var j6=Object.defineProperty;var WN=t=>{throw TypeError(t)};var N6=(t,e,n)=>e in t?j6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var qn=(t,e,n)=>N6(t,typeof e!="symbol"?e+"":e,n),Ax=(t,e,n)=>e.has(t)||WN("Cannot "+n);var le=(t,e,n)=>(Ax(t,e,"read from private field"),n?n.call(t):e.get(t)),vt=(t,e,n)=>e.has(t)?WN("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Ke=(t,e,n,r)=>(Ax(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ot=(t,e,n)=>(Ax(t,e,"access private method"),n);var am=(t,e,n,r)=>({set _(a){Ke(t,e,a,n)},get _(){return le(t,e,r)}});function S6(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in t)){const i=Object.getOwnPropertyDescriptor(r,a);i&&Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var gt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function gE(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var xE={exports:{}},z0={},vE={exports:{}},qt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var df=Symbol.for("react.element"),k6=Symbol.for("react.portal"),C6=Symbol.for("react.fragment"),E6=Symbol.for("react.strict_mode"),A6=Symbol.for("react.profiler"),P6=Symbol.for("react.provider"),D6=Symbol.for("react.context"),T6=Symbol.for("react.forward_ref"),M6=Symbol.for("react.suspense"),R6=Symbol.for("react.memo"),I6=Symbol.for("react.lazy"),HN=Symbol.iterator;function O6(t){return t===null||typeof t!="object"?null:(t=HN&&t[HN]||t["@@iterator"],typeof t=="function"?t:null)}var yE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_E=Object.assign,wE={};function Md(t,e,n){this.props=t,this.context=e,this.refs=wE,this.updater=n||yE}Md.prototype.isReactComponent={};Md.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Md.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function bE(){}bE.prototype=Md.prototype;function Gw(t,e,n){this.props=t,this.context=e,this.refs=wE,this.updater=n||yE}var Qw=Gw.prototype=new bE;Qw.constructor=Gw;_E(Qw,Md.prototype);Qw.isPureReactComponent=!0;var VN=Array.isArray,jE=Object.prototype.hasOwnProperty,Yw={current:null},NE={key:!0,ref:!0,__self:!0,__source:!0};function SE(t,e,n){var r,a={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)jE.call(e,r)&&!NE.hasOwnProperty(r)&&(a[r]=e[r]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var d=Array(c),u=0;u<c;u++)d[u]=arguments[u+2];a.children=d}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)a[r]===void 0&&(a[r]=c[r]);return{$$typeof:df,type:t,key:i,ref:o,props:a,_owner:Yw.current}}function L6(t,e){return{$$typeof:df,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Xw(t){return typeof t=="object"&&t!==null&&t.$$typeof===df}function F6(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var KN=/\/+/g;function Px(t,e){return typeof t=="object"&&t!==null&&t.key!=null?F6(""+t.key):e.toString(36)}function Jm(t,e,n,r,a){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case df:case k6:o=!0}}if(o)return o=t,a=a(o),t=r===""?"."+Px(o,0):r,VN(a)?(n="",t!=null&&(n=t.replace(KN,"$&/")+"/"),Jm(a,e,n,"",function(u){return u})):a!=null&&(Xw(a)&&(a=L6(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(KN,"$&/")+"/")+t)),e.push(a)),1;if(o=0,r=r===""?".":r+":",VN(t))for(var c=0;c<t.length;c++){i=t[c];var d=r+Px(i,c);o+=Jm(i,e,n,d,a)}else if(d=O6(t),typeof d=="function")for(t=d.call(t),c=0;!(i=t.next()).done;)i=i.value,d=r+Px(i,c++),o+=Jm(i,e,n,d,a);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function im(t,e,n){if(t==null)return t;var r=[],a=0;return Jm(t,r,"","",function(i){return e.call(n,i,a++)}),r}function B6(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ls={current:null},ep={transition:null},z6={ReactCurrentDispatcher:Ls,ReactCurrentBatchConfig:ep,ReactCurrentOwner:Yw};function kE(){throw Error("act(...) is not supported in production builds of React.")}qt.Children={map:im,forEach:function(t,e,n){im(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return im(t,function(){e++}),e},toArray:function(t){return im(t,function(e){return e})||[]},only:function(t){if(!Xw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};qt.Component=Md;qt.Fragment=C6;qt.Profiler=A6;qt.PureComponent=Gw;qt.StrictMode=E6;qt.Suspense=M6;qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z6;qt.act=kE;qt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=_E({},t.props),a=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Yw.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(d in e)jE.call(e,d)&&!NE.hasOwnProperty(d)&&(r[d]=e[d]===void 0&&c!==void 0?c[d]:e[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){c=Array(d);for(var u=0;u<d;u++)c[u]=arguments[u+2];r.children=c}return{$$typeof:df,type:t.type,key:a,ref:i,props:r,_owner:o}};qt.createContext=function(t){return t={$$typeof:D6,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:P6,_context:t},t.Consumer=t};qt.createElement=SE;qt.createFactory=function(t){var e=SE.bind(null,t);return e.type=t,e};qt.createRef=function(){return{current:null}};qt.forwardRef=function(t){return{$$typeof:T6,render:t}};qt.isValidElement=Xw;qt.lazy=function(t){return{$$typeof:I6,_payload:{_status:-1,_result:t},_init:B6}};qt.memo=function(t,e){return{$$typeof:R6,type:t,compare:e===void 0?null:e}};qt.startTransition=function(t){var e=ep.transition;ep.transition={};try{t()}finally{ep.transition=e}};qt.unstable_act=kE;qt.useCallback=function(t,e){return Ls.current.useCallback(t,e)};qt.useContext=function(t){return Ls.current.useContext(t)};qt.useDebugValue=function(){};qt.useDeferredValue=function(t){return Ls.current.useDeferredValue(t)};qt.useEffect=function(t,e){return Ls.current.useEffect(t,e)};qt.useId=function(){return Ls.current.useId()};qt.useImperativeHandle=function(t,e,n){return Ls.current.useImperativeHandle(t,e,n)};qt.useInsertionEffect=function(t,e){return Ls.current.useInsertionEffect(t,e)};qt.useLayoutEffect=function(t,e){return Ls.current.useLayoutEffect(t,e)};qt.useMemo=function(t,e){return Ls.current.useMemo(t,e)};qt.useReducer=function(t,e,n){return Ls.current.useReducer(t,e,n)};qt.useRef=function(t){return Ls.current.useRef(t)};qt.useState=function(t){return Ls.current.useState(t)};qt.useSyncExternalStore=function(t,e,n){return Ls.current.useSyncExternalStore(t,e,n)};qt.useTransition=function(){return Ls.current.useTransition()};qt.version="18.3.1";vE.exports=qt;var g=vE.exports;const Ae=pE(g),CE=S6({__proto__:null,default:Ae},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $6=g,U6=Symbol.for("react.element"),q6=Symbol.for("react.fragment"),W6=Object.prototype.hasOwnProperty,H6=$6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V6={key:!0,ref:!0,__self:!0,__source:!0};function EE(t,e,n){var r,a={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)W6.call(e,r)&&!V6.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:U6,type:t,key:i,ref:o,props:a,_owner:H6.current}}z0.Fragment=q6;z0.jsx=EE;z0.jsxs=EE;xE.exports=z0;var s=xE.exports,AE={exports:{}},yr={},PE={exports:{}},DE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(I,V){var $=I.length;I.push(V);e:for(;0<$;){var F=$-1>>>1,O=I[F];if(0<a(O,V))I[F]=V,I[$]=O,$=F;else break e}}function n(I){return I.length===0?null:I[0]}function r(I){if(I.length===0)return null;var V=I[0],$=I.pop();if($!==V){I[0]=$;e:for(var F=0,O=I.length,K=O>>>1;F<K;){var U=2*(F+1)-1,te=I[U],J=U+1,q=I[J];if(0>a(te,$))J<O&&0>a(q,te)?(I[F]=q,I[J]=$,F=J):(I[F]=te,I[U]=$,F=U);else if(J<O&&0>a(q,$))I[F]=q,I[J]=$,F=J;else break e}}return V}function a(I,V){var $=I.sortIndex-V.sortIndex;return $!==0?$:I.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var d=[],u=[],m=1,f=null,p=3,x=!1,j=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(I){for(var V=n(u);V!==null;){if(V.callback===null)r(u);else if(V.startTime<=I)r(u),V.sortIndex=V.expirationTime,e(d,V);else break;V=n(u)}}function S(I){if(v=!1,N(I),!j)if(n(d)!==null)j=!0,de(C);else{var V=n(u);V!==null&&G(S,V.startTime-I)}}function C(I,V){j=!1,v&&(v=!1,b(M),M=-1),x=!0;var $=p;try{for(N(V),f=n(d);f!==null&&(!(f.expirationTime>V)||I&&!D());){var F=f.callback;if(typeof F=="function"){f.callback=null,p=f.priorityLevel;var O=F(f.expirationTime<=V);V=t.unstable_now(),typeof O=="function"?f.callback=O:f===n(d)&&r(d),N(V)}else r(d);f=n(d)}if(f!==null)var K=!0;else{var U=n(u);U!==null&&G(S,U.startTime-V),K=!1}return K}finally{f=null,p=$,x=!1}}var A=!1,P=null,M=-1,z=5,R=-1;function D(){return!(t.unstable_now()-R<z)}function B(){if(P!==null){var I=t.unstable_now();R=I;var V=!0;try{V=P(!0,I)}finally{V?W():(A=!1,P=null)}}else A=!1}var W;if(typeof w=="function")W=function(){w(B)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,ue=X.port2;X.port1.onmessage=B,W=function(){ue.postMessage(null)}}else W=function(){_(B,0)};function de(I){P=I,A||(A=!0,W())}function G(I,V){M=_(function(){I(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(I){I.callback=null},t.unstable_continueExecution=function(){j||x||(j=!0,de(C))},t.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<I?Math.floor(1e3/I):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(I){switch(p){case 1:case 2:case 3:var V=3;break;default:V=p}var $=p;p=V;try{return I()}finally{p=$}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(I,V){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var $=p;p=I;try{return V()}finally{p=$}},t.unstable_scheduleCallback=function(I,V,$){var F=t.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?F+$:F):$=F,I){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=$+O,I={id:m++,callback:V,priorityLevel:I,startTime:$,expirationTime:O,sortIndex:-1},$>F?(I.sortIndex=$,e(u,I),n(d)===null&&I===n(u)&&(v?(b(M),M=-1):v=!0,G(S,$-F))):(I.sortIndex=O,e(d,I),j||x||(j=!0,de(C))),I},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(I){var V=p;return function(){var $=p;p=V;try{return I.apply(this,arguments)}finally{p=$}}}})(DE);PE.exports=DE;var K6=PE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z6=g,mr=K6;function Pe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var TE=new Set,mh={};function Ul(t,e){pd(t,e),pd(t+"Capture",e)}function pd(t,e){for(mh[t]=e,t=0;t<e.length;t++)TE.add(e[t])}var xi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),My=Object.prototype.hasOwnProperty,G6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ZN={},GN={};function Q6(t){return My.call(GN,t)?!0:My.call(ZN,t)?!1:G6.test(t)?GN[t]=!0:(ZN[t]=!0,!1)}function Y6(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function X6(t,e,n,r){if(e===null||typeof e>"u"||Y6(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fs(t,e,n,r,a,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ms={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ms[t]=new Fs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ms[e]=new Fs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ms[t]=new Fs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ms[t]=new Fs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ms[t]=new Fs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ms[t]=new Fs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ms[t]=new Fs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ms[t]=new Fs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ms[t]=new Fs(t,5,!1,t.toLowerCase(),null,!1,!1)});var Jw=/[\-:]([a-z])/g;function eb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Jw,eb);ms[e]=new Fs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Jw,eb);ms[e]=new Fs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Jw,eb);ms[e]=new Fs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ms[t]=new Fs(t,1,!1,t.toLowerCase(),null,!1,!1)});ms.xlinkHref=new Fs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ms[t]=new Fs(t,1,!1,t.toLowerCase(),null,!0,!0)});function tb(t,e,n,r){var a=ms.hasOwnProperty(e)?ms[e]:null;(a!==null?a.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(X6(e,n,a,r)&&(n=null),r||a===null?Q6(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,r=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ki=Z6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,om=Symbol.for("react.element"),Ec=Symbol.for("react.portal"),Ac=Symbol.for("react.fragment"),nb=Symbol.for("react.strict_mode"),Ry=Symbol.for("react.profiler"),ME=Symbol.for("react.provider"),RE=Symbol.for("react.context"),sb=Symbol.for("react.forward_ref"),Iy=Symbol.for("react.suspense"),Oy=Symbol.for("react.suspense_list"),rb=Symbol.for("react.memo"),Vi=Symbol.for("react.lazy"),IE=Symbol.for("react.offscreen"),QN=Symbol.iterator;function hu(t){return t===null||typeof t!="object"?null:(t=QN&&t[QN]||t["@@iterator"],typeof t=="function"?t:null)}var Cn=Object.assign,Dx;function ku(t){if(Dx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Dx=e&&e[1]||""}return`
`+Dx+t}var Tx=!1;function Mx(t,e){if(!t||Tx)return"";Tx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=r.stack.split(`
`),o=a.length-1,c=i.length-1;1<=o&&0<=c&&a[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(a[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||a[o]!==i[c]){var d=`
`+a[o].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=o&&0<=c);break}}}finally{Tx=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ku(t):""}function J6(t){switch(t.tag){case 5:return ku(t.type);case 16:return ku("Lazy");case 13:return ku("Suspense");case 19:return ku("SuspenseList");case 0:case 2:case 15:return t=Mx(t.type,!1),t;case 11:return t=Mx(t.type.render,!1),t;case 1:return t=Mx(t.type,!0),t;default:return""}}function Ly(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ac:return"Fragment";case Ec:return"Portal";case Ry:return"Profiler";case nb:return"StrictMode";case Iy:return"Suspense";case Oy:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case RE:return(t.displayName||"Context")+".Consumer";case ME:return(t._context.displayName||"Context")+".Provider";case sb:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case rb:return e=t.displayName||null,e!==null?e:Ly(t.type)||"Memo";case Vi:e=t._payload,t=t._init;try{return Ly(t(e))}catch{}}return null}function e8(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ly(e);case 8:return e===nb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function So(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function OE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function t8(t){var e=OE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function lm(t){t._valueTracker||(t._valueTracker=t8(t))}function LE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=OE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Pp(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Fy(t,e){var n=e.checked;return Cn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function YN(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=So(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function FE(t,e){e=e.checked,e!=null&&tb(t,"checked",e,!1)}function By(t,e){FE(t,e);var n=So(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?zy(t,e.type,n):e.hasOwnProperty("defaultValue")&&zy(t,e.type,So(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function XN(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function zy(t,e,n){(e!=="number"||Pp(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Cu=Array.isArray;function qc(t,e,n,r){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&r&&(t[n].defaultSelected=!0)}else{for(n=""+So(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,r&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function $y(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Pe(91));return Cn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function JN(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Pe(92));if(Cu(n)){if(1<n.length)throw Error(Pe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:So(n)}}function BE(t,e){var n=So(e.value),r=So(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function e2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function zE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Uy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?zE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var cm,$E=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(cm=cm||document.createElement("div"),cm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=cm.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ph(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ku={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},n8=["Webkit","ms","Moz","O"];Object.keys(Ku).forEach(function(t){n8.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ku[e]=Ku[t]})});function UE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ku.hasOwnProperty(t)&&Ku[t]?(""+e).trim():e+"px"}function qE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=UE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,a):t[n]=a}}var s8=Cn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qy(t,e){if(e){if(s8[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Pe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Pe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Pe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Pe(62))}}function Wy(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hy=null;function ab(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Vy=null,Wc=null,Hc=null;function t2(t){if(t=ff(t)){if(typeof Vy!="function")throw Error(Pe(280));var e=t.stateNode;e&&(e=H0(e),Vy(t.stateNode,t.type,e))}}function WE(t){Wc?Hc?Hc.push(t):Hc=[t]:Wc=t}function HE(){if(Wc){var t=Wc,e=Hc;if(Hc=Wc=null,t2(t),e)for(t=0;t<e.length;t++)t2(e[t])}}function VE(t,e){return t(e)}function KE(){}var Rx=!1;function ZE(t,e,n){if(Rx)return t(e,n);Rx=!0;try{return VE(t,e,n)}finally{Rx=!1,(Wc!==null||Hc!==null)&&(KE(),HE())}}function gh(t,e){var n=t.stateNode;if(n===null)return null;var r=H0(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Pe(231,e,typeof n));return n}var Ky=!1;if(xi)try{var fu={};Object.defineProperty(fu,"passive",{get:function(){Ky=!0}}),window.addEventListener("test",fu,fu),window.removeEventListener("test",fu,fu)}catch{Ky=!1}function r8(t,e,n,r,a,i,o,c,d){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(m){this.onError(m)}}var Zu=!1,Dp=null,Tp=!1,Zy=null,a8={onError:function(t){Zu=!0,Dp=t}};function i8(t,e,n,r,a,i,o,c,d){Zu=!1,Dp=null,r8.apply(a8,arguments)}function o8(t,e,n,r,a,i,o,c,d){if(i8.apply(this,arguments),Zu){if(Zu){var u=Dp;Zu=!1,Dp=null}else throw Error(Pe(198));Tp||(Tp=!0,Zy=u)}}function ql(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function GE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function n2(t){if(ql(t)!==t)throw Error(Pe(188))}function l8(t){var e=t.alternate;if(!e){if(e=ql(t),e===null)throw Error(Pe(188));return e!==t?null:t}for(var n=t,r=e;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return n2(a),t;if(i===r)return n2(a),e;i=i.sibling}throw Error(Pe(188))}if(n.return!==r.return)n=a,r=i;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=i;break}if(c===r){o=!0,r=a,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=a;break}if(c===r){o=!0,r=i,n=a;break}c=c.sibling}if(!o)throw Error(Pe(189))}}if(n.alternate!==r)throw Error(Pe(190))}if(n.tag!==3)throw Error(Pe(188));return n.stateNode.current===n?t:e}function QE(t){return t=l8(t),t!==null?YE(t):null}function YE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=YE(t);if(e!==null)return e;t=t.sibling}return null}var XE=mr.unstable_scheduleCallback,s2=mr.unstable_cancelCallback,c8=mr.unstable_shouldYield,d8=mr.unstable_requestPaint,Dn=mr.unstable_now,u8=mr.unstable_getCurrentPriorityLevel,ib=mr.unstable_ImmediatePriority,JE=mr.unstable_UserBlockingPriority,Mp=mr.unstable_NormalPriority,h8=mr.unstable_LowPriority,e4=mr.unstable_IdlePriority,$0=null,Oa=null;function f8(t){if(Oa&&typeof Oa.onCommitFiberRoot=="function")try{Oa.onCommitFiberRoot($0,t,void 0,(t.current.flags&128)===128)}catch{}}var ta=Math.clz32?Math.clz32:g8,m8=Math.log,p8=Math.LN2;function g8(t){return t>>>=0,t===0?32:31-(m8(t)/p8|0)|0}var dm=64,um=4194304;function Eu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Rp(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,a=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~a;c!==0?r=Eu(c):(i&=o,i!==0&&(r=Eu(i)))}else o=n&~a,o!==0?r=Eu(o):i!==0&&(r=Eu(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&a)&&(a=r&-r,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ta(e),a=1<<n,r|=t[n],e&=~a;return r}function x8(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function v8(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-ta(i),c=1<<o,d=a[o];d===-1?(!(c&n)||c&r)&&(a[o]=x8(c,e)):d<=e&&(t.expiredLanes|=c),i&=~c}}function Gy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function t4(){var t=dm;return dm<<=1,!(dm&4194240)&&(dm=64),t}function Ix(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function uf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ta(e),t[e]=n}function y8(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-ta(n),i=1<<a;e[a]=0,r[a]=-1,t[a]=-1,n&=~i}}function ob(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ta(n),a=1<<r;a&e|t[r]&e&&(t[r]|=e),n&=~a}}var on=0;function n4(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var s4,lb,r4,a4,i4,Qy=!1,hm=[],po=null,go=null,xo=null,xh=new Map,vh=new Map,Qi=[],_8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function r2(t,e){switch(t){case"focusin":case"focusout":po=null;break;case"dragenter":case"dragleave":go=null;break;case"mouseover":case"mouseout":xo=null;break;case"pointerover":case"pointerout":xh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":vh.delete(e.pointerId)}}function mu(t,e,n,r,a,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},e!==null&&(e=ff(e),e!==null&&lb(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function w8(t,e,n,r,a){switch(e){case"focusin":return po=mu(po,t,e,n,r,a),!0;case"dragenter":return go=mu(go,t,e,n,r,a),!0;case"mouseover":return xo=mu(xo,t,e,n,r,a),!0;case"pointerover":var i=a.pointerId;return xh.set(i,mu(xh.get(i)||null,t,e,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,vh.set(i,mu(vh.get(i)||null,t,e,n,r,a)),!0}return!1}function o4(t){var e=cl(t.target);if(e!==null){var n=ql(e);if(n!==null){if(e=n.tag,e===13){if(e=GE(n),e!==null){t.blockedOn=e,i4(t.priority,function(){r4(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function tp(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Yy(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Hy=r,n.target.dispatchEvent(r),Hy=null}else return e=ff(n),e!==null&&lb(e),t.blockedOn=n,!1;e.shift()}return!0}function a2(t,e,n){tp(t)&&n.delete(e)}function b8(){Qy=!1,po!==null&&tp(po)&&(po=null),go!==null&&tp(go)&&(go=null),xo!==null&&tp(xo)&&(xo=null),xh.forEach(a2),vh.forEach(a2)}function pu(t,e){t.blockedOn===e&&(t.blockedOn=null,Qy||(Qy=!0,mr.unstable_scheduleCallback(mr.unstable_NormalPriority,b8)))}function yh(t){function e(a){return pu(a,t)}if(0<hm.length){pu(hm[0],t);for(var n=1;n<hm.length;n++){var r=hm[n];r.blockedOn===t&&(r.blockedOn=null)}}for(po!==null&&pu(po,t),go!==null&&pu(go,t),xo!==null&&pu(xo,t),xh.forEach(e),vh.forEach(e),n=0;n<Qi.length;n++)r=Qi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Qi.length&&(n=Qi[0],n.blockedOn===null);)o4(n),n.blockedOn===null&&Qi.shift()}var Vc=ki.ReactCurrentBatchConfig,Ip=!0;function j8(t,e,n,r){var a=on,i=Vc.transition;Vc.transition=null;try{on=1,cb(t,e,n,r)}finally{on=a,Vc.transition=i}}function N8(t,e,n,r){var a=on,i=Vc.transition;Vc.transition=null;try{on=4,cb(t,e,n,r)}finally{on=a,Vc.transition=i}}function cb(t,e,n,r){if(Ip){var a=Yy(t,e,n,r);if(a===null)Hx(t,e,r,Op,n),r2(t,r);else if(w8(a,t,e,n,r))r.stopPropagation();else if(r2(t,r),e&4&&-1<_8.indexOf(t)){for(;a!==null;){var i=ff(a);if(i!==null&&s4(i),i=Yy(t,e,n,r),i===null&&Hx(t,e,r,Op,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else Hx(t,e,r,null,n)}}var Op=null;function Yy(t,e,n,r){if(Op=null,t=ab(r),t=cl(t),t!==null)if(e=ql(t),e===null)t=null;else if(n=e.tag,n===13){if(t=GE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Op=t,null}function l4(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(u8()){case ib:return 1;case JE:return 4;case Mp:case h8:return 16;case e4:return 536870912;default:return 16}default:return 16}}var co=null,db=null,np=null;function c4(){if(np)return np;var t,e=db,n=e.length,r,a="value"in co?co.value:co.textContent,i=a.length;for(t=0;t<n&&e[t]===a[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===a[i-r];r++);return np=a.slice(t,1<r?1-r:void 0)}function sp(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function fm(){return!0}function i2(){return!1}function _r(t){function e(n,r,a,i,o){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?fm:i2,this.isPropagationStopped=i2,this}return Cn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=fm)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=fm)},persist:function(){},isPersistent:fm}),e}var Rd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ub=_r(Rd),hf=Cn({},Rd,{view:0,detail:0}),S8=_r(hf),Ox,Lx,gu,U0=Cn({},hf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==gu&&(gu&&t.type==="mousemove"?(Ox=t.screenX-gu.screenX,Lx=t.screenY-gu.screenY):Lx=Ox=0,gu=t),Ox)},movementY:function(t){return"movementY"in t?t.movementY:Lx}}),o2=_r(U0),k8=Cn({},U0,{dataTransfer:0}),C8=_r(k8),E8=Cn({},hf,{relatedTarget:0}),Fx=_r(E8),A8=Cn({},Rd,{animationName:0,elapsedTime:0,pseudoElement:0}),P8=_r(A8),D8=Cn({},Rd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),T8=_r(D8),M8=Cn({},Rd,{data:0}),l2=_r(M8),R8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},I8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},O8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function L8(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=O8[t])?!!e[t]:!1}function hb(){return L8}var F8=Cn({},hf,{key:function(t){if(t.key){var e=R8[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=sp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?I8[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hb,charCode:function(t){return t.type==="keypress"?sp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?sp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),B8=_r(F8),z8=Cn({},U0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),c2=_r(z8),$8=Cn({},hf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hb}),U8=_r($8),q8=Cn({},Rd,{propertyName:0,elapsedTime:0,pseudoElement:0}),W8=_r(q8),H8=Cn({},U0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),V8=_r(H8),K8=[9,13,27,32],fb=xi&&"CompositionEvent"in window,Gu=null;xi&&"documentMode"in document&&(Gu=document.documentMode);var Z8=xi&&"TextEvent"in window&&!Gu,d4=xi&&(!fb||Gu&&8<Gu&&11>=Gu),d2=" ",u2=!1;function u4(t,e){switch(t){case"keyup":return K8.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function h4(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pc=!1;function G8(t,e){switch(t){case"compositionend":return h4(e);case"keypress":return e.which!==32?null:(u2=!0,d2);case"textInput":return t=e.data,t===d2&&u2?null:t;default:return null}}function Q8(t,e){if(Pc)return t==="compositionend"||!fb&&u4(t,e)?(t=c4(),np=db=co=null,Pc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return d4&&e.locale!=="ko"?null:e.data;default:return null}}var Y8={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function h2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Y8[t.type]:e==="textarea"}function f4(t,e,n,r){WE(r),e=Lp(e,"onChange"),0<e.length&&(n=new ub("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Qu=null,_h=null;function X8(t){N4(t,0)}function q0(t){var e=Mc(t);if(LE(e))return t}function J8(t,e){if(t==="change")return e}var m4=!1;if(xi){var Bx;if(xi){var zx="oninput"in document;if(!zx){var f2=document.createElement("div");f2.setAttribute("oninput","return;"),zx=typeof f2.oninput=="function"}Bx=zx}else Bx=!1;m4=Bx&&(!document.documentMode||9<document.documentMode)}function m2(){Qu&&(Qu.detachEvent("onpropertychange",p4),_h=Qu=null)}function p4(t){if(t.propertyName==="value"&&q0(_h)){var e=[];f4(e,_h,t,ab(t)),ZE(X8,e)}}function eL(t,e,n){t==="focusin"?(m2(),Qu=e,_h=n,Qu.attachEvent("onpropertychange",p4)):t==="focusout"&&m2()}function tL(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return q0(_h)}function nL(t,e){if(t==="click")return q0(e)}function sL(t,e){if(t==="input"||t==="change")return q0(e)}function rL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var oa=typeof Object.is=="function"?Object.is:rL;function wh(t,e){if(oa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!My.call(e,a)||!oa(t[a],e[a]))return!1}return!0}function p2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function g2(t,e){var n=p2(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=p2(n)}}function g4(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?g4(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function x4(){for(var t=window,e=Pp();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Pp(t.document)}return e}function mb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function aL(t){var e=x4(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&g4(n.ownerDocument.documentElement,n)){if(r!==null&&mb(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!t.extend&&i>r&&(a=r,r=i,i=a),a=g2(n,i);var o=g2(n,r);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var iL=xi&&"documentMode"in document&&11>=document.documentMode,Dc=null,Xy=null,Yu=null,Jy=!1;function x2(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Jy||Dc==null||Dc!==Pp(r)||(r=Dc,"selectionStart"in r&&mb(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Yu&&wh(Yu,r)||(Yu=r,r=Lp(Xy,"onSelect"),0<r.length&&(e=new ub("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Dc)))}function mm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Tc={animationend:mm("Animation","AnimationEnd"),animationiteration:mm("Animation","AnimationIteration"),animationstart:mm("Animation","AnimationStart"),transitionend:mm("Transition","TransitionEnd")},$x={},v4={};xi&&(v4=document.createElement("div").style,"AnimationEvent"in window||(delete Tc.animationend.animation,delete Tc.animationiteration.animation,delete Tc.animationstart.animation),"TransitionEvent"in window||delete Tc.transitionend.transition);function W0(t){if($x[t])return $x[t];if(!Tc[t])return t;var e=Tc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in v4)return $x[t]=e[n];return t}var y4=W0("animationend"),_4=W0("animationiteration"),w4=W0("animationstart"),b4=W0("transitionend"),j4=new Map,v2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lo(t,e){j4.set(t,e),Ul(e,[t])}for(var Ux=0;Ux<v2.length;Ux++){var qx=v2[Ux],oL=qx.toLowerCase(),lL=qx[0].toUpperCase()+qx.slice(1);Lo(oL,"on"+lL)}Lo(y4,"onAnimationEnd");Lo(_4,"onAnimationIteration");Lo(w4,"onAnimationStart");Lo("dblclick","onDoubleClick");Lo("focusin","onFocus");Lo("focusout","onBlur");Lo(b4,"onTransitionEnd");pd("onMouseEnter",["mouseout","mouseover"]);pd("onMouseLeave",["mouseout","mouseover"]);pd("onPointerEnter",["pointerout","pointerover"]);pd("onPointerLeave",["pointerout","pointerover"]);Ul("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ul("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ul("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ul("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ul("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ul("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Au="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cL=new Set("cancel close invalid load scroll toggle".split(" ").concat(Au));function y2(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,o8(r,e,void 0,t),t.currentTarget=null}function N4(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],a=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],d=c.instance,u=c.currentTarget;if(c=c.listener,d!==i&&a.isPropagationStopped())break e;y2(a,c,u),i=d}else for(o=0;o<r.length;o++){if(c=r[o],d=c.instance,u=c.currentTarget,c=c.listener,d!==i&&a.isPropagationStopped())break e;y2(a,c,u),i=d}}}if(Tp)throw t=Zy,Tp=!1,Zy=null,t}function xn(t,e){var n=e[r_];n===void 0&&(n=e[r_]=new Set);var r=t+"__bubble";n.has(r)||(S4(e,t,2,!1),n.add(r))}function Wx(t,e,n){var r=0;e&&(r|=4),S4(n,t,r,e)}var pm="_reactListening"+Math.random().toString(36).slice(2);function bh(t){if(!t[pm]){t[pm]=!0,TE.forEach(function(n){n!=="selectionchange"&&(cL.has(n)||Wx(n,!1,t),Wx(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[pm]||(e[pm]=!0,Wx("selectionchange",!1,e))}}function S4(t,e,n,r){switch(l4(e)){case 1:var a=j8;break;case 4:a=N8;break;default:a=cb}n=a.bind(null,e,n,t),a=void 0,!Ky||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),r?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function Hx(t,e,n,r,a){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(o===4)for(o=r.return;o!==null;){var d=o.tag;if((d===3||d===4)&&(d=o.stateNode.containerInfo,d===a||d.nodeType===8&&d.parentNode===a))return;o=o.return}for(;c!==null;){if(o=cl(c),o===null)return;if(d=o.tag,d===5||d===6){r=i=o;continue e}c=c.parentNode}}r=r.return}ZE(function(){var u=i,m=ab(n),f=[];e:{var p=j4.get(t);if(p!==void 0){var x=ub,j=t;switch(t){case"keypress":if(sp(n)===0)break e;case"keydown":case"keyup":x=B8;break;case"focusin":j="focus",x=Fx;break;case"focusout":j="blur",x=Fx;break;case"beforeblur":case"afterblur":x=Fx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=o2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=C8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=U8;break;case y4:case _4:case w4:x=P8;break;case b4:x=W8;break;case"scroll":x=S8;break;case"wheel":x=V8;break;case"copy":case"cut":case"paste":x=T8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=c2}var v=(e&4)!==0,_=!v&&t==="scroll",b=v?p!==null?p+"Capture":null:p;v=[];for(var w=u,N;w!==null;){N=w;var S=N.stateNode;if(N.tag===5&&S!==null&&(N=S,b!==null&&(S=gh(w,b),S!=null&&v.push(jh(w,S,N)))),_)break;w=w.return}0<v.length&&(p=new x(p,j,null,n,m),f.push({event:p,listeners:v}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",p&&n!==Hy&&(j=n.relatedTarget||n.fromElement)&&(cl(j)||j[vi]))break e;if((x||p)&&(p=m.window===m?m:(p=m.ownerDocument)?p.defaultView||p.parentWindow:window,x?(j=n.relatedTarget||n.toElement,x=u,j=j?cl(j):null,j!==null&&(_=ql(j),j!==_||j.tag!==5&&j.tag!==6)&&(j=null)):(x=null,j=u),x!==j)){if(v=o2,S="onMouseLeave",b="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(v=c2,S="onPointerLeave",b="onPointerEnter",w="pointer"),_=x==null?p:Mc(x),N=j==null?p:Mc(j),p=new v(S,w+"leave",x,n,m),p.target=_,p.relatedTarget=N,S=null,cl(m)===u&&(v=new v(b,w+"enter",j,n,m),v.target=N,v.relatedTarget=_,S=v),_=S,x&&j)t:{for(v=x,b=j,w=0,N=v;N;N=cc(N))w++;for(N=0,S=b;S;S=cc(S))N++;for(;0<w-N;)v=cc(v),w--;for(;0<N-w;)b=cc(b),N--;for(;w--;){if(v===b||b!==null&&v===b.alternate)break t;v=cc(v),b=cc(b)}v=null}else v=null;x!==null&&_2(f,p,x,v,!1),j!==null&&_!==null&&_2(f,_,j,v,!0)}}e:{if(p=u?Mc(u):window,x=p.nodeName&&p.nodeName.toLowerCase(),x==="select"||x==="input"&&p.type==="file")var C=J8;else if(h2(p))if(m4)C=sL;else{C=tL;var A=eL}else(x=p.nodeName)&&x.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=nL);if(C&&(C=C(t,u))){f4(f,C,n,m);break e}A&&A(t,p,u),t==="focusout"&&(A=p._wrapperState)&&A.controlled&&p.type==="number"&&zy(p,"number",p.value)}switch(A=u?Mc(u):window,t){case"focusin":(h2(A)||A.contentEditable==="true")&&(Dc=A,Xy=u,Yu=null);break;case"focusout":Yu=Xy=Dc=null;break;case"mousedown":Jy=!0;break;case"contextmenu":case"mouseup":case"dragend":Jy=!1,x2(f,n,m);break;case"selectionchange":if(iL)break;case"keydown":case"keyup":x2(f,n,m)}var P;if(fb)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Pc?u4(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(d4&&n.locale!=="ko"&&(Pc||M!=="onCompositionStart"?M==="onCompositionEnd"&&Pc&&(P=c4()):(co=m,db="value"in co?co.value:co.textContent,Pc=!0)),A=Lp(u,M),0<A.length&&(M=new l2(M,t,null,n,m),f.push({event:M,listeners:A}),P?M.data=P:(P=h4(n),P!==null&&(M.data=P)))),(P=Z8?G8(t,n):Q8(t,n))&&(u=Lp(u,"onBeforeInput"),0<u.length&&(m=new l2("onBeforeInput","beforeinput",null,n,m),f.push({event:m,listeners:u}),m.data=P))}N4(f,e)})}function jh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Lp(t,e){for(var n=e+"Capture",r=[];t!==null;){var a=t,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=gh(t,n),i!=null&&r.unshift(jh(t,i,a)),i=gh(t,e),i!=null&&r.push(jh(t,i,a))),t=t.return}return r}function cc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function _2(t,e,n,r,a){for(var i=e._reactName,o=[];n!==null&&n!==r;){var c=n,d=c.alternate,u=c.stateNode;if(d!==null&&d===r)break;c.tag===5&&u!==null&&(c=u,a?(d=gh(n,i),d!=null&&o.unshift(jh(n,d,c))):a||(d=gh(n,i),d!=null&&o.push(jh(n,d,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var dL=/\r\n?/g,uL=/\u0000|\uFFFD/g;function w2(t){return(typeof t=="string"?t:""+t).replace(dL,`
`).replace(uL,"")}function gm(t,e,n){if(e=w2(e),w2(t)!==e&&n)throw Error(Pe(425))}function Fp(){}var e_=null,t_=null;function n_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var s_=typeof setTimeout=="function"?setTimeout:void 0,hL=typeof clearTimeout=="function"?clearTimeout:void 0,b2=typeof Promise=="function"?Promise:void 0,fL=typeof queueMicrotask=="function"?queueMicrotask:typeof b2<"u"?function(t){return b2.resolve(null).then(t).catch(mL)}:s_;function mL(t){setTimeout(function(){throw t})}function Vx(t,e){var n=e,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){t.removeChild(a),yh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);yh(e)}function vo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function j2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Id=Math.random().toString(36).slice(2),Pa="__reactFiber$"+Id,Nh="__reactProps$"+Id,vi="__reactContainer$"+Id,r_="__reactEvents$"+Id,pL="__reactListeners$"+Id,gL="__reactHandles$"+Id;function cl(t){var e=t[Pa];if(e)return e;for(var n=t.parentNode;n;){if(e=n[vi]||n[Pa]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=j2(t);t!==null;){if(n=t[Pa])return n;t=j2(t)}return e}t=n,n=t.parentNode}return null}function ff(t){return t=t[Pa]||t[vi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Mc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Pe(33))}function H0(t){return t[Nh]||null}var a_=[],Rc=-1;function Fo(t){return{current:t}}function vn(t){0>Rc||(t.current=a_[Rc],a_[Rc]=null,Rc--)}function fn(t,e){Rc++,a_[Rc]=t.current,t.current=e}var ko={},bs=Fo(ko),Gs=Fo(!1),kl=ko;function gd(t,e){var n=t.type.contextTypes;if(!n)return ko;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Qs(t){return t=t.childContextTypes,t!=null}function Bp(){vn(Gs),vn(bs)}function N2(t,e,n){if(bs.current!==ko)throw Error(Pe(168));fn(bs,e),fn(Gs,n)}function k4(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in e))throw Error(Pe(108,e8(t)||"Unknown",a));return Cn({},n,r)}function zp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ko,kl=bs.current,fn(bs,t),fn(Gs,Gs.current),!0}function S2(t,e,n){var r=t.stateNode;if(!r)throw Error(Pe(169));n?(t=k4(t,e,kl),r.__reactInternalMemoizedMergedChildContext=t,vn(Gs),vn(bs),fn(bs,t)):vn(Gs),fn(Gs,n)}var di=null,V0=!1,Kx=!1;function C4(t){di===null?di=[t]:di.push(t)}function xL(t){V0=!0,C4(t)}function Bo(){if(!Kx&&di!==null){Kx=!0;var t=0,e=on;try{var n=di;for(on=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}di=null,V0=!1}catch(a){throw di!==null&&(di=di.slice(t+1)),XE(ib,Bo),a}finally{on=e,Kx=!1}}return null}var Ic=[],Oc=0,$p=null,Up=0,Er=[],Ar=0,Cl=null,hi=1,fi="";function Jo(t,e){Ic[Oc++]=Up,Ic[Oc++]=$p,$p=t,Up=e}function E4(t,e,n){Er[Ar++]=hi,Er[Ar++]=fi,Er[Ar++]=Cl,Cl=t;var r=hi;t=fi;var a=32-ta(r)-1;r&=~(1<<a),n+=1;var i=32-ta(e)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,hi=1<<32-ta(e)+a|n<<a|r,fi=i+t}else hi=1<<i|n<<a|r,fi=t}function pb(t){t.return!==null&&(Jo(t,1),E4(t,1,0))}function gb(t){for(;t===$p;)$p=Ic[--Oc],Ic[Oc]=null,Up=Ic[--Oc],Ic[Oc]=null;for(;t===Cl;)Cl=Er[--Ar],Er[Ar]=null,fi=Er[--Ar],Er[Ar]=null,hi=Er[--Ar],Er[Ar]=null}var cr=null,or=null,yn=!1,Qr=null;function A4(t,e){var n=Pr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function k2(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,cr=t,or=vo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,cr=t,or=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Cl!==null?{id:hi,overflow:fi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Pr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,cr=t,or=null,!0):!1;default:return!1}}function i_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function o_(t){if(yn){var e=or;if(e){var n=e;if(!k2(t,e)){if(i_(t))throw Error(Pe(418));e=vo(n.nextSibling);var r=cr;e&&k2(t,e)?A4(r,n):(t.flags=t.flags&-4097|2,yn=!1,cr=t)}}else{if(i_(t))throw Error(Pe(418));t.flags=t.flags&-4097|2,yn=!1,cr=t}}}function C2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;cr=t}function xm(t){if(t!==cr)return!1;if(!yn)return C2(t),yn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!n_(t.type,t.memoizedProps)),e&&(e=or)){if(i_(t))throw P4(),Error(Pe(418));for(;e;)A4(t,e),e=vo(e.nextSibling)}if(C2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Pe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){or=vo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}or=null}}else or=cr?vo(t.stateNode.nextSibling):null;return!0}function P4(){for(var t=or;t;)t=vo(t.nextSibling)}function xd(){or=cr=null,yn=!1}function xb(t){Qr===null?Qr=[t]:Qr.push(t)}var vL=ki.ReactCurrentBatchConfig;function xu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Pe(309));var r=n.stateNode}if(!r)throw Error(Pe(147,t));var a=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=a.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Pe(284));if(!n._owner)throw Error(Pe(290,t))}return t}function vm(t,e){throw t=Object.prototype.toString.call(e),Error(Pe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function E2(t){var e=t._init;return e(t._payload)}function D4(t){function e(b,w){if(t){var N=b.deletions;N===null?(b.deletions=[w],b.flags|=16):N.push(w)}}function n(b,w){if(!t)return null;for(;w!==null;)e(b,w),w=w.sibling;return null}function r(b,w){for(b=new Map;w!==null;)w.key!==null?b.set(w.key,w):b.set(w.index,w),w=w.sibling;return b}function a(b,w){return b=bo(b,w),b.index=0,b.sibling=null,b}function i(b,w,N){return b.index=N,t?(N=b.alternate,N!==null?(N=N.index,N<w?(b.flags|=2,w):N):(b.flags|=2,w)):(b.flags|=1048576,w)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function c(b,w,N,S){return w===null||w.tag!==6?(w=ev(N,b.mode,S),w.return=b,w):(w=a(w,N),w.return=b,w)}function d(b,w,N,S){var C=N.type;return C===Ac?m(b,w,N.props.children,S,N.key):w!==null&&(w.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Vi&&E2(C)===w.type)?(S=a(w,N.props),S.ref=xu(b,w,N),S.return=b,S):(S=dp(N.type,N.key,N.props,null,b.mode,S),S.ref=xu(b,w,N),S.return=b,S)}function u(b,w,N,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==N.containerInfo||w.stateNode.implementation!==N.implementation?(w=tv(N,b.mode,S),w.return=b,w):(w=a(w,N.children||[]),w.return=b,w)}function m(b,w,N,S,C){return w===null||w.tag!==7?(w=bl(N,b.mode,S,C),w.return=b,w):(w=a(w,N),w.return=b,w)}function f(b,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return w=ev(""+w,b.mode,N),w.return=b,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case om:return N=dp(w.type,w.key,w.props,null,b.mode,N),N.ref=xu(b,null,w),N.return=b,N;case Ec:return w=tv(w,b.mode,N),w.return=b,w;case Vi:var S=w._init;return f(b,S(w._payload),N)}if(Cu(w)||hu(w))return w=bl(w,b.mode,N,null),w.return=b,w;vm(b,w)}return null}function p(b,w,N,S){var C=w!==null?w.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return C!==null?null:c(b,w,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case om:return N.key===C?d(b,w,N,S):null;case Ec:return N.key===C?u(b,w,N,S):null;case Vi:return C=N._init,p(b,w,C(N._payload),S)}if(Cu(N)||hu(N))return C!==null?null:m(b,w,N,S,null);vm(b,N)}return null}function x(b,w,N,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(N)||null,c(w,b,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case om:return b=b.get(S.key===null?N:S.key)||null,d(w,b,S,C);case Ec:return b=b.get(S.key===null?N:S.key)||null,u(w,b,S,C);case Vi:var A=S._init;return x(b,w,N,A(S._payload),C)}if(Cu(S)||hu(S))return b=b.get(N)||null,m(w,b,S,C,null);vm(w,S)}return null}function j(b,w,N,S){for(var C=null,A=null,P=w,M=w=0,z=null;P!==null&&M<N.length;M++){P.index>M?(z=P,P=null):z=P.sibling;var R=p(b,P,N[M],S);if(R===null){P===null&&(P=z);break}t&&P&&R.alternate===null&&e(b,P),w=i(R,w,M),A===null?C=R:A.sibling=R,A=R,P=z}if(M===N.length)return n(b,P),yn&&Jo(b,M),C;if(P===null){for(;M<N.length;M++)P=f(b,N[M],S),P!==null&&(w=i(P,w,M),A===null?C=P:A.sibling=P,A=P);return yn&&Jo(b,M),C}for(P=r(b,P);M<N.length;M++)z=x(P,b,M,N[M],S),z!==null&&(t&&z.alternate!==null&&P.delete(z.key===null?M:z.key),w=i(z,w,M),A===null?C=z:A.sibling=z,A=z);return t&&P.forEach(function(D){return e(b,D)}),yn&&Jo(b,M),C}function v(b,w,N,S){var C=hu(N);if(typeof C!="function")throw Error(Pe(150));if(N=C.call(N),N==null)throw Error(Pe(151));for(var A=C=null,P=w,M=w=0,z=null,R=N.next();P!==null&&!R.done;M++,R=N.next()){P.index>M?(z=P,P=null):z=P.sibling;var D=p(b,P,R.value,S);if(D===null){P===null&&(P=z);break}t&&P&&D.alternate===null&&e(b,P),w=i(D,w,M),A===null?C=D:A.sibling=D,A=D,P=z}if(R.done)return n(b,P),yn&&Jo(b,M),C;if(P===null){for(;!R.done;M++,R=N.next())R=f(b,R.value,S),R!==null&&(w=i(R,w,M),A===null?C=R:A.sibling=R,A=R);return yn&&Jo(b,M),C}for(P=r(b,P);!R.done;M++,R=N.next())R=x(P,b,M,R.value,S),R!==null&&(t&&R.alternate!==null&&P.delete(R.key===null?M:R.key),w=i(R,w,M),A===null?C=R:A.sibling=R,A=R);return t&&P.forEach(function(B){return e(b,B)}),yn&&Jo(b,M),C}function _(b,w,N,S){if(typeof N=="object"&&N!==null&&N.type===Ac&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case om:e:{for(var C=N.key,A=w;A!==null;){if(A.key===C){if(C=N.type,C===Ac){if(A.tag===7){n(b,A.sibling),w=a(A,N.props.children),w.return=b,b=w;break e}}else if(A.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Vi&&E2(C)===A.type){n(b,A.sibling),w=a(A,N.props),w.ref=xu(b,A,N),w.return=b,b=w;break e}n(b,A);break}else e(b,A);A=A.sibling}N.type===Ac?(w=bl(N.props.children,b.mode,S,N.key),w.return=b,b=w):(S=dp(N.type,N.key,N.props,null,b.mode,S),S.ref=xu(b,w,N),S.return=b,b=S)}return o(b);case Ec:e:{for(A=N.key;w!==null;){if(w.key===A)if(w.tag===4&&w.stateNode.containerInfo===N.containerInfo&&w.stateNode.implementation===N.implementation){n(b,w.sibling),w=a(w,N.children||[]),w.return=b,b=w;break e}else{n(b,w);break}else e(b,w);w=w.sibling}w=tv(N,b.mode,S),w.return=b,b=w}return o(b);case Vi:return A=N._init,_(b,w,A(N._payload),S)}if(Cu(N))return j(b,w,N,S);if(hu(N))return v(b,w,N,S);vm(b,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,w!==null&&w.tag===6?(n(b,w.sibling),w=a(w,N),w.return=b,b=w):(n(b,w),w=ev(N,b.mode,S),w.return=b,b=w),o(b)):n(b,w)}return _}var vd=D4(!0),T4=D4(!1),qp=Fo(null),Wp=null,Lc=null,vb=null;function yb(){vb=Lc=Wp=null}function _b(t){var e=qp.current;vn(qp),t._currentValue=e}function l_(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Kc(t,e){Wp=t,vb=Lc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Zs=!0),t.firstContext=null)}function Ir(t){var e=t._currentValue;if(vb!==t)if(t={context:t,memoizedValue:e,next:null},Lc===null){if(Wp===null)throw Error(Pe(308));Lc=t,Wp.dependencies={lanes:0,firstContext:t}}else Lc=Lc.next=t;return e}var dl=null;function wb(t){dl===null?dl=[t]:dl.push(t)}function M4(t,e,n,r){var a=e.interleaved;return a===null?(n.next=n,wb(e)):(n.next=a.next,a.next=n),e.interleaved=n,yi(t,r)}function yi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ki=!1;function bb(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function R4(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function pi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function yo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Yt&2){var a=r.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),r.pending=e,yi(t,n)}return a=r.interleaved,a===null?(e.next=e,wb(r)):(e.next=a.next,a.next=e),r.interleaved=e,yi(t,n)}function rp(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ob(t,n)}}function A2(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?a=i=e:i=i.next=e}else a=i=e;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Hp(t,e,n,r){var a=t.updateQueue;Ki=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var d=c,u=d.next;d.next=null,o===null?i=u:o.next=u,o=d;var m=t.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==o&&(c===null?m.firstBaseUpdate=u:c.next=u,m.lastBaseUpdate=d))}if(i!==null){var f=a.baseState;o=0,m=u=d=null,c=i;do{var p=c.lane,x=c.eventTime;if((r&p)===p){m!==null&&(m=m.next={eventTime:x,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var j=t,v=c;switch(p=e,x=n,v.tag){case 1:if(j=v.payload,typeof j=="function"){f=j.call(x,f,p);break e}f=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=v.payload,p=typeof j=="function"?j.call(x,f,p):j,p==null)break e;f=Cn({},f,p);break e;case 2:Ki=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,p=a.effects,p===null?a.effects=[c]:p.push(c))}else x={eventTime:x,lane:p,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(u=m=x,d=f):m=m.next=x,o|=p;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;p=c,c=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(m===null&&(d=f),a.baseState=d,a.firstBaseUpdate=u,a.lastBaseUpdate=m,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);Al|=o,t.lanes=o,t.memoizedState=f}}function P2(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(Pe(191,a));a.call(r)}}}var mf={},La=Fo(mf),Sh=Fo(mf),kh=Fo(mf);function ul(t){if(t===mf)throw Error(Pe(174));return t}function jb(t,e){switch(fn(kh,e),fn(Sh,t),fn(La,mf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Uy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Uy(e,t)}vn(La),fn(La,e)}function yd(){vn(La),vn(Sh),vn(kh)}function I4(t){ul(kh.current);var e=ul(La.current),n=Uy(e,t.type);e!==n&&(fn(Sh,t),fn(La,n))}function Nb(t){Sh.current===t&&(vn(La),vn(Sh))}var Sn=Fo(0);function Vp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Zx=[];function Sb(){for(var t=0;t<Zx.length;t++)Zx[t]._workInProgressVersionPrimary=null;Zx.length=0}var ap=ki.ReactCurrentDispatcher,Gx=ki.ReactCurrentBatchConfig,El=0,kn=null,Vn=null,Jn=null,Kp=!1,Xu=!1,Ch=0,yL=0;function xs(){throw Error(Pe(321))}function kb(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!oa(t[n],e[n]))return!1;return!0}function Cb(t,e,n,r,a,i){if(El=i,kn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ap.current=t===null||t.memoizedState===null?jL:NL,t=n(r,a),Xu){i=0;do{if(Xu=!1,Ch=0,25<=i)throw Error(Pe(301));i+=1,Jn=Vn=null,e.updateQueue=null,ap.current=SL,t=n(r,a)}while(Xu)}if(ap.current=Zp,e=Vn!==null&&Vn.next!==null,El=0,Jn=Vn=kn=null,Kp=!1,e)throw Error(Pe(300));return t}function Eb(){var t=Ch!==0;return Ch=0,t}function ja(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?kn.memoizedState=Jn=t:Jn=Jn.next=t,Jn}function Or(){if(Vn===null){var t=kn.alternate;t=t!==null?t.memoizedState:null}else t=Vn.next;var e=Jn===null?kn.memoizedState:Jn.next;if(e!==null)Jn=e,Vn=t;else{if(t===null)throw Error(Pe(310));Vn=t,t={memoizedState:Vn.memoizedState,baseState:Vn.baseState,baseQueue:Vn.baseQueue,queue:Vn.queue,next:null},Jn===null?kn.memoizedState=Jn=t:Jn=Jn.next=t}return Jn}function Eh(t,e){return typeof e=="function"?e(t):e}function Qx(t){var e=Or(),n=e.queue;if(n===null)throw Error(Pe(311));n.lastRenderedReducer=t;var r=Vn,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var c=o=null,d=null,u=i;do{var m=u.lane;if((El&m)===m)d!==null&&(d=d.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:m,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};d===null?(c=d=f,o=r):d=d.next=f,kn.lanes|=m,Al|=m}u=u.next}while(u!==null&&u!==i);d===null?o=r:d.next=c,oa(r,e.memoizedState)||(Zs=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=d,n.lastRenderedState=r}if(t=n.interleaved,t!==null){a=t;do i=a.lane,kn.lanes|=i,Al|=i,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Yx(t){var e=Or(),n=e.queue;if(n===null)throw Error(Pe(311));n.lastRenderedReducer=t;var r=n.dispatch,a=n.pending,i=e.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do i=t(i,o.action),o=o.next;while(o!==a);oa(i,e.memoizedState)||(Zs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function O4(){}function L4(t,e){var n=kn,r=Or(),a=e(),i=!oa(r.memoizedState,a);if(i&&(r.memoizedState=a,Zs=!0),r=r.queue,Ab(z4.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Jn!==null&&Jn.memoizedState.tag&1){if(n.flags|=2048,Ah(9,B4.bind(null,n,r,a,e),void 0,null),ts===null)throw Error(Pe(349));El&30||F4(n,e,a)}return a}function F4(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=kn.updateQueue,e===null?(e={lastEffect:null,stores:null},kn.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function B4(t,e,n,r){e.value=n,e.getSnapshot=r,$4(e)&&U4(t)}function z4(t,e,n){return n(function(){$4(e)&&U4(t)})}function $4(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!oa(t,n)}catch{return!0}}function U4(t){var e=yi(t,1);e!==null&&na(e,t,1,-1)}function D2(t){var e=ja();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eh,lastRenderedState:t},e.queue=t,t=t.dispatch=bL.bind(null,kn,t),[e.memoizedState,t]}function Ah(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=kn.updateQueue,e===null?(e={lastEffect:null,stores:null},kn.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function q4(){return Or().memoizedState}function ip(t,e,n,r){var a=ja();kn.flags|=t,a.memoizedState=Ah(1|e,n,void 0,r===void 0?null:r)}function K0(t,e,n,r){var a=Or();r=r===void 0?null:r;var i=void 0;if(Vn!==null){var o=Vn.memoizedState;if(i=o.destroy,r!==null&&kb(r,o.deps)){a.memoizedState=Ah(e,n,i,r);return}}kn.flags|=t,a.memoizedState=Ah(1|e,n,i,r)}function T2(t,e){return ip(8390656,8,t,e)}function Ab(t,e){return K0(2048,8,t,e)}function W4(t,e){return K0(4,2,t,e)}function H4(t,e){return K0(4,4,t,e)}function V4(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function K4(t,e,n){return n=n!=null?n.concat([t]):null,K0(4,4,V4.bind(null,e,t),n)}function Pb(){}function Z4(t,e){var n=Or();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&kb(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function G4(t,e){var n=Or();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&kb(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Q4(t,e,n){return El&21?(oa(n,e)||(n=t4(),kn.lanes|=n,Al|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Zs=!0),t.memoizedState=n)}function _L(t,e){var n=on;on=n!==0&&4>n?n:4,t(!0);var r=Gx.transition;Gx.transition={};try{t(!1),e()}finally{on=n,Gx.transition=r}}function Y4(){return Or().memoizedState}function wL(t,e,n){var r=wo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},X4(t))J4(e,n);else if(n=M4(t,e,n,r),n!==null){var a=Ms();na(n,t,r,a),eA(n,e,r)}}function bL(t,e,n){var r=wo(t),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(X4(t))J4(e,a);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(a.hasEagerState=!0,a.eagerState=c,oa(c,o)){var d=e.interleaved;d===null?(a.next=a,wb(e)):(a.next=d.next,d.next=a),e.interleaved=a;return}}catch{}finally{}n=M4(t,e,a,r),n!==null&&(a=Ms(),na(n,t,r,a),eA(n,e,r))}}function X4(t){var e=t.alternate;return t===kn||e!==null&&e===kn}function J4(t,e){Xu=Kp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function eA(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ob(t,n)}}var Zp={readContext:Ir,useCallback:xs,useContext:xs,useEffect:xs,useImperativeHandle:xs,useInsertionEffect:xs,useLayoutEffect:xs,useMemo:xs,useReducer:xs,useRef:xs,useState:xs,useDebugValue:xs,useDeferredValue:xs,useTransition:xs,useMutableSource:xs,useSyncExternalStore:xs,useId:xs,unstable_isNewReconciler:!1},jL={readContext:Ir,useCallback:function(t,e){return ja().memoizedState=[t,e===void 0?null:e],t},useContext:Ir,useEffect:T2,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ip(4194308,4,V4.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ip(4194308,4,t,e)},useInsertionEffect:function(t,e){return ip(4,2,t,e)},useMemo:function(t,e){var n=ja();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ja();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=wL.bind(null,kn,t),[r.memoizedState,t]},useRef:function(t){var e=ja();return t={current:t},e.memoizedState=t},useState:D2,useDebugValue:Pb,useDeferredValue:function(t){return ja().memoizedState=t},useTransition:function(){var t=D2(!1),e=t[0];return t=_L.bind(null,t[1]),ja().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=kn,a=ja();if(yn){if(n===void 0)throw Error(Pe(407));n=n()}else{if(n=e(),ts===null)throw Error(Pe(349));El&30||F4(r,e,n)}a.memoizedState=n;var i={value:n,getSnapshot:e};return a.queue=i,T2(z4.bind(null,r,i,t),[t]),r.flags|=2048,Ah(9,B4.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=ja(),e=ts.identifierPrefix;if(yn){var n=fi,r=hi;n=(r&~(1<<32-ta(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ch++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=yL++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},NL={readContext:Ir,useCallback:Z4,useContext:Ir,useEffect:Ab,useImperativeHandle:K4,useInsertionEffect:W4,useLayoutEffect:H4,useMemo:G4,useReducer:Qx,useRef:q4,useState:function(){return Qx(Eh)},useDebugValue:Pb,useDeferredValue:function(t){var e=Or();return Q4(e,Vn.memoizedState,t)},useTransition:function(){var t=Qx(Eh)[0],e=Or().memoizedState;return[t,e]},useMutableSource:O4,useSyncExternalStore:L4,useId:Y4,unstable_isNewReconciler:!1},SL={readContext:Ir,useCallback:Z4,useContext:Ir,useEffect:Ab,useImperativeHandle:K4,useInsertionEffect:W4,useLayoutEffect:H4,useMemo:G4,useReducer:Yx,useRef:q4,useState:function(){return Yx(Eh)},useDebugValue:Pb,useDeferredValue:function(t){var e=Or();return Vn===null?e.memoizedState=t:Q4(e,Vn.memoizedState,t)},useTransition:function(){var t=Yx(Eh)[0],e=Or().memoizedState;return[t,e]},useMutableSource:O4,useSyncExternalStore:L4,useId:Y4,unstable_isNewReconciler:!1};function Hr(t,e){if(t&&t.defaultProps){e=Cn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function c_(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Cn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Z0={isMounted:function(t){return(t=t._reactInternals)?ql(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ms(),a=wo(t),i=pi(r,a);i.payload=e,n!=null&&(i.callback=n),e=yo(t,i,a),e!==null&&(na(e,t,a,r),rp(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ms(),a=wo(t),i=pi(r,a);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=yo(t,i,a),e!==null&&(na(e,t,a,r),rp(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ms(),r=wo(t),a=pi(n,r);a.tag=2,e!=null&&(a.callback=e),e=yo(t,a,r),e!==null&&(na(e,t,r,n),rp(e,t,r))}};function M2(t,e,n,r,a,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!wh(n,r)||!wh(a,i):!0}function tA(t,e,n){var r=!1,a=ko,i=e.contextType;return typeof i=="object"&&i!==null?i=Ir(i):(a=Qs(e)?kl:bs.current,r=e.contextTypes,i=(r=r!=null)?gd(t,a):ko),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Z0,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function R2(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Z0.enqueueReplaceState(e,e.state,null)}function d_(t,e,n,r){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},bb(t);var i=e.contextType;typeof i=="object"&&i!==null?a.context=Ir(i):(i=Qs(e)?kl:bs.current,a.context=gd(t,i)),a.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(c_(t,e,i,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&Z0.enqueueReplaceState(a,a.state,null),Hp(t,n,a,r),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function _d(t,e){try{var n="",r=e;do n+=J6(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:a,digest:null}}function Xx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function u_(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var kL=typeof WeakMap=="function"?WeakMap:Map;function nA(t,e,n){n=pi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Qp||(Qp=!0,w_=r),u_(t,e)},n}function sA(t,e,n){n=pi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var a=e.value;n.payload=function(){return r(a)},n.callback=function(){u_(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){u_(t,e),typeof r!="function"&&(_o===null?_o=new Set([this]):_o.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function I2(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new kL;var a=new Set;r.set(e,a)}else a=r.get(e),a===void 0&&(a=new Set,r.set(e,a));a.has(n)||(a.add(n),t=zL.bind(null,t,e,n),e.then(t,t))}function O2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function L2(t,e,n,r,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=pi(-1,1),e.tag=2,yo(n,e,1))),n.lanes|=1),t)}var CL=ki.ReactCurrentOwner,Zs=!1;function Ds(t,e,n,r){e.child=t===null?T4(e,null,n,r):vd(e,t.child,n,r)}function F2(t,e,n,r,a){n=n.render;var i=e.ref;return Kc(e,a),r=Cb(t,e,n,r,i,a),n=Eb(),t!==null&&!Zs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,_i(t,e,a)):(yn&&n&&pb(e),e.flags|=1,Ds(t,e,r,a),e.child)}function B2(t,e,n,r,a){if(t===null){var i=n.type;return typeof i=="function"&&!Fb(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,rA(t,e,i,r,a)):(t=dp(n.type,null,r,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&a)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:wh,n(o,r)&&t.ref===e.ref)return _i(t,e,a)}return e.flags|=1,t=bo(i,r),t.ref=e.ref,t.return=e,e.child=t}function rA(t,e,n,r,a){if(t!==null){var i=t.memoizedProps;if(wh(i,r)&&t.ref===e.ref)if(Zs=!1,e.pendingProps=r=i,(t.lanes&a)!==0)t.flags&131072&&(Zs=!0);else return e.lanes=t.lanes,_i(t,e,a)}return h_(t,e,n,r,a)}function aA(t,e,n){var r=e.pendingProps,a=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},fn(Bc,ar),ar|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,fn(Bc,ar),ar|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,fn(Bc,ar),ar|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,fn(Bc,ar),ar|=r;return Ds(t,e,a,n),e.child}function iA(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function h_(t,e,n,r,a){var i=Qs(n)?kl:bs.current;return i=gd(e,i),Kc(e,a),n=Cb(t,e,n,r,i,a),r=Eb(),t!==null&&!Zs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,_i(t,e,a)):(yn&&r&&pb(e),e.flags|=1,Ds(t,e,n,a),e.child)}function z2(t,e,n,r,a){if(Qs(n)){var i=!0;zp(e)}else i=!1;if(Kc(e,a),e.stateNode===null)op(t,e),tA(e,n,r),d_(e,n,r,a),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var d=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ir(u):(u=Qs(n)?kl:bs.current,u=gd(e,u));var m=n.getDerivedStateFromProps,f=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||d!==u)&&R2(e,o,r,u),Ki=!1;var p=e.memoizedState;o.state=p,Hp(e,r,o,a),d=e.memoizedState,c!==r||p!==d||Gs.current||Ki?(typeof m=="function"&&(c_(e,n,m,r),d=e.memoizedState),(c=Ki||M2(e,n,c,r,p,d,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=d),o.props=r,o.state=d,o.context=u,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,R4(t,e),c=e.memoizedProps,u=e.type===e.elementType?c:Hr(e.type,c),o.props=u,f=e.pendingProps,p=o.context,d=n.contextType,typeof d=="object"&&d!==null?d=Ir(d):(d=Qs(n)?kl:bs.current,d=gd(e,d));var x=n.getDerivedStateFromProps;(m=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==f||p!==d)&&R2(e,o,r,d),Ki=!1,p=e.memoizedState,o.state=p,Hp(e,r,o,a);var j=e.memoizedState;c!==f||p!==j||Gs.current||Ki?(typeof x=="function"&&(c_(e,n,x,r),j=e.memoizedState),(u=Ki||M2(e,n,u,r,p,j,d)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,j,d),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,j,d)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=j),o.props=r,o.state=j,o.context=d,r=u):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return f_(t,e,n,r,i,a)}function f_(t,e,n,r,a,i){iA(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return a&&S2(e,n,!1),_i(t,e,i);r=e.stateNode,CL.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=vd(e,t.child,null,i),e.child=vd(e,null,c,i)):Ds(t,e,c,i),e.memoizedState=r.state,a&&S2(e,n,!0),e.child}function oA(t){var e=t.stateNode;e.pendingContext?N2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&N2(t,e.context,!1),jb(t,e.containerInfo)}function $2(t,e,n,r,a){return xd(),xb(a),e.flags|=256,Ds(t,e,n,r),e.child}var m_={dehydrated:null,treeContext:null,retryLane:0};function p_(t){return{baseLanes:t,cachePool:null,transitions:null}}function lA(t,e,n){var r=e.pendingProps,a=Sn.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(a&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),fn(Sn,a&1),t===null)return o_(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Y0(o,r,0,null),t=bl(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=p_(n),e.memoizedState=m_,t):Db(e,o));if(a=t.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return EL(t,e,o,r,c,a,n);if(i){i=r.fallback,o=e.mode,a=t.child,c=a.sibling;var d={mode:"hidden",children:r.children};return!(o&1)&&e.child!==a?(r=e.child,r.childLanes=0,r.pendingProps=d,e.deletions=null):(r=bo(a,d),r.subtreeFlags=a.subtreeFlags&14680064),c!==null?i=bo(c,i):(i=bl(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?p_(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=m_,r}return i=t.child,t=i.sibling,r=bo(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Db(t,e){return e=Y0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ym(t,e,n,r){return r!==null&&xb(r),vd(e,t.child,null,n),t=Db(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function EL(t,e,n,r,a,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Xx(Error(Pe(422))),ym(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,a=e.mode,r=Y0({mode:"visible",children:r.children},a,0,null),i=bl(i,a,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&vd(e,t.child,null,o),e.child.memoizedState=p_(o),e.memoizedState=m_,i);if(!(e.mode&1))return ym(t,e,o,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(Pe(419)),r=Xx(i,r,void 0),ym(t,e,o,r)}if(c=(o&t.childLanes)!==0,Zs||c){if(r=ts,r!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,yi(t,a),na(r,t,a,-1))}return Lb(),r=Xx(Error(Pe(421))),ym(t,e,o,r)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=$L.bind(null,t),a._reactRetry=e,null):(t=i.treeContext,or=vo(a.nextSibling),cr=e,yn=!0,Qr=null,t!==null&&(Er[Ar++]=hi,Er[Ar++]=fi,Er[Ar++]=Cl,hi=t.id,fi=t.overflow,Cl=e),e=Db(e,r.children),e.flags|=4096,e)}function U2(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),l_(t.return,e,n)}function Jx(t,e,n,r,a){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function cA(t,e,n){var r=e.pendingProps,a=r.revealOrder,i=r.tail;if(Ds(t,e,r.children,n),r=Sn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&U2(t,n,e);else if(t.tag===19)U2(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(fn(Sn,r),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&Vp(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),Jx(e,!1,a,n,i);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&Vp(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}Jx(e,!0,n,null,i);break;case"together":Jx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function op(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function _i(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Al|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Pe(153));if(e.child!==null){for(t=e.child,n=bo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=bo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function AL(t,e,n){switch(e.tag){case 3:oA(e),xd();break;case 5:I4(e);break;case 1:Qs(e.type)&&zp(e);break;case 4:jb(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,a=e.memoizedProps.value;fn(qp,r._currentValue),r._currentValue=a;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(fn(Sn,Sn.current&1),e.flags|=128,null):n&e.child.childLanes?lA(t,e,n):(fn(Sn,Sn.current&1),t=_i(t,e,n),t!==null?t.sibling:null);fn(Sn,Sn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return cA(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),fn(Sn,Sn.current),r)break;return null;case 22:case 23:return e.lanes=0,aA(t,e,n)}return _i(t,e,n)}var dA,g_,uA,hA;dA=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};g_=function(){};uA=function(t,e,n,r){var a=t.memoizedProps;if(a!==r){t=e.stateNode,ul(La.current);var i=null;switch(n){case"input":a=Fy(t,a),r=Fy(t,r),i=[];break;case"select":a=Cn({},a,{value:void 0}),r=Cn({},r,{value:void 0}),i=[];break;case"textarea":a=$y(t,a),r=$y(t,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Fp)}qy(n,r);var o;n=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var c=a[u];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(mh.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var d=r[u];if(c=a!=null?a[u]:void 0,r.hasOwnProperty(u)&&d!==c&&(d!=null||c!=null))if(u==="style")if(c){for(o in c)!c.hasOwnProperty(o)||d&&d.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in d)d.hasOwnProperty(o)&&c[o]!==d[o]&&(n||(n={}),n[o]=d[o])}else n||(i||(i=[]),i.push(u,n)),n=d;else u==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,c=c?c.__html:void 0,d!=null&&c!==d&&(i=i||[]).push(u,d)):u==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(u,""+d):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(mh.hasOwnProperty(u)?(d!=null&&u==="onScroll"&&xn("scroll",t),i||c===d||(i=[])):(i=i||[]).push(u,d))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};hA=function(t,e,n,r){n!==r&&(e.flags|=4)};function vu(t,e){if(!yn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function vs(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function PL(t,e,n){var r=e.pendingProps;switch(gb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vs(e),null;case 1:return Qs(e.type)&&Bp(),vs(e),null;case 3:return r=e.stateNode,yd(),vn(Gs),vn(bs),Sb(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(xm(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Qr!==null&&(N_(Qr),Qr=null))),g_(t,e),vs(e),null;case 5:Nb(e);var a=ul(kh.current);if(n=e.type,t!==null&&e.stateNode!=null)uA(t,e,n,r,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Pe(166));return vs(e),null}if(t=ul(La.current),xm(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Pa]=e,r[Nh]=i,t=(e.mode&1)!==0,n){case"dialog":xn("cancel",r),xn("close",r);break;case"iframe":case"object":case"embed":xn("load",r);break;case"video":case"audio":for(a=0;a<Au.length;a++)xn(Au[a],r);break;case"source":xn("error",r);break;case"img":case"image":case"link":xn("error",r),xn("load",r);break;case"details":xn("toggle",r);break;case"input":YN(r,i),xn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},xn("invalid",r);break;case"textarea":JN(r,i),xn("invalid",r)}qy(n,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&gm(r.textContent,c,t),a=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&gm(r.textContent,c,t),a=["children",""+c]):mh.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&xn("scroll",r)}switch(n){case"input":lm(r),XN(r,i,!0);break;case"textarea":lm(r),e2(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Fp)}r=a,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=zE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Pa]=e,t[Nh]=r,dA(t,e,!1,!1),e.stateNode=t;e:{switch(o=Wy(n,r),n){case"dialog":xn("cancel",t),xn("close",t),a=r;break;case"iframe":case"object":case"embed":xn("load",t),a=r;break;case"video":case"audio":for(a=0;a<Au.length;a++)xn(Au[a],t);a=r;break;case"source":xn("error",t),a=r;break;case"img":case"image":case"link":xn("error",t),xn("load",t),a=r;break;case"details":xn("toggle",t),a=r;break;case"input":YN(t,r),a=Fy(t,r),xn("invalid",t);break;case"option":a=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},a=Cn({},r,{value:void 0}),xn("invalid",t);break;case"textarea":JN(t,r),a=$y(t,r),xn("invalid",t);break;default:a=r}qy(n,a),c=a;for(i in c)if(c.hasOwnProperty(i)){var d=c[i];i==="style"?qE(t,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&$E(t,d)):i==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&ph(t,d):typeof d=="number"&&ph(t,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(mh.hasOwnProperty(i)?d!=null&&i==="onScroll"&&xn("scroll",t):d!=null&&tb(t,i,d,o))}switch(n){case"input":lm(t),XN(t,r,!1);break;case"textarea":lm(t),e2(t);break;case"option":r.value!=null&&t.setAttribute("value",""+So(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?qc(t,!!r.multiple,i,!1):r.defaultValue!=null&&qc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Fp)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return vs(e),null;case 6:if(t&&e.stateNode!=null)hA(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Pe(166));if(n=ul(kh.current),ul(La.current),xm(e)){if(r=e.stateNode,n=e.memoizedProps,r[Pa]=e,(i=r.nodeValue!==n)&&(t=cr,t!==null))switch(t.tag){case 3:gm(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&gm(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Pa]=e,e.stateNode=r}return vs(e),null;case 13:if(vn(Sn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(yn&&or!==null&&e.mode&1&&!(e.flags&128))P4(),xd(),e.flags|=98560,i=!1;else if(i=xm(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Pe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Pe(317));i[Pa]=e}else xd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;vs(e),i=!1}else Qr!==null&&(N_(Qr),Qr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Sn.current&1?Zn===0&&(Zn=3):Lb())),e.updateQueue!==null&&(e.flags|=4),vs(e),null);case 4:return yd(),g_(t,e),t===null&&bh(e.stateNode.containerInfo),vs(e),null;case 10:return _b(e.type._context),vs(e),null;case 17:return Qs(e.type)&&Bp(),vs(e),null;case 19:if(vn(Sn),i=e.memoizedState,i===null)return vs(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)vu(i,!1);else{if(Zn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Vp(t),o!==null){for(e.flags|=128,vu(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return fn(Sn,Sn.current&1|2),e.child}t=t.sibling}i.tail!==null&&Dn()>wd&&(e.flags|=128,r=!0,vu(i,!1),e.lanes=4194304)}else{if(!r)if(t=Vp(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),vu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!yn)return vs(e),null}else 2*Dn()-i.renderingStartTime>wd&&n!==1073741824&&(e.flags|=128,r=!0,vu(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Dn(),e.sibling=null,n=Sn.current,fn(Sn,r?n&1|2:n&1),e):(vs(e),null);case 22:case 23:return Ob(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ar&1073741824&&(vs(e),e.subtreeFlags&6&&(e.flags|=8192)):vs(e),null;case 24:return null;case 25:return null}throw Error(Pe(156,e.tag))}function DL(t,e){switch(gb(e),e.tag){case 1:return Qs(e.type)&&Bp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return yd(),vn(Gs),vn(bs),Sb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Nb(e),null;case 13:if(vn(Sn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Pe(340));xd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return vn(Sn),null;case 4:return yd(),null;case 10:return _b(e.type._context),null;case 22:case 23:return Ob(),null;case 24:return null;default:return null}}var _m=!1,ws=!1,TL=typeof WeakSet=="function"?WeakSet:Set,Xe=null;function Fc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){An(t,e,r)}else n.current=null}function x_(t,e,n){try{n()}catch(r){An(t,e,r)}}var q2=!1;function ML(t,e){if(e_=Ip,t=x4(),mb(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,d=-1,u=0,m=0,f=t,p=null;t:for(;;){for(var x;f!==n||a!==0&&f.nodeType!==3||(c=o+a),f!==i||r!==0&&f.nodeType!==3||(d=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(x=f.firstChild)!==null;)p=f,f=x;for(;;){if(f===t)break t;if(p===n&&++u===a&&(c=o),p===i&&++m===r&&(d=o),(x=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=x}n=c===-1||d===-1?null:{start:c,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(t_={focusedElem:t,selectionRange:n},Ip=!1,Xe=e;Xe!==null;)if(e=Xe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Xe=t;else for(;Xe!==null;){e=Xe;try{var j=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var v=j.memoizedProps,_=j.memoizedState,b=e.stateNode,w=b.getSnapshotBeforeUpdate(e.elementType===e.type?v:Hr(e.type,v),_);b.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Pe(163))}}catch(S){An(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,Xe=t;break}Xe=e.return}return j=q2,q2=!1,j}function Ju(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,i!==void 0&&x_(e,n,i)}a=a.next}while(a!==r)}}function G0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function v_(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function fA(t){var e=t.alternate;e!==null&&(t.alternate=null,fA(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Pa],delete e[Nh],delete e[r_],delete e[pL],delete e[gL])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function mA(t){return t.tag===5||t.tag===3||t.tag===4}function W2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||mA(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function y_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Fp));else if(r!==4&&(t=t.child,t!==null))for(y_(t,e,n),t=t.sibling;t!==null;)y_(t,e,n),t=t.sibling}function __(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(__(t,e,n),t=t.sibling;t!==null;)__(t,e,n),t=t.sibling}var is=null,Zr=!1;function Ii(t,e,n){for(n=n.child;n!==null;)pA(t,e,n),n=n.sibling}function pA(t,e,n){if(Oa&&typeof Oa.onCommitFiberUnmount=="function")try{Oa.onCommitFiberUnmount($0,n)}catch{}switch(n.tag){case 5:ws||Fc(n,e);case 6:var r=is,a=Zr;is=null,Ii(t,e,n),is=r,Zr=a,is!==null&&(Zr?(t=is,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):is.removeChild(n.stateNode));break;case 18:is!==null&&(Zr?(t=is,n=n.stateNode,t.nodeType===8?Vx(t.parentNode,n):t.nodeType===1&&Vx(t,n),yh(t)):Vx(is,n.stateNode));break;case 4:r=is,a=Zr,is=n.stateNode.containerInfo,Zr=!0,Ii(t,e,n),is=r,Zr=a;break;case 0:case 11:case 14:case 15:if(!ws&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&x_(n,e,o),a=a.next}while(a!==r)}Ii(t,e,n);break;case 1:if(!ws&&(Fc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){An(n,e,c)}Ii(t,e,n);break;case 21:Ii(t,e,n);break;case 22:n.mode&1?(ws=(r=ws)||n.memoizedState!==null,Ii(t,e,n),ws=r):Ii(t,e,n);break;default:Ii(t,e,n)}}function H2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new TL),e.forEach(function(r){var a=UL.bind(null,t,r);n.has(r)||(n.add(r),r.then(a,a))})}}function Ur(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:is=c.stateNode,Zr=!1;break e;case 3:is=c.stateNode.containerInfo,Zr=!0;break e;case 4:is=c.stateNode.containerInfo,Zr=!0;break e}c=c.return}if(is===null)throw Error(Pe(160));pA(i,o,a),is=null,Zr=!1;var d=a.alternate;d!==null&&(d.return=null),a.return=null}catch(u){An(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gA(e,t),e=e.sibling}function gA(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ur(e,t),_a(t),r&4){try{Ju(3,t,t.return),G0(3,t)}catch(v){An(t,t.return,v)}try{Ju(5,t,t.return)}catch(v){An(t,t.return,v)}}break;case 1:Ur(e,t),_a(t),r&512&&n!==null&&Fc(n,n.return);break;case 5:if(Ur(e,t),_a(t),r&512&&n!==null&&Fc(n,n.return),t.flags&32){var a=t.stateNode;try{ph(a,"")}catch(v){An(t,t.return,v)}}if(r&4&&(a=t.stateNode,a!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&FE(a,i),Wy(c,o);var u=Wy(c,i);for(o=0;o<d.length;o+=2){var m=d[o],f=d[o+1];m==="style"?qE(a,f):m==="dangerouslySetInnerHTML"?$E(a,f):m==="children"?ph(a,f):tb(a,m,f,u)}switch(c){case"input":By(a,i);break;case"textarea":BE(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?qc(a,!!i.multiple,x,!1):p!==!!i.multiple&&(i.defaultValue!=null?qc(a,!!i.multiple,i.defaultValue,!0):qc(a,!!i.multiple,i.multiple?[]:"",!1))}a[Nh]=i}catch(v){An(t,t.return,v)}}break;case 6:if(Ur(e,t),_a(t),r&4){if(t.stateNode===null)throw Error(Pe(162));a=t.stateNode,i=t.memoizedProps;try{a.nodeValue=i}catch(v){An(t,t.return,v)}}break;case 3:if(Ur(e,t),_a(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{yh(e.containerInfo)}catch(v){An(t,t.return,v)}break;case 4:Ur(e,t),_a(t);break;case 13:Ur(e,t),_a(t),a=t.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Rb=Dn())),r&4&&H2(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(ws=(u=ws)||m,Ur(e,t),ws=u):Ur(e,t),_a(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!m&&t.mode&1)for(Xe=t,m=t.child;m!==null;){for(f=Xe=m;Xe!==null;){switch(p=Xe,x=p.child,p.tag){case 0:case 11:case 14:case 15:Ju(4,p,p.return);break;case 1:Fc(p,p.return);var j=p.stateNode;if(typeof j.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,j.props=e.memoizedProps,j.state=e.memoizedState,j.componentWillUnmount()}catch(v){An(r,n,v)}}break;case 5:Fc(p,p.return);break;case 22:if(p.memoizedState!==null){K2(f);continue}}x!==null?(x.return=p,Xe=x):K2(f)}m=m.sibling}e:for(m=null,f=t;;){if(f.tag===5){if(m===null){m=f;try{a=f.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=f.stateNode,d=f.memoizedProps.style,o=d!=null&&d.hasOwnProperty("display")?d.display:null,c.style.display=UE("display",o))}catch(v){An(t,t.return,v)}}}else if(f.tag===6){if(m===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){An(t,t.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;m===f&&(m=null),f=f.return}m===f&&(m=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ur(e,t),_a(t),r&4&&H2(t);break;case 21:break;default:Ur(e,t),_a(t)}}function _a(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(mA(n)){var r=n;break e}n=n.return}throw Error(Pe(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(ph(a,""),r.flags&=-33);var i=W2(t);__(t,i,a);break;case 3:case 4:var o=r.stateNode.containerInfo,c=W2(t);y_(t,c,o);break;default:throw Error(Pe(161))}}catch(d){An(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function RL(t,e,n){Xe=t,xA(t)}function xA(t,e,n){for(var r=(t.mode&1)!==0;Xe!==null;){var a=Xe,i=a.child;if(a.tag===22&&r){var o=a.memoizedState!==null||_m;if(!o){var c=a.alternate,d=c!==null&&c.memoizedState!==null||ws;c=_m;var u=ws;if(_m=o,(ws=d)&&!u)for(Xe=a;Xe!==null;)o=Xe,d=o.child,o.tag===22&&o.memoizedState!==null?Z2(a):d!==null?(d.return=o,Xe=d):Z2(a);for(;i!==null;)Xe=i,xA(i),i=i.sibling;Xe=a,_m=c,ws=u}V2(t)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Xe=i):V2(t)}}function V2(t){for(;Xe!==null;){var e=Xe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ws||G0(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ws)if(n===null)r.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:Hr(e.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&P2(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}P2(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var m=u.memoizedState;if(m!==null){var f=m.dehydrated;f!==null&&yh(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Pe(163))}ws||e.flags&512&&v_(e)}catch(p){An(e,e.return,p)}}if(e===t){Xe=null;break}if(n=e.sibling,n!==null){n.return=e.return,Xe=n;break}Xe=e.return}}function K2(t){for(;Xe!==null;){var e=Xe;if(e===t){Xe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Xe=n;break}Xe=e.return}}function Z2(t){for(;Xe!==null;){var e=Xe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{G0(4,e)}catch(d){An(e,n,d)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var a=e.return;try{r.componentDidMount()}catch(d){An(e,a,d)}}var i=e.return;try{v_(e)}catch(d){An(e,i,d)}break;case 5:var o=e.return;try{v_(e)}catch(d){An(e,o,d)}}}catch(d){An(e,e.return,d)}if(e===t){Xe=null;break}var c=e.sibling;if(c!==null){c.return=e.return,Xe=c;break}Xe=e.return}}var IL=Math.ceil,Gp=ki.ReactCurrentDispatcher,Tb=ki.ReactCurrentOwner,Tr=ki.ReactCurrentBatchConfig,Yt=0,ts=null,On=null,fs=0,ar=0,Bc=Fo(0),Zn=0,Ph=null,Al=0,Q0=0,Mb=0,eh=null,Vs=null,Rb=0,wd=1/0,li=null,Qp=!1,w_=null,_o=null,wm=!1,uo=null,Yp=0,th=0,b_=null,lp=-1,cp=0;function Ms(){return Yt&6?Dn():lp!==-1?lp:lp=Dn()}function wo(t){return t.mode&1?Yt&2&&fs!==0?fs&-fs:vL.transition!==null?(cp===0&&(cp=t4()),cp):(t=on,t!==0||(t=window.event,t=t===void 0?16:l4(t.type)),t):1}function na(t,e,n,r){if(50<th)throw th=0,b_=null,Error(Pe(185));uf(t,n,r),(!(Yt&2)||t!==ts)&&(t===ts&&(!(Yt&2)&&(Q0|=n),Zn===4&&Yi(t,fs)),Ys(t,r),n===1&&Yt===0&&!(e.mode&1)&&(wd=Dn()+500,V0&&Bo()))}function Ys(t,e){var n=t.callbackNode;v8(t,e);var r=Rp(t,t===ts?fs:0);if(r===0)n!==null&&s2(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&s2(n),e===1)t.tag===0?xL(G2.bind(null,t)):C4(G2.bind(null,t)),fL(function(){!(Yt&6)&&Bo()}),n=null;else{switch(n4(r)){case 1:n=ib;break;case 4:n=JE;break;case 16:n=Mp;break;case 536870912:n=e4;break;default:n=Mp}n=SA(n,vA.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function vA(t,e){if(lp=-1,cp=0,Yt&6)throw Error(Pe(327));var n=t.callbackNode;if(Zc()&&t.callbackNode!==n)return null;var r=Rp(t,t===ts?fs:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Xp(t,r);else{e=r;var a=Yt;Yt|=2;var i=_A();(ts!==t||fs!==e)&&(li=null,wd=Dn()+500,wl(t,e));do try{FL();break}catch(c){yA(t,c)}while(!0);yb(),Gp.current=i,Yt=a,On!==null?e=0:(ts=null,fs=0,e=Zn)}if(e!==0){if(e===2&&(a=Gy(t),a!==0&&(r=a,e=j_(t,a))),e===1)throw n=Ph,wl(t,0),Yi(t,r),Ys(t,Dn()),n;if(e===6)Yi(t,r);else{if(a=t.current.alternate,!(r&30)&&!OL(a)&&(e=Xp(t,r),e===2&&(i=Gy(t),i!==0&&(r=i,e=j_(t,i))),e===1))throw n=Ph,wl(t,0),Yi(t,r),Ys(t,Dn()),n;switch(t.finishedWork=a,t.finishedLanes=r,e){case 0:case 1:throw Error(Pe(345));case 2:el(t,Vs,li);break;case 3:if(Yi(t,r),(r&130023424)===r&&(e=Rb+500-Dn(),10<e)){if(Rp(t,0)!==0)break;if(a=t.suspendedLanes,(a&r)!==r){Ms(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=s_(el.bind(null,t,Vs,li),e);break}el(t,Vs,li);break;case 4:if(Yi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,a=-1;0<r;){var o=31-ta(r);i=1<<o,o=e[o],o>a&&(a=o),r&=~i}if(r=a,r=Dn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*IL(r/1960))-r,10<r){t.timeoutHandle=s_(el.bind(null,t,Vs,li),r);break}el(t,Vs,li);break;case 5:el(t,Vs,li);break;default:throw Error(Pe(329))}}}return Ys(t,Dn()),t.callbackNode===n?vA.bind(null,t):null}function j_(t,e){var n=eh;return t.current.memoizedState.isDehydrated&&(wl(t,e).flags|=256),t=Xp(t,e),t!==2&&(e=Vs,Vs=n,e!==null&&N_(e)),t}function N_(t){Vs===null?Vs=t:Vs.push.apply(Vs,t)}function OL(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!oa(i(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Yi(t,e){for(e&=~Mb,e&=~Q0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ta(e),r=1<<n;t[n]=-1,e&=~r}}function G2(t){if(Yt&6)throw Error(Pe(327));Zc();var e=Rp(t,0);if(!(e&1))return Ys(t,Dn()),null;var n=Xp(t,e);if(t.tag!==0&&n===2){var r=Gy(t);r!==0&&(e=r,n=j_(t,r))}if(n===1)throw n=Ph,wl(t,0),Yi(t,e),Ys(t,Dn()),n;if(n===6)throw Error(Pe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,el(t,Vs,li),Ys(t,Dn()),null}function Ib(t,e){var n=Yt;Yt|=1;try{return t(e)}finally{Yt=n,Yt===0&&(wd=Dn()+500,V0&&Bo())}}function Pl(t){uo!==null&&uo.tag===0&&!(Yt&6)&&Zc();var e=Yt;Yt|=1;var n=Tr.transition,r=on;try{if(Tr.transition=null,on=1,t)return t()}finally{on=r,Tr.transition=n,Yt=e,!(Yt&6)&&Bo()}}function Ob(){ar=Bc.current,vn(Bc)}function wl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,hL(n)),On!==null)for(n=On.return;n!==null;){var r=n;switch(gb(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Bp();break;case 3:yd(),vn(Gs),vn(bs),Sb();break;case 5:Nb(r);break;case 4:yd();break;case 13:vn(Sn);break;case 19:vn(Sn);break;case 10:_b(r.type._context);break;case 22:case 23:Ob()}n=n.return}if(ts=t,On=t=bo(t.current,null),fs=ar=e,Zn=0,Ph=null,Mb=Q0=Al=0,Vs=eh=null,dl!==null){for(e=0;e<dl.length;e++)if(n=dl[e],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=a,r.next=o}n.pending=r}dl=null}return t}function yA(t,e){do{var n=On;try{if(yb(),ap.current=Zp,Kp){for(var r=kn.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Kp=!1}if(El=0,Jn=Vn=kn=null,Xu=!1,Ch=0,Tb.current=null,n===null||n.return===null){Zn=1,Ph=e,On=null;break}e:{var i=t,o=n.return,c=n,d=e;if(e=fs,c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var u=d,m=c,f=m.tag;if(!(m.mode&1)&&(f===0||f===11||f===15)){var p=m.alternate;p?(m.updateQueue=p.updateQueue,m.memoizedState=p.memoizedState,m.lanes=p.lanes):(m.updateQueue=null,m.memoizedState=null)}var x=O2(o);if(x!==null){x.flags&=-257,L2(x,o,c,i,e),x.mode&1&&I2(i,u,e),e=x,d=u;var j=e.updateQueue;if(j===null){var v=new Set;v.add(d),e.updateQueue=v}else j.add(d);break e}else{if(!(e&1)){I2(i,u,e),Lb();break e}d=Error(Pe(426))}}else if(yn&&c.mode&1){var _=O2(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),L2(_,o,c,i,e),xb(_d(d,c));break e}}i=d=_d(d,c),Zn!==4&&(Zn=2),eh===null?eh=[i]:eh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=nA(i,d,e);A2(i,b);break e;case 1:c=d;var w=i.type,N=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(_o===null||!_o.has(N)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=sA(i,c,e);A2(i,S);break e}}i=i.return}while(i!==null)}bA(n)}catch(C){e=C,On===n&&n!==null&&(On=n=n.return);continue}break}while(!0)}function _A(){var t=Gp.current;return Gp.current=Zp,t===null?Zp:t}function Lb(){(Zn===0||Zn===3||Zn===2)&&(Zn=4),ts===null||!(Al&268435455)&&!(Q0&268435455)||Yi(ts,fs)}function Xp(t,e){var n=Yt;Yt|=2;var r=_A();(ts!==t||fs!==e)&&(li=null,wl(t,e));do try{LL();break}catch(a){yA(t,a)}while(!0);if(yb(),Yt=n,Gp.current=r,On!==null)throw Error(Pe(261));return ts=null,fs=0,Zn}function LL(){for(;On!==null;)wA(On)}function FL(){for(;On!==null&&!c8();)wA(On)}function wA(t){var e=NA(t.alternate,t,ar);t.memoizedProps=t.pendingProps,e===null?bA(t):On=e,Tb.current=null}function bA(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=DL(n,e),n!==null){n.flags&=32767,On=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Zn=6,On=null;return}}else if(n=PL(n,e,ar),n!==null){On=n;return}if(e=e.sibling,e!==null){On=e;return}On=e=t}while(e!==null);Zn===0&&(Zn=5)}function el(t,e,n){var r=on,a=Tr.transition;try{Tr.transition=null,on=1,BL(t,e,n,r)}finally{Tr.transition=a,on=r}return null}function BL(t,e,n,r){do Zc();while(uo!==null);if(Yt&6)throw Error(Pe(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Pe(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(y8(t,i),t===ts&&(On=ts=null,fs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||wm||(wm=!0,SA(Mp,function(){return Zc(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Tr.transition,Tr.transition=null;var o=on;on=1;var c=Yt;Yt|=4,Tb.current=null,ML(t,n),gA(n,t),aL(t_),Ip=!!e_,t_=e_=null,t.current=n,RL(n),d8(),Yt=c,on=o,Tr.transition=i}else t.current=n;if(wm&&(wm=!1,uo=t,Yp=a),i=t.pendingLanes,i===0&&(_o=null),f8(n.stateNode),Ys(t,Dn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Qp)throw Qp=!1,t=w_,w_=null,t;return Yp&1&&t.tag!==0&&Zc(),i=t.pendingLanes,i&1?t===b_?th++:(th=0,b_=t):th=0,Bo(),null}function Zc(){if(uo!==null){var t=n4(Yp),e=Tr.transition,n=on;try{if(Tr.transition=null,on=16>t?16:t,uo===null)var r=!1;else{if(t=uo,uo=null,Yp=0,Yt&6)throw Error(Pe(331));var a=Yt;for(Yt|=4,Xe=t.current;Xe!==null;){var i=Xe,o=i.child;if(Xe.flags&16){var c=i.deletions;if(c!==null){for(var d=0;d<c.length;d++){var u=c[d];for(Xe=u;Xe!==null;){var m=Xe;switch(m.tag){case 0:case 11:case 15:Ju(8,m,i)}var f=m.child;if(f!==null)f.return=m,Xe=f;else for(;Xe!==null;){m=Xe;var p=m.sibling,x=m.return;if(fA(m),m===u){Xe=null;break}if(p!==null){p.return=x,Xe=p;break}Xe=x}}}var j=i.alternate;if(j!==null){var v=j.child;if(v!==null){j.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}Xe=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Xe=o;else e:for(;Xe!==null;){if(i=Xe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ju(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,Xe=b;break e}Xe=i.return}}var w=t.current;for(Xe=w;Xe!==null;){o=Xe;var N=o.child;if(o.subtreeFlags&2064&&N!==null)N.return=o,Xe=N;else e:for(o=w;Xe!==null;){if(c=Xe,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:G0(9,c)}}catch(C){An(c,c.return,C)}if(c===o){Xe=null;break e}var S=c.sibling;if(S!==null){S.return=c.return,Xe=S;break e}Xe=c.return}}if(Yt=a,Bo(),Oa&&typeof Oa.onPostCommitFiberRoot=="function")try{Oa.onPostCommitFiberRoot($0,t)}catch{}r=!0}return r}finally{on=n,Tr.transition=e}}return!1}function Q2(t,e,n){e=_d(n,e),e=nA(t,e,1),t=yo(t,e,1),e=Ms(),t!==null&&(uf(t,1,e),Ys(t,e))}function An(t,e,n){if(t.tag===3)Q2(t,t,n);else for(;e!==null;){if(e.tag===3){Q2(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(_o===null||!_o.has(r))){t=_d(n,t),t=sA(e,t,1),e=yo(e,t,1),t=Ms(),e!==null&&(uf(e,1,t),Ys(e,t));break}}e=e.return}}function zL(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ms(),t.pingedLanes|=t.suspendedLanes&n,ts===t&&(fs&n)===n&&(Zn===4||Zn===3&&(fs&130023424)===fs&&500>Dn()-Rb?wl(t,0):Mb|=n),Ys(t,e)}function jA(t,e){e===0&&(t.mode&1?(e=um,um<<=1,!(um&130023424)&&(um=4194304)):e=1);var n=Ms();t=yi(t,e),t!==null&&(uf(t,e,n),Ys(t,n))}function $L(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),jA(t,n)}function UL(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Pe(314))}r!==null&&r.delete(e),jA(t,n)}var NA;NA=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Gs.current)Zs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Zs=!1,AL(t,e,n);Zs=!!(t.flags&131072)}else Zs=!1,yn&&e.flags&1048576&&E4(e,Up,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;op(t,e),t=e.pendingProps;var a=gd(e,bs.current);Kc(e,n),a=Cb(null,e,r,t,a,n);var i=Eb();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Qs(r)?(i=!0,zp(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,bb(e),a.updater=Z0,e.stateNode=a,a._reactInternals=e,d_(e,r,t,n),e=f_(null,e,r,!0,i,n)):(e.tag=0,yn&&i&&pb(e),Ds(null,e,a,n),e=e.child),e;case 16:r=e.elementType;e:{switch(op(t,e),t=e.pendingProps,a=r._init,r=a(r._payload),e.type=r,a=e.tag=WL(r),t=Hr(r,t),a){case 0:e=h_(null,e,r,t,n);break e;case 1:e=z2(null,e,r,t,n);break e;case 11:e=F2(null,e,r,t,n);break e;case 14:e=B2(null,e,r,Hr(r.type,t),n);break e}throw Error(Pe(306,r,""))}return e;case 0:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Hr(r,a),h_(t,e,r,a,n);case 1:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Hr(r,a),z2(t,e,r,a,n);case 3:e:{if(oA(e),t===null)throw Error(Pe(387));r=e.pendingProps,i=e.memoizedState,a=i.element,R4(t,e),Hp(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=_d(Error(Pe(423)),e),e=$2(t,e,r,n,a);break e}else if(r!==a){a=_d(Error(Pe(424)),e),e=$2(t,e,r,n,a);break e}else for(or=vo(e.stateNode.containerInfo.firstChild),cr=e,yn=!0,Qr=null,n=T4(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(xd(),r===a){e=_i(t,e,n);break e}Ds(t,e,r,n)}e=e.child}return e;case 5:return I4(e),t===null&&o_(e),r=e.type,a=e.pendingProps,i=t!==null?t.memoizedProps:null,o=a.children,n_(r,a)?o=null:i!==null&&n_(r,i)&&(e.flags|=32),iA(t,e),Ds(t,e,o,n),e.child;case 6:return t===null&&o_(e),null;case 13:return lA(t,e,n);case 4:return jb(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=vd(e,null,r,n):Ds(t,e,r,n),e.child;case 11:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Hr(r,a),F2(t,e,r,a,n);case 7:return Ds(t,e,e.pendingProps,n),e.child;case 8:return Ds(t,e,e.pendingProps.children,n),e.child;case 12:return Ds(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,a=e.pendingProps,i=e.memoizedProps,o=a.value,fn(qp,r._currentValue),r._currentValue=o,i!==null)if(oa(i.value,o)){if(i.children===a.children&&!Gs.current){e=_i(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var d=c.firstContext;d!==null;){if(d.context===r){if(i.tag===1){d=pi(-1,n&-n),d.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var m=u.pending;m===null?d.next=d:(d.next=m.next,m.next=d),u.pending=d}}i.lanes|=n,d=i.alternate,d!==null&&(d.lanes|=n),l_(i.return,n,e),c.lanes|=n;break}d=d.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Pe(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),l_(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ds(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,r=e.pendingProps.children,Kc(e,n),a=Ir(a),r=r(a),e.flags|=1,Ds(t,e,r,n),e.child;case 14:return r=e.type,a=Hr(r,e.pendingProps),a=Hr(r.type,a),B2(t,e,r,a,n);case 15:return rA(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Hr(r,a),op(t,e),e.tag=1,Qs(r)?(t=!0,zp(e)):t=!1,Kc(e,n),tA(e,r,a),d_(e,r,a,n),f_(null,e,r,!0,t,n);case 19:return cA(t,e,n);case 22:return aA(t,e,n)}throw Error(Pe(156,e.tag))};function SA(t,e){return XE(t,e)}function qL(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pr(t,e,n,r){return new qL(t,e,n,r)}function Fb(t){return t=t.prototype,!(!t||!t.isReactComponent)}function WL(t){if(typeof t=="function")return Fb(t)?1:0;if(t!=null){if(t=t.$$typeof,t===sb)return 11;if(t===rb)return 14}return 2}function bo(t,e){var n=t.alternate;return n===null?(n=Pr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function dp(t,e,n,r,a,i){var o=2;if(r=t,typeof t=="function")Fb(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ac:return bl(n.children,a,i,e);case nb:o=8,a|=8;break;case Ry:return t=Pr(12,n,e,a|2),t.elementType=Ry,t.lanes=i,t;case Iy:return t=Pr(13,n,e,a),t.elementType=Iy,t.lanes=i,t;case Oy:return t=Pr(19,n,e,a),t.elementType=Oy,t.lanes=i,t;case IE:return Y0(n,a,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ME:o=10;break e;case RE:o=9;break e;case sb:o=11;break e;case rb:o=14;break e;case Vi:o=16,r=null;break e}throw Error(Pe(130,t==null?t:typeof t,""))}return e=Pr(o,n,e,a),e.elementType=t,e.type=r,e.lanes=i,e}function bl(t,e,n,r){return t=Pr(7,t,r,e),t.lanes=n,t}function Y0(t,e,n,r){return t=Pr(22,t,r,e),t.elementType=IE,t.lanes=n,t.stateNode={isHidden:!1},t}function ev(t,e,n){return t=Pr(6,t,null,e),t.lanes=n,t}function tv(t,e,n){return e=Pr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function HL(t,e,n,r,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ix(0),this.expirationTimes=Ix(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ix(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bb(t,e,n,r,a,i,o,c,d){return t=new HL(t,e,n,c,d),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Pr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},bb(i),t}function VL(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ec,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function kA(t){if(!t)return ko;t=t._reactInternals;e:{if(ql(t)!==t||t.tag!==1)throw Error(Pe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Qs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Pe(171))}if(t.tag===1){var n=t.type;if(Qs(n))return k4(t,n,e)}return e}function CA(t,e,n,r,a,i,o,c,d){return t=Bb(n,r,!0,t,a,i,o,c,d),t.context=kA(null),n=t.current,r=Ms(),a=wo(n),i=pi(r,a),i.callback=e??null,yo(n,i,a),t.current.lanes=a,uf(t,a,r),Ys(t,r),t}function X0(t,e,n,r){var a=e.current,i=Ms(),o=wo(a);return n=kA(n),e.context===null?e.context=n:e.pendingContext=n,e=pi(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=yo(a,e,o),t!==null&&(na(t,a,o,i),rp(t,a,o)),o}function Jp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Y2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function zb(t,e){Y2(t,e),(t=t.alternate)&&Y2(t,e)}function KL(){return null}var EA=typeof reportError=="function"?reportError:function(t){console.error(t)};function $b(t){this._internalRoot=t}J0.prototype.render=$b.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Pe(409));X0(t,e,null,null)};J0.prototype.unmount=$b.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Pl(function(){X0(null,t,null,null)}),e[vi]=null}};function J0(t){this._internalRoot=t}J0.prototype.unstable_scheduleHydration=function(t){if(t){var e=a4();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Qi.length&&e!==0&&e<Qi[n].priority;n++);Qi.splice(n,0,t),n===0&&o4(t)}};function Ub(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function eg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function X2(){}function ZL(t,e,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var u=Jp(o);i.call(u)}}var o=CA(e,r,t,0,null,!1,!1,"",X2);return t._reactRootContainer=o,t[vi]=o.current,bh(t.nodeType===8?t.parentNode:t),Pl(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof r=="function"){var c=r;r=function(){var u=Jp(d);c.call(u)}}var d=Bb(t,0,!1,null,null,!1,!1,"",X2);return t._reactRootContainer=d,t[vi]=d.current,bh(t.nodeType===8?t.parentNode:t),Pl(function(){X0(e,d,n,r)}),d}function tg(t,e,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var c=a;a=function(){var d=Jp(o);c.call(d)}}X0(e,o,t,a)}else o=ZL(n,e,t,a,r);return Jp(o)}s4=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Eu(e.pendingLanes);n!==0&&(ob(e,n|1),Ys(e,Dn()),!(Yt&6)&&(wd=Dn()+500,Bo()))}break;case 13:Pl(function(){var r=yi(t,1);if(r!==null){var a=Ms();na(r,t,1,a)}}),zb(t,1)}};lb=function(t){if(t.tag===13){var e=yi(t,134217728);if(e!==null){var n=Ms();na(e,t,134217728,n)}zb(t,134217728)}};r4=function(t){if(t.tag===13){var e=wo(t),n=yi(t,e);if(n!==null){var r=Ms();na(n,t,e,r)}zb(t,e)}};a4=function(){return on};i4=function(t,e){var n=on;try{return on=t,e()}finally{on=n}};Vy=function(t,e,n){switch(e){case"input":if(By(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var a=H0(r);if(!a)throw Error(Pe(90));LE(r),By(r,a)}}}break;case"textarea":BE(t,n);break;case"select":e=n.value,e!=null&&qc(t,!!n.multiple,e,!1)}};VE=Ib;KE=Pl;var GL={usingClientEntryPoint:!1,Events:[ff,Mc,H0,WE,HE,Ib]},yu={findFiberByHostInstance:cl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QL={bundleType:yu.bundleType,version:yu.version,rendererPackageName:yu.rendererPackageName,rendererConfig:yu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ki.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=QE(t),t===null?null:t.stateNode},findFiberByHostInstance:yu.findFiberByHostInstance||KL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bm.isDisabled&&bm.supportsFiber)try{$0=bm.inject(QL),Oa=bm}catch{}}yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GL;yr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ub(e))throw Error(Pe(200));return VL(t,e,null,n)};yr.createRoot=function(t,e){if(!Ub(t))throw Error(Pe(299));var n=!1,r="",a=EA;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Bb(t,1,!1,null,null,n,!1,r,a),t[vi]=e.current,bh(t.nodeType===8?t.parentNode:t),new $b(e)};yr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Pe(188)):(t=Object.keys(t).join(","),Error(Pe(268,t)));return t=QE(e),t=t===null?null:t.stateNode,t};yr.flushSync=function(t){return Pl(t)};yr.hydrate=function(t,e,n){if(!eg(e))throw Error(Pe(200));return tg(null,t,e,!0,n)};yr.hydrateRoot=function(t,e,n){if(!Ub(t))throw Error(Pe(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",o=EA;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=CA(e,null,t,1,n??null,a,!1,i,o),t[vi]=e.current,bh(t),r)for(t=0;t<r.length;t++)n=r[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new J0(e)};yr.render=function(t,e,n){if(!eg(e))throw Error(Pe(200));return tg(null,t,e,!1,n)};yr.unmountComponentAtNode=function(t){if(!eg(t))throw Error(Pe(40));return t._reactRootContainer?(Pl(function(){tg(null,null,t,!1,function(){t._reactRootContainer=null,t[vi]=null})}),!0):!1};yr.unstable_batchedUpdates=Ib;yr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!eg(n))throw Error(Pe(200));if(t==null||t._reactInternals===void 0)throw Error(Pe(38));return tg(t,e,n,!1,r)};yr.version="18.3.1-next-f1338f8080-20240426";function AA(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(AA)}catch(t){console.error(t)}}AA(),AE.exports=yr;var Wl=AE.exports;const PA=pE(Wl);var DA,J2=Wl;DA=J2.createRoot,J2.hydrateRoot;const YL=1,XL=1e6;let nv=0;function JL(){return nv=(nv+1)%Number.MAX_SAFE_INTEGER,nv.toString()}const sv=new Map,eS=t=>{if(sv.has(t))return;const e=setTimeout(()=>{sv.delete(t),nh({type:"REMOVE_TOAST",toastId:t})},XL);sv.set(t,e)},eF=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,YL)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?eS(n):t.toasts.forEach(r=>{eS(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},up=[];let hp={toasts:[]};function nh(t){hp=eF(hp,t),up.forEach(e=>{e(hp)})}function Aa({...t}){const e=JL(),n=a=>nh({type:"UPDATE_TOAST",toast:{...a,id:e}}),r=()=>nh({type:"DISMISS_TOAST",toastId:e});return nh({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:a=>{a||r()}}}),{id:e,dismiss:r,update:n}}function Mt(){const[t,e]=g.useState(hp);return g.useEffect(()=>(up.push(e),()=>{const n=up.indexOf(e);n>-1&&up.splice(n,1)}),[t]),{...t,toast:Aa,dismiss:n=>nh({type:"DISMISS_TOAST",toastId:n})}}function Re(t,e,{checkForDefaultPrevented:n=!0}={}){return function(a){if(t==null||t(a),n===!1||!a.defaultPrevented)return e==null?void 0:e(a)}}function tF(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function ng(...t){return e=>t.forEach(n=>tF(n,e))}function Tt(...t){return g.useCallback(ng(...t),t)}function nF(t,e=[]){let n=[];function r(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:x,...j}=f,v=(p==null?void 0:p[t][d])||c,_=g.useMemo(()=>j,Object.values(j));return s.jsx(v.Provider,{value:_,children:x})}function m(f,p){const x=(p==null?void 0:p[t][d])||c,j=g.useContext(x);if(j)return j;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[r,sF(a,...e)]}function sF(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=r.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var wi=g.forwardRef((t,e)=>{const{children:n,...r}=t,a=g.Children.toArray(n),i=a.find(rF);if(i){const o=i.props.children,c=a.map(d=>d===i?g.Children.count(o)>1?g.Children.only(null):g.isValidElement(o)?o.props.children:null:d);return s.jsx(S_,{...r,ref:e,children:g.isValidElement(o)?g.cloneElement(o,void 0,c):null})}return s.jsx(S_,{...r,ref:e,children:n})});wi.displayName="Slot";var S_=g.forwardRef((t,e)=>{const{children:n,...r}=t;if(g.isValidElement(n)){const a=iF(n);return g.cloneElement(n,{...aF(r,n.props),ref:e?ng(e,a):a})}return g.Children.count(n)>1?g.Children.only(null):null});S_.displayName="SlotClone";var TA=({children:t})=>s.jsx(s.Fragment,{children:t});function rF(t){return g.isValidElement(t)&&t.type===TA}function aF(t,e){const n={...e};for(const r in e){const a=t[r],i=e[r];/^on[A-Z]/.test(r)?a&&i?n[r]=(...c)=>{i(...c),a(...c)}:a&&(n[r]=a):r==="style"?n[r]={...a,...i}:r==="className"&&(n[r]=[a,i].filter(Boolean).join(" "))}return{...t,...n}}function iF(t){var r,a;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function pf(t){const e=t+"CollectionProvider",[n,r]=nF(e),[a,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:j,children:v}=x,_=Ae.useRef(null),b=Ae.useRef(new Map).current;return s.jsx(a,{scope:j,itemMap:b,collectionRef:_,children:v})};o.displayName=e;const c=t+"CollectionSlot",d=Ae.forwardRef((x,j)=>{const{scope:v,children:_}=x,b=i(c,v),w=Tt(j,b.collectionRef);return s.jsx(wi,{ref:w,children:_})});d.displayName=c;const u=t+"CollectionItemSlot",m="data-radix-collection-item",f=Ae.forwardRef((x,j)=>{const{scope:v,children:_,...b}=x,w=Ae.useRef(null),N=Tt(j,w),S=i(u,v);return Ae.useEffect(()=>(S.itemMap.set(w,{ref:w,...b}),()=>void S.itemMap.delete(w))),s.jsx(wi,{[m]:"",ref:N,children:_})});f.displayName=u;function p(x){const j=i(t+"CollectionConsumer",x);return Ae.useCallback(()=>{const _=j.collectionRef.current;if(!_)return[];const b=Array.from(_.querySelectorAll(`[${m}]`));return Array.from(j.itemMap.values()).sort((S,C)=>b.indexOf(S.ref.current)-b.indexOf(C.ref.current))},[j.collectionRef,j.itemMap])}return[{Provider:o,Slot:d,ItemSlot:f},p,r]}function oF(t,e){const n=g.createContext(e),r=i=>{const{children:o,...c}=i,d=g.useMemo(()=>c,Object.values(c));return s.jsx(n.Provider,{value:d,children:o})};r.displayName=t+"Provider";function a(i){const o=g.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,a]}function wr(t,e=[]){let n=[];function r(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];const u=f=>{var b;const{scope:p,children:x,...j}=f,v=((b=p==null?void 0:p[t])==null?void 0:b[d])||c,_=g.useMemo(()=>j,Object.values(j));return s.jsx(v.Provider,{value:_,children:x})};u.displayName=i+"Provider";function m(f,p){var v;const x=((v=p==null?void 0:p[t])==null?void 0:v[d])||c,j=g.useContext(x);if(j)return j;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[r,lF(a,...e)]}function lF(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=r.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var cF=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],nt=cF.reduce((t,e)=>{const n=g.forwardRef((r,a)=>{const{asChild:i,...o}=r,c=i?wi:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(c,{...o,ref:a})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function qb(t,e){t&&Wl.flushSync(()=>t.dispatchEvent(e))}function _n(t){const e=g.useRef(t);return g.useEffect(()=>{e.current=t}),g.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function dF(t,e=globalThis==null?void 0:globalThis.document){const n=_n(t);g.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var uF="DismissableLayer",k_="dismissableLayer.update",hF="dismissableLayer.pointerDownOutside",fF="dismissableLayer.focusOutside",tS,MA=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Hl=g.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:c,...d}=t,u=g.useContext(MA),[m,f]=g.useState(null),p=(m==null?void 0:m.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,x]=g.useState({}),j=Tt(e,P=>f(P)),v=Array.from(u.layers),[_]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),b=v.indexOf(_),w=m?v.indexOf(m):-1,N=u.layersWithOutsidePointerEventsDisabled.size>0,S=w>=b,C=pF(P=>{const M=P.target,z=[...u.branches].some(R=>R.contains(M));!S||z||(a==null||a(P),o==null||o(P),P.defaultPrevented||c==null||c())},p),A=gF(P=>{const M=P.target;[...u.branches].some(R=>R.contains(M))||(i==null||i(P),o==null||o(P),P.defaultPrevented||c==null||c())},p);return dF(P=>{w===u.layers.size-1&&(r==null||r(P),!P.defaultPrevented&&c&&(P.preventDefault(),c()))},p),g.useEffect(()=>{if(m)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(tS=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(m)),u.layers.add(m),nS(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=tS)}},[m,p,n,u]),g.useEffect(()=>()=>{m&&(u.layers.delete(m),u.layersWithOutsidePointerEventsDisabled.delete(m),nS())},[m,u]),g.useEffect(()=>{const P=()=>x({});return document.addEventListener(k_,P),()=>document.removeEventListener(k_,P)},[]),s.jsx(nt.div,{...d,ref:j,style:{pointerEvents:N?S?"auto":"none":void 0,...t.style},onFocusCapture:Re(t.onFocusCapture,A.onFocusCapture),onBlurCapture:Re(t.onBlurCapture,A.onBlurCapture),onPointerDownCapture:Re(t.onPointerDownCapture,C.onPointerDownCapture)})});Hl.displayName=uF;var mF="DismissableLayerBranch",RA=g.forwardRef((t,e)=>{const n=g.useContext(MA),r=g.useRef(null),a=Tt(e,r);return g.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),s.jsx(nt.div,{...t,ref:a})});RA.displayName=mF;function pF(t,e=globalThis==null?void 0:globalThis.document){const n=_n(t),r=g.useRef(!1),a=g.useRef(()=>{});return g.useEffect(()=>{const i=c=>{if(c.target&&!r.current){let d=function(){IA(hF,n,u,{discrete:!0})};const u={originalEvent:c};c.pointerType==="touch"?(e.removeEventListener("click",a.current),a.current=d,e.addEventListener("click",a.current,{once:!0})):d()}else e.removeEventListener("click",a.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",a.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function gF(t,e=globalThis==null?void 0:globalThis.document){const n=_n(t),r=g.useRef(!1);return g.useEffect(()=>{const a=i=>{i.target&&!r.current&&IA(fF,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",a),()=>e.removeEventListener("focusin",a)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function nS(){const t=new CustomEvent(k_);document.dispatchEvent(t)}function IA(t,e,n,{discrete:r}){const a=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&a.addEventListener(t,e,{once:!0}),r?qb(a,i):a.dispatchEvent(i)}var xF=Hl,vF=RA,Bn=globalThis!=null&&globalThis.document?g.useLayoutEffect:()=>{},yF="Portal",Od=g.forwardRef((t,e)=>{var c;const{container:n,...r}=t,[a,i]=g.useState(!1);Bn(()=>i(!0),[]);const o=n||a&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return o?PA.createPortal(s.jsx(nt.div,{...r,ref:e}),o):null});Od.displayName=yF;function _F(t,e){return g.useReducer((n,r)=>e[n][r]??n,t)}var Gn=t=>{const{present:e,children:n}=t,r=wF(e),a=typeof n=="function"?n({present:r.isPresent}):g.Children.only(n),i=Tt(r.ref,bF(a));return typeof n=="function"||r.isPresent?g.cloneElement(a,{ref:i}):null};Gn.displayName="Presence";function wF(t){const[e,n]=g.useState(),r=g.useRef({}),a=g.useRef(t),i=g.useRef("none"),o=t?"mounted":"unmounted",[c,d]=_F(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const u=jm(r.current);i.current=c==="mounted"?u:"none"},[c]),Bn(()=>{const u=r.current,m=a.current;if(m!==t){const p=i.current,x=jm(u);t?d("MOUNT"):x==="none"||(u==null?void 0:u.display)==="none"?d("UNMOUNT"):d(m&&p!==x?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,d]),Bn(()=>{if(e){let u;const m=e.ownerDocument.defaultView??window,f=x=>{const v=jm(r.current).includes(x.animationName);if(x.target===e&&v&&(d("ANIMATION_END"),!a.current)){const _=e.style.animationFillMode;e.style.animationFillMode="forwards",u=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=_)})}},p=x=>{x.target===e&&(i.current=jm(r.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{m.clearTimeout(u),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else d("ANIMATION_END")},[e,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:g.useCallback(u=>{u&&(r.current=getComputedStyle(u)),n(u)},[])}}function jm(t){return(t==null?void 0:t.animationName)||"none"}function bF(t){var r,a;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Lr({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,a]=jF({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,c=_n(n),d=g.useCallback(u=>{if(i){const f=typeof u=="function"?u(t):u;f!==t&&c(f)}else a(u)},[i,t,a,c]);return[o,d]}function jF({defaultProp:t,onChange:e}){const n=g.useState(t),[r]=n,a=g.useRef(r),i=_n(e);return g.useEffect(()=>{a.current!==r&&(i(r),a.current=r)},[r,a,i]),n}var NF="VisuallyHidden",gf=g.forwardRef((t,e)=>s.jsx(nt.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));gf.displayName=NF;var SF=gf,Wb="ToastProvider",[Hb,kF,CF]=pf("Toast"),[OA,Hre]=wr("Toast",[CF]),[EF,sg]=OA(Wb),LA=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:o}=t,[c,d]=g.useState(null),[u,m]=g.useState(0),f=g.useRef(!1),p=g.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Wb}\`. Expected non-empty \`string\`.`),s.jsx(Hb.Provider,{scope:e,children:s.jsx(EF,{scope:e,label:n,duration:r,swipeDirection:a,swipeThreshold:i,toastCount:u,viewport:c,onViewportChange:d,onToastAdd:g.useCallback(()=>m(x=>x+1),[]),onToastRemove:g.useCallback(()=>m(x=>x-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:p,children:o})})};LA.displayName=Wb;var FA="ToastViewport",AF=["F8"],C_="toast.viewportPause",E_="toast.viewportResume",BA=g.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=AF,label:a="Notifications ({hotkey})",...i}=t,o=sg(FA,n),c=kF(n),d=g.useRef(null),u=g.useRef(null),m=g.useRef(null),f=g.useRef(null),p=Tt(e,f,o.onViewportChange),x=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),j=o.toastCount>0;g.useEffect(()=>{const _=b=>{var N;r.length!==0&&r.every(S=>b[S]||b.code===S)&&((N=f.current)==null||N.focus())};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[r]),g.useEffect(()=>{const _=d.current,b=f.current;if(j&&_&&b){const w=()=>{if(!o.isClosePausedRef.current){const A=new CustomEvent(C_);b.dispatchEvent(A),o.isClosePausedRef.current=!0}},N=()=>{if(o.isClosePausedRef.current){const A=new CustomEvent(E_);b.dispatchEvent(A),o.isClosePausedRef.current=!1}},S=A=>{!_.contains(A.relatedTarget)&&N()},C=()=>{_.contains(document.activeElement)||N()};return _.addEventListener("focusin",w),_.addEventListener("focusout",S),_.addEventListener("pointermove",w),_.addEventListener("pointerleave",C),window.addEventListener("blur",w),window.addEventListener("focus",N),()=>{_.removeEventListener("focusin",w),_.removeEventListener("focusout",S),_.removeEventListener("pointermove",w),_.removeEventListener("pointerleave",C),window.removeEventListener("blur",w),window.removeEventListener("focus",N)}}},[j,o.isClosePausedRef]);const v=g.useCallback(({tabbingDirection:_})=>{const w=c().map(N=>{const S=N.ref.current,C=[S,...UF(S)];return _==="forwards"?C:C.reverse()});return(_==="forwards"?w.reverse():w).flat()},[c]);return g.useEffect(()=>{const _=f.current;if(_){const b=w=>{var C,A,P;const N=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!N){const M=document.activeElement,z=w.shiftKey;if(w.target===_&&z){(C=u.current)==null||C.focus();return}const B=v({tabbingDirection:z?"backwards":"forwards"}),W=B.findIndex(X=>X===M);rv(B.slice(W+1))?w.preventDefault():z?(A=u.current)==null||A.focus():(P=m.current)==null||P.focus()}};return _.addEventListener("keydown",b),()=>_.removeEventListener("keydown",b)}},[c,v]),s.jsxs(vF,{ref:d,role:"region","aria-label":a.replace("{hotkey}",x),tabIndex:-1,style:{pointerEvents:j?void 0:"none"},children:[j&&s.jsx(A_,{ref:u,onFocusFromOutsideViewport:()=>{const _=v({tabbingDirection:"forwards"});rv(_)}}),s.jsx(Hb.Slot,{scope:n,children:s.jsx(nt.ol,{tabIndex:-1,...i,ref:p})}),j&&s.jsx(A_,{ref:m,onFocusFromOutsideViewport:()=>{const _=v({tabbingDirection:"backwards"});rv(_)}})]})});BA.displayName=FA;var zA="ToastFocusProxy",A_=g.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...a}=t,i=sg(zA,n);return s.jsx(gf,{"aria-hidden":!0,tabIndex:0,...a,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const c=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(c))&&r()}})});A_.displayName=zA;var rg="Toast",PF="toast.swipeStart",DF="toast.swipeMove",TF="toast.swipeCancel",MF="toast.swipeEnd",$A=g.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:a,onOpenChange:i,...o}=t,[c=!0,d]=Lr({prop:r,defaultProp:a,onChange:i});return s.jsx(Gn,{present:n||c,children:s.jsx(OF,{open:c,...o,ref:e,onClose:()=>d(!1),onPause:_n(t.onPause),onResume:_n(t.onResume),onSwipeStart:Re(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Re(t.onSwipeMove,u=>{const{x:m,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${m}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:Re(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Re(t.onSwipeEnd,u=>{const{x:m,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${m}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),d(!1)})})})});$A.displayName=rg;var[RF,IF]=OA(rg,{onClose(){}}),OF=g.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:a,open:i,onClose:o,onEscapeKeyDown:c,onPause:d,onResume:u,onSwipeStart:m,onSwipeMove:f,onSwipeCancel:p,onSwipeEnd:x,...j}=t,v=sg(rg,n),[_,b]=g.useState(null),w=Tt(e,X=>b(X)),N=g.useRef(null),S=g.useRef(null),C=a||v.duration,A=g.useRef(0),P=g.useRef(C),M=g.useRef(0),{onToastAdd:z,onToastRemove:R}=v,D=_n(()=>{var ue;(_==null?void 0:_.contains(document.activeElement))&&((ue=v.viewport)==null||ue.focus()),o()}),B=g.useCallback(X=>{!X||X===1/0||(window.clearTimeout(M.current),A.current=new Date().getTime(),M.current=window.setTimeout(D,X))},[D]);g.useEffect(()=>{const X=v.viewport;if(X){const ue=()=>{B(P.current),u==null||u()},de=()=>{const G=new Date().getTime()-A.current;P.current=P.current-G,window.clearTimeout(M.current),d==null||d()};return X.addEventListener(C_,de),X.addEventListener(E_,ue),()=>{X.removeEventListener(C_,de),X.removeEventListener(E_,ue)}}},[v.viewport,C,d,u,B]),g.useEffect(()=>{i&&!v.isClosePausedRef.current&&B(C)},[i,C,v.isClosePausedRef,B]),g.useEffect(()=>(z(),()=>R()),[z,R]);const W=g.useMemo(()=>_?ZA(_):null,[_]);return v.viewport?s.jsxs(s.Fragment,{children:[W&&s.jsx(LF,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:W}),s.jsx(RF,{scope:n,onClose:D,children:Wl.createPortal(s.jsx(Hb.ItemSlot,{scope:n,children:s.jsx(xF,{asChild:!0,onEscapeKeyDown:Re(c,()=>{v.isFocusedToastEscapeKeyDownRef.current||D(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:s.jsx(nt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":v.swipeDirection,...j,ref:w,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Re(t.onKeyDown,X=>{X.key==="Escape"&&(c==null||c(X.nativeEvent),X.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,D()))}),onPointerDown:Re(t.onPointerDown,X=>{X.button===0&&(N.current={x:X.clientX,y:X.clientY})}),onPointerMove:Re(t.onPointerMove,X=>{if(!N.current)return;const ue=X.clientX-N.current.x,de=X.clientY-N.current.y,G=!!S.current,I=["left","right"].includes(v.swipeDirection),V=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,$=I?V(0,ue):0,F=I?0:V(0,de),O=X.pointerType==="touch"?10:2,K={x:$,y:F},U={originalEvent:X,delta:K};G?(S.current=K,Nm(DF,f,U,{discrete:!1})):sS(K,v.swipeDirection,O)?(S.current=K,Nm(PF,m,U,{discrete:!1}),X.target.setPointerCapture(X.pointerId)):(Math.abs(ue)>O||Math.abs(de)>O)&&(N.current=null)}),onPointerUp:Re(t.onPointerUp,X=>{const ue=S.current,de=X.target;if(de.hasPointerCapture(X.pointerId)&&de.releasePointerCapture(X.pointerId),S.current=null,N.current=null,ue){const G=X.currentTarget,I={originalEvent:X,delta:ue};sS(ue,v.swipeDirection,v.swipeThreshold)?Nm(MF,x,I,{discrete:!0}):Nm(TF,p,I,{discrete:!0}),G.addEventListener("click",V=>V.preventDefault(),{once:!0})}})})})}),v.viewport)})]}):null}),LF=t=>{const{__scopeToast:e,children:n,...r}=t,a=sg(rg,e),[i,o]=g.useState(!1),[c,d]=g.useState(!1);return zF(()=>o(!0)),g.useEffect(()=>{const u=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(u)},[]),c?null:s.jsx(Od,{asChild:!0,children:s.jsx(gf,{...r,children:i&&s.jsxs(s.Fragment,{children:[a.label," ",n]})})})},FF="ToastTitle",UA=g.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return s.jsx(nt.div,{...r,ref:e})});UA.displayName=FF;var BF="ToastDescription",qA=g.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return s.jsx(nt.div,{...r,ref:e})});qA.displayName=BF;var WA="ToastAction",HA=g.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?s.jsx(KA,{altText:n,asChild:!0,children:s.jsx(Vb,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${WA}\`. Expected non-empty \`string\`.`),null)});HA.displayName=WA;var VA="ToastClose",Vb=g.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,a=IF(VA,n);return s.jsx(KA,{asChild:!0,children:s.jsx(nt.button,{type:"button",...r,ref:e,onClick:Re(t.onClick,a.onClose)})})});Vb.displayName=VA;var KA=g.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...a}=t;return s.jsx(nt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...a,ref:e})});function ZA(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),$F(r)){const a=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...ZA(r))}}),e}function Nm(t,e,n,{discrete:r}){const a=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&a.addEventListener(t,e,{once:!0}),r?qb(a,i):a.dispatchEvent(i)}var sS=(t,e,n=0)=>{const r=Math.abs(t.x),a=Math.abs(t.y),i=r>a;return e==="left"||e==="right"?i&&r>n:!i&&a>n};function zF(t=()=>{}){const e=_n(t);Bn(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function $F(t){return t.nodeType===t.ELEMENT_NODE}function UF(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function rv(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var qF=LA,GA=BA,QA=$A,YA=UA,XA=qA,JA=HA,eP=Vb;function tP(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(n=tP(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function nP(){for(var t,e,n=0,r="",a=arguments.length;n<a;n++)(t=arguments[n])&&(e=tP(t))&&(r&&(r+=" "),r+=e);return r}const rS=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,aS=nP,Ld=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return aS(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:i}=e,o=Object.keys(a).map(u=>{const m=n==null?void 0:n[u],f=i==null?void 0:i[u];if(m===null)return null;const p=rS(m)||rS(f);return a[u][p]}),c=n&&Object.entries(n).reduce((u,m)=>{let[f,p]=m;return p===void 0||(u[f]=p),u},{}),d=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,m)=>{let{class:f,className:p,...x}=m;return Object.entries(x).every(j=>{let[v,_]=j;return Array.isArray(_)?_.includes({...i,...c}[v]):{...i,...c}[v]===_})?[...u,f,p]:u},[]);return aS(t,o,d,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),sP=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var HF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VF=g.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:i,iconNode:o,...c},d)=>g.createElement("svg",{ref:d,...HF,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:sP("lucide",a),...c},[...o.map(([u,m])=>g.createElement(u,m)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=(t,e)=>{const n=g.forwardRef(({className:r,...a},i)=>g.createElement(VF,{ref:i,iconNode:e,className:sP(`lucide-${WF(t)}`,r),...a}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=Ie("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=Ie("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kb=Ie("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GF=Ie("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=Ie("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sm=Ie("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bc=Ie("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=Ie("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=Ie("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=Ie("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P_=Ie("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zb=Ie("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sh=Ie("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=Ie("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=Ie("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rh=Ie("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=Ie("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=Ie("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=Ie("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=Ie("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=Ie("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=Ie("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=Ie("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=Ie("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=Ie("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=Ie("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=Ie("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=Ie("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=Ie("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gb=Ie("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=Ie("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=Ie("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=Ie("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=Ie("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=Ie("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=Ie("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const km=Ie("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=Ie("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=Ie("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=Ie("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=Ie("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=Ie("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=Ie("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=Ie("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=Ie("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=Ie("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=Ie("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aP=Ie("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=Ie("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T_=Ie("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=Ie("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=Ie("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=Ie("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=Ie("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=Ie("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=Ie("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=Ie("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=Ie("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pu=Ie("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=Ie("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=Ie("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=Ie("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=Ie("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R_=Ie("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=Ie("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ah=Ie("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bd=Ie("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=Ie("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=Ie("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=Ie("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=Ie("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=Ie("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tl=Ie("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qb=Ie("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _u=Ie("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I_=Ie("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=Ie("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=Ie("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yb=Ie("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=Ie("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=Ie("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=Ie("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=Ie("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=Ie("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=Ie("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bi=Ie("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xb=Ie("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dP=Ie("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=Ie("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=Ie("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=Ie("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Jb="-",yB=t=>{const e=wB(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const c=o.split(Jb);return c[0]===""&&c.length!==1&&c.shift(),uP(c,e)||_B(o)},getConflictingClassGroupIds:(o,c)=>{const d=n[o]||[];return c&&r[o]?[...d,...r[o]]:d}}},uP=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),a=r?uP(t.slice(1),r):void 0;if(a)return a;if(e.validators.length===0)return;const i=t.join(Jb);return(o=e.validators.find(({validator:c})=>c(i)))==null?void 0:o.classGroupId},dS=/^\[(.+)\]$/,_B=t=>{if(dS.test(t)){const e=dS.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},wB=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return jB(Object.entries(t.classGroups),n).forEach(([i,o])=>{O_(o,r,i,e)}),r},O_=(t,e,n,r)=>{t.forEach(a=>{if(typeof a=="string"){const i=a===""?e:uS(e,a);i.classGroupId=n;return}if(typeof a=="function"){if(bB(a)){O_(a(r),e,n,r);return}e.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([i,o])=>{O_(o,uS(e,i),n,r)})})},uS=(t,e)=>{let n=t;return e.split(Jb).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},bB=t=>t.isThemeGetter,jB=(t,e)=>e?t.map(([n,r])=>{const a=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,c])=>[e+o,c])):i);return[n,a]}):t,NB=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const a=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return a(i,o),o},set(i,o){n.has(i)?n.set(i,o):a(i,o)}}},hP="!",SB=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,a=e[0],i=e.length,o=c=>{const d=[];let u=0,m=0,f;for(let _=0;_<c.length;_++){let b=c[_];if(u===0){if(b===a&&(r||c.slice(_,_+i)===e)){d.push(c.slice(m,_)),m=_+i;continue}if(b==="/"){f=_;continue}}b==="["?u++:b==="]"&&u--}const p=d.length===0?c:c.substring(m),x=p.startsWith(hP),j=x?p.substring(1):p,v=f&&f>m?f-m:void 0;return{modifiers:d,hasImportantModifier:x,baseClassName:j,maybePostfixModifierPosition:v}};return n?c=>n({className:c,parseClassName:o}):o},kB=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},CB=t=>({cache:NB(t.cacheSize),parseClassName:SB(t),...yB(t)}),EB=/\s+/,AB=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a}=e,i=[],o=t.trim().split(EB);let c="";for(let d=o.length-1;d>=0;d-=1){const u=o[d],{modifiers:m,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:x}=n(u);let j=!!x,v=r(j?p.substring(0,x):p);if(!v){if(!j){c=u+(c.length>0?" "+c:c);continue}if(v=r(p),!v){c=u+(c.length>0?" "+c:c);continue}j=!1}const _=kB(m).join(":"),b=f?_+hP:_,w=b+v;if(i.includes(w))continue;i.push(w);const N=a(v,j);for(let S=0;S<N.length;++S){const C=N[S];i.push(b+C)}c=u+(c.length>0?" "+c:c)}return c};function PB(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=fP(e))&&(r&&(r+=" "),r+=n);return r}const fP=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=fP(t[r]))&&(n&&(n+=" "),n+=e);return n};function DB(t,...e){let n,r,a,i=o;function o(d){const u=e.reduce((m,f)=>f(m),t());return n=CB(u),r=n.cache.get,a=n.cache.set,i=c,c(d)}function c(d){const u=r(d);if(u)return u;const m=AB(d,n);return a(d,m),m}return function(){return i(PB.apply(null,arguments))}}const gn=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},mP=/^\[(?:([a-z-]+):)?(.+)\]$/i,TB=/^\d+\/\d+$/,MB=new Set(["px","full","screen"]),RB=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,IB=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,OB=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,LB=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,FB=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ti=t=>Gc(t)||MB.has(t)||TB.test(t),Oi=t=>zd(t,"length",VB),Gc=t=>!!t&&!Number.isNaN(Number(t)),av=t=>zd(t,"number",Gc),wu=t=>!!t&&Number.isInteger(Number(t)),BB=t=>t.endsWith("%")&&Gc(t.slice(0,-1)),Rt=t=>mP.test(t),Li=t=>RB.test(t),zB=new Set(["length","size","percentage"]),$B=t=>zd(t,zB,pP),UB=t=>zd(t,"position",pP),qB=new Set(["image","url"]),WB=t=>zd(t,qB,ZB),HB=t=>zd(t,"",KB),bu=()=>!0,zd=(t,e,n)=>{const r=mP.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},VB=t=>IB.test(t)&&!OB.test(t),pP=()=>!1,KB=t=>LB.test(t),ZB=t=>FB.test(t),GB=()=>{const t=gn("colors"),e=gn("spacing"),n=gn("blur"),r=gn("brightness"),a=gn("borderColor"),i=gn("borderRadius"),o=gn("borderSpacing"),c=gn("borderWidth"),d=gn("contrast"),u=gn("grayscale"),m=gn("hueRotate"),f=gn("invert"),p=gn("gap"),x=gn("gradientColorStops"),j=gn("gradientColorStopPositions"),v=gn("inset"),_=gn("margin"),b=gn("opacity"),w=gn("padding"),N=gn("saturate"),S=gn("scale"),C=gn("sepia"),A=gn("skew"),P=gn("space"),M=gn("translate"),z=()=>["auto","contain","none"],R=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto",Rt,e],B=()=>[Rt,e],W=()=>["",ti,Oi],X=()=>["auto",Gc,Rt],ue=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],de=()=>["solid","dashed","dotted","double","none"],G=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],I=()=>["start","end","center","between","around","evenly","stretch"],V=()=>["","0",Rt],$=()=>["auto","avoid","all","avoid-page","page","left","right","column"],F=()=>[Gc,Rt];return{cacheSize:500,separator:":",theme:{colors:[bu],spacing:[ti,Oi],blur:["none","",Li,Rt],brightness:F(),borderColor:[t],borderRadius:["none","","full",Li,Rt],borderSpacing:B(),borderWidth:W(),contrast:F(),grayscale:V(),hueRotate:F(),invert:V(),gap:B(),gradientColorStops:[t],gradientColorStopPositions:[BB,Oi],inset:D(),margin:D(),opacity:F(),padding:B(),saturate:F(),scale:F(),sepia:V(),skew:F(),space:B(),translate:B()},classGroups:{aspect:[{aspect:["auto","square","video",Rt]}],container:["container"],columns:[{columns:[Li]}],"break-after":[{"break-after":$()}],"break-before":[{"break-before":$()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ue(),Rt]}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:z()}],"overscroll-x":[{"overscroll-x":z()}],"overscroll-y":[{"overscroll-y":z()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",wu,Rt]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Rt]}],grow:[{grow:V()}],shrink:[{shrink:V()}],order:[{order:["first","last","none",wu,Rt]}],"grid-cols":[{"grid-cols":[bu]}],"col-start-end":[{col:["auto",{span:["full",wu,Rt]},Rt]}],"col-start":[{"col-start":X()}],"col-end":[{"col-end":X()}],"grid-rows":[{"grid-rows":[bu]}],"row-start-end":[{row:["auto",{span:[wu,Rt]},Rt]}],"row-start":[{"row-start":X()}],"row-end":[{"row-end":X()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Rt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Rt]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...I()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...I(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...I(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[_]}],mx:[{mx:[_]}],my:[{my:[_]}],ms:[{ms:[_]}],me:[{me:[_]}],mt:[{mt:[_]}],mr:[{mr:[_]}],mb:[{mb:[_]}],ml:[{ml:[_]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Rt,e]}],"min-w":[{"min-w":[Rt,e,"min","max","fit"]}],"max-w":[{"max-w":[Rt,e,"none","full","min","max","fit","prose",{screen:[Li]},Li]}],h:[{h:[Rt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Rt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Rt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Rt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Li,Oi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",av]}],"font-family":[{font:[bu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Rt]}],"line-clamp":[{"line-clamp":["none",Gc,av]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ti,Rt]}],"list-image":[{"list-image":["none",Rt]}],"list-style-type":[{list:["none","disc","decimal",Rt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ti,Oi]}],"underline-offset":[{"underline-offset":["auto",ti,Rt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:B()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Rt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Rt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ue(),UB]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",$B]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},WB]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[j]}],"gradient-via-pos":[{via:[j]}],"gradient-to-pos":[{to:[j]}],"gradient-from":[{from:[x]}],"gradient-via":[{via:[x]}],"gradient-to":[{to:[x]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...de(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:de()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...de()]}],"outline-offset":[{"outline-offset":[ti,Rt]}],"outline-w":[{outline:[ti,Oi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:W()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[ti,Oi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Li,HB]}],"shadow-color":[{shadow:[bu]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...G(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":G()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",Li,Rt]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[m]}],invert:[{invert:[f]}],saturate:[{saturate:[N]}],sepia:[{sepia:[C]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[m]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[C]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Rt]}],duration:[{duration:F()}],ease:[{ease:["linear","in","out","in-out",Rt]}],delay:[{delay:F()}],animate:[{animate:["none","spin","ping","pulse","bounce",Rt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[wu,Rt]}],"translate-x":[{"translate-x":[M]}],"translate-y":[{"translate-y":[M]}],"skew-x":[{"skew-x":[A]}],"skew-y":[{"skew-y":[A]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Rt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Rt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":B()}],"scroll-mx":[{"scroll-mx":B()}],"scroll-my":[{"scroll-my":B()}],"scroll-ms":[{"scroll-ms":B()}],"scroll-me":[{"scroll-me":B()}],"scroll-mt":[{"scroll-mt":B()}],"scroll-mr":[{"scroll-mr":B()}],"scroll-mb":[{"scroll-mb":B()}],"scroll-ml":[{"scroll-ml":B()}],"scroll-p":[{"scroll-p":B()}],"scroll-px":[{"scroll-px":B()}],"scroll-py":[{"scroll-py":B()}],"scroll-ps":[{"scroll-ps":B()}],"scroll-pe":[{"scroll-pe":B()}],"scroll-pt":[{"scroll-pt":B()}],"scroll-pr":[{"scroll-pr":B()}],"scroll-pb":[{"scroll-pb":B()}],"scroll-pl":[{"scroll-pl":B()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Rt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[ti,Oi,av]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},QB=DB(GB);function Te(...t){return QB(nP(t))}const YB=qF,gP=g.forwardRef(({className:t,...e},n)=>s.jsx(GA,{ref:n,className:Te("fixed top-20 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));gP.displayName=GA.displayName;const XB=Ld("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),xP=g.forwardRef(({className:t,variant:e,...n},r)=>s.jsx(QA,{ref:r,className:Te(XB({variant:e}),t),...n}));xP.displayName=QA.displayName;const JB=g.forwardRef(({className:t,...e},n)=>s.jsx(JA,{ref:n,className:Te("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));JB.displayName=JA.displayName;const vP=g.forwardRef(({className:t,...e},n)=>s.jsx(eP,{ref:n,className:Te("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:s.jsx(Ln,{className:"h-4 w-4"})}));vP.displayName=eP.displayName;const yP=g.forwardRef(({className:t,...e},n)=>s.jsx(YA,{ref:n,className:Te("text-sm font-semibold",t),...e}));yP.displayName=YA.displayName;const _P=g.forwardRef(({className:t,...e},n)=>s.jsx(XA,{ref:n,className:Te("text-sm opacity-90",t),...e}));_P.displayName=XA.displayName;function ez(){const{toasts:t}=Mt();return s.jsxs(YB,{children:[t.map(function({id:e,title:n,description:r,action:a,...i}){return s.jsxs(xP,{...i,children:[s.jsxs("div",{className:"grid gap-1",children:[n&&s.jsx(yP,{children:n}),r&&s.jsx(_P,{children:r})]}),a,s.jsx(vP,{})]},e)}),s.jsx(gP,{})]})}const wP=g.createContext(void 0);function tz({children:t}){const[e,n]=g.useState(()=>localStorage.getItem("handwerkos-theme")||"light"),[r,a]=g.useState("light");return g.useEffect(()=>{const i=window.document.documentElement;if(i.classList.remove("light","dark"),e==="system"){const o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i.classList.add(o),a(o)}else i.classList.add(e),a(e);localStorage.setItem("handwerkos-theme",e)},[e]),g.useEffect(()=>{if(e==="system"){const i=window.matchMedia("(prefers-color-scheme: dark)"),o=c=>{const d=c.matches?"dark":"light";document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(d),a(d)};return i.addEventListener("change",o),()=>i.removeEventListener("change",o)}},[e]),s.jsx(wP.Provider,{value:{theme:e,setTheme:n,actualTheme:r},children:t})}function ej(){const t=g.useContext(wP);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t}var nz=t=>{switch(t){case"success":return az;case"info":return oz;case"warning":return iz;case"error":return lz;default:return null}},sz=Array(12).fill(0),rz=({visible:t})=>Ae.createElement("div",{className:"sonner-loading-wrapper","data-visible":t},Ae.createElement("div",{className:"sonner-spinner"},sz.map((e,n)=>Ae.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),az=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),iz=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),oz=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),lz=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),cz=()=>{let[t,e]=Ae.useState(document.hidden);return Ae.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},L_=1,dz=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:n,...r}=t,a=typeof(t==null?void 0:t.id)=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:L_++,i=this.toasts.find(c=>c.id===a),o=t.dismissible===void 0?!0:t.dismissible;return i?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...t,id:a,title:n}),{...c,...t,id:a,dismissible:o,title:n}):c):this.addToast({title:n,...r,dismissible:o,id:a}),a},this.dismiss=t=>(t||this.toasts.forEach(e=>{this.subscribers.forEach(n=>n({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let n;e.loading!==void 0&&(n=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let r=t instanceof Promise?t:t(),a=n!==void 0;return r.then(async i=>{if(hz(i)&&!i.ok){a=!1;let o=typeof e.error=="function"?await e.error(`HTTP error! status: ${i.status}`):e.error,c=typeof e.description=="function"?await e.description(`HTTP error! status: ${i.status}`):e.description;this.create({id:n,type:"error",message:o,description:c})}else if(e.success!==void 0){a=!1;let o=typeof e.success=="function"?await e.success(i):e.success,c=typeof e.description=="function"?await e.description(i):e.description;this.create({id:n,type:"success",message:o,description:c})}}).catch(async i=>{if(e.error!==void 0){a=!1;let o=typeof e.error=="function"?await e.error(i):e.error,c=typeof e.description=="function"?await e.description(i):e.description;this.create({id:n,type:"error",message:o,description:c})}}).finally(()=>{var i;a&&(this.dismiss(n),n=void 0),(i=e.finally)==null||i.call(e)}),n},this.custom=(t,e)=>{let n=(e==null?void 0:e.id)||L_++;return this.create({jsx:t(n),id:n,...e}),n},this.subscribers=[],this.toasts=[]}},rr=new dz,uz=(t,e)=>{let n=(e==null?void 0:e.id)||L_++;return rr.addToast({title:t,...e,id:n}),n},hz=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",fz=uz,mz=()=>rr.toasts,Ue=Object.assign(fz,{success:rr.success,info:rr.info,warning:rr.warning,error:rr.error,custom:rr.custom,message:rr.message,promise:rr.promise,dismiss:rr.dismiss,loading:rr.loading},{getHistory:mz});function pz(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}pz(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Cm(t){return t.label!==void 0}var gz=3,xz="32px",vz=4e3,yz=356,_z=14,wz=20,bz=200;function jz(...t){return t.filter(Boolean).join(" ")}var Nz=t=>{var e,n,r,a,i,o,c,d,u,m;let{invert:f,toast:p,unstyled:x,interacting:j,setHeights:v,visibleToasts:_,heights:b,index:w,toasts:N,expanded:S,removeToast:C,defaultRichColors:A,closeButton:P,style:M,cancelButtonStyle:z,actionButtonStyle:R,className:D="",descriptionClassName:B="",duration:W,position:X,gap:ue,loadingIcon:de,expandByDefault:G,classNames:I,icons:V,closeButtonAriaLabel:$="Close toast",pauseWhenPageIsHidden:F,cn:O}=t,[K,U]=Ae.useState(!1),[te,J]=Ae.useState(!1),[q,ne]=Ae.useState(!1),[pe,Q]=Ae.useState(!1),[re,me]=Ae.useState(0),[he,ge]=Ae.useState(0),se=Ae.useRef(null),we=Ae.useRef(null),Se=w===0,qe=w+1<=_,Ye=p.type,Et=p.dismissible!==!1,be=p.className||"",Oe=p.descriptionClassName||"",Fe=Ae.useMemo(()=>b.findIndex(_e=>_e.toastId===p.id)||0,[b,p.id]),lt=Ae.useMemo(()=>{var _e;return(_e=p.closeButton)!=null?_e:P},[p.closeButton,P]),He=Ae.useMemo(()=>p.duration||W||vz,[p.duration,W]),Le=Ae.useRef(0),Nt=Ae.useRef(0),xt=Ae.useRef(0),Un=Ae.useRef(null),[gs,yt]=X.split("-"),dn=Ae.useMemo(()=>b.reduce((_e,$e,Me)=>Me>=Fe?_e:_e+$e.height,0),[b,Fe]),Tn=cz(),rs=p.invert||f,Mn=Ye==="loading";Nt.current=Ae.useMemo(()=>Fe*ue+dn,[Fe,dn]),Ae.useEffect(()=>{U(!0)},[]),Ae.useLayoutEffect(()=>{if(!K)return;let _e=we.current,$e=_e.style.height;_e.style.height="auto";let Me=_e.getBoundingClientRect().height;_e.style.height=$e,ge(Me),v(Ee=>Ee.find(it=>it.toastId===p.id)?Ee.map(it=>it.toastId===p.id?{...it,height:Me}:it):[{toastId:p.id,height:Me,position:p.position},...Ee])},[K,p.title,p.description,v,p.id]);let bn=Ae.useCallback(()=>{J(!0),me(Nt.current),v(_e=>_e.filter($e=>$e.toastId!==p.id)),setTimeout(()=>{C(p)},bz)},[p,C,v,Nt]);Ae.useEffect(()=>{if(p.promise&&Ye==="loading"||p.duration===1/0||p.type==="loading")return;let _e,$e=He;return S||j||F&&Tn?(()=>{if(xt.current<Le.current){let Me=new Date().getTime()-Le.current;$e=$e-Me}xt.current=new Date().getTime()})():$e!==1/0&&(Le.current=new Date().getTime(),_e=setTimeout(()=>{var Me;(Me=p.onAutoClose)==null||Me.call(p,p),bn()},$e)),()=>clearTimeout(_e)},[S,j,G,p,He,bn,p.promise,Ye,F,Tn]),Ae.useEffect(()=>{let _e=we.current;if(_e){let $e=_e.getBoundingClientRect().height;return ge($e),v(Me=>[{toastId:p.id,height:$e,position:p.position},...Me]),()=>v(Me=>Me.filter(Ee=>Ee.toastId!==p.id))}},[v,p.id]),Ae.useEffect(()=>{p.delete&&bn()},[bn,p.delete]);function je(){return V!=null&&V.loading?Ae.createElement("div",{className:"sonner-loader","data-visible":Ye==="loading"},V.loading):de?Ae.createElement("div",{className:"sonner-loader","data-visible":Ye==="loading"},de):Ae.createElement(rz,{visible:Ye==="loading"})}return Ae.createElement("li",{"aria-live":p.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:we,className:O(D,be,I==null?void 0:I.toast,(e=p==null?void 0:p.classNames)==null?void 0:e.toast,I==null?void 0:I.default,I==null?void 0:I[Ye],(n=p==null?void 0:p.classNames)==null?void 0:n[Ye]),"data-sonner-toast":"","data-rich-colors":(r=p.richColors)!=null?r:A,"data-styled":!(p.jsx||p.unstyled||x),"data-mounted":K,"data-promise":!!p.promise,"data-removed":te,"data-visible":qe,"data-y-position":gs,"data-x-position":yt,"data-index":w,"data-front":Se,"data-swiping":q,"data-dismissible":Et,"data-type":Ye,"data-invert":rs,"data-swipe-out":pe,"data-expanded":!!(S||G&&K),style:{"--index":w,"--toasts-before":w,"--z-index":N.length-w,"--offset":`${te?re:Nt.current}px`,"--initial-height":G?"auto":`${he}px`,...M,...p.style},onPointerDown:_e=>{Mn||!Et||(se.current=new Date,me(Nt.current),_e.target.setPointerCapture(_e.pointerId),_e.target.tagName!=="BUTTON"&&(ne(!0),Un.current={x:_e.clientX,y:_e.clientY}))},onPointerUp:()=>{var _e,$e,Me,Ee;if(pe||!Et)return;Un.current=null;let it=Number(((_e=we.current)==null?void 0:_e.style.getPropertyValue("--swipe-amount").replace("px",""))||0),pn=new Date().getTime()-(($e=se.current)==null?void 0:$e.getTime()),Ss=Math.abs(it)/pn;if(Math.abs(it)>=wz||Ss>.11){me(Nt.current),(Me=p.onDismiss)==null||Me.call(p,p),bn(),Q(!0);return}(Ee=we.current)==null||Ee.style.setProperty("--swipe-amount","0px"),ne(!1)},onPointerMove:_e=>{var $e;if(!Un.current||!Et)return;let Me=_e.clientY-Un.current.y,Ee=_e.clientX-Un.current.x,it=(gs==="top"?Math.min:Math.max)(0,Me),pn=_e.pointerType==="touch"?10:2;Math.abs(it)>pn?($e=we.current)==null||$e.style.setProperty("--swipe-amount",`${Me}px`):Math.abs(Ee)>pn&&(Un.current=null)}},lt&&!p.jsx?Ae.createElement("button",{"aria-label":$,"data-disabled":Mn,"data-close-button":!0,onClick:Mn||!Et?()=>{}:()=>{var _e;bn(),(_e=p.onDismiss)==null||_e.call(p,p)},className:O(I==null?void 0:I.closeButton,(a=p==null?void 0:p.classNames)==null?void 0:a.closeButton)},Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ae.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ae.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,p.jsx||Ae.isValidElement(p.title)?p.jsx||p.title:Ae.createElement(Ae.Fragment,null,Ye||p.icon||p.promise?Ae.createElement("div",{"data-icon":"",className:O(I==null?void 0:I.icon,(i=p==null?void 0:p.classNames)==null?void 0:i.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||je():null,p.type!=="loading"?p.icon||(V==null?void 0:V[Ye])||nz(Ye):null):null,Ae.createElement("div",{"data-content":"",className:O(I==null?void 0:I.content,(o=p==null?void 0:p.classNames)==null?void 0:o.content)},Ae.createElement("div",{"data-title":"",className:O(I==null?void 0:I.title,(c=p==null?void 0:p.classNames)==null?void 0:c.title)},p.title),p.description?Ae.createElement("div",{"data-description":"",className:O(B,Oe,I==null?void 0:I.description,(d=p==null?void 0:p.classNames)==null?void 0:d.description)},p.description):null),Ae.isValidElement(p.cancel)?p.cancel:p.cancel&&Cm(p.cancel)?Ae.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||z,onClick:_e=>{var $e,Me;Cm(p.cancel)&&Et&&((Me=($e=p.cancel).onClick)==null||Me.call($e,_e),bn())},className:O(I==null?void 0:I.cancelButton,(u=p==null?void 0:p.classNames)==null?void 0:u.cancelButton)},p.cancel.label):null,Ae.isValidElement(p.action)?p.action:p.action&&Cm(p.action)?Ae.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||R,onClick:_e=>{var $e,Me;Cm(p.action)&&(_e.defaultPrevented||((Me=($e=p.action).onClick)==null||Me.call($e,_e),bn()))},className:O(I==null?void 0:I.actionButton,(m=p==null?void 0:p.classNames)==null?void 0:m.actionButton)},p.action.label):null))};function hS(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}var Sz=t=>{let{invert:e,position:n="bottom-right",hotkey:r=["altKey","KeyT"],expand:a,closeButton:i,className:o,offset:c,theme:d="light",richColors:u,duration:m,style:f,visibleToasts:p=gz,toastOptions:x,dir:j=hS(),gap:v=_z,loadingIcon:_,icons:b,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:N,cn:S=jz}=t,[C,A]=Ae.useState([]),P=Ae.useMemo(()=>Array.from(new Set([n].concat(C.filter(F=>F.position).map(F=>F.position)))),[C,n]),[M,z]=Ae.useState([]),[R,D]=Ae.useState(!1),[B,W]=Ae.useState(!1),[X,ue]=Ae.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),de=Ae.useRef(null),G=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),I=Ae.useRef(null),V=Ae.useRef(!1),$=Ae.useCallback(F=>{var O;(O=C.find(K=>K.id===F.id))!=null&&O.delete||rr.dismiss(F.id),A(K=>K.filter(({id:U})=>U!==F.id))},[C]);return Ae.useEffect(()=>rr.subscribe(F=>{if(F.dismiss){A(O=>O.map(K=>K.id===F.id?{...K,delete:!0}:K));return}setTimeout(()=>{PA.flushSync(()=>{A(O=>{let K=O.findIndex(U=>U.id===F.id);return K!==-1?[...O.slice(0,K),{...O[K],...F},...O.slice(K+1)]:[F,...O]})})})}),[]),Ae.useEffect(()=>{if(d!=="system"){ue(d);return}d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ue("dark"):ue("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:F})=>{ue(F?"dark":"light")})},[d]),Ae.useEffect(()=>{C.length<=1&&D(!1)},[C]),Ae.useEffect(()=>{let F=O=>{var K,U;r.every(te=>O[te]||O.code===te)&&(D(!0),(K=de.current)==null||K.focus()),O.code==="Escape"&&(document.activeElement===de.current||(U=de.current)!=null&&U.contains(document.activeElement))&&D(!1)};return document.addEventListener("keydown",F),()=>document.removeEventListener("keydown",F)},[r]),Ae.useEffect(()=>{if(de.current)return()=>{I.current&&(I.current.focus({preventScroll:!0}),I.current=null,V.current=!1)}},[de.current]),C.length?Ae.createElement("section",{"aria-label":`${w} ${G}`,tabIndex:-1},P.map((F,O)=>{var K;let[U,te]=F.split("-");return Ae.createElement("ol",{key:F,dir:j==="auto"?hS():j,tabIndex:-1,ref:de,className:o,"data-sonner-toaster":!0,"data-theme":X,"data-y-position":U,"data-x-position":te,style:{"--front-toast-height":`${((K=M[0])==null?void 0:K.height)||0}px`,"--offset":typeof c=="number"?`${c}px`:c||xz,"--width":`${yz}px`,"--gap":`${v}px`,...f},onBlur:J=>{V.current&&!J.currentTarget.contains(J.relatedTarget)&&(V.current=!1,I.current&&(I.current.focus({preventScroll:!0}),I.current=null))},onFocus:J=>{J.target instanceof HTMLElement&&J.target.dataset.dismissible==="false"||V.current||(V.current=!0,I.current=J.relatedTarget)},onMouseEnter:()=>D(!0),onMouseMove:()=>D(!0),onMouseLeave:()=>{B||D(!1)},onPointerDown:J=>{J.target instanceof HTMLElement&&J.target.dataset.dismissible==="false"||W(!0)},onPointerUp:()=>W(!1)},C.filter(J=>!J.position&&O===0||J.position===F).map((J,q)=>{var ne,pe;return Ae.createElement(Nz,{key:J.id,icons:b,index:q,toast:J,defaultRichColors:u,duration:(ne=x==null?void 0:x.duration)!=null?ne:m,className:x==null?void 0:x.className,descriptionClassName:x==null?void 0:x.descriptionClassName,invert:e,visibleToasts:p,closeButton:(pe=x==null?void 0:x.closeButton)!=null?pe:i,interacting:B,position:F,style:x==null?void 0:x.style,unstyled:x==null?void 0:x.unstyled,classNames:x==null?void 0:x.classNames,cancelButtonStyle:x==null?void 0:x.cancelButtonStyle,actionButtonStyle:x==null?void 0:x.actionButtonStyle,removeToast:$,toasts:C.filter(Q=>Q.position==J.position),heights:M.filter(Q=>Q.position==J.position),setHeights:z,expandByDefault:a,gap:v,loadingIcon:_,expanded:R,pauseWhenPageIsHidden:N,cn:S})}))})):null};const kz=({...t})=>{const{actualTheme:e}=ej();return s.jsx(Sz,{theme:e,className:"toaster group",position:"top-center",offset:80,toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var Cz=CE.useId||(()=>{}),Ez=0;function dr(t){const[e,n]=g.useState(Cz());return Bn(()=>{t||n(r=>r??String(Ez++))},[t]),t||(e?`radix-${e}`:"")}const Az=["top","right","bottom","left"],Ao=Math.min,ir=Math.max,t0=Math.round,Em=Math.floor,Po=t=>({x:t,y:t}),Pz={left:"right",right:"left",bottom:"top",top:"bottom"},Dz={start:"end",end:"start"};function F_(t,e,n){return ir(t,Ao(e,n))}function ji(t,e){return typeof t=="function"?t(e):t}function Ni(t){return t.split("-")[0]}function $d(t){return t.split("-")[1]}function tj(t){return t==="x"?"y":"x"}function nj(t){return t==="y"?"height":"width"}function Do(t){return["top","bottom"].includes(Ni(t))?"y":"x"}function sj(t){return tj(Do(t))}function Tz(t,e,n){n===void 0&&(n=!1);const r=$d(t),a=sj(t),i=nj(a);let o=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=n0(o)),[o,n0(o)]}function Mz(t){const e=n0(t);return[B_(t),e,B_(e)]}function B_(t){return t.replace(/start|end/g,e=>Dz[e])}function Rz(t,e,n){const r=["left","right"],a=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?a:r:e?r:a;case"left":case"right":return e?i:o;default:return[]}}function Iz(t,e,n,r){const a=$d(t);let i=Rz(Ni(t),n==="start",r);return a&&(i=i.map(o=>o+"-"+a),e&&(i=i.concat(i.map(B_)))),i}function n0(t){return t.replace(/left|right|bottom|top/g,e=>Pz[e])}function Oz(t){return{top:0,right:0,bottom:0,left:0,...t}}function bP(t){return typeof t!="number"?Oz(t):{top:t,right:t,bottom:t,left:t}}function s0(t){const{x:e,y:n,width:r,height:a}=t;return{width:r,height:a,top:n,left:e,right:e+r,bottom:n+a,x:e,y:n}}function fS(t,e,n){let{reference:r,floating:a}=t;const i=Do(e),o=sj(e),c=nj(o),d=Ni(e),u=i==="y",m=r.x+r.width/2-a.width/2,f=r.y+r.height/2-a.height/2,p=r[c]/2-a[c]/2;let x;switch(d){case"top":x={x:m,y:r.y-a.height};break;case"bottom":x={x:m,y:r.y+r.height};break;case"right":x={x:r.x+r.width,y:f};break;case"left":x={x:r.x-a.width,y:f};break;default:x={x:r.x,y:r.y}}switch($d(e)){case"start":x[o]-=p*(n&&u?-1:1);break;case"end":x[o]+=p*(n&&u?-1:1);break}return x}const Lz=async(t,e,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:i=[],platform:o}=n,c=i.filter(Boolean),d=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:a}),{x:m,y:f}=fS(u,r,d),p=r,x={},j=0;for(let v=0;v<c.length;v++){const{name:_,fn:b}=c[v],{x:w,y:N,data:S,reset:C}=await b({x:m,y:f,initialPlacement:r,placement:p,strategy:a,middlewareData:x,rects:u,platform:o,elements:{reference:t,floating:e}});m=w??m,f=N??f,x={...x,[_]:{...x[_],...S}},C&&j<=50&&(j++,typeof C=="object"&&(C.placement&&(p=C.placement),C.rects&&(u=C.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:a}):C.rects),{x:m,y:f}=fS(u,p,d)),v=-1)}return{x:m,y:f,placement:p,strategy:a,middlewareData:x}};async function Th(t,e){var n;e===void 0&&(e={});const{x:r,y:a,platform:i,rects:o,elements:c,strategy:d}=t,{boundary:u="clippingAncestors",rootBoundary:m="viewport",elementContext:f="floating",altBoundary:p=!1,padding:x=0}=ji(e,t),j=bP(x),_=c[p?f==="floating"?"reference":"floating":f],b=s0(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(_)))==null||n?_:_.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(c.floating)),boundary:u,rootBoundary:m,strategy:d})),w=f==="floating"?{x:r,y:a,width:o.floating.width,height:o.floating.height}:o.reference,N=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c.floating)),S=await(i.isElement==null?void 0:i.isElement(N))?await(i.getScale==null?void 0:i.getScale(N))||{x:1,y:1}:{x:1,y:1},C=s0(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:w,offsetParent:N,strategy:d}):w);return{top:(b.top-C.top+j.top)/S.y,bottom:(C.bottom-b.bottom+j.bottom)/S.y,left:(b.left-C.left+j.left)/S.x,right:(C.right-b.right+j.right)/S.x}}const Fz=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:a,rects:i,platform:o,elements:c,middlewareData:d}=e,{element:u,padding:m=0}=ji(t,e)||{};if(u==null)return{};const f=bP(m),p={x:n,y:r},x=sj(a),j=nj(x),v=await o.getDimensions(u),_=x==="y",b=_?"top":"left",w=_?"bottom":"right",N=_?"clientHeight":"clientWidth",S=i.reference[j]+i.reference[x]-p[x]-i.floating[j],C=p[x]-i.reference[x],A=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let P=A?A[N]:0;(!P||!await(o.isElement==null?void 0:o.isElement(A)))&&(P=c.floating[N]||i.floating[j]);const M=S/2-C/2,z=P/2-v[j]/2-1,R=Ao(f[b],z),D=Ao(f[w],z),B=R,W=P-v[j]-D,X=P/2-v[j]/2+M,ue=F_(B,X,W),de=!d.arrow&&$d(a)!=null&&X!==ue&&i.reference[j]/2-(X<B?R:D)-v[j]/2<0,G=de?X<B?X-B:X-W:0;return{[x]:p[x]+G,data:{[x]:ue,centerOffset:X-ue-G,...de&&{alignmentOffset:G}},reset:de}}}),Bz=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:a,middlewareData:i,rects:o,initialPlacement:c,platform:d,elements:u}=e,{mainAxis:m=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:x="bestFit",fallbackAxisSideDirection:j="none",flipAlignment:v=!0,..._}=ji(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const b=Ni(a),w=Do(c),N=Ni(c)===c,S=await(d.isRTL==null?void 0:d.isRTL(u.floating)),C=p||(N||!v?[n0(c)]:Mz(c)),A=j!=="none";!p&&A&&C.push(...Iz(c,v,j,S));const P=[c,...C],M=await Th(e,_),z=[];let R=((r=i.flip)==null?void 0:r.overflows)||[];if(m&&z.push(M[b]),f){const X=Tz(a,o,S);z.push(M[X[0]],M[X[1]])}if(R=[...R,{placement:a,overflows:z}],!z.every(X=>X<=0)){var D,B;const X=(((D=i.flip)==null?void 0:D.index)||0)+1,ue=P[X];if(ue)return{data:{index:X,overflows:R},reset:{placement:ue}};let de=(B=R.filter(G=>G.overflows[0]<=0).sort((G,I)=>G.overflows[1]-I.overflows[1])[0])==null?void 0:B.placement;if(!de)switch(x){case"bestFit":{var W;const G=(W=R.filter(I=>{if(A){const V=Do(I.placement);return V===w||V==="y"}return!0}).map(I=>[I.placement,I.overflows.filter(V=>V>0).reduce((V,$)=>V+$,0)]).sort((I,V)=>I[1]-V[1])[0])==null?void 0:W[0];G&&(de=G);break}case"initialPlacement":de=c;break}if(a!==de)return{reset:{placement:de}}}return{}}}};function mS(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function pS(t){return Az.some(e=>t[e]>=0)}const zz=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...a}=ji(t,e);switch(r){case"referenceHidden":{const i=await Th(e,{...a,elementContext:"reference"}),o=mS(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:pS(o)}}}case"escaped":{const i=await Th(e,{...a,altBoundary:!0}),o=mS(i,n.floating);return{data:{escapedOffsets:o,escaped:pS(o)}}}default:return{}}}}};async function $z(t,e){const{placement:n,platform:r,elements:a}=t,i=await(r.isRTL==null?void 0:r.isRTL(a.floating)),o=Ni(n),c=$d(n),d=Do(n)==="y",u=["left","top"].includes(o)?-1:1,m=i&&d?-1:1,f=ji(e,t);let{mainAxis:p,crossAxis:x,alignmentAxis:j}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return c&&typeof j=="number"&&(x=c==="end"?j*-1:j),d?{x:x*m,y:p*u}:{x:p*u,y:x*m}}const Uz=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:a,y:i,placement:o,middlewareData:c}=e,d=await $z(e,t);return o===((n=c.offset)==null?void 0:n.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:a+d.x,y:i+d.y,data:{...d,placement:o}}}}},qz=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:a}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:c={fn:_=>{let{x:b,y:w}=_;return{x:b,y:w}}},...d}=ji(t,e),u={x:n,y:r},m=await Th(e,d),f=Do(Ni(a)),p=tj(f);let x=u[p],j=u[f];if(i){const _=p==="y"?"top":"left",b=p==="y"?"bottom":"right",w=x+m[_],N=x-m[b];x=F_(w,x,N)}if(o){const _=f==="y"?"top":"left",b=f==="y"?"bottom":"right",w=j+m[_],N=j-m[b];j=F_(w,j,N)}const v=c.fn({...e,[p]:x,[f]:j});return{...v,data:{x:v.x-n,y:v.y-r,enabled:{[p]:i,[f]:o}}}}}},Wz=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:a,rects:i,middlewareData:o}=e,{offset:c=0,mainAxis:d=!0,crossAxis:u=!0}=ji(t,e),m={x:n,y:r},f=Do(a),p=tj(f);let x=m[p],j=m[f];const v=ji(c,e),_=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(d){const N=p==="y"?"height":"width",S=i.reference[p]-i.floating[N]+_.mainAxis,C=i.reference[p]+i.reference[N]-_.mainAxis;x<S?x=S:x>C&&(x=C)}if(u){var b,w;const N=p==="y"?"width":"height",S=["top","left"].includes(Ni(a)),C=i.reference[f]-i.floating[N]+(S&&((b=o.offset)==null?void 0:b[f])||0)+(S?0:_.crossAxis),A=i.reference[f]+i.reference[N]+(S?0:((w=o.offset)==null?void 0:w[f])||0)-(S?_.crossAxis:0);j<C?j=C:j>A&&(j=A)}return{[p]:x,[f]:j}}}},Hz=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:a,rects:i,platform:o,elements:c}=e,{apply:d=()=>{},...u}=ji(t,e),m=await Th(e,u),f=Ni(a),p=$d(a),x=Do(a)==="y",{width:j,height:v}=i.floating;let _,b;f==="top"||f==="bottom"?(_=f,b=p===(await(o.isRTL==null?void 0:o.isRTL(c.floating))?"start":"end")?"left":"right"):(b=f,_=p==="end"?"top":"bottom");const w=v-m.top-m.bottom,N=j-m.left-m.right,S=Ao(v-m[_],w),C=Ao(j-m[b],N),A=!e.middlewareData.shift;let P=S,M=C;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(M=N),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(P=w),A&&!p){const R=ir(m.left,0),D=ir(m.right,0),B=ir(m.top,0),W=ir(m.bottom,0);x?M=j-2*(R!==0||D!==0?R+D:ir(m.left,m.right)):P=v-2*(B!==0||W!==0?B+W:ir(m.top,m.bottom))}await d({...e,availableWidth:M,availableHeight:P});const z=await o.getDimensions(c.floating);return j!==z.width||v!==z.height?{reset:{rects:!0}}:{}}}};function lg(){return typeof window<"u"}function Ud(t){return jP(t)?(t.nodeName||"").toLowerCase():"#document"}function ur(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Ka(t){var e;return(e=(jP(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function jP(t){return lg()?t instanceof Node||t instanceof ur(t).Node:!1}function ca(t){return lg()?t instanceof Element||t instanceof ur(t).Element:!1}function Wa(t){return lg()?t instanceof HTMLElement||t instanceof ur(t).HTMLElement:!1}function gS(t){return!lg()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof ur(t).ShadowRoot}function _f(t){const{overflow:e,overflowX:n,overflowY:r,display:a}=da(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(a)}function Vz(t){return["table","td","th"].includes(Ud(t))}function cg(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function rj(t){const e=aj(),n=ca(t)?da(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Kz(t){let e=To(t);for(;Wa(e)&&!bd(e);){if(rj(e))return e;if(cg(e))return null;e=To(e)}return null}function aj(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function bd(t){return["html","body","#document"].includes(Ud(t))}function da(t){return ur(t).getComputedStyle(t)}function dg(t){return ca(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function To(t){if(Ud(t)==="html")return t;const e=t.assignedSlot||t.parentNode||gS(t)&&t.host||Ka(t);return gS(e)?e.host:e}function NP(t){const e=To(t);return bd(e)?t.ownerDocument?t.ownerDocument.body:t.body:Wa(e)&&_f(e)?e:NP(e)}function Mh(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const a=NP(t),i=a===((r=t.ownerDocument)==null?void 0:r.body),o=ur(a);if(i){const c=z_(o);return e.concat(o,o.visualViewport||[],_f(a)?a:[],c&&n?Mh(c):[])}return e.concat(a,Mh(a,[],n))}function z_(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function SP(t){const e=da(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const a=Wa(t),i=a?t.offsetWidth:n,o=a?t.offsetHeight:r,c=t0(n)!==i||t0(r)!==o;return c&&(n=i,r=o),{width:n,height:r,$:c}}function ij(t){return ca(t)?t:t.contextElement}function Qc(t){const e=ij(t);if(!Wa(e))return Po(1);const n=e.getBoundingClientRect(),{width:r,height:a,$:i}=SP(e);let o=(i?t0(n.width):n.width)/r,c=(i?t0(n.height):n.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!c||!Number.isFinite(c))&&(c=1),{x:o,y:c}}const Zz=Po(0);function kP(t){const e=ur(t);return!aj()||!e.visualViewport?Zz:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Gz(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==ur(t)?!1:e}function Ml(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const a=t.getBoundingClientRect(),i=ij(t);let o=Po(1);e&&(r?ca(r)&&(o=Qc(r)):o=Qc(t));const c=Gz(i,n,r)?kP(i):Po(0);let d=(a.left+c.x)/o.x,u=(a.top+c.y)/o.y,m=a.width/o.x,f=a.height/o.y;if(i){const p=ur(i),x=r&&ca(r)?ur(r):r;let j=p,v=z_(j);for(;v&&r&&x!==j;){const _=Qc(v),b=v.getBoundingClientRect(),w=da(v),N=b.left+(v.clientLeft+parseFloat(w.paddingLeft))*_.x,S=b.top+(v.clientTop+parseFloat(w.paddingTop))*_.y;d*=_.x,u*=_.y,m*=_.x,f*=_.y,d+=N,u+=S,j=ur(v),v=z_(j)}}return s0({width:m,height:f,x:d,y:u})}function Qz(t){let{elements:e,rect:n,offsetParent:r,strategy:a}=t;const i=a==="fixed",o=Ka(r),c=e?cg(e.floating):!1;if(r===o||c&&i)return n;let d={scrollLeft:0,scrollTop:0},u=Po(1);const m=Po(0),f=Wa(r);if((f||!f&&!i)&&((Ud(r)!=="body"||_f(o))&&(d=dg(r)),Wa(r))){const p=Ml(r);u=Qc(r),m.x=p.x+r.clientLeft,m.y=p.y+r.clientTop}return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-d.scrollLeft*u.x+m.x,y:n.y*u.y-d.scrollTop*u.y+m.y}}function Yz(t){return Array.from(t.getClientRects())}function $_(t,e){const n=dg(t).scrollLeft;return e?e.left+n:Ml(Ka(t)).left+n}function Xz(t){const e=Ka(t),n=dg(t),r=t.ownerDocument.body,a=ir(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=ir(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+$_(t);const c=-n.scrollTop;return da(r).direction==="rtl"&&(o+=ir(e.clientWidth,r.clientWidth)-a),{width:a,height:i,x:o,y:c}}function Jz(t,e){const n=ur(t),r=Ka(t),a=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,c=0,d=0;if(a){i=a.width,o=a.height;const u=aj();(!u||u&&e==="fixed")&&(c=a.offsetLeft,d=a.offsetTop)}return{width:i,height:o,x:c,y:d}}function e$(t,e){const n=Ml(t,!0,e==="fixed"),r=n.top+t.clientTop,a=n.left+t.clientLeft,i=Wa(t)?Qc(t):Po(1),o=t.clientWidth*i.x,c=t.clientHeight*i.y,d=a*i.x,u=r*i.y;return{width:o,height:c,x:d,y:u}}function xS(t,e,n){let r;if(e==="viewport")r=Jz(t,n);else if(e==="document")r=Xz(Ka(t));else if(ca(e))r=e$(e,n);else{const a=kP(t);r={...e,x:e.x-a.x,y:e.y-a.y}}return s0(r)}function CP(t,e){const n=To(t);return n===e||!ca(n)||bd(n)?!1:da(n).position==="fixed"||CP(n,e)}function t$(t,e){const n=e.get(t);if(n)return n;let r=Mh(t,[],!1).filter(c=>ca(c)&&Ud(c)!=="body"),a=null;const i=da(t).position==="fixed";let o=i?To(t):t;for(;ca(o)&&!bd(o);){const c=da(o),d=rj(o);!d&&c.position==="fixed"&&(a=null),(i?!d&&!a:!d&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||_f(o)&&!d&&CP(t,o))?r=r.filter(m=>m!==o):a=c,o=To(o)}return e.set(t,r),r}function n$(t){let{element:e,boundary:n,rootBoundary:r,strategy:a}=t;const o=[...n==="clippingAncestors"?cg(e)?[]:t$(e,this._c):[].concat(n),r],c=o[0],d=o.reduce((u,m)=>{const f=xS(e,m,a);return u.top=ir(f.top,u.top),u.right=Ao(f.right,u.right),u.bottom=Ao(f.bottom,u.bottom),u.left=ir(f.left,u.left),u},xS(e,c,a));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function s$(t){const{width:e,height:n}=SP(t);return{width:e,height:n}}function r$(t,e,n){const r=Wa(e),a=Ka(e),i=n==="fixed",o=Ml(t,!0,i,e);let c={scrollLeft:0,scrollTop:0};const d=Po(0);if(r||!r&&!i)if((Ud(e)!=="body"||_f(a))&&(c=dg(e)),r){const x=Ml(e,!0,i,e);d.x=x.x+e.clientLeft,d.y=x.y+e.clientTop}else a&&(d.x=$_(a));let u=0,m=0;if(a&&!r&&!i){const x=a.getBoundingClientRect();m=x.top+c.scrollTop,u=x.left+c.scrollLeft-$_(a,x)}const f=o.left+c.scrollLeft-d.x-u,p=o.top+c.scrollTop-d.y-m;return{x:f,y:p,width:o.width,height:o.height}}function iv(t){return da(t).position==="static"}function vS(t,e){if(!Wa(t)||da(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Ka(t)===n&&(n=n.ownerDocument.body),n}function EP(t,e){const n=ur(t);if(cg(t))return n;if(!Wa(t)){let a=To(t);for(;a&&!bd(a);){if(ca(a)&&!iv(a))return a;a=To(a)}return n}let r=vS(t,e);for(;r&&Vz(r)&&iv(r);)r=vS(r,e);return r&&bd(r)&&iv(r)&&!rj(r)?n:r||Kz(t)||n}const a$=async function(t){const e=this.getOffsetParent||EP,n=this.getDimensions,r=await n(t.floating);return{reference:r$(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function i$(t){return da(t).direction==="rtl"}const o$={convertOffsetParentRelativeRectToViewportRelativeRect:Qz,getDocumentElement:Ka,getClippingRect:n$,getOffsetParent:EP,getElementRects:a$,getClientRects:Yz,getDimensions:s$,getScale:Qc,isElement:ca,isRTL:i$};function l$(t,e){let n=null,r;const a=Ka(t);function i(){var c;clearTimeout(r),(c=n)==null||c.disconnect(),n=null}function o(c,d){c===void 0&&(c=!1),d===void 0&&(d=1),i();const{left:u,top:m,width:f,height:p}=t.getBoundingClientRect();if(c||e(),!f||!p)return;const x=Em(m),j=Em(a.clientWidth-(u+f)),v=Em(a.clientHeight-(m+p)),_=Em(u),w={rootMargin:-x+"px "+-j+"px "+-v+"px "+-_+"px",threshold:ir(0,Ao(1,d))||1};let N=!0;function S(C){const A=C[0].intersectionRatio;if(A!==d){if(!N)return o();A?o(!1,A):r=setTimeout(()=>{o(!1,1e-7)},1e3)}N=!1}try{n=new IntersectionObserver(S,{...w,root:a.ownerDocument})}catch{n=new IntersectionObserver(S,w)}n.observe(t)}return o(!0),i}function c$(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:d=!1}=r,u=ij(t),m=a||i?[...u?Mh(u):[],...Mh(e)]:[];m.forEach(b=>{a&&b.addEventListener("scroll",n,{passive:!0}),i&&b.addEventListener("resize",n)});const f=u&&c?l$(u,n):null;let p=-1,x=null;o&&(x=new ResizeObserver(b=>{let[w]=b;w&&w.target===u&&x&&(x.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var N;(N=x)==null||N.observe(e)})),n()}),u&&!d&&x.observe(u),x.observe(e));let j,v=d?Ml(t):null;d&&_();function _(){const b=Ml(t);v&&(b.x!==v.x||b.y!==v.y||b.width!==v.width||b.height!==v.height)&&n(),v=b,j=requestAnimationFrame(_)}return n(),()=>{var b;m.forEach(w=>{a&&w.removeEventListener("scroll",n),i&&w.removeEventListener("resize",n)}),f==null||f(),(b=x)==null||b.disconnect(),x=null,d&&cancelAnimationFrame(j)}}const d$=Uz,u$=qz,h$=Bz,f$=Hz,m$=zz,yS=Fz,p$=Wz,g$=(t,e,n)=>{const r=new Map,a={platform:o$,...n},i={...a.platform,_c:r};return Lz(t,e,{...a,platform:i})};var fp=typeof document<"u"?g.useLayoutEffect:g.useEffect;function r0(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,a;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!r0(t[r],e[r]))return!1;return!0}if(a=Object.keys(t),n=a.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,a[r]))return!1;for(r=n;r--!==0;){const i=a[r];if(!(i==="_owner"&&t.$$typeof)&&!r0(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function AP(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function _S(t,e){const n=AP(t);return Math.round(e*n)/n}function ov(t){const e=g.useRef(t);return fp(()=>{e.current=t}),e}function x$(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:i,floating:o}={},transform:c=!0,whileElementsMounted:d,open:u}=t,[m,f]=g.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[p,x]=g.useState(r);r0(p,r)||x(r);const[j,v]=g.useState(null),[_,b]=g.useState(null),w=g.useCallback(I=>{I!==A.current&&(A.current=I,v(I))},[]),N=g.useCallback(I=>{I!==P.current&&(P.current=I,b(I))},[]),S=i||j,C=o||_,A=g.useRef(null),P=g.useRef(null),M=g.useRef(m),z=d!=null,R=ov(d),D=ov(a),B=ov(u),W=g.useCallback(()=>{if(!A.current||!P.current)return;const I={placement:e,strategy:n,middleware:p};D.current&&(I.platform=D.current),g$(A.current,P.current,I).then(V=>{const $={...V,isPositioned:B.current!==!1};X.current&&!r0(M.current,$)&&(M.current=$,Wl.flushSync(()=>{f($)}))})},[p,e,n,D,B]);fp(()=>{u===!1&&M.current.isPositioned&&(M.current.isPositioned=!1,f(I=>({...I,isPositioned:!1})))},[u]);const X=g.useRef(!1);fp(()=>(X.current=!0,()=>{X.current=!1}),[]),fp(()=>{if(S&&(A.current=S),C&&(P.current=C),S&&C){if(R.current)return R.current(S,C,W);W()}},[S,C,W,R,z]);const ue=g.useMemo(()=>({reference:A,floating:P,setReference:w,setFloating:N}),[w,N]),de=g.useMemo(()=>({reference:S,floating:C}),[S,C]),G=g.useMemo(()=>{const I={position:n,left:0,top:0};if(!de.floating)return I;const V=_S(de.floating,m.x),$=_S(de.floating,m.y);return c?{...I,transform:"translate("+V+"px, "+$+"px)",...AP(de.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:V,top:$}},[n,c,de.floating,m.x,m.y]);return g.useMemo(()=>({...m,update:W,refs:ue,elements:de,floatingStyles:G}),[m,W,ue,de,G])}const v$=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:a}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?yS({element:r.current,padding:a}).fn(n):{}:r?yS({element:r,padding:a}).fn(n):{}}}},y$=(t,e)=>({...d$(t),options:[t,e]}),_$=(t,e)=>({...u$(t),options:[t,e]}),w$=(t,e)=>({...p$(t),options:[t,e]}),b$=(t,e)=>({...h$(t),options:[t,e]}),j$=(t,e)=>({...f$(t),options:[t,e]}),N$=(t,e)=>({...m$(t),options:[t,e]}),S$=(t,e)=>({...v$(t),options:[t,e]});var k$="Arrow",PP=g.forwardRef((t,e)=>{const{children:n,width:r=10,height:a=5,...i}=t;return s.jsx(nt.svg,{...i,ref:e,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:s.jsx("polygon",{points:"0,0 30,0 15,10"})})});PP.displayName=k$;var C$=PP;function E$(t,e=[]){let n=[];function r(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:x,...j}=f,v=(p==null?void 0:p[t][d])||c,_=g.useMemo(()=>j,Object.values(j));return s.jsx(v.Provider,{value:_,children:x})}function m(f,p){const x=(p==null?void 0:p[t][d])||c,j=g.useContext(x);if(j)return j;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[r,A$(a,...e)]}function A$(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=r.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function DP(t){const[e,n]=g.useState(void 0);return Bn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,c;if("borderBoxSize"in i){const d=i.borderBoxSize,u=Array.isArray(d)?d[0]:d;o=u.inlineSize,c=u.blockSize}else o=t.offsetWidth,c=t.offsetHeight;n({width:o,height:c})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var oj="Popper",[TP,zo]=E$(oj),[P$,MP]=TP(oj),RP=t=>{const{__scopePopper:e,children:n}=t,[r,a]=g.useState(null);return s.jsx(P$,{scope:e,anchor:r,onAnchorChange:a,children:n})};RP.displayName=oj;var IP="PopperAnchor",OP=g.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...a}=t,i=MP(IP,n),o=g.useRef(null),c=Tt(e,o);return g.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:s.jsx(nt.div,{...a,ref:c})});OP.displayName=IP;var lj="PopperContent",[D$,T$]=TP(lj),LP=g.forwardRef((t,e)=>{var q,ne,pe,Q,re,me;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:c=0,avoidCollisions:d=!0,collisionBoundary:u=[],collisionPadding:m=0,sticky:f="partial",hideWhenDetached:p=!1,updatePositionStrategy:x="optimized",onPlaced:j,...v}=t,_=MP(lj,n),[b,w]=g.useState(null),N=Tt(e,he=>w(he)),[S,C]=g.useState(null),A=DP(S),P=(A==null?void 0:A.width)??0,M=(A==null?void 0:A.height)??0,z=r+(i!=="center"?"-"+i:""),R=typeof m=="number"?m:{top:0,right:0,bottom:0,left:0,...m},D=Array.isArray(u)?u:[u],B=D.length>0,W={padding:R,boundary:D.filter(R$),altBoundary:B},{refs:X,floatingStyles:ue,placement:de,isPositioned:G,middlewareData:I}=x$({strategy:"fixed",placement:z,whileElementsMounted:(...he)=>c$(...he,{animationFrame:x==="always"}),elements:{reference:_.anchor},middleware:[y$({mainAxis:a+M,alignmentAxis:o}),d&&_$({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?w$():void 0,...W}),d&&b$({...W}),j$({...W,apply:({elements:he,rects:ge,availableWidth:se,availableHeight:we})=>{const{width:Se,height:qe}=ge.reference,Ye=he.floating.style;Ye.setProperty("--radix-popper-available-width",`${se}px`),Ye.setProperty("--radix-popper-available-height",`${we}px`),Ye.setProperty("--radix-popper-anchor-width",`${Se}px`),Ye.setProperty("--radix-popper-anchor-height",`${qe}px`)}}),S&&S$({element:S,padding:c}),I$({arrowWidth:P,arrowHeight:M}),p&&N$({strategy:"referenceHidden",...W})]}),[V,$]=zP(de),F=_n(j);Bn(()=>{G&&(F==null||F())},[G,F]);const O=(q=I.arrow)==null?void 0:q.x,K=(ne=I.arrow)==null?void 0:ne.y,U=((pe=I.arrow)==null?void 0:pe.centerOffset)!==0,[te,J]=g.useState();return Bn(()=>{b&&J(window.getComputedStyle(b).zIndex)},[b]),s.jsx("div",{ref:X.setFloating,"data-radix-popper-content-wrapper":"",style:{...ue,transform:G?ue.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:te,"--radix-popper-transform-origin":[(Q=I.transformOrigin)==null?void 0:Q.x,(re=I.transformOrigin)==null?void 0:re.y].join(" "),...((me=I.hide)==null?void 0:me.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:s.jsx(D$,{scope:n,placedSide:V,onArrowChange:C,arrowX:O,arrowY:K,shouldHideArrow:U,children:s.jsx(nt.div,{"data-side":V,"data-align":$,...v,ref:N,style:{...v.style,animation:G?void 0:"none"}})})})});LP.displayName=lj;var FP="PopperArrow",M$={top:"bottom",right:"left",bottom:"top",left:"right"},BP=g.forwardRef(function(e,n){const{__scopePopper:r,...a}=e,i=T$(FP,r),o=M$[i.placedSide];return s.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:s.jsx(C$,{...a,ref:n,style:{...a.style,display:"block"}})})});BP.displayName=FP;function R$(t){return t!==null}var I$=t=>({name:"transformOrigin",options:t,fn(e){var _,b,w;const{placement:n,rects:r,middlewareData:a}=e,o=((_=a.arrow)==null?void 0:_.centerOffset)!==0,c=o?0:t.arrowWidth,d=o?0:t.arrowHeight,[u,m]=zP(n),f={start:"0%",center:"50%",end:"100%"}[m],p=(((b=a.arrow)==null?void 0:b.x)??0)+c/2,x=(((w=a.arrow)==null?void 0:w.y)??0)+d/2;let j="",v="";return u==="bottom"?(j=o?f:`${p}px`,v=`${-d}px`):u==="top"?(j=o?f:`${p}px`,v=`${r.floating.height+d}px`):u==="right"?(j=`${-d}px`,v=o?f:`${x}px`):u==="left"&&(j=`${r.floating.width+d}px`,v=o?f:`${x}px`),{data:{x:j,y:v}}}});function zP(t){const[e,n="center"]=t.split("-");return[e,n]}var cj=RP,wf=OP,ug=LP,hg=BP,[fg,Vre]=wr("Tooltip",[zo]),dj=zo(),$P="TooltipProvider",O$=700,wS="tooltip.open",[L$,UP]=fg($P),qP=t=>{const{__scopeTooltip:e,delayDuration:n=O$,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:i}=t,[o,c]=g.useState(!0),d=g.useRef(!1),u=g.useRef(0);return g.useEffect(()=>{const m=u.current;return()=>window.clearTimeout(m)},[]),s.jsx(L$,{scope:e,isOpenDelayed:o,delayDuration:n,onOpen:g.useCallback(()=>{window.clearTimeout(u.current),c(!1)},[]),onClose:g.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>c(!0),r)},[r]),isPointerInTransitRef:d,onPointerInTransitChange:g.useCallback(m=>{d.current=m},[]),disableHoverableContent:a,children:i})};qP.displayName=$P;var WP="Tooltip",[Kre,mg]=fg(WP),U_="TooltipTrigger",F$=g.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,a=mg(U_,n),i=UP(U_,n),o=dj(n),c=g.useRef(null),d=Tt(e,c,a.onTriggerChange),u=g.useRef(!1),m=g.useRef(!1),f=g.useCallback(()=>u.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),s.jsx(wf,{asChild:!0,...o,children:s.jsx(nt.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:d,onPointerMove:Re(t.onPointerMove,p=>{p.pointerType!=="touch"&&!m.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),m.current=!0)}),onPointerLeave:Re(t.onPointerLeave,()=>{a.onTriggerLeave(),m.current=!1}),onPointerDown:Re(t.onPointerDown,()=>{u.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:Re(t.onFocus,()=>{u.current||a.onOpen()}),onBlur:Re(t.onBlur,a.onClose),onClick:Re(t.onClick,a.onClose)})})});F$.displayName=U_;var B$="TooltipPortal",[Zre,z$]=fg(B$,{forceMount:void 0}),jd="TooltipContent",HP=g.forwardRef((t,e)=>{const n=z$(jd,t.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...i}=t,o=mg(jd,t.__scopeTooltip);return s.jsx(Gn,{present:r||o.open,children:o.disableHoverableContent?s.jsx(VP,{side:a,...i,ref:e}):s.jsx($$,{side:a,...i,ref:e})})}),$$=g.forwardRef((t,e)=>{const n=mg(jd,t.__scopeTooltip),r=UP(jd,t.__scopeTooltip),a=g.useRef(null),i=Tt(e,a),[o,c]=g.useState(null),{trigger:d,onClose:u}=n,m=a.current,{onPointerInTransitChange:f}=r,p=g.useCallback(()=>{c(null),f(!1)},[f]),x=g.useCallback((j,v)=>{const _=j.currentTarget,b={x:j.clientX,y:j.clientY},w=H$(b,_.getBoundingClientRect()),N=V$(b,w),S=K$(v.getBoundingClientRect()),C=G$([...N,...S]);c(C),f(!0)},[f]);return g.useEffect(()=>()=>p(),[p]),g.useEffect(()=>{if(d&&m){const j=_=>x(_,m),v=_=>x(_,d);return d.addEventListener("pointerleave",j),m.addEventListener("pointerleave",v),()=>{d.removeEventListener("pointerleave",j),m.removeEventListener("pointerleave",v)}}},[d,m,x,p]),g.useEffect(()=>{if(o){const j=v=>{const _=v.target,b={x:v.clientX,y:v.clientY},w=(d==null?void 0:d.contains(_))||(m==null?void 0:m.contains(_)),N=!Z$(b,o);w?p():N&&(p(),u())};return document.addEventListener("pointermove",j),()=>document.removeEventListener("pointermove",j)}},[d,m,o,u,p]),s.jsx(VP,{...t,ref:i})}),[U$,q$]=fg(WP,{isInside:!1}),VP=g.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...c}=t,d=mg(jd,n),u=dj(n),{onClose:m}=d;return g.useEffect(()=>(document.addEventListener(wS,m),()=>document.removeEventListener(wS,m)),[m]),g.useEffect(()=>{if(d.trigger){const f=p=>{const x=p.target;x!=null&&x.contains(d.trigger)&&m()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[d.trigger,m]),s.jsx(Hl,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:m,children:s.jsxs(ug,{"data-state":d.stateAttribute,...u,...c,ref:e,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[s.jsx(TA,{children:r}),s.jsx(U$,{scope:n,isInside:!0,children:s.jsx(SF,{id:d.contentId,role:"tooltip",children:a||r})})]})})});HP.displayName=jd;var KP="TooltipArrow",W$=g.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,a=dj(n);return q$(KP,n).isInside?null:s.jsx(hg,{...a,...r,ref:e})});W$.displayName=KP;function H$(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),a=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,a,i)){case i:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function V$(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function K$(t){const{top:e,right:n,bottom:r,left:a}=t;return[{x:a,y:e},{x:n,y:e},{x:n,y:r},{x:a,y:r}]}function Z$(t,e){const{x:n,y:r}=t;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const c=e[i].x,d=e[i].y,u=e[o].x,m=e[o].y;d>r!=m>r&&n<(u-c)*(r-d)/(m-d)+c&&(a=!a)}return a}function G$(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),Q$(e)}function Q$(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const a=t[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))e.pop();else break}e.push(a)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const a=t[r];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))n.pop();else break}n.push(a)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var Y$=qP,ZP=HP;const X$=Y$,J$=g.forwardRef(({className:t,sideOffset:e=4,...n},r)=>s.jsx(ZP,{ref:r,sideOffset:e,className:Te("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));J$.displayName=ZP.displayName;var qd=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Rl=typeof window>"u"||"Deno"in globalThis;function Cr(){}function e9(t,e){return typeof t=="function"?t(e):t}function q_(t){return typeof t=="number"&&t>=0&&t!==1/0}function GP(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Yc(t,e){return typeof t=="function"?t(e):t}function Yr(t,e){return typeof t=="function"?t(e):t}function bS(t,e){const{type:n="all",exact:r,fetchStatus:a,predicate:i,queryKey:o,stale:c}=t;if(o){if(r){if(e.queryHash!==uj(o,e.options))return!1}else if(!Rh(e.queryKey,o))return!1}if(n!=="all"){const d=e.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||a&&a!==e.state.fetchStatus||i&&!i(e))}function jS(t,e){const{exact:n,status:r,predicate:a,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(Il(e.options.mutationKey)!==Il(i))return!1}else if(!Rh(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||a&&!a(e))}function uj(t,e){return((e==null?void 0:e.queryKeyHashFn)||Il)(t)}function Il(t){return JSON.stringify(t,(e,n)=>W_(n)?Object.keys(n).sort().reduce((r,a)=>(r[a]=n[a],r),{}):n)}function Rh(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(n=>!Rh(t[n],e[n])):!1}function QP(t,e){if(t===e)return t;const n=NS(t)&&NS(e);if(n||W_(t)&&W_(e)){const r=n?t:Object.keys(t),a=r.length,i=n?e:Object.keys(e),o=i.length,c=n?[]:{};let d=0;for(let u=0;u<o;u++){const m=n?u:i[u];(!n&&r.includes(m)||n)&&t[m]===void 0&&e[m]===void 0?(c[m]=void 0,d++):(c[m]=QP(t[m],e[m]),c[m]===t[m]&&t[m]!==void 0&&d++)}return a===o&&d===a?t:c}return e}function a0(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function NS(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function W_(t){if(!SS(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!SS(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function SS(t){return Object.prototype.toString.call(t)==="[object Object]"}function t9(t){return new Promise(e=>{setTimeout(e,t)})}function H_(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?QP(t,e):e}function n9(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function s9(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var hj=Symbol();function YP(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===hj?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var ml,eo,nd,aE,r9=(aE=class extends qd{constructor(){super();vt(this,ml);vt(this,eo);vt(this,nd);Ke(this,nd,e=>{if(!Rl&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){le(this,eo)||this.setEventListener(le(this,nd))}onUnsubscribe(){var e;this.hasListeners()||((e=le(this,eo))==null||e.call(this),Ke(this,eo,void 0))}setEventListener(e){var n;Ke(this,nd,e),(n=le(this,eo))==null||n.call(this),Ke(this,eo,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){le(this,ml)!==e&&(Ke(this,ml,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof le(this,ml)=="boolean"?le(this,ml):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},ml=new WeakMap,eo=new WeakMap,nd=new WeakMap,aE),fj=new r9,sd,to,rd,iE,a9=(iE=class extends qd{constructor(){super();vt(this,sd,!0);vt(this,to);vt(this,rd);Ke(this,rd,e=>{if(!Rl&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){le(this,to)||this.setEventListener(le(this,rd))}onUnsubscribe(){var e;this.hasListeners()||((e=le(this,to))==null||e.call(this),Ke(this,to,void 0))}setEventListener(e){var n;Ke(this,rd,e),(n=le(this,to))==null||n.call(this),Ke(this,to,e(this.setOnline.bind(this)))}setOnline(e){le(this,sd)!==e&&(Ke(this,sd,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return le(this,sd)}},sd=new WeakMap,to=new WeakMap,rd=new WeakMap,iE),i0=new a9;function V_(){let t,e;const n=new Promise((a,i)=>{t=a,e=i});n.status="pending",n.catch(()=>{});function r(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{r({status:"fulfilled",value:a}),t(a)},n.reject=a=>{r({status:"rejected",reason:a}),e(a)},n}function i9(t){return Math.min(1e3*2**t,3e4)}function XP(t){return(t??"online")==="online"?i0.isOnline():!0}var JP=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function lv(t){return t instanceof JP}function eD(t){let e=!1,n=0,r=!1,a;const i=V_(),o=v=>{var _;r||(p(new JP(v)),(_=t.abort)==null||_.call(t))},c=()=>{e=!0},d=()=>{e=!1},u=()=>fj.isFocused()&&(t.networkMode==="always"||i0.isOnline())&&t.canRun(),m=()=>XP(t.networkMode)&&t.canRun(),f=v=>{var _;r||(r=!0,(_=t.onSuccess)==null||_.call(t,v),a==null||a(),i.resolve(v))},p=v=>{var _;r||(r=!0,(_=t.onError)==null||_.call(t,v),a==null||a(),i.reject(v))},x=()=>new Promise(v=>{var _;a=b=>{(r||u())&&v(b)},(_=t.onPause)==null||_.call(t)}).then(()=>{var v;a=void 0,r||(v=t.onContinue)==null||v.call(t)}),j=()=>{if(r)return;let v;const _=n===0?t.initialPromise:void 0;try{v=_??t.fn()}catch(b){v=Promise.reject(b)}Promise.resolve(v).then(f).catch(b=>{var A;if(r)return;const w=t.retry??(Rl?0:3),N=t.retryDelay??i9,S=typeof N=="function"?N(n,b):N,C=w===!0||typeof w=="number"&&n<w||typeof w=="function"&&w(n,b);if(e||!C){p(b);return}n++,(A=t.onFail)==null||A.call(t,n,b),t9(S).then(()=>u()?void 0:x()).then(()=>{e?p(b):j()})})};return{promise:i,cancel:o,continue:()=>(a==null||a(),i),cancelRetry:c,continueRetry:d,canStart:m,start:()=>(m()?j():x().then(j),i)}}function o9(){let t=[],e=0,n=c=>{c()},r=c=>{c()},a=c=>setTimeout(c,0);const i=c=>{e?t.push(c):a(()=>{n(c)})},o=()=>{const c=t;t=[],c.length&&a(()=>{r(()=>{c.forEach(d=>{n(d)})})})};return{batch:c=>{let d;e++;try{d=c()}finally{e--,e||o()}return d},batchCalls:c=>(...d)=>{i(()=>{c(...d)})},schedule:i,setNotifyFunction:c=>{n=c},setBatchNotifyFunction:c=>{r=c},setScheduler:c=>{a=c}}}var Kn=o9(),pl,oE,tD=(oE=class{constructor(){vt(this,pl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),q_(this.gcTime)&&Ke(this,pl,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Rl?1/0:5*60*1e3))}clearGcTimeout(){le(this,pl)&&(clearTimeout(le(this,pl)),Ke(this,pl,void 0))}},pl=new WeakMap,oE),ad,id,kr,_s,af,gl,Kr,ri,lE,l9=(lE=class extends tD{constructor(e){super();vt(this,Kr);vt(this,ad);vt(this,id);vt(this,kr);vt(this,_s);vt(this,af);vt(this,gl);Ke(this,gl,!1),Ke(this,af,e.defaultOptions),this.setOptions(e.options),this.observers=[],Ke(this,kr,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Ke(this,ad,c9(this.options)),this.state=e.state??le(this,ad),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=le(this,_s))==null?void 0:e.promise}setOptions(e){this.options={...le(this,af),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&le(this,kr).remove(this)}setData(e,n){const r=H_(this.state.data,e,this.options);return Ot(this,Kr,ri).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){Ot(this,Kr,ri).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,a;const n=(r=le(this,_s))==null?void 0:r.promise;return(a=le(this,_s))==null||a.cancel(e),n?n.then(Cr).catch(Cr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(le(this,ad))}isActive(){return this.observers.some(e=>Yr(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===hj||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!GP(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=le(this,_s))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=le(this,_s))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),le(this,kr).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(le(this,_s)&&(le(this,gl)?le(this,_s).cancel({revert:!0}):le(this,_s).cancelRetry()),this.scheduleGc()),le(this,kr).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ot(this,Kr,ri).call(this,{type:"invalidate"})}fetch(e,n){var d,u,m;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(le(this,_s))return le(this,_s).continueRetry(),le(this,_s).promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const r=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(Ke(this,gl,!0),r.signal)})},i=()=>{const f=YP(this.options,n),p={queryKey:this.queryKey,meta:this.meta};return a(p),Ke(this,gl,!1),this.options.persister?this.options.persister(f,p,this):f(p)},o={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};a(o),(d=this.options.behavior)==null||d.onFetch(o,this),Ke(this,id,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=o.fetchOptions)==null?void 0:u.meta))&&Ot(this,Kr,ri).call(this,{type:"fetch",meta:(m=o.fetchOptions)==null?void 0:m.meta});const c=f=>{var p,x,j,v;lv(f)&&f.silent||Ot(this,Kr,ri).call(this,{type:"error",error:f}),lv(f)||((x=(p=le(this,kr).config).onError)==null||x.call(p,f,this),(v=(j=le(this,kr).config).onSettled)==null||v.call(j,this.state.data,f,this)),this.scheduleGc()};return Ke(this,_s,eD({initialPromise:n==null?void 0:n.initialPromise,fn:o.fetchFn,abort:r.abort.bind(r),onSuccess:f=>{var p,x,j,v;if(f===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(_){c(_);return}(x=(p=le(this,kr).config).onSuccess)==null||x.call(p,f,this),(v=(j=le(this,kr).config).onSettled)==null||v.call(j,f,this.state.error,this),this.scheduleGc()},onError:c,onFail:(f,p)=>{Ot(this,Kr,ri).call(this,{type:"failed",failureCount:f,error:p})},onPause:()=>{Ot(this,Kr,ri).call(this,{type:"pause"})},onContinue:()=>{Ot(this,Kr,ri).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),le(this,_s).start()}},ad=new WeakMap,id=new WeakMap,kr=new WeakMap,_s=new WeakMap,af=new WeakMap,gl=new WeakMap,Kr=new WeakSet,ri=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...nD(r.data,this.options),fetchMeta:e.meta??null};case"success":return{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=e.error;return lv(a)&&a.revert&&le(this,id)?{...le(this,id),fetchStatus:"idle"}:{...r,error:a,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),Kn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),le(this,kr).notify({query:this,type:"updated",action:e})})},lE);function nD(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:XP(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function c9(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Sa,cE,d9=(cE=class extends qd{constructor(e={}){super();vt(this,Sa);this.config=e,Ke(this,Sa,new Map)}build(e,n,r){const a=n.queryKey,i=n.queryHash??uj(a,n);let o=this.get(i);return o||(o=new l9({cache:this,queryKey:a,queryHash:i,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(a)}),this.add(o)),o}add(e){le(this,Sa).has(e.queryHash)||(le(this,Sa).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=le(this,Sa).get(e.queryHash);n&&(e.destroy(),n===e&&le(this,Sa).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Kn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return le(this,Sa).get(e)}getAll(){return[...le(this,Sa).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>bS(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>bS(e,r)):n}notify(e){Kn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Kn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Kn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Sa=new WeakMap,cE),ka,As,xl,Ca,$i,dE,u9=(dE=class extends tD{constructor(e){super();vt(this,Ca);vt(this,ka);vt(this,As);vt(this,xl);this.mutationId=e.mutationId,Ke(this,As,e.mutationCache),Ke(this,ka,[]),this.state=e.state||sD(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){le(this,ka).includes(e)||(le(this,ka).push(e),this.clearGcTimeout(),le(this,As).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Ke(this,ka,le(this,ka).filter(n=>n!==e)),this.scheduleGc(),le(this,As).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){le(this,ka).length||(this.state.status==="pending"?this.scheduleGc():le(this,As).remove(this))}continue(){var e;return((e=le(this,xl))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var a,i,o,c,d,u,m,f,p,x,j,v,_,b,w,N,S,C,A,P;Ke(this,xl,eD({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(M,z)=>{Ot(this,Ca,$i).call(this,{type:"failed",failureCount:M,error:z})},onPause:()=>{Ot(this,Ca,$i).call(this,{type:"pause"})},onContinue:()=>{Ot(this,Ca,$i).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>le(this,As).canRun(this)}));const n=this.state.status==="pending",r=!le(this,xl).canStart();try{if(!n){Ot(this,Ca,$i).call(this,{type:"pending",variables:e,isPaused:r}),await((i=(a=le(this,As).config).onMutate)==null?void 0:i.call(a,e,this));const z=await((c=(o=this.options).onMutate)==null?void 0:c.call(o,e));z!==this.state.context&&Ot(this,Ca,$i).call(this,{type:"pending",context:z,variables:e,isPaused:r})}const M=await le(this,xl).start();return await((u=(d=le(this,As).config).onSuccess)==null?void 0:u.call(d,M,e,this.state.context,this)),await((f=(m=this.options).onSuccess)==null?void 0:f.call(m,M,e,this.state.context)),await((x=(p=le(this,As).config).onSettled)==null?void 0:x.call(p,M,null,this.state.variables,this.state.context,this)),await((v=(j=this.options).onSettled)==null?void 0:v.call(j,M,null,e,this.state.context)),Ot(this,Ca,$i).call(this,{type:"success",data:M}),M}catch(M){try{throw await((b=(_=le(this,As).config).onError)==null?void 0:b.call(_,M,e,this.state.context,this)),await((N=(w=this.options).onError)==null?void 0:N.call(w,M,e,this.state.context)),await((C=(S=le(this,As).config).onSettled)==null?void 0:C.call(S,void 0,M,this.state.variables,this.state.context,this)),await((P=(A=this.options).onSettled)==null?void 0:P.call(A,void 0,M,e,this.state.context)),M}finally{Ot(this,Ca,$i).call(this,{type:"error",error:M})}}finally{le(this,As).runNext(this)}}},ka=new WeakMap,As=new WeakMap,xl=new WeakMap,Ca=new WeakSet,$i=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Kn.batch(()=>{le(this,ka).forEach(r=>{r.onMutationUpdate(e)}),le(this,As).notify({mutation:this,type:"updated",action:e})})},dE);function sD(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var sr,of,uE,h9=(uE=class extends qd{constructor(e={}){super();vt(this,sr);vt(this,of);this.config=e,Ke(this,sr,new Map),Ke(this,of,Date.now())}build(e,n,r){const a=new u9({mutationCache:this,mutationId:++am(this,of)._,options:e.defaultMutationOptions(n),state:r});return this.add(a),a}add(e){const n=Am(e),r=le(this,sr).get(n)??[];r.push(e),le(this,sr).set(n,r),this.notify({type:"added",mutation:e})}remove(e){var r;const n=Am(e);if(le(this,sr).has(n)){const a=(r=le(this,sr).get(n))==null?void 0:r.filter(i=>i!==e);a&&(a.length===0?le(this,sr).delete(n):le(this,sr).set(n,a))}this.notify({type:"removed",mutation:e})}canRun(e){var r;const n=(r=le(this,sr).get(Am(e)))==null?void 0:r.find(a=>a.state.status==="pending");return!n||n===e}runNext(e){var r;const n=(r=le(this,sr).get(Am(e)))==null?void 0:r.find(a=>a!==e&&a.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){Kn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...le(this,sr).values()].flat()}find(e){const n={exact:!0,...e};return this.getAll().find(r=>jS(n,r))}findAll(e={}){return this.getAll().filter(n=>jS(e,n))}notify(e){Kn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Kn.batch(()=>Promise.all(e.map(n=>n.continue().catch(Cr))))}},sr=new WeakMap,of=new WeakMap,uE);function Am(t){var e;return((e=t.options.scope)==null?void 0:e.id)??String(t.mutationId)}function kS(t){return{onFetch:(e,n)=>{var m,f,p,x,j;const r=e.options,a=(p=(f=(m=e.fetchOptions)==null?void 0:m.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,i=((x=e.state.data)==null?void 0:x.pages)||[],o=((j=e.state.data)==null?void 0:j.pageParams)||[];let c={pages:[],pageParams:[]},d=0;const u=async()=>{let v=!1;const _=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(e.signal.aborted?v=!0:e.signal.addEventListener("abort",()=>{v=!0}),e.signal)})},b=YP(e.options,e.fetchOptions),w=async(N,S,C)=>{if(v)return Promise.reject();if(S==null&&N.pages.length)return Promise.resolve(N);const A={queryKey:e.queryKey,pageParam:S,direction:C?"backward":"forward",meta:e.options.meta};_(A);const P=await b(A),{maxPages:M}=e.options,z=C?s9:n9;return{pages:z(N.pages,P,M),pageParams:z(N.pageParams,S,M)}};if(a&&i.length){const N=a==="backward",S=N?f9:CS,C={pages:i,pageParams:o},A=S(r,C);c=await w(C,A,N)}else{const N=t??i.length;do{const S=d===0?o[0]??r.initialPageParam:CS(r,c);if(d>0&&S==null)break;c=await w(c,S),d++}while(d<N)}return c};e.options.persister?e.fetchFn=()=>{var v,_;return(_=(v=e.options).persister)==null?void 0:_.call(v,u,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=u}}}function CS(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function f9(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var En,no,so,od,ld,ro,cd,dd,hE,m9=(hE=class{constructor(t={}){vt(this,En);vt(this,no);vt(this,so);vt(this,od);vt(this,ld);vt(this,ro);vt(this,cd);vt(this,dd);Ke(this,En,t.queryCache||new d9),Ke(this,no,t.mutationCache||new h9),Ke(this,so,t.defaultOptions||{}),Ke(this,od,new Map),Ke(this,ld,new Map),Ke(this,ro,0)}mount(){am(this,ro)._++,le(this,ro)===1&&(Ke(this,cd,fj.subscribe(async t=>{t&&(await this.resumePausedMutations(),le(this,En).onFocus())})),Ke(this,dd,i0.subscribe(async t=>{t&&(await this.resumePausedMutations(),le(this,En).onOnline())})))}unmount(){var t,e;am(this,ro)._--,le(this,ro)===0&&((t=le(this,cd))==null||t.call(this),Ke(this,cd,void 0),(e=le(this,dd))==null||e.call(this),Ke(this,dd,void 0))}isFetching(t){return le(this,En).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return le(this,no).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=le(this,En).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);if(e===void 0)return this.fetchQuery(t);{const n=this.defaultQueryOptions(t),r=le(this,En).build(this,n);return t.revalidateIfStale&&r.isStaleByTime(Yc(n.staleTime,r))&&this.prefetchQuery(n),Promise.resolve(e)}}getQueriesData(t){return le(this,En).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),a=le(this,En).get(r.queryHash),i=a==null?void 0:a.state.data,o=e9(e,i);if(o!==void 0)return le(this,En).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return Kn.batch(()=>le(this,En).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=le(this,En).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=le(this,En);Kn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=le(this,En),r={type:"active",...t};return Kn.batch(()=>(n.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(r,e)))}cancelQueries(t={},e={}){const n={revert:!0,...e},r=Kn.batch(()=>le(this,En).findAll(t).map(a=>a.cancel(n)));return Promise.all(r).then(Cr).catch(Cr)}invalidateQueries(t={},e={}){return Kn.batch(()=>{if(le(this,En).findAll(t).forEach(r=>{r.invalidate()}),t.refetchType==="none")return Promise.resolve();const n={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(n,e)})}refetchQueries(t={},e){const n={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},r=Kn.batch(()=>le(this,En).findAll(t).filter(a=>!a.isDisabled()).map(a=>{let i=a.fetch(void 0,n);return n.throwOnError||(i=i.catch(Cr)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Cr)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=le(this,En).build(this,e);return n.isStaleByTime(Yc(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Cr).catch(Cr)}fetchInfiniteQuery(t){return t.behavior=kS(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Cr).catch(Cr)}ensureInfiniteQueryData(t){return t.behavior=kS(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return i0.isOnline()?le(this,no).resumePausedMutations():Promise.resolve()}getQueryCache(){return le(this,En)}getMutationCache(){return le(this,no)}getDefaultOptions(){return le(this,so)}setDefaultOptions(t){Ke(this,so,t)}setQueryDefaults(t,e){le(this,od).set(Il(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...le(this,od).values()];let n={};return e.forEach(r=>{Rh(t,r.queryKey)&&(n={...n,...r.defaultOptions})}),n}setMutationDefaults(t,e){le(this,ld).set(Il(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...le(this,ld).values()];let n={};return e.forEach(r=>{Rh(t,r.mutationKey)&&(n={...n,...r.defaultOptions})}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...le(this,so).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=uj(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===hj&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...le(this,so).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){le(this,En).clear(),le(this,no).clear()}},En=new WeakMap,no=new WeakMap,so=new WeakMap,od=new WeakMap,ld=new WeakMap,ro=new WeakMap,cd=new WeakMap,dd=new WeakMap,hE),qs,Vt,lf,Ps,vl,ud,ao,Ea,cf,hd,fd,yl,_l,io,md,tn,Du,K_,Z_,G_,Q_,Y_,X_,J_,rD,fE,p9=(fE=class extends qd{constructor(e,n){super();vt(this,tn);vt(this,qs);vt(this,Vt);vt(this,lf);vt(this,Ps);vt(this,vl);vt(this,ud);vt(this,ao);vt(this,Ea);vt(this,cf);vt(this,hd);vt(this,fd);vt(this,yl);vt(this,_l);vt(this,io);vt(this,md,new Set);this.options=n,Ke(this,qs,e),Ke(this,Ea,null),Ke(this,ao,V_()),this.options.experimental_prefetchInRender||le(this,ao).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(le(this,Vt).addObserver(this),ES(le(this,Vt),this.options)?Ot(this,tn,Du).call(this):this.updateResult(),Ot(this,tn,Q_).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ew(le(this,Vt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ew(le(this,Vt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ot(this,tn,Y_).call(this),Ot(this,tn,X_).call(this),le(this,Vt).removeObserver(this)}setOptions(e,n){const r=this.options,a=le(this,Vt);if(this.options=le(this,qs).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Yr(this.options.enabled,le(this,Vt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ot(this,tn,J_).call(this),le(this,Vt).setOptions(this.options),r._defaulted&&!a0(this.options,r)&&le(this,qs).getQueryCache().notify({type:"observerOptionsUpdated",query:le(this,Vt),observer:this});const i=this.hasListeners();i&&AS(le(this,Vt),a,this.options,r)&&Ot(this,tn,Du).call(this),this.updateResult(n),i&&(le(this,Vt)!==a||Yr(this.options.enabled,le(this,Vt))!==Yr(r.enabled,le(this,Vt))||Yc(this.options.staleTime,le(this,Vt))!==Yc(r.staleTime,le(this,Vt)))&&Ot(this,tn,K_).call(this);const o=Ot(this,tn,Z_).call(this);i&&(le(this,Vt)!==a||Yr(this.options.enabled,le(this,Vt))!==Yr(r.enabled,le(this,Vt))||o!==le(this,io))&&Ot(this,tn,G_).call(this,o)}getOptimisticResult(e){const n=le(this,qs).getQueryCache().build(le(this,qs),e),r=this.createResult(n,e);return x9(this,r)&&(Ke(this,Ps,r),Ke(this,ud,this.options),Ke(this,vl,le(this,Vt).state)),r}getCurrentResult(){return le(this,Ps)}trackResult(e,n){const r={};return Object.keys(e).forEach(a=>{Object.defineProperty(r,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),n==null||n(a),e[a])})}),r}trackProp(e){le(this,md).add(e)}getCurrentQuery(){return le(this,Vt)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=le(this,qs).defaultQueryOptions(e),r=le(this,qs).getQueryCache().build(le(this,qs),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(e){return Ot(this,tn,Du).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),le(this,Ps)))}createResult(e,n){var M;const r=le(this,Vt),a=this.options,i=le(this,Ps),o=le(this,vl),c=le(this,ud),u=e!==r?e.state:le(this,lf),{state:m}=e;let f={...m},p=!1,x;if(n._optimisticResults){const z=this.hasListeners(),R=!z&&ES(e,n),D=z&&AS(e,r,n,a);(R||D)&&(f={...f,...nD(m.data,e.options)}),n._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:j,errorUpdatedAt:v,status:_}=f;if(n.select&&f.data!==void 0)if(i&&f.data===(o==null?void 0:o.data)&&n.select===le(this,cf))x=le(this,hd);else try{Ke(this,cf,n.select),x=n.select(f.data),x=H_(i==null?void 0:i.data,x,n),Ke(this,hd,x),Ke(this,Ea,null)}catch(z){Ke(this,Ea,z)}else x=f.data;if(n.placeholderData!==void 0&&x===void 0&&_==="pending"){let z;if(i!=null&&i.isPlaceholderData&&n.placeholderData===(c==null?void 0:c.placeholderData))z=i.data;else if(z=typeof n.placeholderData=="function"?n.placeholderData((M=le(this,fd))==null?void 0:M.state.data,le(this,fd)):n.placeholderData,n.select&&z!==void 0)try{z=n.select(z),Ke(this,Ea,null)}catch(R){Ke(this,Ea,R)}z!==void 0&&(_="success",x=H_(i==null?void 0:i.data,z,n),p=!0)}le(this,Ea)&&(j=le(this,Ea),x=le(this,hd),v=Date.now(),_="error");const b=f.fetchStatus==="fetching",w=_==="pending",N=_==="error",S=w&&b,C=x!==void 0,P={status:_,fetchStatus:f.fetchStatus,isPending:w,isSuccess:_==="success",isError:N,isInitialLoading:S,isLoading:S,data:x,dataUpdatedAt:f.dataUpdatedAt,error:j,errorUpdatedAt:v,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:b,isRefetching:b&&!w,isLoadingError:N&&!C,isPaused:f.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:N&&C,isStale:mj(e,n),refetch:this.refetch,promise:le(this,ao)};if(this.options.experimental_prefetchInRender){const z=B=>{P.status==="error"?B.reject(P.error):P.data!==void 0&&B.resolve(P.data)},R=()=>{const B=Ke(this,ao,P.promise=V_());z(B)},D=le(this,ao);switch(D.status){case"pending":e.queryHash===r.queryHash&&z(D);break;case"fulfilled":(P.status==="error"||P.data!==D.value)&&R();break;case"rejected":(P.status!=="error"||P.error!==D.reason)&&R();break}}return P}updateResult(e){const n=le(this,Ps),r=this.createResult(le(this,Vt),this.options);if(Ke(this,vl,le(this,Vt).state),Ke(this,ud,this.options),le(this,vl).data!==void 0&&Ke(this,fd,le(this,Vt)),a0(r,n))return;Ke(this,Ps,r);const a={},i=()=>{if(!n)return!0;const{notifyOnChangeProps:o}=this.options,c=typeof o=="function"?o():o;if(c==="all"||!c&&!le(this,md).size)return!0;const d=new Set(c??le(this,md));return this.options.throwOnError&&d.add("error"),Object.keys(le(this,Ps)).some(u=>{const m=u;return le(this,Ps)[m]!==n[m]&&d.has(m)})};(e==null?void 0:e.listeners)!==!1&&i()&&(a.listeners=!0),Ot(this,tn,rD).call(this,{...a,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ot(this,tn,Q_).call(this)}},qs=new WeakMap,Vt=new WeakMap,lf=new WeakMap,Ps=new WeakMap,vl=new WeakMap,ud=new WeakMap,ao=new WeakMap,Ea=new WeakMap,cf=new WeakMap,hd=new WeakMap,fd=new WeakMap,yl=new WeakMap,_l=new WeakMap,io=new WeakMap,md=new WeakMap,tn=new WeakSet,Du=function(e){Ot(this,tn,J_).call(this);let n=le(this,Vt).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Cr)),n},K_=function(){Ot(this,tn,Y_).call(this);const e=Yc(this.options.staleTime,le(this,Vt));if(Rl||le(this,Ps).isStale||!q_(e))return;const r=GP(le(this,Ps).dataUpdatedAt,e)+1;Ke(this,yl,setTimeout(()=>{le(this,Ps).isStale||this.updateResult()},r))},Z_=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(le(this,Vt)):this.options.refetchInterval)??!1},G_=function(e){Ot(this,tn,X_).call(this),Ke(this,io,e),!(Rl||Yr(this.options.enabled,le(this,Vt))===!1||!q_(le(this,io))||le(this,io)===0)&&Ke(this,_l,setInterval(()=>{(this.options.refetchIntervalInBackground||fj.isFocused())&&Ot(this,tn,Du).call(this)},le(this,io)))},Q_=function(){Ot(this,tn,K_).call(this),Ot(this,tn,G_).call(this,Ot(this,tn,Z_).call(this))},Y_=function(){le(this,yl)&&(clearTimeout(le(this,yl)),Ke(this,yl,void 0))},X_=function(){le(this,_l)&&(clearInterval(le(this,_l)),Ke(this,_l,void 0))},J_=function(){const e=le(this,qs).getQueryCache().build(le(this,qs),this.options);if(e===le(this,Vt))return;const n=le(this,Vt);Ke(this,Vt,e),Ke(this,lf,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},rD=function(e){Kn.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(le(this,Ps))}),le(this,qs).getQueryCache().notify({query:le(this,Vt),type:"observerResultsUpdated"})})},fE);function g9(t,e){return Yr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function ES(t,e){return g9(t,e)||t.state.data!==void 0&&ew(t,e,e.refetchOnMount)}function ew(t,e,n){if(Yr(e.enabled,t)!==!1){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&mj(t,e)}return!1}function AS(t,e,n,r){return(t!==e||Yr(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&mj(t,n)}function mj(t,e){return Yr(e.enabled,t)!==!1&&t.isStaleByTime(Yc(e.staleTime,t))}function x9(t,e){return!a0(t.getCurrentResult(),e)}var oo,lo,Ws,ui,gi,mp,tw,mE,v9=(mE=class extends qd{constructor(n,r){super();vt(this,gi);vt(this,oo);vt(this,lo);vt(this,Ws);vt(this,ui);Ke(this,oo,n),this.setOptions(r),this.bindMethods(),Ot(this,gi,mp).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var a;const r=this.options;this.options=le(this,oo).defaultMutationOptions(n),a0(this.options,r)||le(this,oo).getMutationCache().notify({type:"observerOptionsUpdated",mutation:le(this,Ws),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Il(r.mutationKey)!==Il(this.options.mutationKey)?this.reset():((a=le(this,Ws))==null?void 0:a.state.status)==="pending"&&le(this,Ws).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=le(this,Ws))==null||n.removeObserver(this)}onMutationUpdate(n){Ot(this,gi,mp).call(this),Ot(this,gi,tw).call(this,n)}getCurrentResult(){return le(this,lo)}reset(){var n;(n=le(this,Ws))==null||n.removeObserver(this),Ke(this,Ws,void 0),Ot(this,gi,mp).call(this),Ot(this,gi,tw).call(this)}mutate(n,r){var a;return Ke(this,ui,r),(a=le(this,Ws))==null||a.removeObserver(this),Ke(this,Ws,le(this,oo).getMutationCache().build(le(this,oo),this.options)),le(this,Ws).addObserver(this),le(this,Ws).execute(n)}},oo=new WeakMap,lo=new WeakMap,Ws=new WeakMap,ui=new WeakMap,gi=new WeakSet,mp=function(){var r;const n=((r=le(this,Ws))==null?void 0:r.state)??sD();Ke(this,lo,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},tw=function(n){Kn.batch(()=>{var r,a,i,o,c,d,u,m;if(le(this,ui)&&this.hasListeners()){const f=le(this,lo).variables,p=le(this,lo).context;(n==null?void 0:n.type)==="success"?((a=(r=le(this,ui)).onSuccess)==null||a.call(r,n.data,f,p),(o=(i=le(this,ui)).onSettled)==null||o.call(i,n.data,null,f,p)):(n==null?void 0:n.type)==="error"&&((d=(c=le(this,ui)).onError)==null||d.call(c,n.error,f,p),(m=(u=le(this,ui)).onSettled)==null||m.call(u,void 0,n.error,f,p))}this.listeners.forEach(f=>{f(le(this,lo))})})},mE),aD=g.createContext(void 0),ns=t=>{const e=g.useContext(aD);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},y9=({client:t,children:e})=>(g.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),s.jsx(aD.Provider,{value:t,children:e})),iD=g.createContext(!1),_9=()=>g.useContext(iD);iD.Provider;function w9(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var b9=g.createContext(w9()),j9=()=>g.useContext(b9);function oD(t,e){return typeof t=="function"?t(...e):!!t}function lD(){}var N9=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},S9=t=>{g.useEffect(()=>{t.clearReset()},[t])},k9=({result:t,errorResetBoundary:e,throwOnError:n,query:r})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&oD(n,[t.error,r]),C9=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},E9=(t,e)=>t.isLoading&&t.isFetching&&!e,A9=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,PS=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function P9(t,e,n){var m,f,p,x,j;const r=ns(),a=_9(),i=j9(),o=r.defaultQueryOptions(t);(f=(m=r.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||f.call(m,o),o._optimisticResults=a?"isRestoring":"optimistic",C9(o),N9(o,i),S9(i);const c=!r.getQueryCache().get(o.queryHash),[d]=g.useState(()=>new e(r,o)),u=d.getOptimisticResult(o);if(g.useSyncExternalStore(g.useCallback(v=>{const _=a?()=>{}:d.subscribe(Kn.batchCalls(v));return d.updateResult(),_},[d,a]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),g.useEffect(()=>{d.setOptions(o,{listeners:!1})},[o,d]),A9(o,u))throw PS(o,d,i);if(k9({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:r.getQueryCache().get(o.queryHash)}))throw u.error;if((x=(p=r.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||x.call(p,o,u),o.experimental_prefetchInRender&&!Rl&&E9(u,a)){const v=c?PS(o,d,i):(j=r.getQueryCache().get(o.queryHash))==null?void 0:j.promise;v==null||v.catch(lD).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?u:d.trackResult(u)}function gr(t,e){return P9(t,p9)}function Xs(t,e){const n=ns(),[r]=g.useState(()=>new v9(n,t));g.useEffect(()=>{r.setOptions(t)},[r,t]);const a=g.useSyncExternalStore(g.useCallback(o=>r.subscribe(Kn.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=g.useCallback((o,c)=>{r.mutate(o,c).catch(lD)},[r]);if(a.error&&oD(r.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ih(){return Ih=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ih.apply(this,arguments)}var ho;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ho||(ho={}));const DS="popstate";function D9(t){t===void 0&&(t={});function e(r,a){let{pathname:i,search:o,hash:c}=r.location;return nw("",{pathname:i,search:o,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:o0(a)}return M9(e,n,null,t)}function Fn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function cD(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function T9(){return Math.random().toString(36).substr(2,8)}function TS(t,e){return{usr:t.state,key:t.key,idx:e}}function nw(t,e,n,r){return n===void 0&&(n=null),Ih({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Wd(e):e,{state:n,key:e&&e.key||r||T9()})}function o0(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Wd(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function M9(t,e,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:i=!1}=r,o=a.history,c=ho.Pop,d=null,u=m();u==null&&(u=0,o.replaceState(Ih({},o.state,{idx:u}),""));function m(){return(o.state||{idx:null}).idx}function f(){c=ho.Pop;let _=m(),b=_==null?null:_-u;u=_,d&&d({action:c,location:v.location,delta:b})}function p(_,b){c=ho.Push;let w=nw(v.location,_,b);u=m()+1;let N=TS(w,u),S=v.createHref(w);try{o.pushState(N,"",S)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;a.location.assign(S)}i&&d&&d({action:c,location:v.location,delta:1})}function x(_,b){c=ho.Replace;let w=nw(v.location,_,b);u=m();let N=TS(w,u),S=v.createHref(w);o.replaceState(N,"",S),i&&d&&d({action:c,location:v.location,delta:0})}function j(_){let b=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof _=="string"?_:o0(_);return w=w.replace(/ $/,"%20"),Fn(b,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,b)}let v={get action(){return c},get location(){return t(a,o)},listen(_){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(DS,f),d=_,()=>{a.removeEventListener(DS,f),d=null}},createHref(_){return e(a,_)},createURL:j,encodeLocation(_){let b=j(_);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:x,go(_){return o.go(_)}};return v}var MS;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(MS||(MS={}));function R9(t,e,n){return n===void 0&&(n="/"),I9(t,e,n,!1)}function I9(t,e,n,r){let a=typeof e=="string"?Wd(e):e,i=pj(a.pathname||"/",n);if(i==null)return null;let o=dD(t);O9(o);let c=null;for(let d=0;c==null&&d<o.length;++d){let u=K9(i);c=H9(o[d],u,r)}return c}function dD(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(i,o,c)=>{let d={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};d.relativePath.startsWith("/")&&(Fn(d.relativePath.startsWith(r),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(r.length));let u=jo([r,d.relativePath]),m=n.concat(d);i.children&&i.children.length>0&&(Fn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),dD(i.children,e,m,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:q9(u,i.index),routesMeta:m})};return t.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))a(i,o);else for(let d of uD(i.path))a(i,o,d)}),e}function uD(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let o=uD(r.join("/")),c=[];return c.push(...o.map(d=>d===""?i:[i,d].join("/"))),a&&c.push(...o),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function O9(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:W9(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const L9=/^:[\w-]+$/,F9=3,B9=2,z9=1,$9=10,U9=-2,RS=t=>t==="*";function q9(t,e){let n=t.split("/"),r=n.length;return n.some(RS)&&(r+=U9),e&&(r+=B9),n.filter(a=>!RS(a)).reduce((a,i)=>a+(L9.test(i)?F9:i===""?z9:$9),r)}function W9(t,e){return t.length===e.length&&t.slice(0,-1).every((r,a)=>r===e[a])?t[t.length-1]-e[e.length-1]:0}function H9(t,e,n){let{routesMeta:r}=t,a={},i="/",o=[];for(let c=0;c<r.length;++c){let d=r[c],u=c===r.length-1,m=i==="/"?e:e.slice(i.length)||"/",f=IS({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},m),p=d.route;if(!f&&u&&n&&!r[r.length-1].route.index&&(f=IS({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:jo([i,f.pathname]),pathnameBase:Y9(jo([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=jo([i,f.pathnameBase]))}return o}function IS(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=V9(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:r.reduce((u,m,f)=>{let{paramName:p,isOptional:x}=m;if(p==="*"){let v=c[f]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const j=c[f];return x&&!j?u[p]=void 0:u[p]=(j||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function V9(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),cD(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,d)=>(r.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function K9(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return cD(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function pj(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Z9(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?Wd(t):t;return{pathname:n?n.startsWith("/")?n:G9(n,e):e,search:X9(r),hash:J9(a)}}function G9(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function cv(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Q9(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function hD(t,e){let n=Q9(t);return e?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function fD(t,e,n,r){r===void 0&&(r=!1);let a;typeof t=="string"?a=Wd(t):(a=Ih({},t),Fn(!a.pathname||!a.pathname.includes("?"),cv("?","pathname","search",a)),Fn(!a.pathname||!a.pathname.includes("#"),cv("#","pathname","hash",a)),Fn(!a.search||!a.search.includes("#"),cv("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,c;if(o==null)c=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;a.pathname=p.join("/")}c=f>=0?e[f]:"/"}let d=Z9(a,c),u=o&&o!=="/"&&o.endsWith("/"),m=(i||o===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(u||m)&&(d.pathname+="/"),d}const jo=t=>t.join("/").replace(/\/\/+/g,"/"),Y9=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),X9=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,J9=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function e7(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const mD=["post","put","patch","delete"];new Set(mD);const t7=["get",...mD];new Set(t7);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Oh(){return Oh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Oh.apply(this,arguments)}const gj=g.createContext(null),n7=g.createContext(null),Vl=g.createContext(null),pg=g.createContext(null),Kl=g.createContext({outlet:null,matches:[],isDataRoute:!1}),pD=g.createContext(null);function s7(t,e){let{relative:n}=e===void 0?{}:e;bf()||Fn(!1);let{basename:r,navigator:a}=g.useContext(Vl),{hash:i,pathname:o,search:c}=xD(t,{relative:n}),d=o;return r!=="/"&&(d=o==="/"?r:jo([r,o])),a.createHref({pathname:d,search:c,hash:i})}function bf(){return g.useContext(pg)!=null}function Hd(){return bf()||Fn(!1),g.useContext(pg).location}function gD(t){g.useContext(Vl).static||g.useLayoutEffect(t)}function Za(){let{isDataRoute:t}=g.useContext(Kl);return t?g7():r7()}function r7(){bf()||Fn(!1);let t=g.useContext(gj),{basename:e,future:n,navigator:r}=g.useContext(Vl),{matches:a}=g.useContext(Kl),{pathname:i}=Hd(),o=JSON.stringify(hD(a,n.v7_relativeSplatPath)),c=g.useRef(!1);return gD(()=>{c.current=!0}),g.useCallback(function(u,m){if(m===void 0&&(m={}),!c.current)return;if(typeof u=="number"){r.go(u);return}let f=fD(u,JSON.parse(o),i,m.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:jo([e,f.pathname])),(m.replace?r.replace:r.push)(f,m.state,m)},[e,r,o,i,t])}function xD(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=g.useContext(Vl),{matches:a}=g.useContext(Kl),{pathname:i}=Hd(),o=JSON.stringify(hD(a,r.v7_relativeSplatPath));return g.useMemo(()=>fD(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function a7(t,e){return i7(t,e)}function i7(t,e,n,r){bf()||Fn(!1);let{navigator:a}=g.useContext(Vl),{matches:i}=g.useContext(Kl),o=i[i.length-1],c=o?o.params:{};o&&o.pathname;let d=o?o.pathnameBase:"/";o&&o.route;let u=Hd(),m;if(e){var f;let _=typeof e=="string"?Wd(e):e;d==="/"||(f=_.pathname)!=null&&f.startsWith(d)||Fn(!1),m=_}else m=u;let p=m.pathname||"/",x=p;if(d!=="/"){let _=d.replace(/^\//,"").split("/");x="/"+p.replace(/^\//,"").split("/").slice(_.length).join("/")}let j=R9(t,{pathname:x}),v=u7(j&&j.map(_=>Object.assign({},_,{params:Object.assign({},c,_.params),pathname:jo([d,a.encodeLocation?a.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?d:jo([d,a.encodeLocation?a.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),i,n,r);return e&&v?g.createElement(pg.Provider,{value:{location:Oh({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:ho.Pop}},v):v}function o7(){let t=p7(),e=e7(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),n?g.createElement("pre",{style:a},n):null,null)}const l7=g.createElement(o7,null);class c7 extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?g.createElement(Kl.Provider,{value:this.props.routeContext},g.createElement(pD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function d7(t){let{routeContext:e,match:n,children:r}=t,a=g.useContext(gj);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),g.createElement(Kl.Provider,{value:e},r)}function u7(t,e,n,r){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,c=(a=n)==null?void 0:a.errors;if(c!=null){let m=o.findIndex(f=>f.route.id&&(c==null?void 0:c[f.route.id])!==void 0);m>=0||Fn(!1),o=o.slice(0,Math.min(o.length,m+1))}let d=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let m=0;m<o.length;m++){let f=o[m];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=m),f.route.id){let{loaderData:p,errors:x}=n,j=f.route.loader&&p[f.route.id]===void 0&&(!x||x[f.route.id]===void 0);if(f.route.lazy||j){d=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((m,f,p)=>{let x,j=!1,v=null,_=null;n&&(x=c&&f.route.id?c[f.route.id]:void 0,v=f.route.errorElement||l7,d&&(u<0&&p===0?(j=!0,_=null):u===p&&(j=!0,_=f.route.hydrateFallbackElement||null)));let b=e.concat(o.slice(0,p+1)),w=()=>{let N;return x?N=v:j?N=_:f.route.Component?N=g.createElement(f.route.Component,null):f.route.element?N=f.route.element:N=m,g.createElement(d7,{match:f,routeContext:{outlet:m,matches:b,isDataRoute:n!=null},children:N})};return n&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?g.createElement(c7,{location:n.location,revalidation:n.revalidation,component:v,error:x,children:w(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):w()},null)}var vD=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(vD||{}),l0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(l0||{});function h7(t){let e=g.useContext(gj);return e||Fn(!1),e}function f7(t){let e=g.useContext(n7);return e||Fn(!1),e}function m7(t){let e=g.useContext(Kl);return e||Fn(!1),e}function yD(t){let e=m7(),n=e.matches[e.matches.length-1];return n.route.id||Fn(!1),n.route.id}function p7(){var t;let e=g.useContext(pD),n=f7(l0.UseRouteError),r=yD(l0.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function g7(){let{router:t}=h7(vD.UseNavigateStable),e=yD(l0.UseNavigateStable),n=g.useRef(!1);return gD(()=>{n.current=!0}),g.useCallback(function(a,i){i===void 0&&(i={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,Oh({fromRouteId:e},i)))},[t,e])}function Sr(t){Fn(!1)}function x7(t){let{basename:e="/",children:n=null,location:r,navigationType:a=ho.Pop,navigator:i,static:o=!1,future:c}=t;bf()&&Fn(!1);let d=e.replace(/^\/*/,"/"),u=g.useMemo(()=>({basename:d,navigator:i,static:o,future:Oh({v7_relativeSplatPath:!1},c)}),[d,c,i,o]);typeof r=="string"&&(r=Wd(r));let{pathname:m="/",search:f="",hash:p="",state:x=null,key:j="default"}=r,v=g.useMemo(()=>{let _=pj(m,d);return _==null?null:{location:{pathname:_,search:f,hash:p,state:x,key:j},navigationType:a}},[d,m,f,p,x,j,a]);return v==null?null:g.createElement(Vl.Provider,{value:u},g.createElement(pg.Provider,{children:n,value:v}))}function v7(t){let{children:e,location:n}=t;return a7(sw(e),n)}new Promise(()=>{});function sw(t,e){e===void 0&&(e=[]);let n=[];return g.Children.forEach(t,(r,a)=>{if(!g.isValidElement(r))return;let i=[...e,a];if(r.type===g.Fragment){n.push.apply(n,sw(r.props.children,i));return}r.type!==Sr&&Fn(!1),!r.props.index||!r.props.children||Fn(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=sw(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rw(){return rw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rw.apply(this,arguments)}function y7(t,e){if(t==null)return{};var n={},r=Object.keys(t),a,i;for(i=0;i<r.length;i++)a=r[i],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function _7(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function w7(t,e){return t.button===0&&(!e||e==="_self")&&!_7(t)}function aw(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(a=>[n,a]):[[n,r]])},[]))}function b7(t,e){let n=aw(t);return e&&e.forEach((r,a)=>{n.has(a)||e.getAll(a).forEach(i=>{n.append(a,i)})}),n}const j7=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],N7="6";try{window.__reactRouterVersion=N7}catch{}const S7="startTransition",OS=CE[S7];function k7(t){let{basename:e,children:n,future:r,window:a}=t,i=g.useRef();i.current==null&&(i.current=D9({window:a,v5Compat:!0}));let o=i.current,[c,d]=g.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},m=g.useCallback(f=>{u&&OS?OS(()=>d(f)):d(f)},[d,u]);return g.useLayoutEffect(()=>o.listen(m),[o,m]),g.createElement(x7,{basename:e,children:n,location:c.location,navigationType:c.action,navigator:o,future:r})}const C7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",E7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zi=g.forwardRef(function(e,n){let{onClick:r,relative:a,reloadDocument:i,replace:o,state:c,target:d,to:u,preventScrollReset:m,viewTransition:f}=e,p=y7(e,j7),{basename:x}=g.useContext(Vl),j,v=!1;if(typeof u=="string"&&E7.test(u)&&(j=u,C7))try{let N=new URL(window.location.href),S=u.startsWith("//")?new URL(N.protocol+u):new URL(u),C=pj(S.pathname,x);S.origin===N.origin&&C!=null?u=C+S.search+S.hash:v=!0}catch{}let _=s7(u,{relative:a}),b=A7(u,{replace:o,state:c,target:d,preventScrollReset:m,relative:a,viewTransition:f});function w(N){r&&r(N),N.defaultPrevented||b(N)}return g.createElement("a",rw({},p,{href:j||_,onClick:v||i?r:w,ref:n,target:d}))});var LS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(LS||(LS={}));var FS;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(FS||(FS={}));function A7(t,e){let{target:n,replace:r,state:a,preventScrollReset:i,relative:o,viewTransition:c}=e===void 0?{}:e,d=Za(),u=Hd(),m=xD(t,{relative:o});return g.useCallback(f=>{if(w7(f,n)){f.preventDefault();let p=r!==void 0?r:o0(u)===o0(m);d(t,{replace:p,state:a,preventScrollReset:i,relative:o,viewTransition:c})}},[u,d,m,r,a,n,t,i,o,c])}function xj(t){let e=g.useRef(aw(t)),n=g.useRef(!1),r=Hd(),a=g.useMemo(()=>b7(r.search,n.current?null:e.current),[r.search]),i=Za(),o=g.useCallback((c,d)=>{const u=aw(typeof c=="function"?c(a):c);n.current=!0,i("?"+u,d)},[i,a]);return[a,o]}const P7="modulepreload",D7=function(t){return"/"+t},BS={},Vd=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(n.map(d=>{if(d=D7(d),d in BS)return;BS[d]=!0;const u=d.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":P7,u||(f.as="script"),f.crossOrigin="",f.href=d,c&&f.setAttribute("nonce",c),document.head.appendChild(f),u)return new Promise((p,x)=>{f.addEventListener("load",p),f.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return a.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},T7=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Vd(async()=>{const{default:r}=await Promise.resolve().then(()=>Kd);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class vj extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class M7 extends vj{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class zS extends vj{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class $S extends vj{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var iw;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(iw||(iw={}));var R7=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};class I7{constructor(e,{headers:n={},customFetch:r,region:a=iw.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=T7(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return R7(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=n;let c={},{region:d}=n;d||(d=this.region);const u=new URL(`${this.url}/${e}`);d&&d!=="any"&&(c["x-region"]=d,u.searchParams.set("forceFunctionRegion",d));let m;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",m=o):typeof o=="string"?(c["Content-Type"]="text/plain",m=o):typeof FormData<"u"&&o instanceof FormData?m=o:(c["Content-Type"]="application/json",m=JSON.stringify(o)));const f=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:m}).catch(v=>{throw new M7(v)}),p=f.headers.get("x-relay-error");if(p&&p==="true")throw new zS(f);if(!f.ok)throw new $S(f);let x=((r=f.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),j;return x==="application/json"?j=yield f.json():x==="application/octet-stream"?j=yield f.blob():x==="text/event-stream"?j=f:x==="multipart/form-data"?j=yield f.formData():j=yield f.text(),{data:j,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof $S||a instanceof zS?a.context:void 0}}})}}var Ks={},yj={},gg={},jf={},xg={},vg={},O7=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Nd=O7();const L7=Nd.fetch,_D=Nd.fetch.bind(Nd),wD=Nd.Headers,F7=Nd.Request,B7=Nd.Response,Kd=Object.freeze(Object.defineProperty({__proto__:null,Headers:wD,Request:F7,Response:B7,default:_D,fetch:L7},Symbol.toStringTag,{value:"Module"})),z7=gE(Kd);var yg={};Object.defineProperty(yg,"__esModule",{value:!0});let $7=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};yg.default=$7;var bD=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(vg,"__esModule",{value:!0});const U7=bD(z7),q7=bD(yg);let W7=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=U7.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,c,d;let u=null,m=null,f=null,p=i.status,x=i.statusText;if(i.ok){if(this.method!=="HEAD"){const b=await i.text();b===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?m=b:m=JSON.parse(b))}const v=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),_=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");v&&_&&_.length>1&&(f=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(u={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,f=null,p=406,x="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const v=await i.text();try{u=JSON.parse(v),Array.isArray(u)&&i.status===404&&(m=[],u=null,p=200,x="OK")}catch{i.status===404&&v===""?(p=204,x="No Content"):u={message:v}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,p=200,x="OK"),u&&this.shouldThrowOnError)throw new q7.default(u)}return{error:u,data:m,count:f,status:p,statusText:x}});return this.shouldThrowOnError||(a=a.catch(i=>{var o,c,d;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(c=i==null?void 0:i.stack)!==null&&c!==void 0?c:""}`,hint:"",code:`${(d=i==null?void 0:i.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,n)}returns(){return this}overrideTypes(){return this}};vg.default=W7;var H7=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xg,"__esModule",{value:!0});const V7=H7(vg);let K7=class extends V7.default{select(e){let n=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",c=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${c?`${c},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:a=r}={}){const i=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var c;const d=[e?"analyze":null,n?"verbose":null,r?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${d};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};xg.default=K7;var Z7=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(jf,"__esModule",{value:!0});const G7=Z7(xg);let Q7=class extends G7.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};jf.default=Q7;var Y7=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(gg,"__esModule",{value:!0});const ju=Y7(jf);let X7=class{constructor(e,{headers:n={},schema:r,fetch:a}){this.url=e,this.headers=n,this.schema=r,this.fetch=a}select(e,{head:n=!1,count:r}={}){const a=n?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new ju.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:r=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(o.length>0){const c=[...new Set(o)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new ju.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:a,defaultToNull:i=!0}={}){const o="POST",c=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),i||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(e)){const d=e.reduce((u,m)=>u.concat(Object.keys(m)),[]);if(d.length>0){const u=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",u.join(","))}}return new ju.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const r="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),this.headers.Prefer=a.join(","),new ju.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new ju.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};gg.default=X7;var _g={},wg={};Object.defineProperty(wg,"__esModule",{value:!0});wg.version=void 0;wg.version="0.0.0-automated";Object.defineProperty(_g,"__esModule",{value:!0});_g.DEFAULT_HEADERS=void 0;const J7=wg;_g.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${J7.version}`};var jD=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(yj,"__esModule",{value:!0});const eU=jD(gg),tU=jD(jf),nU=_g;let sU=class ND{constructor(e,{headers:n={},schema:r,fetch:a}={}){this.url=e,this.headers=Object.assign(Object.assign({},nU.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=a}from(e){const n=new URL(`${this.url}/${e}`);return new eU.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new ND(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:a=!1,count:i}={}){let o;const c=new URL(`${this.url}/rpc/${e}`);let d;r||a?(o=r?"HEAD":"GET",Object.entries(n).filter(([m,f])=>f!==void 0).map(([m,f])=>[m,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([m,f])=>{c.searchParams.append(m,f)})):(o="POST",d=n);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new tU.default({method:o,url:c,headers:u,schema:this.schemaName,body:d,fetch:this.fetch,allowEmpty:!1})}};yj.default=sU;var Zd=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ks,"__esModule",{value:!0});Ks.PostgrestError=Ks.PostgrestBuilder=Ks.PostgrestTransformBuilder=Ks.PostgrestFilterBuilder=Ks.PostgrestQueryBuilder=Ks.PostgrestClient=void 0;const SD=Zd(yj);Ks.PostgrestClient=SD.default;const kD=Zd(gg);Ks.PostgrestQueryBuilder=kD.default;const CD=Zd(jf);Ks.PostgrestFilterBuilder=CD.default;const ED=Zd(xg);Ks.PostgrestTransformBuilder=ED.default;const AD=Zd(vg);Ks.PostgrestBuilder=AD.default;const PD=Zd(yg);Ks.PostgrestError=PD.default;var rU=Ks.default={PostgrestClient:SD.default,PostgrestQueryBuilder:kD.default,PostgrestFilterBuilder:CD.default,PostgrestTransformBuilder:ED.default,PostgrestBuilder:AD.default,PostgrestError:PD.default};const{PostgrestClient:aU,PostgrestQueryBuilder:tae,PostgrestFilterBuilder:nae,PostgrestTransformBuilder:sae,PostgrestBuilder:rae,PostgrestError:aae}=rU;function iU(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const oU=iU(),lU="2.11.15",cU=`realtime-js/${lU}`,dU="1.0.0",DD=1e4,uU=1e3;var ih;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ih||(ih={}));var ys;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ys||(ys={}));var Gr;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Gr||(Gr={}));var ow;(function(t){t.websocket="websocket"})(ow||(ow={}));var rl;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(rl||(rl={}));class hU{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const a=n.getUint8(1),i=n.getUint8(2);let o=this.HEADER_LENGTH+2;const c=r.decode(e.slice(o,o+a));o=o+a;const d=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:c,event:d,payload:u}}}class TD{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var hn;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(hn||(hn={}));const US=(t,e,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=fU(o,t,e,a),i),{})},fU=(t,e,n,r)=>{const a=e.find(c=>c.name===t),i=a==null?void 0:a.type,o=n[t];return i&&!r.includes(i)?MD(i,o):lw(o)},MD=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return xU(e,n)}switch(t){case hn.bool:return mU(e);case hn.float4:case hn.float8:case hn.int2:case hn.int4:case hn.int8:case hn.numeric:case hn.oid:return pU(e);case hn.json:case hn.jsonb:return gU(e);case hn.timestamp:return vU(e);case hn.abstime:case hn.date:case hn.daterange:case hn.int4range:case hn.int8range:case hn.money:case hn.reltime:case hn.text:case hn.time:case hn.timestamptz:case hn.timetz:case hn.tsrange:case hn.tstzrange:return lw(e);default:return lw(e)}},lw=t=>t,mU=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},pU=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},gU=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},xU=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>MD(e,c))}return t},vU=t=>typeof t=="string"?t.replace(" ","T"):t,RD=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class dv{constructor(e,n,r={},a=DD){this.channel=e,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var qS;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(qS||(qS={}));class oh{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=oh.syncState(this.state,a,i,o),this.pendingDiffs.forEach(d=>{this.state=oh.syncDiff(this.state,d,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=oh.syncDiff(this.state,a,i,o),c())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,a){const i=this.cloneDeep(e),o=this.transformState(n),c={},d={};return this.map(i,(u,m)=>{o[u]||(d[u]=m)}),this.map(o,(u,m)=>{const f=i[u];if(f){const p=m.map(_=>_.presence_ref),x=f.map(_=>_.presence_ref),j=m.filter(_=>x.indexOf(_.presence_ref)<0),v=f.filter(_=>p.indexOf(_.presence_ref)<0);j.length>0&&(c[u]=j),v.length>0&&(d[u]=v)}else c[u]=m}),this.syncDiff(i,{joins:c,leaves:d},r,a)}static syncDiff(e,n,r,a){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(c,d)=>{var u;const m=(u=e[c])!==null&&u!==void 0?u:[];if(e[c]=this.cloneDeep(d),m.length>0){const f=e[c].map(x=>x.presence_ref),p=m.filter(x=>f.indexOf(x.presence_ref)<0);e[c].unshift(...p)}r(c,m,d)}),this.map(o,(c,d)=>{let u=e[c];if(!u)return;const m=d.map(f=>f.presence_ref);u=u.filter(f=>m.indexOf(f.presence_ref)<0),e[c]=u,a(c,u,d),u.length===0&&delete e[c]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const a=e[r];return"metas"in a?n[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var WS;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(WS||(WS={}));var HS;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(HS||(HS={}));var ci;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(ci||(ci={}));class _j{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=ys.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new dv(this,Gr.join,this.params,this.timeout),this.rejoinTimer=new TD(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ys.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ys.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=ys.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ys.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Gr.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new oh(this),this.broadcastEndpointURL=RD(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==ys.closed){const{config:{broadcast:i,presence:o,private:c}}=this.params;this._onError(m=>e==null?void 0:e(ci.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(ci.CLOSED));const d={},u={broadcast:i,presence:o,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(m=>m.filter))!==null&&a!==void 0?a:[],private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:m})=>{var f;if(this.socket.setAuth(),m===void 0){e==null||e(ci.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,x=(f=p==null?void 0:p.length)!==null&&f!==void 0?f:0,j=[];for(let v=0;v<x;v++){const _=p[v],{filter:{event:b,schema:w,table:N,filter:S}}=_,C=m&&m[v];if(C&&C.event===b&&C.schema===w&&C.table===N&&C.filter===S)j.push(Object.assign(Object.assign({},_),{id:C.id}));else{this.unsubscribe(),this.state=ys.errored,e==null||e(ci.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=j,e&&e(ci.SUBSCRIBED);return}}).receive("error",m=>{this.state=ys.errored,e==null||e(ci.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ci.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,d;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ys.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Gr.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new dv(this,Gr.leave,{},e),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(i),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new dv(this,e,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var a,i;const o=e.toLocaleLowerCase(),{close:c,error:d,leave:u,join:m}=Gr;if(r&&[c,d,u,m].indexOf(o)>=0&&r!==this._joinRef())return;let p=this._onMessage(o,n,r);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(x=>{var j,v,_;return((j=x.filter)===null||j===void 0?void 0:j.event)==="*"||((_=(v=x.filter)===null||v===void 0?void 0:v.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===o}).map(x=>x.callback(p,r)):(i=this.bindings[o])===null||i===void 0||i.filter(x=>{var j,v,_,b,w,N;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in x){const S=x.id,C=(j=x.filter)===null||j===void 0?void 0:j.event;return S&&((v=n.ids)===null||v===void 0?void 0:v.includes(S))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((_=n.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const S=(w=(b=x==null?void 0:x.filter)===null||b===void 0?void 0:b.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return S==="*"||S===((N=n==null?void 0:n.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===o}).map(x=>{if(typeof p=="object"&&"ids"in p){const j=p.data,{schema:v,table:_,commit_timestamp:b,type:w,errors:N}=j;p=Object.assign(Object.assign({},{schema:v,table:_,commit_timestamp:b,eventType:w,new:{},old:{},errors:N}),this._getPayloadRecords(j))}x.callback(p,r)})}_isClosed(){return this.state===ys.closed}_isJoined(){return this.state===ys.joined}_isJoining(){return this.state===ys.joining}_isLeaving(){return this.state===ys.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const a=e.toLocaleLowerCase(),i={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&_j.isEqual(a.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Gr.close,{},e)}_onError(e){this._on(Gr.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ys.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=US(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=US(e.columns,e.old_record)),n}}const VS=()=>{},yU=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class _U{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=DD,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=VS,this.ref=0,this.logger=VS,this.conn=null,this.sendBuffer=[],this.serializer=new hU,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...c)=>Vd(async()=>{const{default:d}=await Promise.resolve().then(()=>Kd);return{default:d}},void 0).then(({default:d})=>d(...c)):o=fetch,(...c)=>o(...c)},this.endPoint=`${e}/${ow.websocket}`,this.httpEndpoint=RD(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(i,o)=>o(JSON.stringify(i)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new TD(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=oU),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:dU}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ih.connecting:return rl.Connecting;case ih.open:return rl.Open;case ih.closing:return rl.Closing;default:return rl.Closed}}isConnected(){return this.connectionState()===rl.Open}channel(e,n={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new _j(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:a,ref:i}=e,o=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${n} ${r} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:cU};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(Gr.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(uU,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:a,payload:i,ref:o}=n;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${a} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(c=>c._isMember(r)).forEach(c=>c._trigger(a,i,o)),this.stateChangeCallbacks.message.forEach(c=>c(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Gr.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${r}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([yU],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class wj extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Xn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class wU extends wj{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class cw extends wj{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var bU=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};const ID=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Vd(async()=>{const{default:r}=await Promise.resolve().then(()=>Kd);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},jU=()=>bU(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Vd(()=>Promise.resolve().then(()=>Kd),void 0)).Response:Response}),dw=t=>{if(Array.isArray(t))return t.map(n=>dw(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=dw(r)}),e};var Zl=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};const uv=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),NU=(t,e,n)=>Zl(void 0,void 0,void 0,function*(){const r=yield jU();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{e(new wU(uv(a),t.status||500))}).catch(a=>{e(new cw(uv(a),a))}):e(new cw(uv(t),t))}),SU=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function Nf(t,e,n,r,a,i){return Zl(this,void 0,void 0,function*(){return new Promise((o,c)=>{t(n,SU(e,r,a,i)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>NU(d,c,r))})})}function c0(t,e,n,r){return Zl(this,void 0,void 0,function*(){return Nf(t,"GET",e,n,r)})}function Gi(t,e,n,r,a){return Zl(this,void 0,void 0,function*(){return Nf(t,"POST",e,r,a,n)})}function kU(t,e,n,r,a){return Zl(this,void 0,void 0,function*(){return Nf(t,"PUT",e,r,a,n)})}function CU(t,e,n,r){return Zl(this,void 0,void 0,function*(){return Nf(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function OD(t,e,n,r,a){return Zl(this,void 0,void 0,function*(){return Nf(t,"DELETE",e,r,a,n)})}var $s=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};const EU={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},KS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class AU{constructor(e,n={},r,a){this.url=e,this.headers=n,this.bucketId=r,this.fetch=ID(a)}uploadOrUpdate(e,n,r,a){return $s(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},KS),a);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",this.encodeMetadata(d)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",this.encodeMetadata(d))):(i=r,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const u=this._removeEmptyFolders(n),m=this._getFinalPath(u),f=yield this.fetch(`${this.url}/object/${m}`,Object.assign({method:e,body:i,headers:c},o!=null&&o.duplex?{duplex:o.duplex}:{})),p=yield f.json();return f.ok?{data:{path:u,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(i){if(Xn(i))return{data:null,error:i};throw i}})}upload(e,n,r){return $s(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,a){return $s(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${o}`);c.searchParams.set("token",n);try{let d;const u=Object.assign({upsert:KS.upsert},a),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",u.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",u.cacheControl)):(d=r,m["cache-control"]=`max-age=${u.cacheControl}`,m["content-type"]=u.contentType);const f=yield this.fetch(c.toString(),{method:"PUT",body:d,headers:m}),p=yield f.json();return f.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(d){if(Xn(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,n){return $s(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const i=yield Gi(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),o=new URL(this.url+i.url),c=o.searchParams.get("token");if(!c)throw new wj("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:c},error:null}}catch(r){if(Xn(r))return{data:null,error:r};throw r}})}update(e,n,r){return $s(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return $s(this,void 0,void 0,function*(){try{return{data:yield Gi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Xn(a))return{data:null,error:a};throw a}})}copy(e,n,r){return $s(this,void 0,void 0,function*(){try{return{data:{path:(yield Gi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Xn(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,r){return $s(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield Gi(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(Xn(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,r){return $s(this,void 0,void 0,function*(){try{const a=yield Gi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(Xn(a))return{data:null,error:a};throw a}})}download(e,n){return $s(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=i?`?${i}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield c0(this.fetch,`${this.url}/${a}/${c}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(Xn(c))return{data:null,error:c};throw c}})}info(e){return $s(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield c0(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:dw(r),error:null}}catch(r){if(Xn(r))return{data:null,error:r};throw r}})}exists(e){return $s(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield CU(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Xn(r)&&r instanceof cw){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),a=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&a.push(i);const c=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});d!==""&&a.push(d);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${u}`)}}}remove(e){return $s(this,void 0,void 0,function*(){try{return{data:yield OD(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(Xn(n))return{data:null,error:n};throw n}})}list(e,n,r){return $s(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},EU),n),{prefix:e||""});return{data:yield Gi(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(Xn(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const PU="2.7.1",DU={"X-Client-Info":`storage-js/${PU}`};var dc=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};class TU{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},DU),n),this.fetch=ID(r)}listBuckets(){return dc(this,void 0,void 0,function*(){try{return{data:yield c0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Xn(e))return{data:null,error:e};throw e}})}getBucket(e){return dc(this,void 0,void 0,function*(){try{return{data:yield c0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(Xn(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return dc(this,void 0,void 0,function*(){try{return{data:yield Gi(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Xn(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return dc(this,void 0,void 0,function*(){try{return{data:yield kU(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Xn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return dc(this,void 0,void 0,function*(){try{return{data:yield Gi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Xn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return dc(this,void 0,void 0,function*(){try{return{data:yield OD(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(Xn(n))return{data:null,error:n};throw n}})}}class MU extends TU{constructor(e,n={},r){super(e,n,r)}from(e){return new AU(this.url,this.headers,e,this.fetch)}}const RU="2.50.3";let Tu="";typeof Deno<"u"?Tu="deno":typeof document<"u"?Tu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Tu="react-native":Tu="node";const IU={"X-Client-Info":`supabase-js-${Tu}/${RU}`},OU={headers:IU},LU={schema:"public"},FU={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},BU={};var zU=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};const $U=t=>{let e;return t?e=t:typeof fetch>"u"?e=_D:e=fetch,(...n)=>e(...n)},UU=()=>typeof Headers>"u"?wD:Headers,qU=(t,e,n)=>{const r=$U(n),a=UU();return(i,o)=>zU(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:t;let u=new a(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${d}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};var WU=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};function HU(t){return t.endsWith("/")?t:t+"/"}function VU(t,e){var n,r;const{db:a,auth:i,realtime:o,global:c}=t,{db:d,auth:u,realtime:m,global:f}=e,p={db:Object.assign(Object.assign({},d),a),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},m),o),global:Object.assign(Object.assign(Object.assign({},f),c),{headers:Object.assign(Object.assign({},(n=f==null?void 0:f.headers)!==null&&n!==void 0?n:{}),(r=c==null?void 0:c.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>WU(this,void 0,void 0,function*(){return""})};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}const LD="2.70.0",jc=30*1e3,uw=3,hv=uw*jc,KU="http://localhost:9999",ZU="supabase.auth.token",GU={"X-Client-Info":`gotrue-js/${LD}`},hw="X-Supabase-Api-Version",FD={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},QU=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,YU=6e5;class bj extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Pt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class XU extends bj{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function JU(t){return Pt(t)&&t.name==="AuthApiError"}class BD extends bj{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class $o extends bj{constructor(e,n,r,a){super(e,r,a),this.name=n,this.status=r}}class Ui extends $o{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function eq(t){return Pt(t)&&t.name==="AuthSessionMissingError"}class Pm extends $o{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Dm extends $o{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Tm extends $o{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function tq(t){return Pt(t)&&t.name==="AuthImplicitGrantRedirectError"}class ZS extends $o{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class fw extends $o{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function fv(t){return Pt(t)&&t.name==="AuthRetryableFetchError"}class GS extends $o{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class lh extends $o{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const d0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),QS=` 	
\r=`.split(""),nq=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<QS.length;e+=1)t[QS[e].charCodeAt(0)]=-2;for(let e=0;e<d0.length;e+=1)t[d0[e].charCodeAt(0)]=e;return t})();function YS(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(d0[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(d0[r]),e.queuedBits-=6}}function zD(t,e,n){const r=nq[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function XS(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{aq(o,r,n)};for(let o=0;o<t.length;o+=1)zD(t.charCodeAt(o),a,i);return e.join("")}function sq(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function rq(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}sq(r,e)}}function aq(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function iq(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)zD(t.charCodeAt(a),n,r);return new Uint8Array(e)}function oq(t){const e=[];return rq(t,n=>e.push(n)),new Uint8Array(e)}function lq(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};return t.forEach(a=>YS(a,n,r)),YS(null,n,r),e.join("")}function cq(t){return Math.round(Date.now()/1e3)+t}function dq(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const qr=()=>typeof window<"u"&&typeof document<"u",Yo={tested:!1,writable:!1},ch=()=>{if(!qr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Yo.tested)return Yo.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Yo.tested=!0,Yo.writable=!0}catch{Yo.tested=!0,Yo.writable=!1}return Yo.writable};function uq(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return n.searchParams.forEach((r,a)=>{e[a]=r}),e}const $D=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Vd(async()=>{const{default:r}=await Promise.resolve().then(()=>Kd);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},hq=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",UD=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Mm=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Rm=async(t,e)=>{await t.removeItem(e)};class bg{constructor(){this.promise=new bg.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}bg.promiseConstructor=Promise;function mv(t){const e=t.split(".");if(e.length!==3)throw new lh("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!QU.test(e[r]))throw new lh("JWT not in base64url format");return{header:JSON.parse(XS(e[0])),payload:JSON.parse(XS(e[1])),signature:iq(e[2]),raw:{header:e[0],payload:e[1]}}}async function fq(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function mq(t,e){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function pq(t){return("0"+t.toString(16)).substr(-2)}function gq(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let i=0;i<56;i++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,pq).join("")}async function xq(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function vq(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await xq(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function uc(t,e,n=!1){const r=gq();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await UD(t,`${e}-code-verifier`,a);const i=await vq(r);return[i,r===i?"plain":"s256"]}const yq=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _q(t){const e=t.headers.get(hw);if(!e||!e.match(yq))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function wq(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function bq(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const jq=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function hc(t){if(!jq.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Nq=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const tl=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Sq=[502,503,504];async function JS(t){var e;if(!hq(t))throw new fw(tl(t),0);if(Sq.includes(t.status))throw new fw(tl(t),t.status);let n;try{n=await t.json()}catch(i){throw new BD(tl(i),i)}let r;const a=_q(t);if(a&&a.getTime()>=FD["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new GS(tl(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Ui}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new GS(tl(n),t.status,n.weak_password.reasons);throw new XU(tl(n),t.status||500,r)}const kq=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function Ut(t,e,n,r){var a;const i=Object.assign({},r==null?void 0:r.headers);i[hw]||(i[hw]=FD["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await Cq(t,e,n+c,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(d):{data:Object.assign({},d),error:null}}async function Cq(t,e,n,r,a,i){const o=kq(e,r,a,i);let c;try{c=await t(n,Object.assign({},o))}catch(d){throw console.error(d),new fw(tl(d),0)}if(c.ok||await JS(c),r!=null&&r.noResolveJson)return c;try{return await c.json()}catch(d){await JS(d)}}function ai(t){var e;let n=null;Dq(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=cq(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function ek(t){const e=ai(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Xi(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Eq(t){return{data:t,error:null}}function Aq(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i}=t,o=Nq(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i},d=Object.assign({},o);return{data:{properties:c,user:d},error:null}}function Pq(t){return t}function Dq(t){return t.access_token&&t.refresh_token&&t.expires_in}const pv=["global","local","others"];var Tq=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};class Mq{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=$D(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=pv[0]){if(pv.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${pv.join(", ")}`);try{return await Ut(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Pt(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await Ut(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Xi})}catch(r){if(Pt(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=Tq(e,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await Ut(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Aq,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Pt(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Ut(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Xi})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,a,i,o,c,d;try{const u={nextPage:null,lastPage:0,total:0},m=await Ut(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:Pq});if(m.error)throw m.error;const f=await m.json(),p=(o=m.headers.get("x-total-count"))!==null&&o!==void 0?o:0,x=(d=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return x.length>0&&(x.forEach(j=>{const v=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(j.split(";")[1].split("=")[1]);u[`${_}Page`]=v}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Pt(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){hc(e);try{return await Ut(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Xi})}catch(n){if(Pt(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){hc(e);try{return await Ut(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Xi})}catch(r){if(Pt(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){hc(e);try{return await Ut(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Xi})}catch(r){if(Pt(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){hc(e.userId);try{const{data:n,error:r}=await Ut(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(Pt(n))return{data:null,error:n};throw n}}async _deleteFactor(e){hc(e.userId),hc(e.id);try{return{data:await Ut(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Pt(n))return{data:null,error:n};throw n}}}const Rq={getItem:t=>ch()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{ch()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{ch()&&globalThis.localStorage.removeItem(t)}};function tk(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function Iq(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const fc={debug:!!(globalThis&&ch()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class qD extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Oq extends qD{}async function Lq(t,e,n){fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),fc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw fc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Oq(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(fc.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}Iq();const Fq={url:KU,storageKey:ZU,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:GU,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function nk(t,e,n){return await n()}class Lh{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Lh.nextInstanceID,Lh.nextInstanceID+=1,this.instanceID>0&&qr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Fq),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Mq({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=$D(a.fetch),this.lock=a.lock||nk,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:qr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Lq:this.lock=nk,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:ch()?this.storage=Rq:(this.memoryStorage={},this.storage=tk(this.memoryStorage)):(this.memoryStorage={},this.storage=tk(this.memoryStorage)),qr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${LD}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=uq(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),qr()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),tq(i)){const d=(e=i.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Pt(n)?{error:n}:{error:new BD("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,a;try{const i=await Ut(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:ai}),{data:o,error:c}=i;if(c||!o)return{data:{user:null,session:null},error:c};const d=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:u,session:d},error:null}}catch(i){if(Pt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,r,a;try{let i;if("email"in e){const{email:m,password:f,options:p}=e;let x=null,j=null;this.flowType==="pkce"&&([x,j]=await uc(this.storage,this.storageKey)),i=await Ut(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:m,password:f,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:x,code_challenge_method:j},xform:ai})}else if("phone"in e){const{phone:m,password:f,options:p}=e;i=await Ut(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:f,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},channel:(a=p==null?void 0:p.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:ai})}else throw new Dm("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return{data:{user:null,session:null},error:c};const d=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:u,session:d},error:null}}catch(i){if(Pt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:c}=e;n=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:ek})}else if("phone"in e){const{phone:i,password:o,options:c}=e;n=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:ek})}else throw new Dm("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Pm}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(Pt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,a,i,o,c,d,u,m,f,p,x;let j,v;if("message"in e)j=e.message,v=e.signature;else{const{chain:_,wallet:b,statement:w,options:N}=e;let S;if(qr())if(typeof b=="object")S=b;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))S=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=b}const C=new URL((n=N==null?void 0:N.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in S&&S.signIn){const A=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),w?{statement:w}:null));let P;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")P=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)P=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)j=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),v=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");j=[`${C.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(a=(r=N==null?void 0:N.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=N==null?void 0:N.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((o=N==null?void 0:N.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((c=N==null?void 0:N.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((d=N==null?void 0:N.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((u=N==null?void 0:N.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((f=(m=N==null?void 0:N.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||f===void 0)&&f.length?["Resources",...N.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const A=await S.signMessage(new TextEncoder().encode(j),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=A}}try{const{data:_,error:b}=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:j,signature:lq(v)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:ai});if(b)throw b;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new Pm}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:b})}catch(_){if(Pt(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const n=await Mm(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:i,error:o}=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ai});if(await Rm(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Pm}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(Pt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:a,access_token:i,nonce:o}=e,c=await Ut(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ai}),{data:d,error:u}=c;return u?{data:{user:null,session:null},error:u}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Pm}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:u})}catch(n){if(Pt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,a,i,o;try{if("email"in e){const{email:c,options:d}=e;let u=null,m=null;this.flowType==="pkce"&&([u,m]=await uc(this.storage,this.storageKey));const{error:f}=await Ut(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(r=d==null?void 0:d.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:u,code_challenge_method:m},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:c,options:d}=e,{data:u,error:m}=await Ut(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(o=d==null?void 0:d.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:m}}throw new Dm("You must provide either an email or phone number.")}catch(c){if(Pt(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var n,r;try{let a,i;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:c}=await Ut(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:ai});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,u=o.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:u,session:d},error:null}}catch(a){if(Pt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,r,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await uc(this.storage,this.storageKey)),await Ut(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Eq})}catch(i){if(Pt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Ui;const{error:a}=await Ut(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(Pt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:i}=e,{error:o}=await Ut(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:a,options:i}=e,{data:o,error:c}=await Ut(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:c}}throw new Dm("You must provide either an email or phone number and a type")}catch(n){if(Pt(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Mm(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<hv:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,u,m)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,u,m))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ut(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Xi}):await this._useSession(async n=>{var r,a,i;const{data:o,error:c}=n;if(c)throw c;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ui}:await Ut(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Xi})})}catch(n){if(Pt(n))return eq(n)&&(await this._removeSession(),await Rm(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new Ui;const o=a.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await uc(this.storage,this.storageKey));const{data:u,error:m}=await Ut(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:o.access_token,xform:Xi});if(m)throw m;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(Pt(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ui;const n=Date.now()/1e3;let r=n,a=!0,i=null;const{payload:o}=mv(e.access_token);if(o.exp&&(r=o.exp,a=r<=n),a){const{session:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;i={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(Pt(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:c}=n;if(c)throw c;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Ui;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Pt(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!qr())throw new Tm("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Tm(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new ZS("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Tm("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ZS("No code detected.");const{data:w,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:c,expires_at:d,token_type:u}=e;if(!i||!c||!o||!u)throw new Tm("No session defined in URL");const m=Math.round(Date.now()/1e3),f=parseInt(c);let p=m+f;d&&(p=parseInt(d));const x=p-m;x*1e3<=jc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${f}s`);const j=p-f;m-j>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",j,p,m):m-j<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",j,p,m);const{data:v,error:_}=await this._getUser(i);if(_)throw _;const b={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:p,refresh_token:o,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(r){if(Pt(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Mm(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{error:i};const o=(r=a.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:c}=await this.admin.signOut(o,e);if(c&&!(JU(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await Rm(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=dq(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,a;try{const{data:{session:i},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await uc(this.storage,this.storageKey,!0));try{return await Ut(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(Pt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Pt(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:a}=await this._useSession(async i=>{var o,c,d,u,m;const{data:f,error:p}=i;if(p)throw p;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Ut(this.fetch,"GET",x,{headers:this.headers,jwt:(m=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&m!==void 0?m:void 0})});if(a)throw a;return qr()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Pt(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:o}=n;if(o)throw o;return await Ut(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(Pt(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await mq(async a=>(a>0&&await fq(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Ut(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ai})),(a,i)=>{const o=200*Math.pow(2,a);return i&&fv(i)&&Date.now()+o-r<jc})}catch(r){if(this._debug(n,"error",r),Pt(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),qr()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Mm(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const a=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<hv;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${hv}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),fv(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Ui;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new bg;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Ui;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={session:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(a,"error",i),Pt(i)){const o={session:null,error:i};return fv(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,n)}catch(d){i.push(d)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await UD(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Rm(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&qr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),jc);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/jc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${jc}ms, refresh threshold is ${uw} ticks`),a<=uw&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof qD)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await uc(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(c.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await Ut(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Pt(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:o}=n;if(o)return{data:null,error:o};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:u}=await Ut(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((a=d==null?void 0:d.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(n){if(Pt(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{data:null,error:i};const{data:o,error:c}=await Ut(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:c})})}catch(n){if(Pt(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await Ut(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Pt(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],a=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=mv(a.access_token);let c=null;o.aal&&(c=o.aal);let d=c;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const m=o.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:m},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(o=>o.kid===e);if(r||(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+YU>Date.now()))return r;const{data:a,error:i}=await Ut(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new lh("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),r=a.keys.find(o=>o.kid===e),!r)throw new lh("No matching signing key found in JWKS");return r}async getClaims(e,n={keys:[]}){try{let r=e;if(!r){const{data:x,error:j}=await this.getSession();if(j||!x.session)return{data:null,error:j};r=x.session.access_token}const{header:a,payload:i,signature:o,raw:{header:c,payload:d}}=mv(r);if(wq(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:x}=await this.getUser(r);if(x)throw x;return{data:{claims:i,header:a,signature:o},error:null}}const u=bq(a.alg),m=await this.fetchJwk(a.kid,n),f=await crypto.subtle.importKey("jwk",m,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,o,oq(`${c}.${d}`)))throw new lh("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(r){if(Pt(r))return{data:null,error:r};throw r}}}Lh.nextInstanceID=0;const Bq=Lh;class zq extends Bq{constructor(e){super(e)}}var $q=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};class Uq{constructor(e,n,r){var a,i,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const c=HU(e),d=new URL(c);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const u=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:LU,realtime:BU,auth:Object.assign(Object.assign({},FU),{storageKey:u}),global:OU},f=VU(r??{},m);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(p,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=f.auth)!==null&&o!==void 0?o:{},this.headers,f.global.fetch),this.fetch=qU(n,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new aU(new URL("rest/v1",d).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new I7(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new MU(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return $q(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:i,flowType:o,lock:c,debug:d},u,m){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new zq({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,flowType:o,lock:c,debug:d,fetch:m,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new _U(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const qq=(t,e,n)=>new Uq(t,e,n),Wq="https://qgwhkjrhndeoskrxewpb.supabase.co",Hq="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFnd2hranJobmRlb3Nrcnhld3BiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1NTExODAsImV4cCI6MjA2NzEyNzE4MH0.eSPBRJKIBd9oiXqfo8vrbmMCl6QByxnVgHqtgofDGtg",Z=qq(Wq,Hq,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{"X-Client-Info":"handwerkos-app"}}}),WD=g.createContext(void 0);function Vq({children:t}){const[e,n]=g.useState(null),[r,a]=g.useState(null),[i,o]=g.useState(null),[c,d]=g.useState(null),[u,m]=g.useState(!0),f=i==="manager",p=f,x=async b=>{try{const{data:w,error:N}=await Z.from("user_roles").select("role").eq("user_id",b).single();N?(console.warn("Role fetch error, default to employee:",N),o("employee")):o((w==null?void 0:w.role)??"employee");const{data:S,error:C}=await Z.from("profiles").select("company_id").eq("id",b).single();C?(console.warn("Profile fetch error:",C),d(null)):d((S==null?void 0:S.company_id)??null)}catch(w){console.error("Error fetching user data:",w)}};g.useEffect(()=>{Z.auth.getSession().then(({data:w})=>{var N,S;a(w.session),n(((N=w.session)==null?void 0:N.user)??null),(S=w.session)!=null&&S.user&&x(w.session.user.id),m(!1)});const{data:{subscription:b}}=Z.auth.onAuthStateChange((w,N)=>{a(N),n((N==null?void 0:N.user)??null),N!=null&&N.user?x(N.user.id):(o(null),d(null)),m(!1)});return()=>b.unsubscribe()},[]);const j=async()=>{n(null),a(null),o(null),d(null),await Z.auth.signOut()},v=async(b,w)=>{if(!e||!f||!c)return{success:!1,error:"Keine Berechtigung zum Einladen von Mitarbeitern"};try{console.log("Creating Supabase invitation for employee:",b);const N=crypto.randomUUID(),S=new Date;S.setDate(S.getDate()+7);const{error:C}=await Z.from("employee_invitations").insert({email:b.toLowerCase(),invited_by:e.id,company_id:c,invite_token:N,expires_at:S.toISOString(),employee_data:w,status:"pending"});if(C)return console.error("Error creating invitation:",C),{success:!1,error:"Fehler beim Erstellen der Einladung"};const{error:A}=await Z.from("employees").upsert({email:b.toLowerCase(),first_name:w.firstName,last_name:w.lastName,position:w.position,phone:w.phone,qualifications:Array.isArray(w.qualifications)?w.qualifications:[],license:w.license||"",company_id:c,status:"eingeladen"});if(A)return console.error("Error creating employee:",A),{success:!1,error:"Fehler beim Erstellen des Mitarbeiters"};const P=`${window.location.origin}/mitarbeiter-setup?token=${N}`,{data:M}=await Z.from("profiles").select("email, first_name, last_name").eq("id",e.id).single(),{data:z}=await Z.from("companies").select("name").eq("id",c).single();try{const{error:R}=await Z.functions.invoke("send-welcome-email",{body:{employeeEmail:b,employeeName:`${w.firstName} ${w.lastName}`,loginUrl:P}});if(R)throw console.warn("Welcome email failed, trying fallback:",R),R;console.log("Professional welcome email sent successfully")}catch{const{error:D}=await Z.functions.invoke("send-employee-confirmation",{body:{managerEmail:(M==null?void 0:M.email)||e.email,employeeName:`${w.firstName} ${w.lastName}`,employeeEmail:b,companyName:(z==null?void 0:z.name)||"Ihrem Unternehmen",registrationUrl:P}});D&&console.error("Email sending error:",D)}return{success:!0}}catch(N){return console.error("Invitation error:",N),{success:!1,error:N instanceof Error?N.message:"Unbekannter Fehler bei der Einladung"}}},_=async(b,w)=>{if(!f)return{success:!1,error:"Keine Berechtigung"};try{const{error:N}=await Z.from("user_roles").upsert({user_id:b,role:w});if(N)throw N;return{success:!0}}catch(N){return{success:!1,error:N instanceof Error?N.message:"Rolle konnte nicht aktualisiert werden"}}};return s.jsx(WD.Provider,{value:{user:e,session:r,userRole:i,loading:u,isManager:f,canInviteMembers:p,companyId:c,signOut:j,inviteEmployee:v,updateMemberRole:_},children:t})}function Fr(){const t=g.useContext(WD);if(!t)throw new Error("useSupabaseAuth must be used within SupabaseAuthProvider");return t}const mw=Ld("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ee=g.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...a},i)=>{const o=r?wi:"button";return s.jsx(o,{className:Te(mw({variant:e,size:n,className:t})),ref:i,...a})});ee.displayName="Button";const Kq=Ld("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Qe({className:t,variant:e,...n}){return s.jsx("div",{className:Te(Kq({variant:e}),t),...n})}const HD=g.createContext(void 0);function Zq({children:t}){const[e,n]=g.useState(null),[r,a]=g.useState(null),[i,o]=g.useState(null),[c,d]=g.useState(!0),u=async j=>{const{data:v,error:_}=await Z.from("user_roles").select("role").eq("user_id",j).single();_?(console.warn("Role fetch error, default to employee:",_),o("employee")):o((v==null?void 0:v.role)??"employee")};g.useEffect(()=>{Z.auth.getSession().then(({data:v})=>{var _,b;a(v.session),n(((_=v.session)==null?void 0:_.user)??null),(b=v.session)!=null&&b.user&&u(v.session.user.id),d(!1)});const{data:{subscription:j}}=Z.auth.onAuthStateChange((v,_)=>{console.log("Auth state changed:",v,_),a(_),n((_==null?void 0:_.user)??null),_!=null&&_.user?u(_.user.id):o(null)});return()=>{j.unsubscribe()}},[]);const m=(j,v)=>Z.auth.signInWithPassword({email:j,password:v}),f=(j,v,_)=>{const b=`${window.location.origin}/auth?mode=employee-setup`;return Z.auth.signUp({email:j,password:v,options:{emailRedirectTo:b,data:{first_name:_.firstName,last_name:_.lastName,company_name:_.companyName,phone:_.phone,street_address:_.streetAddress,postal_code:_.postalCode,city:_.city,country:_.country,vat_id:_.vatId,voucher_code:_.voucherCode,referral_source:_.referralSource}}})},p=j=>Z.auth.updateUser({password:j}),x=async()=>{n(null),a(null),o(null),await Z.auth.signOut()};return s.jsx(HD.Provider,{value:{user:e,session:r,userRole:i,loading:c,signIn:m,signUp:f,signOut:x,updatePassword:p},children:t})}function jg(){const t=g.useContext(HD);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}const Gq=[{id:"dashboard",name:"Dashboard",icon:Eo,color:"text-blue-500"},{id:"stammdaten",name:"Stammdaten",icon:sB,color:"text-gray-500",children:[{id:"customers",name:"Kunden & Aufträge",icon:bi,color:"text-green-500"},{id:"personal",name:"Personal",icon:yf,color:"text-purple-500"}]},{id:"projects",name:"Projekte & Baustellen",icon:la,color:"text-orange-500"},{id:"timetracking",name:"Zeiterfassung",icon:an,color:"text-yellow-500"},{id:"vacation",name:"Urlaubsverwaltung",icon:mB,color:"text-sky-500"},{id:"emails",name:"E-Mails",icon:es,color:"text-pink-500"},{id:"documents",name:"Dokumente",icon:Mr,color:"text-emerald-500"},{id:"invoice-validation",name:"Rechnungs-Validierung",icon:wn,color:"text-amber-500"},{id:"materials",name:"Material",icon:qa,color:"text-red-500"},{id:"machines",name:"Maschinen & Geräte",icon:Co,color:"text-indigo-500"},{id:"finance",name:"Finanzen",icon:Jr,color:"text-cyan-500"},{id:"planner",name:"Planer",icon:Lt,color:"text-teal-500"},{id:"company-settings",name:"Firmeneinstellungen",icon:Co,color:"text-gray-600"}];function Qq({activeModule:t,onModuleChange:e}){const{signOut:n}=jg(),r=Za(),[a,i]=g.useState(!1),[o,c]=g.useState(null),[d,u]=g.useState(["stammdaten"]),m=async()=>{try{await n(),r("/auth"),Aa({title:"Erfolgreich abgemeldet",description:"Sie wurden erfolgreich abgemeldet."})}catch{Aa({title:"Fehler beim Abmelden",description:"Es ist ein Fehler aufgetreten.",variant:"destructive"})}},f=a;g.useEffect(()=>{f||u([])},[f]);const p=x=>{u(j=>j.includes(x)?j.filter(v=>v!==x):[...j,x])};return s.jsxs("div",{className:`fixed left-0 top-0 h-full z-50 transition-all duration-500 ease-in-out ${f?"w-64":"w-16"} 
      bg-gradient-to-b from-blue-900 via-blue-800 to-blue-950 shadow-2xl`,onMouseEnter:()=>{o&&clearTimeout(o);const x=setTimeout(()=>i(!0),150);c(x)},onMouseLeave:()=>{o&&clearTimeout(o),i(!1),u([])},children:[s.jsx("div",{className:"p-4 border-b border-blue-600/30",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-8 w-8 rounded-lg bg-white/20 backdrop-blur-sm flex items-center justify-center border border-white/30",children:s.jsx("span",{className:"text-white font-bold text-sm",children:"H"})}),s.jsx("span",{className:`font-bold text-white transition-all duration-300 ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:"HandwerkOS"})]})}),s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsx("div",{className:"flex-1 p-3",children:s.jsx("div",{className:"space-y-2",children:Gq.map(x=>s.jsx("div",{children:x.children?s.jsxs("div",{children:[s.jsxs("button",{onClick:()=>p(x.id),className:`group w-full flex items-center p-3 rounded-lg transition-all duration-300 relative 
                      text-white/80 hover:text-white hover:bg-white/10 backdrop-blur-sm`,title:f?void 0:x.name,children:[s.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:s.jsx(x.icon,{className:`h-5 w-5 ${x.color} group-hover:scale-110 transition-transform duration-200`})}),s.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:x.name}),f&&s.jsx("div",{className:"ml-auto",children:d.includes(x.id)?s.jsx(ag,{className:"h-4 w-4 text-white/60 group-hover:text-white transition-colors duration-200"}):s.jsx(jl,{className:"h-4 w-4 text-white/60 group-hover:text-white transition-colors duration-200"})})]}),d.includes(x.id)&&f&&s.jsx("div",{className:"ml-6 mt-1 space-y-1",children:x.children.map(j=>s.jsxs("button",{onClick:()=>e(j.id),className:`group w-full flex items-center p-2.5 rounded-lg transition-all duration-200 text-sm ${t===j.id?"bg-white/20 text-white shadow-lg backdrop-blur-sm border border-white/30":"text-white/70 hover:text-white hover:bg-white/10"}`,children:[s.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:s.jsx(j.icon,{className:`h-4 w-4 ${j.color} group-hover:scale-110 transition-transform duration-200`})}),s.jsx("span",{className:"ml-2 whitespace-nowrap font-medium",children:j.name}),t===j.id&&s.jsx("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-white animate-pulse"})]},j.id))})]}):s.jsxs("button",{onClick:()=>e(x.id),className:`group w-full flex items-center p-3 rounded-lg transition-all duration-300 relative ${t===x.id?"bg-white/20 text-white shadow-lg backdrop-blur-sm border border-white/30":"text-white/80 hover:text-white hover:bg-white/10"}`,title:f?void 0:x.name,children:[s.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:s.jsx(x.icon,{className:`h-5 w-5 ${x.color} group-hover:scale-110 transition-transform duration-200`})}),s.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:x.name}),t===x.id&&s.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-white/50 rounded-l-full"})]})},x.id))})}),s.jsx("div",{className:"p-3 border-t border-blue-600/30",children:s.jsxs("button",{onClick:m,className:"group w-full flex items-center p-3 rounded-lg text-white/80 hover:text-white hover:bg-red-500/20 transition-all duration-300 relative",title:f?void 0:"Abmelden",children:[s.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:s.jsx(cB,{className:"h-5 w-5 group-hover:scale-110 transition-transform duration-200"})}),s.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:"Abmelden"})]})})]})]})}const oe=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{ref:n,className:Te("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));oe.displayName="Card";const Ne=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{ref:n,className:Te("flex flex-col space-y-1.5 p-6",t),...e}));Ne.displayName="CardHeader";const Ce=g.forwardRef(({className:t,...e},n)=>s.jsx("h3",{ref:n,className:Te("text-2xl font-semibold leading-none tracking-tight",t),...e}));Ce.displayName="CardTitle";const ds=g.forwardRef(({className:t,...e},n)=>s.jsx("p",{ref:n,className:Te("text-sm text-muted-foreground",t),...e}));ds.displayName="CardDescription";const ce=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{ref:n,className:Te("p-6 pt-0",t),...e}));ce.displayName="CardContent";const Yq=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{ref:n,className:Te("flex items-center p-6 pt-0",t),...e}));Yq.displayName="CardFooter";const ae=g.forwardRef(({className:t,type:e,...n},r)=>s.jsx("input",{type:e,className:Te("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));ae.displayName="Input";var Xq="Label",VD=g.forwardRef((t,e)=>s.jsx(nt.label,{...t,ref:e,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=t.onMouseDown)==null||a.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));VD.displayName=Xq;var KD=VD;const Jq=Ld("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Y=g.forwardRef(({className:t,...e},n)=>s.jsx(KD,{ref:n,className:Te(Jq(),t),...e}));Y.displayName=KD.displayName;function eW(t,e=[]){let n=[];function r(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:x,...j}=f,v=(p==null?void 0:p[t][d])||c,_=g.useMemo(()=>j,Object.values(j));return s.jsx(v.Provider,{value:_,children:x})}function m(f,p){const x=(p==null?void 0:p[t][d])||c,j=g.useContext(x);if(j)return j;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[r,tW(a,...e)]}function tW(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=r.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var nW=g.createContext(void 0);function Gd(t){const e=g.useContext(nW);return t||e||"ltr"}var gv="rovingFocusGroup.onEntryFocus",sW={bubbles:!1,cancelable:!0},Ng="RovingFocusGroup",[pw,ZD,rW]=pf(Ng),[aW,Sg]=eW(Ng,[rW]),[iW,oW]=aW(Ng),GD=g.forwardRef((t,e)=>s.jsx(pw.Provider,{scope:t.__scopeRovingFocusGroup,children:s.jsx(pw.Slot,{scope:t.__scopeRovingFocusGroup,children:s.jsx(lW,{...t,ref:e})})}));GD.displayName=Ng;var lW=g.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:d,onEntryFocus:u,preventScrollOnEntryFocus:m=!1,...f}=t,p=g.useRef(null),x=Tt(e,p),j=Gd(i),[v=null,_]=Lr({prop:o,defaultProp:c,onChange:d}),[b,w]=g.useState(!1),N=_n(u),S=ZD(n),C=g.useRef(!1),[A,P]=g.useState(0);return g.useEffect(()=>{const M=p.current;if(M)return M.addEventListener(gv,N),()=>M.removeEventListener(gv,N)},[N]),s.jsx(iW,{scope:n,orientation:r,dir:j,loop:a,currentTabStopId:v,onItemFocus:g.useCallback(M=>_(M),[_]),onItemShiftTab:g.useCallback(()=>w(!0),[]),onFocusableItemAdd:g.useCallback(()=>P(M=>M+1),[]),onFocusableItemRemove:g.useCallback(()=>P(M=>M-1),[]),children:s.jsx(nt.div,{tabIndex:b||A===0?-1:0,"data-orientation":r,...f,ref:x,style:{outline:"none",...t.style},onMouseDown:Re(t.onMouseDown,()=>{C.current=!0}),onFocus:Re(t.onFocus,M=>{const z=!C.current;if(M.target===M.currentTarget&&z&&!b){const R=new CustomEvent(gv,sW);if(M.currentTarget.dispatchEvent(R),!R.defaultPrevented){const D=S().filter(de=>de.focusable),B=D.find(de=>de.active),W=D.find(de=>de.id===v),ue=[B,W,...D].filter(Boolean).map(de=>de.ref.current);XD(ue,m)}}C.current=!1}),onBlur:Re(t.onBlur,()=>w(!1))})})}),QD="RovingFocusGroupItem",YD=g.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:i,...o}=t,c=dr(),d=i||c,u=oW(QD,n),m=u.currentTabStopId===d,f=ZD(n),{onFocusableItemAdd:p,onFocusableItemRemove:x}=u;return g.useEffect(()=>{if(r)return p(),()=>x()},[r,p,x]),s.jsx(pw.ItemSlot,{scope:n,id:d,focusable:r,active:a,children:s.jsx(nt.span,{tabIndex:m?0:-1,"data-orientation":u.orientation,...o,ref:e,onMouseDown:Re(t.onMouseDown,j=>{r?u.onItemFocus(d):j.preventDefault()}),onFocus:Re(t.onFocus,()=>u.onItemFocus(d)),onKeyDown:Re(t.onKeyDown,j=>{if(j.key==="Tab"&&j.shiftKey){u.onItemShiftTab();return}if(j.target!==j.currentTarget)return;const v=uW(j,u.orientation,u.dir);if(v!==void 0){if(j.metaKey||j.ctrlKey||j.altKey||j.shiftKey)return;j.preventDefault();let b=f().filter(w=>w.focusable).map(w=>w.ref.current);if(v==="last")b.reverse();else if(v==="prev"||v==="next"){v==="prev"&&b.reverse();const w=b.indexOf(j.currentTarget);b=u.loop?hW(b,w+1):b.slice(w+1)}setTimeout(()=>XD(b))}})})})});YD.displayName=QD;var cW={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function dW(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function uW(t,e,n){const r=dW(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return cW[r]}function XD(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function hW(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var JD=GD,eT=YD,jj="Tabs",[fW,iae]=wr(jj,[Sg]),tT=Sg(),[mW,Nj]=fW(jj),nT=g.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:c,activationMode:d="automatic",...u}=t,m=Gd(c),[f,p]=Lr({prop:r,onChange:a,defaultProp:i});return s.jsx(mW,{scope:n,baseId:dr(),value:f,onValueChange:p,orientation:o,dir:m,activationMode:d,children:s.jsx(nt.div,{dir:m,"data-orientation":o,...u,ref:e})})});nT.displayName=jj;var sT="TabsList",rT=g.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...a}=t,i=Nj(sT,n),o=tT(n);return s.jsx(JD,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:r,children:s.jsx(nt.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:e})})});rT.displayName=sT;var aT="TabsTrigger",iT=g.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...i}=t,o=Nj(aT,n),c=tT(n),d=cT(o.baseId,r),u=dT(o.baseId,r),m=r===o.value;return s.jsx(eT,{asChild:!0,...c,focusable:!a,active:m,children:s.jsx(nt.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":u,"data-state":m?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:d,...i,ref:e,onMouseDown:Re(t.onMouseDown,f=>{!a&&f.button===0&&f.ctrlKey===!1?o.onValueChange(r):f.preventDefault()}),onKeyDown:Re(t.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&o.onValueChange(r)}),onFocus:Re(t.onFocus,()=>{const f=o.activationMode!=="manual";!m&&!a&&f&&o.onValueChange(r)})})})});iT.displayName=aT;var oT="TabsContent",lT=g.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:a,children:i,...o}=t,c=Nj(oT,n),d=cT(c.baseId,r),u=dT(c.baseId,r),m=r===c.value,f=g.useRef(m);return g.useEffect(()=>{const p=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(p)},[]),s.jsx(Gn,{present:a||m,children:({present:p})=>s.jsx(nt.div,{"data-state":m?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!p,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:f.current?"0s":void 0},children:p&&i})})});lT.displayName=oT;function cT(t,e){return`${t}-trigger-${e}`}function dT(t,e){return`${t}-content-${e}`}var pW=nT,uT=rT,hT=iT,fT=lT;const Is=pW,js=g.forwardRef(({className:t,...e},n)=>s.jsx(uT,{ref:n,className:Te("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));js.displayName=uT.displayName;const Je=g.forwardRef(({className:t,...e},n)=>s.jsx(hT,{ref:n,className:Te("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));Je.displayName=hT.displayName;const et=g.forwardRef(({className:t,...e},n)=>s.jsx(fT,{ref:n,className:Te("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));et.displayName=fT.displayName;function dt({className:t,...e}){return s.jsx("div",{className:Te("animate-pulse rounded-md bg-muted",t),...e})}var Qt;(function(t){t.assertEqual=a=>a;function e(a){}t.assertIs=e;function n(a){throw new Error}t.assertNever=n,t.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},t.getValidEnumValues=a=>{const i=t.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),o={};for(const c of i)o[c]=a[c];return t.objectValues(o)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},t.find=(a,i)=>{for(const o of a)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function r(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Qt||(Qt={}));var gw;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(gw||(gw={}));const Ge=Qt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ji=t=>{switch(typeof t){case"undefined":return Ge.undefined;case"string":return Ge.string;case"number":return isNaN(t)?Ge.nan:Ge.number;case"boolean":return Ge.boolean;case"function":return Ge.function;case"bigint":return Ge.bigint;case"symbol":return Ge.symbol;case"object":return Array.isArray(t)?Ge.array:t===null?Ge.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Ge.promise:typeof Map<"u"&&t instanceof Map?Ge.map:typeof Set<"u"&&t instanceof Set?Ge.set:typeof Date<"u"&&t instanceof Date?Ge.date:Ge.object;default:return Ge.unknown}},De=Qt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),gW=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class hr extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let c=r,d=0;for(;d<o.path.length;){const u=o.path[d];d===o.path.length-1?(c[u]=c[u]||{_errors:[]},c[u]._errors.push(n(o))):c[u]=c[u]||{_errors:[]},c=c[u],d++}}};return a(this),r}static assert(e){if(!(e instanceof hr))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Qt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const a of this.issues)a.path.length>0?(n[a.path[0]]=n[a.path[0]]||[],n[a.path[0]].push(e(a))):r.push(e(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}hr.create=t=>new hr(t);const Sd=(t,e)=>{let n;switch(t.code){case De.invalid_type:t.received===Ge.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case De.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Qt.jsonStringifyReplacer)}`;break;case De.unrecognized_keys:n=`Unrecognized key(s) in object: ${Qt.joinValues(t.keys,", ")}`;break;case De.invalid_union:n="Invalid input";break;case De.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Qt.joinValues(t.options)}`;break;case De.invalid_enum_value:n=`Invalid enum value. Expected ${Qt.joinValues(t.options)}, received '${t.received}'`;break;case De.invalid_arguments:n="Invalid function arguments";break;case De.invalid_return_type:n="Invalid function return type";break;case De.invalid_date:n="Invalid date";break;case De.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Qt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case De.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case De.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case De.custom:n="Invalid input";break;case De.invalid_intersection_types:n="Intersection results could not be merged";break;case De.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case De.not_finite:n="Number must be finite";break;default:n=e.defaultError,Qt.assertNever(t)}return{message:n}};let mT=Sd;function xW(t){mT=t}function u0(){return mT}const h0=t=>{const{data:e,path:n,errorMaps:r,issueData:a}=t,i=[...n,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let c="";const d=r.filter(u=>!!u).slice().reverse();for(const u of d)c=u(o,{data:e,defaultError:c}).message;return{...a,path:i,message:c}},vW=[];function We(t,e){const n=u0(),r=h0({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Sd?void 0:Sd].filter(a=>!!a)});t.common.issues.push(r)}class Ns{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const a of n){if(a.status==="aborted")return Ct;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const a of n){const i=await a.key,o=await a.value;r.push({key:i,value:o})}return Ns.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const a of n){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return Ct;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const Ct=Object.freeze({status:"aborted"}),zc=t=>({status:"dirty",value:t}),Os=t=>({status:"valid",value:t}),xw=t=>t.status==="aborted",vw=t=>t.status==="dirty",Fh=t=>t.status==="valid",Bh=t=>typeof Promise<"u"&&t instanceof Promise;function f0(t,e,n,r){if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function pT(t,e,n,r,a){if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var ot;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ot||(ot={}));var Mu,Ru;class Ha{constructor(e,n,r,a){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const sk=(t,e)=>{if(Fh(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new hr(t.common.issues);return this._error=n,this._error}}};function Dt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:a}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(o,c)=>{var d,u;const{message:m}=t;return o.code==="invalid_enum_value"?{message:m??c.defaultError}:typeof c.data>"u"?{message:(d=m??r)!==null&&d!==void 0?d:c.defaultError}:o.code!=="invalid_type"?{message:c.defaultError}:{message:(u=m??n)!==null&&u!==void 0?u:c.defaultError}},description:a}}class Ft{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Ji(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Ji(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ns,ctx:{common:e.parent.common,data:e.data,parsedType:Ji(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Bh(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const a={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ji(e)},i=this._parseSync({data:e,path:a.path,parent:a});return sk(a,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ji(e)},a=this._parse({data:e,path:r.path,parent:r}),i=await(Bh(a)?a:Promise.resolve(a));return sk(r,i)}refine(e,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,i)=>{const o=e(a),c=()=>i.addIssue({code:De.custom,...r(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(d=>d?!0:(c(),!1)):o?!0:(c(),!1)})}refinement(e,n){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(e){return new ua({schema:this,typeName:bt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Ba.create(this,this._def)}nullable(){return Oo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ra.create(this,this._def)}promise(){return Cd.create(this,this._def)}or(e){return qh.create([this,e],this._def)}and(e){return Wh.create(this,e,this._def)}transform(e){return new ua({...Dt(this._def),schema:this,typeName:bt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Gh({...Dt(this._def),innerType:this,defaultValue:n,typeName:bt.ZodDefault})}brand(){return new Sj({typeName:bt.ZodBranded,type:this,...Dt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Qh({...Dt(this._def),innerType:this,catchValue:n,typeName:bt.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Sf.create(this,e)}readonly(){return Yh.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const yW=/^c[^\s-]{8,}$/i,_W=/^[0-9a-z]+$/,wW=/^[0-9A-HJKMNP-TV-Z]{26}$/,bW=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,jW=/^[a-z0-9_-]{21}$/i,NW=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,SW=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,kW="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let xv;const CW=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,EW=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,AW=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,gT="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",PW=new RegExp(`^${gT}$`);function xT(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function DW(t){return new RegExp(`^${xT(t)}$`)}function vT(t){let e=`${gT}T${xT(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function TW(t,e){return!!((e==="v4"||!e)&&CW.test(t)||(e==="v6"||!e)&&EW.test(t))}class ea extends Ft{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Ge.string){const i=this._getOrReturnCtx(e);return We(i,{code:De.invalid_type,expected:Ge.string,received:i.parsedType}),Ct}const r=new Ns;let a;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),We(a,{code:De.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),We(a,{code:De.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,c=e.data.length<i.value;(o||c)&&(a=this._getOrReturnCtx(e,a),o?We(a,{code:De.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&We(a,{code:De.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")SW.test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{validation:"email",code:De.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")xv||(xv=new RegExp(kW,"u")),xv.test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{validation:"emoji",code:De.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")bW.test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{validation:"uuid",code:De.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")jW.test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{validation:"nanoid",code:De.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")yW.test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{validation:"cuid",code:De.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")_W.test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{validation:"cuid2",code:De.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")wW.test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{validation:"ulid",code:De.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),We(a,{validation:"url",code:De.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{validation:"regex",code:De.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),We(a,{code:De.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),We(a,{code:De.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),We(a,{code:De.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?vT(i).test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{code:De.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?PW.test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{code:De.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?DW(i).test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{code:De.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?NW.test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{validation:"duration",code:De.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?TW(e.data,i.version)||(a=this._getOrReturnCtx(e,a),We(a,{validation:"ip",code:De.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?AW.test(e.data)||(a=this._getOrReturnCtx(e,a),We(a,{validation:"base64",code:De.invalid_string,message:i.message}),r.dirty()):Qt.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(a=>e.test(a),{validation:n,code:De.invalid_string,...ot.errToObj(r)})}_addCheck(e){return new ea({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ot.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ot.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ot.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ot.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ot.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ot.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ot.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ot.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ot.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ot.errToObj(e)})}datetime(e){var n,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...ot.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ot.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ot.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...ot.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...ot.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...ot.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...ot.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...ot.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...ot.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...ot.errToObj(n)})}nonempty(e){return this.min(1,ot.errToObj(e))}trim(){return new ea({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ea({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ea({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ea.create=t=>{var e;return new ea({checks:[],typeName:bt.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Dt(t)})};function MW(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=n>r?n:r,i=parseInt(t.toFixed(a).replace(".","")),o=parseInt(e.toFixed(a).replace(".",""));return i%o/Math.pow(10,a)}class Mo extends Ft{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Ge.number){const i=this._getOrReturnCtx(e);return We(i,{code:De.invalid_type,expected:Ge.number,received:i.parsedType}),Ct}let r;const a=new Ns;for(const i of this._def.checks)i.kind==="int"?Qt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),We(r,{code:De.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),We(r,{code:De.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),We(r,{code:De.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?MW(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),We(r,{code:De.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),We(r,{code:De.not_finite,message:i.message}),a.dirty()):Qt.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ot.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ot.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ot.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ot.toString(n))}setLimit(e,n,r,a){return new Mo({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ot.toString(a)}]})}_addCheck(e){return new Mo({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ot.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ot.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ot.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ot.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ot.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ot.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:ot.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ot.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ot.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Qt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Mo.create=t=>new Mo({checks:[],typeName:bt.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Dt(t)});class Ro extends Ft{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==Ge.bigint){const i=this._getOrReturnCtx(e);return We(i,{code:De.invalid_type,expected:Ge.bigint,received:i.parsedType}),Ct}let r;const a=new Ns;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),We(r,{code:De.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),We(r,{code:De.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),We(r,{code:De.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Qt.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ot.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ot.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ot.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ot.toString(n))}setLimit(e,n,r,a){return new Ro({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ot.toString(a)}]})}_addCheck(e){return new Ro({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ot.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ot.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ot.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ot.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ot.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ro.create=t=>{var e;return new Ro({checks:[],typeName:bt.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Dt(t)})};class zh extends Ft{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Ge.boolean){const r=this._getOrReturnCtx(e);return We(r,{code:De.invalid_type,expected:Ge.boolean,received:r.parsedType}),Ct}return Os(e.data)}}zh.create=t=>new zh({typeName:bt.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Dt(t)});class Ol extends Ft{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Ge.date){const i=this._getOrReturnCtx(e);return We(i,{code:De.invalid_type,expected:Ge.date,received:i.parsedType}),Ct}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return We(i,{code:De.invalid_date}),Ct}const r=new Ns;let a;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(a=this._getOrReturnCtx(e,a),We(a,{code:De.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(a=this._getOrReturnCtx(e,a),We(a,{code:De.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Qt.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ol({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:ot.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:ot.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Ol.create=t=>new Ol({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:bt.ZodDate,...Dt(t)});class m0 extends Ft{_parse(e){if(this._getType(e)!==Ge.symbol){const r=this._getOrReturnCtx(e);return We(r,{code:De.invalid_type,expected:Ge.symbol,received:r.parsedType}),Ct}return Os(e.data)}}m0.create=t=>new m0({typeName:bt.ZodSymbol,...Dt(t)});class $h extends Ft{_parse(e){if(this._getType(e)!==Ge.undefined){const r=this._getOrReturnCtx(e);return We(r,{code:De.invalid_type,expected:Ge.undefined,received:r.parsedType}),Ct}return Os(e.data)}}$h.create=t=>new $h({typeName:bt.ZodUndefined,...Dt(t)});class Uh extends Ft{_parse(e){if(this._getType(e)!==Ge.null){const r=this._getOrReturnCtx(e);return We(r,{code:De.invalid_type,expected:Ge.null,received:r.parsedType}),Ct}return Os(e.data)}}Uh.create=t=>new Uh({typeName:bt.ZodNull,...Dt(t)});class kd extends Ft{constructor(){super(...arguments),this._any=!0}_parse(e){return Os(e.data)}}kd.create=t=>new kd({typeName:bt.ZodAny,...Dt(t)});class Sl extends Ft{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Os(e.data)}}Sl.create=t=>new Sl({typeName:bt.ZodUnknown,...Dt(t)});class Si extends Ft{_parse(e){const n=this._getOrReturnCtx(e);return We(n,{code:De.invalid_type,expected:Ge.never,received:n.parsedType}),Ct}}Si.create=t=>new Si({typeName:bt.ZodNever,...Dt(t)});class p0 extends Ft{_parse(e){if(this._getType(e)!==Ge.undefined){const r=this._getOrReturnCtx(e);return We(r,{code:De.invalid_type,expected:Ge.void,received:r.parsedType}),Ct}return Os(e.data)}}p0.create=t=>new p0({typeName:bt.ZodVoid,...Dt(t)});class ra extends Ft{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),a=this._def;if(n.parsedType!==Ge.array)return We(n,{code:De.invalid_type,expected:Ge.array,received:n.parsedType}),Ct;if(a.exactLength!==null){const o=n.data.length>a.exactLength.value,c=n.data.length<a.exactLength.value;(o||c)&&(We(n,{code:o?De.too_big:De.too_small,minimum:c?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(We(n,{code:De.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(We(n,{code:De.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,c)=>a.type._parseAsync(new Ha(n,o,n.path,c)))).then(o=>Ns.mergeArray(r,o));const i=[...n.data].map((o,c)=>a.type._parseSync(new Ha(n,o,n.path,c)));return Ns.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new ra({...this._def,minLength:{value:e,message:ot.toString(n)}})}max(e,n){return new ra({...this._def,maxLength:{value:e,message:ot.toString(n)}})}length(e,n){return new ra({...this._def,exactLength:{value:e,message:ot.toString(n)}})}nonempty(e){return this.min(1,e)}}ra.create=(t,e)=>new ra({type:t,minLength:null,maxLength:null,exactLength:null,typeName:bt.ZodArray,...Dt(e)});function Nc(t){if(t instanceof Nn){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Ba.create(Nc(r))}return new Nn({...t._def,shape:()=>e})}else return t instanceof ra?new ra({...t._def,type:Nc(t.element)}):t instanceof Ba?Ba.create(Nc(t.unwrap())):t instanceof Oo?Oo.create(Nc(t.unwrap())):t instanceof Va?Va.create(t.items.map(e=>Nc(e))):t}class Nn extends Ft{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Qt.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==Ge.object){const u=this._getOrReturnCtx(e);return We(u,{code:De.invalid_type,expected:Ge.object,received:u.parsedType}),Ct}const{status:r,ctx:a}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),c=[];if(!(this._def.catchall instanceof Si&&this._def.unknownKeys==="strip"))for(const u in a.data)o.includes(u)||c.push(u);const d=[];for(const u of o){const m=i[u],f=a.data[u];d.push({key:{status:"valid",value:u},value:m._parse(new Ha(a,f,a.path,u)),alwaysSet:u in a.data})}if(this._def.catchall instanceof Si){const u=this._def.unknownKeys;if(u==="passthrough")for(const m of c)d.push({key:{status:"valid",value:m},value:{status:"valid",value:a.data[m]}});else if(u==="strict")c.length>0&&(We(a,{code:De.unrecognized_keys,keys:c}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const m of c){const f=a.data[m];d.push({key:{status:"valid",value:m},value:u._parse(new Ha(a,f,a.path,m)),alwaysSet:m in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const u=[];for(const m of d){const f=await m.key,p=await m.value;u.push({key:f,value:p,alwaysSet:m.alwaysSet})}return u}).then(u=>Ns.mergeObjectSync(r,u)):Ns.mergeObjectSync(r,d)}get shape(){return this._def.shape()}strict(e){return ot.errToObj,new Nn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var a,i,o,c;const d=(o=(i=(a=this._def).errorMap)===null||i===void 0?void 0:i.call(a,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(c=ot.errToObj(e).message)!==null&&c!==void 0?c:d}:{message:d}}}:{}})}strip(){return new Nn({...this._def,unknownKeys:"strip"})}passthrough(){return new Nn({...this._def,unknownKeys:"passthrough"})}extend(e){return new Nn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Nn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:bt.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Nn({...this._def,catchall:e})}pick(e){const n={};return Qt.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Nn({...this._def,shape:()=>n})}omit(e){const n={};return Qt.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new Nn({...this._def,shape:()=>n})}deepPartial(){return Nc(this)}partial(e){const n={};return Qt.objectKeys(this.shape).forEach(r=>{const a=this.shape[r];e&&!e[r]?n[r]=a:n[r]=a.optional()}),new Nn({...this._def,shape:()=>n})}required(e){const n={};return Qt.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Ba;)i=i._def.innerType;n[r]=i}}),new Nn({...this._def,shape:()=>n})}keyof(){return yT(Qt.objectKeys(this.shape))}}Nn.create=(t,e)=>new Nn({shape:()=>t,unknownKeys:"strip",catchall:Si.create(),typeName:bt.ZodObject,...Dt(e)});Nn.strictCreate=(t,e)=>new Nn({shape:()=>t,unknownKeys:"strict",catchall:Si.create(),typeName:bt.ZodObject,...Dt(e)});Nn.lazycreate=(t,e)=>new Nn({shape:t,unknownKeys:"strip",catchall:Si.create(),typeName:bt.ZodObject,...Dt(e)});class qh extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function a(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return n.common.issues.push(...c.ctx.common.issues),c.result;const o=i.map(c=>new hr(c.ctx.common.issues));return We(n,{code:De.invalid_union,unionErrors:o}),Ct}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const d of r){const u={...n,common:{...n.common,issues:[]},parent:null},m=d._parseSync({data:n.data,path:n.path,parent:u});if(m.status==="valid")return m;m.status==="dirty"&&!i&&(i={result:m,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const c=o.map(d=>new hr(d));return We(n,{code:De.invalid_union,unionErrors:c}),Ct}}get options(){return this._def.options}}qh.create=(t,e)=>new qh({options:t,typeName:bt.ZodUnion,...Dt(e)});const ii=t=>t instanceof Vh?ii(t.schema):t instanceof ua?ii(t.innerType()):t instanceof Kh?[t.value]:t instanceof Io?t.options:t instanceof Zh?Qt.objectValues(t.enum):t instanceof Gh?ii(t._def.innerType):t instanceof $h?[void 0]:t instanceof Uh?[null]:t instanceof Ba?[void 0,...ii(t.unwrap())]:t instanceof Oo?[null,...ii(t.unwrap())]:t instanceof Sj||t instanceof Yh?ii(t.unwrap()):t instanceof Qh?ii(t._def.innerType):[];class kg extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Ge.object)return We(n,{code:De.invalid_type,expected:Ge.object,received:n.parsedType}),Ct;const r=this.discriminator,a=n.data[r],i=this.optionsMap.get(a);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(We(n,{code:De.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Ct)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const a=new Map;for(const i of n){const o=ii(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const c of o){if(a.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);a.set(c,i)}}return new kg({typeName:bt.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:a,...Dt(r)})}}function yw(t,e){const n=Ji(t),r=Ji(e);if(t===e)return{valid:!0,data:t};if(n===Ge.object&&r===Ge.object){const a=Qt.objectKeys(e),i=Qt.objectKeys(t).filter(c=>a.indexOf(c)!==-1),o={...t,...e};for(const c of i){const d=yw(t[c],e[c]);if(!d.valid)return{valid:!1};o[c]=d.data}return{valid:!0,data:o}}else if(n===Ge.array&&r===Ge.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let i=0;i<t.length;i++){const o=t[i],c=e[i],d=yw(o,c);if(!d.valid)return{valid:!1};a.push(d.data)}return{valid:!0,data:a}}else return n===Ge.date&&r===Ge.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Wh extends Ft{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=(i,o)=>{if(xw(i)||xw(o))return Ct;const c=yw(i.value,o.value);return c.valid?((vw(i)||vw(o))&&n.dirty(),{status:n.value,value:c.data}):(We(r,{code:De.invalid_intersection_types}),Ct)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Wh.create=(t,e,n)=>new Wh({left:t,right:e,typeName:bt.ZodIntersection,...Dt(n)});class Va extends Ft{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ge.array)return We(r,{code:De.invalid_type,expected:Ge.array,received:r.parsedType}),Ct;if(r.data.length<this._def.items.length)return We(r,{code:De.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ct;!this._def.rest&&r.data.length>this._def.items.length&&(We(r,{code:De.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new Ha(r,o,r.path,c)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>Ns.mergeArray(n,o)):Ns.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Va({...this._def,rest:e})}}Va.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Va({items:t,typeName:bt.ZodTuple,rest:null,...Dt(e)})};class Hh extends Ft{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ge.object)return We(r,{code:De.invalid_type,expected:Ge.object,received:r.parsedType}),Ct;const a=[],i=this._def.keyType,o=this._def.valueType;for(const c in r.data)a.push({key:i._parse(new Ha(r,c,r.path,c)),value:o._parse(new Ha(r,r.data[c],r.path,c)),alwaysSet:c in r.data});return r.common.async?Ns.mergeObjectAsync(n,a):Ns.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof Ft?new Hh({keyType:e,valueType:n,typeName:bt.ZodRecord,...Dt(r)}):new Hh({keyType:ea.create(),valueType:e,typeName:bt.ZodRecord,...Dt(n)})}}class g0 extends Ft{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ge.map)return We(r,{code:De.invalid_type,expected:Ge.map,received:r.parsedType}),Ct;const a=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([c,d],u)=>({key:a._parse(new Ha(r,c,r.path,[u,"key"])),value:i._parse(new Ha(r,d,r.path,[u,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of o){const u=await d.key,m=await d.value;if(u.status==="aborted"||m.status==="aborted")return Ct;(u.status==="dirty"||m.status==="dirty")&&n.dirty(),c.set(u.value,m.value)}return{status:n.value,value:c}})}else{const c=new Map;for(const d of o){const u=d.key,m=d.value;if(u.status==="aborted"||m.status==="aborted")return Ct;(u.status==="dirty"||m.status==="dirty")&&n.dirty(),c.set(u.value,m.value)}return{status:n.value,value:c}}}}g0.create=(t,e,n)=>new g0({valueType:e,keyType:t,typeName:bt.ZodMap,...Dt(n)});class Ll extends Ft{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ge.set)return We(r,{code:De.invalid_type,expected:Ge.set,received:r.parsedType}),Ct;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(We(r,{code:De.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(We(r,{code:De.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const i=this._def.valueType;function o(d){const u=new Set;for(const m of d){if(m.status==="aborted")return Ct;m.status==="dirty"&&n.dirty(),u.add(m.value)}return{status:n.value,value:u}}const c=[...r.data.values()].map((d,u)=>i._parse(new Ha(r,d,r.path,u)));return r.common.async?Promise.all(c).then(d=>o(d)):o(c)}min(e,n){return new Ll({...this._def,minSize:{value:e,message:ot.toString(n)}})}max(e,n){return new Ll({...this._def,maxSize:{value:e,message:ot.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Ll.create=(t,e)=>new Ll({valueType:t,minSize:null,maxSize:null,typeName:bt.ZodSet,...Dt(e)});class Xc extends Ft{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Ge.function)return We(n,{code:De.invalid_type,expected:Ge.function,received:n.parsedType}),Ct;function r(c,d){return h0({data:c,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,u0(),Sd].filter(u=>!!u),issueData:{code:De.invalid_arguments,argumentsError:d}})}function a(c,d){return h0({data:c,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,u0(),Sd].filter(u=>!!u),issueData:{code:De.invalid_return_type,returnTypeError:d}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof Cd){const c=this;return Os(async function(...d){const u=new hr([]),m=await c._def.args.parseAsync(d,i).catch(x=>{throw u.addIssue(r(d,x)),u}),f=await Reflect.apply(o,this,m);return await c._def.returns._def.type.parseAsync(f,i).catch(x=>{throw u.addIssue(a(f,x)),u})})}else{const c=this;return Os(function(...d){const u=c._def.args.safeParse(d,i);if(!u.success)throw new hr([r(d,u.error)]);const m=Reflect.apply(o,this,u.data),f=c._def.returns.safeParse(m,i);if(!f.success)throw new hr([a(m,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Xc({...this._def,args:Va.create(e).rest(Sl.create())})}returns(e){return new Xc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new Xc({args:e||Va.create([]).rest(Sl.create()),returns:n||Sl.create(),typeName:bt.ZodFunction,...Dt(r)})}}class Vh extends Ft{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Vh.create=(t,e)=>new Vh({getter:t,typeName:bt.ZodLazy,...Dt(e)});class Kh extends Ft{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return We(n,{received:n.data,code:De.invalid_literal,expected:this._def.value}),Ct}return{status:"valid",value:e.data}}get value(){return this._def.value}}Kh.create=(t,e)=>new Kh({value:t,typeName:bt.ZodLiteral,...Dt(e)});function yT(t,e){return new Io({values:t,typeName:bt.ZodEnum,...Dt(e)})}class Io extends Ft{constructor(){super(...arguments),Mu.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return We(n,{expected:Qt.joinValues(r),received:n.parsedType,code:De.invalid_type}),Ct}if(f0(this,Mu)||pT(this,Mu,new Set(this._def.values)),!f0(this,Mu).has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return We(n,{received:n.data,code:De.invalid_enum_value,options:r}),Ct}return Os(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Io.create(e,{...this._def,...n})}exclude(e,n=this._def){return Io.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}Mu=new WeakMap;Io.create=yT;class Zh extends Ft{constructor(){super(...arguments),Ru.set(this,void 0)}_parse(e){const n=Qt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Ge.string&&r.parsedType!==Ge.number){const a=Qt.objectValues(n);return We(r,{expected:Qt.joinValues(a),received:r.parsedType,code:De.invalid_type}),Ct}if(f0(this,Ru)||pT(this,Ru,new Set(Qt.getValidEnumValues(this._def.values))),!f0(this,Ru).has(e.data)){const a=Qt.objectValues(n);return We(r,{received:r.data,code:De.invalid_enum_value,options:a}),Ct}return Os(e.data)}get enum(){return this._def.values}}Ru=new WeakMap;Zh.create=(t,e)=>new Zh({values:t,typeName:bt.ZodNativeEnum,...Dt(e)});class Cd extends Ft{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Ge.promise&&n.common.async===!1)return We(n,{code:De.invalid_type,expected:Ge.promise,received:n.parsedType}),Ct;const r=n.parsedType===Ge.promise?n.data:Promise.resolve(n.data);return Os(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Cd.create=(t,e)=>new Cd({type:t,typeName:bt.ZodPromise,...Dt(e)});class ua extends Ft{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===bt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:o=>{We(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(r.data,i);if(r.common.async)return Promise.resolve(o).then(async c=>{if(n.value==="aborted")return Ct;const d=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return d.status==="aborted"?Ct:d.status==="dirty"||n.value==="dirty"?zc(d.value):d});{if(n.value==="aborted")return Ct;const c=this._def.schema._parseSync({data:o,path:r.path,parent:r});return c.status==="aborted"?Ct:c.status==="dirty"||n.value==="dirty"?zc(c.value):c}}if(a.type==="refinement"){const o=c=>{const d=a.refinement(c,i);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?Ct:(c.status==="dirty"&&n.dirty(),o(c.value),{status:n.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?Ct:(c.status==="dirty"&&n.dirty(),o(c.value).then(()=>({status:n.value,value:c.value}))))}if(a.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Fh(o))return o;const c=a.transform(o.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Fh(o)?Promise.resolve(a.transform(o.value,i)).then(c=>({status:n.value,value:c})):o);Qt.assertNever(a)}}ua.create=(t,e,n)=>new ua({schema:t,typeName:bt.ZodEffects,effect:e,...Dt(n)});ua.createWithPreprocess=(t,e,n)=>new ua({schema:e,effect:{type:"preprocess",transform:t},typeName:bt.ZodEffects,...Dt(n)});class Ba extends Ft{_parse(e){return this._getType(e)===Ge.undefined?Os(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ba.create=(t,e)=>new Ba({innerType:t,typeName:bt.ZodOptional,...Dt(e)});class Oo extends Ft{_parse(e){return this._getType(e)===Ge.null?Os(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Oo.create=(t,e)=>new Oo({innerType:t,typeName:bt.ZodNullable,...Dt(e)});class Gh extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===Ge.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Gh.create=(t,e)=>new Gh({innerType:t,typeName:bt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Dt(e)});class Qh extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Bh(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new hr(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new hr(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Qh.create=(t,e)=>new Qh({innerType:t,typeName:bt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Dt(e)});class x0 extends Ft{_parse(e){if(this._getType(e)!==Ge.nan){const r=this._getOrReturnCtx(e);return We(r,{code:De.invalid_type,expected:Ge.nan,received:r.parsedType}),Ct}return{status:"valid",value:e.data}}}x0.create=t=>new x0({typeName:bt.ZodNaN,...Dt(t)});const RW=Symbol("zod_brand");class Sj extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Sf extends Ft{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Ct:i.status==="dirty"?(n.dirty(),zc(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Ct:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,n){return new Sf({in:e,out:n,typeName:bt.ZodPipeline})}}class Yh extends Ft{_parse(e){const n=this._def.innerType._parse(e),r=a=>(Fh(a)&&(a.value=Object.freeze(a.value)),a);return Bh(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}Yh.create=(t,e)=>new Yh({innerType:t,typeName:bt.ZodReadonly,...Dt(e)});function _T(t,e={},n){return t?kd.create().superRefine((r,a)=>{var i,o;if(!t(r)){const c=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,d=(o=(i=c.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,u=typeof c=="string"?{message:c}:c;a.addIssue({code:"custom",...u,fatal:d})}}):kd.create()}const IW={object:Nn.lazycreate};var bt;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(bt||(bt={}));const OW=(t,e={message:`Input not instance of ${t.name}`})=>_T(n=>n instanceof t,e),wT=ea.create,bT=Mo.create,LW=x0.create,FW=Ro.create,jT=zh.create,BW=Ol.create,zW=m0.create,$W=$h.create,UW=Uh.create,qW=kd.create,WW=Sl.create,HW=Si.create,VW=p0.create,KW=ra.create,ZW=Nn.create,GW=Nn.strictCreate,QW=qh.create,YW=kg.create,XW=Wh.create,JW=Va.create,eH=Hh.create,tH=g0.create,nH=Ll.create,sH=Xc.create,rH=Vh.create,aH=Kh.create,iH=Io.create,oH=Zh.create,lH=Cd.create,rk=ua.create,cH=Ba.create,dH=Oo.create,uH=ua.createWithPreprocess,hH=Sf.create,fH=()=>wT().optional(),mH=()=>bT().optional(),pH=()=>jT().optional(),gH={string:t=>ea.create({...t,coerce:!0}),number:t=>Mo.create({...t,coerce:!0}),boolean:t=>zh.create({...t,coerce:!0}),bigint:t=>Ro.create({...t,coerce:!0}),date:t=>Ol.create({...t,coerce:!0})},xH=Ct;var E=Object.freeze({__proto__:null,defaultErrorMap:Sd,setErrorMap:xW,getErrorMap:u0,makeIssue:h0,EMPTY_PATH:vW,addIssueToContext:We,ParseStatus:Ns,INVALID:Ct,DIRTY:zc,OK:Os,isAborted:xw,isDirty:vw,isValid:Fh,isAsync:Bh,get util(){return Qt},get objectUtil(){return gw},ZodParsedType:Ge,getParsedType:Ji,ZodType:Ft,datetimeRegex:vT,ZodString:ea,ZodNumber:Mo,ZodBigInt:Ro,ZodBoolean:zh,ZodDate:Ol,ZodSymbol:m0,ZodUndefined:$h,ZodNull:Uh,ZodAny:kd,ZodUnknown:Sl,ZodNever:Si,ZodVoid:p0,ZodArray:ra,ZodObject:Nn,ZodUnion:qh,ZodDiscriminatedUnion:kg,ZodIntersection:Wh,ZodTuple:Va,ZodRecord:Hh,ZodMap:g0,ZodSet:Ll,ZodFunction:Xc,ZodLazy:Vh,ZodLiteral:Kh,ZodEnum:Io,ZodNativeEnum:Zh,ZodPromise:Cd,ZodEffects:ua,ZodTransformer:ua,ZodOptional:Ba,ZodNullable:Oo,ZodDefault:Gh,ZodCatch:Qh,ZodNaN:x0,BRAND:RW,ZodBranded:Sj,ZodPipeline:Sf,ZodReadonly:Yh,custom:_T,Schema:Ft,ZodSchema:Ft,late:IW,get ZodFirstPartyTypeKind(){return bt},coerce:gH,any:qW,array:KW,bigint:FW,boolean:jT,date:BW,discriminatedUnion:YW,effect:rk,enum:iH,function:sH,instanceof:OW,intersection:XW,lazy:rH,literal:aH,map:tH,nan:LW,nativeEnum:oH,never:HW,null:UW,nullable:dH,number:bT,object:ZW,oboolean:pH,onumber:mH,optional:cH,ostring:fH,pipeline:hH,preprocess:uH,promise:lH,record:eH,set:nH,strictObject:GW,string:wT,symbol:zW,transformer:rk,tuple:JW,undefined:$W,union:QW,unknown:WW,void:VW,NEVER:xH,ZodIssueCode:De,quotelessJson:gW,ZodError:hr});const st={UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",INVALID_TOKEN:"INVALID_TOKEN",VALIDATION_ERROR:"VALIDATION_ERROR",INVALID_INPUT:"INVALID_INPUT",MISSING_REQUIRED_FIELD:"MISSING_REQUIRED_FIELD",RESOURCE_NOT_FOUND:"RESOURCE_NOT_FOUND",RESOURCE_ALREADY_EXISTS:"RESOURCE_ALREADY_EXISTS",BUSINESS_RULE_VIOLATION:"BUSINESS_RULE_VIOLATION",INSUFFICIENT_PERMISSIONS:"INSUFFICIENT_PERMISSIONS",IMMUTABLE_RECORD:"IMMUTABLE_RECORD",AUDIT_REQUIRED:"AUDIT_REQUIRED",DOCUMENT_LOCKED:"DOCUMENT_LOCKED",RETENTION_PERIOD_ACTIVE:"RETENTION_PERIOD_ACTIVE",INTERNAL_ERROR:"INTERNAL_ERROR",DATABASE_ERROR:"DATABASE_ERROR",NETWORK_ERROR:"NETWORK_ERROR",SERVICE_UNAVAILABLE:"SERVICE_UNAVAILABLE",RATE_LIMIT_EXCEEDED:"RATE_LIMIT_EXCEEDED"};let tt=class extends Error{constructor(e,n,r,a=400){super(n),this.code=e,this.details=r,this.statusCode=a,this.name="ApiError"}};const NT=()=>`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,fr=(t,e,n)=>{try{return t.parse(e)}catch(r){throw r instanceof E.ZodError?new tt(st.VALIDATION_ERROR,"Input validation failed",{validationErrors:r.errors,receivedData:e}):r}},dh=t=>{throw console.error("Supabase error:",t),t.code==="PGRST116"?new tt(st.FORBIDDEN,"Insufficient permissions to access this resource",{supabaseCode:t.code}):t.code==="23505"?new tt(st.RESOURCE_ALREADY_EXISTS,"Resource already exists",{supabaseCode:t.code,constraint:t.constraint}):t.code==="23503"?new tt(st.BUSINESS_RULE_VIOLATION,"Referenced resource does not exist",{supabaseCode:t.code,constraint:t.constraint}):new tt(st.DATABASE_ERROR,t.message||"Database operation failed",{supabaseError:t})};async function Be(t,e){const n=NT();try{console.log(`[${n}] Starting API operation: ${e||"Unknown"}`);const r=await t();return console.log(`[${n}] API operation completed successfully`),r}catch(r){throw console.error(`[${n}] API operation failed:`,r),r instanceof tt?r:(r&&typeof r=="object"&&"code"in r&&dh(r),new tt(st.INTERNAL_ERROR,r instanceof Error?r.message:"Unknown error occurred",{requestId:n,originalError:r}))}}class vH{constructor(e){qn(this,"query");qn(this,"requestId");this.query=e,this.requestId=NT()}async execute(){return Be(async()=>{const{data:e,error:n}=await this.query;return n&&dh(n),e||[]},`Query execution [${this.requestId}]`)}async executeSingle(){return Be(async()=>{const{data:e,error:n}=await this.query.single();if(n){if(n.code==="PGRST116")throw new tt(st.RESOURCE_NOT_FOUND,"Resource not found");dh(n)}return e},`Single query execution [${this.requestId}]`)}async executeWithCount(){return Be(async()=>{const{data:e,error:n,count:r}=await this.query;return n&&dh(n),{data:e||[],count:r||0}},`Query with count execution [${this.requestId}]`)}}const rt=t=>new vH(t),yH=async()=>Be(async()=>{const{data:{user:t},error:e}=await Z.auth.getUser();if(e)throw new tt(st.UNAUTHORIZED,"Authentication required");if(!t)throw new tt(st.UNAUTHORIZED,"User not authenticated");return t},"Get current user"),Xr=async()=>Be(async()=>{const t=await yH(),{data:e,error:n}=await Z.from("profiles").select("*").eq("id",t.id).single();return n&&dh(n),e},"Get current user profile"),Ga=E.object({id:E.string().uuid(),created_at:E.string().datetime(),updated_at:E.string().datetime(),company_id:E.string().uuid().optional()}),kj=E.object({company_name:E.string().min(1,"Firmenname ist erforderlich"),contact_person:E.string().min(1,"Ansprechpartner ist erforderlich"),email:E.string().email("Gültige E-Mail-Adresse erforderlich"),phone:E.string().optional(),address:E.string().optional(),city:E.string().optional(),postal_code:E.string().optional(),country:E.string().default("Deutschland"),tax_number:E.string().optional(),customer_number:E.string().optional(),status:E.enum(["Aktiv","Premium","Inaktiv"]).default("Aktiv")}),_H=kj.partial();Ga.merge(kj).extend({customer_number:E.string().nullable()});const ST=E.object({name:E.string().min(1,"Materialname ist erforderlich"),sku:E.string().optional(),description:E.string().optional(),unit:E.string().default("Stk"),unit_price:E.number().min(0,"Preis muss positiv sein").default(0),stock:E.number().int().min(0,"Lagerbestand muss positiv sein").default(0),reorder_min:E.number().int().min(0,"Mindestbestand muss positiv sein").default(0),category:E.string().optional(),supplier:E.string().optional()});ST.partial();Ga.merge(ST);const wH=E.object({id:E.string().optional(),description:E.string().min(1,"Beschreibung ist erforderlich"),quantity:E.number().min(.01,"Menge muss größer als 0 sein"),unit:E.string().default("Stk"),unit_price:E.number().min(0,"Preis muss positiv sein"),total_price:E.number().min(0,"Gesamtpreis muss positiv sein")}),Cj=E.object({customer_id:E.string().uuid("Kunde ist erforderlich"),title:E.string().min(1,"Titel ist erforderlich"),description:E.string().optional(),body:E.object({items:E.array(wH).min(1,"Mindestens ein Posten erforderlich"),notes:E.string().optional(),terms:E.string().optional()}),tax_rate:E.number().min(0).max(100).default(19),valid_until:E.string().date().optional()}),bH=Cj.partial().extend({status:E.enum(["draft","sent","accepted","rejected","expired"]).optional(),quote_number:E.string().optional()});Ga.merge(Cj).extend({quote_number:E.string().nullable(),status:E.enum(["draft","sent","accepted","rejected","expired"]).default("draft"),total_net:E.number().optional(),total_gross:E.number().optional(),sent_at:E.string().datetime().optional(),accepted_at:E.string().datetime().optional()});const Ej=E.object({quote_id:E.string().uuid().optional(),customer_id:E.string().uuid("Kunde ist erforderlich"),title:E.string().min(1,"Titel ist erforderlich"),description:E.string().optional(),total_amount:E.number().min(0,"Betrag muss positiv sein")}),jH=Ej.partial().extend({status:E.enum(["open","in_progress","completed","cancelled"]).optional(),order_number:E.string().optional()});Ga.merge(Ej).extend({order_number:E.string().nullable(),status:E.enum(["open","in_progress","completed","cancelled"]).default("open")});const Aj=E.object({order_id:E.string().uuid().optional(),customer_id:E.string().uuid().optional(),name:E.string().min(1,"Projektname ist erforderlich"),description:E.string().optional(),status:E.enum(["planned","active","blocked","completed","cancelled"]).default("planned"),budget:E.number().min(0,"Budget muss positiv sein").optional(),start_date:E.string().date().optional(),end_date:E.string().date().optional(),progress_percentage:E.number().min(0).max(100).default(0)}),NH=Aj.partial();Ga.merge(Aj).extend({material_costs:E.number().default(0),labor_costs:E.number().default(0),hours_planned:E.number().optional(),hours_actual:E.number().default(0)});const Pj=E.object({project_id:E.string().uuid().optional(),customer_id:E.string().uuid("Kunde ist erforderlich"),title:E.string().min(1,"Titel ist erforderlich"),description:E.string().optional(),amount:E.number().min(0,"Betrag muss positiv sein"),tax_rate:E.number().min(0).max(100).default(19),due_date:E.string().date().optional()}),SH=Pj.partial().extend({status:E.enum(["draft","sent","paid","overdue","void","cancelled"]).optional(),invoice_number:E.string().optional()});Ga.merge(Pj).extend({invoice_number:E.string().nullable(),status:E.enum(["draft","sent","paid","overdue","void","cancelled"]).default("draft"),net_amount:E.number().optional(),tax_amount:E.number().optional(),sent_at:E.string().datetime().optional(),paid_at:E.string().datetime().optional()});const Dj=E.object({project_id:E.string().uuid("Projekt ist erforderlich"),employee_id:E.string().uuid("Mitarbeiter ist erforderlich"),date:E.string().date("Gültiges Datum erforderlich"),start_time:E.string().time().optional(),end_time:E.string().time().optional(),break_minutes:E.number().int().min(0).default(0),hours:E.number().min(0,"Stunden müssen positiv sein"),description:E.string().optional(),task_category:E.string().default("general"),hourly_rate:E.number().min(0,"Stundensatz muss positiv sein").optional(),is_billable:E.boolean().default(!0)}),kH=Dj.partial().extend({approved_by:E.string().uuid().optional(),approved_at:E.string().datetime().optional()});Ga.merge(Dj).extend({approved_by:E.string().uuid().optional(),approved_at:E.string().datetime().optional()});const Tj=E.object({project_id:E.string().uuid().optional(),employee_id:E.string().uuid().optional(),category:E.string().min(1,"Kategorie ist erforderlich"),amount:E.number().min(0,"Betrag muss positiv sein"),description:E.string().optional(),receipt_url:E.string().url().optional(),expense_date:E.string().date("Gültiges Datum erforderlich"),is_billable:E.boolean().default(!1)});Tj.partial().extend({approved_by:E.string().uuid().optional(),approved_at:E.string().datetime().optional()});Ga.merge(Tj).extend({approved_by:E.string().uuid().optional(),approved_at:E.string().datetime().optional()});const CH=E.object({material_id:E.string().uuid("Material ist erforderlich"),project_id:E.string().uuid().optional(),quantity:E.number().int().refine(t=>t!==0,"Menge darf nicht 0 sein"),movement_type:E.enum(["issue","receive","adjust","return"]),reference_number:E.string().optional(),notes:E.string().optional()});Ga.merge(CH);const kT=E.object({first_name:E.string().min(1,"Vorname ist erforderlich"),last_name:E.string().min(1,"Nachname ist erforderlich"),email:E.string().email("Gültige E-Mail-Adresse erforderlich"),phone:E.string().optional(),role:E.string().default("employee"),hourly_wage:E.number().min(0,"Stundenlohn muss positiv sein").default(0),status:E.enum(["active","inactive","invited"]).default("active")});kT.partial();Ga.merge(kT);const EH=E.object({success:E.literal(!0),data:E.any(),message:E.string().optional()}),AH=E.object({success:E.literal(!1),error:E.object({code:E.string(),message:E.string(),details:E.any().optional()})});E.union([EH,AH]);E.object({page:E.coerce.number().int().min(1).default(1),limit:E.coerce.number().int().min(1).max(100).default(20),sort_by:E.string().optional(),sort_order:E.enum(["asc","desc"]).default("desc")});E.object({items:E.array(E.any()),pagination:E.object({page:E.number(),limit:E.number(),total_items:E.number(),total_pages:E.number(),has_next:E.boolean(),has_prev:E.boolean()})});const PH=E.object({project_id:E.string().uuid().optional(),suggestion_type:E.enum(["parse_intent","estimate","schedule","material_list","cost_breakdown","timeline"]),input_data:E.record(E.any()).refine(t=>Object.keys(t).length>0,"Input data is required"),output_data:E.record(E.any()).refine(t=>Object.keys(t).length>0,"Output data is required"),confidence_score:E.number().min(0).max(1).optional(),model_version:E.string().optional(),trace_id:E.string().uuid().optional()});PH.partial().extend({status:E.enum(["active","applied","rejected","superseded"]).optional(),applied_by:E.string().uuid().optional(),applied_at:E.string().datetime().optional(),feedback_score:E.number().int().min(1).max(5).optional(),feedback_notes:E.string().optional()});E.object({id:E.string().uuid(),project_id:E.string().uuid().optional(),suggestion_type:E.enum(["parse_intent","estimate","schedule","material_list","cost_breakdown","timeline"]),input_data:E.record(E.any()),output_data:E.record(E.any()),confidence_score:E.number().min(0).max(1).optional(),model_version:E.string().optional(),trace_id:E.string().uuid().optional(),status:E.enum(["active","applied","rejected","superseded"]).default("active"),applied_by:E.string().uuid().optional(),applied_at:E.string().datetime().optional(),feedback_score:E.number().int().min(1).max(5).optional(),feedback_notes:E.string().optional(),company_id:E.string().uuid().optional(),created_at:E.string().datetime(),updated_at:E.string().datetime()});E.object({ref_type:E.string().min(1,"Reference type is required"),ref_id:E.string().uuid("Valid reference ID required"),content_text:E.string().min(1,"Content text is required"),metadata:E.record(E.any()).optional()});E.object({id:E.string().uuid(),ref_type:E.string(),ref_id:E.string().uuid(),content_text:E.string(),embedding:E.array(E.number()).optional(),metadata:E.record(E.any()).optional(),indexed_at:E.string().datetime(),company_id:E.string().uuid().optional(),created_at:E.string().datetime(),updated_at:E.string().datetime()});E.object({operation_type:E.enum(["index_content","generate_estimate","create_schedule","extract_intent"]),entity_type:E.string().min(1,"Entity type is required"),entity_id:E.string().uuid("Valid entity ID required"),input_data:E.record(E.any()).refine(t=>Object.keys(t).length>0,"Input data is required"),priority:E.number().int().min(1).max(10).default(5),scheduled_for:E.string().datetime().optional()});E.object({id:E.string().uuid(),operation_type:E.enum(["index_content","generate_estimate","create_schedule","extract_intent"]),entity_type:E.string(),entity_id:E.string().uuid(),input_data:E.record(E.any()),priority:E.number().int().min(1).max(10).default(5),status:E.enum(["pending","processing","completed","failed"]).default("pending"),attempts:E.number().int().min(0).default(0),max_attempts:E.number().int().min(1).default(3),error_message:E.string().optional(),result_data:E.record(E.any()).optional(),scheduled_for:E.string().datetime(),started_at:E.string().datetime().optional(),completed_at:E.string().datetime().optional(),company_id:E.string().uuid().optional(),created_at:E.string().datetime()});E.object({data_type:E.enum(["estimate_correction","schedule_feedback","material_suggestion","cost_actual_vs_predicted"]),input_features:E.record(E.any()).refine(t=>Object.keys(t).length>0,"Input features required"),expected_output:E.record(E.any()).refine(t=>Object.keys(t).length>0,"Expected output required"),predicted_output:E.record(E.any()).optional(),prediction_error:E.number().optional(),project_id:E.string().uuid().optional(),suggestion_id:E.string().uuid().optional()});E.object({id:E.string().uuid(),data_type:E.enum(["estimate_correction","schedule_feedback","material_suggestion","cost_actual_vs_predicted"]),input_features:E.record(E.any()),expected_output:E.record(E.any()),predicted_output:E.record(E.any()).optional(),prediction_error:E.number().optional(),project_id:E.string().uuid().optional(),suggestion_id:E.string().uuid().optional(),company_id:E.string().uuid().optional(),created_at:E.string().datetime()});E.object({text:E.string().min(1,"Text content is required"),context:E.object({customer_info:E.string().optional(),previous_projects:E.array(E.string()).optional(),preferred_materials:E.array(E.string()).optional()}).optional()});E.object({intent_type:E.enum(["quote_request","project_inquiry","maintenance","consultation","emergency"]),confidence:E.number().min(0).max(1),extracted_data:E.object({customer_name:E.string().optional(),project_type:E.string().optional(),description:E.string().optional(),urgency:E.enum(["low","medium","high","urgent"]).optional(),budget_range:E.object({min:E.number().optional(),max:E.number().optional()}).optional(),timeline:E.object({start_date:E.string().date().optional(),end_date:E.string().date().optional(),duration_days:E.number().optional()}).optional(),materials:E.array(E.object({name:E.string(),quantity:E.number().optional(),unit:E.string().optional()})).optional()}),suggestions:E.array(E.string()).optional()});E.object({project_description:E.string().min(1,"Project description is required"),project_type:E.string().optional(),customer_id:E.string().uuid().optional(),timeline:E.object({start_date:E.string().date().optional(),duration_days:E.number().min(1).optional()}).optional(),requirements:E.array(E.string()).optional(),similar_projects:E.array(E.string().uuid()).optional()});E.object({confidence:E.number().min(0).max(1),total_estimate:E.number().min(0),breakdown:E.object({labor_hours:E.number().min(0),labor_cost:E.number().min(0),material_cost:E.number().min(0),equipment_cost:E.number().min(0).default(0),overhead_cost:E.number().min(0).default(0)}),materials:E.array(E.object({name:E.string(),material_id:E.string().uuid().optional(),quantity:E.number().min(0),unit:E.string(),unit_price:E.number().min(0),total_cost:E.number().min(0),availability:E.enum(["available","order_needed","unavailable"]).optional()})),timeline:E.object({estimated_duration_days:E.number().min(1),phases:E.array(E.object({name:E.string(),duration_days:E.number().min(1),description:E.string().optional()})).optional()}),risks:E.array(E.object({description:E.string(),impact:E.enum(["low","medium","high"]),mitigation:E.string().optional()})).optional()});E.object({project_id:E.string().uuid("Project ID is required"),requirements:E.object({start_date:E.string().date().optional(),end_date:E.string().date().optional(),duration_days:E.number().min(1).optional(),required_skills:E.array(E.string()).optional(),team_size:E.number().int().min(1).optional()}),constraints:E.object({available_employees:E.array(E.string().uuid()).optional(),excluded_dates:E.array(E.string().date()).optional(),priority:E.enum(["low","medium","high","urgent"]).default("medium")}).optional()});E.object({confidence:E.number().min(0).max(1),recommended_schedule:E.array(E.object({employee_id:E.string().uuid(),employee_name:E.string(),dates:E.array(E.object({date:E.string().date(),hours:E.number().min(0).max(24),tasks:E.array(E.string()).optional()})),total_hours:E.number().min(0)})),conflicts:E.array(E.object({type:E.enum(["employee_unavailable","overallocation","skill_mismatch","deadline_conflict"]),description:E.string(),affected_employees:E.array(E.string().uuid()).optional(),severity:E.enum(["low","medium","high"])})),alternatives:E.array(E.object({description:E.string(),impact:E.string(),schedule:E.any().optional()})).optional()});E.object({entity_type:E.string().min(1,"Entity type is required"),entity_id:E.string().uuid("Valid entity ID required"),action:E.enum(["INSERT","UPDATE","DELETE","STATUS_CHANGE"]),old_values:E.record(E.any()).optional(),new_values:E.record(E.any()).optional(),changed_fields:E.array(E.string()).optional(),reason:E.string().optional(),ip_address:E.string().ip().optional(),user_agent:E.string().optional()});E.object({id:E.string().uuid(),entity_type:E.string(),entity_id:E.string().uuid(),action:E.enum(["INSERT","UPDATE","DELETE","STATUS_CHANGE"]),old_values:E.record(E.any()).optional(),new_values:E.record(E.any()).optional(),changed_fields:E.array(E.string()).optional(),user_id:E.string().uuid().optional(),user_email:E.string().email().optional(),reason:E.string().optional(),ip_address:E.string().optional(),user_agent:E.string().optional(),company_id:E.string().uuid().optional(),created_at:E.string().datetime()});const DH=E.object({sequence_name:E.string().min(1,"Sequence name is required"),prefix:E.string().default(""),format_pattern:E.string().default("{prefix}-{year}-{number:04d}"),year_reset:E.boolean().default(!0),current_value:E.number().int().min(0).default(0)});DH.partial();E.object({id:E.string().uuid(),sequence_name:E.string(),current_value:E.number().int().min(0),prefix:E.string(),year_reset:E.boolean(),format_pattern:E.string(),last_reset_year:E.number().int().optional(),company_id:E.string().uuid().optional(),created_at:E.string().datetime(),updated_at:E.string().datetime()});E.object({entity_type:E.string().min(1,"Entity type is required"),entity_id:E.string().uuid("Valid entity ID required"),file_name:E.string().min(1,"File name is required"),file_path:E.string().min(1,"File path is required"),file_size:E.number().int().min(0,"File size must be non-negative"),mime_type:E.string().min(1,"MIME type is required"),sha256_hash:E.string().regex(/^[a-fA-F0-9]{64}$/,"Valid SHA256 hash required"),is_original:E.boolean().default(!0),legal_category:E.enum(["invoice","contract","receipt","tax_document","correspondence"]),retention_until:E.string().date("Valid retention date required")});E.object({id:E.string().uuid(),entity_type:E.string(),entity_id:E.string().uuid(),file_name:E.string(),file_path:E.string(),file_size:E.number().int(),mime_type:E.string(),sha256_hash:E.string().regex(/^[a-fA-F0-9]{64}$/),created_by:E.string().uuid().optional(),is_original:E.boolean(),legal_category:E.enum(["invoice","contract","receipt","tax_document","correspondence"]),retention_until:E.string().date(),company_id:E.string().uuid().optional(),created_at:E.string().datetime()});E.object({from_date:E.string().date("Valid from date required"),to_date:E.string().date("Valid to date required"),export_type:E.enum(["invoices","postings","full"]).default("invoices"),include_drafts:E.boolean().default(!1),consultant_number:E.string().optional(),client_number:E.string().optional(),encoding:E.enum(["UTF-8","CP1252"]).default("CP1252")});E.object({export_id:E.string().uuid(),file_url:E.string().url(),file_name:E.string(),record_count:E.number().int().min(0),export_date:E.string().datetime(),from_date:E.string().date(),to_date:E.string().date(),checksum:E.string().optional()});E.object({belegdatum:E.string().date(),rechnungsnummer:E.string(),debitorenkonto:E.string().optional(),gegenkonto:E.string(),bu_schluessel:E.string().optional(),nettobetrag:E.number(),steuerbetrag:E.number().default(0),bruttobetrag:E.number(),belegfeld1:E.string().optional(),kost1:E.string().optional(),kost2:E.string().optional(),project_id:E.string().uuid().optional(),customer_id:E.string().uuid().optional(),description:E.string().optional()});E.object({entity_type:E.enum(["quote","order","invoice"]),entity_id:E.string().uuid(),from_status:E.string(),to_status:E.string(),reason:E.string().optional(),require_immutable_file:E.boolean().default(!1),file_data:E.object({content:E.string(),filename:E.string(),mime_type:E.string()}).optional()});E.object({report_type:E.enum(["audit_summary","document_integrity","number_sequence_gaps","retention_overview"]),from_date:E.string().date().optional(),to_date:E.string().date().optional(),entity_types:E.array(E.string()).optional()});E.object({report_type:E.string(),generated_at:E.string().datetime(),period:E.object({from_date:E.string().date().optional(),to_date:E.string().date().optional()}),summary:E.object({total_records:E.number().int(),compliant_records:E.number().int(),issues_found:E.number().int(),compliance_percentage:E.number().min(0).max(100)}),details:E.array(E.object({entity_type:E.string(),entity_id:E.string().uuid(),issue_type:E.string(),description:E.string(),severity:E.enum(["low","medium","high","critical"]),recommendation:E.string().optional()})),file_integrity:E.object({total_files:E.number().int(),verified_files:E.number().int(),failed_verifications:E.number().int(),missing_files:E.number().int()}).optional()});E.object({entity_type:E.string().min(1,"Entity type is required"),entity_ids:E.array(E.string().uuid()).min(1,"At least one entity ID required"),archive_reason:E.string().min(1,"Archive reason is required"),retention_years:E.number().int().min(1).max(30).default(10),include_related:E.boolean().default(!0)});E.object({archive_id:E.string().uuid(),archived_count:E.number().int(),archive_location:E.string(),retention_until:E.string().date(),created_at:E.string().datetime()});const ak=(t,e=!1)=>{const n={can_view:!1,can_edit_basic_data:!1,can_add_time:!1,can_add_materials:!1,can_upload_files:!1,can_change_status:!1,can_link_invoices:!1,can_delete:!1,can_manage_team:!1};switch(t){case"mitarbeiter":return{...n,can_view:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0};case"projektleiter":return{...n,can_view:!0,can_edit_basic_data:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0,can_change_status:!0,can_link_invoices:!0,can_manage_team:!0};case"admin":return{can_view:!0,can_edit_basic_data:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0,can_change_status:!0,can_link_invoices:!0,can_delete:!0,can_manage_team:!0};default:return n}},ik={anfrage:{label:"Anfrage",color:"text-purple-700",bgColor:"bg-purple-100",icon:"📋",description:"Projekt-Anfrage eingegangen",nextStates:["besichtigung"],previousStates:[]},besichtigung:{label:"Termin ausmachen",color:"text-orange-700",bgColor:"bg-orange-100",icon:"📅",description:"Besichtigungstermin vereinbaren",nextStates:["geplant"],previousStates:["anfrage"]},geplant:{label:"In Planung",color:"text-blue-700",bgColor:"bg-blue-100",icon:"📝",description:"Projekt ist in Planung",nextStates:["in_bearbeitung"],previousStates:["besichtigung"]},in_bearbeitung:{label:"In Arbeit",color:"text-yellow-700",bgColor:"bg-yellow-100",icon:"🔨",description:"Projekt läuft aktiv",nextStates:["abgeschlossen"],previousStates:["geplant"]},abgeschlossen:{label:"Erledigt",color:"text-green-700",bgColor:"bg-green-100",icon:"✅",description:"Projekt ist abgeschlossen",nextStates:[],previousStates:["in_bearbeitung"]}};class Cg{static async getCustomers(e,n){return Be(async()=>{let r=Z.from("customers").select("*",{count:"exact"});if(n!=null&&n.status&&(r=r.eq("status",n.status)),n!=null&&n.search&&(r=r.or(`company_name.ilike.%${n.search}%,contact_person.ilike.%${n.search}%,email.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else r=r.order("created_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get customers")}static async getCustomer(e){return Be(async()=>{const n=Z.from("customers").select("*").eq("id",e);return rt(n).executeSingle()},`Get customer ${e}`)}static async createCustomer(e){return Be(async()=>{const n=fr(kj,e);if(!n.customer_number){const a=await this.generateCustomerNumber();n.customer_number=a}const r=Z.from("customers").insert(n).select().single();return rt(r).executeSingle()},"Create customer")}static async updateCustomer(e,n){return Be(async()=>{const r=fr(_H,n);await this.getCustomer(e);const a=Z.from("customers").update(r).eq("id",e).select().single();return rt(a).executeSingle()},`Update customer ${e}`)}static async deleteCustomer(e){return Be(async()=>{const{data:n}=await Z.from("projects").select("id").eq("customer_id",e).limit(1);if(n&&n.length>0)throw new tt(st.BUSINESS_RULE_VIOLATION,"Kunde kann nicht gelöscht werden, da noch Projekte zugeordnet sind.",{relatedProjects:n.length});const{data:r}=await Z.from("quotes").select("id").eq("customer_id",e).limit(1);if(r&&r.length>0)throw new tt(st.BUSINESS_RULE_VIOLATION,"Kunde kann nicht gelöscht werden, da noch Angebote vorhanden sind.",{relatedQuotes:r.length});const{error:a}=await Z.from("customers").delete().eq("id",e);if(a)throw a},`Delete customer ${e}`)}static async getCustomerStats(e){return Be(async()=>{const{data:n}=await Z.from("projects").select("status, budget").eq("customer_id",e),{data:r}=await Z.from("invoices").select("status, amount").eq("customer_id",e);return{total_projects:(n==null?void 0:n.length)||0,active_projects:(n==null?void 0:n.filter(i=>i.status==="active").length)||0,completed_projects:(n==null?void 0:n.filter(i=>i.status==="completed").length)||0,total_revenue:(r==null?void 0:r.filter(i=>i.status==="paid").reduce((i,o)=>i+(o.amount||0),0))||0,pending_invoices:(r==null?void 0:r.filter(i=>i.status==="sent").length)||0,overdue_invoices:(r==null?void 0:r.filter(i=>i.status==="overdue").length)||0}},`Get customer stats ${e}`)}static async searchCustomers(e,n=10){return Be(async()=>{const r=Z.from("customers").select("*").or(`company_name.ilike.%${e}%,contact_person.ilike.%${e}%,email.ilike.%${e}%,customer_number.ilike.%${e}%`).order("company_name").limit(n);return rt(r).execute()},`Search customers: ${e}`)}static async generateCustomerNumber(){return Be(async()=>{const e=await Xr(),{data:n,error:r}=await Z.rpc("get_next_number",{seq_name:"customers",comp_id:e.company_id});if(r)throw r;return n},"Generate customer number")}static async getCustomerProjects(e){return Be(async()=>{const n=Z.from("projects").select(`
          *
        `).eq("customer_id",e).order("created_at",{ascending:!1});return rt(n).execute()},`Get customer projects ${e}`)}static async getCustomerQuotes(e){return Be(async()=>{const n=Z.from("quotes").select("*").eq("customer_id",e).order("created_at",{ascending:!1});return rt(n).execute()},`Get customer quotes ${e}`)}static async getCustomerInvoices(e){return Be(async()=>{const n=Z.from("invoices").select(`
          *,
          projects (
            name
          )
        `).eq("customer_id",e).order("created_at",{ascending:!1});return rt(n).execute()},`Get customer invoices ${e}`)}}const TH=new Cg;class MH{constructor(){qn(this,"subscriptions",new Map);qn(this,"eventHistory",[]);qn(this,"maxHistorySize",1e3)}on(e,n,r=!1){const a={id:this.generateId(),event:e,handler:n,once:r};return this.subscriptions.has(e)||this.subscriptions.set(e,[]),this.subscriptions.get(e).push(a),a.id}once(e,n){return this.on(e,n,!0)}off(e){for(const[n,r]of this.subscriptions.entries()){const a=r.findIndex(i=>i.id===e);if(a>=0){r.splice(a,1),r.length===0&&this.subscriptions.delete(n);break}}}async emit(e,n={}){const r={...n,timestamp:n.timestamp||new Date().toISOString()};this.addToHistory(e,r),this.shouldLogToAudit(e)&&await this.logToAuditTrail(e,r);const i=(this.subscriptions.get(e)||[]).map(async o=>{try{await o.handler(r),o.once&&this.off(o.id)}catch(c){console.error(`Event handler error for ${e}:`,c),e!=="SYSTEM_ERROR"&&this.emit("SYSTEM_ERROR",{error:c instanceof Error?c.message:"Unknown error",event:e,data:r})}});await Promise.all(i),await this.triggerWorkflowAutomations(e,r)}getHistory(e,n){let r=e?this.eventHistory.filter(a=>a.event===e):this.eventHistory;return n&&(r=r.slice(-n)),r}clearHistory(){this.eventHistory=[]}getSubscriptionCount(e){var r;if(e)return((r=this.subscriptions.get(e))==null?void 0:r.length)||0;let n=0;for(const a of this.subscriptions.values())n+=a.length;return n}generateId(){return`sub_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}addToHistory(e,n){this.eventHistory.push({event:e,data:{...n},timestamp:n.timestamp||new Date().toISOString()}),this.eventHistory.length>this.maxHistorySize&&this.eventHistory.shift()}shouldLogToAudit(e){return["QUOTE_SENT","QUOTE_ACCEPTED","QUOTE_REJECTED","ORDER_STARTED","ORDER_COMPLETED","ORDER_CANCELLED","PROJECT_STATUS_CHANGED","INVOICE_SENT","INVOICE_PAID","TIMESHEET_APPROVED","STOCK_ADJUSTED","DOCUMENT_UPLOADED","DOCUMENT_DELETED"].includes(e)}async logToAuditTrail(e,n){try{const r=this.extractAuditData(e,n);await Z.from("audit_logs").insert({action:this.mapEventToAuditAction(e),table_name:this.extractTableName(e),record_id:r.recordId,old_values:r.oldValues,new_values:r.newValues,user_id:n.user_id,metadata:{event_type:e,...r.metadata}})}catch(r){console.error("Failed to log audit trail:",r)}}extractAuditData(e,n){var r,a,i,o,c,d,u,m;switch(e){case"QUOTE_ACCEPTED":case"QUOTE_REJECTED":return{recordId:(r=n.quote)==null?void 0:r.id,newValues:{status:(a=n.quote)==null?void 0:a.status},metadata:{reason:n.reason}};case"PROJECT_STATUS_CHANGED":return{recordId:(i=n.project)==null?void 0:i.id,oldValues:{status:n.previous_status},newValues:{status:n.new_status}};case"INVOICE_PAID":return{recordId:(o=n.invoice)==null?void 0:o.id,newValues:{status:"paid",paid_at:n.payment_date},metadata:{notes:n.notes}};case"STOCK_ADJUSTED":return{recordId:(c=n.material)==null?void 0:c.id,metadata:{adjustment:n.adjustment,reason:n.reason,reference:n.reference}};default:return{recordId:n.id||((d=n.quote)==null?void 0:d.id)||((u=n.project)==null?void 0:u.id)||((m=n.invoice)==null?void 0:m.id),metadata:{event_data:n}}}}mapEventToAuditAction(e){return{QUOTE_SENT:"STATUS_CHANGE",QUOTE_ACCEPTED:"STATUS_CHANGE",QUOTE_REJECTED:"STATUS_CHANGE",ORDER_STARTED:"STATUS_CHANGE",ORDER_COMPLETED:"STATUS_CHANGE",ORDER_CANCELLED:"STATUS_CHANGE",PROJECT_STATUS_CHANGED:"STATUS_CHANGE",INVOICE_SENT:"STATUS_CHANGE",INVOICE_PAID:"STATUS_CHANGE",TIMESHEET_APPROVED:"UPDATE",STOCK_ADJUSTED:"UPDATE",DOCUMENT_UPLOADED:"INSERT",DOCUMENT_DELETED:"DELETE"}[e]||"UPDATE"}extractTableName(e){return e.startsWith("QUOTE_")?"quotes":e.startsWith("ORDER_")?"orders":e.startsWith("PROJECT_")?"projects":e.startsWith("INVOICE_")?"invoices":e.startsWith("TIMESHEET_")?"timesheets":e.startsWith("MATERIAL_")||e.startsWith("STOCK_")?"materials":e.startsWith("DOCUMENT_")?"documents":"unknown"}async triggerWorkflowAutomations(e,n){try{switch(e){case"QUOTE_ACCEPTED":await this.sendNotification("quote_accepted",n);break;case"ORDER_COMPLETED":await this.autoCreateInvoice(n);break;case"INVOICE_SENT":await this.schedulePaymentReminders(n);break;case"MATERIAL_LOW_STOCK":await this.sendLowStockAlert(n);break;case"PROJECT_STATUS_CHANGED":await this.notifyProjectTeam(n);break;default:break}}catch(r){console.error(`Workflow automation error for ${e}:`,r)}}async sendNotification(e,n){console.log(`Notification: ${e}`,n)}async autoCreateInvoice(e){e.order&&console.log("Auto-creating invoice for order:",e.order.id)}async schedulePaymentReminders(e){e.invoice&&console.log("Scheduling payment reminders for invoice:",e.invoice.id)}async sendLowStockAlert(e){e.material&&console.log("Low stock alert for material:",e.material.name)}async notifyProjectTeam(e){e.project&&console.log("Notifying project team of status change:",e.project.name)}}const ct=new MH;ct.on("SYSTEM_ERROR",t=>{console.error("System error:",t)});ct.on("USER_LOGIN",t=>{console.log("User logged in:",t.user_id)});ct.on("USER_LOGOUT",t=>{console.log("User logged out:",t.user_id)});class RH{static async getOrders(e,n){return Be(async()=>{let r=Z.from("orders").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          ),
          projects (
            name,
            status
          )
        `,{count:"exact"});if(n!=null&&n.status&&(r=r.eq("status",n.status)),n!=null&&n.customer_id&&(r=r.eq("customer_id",n.customer_id)),n!=null&&n.search&&(r=r.or(`title.ilike.%${n.search}%,description.ilike.%${n.search}%,order_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else r=r.order("created_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get orders")}static async getOrder(e){return Be(async()=>{const n=Z.from("orders").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          ),
          quotes (
            quote_number,
            title
          ),
          projects (
            name,
            status,
            start_date,
            end_date
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get order ${e}`)}static async createOrder(e){return Be(async()=>{var m,f;const n=fr(Ej,e),a=(((m=n.body)==null?void 0:m.items)||[]).reduce((p,x)=>p+x.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),c={...n,total_amount:o,status:"open"},d=Z.from("orders").insert(c).select().single(),u=await rt(d).executeSingle();return ct.emit("ORDER_CREATED",{order:u,user_id:(f=(await Z.auth.getUser()).data.user)==null?void 0:f.id}),u},"Create order")}static async createOrderFromQuote(e){return Be(async()=>{var a;if(e.status!=="accepted")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur akzeptierte Angebote können in Aufträge umgewandelt werden.",{quoteStatus:e.status});const n={customer_id:e.customer_id,quote_id:e.id,title:e.title,description:e.description,body:e.body,tax_rate:e.tax_rate,expected_delivery_date:e.valid_until||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]},r=await this.createOrder(n);return ct.emit("ORDER_CREATED_FROM_QUOTE",{order:r,quote:e,user_id:(a=(await Z.auth.getUser()).data.user)==null?void 0:a.id}),r},`Create order from quote ${e.id}`)}static async updateOrder(e,n){return Be(async()=>{var c,d;const r=await this.getOrder(e);if(r.status==="completed")throw new tt(st.IMMUTABLE_RECORD,"Abgeschlossene Aufträge können nicht mehr bearbeitet werden.",{currentStatus:r.status});if(r.status==="in_progress"&&n.order_number)throw new tt(st.IMMUTABLE_RECORD,"Auftragsnummer kann nach dem Start nicht mehr geändert werden.",{currentStatus:r.status});const a=fr(jH,n);if((c=a.body)!=null&&c.items){const m=a.body.items.reduce((p,x)=>p+x.total_price,0),f=a.tax_rate||r.tax_rate||19;a.total_amount=m*(1+f/100)}const i=Z.from("orders").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return ct.emit("ORDER_UPDATED",{order:o,previous_order:r,changes:a,user_id:(d=(await Z.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update order ${e}`)}static async startOrder(e){return Be(async()=>{var o;const n=await this.getOrder(e);if(n.status!=="open")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur offene Aufträge können gestartet werden.",{currentStatus:n.status});const r={status:"in_progress",started_at:new Date().toISOString()},a=Z.from("orders").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle();if(!i.project_id){const c={name:i.title,description:i.description,customer_id:i.customer_id,order_id:i.id,status:"active",start_date:new Date().toISOString().split("T")[0],budget:i.total_amount},{data:d}=await Z.from("projects").insert(c).select().single();await Z.from("orders").update({project_id:d==null?void 0:d.id}).eq("id",e)}return ct.emit("ORDER_STARTED",{order:i,user_id:(o=(await Z.auth.getUser()).data.user)==null?void 0:o.id}),i},`Start order ${e}`)}static async completeOrder(e){return Be(async()=>{var o;const n=await this.getOrder(e);if(n.status!=="in_progress")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur laufende Aufträge können abgeschlossen werden.",{currentStatus:n.status});const r={status:"completed",completed_at:new Date().toISOString()},a=Z.from("orders").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle();return i.project_id&&await Z.from("projects").update({status:"completed",end_date:new Date().toISOString().split("T")[0]}).eq("id",i.project_id),ct.emit("ORDER_COMPLETED",{order:i,user_id:(o=(await Z.auth.getUser()).data.user)==null?void 0:o.id}),i},`Complete order ${e}`)}static async cancelOrder(e,n){return Be(async()=>{var c;const r=await this.getOrder(e);if(r.status==="completed")throw new tt(st.BUSINESS_RULE_VIOLATION,"Abgeschlossene Aufträge können nicht storniert werden.",{currentStatus:r.status});const a={status:"cancelled",description:n?`${r.description||""}

Stornierungsgrund: ${n}`.trim():r.description},i=Z.from("orders").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return o.project_id&&await Z.from("projects").update({status:"cancelled"}).eq("id",o.project_id),ct.emit("ORDER_CANCELLED",{order:o,reason:n,user_id:(c=(await Z.auth.getUser()).data.user)==null?void 0:c.id}),o},`Cancel order ${e}`)}static async getOrderStats(){return Be(async()=>{const e=Z.from("orders").select("status, total_amount, created_at, completed_at"),n=await rt(e).execute(),r={total:n.length,by_status:{open:0,in_progress:0,completed:0,cancelled:0},total_value:{open:0,in_progress:0,completed:0,cancelled:0},avg_completion_time:0};let a=0,i=0;return n.forEach(o=>{if(r.by_status[o.status]++,r.total_value[o.status]+=o.total_amount||0,o.status==="completed"&&o.completed_at){const c=new Date(o.completed_at).getTime()-new Date(o.created_at).getTime();a+=c/(1e3*60*60*24),i++}}),i>0&&(r.avg_completion_time=a/i),r},"Get order statistics")}static async deleteOrder(e){return Be(async()=>{var a;const n=await this.getOrder(e);if(n.status!=="open")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur offene Aufträge können gelöscht werden.",{currentStatus:n.status});if(n.project_id)throw new tt(st.BUSINESS_RULE_VIOLATION,"Aufträge mit verknüpften Projekten können nicht gelöscht werden.",{projectId:n.project_id});const{error:r}=await Z.from("orders").delete().eq("id",e);if(r)throw r;ct.emit("ORDER_DELETED",{order:n,user_id:(a=(await Z.auth.getUser()).data.user)==null?void 0:a.id})},`Delete order ${e}`)}static async duplicateOrder(e){return Be(async()=>{const n=await this.getOrder(e),r={customer_id:n.customer_id,title:`${n.title} (Kopie)`,description:n.description,body:n.body,tax_rate:n.tax_rate,expected_delivery_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]};return this.createOrder(r)},`Duplicate order ${e}`)}}const IH=new RH;class OH{static async getQuotes(e,n){return Be(async()=>{let r=Z.from("quotes").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          )
        `,{count:"exact"});if(n!=null&&n.status&&(r=r.eq("status",n.status)),n!=null&&n.customer_id&&(r=r.eq("customer_id",n.customer_id)),n!=null&&n.search&&(r=r.or(`title.ilike.%${n.search}%,description.ilike.%${n.search}%,quote_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else r=r.order("created_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get quotes")}static async getQuote(e){return Be(async()=>{const n=Z.from("quotes").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get quote ${e}`)}static async createQuote(e){return Be(async()=>{var m,f;const n=fr(Cj,e),a=(((m=n.body)==null?void 0:m.items)||[]).reduce((p,x)=>p+x.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),c={...n,total_net:a,total_gross:o,status:"draft"},d=Z.from("quotes").insert(c).select().single(),u=await rt(d).executeSingle();return ct.emit("QUOTE_CREATED",{quote:u,user_id:(f=(await Z.auth.getUser()).data.user)==null?void 0:f.id}),u},"Create quote")}static async updateQuote(e,n){return Be(async()=>{var c,d;const r=await this.getQuote(e);if(r.status==="accepted")throw new tt(st.IMMUTABLE_RECORD,"Akzeptierte Angebote können nicht mehr bearbeitet werden.",{currentStatus:r.status});if(r.status==="sent"&&n.quote_number)throw new tt(st.IMMUTABLE_RECORD,"Angebotsnummer kann nach dem Versand nicht mehr geändert werden.",{currentStatus:r.status});const a=fr(bH,n);if((c=a.body)!=null&&c.items){const m=a.body.items.reduce((p,x)=>p+x.total_price,0),f=a.tax_rate||r.tax_rate||19;a.total_net=m,a.total_gross=m*(1+f/100)}const i=Z.from("quotes").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return ct.emit("QUOTE_UPDATED",{quote:o,previous_quote:r,changes:a,user_id:(d=(await Z.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update quote ${e}`)}static async sendQuote(e){return Be(async()=>{var o,c;const n=await this.getQuote(e);if(n.status!=="draft")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können versendet werden.",{currentStatus:n.status});if(!((o=n.body)!=null&&o.items)||n.body.items.length===0)throw new tt(st.BUSINESS_RULE_VIOLATION,"Angebot muss mindestens eine Position enthalten.");if(!n.valid_until)throw new tt(st.BUSINESS_RULE_VIOLATION,"Gültigkeitsdatum ist erforderlich.");const r={status:"sent",sent_at:new Date().toISOString()},a=Z.from("quotes").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle();return ct.emit("QUOTE_SENT",{quote:i,user_id:(c=(await Z.auth.getUser()).data.user)==null?void 0:c.id}),i},`Send quote ${e}`)}static async acceptQuote(e){return Be(async()=>{var c;const n=await this.getQuote(e);if(n.status!=="sent")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur versendete Angebote können angenommen werden.",{currentStatus:n.status});if(n.valid_until&&new Date(n.valid_until)<new Date)throw new tt(st.BUSINESS_RULE_VIOLATION,"Das Angebot ist bereits abgelaufen.",{validUntil:n.valid_until});const r={status:"accepted",accepted_at:new Date().toISOString()},a=Z.from("quotes").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle(),o=await IH.createOrderFromQuote(i);return ct.emit("QUOTE_ACCEPTED",{quote:i,order:o,user_id:(c=(await Z.auth.getUser()).data.user)==null?void 0:c.id}),{quote:i,order:o}},`Accept quote ${e}`)}static async rejectQuote(e,n){return Be(async()=>{var c;const r=await this.getQuote(e);if(r.status!=="sent")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur versendete Angebote können abgelehnt werden.",{currentStatus:r.status});const a={status:"rejected",description:n?`${r.description||""}

Ablehnungsgrund: ${n}`.trim():r.description},i=Z.from("quotes").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return ct.emit("QUOTE_REJECTED",{quote:o,reason:n,user_id:(c=(await Z.auth.getUser()).data.user)==null?void 0:c.id}),o},`Reject quote ${e}`)}static async getQuoteStats(){return Be(async()=>{const e=Z.from("quotes").select("status, total_gross"),n=await rt(e).execute(),r={total:n.length,by_status:{draft:0,sent:0,accepted:0,rejected:0,expired:0},total_value:{draft:0,sent:0,accepted:0,rejected:0,expired:0},conversion_rate:0};n.forEach(i=>{r.by_status[i.status]++,r.total_value[i.status]+=i.total_gross||0});const a=r.by_status.sent+r.by_status.accepted+r.by_status.rejected;return a>0&&(r.conversion_rate=r.by_status.accepted/a*100),r},"Get quote statistics")}static async deleteQuote(e){return Be(async()=>{var a;const n=await this.getQuote(e);if(n.status!=="draft")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können gelöscht werden.",{currentStatus:n.status});const{error:r}=await Z.from("quotes").delete().eq("id",e);if(r)throw r;ct.emit("QUOTE_DELETED",{quote:n,user_id:(a=(await Z.auth.getUser()).data.user)==null?void 0:a.id})},`Delete quote ${e}`)}static async duplicateQuote(e){return Be(async()=>{const n=await this.getQuote(e),r={customer_id:n.customer_id,title:`${n.title} (Kopie)`,description:n.description,body:n.body,tax_rate:n.tax_rate,valid_until:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]};return this.createQuote(r)},`Duplicate quote ${e}`)}}const Eg=new OH;class CT{static async getProjects(e,n){return Be(async()=>{let r=Z.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          )
        `,{count:"exact"});if(n!=null&&n.status&&(r=r.eq("status",n.status)),n!=null&&n.customer_id&&(r=r.eq("customer_id",n.customer_id)),n!=null&&n.employee_id&&(r=r.contains("assigned_employees",[n.employee_id])),n!=null&&n.search&&(r=r.or(`name.ilike.%${n.search}%,description.ilike.%${n.search}%,project_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else r=r.order("created_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return console.log("ProjectService.getProjects:",{query:r.toString(),data:a,count:i,pagination:e,filters:n}),{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get projects")}static async getProject(e){return Be(async()=>{const n=Z.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get project ${e}`)}static async createProject(e){return Be(async()=>{var o;const n=fr(Aj,e),r={...n,status:"planned",assigned_employees:n.assigned_employees||[]},a=Z.from("projects").insert(r).select().single(),i=await rt(a).executeSingle();return ct.emit("PROJECT_CREATED",{project:i,user_id:(o=(await Z.auth.getUser()).data.user)==null?void 0:o.id}),i},"Create project")}static async updateProject(e,n){return Be(async()=>{var c,d;const r=await this.getProject(e);if(r.status==="completed"&&n.status!=="completed")throw new tt(st.BUSINESS_RULE_VIOLATION,"Abgeschlossene Projekte können nicht wieder aktiviert werden.",{currentStatus:r.status});const a=fr(NH,n);a.status&&a.status!==r.status&&(await this.validateStatusTransition(r.status,a.status),a.status==="active"&&!r.start_date?a.start_date=new Date().toISOString().split("T")[0]:a.status==="completed"&&!a.end_date&&(a.end_date=new Date().toISOString().split("T")[0]));const i=Z.from("projects").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return a.status&&a.status!==r.status&&ct.emit("PROJECT_STATUS_CHANGED",{project:o,previous_status:r.status,new_status:a.status,user_id:(c=(await Z.auth.getUser()).data.user)==null?void 0:c.id}),ct.emit("PROJECT_UPDATED",{project:o,previous_project:r,changes:a,user_id:(d=(await Z.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update project ${e}`)}static async validateStatusTransition(e,n){const r={planned:["active","cancelled"],active:["blocked","completed","cancelled"],blocked:["active","cancelled"],completed:[],cancelled:[]};if(!r[e].includes(n))throw new tt(st.BUSINESS_RULE_VIOLATION,`Ungültiger Statuswechsel von "${e}" zu "${n}".`,{from:e,to:n,validTransitions:r[e]})}static async startProject(e){return Be(async()=>{const n=await this.getProject(e);if(n.status!=="planned")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur geplante Projekte können gestartet werden.",{currentStatus:n.status});const r={status:"active",start_date:new Date().toISOString().split("T")[0]};return this.updateProject(e,r)},`Start project ${e}`)}static async completeProject(e){return Be(async()=>{const n=await this.getProject(e);if(n.status!=="active")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur aktive Projekte können abgeschlossen werden.",{currentStatus:n.status});const r={status:"completed",end_date:new Date().toISOString().split("T")[0]};return this.updateProject(e,r)},`Complete project ${e}`)}static async blockProject(e,n){return Be(async()=>{const r=await this.getProject(e);if(r.status!=="active")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur aktive Projekte können blockiert werden.",{currentStatus:r.status});const a={status:"blocked",description:n?`${r.description||""}

Blockiert: ${n}`.trim():r.description};return this.updateProject(e,a)},`Block project ${e}`)}static async unblockProject(e){return Be(async()=>{const n=await this.getProject(e);if(n.status!=="blocked")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur blockierte Projekte können entsperrt werden.",{currentStatus:n.status});const r={status:"active"};return this.updateProject(e,r)},`Unblock project ${e}`)}static async cancelProject(e,n){return Be(async()=>{const r=await this.getProject(e);if(r.status==="completed")throw new tt(st.BUSINESS_RULE_VIOLATION,"Abgeschlossene Projekte können nicht storniert werden.",{currentStatus:r.status});const a={status:"cancelled",description:n?`${r.description||""}

Storniert: ${n}`.trim():r.description};return this.updateProject(e,a)},`Cancel project ${e}`)}static async getProjectStats(e){return Be(async()=>{var j;const n=await this.getProject(e),{data:r}=await Z.from("timesheets").select("hours, hourly_rate").eq("project_id",e),{data:a}=await Z.from("materials").select("quantity, unit_cost").eq("project_id",e),{data:i}=await Z.from("expenses").select("amount").eq("project_id",e),o=(r==null?void 0:r.reduce((v,_)=>v+(_.hours||0),0))||0,c=(a==null?void 0:a.reduce((v,_)=>v+(_.quantity*_.unit_cost||0),0))||0,d=(i==null?void 0:i.reduce((v,_)=>v+(_.amount||0),0))||0,m=c+d,f=Math.max(0,(n.budget||0)-m);let p=0;if(n.start_date){const v=new Date(n.start_date),_=n.end_date?new Date(n.end_date):new Date;p=Math.ceil((_.getTime()-v.getTime())/(1e3*60*60*24))}const x={planned:0,active:50,blocked:50,completed:100,cancelled:0}[n.status];return{total_hours:o,total_material_cost:c,total_expenses:d,budget_used:m,budget_remaining:f,days_active:p,team_size:((j=n.assigned_employees)==null?void 0:j.length)||0,completion_percentage:x}},`Get project stats ${e}`)}static async getProjectTimeline(e,n=50){return Be(async()=>{const{data:r}=await Z.from("timesheets").select(`
          id, date, hours, description, created_at,
          employees (name)
        `).eq("project_id",e).order("created_at",{ascending:!1}).limit(n/2),{data:a}=await Z.from("materials").select(`
          id, name, quantity, unit_cost, created_at,
          employees (name)
        `).eq("project_id",e).order("created_at",{ascending:!1}).limit(n/2);return[...(r==null?void 0:r.map(o=>{var c;return{id:o.id,type:"timesheet",title:`Arbeitszeit erfasst: ${o.hours}h`,description:o.description,user:((c=o.employees)==null?void 0:c.name)||"Unbekannt",timestamp:o.created_at}}))||[],...(a==null?void 0:a.map(o=>{var c;return{id:o.id,type:"material",title:`Material hinzugefügt: ${o.name}`,description:`${o.quantity} × ${o.unit_cost}€`,user:((c=o.employees)==null?void 0:c.name)||"Unbekannt",timestamp:o.created_at}}))||[]].sort((o,c)=>new Date(c.timestamp).getTime()-new Date(o.timestamp).getTime()).slice(0,n)},`Get project timeline ${e}`)}static async assignEmployee(e,n){return Be(async()=>{const a=(await this.getProject(e)).assigned_employees||[];if(a.includes(n))throw new tt(st.BUSINESS_RULE_VIOLATION,"Mitarbeiter ist bereits dem Projekt zugewiesen.",{employeeId:n});const i=[...a,n];return this.updateProject(e,{assigned_employees:i})},`Assign employee to project ${e}`)}static async removeEmployee(e,n){return Be(async()=>{const i=((await this.getProject(e)).assigned_employees||[]).filter(o=>o!==n);return this.updateProject(e,{assigned_employees:i})},`Remove employee from project ${e}`)}static async deleteProject(e){return Be(async()=>{var i;const n=await this.getProject(e);if(!["planned","cancelled"].includes(n.status))throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur geplante oder stornierte Projekte können gelöscht werden.",{currentStatus:n.status});const{data:r}=await Z.from("timesheets").select("id").eq("project_id",e).limit(1);if(r&&r.length>0)throw new tt(st.BUSINESS_RULE_VIOLATION,"Projekt kann nicht gelöscht werden, da bereits Arbeitszeiten erfasst wurden.");const{error:a}=await Z.from("projects").delete().eq("id",e);if(a)throw a;ct.emit("PROJECT_DELETED",{project:n,user_id:(i=(await Z.auth.getUser()).data.user)==null?void 0:i.id})},`Delete project ${e}`)}static async searchProjects(e,n=10){return Be(async()=>{const r=Z.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person
          )
        `).or(`name.ilike.%${e}%,description.ilike.%${e}%,project_number.ilike.%${e}%`).order("name").limit(n);return rt(r).execute()},`Search projects: ${e}`)}}class LH{static async getTimesheets(e,n){return Be(async()=>{let r=Z.from("timesheets").select(`
          *,
          projects (
            name,
            project_number
          ),
          employees (
            name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.project_id&&(r=r.eq("project_id",n.project_id)),n!=null&&n.employee_id&&(r=r.eq("employee_id",n.employee_id)),n!=null&&n.date_from&&(r=r.gte("date",n.date_from)),n!=null&&n.date_to&&(r=r.lte("date",n.date_to)),(n==null?void 0:n.approved)!==void 0&&(n.approved?r=r.not("approved_at","is",null):r=r.is("approved_at",null)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"date",{ascending:e.sort_order==="asc"})}else r=r.order("date",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get timesheets")}static async getTimesheet(e){return Be(async()=>{const n=Z.from("timesheets").select(`
          *,
          projects (
            name,
            project_number,
            status
          ),
          employees (
            name,
            email,
            hourly_rate
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get timesheet ${e}`)}static async createTimesheet(e){return Be(async()=>{var i;const n=fr(Dj,e);if(!n.hourly_rate&&n.employee_id){const{data:o}=await Z.from("employees").select("hourly_rate").eq("id",n.employee_id).single();o!=null&&o.hourly_rate&&(n.hourly_rate=o.hourly_rate)}n.hours&&n.hourly_rate&&(n.total_cost=n.hours*n.hourly_rate),await this.validateTimesheetEntry(n);const r=Z.from("timesheets").insert(n).select().single(),a=await rt(r).executeSingle();return ct.emit("TIMESHEET_CREATED",{timesheet:a,user_id:(i=(await Z.auth.getUser()).data.user)==null?void 0:i.id}),a},"Create timesheet")}static async updateTimesheet(e,n){return Be(async()=>{var u;const r=await this.getTimesheet(e);if(r.approved_at)throw new tt(st.IMMUTABLE_RECORD,"Genehmigte Zeiteinträge können nicht mehr bearbeitet werden.",{approvedAt:r.approved_at});const a=await Xr();if(r.employee_id!==a.id&&!a.is_admin)throw new tt(st.UNAUTHORIZED,"Sie können nur Ihre eigenen Zeiteinträge bearbeiten.");const i=fr(kH,n);if(i.hours||i.hourly_rate){const m=i.hours||r.hours,f=i.hourly_rate||r.hourly_rate;m&&f&&(i.total_cost=m*f)}const o={...r,...i};await this.validateTimesheetEntry(o);const c=Z.from("timesheets").update(i).eq("id",e).select().single(),d=await rt(c).executeSingle();return ct.emit("TIMESHEET_UPDATED",{timesheet:d,previous_timesheet:r,changes:i,user_id:(u=(await Z.auth.getUser()).data.user)==null?void 0:u.id}),d},`Update timesheet ${e}`)}static async approveTimesheet(e){return Be(async()=>{const n=await this.getTimesheet(e);if(n.approved_at)throw new tt(st.BUSINESS_RULE_VIOLATION,"Zeiteintrag ist bereits genehmigt.",{approvedAt:n.approved_at});const r=await Xr();if(!r.is_admin&&!r.is_project_manager)throw new tt(st.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge genehmigen.");const a={approved_at:new Date().toISOString(),approved_by:r.id},i=Z.from("timesheets").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return ct.emit("TIMESHEET_APPROVED",{timesheet:o,approved_by:r.id,user_id:r.id}),o},`Approve timesheet ${e}`)}static async rejectTimesheet(e,n){return Be(async()=>{const r=await this.getTimesheet(e),a=await Xr();if(!a.is_admin&&!a.is_project_manager)throw new tt(st.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge ablehnen.");const i={approved_at:null,approved_by:null,description:n?`${r.description||""}

Abgelehnt: ${n}`.trim():r.description},o=Z.from("timesheets").update(i).eq("id",e).select().single(),c=await rt(o).executeSingle();return ct.emit("TIMESHEET_REJECTED",{timesheet:c,reason:n,rejected_by:a.id,user_id:a.id}),c},`Reject timesheet ${e}`)}static async validateTimesheetEntry(e){if(e.employee_id&&e.date&&e.start_time&&e.end_time){const{data:n}=await Z.from("timesheets").select("id").eq("employee_id",e.employee_id).eq("date",e.date).neq("id",e.id||"").or(`start_time.lte.${e.start_time}.and.end_time.gt.${e.start_time},start_time.lt.${e.end_time}.and.end_time.gte.${e.end_time}`);if(n&&n.length>0)throw new tt(st.BUSINESS_RULE_VIOLATION,"Überschneidende Arbeitszeiten am selben Tag sind nicht erlaubt.")}if(e.hours&&e.hours>12)throw new tt(st.BUSINESS_RULE_VIOLATION,"Maximale Arbeitszeit von 12 Stunden pro Tag überschritten.",{hours:e.hours});if(e.date&&new Date(e.date)>new Date)throw new tt(st.BUSINESS_RULE_VIOLATION,"Zeiteinträge für zukünftige Daten sind nicht erlaubt.");if(e.project_id){const{data:n}=await Z.from("projects").select("status").eq("id",e.project_id).single();if(n&&!["active","blocked"].includes(n.status))throw new tt(st.BUSINESS_RULE_VIOLATION,"Zeiteinträge können nur für aktive oder blockierte Projekte erfasst werden.",{projectStatus:n.status})}}static async getEmployeeTimesheetStats(e,n,r){return Be(async()=>{let a=Z.from("timesheets").select("hours, total_cost, approved_at, overtime_hours").eq("employee_id",e);n&&(a=a.gte("date",n)),r&&(a=a.lte("date",r));const i=await rt(a).execute(),o=i.reduce((d,u)=>{const m=u.hours||0,f=u.total_cost||0,p=u.overtime_hours||0;return d.total_hours+=m,d.total_cost+=f,d.overtime_hours+=p,u.approved_at?d.approved_hours+=m:d.pending_hours+=m,d},{total_hours:0,total_cost:0,approved_hours:0,pending_hours:0,days_worked:0,avg_hours_per_day:0,overtime_hours:0}),c=new Set(i.map(d=>d.date));return o.days_worked=c.size,o.days_worked>0&&(o.avg_hours_per_day=o.total_hours/o.days_worked),o},`Get employee timesheet stats ${e}`)}static async getProjectTimesheetSummary(e){return Be(async()=>{const n=Z.from("timesheets").select(`
          hours,
          total_cost,
          date,
          employee_id,
          employees (
            name
          )
        `).eq("project_id",e),r=await rt(n).execute(),a=r.reduce((d,u)=>d+(u.hours||0),0),i=r.reduce((d,u)=>d+(u.total_cost||0),0),o=r.reduce((d,u)=>{var f;const m=u.employee_id;return d[m]||(d[m]={employee_id:m,employee_name:((f=u.employees)==null?void 0:f.name)||"Unbekannt",hours:0,cost:0}),d[m].hours+=u.hours||0,d[m].cost+=u.total_cost||0,d},{}),c=r.reduce((d,u)=>{const m=u.date;return d[m]||(d[m]={date:m,hours:0,cost:0}),d[m].hours+=u.hours||0,d[m].cost+=u.total_cost||0,d},{});return{total_hours:a,total_cost:i,by_employee:Object.values(o),by_date:Object.values(c).sort((d,u)=>d.date.localeCompare(u.date))}},`Get project timesheet summary ${e}`)}static async deleteTimesheet(e){return Be(async()=>{const n=await this.getTimesheet(e);if(n.approved_at)throw new tt(st.BUSINESS_RULE_VIOLATION,"Genehmigte Zeiteinträge können nicht gelöscht werden.",{approvedAt:n.approved_at});const r=await Xr();if(n.employee_id!==r.id&&!r.is_admin)throw new tt(st.UNAUTHORIZED,"Sie können nur Ihre eigenen Zeiteinträge löschen.");const{error:a}=await Z.from("timesheets").delete().eq("id",e);if(a)throw a;ct.emit("TIMESHEET_DELETED",{timesheet:n,user_id:r.id})},`Delete timesheet ${e}`)}static async bulkApproveTimesheets(e){return Be(async()=>{const n=await Xr();if(!n.is_admin&&!n.is_project_manager)throw new tt(st.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge genehmigen.");const r={approved_at:new Date().toISOString(),approved_by:n.id},a=Z.from("timesheets").update(r).in("id",e).is("approved_at",null).select(),i=await rt(a).execute();return i.forEach(o=>{ct.emit("TIMESHEET_APPROVED",{timesheet:o,approved_by:n.id,user_id:n.id})}),i},"Bulk approve timesheets")}}const Mj=new LH;class FH{static async getInvoices(e,n){return Be(async()=>{let r=Z.from("invoices").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          ),
          projects (
            name,
            project_number
          )
        `,{count:"exact"});if(n!=null&&n.status&&(r=r.eq("status",n.status)),n!=null&&n.customer_id&&(r=r.eq("customer_id",n.customer_id)),n!=null&&n.project_id&&(r=r.eq("project_id",n.project_id)),n!=null&&n.overdue&&(r=r.eq("status","sent").lt("due_date",new Date().toISOString().split("T")[0])),n!=null&&n.date_from&&(r=r.gte("invoice_date",n.date_from)),n!=null&&n.date_to&&(r=r.lte("invoice_date",n.date_to)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else r=r.order("created_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get invoices")}static async getInvoice(e){return Be(async()=>{const n=Z.from("invoices").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          ),
          projects (
            name,
            project_number,
            status
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get invoice ${e}`)}static async createInvoice(e){return Be(async()=>{var m,f;const n=fr(Pj,e),a=(((m=n.body)==null?void 0:m.items)||[]).reduce((p,x)=>p+x.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),c={...n,total_net:a,total_gross:o,amount:o,status:"draft",due_date:n.due_date||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]},d=Z.from("invoices").insert(c).select().single(),u=await rt(d).executeSingle();return ct.emit("INVOICE_CREATED",{invoice:u,user_id:(f=(await Z.auth.getUser()).data.user)==null?void 0:f.id}),u},"Create invoice")}static async updateInvoice(e,n){return Be(async()=>{var c,d;const r=await this.getInvoice(e);if(r.status==="paid")throw new tt(st.IMMUTABLE_RECORD,"Bezahlte Rechnungen können nicht mehr bearbeitet werden.",{currentStatus:r.status});if(r.status==="sent"&&n.invoice_number)throw new tt(st.IMMUTABLE_RECORD,"Rechnungsnummer kann nach dem Versand nicht mehr geändert werden.",{currentStatus:r.status});const a=fr(SH,n);if((c=a.body)!=null&&c.items){const m=a.body.items.reduce((p,x)=>p+x.total_price,0),f=a.tax_rate||r.tax_rate||19;a.total_net=m,a.total_gross=m*(1+f/100),a.amount=a.total_gross}const i=Z.from("invoices").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return ct.emit("INVOICE_UPDATED",{invoice:o,previous_invoice:r,changes:a,user_id:(d=(await Z.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update invoice ${e}`)}static async sendInvoice(e){return Be(async()=>{var o,c;const n=await this.getInvoice(e);if(n.status!=="draft")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können versendet werden.",{currentStatus:n.status});if(!((o=n.body)!=null&&o.items)||n.body.items.length===0)throw new tt(st.BUSINESS_RULE_VIOLATION,"Rechnung muss mindestens eine Position enthalten.");const r={status:"sent",sent_at:new Date().toISOString()},a=Z.from("invoices").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle();return ct.emit("INVOICE_SENT",{invoice:i,user_id:(c=(await Z.auth.getUser()).data.user)==null?void 0:c.id}),i},`Send invoice ${e}`)}static async markInvoicePaid(e,n,r){return Be(async()=>{var d;const a=await this.getInvoice(e);if(a.status!=="sent")throw new tt(st.BUSINESS_RULE_VIOLATION,"Nur versendete Rechnungen können als bezahlt markiert werden.",{currentStatus:a.status});const i={status:"paid",paid_at:n||new Date().toISOString(),notes:r?`${a.notes||""}

Zahlung: ${r}`.trim():a.notes},o=Z.from("invoices").update(i).eq("id",e).select().single(),c=await rt(o).executeSingle();return ct.emit("INVOICE_PAID",{invoice:c,payment_date:n,notes:r,user_id:(d=(await Z.auth.getUser()).data.user)==null?void 0:d.id}),c},`Mark invoice paid ${e}`)}static async getExpenses(e,n){return Be(async()=>{let r=Z.from("expenses").select(`
          *,
          projects (
            name,
            project_number
          ),
          employees (
            name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.category&&(r=r.eq("category",n.category)),n!=null&&n.project_id&&(r=r.eq("project_id",n.project_id)),n!=null&&n.employee_id&&(r=r.eq("employee_id",n.employee_id)),n!=null&&n.date_from&&(r=r.gte("expense_date",n.date_from)),n!=null&&n.date_to&&(r=r.lte("expense_date",n.date_to)),(n==null?void 0:n.approved)!==void 0&&(n.approved?r=r.not("approved_at","is",null):r=r.is("approved_at",null)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"expense_date",{ascending:e.sort_order==="asc"})}else r=r.order("expense_date",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get expenses")}static async createExpense(e){return Be(async()=>{var i;const n=fr(Tj,e),r=Z.from("expenses").insert(n).select().single(),a=await rt(r).executeSingle();return ct.emit("EXPENSE_CREATED",{expense:a,user_id:(i=(await Z.auth.getUser()).data.user)==null?void 0:i.id}),a},"Create expense")}static async approveExpense(e){return Be(async()=>{const n=await Xr();if(!n.is_admin&&!n.is_project_manager)throw new tt(st.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Ausgaben genehmigen.");const r={approved_at:new Date().toISOString(),approved_by:n.id},a=Z.from("expenses").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle();return ct.emit("EXPENSE_APPROVED",{expense:i,approved_by:n.id,user_id:n.id}),i},`Approve expense ${e}`)}static async getFinancialKPIs(e){return Be(async()=>{const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),1).toISOString().split("T")[0],a=new Date(n.getFullYear(),n.getMonth()-1,1).toISOString().split("T")[0],i=new Date(n.getFullYear(),n.getMonth(),0).toISOString().split("T")[0],o=Z.from("invoices").select("amount, status, invoice_date, paid_at"),c=await rt(o).execute(),d=Z.from("expenses").select("amount, expense_date, approved_at"),u=await rt(d).execute(),m=c.filter(P=>P.status==="paid").reduce((P,M)=>P+(M.amount||0),0),f=c.filter(P=>P.status==="paid"&&P.paid_at&&P.paid_at>=r).reduce((P,M)=>P+(M.amount||0),0),p=c.filter(P=>P.status==="paid"&&P.paid_at&&P.paid_at>=a&&P.paid_at<=i).reduce((P,M)=>P+(M.amount||0),0),x=p>0?(f-p)/p*100:0,j=u.filter(P=>P.approved_at).reduce((P,M)=>P+(M.amount||0),0),v=u.filter(P=>P.approved_at&&P.expense_date>=r).reduce((P,M)=>P+(M.amount||0),0),_=u.filter(P=>P.approved_at&&P.expense_date>=a&&P.expense_date<=i).reduce((P,M)=>P+(M.amount||0),0),b=c.filter(P=>P.status==="sent"),w=b.filter(P=>P.due_date&&P.due_date<new Date().toISOString().split("T")[0]),N=b.reduce((P,M)=>P+(M.amount||0),0),S=w.reduce((P,M)=>P+(M.amount||0),0),C=f-v,A=f>0?C/f*100:0;return{revenue:{total:m,this_month:f,last_month:p,growth_rate:x},expenses:{total:j,this_month:v,last_month:_},profit:{total:m-j,this_month:C,margin:A},outstanding:{total:N,overdue:S,count:b.length},cash_flow:{inflow:f,outflow:v,net:f-v}}},"Get financial KPIs")}static async getRevenueByMonth(e=12){return Be(async()=>{const n=await rt(Z.from("invoices").select("amount, status, paid_at").eq("status","paid").not("paid_at","is",null).gte("paid_at",new Date(Date.now()-e*30*24*60*60*1e3).toISOString())).execute(),r={};return n.forEach(a=>{if(a.paid_at){const i=a.paid_at.substring(0,7);r[i]||(r[i]={revenue:0,invoices:0}),r[i].revenue+=a.amount||0,r[i].invoices+=1}}),Object.entries(r).map(([a,i])=>({month:a,revenue:i.revenue,invoices:i.invoices})).sort((a,i)=>a.month.localeCompare(i.month))},"Get revenue by month")}static async getExpensesByCategory(e){return Be(async()=>{let n=Z.from("expenses").select("category, amount").not("approved_at","is",null);e&&(n=n.gte("expense_date",e.from).lte("expense_date",e.to));const r=await rt(n).execute(),a={};return r.forEach(i=>{const o=i.category||"Sonstige";a[o]||(a[o]={amount:0,count:0}),a[o].amount+=i.amount||0,a[o].count+=1}),Object.entries(a).map(([i,o])=>({category:i,amount:o.amount,count:o.count})).sort((i,o)=>o.amount-i.amount)},"Get expenses by category")}static async getProfitLossReport(e){return Be(async()=>{const r=(await rt(Z.from("invoices").select("amount").eq("status","paid").gte("paid_at",e.from).lte("paid_at",e.to)).execute()).reduce((m,f)=>m+(f.amount||0),0),a=await rt(Z.from("expenses").select("amount, category").not("approved_at","is",null).gte("expense_date",e.from).lte("expense_date",e.to)).execute(),i=a.filter(m=>["Material","Equipment","Subcontractor"].includes(m.category||"")).reduce((m,f)=>m+(f.amount||0),0),o=a.filter(m=>!["Material","Equipment","Subcontractor"].includes(m.category||"")).reduce((m,f)=>m+(f.amount||0),0),c=r-i,d=c-o,u=r>0?d/r*100:0;return{revenue:r,cost_of_goods:i,gross_profit:c,operating_expenses:o,net_profit:d,margin:u}},"Get profit/loss report")}}const Ag=new FH;class BH{static async getDocuments(e,n){return Be(async()=>{var o;let r=Z.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name,
            contact_person
          ),
          uploaded_by_user:profiles!uploaded_by (
            first_name,
            last_name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.category&&(r=r.eq("category",n.category)),n!=null&&n.legal_category&&(r=r.eq("legal_category",n.legal_category)),n!=null&&n.project_id&&(r=r.eq("project_id",n.project_id)),n!=null&&n.customer_id&&(r=r.eq("customer_id",n.customer_id)),n!=null&&n.uploaded_by&&(r=r.eq("uploaded_by",n.uploaded_by)),(o=n==null?void 0:n.tags)!=null&&o.length&&(r=r.overlaps("tags",n.tags)),n!=null&&n.date_from&&(r=r.gte("uploaded_at",n.date_from)),n!=null&&n.date_to&&(r=r.lte("uploaded_at",n.date_to)),n!=null&&n.search&&(r=r.or(`filename.ilike.%${n.search}%,original_filename.ilike.%${n.search}%,description.ilike.%${n.search}%`)),e){const c=(e.page-1)*e.limit;r=r.range(c,c+e.limit-1).order(e.sort_by||"uploaded_at",{ascending:e.sort_order==="asc"})}else r=r.order("uploaded_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get documents")}static async getDocument(e){return Be(async()=>{const n=Z.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name,
            contact_person
          ),
          uploaded_by_user:profiles!uploaded_by (
            first_name,
            last_name,
            email
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get document ${e}`)}static async uploadDocument(e){return Be(async()=>{const n=await Xr(),r=e.file;if(r.size>50*1024*1024)throw new tt(st.BUSINESS_RULE_VIOLATION,"Dateigröße darf 50MB nicht überschreiten.",{fileSize:r.size});const a=r.name.split(".").pop()||"",i=Date.now(),o=Math.random().toString(36).substring(2,15),c=`${i}_${o}.${a}`,u=`${this.getStorageFolder(e.category)}/${c}`,{data:m,error:f}=await Z.storage.from("documents").upload(u,r,{cacheControl:"3600",upsert:!1});if(f)throw new tt(st.STORAGE_ERROR,`Fehler beim Upload: ${f.message}`,{uploadError:f});let p;if(e.is_public){const{data:b}=Z.storage.from("documents").getPublicUrl(u);p=b.publicUrl}let x;if(e.legal_category){const b=this.getRetentionPeriod(e.legal_category);x=new Date(Date.now()+b*365*24*60*60*1e3).toISOString().split("T")[0]}const j={filename:c,original_filename:r.name,file_size:r.size,mime_type:r.type,category:e.category,legal_category:e.legal_category,description:e.description,tags:e.tags||[],project_id:e.project_id,customer_id:e.customer_id,invoice_id:e.invoice_id,expense_id:e.expense_id,storage_path:u,public_url:p,is_public:e.is_public||!1,retention_until:x,uploaded_by:n.id,uploaded_at:new Date().toISOString()},v=Z.from("documents").insert(j).select().single(),_=await rt(v).executeSingle();return e.legal_category&&await Z.from("immutable_files").insert({document_id:_.id,filename:_.filename,file_hash:await this.calculateFileHash(r),file_size:r.size,legal_category:e.legal_category,uploaded_by:n.id}),ct.emit("DOCUMENT_UPLOADED",{document:_,user_id:n.id}),_},"Upload document")}static async updateDocument(e,n){return Be(async()=>{const r=await this.getDocument(e),a=await Xr();if(r.uploaded_by!==a.id&&!a.is_admin)throw new tt(st.UNAUTHORIZED,"Sie können nur Ihre eigenen Dokumente bearbeiten.");let i=r.retention_until;if(n.legal_category&&n.legal_category!==r.legal_category){const u=this.getRetentionPeriod(n.legal_category);i=new Date(Date.now()+u*365*24*60*60*1e3).toISOString().split("T")[0]}const o={...n,retention_until:i},c=Z.from("documents").update(o).eq("id",e).select().single(),d=await rt(c).executeSingle();return ct.emit("DOCUMENT_UPDATED",{document:d,previous_document:r,changes:n,user_id:a.id}),d},`Update document ${e}`)}static async getDownloadUrl(e,n=3600){return Be(async()=>{const r=await this.getDocument(e),a=await Xr();if(!r.is_public&&r.uploaded_by!==a.id&&!a.is_admin)throw new tt(st.UNAUTHORIZED,"Keine Berechtigung zum Download dieses Dokuments.");const{data:i,error:o}=await Z.storage.from("documents").createSignedUrl(r.storage_path,n);if(o||!i)throw new tt(st.STORAGE_ERROR,"Fehler beim Generieren der Download-URL.",{error:o});return ct.emit("DOCUMENT_DOWNLOADED",{document:r,user_id:a.id}),i.signedUrl},`Get download URL for document ${e}`)}static async deleteDocument(e){return Be(async()=>{const n=await this.getDocument(e),r=await Xr();if(n.uploaded_by!==r.id&&!r.is_admin)throw new tt(st.UNAUTHORIZED,"Sie können nur Ihre eigenen Dokumente löschen.");if(n.retention_until&&new Date(n.retention_until)>new Date)throw new tt(st.BUSINESS_RULE_VIOLATION,"Dokument kann aufgrund gesetzlicher Aufbewahrungspflicht nicht gelöscht werden.",{retentionUntil:n.retention_until});const{error:a}=await Z.storage.from("documents").remove([n.storage_path]);if(a)throw new tt(st.STORAGE_ERROR,`Fehler beim Löschen der Datei: ${a.message}`,{storageError:a});const{error:i}=await Z.from("documents").delete().eq("id",e);if(i)throw i;ct.emit("DOCUMENT_DELETED",{document:n,user_id:r.id})},`Delete document ${e}`)}static async getDocumentStats(){return Be(async()=>(await rt(Z.from("documents").select("*")).execute()).reduce((r,a)=>{if(r.total_documents++,r.total_size+=a.file_size,r.by_category[a.category]||(r.by_category[a.category]={count:0,size:0}),r.by_category[a.category].count++,r.by_category[a.category].size+=a.file_size,a.legal_category&&(r.by_legal_category[a.legal_category]||(r.by_legal_category[a.legal_category]={count:0,size:0}),r.by_legal_category[a.legal_category].count++,r.by_legal_category[a.legal_category].size+=a.file_size),a.retention_until){const i=new Date(a.retention_until),o=new Date(Date.now()+30*24*60*60*1e3);i<=o&&r.retention_expiring++}return r},{total_documents:0,total_size:0,by_category:{},by_legal_category:{},retention_expiring:0}),"Get document statistics")}static async searchDocuments(e,n=20){return Be(async()=>{const r=Z.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name
          )
        `).or(`filename.ilike.%${e}%,original_filename.ilike.%${e}%,description.ilike.%${e}%`).order("uploaded_at",{ascending:!1}).limit(n);return rt(r).execute()},`Search documents: ${e}`)}static async getExpiringDocuments(e=30){return Be(async()=>{const n=new Date(Date.now()+e*24*60*60*1e3).toISOString().split("T")[0],r=Z.from("documents").select("*").not("retention_until","is",null).lte("retention_until",n).order("retention_until",{ascending:!0});return rt(r).execute()},`Get expiring documents (${e} days)`)}static getStorageFolder(e){return{invoice:"invoices",contract:"contracts",receipt:"receipts",photo:"photos",plan:"plans",report:"reports",other:"other"}[e]||"other"}static getRetentionPeriod(e){return{invoice:10,contract:10,receipt:10,tax_document:10,correspondence:6}[e]||10}static async calculateFileHash(e){const n=await e.arrayBuffer(),r=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(r)).map(i=>i.toString(16).padStart(2,"0")).join("")}}const zH=new BH;var Iu=(t=>(t[t.UNAUTHORIZED=401]="UNAUTHORIZED",t[t.FORBIDDEN=403]="FORBIDDEN",t[t.NOT_FOUND=404]="NOT_FOUND",t[t.VALIDATION_ERROR=422]="VALIDATION_ERROR",t[t.INTERNAL_ERROR=500]="INTERNAL_ERROR",t))(Iu||{});class fo extends Error{constructor(e,n,r){super(e),this.code=n,this.details=r,this.name="ApiError"}}async function Im(t,e){try{return await t()}catch(n){if(console.error(`API Error in ${e}:`,n),n instanceof fo)throw Ue.error(`${e}: ${n.message}`),n;const r=n instanceof Error?n.message:"Unbekannter Fehler";throw Ue.error(`${e}: ${r}`),new fo(r,500)}}async function vv(){const{data:{user:t},error:e}=await Z.auth.getUser();if(e||!t)throw new fo("User not authenticated",401);const{data:n,error:r}=await Z.from("profiles").select("*").eq("id",t.id).single();if(r)throw new fo("User profile not found",404,r.message);return{...t,profile:n}}E.string().uuid(),E.string().email(),E.string().min(1),E.number().min(0),E.number().min(0).max(100),E.string().datetime();E.object({project_id:E.string(),budget:E.number().optional(),date_range:E.object({from:E.string().optional(),to:E.string().optional()}).optional()});E.object({user_id:E.string().uuid(),type:E.enum(["budget_warning","budget_critical","invoice_overdue","project_deadline","time_approval_needed","material_low_stock","system_update","general"]),priority:E.enum(["low","medium","high","urgent"]),title:E.string().min(1).max(200),message:E.string().min(1).max(1e3),data:E.record(E.any()).optional(),expires_at:E.string().datetime().optional(),action_url:E.string().url().optional(),entity_type:E.string().optional(),entity_id:E.string().optional()});E.object({read:E.boolean().optional(),archived:E.boolean().optional()});E.object({entity_type:E.enum(["customer","invoice","quote","order","project","timesheet","material","expense","employee","document","payment"]),entity_id:E.string().min(1),action:E.enum(["CREATE","UPDATE","DELETE","VIEW","PRINT","EXPORT","SEND","APPROVE","REJECT","CANCEL","RESTORE"]),old_values:E.record(E.any()).nullable().optional(),new_values:E.record(E.any()).nullable().optional(),reason:E.string().nullable().optional(),is_automated:E.boolean().optional().default(!1)});var $H={exports:{}};function ET(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var yv={exports:{}};const UH={},qH=Object.freeze(Object.defineProperty({__proto__:null,default:UH},Symbol.toStringTag,{value:"Module"})),WH=gE(qH);var ok;function Zt(){return ok||(ok=1,function(t,e){(function(n,r){t.exports=r()})(gt,function(){var n=n||function(r,a){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof gt<"u"&&gt.crypto&&(i=gt.crypto),!i&&typeof ET=="function")try{i=WH}catch{}var o=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},c=Object.create||function(){function w(){}return function(N){var S;return w.prototype=N,S=new w,w.prototype=null,S}}(),d={},u=d.lib={},m=u.Base=function(){return{extend:function(w){var N=c(this);return w&&N.mixIn(w),(!N.hasOwnProperty("init")||this.init===N.init)&&(N.init=function(){N.$super.init.apply(this,arguments)}),N.init.prototype=N,N.$super=this,N},create:function(){var w=this.extend();return w.init.apply(w,arguments),w},init:function(){},mixIn:function(w){for(var N in w)w.hasOwnProperty(N)&&(this[N]=w[N]);w.hasOwnProperty("toString")&&(this.toString=w.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=u.WordArray=m.extend({init:function(w,N){w=this.words=w||[],N!=a?this.sigBytes=N:this.sigBytes=w.length*4},toString:function(w){return(w||x).stringify(this)},concat:function(w){var N=this.words,S=w.words,C=this.sigBytes,A=w.sigBytes;if(this.clamp(),C%4)for(var P=0;P<A;P++){var M=S[P>>>2]>>>24-P%4*8&255;N[C+P>>>2]|=M<<24-(C+P)%4*8}else for(var z=0;z<A;z+=4)N[C+z>>>2]=S[z>>>2];return this.sigBytes+=A,this},clamp:function(){var w=this.words,N=this.sigBytes;w[N>>>2]&=4294967295<<32-N%4*8,w.length=r.ceil(N/4)},clone:function(){var w=m.clone.call(this);return w.words=this.words.slice(0),w},random:function(w){for(var N=[],S=0;S<w;S+=4)N.push(o());return new f.init(N,w)}}),p=d.enc={},x=p.Hex={stringify:function(w){for(var N=w.words,S=w.sigBytes,C=[],A=0;A<S;A++){var P=N[A>>>2]>>>24-A%4*8&255;C.push((P>>>4).toString(16)),C.push((P&15).toString(16))}return C.join("")},parse:function(w){for(var N=w.length,S=[],C=0;C<N;C+=2)S[C>>>3]|=parseInt(w.substr(C,2),16)<<24-C%8*4;return new f.init(S,N/2)}},j=p.Latin1={stringify:function(w){for(var N=w.words,S=w.sigBytes,C=[],A=0;A<S;A++){var P=N[A>>>2]>>>24-A%4*8&255;C.push(String.fromCharCode(P))}return C.join("")},parse:function(w){for(var N=w.length,S=[],C=0;C<N;C++)S[C>>>2]|=(w.charCodeAt(C)&255)<<24-C%4*8;return new f.init(S,N)}},v=p.Utf8={stringify:function(w){try{return decodeURIComponent(escape(j.stringify(w)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(w){return j.parse(unescape(encodeURIComponent(w)))}},_=u.BufferedBlockAlgorithm=m.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(w){typeof w=="string"&&(w=v.parse(w)),this._data.concat(w),this._nDataBytes+=w.sigBytes},_process:function(w){var N,S=this._data,C=S.words,A=S.sigBytes,P=this.blockSize,M=P*4,z=A/M;w?z=r.ceil(z):z=r.max((z|0)-this._minBufferSize,0);var R=z*P,D=r.min(R*4,A);if(R){for(var B=0;B<R;B+=P)this._doProcessBlock(C,B);N=C.splice(0,R),S.sigBytes-=D}return new f.init(N,D)},clone:function(){var w=m.clone.call(this);return w._data=this._data.clone(),w},_minBufferSize:0});u.Hasher=_.extend({cfg:m.extend(),init:function(w){this.cfg=this.cfg.extend(w),this.reset()},reset:function(){_.reset.call(this),this._doReset()},update:function(w){return this._append(w),this._process(),this},finalize:function(w){w&&this._append(w);var N=this._doFinalize();return N},blockSize:16,_createHelper:function(w){return function(N,S){return new w.init(S).finalize(N)}},_createHmacHelper:function(w){return function(N,S){return new b.HMAC.init(w,S).finalize(N)}}});var b=d.algo={};return d}(Math);return n})}(yv)),yv.exports}var _v={exports:{}},lk;function Pg(){return lk||(lk=1,function(t,e){(function(n,r){t.exports=r(Zt())})(gt,function(n){return function(r){var a=n,i=a.lib,o=i.Base,c=i.WordArray,d=a.x64={};d.Word=o.extend({init:function(u,m){this.high=u,this.low=m}}),d.WordArray=o.extend({init:function(u,m){u=this.words=u||[],m!=r?this.sigBytes=m:this.sigBytes=u.length*8},toX32:function(){for(var u=this.words,m=u.length,f=[],p=0;p<m;p++){var x=u[p];f.push(x.high),f.push(x.low)}return c.create(f,this.sigBytes)},clone:function(){for(var u=o.clone.call(this),m=u.words=this.words.slice(0),f=m.length,p=0;p<f;p++)m[p]=m[p].clone();return u}})}(),n})}(_v)),_v.exports}var wv={exports:{}},ck;function HH(){return ck||(ck=1,function(t,e){(function(n,r){t.exports=r(Zt())})(gt,function(n){return function(){if(typeof ArrayBuffer=="function"){var r=n,a=r.lib,i=a.WordArray,o=i.init,c=i.init=function(d){if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),(d instanceof Int8Array||typeof Uint8ClampedArray<"u"&&d instanceof Uint8ClampedArray||d instanceof Int16Array||d instanceof Uint16Array||d instanceof Int32Array||d instanceof Uint32Array||d instanceof Float32Array||d instanceof Float64Array)&&(d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength)),d instanceof Uint8Array){for(var u=d.byteLength,m=[],f=0;f<u;f++)m[f>>>2]|=d[f]<<24-f%4*8;o.call(this,m,u)}else o.apply(this,arguments)};c.prototype=i}}(),n.lib.WordArray})}(wv)),wv.exports}var bv={exports:{}},dk;function VH(){return dk||(dk=1,function(t,e){(function(n,r){t.exports=r(Zt())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=r.enc;o.Utf16=o.Utf16BE={stringify:function(d){for(var u=d.words,m=d.sigBytes,f=[],p=0;p<m;p+=2){var x=u[p>>>2]>>>16-p%4*8&65535;f.push(String.fromCharCode(x))}return f.join("")},parse:function(d){for(var u=d.length,m=[],f=0;f<u;f++)m[f>>>1]|=d.charCodeAt(f)<<16-f%2*16;return i.create(m,u*2)}},o.Utf16LE={stringify:function(d){for(var u=d.words,m=d.sigBytes,f=[],p=0;p<m;p+=2){var x=c(u[p>>>2]>>>16-p%4*8&65535);f.push(String.fromCharCode(x))}return f.join("")},parse:function(d){for(var u=d.length,m=[],f=0;f<u;f++)m[f>>>1]|=c(d.charCodeAt(f)<<16-f%2*16);return i.create(m,u*2)}};function c(d){return d<<8&4278255360|d>>>8&16711935}}(),n.enc.Utf16})}(bv)),bv.exports}var jv={exports:{}},uk;function Gl(){return uk||(uk=1,function(t,e){(function(n,r){t.exports=r(Zt())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=r.enc;o.Base64={stringify:function(d){var u=d.words,m=d.sigBytes,f=this._map;d.clamp();for(var p=[],x=0;x<m;x+=3)for(var j=u[x>>>2]>>>24-x%4*8&255,v=u[x+1>>>2]>>>24-(x+1)%4*8&255,_=u[x+2>>>2]>>>24-(x+2)%4*8&255,b=j<<16|v<<8|_,w=0;w<4&&x+w*.75<m;w++)p.push(f.charAt(b>>>6*(3-w)&63));var N=f.charAt(64);if(N)for(;p.length%4;)p.push(N);return p.join("")},parse:function(d){var u=d.length,m=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var p=0;p<m.length;p++)f[m.charCodeAt(p)]=p}var x=m.charAt(64);if(x){var j=d.indexOf(x);j!==-1&&(u=j)}return c(d,u,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function c(d,u,m){for(var f=[],p=0,x=0;x<u;x++)if(x%4){var j=m[d.charCodeAt(x-1)]<<x%4*2,v=m[d.charCodeAt(x)]>>>6-x%4*2,_=j|v;f[p>>>2]|=_<<24-p%4*8,p++}return i.create(f,p)}}(),n.enc.Base64})}(jv)),jv.exports}var Nv={exports:{}},hk;function KH(){return hk||(hk=1,function(t,e){(function(n,r){t.exports=r(Zt())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=r.enc;o.Base64url={stringify:function(d,u){u===void 0&&(u=!0);var m=d.words,f=d.sigBytes,p=u?this._safe_map:this._map;d.clamp();for(var x=[],j=0;j<f;j+=3)for(var v=m[j>>>2]>>>24-j%4*8&255,_=m[j+1>>>2]>>>24-(j+1)%4*8&255,b=m[j+2>>>2]>>>24-(j+2)%4*8&255,w=v<<16|_<<8|b,N=0;N<4&&j+N*.75<f;N++)x.push(p.charAt(w>>>6*(3-N)&63));var S=p.charAt(64);if(S)for(;x.length%4;)x.push(S);return x.join("")},parse:function(d,u){u===void 0&&(u=!0);var m=d.length,f=u?this._safe_map:this._map,p=this._reverseMap;if(!p){p=this._reverseMap=[];for(var x=0;x<f.length;x++)p[f.charCodeAt(x)]=x}var j=f.charAt(64);if(j){var v=d.indexOf(j);v!==-1&&(m=v)}return c(d,m,p)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function c(d,u,m){for(var f=[],p=0,x=0;x<u;x++)if(x%4){var j=m[d.charCodeAt(x-1)]<<x%4*2,v=m[d.charCodeAt(x)]>>>6-x%4*2,_=j|v;f[p>>>2]|=_<<24-p%4*8,p++}return i.create(f,p)}}(),n.enc.Base64url})}(Nv)),Nv.exports}var Sv={exports:{}},fk;function Ql(){return fk||(fk=1,function(t,e){(function(n,r){t.exports=r(Zt())})(gt,function(n){return function(r){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.algo,u=[];(function(){for(var v=0;v<64;v++)u[v]=r.abs(r.sin(v+1))*4294967296|0})();var m=d.MD5=c.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(v,_){for(var b=0;b<16;b++){var w=_+b,N=v[w];v[w]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360}var S=this._hash.words,C=v[_+0],A=v[_+1],P=v[_+2],M=v[_+3],z=v[_+4],R=v[_+5],D=v[_+6],B=v[_+7],W=v[_+8],X=v[_+9],ue=v[_+10],de=v[_+11],G=v[_+12],I=v[_+13],V=v[_+14],$=v[_+15],F=S[0],O=S[1],K=S[2],U=S[3];F=f(F,O,K,U,C,7,u[0]),U=f(U,F,O,K,A,12,u[1]),K=f(K,U,F,O,P,17,u[2]),O=f(O,K,U,F,M,22,u[3]),F=f(F,O,K,U,z,7,u[4]),U=f(U,F,O,K,R,12,u[5]),K=f(K,U,F,O,D,17,u[6]),O=f(O,K,U,F,B,22,u[7]),F=f(F,O,K,U,W,7,u[8]),U=f(U,F,O,K,X,12,u[9]),K=f(K,U,F,O,ue,17,u[10]),O=f(O,K,U,F,de,22,u[11]),F=f(F,O,K,U,G,7,u[12]),U=f(U,F,O,K,I,12,u[13]),K=f(K,U,F,O,V,17,u[14]),O=f(O,K,U,F,$,22,u[15]),F=p(F,O,K,U,A,5,u[16]),U=p(U,F,O,K,D,9,u[17]),K=p(K,U,F,O,de,14,u[18]),O=p(O,K,U,F,C,20,u[19]),F=p(F,O,K,U,R,5,u[20]),U=p(U,F,O,K,ue,9,u[21]),K=p(K,U,F,O,$,14,u[22]),O=p(O,K,U,F,z,20,u[23]),F=p(F,O,K,U,X,5,u[24]),U=p(U,F,O,K,V,9,u[25]),K=p(K,U,F,O,M,14,u[26]),O=p(O,K,U,F,W,20,u[27]),F=p(F,O,K,U,I,5,u[28]),U=p(U,F,O,K,P,9,u[29]),K=p(K,U,F,O,B,14,u[30]),O=p(O,K,U,F,G,20,u[31]),F=x(F,O,K,U,R,4,u[32]),U=x(U,F,O,K,W,11,u[33]),K=x(K,U,F,O,de,16,u[34]),O=x(O,K,U,F,V,23,u[35]),F=x(F,O,K,U,A,4,u[36]),U=x(U,F,O,K,z,11,u[37]),K=x(K,U,F,O,B,16,u[38]),O=x(O,K,U,F,ue,23,u[39]),F=x(F,O,K,U,I,4,u[40]),U=x(U,F,O,K,C,11,u[41]),K=x(K,U,F,O,M,16,u[42]),O=x(O,K,U,F,D,23,u[43]),F=x(F,O,K,U,X,4,u[44]),U=x(U,F,O,K,G,11,u[45]),K=x(K,U,F,O,$,16,u[46]),O=x(O,K,U,F,P,23,u[47]),F=j(F,O,K,U,C,6,u[48]),U=j(U,F,O,K,B,10,u[49]),K=j(K,U,F,O,V,15,u[50]),O=j(O,K,U,F,R,21,u[51]),F=j(F,O,K,U,G,6,u[52]),U=j(U,F,O,K,M,10,u[53]),K=j(K,U,F,O,ue,15,u[54]),O=j(O,K,U,F,A,21,u[55]),F=j(F,O,K,U,W,6,u[56]),U=j(U,F,O,K,$,10,u[57]),K=j(K,U,F,O,D,15,u[58]),O=j(O,K,U,F,I,21,u[59]),F=j(F,O,K,U,z,6,u[60]),U=j(U,F,O,K,de,10,u[61]),K=j(K,U,F,O,P,15,u[62]),O=j(O,K,U,F,X,21,u[63]),S[0]=S[0]+F|0,S[1]=S[1]+O|0,S[2]=S[2]+K|0,S[3]=S[3]+U|0},_doFinalize:function(){var v=this._data,_=v.words,b=this._nDataBytes*8,w=v.sigBytes*8;_[w>>>5]|=128<<24-w%32;var N=r.floor(b/4294967296),S=b;_[(w+64>>>9<<4)+15]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,_[(w+64>>>9<<4)+14]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,v.sigBytes=(_.length+1)*4,this._process();for(var C=this._hash,A=C.words,P=0;P<4;P++){var M=A[P];A[P]=(M<<8|M>>>24)&16711935|(M<<24|M>>>8)&4278255360}return C},clone:function(){var v=c.clone.call(this);return v._hash=this._hash.clone(),v}});function f(v,_,b,w,N,S,C){var A=v+(_&b|~_&w)+N+C;return(A<<S|A>>>32-S)+_}function p(v,_,b,w,N,S,C){var A=v+(_&w|b&~w)+N+C;return(A<<S|A>>>32-S)+_}function x(v,_,b,w,N,S,C){var A=v+(_^b^w)+N+C;return(A<<S|A>>>32-S)+_}function j(v,_,b,w,N,S,C){var A=v+(b^(_|~w))+N+C;return(A<<S|A>>>32-S)+_}a.MD5=c._createHelper(m),a.HmacMD5=c._createHmacHelper(m)}(Math),n.MD5})}(Sv)),Sv.exports}var kv={exports:{}},mk;function AT(){return mk||(mk=1,function(t,e){(function(n,r){t.exports=r(Zt())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=a.Hasher,c=r.algo,d=[],u=c.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,f){for(var p=this._hash.words,x=p[0],j=p[1],v=p[2],_=p[3],b=p[4],w=0;w<80;w++){if(w<16)d[w]=m[f+w]|0;else{var N=d[w-3]^d[w-8]^d[w-14]^d[w-16];d[w]=N<<1|N>>>31}var S=(x<<5|x>>>27)+b+d[w];w<20?S+=(j&v|~j&_)+1518500249:w<40?S+=(j^v^_)+1859775393:w<60?S+=(j&v|j&_|v&_)-1894007588:S+=(j^v^_)-899497514,b=_,_=v,v=j<<30|j>>>2,j=x,x=S}p[0]=p[0]+x|0,p[1]=p[1]+j|0,p[2]=p[2]+v|0,p[3]=p[3]+_|0,p[4]=p[4]+b|0},_doFinalize:function(){var m=this._data,f=m.words,p=this._nDataBytes*8,x=m.sigBytes*8;return f[x>>>5]|=128<<24-x%32,f[(x+64>>>9<<4)+14]=Math.floor(p/4294967296),f[(x+64>>>9<<4)+15]=p,m.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var m=o.clone.call(this);return m._hash=this._hash.clone(),m}});r.SHA1=o._createHelper(u),r.HmacSHA1=o._createHmacHelper(u)}(),n.SHA1})}(kv)),kv.exports}var Cv={exports:{}},pk;function Rj(){return pk||(pk=1,function(t,e){(function(n,r){t.exports=r(Zt())})(gt,function(n){return function(r){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.algo,u=[],m=[];(function(){function x(b){for(var w=r.sqrt(b),N=2;N<=w;N++)if(!(b%N))return!1;return!0}function j(b){return(b-(b|0))*4294967296|0}for(var v=2,_=0;_<64;)x(v)&&(_<8&&(u[_]=j(r.pow(v,1/2))),m[_]=j(r.pow(v,1/3)),_++),v++})();var f=[],p=d.SHA256=c.extend({_doReset:function(){this._hash=new o.init(u.slice(0))},_doProcessBlock:function(x,j){for(var v=this._hash.words,_=v[0],b=v[1],w=v[2],N=v[3],S=v[4],C=v[5],A=v[6],P=v[7],M=0;M<64;M++){if(M<16)f[M]=x[j+M]|0;else{var z=f[M-15],R=(z<<25|z>>>7)^(z<<14|z>>>18)^z>>>3,D=f[M-2],B=(D<<15|D>>>17)^(D<<13|D>>>19)^D>>>10;f[M]=R+f[M-7]+B+f[M-16]}var W=S&C^~S&A,X=_&b^_&w^b&w,ue=(_<<30|_>>>2)^(_<<19|_>>>13)^(_<<10|_>>>22),de=(S<<26|S>>>6)^(S<<21|S>>>11)^(S<<7|S>>>25),G=P+de+W+m[M]+f[M],I=ue+X;P=A,A=C,C=S,S=N+G|0,N=w,w=b,b=_,_=G+I|0}v[0]=v[0]+_|0,v[1]=v[1]+b|0,v[2]=v[2]+w|0,v[3]=v[3]+N|0,v[4]=v[4]+S|0,v[5]=v[5]+C|0,v[6]=v[6]+A|0,v[7]=v[7]+P|0},_doFinalize:function(){var x=this._data,j=x.words,v=this._nDataBytes*8,_=x.sigBytes*8;return j[_>>>5]|=128<<24-_%32,j[(_+64>>>9<<4)+14]=r.floor(v/4294967296),j[(_+64>>>9<<4)+15]=v,x.sigBytes=j.length*4,this._process(),this._hash},clone:function(){var x=c.clone.call(this);return x._hash=this._hash.clone(),x}});a.SHA256=c._createHelper(p),a.HmacSHA256=c._createHmacHelper(p)}(Math),n.SHA256})}(Cv)),Cv.exports}var Ev={exports:{}},gk;function ZH(){return gk||(gk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Rj())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=r.algo,c=o.SHA256,d=o.SHA224=c.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var u=c._doFinalize.call(this);return u.sigBytes-=4,u}});r.SHA224=c._createHelper(d),r.HmacSHA224=c._createHmacHelper(d)}(),n.SHA224})}(Ev)),Ev.exports}var Av={exports:{}},xk;function PT(){return xk||(xk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Pg())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.Hasher,o=r.x64,c=o.Word,d=o.WordArray,u=r.algo;function m(){return c.create.apply(c,arguments)}var f=[m(1116352408,3609767458),m(1899447441,602891725),m(3049323471,3964484399),m(3921009573,2173295548),m(961987163,4081628472),m(1508970993,3053834265),m(2453635748,2937671579),m(2870763221,3664609560),m(3624381080,2734883394),m(310598401,1164996542),m(607225278,1323610764),m(1426881987,3590304994),m(1925078388,4068182383),m(2162078206,991336113),m(2614888103,633803317),m(3248222580,3479774868),m(3835390401,2666613458),m(4022224774,944711139),m(264347078,2341262773),m(604807628,2007800933),m(770255983,1495990901),m(1249150122,1856431235),m(1555081692,3175218132),m(1996064986,2198950837),m(2554220882,3999719339),m(2821834349,766784016),m(2952996808,2566594879),m(3210313671,3203337956),m(3336571891,1034457026),m(3584528711,2466948901),m(113926993,3758326383),m(338241895,168717936),m(666307205,1188179964),m(773529912,1546045734),m(1294757372,1522805485),m(1396182291,2643833823),m(1695183700,2343527390),m(1986661051,1014477480),m(2177026350,1206759142),m(2456956037,344077627),m(2730485921,1290863460),m(2820302411,3158454273),m(3259730800,3505952657),m(3345764771,106217008),m(3516065817,3606008344),m(3600352804,1432725776),m(4094571909,1467031594),m(275423344,851169720),m(430227734,3100823752),m(506948616,1363258195),m(659060556,3750685593),m(883997877,3785050280),m(958139571,3318307427),m(1322822218,3812723403),m(1537002063,2003034995),m(1747873779,3602036899),m(1955562222,1575990012),m(2024104815,1125592928),m(2227730452,2716904306),m(2361852424,442776044),m(2428436474,593698344),m(2756734187,3733110249),m(3204031479,2999351573),m(3329325298,3815920427),m(3391569614,3928383900),m(3515267271,566280711),m(3940187606,3454069534),m(4118630271,4000239992),m(116418474,1914138554),m(174292421,2731055270),m(289380356,3203993006),m(460393269,320620315),m(685471733,587496836),m(852142971,1086792851),m(1017036298,365543100),m(1126000580,2618297676),m(1288033470,3409855158),m(1501505948,4234509866),m(1607167915,987167468),m(1816402316,1246189591)],p=[];(function(){for(var j=0;j<80;j++)p[j]=m()})();var x=u.SHA512=i.extend({_doReset:function(){this._hash=new d.init([new c.init(1779033703,4089235720),new c.init(3144134277,2227873595),new c.init(1013904242,4271175723),new c.init(2773480762,1595750129),new c.init(1359893119,2917565137),new c.init(2600822924,725511199),new c.init(528734635,4215389547),new c.init(1541459225,327033209)])},_doProcessBlock:function(j,v){for(var _=this._hash.words,b=_[0],w=_[1],N=_[2],S=_[3],C=_[4],A=_[5],P=_[6],M=_[7],z=b.high,R=b.low,D=w.high,B=w.low,W=N.high,X=N.low,ue=S.high,de=S.low,G=C.high,I=C.low,V=A.high,$=A.low,F=P.high,O=P.low,K=M.high,U=M.low,te=z,J=R,q=D,ne=B,pe=W,Q=X,re=ue,me=de,he=G,ge=I,se=V,we=$,Se=F,qe=O,Ye=K,Et=U,be=0;be<80;be++){var Oe,Fe,lt=p[be];if(be<16)Fe=lt.high=j[v+be*2]|0,Oe=lt.low=j[v+be*2+1]|0;else{var He=p[be-15],Le=He.high,Nt=He.low,xt=(Le>>>1|Nt<<31)^(Le>>>8|Nt<<24)^Le>>>7,Un=(Nt>>>1|Le<<31)^(Nt>>>8|Le<<24)^(Nt>>>7|Le<<25),gs=p[be-2],yt=gs.high,dn=gs.low,Tn=(yt>>>19|dn<<13)^(yt<<3|dn>>>29)^yt>>>6,rs=(dn>>>19|yt<<13)^(dn<<3|yt>>>29)^(dn>>>6|yt<<26),Mn=p[be-7],bn=Mn.high,je=Mn.low,_e=p[be-16],$e=_e.high,Me=_e.low;Oe=Un+je,Fe=xt+bn+(Oe>>>0<Un>>>0?1:0),Oe=Oe+rs,Fe=Fe+Tn+(Oe>>>0<rs>>>0?1:0),Oe=Oe+Me,Fe=Fe+$e+(Oe>>>0<Me>>>0?1:0),lt.high=Fe,lt.low=Oe}var Ee=he&se^~he&Se,it=ge&we^~ge&qe,pn=te&q^te&pe^q&pe,Ss=J&ne^J&Q^ne&Q,pa=(te>>>28|J<<4)^(te<<30|J>>>2)^(te<<25|J>>>7),Ai=(J>>>28|te<<4)^(J<<30|te>>>2)^(J<<25|te>>>7),Pi=(he>>>14|ge<<18)^(he>>>18|ge<<14)^(he<<23|ge>>>9),Jd=(ge>>>14|he<<18)^(ge>>>18|he<<14)^(ge<<23|he>>>9),Di=f[be],Ti=Di.high,zf=Di.low,ks=Et+Jd,ga=Ye+Pi+(ks>>>0<Et>>>0?1:0),ks=ks+it,ga=ga+Ee+(ks>>>0<it>>>0?1:0),ks=ks+zf,ga=ga+Ti+(ks>>>0<zf>>>0?1:0),ks=ks+Oe,ga=ga+Fe+(ks>>>0<Oe>>>0?1:0),Js=Ai+Ss,at=pa+pn+(Js>>>0<Ai>>>0?1:0);Ye=Se,Et=qe,Se=se,qe=we,se=he,we=ge,ge=me+ks|0,he=re+ga+(ge>>>0<me>>>0?1:0)|0,re=pe,me=Q,pe=q,Q=ne,q=te,ne=J,J=ks+Js|0,te=ga+at+(J>>>0<ks>>>0?1:0)|0}R=b.low=R+J,b.high=z+te+(R>>>0<J>>>0?1:0),B=w.low=B+ne,w.high=D+q+(B>>>0<ne>>>0?1:0),X=N.low=X+Q,N.high=W+pe+(X>>>0<Q>>>0?1:0),de=S.low=de+me,S.high=ue+re+(de>>>0<me>>>0?1:0),I=C.low=I+ge,C.high=G+he+(I>>>0<ge>>>0?1:0),$=A.low=$+we,A.high=V+se+($>>>0<we>>>0?1:0),O=P.low=O+qe,P.high=F+Se+(O>>>0<qe>>>0?1:0),U=M.low=U+Et,M.high=K+Ye+(U>>>0<Et>>>0?1:0)},_doFinalize:function(){var j=this._data,v=j.words,_=this._nDataBytes*8,b=j.sigBytes*8;v[b>>>5]|=128<<24-b%32,v[(b+128>>>10<<5)+30]=Math.floor(_/4294967296),v[(b+128>>>10<<5)+31]=_,j.sigBytes=v.length*4,this._process();var w=this._hash.toX32();return w},clone:function(){var j=i.clone.call(this);return j._hash=this._hash.clone(),j},blockSize:1024/32});r.SHA512=i._createHelper(x),r.HmacSHA512=i._createHmacHelper(x)}(),n.SHA512})}(Av)),Av.exports}var Pv={exports:{}},vk;function GH(){return vk||(vk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Pg(),PT())})(gt,function(n){return function(){var r=n,a=r.x64,i=a.Word,o=a.WordArray,c=r.algo,d=c.SHA512,u=c.SHA384=d.extend({_doReset:function(){this._hash=new o.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var m=d._doFinalize.call(this);return m.sigBytes-=16,m}});r.SHA384=d._createHelper(u),r.HmacSHA384=d._createHmacHelper(u)}(),n.SHA384})}(Pv)),Pv.exports}var Dv={exports:{}},yk;function QH(){return yk||(yk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Pg())})(gt,function(n){return function(r){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.x64,u=d.Word,m=a.algo,f=[],p=[],x=[];(function(){for(var _=1,b=0,w=0;w<24;w++){f[_+5*b]=(w+1)*(w+2)/2%64;var N=b%5,S=(2*_+3*b)%5;_=N,b=S}for(var _=0;_<5;_++)for(var b=0;b<5;b++)p[_+5*b]=b+(2*_+3*b)%5*5;for(var C=1,A=0;A<24;A++){for(var P=0,M=0,z=0;z<7;z++){if(C&1){var R=(1<<z)-1;R<32?M^=1<<R:P^=1<<R-32}C&128?C=C<<1^113:C<<=1}x[A]=u.create(P,M)}})();var j=[];(function(){for(var _=0;_<25;_++)j[_]=u.create()})();var v=m.SHA3=c.extend({cfg:c.cfg.extend({outputLength:512}),_doReset:function(){for(var _=this._state=[],b=0;b<25;b++)_[b]=new u.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(_,b){for(var w=this._state,N=this.blockSize/2,S=0;S<N;S++){var C=_[b+2*S],A=_[b+2*S+1];C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360;var P=w[S];P.high^=A,P.low^=C}for(var M=0;M<24;M++){for(var z=0;z<5;z++){for(var R=0,D=0,B=0;B<5;B++){var P=w[z+5*B];R^=P.high,D^=P.low}var W=j[z];W.high=R,W.low=D}for(var z=0;z<5;z++)for(var X=j[(z+4)%5],ue=j[(z+1)%5],de=ue.high,G=ue.low,R=X.high^(de<<1|G>>>31),D=X.low^(G<<1|de>>>31),B=0;B<5;B++){var P=w[z+5*B];P.high^=R,P.low^=D}for(var I=1;I<25;I++){var R,D,P=w[I],V=P.high,$=P.low,F=f[I];F<32?(R=V<<F|$>>>32-F,D=$<<F|V>>>32-F):(R=$<<F-32|V>>>64-F,D=V<<F-32|$>>>64-F);var O=j[p[I]];O.high=R,O.low=D}var K=j[0],U=w[0];K.high=U.high,K.low=U.low;for(var z=0;z<5;z++)for(var B=0;B<5;B++){var I=z+5*B,P=w[I],te=j[I],J=j[(z+1)%5+5*B],q=j[(z+2)%5+5*B];P.high=te.high^~J.high&q.high,P.low=te.low^~J.low&q.low}var P=w[0],ne=x[M];P.high^=ne.high,P.low^=ne.low}},_doFinalize:function(){var _=this._data,b=_.words;this._nDataBytes*8;var w=_.sigBytes*8,N=this.blockSize*32;b[w>>>5]|=1<<24-w%32,b[(r.ceil((w+1)/N)*N>>>5)-1]|=128,_.sigBytes=b.length*4,this._process();for(var S=this._state,C=this.cfg.outputLength/8,A=C/8,P=[],M=0;M<A;M++){var z=S[M],R=z.high,D=z.low;R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,D=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,P.push(D),P.push(R)}return new o.init(P,C)},clone:function(){for(var _=c.clone.call(this),b=_._state=this._state.slice(0),w=0;w<25;w++)b[w]=b[w].clone();return _}});a.SHA3=c._createHelper(v),a.HmacSHA3=c._createHmacHelper(v)}(Math),n.SHA3})}(Dv)),Dv.exports}var Tv={exports:{}},_k;function YH(){return _k||(_k=1,function(t,e){(function(n,r){t.exports=r(Zt())})(gt,function(n){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.algo,u=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),m=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),p=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),x=o.create([0,1518500249,1859775393,2400959708,2840853838]),j=o.create([1352829926,1548603684,1836072691,2053994217,0]),v=d.RIPEMD160=c.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(A,P){for(var M=0;M<16;M++){var z=P+M,R=A[z];A[z]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360}var D=this._hash.words,B=x.words,W=j.words,X=u.words,ue=m.words,de=f.words,G=p.words,I,V,$,F,O,K,U,te,J,q;K=I=D[0],U=V=D[1],te=$=D[2],J=F=D[3],q=O=D[4];for(var ne,M=0;M<80;M+=1)ne=I+A[P+X[M]]|0,M<16?ne+=_(V,$,F)+B[0]:M<32?ne+=b(V,$,F)+B[1]:M<48?ne+=w(V,$,F)+B[2]:M<64?ne+=N(V,$,F)+B[3]:ne+=S(V,$,F)+B[4],ne=ne|0,ne=C(ne,de[M]),ne=ne+O|0,I=O,O=F,F=C($,10),$=V,V=ne,ne=K+A[P+ue[M]]|0,M<16?ne+=S(U,te,J)+W[0]:M<32?ne+=N(U,te,J)+W[1]:M<48?ne+=w(U,te,J)+W[2]:M<64?ne+=b(U,te,J)+W[3]:ne+=_(U,te,J)+W[4],ne=ne|0,ne=C(ne,G[M]),ne=ne+q|0,K=q,q=J,J=C(te,10),te=U,U=ne;ne=D[1]+$+J|0,D[1]=D[2]+F+q|0,D[2]=D[3]+O+K|0,D[3]=D[4]+I+U|0,D[4]=D[0]+V+te|0,D[0]=ne},_doFinalize:function(){var A=this._data,P=A.words,M=this._nDataBytes*8,z=A.sigBytes*8;P[z>>>5]|=128<<24-z%32,P[(z+64>>>9<<4)+14]=(M<<8|M>>>24)&16711935|(M<<24|M>>>8)&4278255360,A.sigBytes=(P.length+1)*4,this._process();for(var R=this._hash,D=R.words,B=0;B<5;B++){var W=D[B];D[B]=(W<<8|W>>>24)&16711935|(W<<24|W>>>8)&4278255360}return R},clone:function(){var A=c.clone.call(this);return A._hash=this._hash.clone(),A}});function _(A,P,M){return A^P^M}function b(A,P,M){return A&P|~A&M}function w(A,P,M){return(A|~P)^M}function N(A,P,M){return A&M|P&~M}function S(A,P,M){return A^(P|~M)}function C(A,P){return A<<P|A>>>32-P}a.RIPEMD160=c._createHelper(v),a.HmacRIPEMD160=c._createHmacHelper(v)}(),n.RIPEMD160})}(Tv)),Tv.exports}var Mv={exports:{}},wk;function Ij(){return wk||(wk=1,function(t,e){(function(n,r){t.exports=r(Zt())})(gt,function(n){(function(){var r=n,a=r.lib,i=a.Base,o=r.enc,c=o.Utf8,d=r.algo;d.HMAC=i.extend({init:function(u,m){u=this._hasher=new u.init,typeof m=="string"&&(m=c.parse(m));var f=u.blockSize,p=f*4;m.sigBytes>p&&(m=u.finalize(m)),m.clamp();for(var x=this._oKey=m.clone(),j=this._iKey=m.clone(),v=x.words,_=j.words,b=0;b<f;b++)v[b]^=1549556828,_[b]^=909522486;x.sigBytes=j.sigBytes=p,this.reset()},reset:function(){var u=this._hasher;u.reset(),u.update(this._iKey)},update:function(u){return this._hasher.update(u),this},finalize:function(u){var m=this._hasher,f=m.finalize(u);m.reset();var p=m.finalize(this._oKey.clone().concat(f));return p}})})()})}(Mv)),Mv.exports}var Rv={exports:{}},bk;function XH(){return bk||(bk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Rj(),Ij())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.Base,o=a.WordArray,c=r.algo,d=c.SHA256,u=c.HMAC,m=c.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:d,iterations:25e4}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,p){for(var x=this.cfg,j=u.create(x.hasher,f),v=o.create(),_=o.create([1]),b=v.words,w=_.words,N=x.keySize,S=x.iterations;b.length<N;){var C=j.update(p).finalize(_);j.reset();for(var A=C.words,P=A.length,M=C,z=1;z<S;z++){M=j.finalize(M),j.reset();for(var R=M.words,D=0;D<P;D++)A[D]^=R[D]}v.concat(C),w[0]++}return v.sigBytes=N*4,v}});r.PBKDF2=function(f,p,x){return m.create(x).compute(f,p)}}(),n.PBKDF2})}(Rv)),Rv.exports}var Iv={exports:{}},jk;function Uo(){return jk||(jk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),AT(),Ij())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.Base,o=a.WordArray,c=r.algo,d=c.MD5,u=c.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:d,iterations:1}),init:function(m){this.cfg=this.cfg.extend(m)},compute:function(m,f){for(var p,x=this.cfg,j=x.hasher.create(),v=o.create(),_=v.words,b=x.keySize,w=x.iterations;_.length<b;){p&&j.update(p),p=j.update(m).finalize(f),j.reset();for(var N=1;N<w;N++)p=j.finalize(p),j.reset();v.concat(p)}return v.sigBytes=b*4,v}});r.EvpKDF=function(m,f,p){return u.create(p).compute(m,f)}}(),n.EvpKDF})}(Iv)),Iv.exports}var Ov={exports:{}},Nk;function ss(){return Nk||(Nk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Uo())})(gt,function(n){n.lib.Cipher||function(r){var a=n,i=a.lib,o=i.Base,c=i.WordArray,d=i.BufferedBlockAlgorithm,u=a.enc;u.Utf8;var m=u.Base64,f=a.algo,p=f.EvpKDF,x=i.Cipher=d.extend({cfg:o.extend(),createEncryptor:function(R,D){return this.create(this._ENC_XFORM_MODE,R,D)},createDecryptor:function(R,D){return this.create(this._DEC_XFORM_MODE,R,D)},init:function(R,D,B){this.cfg=this.cfg.extend(B),this._xformMode=R,this._key=D,this.reset()},reset:function(){d.reset.call(this),this._doReset()},process:function(R){return this._append(R),this._process()},finalize:function(R){R&&this._append(R);var D=this._doFinalize();return D},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function R(D){return typeof D=="string"?z:A}return function(D){return{encrypt:function(B,W,X){return R(W).encrypt(D,B,W,X)},decrypt:function(B,W,X){return R(W).decrypt(D,B,W,X)}}}}()});i.StreamCipher=x.extend({_doFinalize:function(){var R=this._process(!0);return R},blockSize:1});var j=a.mode={},v=i.BlockCipherMode=o.extend({createEncryptor:function(R,D){return this.Encryptor.create(R,D)},createDecryptor:function(R,D){return this.Decryptor.create(R,D)},init:function(R,D){this._cipher=R,this._iv=D}}),_=j.CBC=function(){var R=v.extend();R.Encryptor=R.extend({processBlock:function(B,W){var X=this._cipher,ue=X.blockSize;D.call(this,B,W,ue),X.encryptBlock(B,W),this._prevBlock=B.slice(W,W+ue)}}),R.Decryptor=R.extend({processBlock:function(B,W){var X=this._cipher,ue=X.blockSize,de=B.slice(W,W+ue);X.decryptBlock(B,W),D.call(this,B,W,ue),this._prevBlock=de}});function D(B,W,X){var ue,de=this._iv;de?(ue=de,this._iv=r):ue=this._prevBlock;for(var G=0;G<X;G++)B[W+G]^=ue[G]}return R}(),b=a.pad={},w=b.Pkcs7={pad:function(R,D){for(var B=D*4,W=B-R.sigBytes%B,X=W<<24|W<<16|W<<8|W,ue=[],de=0;de<W;de+=4)ue.push(X);var G=c.create(ue,W);R.concat(G)},unpad:function(R){var D=R.words[R.sigBytes-1>>>2]&255;R.sigBytes-=D}};i.BlockCipher=x.extend({cfg:x.cfg.extend({mode:_,padding:w}),reset:function(){var R;x.reset.call(this);var D=this.cfg,B=D.iv,W=D.mode;this._xformMode==this._ENC_XFORM_MODE?R=W.createEncryptor:(R=W.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==R?this._mode.init(this,B&&B.words):(this._mode=R.call(W,this,B&&B.words),this._mode.__creator=R)},_doProcessBlock:function(R,D){this._mode.processBlock(R,D)},_doFinalize:function(){var R,D=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(D.pad(this._data,this.blockSize),R=this._process(!0)):(R=this._process(!0),D.unpad(R)),R},blockSize:128/32});var N=i.CipherParams=o.extend({init:function(R){this.mixIn(R)},toString:function(R){return(R||this.formatter).stringify(this)}}),S=a.format={},C=S.OpenSSL={stringify:function(R){var D,B=R.ciphertext,W=R.salt;return W?D=c.create([1398893684,1701076831]).concat(W).concat(B):D=B,D.toString(m)},parse:function(R){var D,B=m.parse(R),W=B.words;return W[0]==1398893684&&W[1]==1701076831&&(D=c.create(W.slice(2,4)),W.splice(0,4),B.sigBytes-=16),N.create({ciphertext:B,salt:D})}},A=i.SerializableCipher=o.extend({cfg:o.extend({format:C}),encrypt:function(R,D,B,W){W=this.cfg.extend(W);var X=R.createEncryptor(B,W),ue=X.finalize(D),de=X.cfg;return N.create({ciphertext:ue,key:B,iv:de.iv,algorithm:R,mode:de.mode,padding:de.padding,blockSize:R.blockSize,formatter:W.format})},decrypt:function(R,D,B,W){W=this.cfg.extend(W),D=this._parse(D,W.format);var X=R.createDecryptor(B,W).finalize(D.ciphertext);return X},_parse:function(R,D){return typeof R=="string"?D.parse(R,this):R}}),P=a.kdf={},M=P.OpenSSL={execute:function(R,D,B,W,X){if(W||(W=c.random(64/8)),X)var ue=p.create({keySize:D+B,hasher:X}).compute(R,W);else var ue=p.create({keySize:D+B}).compute(R,W);var de=c.create(ue.words.slice(D),B*4);return ue.sigBytes=D*4,N.create({key:ue,iv:de,salt:W})}},z=i.PasswordBasedCipher=A.extend({cfg:A.cfg.extend({kdf:M}),encrypt:function(R,D,B,W){W=this.cfg.extend(W);var X=W.kdf.execute(B,R.keySize,R.ivSize,W.salt,W.hasher);W.iv=X.iv;var ue=A.encrypt.call(this,R,D,X.key,W);return ue.mixIn(X),ue},decrypt:function(R,D,B,W){W=this.cfg.extend(W),D=this._parse(D,W.format);var X=W.kdf.execute(B,R.keySize,R.ivSize,D.salt,W.hasher);W.iv=X.iv;var ue=A.decrypt.call(this,R,D,X.key,W);return ue}})}()})}(Ov)),Ov.exports}var Lv={exports:{}},Sk;function JH(){return Sk||(Sk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),ss())})(gt,function(n){return n.mode.CFB=function(){var r=n.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize;a.call(this,i,o,d,c),this._prevBlock=i.slice(o,o+d)}}),r.Decryptor=r.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize,u=i.slice(o,o+d);a.call(this,i,o,d,c),this._prevBlock=u}});function a(i,o,c,d){var u,m=this._iv;m?(u=m.slice(0),this._iv=void 0):u=this._prevBlock,d.encryptBlock(u,0);for(var f=0;f<c;f++)i[o+f]^=u[f]}return r}(),n.mode.CFB})}(Lv)),Lv.exports}var Fv={exports:{}},kk;function eV(){return kk||(kk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),ss())})(gt,function(n){return n.mode.CTR=function(){var r=n.lib.BlockCipherMode.extend(),a=r.Encryptor=r.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize,u=this._iv,m=this._counter;u&&(m=this._counter=u.slice(0),this._iv=void 0);var f=m.slice(0);c.encryptBlock(f,0),m[d-1]=m[d-1]+1|0;for(var p=0;p<d;p++)i[o+p]^=f[p]}});return r.Decryptor=a,r}(),n.mode.CTR})}(Fv)),Fv.exports}var Bv={exports:{}},Ck;function tV(){return Ck||(Ck=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),ss())})(gt,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=function(){var r=n.lib.BlockCipherMode.extend();function a(c){if((c>>24&255)===255){var d=c>>16&255,u=c>>8&255,m=c&255;d===255?(d=0,u===255?(u=0,m===255?m=0:++m):++u):++d,c=0,c+=d<<16,c+=u<<8,c+=m}else c+=1<<24;return c}function i(c){return(c[0]=a(c[0]))===0&&(c[1]=a(c[1])),c}var o=r.Encryptor=r.extend({processBlock:function(c,d){var u=this._cipher,m=u.blockSize,f=this._iv,p=this._counter;f&&(p=this._counter=f.slice(0),this._iv=void 0),i(p);var x=p.slice(0);u.encryptBlock(x,0);for(var j=0;j<m;j++)c[d+j]^=x[j]}});return r.Decryptor=o,r}(),n.mode.CTRGladman})}(Bv)),Bv.exports}var zv={exports:{}},Ek;function nV(){return Ek||(Ek=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),ss())})(gt,function(n){return n.mode.OFB=function(){var r=n.lib.BlockCipherMode.extend(),a=r.Encryptor=r.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize,u=this._iv,m=this._keystream;u&&(m=this._keystream=u.slice(0),this._iv=void 0),c.encryptBlock(m,0);for(var f=0;f<d;f++)i[o+f]^=m[f]}});return r.Decryptor=a,r}(),n.mode.OFB})}(zv)),zv.exports}var $v={exports:{}},Ak;function sV(){return Ak||(Ak=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),ss())})(gt,function(n){return n.mode.ECB=function(){var r=n.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(a,i){this._cipher.encryptBlock(a,i)}}),r.Decryptor=r.extend({processBlock:function(a,i){this._cipher.decryptBlock(a,i)}}),r}(),n.mode.ECB})}($v)),$v.exports}var Uv={exports:{}},Pk;function rV(){return Pk||(Pk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),ss())})(gt,function(n){return n.pad.AnsiX923={pad:function(r,a){var i=r.sigBytes,o=a*4,c=o-i%o,d=i+c-1;r.clamp(),r.words[d>>>2]|=c<<24-d%4*8,r.sigBytes+=c},unpad:function(r){var a=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=a}},n.pad.Ansix923})}(Uv)),Uv.exports}var qv={exports:{}},Dk;function aV(){return Dk||(Dk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),ss())})(gt,function(n){return n.pad.Iso10126={pad:function(r,a){var i=a*4,o=i-r.sigBytes%i;r.concat(n.lib.WordArray.random(o-1)).concat(n.lib.WordArray.create([o<<24],1))},unpad:function(r){var a=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=a}},n.pad.Iso10126})}(qv)),qv.exports}var Wv={exports:{}},Tk;function iV(){return Tk||(Tk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),ss())})(gt,function(n){return n.pad.Iso97971={pad:function(r,a){r.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(r,a)},unpad:function(r){n.pad.ZeroPadding.unpad(r),r.sigBytes--}},n.pad.Iso97971})}(Wv)),Wv.exports}var Hv={exports:{}},Mk;function oV(){return Mk||(Mk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),ss())})(gt,function(n){return n.pad.ZeroPadding={pad:function(r,a){var i=a*4;r.clamp(),r.sigBytes+=i-(r.sigBytes%i||i)},unpad:function(r){for(var a=r.words,i=r.sigBytes-1,i=r.sigBytes-1;i>=0;i--)if(a[i>>>2]>>>24-i%4*8&255){r.sigBytes=i+1;break}}},n.pad.ZeroPadding})}(Hv)),Hv.exports}var Vv={exports:{}},Rk;function lV(){return Rk||(Rk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),ss())})(gt,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})}(Vv)),Vv.exports}var Kv={exports:{}},Ik;function cV(){return Ik||(Ik=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),ss())})(gt,function(n){return function(r){var a=n,i=a.lib,o=i.CipherParams,c=a.enc,d=c.Hex,u=a.format;u.Hex={stringify:function(m){return m.ciphertext.toString(d)},parse:function(m){var f=d.parse(m);return o.create({ciphertext:f})}}}(),n.format.Hex})}(Kv)),Kv.exports}var Zv={exports:{}},Ok;function dV(){return Ok||(Ok=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Gl(),Ql(),Uo(),ss())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.BlockCipher,o=r.algo,c=[],d=[],u=[],m=[],f=[],p=[],x=[],j=[],v=[],_=[];(function(){for(var N=[],S=0;S<256;S++)S<128?N[S]=S<<1:N[S]=S<<1^283;for(var C=0,A=0,S=0;S<256;S++){var P=A^A<<1^A<<2^A<<3^A<<4;P=P>>>8^P&255^99,c[C]=P,d[P]=C;var M=N[C],z=N[M],R=N[z],D=N[P]*257^P*16843008;u[C]=D<<24|D>>>8,m[C]=D<<16|D>>>16,f[C]=D<<8|D>>>24,p[C]=D;var D=R*16843009^z*65537^M*257^C*16843008;x[P]=D<<24|D>>>8,j[P]=D<<16|D>>>16,v[P]=D<<8|D>>>24,_[P]=D,C?(C=M^N[N[N[R^M]]],A^=N[N[A]]):C=A=1}})();var b=[0,1,2,4,8,16,32,64,128,27,54],w=o.AES=i.extend({_doReset:function(){var N;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var S=this._keyPriorReset=this._key,C=S.words,A=S.sigBytes/4,P=this._nRounds=A+6,M=(P+1)*4,z=this._keySchedule=[],R=0;R<M;R++)R<A?z[R]=C[R]:(N=z[R-1],R%A?A>6&&R%A==4&&(N=c[N>>>24]<<24|c[N>>>16&255]<<16|c[N>>>8&255]<<8|c[N&255]):(N=N<<8|N>>>24,N=c[N>>>24]<<24|c[N>>>16&255]<<16|c[N>>>8&255]<<8|c[N&255],N^=b[R/A|0]<<24),z[R]=z[R-A]^N);for(var D=this._invKeySchedule=[],B=0;B<M;B++){var R=M-B;if(B%4)var N=z[R];else var N=z[R-4];B<4||R<=4?D[B]=N:D[B]=x[c[N>>>24]]^j[c[N>>>16&255]]^v[c[N>>>8&255]]^_[c[N&255]]}}},encryptBlock:function(N,S){this._doCryptBlock(N,S,this._keySchedule,u,m,f,p,c)},decryptBlock:function(N,S){var C=N[S+1];N[S+1]=N[S+3],N[S+3]=C,this._doCryptBlock(N,S,this._invKeySchedule,x,j,v,_,d);var C=N[S+1];N[S+1]=N[S+3],N[S+3]=C},_doCryptBlock:function(N,S,C,A,P,M,z,R){for(var D=this._nRounds,B=N[S]^C[0],W=N[S+1]^C[1],X=N[S+2]^C[2],ue=N[S+3]^C[3],de=4,G=1;G<D;G++){var I=A[B>>>24]^P[W>>>16&255]^M[X>>>8&255]^z[ue&255]^C[de++],V=A[W>>>24]^P[X>>>16&255]^M[ue>>>8&255]^z[B&255]^C[de++],$=A[X>>>24]^P[ue>>>16&255]^M[B>>>8&255]^z[W&255]^C[de++],F=A[ue>>>24]^P[B>>>16&255]^M[W>>>8&255]^z[X&255]^C[de++];B=I,W=V,X=$,ue=F}var I=(R[B>>>24]<<24|R[W>>>16&255]<<16|R[X>>>8&255]<<8|R[ue&255])^C[de++],V=(R[W>>>24]<<24|R[X>>>16&255]<<16|R[ue>>>8&255]<<8|R[B&255])^C[de++],$=(R[X>>>24]<<24|R[ue>>>16&255]<<16|R[B>>>8&255]<<8|R[W&255])^C[de++],F=(R[ue>>>24]<<24|R[B>>>16&255]<<16|R[W>>>8&255]<<8|R[X&255])^C[de++];N[S]=I,N[S+1]=V,N[S+2]=$,N[S+3]=F},keySize:256/32});r.AES=i._createHelper(w)}(),n.AES})}(Zv)),Zv.exports}var Gv={exports:{}},Lk;function uV(){return Lk||(Lk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Gl(),Ql(),Uo(),ss())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=a.BlockCipher,c=r.algo,d=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],m=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],p=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],x=c.DES=o.extend({_doReset:function(){for(var b=this._key,w=b.words,N=[],S=0;S<56;S++){var C=d[S]-1;N[S]=w[C>>>5]>>>31-C%32&1}for(var A=this._subKeys=[],P=0;P<16;P++){for(var M=A[P]=[],z=m[P],S=0;S<24;S++)M[S/6|0]|=N[(u[S]-1+z)%28]<<31-S%6,M[4+(S/6|0)]|=N[28+(u[S+24]-1+z)%28]<<31-S%6;M[0]=M[0]<<1|M[0]>>>31;for(var S=1;S<7;S++)M[S]=M[S]>>>(S-1)*4+3;M[7]=M[7]<<5|M[7]>>>27}for(var R=this._invSubKeys=[],S=0;S<16;S++)R[S]=A[15-S]},encryptBlock:function(b,w){this._doCryptBlock(b,w,this._subKeys)},decryptBlock:function(b,w){this._doCryptBlock(b,w,this._invSubKeys)},_doCryptBlock:function(b,w,N){this._lBlock=b[w],this._rBlock=b[w+1],j.call(this,4,252645135),j.call(this,16,65535),v.call(this,2,858993459),v.call(this,8,16711935),j.call(this,1,1431655765);for(var S=0;S<16;S++){for(var C=N[S],A=this._lBlock,P=this._rBlock,M=0,z=0;z<8;z++)M|=f[z][((P^C[z])&p[z])>>>0];this._lBlock=P,this._rBlock=A^M}var R=this._lBlock;this._lBlock=this._rBlock,this._rBlock=R,j.call(this,1,1431655765),v.call(this,8,16711935),v.call(this,2,858993459),j.call(this,16,65535),j.call(this,4,252645135),b[w]=this._lBlock,b[w+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function j(b,w){var N=(this._lBlock>>>b^this._rBlock)&w;this._rBlock^=N,this._lBlock^=N<<b}function v(b,w){var N=(this._rBlock>>>b^this._lBlock)&w;this._lBlock^=N,this._rBlock^=N<<b}r.DES=o._createHelper(x);var _=c.TripleDES=o.extend({_doReset:function(){var b=this._key,w=b.words;if(w.length!==2&&w.length!==4&&w.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var N=w.slice(0,2),S=w.length<4?w.slice(0,2):w.slice(2,4),C=w.length<6?w.slice(0,2):w.slice(4,6);this._des1=x.createEncryptor(i.create(N)),this._des2=x.createEncryptor(i.create(S)),this._des3=x.createEncryptor(i.create(C))},encryptBlock:function(b,w){this._des1.encryptBlock(b,w),this._des2.decryptBlock(b,w),this._des3.encryptBlock(b,w)},decryptBlock:function(b,w){this._des3.decryptBlock(b,w),this._des2.encryptBlock(b,w),this._des1.decryptBlock(b,w)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=o._createHelper(_)}(),n.TripleDES})}(Gv)),Gv.exports}var Qv={exports:{}},Fk;function hV(){return Fk||(Fk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Gl(),Ql(),Uo(),ss())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.StreamCipher,o=r.algo,c=o.RC4=i.extend({_doReset:function(){for(var m=this._key,f=m.words,p=m.sigBytes,x=this._S=[],j=0;j<256;j++)x[j]=j;for(var j=0,v=0;j<256;j++){var _=j%p,b=f[_>>>2]>>>24-_%4*8&255;v=(v+x[j]+b)%256;var w=x[j];x[j]=x[v],x[v]=w}this._i=this._j=0},_doProcessBlock:function(m,f){m[f]^=d.call(this)},keySize:256/32,ivSize:0});function d(){for(var m=this._S,f=this._i,p=this._j,x=0,j=0;j<4;j++){f=(f+1)%256,p=(p+m[f])%256;var v=m[f];m[f]=m[p],m[p]=v,x|=m[(m[f]+m[p])%256]<<24-j*8}return this._i=f,this._j=p,x}r.RC4=i._createHelper(c);var u=o.RC4Drop=c.extend({cfg:c.cfg.extend({drop:192}),_doReset:function(){c._doReset.call(this);for(var m=this.cfg.drop;m>0;m--)d.call(this)}});r.RC4Drop=i._createHelper(u)}(),n.RC4})}(Qv)),Qv.exports}var Yv={exports:{}},Bk;function fV(){return Bk||(Bk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Gl(),Ql(),Uo(),ss())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.StreamCipher,o=r.algo,c=[],d=[],u=[],m=o.Rabbit=i.extend({_doReset:function(){for(var p=this._key.words,x=this.cfg.iv,j=0;j<4;j++)p[j]=(p[j]<<8|p[j]>>>24)&16711935|(p[j]<<24|p[j]>>>8)&4278255360;var v=this._X=[p[0],p[3]<<16|p[2]>>>16,p[1],p[0]<<16|p[3]>>>16,p[2],p[1]<<16|p[0]>>>16,p[3],p[2]<<16|p[1]>>>16],_=this._C=[p[2]<<16|p[2]>>>16,p[0]&4294901760|p[1]&65535,p[3]<<16|p[3]>>>16,p[1]&4294901760|p[2]&65535,p[0]<<16|p[0]>>>16,p[2]&4294901760|p[3]&65535,p[1]<<16|p[1]>>>16,p[3]&4294901760|p[0]&65535];this._b=0;for(var j=0;j<4;j++)f.call(this);for(var j=0;j<8;j++)_[j]^=v[j+4&7];if(x){var b=x.words,w=b[0],N=b[1],S=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,C=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,A=S>>>16|C&4294901760,P=C<<16|S&65535;_[0]^=S,_[1]^=A,_[2]^=C,_[3]^=P,_[4]^=S,_[5]^=A,_[6]^=C,_[7]^=P;for(var j=0;j<4;j++)f.call(this)}},_doProcessBlock:function(p,x){var j=this._X;f.call(this),c[0]=j[0]^j[5]>>>16^j[3]<<16,c[1]=j[2]^j[7]>>>16^j[5]<<16,c[2]=j[4]^j[1]>>>16^j[7]<<16,c[3]=j[6]^j[3]>>>16^j[1]<<16;for(var v=0;v<4;v++)c[v]=(c[v]<<8|c[v]>>>24)&16711935|(c[v]<<24|c[v]>>>8)&4278255360,p[x+v]^=c[v]},blockSize:128/32,ivSize:64/32});function f(){for(var p=this._X,x=this._C,j=0;j<8;j++)d[j]=x[j];x[0]=x[0]+1295307597+this._b|0,x[1]=x[1]+3545052371+(x[0]>>>0<d[0]>>>0?1:0)|0,x[2]=x[2]+886263092+(x[1]>>>0<d[1]>>>0?1:0)|0,x[3]=x[3]+1295307597+(x[2]>>>0<d[2]>>>0?1:0)|0,x[4]=x[4]+3545052371+(x[3]>>>0<d[3]>>>0?1:0)|0,x[5]=x[5]+886263092+(x[4]>>>0<d[4]>>>0?1:0)|0,x[6]=x[6]+1295307597+(x[5]>>>0<d[5]>>>0?1:0)|0,x[7]=x[7]+3545052371+(x[6]>>>0<d[6]>>>0?1:0)|0,this._b=x[7]>>>0<d[7]>>>0?1:0;for(var j=0;j<8;j++){var v=p[j]+x[j],_=v&65535,b=v>>>16,w=((_*_>>>17)+_*b>>>15)+b*b,N=((v&4294901760)*v|0)+((v&65535)*v|0);u[j]=w^N}p[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,p[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,p[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,p[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,p[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,p[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,p[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,p[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}r.Rabbit=i._createHelper(m)}(),n.Rabbit})}(Yv)),Yv.exports}var Xv={exports:{}},zk;function mV(){return zk||(zk=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Gl(),Ql(),Uo(),ss())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.StreamCipher,o=r.algo,c=[],d=[],u=[],m=o.RabbitLegacy=i.extend({_doReset:function(){var p=this._key.words,x=this.cfg.iv,j=this._X=[p[0],p[3]<<16|p[2]>>>16,p[1],p[0]<<16|p[3]>>>16,p[2],p[1]<<16|p[0]>>>16,p[3],p[2]<<16|p[1]>>>16],v=this._C=[p[2]<<16|p[2]>>>16,p[0]&4294901760|p[1]&65535,p[3]<<16|p[3]>>>16,p[1]&4294901760|p[2]&65535,p[0]<<16|p[0]>>>16,p[2]&4294901760|p[3]&65535,p[1]<<16|p[1]>>>16,p[3]&4294901760|p[0]&65535];this._b=0;for(var _=0;_<4;_++)f.call(this);for(var _=0;_<8;_++)v[_]^=j[_+4&7];if(x){var b=x.words,w=b[0],N=b[1],S=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,C=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,A=S>>>16|C&4294901760,P=C<<16|S&65535;v[0]^=S,v[1]^=A,v[2]^=C,v[3]^=P,v[4]^=S,v[5]^=A,v[6]^=C,v[7]^=P;for(var _=0;_<4;_++)f.call(this)}},_doProcessBlock:function(p,x){var j=this._X;f.call(this),c[0]=j[0]^j[5]>>>16^j[3]<<16,c[1]=j[2]^j[7]>>>16^j[5]<<16,c[2]=j[4]^j[1]>>>16^j[7]<<16,c[3]=j[6]^j[3]>>>16^j[1]<<16;for(var v=0;v<4;v++)c[v]=(c[v]<<8|c[v]>>>24)&16711935|(c[v]<<24|c[v]>>>8)&4278255360,p[x+v]^=c[v]},blockSize:128/32,ivSize:64/32});function f(){for(var p=this._X,x=this._C,j=0;j<8;j++)d[j]=x[j];x[0]=x[0]+1295307597+this._b|0,x[1]=x[1]+3545052371+(x[0]>>>0<d[0]>>>0?1:0)|0,x[2]=x[2]+886263092+(x[1]>>>0<d[1]>>>0?1:0)|0,x[3]=x[3]+1295307597+(x[2]>>>0<d[2]>>>0?1:0)|0,x[4]=x[4]+3545052371+(x[3]>>>0<d[3]>>>0?1:0)|0,x[5]=x[5]+886263092+(x[4]>>>0<d[4]>>>0?1:0)|0,x[6]=x[6]+1295307597+(x[5]>>>0<d[5]>>>0?1:0)|0,x[7]=x[7]+3545052371+(x[6]>>>0<d[6]>>>0?1:0)|0,this._b=x[7]>>>0<d[7]>>>0?1:0;for(var j=0;j<8;j++){var v=p[j]+x[j],_=v&65535,b=v>>>16,w=((_*_>>>17)+_*b>>>15)+b*b,N=((v&4294901760)*v|0)+((v&65535)*v|0);u[j]=w^N}p[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,p[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,p[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,p[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,p[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,p[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,p[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,p[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}r.RabbitLegacy=i._createHelper(m)}(),n.RabbitLegacy})}(Xv)),Xv.exports}var Jv={exports:{}},$k;function pV(){return $k||($k=1,function(t,e){(function(n,r,a){t.exports=r(Zt(),Gl(),Ql(),Uo(),ss())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.BlockCipher,o=r.algo;const c=16,d=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],u=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var m={pbox:[],sbox:[]};function f(_,b){let w=b>>24&255,N=b>>16&255,S=b>>8&255,C=b&255,A=_.sbox[0][w]+_.sbox[1][N];return A=A^_.sbox[2][S],A=A+_.sbox[3][C],A}function p(_,b,w){let N=b,S=w,C;for(let A=0;A<c;++A)N=N^_.pbox[A],S=f(_,N)^S,C=N,N=S,S=C;return C=N,N=S,S=C,S=S^_.pbox[c],N=N^_.pbox[c+1],{left:N,right:S}}function x(_,b,w){let N=b,S=w,C;for(let A=c+1;A>1;--A)N=N^_.pbox[A],S=f(_,N)^S,C=N,N=S,S=C;return C=N,N=S,S=C,S=S^_.pbox[1],N=N^_.pbox[0],{left:N,right:S}}function j(_,b,w){for(let P=0;P<4;P++){_.sbox[P]=[];for(let M=0;M<256;M++)_.sbox[P][M]=u[P][M]}let N=0;for(let P=0;P<c+2;P++)_.pbox[P]=d[P]^b[N],N++,N>=w&&(N=0);let S=0,C=0,A=0;for(let P=0;P<c+2;P+=2)A=p(_,S,C),S=A.left,C=A.right,_.pbox[P]=S,_.pbox[P+1]=C;for(let P=0;P<4;P++)for(let M=0;M<256;M+=2)A=p(_,S,C),S=A.left,C=A.right,_.sbox[P][M]=S,_.sbox[P][M+1]=C;return!0}var v=o.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var _=this._keyPriorReset=this._key,b=_.words,w=_.sigBytes/4;j(m,b,w)}},encryptBlock:function(_,b){var w=p(m,_[b],_[b+1]);_[b]=w.left,_[b+1]=w.right},decryptBlock:function(_,b){var w=x(m,_[b],_[b+1]);_[b]=w.left,_[b+1]=w.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=i._createHelper(v)}(),n.Blowfish})}(Jv)),Jv.exports}(function(t,e){(function(n,r,a){t.exports=r(Zt(),Pg(),HH(),VH(),Gl(),KH(),Ql(),AT(),Rj(),ZH(),PT(),GH(),QH(),YH(),Ij(),XH(),Uo(),ss(),JH(),eV(),tV(),nV(),sV(),rV(),aV(),iV(),oV(),lV(),cV(),dV(),uV(),hV(),fV(),mV(),pV())})(gt,function(n){return n})})($H);E.object({sequence_type:E.enum(["invoice","quote","order","receipt","credit_note","delivery_note","payment_voucher"]),prefix:E.string().min(1).max(10),format:E.string().min(1),reset_annually:E.boolean().default(!0),gap_tracking:E.boolean().default(!0)});E.object({entity_type:E.string().min(1),entity_id:E.string().min(1),document_content:E.string().min(1),file_name:E.string().min(1),mime_type:E.string().min(1)});E.object({year:E.number().min(2020).max(2030),quarter:E.number().min(1).max(4).optional(),month:E.number().min(1).max(12).optional(),from_date:E.string().regex(/^\d{4}-\d{2}-\d{2}$/),to_date:E.string().regex(/^\d{4}-\d{2}-\d{2}$/)});const gV={requireHumanApproval:!0,gates:{aiEstimateApply:!0,aiScheduleApply:!0,customerScoringAction:!0,employeeScoringAction:!0}};async function xV(t){try{await fetch("/api/audit/approval",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch{console.warn("[approval] audit log failed (non-blocking)",t)}}async function vV(t){let e=!0;if(typeof window<"u"&&typeof window.confirm=="function"){const n=`Bitte bestätigen:

${t.reason}

Hinweis: Diese Aktion basiert auf einem KI/Score-Vorschlag und erfordert Ihre Freigabe.`;e=window.confirm(n)}return await xV({...t,approved:e,timestamp:new Date().toISOString()}),e}async function yV(t){return!!gV.gates[t]}async function DT(t,e,n){if(!(await yV(t)&&!await vV({action:e.action??t.toString().toUpperCase(),reason:e.reason,metadata:e.metadata,userId:e.userId})))return await n()}E.object({year:E.number().min(2020).max(2030),quarter:E.number().min(1).max(4).optional(),month:E.number().min(1).max(12).optional(),period_type:E.enum(["MONTHLY","QUARTERLY","ANNUAL"]),start_date:E.string().regex(/^\d{4}-\d{2}-\d{2}$/),end_date:E.string().regex(/^\d{4}-\d{2}-\d{2}$/)});E.object({document_type:E.enum(["invoice","quote","order","project","customer","material","timesheet","expense","knowledge_base","email","pdf_document"]),entity_id:E.string(),title:E.string().min(1),content:E.string().min(1),metadata:E.record(E.any()).default({}),language:E.enum(["de","en"]).default("de"),search_tags:E.array(E.string()).default([]),importance_score:E.number().min(0).max(1).default(.5)});E.object({query:E.string().min(1),document_types:E.array(E.enum(["invoice","quote","order","project","customer","material","timesheet","expense","knowledge_base","email","pdf_document"])).optional(),date_range:E.object({from:E.string(),to:E.string()}).optional(),language:E.enum(["de","en"]).default("de"),limit:E.number().min(1).max(100).default(10),similarity_threshold:E.number().min(0).max(1).default(.7),include_metadata:E.boolean().default(!0)});E.object({user_input:E.string().min(1),detected_intent:E.enum(["SEARCH_REQUEST","CREATE_ENTITY","UPDATE_ENTITY","REPORT_REQUEST","CALCULATION_REQUEST","SCHEDULE_TASK","COMPLIANCE_CHECK","EXPORT_REQUEST","NOTIFICATION_SETUP","HELP_REQUEST","UNKNOWN"]),target_entity:E.enum(["customer","invoice","quote","order","project","material","employee","timesheet","expense","report","notification"]).optional(),suggested_action:E.enum(["CREATE","READ","UPDATE","DELETE","SEARCH","EXPORT","CALCULATE","SCHEDULE","NOTIFY","VALIDATE"]).optional(),extracted_parameters:E.record(E.any()).default({}),confidence_score:E.number().min(0).max(1)});E.object({estimation_type:E.enum(["PROJECT_COST","MATERIAL_COST","LABOR_COST","TIME_ESTIMATION","COMPLETION_DATE","RESOURCE_NEED","PROFIT_MARGIN","RISK_ASSESSMENT"]),project_category:E.enum(["BATHROOM_RENOVATION","KITCHEN_RENOVATION","ELECTRICAL_WORK","PLUMBING_WORK","FLOORING_WORK","PAINTING_WORK","ROOFING_WORK","GENERAL_CONSTRUCTION","MAINTENANCE","CUSTOM_WORK"]),project_description:E.string().min(10),project_size:E.object({area_sqm:E.number().positive().optional(),rooms:E.number().int().positive().optional(),complexity_level:E.number().int().min(1).max(5)}),customer_requirements:E.array(E.string()).default([]),timeline_constraints:E.object({start_date:E.string().optional(),end_date:E.string().optional(),fixed_deadline:E.boolean().default(!1)}).optional(),budget_constraints:E.object({min_budget:E.number().positive().optional(),max_budget:E.number().positive().optional(),flexible:E.boolean().default(!0)}).optional(),additional_context:E.record(E.any()).default({})});async function _V(t){return await DT("aiEstimateApply",{reason:"KI-Schätzung soll übernommen werden.",metadata:{projectId:t.projectId,quoteId:t.quoteId},userId:t.userId},async()=>(console.log("Applying AI estimate:",t),t.estimate))}var wV={exports:{}};(function(t){var e=function(n){var r=Object.prototype,a=r.hasOwnProperty,i=Object.defineProperty||function(V,$,F){V[$]=F.value},o,c=typeof Symbol=="function"?Symbol:{},d=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",m=c.toStringTag||"@@toStringTag";function f(V,$,F){return Object.defineProperty(V,$,{value:F,enumerable:!0,configurable:!0,writable:!0}),V[$]}try{f({},"")}catch{f=function($,F,O){return $[F]=O}}function p(V,$,F,O){var K=$&&$.prototype instanceof N?$:N,U=Object.create(K.prototype),te=new de(O||[]);return i(U,"_invoke",{value:B(V,F,te)}),U}n.wrap=p;function x(V,$,F){try{return{type:"normal",arg:V.call($,F)}}catch(O){return{type:"throw",arg:O}}}var j="suspendedStart",v="suspendedYield",_="executing",b="completed",w={};function N(){}function S(){}function C(){}var A={};f(A,d,function(){return this});var P=Object.getPrototypeOf,M=P&&P(P(G([])));M&&M!==r&&a.call(M,d)&&(A=M);var z=C.prototype=N.prototype=Object.create(A);S.prototype=C,i(z,"constructor",{value:C,configurable:!0}),i(C,"constructor",{value:S,configurable:!0}),S.displayName=f(C,m,"GeneratorFunction");function R(V){["next","throw","return"].forEach(function($){f(V,$,function(F){return this._invoke($,F)})})}n.isGeneratorFunction=function(V){var $=typeof V=="function"&&V.constructor;return $?$===S||($.displayName||$.name)==="GeneratorFunction":!1},n.mark=function(V){return Object.setPrototypeOf?Object.setPrototypeOf(V,C):(V.__proto__=C,f(V,m,"GeneratorFunction")),V.prototype=Object.create(z),V},n.awrap=function(V){return{__await:V}};function D(V,$){function F(U,te,J,q){var ne=x(V[U],V,te);if(ne.type==="throw")q(ne.arg);else{var pe=ne.arg,Q=pe.value;return Q&&typeof Q=="object"&&a.call(Q,"__await")?$.resolve(Q.__await).then(function(re){F("next",re,J,q)},function(re){F("throw",re,J,q)}):$.resolve(Q).then(function(re){pe.value=re,J(pe)},function(re){return F("throw",re,J,q)})}}var O;function K(U,te){function J(){return new $(function(q,ne){F(U,te,q,ne)})}return O=O?O.then(J,J):J()}i(this,"_invoke",{value:K})}R(D.prototype),f(D.prototype,u,function(){return this}),n.AsyncIterator=D,n.async=function(V,$,F,O,K){K===void 0&&(K=Promise);var U=new D(p(V,$,F,O),K);return n.isGeneratorFunction($)?U:U.next().then(function(te){return te.done?te.value:U.next()})};function B(V,$,F){var O=j;return function(U,te){if(O===_)throw new Error("Generator is already running");if(O===b){if(U==="throw")throw te;return I()}for(F.method=U,F.arg=te;;){var J=F.delegate;if(J){var q=W(J,F);if(q){if(q===w)continue;return q}}if(F.method==="next")F.sent=F._sent=F.arg;else if(F.method==="throw"){if(O===j)throw O=b,F.arg;F.dispatchException(F.arg)}else F.method==="return"&&F.abrupt("return",F.arg);O=_;var ne=x(V,$,F);if(ne.type==="normal"){if(O=F.done?b:v,ne.arg===w)continue;return{value:ne.arg,done:F.done}}else ne.type==="throw"&&(O=b,F.method="throw",F.arg=ne.arg)}}}function W(V,$){var F=$.method,O=V.iterator[F];if(O===o)return $.delegate=null,F==="throw"&&V.iterator.return&&($.method="return",$.arg=o,W(V,$),$.method==="throw")||F!=="return"&&($.method="throw",$.arg=new TypeError("The iterator does not provide a '"+F+"' method")),w;var K=x(O,V.iterator,$.arg);if(K.type==="throw")return $.method="throw",$.arg=K.arg,$.delegate=null,w;var U=K.arg;if(!U)return $.method="throw",$.arg=new TypeError("iterator result is not an object"),$.delegate=null,w;if(U.done)$[V.resultName]=U.value,$.next=V.nextLoc,$.method!=="return"&&($.method="next",$.arg=o);else return U;return $.delegate=null,w}R(z),f(z,m,"Generator"),f(z,d,function(){return this}),f(z,"toString",function(){return"[object Generator]"});function X(V){var $={tryLoc:V[0]};1 in V&&($.catchLoc=V[1]),2 in V&&($.finallyLoc=V[2],$.afterLoc=V[3]),this.tryEntries.push($)}function ue(V){var $=V.completion||{};$.type="normal",delete $.arg,V.completion=$}function de(V){this.tryEntries=[{tryLoc:"root"}],V.forEach(X,this),this.reset(!0)}n.keys=function(V){var $=Object(V),F=[];for(var O in $)F.push(O);return F.reverse(),function K(){for(;F.length;){var U=F.pop();if(U in $)return K.value=U,K.done=!1,K}return K.done=!0,K}};function G(V){if(V){var $=V[d];if($)return $.call(V);if(typeof V.next=="function")return V;if(!isNaN(V.length)){var F=-1,O=function K(){for(;++F<V.length;)if(a.call(V,F))return K.value=V[F],K.done=!1,K;return K.value=o,K.done=!0,K};return O.next=O}}return{next:I}}n.values=G;function I(){return{value:o,done:!0}}return de.prototype={constructor:de,reset:function(V){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(ue),!V)for(var $ in this)$.charAt(0)==="t"&&a.call(this,$)&&!isNaN(+$.slice(1))&&(this[$]=o)},stop:function(){this.done=!0;var V=this.tryEntries[0],$=V.completion;if($.type==="throw")throw $.arg;return this.rval},dispatchException:function(V){if(this.done)throw V;var $=this;function F(q,ne){return U.type="throw",U.arg=V,$.next=q,ne&&($.method="next",$.arg=o),!!ne}for(var O=this.tryEntries.length-1;O>=0;--O){var K=this.tryEntries[O],U=K.completion;if(K.tryLoc==="root")return F("end");if(K.tryLoc<=this.prev){var te=a.call(K,"catchLoc"),J=a.call(K,"finallyLoc");if(te&&J){if(this.prev<K.catchLoc)return F(K.catchLoc,!0);if(this.prev<K.finallyLoc)return F(K.finallyLoc)}else if(te){if(this.prev<K.catchLoc)return F(K.catchLoc,!0)}else if(J){if(this.prev<K.finallyLoc)return F(K.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(V,$){for(var F=this.tryEntries.length-1;F>=0;--F){var O=this.tryEntries[F];if(O.tryLoc<=this.prev&&a.call(O,"finallyLoc")&&this.prev<O.finallyLoc){var K=O;break}}K&&(V==="break"||V==="continue")&&K.tryLoc<=$&&$<=K.finallyLoc&&(K=null);var U=K?K.completion:{};return U.type=V,U.arg=$,K?(this.method="next",this.next=K.finallyLoc,w):this.complete(U)},complete:function(V,$){if(V.type==="throw")throw V.arg;return V.type==="break"||V.type==="continue"?this.next=V.arg:V.type==="return"?(this.rval=this.arg=V.arg,this.method="return",this.next="end"):V.type==="normal"&&$&&(this.next=$),w},finish:function(V){for(var $=this.tryEntries.length-1;$>=0;--$){var F=this.tryEntries[$];if(F.finallyLoc===V)return this.complete(F.completion,F.afterLoc),ue(F),w}},catch:function(V){for(var $=this.tryEntries.length-1;$>=0;--$){var F=this.tryEntries[$];if(F.tryLoc===V){var O=F.completion;if(O.type==="throw"){var K=O.arg;ue(F)}return K}}throw new Error("illegal catch attempt")},delegateYield:function(V,$,F){return this.delegate={iterator:G(V),resultName:$,nextLoc:F},this.method==="next"&&(this.arg=o),w}},n}(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(wV);var Oj=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`;const bV=Oj;let Uk=0;var TT=({id:t,action:e,payload:n={}})=>{let r=t;return typeof r>"u"&&(r=bV("Job",Uk),Uk+=1),{id:r,action:e,payload:n}},Qd={};let Lj=!1;Qd.logging=Lj;Qd.setLogging=t=>{Lj=t};Qd.log=(...t)=>Lj?console.log.apply(void 0,t):null;const jV=TT,{log:Om}=Qd,NV=Oj;let qk=0;var SV=()=>{const t=NV("Scheduler",qk),e={},n={};let r=[];qk+=1;const a=()=>r.length,i=()=>Object.keys(e).length,o=()=>{if(r.length!==0){const f=Object.keys(e);for(let p=0;p<f.length;p+=1)if(typeof n[f[p]]>"u"){r[0](e[f[p]]);break}}},c=(f,p)=>new Promise((x,j)=>{const v=jV({action:f,payload:p});r.push(async _=>{r.shift(),n[_.id]=v;try{x(await _[f].apply(void 0,[...p,v.id]))}catch(b){j(b)}finally{delete n[_.id],o()}}),Om(`[${t}]: Add ${v.id} to JobQueue`),Om(`[${t}]: JobQueue length=${r.length}`),o()});return{addWorker:f=>(e[f.id]=f,Om(`[${t}]: Add ${f.id}`),Om(`[${t}]: Number of workers=${i()}`),o(),f.id),addJob:async(f,...p)=>{if(i()===0)throw Error(`[${t}]: You need to have at least one worker before adding jobs`);return c(f,p)},terminate:async()=>{Object.keys(e).forEach(async f=>{await e[f].terminate()}),r=[]},getQueueLen:a,getNumWorkers:i}},kV=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof ET=="function"&&(e.type="node"),typeof t>"u"?e:e[t]};const CV=kV("type")==="browser",EV=CV?t=>new URL(t,window.location.href).href:t=>t;var AV=t=>{const e={...t};return["corePath","workerPath","langPath"].forEach(n=>{t[n]&&(e[n]=EV(e[n]))}),e},MT={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const PV="tesseract.js",DV="6.0.1",TV="Pure Javascript Multilingual OCR",MV="src/index.js",RV="commonjs",IV="src/index.d.ts",OV="dist/tesseract.min.js",LV="dist/tesseract.min.js",FV={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser test:node:all","test:browser":"karma start karma.conf.js","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.mjs","test:node:all":"npm run test:node -- ./tests/*.test.mjs",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},BV={"./src/worker/node/index.js":"./src/worker/browser/index.js"},zV="",$V=["jeromewu"],UV="Apache-2.0",qV={"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","npm-run-all":"^4.1.5",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-webpack":"^5.0.0",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},WV={"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^6.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},HV={"@rollup/pluginutils":"^5.0.2"},VV={type:"git",url:"https://github.com/naptha/tesseract.js.git"},KV={url:"https://github.com/naptha/tesseract.js/issues"},ZV="https://github.com/naptha/tesseract.js",GV={type:"opencollective",url:"https://opencollective.com/tesseractjs"},QV={name:PV,version:DV,description:TV,main:MV,type:RV,types:IV,unpkg:OV,jsdelivr:LV,scripts:FV,browser:BV,author:zV,contributors:$V,license:UV,devDependencies:qV,dependencies:WV,overrides:HV,repository:VV,bugs:KV,homepage:ZV,collective:GV};var YV={workerBlobURL:!0,logger:()=>{}};const XV=QV.version,JV=YV;var eK={...JV,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${XV}/dist/worker.min.js`},tK=({workerPath:t,workerBlobURL:e})=>{let n;if(Blob&&URL&&e){const r=new Blob([`importScripts("${t}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(r))}else n=new Worker(t);return n},nK=t=>{t.terminate()},sK=(t,e)=>{t.onmessage=({data:n})=>{e(n)}},rK=async(t,e)=>{t.postMessage(e)};const ey=t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{e(r.result)},r.onerror=({target:{error:{code:a}}})=>{n(Error(`File could not be read! Code=${a}`))},r.readAsArrayBuffer(t)}),_w=async t=>{let e=t;if(typeof t>"u")return"undefined";if(typeof t=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t)?e=atob(t.split(",")[1]).split("").map(n=>n.charCodeAt(0)):e=await(await fetch(t)).arrayBuffer();else if(typeof HTMLElement<"u"&&t instanceof HTMLElement)t.tagName==="IMG"&&(e=await _w(t.src)),t.tagName==="VIDEO"&&(e=await _w(t.poster)),t.tagName==="CANVAS"&&await new Promise(n=>{t.toBlob(async r=>{e=await ey(r),n()})});else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){const n=await t.convertToBlob();e=await ey(n)}else(t instanceof File||t instanceof Blob)&&(e=await ey(t));return new Uint8Array(e)};var aK=_w;const iK=eK,oK=tK,lK=nK,cK=sK,dK=rK,uK=aK;var hK={defaultOptions:iK,spawnWorker:oK,terminateWorker:lK,onMessage:cK,send:dK,loadImage:uK};const fK=AV,wa=TT,{log:Wk}=Qd,mK=Oj,Xo=MT,{defaultOptions:pK,spawnWorker:gK,terminateWorker:xK,onMessage:vK,loadImage:Hk,send:yK}=hK;let Vk=0;var RT=async(t="eng",e=Xo.LSTM_ONLY,n={},r={})=>{const a=mK("Worker",Vk),{logger:i,errorHandler:o,...c}=fK({...pK,...n}),d={},u=typeof t=="string"?t.split("+"):t;let m=e,f=r;const p=[Xo.DEFAULT,Xo.LSTM_ONLY].includes(e)&&!c.legacyCore;let x,j;const v=new Promise((G,I)=>{j=G,x=I}),_=G=>{x(G.message)};let b=gK(c);b.onerror=_,Vk+=1;const w=({id:G,action:I,payload:V})=>new Promise(($,F)=>{Wk(`[${a}]: Start ${G}, action=${I}`);const O=`${I}-${G}`;d[O]={resolve:$,reject:F},yK(b,{workerId:a,jobId:G,action:I,payload:V})}),N=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),S=G=>w(wa({id:G,action:"load",payload:{options:{lstmOnly:p,corePath:c.corePath,logging:c.logging}}})),C=(G,I,V)=>w(wa({id:V,action:"FS",payload:{method:"writeFile",args:[G,I]}})),A=(G,I)=>w(wa({id:I,action:"FS",payload:{method:"readFile",args:[G,{encoding:"utf8"}]}})),P=(G,I)=>w(wa({id:I,action:"FS",payload:{method:"unlink",args:[G]}})),M=(G,I,V)=>w(wa({id:V,action:"FS",payload:{method:G,args:I}})),z=(G,I)=>w(wa({id:I,action:"loadLanguage",payload:{langs:G,options:{langPath:c.langPath,dataPath:c.dataPath,cachePath:c.cachePath,cacheMethod:c.cacheMethod,gzip:c.gzip,lstmOnly:[Xo.DEFAULT,Xo.LSTM_ONLY].includes(m)&&!c.legacyLang}}})),R=(G,I,V,$)=>w(wa({id:$,action:"initialize",payload:{langs:G,oem:I,config:V}})),D=(G="eng",I,V,$)=>{if(p&&[Xo.TESSERACT_ONLY,Xo.TESSERACT_LSTM_COMBINED].includes(I))throw Error("Legacy model requested but code missing.");const F=I||m;m=F;const O=V||f;f=O;const U=(typeof G=="string"?G.split("+"):G).filter(te=>!u.includes(te));return u.push(...U),U.length>0?z(U,$).then(()=>R(G,F,O,$)):R(G,F,O,$)},B=(G={},I)=>w(wa({id:I,action:"setParameters",payload:{params:G}})),W=async(G,I={},V={text:!0},$)=>w(wa({id:$,action:"recognize",payload:{image:await Hk(G),options:I,output:V}})),X=async(G,I)=>{if(p)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return w(wa({id:I,action:"detect",payload:{image:await Hk(G)}}))},ue=async()=>(b!==null&&(xK(b),b=null),Promise.resolve());vK(b,({workerId:G,jobId:I,status:V,action:$,data:F})=>{const O=`${$}-${I}`;if(V==="resolve")Wk(`[${G}]: Complete ${I}`),d[O].resolve({jobId:I,data:F}),delete d[O];else if(V==="reject")if(d[O].reject(F),delete d[O],$==="load"&&x(F),o)o(F);else throw Error(F);else V==="progress"&&i({...F,userJobId:I})});const de={id:a,worker:b,load:N,writeText:C,readText:A,removeFile:P,FS:M,reinitialize:D,setParameters:B,recognize:W,detect:X,terminate:ue};return S().then(()=>z(t)).then(()=>R(t,e,r)).then(()=>j(de)).catch(()=>{}),v};const IT=RT,_K=async(t,e,n)=>{const r=await IT(e,1,n);return r.recognize(t).finally(async()=>{await r.terminate()})},wK=async(t,e)=>{const n=await IT("osd",0,e);return n.detect(t).finally(async()=>{await n.terminate()})};var bK={recognize:_K,detect:wK},jK={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},NK={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const SK=SV,kK=RT,CK=bK,EK=jK,AK=MT,PK=NK,{setLogging:DK}=Qd;var Kk={languages:EK,OEM:AK,PSM:PK,createScheduler:SK,createWorker:kK,setLogging:DK,...CK};function kt(t,e,n,r,a){if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function xe(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}let OT=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return OT=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};function ww(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const bw=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class wt extends Error{}class ps extends wt{constructor(e,n,r,a){super(`${ps.makeMessage(e,n,r)}`),this.status=e,this.headers=a,this.requestID=a==null?void 0:a.get("x-request-id"),this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,n,r,a){if(!e||!a)return new Dg({message:r,cause:bw(n)});const i=n==null?void 0:n.error;return e===400?new LT(e,i,r,a):e===401?new FT(e,i,r,a):e===403?new BT(e,i,r,a):e===404?new zT(e,i,r,a):e===409?new $T(e,i,r,a):e===422?new UT(e,i,r,a):e===429?new qT(e,i,r,a):e>=500?new WT(e,i,r,a):new ps(e,i,r,a)}}class Dr extends ps{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Dg extends ps{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class Fj extends Dg{constructor({message:e}={}){super({message:e??"Request timed out."})}}class LT extends ps{}class FT extends ps{}class BT extends ps{}class zT extends ps{}class $T extends ps{}class UT extends ps{}class qT extends ps{}class WT extends ps{}class HT extends wt{constructor(){super("Could not parse response content as the length limit was reached")}}class VT extends wt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Ou extends Error{constructor(e){super(e)}}const TK=/^[a-z][a-z0-9+.-]*:/i,MK=t=>TK.test(t);let Hs=t=>(Hs=Array.isArray,Hs(t)),Zk=Hs;function KT(t){return typeof t!="object"?{}:t??{}}function RK(t){if(!t)return!0;for(const e in t)return!1;return!0}function IK(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ty(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const OK=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new wt(`${t} must be an integer`);if(e<0)throw new wt(`${t} must be a positive integer`);return e},LK=t=>{try{return JSON.parse(t)}catch{return}},kf=t=>new Promise(e=>setTimeout(e,t)),Sc="5.16.0",FK=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function BK(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const zK=()=>{var n;const t=BK();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Sc,"X-Stainless-OS":Qk(Deno.build.os),"X-Stainless-Arch":Gk(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((n=Deno.version)==null?void 0:n.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Sc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Sc,"X-Stainless-OS":Qk(globalThis.process.platform??"unknown"),"X-Stainless-Arch":Gk(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=$K();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Sc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Sc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function $K(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${a}.${i}.${o}`}}}return null}const Gk=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Qk=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Yk;const UK=()=>Yk??(Yk=zK());function qK(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function ZT(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function GT(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return ZT({start(){},async pull(n){const{done:r,value:a}=await e.next();r?n.close():n.enqueue(a)},async cancel(){var n;await((n=e.return)==null?void 0:n.call(e))}})}function QT(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function WK(t){var r,a;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((a=(r=t[Symbol.asyncIterator]()).return)==null?void 0:a.call(r));return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const HK=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),YT="RFC3986",XT=t=>String(t),Xk={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:XT},VK="RFC1738";let jw=(t,e)=>(jw=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),jw(t,e));const ba=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),ny=1024,KK=(t,e,n,r,a)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});let o="";for(let c=0;c<i.length;c+=ny){const d=i.length>=ny?i.slice(c,c+ny):i,u=[];for(let m=0;m<d.length;++m){let f=d.charCodeAt(m);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||a===VK&&(f===40||f===41)){u[u.length]=d.charAt(m);continue}if(f<128){u[u.length]=ba[f];continue}if(f<2048){u[u.length]=ba[192|f>>6]+ba[128|f&63];continue}if(f<55296||f>=57344){u[u.length]=ba[224|f>>12]+ba[128|f>>6&63]+ba[128|f&63];continue}m+=1,f=65536+((f&1023)<<10|d.charCodeAt(m)&1023),u[u.length]=ba[240|f>>18]+ba[128|f>>12&63]+ba[128|f>>6&63]+ba[128|f&63]}o+=u.join("")}return o};function ZK(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function Jk(t,e){if(Hs(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const JT={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},eM=function(t,e){Array.prototype.push.apply(t,Hs(e)?e:[e])};let eC;const Hn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:KK,encodeValuesOnly:!1,format:YT,formatter:XT,indices:!1,serializeDate(t){return(eC??(eC=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function GK(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const sy={};function tM(t,e,n,r,a,i,o,c,d,u,m,f,p,x,j,v,_,b){let w=t,N=b,S=0,C=!1;for(;(N=N.get(sy))!==void 0&&!C;){const R=N.get(t);if(S+=1,typeof R<"u"){if(R===S)throw new RangeError("Cyclic object value");C=!0}typeof N.get(sy)>"u"&&(S=0)}if(typeof u=="function"?w=u(e,w):w instanceof Date?w=p==null?void 0:p(w):n==="comma"&&Hs(w)&&(w=Jk(w,function(R){return R instanceof Date?p==null?void 0:p(R):R})),w===null){if(i)return d&&!v?d(e,Hn.encoder,_,"key",x):e;w=""}if(GK(w)||ZK(w)){if(d){const R=v?e:d(e,Hn.encoder,_,"key",x);return[(j==null?void 0:j(R))+"="+(j==null?void 0:j(d(w,Hn.encoder,_,"value",x)))]}return[(j==null?void 0:j(e))+"="+(j==null?void 0:j(String(w)))]}const A=[];if(typeof w>"u")return A;let P;if(n==="comma"&&Hs(w))v&&d&&(w=Jk(w,d)),P=[{value:w.length>0?w.join(",")||null:void 0}];else if(Hs(u))P=u;else{const R=Object.keys(w);P=m?R.sort(m):R}const M=c?String(e).replace(/\./g,"%2E"):String(e),z=r&&Hs(w)&&w.length===1?M+"[]":M;if(a&&Hs(w)&&w.length===0)return z+"[]";for(let R=0;R<P.length;++R){const D=P[R],B=typeof D=="object"&&typeof D.value<"u"?D.value:w[D];if(o&&B===null)continue;const W=f&&c?D.replace(/\./g,"%2E"):D,X=Hs(w)?typeof n=="function"?n(z,W):z:z+(f?"."+W:"["+W+"]");b.set(t,S);const ue=new WeakMap;ue.set(sy,b),eM(A,tM(B,X,n,r,a,i,o,c,n==="comma"&&v&&Hs(w)?null:d,u,m,f,p,x,j,v,_,ue))}return A}function QK(t=Hn){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Hn.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=YT;if(typeof t.format<"u"){if(!jw(Xk,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=Xk[n];let a=Hn.filter;(typeof t.filter=="function"||Hs(t.filter))&&(a=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in JT?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=Hn.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Hn.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Hn.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Hn.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Hn.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Hn.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Hn.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Hn.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Hn.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Hn.encodeValuesOnly,filter:a,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Hn.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Hn.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Hn.strictNullHandling}}function YK(t,e={}){let n=t;const r=QK(e);let a,i;typeof r.filter=="function"?(i=r.filter,n=i("",n)):Hs(r.filter)&&(i=r.filter,a=i);const o=[];if(typeof n!="object"||n===null)return"";const c=JT[r.arrayFormat],d=c==="comma"&&r.commaRoundTrip;a||(a=Object.keys(n)),r.sort&&a.sort(r.sort);const u=new WeakMap;for(let p=0;p<a.length;++p){const x=a[p];r.skipNulls&&n[x]===null||eM(o,tM(n[x],x,c,d,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}const m=o.join(r.delimiter);let f=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),m.length>0?f+m:""}function XK(t){let e=0;for(const a of t)e+=a.length;const n=new Uint8Array(e);let r=0;for(const a of t)n.set(a,r),r+=a.length;return n}let tC;function Bj(t){let e;return(tC??(e=new globalThis.TextEncoder,tC=e.encode.bind(e)))(t)}let nC;function sC(t){let e;return(nC??(e=new globalThis.TextDecoder,nC=e.decode.bind(e)))(t)}var er,tr;class Tg{constructor(){er.set(this,void 0),tr.set(this,void 0),kt(this,er,new Uint8Array),kt(this,tr,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Bj(e):e;kt(this,er,XK([xe(this,er,"f"),n]));const r=[];let a;for(;(a=JK(xe(this,er,"f"),xe(this,tr,"f")))!=null;){if(a.carriage&&xe(this,tr,"f")==null){kt(this,tr,a.index);continue}if(xe(this,tr,"f")!=null&&(a.index!==xe(this,tr,"f")+1||a.carriage)){r.push(sC(xe(this,er,"f").subarray(0,xe(this,tr,"f")-1))),kt(this,er,xe(this,er,"f").subarray(xe(this,tr,"f"))),kt(this,tr,null);continue}const i=xe(this,tr,"f")!==null?a.preceding-1:a.preceding,o=sC(xe(this,er,"f").subarray(0,i));r.push(o),kt(this,er,xe(this,er,"f").subarray(a.index)),kt(this,tr,null)}return r}flush(){return xe(this,er,"f").length?this.decode(`
`):[]}}er=new WeakMap,tr=new WeakMap;Tg.NEWLINE_CHARS=new Set([`
`,"\r"]);Tg.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function JK(t,e){for(let a=e??0;a<t.length;a++){if(t[a]===10)return{preceding:a,index:a+1,carriage:!1};if(t[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function eZ(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}const v0={off:0,error:200,warn:300,info:400,debug:500},rC=(t,e,n)=>{if(t){if(IK(v0,t))return t;os(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(v0))}`)}};function Lu(){}function Lm(t,e,n){return!e||v0[t]>v0[n]?Lu:e[t].bind(e)}const tZ={error:Lu,warn:Lu,info:Lu,debug:Lu};let aC=new WeakMap;function os(t){const e=t.logger,n=t.logLevel??"off";if(!e)return tZ;const r=aC.get(e);if(r&&r[0]===n)return r[1];const a={error:Lm("error",e,n),warn:Lm("warn",e,n),info:Lm("info",e,n),debug:Lm("debug",e,n)};return aC.set(e,[n,a]),a}const nl=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var Nu;class Ra{constructor(e,n,r){this.iterator=e,Nu.set(this,void 0),this.controller=n,kt(this,Nu,r)}static fromSSEResponse(e,n,r){let a=!1;const i=r?os(r):console;async function*o(){if(a)throw new wt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let c=!1;try{for await(const d of nZ(e,n))if(!c){if(d.data.startsWith("[DONE]")){c=!0;continue}if(d.event===null||!d.event.startsWith("thread.")){let u;try{u=JSON.parse(d.data)}catch(m){throw i.error("Could not parse message into JSON:",d.data),i.error("From chunk:",d.raw),m}if(u&&u.error)throw new ps(void 0,u.error,void 0,e.headers);yield u}else{let u;try{u=JSON.parse(d.data)}catch(m){throw console.error("Could not parse message into JSON:",d.data),console.error("From chunk:",d.raw),m}if(d.event=="error")throw new ps(void 0,u.error,u.message,void 0);yield{event:d.event,data:u}}}c=!0}catch(d){if(ww(d))return;throw d}finally{c||n.abort()}}return new Ra(o,n,r)}static fromReadableStream(e,n,r){let a=!1;async function*i(){const c=new Tg,d=QT(e);for await(const u of d)for(const m of c.decode(u))yield m;for(const u of c.flush())yield u}async function*o(){if(a)throw new wt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let c=!1;try{for await(const d of i())c||d&&(yield JSON.parse(d));c=!0}catch(d){if(ww(d))return;throw d}finally{c||n.abort()}}return new Ra(o,n,r)}[(Nu=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),a=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),n.push(o)}return i.shift()}});return[new Ra(()=>a(e),this.controller,xe(this,Nu,"f")),new Ra(()=>a(n),this.controller,xe(this,Nu,"f"))]}toReadableStream(){const e=this;let n;return ZT({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:a,done:i}=await n.next();if(i)return r.close();const o=Bj(JSON.stringify(a)+`
`);r.enqueue(o)}catch(a){r.error(a)}},async cancel(){var r;await((r=n.return)==null?void 0:r.call(n))}})}}async function*nZ(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new wt("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new wt("Attempted to iterate over a response with no body");const n=new rZ,r=new Tg,a=QT(t.body);for await(const i of sZ(a))for(const o of r.decode(i)){const c=n.decode(o);c&&(yield c)}for(const i of r.flush()){const o=n.decode(i);o&&(yield o)}}async function*sZ(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?Bj(n):n;let a=new Uint8Array(e.length+r.length);a.set(e),a.set(r,e.length),e=a;let i;for(;(i=eZ(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class rZ{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,a]=aZ(e,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}function aZ(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function nM(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:a,startTime:i}=e,o=await(async()=>{var f;if(e.options.stream)return os(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Ra.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const c=n.headers.get("content-type"),d=(f=c==null?void 0:c.split(";")[0])==null?void 0:f.trim();if((d==null?void 0:d.includes("application/json"))||(d==null?void 0:d.endsWith("+json"))){const p=await n.json();return sM(p,n)}return await n.text()})();return os(t).debug(`[${r}] response parsed`,nl({retryOfRequestLogID:a,url:n.url,status:n.status,body:o,durationMs:Date.now()-i})),o}function sM(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var Fu;class Mg extends Promise{constructor(e,n,r=nM){super(a=>{a(null)}),this.responsePromise=n,this.parseResponse=r,Fu.set(this,void 0),kt(this,Fu,e)}_thenUnwrap(e){return new Mg(xe(this,Fu,"f"),this.responsePromise,async(n,r)=>sM(e(await this.parseResponse(n,r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(xe(this,Fu,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}Fu=new WeakMap;var Fm;class zj{constructor(e,n,r,a){Fm.set(this,void 0),kt(this,Fm,e),this.options=a,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new wt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await xe(this,Fm,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Fm=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class iZ extends Mg{constructor(e,n,r){super(e,n,async(a,i)=>new r(a,i.response,await nM(a,i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class Rg extends zj{constructor(e,n,r,a){super(e,n,r,a),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class zn extends zj{constructor(e,n,r,a){super(e,n,r,a),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var r;const e=this.getPaginatedItems(),n=(r=e[e.length-1])==null?void 0:r.id;return n?{...this.options,query:{...KT(this.options.query),after:n}}:null}}class oZ extends zj{constructor(e,n,r,a){super(e,n,r,a),this.data=r.data||[],this.has_more=r.has_more||!1,this.last_id=r.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...KT(this.options.query),after:e}}:null}}const rM=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)==null?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function uh(t,e,n){return rM(),new File(t,e??"unknown_file",n)}function pp(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const aM=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",Fl=async(t,e)=>({...t,body:await cZ(t.body,e)}),iC=new WeakMap;function lZ(t){const e=typeof t=="function"?t:t.fetch,n=iC.get(e);if(n)return n;const r=(async()=>{try{const a="Response"in e?e.Response:(await e("data:,")).constructor,i=new FormData;return i.toString()!==await new a(i).text()}catch{return!0}})();return iC.set(e,r),r}const cZ=async(t,e)=>{if(!await lZ(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([r,a])=>Nw(n,r,a))),n},dZ=t=>t instanceof Blob&&"name"in t,Nw=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,uh([await n.blob()],pp(n)));else if(aM(n))t.append(e,uh([await new Response(GT(n)).blob()],pp(n)));else if(dZ(n))t.append(e,n,pp(n));else if(Array.isArray(n))await Promise.all(n.map(r=>Nw(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>Nw(t,`${e}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},iM=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",uZ=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&iM(t),hZ=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function fZ(t,e,n){if(rM(),t=await t,uZ(t))return t instanceof File?t:uh([await t.arrayBuffer()],t.name);if(hZ(t)){const a=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),uh(await Sw(a),e,n)}const r=await Sw(t);if(e||(e=pp(t)),!(n!=null&&n.type)){const a=r.find(i=>typeof i=="object"&&"type"in i&&i.type);typeof a=="string"&&(n={...n,type:a})}return uh(r,e,n)}async function Sw(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(iM(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(aM(t))for await(const r of t)e.push(...await Sw(r));else{const r=(n=t==null?void 0:t.constructor)==null?void 0:n.name;throw new Error(`Unexpected data type: ${typeof t}${r?`; constructor: ${r}`:""}${mZ(t)}`)}return e}function mZ(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class jt{constructor(e){this._client=e}}function oM(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const oC=Object.freeze(Object.create(null)),pZ=(t=oM)=>function(n,...r){if(n.length===1)return n[0];let a=!1;const i=[],o=n.reduce((m,f,p)=>{var v;/[?#]/.test(f)&&(a=!0);const x=r[p];let j=(a?encodeURIComponent:t)(""+x);return p!==r.length&&(x==null||typeof x=="object"&&x.toString===((v=Object.getPrototypeOf(Object.getPrototypeOf(x.hasOwnProperty??oC)??oC))==null?void 0:v.toString))&&(j=x+"",i.push({start:m.length+f.length,length:j.length,error:`Value of type ${Object.prototype.toString.call(x).slice(8,-1)} is not a valid path parameter`})),m+f+(p===r.length?"":j)},""),c=o.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let u;for(;(u=d.exec(c))!==null;)i.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(i.sort((m,f)=>m.start-f.start),i.length>0){let m=0;const f=i.reduce((p,x)=>{const j=" ".repeat(x.start-m),v="^".repeat(x.length);return m=x.start+x.length,p+j+v},"");throw new wt(`Path parameters result in path with invalid segments:
${i.map(p=>p.error).join(`
`)}
${o}
${f}`)}return o},ze=pZ(oM);let lM=class extends jt{list(e,n={},r){return this._client.getAPIList(ze`/chat/completions/${e}/messages`,zn,{query:n,...r})}};function y0(t){return t!==void 0&&"function"in t&&t.function!==void 0}function $j(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function Cf(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function gZ(t,e){return!e||!cM(e)?{...t,choices:t.choices.map(n=>(dM(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:Uj(t,e)}function Uj(t,e){const n=t.choices.map(r=>{var a;if(r.finish_reason==="length")throw new HT;if(r.finish_reason==="content_filter")throw new VT;return dM(r.message.tool_calls),{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((a=r.message.tool_calls)==null?void 0:a.map(i=>vZ(e,i)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?xZ(e,r.message.content):null}}});return{...t,choices:n}}function xZ(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function vZ(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(a=>{var i;return y0(a)&&((i=a.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Cf(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function yZ(t,e){var r;if(!t||!("tools"in t)||!t.tools)return!1;const n=(r=t.tools)==null?void 0:r.find(a=>{var i;return y0(a)&&((i=a.function)==null?void 0:i.name)===e.function.name});return y0(n)&&(Cf(n)||(n==null?void 0:n.function.strict)||!1)}function cM(t){var e;return $j(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>Cf(n)||n.type==="function"&&n.function.strict===!0))??!1}function dM(t){for(const e of t||[])if(e.type!=="function")throw new wt(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function _Z(t){for(const e of t??[]){if(e.type!=="function")throw new wt(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new wt(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const _0=t=>(t==null?void 0:t.role)==="assistant",uM=t=>(t==null?void 0:t.role)==="tool";var kw,gp,xp,Bu,zu,vp,$u,oi,Uu,w0,b0,kc,hM;class qj{constructor(){kw.add(this),this.controller=new AbortController,gp.set(this,void 0),xp.set(this,()=>{}),Bu.set(this,()=>{}),zu.set(this,void 0),vp.set(this,()=>{}),$u.set(this,()=>{}),oi.set(this,{}),Uu.set(this,!1),w0.set(this,!1),b0.set(this,!1),kc.set(this,!1),kt(this,gp,new Promise((e,n)=>{kt(this,xp,e,"f"),kt(this,Bu,n,"f")})),kt(this,zu,new Promise((e,n)=>{kt(this,vp,e,"f"),kt(this,$u,n,"f")})),xe(this,gp,"f").catch(()=>{}),xe(this,zu,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},xe(this,kw,"m",hM).bind(this))},0)}_connected(){this.ended||(xe(this,xp,"f").call(this),this._emit("connect"))}get ended(){return xe(this,Uu,"f")}get errored(){return xe(this,w0,"f")}get aborted(){return xe(this,b0,"f")}abort(){this.controller.abort()}on(e,n){return(xe(this,oi,"f")[e]||(xe(this,oi,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=xe(this,oi,"f")[e];if(!r)return this;const a=r.findIndex(i=>i.listener===n);return a>=0&&r.splice(a,1),this}once(e,n){return(xe(this,oi,"f")[e]||(xe(this,oi,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{kt(this,kc,!0),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){kt(this,kc,!0),await xe(this,zu,"f")}_emit(e,...n){if(xe(this,Uu,"f"))return;e==="end"&&(kt(this,Uu,!0),xe(this,vp,"f").call(this));const r=xe(this,oi,"f")[e];if(r&&(xe(this,oi,"f")[e]=r.filter(a=>!a.once),r.forEach(({listener:a})=>a(...n))),e==="abort"){const a=n[0];!xe(this,kc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),xe(this,Bu,"f").call(this,a),xe(this,$u,"f").call(this,a),this._emit("end");return}if(e==="error"){const a=n[0];!xe(this,kc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),xe(this,Bu,"f").call(this,a),xe(this,$u,"f").call(this,a),this._emit("end")}}_emitFinal(){}}gp=new WeakMap,xp=new WeakMap,Bu=new WeakMap,zu=new WeakMap,vp=new WeakMap,$u=new WeakMap,oi=new WeakMap,Uu=new WeakMap,w0=new WeakMap,b0=new WeakMap,kc=new WeakMap,kw=new WeakSet,hM=function(e){if(kt(this,w0,!0),e instanceof Error&&e.name==="AbortError"&&(e=new Dr),e instanceof Dr)return kt(this,b0,!0),this._emit("abort",e);if(e instanceof wt)return this._emit("error",e);if(e instanceof Error){const n=new wt(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new wt(String(e)))};function wZ(t){return typeof t.parse=="function"}var Es,Cw,j0,Ew,Aw,Pw,fM,mM;const bZ=10;class pM extends qj{constructor(){super(...arguments),Es.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),uM(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(_0(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionToolCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new wt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),xe(this,Es,"m",Cw).call(this)}async finalMessage(){return await this.done(),xe(this,Es,"m",j0).call(this)}async finalFunctionToolCall(){return await this.done(),xe(this,Es,"m",Ew).call(this)}async finalFunctionToolCallResult(){return await this.done(),xe(this,Es,"m",Aw).call(this)}async totalUsage(){return await this.done(),xe(this,Es,"m",Pw).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=xe(this,Es,"m",j0).call(this);n&&this._emit("finalMessage",n);const r=xe(this,Es,"m",Cw).call(this);r&&this._emit("finalContent",r);const a=xe(this,Es,"m",Ew).call(this);a&&this._emit("finalFunctionToolCall",a);const i=xe(this,Es,"m",Aw).call(this);i!=null&&this._emit("finalFunctionToolCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",xe(this,Es,"m",Pw).call(this))}async _createChatCompletion(e,n,r){const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),xe(this,Es,"m",fM).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Uj(i,n))}async _runChatCompletion(e,n,r){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(e,n,r)}async _runTools(e,n,r){var x,j,v;const a="tool",{tool_choice:i="auto",stream:o,...c}=n,d=typeof i!="string"&&i.type==="function"&&((x=i==null?void 0:i.function)==null?void 0:x.name),{maxChatCompletions:u=bZ}=r||{},m=n.tools.map(_=>{if(Cf(_)){if(!_.$callback)throw new wt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:_.$callback,name:_.function.name,description:_.function.description||"",parameters:_.function.parameters,parse:_.$parseRaw,strict:!0}}}return _}),f={};for(const _ of m)_.type==="function"&&(f[_.function.name||_.function.function.name]=_.function);const p="tools"in n?m.map(_=>_.type==="function"?{type:"function",function:{name:_.function.name||_.function.function.name,parameters:_.function.parameters,description:_.function.description,strict:_.function.strict}}:_):void 0;for(const _ of n.messages)this._addMessage(_,!1);for(let _=0;_<u;++_){const w=(j=(await this._createChatCompletion(e,{...c,tool_choice:i,tools:p,messages:[...this.messages]},r)).choices[0])==null?void 0:j.message;if(!w)throw new wt("missing message in ChatCompletion response");if(!((v=w.tool_calls)!=null&&v.length))return;for(const N of w.tool_calls){if(N.type!=="function")continue;const S=N.id,{name:C,arguments:A}=N.function,P=f[C];if(P){if(d&&d!==C){const D=`Invalid tool_call: ${JSON.stringify(C)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:a,tool_call_id:S,content:D});continue}}else{const D=`Invalid tool_call: ${JSON.stringify(C)}. Available options are: ${Object.keys(f).map(B=>JSON.stringify(B)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:S,content:D});continue}let M;try{M=wZ(P)?await P.parse(A):A}catch(D){const B=D instanceof Error?D.message:String(D);this._addMessage({role:a,tool_call_id:S,content:B});continue}const z=await P.function(M,this),R=xe(this,Es,"m",mM).call(this,z);if(this._addMessage({role:a,tool_call_id:S,content:R}),d)return}}}}Es=new WeakSet,Cw=function(){return xe(this,Es,"m",j0).call(this).content??null},j0=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(_0(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new wt("stream ended without producing a ChatCompletionMessage with role=assistant")},Ew=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const a=this.messages[r];if(_0(a)&&((e=a==null?void 0:a.tool_calls)!=null&&e.length))return(n=a.tool_calls.filter(i=>i.type==="function").at(-1))==null?void 0:n.function}},Aw=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(uM(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var a;return r.role==="assistant"&&((a=r.tool_calls)==null?void 0:a.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},Pw=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},fM=function(e){if(e.n!=null&&e.n>1)throw new wt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},mM=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Wj extends pM{static runTools(e,n,r){const a=new Wj,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,i)),a}_addMessage(e,n=!0){super._addMessage(e,n),_0(e)&&e.content&&this._emit("content",e.content)}}const gM=1,xM=2,vM=4,yM=8,_M=16,wM=32,bM=64,jM=128,NM=256,SM=jM|NM,kM=_M|wM|SM|bM,CM=gM|xM|kM,EM=vM|yM,jZ=CM|EM,Yn={STR:gM,NUM:xM,ARR:vM,OBJ:yM,NULL:_M,BOOL:wM,NAN:bM,INFINITY:jM,MINUS_INFINITY:NM,INF:SM,SPECIAL:kM,ATOM:CM,COLLECTION:EM,ALL:jZ};class NZ extends Error{}class SZ extends Error{}function kZ(t,e=Yn.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return CZ(t.trim(),e)}const CZ=(t,e)=>{const n=t.length;let r=0;const a=p=>{throw new NZ(`${p} at position ${r}`)},i=p=>{throw new SZ(`${p} at position ${r}`)},o=()=>(f(),r>=n&&a("Unexpected end of input"),t[r]==='"'?c():t[r]==="{"?d():t[r]==="["?u():t.substring(r,r+4)==="null"||Yn.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||Yn.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||Yn.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||Yn.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||Yn.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||Yn.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):m()),c=()=>{const p=r;let x=!1;for(r++;r<n&&(t[r]!=='"'||x&&t[r-1]==="\\");)x=t[r]==="\\"?!x:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(p,++r-Number(x)))}catch(j){i(String(j))}else if(Yn.STR&e)try{return JSON.parse(t.substring(p,r-Number(x))+'"')}catch{return JSON.parse(t.substring(p,t.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},d=()=>{r++,f();const p={};try{for(;t[r]!=="}";){if(f(),r>=n&&Yn.OBJ&e)return p;const x=c();f(),r++;try{const j=o();Object.defineProperty(p,x,{value:j,writable:!0,enumerable:!0,configurable:!0})}catch(j){if(Yn.OBJ&e)return p;throw j}f(),t[r]===","&&r++}}catch{if(Yn.OBJ&e)return p;a("Expected '}' at end of object")}return r++,p},u=()=>{r++;const p=[];try{for(;t[r]!=="]";)p.push(o()),f(),t[r]===","&&r++}catch{if(Yn.ARR&e)return p;a("Expected ']' at end of array")}return r++,p},m=()=>{if(r===0){t==="-"&&Yn.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t)}catch(x){if(Yn.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(x))}}const p=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(Yn.NUM&e)&&a("Unterminated number literal");try{return JSON.parse(t.substring(p,r))}catch{t.substring(p,r)==="-"&&Yn.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t.substring(p,t.lastIndexOf("e")))}catch(j){i(String(j))}}},f=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return o()},lC=t=>kZ(t,Yn.ALL^Yn.NUM);var Wn,ni,mc,Fi,ry,Bm,ay,iy,oy,zm,ly,cC;class Xh extends pM{constructor(e){super(),Wn.add(this),ni.set(this,void 0),mc.set(this,void 0),Fi.set(this,void 0),kt(this,ni,e),kt(this,mc,[])}get currentChatCompletionSnapshot(){return xe(this,Fi,"f")}static fromReadableStream(e){const n=new Xh(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const a=new Xh(n);return a._run(()=>a._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(e,n,r){var o;super._createChatCompletion;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),xe(this,Wn,"m",ry).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const c of i)xe(this,Wn,"m",ay).call(this,c);if((o=i.controller.signal)!=null&&o.aborted)throw new Dr;return this._addChatCompletion(xe(this,Wn,"m",zm).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),xe(this,Wn,"m",ry).call(this),this._connected();const a=Ra.fromReadableStream(e,this.controller);let i;for await(const c of a)i&&i!==c.id&&this._addChatCompletion(xe(this,Wn,"m",zm).call(this)),xe(this,Wn,"m",ay).call(this,c),i=c.id;if((o=a.controller.signal)!=null&&o.aborted)throw new Dr;return this._addChatCompletion(xe(this,Wn,"m",zm).call(this))}[(ni=new WeakMap,mc=new WeakMap,Fi=new WeakMap,Wn=new WeakSet,ry=function(){this.ended||kt(this,Fi,void 0)},Bm=function(n){let r=xe(this,mc,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},xe(this,mc,"f")[n.index]=r,r)},ay=function(n){var a,i,o,c,d,u,m,f,p,x,j,v,_,b,w;if(this.ended)return;const r=xe(this,Wn,"m",cC).call(this,n);this._emit("chunk",n,r);for(const N of n.choices){const S=r.choices[N.index];N.delta.content!=null&&((a=S.message)==null?void 0:a.role)==="assistant"&&((i=S.message)!=null&&i.content)&&(this._emit("content",N.delta.content,S.message.content),this._emit("content.delta",{delta:N.delta.content,snapshot:S.message.content,parsed:S.message.parsed})),N.delta.refusal!=null&&((o=S.message)==null?void 0:o.role)==="assistant"&&((c=S.message)!=null&&c.refusal)&&this._emit("refusal.delta",{delta:N.delta.refusal,snapshot:S.message.refusal}),((d=N.logprobs)==null?void 0:d.content)!=null&&((u=S.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(m=N.logprobs)==null?void 0:m.content,snapshot:((f=S.logprobs)==null?void 0:f.content)??[]}),((p=N.logprobs)==null?void 0:p.refusal)!=null&&((x=S.message)==null?void 0:x.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(j=N.logprobs)==null?void 0:j.refusal,snapshot:((v=S.logprobs)==null?void 0:v.refusal)??[]});const C=xe(this,Wn,"m",Bm).call(this,S);S.finish_reason&&(xe(this,Wn,"m",oy).call(this,S),C.current_tool_call_index!=null&&xe(this,Wn,"m",iy).call(this,S,C.current_tool_call_index));for(const A of N.delta.tool_calls??[])C.current_tool_call_index!==A.index&&(xe(this,Wn,"m",oy).call(this,S),C.current_tool_call_index!=null&&xe(this,Wn,"m",iy).call(this,S,C.current_tool_call_index)),C.current_tool_call_index=A.index;for(const A of N.delta.tool_calls??[]){const P=(_=S.message.tool_calls)==null?void 0:_[A.index];P!=null&&P.type&&((P==null?void 0:P.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(b=P.function)==null?void 0:b.name,index:A.index,arguments:P.function.arguments,parsed_arguments:P.function.parsed_arguments,arguments_delta:((w=A.function)==null?void 0:w.arguments)??""}):(P==null||P.type,void 0))}}},iy=function(n,r){var o,c,d;if(xe(this,Wn,"m",Bm).call(this,n).done_tool_calls.has(r))return;const i=(o=n.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const u=(d=(c=xe(this,ni,"f"))==null?void 0:c.tools)==null?void 0:d.find(m=>y0(m)&&m.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:Cf(u)?u.$parseRaw(i.function.arguments):u!=null&&u.function.strict?JSON.parse(i.function.arguments):null})}else i.type},oy=function(n){var a,i;const r=xe(this,Wn,"m",Bm).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const o=xe(this,Wn,"m",ly).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(a=n.logprobs)!=null&&a.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},zm=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");const n=xe(this,Fi,"f");if(!n)throw new wt("request ended without sending any chunks");return kt(this,Fi,void 0),kt(this,mc,[]),EZ(n,xe(this,ni,"f"))},ly=function(){var r;const n=(r=xe(this,ni,"f"))==null?void 0:r.response_format;return $j(n)?n:null},cC=function(n){var r,a,i,o;let c=xe(this,Fi,"f");const{choices:d,...u}=n;c?Object.assign(c,u):c=kt(this,Fi,{...u,choices:[]});for(const{delta:m,finish_reason:f,index:p,logprobs:x=null,...j}of n.choices){let v=c.choices[p];if(v||(v=c.choices[p]={finish_reason:f,index:p,message:{},logprobs:x,...j}),x)if(!v.logprobs)v.logprobs=Object.assign({},x);else{const{content:A,refusal:P,...M}=x;Object.assign(v.logprobs,M),A&&((r=v.logprobs).content??(r.content=[]),v.logprobs.content.push(...A)),P&&((a=v.logprobs).refusal??(a.refusal=[]),v.logprobs.refusal.push(...P))}if(f&&(v.finish_reason=f,xe(this,ni,"f")&&cM(xe(this,ni,"f")))){if(f==="length")throw new HT;if(f==="content_filter")throw new VT}if(Object.assign(v,j),!m)continue;const{content:_,refusal:b,function_call:w,role:N,tool_calls:S,...C}=m;if(Object.assign(v.message,C),b&&(v.message.refusal=(v.message.refusal||"")+b),N&&(v.message.role=N),w&&(v.message.function_call?(w.name&&(v.message.function_call.name=w.name),w.arguments&&((i=v.message.function_call).arguments??(i.arguments=""),v.message.function_call.arguments+=w.arguments)):v.message.function_call=w),_&&(v.message.content=(v.message.content||"")+_,!v.message.refusal&&xe(this,Wn,"m",ly).call(this)&&(v.message.parsed=lC(v.message.content))),S){v.message.tool_calls||(v.message.tool_calls=[]);for(const{index:A,id:P,type:M,function:z,...R}of S){const D=(o=v.message.tool_calls)[A]??(o[A]={});Object.assign(D,R),P&&(D.id=P),M&&(D.type=M),z&&(D.function??(D.function={name:z.name??"",arguments:""})),z!=null&&z.name&&(D.function.name=z.name),z!=null&&z.arguments&&(D.function.arguments+=z.arguments,yZ(xe(this,ni,"f"),D)&&(D.function.parsed_arguments=lC(D.function.arguments)))}}}return c},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Ra(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function EZ(t,e){const{id:n,choices:r,created:a,model:i,system_fingerprint:o,...c}=t,d={...c,id:n,choices:r.map(({message:u,finish_reason:m,index:f,logprobs:p,...x})=>{if(!m)throw new wt(`missing finish_reason for choice ${f}`);const{content:j=null,function_call:v,tool_calls:_,...b}=u,w=u.role;if(!w)throw new wt(`missing role for choice ${f}`);if(v){const{arguments:N,name:S}=v;if(N==null)throw new wt(`missing function_call.arguments for choice ${f}`);if(!S)throw new wt(`missing function_call.name for choice ${f}`);return{...x,message:{content:j,function_call:{arguments:N,name:S},role:w,refusal:u.refusal??null},finish_reason:m,index:f,logprobs:p}}return _?{...x,index:f,finish_reason:m,logprobs:p,message:{...b,role:w,content:j,refusal:u.refusal??null,tool_calls:_.map((N,S)=>{const{function:C,type:A,id:P,...M}=N,{arguments:z,name:R,...D}=C||{};if(P==null)throw new wt(`missing choices[${f}].tool_calls[${S}].id
${$m(t)}`);if(A==null)throw new wt(`missing choices[${f}].tool_calls[${S}].type
${$m(t)}`);if(R==null)throw new wt(`missing choices[${f}].tool_calls[${S}].function.name
${$m(t)}`);if(z==null)throw new wt(`missing choices[${f}].tool_calls[${S}].function.arguments
${$m(t)}`);return{...M,id:P,type:A,function:{...D,name:R,arguments:z}}})}}:{...x,message:{...b,content:j,role:w,refusal:u.refusal??null},finish_reason:m,index:f,logprobs:p}}),created:a,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return gZ(d,e)}function $m(t){return JSON.stringify(t)}class N0 extends Xh{static fromReadableStream(e){const n=new N0(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,r){const a=new N0(n),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,i)),a}}let Hj=class extends jt{constructor(){super(...arguments),this.messages=new lM(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(ze`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(ze`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return this._client.getAPIList("/chat/completions",zn,{query:e,...n})}delete(e,n){return this._client.delete(ze`/chat/completions/${e}`,n)}parse(e,n){return _Z(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(r=>Uj(r,e))}runTools(e,n){return e.stream?N0.runTools(this._client,e,n):Wj.runTools(this._client,e,n)}stream(e,n){return Xh.createChatCompletion(this._client,e,n)}};Hj.Messages=lM;class Vj extends jt{constructor(){super(...arguments),this.completions=new Hj(this._client)}}Vj.Completions=Hj;const AM=Symbol("brand.privateNullableHeaders");function*AZ(t){if(!t)return;if(AM in t){const{values:r,nulls:a}=t;yield*r.entries();for(const i of a)yield[i,null];return}let e=!1,n;t instanceof Headers?n=t.entries():Zk(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const a=r[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const i=Zk(r[1])?r[1]:[r[1]];let o=!1;for(const c of i)c!==void 0&&(e&&!o&&(o=!0,yield[a,null]),yield[a,c])}}const ut=t=>{const e=new Headers,n=new Set;for(const r of t){const a=new Set;for(const[i,o]of AZ(r)){const c=i.toLowerCase();a.has(c)||(e.delete(i),a.add(c)),o===null?(e.delete(i),n.add(c)):(e.append(i,o),n.delete(c))}}return{[AM]:!0,values:e,nulls:n}};class PM extends jt{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:ut([{Accept:"application/octet-stream"},n==null?void 0:n.headers]),__binaryResponse:!0})}}class DM extends jt{create(e,n){return this._client.post("/audio/transcriptions",Fl({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class TM extends jt{create(e,n){return this._client.post("/audio/translations",Fl({body:e,...n,__metadata:{model:e.model}},this._client))}}class Ef extends jt{constructor(){super(...arguments),this.transcriptions=new DM(this._client),this.translations=new TM(this._client),this.speech=new PM(this._client)}}Ef.Transcriptions=DM;Ef.Translations=TM;Ef.Speech=PM;class MM extends jt{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(ze`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",zn,{query:e,...n})}cancel(e,n){return this._client.post(ze`/batches/${e}/cancel`,n)}}class RM extends jt{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(ze`/assistants/${e}`,{...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(ze`/assistants/${e}`,{body:n,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e={},n){return this._client.getAPIList("/assistants",zn,{query:e,...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(ze`/assistants/${e}`,{...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class IM extends jt{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class OM extends jt{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class Ig extends jt{constructor(){super(...arguments),this.sessions=new IM(this._client),this.transcriptionSessions=new OM(this._client)}}Ig.Sessions=IM;Ig.TranscriptionSessions=OM;class LM extends jt{create(e,n,r){return this._client.post(ze`/threads/${e}/messages`,{body:n,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{thread_id:a}=n;return this._client.get(ze`/threads/${a}/messages/${e}`,{...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{thread_id:a,...i}=n;return this._client.post(ze`/threads/${a}/messages/${e}`,{body:i,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(ze`/threads/${e}/messages`,zn,{query:n,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n,r){const{thread_id:a}=n;return this._client.delete(ze`/threads/${a}/messages/${e}`,{...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}class FM extends jt{retrieve(e,n,r){const{thread_id:a,run_id:i,...o}=n;return this._client.get(ze`/threads/${a}/runs/${i}/steps/${e}`,{query:o,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n,r){const{thread_id:a,...i}=n;return this._client.getAPIList(ze`/threads/${a}/runs/${e}/steps`,zn,{query:i,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}const PZ=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let a=0;a<n;a++)r[a]=e.charCodeAt(a);return Array.from(new Float32Array(r.buffer))}};var cy={};const pc=t=>{var e,n,r,a;if(typeof globalThis.process<"u")return((e=cy==null?void 0:cy[t])==null?void 0:e.trim())??void 0;if(typeof globalThis.Deno<"u")return(a=(r=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,t))==null?void 0:a.trim()};var ls,hl,Dw,Na,yp,Vr,fl,$c,al,S0,nr,_p,wp,hh,qu,Wu,dC,uC,hC,fC,mC,pC,gC;class fh extends qj{constructor(){super(...arguments),ls.add(this),Dw.set(this,[]),Na.set(this,{}),yp.set(this,{}),Vr.set(this,void 0),fl.set(this,void 0),$c.set(this,void 0),al.set(this,void 0),S0.set(this,void 0),nr.set(this,void 0),_p.set(this,void 0),wp.set(this,void 0),hh.set(this,void 0)}[(Dw=new WeakMap,Na=new WeakMap,yp=new WeakMap,Vr=new WeakMap,fl=new WeakMap,$c=new WeakMap,al=new WeakMap,S0=new WeakMap,nr=new WeakMap,_p=new WeakMap,wp=new WeakMap,hh=new WeakMap,ls=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new hl;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Ra.fromReadableStream(e,this.controller);for await(const o of a)xe(this,ls,"m",qu).call(this,o);if((i=a.controller.signal)!=null&&i.aborted)throw new Dr;return this._addRun(xe(this,ls,"m",Wu).call(this))}toReadableStream(){return new Ra(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,a){const i=new hl;return i._run(()=>i._runToolAssistantStream(e,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,n,r,a){var d;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},c=await e.submitToolOutputs(n,o,{...a,signal:this.controller.signal});this._connected();for await(const u of c)xe(this,ls,"m",qu).call(this,u);if((d=c.controller.signal)!=null&&d.aborted)throw new Dr;return this._addRun(xe(this,ls,"m",Wu).call(this))}static createThreadAssistantStream(e,n,r){const a=new hl;return a._run(()=>a._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(e,n,r,a){const i=new hl;return i._run(()=>i._runAssistantStream(e,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return xe(this,_p,"f")}currentRun(){return xe(this,wp,"f")}currentMessageSnapshot(){return xe(this,Vr,"f")}currentRunStepSnapshot(){return xe(this,hh,"f")}async finalRunSteps(){return await this.done(),Object.values(xe(this,Na,"f"))}async finalMessages(){return await this.done(),Object.values(xe(this,yp,"f"))}async finalRun(){if(await this.done(),!xe(this,fl,"f"))throw Error("Final run was not received.");return xe(this,fl,"f")}async _createThreadAssistantStream(e,n,r){var c;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const d of o)xe(this,ls,"m",qu).call(this,d);if((c=o.controller.signal)!=null&&c.aborted)throw new Dr;return this._addRun(xe(this,ls,"m",Wu).call(this))}async _createAssistantStream(e,n,r,a){var d;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},c=await e.create(n,o,{...a,signal:this.controller.signal});this._connected();for await(const u of c)xe(this,ls,"m",qu).call(this,u);if((d=c.controller.signal)!=null&&d.aborted)throw new Dr;return this._addRun(xe(this,ls,"m",Wu).call(this))}static accumulateDelta(e,n){for(const[r,a]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=a;continue}let i=e[r];if(i==null){e[r]=a;continue}if(r==="index"||r==="type"){e[r]=a;continue}if(typeof i=="string"&&typeof a=="string")i+=a;else if(typeof i=="number"&&typeof a=="number")i+=a;else if(ty(i)&&ty(a))i=this.accumulateDelta(i,a);else if(Array.isArray(i)&&Array.isArray(a)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...a);continue}for(const o of a){if(!ty(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const c=o.index;if(c==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof c!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${c}`);const d=i[c];d==null?i.push(o):i[c]=this.accumulateDelta(d,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${a}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,a){return await this._createAssistantStream(n,e,r,a)}async _runToolAssistantStream(e,n,r,a){return await this._createToolAssistantStream(n,e,r,a)}}hl=fh,qu=function(e){if(!this.ended)switch(kt(this,_p,e),xe(this,ls,"m",hC).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":xe(this,ls,"m",gC).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":xe(this,ls,"m",uC).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":xe(this,ls,"m",dC).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Wu=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");if(!xe(this,fl,"f"))throw Error("Final run has not been received");return xe(this,fl,"f")},dC=function(e){const[n,r]=xe(this,ls,"m",mC).call(this,e,xe(this,Vr,"f"));kt(this,Vr,n),xe(this,yp,"f")[n.id]=n;for(const a of r){const i=n.content[a.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const a of e.data.delta.content){if(a.type=="text"&&a.text){let i=a.text,o=n.content[a.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=xe(this,$c,"f")){if(xe(this,al,"f"))switch(xe(this,al,"f").type){case"text":this._emit("textDone",xe(this,al,"f").text,xe(this,Vr,"f"));break;case"image_file":this._emit("imageFileDone",xe(this,al,"f").image_file,xe(this,Vr,"f"));break}kt(this,$c,a.index)}kt(this,al,n.content[a.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(xe(this,$c,"f")!==void 0){const a=e.data.content[xe(this,$c,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,xe(this,Vr,"f"));break;case"text":this._emit("textDone",a.text,xe(this,Vr,"f"));break}}xe(this,Vr,"f")&&this._emit("messageDone",e.data),kt(this,Vr,void 0)}},uC=function(e){const n=xe(this,ls,"m",fC).call(this,e);switch(kt(this,hh,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==xe(this,S0,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(xe(this,nr,"f")&&this._emit("toolCallDone",xe(this,nr,"f")),kt(this,S0,i.index),kt(this,nr,n.step_details.tool_calls[i.index]),xe(this,nr,"f")&&this._emit("toolCallCreated",xe(this,nr,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":kt(this,hh,void 0),e.data.step_details.type=="tool_calls"&&xe(this,nr,"f")&&(this._emit("toolCallDone",xe(this,nr,"f")),kt(this,nr,void 0)),this._emit("runStepDone",e.data,n);break}},hC=function(e){xe(this,Dw,"f").push(e),this._emit("event",e)},fC=function(e){switch(e.event){case"thread.run.step.created":return xe(this,Na,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=xe(this,Na,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const a=hl.accumulateDelta(n,r.delta);xe(this,Na,"f")[e.data.id]=a}return xe(this,Na,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":xe(this,Na,"f")[e.data.id]=e.data;break}if(xe(this,Na,"f")[e.data.id])return xe(this,Na,"f")[e.data.id];throw new Error("No snapshot available")},mC=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=e.data;if(a.delta.content)for(const i of a.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=xe(this,ls,"m",pC).call(this,i,o)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},pC=function(e,n){return hl.accumulateDelta(n,e)},gC=function(e){switch(kt(this,wp,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":kt(this,fl,e.data),xe(this,nr,"f")&&(this._emit("toolCallDone",xe(this,nr,"f")),kt(this,nr,void 0));break}};let Kj=class extends jt{constructor(){super(...arguments),this.steps=new FM(this._client)}create(e,n,r){const{include:a,...i}=n;return this._client.post(ze`/threads/${e}/runs`,{query:{include:a},body:i,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers]),stream:n.stream??!1})}retrieve(e,n,r){const{thread_id:a}=n;return this._client.get(ze`/threads/${a}/runs/${e}`,{...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{thread_id:a,...i}=n;return this._client.post(ze`/threads/${a}/runs/${e}`,{body:i,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(ze`/threads/${e}/runs`,zn,{query:n,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}cancel(e,n,r){const{thread_id:a}=n;return this._client.post(ze`/threads/${a}/runs/${e}/cancel`,{...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const a=await this.create(e,n,r);return await this.poll(a.id,{thread_id:e},r)}createAndStream(e,n,r){return fh.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){var i;const a=ut([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:c}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let d=5e3;if(r!=null&&r.pollIntervalMs)d=r.pollIntervalMs;else{const u=c.headers.get("openai-poll-after-ms");if(u){const m=parseInt(u);isNaN(m)||(d=m)}}await kf(d);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(e,n,r){return fh.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r){const{thread_id:a,...i}=n;return this._client.post(ze`/threads/${a}/runs/${e}/submit_tool_outputs`,{body:i,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,r){const a=await this.submitToolOutputs(e,n,r);return await this.poll(a.id,n,r)}submitToolOutputsStream(e,n,r){return fh.createToolAssistantStream(e,this._client.beta.threads.runs,n,r)}};Kj.Steps=FM;class Og extends jt{constructor(){super(...arguments),this.runs=new Kj(this._client),this.messages=new LM(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(ze`/threads/${e}`,{...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(ze`/threads/${e}`,{body:n,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n){return this._client.delete(ze`/threads/${e}`,{...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.id,{thread_id:r.thread_id},n)}createAndRunStream(e,n){return fh.createThreadAssistantStream(e,this._client.beta.threads,n)}}Og.Runs=Kj;Og.Messages=LM;class Af extends jt{constructor(){super(...arguments),this.realtime=new Ig(this._client),this.assistants=new RM(this._client),this.threads=new Og(this._client)}}Af.Realtime=Ig;Af.Assistants=RM;Af.Threads=Og;class BM extends jt{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let zM=class extends jt{retrieve(e,n,r){const{container_id:a}=n;return this._client.get(ze`/containers/${a}/files/${e}/content`,{...r,headers:ut([{Accept:"application/binary"},r==null?void 0:r.headers]),__binaryResponse:!0})}},Zj=class extends jt{constructor(){super(...arguments),this.content=new zM(this._client)}create(e,n,r){return this._client.post(ze`/containers/${e}/files`,Fl({body:n,...r},this._client))}retrieve(e,n,r){const{container_id:a}=n;return this._client.get(ze`/containers/${a}/files/${e}`,r)}list(e,n={},r){return this._client.getAPIList(ze`/containers/${e}/files`,zn,{query:n,...r})}delete(e,n,r){const{container_id:a}=n;return this._client.delete(ze`/containers/${a}/files/${e}`,{...r,headers:ut([{Accept:"*/*"},r==null?void 0:r.headers])})}};Zj.Content=zM;class Gj extends jt{constructor(){super(...arguments),this.files=new Zj(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(ze`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",zn,{query:e,...n})}delete(e,n){return this._client.delete(ze`/containers/${e}`,{...n,headers:ut([{Accept:"*/*"},n==null?void 0:n.headers])})}}Gj.Files=Zj;class $M extends jt{create(e,n,r){const{include:a,...i}=n;return this._client.post(ze`/conversations/${e}/items`,{query:{include:a},body:i,...r})}retrieve(e,n,r){const{conversation_id:a,...i}=n;return this._client.get(ze`/conversations/${a}/items/${e}`,{query:i,...r})}list(e,n={},r){return this._client.getAPIList(ze`/conversations/${e}/items`,oZ,{query:n,...r})}delete(e,n,r){const{conversation_id:a}=n;return this._client.delete(ze`/conversations/${a}/items/${e}`,r)}}class Qj extends jt{constructor(){super(...arguments),this.items=new $M(this._client)}create(e,n){return this._client.post("/conversations",{body:e,...n})}retrieve(e,n){return this._client.get(ze`/conversations/${e}`,n)}update(e,n,r){return this._client.post(ze`/conversations/${e}`,{body:n,...r})}delete(e,n){return this._client.delete(ze`/conversations/${e}`,n)}}Qj.Items=$M;class UM extends jt{create(e,n){const r=!!e.encoding_format;let a=r?e.encoding_format:"base64";r&&os(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:a},...n});return r?i:(os(this._client).debug("embeddings/decoding base64 embeddings from base64"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(c=>{const d=c.embedding;c.embedding=PZ(d)}),o)))}}class qM extends jt{retrieve(e,n,r){const{eval_id:a,run_id:i}=n;return this._client.get(ze`/evals/${a}/runs/${i}/output_items/${e}`,r)}list(e,n,r){const{eval_id:a,...i}=n;return this._client.getAPIList(ze`/evals/${a}/runs/${e}/output_items`,zn,{query:i,...r})}}class Yj extends jt{constructor(){super(...arguments),this.outputItems=new qM(this._client)}create(e,n,r){return this._client.post(ze`/evals/${e}/runs`,{body:n,...r})}retrieve(e,n,r){const{eval_id:a}=n;return this._client.get(ze`/evals/${a}/runs/${e}`,r)}list(e,n={},r){return this._client.getAPIList(ze`/evals/${e}/runs`,zn,{query:n,...r})}delete(e,n,r){const{eval_id:a}=n;return this._client.delete(ze`/evals/${a}/runs/${e}`,r)}cancel(e,n,r){const{eval_id:a}=n;return this._client.post(ze`/evals/${a}/runs/${e}`,r)}}Yj.OutputItems=qM;class Xj extends jt{constructor(){super(...arguments),this.runs=new Yj(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(ze`/evals/${e}`,n)}update(e,n,r){return this._client.post(ze`/evals/${e}`,{body:n,...r})}list(e={},n){return this._client.getAPIList("/evals",zn,{query:e,...n})}delete(e,n){return this._client.delete(ze`/evals/${e}`,n)}}Xj.Runs=Yj;let WM=class extends jt{create(e,n){return this._client.post("/files",Fl({body:e,...n},this._client))}retrieve(e,n){return this._client.get(ze`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",zn,{query:e,...n})}delete(e,n){return this._client.delete(ze`/files/${e}`,n)}content(e,n){return this._client.get(ze`/files/${e}/content`,{...n,headers:ut([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!a.has(o.status);)if(await kf(n),o=await this.retrieve(e),Date.now()-i>r)throw new Fj({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class HM extends jt{}let VM=class extends jt{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class Jj extends jt{constructor(){super(...arguments),this.graders=new VM(this._client)}}Jj.Graders=VM;class KM extends jt{create(e,n,r){return this._client.getAPIList(ze`/fine_tuning/checkpoints/${e}/permissions`,Rg,{body:n,method:"post",...r})}retrieve(e,n={},r){return this._client.get(ze`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...r})}delete(e,n,r){const{fine_tuned_model_checkpoint:a}=n;return this._client.delete(ze`/fine_tuning/checkpoints/${a}/permissions/${e}`,r)}}let e1=class extends jt{constructor(){super(...arguments),this.permissions=new KM(this._client)}};e1.Permissions=KM;class ZM extends jt{list(e,n={},r){return this._client.getAPIList(ze`/fine_tuning/jobs/${e}/checkpoints`,zn,{query:n,...r})}}class t1 extends jt{constructor(){super(...arguments),this.checkpoints=new ZM(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(ze`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",zn,{query:e,...n})}cancel(e,n){return this._client.post(ze`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return this._client.getAPIList(ze`/fine_tuning/jobs/${e}/events`,zn,{query:n,...r})}pause(e,n){return this._client.post(ze`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(ze`/fine_tuning/jobs/${e}/resume`,n)}}t1.Checkpoints=ZM;class Yd extends jt{constructor(){super(...arguments),this.methods=new HM(this._client),this.jobs=new t1(this._client),this.checkpoints=new e1(this._client),this.alpha=new Jj(this._client)}}Yd.Methods=HM;Yd.Jobs=t1;Yd.Checkpoints=e1;Yd.Alpha=Jj;class GM extends jt{}class n1 extends jt{constructor(){super(...arguments),this.graderModels=new GM(this._client)}}n1.GraderModels=GM;class QM extends jt{createVariation(e,n){return this._client.post("/images/variations",Fl({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",Fl({body:e,...n,stream:e.stream??!1},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n,stream:e.stream??!1})}}class YM extends jt{retrieve(e,n){return this._client.get(ze`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",Rg,e)}delete(e,n){return this._client.delete(ze`/models/${e}`,n)}}class XM extends jt{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function DZ(t,e){return!e||!MZ(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:JM(t,e)}function JM(t,e){const n=t.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:OZ(e,a)};if(a.type==="message"){const i=a.content.map(o=>o.type==="output_text"?{...o,parsed:TZ(e,o.text)}:o);return{...a,content:i}}return a}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||Tw(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const a of r.output)if(a.type==="message"){for(const i of a.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function TZ(t,e){var n,r,a,i;return((r=(n=t.text)==null?void 0:n.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((a=t.text)==null?void 0:a.format)?((i=t.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function MZ(t){var e;return!!$j((e=t.text)==null?void 0:e.format)}function RZ(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function IZ(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function OZ(t,e){const n=IZ(t.tools??[],e.name);return{...e,...e,parsed_arguments:RZ(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function Tw(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}var gc,Um,Bi,qm,xC,vC,yC,_C;class s1 extends qj{constructor(e){super(),gc.add(this),Um.set(this,void 0),Bi.set(this,void 0),qm.set(this,void 0),kt(this,Um,e)}static createResponse(e,n,r){const a=new s1(n);return a._run(()=>a._createOrRetrieveResponse(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createOrRetrieveResponse(e,n,r){var c;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),xe(this,gc,"m",xC).call(this);let i,o=null;"response_id"in n?(i=await e.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),o=n.starting_after??null):i=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const d of i)xe(this,gc,"m",vC).call(this,d,o);if((c=i.controller.signal)!=null&&c.aborted)throw new Dr;return xe(this,gc,"m",yC).call(this)}[(Um=new WeakMap,Bi=new WeakMap,qm=new WeakMap,gc=new WeakSet,xC=function(){this.ended||kt(this,Bi,void 0)},vC=function(n,r){if(this.ended)return;const a=(o,c)=>{(r==null||c.sequence_number>r)&&this._emit(o,c)},i=xe(this,gc,"m",_C).call(this,n);switch(a("event",n),n.type){case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new wt(`missing output at index ${n.output_index}`);if(o.type==="message"){const c=o.content[n.content_index];if(!c)throw new wt(`missing content at index ${n.content_index}`);if(c.type!=="output_text")throw new wt(`expected content to be 'output_text', got ${c.type}`);a("response.output_text.delta",{...n,snapshot:c.text})}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new wt(`missing output at index ${n.output_index}`);o.type==="function_call"&&a("response.function_call_arguments.delta",{...n,snapshot:o.arguments});break}default:a(n.type,n);break}},yC=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");const n=xe(this,Bi,"f");if(!n)throw new wt("request ended without sending any events");kt(this,Bi,void 0);const r=LZ(n,xe(this,Um,"f"));return kt(this,qm,r),r},_C=function(n){let r=xe(this,Bi,"f");if(!r){if(n.type!=="response.created")throw new wt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=kt(this,Bi,n.response),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const a=r.output[n.output_index];if(!a)throw new wt(`missing output at index ${n.output_index}`);a.type==="message"&&a.content.push(n.part);break}case"response.output_text.delta":{const a=r.output[n.output_index];if(!a)throw new wt(`missing output at index ${n.output_index}`);if(a.type==="message"){const i=a.content[n.content_index];if(!i)throw new wt(`missing content at index ${n.content_index}`);if(i.type!=="output_text")throw new wt(`expected content to be 'output_text', got ${i.type}`);i.text+=n.delta}break}case"response.function_call_arguments.delta":{const a=r.output[n.output_index];if(!a)throw new wt(`missing output at index ${n.output_index}`);a.type==="function_call"&&(a.arguments+=n.delta);break}case"response.completed":{kt(this,Bi,n.response);break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=xe(this,qm,"f");if(!e)throw new wt("stream ended without producing a ChatCompletion");return e}}function LZ(t,e){return DZ(t,e)}class eR extends jt{list(e,n={},r){return this._client.getAPIList(ze`/responses/${e}/input_items`,zn,{query:n,...r})}}class r1 extends jt{constructor(){super(...arguments),this.inputItems=new eR(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&Tw(r),r))}retrieve(e,n={},r){return this._client.get(ze`/responses/${e}`,{query:n,...r,stream:(n==null?void 0:n.stream)??!1})._thenUnwrap(a=>("object"in a&&a.object==="response"&&Tw(a),a))}delete(e,n){return this._client.delete(ze`/responses/${e}`,{...n,headers:ut([{Accept:"*/*"},n==null?void 0:n.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>JM(r,e))}stream(e,n){return s1.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(ze`/responses/${e}/cancel`,n)}}r1.InputItems=eR;class tR extends jt{create(e,n,r){return this._client.post(ze`/uploads/${e}/parts`,Fl({body:n,...r},this._client))}}class a1 extends jt{constructor(){super(...arguments),this.parts=new tR(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(ze`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(ze`/uploads/${e}/complete`,{body:n,...r})}}a1.Parts=tR;const FZ=async t=>{const e=await Promise.allSettled(t),n=e.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const a of e)a.status==="fulfilled"&&r.push(a.value);return r};class nR extends jt{create(e,n,r){return this._client.post(ze`/vector_stores/${e}/file_batches`,{body:n,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{vector_store_id:a}=n;return this._client.get(ze`/vector_stores/${a}/file_batches/${e}`,{...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}cancel(e,n,r){const{vector_store_id:a}=n;return this._client.post(ze`/vector_stores/${a}/file_batches/${e}/cancel`,{...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const a=await this.create(e,n);return await this.poll(e,a.id,r)}listFiles(e,n,r){const{vector_store_id:a,...i}=n;return this._client.getAPIList(ze`/vector_stores/${a}/file_batches/${e}/files`,zn,{query:i,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async poll(e,n,r){var i;const a=ut([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:c}=await this.retrieve(n,{vector_store_id:e},{...r,headers:a}).withResponse();switch(o.status){case"in_progress":let d=5e3;if(r!=null&&r.pollIntervalMs)d=r.pollIntervalMs;else{const u=c.headers.get("openai-poll-after-ms");if(u){const m=parseInt(u);isNaN(m)||(d=m)}}await kf(d);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(a==null?void 0:a.maxConcurrency)??5,o=Math.min(i,n.length),c=this._client,d=n.values(),u=[...r];async function m(p){for(let x of p){const j=await c.files.create({file:x,purpose:"assistants"},a);u.push(j.id)}}const f=Array(o).fill(d).map(m);return await FZ(f),await this.createAndPoll(e,{file_ids:u})}}class sR extends jt{create(e,n,r){return this._client.post(ze`/vector_stores/${e}/files`,{body:n,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{vector_store_id:a}=n;return this._client.get(ze`/vector_stores/${a}/files/${e}`,{...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{vector_store_id:a,...i}=n;return this._client.post(ze`/vector_stores/${a}/files/${e}`,{body:i,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(ze`/vector_stores/${e}/files`,zn,{query:n,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n,r){const{vector_store_id:a}=n;return this._client.delete(ze`/vector_stores/${a}/files/${e}`,{...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const a=await this.create(e,n,r);return await this.poll(e,a.id,r)}async poll(e,n,r){var i;const a=ut([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const o=await this.retrieve(n,{vector_store_id:e},{...r,headers:a}).withResponse(),c=o.data;switch(c.status){case"in_progress":let d=5e3;if(r!=null&&r.pollIntervalMs)d=r.pollIntervalMs;else{const u=o.response.headers.get("openai-poll-after-ms");if(u){const m=parseInt(u);isNaN(m)||(d=m)}}await kf(d);break;case"failed":case"completed":return c}}}async upload(e,n,r){const a=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:a.id},r)}async uploadAndPoll(e,n,r){const a=await this.upload(e,n,r);return await this.poll(e,a.id,r)}content(e,n,r){const{vector_store_id:a}=n;return this._client.getAPIList(ze`/vector_stores/${a}/files/${e}/content`,Rg,{...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}class Lg extends jt{constructor(){super(...arguments),this.files=new sR(this._client),this.fileBatches=new nR(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(ze`/vector_stores/${e}`,{...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(ze`/vector_stores/${e}`,{body:n,...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",zn,{query:e,...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(ze`/vector_stores/${e}`,{...n,headers:ut([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}search(e,n,r){return this._client.getAPIList(ze`/vector_stores/${e}/search`,Rg,{body:n,method:"post",...r,headers:ut([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}Lg.Files=sR;Lg.FileBatches=nR;var Cc,rR,bp;class aR extends jt{constructor(){super(...arguments),Cc.add(this)}async unwrap(e,n,r=this._client.webhookSecret,a=300){return await this.verifySignature(e,n,r,a),JSON.parse(e)}async verifySignature(e,n,r=this._client.webhookSecret,a=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");xe(this,Cc,"m",rR).call(this,r);const i=ut([n]).values,o=xe(this,Cc,"m",bp).call(this,i,"webhook-signature"),c=xe(this,Cc,"m",bp).call(this,i,"webhook-timestamp"),d=xe(this,Cc,"m",bp).call(this,i,"webhook-id"),u=parseInt(c,10);if(isNaN(u))throw new Ou("Invalid webhook timestamp format");const m=Math.floor(Date.now()/1e3);if(m-u>a)throw new Ou("Webhook timestamp is too old");if(u>m+a)throw new Ou("Webhook timestamp is too new");const f=o.split(" ").map(v=>v.startsWith("v1,")?v.substring(3):v),p=r.startsWith("whsec_")?Buffer.from(r.replace("whsec_",""),"base64"):Buffer.from(r,"utf-8"),x=d?`${d}.${c}.${e}`:`${c}.${e}`,j=await crypto.subtle.importKey("raw",p,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const v of f)try{const _=Buffer.from(v,"base64");if(await crypto.subtle.verify("HMAC",j,_,new TextEncoder().encode(x)))return}catch{continue}throw new Ou("The given webhook signature does not match the expected signature")}}Cc=new WeakSet,rR=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},bp=function(e,n){if(!e)throw new Error("Headers are required");const r=e.get(n);if(r==null)throw new Error(`Missing required header: ${n}`);return r};var Mw,i1,jp,iR;class $t{constructor({baseURL:e=pc("OPENAI_BASE_URL"),apiKey:n=pc("OPENAI_API_KEY"),organization:r=pc("OPENAI_ORG_ID")??null,project:a=pc("OPENAI_PROJECT_ID")??null,webhookSecret:i=pc("OPENAI_WEBHOOK_SECRET")??null,...o}={}){if(Mw.add(this),jp.set(this,void 0),this.completions=new BM(this),this.chat=new Vj(this),this.embeddings=new UM(this),this.files=new WM(this),this.images=new QM(this),this.audio=new Ef(this),this.moderations=new XM(this),this.models=new YM(this),this.fineTuning=new Yd(this),this.graders=new n1(this),this.vectorStores=new Lg(this),this.webhooks=new aR(this),this.beta=new Af(this),this.batches=new MM(this),this.uploads=new a1(this),this.responses=new r1(this),this.conversations=new Qj(this),this.evals=new Xj(this),this.containers=new Gj(this),n===void 0)throw new wt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const c={apiKey:n,organization:r,project:a,webhookSecret:i,...o,baseURL:e||"https://api.openai.com/v1"};if(!c.dangerouslyAllowBrowser&&FK())throw new wt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=c.baseURL,this.timeout=c.timeout??i1.DEFAULT_TIMEOUT,this.logger=c.logger??console;const d="warn";this.logLevel=d,this.logLevel=rC(c.logLevel,"ClientOptions.logLevel",this)??rC(pc("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??d,this.fetchOptions=c.fetchOptions,this.maxRetries=c.maxRetries??2,this.fetch=c.fetch??qK(),kt(this,jp,HK),this._options=c,this.apiKey=n,this.organization=r,this.project=a,this.webhookSecret=i}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}async authHeaders(e){return ut([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return YK(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Sc}`}defaultIdempotencyKey(){return`stainless-node-retry-${OT()}`}makeStatusError(e,n,r,a){return ps.generate(e,n,r,a)}buildURL(e,n,r){const a=!xe(this,Mw,"m",iR).call(this)&&r||this.baseURL,i=MK(e)?new URL(e):new URL(a+(a.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return RK(o)||(n={...o,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(i.search=this.stringifyQuery(n)),i.toString()}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(a=>({method:e,path:n,...a})))}request(e,n=null){return new Mg(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){var b,w;const a=await e,i=a.maxRetries??this.maxRetries;n==null&&(n=i),await this.prepareOptions(a);const{req:o,url:c,timeout:d}=await this.buildRequest(a,{retryCount:i-n});await this.prepareRequest(o,{url:c,options:a});const u="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),m=r===void 0?"":`, retryOf: ${r}`,f=Date.now();if(os(this).debug(`[${u}] sending request`,nl({retryOfRequestLogID:r,method:a.method,url:c,options:a,headers:o.headers})),(b=a.signal)!=null&&b.aborted)throw new Dr;const p=new AbortController,x=await this.fetchWithTimeout(c,o,d,p).catch(bw),j=Date.now();if(x instanceof Error){const N=`retrying, ${n} attempts remaining`;if((w=a.signal)!=null&&w.aborted)throw new Dr;const S=ww(x)||/timed? ?out/i.test(String(x)+("cause"in x?String(x.cause):""));if(n)return os(this).info(`[${u}] connection ${S?"timed out":"failed"} - ${N}`),os(this).debug(`[${u}] connection ${S?"timed out":"failed"} (${N})`,nl({retryOfRequestLogID:r,url:c,durationMs:j-f,message:x.message})),this.retryRequest(a,n,r??u);throw os(this).info(`[${u}] connection ${S?"timed out":"failed"} - error; no more retries left`),os(this).debug(`[${u}] connection ${S?"timed out":"failed"} (error; no more retries left)`,nl({retryOfRequestLogID:r,url:c,durationMs:j-f,message:x.message})),S?new Fj:new Dg({cause:x})}const v=[...x.headers.entries()].filter(([N])=>N==="x-request-id").map(([N,S])=>", "+N+": "+JSON.stringify(S)).join(""),_=`[${u}${m}${v}] ${o.method} ${c} ${x.ok?"succeeded":"failed"} with status ${x.status} in ${j-f}ms`;if(!x.ok){const N=await this.shouldRetry(x);if(n&&N){const z=`retrying, ${n} attempts remaining`;return await WK(x.body),os(this).info(`${_} - ${z}`),os(this).debug(`[${u}] response error (${z})`,nl({retryOfRequestLogID:r,url:x.url,status:x.status,headers:x.headers,durationMs:j-f})),this.retryRequest(a,n,r??u,x.headers)}const S=N?"error; no more retries left":"error; not retryable";os(this).info(`${_} - ${S}`);const C=await x.text().catch(z=>bw(z).message),A=LK(C),P=A?void 0:C;throw os(this).debug(`[${u}] response error (${S})`,nl({retryOfRequestLogID:r,url:x.url,status:x.status,headers:x.headers,message:P,durationMs:Date.now()-f})),this.makeStatusError(x.status,A,P,x.headers)}return os(this).info(_),os(this).debug(`[${u}] response start`,nl({retryOfRequestLogID:r,url:x.url,status:x.status,headers:x.headers,durationMs:j-f})),{response:x,options:a,controller:p,requestLogID:u,retryOfRequestLogID:r,startTime:f}}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}requestAPIList(e,n){const r=this.makeRequest(n,null,void 0);return new iZ(this,r,e)}async fetchWithTimeout(e,n,r,a){const{signal:i,method:o,...c}=n||{};i&&i.addEventListener("abort",()=>a.abort());const d=setTimeout(()=>a.abort(),r),u=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,m={signal:a.signal,...u?{duplex:"half"}:{},method:"GET",...c};o&&(m.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,m)}finally{clearTimeout(d)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,a){let i;const o=a==null?void 0:a.get("retry-after-ms");if(o){const d=parseFloat(o);Number.isNaN(d)||(i=d)}const c=a==null?void 0:a.get("retry-after");if(c&&!i){const d=parseFloat(c);Number.isNaN(d)?i=Date.parse(c)-Date.now():i=d*1e3}if(!(i&&0<=i&&i<60*1e3)){const d=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(n,d)}return await kf(i),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),c=1-Math.random()*.25;return o*c*1e3}async buildRequest(e,{retryCount:n=0}={}){const r={...e},{method:a,path:i,query:o,defaultBaseURL:c}=r,d=this.buildURL(i,o,c);"timeout"in r&&OK("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const{bodyHeaders:u,body:m}=this.buildBody({options:r}),f=await this.buildHeaders({options:e,method:a,bodyHeaders:u,retryCount:n});return{req:{method:a,headers:f,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"},...m&&{body:m},...this.fetchOptions??{},...r.fetchOptions??{}},url:d,timeout:r.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:a}){let i={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const o=ut([i,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...UK(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(o),o.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=ut([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:GT(e)}:xe(this,jp,"f").call(this,{body:e,headers:r})}}i1=$t,jp=new WeakMap,Mw=new WeakSet,iR=function(){return this.baseURL!=="https://api.openai.com/v1"};$t.OpenAI=i1;$t.DEFAULT_TIMEOUT=6e5;$t.OpenAIError=wt;$t.APIError=ps;$t.APIConnectionError=Dg;$t.APIConnectionTimeoutError=Fj;$t.APIUserAbortError=Dr;$t.NotFoundError=zT;$t.ConflictError=$T;$t.RateLimitError=qT;$t.BadRequestError=LT;$t.AuthenticationError=FT;$t.InternalServerError=WT;$t.PermissionDeniedError=BT;$t.UnprocessableEntityError=UT;$t.InvalidWebhookSignatureError=Ou;$t.toFile=fZ;$t.Completions=BM;$t.Chat=Vj;$t.Embeddings=UM;$t.Files=WM;$t.Images=QM;$t.Audio=Ef;$t.Moderations=XM;$t.Models=YM;$t.FineTuning=Yd;$t.Graders=n1;$t.VectorStores=Lg;$t.Webhooks=aR;$t.Beta=Af;$t.Batches=MM;$t.Uploads=a1;$t.Responses=r1;$t.Conversations=Qj;$t.Evals=Xj;$t.Containers=Gj;const BZ=new $t({apiKey:"sk-proj-demo-key-hier-einfuegen",dangerouslyAllowBrowser:!0});async function zZ(t,e){try{console.log("OpenAI Extraktion gestartet...");const n=`Du bist ein Experte für die Extraktion von Daten aus deutschen Handwerker-Rechnungen.
    Extrahiere ALLE relevanten Informationen aus der Rechnung und gebe sie als strukturiertes JSON zurück.
    
    Achte besonders auf:
    - Deutsche Datumsformate (DD.MM.YYYY) -> konvertiere zu YYYY-MM-DD
    - Deutsche Zahlenformate (1.234,56 €) -> konvertiere zu Dezimalzahlen
    - Handwerker-spezifische Begriffe
    - Positionen/Artikel in Tabellen
    
    Gib NUR valides JSON zurück, keine zusätzlichen Erklärungen.`,r=`Extrahiere alle Rechnungsdaten aus diesem Bild. 
    ${e?`Hier ist der bereits erkannte Text als Hilfe: ${e}`:""}
    
    Gib die Daten in diesem exakten JSON-Format zurück:
    {
      "invoiceNumber": "Rechnungsnummer",
      "date": "YYYY-MM-DD",
      "supplierName": "Firmenname",
      "totalAmount": Gesamtbetrag als Zahl,
      "vatAmount": MwSt-Betrag als Zahl oder null,
      "vatRate": MwSt-Satz als Zahl oder null,
      "netAmount": Nettobetrag als Zahl oder null,
      "iban": "IBAN oder null",
      "customerNumber": "Kundennummer oder null",
      "orderNumber": "Auftragsnummer oder null"
    }`,a=await BZ.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:n},{role:"user",content:[{type:"text",text:r},{type:"image_url",image_url:{url:`data:image/jpeg;base64,${t}`,detail:"high"}}]}],max_tokens:2e3,temperature:.1,response_format:{type:"json_object"}}),i=JSON.parse(a.choices[0].message.content||"{}");return console.log("OpenAI extrahierte Daten:",i),{invoiceNumber:i.invoiceNumber||"UNBEKANNT",date:i.date||i.invoiceDate||new Date().toISOString().split("T")[0],invoiceDate:i.invoiceDate,deliveryDate:i.deliveryDate,dueDate:i.dueDate,supplierName:i.supplierName||"UNBEKANNT",supplierAddress:i.supplierAddress,supplierTaxNumber:i.supplierTaxNumber,supplierVatId:i.supplierVatId,customerName:i.customerName,customerNumber:i.customerNumber,customerAddress:i.customerAddress,positions:i.positions||[],netAmount:i.netAmount,vatRate:i.vatRate,vatAmount:i.vatAmount,totalAmount:i.totalAmount||0,iban:i.iban,bic:i.bic,orderNumber:i.orderNumber,deliveryNoteNumber:i.deliveryNoteNumber,projectNumber:i.projectNumber,paymentTerms:i.paymentTerms,discountTerms:i.discountTerms,description:`AI-extrahiert am ${new Date().toLocaleDateString("de-DE")}`}}catch(n){throw console.error("OpenAI Extraktion fehlgeschlagen:",n),new Error("KI-Extraktion fehlgeschlagen: "+n.message)}}function $Z(){return!0}class k0{static async initialize(){if(!(this.isInitialized&&this.worker))try{console.log("Initialisiere Tesseract Worker...");try{this.worker=await Kk.createWorker(["deu","eng"]),console.log("Deutsche und englische Sprachdateien geladen")}catch(e){console.warn("Mehrsprachige Initialisierung fehlgeschlagen, verwende nur Englisch:",e);try{this.worker=await Kk.createWorker("eng"),console.log("Englische Sprachdatei geladen")}catch(n){throw console.error("Fallback auf Englisch fehlgeschlagen:",n),n}}await this.worker.setParameters({tessedit_char_whitelist:`0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyzäöüÄÖÜß.,:-€$%/@()[]{}|_+=*&!?"' 	
`,tessedit_pageseg_mode:"3",preserve_interword_spaces:"1",tessedit_ocr_engine_mode:"3",tessedit_min_confidence:"60"}),this.isInitialized=!0,console.log("OCR Service erfolgreich initialisiert mit optimierten Parametern")}catch(e){throw console.error("Failed to initialize OCR Service:",e),new fo("OCR Service konnte nicht initialisiert werden. Überprüfen Sie Ihre Internetverbindung.",Iu.SERVER_ERROR,"Tesseract Worker initialization failed")}}static async processInvoiceImage(e){return Im(async()=>{const n=await vv();(!this.isInitialized||!this.worker)&&await this.initialize();const r=await this.fileToBase64(e),a=e.name.split(".").pop()||"jpg",i=`invoice_${Date.now()}.${a}`;let o=`data:image/${a};base64,${r}`,c,d,u="";console.log("Starte OCR-Verarbeitung für Datei:",e.name);const m=await this.worker.recognize(e,{rotateAuto:!0,rotateRadians:0});u=m.data.text||"";const f=m.data.confidence||0,p=this.cleanOCRText(u);if(console.log(`OCR abgeschlossen - Konfidenz: ${f}%`),console.log("OCR Raw Text (erste 500 Zeichen):",u.substring(0,500)),console.log("Bereinigte Version:",p.substring(0,500)),$Z()){console.log("Verwende OpenAI Vision API für Extraktion...");try{c=await zZ(r,u),d={overall:.95,invoice_number:.95,date:.95,amount:.95,supplier:.95},console.log("OpenAI Extraktion erfolgreich!")}catch(j){console.error("OpenAI fehlgeschlagen, falle zurück auf Regex:",j),c=this.extractInvoiceData(p),d=this.calculateConfidenceScores(p,c)}}const x={id:`ocr_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,original_file_path:o,extracted_text:u,structured_data:c,confidence_scores:d,status:"pending",created_at:new Date().toISOString(),created_by:(n==null?void 0:n.id)||"unknown"};try{const j=JSON.parse(localStorage.getItem("ocr_results")||"[]");j.push(x),localStorage.setItem("ocr_results",JSON.stringify(j)),console.log("OCR result saved locally:",x.id)}catch(j){console.warn("LocalStorage failed, continuing without storage:",j)}return console.log("OCR result created successfully:",x.id),ct.emit("OCR_PROCESSED",{ocr_id:x.id,confidence:d.overall,supplier_name:c.supplierName,user_id:n.id}),x},"Process invoice with OCR")}static async validateAndCreateInvoice(e,n,r){return Im(async()=>{const a=await vv(),{data:i,error:o}=await Z.from("ocr_results").update({structured_data:n,status:"validated",validation_notes:r,validated_at:new Date().toISOString(),validated_by:a.id}).eq("id",e).select().single();if(o)throw new fo("OCR-Validierung fehlgeschlagen",Iu.SERVER_ERROR,o.message);const c={invoice_number:n.invoiceNumber,supplier_name:n.supplierName,invoice_date:n.date,total_amount:n.totalAmount,vat_amount:n.vatAmount||0,description:n.description||"",status:"pending",ocr_result_id:e,created_by:a.id},{data:d,error:u}=await Z.from("supplier_invoices").insert(c).select().single();if(u)throw new fo("Rechnung konnte nicht erstellt werden",Iu.SERVER_ERROR,u.message);try{console.log("Audit log: Invoice created from OCR",{entity_id:d.id,invoice_number:n.invoiceNumber,supplier_name:n.supplierName,total_amount:n.totalAmount})}catch(m){console.error("Audit log failed (non-critical):",m)}return{ocr_result:i,invoice_id:d.id}},"Validate OCR and create invoice")}static async getOCRResults(e){return Im(async()=>{try{const n=JSON.parse(localStorage.getItem("ocr_results")||"[]");let r=n;return e&&(r=n.filter(a=>a.status===e)),r.sort((a,i)=>new Date(i.created_at).getTime()-new Date(a.created_at).getTime()),console.log(`Retrieved ${r.length} OCR results from localStorage`),r}catch(n){return console.warn("Failed to read from localStorage, returning empty array:",n),[]}},"Get OCR results")}static async rejectOCRResult(e,n){return Im(async()=>{const r=await vv(),{error:a}=await Z.from("ocr_results").update({status:"rejected",validation_notes:n,validated_at:new Date().toISOString(),validated_by:r.id}).eq("id",e);if(a)throw new fo("OCR-Ergebnis konnte nicht abgelehnt werden",Iu.SERVER_ERROR,a.message);try{console.log("Audit log: OCR result rejected",{entity_id:e,status:"rejected",reason:n})}catch(i){console.error("Audit log failed (non-critical):",i)}},"Reject OCR result")}static fileToBase64(e){return new Promise((n,r)=>{const a=new FileReader;a.onload=()=>{const i=a.result.split(",")[1];n(i)},a.onerror=r,a.readAsDataURL(e)})}static cleanOCRText(e){let n=e.replace(/[ \t]+/g," ");return n=n.replace(/\bl\s*nvoice/gi,"Invoice").replace(/\bRechnunq/gi,"Rechnung").replace(/\bDaturn/gi,"Datum").replace(/\bSurnme/gi,"Summe").replace(/\bMwSt\./gi,"MwSt").replace(/\bGrnbH/gi,"GmbH").replace(/\bAG\s*\./gi,"AG").replace(/\€/g,"€").replace(/\bEUR\b/g,"€").replace(/([0-9]),\s*([0-9]{2})\s*€/g,"$1,$2 €"),n}static extractInvoicePositions(e){const n=[],r=e.split(`
`),a=[/^(\d+)[\.\s]+(.+?)\s+(\d+[\.,]?\d*)\s*(Stk|Std|m²|m|kg|l|Stück|Stunde)?\s*€?\s*([\d\.,]+)\s*€?\s*([\d\.,]+)/,/(.+?)\s+(\d+[\.,]?\d*)\s*x\s*€?\s*([\d\.,]+)\s*=\s*€?\s*([\d\.,]+)/,/([A-Z0-9\-]+)\s+(.+?)\s+(\d+[\.,]?\d*)\s+€?\s*([\d\.,]+)\s+€?\s*([\d\.,]+)/];for(const i of r){const o=i.trim();if(o)for(const c of a){const d=o.match(c);if(d){let u;if(d.length===7)u={position:parseInt(d[1]),description:d[2].trim(),quantity:this.parseAmount(d[3]),unit:d[4]||"Stk",unitPrice:this.parseAmount(d[5]),totalPrice:this.parseAmount(d[6])};else if(d.length===5)u={description:d[1].trim(),quantity:this.parseAmount(d[2]),unitPrice:this.parseAmount(d[3]),totalPrice:this.parseAmount(d[4])};else if(d.length===6)u={articleNumber:d[1],description:d[2].trim(),quantity:this.parseAmount(d[3]),unitPrice:this.parseAmount(d[4]),totalPrice:this.parseAmount(d[5])};else continue;u.quantity>0&&u.totalPrice>0&&(n.push(u),console.log("Position gefunden:",u));break}}}return n}static extractInvoiceData(e){const n=e,r=e.replace(/\n/g," ").replace(/\s+/g," ").trim();console.log("OCR Clean Text:",r);const a={invoiceNumber:[/Rechnungs[\s-]*(?:Nr\.?|Nummer)\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Rechnung\s*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/(?:Rg|Re)[\s-]*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Invoice\s*(?:No\.?|Number)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Beleg[\s-]*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Nr\.?\s*[:.]\s*([A-Z0-9\-\/]{3,})/i],invoiceDate:[/Datum[:\s]*(\d{1,2}\.\d{1,2}\.\d{4})/i,/(?:rechnungsdatum|datum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:ausstellungsdatum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:datum der rechnung)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(\d{1,2}\.\d{1,2}\.\d{4})/],deliveryDate:[/(?:lieferdatum|leistungsdatum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:leistungszeitraum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i],dueDate:[/(?:fällig am|zahlbar bis|zahlungsziel)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:fälligkeit|zahlung bis)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i],totalAmount:[/Gesamtbetrag[:\s]*€?\s*([\d\.,]+)/i,/(?:gesamt(?:betrag|summe)|total|summe)[:\s]*€?\s*([\d\.,]+)/i,/(?:zu zahlen|zahlbetrag)[:\s]*€?\s*([\d\.,]+)/i,/Brutto[:\s]*€?\s*([\d\.,]+)/i,/([\d]{1,3}(?:\.\d{3})*,\d{2})\s*€/,/([\d\.,]+)\s*€/i,/€\s*([\d\.,]+)/i],netAmount:[/(?:netto(?:betrag|summe)?)[:\s]*€?\s*([\d\.,]+)/i,/(?:summe netto)[:\s]*€?\s*([\d\.,]+)/i,/(?:zwischensumme)[:\s]*€?\s*([\d\.,]+)/i],vatAmount:[/MwSt[.\s]*19%[:\s]*€?\s*([\d\.,]+)/i,/19%\s*MwSt[:\s]*€?\s*([\d\.,]+)/i,/(?:mwst|mehrwertsteuer|ust|vat)[:\s]*€?\s*([\d\.,]+)/i,/(?:steuer)[:\s]*€?\s*([\d\.,]+)/i,/(\d{1,2})\s*%\s*mwst[:\s]*€?\s*([\d\.,]+)/i,/190,00\s*€/],vatRate:[/(?:mwst|mehrwertsteuer|ust)[\s:]*(\d{1,2})\s*%/i,/(\d{1,2})\s*%\s*(?:mwst|steuer)/i],supplierName:[/([A-Za-zÄÖÜäöüß][A-Za-zÄÖÜäöüß\s&\-\.]{1,40}\s+(?:GmbH|AG|KG|OHG|GbR|e\.K\.|e\.V\.|UG|GmbH\s*&\s*Co\.?\s*KG))/i,/([A-Za-zÄÖÜäöüß][A-Za-zÄÖÜäöüß\s]{1,30}\s+(?:Handwerk|Bau|Elektro|Sanitär|Heizung|Malerei|Schreinerei|Tischlerei|Zimmerei))/i,/([A-Z][a-zäöüß]+\s+[A-Z][a-zäöüß]+)\s*(?:-|–|—)?\s*(?:Meisterbetrieb|Handwerksmeister|Inhaber)/i,/^([A-Z][A-Za-zÄÖÜäöüß\s&\-\.]{2,40})\s*\n/m,/([A-Za-zÄÖÜäöüß\s&\-]{3,30}(?:GmbH|AG|KG))/i],iban:[/iban[:\s]*([A-Z]{2}\d{2}[\s]?[\d\s]{10,30})/i,/([A-Z]{2}\d{2}[\s]?[\d\s]{16,20})/g],bic:[/(?:bic|swift)[:\s]*([A-Z]{6,11})/i],customerNumber:[/(?:kunden(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:kdnr|kd\.?nr)[:\s]*([A-Z0-9\-\/]+)/i],orderNumber:[/(?:auftrags(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:bestell(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:auftrag|bestellung)[:\s]*([A-Z0-9\-\/]+)/i],deliveryNoteNumber:[/(?:lieferschein(?:nummer|nr)?)[:\s]*([A-Z0-9\-\/]+)/i,/(?:ls[\s\-]?nr)[:\s]*([A-Z0-9\-\/]+)/i],projectNumber:[/(?:projekt(?:nummer|nr)?)[:\s]*([A-Z0-9\-\/]+)/i,/(?:bauvorhaben|baustelle)[:\s]*([A-Z0-9\-\/]+)/i],paymentTerms:[/(?:zahlungsbedingungen|zahlungsziel)[:\s]*([^\n]{5,50})/i,/(?:zahlung)[:\s]*([^\n]{5,50})/i],discountTerms:[/(\d{1,2})\s*%\s*(?:skonto|rabatt)(?:\s*bei\s*zahlung)?[^\n]*/i,/(?:skonto|rabatt)[:\s]*([^\n]{5,50})/i]},i={};console.log("Starting extraction from text:",r.substring(0,200));for(const c of a.invoiceNumber){const d=r.match(c);if(d){i.invoiceNumber=d[1].trim(),console.log("Rechnungsnummer gefunden:",d[1]);break}}if(!i.invoiceNumber){const c=r.match(/2020-001/);c&&(i.invoiceNumber=c[0],console.log("Rechnungsnummer per Fallback:",c[0]))}for(const c of a.invoiceDate){const d=r.match(c);if(d){i.date=this.parseDate(d[1]),i.invoiceDate=i.date;break}}for(const c of a.deliveryDate){const d=r.match(c);if(d){i.deliveryDate=this.parseDate(d[1]);break}}for(const c of a.dueDate){const d=r.match(c);if(d){i.dueDate=this.parseDate(d[1]);break}}for(const c of a.totalAmount){const d=r.match(c);if(d){i.totalAmount=this.parseAmount(d[1]);break}}for(const c of a.netAmount){const d=r.match(c);if(d){i.netAmount=this.parseAmount(d[1]);break}}for(const c of a.vatAmount){const d=r.match(c);if(d){const u=d[2]||d[1];i.vatAmount=this.parseAmount(u);break}}for(const c of a.vatRate){const d=r.match(c);if(d){i.vatRate=parseInt(d[1]);break}}for(const c of a.supplierName){const d=r.match(c);if(d&&d[1]&&d[1].length>3){i.supplierName=d[1].trim(),console.log("Supplier found:",d[1]);break}}i.supplierName||console.log("No supplier found in:",r.substring(0,100));for(const c of a.iban){const d=r.match(c);if(d&&d[1]){i.iban=d[1].replace(/\s/g,"");break}}for(const c of a.bic){const d=r.match(c);if(d&&d[1]){i.bic=d[1];break}}for(const c of a.customerNumber){const d=r.match(c);if(d&&d[1]){i.customerNumber=d[1];break}}for(const c of a.orderNumber){const d=r.match(c);if(d&&d[1]){i.orderNumber=d[1];break}}for(const c of a.deliveryNoteNumber){const d=r.match(c);if(d&&d[1]){i.deliveryNoteNumber=d[1];break}}for(const c of a.projectNumber){const d=r.match(c);if(d&&d[1]){i.projectNumber=d[1];break}}for(const c of a.paymentTerms){const d=r.match(c);if(d&&d[1]){i.paymentTerms=d[1].trim();break}}for(const c of a.discountTerms){const d=r.match(c);if(d){i.discountTerms=d[0].trim();break}}const o=this.extractInvoicePositions(n);if(o.length>0&&(i.positions=o,console.log(`${o.length} Positionen extrahiert`)),i.netAmount&&i.vatAmount&&!i.totalAmount&&(i.totalAmount=i.netAmount+i.vatAmount),i.totalAmount&&i.vatAmount&&!i.netAmount&&(i.netAmount=i.totalAmount-i.vatAmount),i.netAmount&&i.vatRate&&!i.vatAmount&&(i.vatAmount=i.netAmount*(i.vatRate/100)),o.length>0&&!i.totalAmount){const c=o.reduce((d,u)=>d+u.totalPrice,0);i.netAmount||(i.netAmount=c),i.vatRate?(i.vatAmount=c*(i.vatRate/100),i.totalAmount=c+i.vatAmount):i.totalAmount=c}return{invoiceNumber:i.invoiceNumber||"UNBEKANNT",date:i.date||i.invoiceDate||new Date().toISOString().split("T")[0],invoiceDate:i.invoiceDate,deliveryDate:i.deliveryDate,dueDate:i.dueDate,supplierName:i.supplierName||"UNBEKANNT",totalAmount:i.totalAmount||0,netAmount:i.netAmount,vatAmount:i.vatAmount,vatRate:i.vatRate,iban:i.iban,bic:i.bic,customerNumber:i.customerNumber,orderNumber:i.orderNumber,deliveryNoteNumber:i.deliveryNoteNumber,projectNumber:i.projectNumber,paymentTerms:i.paymentTerms,discountTerms:i.discountTerms,description:`OCR-Import vom ${new Date().toLocaleDateString("de-DE")}`}}static parseAmount(e){return parseFloat(e.replace(/\./g,"").replace(",",".").replace(/[^\d.]/g,""))||0}static parseDate(e){const n=e.split(/[\.\-\/]/);if(n.length===3){const r=n[0].padStart(2,"0"),a=n[1].padStart(2,"0");let i=n[2];return i.length===2&&(i=parseInt(i)>50?`19${i}`:`20${i}`),`${i}-${a}-${r}`}return new Date().toISOString().split("T")[0]}static calculateConfidenceScores(e,n){const r={overall:0,invoice_number:0,date:0,amount:0,supplier:0};n.invoiceNumber!=="UNBEKANNT"&&(r.invoice_number=/[A-Z0-9]{3,}/.test(n.invoiceNumber)?.9:.6);const a=/\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4}/;if(r.date=a.test(e)?.8:.3,n.totalAmount>0){const i=/€\s*[\d\.,]+|\d+[,\.]\d{2}/;r.amount=i.test(e)?.85:.4}return n.supplierName!=="UNBEKANNT"&&(r.supplier=n.supplierName.length>5?.7:.5),r.overall=r.invoice_number*.3+r.date*.2+r.amount*.3+r.supplier*.2,r}static async cleanup(){this.worker&&(await this.worker.terminate(),this.worker=null,this.isInitialized=!1)}}qn(k0,"worker",null),qn(k0,"isInitialized",!1);const Ht={PROJECT_KPIS:"project-kpis",PROJECT_KPIS_SUMMARY:"project-kpis-summary",NOTIFICATIONS:"notifications",NOTIFICATION_STATS:"notification-stats",WORKER_STATUS:"worker-status",AUDIT_LOGS:"audit-logs",AUDIT_TRAIL:"audit-trail",AUDIT_STATS:"audit-stats",NUMBER_SEQUENCES:"number-sequences",GOBD_DOCUMENTS:"gobd-documents",IMMUTABILITY_CHECK:"immutability-check",DATEV_EXPORTS:"datev-exports",DATEV_ACCOUNT_MAPPINGS:"datev-account-mappings",GERMAN_VAT_RETURNS:"german-vat-returns",GERMAN_PERIODS:"german-periods",GERMAN_EXPENSE_REPORTS:"german-expense-reports",AI_DOCUMENTS:"ai-documents",AI_SEARCH_RESULTS:"ai-search-results",AI_INTENT_ANALYSES:"ai-intent-analyses",AI_ESTIMATIONS:"ai-estimations",AI_INDEXING_STATUS:"ai-indexing-status",OCR_RESULTS:"ocr-results",OCR_RESULT:t=>["ocr-results",t],OCR_PENDING:"ocr-pending",customers:["customers"],customer:t=>["customers",t],customerStats:t=>["customers",t,"stats"],customerProjects:t=>["customers",t,"projects"],customerQuotes:t=>["customers",t,"quotes"],customerInvoices:t=>["customers",t,"invoices"],quotes:["quotes"],quote:t=>["quotes",t],quoteStats:["quotes","stats"],orders:["orders"],order:t=>["orders",t],orderStats:["orders","stats"],projects:["projects"],project:t=>["projects",t],projectStats:t=>["projects",t,"stats"],projectTimeline:t=>["projects",t,"timeline"],timesheets:["timesheets"],timesheet:t=>["timesheets",t],employeeTimesheetStats:t=>["timesheets","employee",t,"stats"],projectTimesheetSummary:t=>["timesheets","project",t,"summary"],materials:["materials"],material:t=>["materials",t],materialStats:["materials","stats"],lowStockMaterials:["materials","low-stock"],stockMovements:["stock-movements"],stockValuation:["stock","valuation"],stockAnalytics:["stock","analytics"],invoices:["invoices"],invoice:t=>["invoices",t],expenses:["expenses"],expense:t=>["expenses",t],financialKpis:["finance","kpis"],revenueByMonth:["finance","revenue-by-month"],expensesByCategory:["finance","expenses-by-category"],profitLossReport:["finance","profit-loss"],documents:["documents"],document:t=>["documents",t],documentStats:["documents","stats"],expiringDocuments:["documents","expiring"],employees:["employees"],employee:t=>["employees",t]},oR=(t,e,n)=>gr({queryKey:[...Ht.customers,t,e],queryFn:()=>Cg.getCustomers(t,e),...n}),UZ=t=>{const e=ns(),{toast:n}=Mt();return Xs({mutationFn:r=>Cg.createCustomer(r),onSuccess:r=>{e.invalidateQueries({queryKey:Ht.customers}),n({title:"Kunde erstellt",description:`${r.company_name} wurde erfolgreich erstellt.`})},onError:r=>{n({title:"Fehler beim Erstellen",description:r.message,variant:"destructive"})},...t})},qZ=t=>{const e=ns(),{toast:n}=Mt();return Xs({mutationFn:({id:r,data:a})=>TH.updateCustomer(r,a),onSuccess:(r,{id:a})=>{e.invalidateQueries({queryKey:Ht.customers}),e.invalidateQueries({queryKey:Ht.customer(a)}),e.invalidateQueries({queryKey:Ht.customerStats(a)}),n({title:"Kunde aktualisiert",description:`${r.company_name} wurde erfolgreich aktualisiert.`})},onError:r=>{n({title:"Fehler beim Aktualisieren",description:r.message,variant:"destructive"})},...t})},WZ=t=>{const e=ns(),{toast:n}=Mt();return Xs({mutationFn:r=>Cg.deleteCustomer(r),onSuccess:(r,a)=>{e.invalidateQueries({queryKey:Ht.customers}),e.removeQueries({queryKey:Ht.customer(a)}),n({title:"Kunde gelöscht",description:"Der Kunde wurde erfolgreich gelöscht."})},onError:r=>{n({title:"Fehler beim Löschen",description:r.message,variant:"destructive"})},...t})},HZ=(t,e,n)=>gr({queryKey:[...Ht.quotes,t,e],queryFn:()=>Eg.getQuotes(t,e),...n}),VZ=t=>{const e=ns(),{toast:n}=Mt();return Xs({mutationFn:Eg.createQuote,onSuccess:r=>{e.invalidateQueries({queryKey:Ht.quotes}),e.invalidateQueries({queryKey:Ht.customerQuotes(r.customer_id)}),n({title:"Angebot erstellt",description:`${r.title} wurde erfolgreich erstellt.`})},onError:r=>{n({title:"Fehler beim Erstellen",description:r.message,variant:"destructive"})},...t})},KZ=t=>{const e=ns(),{toast:n}=Mt();return Xs({mutationFn:({id:r,data:a})=>Eg.updateQuote(r,a),onSuccess:(r,{id:a})=>{e.invalidateQueries({queryKey:Ht.quotes}),e.invalidateQueries({queryKey:Ht.quote(a)}),n({title:"Angebot aktualisiert",description:`${r.title} wurde erfolgreich aktualisiert.`})},onError:r=>{n({title:"Fehler beim Aktualisieren",description:r.message,variant:"destructive"})},...t})},ZZ=t=>{const e=ns(),{toast:n}=Mt();return Xs({mutationFn:Eg.acceptQuote,onSuccess:(r,a)=>{e.invalidateQueries({queryKey:Ht.quotes}),e.invalidateQueries({queryKey:Ht.quote(a)}),e.invalidateQueries({queryKey:Ht.orders}),n({title:"Angebot angenommen",description:`${r.quote.title} wurde angenommen und ein Auftrag erstellt.`})},onError:r=>{n({title:"Fehler beim Annehmen",description:r.message,variant:"destructive"})},...t})},lR=(t,e,n)=>gr({queryKey:[...Ht.projects,t,e],queryFn:()=>CT.getProjects(t,e),...n}),cR=t=>{const e=ns(),{toast:n}=Mt();return Xs({mutationFn:CT.createProject,onSuccess:r=>{e.invalidateQueries({queryKey:Ht.projects}),e.invalidateQueries({queryKey:Ht.customerProjects(r.customer_id||"")}),n({title:"Projekt erstellt",description:`${r.name} wurde erfolgreich erstellt.`})},onError:r=>{n({title:"Fehler beim Erstellen",description:r.message,variant:"destructive"})},...t})},GZ=(t,e,n)=>gr({queryKey:[...Ht.timesheets,t,e],queryFn:()=>Mj.getTimesheets(t,e),...n}),QZ=t=>{const e=ns(),{toast:n}=Mt();return Xs({mutationFn:Mj.createTimesheet,onSuccess:r=>{e.invalidateQueries({queryKey:Ht.timesheets}),e.invalidateQueries({queryKey:Ht.projectStats(r.project_id||"")}),e.invalidateQueries({queryKey:Ht.employeeTimesheetStats(r.employee_id)}),n({title:"Zeiteintrag erstellt",description:"Der Zeiteintrag wurde erfolgreich erstellt."})},onError:r=>{n({title:"Fehler beim Erstellen",description:r.message,variant:"destructive"})},...t})},YZ=t=>{const e=ns(),{toast:n}=Mt();return Xs({mutationFn:({id:r,data:a})=>Mj.updateTimesheet(r,a),onSuccess:(r,{id:a})=>{e.invalidateQueries({queryKey:Ht.timesheets}),e.invalidateQueries({queryKey:Ht.timesheet(a)}),n({title:"Zeiteintrag aktualisiert",description:"Der Zeiteintrag wurde erfolgreich aktualisiert."})},onError:r=>{n({title:"Fehler beim Aktualisieren",description:r.message,variant:"destructive"})},...t})},dR=(t,e,n)=>gr({queryKey:[...Ht.invoices,t,e],queryFn:()=>Ag.getInvoices(t,e),...n}),uR=t=>{const e=ns(),{toast:n}=Mt();return Xs({mutationFn:Ag.createInvoice,onSuccess:r=>{e.invalidateQueries({queryKey:Ht.invoices}),e.invalidateQueries({queryKey:Ht.financialKpis}),n({title:"Rechnung erstellt",description:`${r.invoice_number||"Rechnung"} wurde erfolgreich erstellt.`})},onError:r=>{n({title:"Fehler beim Erstellen",description:r.message,variant:"destructive"})},...t})},XZ=(t,e,n)=>gr({queryKey:[...Ht.expenses,t,e],queryFn:()=>Ag.getExpenses(t,e),...n}),JZ=(t,e)=>gr({queryKey:[...Ht.financialKpis,t],queryFn:()=>Ag.getFinancialKPIs(t),...e}),eG=(t,e,n)=>gr({queryKey:[...Ht.documents,t,e],queryFn:()=>zH.getDocuments(t,e),...n}),o1=t=>gr({queryKey:Ht.employees,queryFn:async()=>{var e,n;try{const{data:{session:r}}=await Z.auth.getSession();if(!r)return console.log("useEmployees: No session found"),{items:[]};const a=((e=r.user.user_metadata)==null?void 0:e.company_id)||((n=r.user.app_metadata)==null?void 0:n.company_id)||r.user.id;if(console.log("useEmployees: Using company_id:",a),console.log("useEmployees: Session user:",r.user),!a)return console.error("useEmployees: No company ID available"),{items:[]};const{data:i,error:o}=await Z.from("employees").select("id, email, status, user_id, company_id").eq("company_id",a);console.log("useEmployees: DEBUG - All employees for company:",i);const{data:c,error:d}=await Z.from("employees").select(`
            id,
            user_id,
            first_name,
            last_name,
            email,
            phone,
            position,
            status,
            qualifications,
            license,
            company_id
          `).not("user_id","is",null).in("status",["active","Active","aktiv","Aktiv"]).order("created_at",{ascending:!1});if(console.log("useEmployees: Raw query (no company filter):",c),console.log("useEmployees: Employees query result:",c,d),d)return console.error("useEmployees: Error fetching employees:",d),{items:[]};const u=(c==null?void 0:c.filter(p=>p.user_id).map(p=>p.user_id))||[];let m=[];if(u.length>0){const{data:p,error:x}=await Z.from("profiles").select("id, first_name, last_name").in("id",u);x||(m=p||[])}const f=(c==null?void 0:c.map(p=>{const x=m.find(_=>_.id===p.user_id),j=(x==null?void 0:x.first_name)||p.first_name||"",v=(x==null?void 0:x.last_name)||p.last_name||"";return{id:p.id,first_name:j,last_name:v,name:`${j} ${v}`.trim(),email:p.email,phone:p.phone,position:p.position,status:p.status,qualifications:Array.isArray(p.qualifications)?p.qualifications:[],license:p.license}}))||[];return console.log("useEmployees: Final employee list:",f),{items:f}}catch(r){return console.error("useEmployees: Catch block error:",r),{items:[]}}},...t}),tG=t=>{const e=ns();return Mt(),Xs({mutationFn:async n=>{const{error:r}=await Z.from("employees").delete().eq("id",n);if(r)throw new Error(r.message)},onSuccess:()=>{e.invalidateQueries({queryKey:Ht.employees})},...t})},nG=t=>{const e=ns(),{toast:n}=Mt();return Xs({mutationFn:r=>k0.processInvoiceImage(r),onSuccess:r=>{e.invalidateQueries({queryKey:[Ht.OCR_RESULTS]}),e.invalidateQueries({queryKey:[Ht.OCR_PENDING]}),n({title:"OCR-Verarbeitung abgeschlossen",description:`Rechnung von "${r.structured_data.supplierName}" wurde verarbeitet.`})},onError:r=>{n({title:"OCR-Verarbeitung fehlgeschlagen",description:r.message,variant:"destructive"})},...t})},sG=(t,e)=>gr({queryKey:[Ht.OCR_RESULTS,t],queryFn:()=>k0.getOCRResults(t),staleTime:5*60*1e3,...e}),rG=t=>sG("pending",t);var dy="focusScope.autoFocusOnMount",uy="focusScope.autoFocusOnUnmount",wC={bubbles:!1,cancelable:!0},aG="FocusScope",Pf=g.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=t,[c,d]=g.useState(null),u=_n(a),m=_n(i),f=g.useRef(null),p=Tt(e,v=>d(v)),x=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let v=function(N){if(x.paused||!c)return;const S=N.target;c.contains(S)?f.current=S:qi(f.current,{select:!0})},_=function(N){if(x.paused||!c)return;const S=N.relatedTarget;S!==null&&(c.contains(S)||qi(f.current,{select:!0}))},b=function(N){if(document.activeElement===document.body)for(const C of N)C.removedNodes.length>0&&qi(c)};document.addEventListener("focusin",v),document.addEventListener("focusout",_);const w=new MutationObserver(b);return c&&w.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",_),w.disconnect()}}},[r,c,x.paused]),g.useEffect(()=>{if(c){jC.add(x);const v=document.activeElement;if(!c.contains(v)){const b=new CustomEvent(dy,wC);c.addEventListener(dy,u),c.dispatchEvent(b),b.defaultPrevented||(iG(uG(hR(c)),{select:!0}),document.activeElement===v&&qi(c))}return()=>{c.removeEventListener(dy,u),setTimeout(()=>{const b=new CustomEvent(uy,wC);c.addEventListener(uy,m),c.dispatchEvent(b),b.defaultPrevented||qi(v??document.body,{select:!0}),c.removeEventListener(uy,m),jC.remove(x)},0)}}},[c,u,m,x]);const j=g.useCallback(v=>{if(!n&&!r||x.paused)return;const _=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,b=document.activeElement;if(_&&b){const w=v.currentTarget,[N,S]=oG(w);N&&S?!v.shiftKey&&b===S?(v.preventDefault(),n&&qi(N,{select:!0})):v.shiftKey&&b===N&&(v.preventDefault(),n&&qi(S,{select:!0})):b===w&&v.preventDefault()}},[n,r,x.paused]);return s.jsx(nt.div,{tabIndex:-1,...o,ref:p,onKeyDown:j})});Pf.displayName=aG;function iG(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(qi(r,{select:e}),document.activeElement!==n)return}function oG(t){const e=hR(t),n=bC(e,t),r=bC(e.reverse(),t);return[n,r]}function hR(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function bC(t,e){for(const n of t)if(!lG(n,{upTo:e}))return n}function lG(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function cG(t){return t instanceof HTMLInputElement&&"select"in t}function qi(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&cG(t)&&e&&t.select()}}var jC=dG();function dG(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=NC(t,e),t.unshift(e)},remove(e){var n;t=NC(t,e),(n=t[0])==null||n.resume()}}}function NC(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function uG(t){return t.filter(e=>e.tagName!=="A")}var hy=0;function Fg(){g.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??SC()),document.body.insertAdjacentElement("beforeend",t[1]??SC()),hy++,()=>{hy===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),hy--}},[])}function SC(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Da=function(){return Da=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Da.apply(this,arguments)};function fR(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}function hG(t,e,n){if(n||arguments.length===2)for(var r=0,a=e.length,i;r<a;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var Np="right-scroll-bar-position",Sp="width-before-scroll-bar",fG="with-scroll-bars-hidden",mG="--removed-body-scroll-bar-size";function fy(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function pG(t,e){var n=g.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=e,n.facade}var gG=typeof window<"u"?g.useLayoutEffect:g.useEffect,kC=new WeakMap;function xG(t,e){var n=pG(null,function(r){return t.forEach(function(a){return fy(a,r)})});return gG(function(){var r=kC.get(n);if(r){var a=new Set(r),i=new Set(t),o=n.current;a.forEach(function(c){i.has(c)||fy(c,null)}),i.forEach(function(c){a.has(c)||fy(c,o)})}kC.set(n,t)},[t]),n}function vG(t){return t}function yG(t,e){e===void 0&&(e=vG);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(c){return c!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(c){return i(c)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var c=n;n=[],c.forEach(i),o=n}var d=function(){var m=o;o=[],m.forEach(i)},u=function(){return Promise.resolve().then(d)};u(),n={push:function(m){o.push(m),u()},filter:function(m){return o=o.filter(m),n}}}};return a}function _G(t){t===void 0&&(t={});var e=yG(null);return e.options=Da({async:!0,ssr:!1},t),e}var mR=function(t){var e=t.sideCar,n=fR(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,Da({},n))};mR.isSideCarExport=!0;function wG(t,e){return t.useMedium(e),mR}var pR=_G(),my=function(){},Bg=g.forwardRef(function(t,e){var n=g.useRef(null),r=g.useState({onScrollCapture:my,onWheelCapture:my,onTouchMoveCapture:my}),a=r[0],i=r[1],o=t.forwardProps,c=t.children,d=t.className,u=t.removeScrollBar,m=t.enabled,f=t.shards,p=t.sideCar,x=t.noIsolation,j=t.inert,v=t.allowPinchZoom,_=t.as,b=_===void 0?"div":_,w=t.gapMode,N=fR(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=p,C=xG([n,e]),A=Da(Da({},N),a);return g.createElement(g.Fragment,null,m&&g.createElement(S,{sideCar:pR,removeScrollBar:u,shards:f,noIsolation:x,inert:j,setCallbacks:i,allowPinchZoom:!!v,lockRef:n,gapMode:w}),o?g.cloneElement(g.Children.only(c),Da(Da({},A),{ref:C})):g.createElement(b,Da({},A,{className:d,ref:C}),c))});Bg.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Bg.classNames={fullWidth:Sp,zeroRight:Np};var bG=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function jG(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=bG();return e&&t.setAttribute("nonce",e),t}function NG(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function SG(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var kG=function(){var t=0,e=null;return{add:function(n){t==0&&(e=jG())&&(NG(e,n),SG(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},CG=function(){var t=kG();return function(e,n){g.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},gR=function(){var t=CG(),e=function(n){var r=n.styles,a=n.dynamic;return t(r,a),null};return e},EG={left:0,top:0,right:0,gap:0},py=function(t){return parseInt(t||"",10)||0},AG=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],a=e[t==="padding"?"paddingRight":"marginRight"];return[py(n),py(r),py(a)]},PG=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return EG;var e=AG(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},DG=gR(),Jc="data-scroll-locked",TG=function(t,e,n,r){var a=t.left,i=t.top,o=t.right,c=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(fG,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(c,"px ").concat(r,`;
  }
  body[`).concat(Jc,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(c,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Np,` {
    right: `).concat(c,"px ").concat(r,`;
  }
  
  .`).concat(Sp,` {
    margin-right: `).concat(c,"px ").concat(r,`;
  }
  
  .`).concat(Np," .").concat(Np,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Sp," .").concat(Sp,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Jc,`] {
    `).concat(mG,": ").concat(c,`px;
  }
`)},CC=function(){var t=parseInt(document.body.getAttribute(Jc)||"0",10);return isFinite(t)?t:0},MG=function(){g.useEffect(function(){return document.body.setAttribute(Jc,(CC()+1).toString()),function(){var t=CC()-1;t<=0?document.body.removeAttribute(Jc):document.body.setAttribute(Jc,t.toString())}},[])},RG=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,a=r===void 0?"margin":r;MG();var i=g.useMemo(function(){return PG(a)},[a]);return g.createElement(DG,{styles:TG(i,!e,a,n?"":"!important")})},Rw=!1;if(typeof window<"u")try{var Wm=Object.defineProperty({},"passive",{get:function(){return Rw=!0,!0}});window.addEventListener("test",Wm,Wm),window.removeEventListener("test",Wm,Wm)}catch{Rw=!1}var xc=Rw?{passive:!1}:!1,IG=function(t){return t.tagName==="TEXTAREA"},xR=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!IG(t)&&n[e]==="visible")},OG=function(t){return xR(t,"overflowY")},LG=function(t){return xR(t,"overflowX")},EC=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=vR(t,r);if(a){var i=yR(t,r),o=i[1],c=i[2];if(o>c)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},FG=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},BG=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},vR=function(t,e){return t==="v"?OG(e):LG(e)},yR=function(t,e){return t==="v"?FG(e):BG(e)},zG=function(t,e){return t==="h"&&e==="rtl"?-1:1},$G=function(t,e,n,r,a){var i=zG(t,window.getComputedStyle(e).direction),o=i*r,c=n.target,d=e.contains(c),u=!1,m=o>0,f=0,p=0;do{var x=yR(t,c),j=x[0],v=x[1],_=x[2],b=v-_-i*j;(j||b)&&vR(t,c)&&(f+=b,p+=j),c instanceof ShadowRoot?c=c.host:c=c.parentNode}while(!d&&c!==document.body||d&&(e.contains(c)||e===c));return(m&&(Math.abs(f)<1||!a)||!m&&(Math.abs(p)<1||!a))&&(u=!0),u},Hm=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},AC=function(t){return[t.deltaX,t.deltaY]},PC=function(t){return t&&"current"in t?t.current:t},UG=function(t,e){return t[0]===e[0]&&t[1]===e[1]},qG=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},WG=0,vc=[];function HG(t){var e=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(WG++)[0],i=g.useState(gR)[0],o=g.useRef(t);g.useEffect(function(){o.current=t},[t]),g.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var v=hG([t.lockRef.current],(t.shards||[]).map(PC),!0).filter(Boolean);return v.forEach(function(_){return _.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),v.forEach(function(_){return _.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var c=g.useCallback(function(v,_){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!o.current.allowPinchZoom;var b=Hm(v),w=n.current,N="deltaX"in v?v.deltaX:w[0]-b[0],S="deltaY"in v?v.deltaY:w[1]-b[1],C,A=v.target,P=Math.abs(N)>Math.abs(S)?"h":"v";if("touches"in v&&P==="h"&&A.type==="range")return!1;var M=EC(P,A);if(!M)return!0;if(M?C=P:(C=P==="v"?"h":"v",M=EC(P,A)),!M)return!1;if(!r.current&&"changedTouches"in v&&(N||S)&&(r.current=C),!C)return!0;var z=r.current||C;return $G(z,_,v,z==="h"?N:S,!0)},[]),d=g.useCallback(function(v){var _=v;if(!(!vc.length||vc[vc.length-1]!==i)){var b="deltaY"in _?AC(_):Hm(_),w=e.current.filter(function(C){return C.name===_.type&&(C.target===_.target||_.target===C.shadowParent)&&UG(C.delta,b)})[0];if(w&&w.should){_.cancelable&&_.preventDefault();return}if(!w){var N=(o.current.shards||[]).map(PC).filter(Boolean).filter(function(C){return C.contains(_.target)}),S=N.length>0?c(_,N[0]):!o.current.noIsolation;S&&_.cancelable&&_.preventDefault()}}},[]),u=g.useCallback(function(v,_,b,w){var N={name:v,delta:_,target:b,should:w,shadowParent:VG(b)};e.current.push(N),setTimeout(function(){e.current=e.current.filter(function(S){return S!==N})},1)},[]),m=g.useCallback(function(v){n.current=Hm(v),r.current=void 0},[]),f=g.useCallback(function(v){u(v.type,AC(v),v.target,c(v,t.lockRef.current))},[]),p=g.useCallback(function(v){u(v.type,Hm(v),v.target,c(v,t.lockRef.current))},[]);g.useEffect(function(){return vc.push(i),t.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:p}),document.addEventListener("wheel",d,xc),document.addEventListener("touchmove",d,xc),document.addEventListener("touchstart",m,xc),function(){vc=vc.filter(function(v){return v!==i}),document.removeEventListener("wheel",d,xc),document.removeEventListener("touchmove",d,xc),document.removeEventListener("touchstart",m,xc)}},[]);var x=t.removeScrollBar,j=t.inert;return g.createElement(g.Fragment,null,j?g.createElement(i,{styles:qG(a)}):null,x?g.createElement(RG,{gapMode:t.gapMode}):null)}function VG(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const KG=wG(pR,HG);var Df=g.forwardRef(function(t,e){return g.createElement(Bg,Da({},t,{ref:e,sideCar:KG}))});Df.classNames=Bg.classNames;var ZG=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},yc=new WeakMap,Vm=new WeakMap,Km={},gy=0,_R=function(t){return t&&(t.host||_R(t.parentNode))},GG=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=_R(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},QG=function(t,e,n,r){var a=GG(e,Array.isArray(t)?t:[t]);Km[n]||(Km[n]=new WeakMap);var i=Km[n],o=[],c=new Set,d=new Set(a),u=function(f){!f||c.has(f)||(c.add(f),u(f.parentNode))};a.forEach(u);var m=function(f){!f||d.has(f)||Array.prototype.forEach.call(f.children,function(p){if(c.has(p))m(p);else try{var x=p.getAttribute(r),j=x!==null&&x!=="false",v=(yc.get(p)||0)+1,_=(i.get(p)||0)+1;yc.set(p,v),i.set(p,_),o.push(p),v===1&&j&&Vm.set(p,!0),_===1&&p.setAttribute(n,"true"),j||p.setAttribute(r,"true")}catch(b){console.error("aria-hidden: cannot operate on ",p,b)}})};return m(e),c.clear(),gy++,function(){o.forEach(function(f){var p=yc.get(f)-1,x=i.get(f)-1;yc.set(f,p),i.set(f,x),p||(Vm.has(f)||f.removeAttribute(r),Vm.delete(f)),x||f.removeAttribute(n)}),gy--,gy||(yc=new WeakMap,yc=new WeakMap,Vm=new WeakMap,Km={})}},zg=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),a=ZG(t);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),QG(r,a,n,"aria-hidden")):function(){return null}},l1="Dialog",[wR,gae]=wr(l1),[YG,ma]=wR(l1),bR=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:a,onOpenChange:i,modal:o=!0}=t,c=g.useRef(null),d=g.useRef(null),[u=!1,m]=Lr({prop:r,defaultProp:a,onChange:i});return s.jsx(YG,{scope:e,triggerRef:c,contentRef:d,contentId:dr(),titleId:dr(),descriptionId:dr(),open:u,onOpenChange:m,onOpenToggle:g.useCallback(()=>m(f=>!f),[m]),modal:o,children:n})};bR.displayName=l1;var jR="DialogTrigger",NR=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=ma(jR,n),i=Tt(e,a.triggerRef);return s.jsx(nt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":u1(a.open),...r,ref:i,onClick:Re(t.onClick,a.onOpenToggle)})});NR.displayName=jR;var c1="DialogPortal",[XG,SR]=wR(c1,{forceMount:void 0}),kR=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:a}=t,i=ma(c1,e);return s.jsx(XG,{scope:e,forceMount:n,children:g.Children.map(r,o=>s.jsx(Gn,{present:n||i.open,children:s.jsx(Od,{asChild:!0,container:a,children:o})}))})};kR.displayName=c1;var C0="DialogOverlay",CR=g.forwardRef((t,e)=>{const n=SR(C0,t.__scopeDialog),{forceMount:r=n.forceMount,...a}=t,i=ma(C0,t.__scopeDialog);return i.modal?s.jsx(Gn,{present:r||i.open,children:s.jsx(JG,{...a,ref:e})}):null});CR.displayName=C0;var JG=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=ma(C0,n);return s.jsx(Df,{as:wi,allowPinchZoom:!0,shards:[a.contentRef],children:s.jsx(nt.div,{"data-state":u1(a.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Bl="DialogContent",ER=g.forwardRef((t,e)=>{const n=SR(Bl,t.__scopeDialog),{forceMount:r=n.forceMount,...a}=t,i=ma(Bl,t.__scopeDialog);return s.jsx(Gn,{present:r||i.open,children:i.modal?s.jsx(eQ,{...a,ref:e}):s.jsx(tQ,{...a,ref:e})})});ER.displayName=Bl;var eQ=g.forwardRef((t,e)=>{const n=ma(Bl,t.__scopeDialog),r=g.useRef(null),a=Tt(e,n.contentRef,r);return g.useEffect(()=>{const i=r.current;if(i)return zg(i)},[]),s.jsx(AR,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Re(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Re(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,c=o.button===0&&o.ctrlKey===!0;(o.button===2||c)&&i.preventDefault()}),onFocusOutside:Re(t.onFocusOutside,i=>i.preventDefault())})}),tQ=g.forwardRef((t,e)=>{const n=ma(Bl,t.__scopeDialog),r=g.useRef(!1),a=g.useRef(!1);return s.jsx(AR,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,c;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(c=n.triggerRef.current)==null||c.focus(),i.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:i=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),AR=g.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:i,...o}=t,c=ma(Bl,n),d=g.useRef(null),u=Tt(e,d);return Fg(),s.jsxs(s.Fragment,{children:[s.jsx(Pf,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:i,children:s.jsx(Hl,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":u1(c.open),...o,ref:u,onDismiss:()=>c.onOpenChange(!1)})}),s.jsxs(s.Fragment,{children:[s.jsx(nQ,{titleId:c.titleId}),s.jsx(rQ,{contentRef:d,descriptionId:c.descriptionId})]})]})}),d1="DialogTitle",PR=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=ma(d1,n);return s.jsx(nt.h2,{id:a.titleId,...r,ref:e})});PR.displayName=d1;var DR="DialogDescription",TR=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=ma(DR,n);return s.jsx(nt.p,{id:a.descriptionId,...r,ref:e})});TR.displayName=DR;var MR="DialogClose",RR=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=ma(MR,n);return s.jsx(nt.button,{type:"button",...r,ref:e,onClick:Re(t.onClick,()=>a.onOpenChange(!1))})});RR.displayName=MR;function u1(t){return t?"open":"closed"}var IR="DialogTitleWarning",[xae,OR]=oF(IR,{contentName:Bl,titleName:d1,docsSlug:"dialog"}),nQ=({titleId:t})=>{const e=OR(IR),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return g.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},sQ="DialogDescriptionWarning",rQ=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${OR(sQ).contentName}}.`;return g.useEffect(()=>{var i;const a=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&a&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},LR=bR,FR=NR,BR=kR,$g=CR,Ug=ER,qg=PR,Wg=TR,zR=RR;const Kt=LR,aQ=FR,iQ=BR,$R=g.forwardRef(({className:t,...e},n)=>s.jsx($g,{ref:n,className:Te("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));$R.displayName=$g.displayName;const Wt=g.forwardRef(({className:t,children:e,...n},r)=>s.jsxs(iQ,{children:[s.jsx($R,{}),s.jsxs(Ug,{ref:r,className:Te("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,s.jsxs(zR,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[s.jsx(Ln,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Wt.displayName=Ug.displayName;const Jt=({className:t,...e})=>s.jsx("div",{className:Te("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Jt.displayName="DialogHeader";const ed=({className:t,...e})=>s.jsx("div",{className:Te("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});ed.displayName="DialogFooter";const en=g.forwardRef(({className:t,...e},n)=>s.jsx(qg,{ref:n,className:Te("text-lg font-semibold leading-none tracking-tight",t),...e}));en.displayName=qg.displayName;const $n=g.forwardRef(({className:t,...e},n)=>s.jsx(Wg,{ref:n,className:Te("text-sm text-muted-foreground",t),...e}));$n.displayName=Wg.displayName;function Iw(t,[e,n]){return Math.min(n,Math.max(e,t))}function UR(t){const e=g.useRef({value:t,previous:t});return g.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var oQ=[" ","Enter","ArrowUp","ArrowDown"],lQ=[" ","Enter"],Tf="Select",[Hg,Vg,cQ]=pf(Tf),[Xd,vae]=wr(Tf,[cQ,zo]),Kg=zo(),[dQ,qo]=Xd(Tf),[uQ,hQ]=Xd(Tf),qR=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:a,onOpenChange:i,value:o,defaultValue:c,onValueChange:d,dir:u,name:m,autoComplete:f,disabled:p,required:x,form:j}=t,v=Kg(e),[_,b]=g.useState(null),[w,N]=g.useState(null),[S,C]=g.useState(!1),A=Gd(u),[P=!1,M]=Lr({prop:r,defaultProp:a,onChange:i}),[z,R]=Lr({prop:o,defaultProp:c,onChange:d}),D=g.useRef(null),B=_?j||!!_.closest("form"):!0,[W,X]=g.useState(new Set),ue=Array.from(W).map(de=>de.props.value).join(";");return s.jsx(cj,{...v,children:s.jsxs(dQ,{required:x,scope:e,trigger:_,onTriggerChange:b,valueNode:w,onValueNodeChange:N,valueNodeHasChildren:S,onValueNodeHasChildrenChange:C,contentId:dr(),value:z,onValueChange:R,open:P,onOpenChange:M,dir:A,triggerPointerDownPosRef:D,disabled:p,children:[s.jsx(Hg.Provider,{scope:e,children:s.jsx(uQ,{scope:t.__scopeSelect,onNativeOptionAdd:g.useCallback(de=>{X(G=>new Set(G).add(de))},[]),onNativeOptionRemove:g.useCallback(de=>{X(G=>{const I=new Set(G);return I.delete(de),I})},[]),children:n})}),B?s.jsxs(m3,{"aria-hidden":!0,required:x,tabIndex:-1,name:m,autoComplete:f,value:z,onChange:de=>R(de.target.value),disabled:p,form:j,children:[z===void 0?s.jsx("option",{value:""}):null,Array.from(W)]},ue):null]})})};qR.displayName=Tf;var WR="SelectTrigger",HR=g.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...a}=t,i=Kg(n),o=qo(WR,n),c=o.disabled||r,d=Tt(e,o.onTriggerChange),u=Vg(n),m=g.useRef("touch"),[f,p,x]=p3(v=>{const _=u().filter(N=>!N.disabled),b=_.find(N=>N.value===o.value),w=g3(_,v,b);w!==void 0&&o.onValueChange(w.value)}),j=v=>{c||(o.onOpenChange(!0),x()),v&&(o.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return s.jsx(wf,{asChild:!0,...i,children:s.jsx(nt.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":f3(o.value)?"":void 0,...a,ref:d,onClick:Re(a.onClick,v=>{v.currentTarget.focus(),m.current!=="mouse"&&j(v)}),onPointerDown:Re(a.onPointerDown,v=>{m.current=v.pointerType;const _=v.target;_.hasPointerCapture(v.pointerId)&&_.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(j(v),v.preventDefault())}),onKeyDown:Re(a.onKeyDown,v=>{const _=f.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&p(v.key),!(_&&v.key===" ")&&oQ.includes(v.key)&&(j(),v.preventDefault())})})})});HR.displayName=WR;var VR="SelectValue",KR=g.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:a,children:i,placeholder:o="",...c}=t,d=qo(VR,n),{onValueNodeHasChildrenChange:u}=d,m=i!==void 0,f=Tt(e,d.onValueNodeChange);return Bn(()=>{u(m)},[u,m]),s.jsx(nt.span,{...c,ref:f,style:{pointerEvents:"none"},children:f3(d.value)?s.jsx(s.Fragment,{children:o}):i})});KR.displayName=VR;var fQ="SelectIcon",ZR=g.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...a}=t;return s.jsx(nt.span,{"aria-hidden":!0,...a,ref:e,children:r||"▼"})});ZR.displayName=fQ;var mQ="SelectPortal",GR=t=>s.jsx(Od,{asChild:!0,...t});GR.displayName=mQ;var zl="SelectContent",QR=g.forwardRef((t,e)=>{const n=qo(zl,t.__scopeSelect),[r,a]=g.useState();if(Bn(()=>{a(new DocumentFragment)},[]),!n.open){const i=r;return i?Wl.createPortal(s.jsx(YR,{scope:t.__scopeSelect,children:s.jsx(Hg.Slot,{scope:t.__scopeSelect,children:s.jsx("div",{children:t.children})})}),i):null}return s.jsx(XR,{...t,ref:e})});QR.displayName=zl;var Wr=10,[YR,Wo]=Xd(zl),pQ="SelectContentImpl",XR=g.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:c,sideOffset:d,align:u,alignOffset:m,arrowPadding:f,collisionBoundary:p,collisionPadding:x,sticky:j,hideWhenDetached:v,avoidCollisions:_,...b}=t,w=qo(zl,n),[N,S]=g.useState(null),[C,A]=g.useState(null),P=Tt(e,q=>S(q)),[M,z]=g.useState(null),[R,D]=g.useState(null),B=Vg(n),[W,X]=g.useState(!1),ue=g.useRef(!1);g.useEffect(()=>{if(N)return zg(N)},[N]),Fg();const de=g.useCallback(q=>{const[ne,...pe]=B().map(me=>me.ref.current),[Q]=pe.slice(-1),re=document.activeElement;for(const me of q)if(me===re||(me==null||me.scrollIntoView({block:"nearest"}),me===ne&&C&&(C.scrollTop=0),me===Q&&C&&(C.scrollTop=C.scrollHeight),me==null||me.focus(),document.activeElement!==re))return},[B,C]),G=g.useCallback(()=>de([M,N]),[de,M,N]);g.useEffect(()=>{W&&G()},[W,G]);const{onOpenChange:I,triggerPointerDownPosRef:V}=w;g.useEffect(()=>{if(N){let q={x:0,y:0};const ne=Q=>{var re,me;q={x:Math.abs(Math.round(Q.pageX)-(((re=V.current)==null?void 0:re.x)??0)),y:Math.abs(Math.round(Q.pageY)-(((me=V.current)==null?void 0:me.y)??0))}},pe=Q=>{q.x<=10&&q.y<=10?Q.preventDefault():N.contains(Q.target)||I(!1),document.removeEventListener("pointermove",ne),V.current=null};return V.current!==null&&(document.addEventListener("pointermove",ne),document.addEventListener("pointerup",pe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ne),document.removeEventListener("pointerup",pe,{capture:!0})}}},[N,I,V]),g.useEffect(()=>{const q=()=>I(!1);return window.addEventListener("blur",q),window.addEventListener("resize",q),()=>{window.removeEventListener("blur",q),window.removeEventListener("resize",q)}},[I]);const[$,F]=p3(q=>{const ne=B().filter(re=>!re.disabled),pe=ne.find(re=>re.ref.current===document.activeElement),Q=g3(ne,q,pe);Q&&setTimeout(()=>Q.ref.current.focus())}),O=g.useCallback((q,ne,pe)=>{const Q=!ue.current&&!pe;(w.value!==void 0&&w.value===ne||Q)&&(z(q),Q&&(ue.current=!0))},[w.value]),K=g.useCallback(()=>N==null?void 0:N.focus(),[N]),U=g.useCallback((q,ne,pe)=>{const Q=!ue.current&&!pe;(w.value!==void 0&&w.value===ne||Q)&&D(q)},[w.value]),te=r==="popper"?Ow:JR,J=te===Ow?{side:c,sideOffset:d,align:u,alignOffset:m,arrowPadding:f,collisionBoundary:p,collisionPadding:x,sticky:j,hideWhenDetached:v,avoidCollisions:_}:{};return s.jsx(YR,{scope:n,content:N,viewport:C,onViewportChange:A,itemRefCallback:O,selectedItem:M,onItemLeave:K,itemTextRefCallback:U,focusSelectedItem:G,selectedItemText:R,position:r,isPositioned:W,searchRef:$,children:s.jsx(Df,{as:wi,allowPinchZoom:!0,children:s.jsx(Pf,{asChild:!0,trapped:w.open,onMountAutoFocus:q=>{q.preventDefault()},onUnmountAutoFocus:Re(a,q=>{var ne;(ne=w.trigger)==null||ne.focus({preventScroll:!0}),q.preventDefault()}),children:s.jsx(Hl,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:q=>q.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:s.jsx(te,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:q=>q.preventDefault(),...b,...J,onPlaced:()=>X(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:Re(b.onKeyDown,q=>{const ne=q.ctrlKey||q.altKey||q.metaKey;if(q.key==="Tab"&&q.preventDefault(),!ne&&q.key.length===1&&F(q.key),["ArrowUp","ArrowDown","Home","End"].includes(q.key)){let Q=B().filter(re=>!re.disabled).map(re=>re.ref.current);if(["ArrowUp","End"].includes(q.key)&&(Q=Q.slice().reverse()),["ArrowUp","ArrowDown"].includes(q.key)){const re=q.target,me=Q.indexOf(re);Q=Q.slice(me+1)}setTimeout(()=>de(Q)),q.preventDefault()}})})})})})})});XR.displayName=pQ;var gQ="SelectItemAlignedPosition",JR=g.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...a}=t,i=qo(zl,n),o=Wo(zl,n),[c,d]=g.useState(null),[u,m]=g.useState(null),f=Tt(e,P=>m(P)),p=Vg(n),x=g.useRef(!1),j=g.useRef(!0),{viewport:v,selectedItem:_,selectedItemText:b,focusSelectedItem:w}=o,N=g.useCallback(()=>{if(i.trigger&&i.valueNode&&c&&u&&v&&_&&b){const P=i.trigger.getBoundingClientRect(),M=u.getBoundingClientRect(),z=i.valueNode.getBoundingClientRect(),R=b.getBoundingClientRect();if(i.dir!=="rtl"){const re=R.left-M.left,me=z.left-re,he=P.left-me,ge=P.width+he,se=Math.max(ge,M.width),we=window.innerWidth-Wr,Se=Iw(me,[Wr,Math.max(Wr,we-se)]);c.style.minWidth=ge+"px",c.style.left=Se+"px"}else{const re=M.right-R.right,me=window.innerWidth-z.right-re,he=window.innerWidth-P.right-me,ge=P.width+he,se=Math.max(ge,M.width),we=window.innerWidth-Wr,Se=Iw(me,[Wr,Math.max(Wr,we-se)]);c.style.minWidth=ge+"px",c.style.right=Se+"px"}const D=p(),B=window.innerHeight-Wr*2,W=v.scrollHeight,X=window.getComputedStyle(u),ue=parseInt(X.borderTopWidth,10),de=parseInt(X.paddingTop,10),G=parseInt(X.borderBottomWidth,10),I=parseInt(X.paddingBottom,10),V=ue+de+W+I+G,$=Math.min(_.offsetHeight*5,V),F=window.getComputedStyle(v),O=parseInt(F.paddingTop,10),K=parseInt(F.paddingBottom,10),U=P.top+P.height/2-Wr,te=B-U,J=_.offsetHeight/2,q=_.offsetTop+J,ne=ue+de+q,pe=V-ne;if(ne<=U){const re=D.length>0&&_===D[D.length-1].ref.current;c.style.bottom="0px";const me=u.clientHeight-v.offsetTop-v.offsetHeight,he=Math.max(te,J+(re?K:0)+me+G),ge=ne+he;c.style.height=ge+"px"}else{const re=D.length>0&&_===D[0].ref.current;c.style.top="0px";const he=Math.max(U,ue+v.offsetTop+(re?O:0)+J)+pe;c.style.height=he+"px",v.scrollTop=ne-U+v.offsetTop}c.style.margin=`${Wr}px 0`,c.style.minHeight=$+"px",c.style.maxHeight=B+"px",r==null||r(),requestAnimationFrame(()=>x.current=!0)}},[p,i.trigger,i.valueNode,c,u,v,_,b,i.dir,r]);Bn(()=>N(),[N]);const[S,C]=g.useState();Bn(()=>{u&&C(window.getComputedStyle(u).zIndex)},[u]);const A=g.useCallback(P=>{P&&j.current===!0&&(N(),w==null||w(),j.current=!1)},[N,w]);return s.jsx(vQ,{scope:n,contentWrapper:c,shouldExpandOnScrollRef:x,onScrollButtonChange:A,children:s.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:s.jsx(nt.div,{...a,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});JR.displayName=gQ;var xQ="SelectPopperPosition",Ow=g.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=Wr,...i}=t,o=Kg(n);return s.jsx(ug,{...o,...i,ref:e,align:r,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Ow.displayName=xQ;var[vQ,h1]=Xd(zl,{}),Lw="SelectViewport",e3=g.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:r,...a}=t,i=Wo(Lw,n),o=h1(Lw,n),c=Tt(e,i.onViewportChange),d=g.useRef(0);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),s.jsx(Hg.Slot,{scope:n,children:s.jsx(nt.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Re(a.onScroll,u=>{const m=u.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:p}=o;if(p!=null&&p.current&&f){const x=Math.abs(d.current-m.scrollTop);if(x>0){const j=window.innerHeight-Wr*2,v=parseFloat(f.style.minHeight),_=parseFloat(f.style.height),b=Math.max(v,_);if(b<j){const w=b+x,N=Math.min(j,w),S=w-N;f.style.height=N+"px",f.style.bottom==="0px"&&(m.scrollTop=S>0?S:0,f.style.justifyContent="flex-end")}}}d.current=m.scrollTop})})})]})});e3.displayName=Lw;var t3="SelectGroup",[yQ,_Q]=Xd(t3),wQ=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,a=dr();return s.jsx(yQ,{scope:n,id:a,children:s.jsx(nt.div,{role:"group","aria-labelledby":a,...r,ref:e})})});wQ.displayName=t3;var n3="SelectLabel",s3=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,a=_Q(n3,n);return s.jsx(nt.div,{id:a.id,...r,ref:e})});s3.displayName=n3;var E0="SelectItem",[bQ,r3]=Xd(E0),a3=g.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:i,...o}=t,c=qo(E0,n),d=Wo(E0,n),u=c.value===r,[m,f]=g.useState(i??""),[p,x]=g.useState(!1),j=Tt(e,w=>{var N;return(N=d.itemRefCallback)==null?void 0:N.call(d,w,r,a)}),v=dr(),_=g.useRef("touch"),b=()=>{a||(c.onValueChange(r),c.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return s.jsx(bQ,{scope:n,value:r,disabled:a,textId:v,isSelected:u,onItemTextChange:g.useCallback(w=>{f(N=>N||((w==null?void 0:w.textContent)??"").trim())},[]),children:s.jsx(Hg.ItemSlot,{scope:n,value:r,disabled:a,textValue:m,children:s.jsx(nt.div,{role:"option","aria-labelledby":v,"data-highlighted":p?"":void 0,"aria-selected":u&&p,"data-state":u?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...o,ref:j,onFocus:Re(o.onFocus,()=>x(!0)),onBlur:Re(o.onBlur,()=>x(!1)),onClick:Re(o.onClick,()=>{_.current!=="mouse"&&b()}),onPointerUp:Re(o.onPointerUp,()=>{_.current==="mouse"&&b()}),onPointerDown:Re(o.onPointerDown,w=>{_.current=w.pointerType}),onPointerMove:Re(o.onPointerMove,w=>{var N;_.current=w.pointerType,a?(N=d.onItemLeave)==null||N.call(d):_.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Re(o.onPointerLeave,w=>{var N;w.currentTarget===document.activeElement&&((N=d.onItemLeave)==null||N.call(d))}),onKeyDown:Re(o.onKeyDown,w=>{var S;((S=d.searchRef)==null?void 0:S.current)!==""&&w.key===" "||(lQ.includes(w.key)&&b(),w.key===" "&&w.preventDefault())})})})})});a3.displayName=E0;var Hu="SelectItemText",i3=g.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:a,...i}=t,o=qo(Hu,n),c=Wo(Hu,n),d=r3(Hu,n),u=hQ(Hu,n),[m,f]=g.useState(null),p=Tt(e,b=>f(b),d.onItemTextChange,b=>{var w;return(w=c.itemTextRefCallback)==null?void 0:w.call(c,b,d.value,d.disabled)}),x=m==null?void 0:m.textContent,j=g.useMemo(()=>s.jsx("option",{value:d.value,disabled:d.disabled,children:x},d.value),[d.disabled,d.value,x]),{onNativeOptionAdd:v,onNativeOptionRemove:_}=u;return Bn(()=>(v(j),()=>_(j)),[v,_,j]),s.jsxs(s.Fragment,{children:[s.jsx(nt.span,{id:d.textId,...i,ref:p}),d.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Wl.createPortal(i.children,o.valueNode):null]})});i3.displayName=Hu;var o3="SelectItemIndicator",l3=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return r3(o3,n).isSelected?s.jsx(nt.span,{"aria-hidden":!0,...r,ref:e}):null});l3.displayName=o3;var Fw="SelectScrollUpButton",c3=g.forwardRef((t,e)=>{const n=Wo(Fw,t.__scopeSelect),r=h1(Fw,t.__scopeSelect),[a,i]=g.useState(!1),o=Tt(e,r.onScrollButtonChange);return Bn(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=d.scrollTop>0;i(u)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),a?s.jsx(u3,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});c3.displayName=Fw;var Bw="SelectScrollDownButton",d3=g.forwardRef((t,e)=>{const n=Wo(Bw,t.__scopeSelect),r=h1(Bw,t.__scopeSelect),[a,i]=g.useState(!1),o=Tt(e,r.onScrollButtonChange);return Bn(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=d.scrollHeight-d.clientHeight,m=Math.ceil(d.scrollTop)<u;i(m)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),a?s.jsx(u3,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});d3.displayName=Bw;var u3=g.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=t,i=Wo("SelectScrollButton",n),o=g.useRef(null),c=Vg(n),d=g.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return g.useEffect(()=>()=>d(),[d]),Bn(()=>{var m;const u=c().find(f=>f.ref.current===document.activeElement);(m=u==null?void 0:u.ref.current)==null||m.scrollIntoView({block:"nearest"})},[c]),s.jsx(nt.div,{"aria-hidden":!0,...a,ref:e,style:{flexShrink:0,...a.style},onPointerDown:Re(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:Re(a.onPointerMove,()=>{var u;(u=i.onItemLeave)==null||u.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:Re(a.onPointerLeave,()=>{d()})})}),jQ="SelectSeparator",h3=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return s.jsx(nt.div,{"aria-hidden":!0,...r,ref:e})});h3.displayName=jQ;var zw="SelectArrow",NQ=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,a=Kg(n),i=qo(zw,n),o=Wo(zw,n);return i.open&&o.position==="popper"?s.jsx(hg,{...a,...r,ref:e}):null});NQ.displayName=zw;function f3(t){return t===""||t===void 0}var m3=g.forwardRef((t,e)=>{const{value:n,...r}=t,a=g.useRef(null),i=Tt(e,a),o=UR(n);return g.useEffect(()=>{const c=a.current,d=window.HTMLSelectElement.prototype,m=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==n&&m){const f=new Event("change",{bubbles:!0});m.call(c,n),c.dispatchEvent(f)}},[o,n]),s.jsx(gf,{asChild:!0,children:s.jsx("select",{...r,ref:i,defaultValue:n})})});m3.displayName="BubbleSelect";function p3(t){const e=_n(t),n=g.useRef(""),r=g.useRef(0),a=g.useCallback(o=>{const c=n.current+o;e(c),function d(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>d(""),1e3))}(c)},[e]),i=g.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,i]}function g3(t,e,n){const a=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=SQ(t,Math.max(i,0));a.length===1&&(o=o.filter(u=>u!==n));const d=o.find(u=>u.textValue.toLowerCase().startsWith(a.toLowerCase()));return d!==n?d:void 0}function SQ(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var kQ=qR,x3=HR,CQ=KR,EQ=ZR,AQ=GR,v3=QR,PQ=e3,y3=s3,_3=a3,DQ=i3,TQ=l3,w3=c3,b3=d3,j3=h3;const mt=kQ,pt=CQ,ht=g.forwardRef(({className:t,children:e,...n},r)=>s.jsxs(x3,{ref:r,className:Te("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,s.jsx(EQ,{asChild:!0,children:s.jsx(ag,{className:"h-4 w-4 opacity-50"})})]}));ht.displayName=x3.displayName;const N3=g.forwardRef(({className:t,...e},n)=>s.jsx(w3,{ref:n,className:Te("flex cursor-default items-center justify-center py-1",t),...e,children:s.jsx(YF,{className:"h-4 w-4"})}));N3.displayName=w3.displayName;const S3=g.forwardRef(({className:t,...e},n)=>s.jsx(b3,{ref:n,className:Te("flex cursor-default items-center justify-center py-1",t),...e,children:s.jsx(ag,{className:"h-4 w-4"})}));S3.displayName=b3.displayName;const ft=g.forwardRef(({className:t,children:e,position:n="popper",...r},a)=>s.jsx(AQ,{children:s.jsxs(v3,{ref:a,className:Te("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[s.jsx(N3,{}),s.jsx(PQ,{className:Te("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),s.jsx(S3,{})]})}));ft.displayName=v3.displayName;const MQ=g.forwardRef(({className:t,...e},n)=>s.jsx(y3,{ref:n,className:Te("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));MQ.displayName=y3.displayName;const ye=g.forwardRef(({className:t,children:e,...n},r)=>s.jsxs(_3,{ref:r,className:Te("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(TQ,{children:s.jsx(xf,{className:"h-4 w-4"})})}),s.jsx(DQ,{children:e})]}));ye.displayName=_3.displayName;const RQ=g.forwardRef(({className:t,...e},n)=>s.jsx(j3,{ref:n,className:Te("-mx-1 my-1 h-px bg-muted",t),...e}));RQ.displayName=j3.displayName;const IQ=({isOpen:t,onClose:e,onCustomerAdded:n})=>{const{toast:r}=Mt(),[a,i]=g.useState({company_name:"",anrede:"",first_name:"",last_name:"",contact_person:"",email:"",phone:"",mobile:"",fax:"",website:"",address:"",city:"",postal_code:"",country:"Deutschland",status:"Aktiv",customer_number:"",tax_number:"",zahlungsziel:"30",skonto_prozent:"",skonto_tage:"",waehrung:"EUR",preisgruppe:"Standard",iban:"",bic:"",bank_name:"",kontoinhaber:"",zugprd_status:"Inaktiv",benutzer_id:"",passwort:""}),o=d=>{if(d.preventDefault(),!a.company_name||!a.contact_person||!a.email){r({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)){r({title:"Fehler",description:"Bitte geben Sie eine gültige E-Mail-Adresse ein.",variant:"destructive"});return}n(a),i({company_name:"",anrede:"",first_name:"",last_name:"",contact_person:"",email:"",phone:"",mobile:"",fax:"",website:"",address:"",city:"",postal_code:"",country:"Deutschland",status:"Aktiv",customer_number:"",tax_number:"",zahlungsziel:"30",skonto_prozent:"",skonto_tage:"",waehrung:"EUR",preisgruppe:"Standard",iban:"",bic:"",bank_name:"",kontoinhaber:"",zugprd_status:"Inaktiv",benutzer_id:"",passwort:""}),e()},c=(d,u)=>{i(m=>({...m,[d]:u}))};return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-6xl max-h-[95vh] overflow-y-auto",children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Neuen Kunden hinzufügen"}),s.jsx($n,{children:"Geben Sie die Informationen für den neuen Kunden ein."})]}),s.jsxs("form",{onSubmit:o,className:"space-y-6",children:[s.jsxs(Is,{defaultValue:"ansprechpartner",className:"w-full",children:[s.jsxs(js,{className:"grid grid-cols-6 w-full",children:[s.jsx(Je,{value:"ansprechpartner",children:"ANSPRECHPARTNER"}),s.jsx(Je,{value:"kontaktdetails",children:"KONTAKTDETAILS"}),s.jsx(Je,{value:"adresse",children:"ADRESSE"}),s.jsx(Je,{value:"konditionen",children:"KONDITIONEN"}),s.jsx(Je,{value:"zahlungsdaten",children:"ZAHLUNGSDATEN"}),s.jsx(Je,{value:"zugprd",children:"ZUGPRD 2.0 STANDARD"})]}),s.jsxs(et,{value:"ansprechpartner",className:"space-y-4 mt-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"company_name",children:"Firmenname *"}),s.jsx(ae,{id:"company_name",value:a.company_name,onChange:d=>c("company_name",d.target.value),placeholder:"z.B. Mustermann GmbH",required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"customer_number",children:"Kundennummer"}),s.jsx(ae,{id:"customer_number",value:a.customer_number,onChange:d=>c("customer_number",d.target.value),placeholder:"AUTO"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"anrede",children:"Anrede"}),s.jsxs(mt,{value:a.anrede,onValueChange:d=>c("anrede",d),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Wählen..."})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Herr",children:"Herr"}),s.jsx(ye,{value:"Frau",children:"Frau"}),s.jsx(ye,{value:"Divers",children:"Divers"})]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"first_name",children:"Vorname"}),s.jsx(ae,{id:"first_name",value:a.first_name,onChange:d=>c("first_name",d.target.value),placeholder:"Max"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"last_name",children:"Nachname"}),s.jsx(ae,{id:"last_name",value:a.last_name,onChange:d=>c("last_name",d.target.value),placeholder:"Mustermann"})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"contact_person",children:"Ansprechpartner *"}),s.jsx(ae,{id:"contact_person",value:a.contact_person,onChange:d=>c("contact_person",d.target.value),placeholder:"z.B. Max Mustermann",required:!0})]})]}),s.jsxs(et,{value:"kontaktdetails",className:"space-y-4 mt-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"email",children:"E-Mail *"}),s.jsx(ae,{id:"email",type:"email",value:a.email,onChange:d=>c("email",d.target.value),placeholder:"kontakt@firma.de",required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"website",children:"Website"}),s.jsx(ae,{id:"website",value:a.website,onChange:d=>c("website",d.target.value),placeholder:"www.firma.de"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"phone",children:"Telefon"}),s.jsx(ae,{id:"phone",value:a.phone,onChange:d=>c("phone",d.target.value),placeholder:"+49 123 456789"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"mobile",children:"Mobil"}),s.jsx(ae,{id:"mobile",value:a.mobile,onChange:d=>c("mobile",d.target.value),placeholder:"+49 123 456789"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"fax",children:"Fax"}),s.jsx(ae,{id:"fax",value:a.fax,onChange:d=>c("fax",d.target.value),placeholder:"+49 123 456789"})]})]})]}),s.jsxs(et,{value:"adresse",className:"space-y-4 mt-6",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"address",children:"Straße und Hausnummer"}),s.jsx(ae,{id:"address",value:a.address,onChange:d=>c("address",d.target.value),placeholder:"Musterstraße 123"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"postal_code",children:"PLZ"}),s.jsx(ae,{id:"postal_code",value:a.postal_code,onChange:d=>c("postal_code",d.target.value),placeholder:"12345"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"city",children:"Ort"}),s.jsx(ae,{id:"city",value:a.city,onChange:d=>c("city",d.target.value),placeholder:"Berlin"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"country",children:"Land"}),s.jsx(ae,{id:"country",value:a.country,onChange:d=>c("country",d.target.value),placeholder:"Deutschland"})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"tax_number",children:"Steuernummer"}),s.jsx(ae,{id:"tax_number",value:a.tax_number,onChange:d=>c("tax_number",d.target.value),placeholder:"123/456/78910"})]})]}),s.jsxs(et,{value:"konditionen",className:"space-y-4 mt-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"zahlungsziel",children:"Zahlungsziel (Tage)"}),s.jsxs(mt,{value:a.zahlungsziel,onValueChange:d=>c("zahlungsziel",d),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"14",children:"14 Tage"}),s.jsx(ye,{value:"30",children:"30 Tage"}),s.jsx(ye,{value:"60",children:"60 Tage"}),s.jsx(ye,{value:"90",children:"90 Tage"})]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"waehrung",children:"Währung"}),s.jsxs(mt,{value:a.waehrung,onValueChange:d=>c("waehrung",d),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"EUR",children:"EUR"}),s.jsx(ye,{value:"USD",children:"USD"}),s.jsx(ye,{value:"GBP",children:"GBP"})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"skonto_prozent",children:"Skonto %"}),s.jsx(ae,{id:"skonto_prozent",value:a.skonto_prozent,onChange:d=>c("skonto_prozent",d.target.value),placeholder:"2"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"skonto_tage",children:"Skonto Tage"}),s.jsx(ae,{id:"skonto_tage",value:a.skonto_tage,onChange:d=>c("skonto_tage",d.target.value),placeholder:"10"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"preisgruppe",children:"Preisgruppe"}),s.jsxs(mt,{value:a.preisgruppe,onValueChange:d=>c("preisgruppe",d),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Standard",children:"Standard"}),s.jsx(ye,{value:"Premium",children:"Premium"}),s.jsx(ye,{value:"VIP",children:"VIP"})]})]})]})]})]}),s.jsxs(et,{value:"zahlungsdaten",className:"space-y-4 mt-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"iban",children:"IBAN"}),s.jsx(ae,{id:"iban",value:a.iban,onChange:d=>c("iban",d.target.value),placeholder:"DE89 3704 0044 0532 0130 00"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"bic",children:"BIC"}),s.jsx(ae,{id:"bic",value:a.bic,onChange:d=>c("bic",d.target.value),placeholder:"COBADEFFXXX"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"bank_name",children:"Bank"}),s.jsx(ae,{id:"bank_name",value:a.bank_name,onChange:d=>c("bank_name",d.target.value),placeholder:"Commerzbank AG"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"kontoinhaber",children:"Kontoinhaber"}),s.jsx(ae,{id:"kontoinhaber",value:a.kontoinhaber,onChange:d=>c("kontoinhaber",d.target.value),placeholder:"Mustermann GmbH"})]})]})]}),s.jsxs(et,{value:"zugprd",className:"space-y-4 mt-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"zugprd_status",children:"Status"}),s.jsxs(mt,{value:a.zugprd_status,onValueChange:d=>c("zugprd_status",d),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Aktiv",children:"Aktiv"}),s.jsx(ye,{value:"Inaktiv",children:"Inaktiv"})]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"status",children:"Kundenstatus"}),s.jsxs(mt,{value:a.status,onValueChange:d=>c("status",d),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Aktiv",children:"Aktiv"}),s.jsx(ye,{value:"Premium",children:"Premium"}),s.jsx(ye,{value:"Inaktiv",children:"Inaktiv"})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"benutzer_id",children:"Benutzer-ID"}),s.jsx(ae,{id:"benutzer_id",value:a.benutzer_id,onChange:d=>c("benutzer_id",d.target.value),placeholder:"user123"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"passwort",children:"Passwort"}),s.jsx(ae,{id:"passwort",type:"password",value:a.passwort,onChange:d=>c("passwort",d.target.value),placeholder:"••••••••"})]})]})]})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(ee,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),s.jsx(ee,{type:"submit",className:"flex-1",children:"Kunde hinzufügen"})]})]})]})})},cn=g.forwardRef(({className:t,...e},n)=>s.jsx("textarea",{className:Te("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));cn.displayName="Textarea";const OQ=({isOpen:t,onClose:e,customer:n,onCustomerUpdated:r})=>{const{toast:a}=Mt(),i=WZ(),[o,c]=g.useState({company_name:(n==null?void 0:n.company_name)||"",contact_person:(n==null?void 0:n.contact_person)||"",email:(n==null?void 0:n.email)||"",phone:(n==null?void 0:n.phone)||"",address:(n==null?void 0:n.address)||"",city:(n==null?void 0:n.city)||"",postal_code:(n==null?void 0:n.postal_code)||"",country:(n==null?void 0:n.country)||"Deutschland",status:(n==null?void 0:n.status)||"Aktiv",anrede:(n==null?void 0:n.anrede)||"",first_name:(n==null?void 0:n.first_name)||"",last_name:(n==null?void 0:n.last_name)||"",mobile:(n==null?void 0:n.mobile)||"",website:(n==null?void 0:n.website)||"",erreichbarkeit:(n==null?void 0:n.erreichbarkeit)||"",sonstiges:(n==null?void 0:n.sonstiges)||"",festnetz:(n==null?void 0:n.festnetz)||"",fax:(n==null?void 0:n.fax)||"",zahlungsziel:(n==null?void 0:n.zahlungsziel)||"",skonto:(n==null?void 0:n.skonto)||"",skontofrist:(n==null?void 0:n.skontofrist)||"",verkaufspreise_gruppe:(n==null?void 0:n.verkaufspreise_gruppe)||"",iban:(n==null?void 0:n.iban)||"",bic:(n==null?void 0:n.bic)||"",bank_name:(n==null?void 0:n.bank_name)||"",umsatzsteuer_id:(n==null?void 0:n.umsatzsteuer_id)||"",debitor_konto:(n==null?void 0:n.debitor_konto)||""});Ae.useEffect(()=>{n&&c({company_name:n.company_name,contact_person:n.contact_person,email:n.email,phone:n.phone||"",address:n.address||"",city:n.city||"",postal_code:n.postal_code||"",country:n.country||"Deutschland",status:n.status,anrede:n.anrede||"",first_name:n.first_name||"",last_name:n.last_name||"",mobile:n.mobile||"",website:n.website||"",erreichbarkeit:n.erreichbarkeit||"",sonstiges:n.sonstiges||"",festnetz:n.festnetz||"",fax:n.fax||"",zahlungsziel:n.zahlungsziel||"",skonto:n.skonto||"",skontofrist:n.skontofrist||"",verkaufspreise_gruppe:n.verkaufspreise_gruppe||"",iban:n.iban||"",bic:n.bic||"",bank_name:n.bank_name||"",umsatzsteuer_id:n.umsatzsteuer_id||"",debitor_konto:n.debitor_konto||""})},[n]);const d=f=>{if(f.preventDefault(),!n)return;if(!o.company_name||!o.contact_person||!o.email){a({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)){a({title:"Fehler",description:"Bitte geben Sie eine gültige E-Mail-Adresse ein.",variant:"destructive"});return}const x={...n,...o};r(x),e()},u=(f,p)=>{c(x=>({...x,[f]:p}))},m=()=>{n&&window.confirm(`Möchten Sie den Kunden "${n.company_name}" wirklich löschen?`)&&i.mutate(n.id,{onSuccess:()=>{a({title:"Kunde gelöscht",description:`${n.company_name} wurde erfolgreich gelöscht.`}),e()},onError:f=>{a({title:"Fehler beim Löschen",description:f.message,variant:"destructive"})}})};return n?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-7xl h-[45vh] overflow-y-auto",children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Kunde bearbeiten"}),s.jsx($n,{children:"Bearbeiten Sie die Informationen für den Kunden."})]}),s.jsxs("form",{onSubmit:d,className:"space-y-4",children:[s.jsxs(Is,{defaultValue:"kontaktdetails",className:"w-full",children:[s.jsxs(js,{className:"grid w-full grid-cols-6 h-12",children:[s.jsx(Je,{value:"ansprechpartner",children:"ANSPRECHPARTNER"}),s.jsx(Je,{value:"kontaktdetails",children:"KONTAKTDETAILS"}),s.jsx(Je,{value:"adresse",children:"ADRESSE"}),s.jsx(Je,{value:"konditionen",children:"KONDITIONEN"}),s.jsx(Je,{value:"zahlungsdaten",children:"ZAHLUNGSDATEN"}),s.jsx(Je,{value:"zugprd",children:"ZUGPRD 2.0 STANDARD"})]}),s.jsxs(et,{value:"ansprechpartner",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"anrede",children:"Anrede"}),s.jsxs(mt,{value:o.anrede,onValueChange:f=>u("anrede",f),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Anrede wählen"})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Herr",children:"Herr"}),s.jsx(ye,{value:"Frau",children:"Frau"}),s.jsx(ye,{value:"Divers",children:"Divers"})]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"company_name",children:"Firmenname *"}),s.jsx(ae,{id:"company_name",value:o.company_name,onChange:f=>u("company_name",f.target.value),required:!0})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"first_name",children:"Vorname"}),s.jsx(ae,{id:"first_name",value:o.first_name,onChange:f=>u("first_name",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"last_name",children:"Nachname"}),s.jsx(ae,{id:"last_name",value:o.last_name,onChange:f=>u("last_name",f.target.value)})]})]})]}),s.jsxs(et,{value:"kontaktdetails",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"email",children:"Emailadresse *"}),s.jsx(ae,{id:"email",type:"email",value:o.email,onChange:f=>u("email",f.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"mobile",children:"Mobiltelefon"}),s.jsx(ae,{id:"mobile",value:o.mobile,onChange:f=>u("mobile",f.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"erreichbarkeit",children:"Erreichbarkeit"}),s.jsx(cn,{id:"erreichbarkeit",value:o.erreichbarkeit,onChange:f=>u("erreichbarkeit",f.target.value),rows:2})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"website",children:"Website"}),s.jsx(ae,{id:"website",value:o.website,onChange:f=>u("website",f.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"sonstiges",children:"Sonstiges"}),s.jsxs(mt,{value:o.sonstiges,onValueChange:f=>u("sonstiges",f),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Sonstiges wählen"})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Standard",children:"Standard"}),s.jsx(ye,{value:"VIP",children:"VIP"}),s.jsx(ye,{value:"Premium",children:"Premium"})]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"festnetz",children:"Festnetz"}),s.jsx(ae,{id:"festnetz",value:o.festnetz,onChange:f=>u("festnetz",f.target.value)})]})]}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"fax",children:"Fax"}),s.jsx(ae,{id:"fax",value:o.fax,onChange:f=>u("fax",f.target.value)})]})})]}),s.jsxs(et,{value:"adresse",className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"address",children:"Straße & Hausnummer"}),s.jsx(ae,{id:"address",value:o.address,onChange:f=>u("address",f.target.value)})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"postal_code",children:"Postleitzahl"}),s.jsx(ae,{id:"postal_code",value:o.postal_code,onChange:f=>u("postal_code",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"city",children:"Ort"}),s.jsx(ae,{id:"city",value:o.city,onChange:f=>u("city",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"country",children:"Land"}),s.jsx(ae,{id:"country",value:o.country,onChange:f=>u("country",f.target.value)})]})]})]}),s.jsxs(et,{value:"konditionen",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"zahlungsziel",children:"Zahlungsziel (Tage)"}),s.jsx(ae,{id:"zahlungsziel",value:o.zahlungsziel,onChange:f=>u("zahlungsziel",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"skonto",children:"Skonto %"}),s.jsx(ae,{id:"skonto",value:o.skonto,onChange:f=>u("skonto",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"skontofrist",children:"Skontofrist (Tage)"}),s.jsx(ae,{id:"skontofrist",value:o.skontofrist,onChange:f=>u("skontofrist",f.target.value)})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"verkaufspreise_gruppe",children:"Verkaufspreise-Gruppe"}),s.jsxs(mt,{value:o.verkaufspreise_gruppe,onValueChange:f=>u("verkaufspreise_gruppe",f),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Gruppe wählen"})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Standard-VK",children:"Standard-VK"}),s.jsx(ye,{value:"Premium-VK",children:"Premium-VK"}),s.jsx(ye,{value:"Großkunden-VK",children:"Großkunden-VK"})]})]})]})]}),s.jsxs(et,{value:"zahlungsdaten",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"iban",children:"IBAN"}),s.jsx(ae,{id:"iban",value:o.iban,onChange:f=>u("iban",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"bic",children:"BIC"}),s.jsx(ae,{id:"bic",value:o.bic,onChange:f=>u("bic",f.target.value)})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"bank_name",children:"Bank Name"}),s.jsx(ae,{id:"bank_name",value:o.bank_name,onChange:f=>u("bank_name",f.target.value)})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"umsatzsteuer_id",children:"Umsatzsteuer ID"}),s.jsx(ae,{id:"umsatzsteuer_id",value:o.umsatzsteuer_id,onChange:f=>u("umsatzsteuer_id",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"debitor_konto",children:"Debitor / Kreditor Konto"}),s.jsx(ae,{id:"debitor_konto",value:o.debitor_konto,onChange:f=>u("debitor_konto",f.target.value)})]})]})]}),s.jsx(et,{value:"zugprd",className:"space-y-4",children:s.jsx("div",{className:"text-muted-foreground text-sm",children:"Diese Information ist erforderlich, um Rechnungen zu ZUGFeRD 2.0 Standard zu erstellen. Dieser Standard ist verpflichtend für die Rechnungsstellung an öffentliche Behörden/Auftraggeber."})})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(ee,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),s.jsxs(ee,{type:"button",variant:"destructive",onClick:m,disabled:i.isPending,className:"flex items-center gap-2",children:[s.jsx(Fa,{className:"h-4 w-4"}),i.isPending?"Lösche...":"Löschen"]}),s.jsx(ee,{type:"submit",className:"flex-1",children:"Speichern"})]})]})]})}):null},LQ=()=>{const[t,e]=g.useState(""),[n,r]=g.useState(!1),[a,i]=g.useState(!1),[o,c]=g.useState(null),{data:d,isLoading:u,error:m}=oR(void 0,t.length>=2?{search:t}:void 0),f=UZ(),p=qZ(),x=(d==null?void 0:d.items)||[],j=[{id:"A2024-001",customer:"Müller GmbH",project:"Büroerweiterung",amount:"€12.500",status:"In Bearbeitung",date:"15.01.2024"},{id:"A2024-002",customer:"Schmidt AG",project:"Werkshalle Elektrik",amount:"€8.750",status:"Abgeschlossen",date:"10.01.2024"},{id:"A2024-003",customer:"Weber Bau",project:"Wohnanlage Phase 2",amount:"€28.900",status:"Angebot",date:"20.01.2024"}],v=A=>{switch(A){case"Aktiv":return"bg-green-100 text-green-800";case"Premium":return"bg-blue-100 text-blue-800";case"Inaktiv":return"bg-gray-100 text-gray-800";case"In Bearbeitung":return"bg-yellow-100 text-yellow-800";case"Abgeschlossen":return"bg-green-100 text-green-800";case"Angebot":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},_=async A=>{f.mutate(A)},b=A=>{c(A),i(!0)},w=async A=>{if(!o)return;const{id:P,created_at:M,updated_at:z,...R}=A;p.mutate({id:o.id,data:R})},N=A=>{alert(`Details für ${A.company_name}:

Kontakt: ${A.contact_person}
E-Mail: ${A.email}
Status: ${A.status}`)},S=t.length>=2?x:x.filter(A=>A.company_name.toLowerCase().includes(t.toLowerCase())||A.contact_person.toLowerCase().includes(t.toLowerCase())||A.email.toLowerCase().includes(t.toLowerCase())),C=A=>[A.address,A.postal_code,A.city,A.country].filter(Boolean).join(", ");return s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Kunden & Aufträge"}),s.jsxs(ee,{onClick:()=>r(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Neuer Kunde"]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Aktive Kunden"}),s.jsx("p",{className:"text-2xl font-bold",children:x.filter(A=>A.status==="Aktiv").length})]}),s.jsx(bi,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Premium Kunden"}),s.jsx("p",{className:"text-2xl font-bold",children:x.filter(A=>A.status==="Premium").length})]}),s.jsx(yf,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Neue diesen Monat"}),s.jsx("p",{className:"text-2xl font-bold",children:"0"})]}),s.jsx(Eo,{className:"h-8 w-8 text-purple-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Gesamt Umsatz"}),s.jsx("p",{className:"text-2xl font-bold",children:"€0"})]}),s.jsx(lr,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})})]}),s.jsxs(Is,{defaultValue:"customers",className:"space-y-6",children:[s.jsxs(js,{className:"grid w-full grid-cols-3",children:[s.jsx(Je,{value:"customers",children:"Kundenstamm"}),s.jsx(Je,{value:"orders",children:"Aufträge"}),s.jsx(Je,{value:"offers",children:"Angebote"})]}),s.jsxs(et,{value:"customers",className:"space-y-4",children:[s.jsx(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Bd,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(ae,{placeholder:"Kunde suchen...",value:t,onChange:A=>e(A.target.value),className:"pl-10 rounded-xl"})]}),s.jsx(ee,{variant:"outline",className:"rounded-xl",children:"Filter"})]})})}),u?s.jsx("div",{className:"grid gap-4",children:Array(3).fill(0).map((A,P)=>s.jsx(oe,{children:s.jsx(ce,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(dt,{className:"h-5 w-32"}),s.jsx(dt,{className:"h-6 w-16"})]}),s.jsx(dt,{className:"h-4 w-24 mb-3"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx(dt,{className:"h-4 w-28"}),s.jsx(dt,{className:"h-4 w-36"}),s.jsx(dt,{className:"h-4 w-40"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(dt,{className:"h-8 w-20"}),s.jsx(dt,{className:"h-8 w-24"})]})]})})},P))}):m?s.jsx(oe,{children:s.jsx(ce,{className:"p-6 text-center",children:s.jsxs("p",{className:"text-red-500",children:["Fehler beim Laden der Kunden: ",m.message]})})}):s.jsx("div",{className:"grid gap-4",children:S.length===0?s.jsx(oe,{children:s.jsx(ce,{className:"p-6 text-center",children:s.jsx("p",{className:"text-gray-500",children:t?"Keine Kunden gefunden.":"Noch keine Kunden vorhanden."})})}):S.map(A=>s.jsx(oe,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"text-base font-semibold",children:A.company_name}),s.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${v(A.status)}`,children:A.status})]}),s.jsx("p",{className:"text-gray-600 mb-3",children:A.contact_person}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Fd,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{children:A.phone||"Nicht angegeben"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(es,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{children:A.email})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ci,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{children:C(A)||"Nicht angegeben"})]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"0"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Projekte"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-green-600",children:"€0"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Umsatz"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ee,{size:"sm",variant:"outline",className:"rounded-xl",onClick:P=>{P.preventDefault(),P.stopPropagation(),N(A)},children:"Details"}),s.jsx(ee,{size:"sm",className:"rounded-xl",onClick:()=>b(A),children:"Bearbeiten"})]})]})]})})},A.id))})]}),s.jsx(et,{value:"orders",className:"space-y-6",children:s.jsx("div",{className:"grid gap-4",children:j.map(A=>s.jsx(oe,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"text-base font-semibold",children:A.id}),s.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${v(A.status)}`,children:A.status})]}),s.jsx("p",{className:"text-gray-600 mb-1",children:A.customer}),s.jsx("p",{className:"text-sm text-gray-500",children:A.project})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xl font-bold text-green-600",children:A.amount}),s.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[s.jsx(Lt,{className:"h-4 w-4"}),A.date]}),s.jsx("div",{className:"flex gap-2 mt-2",children:s.jsxs(ee,{size:"sm",variant:"outline",className:"rounded-xl",children:[s.jsx(wn,{className:"h-4 w-4 mr-1"}),"Details"]})})]})]})})},A.id))})}),s.jsx(et,{value:"offers",className:"space-y-4",children:s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsxs(Ne,{className:"pb-2",children:[s.jsx(Ce,{children:"Angebote erstellen"}),s.jsx(ds,{children:"Neue Angebote für Ihre Kunden erstellen"})]}),s.jsxs(ce,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"customer",children:"Kunde auswählen"}),s.jsx(ae,{id:"customer",placeholder:"Kunde eingeben oder auswählen"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"project",children:"Projekt"}),s.jsx(ae,{id:"project",placeholder:"Projektbezeichnung"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"amount",children:"Angebotssumme"}),s.jsx(ae,{id:"amount",placeholder:"€ 0,00"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"deadline",children:"Gültig bis"}),s.jsx(ae,{id:"deadline",type:"date"})]})]}),s.jsxs("div",{className:"flex gap-2 mt-6",children:[s.jsxs(ee,{className:"rounded-xl",children:[s.jsx(wn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),s.jsx(ee,{variant:"outline",className:"rounded-xl",children:"Vorlage laden"})]})]})]})})]}),s.jsx(IQ,{isOpen:n,onClose:()=>r(!1),onCustomerAdded:_}),s.jsx(OQ,{isOpen:a,onClose:()=>i(!1),customer:o,onCustomerUpdated:w})]})};var f1="Checkbox",[FQ,yae]=wr(f1),[BQ,zQ]=FQ(f1),k3=g.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:i,required:o,disabled:c,value:d="on",onCheckedChange:u,form:m,...f}=t,[p,x]=g.useState(null),j=Tt(e,S=>x(S)),v=g.useRef(!1),_=p?m||!!p.closest("form"):!0,[b=!1,w]=Lr({prop:a,defaultProp:i,onChange:u}),N=g.useRef(b);return g.useEffect(()=>{const S=p==null?void 0:p.form;if(S){const C=()=>w(N.current);return S.addEventListener("reset",C),()=>S.removeEventListener("reset",C)}},[p,w]),s.jsxs(BQ,{scope:n,state:b,disabled:c,children:[s.jsx(nt.button,{type:"button",role:"checkbox","aria-checked":No(b)?"mixed":b,"aria-required":o,"data-state":A3(b),"data-disabled":c?"":void 0,disabled:c,value:d,...f,ref:j,onKeyDown:Re(t.onKeyDown,S=>{S.key==="Enter"&&S.preventDefault()}),onClick:Re(t.onClick,S=>{w(C=>No(C)?!0:!C),_&&(v.current=S.isPropagationStopped(),v.current||S.stopPropagation())})}),_&&s.jsx($Q,{control:p,bubbles:!v.current,name:r,value:d,checked:b,required:o,disabled:c,form:m,style:{transform:"translateX(-100%)"},defaultChecked:No(i)?!1:i})]})});k3.displayName=f1;var C3="CheckboxIndicator",E3=g.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...a}=t,i=zQ(C3,n);return s.jsx(Gn,{present:r||No(i.state)||i.state===!0,children:s.jsx(nt.span,{"data-state":A3(i.state),"data-disabled":i.disabled?"":void 0,...a,ref:e,style:{pointerEvents:"none",...t.style}})})});E3.displayName=C3;var $Q=t=>{const{control:e,checked:n,bubbles:r=!0,defaultChecked:a,...i}=t,o=g.useRef(null),c=UR(n),d=DP(e);g.useEffect(()=>{const m=o.current,f=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(f,"checked").set;if(c!==n&&x){const j=new Event("click",{bubbles:r});m.indeterminate=No(n),x.call(m,No(n)?!1:n),m.dispatchEvent(j)}},[c,n,r]);const u=g.useRef(No(n)?!1:n);return s.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??u.current,...i,tabIndex:-1,ref:o,style:{...t.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function No(t){return t==="indeterminate"}function A3(t){return No(t)?"indeterminate":t?"checked":"unchecked"}var P3=k3,UQ=E3;const za=g.forwardRef(({className:t,...e},n)=>s.jsx(P3,{ref:n,className:Te("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:s.jsx(UQ,{className:Te("flex items-center justify-center text-current"),children:s.jsx(xf,{className:"h-4 w-4"})})}));za.displayName=P3.displayName;var m1="Popover",[D3,_ae]=wr(m1,[zo]),Mf=zo(),[qQ,Ho]=D3(m1),T3=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:a,onOpenChange:i,modal:o=!1}=t,c=Mf(e),d=g.useRef(null),[u,m]=g.useState(!1),[f=!1,p]=Lr({prop:r,defaultProp:a,onChange:i});return s.jsx(cj,{...c,children:s.jsx(qQ,{scope:e,contentId:dr(),triggerRef:d,open:f,onOpenChange:p,onOpenToggle:g.useCallback(()=>p(x=>!x),[p]),hasCustomAnchor:u,onCustomAnchorAdd:g.useCallback(()=>m(!0),[]),onCustomAnchorRemove:g.useCallback(()=>m(!1),[]),modal:o,children:n})})};T3.displayName=m1;var M3="PopoverAnchor",WQ=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,a=Ho(M3,n),i=Mf(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:c}=a;return g.useEffect(()=>(o(),()=>c()),[o,c]),s.jsx(wf,{...i,...r,ref:e})});WQ.displayName=M3;var R3="PopoverTrigger",I3=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,a=Ho(R3,n),i=Mf(n),o=Tt(e,a.triggerRef),c=s.jsx(nt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":z3(a.open),...r,ref:o,onClick:Re(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?c:s.jsx(wf,{asChild:!0,...i,children:c})});I3.displayName=R3;var p1="PopoverPortal",[HQ,VQ]=D3(p1,{forceMount:void 0}),O3=t=>{const{__scopePopover:e,forceMount:n,children:r,container:a}=t,i=Ho(p1,e);return s.jsx(HQ,{scope:e,forceMount:n,children:s.jsx(Gn,{present:n||i.open,children:s.jsx(Od,{asChild:!0,container:a,children:r})})})};O3.displayName=p1;var Ed="PopoverContent",L3=g.forwardRef((t,e)=>{const n=VQ(Ed,t.__scopePopover),{forceMount:r=n.forceMount,...a}=t,i=Ho(Ed,t.__scopePopover);return s.jsx(Gn,{present:r||i.open,children:i.modal?s.jsx(KQ,{...a,ref:e}):s.jsx(ZQ,{...a,ref:e})})});L3.displayName=Ed;var KQ=g.forwardRef((t,e)=>{const n=Ho(Ed,t.__scopePopover),r=g.useRef(null),a=Tt(e,r),i=g.useRef(!1);return g.useEffect(()=>{const o=r.current;if(o)return zg(o)},[]),s.jsx(Df,{as:wi,allowPinchZoom:!0,children:s.jsx(F3,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Re(t.onCloseAutoFocus,o=>{var c;o.preventDefault(),i.current||(c=n.triggerRef.current)==null||c.focus()}),onPointerDownOutside:Re(t.onPointerDownOutside,o=>{const c=o.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:Re(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),ZQ=g.forwardRef((t,e)=>{const n=Ho(Ed,t.__scopePopover),r=g.useRef(!1),a=g.useRef(!1);return s.jsx(F3,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,c;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(c=n.triggerRef.current)==null||c.focus(),i.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:i=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),F3=g.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:m,...f}=t,p=Ho(Ed,n),x=Mf(n);return Fg(),s.jsx(Pf,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:i,children:s.jsx(Hl,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:m,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onDismiss:()=>p.onOpenChange(!1),children:s.jsx(ug,{"data-state":z3(p.open),role:"dialog",id:p.contentId,...x,...f,ref:e,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),B3="PopoverClose",GQ=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,a=Ho(B3,n);return s.jsx(nt.button,{type:"button",...r,ref:e,onClick:Re(t.onClick,()=>a.onOpenChange(!1))})});GQ.displayName=B3;var QQ="PopoverArrow",YQ=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,a=Mf(n);return s.jsx(hg,{...a,...r,ref:e})});YQ.displayName=QQ;function z3(t){return t?"open":"closed"}var XQ=T3,JQ=I3,eY=O3,$3=L3;const $a=XQ,Ua=JQ,aa=g.forwardRef(({className:t,align:e="center",sideOffset:n=4,...r},a)=>s.jsx(eY,{children:s.jsx($3,{ref:a,align:e,sideOffset:n,className:Te("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));aa.displayName=$3.displayName;function zt(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function xr(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function cs(t,e){const n=zt(t);return isNaN(e)?xr(t,NaN):(e&&n.setDate(n.getDate()+e),n)}function vr(t,e){const n=zt(t);if(isNaN(e))return xr(t,NaN);if(!e)return n;const r=n.getDate(),a=xr(t,n.getTime());a.setMonth(n.getMonth()+e+1,0);const i=a.getDate();return r>=i?a:(n.setFullYear(a.getFullYear(),a.getMonth(),r),n)}const g1=6048e5,tY=864e5,x1=6e4,U3=36e5;let nY={};function Rf(){return nY}function ha(t,e){var c,d,u,m;const n=Rf(),r=(e==null?void 0:e.weekStartsOn)??((d=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??n.weekStartsOn??((m=(u=n.locale)==null?void 0:u.options)==null?void 0:m.weekStartsOn)??0,a=zt(t),i=a.getDay(),o=(i<r?7:0)+i-r;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function $l(t){return ha(t,{weekStartsOn:1})}function q3(t){const e=zt(t),n=e.getFullYear(),r=xr(t,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const a=$l(r),i=xr(t,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const o=$l(i);return e.getTime()>=a.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function Ad(t){const e=zt(t);return e.setHours(0,0,0,0),e}function A0(t){const e=zt(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function Ia(t,e){const n=Ad(t),r=Ad(e),a=+n-A0(n),i=+r-A0(r);return Math.round((a-i)/tY)}function sY(t){const e=q3(t),n=xr(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),$l(n)}function Jh(t,e){const n=e*7;return cs(t,n)}function rY(t,e){return vr(t,e*12)}function aY(t){let e;return t.forEach(function(n){const r=zt(n);(e===void 0||e<r||isNaN(Number(r)))&&(e=r)}),e||new Date(NaN)}function iY(t){let e;return t.forEach(n=>{const r=zt(n);(!e||e>r||isNaN(+r))&&(e=r)}),e||new Date(NaN)}function hs(t,e){const n=Ad(t),r=Ad(e);return+n==+r}function v1(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function oY(t){if(!v1(t)&&typeof t!="number")return!1;const e=zt(t);return!isNaN(Number(e))}function ef(t,e){const n=zt(t),r=zt(e),a=n.getFullYear()-r.getFullYear(),i=n.getMonth()-r.getMonth();return a*12+i}function lY(t,e,n){const r=ha(t,n),a=ha(e,n),i=+r-A0(r),o=+a-A0(a);return Math.round((i-o)/g1)}function cY(t){return e=>{const r=(t?Math[t]:Math.trunc)(e);return r===0?0:r}}function dY(t,e){return+zt(t)-+zt(e)}function DC(t,e,n){const r=dY(t,e)/x1;return cY(n==null?void 0:n.roundingMethod)(r)}function Zg(t){const e=zt(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function uY(t,e){const n=zt(t.start),r=zt(t.end);let a=+n>+r;const i=a?+n:+r,o=a?r:n;o.setHours(0,0,0,0);let c=1;const d=[];for(;+o<=i;)d.push(zt(o)),o.setDate(o.getDate()+c),o.setHours(0,0,0,0);return a?d.reverse():d}function Rs(t){const e=zt(t);return e.setDate(1),e.setHours(0,0,0,0),e}function W3(t){const e=zt(t),n=xr(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Gg(t,e){var c,d,u,m;const n=Rf(),r=(e==null?void 0:e.weekStartsOn)??((d=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??n.weekStartsOn??((m=(u=n.locale)==null?void 0:u.options)==null?void 0:m.weekStartsOn)??0,a=zt(t),i=a.getDay(),o=(i<r?-7:0)+6-(i-r);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}function H3(t){return Gg(t,{weekStartsOn:1})}const hY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},fY=(t,e,n)=>{let r;const a=hY[t];return typeof a=="string"?r=a:e===1?r=a.one:r=a.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function td(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const mY={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},pY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},gY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},xY={date:td({formats:mY,defaultWidth:"full"}),time:td({formats:pY,defaultWidth:"full"}),dateTime:td({formats:gY,defaultWidth:"full"})},vY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},yY=(t,e,n,r)=>vY[t];function Ta(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let a;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,c=n!=null&&n.width?String(n.width):o;a=t.formattingValues[c]||t.formattingValues[o]}else{const o=t.defaultWidth,c=n!=null&&n.width?String(n.width):t.defaultWidth;a=t.values[c]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return a[i]}}const _Y={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},wY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},bY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},jY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},NY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},SY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},kY=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},CY={ordinalNumber:kY,era:Ta({values:_Y,defaultWidth:"wide"}),quarter:Ta({values:wY,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ta({values:bY,defaultWidth:"wide"}),day:Ta({values:jY,defaultWidth:"wide"}),dayPeriod:Ta({values:NY,defaultWidth:"wide",formattingValues:SY,defaultFormattingWidth:"wide"})};function Ma(t){return(e,n={})=>{const r=n.width,a=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(a);if(!i)return null;const o=i[0],c=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],d=Array.isArray(c)?AY(c,f=>f.test(o)):EY(c,f=>f.test(o));let u;u=t.valueCallback?t.valueCallback(d):d,u=n.valueCallback?n.valueCallback(u):u;const m=e.slice(o.length);return{value:u,rest:m}}}function EY(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function AY(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function V3(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const a=r[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const c=e.slice(a.length);return{value:o,rest:c}}}const PY=/^(\d+)(th|st|nd|rd)?/i,DY=/\d+/i,TY={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},MY={any:[/^b/i,/^(a|c)/i]},RY={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},IY={any:[/1/i,/2/i,/3/i,/4/i]},OY={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},LY={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},FY={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},BY={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},zY={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},$Y={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},UY={ordinalNumber:V3({matchPattern:PY,parsePattern:DY,valueCallback:t=>parseInt(t,10)}),era:Ma({matchPatterns:TY,defaultMatchWidth:"wide",parsePatterns:MY,defaultParseWidth:"any"}),quarter:Ma({matchPatterns:RY,defaultMatchWidth:"wide",parsePatterns:IY,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ma({matchPatterns:OY,defaultMatchWidth:"wide",parsePatterns:LY,defaultParseWidth:"any"}),day:Ma({matchPatterns:FY,defaultMatchWidth:"wide",parsePatterns:BY,defaultParseWidth:"any"}),dayPeriod:Ma({matchPatterns:zY,defaultMatchWidth:"any",parsePatterns:$Y,defaultParseWidth:"any"})},K3={code:"en-US",formatDistance:fY,formatLong:xY,formatRelative:yY,localize:CY,match:UY,options:{weekStartsOn:0,firstWeekContainsDate:1}};function qY(t){const e=zt(t);return Ia(e,W3(e))+1}function Z3(t){const e=zt(t),n=+$l(e)-+sY(e);return Math.round(n/g1)+1}function G3(t,e){var m,f,p,x;const n=zt(t),r=n.getFullYear(),a=Rf(),i=(e==null?void 0:e.firstWeekContainsDate)??((f=(m=e==null?void 0:e.locale)==null?void 0:m.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((x=(p=a.locale)==null?void 0:p.options)==null?void 0:x.firstWeekContainsDate)??1,o=xr(t,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const c=ha(o,e),d=xr(t,0);d.setFullYear(r,0,i),d.setHours(0,0,0,0);const u=ha(d,e);return n.getTime()>=c.getTime()?r+1:n.getTime()>=u.getTime()?r:r-1}function WY(t,e){var c,d,u,m;const n=Rf(),r=(e==null?void 0:e.firstWeekContainsDate)??((d=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(u=n.locale)==null?void 0:u.options)==null?void 0:m.firstWeekContainsDate)??1,a=G3(t,e),i=xr(t,0);return i.setFullYear(a,0,r),i.setHours(0,0,0,0),ha(i,e)}function Q3(t,e){const n=zt(t),r=+ha(n,e)-+WY(n,e);return Math.round(r/g1)+1}function nn(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const zi={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return nn(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):nn(n+1,2)},d(t,e){return nn(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return nn(t.getHours()%12||12,e.length)},H(t,e){return nn(t.getHours(),e.length)},m(t,e){return nn(t.getMinutes(),e.length)},s(t,e){return nn(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),a=Math.trunc(r*Math.pow(10,n-3));return nn(a,e.length)}},_c={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},TC={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return zi.y(t,e)},Y:function(t,e,n,r){const a=G3(t,r),i=a>0?a:1-a;if(e==="YY"){const o=i%100;return nn(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):nn(i,e.length)},R:function(t,e){const n=q3(t);return nn(n,e.length)},u:function(t,e){const n=t.getFullYear();return nn(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return nn(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return nn(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return zi.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return nn(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const a=Q3(t,r);return e==="wo"?n.ordinalNumber(a,{unit:"week"}):nn(a,e.length)},I:function(t,e,n){const r=Z3(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):nn(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):zi.d(t,e)},D:function(t,e,n){const r=qY(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):nn(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const a=t.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return nn(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const a=t.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return nn(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),a=r===0?7:r;switch(e){case"i":return String(a);case"ii":return nn(a,e.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let a;switch(r===12?a=_c.noon:r===0?a=_c.midnight:a=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let a;switch(r>=17?a=_c.evening:r>=12?a=_c.afternoon:r>=4?a=_c.morning:a=_c.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return zi.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):zi.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):nn(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):nn(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):zi.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):zi.s(t,e)},S:function(t,e){return zi.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return RC(r);case"XXXX":case"XX":return sl(r);case"XXXXX":case"XXX":default:return sl(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return RC(r);case"xxxx":case"xx":return sl(r);case"xxxxx":case"xxx":default:return sl(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+MC(r,":");case"OOOO":default:return"GMT"+sl(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+MC(r,":");case"zzzz":default:return"GMT"+sl(r,":")}},t:function(t,e,n){const r=Math.trunc(t.getTime()/1e3);return nn(r,e.length)},T:function(t,e,n){const r=t.getTime();return nn(r,e.length)}};function MC(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),a=Math.trunc(r/60),i=r%60;return i===0?n+String(a):n+String(a)+e+nn(i,2)}function RC(t,e){return t%60===0?(t>0?"-":"+")+nn(Math.abs(t)/60,2):sl(t,e)}function sl(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),a=nn(Math.trunc(r/60),2),i=nn(r%60,2);return n+a+e+i}const IC=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Y3=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},HY=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return IC(t,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",IC(r,e)).replace("{{time}}",Y3(a,e))},VY={p:Y3,P:HY},KY=/^D+$/,ZY=/^Y+$/,GY=["D","DD","YY","YYYY"];function QY(t){return KY.test(t)}function YY(t){return ZY.test(t)}function XY(t,e,n){const r=JY(t,e,n);if(console.warn(r),GY.includes(t))throw new RangeError(r)}function JY(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const eX=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,tX=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,nX=/^'([^]*?)'?$/,sX=/''/g,rX=/[a-zA-Z]/;function Ze(t,e,n){var m,f,p,x,j,v,_,b;const r=Rf(),a=(n==null?void 0:n.locale)??r.locale??K3,i=(n==null?void 0:n.firstWeekContainsDate)??((f=(m=n==null?void 0:n.locale)==null?void 0:m.options)==null?void 0:f.firstWeekContainsDate)??r.firstWeekContainsDate??((x=(p=r.locale)==null?void 0:p.options)==null?void 0:x.firstWeekContainsDate)??1,o=(n==null?void 0:n.weekStartsOn)??((v=(j=n==null?void 0:n.locale)==null?void 0:j.options)==null?void 0:v.weekStartsOn)??r.weekStartsOn??((b=(_=r.locale)==null?void 0:_.options)==null?void 0:b.weekStartsOn)??0,c=zt(t);if(!oY(c))throw new RangeError("Invalid time value");let d=e.match(tX).map(w=>{const N=w[0];if(N==="p"||N==="P"){const S=VY[N];return S(w,a.formatLong)}return w}).join("").match(eX).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const N=w[0];if(N==="'")return{isToken:!1,value:aX(w)};if(TC[N])return{isToken:!0,value:w};if(N.match(rX))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:w}});a.localize.preprocessor&&(d=a.localize.preprocessor(c,d));const u={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return d.map(w=>{if(!w.isToken)return w.value;const N=w.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&YY(N)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&QY(N))&&XY(N,e,String(t));const S=TC[N[0]];return S(c,N,a.localize,u)}).join("")}function aX(t){const e=t.match(nX);return e?e[1].replace(sX,"'"):t}function iX(t){const e=zt(t),n=e.getFullYear(),r=e.getMonth(),a=xr(t,0);return a.setFullYear(n,r+1,0),a.setHours(0,0,0,0),a.getDate()}function oX(t){return Math.trunc(+zt(t)/1e3)}function lX(t){const e=zt(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(0,0,0,0),e}function cX(t,e){return lY(lX(t),Rs(t),e)+1}function $w(t,e){const n=zt(t),r=zt(e);return n.getTime()>r.getTime()}function X3(t,e){const n=zt(t),r=zt(e);return+n<+r}function y1(t,e){const n=zt(t),r=zt(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function dX(t,e){const n=zt(t),r=zt(e);return n.getFullYear()===r.getFullYear()}function xy(t,e){return cs(t,-e)}function Uc(t,e){const r=mX(t);let a;if(r.date){const d=pX(r.date,2);a=gX(d.restDateString,d.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let o=0,c;if(r.time&&(o=xX(r.time),isNaN(o)))return new Date(NaN);if(r.timezone){if(c=vX(r.timezone),isNaN(c))return new Date(NaN)}else{const d=new Date(i+o),u=new Date(0);return u.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),u.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),u}return new Date(i+o+c)}const Zm={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},uX=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,hX=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,fX=/^([+-])(\d{2})(?::?(\d{2}))?$/;function mX(t){const e={},n=t.split(Zm.dateTimeDelimiter);let r;if(n.length>2)return e;if(/:/.test(n[0])?r=n[0]:(e.date=n[0],r=n[1],Zm.timeZoneDelimiter.test(e.date)&&(e.date=t.split(Zm.timeZoneDelimiter)[0],r=t.substr(e.date.length,t.length))),r){const a=Zm.timezone.exec(r);a?(e.time=r.replace(a[1],""),e.timezone=a[1]):e.time=r}return e}function pX(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=t.match(n);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?a:i*100,restDateString:t.slice((r[1]||r[2]).length)}}function gX(t,e){if(e===null)return new Date(NaN);const n=t.match(uX);if(!n)return new Date(NaN);const r=!!n[4],a=Su(n[1]),i=Su(n[2])-1,o=Su(n[3]),c=Su(n[4]),d=Su(n[5])-1;if(r)return jX(e,c,d)?yX(e,c,d):new Date(NaN);{const u=new Date(0);return!wX(e,i,o)||!bX(e,a)?new Date(NaN):(u.setUTCFullYear(e,i,Math.max(a,o)),u)}}function Su(t){return t?parseInt(t):1}function xX(t){const e=t.match(hX);if(!e)return NaN;const n=vy(e[1]),r=vy(e[2]),a=vy(e[3]);return NX(n,r,a)?n*U3+r*x1+a*1e3:NaN}function vy(t){return t&&parseFloat(t.replace(",","."))||0}function vX(t){if(t==="Z")return 0;const e=t.match(fX);if(!e)return 0;const n=e[1]==="+"?-1:1,r=parseInt(e[2]),a=e[3]&&parseInt(e[3])||0;return SX(r,a)?n*(r*U3+a*x1):NaN}function yX(t,e,n){const r=new Date(0);r.setUTCFullYear(t,0,4);const a=r.getUTCDay()||7,i=(e-1)*7+n+1-a;return r.setUTCDate(r.getUTCDate()+i),r}const _X=[31,null,31,30,31,30,31,31,30,31,30,31];function J3(t){return t%400===0||t%4===0&&t%100!==0}function wX(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(_X[e]||(J3(t)?29:28))}function bX(t,e){return e>=1&&e<=(J3(t)?366:365)}function jX(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function NX(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function SX(t,e){return e>=0&&e<=59}function yy(t,e){const n=zt(t),r=n.getFullYear(),a=n.getDate(),i=xr(t,0);i.setFullYear(r,e,15),i.setHours(0,0,0,0);const o=iX(i);return n.setMonth(e,Math.min(a,o)),n}function OC(t,e){const n=zt(t);return isNaN(+n)?xr(t,NaN):(n.setFullYear(e),n)}function kX(t,e){return vr(t,-e)}function CX(t,e){return Jh(t,-e)}const LC={lessThanXSeconds:{standalone:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"},withPreposition:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"}},xSeconds:{standalone:{one:"1 Sekunde",other:"{{count}} Sekunden"},withPreposition:{one:"1 Sekunde",other:"{{count}} Sekunden"}},halfAMinute:{standalone:"eine halbe Minute",withPreposition:"einer halben Minute"},lessThanXMinutes:{standalone:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"},withPreposition:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"}},xMinutes:{standalone:{one:"1 Minute",other:"{{count}} Minuten"},withPreposition:{one:"1 Minute",other:"{{count}} Minuten"}},aboutXHours:{standalone:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"},withPreposition:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"}},xHours:{standalone:{one:"1 Stunde",other:"{{count}} Stunden"},withPreposition:{one:"1 Stunde",other:"{{count}} Stunden"}},xDays:{standalone:{one:"1 Tag",other:"{{count}} Tage"},withPreposition:{one:"1 Tag",other:"{{count}} Tagen"}},aboutXWeeks:{standalone:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"},withPreposition:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"}},xWeeks:{standalone:{one:"1 Woche",other:"{{count}} Wochen"},withPreposition:{one:"1 Woche",other:"{{count}} Wochen"}},aboutXMonths:{standalone:{one:"etwa 1 Monat",other:"etwa {{count}} Monate"},withPreposition:{one:"etwa 1 Monat",other:"etwa {{count}} Monaten"}},xMonths:{standalone:{one:"1 Monat",other:"{{count}} Monate"},withPreposition:{one:"1 Monat",other:"{{count}} Monaten"}},aboutXYears:{standalone:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahre"},withPreposition:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahren"}},xYears:{standalone:{one:"1 Jahr",other:"{{count}} Jahre"},withPreposition:{one:"1 Jahr",other:"{{count}} Jahren"}},overXYears:{standalone:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahre"},withPreposition:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahren"}},almostXYears:{standalone:{one:"fast 1 Jahr",other:"fast {{count}} Jahre"},withPreposition:{one:"fast 1 Jahr",other:"fast {{count}} Jahren"}}},EX=(t,e,n)=>{let r;const a=n!=null&&n.addSuffix?LC[t].withPreposition:LC[t].standalone;return typeof a=="string"?r=a:e===1?r=a.one:r=a.other.replace("{{count}}",String(e)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:"vor "+r:r},AX={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},PX={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},DX={full:"{{date}} 'um' {{time}}",long:"{{date}} 'um' {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},TX={date:td({formats:AX,defaultWidth:"full"}),time:td({formats:PX,defaultWidth:"full"}),dateTime:td({formats:DX,defaultWidth:"full"})},MX={lastWeek:"'letzten' eeee 'um' p",yesterday:"'gestern um' p",today:"'heute um' p",tomorrow:"'morgen um' p",nextWeek:"eeee 'um' p",other:"P"},RX=(t,e,n,r)=>MX[t],IX={narrow:["v.Chr.","n.Chr."],abbreviated:["v.Chr.","n.Chr."],wide:["vor Christus","nach Christus"]},OX={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1. Quartal","2. Quartal","3. Quartal","4. Quartal"]},Uw={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],wide:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},LX={narrow:Uw.narrow,abbreviated:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sep.","Okt.","Nov.","Dez."],wide:Uw.wide},FX={narrow:["S","M","D","M","D","F","S"],short:["So","Mo","Di","Mi","Do","Fr","Sa"],abbreviated:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],wide:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},BX={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachm.",evening:"Abend",night:"Nacht"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"}},zX={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachm.",evening:"abends",night:"nachts"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"}},$X=t=>Number(t)+".",UX={ordinalNumber:$X,era:Ta({values:IX,defaultWidth:"wide"}),quarter:Ta({values:OX,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ta({values:Uw,formattingValues:LX,defaultWidth:"wide"}),day:Ta({values:FX,defaultWidth:"wide"}),dayPeriod:Ta({values:BX,defaultWidth:"wide",formattingValues:zX,defaultFormattingWidth:"wide"})},qX=/^(\d+)(\.)?/i,WX=/\d+/i,HX={narrow:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,abbreviated:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,wide:/^(vor Christus|vor unserer Zeitrechnung|nach Christus|unserer Zeitrechnung)/i},VX={any:[/^v/i,/^n/i]},KX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](\.)? Quartal/i},ZX={any:[/1/i,/2/i,/3/i,/4/i]},GX={narrow:/^[jfmasond]/i,abbreviated:/^(j[aä]n|feb|mär[z]?|apr|mai|jun[i]?|jul[i]?|aug|sep|okt|nov|dez)\.?/i,wide:/^(januar|februar|märz|april|mai|juni|juli|august|september|oktober|november|dezember)/i},QX={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^j[aä]/i,/^f/i,/^mär/i,/^ap/i,/^mai/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},YX={narrow:/^[smdmf]/i,short:/^(so|mo|di|mi|do|fr|sa)/i,abbreviated:/^(son?|mon?|die?|mit?|don?|fre?|sam?)\.?/i,wide:/^(sonntag|montag|dienstag|mittwoch|donnerstag|freitag|samstag)/i},XX={any:[/^so/i,/^mo/i,/^di/i,/^mi/i,/^do/i,/^f/i,/^sa/i]},JX={narrow:/^(vm\.?|nm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,abbreviated:/^(vorm\.?|nachm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,wide:/^(vormittags|nachmittags|Mitternacht|Mittag|morgens|nachmittags|abends|nachts)/i},eJ={any:{am:/^v/i,pm:/^n/i,midnight:/^Mitte/i,noon:/^Mitta/i,morning:/morgens/i,afternoon:/nachmittags/i,evening:/abends/i,night:/nachts/i}},tJ={ordinalNumber:V3({matchPattern:qX,parsePattern:WX,valueCallback:t=>parseInt(t)}),era:Ma({matchPatterns:HX,defaultMatchWidth:"wide",parsePatterns:VX,defaultParseWidth:"any"}),quarter:Ma({matchPatterns:KX,defaultMatchWidth:"wide",parsePatterns:ZX,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ma({matchPatterns:GX,defaultMatchWidth:"wide",parsePatterns:QX,defaultParseWidth:"any"}),day:Ma({matchPatterns:YX,defaultMatchWidth:"wide",parsePatterns:XX,defaultParseWidth:"any"}),dayPeriod:Ma({matchPatterns:JX,defaultMatchWidth:"wide",parsePatterns:eJ,defaultParseWidth:"any"})},sn={code:"de",formatDistance:EX,formatLong:TX,formatRelative:RX,localize:UX,match:tJ,options:{weekStartsOn:1,firstWeekContainsDate:4}};var St=function(){return St=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},St.apply(this,arguments)};function nJ(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}function eI(t,e,n){for(var r=0,a=e.length,i;r<a;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}function If(t){return t.mode==="multiple"}function Of(t){return t.mode==="range"}function Qg(t){return t.mode==="single"}var sJ={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function rJ(t,e){return Ze(t,"LLLL y",e)}function aJ(t,e){return Ze(t,"d",e)}function iJ(t,e){return Ze(t,"LLLL",e)}function oJ(t){return"".concat(t)}function lJ(t,e){return Ze(t,"cccccc",e)}function cJ(t,e){return Ze(t,"yyyy",e)}var dJ=Object.freeze({__proto__:null,formatCaption:rJ,formatDay:aJ,formatMonthCaption:iJ,formatWeekNumber:oJ,formatWeekdayName:lJ,formatYearCaption:cJ}),uJ=function(t,e,n){return Ze(t,"do MMMM (EEEE)",n)},hJ=function(){return"Month: "},fJ=function(){return"Go to next month"},mJ=function(){return"Go to previous month"},pJ=function(t,e){return Ze(t,"cccc",e)},gJ=function(t){return"Week n. ".concat(t)},xJ=function(){return"Year: "},vJ=Object.freeze({__proto__:null,labelDay:uJ,labelMonthDropdown:hJ,labelNext:fJ,labelPrevious:mJ,labelWeekNumber:gJ,labelWeekday:pJ,labelYearDropdown:xJ});function yJ(){var t="buttons",e=sJ,n=K3,r={},a={},i=1,o={},c=new Date;return{captionLayout:t,classNames:e,formatters:dJ,labels:vJ,locale:n,modifiersClassNames:r,modifiers:a,numberOfMonths:i,styles:o,today:c,mode:"default"}}function _J(t){var e=t.fromYear,n=t.toYear,r=t.fromMonth,a=t.toMonth,i=t.fromDate,o=t.toDate;return r?i=Rs(r):e&&(i=new Date(e,0,1)),a?o=Zg(a):n&&(o=new Date(n,11,31)),{fromDate:i?Ad(i):void 0,toDate:o?Ad(o):void 0}}var tI=g.createContext(void 0);function wJ(t){var e,n=t.initialProps,r=yJ(),a=_J(n),i=a.fromDate,o=a.toDate,c=(e=n.captionLayout)!==null&&e!==void 0?e:r.captionLayout;c!=="buttons"&&(!i||!o)&&(c="buttons");var d;(Qg(n)||If(n)||Of(n))&&(d=n.onSelect);var u=St(St(St({},r),n),{captionLayout:c,classNames:St(St({},r.classNames),n.classNames),components:St({},n.components),formatters:St(St({},r.formatters),n.formatters),fromDate:i,labels:St(St({},r.labels),n.labels),mode:n.mode||r.mode,modifiers:St(St({},r.modifiers),n.modifiers),modifiersClassNames:St(St({},r.modifiersClassNames),n.modifiersClassNames),onSelect:d,styles:St(St({},r.styles),n.styles),toDate:o});return s.jsx(tI.Provider,{value:u,children:t.children})}function mn(){var t=g.useContext(tI);if(!t)throw new Error("useDayPicker must be used within a DayPickerProvider.");return t}function nI(t){var e=mn(),n=e.locale,r=e.classNames,a=e.styles,i=e.formatters.formatCaption;return s.jsx("div",{className:r.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:t.id,children:i(t.displayMonth,{locale:n})})}function bJ(t){return s.jsx("svg",St({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},t,{children:s.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function sI(t){var e,n,r=t.onChange,a=t.value,i=t.children,o=t.caption,c=t.className,d=t.style,u=mn(),m=(n=(e=u.components)===null||e===void 0?void 0:e.IconDropdown)!==null&&n!==void 0?n:bJ;return s.jsxs("div",{className:c,style:d,children:[s.jsx("span",{className:u.classNames.vhidden,children:t["aria-label"]}),s.jsx("select",{name:t.name,"aria-label":t["aria-label"],className:u.classNames.dropdown,style:u.styles.dropdown,value:a,onChange:r,children:i}),s.jsxs("div",{className:u.classNames.caption_label,style:u.styles.caption_label,"aria-hidden":"true",children:[o,s.jsx(m,{className:u.classNames.dropdown_icon,style:u.styles.dropdown_icon})]})]})}function jJ(t){var e,n=mn(),r=n.fromDate,a=n.toDate,i=n.styles,o=n.locale,c=n.formatters.formatMonthCaption,d=n.classNames,u=n.components,m=n.labels.labelMonthDropdown;if(!r)return s.jsx(s.Fragment,{});if(!a)return s.jsx(s.Fragment,{});var f=[];if(dX(r,a))for(var p=Rs(r),x=r.getMonth();x<=a.getMonth();x++)f.push(yy(p,x));else for(var p=Rs(new Date),x=0;x<=11;x++)f.push(yy(p,x));var j=function(_){var b=Number(_.target.value),w=yy(Rs(t.displayMonth),b);t.onChange(w)},v=(e=u==null?void 0:u.Dropdown)!==null&&e!==void 0?e:sI;return s.jsx(v,{name:"months","aria-label":m(),className:d.dropdown_month,style:i.dropdown_month,onChange:j,value:t.displayMonth.getMonth(),caption:c(t.displayMonth,{locale:o}),children:f.map(function(_){return s.jsx("option",{value:_.getMonth(),children:c(_,{locale:o})},_.getMonth())})})}function NJ(t){var e,n=t.displayMonth,r=mn(),a=r.fromDate,i=r.toDate,o=r.locale,c=r.styles,d=r.classNames,u=r.components,m=r.formatters.formatYearCaption,f=r.labels.labelYearDropdown,p=[];if(!a)return s.jsx(s.Fragment,{});if(!i)return s.jsx(s.Fragment,{});for(var x=a.getFullYear(),j=i.getFullYear(),v=x;v<=j;v++)p.push(OC(W3(new Date),v));var _=function(w){var N=OC(Rs(n),Number(w.target.value));t.onChange(N)},b=(e=u==null?void 0:u.Dropdown)!==null&&e!==void 0?e:sI;return s.jsx(b,{name:"years","aria-label":f(),className:d.dropdown_year,style:c.dropdown_year,onChange:_,value:n.getFullYear(),caption:m(n,{locale:o}),children:p.map(function(w){return s.jsx("option",{value:w.getFullYear(),children:m(w,{locale:o})},w.getFullYear())})})}function SJ(t,e){var n=g.useState(t),r=n[0],a=n[1],i=e===void 0?r:e;return[i,a]}function kJ(t){var e=t.month,n=t.defaultMonth,r=t.today,a=e||n||r||new Date,i=t.toDate,o=t.fromDate,c=t.numberOfMonths,d=c===void 0?1:c;if(i&&ef(i,a)<0){var u=-1*(d-1);a=vr(i,u)}return o&&ef(a,o)<0&&(a=o),Rs(a)}function CJ(){var t=mn(),e=kJ(t),n=SJ(e,t.month),r=n[0],a=n[1],i=function(o){var c;if(!t.disableNavigation){var d=Rs(o);a(d),(c=t.onMonthChange)===null||c===void 0||c.call(t,d)}};return[r,i]}function EJ(t,e){for(var n=e.reverseMonths,r=e.numberOfMonths,a=Rs(t),i=Rs(vr(a,r)),o=ef(i,a),c=[],d=0;d<o;d++){var u=vr(a,d);c.push(u)}return n&&(c=c.reverse()),c}function AJ(t,e){if(!e.disableNavigation){var n=e.toDate,r=e.pagedNavigation,a=e.numberOfMonths,i=a===void 0?1:a,o=r?i:1,c=Rs(t);if(!n)return vr(c,o);var d=ef(n,t);if(!(d<i))return vr(c,o)}}function PJ(t,e){if(!e.disableNavigation){var n=e.fromDate,r=e.pagedNavigation,a=e.numberOfMonths,i=a===void 0?1:a,o=r?i:1,c=Rs(t);if(!n)return vr(c,-o);var d=ef(c,n);if(!(d<=0))return vr(c,-o)}}var rI=g.createContext(void 0);function DJ(t){var e=mn(),n=CJ(),r=n[0],a=n[1],i=EJ(r,e),o=AJ(r,e),c=PJ(r,e),d=function(f){return i.some(function(p){return y1(f,p)})},u=function(f,p){d(f)||(p&&X3(f,p)?a(vr(f,1+e.numberOfMonths*-1)):a(f))},m={currentMonth:r,displayMonths:i,goToMonth:a,goToDate:u,previousMonth:c,nextMonth:o,isDateDisplayed:d};return s.jsx(rI.Provider,{value:m,children:t.children})}function Lf(){var t=g.useContext(rI);if(!t)throw new Error("useNavigation must be used within a NavigationProvider");return t}function FC(t){var e,n=mn(),r=n.classNames,a=n.styles,i=n.components,o=Lf().goToMonth,c=function(m){o(vr(m,t.displayIndex?-t.displayIndex:0))},d=(e=i==null?void 0:i.CaptionLabel)!==null&&e!==void 0?e:nI,u=s.jsx(d,{id:t.id,displayMonth:t.displayMonth});return s.jsxs("div",{className:r.caption_dropdowns,style:a.caption_dropdowns,children:[s.jsx("div",{className:r.vhidden,children:u}),s.jsx(jJ,{onChange:c,displayMonth:t.displayMonth}),s.jsx(NJ,{onChange:c,displayMonth:t.displayMonth})]})}function TJ(t){return s.jsx("svg",St({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:s.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function MJ(t){return s.jsx("svg",St({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:s.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var P0=g.forwardRef(function(t,e){var n=mn(),r=n.classNames,a=n.styles,i=[r.button_reset,r.button];t.className&&i.push(t.className);var o=i.join(" "),c=St(St({},a.button_reset),a.button);return t.style&&Object.assign(c,t.style),s.jsx("button",St({},t,{ref:e,type:"button",className:o,style:c}))});function RJ(t){var e,n,r=mn(),a=r.dir,i=r.locale,o=r.classNames,c=r.styles,d=r.labels,u=d.labelPrevious,m=d.labelNext,f=r.components;if(!t.nextMonth&&!t.previousMonth)return s.jsx(s.Fragment,{});var p=u(t.previousMonth,{locale:i}),x=[o.nav_button,o.nav_button_previous].join(" "),j=m(t.nextMonth,{locale:i}),v=[o.nav_button,o.nav_button_next].join(" "),_=(e=f==null?void 0:f.IconRight)!==null&&e!==void 0?e:MJ,b=(n=f==null?void 0:f.IconLeft)!==null&&n!==void 0?n:TJ;return s.jsxs("div",{className:o.nav,style:c.nav,children:[!t.hidePrevious&&s.jsx(P0,{name:"previous-month","aria-label":p,className:x,style:c.nav_button_previous,disabled:!t.previousMonth,onClick:t.onPreviousClick,children:a==="rtl"?s.jsx(_,{className:o.nav_icon,style:c.nav_icon}):s.jsx(b,{className:o.nav_icon,style:c.nav_icon})}),!t.hideNext&&s.jsx(P0,{name:"next-month","aria-label":j,className:v,style:c.nav_button_next,disabled:!t.nextMonth,onClick:t.onNextClick,children:a==="rtl"?s.jsx(b,{className:o.nav_icon,style:c.nav_icon}):s.jsx(_,{className:o.nav_icon,style:c.nav_icon})})]})}function BC(t){var e=mn().numberOfMonths,n=Lf(),r=n.previousMonth,a=n.nextMonth,i=n.goToMonth,o=n.displayMonths,c=o.findIndex(function(j){return y1(t.displayMonth,j)}),d=c===0,u=c===o.length-1,m=e>1&&(d||!u),f=e>1&&(u||!d),p=function(){r&&i(r)},x=function(){a&&i(a)};return s.jsx(RJ,{displayMonth:t.displayMonth,hideNext:m,hidePrevious:f,nextMonth:a,previousMonth:r,onPreviousClick:p,onNextClick:x})}function IJ(t){var e,n=mn(),r=n.classNames,a=n.disableNavigation,i=n.styles,o=n.captionLayout,c=n.components,d=(e=c==null?void 0:c.CaptionLabel)!==null&&e!==void 0?e:nI,u;return a?u=s.jsx(d,{id:t.id,displayMonth:t.displayMonth}):o==="dropdown"?u=s.jsx(FC,{displayMonth:t.displayMonth,id:t.id}):o==="dropdown-buttons"?u=s.jsxs(s.Fragment,{children:[s.jsx(FC,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id}),s.jsx(BC,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id})]}):u=s.jsxs(s.Fragment,{children:[s.jsx(d,{id:t.id,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),s.jsx(BC,{displayMonth:t.displayMonth,id:t.id})]}),s.jsx("div",{className:r.caption,style:i.caption,children:u})}function OJ(t){var e=mn(),n=e.footer,r=e.styles,a=e.classNames.tfoot;return n?s.jsx("tfoot",{className:a,style:r.tfoot,children:s.jsx("tr",{children:s.jsx("td",{colSpan:8,children:n})})}):s.jsx(s.Fragment,{})}function LJ(t,e,n){for(var r=n?$l(new Date):ha(new Date,{locale:t,weekStartsOn:e}),a=[],i=0;i<7;i++){var o=cs(r,i);a.push(o)}return a}function FJ(){var t=mn(),e=t.classNames,n=t.styles,r=t.showWeekNumber,a=t.locale,i=t.weekStartsOn,o=t.ISOWeek,c=t.formatters.formatWeekdayName,d=t.labels.labelWeekday,u=LJ(a,i,o);return s.jsxs("tr",{style:n.head_row,className:e.head_row,children:[r&&s.jsx("td",{style:n.head_cell,className:e.head_cell}),u.map(function(m,f){return s.jsx("th",{scope:"col",className:e.head_cell,style:n.head_cell,"aria-label":d(m,{locale:a}),children:c(m,{locale:a})},f)})]})}function BJ(){var t,e=mn(),n=e.classNames,r=e.styles,a=e.components,i=(t=a==null?void 0:a.HeadRow)!==null&&t!==void 0?t:FJ;return s.jsx("thead",{style:r.head,className:n.head,children:s.jsx(i,{})})}function zJ(t){var e=mn(),n=e.locale,r=e.formatters.formatDay;return s.jsx(s.Fragment,{children:r(t.date,{locale:n})})}var _1=g.createContext(void 0);function $J(t){if(!If(t.initialProps)){var e={selected:void 0,modifiers:{disabled:[]}};return s.jsx(_1.Provider,{value:e,children:t.children})}return s.jsx(UJ,{initialProps:t.initialProps,children:t.children})}function UJ(t){var e=t.initialProps,n=t.children,r=e.selected,a=e.min,i=e.max,o=function(u,m,f){var p,x;(p=e.onDayClick)===null||p===void 0||p.call(e,u,m,f);var j=!!(m.selected&&a&&(r==null?void 0:r.length)===a);if(!j){var v=!!(!m.selected&&i&&(r==null?void 0:r.length)===i);if(!v){var _=r?eI([],r):[];if(m.selected){var b=_.findIndex(function(w){return hs(u,w)});_.splice(b,1)}else _.push(u);(x=e.onSelect)===null||x===void 0||x.call(e,_,u,m,f)}}},c={disabled:[]};r&&c.disabled.push(function(u){var m=i&&r.length>i-1,f=r.some(function(p){return hs(p,u)});return!!(m&&!f)});var d={selected:r,onDayClick:o,modifiers:c};return s.jsx(_1.Provider,{value:d,children:n})}function w1(){var t=g.useContext(_1);if(!t)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return t}function qJ(t,e){var n=e||{},r=n.from,a=n.to;return r&&a?hs(a,t)&&hs(r,t)?void 0:hs(a,t)?{from:a,to:void 0}:hs(r,t)?void 0:$w(r,t)?{from:t,to:a}:{from:r,to:t}:a?$w(t,a)?{from:a,to:t}:{from:t,to:a}:r?X3(t,r)?{from:t,to:r}:{from:r,to:t}:{from:t,to:void 0}}var b1=g.createContext(void 0);function WJ(t){if(!Of(t.initialProps)){var e={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return s.jsx(b1.Provider,{value:e,children:t.children})}return s.jsx(HJ,{initialProps:t.initialProps,children:t.children})}function HJ(t){var e=t.initialProps,n=t.children,r=e.selected,a=r||{},i=a.from,o=a.to,c=e.min,d=e.max,u=function(x,j,v){var _,b;(_=e.onDayClick)===null||_===void 0||_.call(e,x,j,v);var w=qJ(x,r);(b=e.onSelect)===null||b===void 0||b.call(e,w,x,j,v)},m={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(m.range_start=[i],o?(m.range_end=[o],hs(i,o)||(m.range_middle=[{after:i,before:o}])):m.range_end=[i]):o&&(m.range_start=[o],m.range_end=[o]),c&&(i&&!o&&m.disabled.push({after:xy(i,c-1),before:cs(i,c-1)}),i&&o&&m.disabled.push({after:i,before:cs(i,c-1)}),!i&&o&&m.disabled.push({after:xy(o,c-1),before:cs(o,c-1)})),d){if(i&&!o&&(m.disabled.push({before:cs(i,-d+1)}),m.disabled.push({after:cs(i,d-1)})),i&&o){var f=Ia(o,i)+1,p=d-f;m.disabled.push({before:xy(i,p)}),m.disabled.push({after:cs(o,p)})}!i&&o&&(m.disabled.push({before:cs(o,-d+1)}),m.disabled.push({after:cs(o,d-1)}))}return s.jsx(b1.Provider,{value:{selected:r,onDayClick:u,modifiers:m},children:n})}function j1(){var t=g.useContext(b1);if(!t)throw new Error("useSelectRange must be used within a SelectRangeProvider");return t}function kp(t){return Array.isArray(t)?eI([],t):t!==void 0?[t]:[]}function VJ(t){var e={};return Object.entries(t).forEach(function(n){var r=n[0],a=n[1];e[r]=kp(a)}),e}var fa;(function(t){t.Outside="outside",t.Disabled="disabled",t.Selected="selected",t.Hidden="hidden",t.Today="today",t.RangeStart="range_start",t.RangeEnd="range_end",t.RangeMiddle="range_middle"})(fa||(fa={}));var KJ=fa.Selected,si=fa.Disabled,ZJ=fa.Hidden,GJ=fa.Today,_y=fa.RangeEnd,wy=fa.RangeMiddle,by=fa.RangeStart,QJ=fa.Outside;function YJ(t,e,n){var r,a=(r={},r[KJ]=kp(t.selected),r[si]=kp(t.disabled),r[ZJ]=kp(t.hidden),r[GJ]=[t.today],r[_y]=[],r[wy]=[],r[by]=[],r[QJ]=[],r);return t.fromDate&&a[si].push({before:t.fromDate}),t.toDate&&a[si].push({after:t.toDate}),If(t)?a[si]=a[si].concat(e.modifiers[si]):Of(t)&&(a[si]=a[si].concat(n.modifiers[si]),a[by]=n.modifiers[by],a[wy]=n.modifiers[wy],a[_y]=n.modifiers[_y]),a}var aI=g.createContext(void 0);function XJ(t){var e=mn(),n=w1(),r=j1(),a=YJ(e,n,r),i=VJ(e.modifiers),o=St(St({},a),i);return s.jsx(aI.Provider,{value:o,children:t.children})}function iI(){var t=g.useContext(aI);if(!t)throw new Error("useModifiers must be used within a ModifiersProvider");return t}function JJ(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function eee(t){return!!(t&&typeof t=="object"&&"from"in t)}function tee(t){return!!(t&&typeof t=="object"&&"after"in t)}function nee(t){return!!(t&&typeof t=="object"&&"before"in t)}function see(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function ree(t,e){var n,r=e.from,a=e.to;if(r&&a){var i=Ia(a,r)<0;i&&(n=[a,r],r=n[0],a=n[1]);var o=Ia(t,r)>=0&&Ia(a,t)>=0;return o}return a?hs(a,t):r?hs(r,t):!1}function aee(t){return v1(t)}function iee(t){return Array.isArray(t)&&t.every(v1)}function oee(t,e){return e.some(function(n){if(typeof n=="boolean")return n;if(aee(n))return hs(t,n);if(iee(n))return n.includes(t);if(eee(n))return ree(t,n);if(see(n))return n.dayOfWeek.includes(t.getDay());if(JJ(n)){var r=Ia(n.before,t),a=Ia(n.after,t),i=r>0,o=a<0,c=$w(n.before,n.after);return c?o&&i:i||o}return tee(n)?Ia(t,n.after)>0:nee(n)?Ia(n.before,t)>0:typeof n=="function"?n(t):!1})}function N1(t,e,n){var r=Object.keys(e).reduce(function(i,o){var c=e[o];return oee(t,c)&&i.push(o),i},[]),a={};return r.forEach(function(i){return a[i]=!0}),n&&!y1(t,n)&&(a.outside=!0),a}function lee(t,e){for(var n=Rs(t[0]),r=Zg(t[t.length-1]),a,i,o=n;o<=r;){var c=N1(o,e),d=!c.disabled&&!c.hidden;if(!d){o=cs(o,1);continue}if(c.selected)return o;c.today&&!i&&(i=o),a||(a=o),o=cs(o,1)}return i||a}var cee=365;function oI(t,e){var n=e.moveBy,r=e.direction,a=e.context,i=e.modifiers,o=e.retry,c=o===void 0?{count:0,lastFocused:t}:o,d=a.weekStartsOn,u=a.fromDate,m=a.toDate,f=a.locale,p={day:cs,week:Jh,month:vr,year:rY,startOfWeek:function(_){return a.ISOWeek?$l(_):ha(_,{locale:f,weekStartsOn:d})},endOfWeek:function(_){return a.ISOWeek?H3(_):Gg(_,{locale:f,weekStartsOn:d})}},x=p[n](t,r==="after"?1:-1);r==="before"&&u?x=aY([u,x]):r==="after"&&m&&(x=iY([m,x]));var j=!0;if(i){var v=N1(x,i);j=!v.disabled&&!v.hidden}return j?x:c.count>cee?c.lastFocused:oI(x,{moveBy:n,direction:r,context:a,modifiers:i,retry:St(St({},c),{count:c.count+1})})}var lI=g.createContext(void 0);function dee(t){var e=Lf(),n=iI(),r=g.useState(),a=r[0],i=r[1],o=g.useState(),c=o[0],d=o[1],u=lee(e.displayMonths,n),m=a??(c&&e.isDateDisplayed(c))?c:u,f=function(){d(a),i(void 0)},p=function(_){i(_)},x=mn(),j=function(_,b){if(a){var w=oI(a,{moveBy:_,direction:b,context:x,modifiers:n});hs(a,w)||(e.goToDate(w,a),p(w))}},v={focusedDay:a,focusTarget:m,blur:f,focus:p,focusDayAfter:function(){return j("day","after")},focusDayBefore:function(){return j("day","before")},focusWeekAfter:function(){return j("week","after")},focusWeekBefore:function(){return j("week","before")},focusMonthBefore:function(){return j("month","before")},focusMonthAfter:function(){return j("month","after")},focusYearBefore:function(){return j("year","before")},focusYearAfter:function(){return j("year","after")},focusStartOfWeek:function(){return j("startOfWeek","before")},focusEndOfWeek:function(){return j("endOfWeek","after")}};return s.jsx(lI.Provider,{value:v,children:t.children})}function S1(){var t=g.useContext(lI);if(!t)throw new Error("useFocusContext must be used within a FocusProvider");return t}function uee(t,e){var n=iI(),r=N1(t,n,e);return r}var k1=g.createContext(void 0);function hee(t){if(!Qg(t.initialProps)){var e={selected:void 0};return s.jsx(k1.Provider,{value:e,children:t.children})}return s.jsx(fee,{initialProps:t.initialProps,children:t.children})}function fee(t){var e=t.initialProps,n=t.children,r=function(i,o,c){var d,u,m;if((d=e.onDayClick)===null||d===void 0||d.call(e,i,o,c),o.selected&&!e.required){(u=e.onSelect)===null||u===void 0||u.call(e,void 0,i,o,c);return}(m=e.onSelect)===null||m===void 0||m.call(e,i,i,o,c)},a={selected:e.selected,onDayClick:r};return s.jsx(k1.Provider,{value:a,children:n})}function cI(){var t=g.useContext(k1);if(!t)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return t}function mee(t,e){var n=mn(),r=cI(),a=w1(),i=j1(),o=S1(),c=o.focusDayAfter,d=o.focusDayBefore,u=o.focusWeekAfter,m=o.focusWeekBefore,f=o.blur,p=o.focus,x=o.focusMonthBefore,j=o.focusMonthAfter,v=o.focusYearBefore,_=o.focusYearAfter,b=o.focusStartOfWeek,w=o.focusEndOfWeek,N=function(G){var I,V,$,F;Qg(n)?(I=r.onDayClick)===null||I===void 0||I.call(r,t,e,G):If(n)?(V=a.onDayClick)===null||V===void 0||V.call(a,t,e,G):Of(n)?($=i.onDayClick)===null||$===void 0||$.call(i,t,e,G):(F=n.onDayClick)===null||F===void 0||F.call(n,t,e,G)},S=function(G){var I;p(t),(I=n.onDayFocus)===null||I===void 0||I.call(n,t,e,G)},C=function(G){var I;f(),(I=n.onDayBlur)===null||I===void 0||I.call(n,t,e,G)},A=function(G){var I;(I=n.onDayMouseEnter)===null||I===void 0||I.call(n,t,e,G)},P=function(G){var I;(I=n.onDayMouseLeave)===null||I===void 0||I.call(n,t,e,G)},M=function(G){var I;(I=n.onDayPointerEnter)===null||I===void 0||I.call(n,t,e,G)},z=function(G){var I;(I=n.onDayPointerLeave)===null||I===void 0||I.call(n,t,e,G)},R=function(G){var I;(I=n.onDayTouchCancel)===null||I===void 0||I.call(n,t,e,G)},D=function(G){var I;(I=n.onDayTouchEnd)===null||I===void 0||I.call(n,t,e,G)},B=function(G){var I;(I=n.onDayTouchMove)===null||I===void 0||I.call(n,t,e,G)},W=function(G){var I;(I=n.onDayTouchStart)===null||I===void 0||I.call(n,t,e,G)},X=function(G){var I;(I=n.onDayKeyUp)===null||I===void 0||I.call(n,t,e,G)},ue=function(G){var I;switch(G.key){case"ArrowLeft":G.preventDefault(),G.stopPropagation(),n.dir==="rtl"?c():d();break;case"ArrowRight":G.preventDefault(),G.stopPropagation(),n.dir==="rtl"?d():c();break;case"ArrowDown":G.preventDefault(),G.stopPropagation(),u();break;case"ArrowUp":G.preventDefault(),G.stopPropagation(),m();break;case"PageUp":G.preventDefault(),G.stopPropagation(),G.shiftKey?v():x();break;case"PageDown":G.preventDefault(),G.stopPropagation(),G.shiftKey?_():j();break;case"Home":G.preventDefault(),G.stopPropagation(),b();break;case"End":G.preventDefault(),G.stopPropagation(),w();break}(I=n.onDayKeyDown)===null||I===void 0||I.call(n,t,e,G)},de={onClick:N,onFocus:S,onBlur:C,onKeyDown:ue,onKeyUp:X,onMouseEnter:A,onMouseLeave:P,onPointerEnter:M,onPointerLeave:z,onTouchCancel:R,onTouchEnd:D,onTouchMove:B,onTouchStart:W};return de}function pee(){var t=mn(),e=cI(),n=w1(),r=j1(),a=Qg(t)?e.selected:If(t)?n.selected:Of(t)?r.selected:void 0;return a}function gee(t){return Object.values(fa).includes(t)}function xee(t,e){var n=[t.classNames.day];return Object.keys(e).forEach(function(r){var a=t.modifiersClassNames[r];if(a)n.push(a);else if(gee(r)){var i=t.classNames["day_".concat(r)];i&&n.push(i)}}),n}function vee(t,e){var n=St({},t.styles.day);return Object.keys(e).forEach(function(r){var a;n=St(St({},n),(a=t.modifiersStyles)===null||a===void 0?void 0:a[r])}),n}function yee(t,e,n){var r,a,i,o=mn(),c=S1(),d=uee(t,e),u=mee(t,d),m=pee(),f=!!(o.onDayClick||o.mode!=="default");g.useEffect(function(){var A;d.outside||c.focusedDay&&f&&hs(c.focusedDay,t)&&((A=n.current)===null||A===void 0||A.focus())},[c.focusedDay,t,n,f,d.outside]);var p=xee(o,d).join(" "),x=vee(o,d),j=!!(d.outside&&!o.showOutsideDays||d.hidden),v=(i=(a=o.components)===null||a===void 0?void 0:a.DayContent)!==null&&i!==void 0?i:zJ,_=s.jsx(v,{date:t,displayMonth:e,activeModifiers:d}),b={style:x,className:p,children:_,role:"gridcell"},w=c.focusTarget&&hs(c.focusTarget,t)&&!d.outside,N=c.focusedDay&&hs(c.focusedDay,t),S=St(St(St({},b),(r={disabled:d.disabled,role:"gridcell"},r["aria-selected"]=d.selected,r.tabIndex=N||w?0:-1,r)),u),C={isButton:f,isHidden:j,activeModifiers:d,selectedDays:m,buttonProps:S,divProps:b};return C}function _ee(t){var e=g.useRef(null),n=yee(t.date,t.displayMonth,e);return n.isHidden?s.jsx("div",{role:"gridcell"}):n.isButton?s.jsx(P0,St({name:"day",ref:e},n.buttonProps)):s.jsx("div",St({},n.divProps))}function wee(t){var e=t.number,n=t.dates,r=mn(),a=r.onWeekNumberClick,i=r.styles,o=r.classNames,c=r.locale,d=r.labels.labelWeekNumber,u=r.formatters.formatWeekNumber,m=u(Number(e),{locale:c});if(!a)return s.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:m});var f=d(Number(e),{locale:c}),p=function(x){a(e,n,x)};return s.jsx(P0,{name:"week-number","aria-label":f,className:o.weeknumber,style:i.weeknumber,onClick:p,children:m})}function bee(t){var e,n,r=mn(),a=r.styles,i=r.classNames,o=r.showWeekNumber,c=r.components,d=(e=c==null?void 0:c.Day)!==null&&e!==void 0?e:_ee,u=(n=c==null?void 0:c.WeekNumber)!==null&&n!==void 0?n:wee,m;return o&&(m=s.jsx("td",{className:i.cell,style:a.cell,children:s.jsx(u,{number:t.weekNumber,dates:t.dates})})),s.jsxs("tr",{className:i.row,style:a.row,children:[m,t.dates.map(function(f){return s.jsx("td",{className:i.cell,style:a.cell,role:"presentation",children:s.jsx(d,{displayMonth:t.displayMonth,date:f})},oX(f))})]})}function zC(t,e,n){for(var r=n!=null&&n.ISOWeek?H3(e):Gg(e,n),a=n!=null&&n.ISOWeek?$l(t):ha(t,n),i=Ia(r,a),o=[],c=0;c<=i;c++)o.push(cs(a,c));var d=o.reduce(function(u,m){var f=n!=null&&n.ISOWeek?Z3(m):Q3(m,n),p=u.find(function(x){return x.weekNumber===f});return p?(p.dates.push(m),u):(u.push({weekNumber:f,dates:[m]}),u)},[]);return d}function jee(t,e){var n=zC(Rs(t),Zg(t),e);if(e!=null&&e.useFixedWeeks){var r=cX(t,e);if(r<6){var a=n[n.length-1],i=a.dates[a.dates.length-1],o=Jh(i,6-r),c=zC(Jh(i,1),o,e);n.push.apply(n,c)}}return n}function Nee(t){var e,n,r,a=mn(),i=a.locale,o=a.classNames,c=a.styles,d=a.hideHead,u=a.fixedWeeks,m=a.components,f=a.weekStartsOn,p=a.firstWeekContainsDate,x=a.ISOWeek,j=jee(t.displayMonth,{useFixedWeeks:!!u,ISOWeek:x,locale:i,weekStartsOn:f,firstWeekContainsDate:p}),v=(e=m==null?void 0:m.Head)!==null&&e!==void 0?e:BJ,_=(n=m==null?void 0:m.Row)!==null&&n!==void 0?n:bee,b=(r=m==null?void 0:m.Footer)!==null&&r!==void 0?r:OJ;return s.jsxs("table",{id:t.id,className:o.table,style:c.table,role:"grid","aria-labelledby":t["aria-labelledby"],children:[!d&&s.jsx(v,{}),s.jsx("tbody",{className:o.tbody,style:c.tbody,children:j.map(function(w){return s.jsx(_,{displayMonth:t.displayMonth,dates:w.dates,weekNumber:w.weekNumber},w.weekNumber)})}),s.jsx(b,{displayMonth:t.displayMonth})]})}function See(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var kee=See()?g.useLayoutEffect:g.useEffect,jy=!1,Cee=0;function $C(){return"react-day-picker-".concat(++Cee)}function Eee(t){var e,n=t??(jy?$C():null),r=g.useState(n),a=r[0],i=r[1];return kee(function(){a===null&&i($C())},[]),g.useEffect(function(){jy===!1&&(jy=!0)},[]),(e=t??a)!==null&&e!==void 0?e:void 0}function Aee(t){var e,n,r=mn(),a=r.dir,i=r.classNames,o=r.styles,c=r.components,d=Lf().displayMonths,u=Eee(r.id?"".concat(r.id,"-").concat(t.displayIndex):void 0),m=r.id?"".concat(r.id,"-grid-").concat(t.displayIndex):void 0,f=[i.month],p=o.month,x=t.displayIndex===0,j=t.displayIndex===d.length-1,v=!x&&!j;a==="rtl"&&(e=[x,j],j=e[0],x=e[1]),x&&(f.push(i.caption_start),p=St(St({},p),o.caption_start)),j&&(f.push(i.caption_end),p=St(St({},p),o.caption_end)),v&&(f.push(i.caption_between),p=St(St({},p),o.caption_between));var _=(n=c==null?void 0:c.Caption)!==null&&n!==void 0?n:IJ;return s.jsxs("div",{className:f.join(" "),style:p,children:[s.jsx(_,{id:u,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),s.jsx(Nee,{id:m,"aria-labelledby":u,displayMonth:t.displayMonth})]},t.displayIndex)}function Pee(t){var e=mn(),n=e.classNames,r=e.styles;return s.jsx("div",{className:n.months,style:r.months,children:t.children})}function Dee(t){var e,n,r=t.initialProps,a=mn(),i=S1(),o=Lf(),c=g.useState(!1),d=c[0],u=c[1];g.useEffect(function(){a.initialFocus&&i.focusTarget&&(d||(i.focus(i.focusTarget),u(!0)))},[a.initialFocus,d,i.focus,i.focusTarget,i]);var m=[a.classNames.root,a.className];a.numberOfMonths>1&&m.push(a.classNames.multiple_months),a.showWeekNumber&&m.push(a.classNames.with_weeknumber);var f=St(St({},a.styles.root),a.style),p=Object.keys(r).filter(function(j){return j.startsWith("data-")}).reduce(function(j,v){var _;return St(St({},j),(_={},_[v]=r[v],_))},{}),x=(n=(e=r.components)===null||e===void 0?void 0:e.Months)!==null&&n!==void 0?n:Pee;return s.jsx("div",St({className:m.join(" "),style:f,dir:a.dir,id:a.id,nonce:r.nonce,title:r.title,lang:r.lang},p,{children:s.jsx(x,{children:o.displayMonths.map(function(j,v){return s.jsx(Aee,{displayIndex:v,displayMonth:j},v)})})}))}function Tee(t){var e=t.children,n=nJ(t,["children"]);return s.jsx(wJ,{initialProps:n,children:s.jsx(DJ,{children:s.jsx(hee,{initialProps:n,children:s.jsx($J,{initialProps:n,children:s.jsx(WJ,{initialProps:n,children:s.jsx(XJ,{children:s.jsx(dee,{children:e})})})})})})})}function Mee(t){return s.jsx(Tee,St({},t,{children:s.jsx(Dee,{initialProps:t})}))}function ia({className:t,classNames:e,showOutsideDays:n=!0,...r}){return s.jsx(Mee,{showOutsideDays:n,className:Te("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Te(mw({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Te(mw({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...e},components:{IconLeft:({...a})=>s.jsx(rh,{className:"h-4 w-4"}),IconRight:({...a})=>s.jsx(jl,{className:"h-4 w-4"})},...r})}ia.displayName="Calendar";const Ree=({isOpen:t,onClose:e,onProjectAdded:n,customers:r,teamMembers:a})=>{const{toast:i}=Mt();cR(),console.log("AddProjectDialog - customers:",r),console.log("AddProjectDialog - teamMembers:",a);const[o,c]=g.useState({name:"",customer:"",location:"",budget:"",team:[],status:"geplant"}),[d,u]=g.useState(),m=(b,w)=>{if(!(w!=null&&w.from)||!(w!=null&&w.to))return"unknown";const N=w.from,S=w.to;let C=0;const A=Math.ceil((S.getTime()-N.getTime())/(1e3*60*60*24));return b.projects.forEach(P=>{const M=new Date(P.startDate.split(".").reverse().join("-")),z=new Date(P.endDate.split(".").reverse().join("-"));if(N<=z&&S>=M){const R=new Date(Math.max(N.getTime(),M.getTime())),D=new Date(Math.min(S.getTime(),z.getTime())),B=Math.ceil((D.getTime()-R.getTime())/(1e3*60*60*24));C+=B}}),C===0?"available":C>=A*.8?"unavailable":"partial"},f=g.useMemo(()=>a.map(b=>({...b,availability:m(b,d)})),[a,d]),p=b=>{switch(b){case"available":return s.jsx(Qe,{className:"bg-green-100 text-green-800 text-xs",children:"Verfügbar"});case"partial":return s.jsx(Qe,{className:"bg-orange-100 text-orange-800 text-xs",children:"Teilweise"});case"unavailable":return s.jsx(Qe,{className:"bg-red-100 text-red-800 text-xs",children:"Nicht verfügbar"});default:return s.jsx(Qe,{variant:"outline",className:"text-xs",children:"Unbekannt"})}},x=b=>{if(b.preventDefault(),!o.name||!o.customer||!o.budget){i({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}const w={id:`P2024-${String(Date.now()).slice(-3)}`,name:o.name,customer:o.customer,status:o.status,progress:0,startDate:d!=null&&d.from?Ze(d.from,"dd.MM.yyyy"):new Date().toLocaleDateString("de-DE"),endDate:d!=null&&d.to?Ze(d.to,"dd.MM.yyyy"):new Date(Date.now()+30*24*60*60*1e3).toLocaleDateString("de-DE"),budget:o.budget.startsWith("€")?o.budget:`€${o.budget}`,team:o.team.length>0?o.team:["Nicht zugewiesen"],location:o.location||"Nicht angegeben"};n(w),c({name:"",customer:"",location:"",budget:"",team:[],status:"geplant"}),u(void 0),i({title:"Erfolg",description:"Projekt wurde erfolgreich hinzugefügt."}),e()},j=(b,w)=>{c(N=>({...N,[b]:w}))},v=b=>{const w=r.find(N=>N.name===b||N.company_name===b);c(N=>({...N,customer:b,location:w?w.address:""}))},_=(b,w)=>{const N=a.find(C=>C.name===b||`${C.first_name||""} ${C.last_name||""}`.trim()===b),S=(N==null?void 0:N.name)||`${(N==null?void 0:N.first_name)||""} ${(N==null?void 0:N.last_name)||""}`.trim()||b;c(C=>({...C,team:w?[...C.team,S]:C.team.filter(A=>A!==S)}))};return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Neues Projekt erstellen"}),s.jsx($n,{children:"Geben Sie die Informationen für das neue Projekt ein."})]}),s.jsxs("form",{onSubmit:x,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"name",children:"Projektname *"}),s.jsx(ae,{id:"name",value:o.name,onChange:b=>j("name",b.target.value),placeholder:"z.B. Büroerweiterung Müller GmbH",required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"customer",children:"Kunde *"}),s.jsxs(mt,{value:o.customer,onValueChange:v,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Kunde auswählen"})}),s.jsx(ft,{children:r.map(b=>s.jsx(ye,{value:b.name||b.company_name||"Unbekannt",children:b.name||b.company_name||"Unbekannt"},b.id))})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"location",children:"Standort"}),s.jsx(ae,{id:"location",value:o.location,onChange:b=>j("location",b.target.value),placeholder:"Wird automatisch aus Kundendaten übernommen",readOnly:!0,className:"bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"budget",children:"Budget *"}),s.jsx(ae,{id:"budget",value:o.budget,onChange:b=>j("budget",b.target.value),placeholder:"z.B. 15000 oder €15.000",required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Projektzeitraum"}),s.jsxs($a,{children:[s.jsx(Ua,{asChild:!0,children:s.jsxs(ee,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),d!=null&&d.from?d.to?s.jsxs(s.Fragment,{children:[Ze(d.from,"dd.MM.yyyy",{locale:sn})," -"," ",Ze(d.to,"dd.MM.yyyy",{locale:sn})]}):Ze(d.from,"dd.MM.yyyy",{locale:sn}):s.jsx("span",{children:"Start- und Enddatum auswählen"})]})}),s.jsx(aa,{className:"w-auto p-0",align:"start",children:s.jsx(ia,{initialFocus:!0,mode:"range",defaultMonth:d==null?void 0:d.from,selected:d,onSelect:u,numberOfMonths:2,locale:sn,className:"pointer-events-auto"})})]})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Team auswählen"}),s.jsx("div",{className:"mt-2 space-y-2 max-h-48 overflow-y-auto border rounded-md p-3",children:f.map(b=>s.jsxs("div",{className:"flex items-center justify-between space-x-2 p-2 rounded-lg hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(za,{id:`team-${b.id}`,checked:o.team.includes(b.name||`${b.first_name||""} ${b.last_name||""}`.trim()),onCheckedChange:w=>_(b.name||`${b.first_name||""} ${b.last_name||""}`.trim(),w)}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:`team-${b.id}`,className:"text-sm font-medium cursor-pointer",children:b.name||`${b.first_name||""} ${b.last_name||""}`.trim()||"Unbekannt"}),s.jsx("p",{className:"text-xs text-gray-500",children:b.role||b.position||"Mitarbeiter"})]})]}),p(b.availability)]},b.id))})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"status",children:"Status"}),s.jsxs(mt,{value:o.status,onValueChange:b=>j("status",b),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"anfrage",children:"Anfrage"}),s.jsx(ye,{value:"besichtigung",children:"Besichtigung"}),s.jsx(ye,{value:"geplant",children:"Planung"}),s.jsx(ye,{value:"in_bearbeitung",children:"In Bearbeitung"}),s.jsx(ye,{value:"abgeschlossen",children:"Abgeschlossen"})]})]})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(ee,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),s.jsx(ee,{type:"submit",className:"flex-1",children:"Projekt erstellen"})]})]})]})})},Iee=({isOpen:t,onClose:e,project:n,onProjectUpdated:r,onProjectDeleted:a})=>{const{toast:i}=Mt(),[o,c]=g.useState([]),[d,u]=g.useState(),[m,f]=g.useState(!1),[p,x]=g.useState(0),[j,v]=g.useState(null),[_,b]=g.useState({name:(n==null?void 0:n.name)||"",customer:(n==null?void 0:n.customer)||"",status:(n==null?void 0:n.status)||"Planung",progress:(n==null?void 0:n.progress)||0,startDate:(n==null?void 0:n.startDate)||"",endDate:(n==null?void 0:n.endDate)||"",budget:(n==null?void 0:n.budget)||"",location:(n==null?void 0:n.location)||""});g.useEffect(()=>{t&&(async()=>{const{data:M}=await Z.from("customers").select("*").eq("status","Aktiv").order("company_name");M&&c(M)})()},[t]),g.useEffect(()=>{if(n){if(b({name:n.name,customer:n.customer,status:n.status,progress:n.progress,startDate:n.startDate,endDate:n.endDate,budget:n.budget,location:n.location}),n.startDate&&n.endDate){const P=new Date(n.startDate),M=new Date(n.endDate);!isNaN(P.getTime())&&!isNaN(M.getTime())&&u({from:P,to:M})}else if(n.startDate){const P=new Date(n.startDate);isNaN(P.getTime())||u({from:P,to:void 0})}}},[n]),g.useEffect(()=>{d!=null&&d.from&&N("startDate",Ze(d.from,"yyyy-MM-dd")),d!=null&&d.to&&N("endDate",Ze(d.to,"yyyy-MM-dd"))},[d]),g.useEffect(()=>(t||C(),()=>{j&&clearInterval(j)}),[t,j]);const w=P=>{if(P.preventDefault(),!n)return;const M={...n,..._};r(M),e()},N=(P,M)=>{b(z=>({...z,[P]:M}))},S=()=>{console.log("🚀 startDelete called - beginning delete sequence"),f(!0),x(0);const P=setInterval(()=>{x(M=>{const z=M+4;return console.log("⏰ Delete progress:",Math.round(z)+"%"),z>=100?(clearInterval(P),console.log("✅ Delete timer completed, calling handleDelete"),A(),100):z})},100);v(P)},C=()=>{console.log("⏹️ stopDelete called - canceling delete sequence"),j&&(clearInterval(j),v(null)),f(!1),x(0)},A=async()=>{if(!n||!a){console.log("❌ handleDelete aborted - missing project or callback");return}console.log("🗑️ Starting deletion of project:",n.id,n.name);try{const{data:P,error:M}=await Z.from("projects").select("id, name").eq("id",n.id).single();if(console.log("🔍 Project check before delete:",{checkData:P,checkError:M}),M)throw console.error("❌ Cannot access project for deletion:",M),new Error("Projekt nicht gefunden oder keine Berechtigung");const{data:z,error:R,count:D}=await Z.from("projects").delete().eq("id",n.id).select("*");if(console.log("🗑️ Delete result:",{data:z,error:R,count:D,deletedRows:(z==null?void 0:z.length)||0}),R)throw console.error("❌ Database delete error:",R),console.error("❌ Error details:",{message:R.message,code:R.code,details:R.details,hint:R.hint}),R;if(!z||z.length===0)throw console.warn("⚠️ No rows were deleted - project may not exist or access denied"),new Error("Projekt konnte nicht gelöscht werden - möglicherweise keine Berechtigung");console.log("✅ Project successfully deleted from database:",z[0]),i({title:"Projekt gelöscht",description:"Das Projekt wurde erfolgreich gelöscht."}),a(n.id),e(),console.log("✅ Delete operation completed")}catch(P){console.error("💥 Error deleting project:",P),i({title:"Fehler",description:"Projekt konnte nicht gelöscht werden: "+(P.message||"Unbekannter Fehler"),variant:"destructive"})}finally{C()}};return n?(console.log("🎯 EditProjectDialog render - onProjectDeleted available:",!!a),s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Projekt bearbeiten"}),s.jsx($n,{children:"Bearbeiten Sie die Informationen für das Projekt."})]}),s.jsxs("form",{onSubmit:w,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"name",children:"Projektname"}),s.jsx(ae,{id:"name",value:_.name,onChange:P=>N("name",P.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"customer",children:"Kunde"}),s.jsxs(mt,{value:_.customer,onValueChange:P=>N("customer",P),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Kunde auswählen"})}),s.jsx(ft,{children:o.map(P=>s.jsx(ye,{value:P.company_name,children:P.company_name},P.id))})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"location",children:"Standort"}),s.jsx(ae,{id:"location",value:_.location,onChange:P=>N("location",P.target.value)})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"budget",children:"Budget"}),s.jsx(ae,{id:"budget",value:_.budget,onChange:P=>N("budget",P.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Projektzeitraum"}),s.jsxs($a,{children:[s.jsx(Ua,{asChild:!0,children:s.jsxs(ee,{variant:"outline",className:Te("w-full justify-start text-left font-normal",!d&&"text-muted-foreground"),children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),d!=null&&d.from?d.to?s.jsxs(s.Fragment,{children:[Ze(d.from,"dd.MM.yyyy")," -"," ",Ze(d.to,"dd.MM.yyyy")]}):Ze(d.from,"dd.MM.yyyy"):s.jsx("span",{children:"Zeitraum auswählen"})]})}),s.jsx(aa,{className:"w-auto p-0",align:"start",children:s.jsx(ia,{initialFocus:!0,mode:"range",defaultMonth:d==null?void 0:d.from,selected:d,onSelect:u,numberOfMonths:2,className:Te("p-3 pointer-events-auto")})})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"status",children:"Status"}),s.jsxs(mt,{value:_.status,onValueChange:P=>N("status",P),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Anfrage",children:"Anfrage"}),s.jsx(ye,{value:"Besichtigung",children:"Besichtigung"}),s.jsx(ye,{value:"Planung",children:"Planung"}),s.jsx(ye,{value:"In Bearbeitung",children:"In Bearbeitung"}),s.jsx(ye,{value:"Abgeschlossen",children:"Abgeschlossen"})]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"progress",children:"Fortschritt (%)"}),s.jsx(ae,{id:"progress",type:"number",min:"0",max:"100",value:_.progress,onChange:P=>N("progress",parseInt(P.target.value))})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx("div",{className:"relative",children:s.jsxs(ee,{type:"button",variant:"destructive",className:"w-full relative overflow-hidden",onClick:()=>console.log("🖱️ Delete button clicked!"),onMouseDown:a?S:void 0,onMouseUp:a?C:void 0,onMouseLeave:a?C:void 0,onTouchStart:a?S:void 0,onTouchEnd:a?C:void 0,disabled:!a,children:[m&&s.jsx("div",{className:"absolute inset-0 bg-white/30 transition-all duration-100 ease-linear",style:{width:`${p}%`,left:0}}),s.jsx(Fa,{className:"h-4 w-4 mr-2 relative z-10"}),s.jsx("span",{className:"relative z-10",children:m?"Löschen...":"Projekt löschen"})]})})}),s.jsx(ee,{type:"button",variant:"outline",onClick:e,children:"Abbrechen"}),s.jsx(ee,{type:"submit",children:"Speichern"})]})]})]})})):null},Oee=({isOpen:t,onClose:e,project:n})=>{const[r,a]=g.useState([]),[i,o]=g.useState(!1),[c,d]=g.useState(""),[u,m]=g.useState(""),[f,p]=g.useState(""),[x,j]=g.useState(""),[v,_]=g.useState("geplant");g.useEffect(()=>{t&&n&&b(n.id)},[t,n]);const b=async N=>{o(!0),a([]),o(!1)},w=async N=>{N.preventDefault(),n&&c.trim()&&(console.log("Add task functionality not yet implemented"),d(""),m(""),p(""),j(""),_("geplant"),b(n.id))};return n?s.jsx(Kt,{open:t,onOpenChange:N=>!N&&e(),children:s.jsx(Wt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:s.jsxs(Is,{defaultValue:"overview",className:"w-full",children:[s.jsxs(Jt,{className:"pb-2",children:[s.jsxs(en,{children:[n.name," – Details"]}),s.jsxs(js,{children:[s.jsx(Je,{value:"overview",children:"Übersicht"}),s.jsx(Je,{value:"tasks",children:"Teilaufgaben"})]})]}),s.jsx(et,{value:"overview",className:"mt-0",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Kunde"})}),s.jsx(ce,{children:n.customer})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Status"})}),s.jsx(ce,{children:n.status})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Budget"})}),s.jsx(ce,{children:n.budget||"n/a"})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Standort"})}),s.jsx(ce,{children:n.location||"n/a"})]})]})}),s.jsx(et,{value:"tasks",className:"mt-0",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Aufgabenplan"}),i?s.jsx("p",{children:"Aufgaben werden geladen…"}):r.length===0?s.jsx("p",{children:"Keine Teilaufgaben vorhanden."}):s.jsx("ul",{className:"space-y-2",children:r.map(N=>s.jsxs("li",{className:"border rounded-md p-2",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-medium",children:N.name}),s.jsx("span",{className:"text-xs text-gray-500",children:N.status})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N.description||"–"}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[N.start_date&&`Start: ${N.start_date}`," ",N.end_date&&`· Ende: ${N.end_date}`]})]},N.id))}),s.jsxs("form",{onSubmit:w,className:"mt-6 space-y-2",children:[s.jsx("h4",{className:"font-semibold",children:"Neue Aufgabe"}),s.jsx("input",{type:"text",className:"border rounded-md p-2 w-full",placeholder:"Name der Aufgabe",value:c,onChange:N=>d(N.target.value),required:!0}),s.jsx("textarea",{className:"border rounded-md p-2 w-full",placeholder:"Beschreibung",value:u,onChange:N=>m(N.target.value),rows:3}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"date",className:"border rounded-md p-2 flex-1",value:f,onChange:N=>p(N.target.value)}),s.jsx("input",{type:"date",className:"border rounded-md p-2 flex-1",value:x,onChange:N=>j(N.target.value)})]}),s.jsxs("select",{className:"border rounded-md p-2 w-full",value:v,onChange:N=>_(N.target.value),children:[s.jsx("option",{value:"geplant",children:"Geplant"}),s.jsx("option",{value:"in_bearbeitung",children:"In Bearbeitung"}),s.jsx("option",{value:"abgeschlossen",children:"Abgeschlossen"})]}),s.jsx(ee,{type:"submit",className:"w-full",children:"Aufgabe hinzufügen"})]})]})})]})})}):null},Lee=({isOpen:t,onClose:e,projectId:n,onTimeEntryAdded:r})=>{const{toast:a}=Mt(),[i,o]=g.useState({work_date:new Date().toISOString().split("T")[0],start_time:"08:00",end_time:"17:00",task_description:"",category:"ausfuehrung"}),[c,d]=g.useState(new Date),[u,m]=g.useState(!1),[f,p]=g.useState(!1),x=async b=>{if(b.preventDefault(),!i.task_description.trim()){a({title:"Fehler",description:"Bitte geben Sie eine Tätigkeitsbeschreibung ein.",variant:"destructive"});return}if(i.start_time>=i.end_time){a({title:"Fehler",description:"Die Endzeit muss nach der Startzeit liegen.",variant:"destructive"});return}p(!0);try{const w=new Date(`${i.work_date}T${i.start_time}`),S=(new Date(`${i.work_date}T${i.end_time}`).getTime()-w.getTime())/(1e3*60*60),C={...i,work_date:Ze(c,"yyyy-MM-dd")};r(C),a({title:"Erfolg",description:`Arbeitszeit von ${S.toFixed(1)} Stunden erfasst.`}),o({work_date:new Date().toISOString().split("T")[0],start_time:"08:00",end_time:"17:00",task_description:"",category:"ausfuehrung"}),d(new Date),m(!1),e()}catch{a({title:"Fehler",description:"Arbeitszeit konnte nicht erfasst werden.",variant:"destructive"})}finally{p(!1)}},j=(b,w)=>{o(N=>({...N,[b]:w}))},_=(()=>{if(!i.start_time||!i.end_time)return 0;const b=new Date(`${i.work_date}T${i.start_time}`),w=new Date(`${i.work_date}T${i.end_time}`);return w<=b?0:(w.getTime()-b.getTime())/(1e3*60*60)})();return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsxs(Jt,{children:[s.jsxs(en,{className:"flex items-center gap-2",children:[s.jsx(an,{className:"h-5 w-5"}),"Arbeitszeit erfassen"]}),s.jsx($n,{children:"Erfassen Sie Ihre Arbeitszeiten für dieses Projekt."})]}),s.jsxs("form",{onSubmit:x,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"work_date",children:"Arbeitsdatum *"}),s.jsxs($a,{children:[s.jsx(Ua,{asChild:!0,children:s.jsxs(ee,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),Ze(c,"dd.MM.yyyy",{locale:sn})]})}),s.jsx(aa,{className:"w-auto p-0",align:"start",children:s.jsx(ia,{mode:"single",selected:c,onSelect:b=>{b&&(d(b),j("work_date",Ze(b,"yyyy-MM-dd")))},initialFocus:!0,locale:sn})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"start_time",children:"Von *"}),s.jsx(ae,{id:"start_time",type:"time",value:i.start_time,onChange:b=>j("start_time",b.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"end_time",children:"Bis *"}),s.jsx(ae,{id:"end_time",type:"time",value:i.end_time,onChange:b=>j("end_time",b.target.value),required:!0})]})]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Gesamtstunden:"}),s.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[_.toFixed(1),"h"]})]}),_>8&&s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx(za,{id:"overtime",checked:u,onCheckedChange:b=>m(b)}),s.jsxs("label",{htmlFor:"overtime",className:"text-sm text-orange-600 cursor-pointer",children:["Überstunden (",(_-8).toFixed(1),"h)"]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"category",children:"Kategorie *"}),s.jsxs(mt,{value:i.category,onValueChange:b=>j("category",b),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"planung",children:"Planung"}),s.jsx(ye,{value:"ausfuehrung",children:"Ausführung"}),s.jsx(ye,{value:"nacharbeit",children:"Nacharbeit"}),s.jsx(ye,{value:"dokumentation",children:"Dokumentation"}),s.jsx(ye,{value:"sonstiges",children:"Sonstiges"})]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"task_description",children:"Tätigkeitsbeschreibung *"}),s.jsx(cn,{id:"task_description",placeholder:"Beschreiben Sie Ihre durchgeführten Arbeiten...",value:i.task_description,onChange:b=>j("task_description",b.target.value),rows:3,required:!0})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(ee,{type:"button",variant:"outline",onClick:e,className:"flex-1",disabled:f,children:"Abbrechen"}),s.jsx(ee,{type:"submit",className:"flex-1",disabled:f||_===0,children:f?"Speichern...":"Zeit erfassen"})]})]})]})})},Fee=({isOpen:t,onClose:e,projectId:n,onMaterialEntryAdded:r})=>{const{toast:a}=Mt(),[i,o]=g.useState({entry_date:new Date().toISOString().split("T")[0],material_name:"",quantity:1,unit:"Stück",unit_cost:0,category:"baumaterial",supplier:""}),[c,d]=g.useState(new Date),[u,m]=g.useState(!1),f=async _=>{if(_.preventDefault(),!i.material_name.trim()){a({title:"Fehler",description:"Bitte geben Sie einen Materialnamen ein.",variant:"destructive"});return}if(i.quantity<=0){a({title:"Fehler",description:"Die Menge muss größer als 0 sein.",variant:"destructive"});return}if(i.unit_cost<0){a({title:"Fehler",description:"Der Stückpreis kann nicht negativ sein.",variant:"destructive"});return}m(!0);try{const b={...i,entry_date:Ze(c,"yyyy-MM-dd")};r(b);const w=i.quantity*i.unit_cost;a({title:"Erfolg",description:`Material im Wert von ${w.toFixed(2)}€ erfasst.`}),o({entry_date:new Date().toISOString().split("T")[0],material_name:"",quantity:1,unit:"Stück",unit_cost:0,category:"baumaterial",supplier:""}),d(new Date),e()}catch{a({title:"Fehler",description:"Material konnte nicht erfasst werden.",variant:"destructive"})}finally{m(!1)}},p=(_,b)=>{o(w=>({...w,[_]:b}))},j=i.quantity*i.unit_cost,v=["Stück","kg","g","Liter","ml","m","cm","mm","m²","cm²","Paket","Karton","Rolle","Meter","qm","Sack","Palette"];return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsxs(Jt,{children:[s.jsxs(en,{className:"flex items-center gap-2",children:[s.jsx(qa,{className:"h-5 w-5"}),"Material erfassen"]}),s.jsx($n,{children:"Erfassen Sie verwendete Materialien für dieses Projekt."})]}),s.jsxs("form",{onSubmit:f,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"entry_date",children:"Datum *"}),s.jsxs($a,{children:[s.jsx(Ua,{asChild:!0,children:s.jsxs(ee,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),Ze(c,"dd.MM.yyyy",{locale:sn})]})}),s.jsx(aa,{className:"w-auto p-0",align:"start",children:s.jsx(ia,{mode:"single",selected:c,onSelect:_=>{_&&(d(_),p("entry_date",Ze(_,"yyyy-MM-dd")))},initialFocus:!0,locale:sn})})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"material_name",children:"Materialname *"}),s.jsx(ae,{id:"material_name",placeholder:"z.B. Zement, Kabel, Schrauben...",value:i.material_name,onChange:_=>p("material_name",_.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"category",children:"Kategorie *"}),s.jsxs(mt,{value:i.category,onValueChange:_=>p("category",_),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"baumaterial",children:"Baumaterial"}),s.jsx(ye,{value:"werkzeug",children:"Werkzeug"}),s.jsx(ye,{value:"verbrauchsmaterial",children:"Verbrauchsmaterial"}),s.jsx(ye,{value:"sonstiges",children:"Sonstiges"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"quantity",children:"Menge *"}),s.jsx(ae,{id:"quantity",type:"number",min:"0.01",step:"0.01",value:i.quantity,onChange:_=>p("quantity",parseFloat(_.target.value)||0),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"unit",children:"Einheit *"}),s.jsxs(mt,{value:i.unit,onValueChange:_=>p("unit",_),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsx(ft,{children:v.map(_=>s.jsx(ye,{value:_,children:_},_))})]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"unit_cost",children:"Stückpreis (€) *"}),s.jsx(ae,{id:"unit_cost",type:"number",min:"0",step:"0.01",placeholder:"0.00",value:i.unit_cost,onChange:_=>p("unit_cost",parseFloat(_.target.value)||0),required:!0})]}),s.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Jr,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Gesamtkosten:"})]}),s.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[j.toFixed(2),"€"]})]}),s.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[i.quantity," ",i.unit," × ",i.unit_cost.toFixed(2),"€"]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"supplier",children:"Lieferant"}),s.jsx(ae,{id:"supplier",placeholder:"z.B. Baumarkt, Großhandel...",value:i.supplier,onChange:_=>p("supplier",_.target.value)})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(ee,{type:"button",variant:"outline",onClick:e,className:"flex-1",disabled:u,children:"Abbrechen"}),s.jsx(ee,{type:"submit",className:"flex-1",disabled:u||!i.material_name.trim()||i.quantity<=0,children:u?"Speichern...":"Material erfassen"})]})]})]})})},Bee=({isOpen:t,onClose:e,projectId:n})=>{const{toast:r}=Mt(),[a,i]=g.useState(null),[o,c]=g.useState(!0),[d,u]=g.useState("mitarbeiter"),[m,f]=g.useState({can_view:!1,can_edit_basic_data:!1,can_add_time:!1,can_add_materials:!1,can_upload_files:!1,can_change_status:!1,can_link_invoices:!1,can_delete:!1,can_manage_team:!1}),[p,x]=g.useState("overview"),[j,v]=g.useState(!1),[_,b]=g.useState(!1),[w,N]=g.useState(!1),[S,C]=g.useState([]);g.useEffect(()=>{t&&n&&A()},[t,n]);const A=async()=>{c(!0);try{const{data:G}=await Z.auth.getUser();if(!(G!=null&&G.user)){r({title:"Fehler",description:"Benutzer nicht authentifiziert",variant:"destructive"});return}const{data:I}=await Z.from("profiles").select("company_id").eq("id",G.user.id).single();if(!(I!=null&&I.company_id)){r({title:"Fehler",description:"Benutzer-Unternehmen nicht gefunden",variant:"destructive"});return}const{data:V,error:$}=await Z.from("projects").select("*").eq("id",n).eq("company_id",I.company_id).single();if($||!V){r({title:"Fehler",description:"Projekt nicht gefunden",variant:"destructive"});return}let F=null;if(V.customer_id){const{data:He}=await Z.from("customers").select("*").eq("id",V.customer_id).single();F=He}const{data:O,error:K}=await Z.from("time_entries").select("hours_worked").eq("project_id",n);K&&console.log("Time entries table might not exist yet:",K.message);const U=(O==null?void 0:O.reduce((He,Le)=>He+(Le.hours_worked||0),0))||0,{data:te,error:J}=await Z.from("material_entries").select("total_cost").eq("project_id",n);J&&console.log("Material entries table might not exist yet:",J.message);const q=(te==null?void 0:te.reduce((He,Le)=>He+(Le.total_cost||0),0))||0,{data:ne,error:pe}=await Z.from("project_team_members").select("employee_id, employees!inner(first_name, last_name, email)").eq("project_id",n);pe&&console.log("Project team members table might not exist yet:",pe.message);const{data:Q,error:re}=await Z.from("project_comments").select("id").eq("project_id",n);re&&console.log("Project comments table might not exist yet:",re.message);const{data:me,error:he}=await Z.from("project_documents").select("id").eq("project_id",n);he&&console.log("Project documents table might not exist yet:",he.message);const ge=V.budget||0,se=q+U*50,we=ge>0?Math.round(se/ge*100):0,Se=new Date(V.start_date||new Date),qe=new Date(V.end_date||new Date),Ye=new Date,Et=Math.max(0,Math.floor((Ye.getTime()-Se.getTime())/(1e3*60*60*24))),be=Math.max(0,Math.floor((qe.getTime()-Ye.getTime())/(1e3*60*60*24))),Oe={id:V.id,company_id:V.company_id,project_name:V.name,customer_id:V.customer_id||"",start_date:V.start_date||new Date().toISOString().split("T")[0],planned_end_date:V.end_date||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],status:V.status??"geplant",project_address:V.address||V.location||V.project_address||(F==null?void 0:F.address)||"Nicht angegeben",project_description:V.description||"Keine Beschreibung",linked_invoices:[],linked_offers:[],created_at:V.created_at||new Date().toISOString(),updated_at:V.updated_at||new Date().toISOString(),created_by:G.user.id,assigned_team:(ne==null?void 0:ne.map(He=>He.employee_id))||[],customer:F?{company_name:F.company_name,contact_person:F.contact_person,email:F.email,phone:F.phone}:{company_name:"Unbekannter Kunde",contact_person:"Nicht verfügbar",email:"nicht-verfuegbar@example.com",phone:void 0},stats:{total_hours_logged:U>0?U:45.5,total_material_cost:q>0?q:2850,total_project_cost:ge||se||12750,budget_utilization:we>0?we:68,days_active:Et,days_remaining:be,team_size:(ne==null?void 0:ne.length)||3,documents_count:(me==null?void 0:me.length)||8,comments_count:(Q==null?void 0:Q.length)||12,last_activity:new Date().toISOString()},recent_activities:[],team_members:(ne==null?void 0:ne.length)>0?ne.map(He=>({id:He.employee_id,name:`${He.employees.first_name} ${He.employees.last_name}`.trim(),role:"team_member",email:He.employees.email,hours_this_week:0})):[{id:"demo_1",name:"Max Mustermann",role:"projektleiter",email:"max@example.com",hours_this_week:32.5},{id:"demo_2",name:"Anna Schmidt",role:"admin",email:"anna@example.com",hours_this_week:28}],permissions:ak("admin",!0)},Fe="admin";u(Fe),f(ak(Fe,!0));const lt=[];if(Q&&Q.length>0){const{data:He}=await Z.from("project_comments").select("id, content, created_at, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(5);He&&He.forEach(Le=>{lt.push({id:`comment_${Le.id}`,project_id:n,event_type:"comment",title:"Neuer Kommentar hinzugefügt",description:Le.content.substring(0,100)+(Le.content.length>100?"...":""),user_name:`${Le.profiles.first_name} ${Le.profiles.last_name}`,user_role:"team_member",timestamp:Le.created_at})})}if(O&&O.length>0){const{data:He}=await Z.from("time_entries").select("id, hours_worked, work_date, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(3);He&&He.forEach(Le=>{lt.push({id:`time_${Le.id}`,project_id:n,event_type:"time",title:"Arbeitszeit erfasst",description:`${Le.hours_worked}h am ${new Date(Le.work_date).toLocaleDateString("de-DE")}`,user_name:`${Le.profiles.first_name} ${Le.profiles.last_name}`,user_role:"team_member",timestamp:Le.work_date})})}if(te&&te.length>0){const{data:He}=await Z.from("material_entries").select("id, material_name, quantity, total_cost, created_at, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(3);He&&He.forEach(Le=>{lt.push({id:`material_${Le.id}`,project_id:n,event_type:"material",title:"Material hinzugefügt",description:`${Le.material_name} (${Le.quantity}x) - ${Le.total_cost}€`,user_name:`${Le.profiles.first_name} ${Le.profiles.last_name}`,user_role:"team_member",timestamp:Le.created_at})})}lt.sort((He,Le)=>new Date(Le.timestamp).getTime()-new Date(He.timestamp).getTime()),Oe.recent_activities=lt.length>0?lt.slice(0,10):[{id:"demo_activity_1",project_id:n,event_type:"comment",title:"Neuer Kommentar hinzugefügt",description:"Materiallieferung für Freitag geplant",user_name:"Max Mustermann",user_role:"projektleiter",timestamp:new Date(Date.now()-2*60*60*1e3).toISOString()},{id:"demo_activity_2",project_id:n,event_type:"document",title:"Dokument hochgeladen",description:"Bauplan_Final.pdf",user_name:"Anna Schmidt",user_role:"admin",timestamp:new Date(Date.now()-6*60*60*1e3).toISOString()}],i(Oe)}catch(G){console.error("Error fetching project data:",G),r({title:"Fehler",description:"Projektdaten konnten nicht geladen werden",variant:"destructive"})}finally{c(!1)}},P=async()=>{var G;try{const{data:I}=await Z.auth.getUser();if(!(I!=null&&I.user))return;const{data:V}=await Z.from("profiles").select("company_id").eq("id",I.user.id).single();if(!(V!=null&&V.company_id))return;const{data:$}=await Z.from("employees").select("id, first_name, last_name, email, position, status").eq("company_id",V.company_id).eq("status","active"),F=((G=a==null?void 0:a.team_members)==null?void 0:G.map(U=>U.id))||[];let O=[];const K=new Date().toISOString().split("T")[0];for(const U of $||[]){if(F.includes(U.id))continue;const{data:te}=await Z.from("vacation_requests").select("*").eq("employee_id",U.id).in("status",["approved","pending"]).lte("start_date",K).gte("end_date",K);if(te&&te.length>0){O.push({...U,availability_status:"unavailable",reason:te[0].request_type==="vacation"?"Im Urlaub":"Krankgemeldet"});continue}const{data:J}=await Z.from("project_team_members").select("project_id, projects!inner(start_date, end_date, name, status)").eq("employee_id",U.id).neq("project_id",n).in("projects.status",["in_bearbeitung","geplant"]);(J==null?void 0:J.some(ne=>{const pe=ne.projects.start_date,Q=ne.projects.end_date,re=a==null?void 0:a.start_date,me=a==null?void 0:a.end_date;return!pe||!Q||!re||!me?!1:pe<=me&&Q>=re}))?O.push({...U,availability_status:"busy",reason:`In ${J==null?void 0:J.length} anderen Projekten`}):O.push({...U,availability_status:"available",reason:"Verfügbar"})}C(O)}catch(I){console.error("Error loading available employees:",I)}},M=async G=>{try{const I=S.find(F=>F.id===G);if(!I)return;const V={id:G,name:`${I.first_name} ${I.last_name}`.trim(),role:I.position||"team_member",email:I.email,hours_this_week:0};i(F=>F?{...F,team_members:[...F.team_members||[],V]}:null),C(F=>F.filter(O=>O.id!==G)),N(!1);const{error:$}=await Z.from("project_team_members").insert({project_id:n,employee_id:G,assigned_at:new Date().toISOString()});if($){console.error("Error adding team member:",$),i(F=>F?{...F,team_members:F.team_members.filter(O=>O.id!==G)}:null),C(F=>[...F,I]),r({title:"Fehler",description:"Team-Mitglied konnte nicht hinzugefügt werden",variant:"destructive"});return}r({title:"Erfolg",description:"Team-Mitglied wurde erfolgreich hinzugefügt"})}catch(I){console.error("Error adding team member:",I),r({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}},z=async G=>{try{const I=a==null?void 0:a.team_members.find($=>$.id===G);if(!I)return;i($=>$?{...$,team_members:$.team_members.filter(F=>F.id!==G)}:null);const{error:V}=await Z.from("project_team_members").delete().eq("project_id",n).eq("employee_id",G);if(V){console.error("Error removing team member:",V),i($=>$?{...$,team_members:[...$.team_members,I]}:null),r({title:"Fehler",description:"Team-Mitglied konnte nicht entfernt werden",variant:"destructive"});return}r({title:"Erfolg",description:"Team-Mitglied wurde erfolgreich entfernt"})}catch(I){console.error("Error removing team member:",I),r({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}},R=async G=>{if(!(!a||!m.can_change_status))try{const{error:I}=await Z.from("projects").update({status:G}).eq("id",a.id);if(I)throw I;i(V=>V?{...V,status:G}:null),r({title:"Erfolg",description:"Projektstatus wurde aktualisiert"})}catch{r({title:"Fehler",description:"Status konnte nicht geändert werden",variant:"destructive"})}},D=G=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(G),B=G=>new Date(G).toLocaleDateString("de-DE"),W=G=>new Date(G).toLocaleString("de-DE"),X=G=>ik[G]||ik.geplant,ue=G=>`P${G.split("-").join("").substring(0,6).toUpperCase()}`;if(o)return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsx(Wt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Projektdaten werden geladen..."})]})})})});if(!a)return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsx(Wt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(us,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Projekt nicht gefunden"}),s.jsx("p",{className:"text-gray-600",children:"Das angeforderte Projekt konnte nicht geladen werden."}),s.jsx(ee,{onClick:e,className:"mt-4",children:"Schließen"})]})})});const de=X(a.status);return console.log("Project status:",a.status,"Status config:",de),s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:[s.jsxs(Is,{value:p,onValueChange:x,className:"w-full",children:[s.jsxs(Jt,{className:"pb-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsxs(en,{className:"text-2xl flex items-center gap-2",children:[s.jsx(la,{className:"h-6 w-6"}),a.project_name]}),s.jsxs($n,{className:"flex items-center gap-4 mt-1",children:[s.jsxs(Qe,{className:`${de.bgColor} ${de.color} text-sm`,children:[de.icon," ",de.label]}),s.jsxs("span",{className:"text-gray-500",children:["ID: ",ue(a.id)]})]})]}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Budget / Genutzt"}),s.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[D(a.budget||0)," / ",D(a.stats.total_project_cost||0)]})]})})]}),s.jsxs(js,{className:"grid w-full grid-cols-5 mb-4",children:[s.jsx(Je,{value:"overview",children:"Übersicht"}),s.jsx(Je,{value:"time",children:"Zeiten"}),s.jsx(Je,{value:"materials",children:"Material"}),s.jsx(Je,{value:"documents",children:"Dokumente"}),s.jsx(Je,{value:"comments",children:"Kommentare"})]})]}),s.jsxs(et,{value:"overview",className:"space-y-4 min-h-[600px] mt-0",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Gesamtstunden"}),s.jsxs("p",{className:"text-2xl font-bold",children:[a.stats.total_hours_logged,"h"]})]}),s.jsx(an,{className:"h-8 w-8 text-blue-500"})]})})}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Materialkosten"}),s.jsx("p",{className:"text-2xl font-bold",children:D(a.stats.total_material_cost)})]}),s.jsx(Gb,{className:"h-8 w-8 text-green-500"})]})})}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Budget-Nutzung"}),s.jsxs("p",{className:"text-2xl font-bold",children:[a.stats.budget_utilization,"%"]})]}),s.jsx(us,{className:`h-8 w-8 ${a.stats.budget_utilization>80?"text-red-500":"text-yellow-500"}`})]})})}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Team-Größe"}),s.jsx("p",{className:"text-2xl font-bold",children:a.stats.team_size})]}),s.jsx(bi,{className:"h-8 w-8 text-purple-500"})]})})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Projektdetails"})}),s.jsxs(ce,{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Start:"})," ",B(a.start_date)]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Ende:"})," ",B(a.planned_end_date)]})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Standort"}),s.jsxs("p",{className:"font-medium flex items-center gap-2",children:[s.jsx(Ci,{className:"h-4 w-4"}),a.project_address]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Verbleibende Tage"}),s.jsxs("p",{className:"font-medium",children:[a.stats.days_remaining," Tage"]})]})]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Kundeninformationen"})}),s.jsxs(ce,{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Unternehmen"}),s.jsx("p",{className:"font-medium",children:a.customer.company_name})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Ansprechpartner"}),s.jsx("p",{className:"font-medium",children:a.customer.contact_person})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(es,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:a.customer.email})]}),a.customer.phone&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Fd,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:a.customer.phone})]})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center justify-between",children:["Team-Mitglieder",m.can_manage_team&&s.jsxs(ee,{size:"sm",variant:"outline",onClick:()=>{P(),N(!0)},children:[s.jsx(rn,{className:"h-4 w-4 mr-1"}),"Hinzufügen"]})]})}),s.jsx(ce,{className:"space-y-3",children:a.team_members.map(G=>s.jsx(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{children:s.jsx("p",{className:"font-medium",children:G.name})}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-sm font-medium",children:[G.hours_this_week,"h"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"diese Woche"})]}),m.can_manage_team&&s.jsx(ee,{size:"sm",variant:"ghost",onClick:()=>z(G.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:s.jsx(Ln,{className:"h-4 w-4"})})]})]})})},G.id))})]}),m.can_change_status&&s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Status ändern"})}),s.jsxs(ce,{className:"space-y-2",children:[de.previousStates&&de.previousStates.length>0&&s.jsxs(s.Fragment,{children:[de.previousStates.map(G=>{const I=X(G);return s.jsxs(ee,{variant:"outline",size:"sm",className:"w-full justify-start text-gray-600",onClick:()=>R(G),children:[s.jsx("span",{className:"mr-2",children:"←"})," Zurück zu ",I.label]},G)}),de.nextStates.length>0&&s.jsx("div",{className:"border-t my-2"})]}),de.nextStates.map(G=>{const I=X(G);return s.jsxs(ee,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>R(G),children:[I.icon," ",I.label]},G)})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Letzte Aktivitäten"})}),s.jsx(ce,{className:"space-y-3",children:a.recent_activities.map(G=>s.jsxs("div",{className:"border-l-2 border-blue-200 pl-3",children:[s.jsx("p",{className:"text-sm font-medium",children:G.title}),s.jsx("p",{className:"text-xs text-gray-600",children:G.description}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:"text-xs text-gray-500",children:G.user_name}),s.jsx("span",{className:"text-xs text-gray-400",children:"•"}),s.jsx("span",{className:"text-xs text-gray-500",children:W(G.timestamp)})]})]},G.id))})]})]})]})]}),s.jsxs(et,{value:"time",className:"space-y-4 min-h-[600px] mt-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Zeiterfassung"}),m.can_add_time&&s.jsxs(ee,{onClick:()=>v(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Zeit erfassen"]})]}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsx("p",{className:"text-gray-500",children:"Zeiteinträge werden hier angezeigt..."})})})]}),s.jsxs(et,{value:"materials",className:"space-y-4 min-h-[600px] mt-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Materialverwaltung"}),m.can_add_materials&&s.jsxs(ee,{onClick:()=>b(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsx("p",{className:"text-gray-500",children:"Materialeinträge werden hier angezeigt..."})})})]}),s.jsxs(et,{value:"documents",className:"space-y-4 min-h-[600px] mt-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Dokumente"}),m.can_upload_files&&s.jsxs(ee,{children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Datei hochladen"]})]}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsx("p",{className:"text-gray-500",children:"Projektdokumente werden hier angezeigt..."})})})]}),s.jsxs(et,{value:"comments",className:"space-y-4 min-h-[600px] mt-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Kommentare & Notizen"}),s.jsxs(ee,{children:[s.jsx(aP,{className:"h-4 w-4 mr-2"}),"Kommentar hinzufügen"]})]}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsx("p",{className:"text-gray-500",children:"Projektkommentare werden hier angezeigt..."})})})]})]}),s.jsx(Lee,{isOpen:j,onClose:()=>v(!1),projectId:a.id,onTimeEntryAdded:G=>{console.log("Time entry added:",G),r({title:"Erfolg",description:"Arbeitszeit wurde erfasst"})}}),s.jsx(Fee,{isOpen:_,onClose:()=>b(!1),projectId:a.id,onMaterialEntryAdded:G=>{console.log("Material entry added:",G),r({title:"Erfolg",description:"Material wurde erfasst"})}}),w&&s.jsx(Kt,{open:w,onOpenChange:N,children:s.jsxs(Wt,{children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Team-Mitglied hinzufügen"}),s.jsx($n,{children:"Wählen Sie einen Mitarbeiter aus, der dem Projekt hinzugefügt werden soll."})]}),s.jsx("div",{className:"space-y-4",children:S.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"Keine verfügbaren Mitarbeiter gefunden oder alle sind bereits dem Projekt zugewiesen."}):s.jsx("div",{className:"space-y-2",children:S.map(G=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:`w-3 h-3 rounded-full ${G.availability_status==="available"?"bg-green-500":G.availability_status==="busy"?"bg-yellow-500":"bg-red-500"}`,title:G.reason})}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium",children:[G.first_name," ",G.last_name]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[G.position,s.jsxs("span",{className:`ml-2 text-xs ${G.availability_status==="available"?"text-green-600":G.availability_status==="busy"?"text-yellow-600":"text-red-600"}`,children:["• ",G.reason]})]})]})]}),s.jsx(ee,{size:"sm",onClick:()=>M(G.id),children:s.jsx(rn,{className:"h-4 w-4"})})]},G.id))})})]})})]})})},zee=({isOpen:t,onClose:e,projectId:n,projectName:r,customerId:a,onCalculationSaved:i})=>{const{toast:o}=Mt(),[c,d]=g.useState({projectId:n,projectName:r,customerId:a,materials:[],labor:[],subcontractors:[],travelCosts:0,travelDescription:"",safetyBuffer:10,profitMargin:20,materialCosts:0,laborCosts:0,subcontractorCosts:0,totalBaseCosts:0,totalCostsWithBuffer:0,finalPrice:0,notes:""});g.useEffect(()=>{t&&n&&u()},[t,n]);const u=async()=>{try{const{data:A}=await Z.from("projects").select("description").eq("id",n).single();if(A!=null&&A.description){const P=A.description.match(/\[PRECALC:(.*?)\]/);if(P)try{const M=JSON.parse(P[1]);console.log("📊 Loading existing calculation:",M),d(z=>({...z,...M,projectId:n,projectName:r,customerId:a})),o({title:"Bestehende Kalkulation geladen",description:"Die vorhandene Vor-Kalkulation wurde geladen."})}catch(M){console.warn("Error parsing existing calculation:",M)}}}catch(A){console.error("Error loading existing calculation:",A)}};g.useEffect(()=>{m()},[c.materials,c.labor,c.subcontractors,c.travelCosts,c.safetyBuffer,c.profitMargin]);const m=()=>{const A=c.materials.reduce((B,W)=>{const ue=W.quantity*W.pricePerUnit*(1+W.markup/100);return B+ue},0),P=c.labor.reduce((B,W)=>B+W.hours*W.workers*W.hourlyRate,0),M=c.subcontractors.reduce((B,W)=>B+W.cost,0),z=A+P+M+c.travelCosts,R=z*(1+c.safetyBuffer/100),D=R*(1+c.profitMargin/100);d(B=>({...B,materialCosts:A,laborCosts:P,subcontractorCosts:M,totalBaseCosts:z,totalCostsWithBuffer:R,finalPrice:D}))},f=()=>{const A={id:Date.now().toString(),name:"",quantity:1,unit:"Stück",pricePerUnit:0,markup:15,totalCost:0,isEstimate:!1};d(P=>({...P,materials:[...P.materials,A]}))},p=()=>{const A={id:Date.now().toString(),description:"",hours:8,workers:1,hourlyRate:45,totalCost:0,isEstimate:!1};d(P=>({...P,labor:[...P.labor,A]}))},x=()=>{const A={id:Date.now().toString(),description:"",supplier:"",cost:0};d(P=>({...P,subcontractors:[...P.subcontractors,A]}))},j=A=>{d(P=>({...P,materials:P.materials.filter(M=>M.id!==A)}))},v=A=>{d(P=>({...P,labor:P.labor.filter(M=>M.id!==A)}))},_=A=>{d(P=>({...P,subcontractors:P.subcontractors.filter(M=>M.id!==A)}))},b=(A,P,M)=>{d(z=>({...z,materials:z.materials.map(R=>R.id===A?{...R,[P]:M}:R)}))},w=(A,P,M)=>{d(z=>({...z,labor:z.labor.map(R=>R.id===A?{...R,[P]:M}:R)}))},N=(A,P,M)=>{d(z=>({...z,subcontractors:z.subcontractors.map(R=>R.id===A?{...R,[P]:M}:R)}))},S=async()=>{try{const A={...c,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if((c.isEstimate||c.materials.some(B=>B.isEstimate))&&!await _V({projectId:n,estimate:A,userId:void 0}))return;const P=`[PRECALC:${JSON.stringify(A)}]`,M={},{data:z}=await Z.from("projects").select("description, budget").eq("id",n).single();let R=P;z!=null&&z.description&&!z.description.includes("[PRECALC:")?R=`${z.description} ${P}`:z!=null&&z.description&&z.description.includes("[PRECALC:")&&(R=z.description.replace(/\[PRECALC:.*?\]/,P)),M.description=R,M.budget=Math.round(c.finalPrice),console.log("💰 Setting project budget to:",M.budget);const{error:D}=await Z.from("projects").update(M).eq("id",n);if(D)throw D;o({title:"Vor-Kalkulation gespeichert",description:`Budget wurde auf €${c.finalPrice.toFixed(2)} gesetzt`}),i==null||i(A),e()}catch(A){console.error("Error saving pre-calculation:",A),o({title:"Fehler",description:"Vor-Kalkulation konnte nicht gespeichert werden",variant:"destructive"})}},C=A=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(A);return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Jt,{children:[s.jsxs(en,{className:"flex items-center gap-2",children:[s.jsx(Jr,{className:"h-5 w-5"}),"Vor-Kalkulation: ",r]}),s.jsx($n,{children:"Detaillierte Kostenberechnung für das Projekt erstellen"})]}),s.jsxs(Is,{defaultValue:"materials",className:"w-full",children:[s.jsxs(js,{className:"grid w-full grid-cols-5",children:[s.jsx(Je,{value:"materials",children:"Material"}),s.jsx(Je,{value:"labor",children:"Arbeitszeit"}),s.jsx(Je,{value:"subcontractors",children:"Fremdleistungen"}),s.jsx(Je,{value:"costs",children:"Zusatzkosten"}),s.jsx(Je,{value:"summary",children:"Zusammenfassung"})]}),s.jsxs(et,{value:"materials",className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Materialkosten"}),s.jsxs(ee,{onClick:f,size:"sm",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),s.jsxs("div",{className:"space-y-4",children:[c.materials.map((A,P)=>s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"grid grid-cols-8 gap-4 items-center",children:[s.jsxs("div",{children:[s.jsx(Y,{children:"Material"}),s.jsx(ae,{value:A.name,onChange:M=>b(A.id,"name",M.target.value),placeholder:"z.B. Fliesen 30x30cm"})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Menge"}),s.jsx(ae,{type:"number",value:A.quantity,onChange:M=>b(A.id,"quantity",parseFloat(M.target.value)||0)})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Einheit"}),s.jsxs(mt,{value:A.unit,onValueChange:M=>b(A.id,"unit",M),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Stück",children:"Stück"}),s.jsx(ye,{value:"m²",children:"m²"}),s.jsx(ye,{value:"m",children:"m"}),s.jsx(ye,{value:"kg",children:"kg"}),s.jsx(ye,{value:"l",children:"l"}),s.jsx(ye,{value:"Paket",children:"Paket"})]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Preis/Einheit"}),s.jsx(ae,{type:"number",step:"0.01",value:A.pricePerUnit,onChange:M=>b(A.id,"pricePerUnit",parseFloat(M.target.value)||0)})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Aufschlag %"}),s.jsx(ae,{type:"number",value:A.markup,onChange:M=>b(A.id,"markup",parseFloat(M.target.value)||0)})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Gesamt"}),s.jsx("div",{className:"font-bold",children:C(A.quantity*A.pricePerUnit*(1+A.markup/100))})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Schätzung"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(za,{checked:A.isEstimate,onCheckedChange:M=>b(A.id,"isEstimate",M)}),s.jsx("span",{className:"text-sm text-gray-600",children:A.isEstimate?"Schätzung":"Bestätigt"})]})]}),s.jsx("div",{children:s.jsx(ee,{variant:"outline",size:"sm",onClick:()=>j(A.id),className:"text-red-600",children:s.jsx(Fa,{className:"h-4 w-4"})})})]})})},A.id)),c.materials.length===0&&s.jsx("div",{className:"text-center text-gray-500 py-8",children:'Noch keine Materialien hinzugefügt. Klicken Sie auf "Material hinzufügen" um zu beginnen.'})]}),s.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-semibold",children:"Gesamte Materialkosten:"}),s.jsx("span",{className:"text-xl font-bold text-blue-600",children:C(c.materialCosts)})]})})]}),s.jsxs(et,{value:"labor",className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Arbeitszeit & Lohnkosten"}),s.jsxs(ee,{onClick:p,size:"sm",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Arbeitsposition hinzufügen"]})]}),s.jsxs("div",{className:"space-y-4",children:[c.labor.map(A=>s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"grid grid-cols-7 gap-4 items-center",children:[s.jsxs("div",{className:"col-span-2",children:[s.jsx(Y,{children:"Arbeitsposition"}),s.jsx(ae,{value:A.description,onChange:P=>w(A.id,"description",P.target.value),placeholder:"z.B. Fliesen verlegen"})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Stunden"}),s.jsx(ae,{type:"number",step:"0.5",value:A.hours,onChange:P=>w(A.id,"hours",parseFloat(P.target.value)||0)})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Personen"}),s.jsx(ae,{type:"number",value:A.workers,onChange:P=>w(A.id,"workers",parseInt(P.target.value)||1)})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"€/Stunde"}),s.jsx(ae,{type:"number",step:"0.01",value:A.hourlyRate,onChange:P=>w(A.id,"hourlyRate",parseFloat(P.target.value)||0)})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Gesamt"}),s.jsx("div",{className:"font-bold",children:C(A.hours*A.workers*A.hourlyRate)})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Schätzung"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(za,{checked:A.isEstimate,onCheckedChange:P=>w(A.id,"isEstimate",P)}),s.jsx("span",{className:"text-sm text-gray-600",children:A.isEstimate?"Schätzung":"Bestätigt"})]}),s.jsx(ee,{variant:"outline",size:"sm",onClick:()=>v(A.id),className:"text-red-600 mt-2",children:s.jsx(Fa,{className:"h-4 w-4"})})]})]})})},A.id)),c.labor.length===0&&s.jsx("div",{className:"text-center text-gray-500 py-8",children:"Noch keine Arbeitspositionen hinzugefügt."})]}),s.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-semibold",children:"Gesamte Lohnkosten:"}),s.jsx("span",{className:"text-xl font-bold text-green-600",children:C(c.laborCosts)})]})})]}),s.jsxs(et,{value:"subcontractors",className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Fremdleistungen & Subunternehmer"}),s.jsxs(ee,{onClick:x,size:"sm",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Fremdleistung hinzufügen"]})]}),s.jsxs("div",{className:"space-y-4",children:[c.subcontractors.map(A=>s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[s.jsxs("div",{className:"col-span-2",children:[s.jsx(Y,{children:"Leistung"}),s.jsx(ae,{value:A.description,onChange:P=>N(A.id,"description",P.target.value),placeholder:"z.B. Elektroinstallation"})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Anbieter"}),s.jsx(ae,{value:A.supplier,onChange:P=>N(A.id,"supplier",P.target.value),placeholder:"Firma/Name"})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Kosten"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ae,{type:"number",step:"0.01",value:A.cost,onChange:P=>N(A.id,"cost",parseFloat(P.target.value)||0)}),s.jsx(ee,{variant:"outline",size:"sm",onClick:()=>_(A.id),className:"text-red-600",children:s.jsx(Fa,{className:"h-4 w-4"})})]})]})]})})},A.id)),c.subcontractors.length===0&&s.jsx("div",{className:"text-center text-gray-500 py-8",children:"Noch keine Fremdleistungen hinzugefügt."})]}),s.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-semibold",children:"Gesamte Fremdleistungen:"}),s.jsx("span",{className:"text-xl font-bold text-purple-600",children:C(c.subcontractorCosts)})]})})]}),s.jsxs(et,{value:"costs",className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Zusatzkosten & Zuschläge"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Fahrtkosten"})}),s.jsxs(ce,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{children:"Beschreibung"}),s.jsx(ae,{value:c.travelDescription,onChange:A=>d(P=>({...P,travelDescription:A.target.value})),placeholder:"z.B. 50km Anfahrt × 2 Fahrten"})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Kosten"}),s.jsx(ae,{type:"number",step:"0.01",value:c.travelCosts,onChange:A=>d(P=>({...P,travelCosts:parseFloat(A.target.value)||0}))})]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Zuschläge & Margen"})}),s.jsxs(ce,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{children:"Sicherheitszuschlag (%)"}),s.jsx(ae,{type:"number",value:c.safetyBuffer,onChange:A=>d(P=>({...P,safetyBuffer:parseFloat(A.target.value)||0}))}),s.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Üblich: 5-15% für unvorhergesehene Kosten"})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Gewinnmarge (%)"}),s.jsx(ae,{type:"number",value:c.profitMargin,onChange:A=>d(P=>({...P,profitMargin:parseFloat(A.target.value)||0}))}),s.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Üblich: 15-25% je nach Wettbewerb"})]})]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Notizen & Bemerkungen"})}),s.jsx(ce,{children:s.jsx(cn,{value:c.notes,onChange:A=>d(P=>({...P,notes:A.target.value})),placeholder:"Zusätzliche Hinweise zur Kalkulation...",rows:4})})]})]}),s.jsxs(et,{value:"summary",className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Kalkulationsergebnis"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Kostenaufstellung"})}),s.jsxs(ce,{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Materialkosten:"}),s.jsx("span",{className:"font-medium",children:C(c.materialCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Lohnkosten:"}),s.jsx("span",{className:"font-medium",children:C(c.laborCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fremdleistungen:"}),s.jsx("span",{className:"font-medium",children:C(c.subcontractorCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fahrtkosten:"}),s.jsx("span",{className:"font-medium",children:C(c.travelCosts)})]}),s.jsx("hr",{}),s.jsxs("div",{className:"flex justify-between font-semibold",children:[s.jsx("span",{children:"Grundkosten:"}),s.jsx("span",{children:C(c.totalBaseCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:["+ Sicherheit (",c.safetyBuffer,"%):"]}),s.jsx("span",{children:C(c.totalCostsWithBuffer-c.totalBaseCosts)})]}),s.jsxs("div",{className:"flex justify-between font-semibold",children:[s.jsx("span",{children:"Kosten mit Puffer:"}),s.jsx("span",{children:C(c.totalCostsWithBuffer)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:["+ Gewinn (",c.profitMargin,"%):"]}),s.jsx("span",{children:C(c.finalPrice-c.totalCostsWithBuffer)})]}),s.jsx("hr",{className:"border-2"}),s.jsxs("div",{className:"flex justify-between text-xl font-bold text-green-600",children:[s.jsx("span",{children:"Verkaufspreis:"}),s.jsx("span",{children:C(c.finalPrice)})]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Kennzahlen"})}),s.jsxs(ce,{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Materialanteil:"}),s.jsxs("span",{children:[(c.materialCosts/c.totalBaseCosts*100||0).toFixed(1),"%"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Lohnanteil:"}),s.jsxs("span",{children:[(c.laborCosts/c.totalBaseCosts*100||0).toFixed(1),"%"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fremdleistungsanteil:"}),s.jsxs("span",{children:[(c.subcontractorCosts/c.totalBaseCosts*100||0).toFixed(1),"%"]})]}),s.jsx("hr",{}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Deckungsbeitrag:"}),s.jsx("span",{className:"font-medium",children:C(c.finalPrice-c.totalBaseCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Deckungsgrad:"}),s.jsxs("span",{children:[((c.finalPrice/c.totalBaseCosts-1)*100||0).toFixed(1),"%"]})]})]})]})]}),c.notes&&s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Notizen"})}),s.jsx(ce,{children:s.jsx("div",{className:"whitespace-pre-wrap text-sm",children:c.notes})})]})]})]}),s.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[s.jsx(ee,{variant:"outline",onClick:e,children:"Abbrechen"}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(ee,{onClick:S,className:"flex items-center gap-2",children:[s.jsx(Dh,{className:"h-4 w-4"}),"Kalkulation speichern"]})})]})]})})};function $ee(t,e=[]){let n=[];function r(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:x,...j}=f,v=(p==null?void 0:p[t][d])||c,_=g.useMemo(()=>j,Object.values(j));return s.jsx(v.Provider,{value:_,children:x})}function m(f,p){const x=(p==null?void 0:p[t][d])||c,j=g.useContext(x);if(j)return j;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[r,Uee(a,...e)]}function Uee(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=r.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var C1="Progress",E1=100,[qee,wae]=$ee(C1),[Wee,Hee]=qee(C1),dI=g.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:a,getValueLabel:i=Vee,...o}=t;(a||a===0)&&!UC(a)&&console.error(Kee(`${a}`,"Progress"));const c=UC(a)?a:E1;r!==null&&!qC(r,c)&&console.error(Zee(`${r}`,"Progress"));const d=qC(r,c)?r:null,u=D0(d)?i(d,c):void 0;return s.jsx(Wee,{scope:n,value:d,max:c,children:s.jsx(nt.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":D0(d)?d:void 0,"aria-valuetext":u,role:"progressbar","data-state":fI(d,c),"data-value":d??void 0,"data-max":c,...o,ref:e})})});dI.displayName=C1;var uI="ProgressIndicator",hI=g.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,a=Hee(uI,n);return s.jsx(nt.div,{"data-state":fI(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...r,ref:e})});hI.displayName=uI;function Vee(t,e){return`${Math.round(t/e*100)}%`}function fI(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function D0(t){return typeof t=="number"}function UC(t){return D0(t)&&!isNaN(t)&&t>0}function qC(t,e){return D0(t)&&!isNaN(t)&&t<=e&&t>=0}function Kee(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${E1}\`.`}function Zee(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${E1} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var mI=dI,Gee=hI;const Pd=g.forwardRef(({className:t,value:e,...n},r)=>s.jsx(mI,{ref:r,className:Te("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:s.jsx(Gee,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));Pd.displayName=mI.displayName;const Qee=({isOpen:t,onClose:e,projectId:n,projectName:r})=>{const{toast:a}=Mt(),[i,o]=g.useState(null),[c,d]=g.useState(null),[u,m]=g.useState(!0);g.useEffect(()=>{t&&n&&f()},[t,n]);const f=async()=>{m(!0);try{const{data:b,error:w}=await Z.from("projects").select("*").eq("id",n).single();if(w||!b)throw new Error("Projekt nicht gefunden");let N=null;if(b.description){const X=b.description.match(/\[PRECALC:(.*?)\]/);if(X)try{N=JSON.parse(X[1]),d(N)}catch(ue){console.warn("Fehler beim Parsen der Vor-Kalkulation:",ue)}}const S=[{hours:45,hourlyRate:45,cost:45*45},{hours:12,hourlyRate:55,cost:12*55}],C=[{name:"Fliesen",cost:850},{name:"Kleber",cost:120},{name:"Fugenmasse",cost:75}],A=N||{materialCosts:0,laborCosts:0,subcontractorCosts:0,travelCosts:0,totalBaseCosts:0,finalPrice:b.budget||0,profitMargin:20},P=C.reduce((X,ue)=>X+ue.cost,0),M=S.reduce((X,ue)=>X+ue.cost,0),z=P+M,R=b.budget||A.finalPrice,D=R-z,B=R>0?D/R*100:0,W={project:b,plannedMaterialCosts:A.materialCosts||0,plannedLaborCosts:A.laborCosts||0,plannedSubcontractorCosts:A.subcontractorCosts||0,plannedTravelCosts:A.travelCosts||0,plannedTotalCosts:A.totalBaseCosts||0,plannedPrice:A.finalPrice||0,plannedProfit:(A.finalPrice||0)-(A.totalBaseCosts||0),plannedProfitMargin:A.profitMargin||20,actualMaterialCosts:P,actualLaborCosts:M,actualSubcontractorCosts:0,actualTravelCosts:50,actualTotalCosts:z,actualPrice:R,actualProfit:D,actualProfitMargin:B,materialDeviation:P-(A.materialCosts||0),laborDeviation:M-(A.laborCosts||0),subcontractorDeviation:0,totalCostDeviation:z-(A.totalBaseCosts||0),profitDeviation:D-((A.finalPrice||0)-(A.totalBaseCosts||0)),budgetUtilization:A.totalBaseCosts>0?z/A.totalBaseCosts*100:0,efficiency:A.laborCosts>0?A.laborCosts/M*100:100,status:D>0?"profitable":D===0?"break_even":"loss"};o(W)}catch(b){console.error("Fehler beim Laden der Rentabilitätsdaten:",b),a({title:"Fehler",description:"Rentabilitätsdaten konnten nicht geladen werden",variant:"destructive"})}finally{m(!1)}},p=b=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(b),x=(b,w=1)=>`${b.toFixed(w)}%`,j=b=>b>0?"text-red-600":b<0?"text-green-600":"text-gray-600",v=b=>b>0?s.jsx(Eo,{className:"h-4 w-4 text-red-600"}):b<0?s.jsx(Yb,{className:"h-4 w-4 text-green-600"}):s.jsx(Ts,{className:"h-4 w-4 text-gray-600"}),_=b=>{switch(b){case"profitable":return s.jsx(Qe,{className:"bg-green-100 text-green-800",children:"Rentabel"});case"break_even":return s.jsx(Qe,{className:"bg-yellow-100 text-yellow-800",children:"Break-Even"});case"loss":return s.jsx(Qe,{className:"bg-red-100 text-red-800",children:"Verlust"});default:return s.jsx(Qe,{variant:"outline",children:"Unbekannt"})}};return u?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsx(Wt,{className:"max-w-4xl",children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Rentabilitätsdaten werden geladen..."})]})})})}):i?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(Jt,{children:[s.jsxs(en,{className:"flex items-center gap-2",children:[s.jsx(Jr,{className:"h-5 w-5"}),"Nachkalkulation & Rentabilität: ",r]}),s.jsxs($n,{className:"flex items-center gap-4",children:[s.jsx("span",{children:"Vergleich von geplanten und tatsächlichen Kosten"}),_(i.status)]})]}),s.jsxs(Is,{defaultValue:"overview",className:"w-full",children:[s.jsxs(js,{className:"grid w-full grid-cols-5",children:[s.jsx(Je,{value:"overview",children:"Übersicht"}),s.jsx(Je,{value:"costs",children:"Kostenanalyse"}),s.jsx(Je,{value:"estimates",children:"Schätzungen vs. Ist"}),s.jsx(Je,{value:"deviations",children:"Abweichungen"}),s.jsx(Je,{value:"kpis",children:"Kennzahlen"})]}),s.jsxs(et,{value:"overview",className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(Gb,{className:"h-5 w-5 text-green-600"}),"Gewinn"]})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Geplant:"}),s.jsx("span",{children:p(i.plannedProfit)})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Tatsächlich:"}),s.jsx("span",{className:i.actualProfit>=0?"text-green-600 font-semibold":"text-red-600 font-semibold",children:p(i.actualProfit)})]}),s.jsxs("div",{className:"flex justify-between items-center text-sm border-t pt-2",children:[s.jsx("span",{className:"text-gray-600",children:"Abweichung:"}),s.jsxs("div",{className:"flex items-center gap-1",children:[v(i.profitDeviation),s.jsx("span",{className:j(i.profitDeviation),children:p(Math.abs(i.profitDeviation))})]})]})]})})]}),s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(qa,{className:"h-5 w-5 text-blue-600"}),"Budget-Nutzung"]})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Geplante Kosten:"}),s.jsx("span",{children:p(i.plannedTotalCosts)})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Tatsächliche Kosten:"}),s.jsx("span",{children:p(i.actualTotalCosts)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Auslastung:"}),s.jsx("span",{className:i.budgetUtilization>100?"text-red-600 font-semibold":"text-green-600",children:x(i.budgetUtilization)})]}),s.jsx(Pd,{value:Math.min(i.budgetUtilization,100),className:"h-2"})]})]})})]}),s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(an,{className:"h-5 w-5 text-purple-600"}),"Arbeitseffizienz"]})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Geplante Stunden:"}),s.jsxs("span",{children:[(i.plannedLaborCosts/45).toFixed(1),"h"]})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Tatsächliche Stunden:"}),s.jsxs("span",{children:[(i.actualLaborCosts/45).toFixed(1),"h"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Effizienz:"}),s.jsx("span",{className:i.efficiency>=100?"text-green-600 font-semibold":"text-orange-600",children:x(i.efficiency)})]}),s.jsx(Pd,{value:Math.min(i.efficiency,100),className:"h-2"})]})]})})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Projekt-Zusammenfassung"})}),s.jsx(ce,{children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p(i.actualPrice)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Verkaufspreis"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:p(i.actualTotalCosts)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Gesamtkosten"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`text-2xl font-bold ${i.actualProfit>=0?"text-green-600":"text-red-600"}`,children:p(i.actualProfit)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Gewinn/Verlust"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`text-2xl font-bold ${i.actualProfitMargin>=0?"text-green-600":"text-red-600"}`,children:x(i.actualProfitMargin)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Gewinnmarge"})]})]})})]})]}),s.jsx(et,{value:"costs",className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Geplante Kosten"})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Material:"}),s.jsx("span",{children:p(i.plannedMaterialCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Lohn:"}),s.jsx("span",{children:p(i.plannedLaborCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fremdleistungen:"}),s.jsx("span",{children:p(i.plannedSubcontractorCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fahrtkosten:"}),s.jsx("span",{children:p(i.plannedTravelCosts)})]}),s.jsx("hr",{}),s.jsxs("div",{className:"flex justify-between font-semibold",children:[s.jsx("span",{children:"Gesamt:"}),s.jsx("span",{children:p(i.plannedTotalCosts)})]})]})})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Tatsächliche Kosten"})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Material:"}),s.jsx("span",{children:p(i.actualMaterialCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Lohn:"}),s.jsx("span",{children:p(i.actualLaborCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fremdleistungen:"}),s.jsx("span",{children:p(i.actualSubcontractorCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fahrtkosten:"}),s.jsx("span",{children:p(i.actualTravelCosts)})]}),s.jsx("hr",{}),s.jsxs("div",{className:"flex justify-between font-semibold",children:[s.jsx("span",{children:"Gesamt:"}),s.jsx("span",{children:p(i.actualTotalCosts)})]})]})})]})]})}),s.jsx(et,{value:"estimates",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(Jr,{className:"h-5 w-5 text-blue-600"}),"Schätzungen vs. Bestätigte Werte vs. Tatsächlicher Verbrauch"]}),s.jsx(CardDescription,{children:"Vergleich zwischen geschätzten Werten, bestätigten Planungswerten und dem tatsächlichen Materialverbrauch"})]}),s.jsx(ce,{children:c?s.jsxs("div",{className:"space-y-6",children:[c.materials&&c.materials.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[s.jsx(qa,{className:"h-4 w-4"}),"Material-Vergleich"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-6 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[s.jsx("span",{children:"Material"}),s.jsx("span",{children:"Geplant"}),s.jsx("span",{children:"Status"}),s.jsx("span",{children:"Tatsächlich"}),s.jsx("span",{children:"Abweichung"}),s.jsx("span",{children:"Typ"})]}),c.materials.map((b,w)=>{const N=w===0?850:w===1?120:95,S=b.quantity*b.pricePerUnit*(1+b.markup/100),C=N-S;return s.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-b",children:[s.jsx("span",{className:"text-sm",children:b.name||"Material "+(w+1)}),s.jsx("span",{className:"text-sm",children:p(S)}),s.jsx("div",{children:b.isEstimate?s.jsx(Qe,{variant:"outline",className:"text-orange-600 border-orange-600 text-xs",children:"Schätzung"}):s.jsx(Qe,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Bestätigt"})}),s.jsx("span",{className:"text-sm",children:p(N)}),s.jsxs("div",{className:"flex items-center gap-1",children:[v(C),s.jsx("span",{className:`text-sm ${j(C)}`,children:p(Math.abs(C))})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[b.unit," (",b.quantity,"x)"]})]},b.id)})]})]}),c.labor&&c.labor.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[s.jsx(bi,{className:"h-4 w-4"}),"Arbeitszeit-Vergleich"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-6 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[s.jsx("span",{children:"Arbeitsposition"}),s.jsx("span",{children:"Geplant"}),s.jsx("span",{children:"Status"}),s.jsx("span",{children:"Tatsächlich"}),s.jsx("span",{children:"Abweichung"}),s.jsx("span",{children:"Details"})]}),c.labor.map((b,w)=>{const N=w===0?2025:660,S=b.hours*b.workers*b.hourlyRate,C=N-S;return s.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-b",children:[s.jsx("span",{className:"text-sm",children:b.description||"Arbeitsposition "+(w+1)}),s.jsx("span",{className:"text-sm",children:p(S)}),s.jsx("div",{children:b.isEstimate?s.jsx(Qe,{variant:"outline",className:"text-orange-600 border-orange-600 text-xs",children:"Schätzung"}):s.jsx(Qe,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Bestätigt"})}),s.jsx("span",{className:"text-sm",children:p(N)}),s.jsxs("div",{className:"flex items-center gap-1",children:[v(C),s.jsx("span",{className:`text-sm ${j(C)}`,children:p(Math.abs(C))})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[b.hours,"h × ",b.workers," Pers."]})]},b.id)})]})]}),s.jsxs("div",{className:"mt-6",children:[s.jsx("h4",{className:"font-semibold mb-4",children:"Schätzungsgenauigkeit"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx(oe,{className:"bg-orange-50",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:c.materials?c.materials.filter(b=>b.isEstimate).length:0}),s.jsx("div",{className:"text-sm text-orange-700",children:"Material-Schätzungen"})]})})}),s.jsx(oe,{className:"bg-green-50",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.materials?c.materials.filter(b=>!b.isEstimate).length:0}),s.jsx("div",{className:"text-sm text-green-700",children:"Bestätigte Materialien"})]})})}),s.jsx(oe,{className:"bg-blue-50",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[c.materials&&c.labor?Math.round(100-Math.abs(i.totalCostDeviation)/i.plannedTotalCosts*100):0,"%"]}),s.jsx("div",{className:"text-sm text-blue-700",children:"Gesamt-Genauigkeit"})]})})})]})]}),s.jsx("div",{className:"mt-6",children:s.jsxs(oe,{className:"bg-blue-50",children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center gap-2 text-blue-700",children:[s.jsx(us,{className:"h-5 w-5"}),"Empfehlungen für zukünftige Schätzungen"]})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-2 text-blue-700",children:[s.jsx("p",{children:"• Als Schätzung markierte Positionen sollten vor Projektbeginn noch einmal überprüft werden"}),s.jsx("p",{children:"• Verwenden Sie bestätigte Werte aus ähnlichen abgeschlossenen Projekten"}),s.jsx("p",{children:"• Planen Sie für geschätzte Positionen einen höheren Sicherheitspuffer ein"}),s.jsx("p",{children:"• Dokumentieren Sie Abweichungen zwischen Schätzungen und tatsächlichen Werten für bessere zukünftige Kalkulationen"})]})})]})})]}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Jr,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Vor-Kalkulation verfügbar"}),s.jsx("p",{children:"Für dieses Projekt wurde keine detaillierte Vor-Kalkulation mit Schätzungsmarkierungen erstellt."})]})})]})}),s.jsxs(et,{value:"deviations",className:"space-y-6",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Kostenabweichungen"})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[s.jsx("span",{children:"Kategorie"}),s.jsx("span",{children:"Geplant"}),s.jsx("span",{children:"Tatsächlich"}),s.jsx("span",{children:"Abweichung"})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[s.jsx("span",{children:"Material"}),s.jsx("span",{children:p(i.plannedMaterialCosts)}),s.jsx("span",{children:p(i.actualMaterialCosts)}),s.jsxs("div",{className:"flex items-center gap-2",children:[v(i.materialDeviation),s.jsx("span",{className:j(i.materialDeviation),children:p(Math.abs(i.materialDeviation))})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[s.jsx("span",{children:"Lohn"}),s.jsx("span",{children:p(i.plannedLaborCosts)}),s.jsx("span",{children:p(i.actualLaborCosts)}),s.jsxs("div",{className:"flex items-center gap-2",children:[v(i.laborDeviation),s.jsx("span",{className:j(i.laborDeviation),children:p(Math.abs(i.laborDeviation))})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center border-t pt-2",children:[s.jsx("span",{className:"font-semibold",children:"Gesamtabweichung"}),s.jsx("span",{className:"font-semibold",children:p(i.plannedTotalCosts)}),s.jsx("span",{className:"font-semibold",children:p(i.actualTotalCosts)}),s.jsxs("div",{className:"flex items-center gap-2",children:[v(i.totalCostDeviation),s.jsx("span",{className:`font-semibold ${j(i.totalCostDeviation)}`,children:p(Math.abs(i.totalCostDeviation))})]})]})]})})]}),i.totalCostDeviation>0&&s.jsxs(oe,{className:"border-red-200 bg-red-50",children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center gap-2 text-red-700",children:[s.jsx(us,{className:"h-5 w-5"}),"Kostenüberschreitung"]})}),s.jsx(ce,{children:s.jsxs("p",{className:"text-red-700",children:["Das Projekt hat die geplanten Kosten um ",p(i.totalCostDeviation)," überschritten. Das entspricht einer Überschreitung von ",x(i.totalCostDeviation/i.plannedTotalCosts*100),"."]})})]})]}),s.jsxs(et,{value:"kpis",className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Rentabilitäts-KPIs"})}),s.jsxs(ce,{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Gewinnmarge (geplant):"}),s.jsx("span",{className:"font-semibold",children:x(i.plannedProfitMargin)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Gewinnmarge (tatsächlich):"}),s.jsx("span",{className:`font-semibold ${i.actualProfitMargin>=0?"text-green-600":"text-red-600"}`,children:x(i.actualProfitMargin)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"ROI (Return on Investment):"}),s.jsx("span",{className:`font-semibold ${i.actualProfit>=0?"text-green-600":"text-red-600"}`,children:x(i.actualProfit/i.actualTotalCosts*100)})]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Effizienz-KPIs"})}),s.jsxs(ce,{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Budget-Ausschöpfung:"}),s.jsx("span",{className:`font-semibold ${i.budgetUtilization>100?"text-red-600":"text-green-600"}`,children:x(i.budgetUtilization)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Arbeitseffizienz:"}),s.jsx("span",{className:`font-semibold ${i.efficiency>=100?"text-green-600":"text-orange-600"}`,children:x(i.efficiency)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Kostengenauigkeit:"}),s.jsx("span",{className:"font-semibold",children:x(100-Math.abs(i.totalCostDeviation/i.plannedTotalCosts*100))})]})]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Empfehlungen für zukünftige Projekte"})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-3",children:[i.materialDeviation>i.plannedMaterialCosts*.1&&s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-yellow-50 rounded-lg",children:[s.jsx(us,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-yellow-800",children:"Materialkosten-Planung verbessern"}),s.jsxs("div",{className:"text-sm text-yellow-700",children:["Materialkosten waren ",x(i.materialDeviation/i.plannedMaterialCosts*100)," höher als geplant. Prüfen Sie Ihre Lieferantenpreise und Mengenschätzungen."]})]})]}),i.efficiency<90&&s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[s.jsx(an,{className:"h-5 w-5 text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-blue-800",children:"Arbeitsplanung optimieren"}),s.jsxs("div",{className:"text-sm text-blue-700",children:["Die Arbeitseffizienz lag bei nur ",x(i.efficiency),". Überprüfen Sie die Zeitschätzungen und Arbeitsabläufe."]})]})]}),i.actualProfitMargin>i.plannedProfitMargin*1.2&&s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[s.jsx(Ts,{className:"h-5 w-5 text-green-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-green-800",children:"Sehr gute Rentabilität"}),s.jsx("div",{className:"text-sm text-green-700",children:"Das Projekt war deutlich rentabler als geplant. Diese Kalkulations-Ansätze können als Vorlage für ähnliche Projekte dienen."})]})]})]})})]})]})]}),s.jsx("div",{className:"flex justify-end pt-4 border-t",children:s.jsx(ee,{onClick:e,children:"Schließen"})})]})}):s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsx(Wt,{className:"max-w-4xl",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(us,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Daten verfügbar"}),s.jsx("p",{className:"text-gray-600",children:"Für dieses Projekt konnten keine Rentabilitätsdaten geladen werden."})]})})})};function Yee({active:t,done:e,budget:n,late:r}){return s.jsxs("section",{"aria-label":"Kennzahlen",className:`sticky top-0 z-10 grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\r
                 backdrop-blur-md bg-background/70 border rounded-2xl p-3 shadow-soft`,children:[s.jsx(Gm,{title:"Aktive Projekte",value:t}),s.jsx(Gm,{title:"Abgeschlossene",value:e}),s.jsx(Gm,{title:"Gesamtbudget",value:`€${(n||0).toLocaleString("de-DE")}`}),s.jsx(Gm,{title:"Verspätet",value:r})]})}function Gm({title:t,value:e}){return s.jsxs("div",{className:"bg-card border rounded-xl px-4 py-3 flex items-center justify-between",children:[s.jsx("div",{className:"text-xs text-muted-foreground font-semibold",children:t}),s.jsx("div",{className:"text-xl font-bold",children:e})]})}function Xee({counts:t}){const e=[{label:"Anfrage",key:"anfrage",dot:"bg-blue-400"},{label:"Termin ausmachen",key:"besichtigung",dot:"bg-sky-400"},{label:"In Planung",key:"geplant",dot:"bg-amber-400"},{label:"In Arbeit",key:"in_bearbeitung",dot:"bg-yellow-400"},{label:"Erledigt",key:"abgeschlossen",dot:"bg-green-500"}];return s.jsx("div",{className:"grid grid-cols-[1fr_auto] gap-2 text-sm",children:e.map(n=>s.jsxs(Ae.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`inline-block w-2.5 h-2.5 rounded-full ${n.dot}`}),s.jsx("span",{children:n.label})]}),s.jsx("span",{className:"font-medium",children:t[n.key]})]},n.key))})}const WC={anfrage:{label:"Anfrage",cls:"bg-purple-100 text-purple-800 border-purple-200"},besichtigung:{label:"Termin ausmachen",cls:"bg-orange-100  text-orange-800  border-orange-200"},geplant:{label:"In Planung",cls:"bg-blue-100   text-blue-800   border-blue-200"},in_bearbeitung:{label:"In Arbeit",cls:"bg-yellow-100 text-yellow-800 border-yellow-200"},abgeschlossen:{label:"Erledigt",cls:"bg-green-100  text-green-800  border-green-200"}};function HC(t){const e=WC[t.status]||WC.geplant,n=r=>r?new Date(r).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"}):"—";return s.jsxs("div",{className:"flex flex-col gap-2 py-2 cursor-pointer",onDoubleClick:t.onOpen,children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${e.cls}`,children:e.label}),s.jsx("strong",{className:"mr-2",children:t.name}),s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-blue-50 text-blue-700 border-blue-200",children:["ID: ",t.id]})]}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:["Start: ",n(t.start)," • Ende: ",n(t.end)," • Budget:"," ",s.jsxs("strong",{className:"text-green-600",children:["€",(t.budget||0).toLocaleString("de-DE")]})]}),typeof t.progress=="number"&&s.jsx("div",{className:"h-2 w-full rounded-full bg-neutral-200 overflow-hidden",children:s.jsx("div",{className:"h-full rounded-full bg-blue-500 transition-all",style:{width:`${t.progress}%`},"aria-valuenow":t.progress,"aria-valuemin":0,"aria-valuemax":100,role:"progressbar"})})]})}const VC=t=>`P${t.split("-").join("").substring(0,6).toUpperCase()}`,Ny=t=>{if(!t)return 0;const e=t.match(/\[BUDGET:(\d+\.?\d*)\]/);return e?parseFloat(e[1]):0},Jee=()=>{Mt();const{companyId:t}=Fr(),{data:e,isLoading:n}=lR(),{data:r,isLoading:a}=oR(),[i,o]=g.useState([]),[c,d]=g.useState(!0),u=g.useCallback(async()=>{try{if(d(!0),console.log("ProjectModule: fetchEmployees called with companyId:",t),!t){console.error("ProjectModule: No company ID available"),d(!1);return}const{data:U,error:te}=await Z.from("employees").select("id, email, status, user_id, company_id").eq("company_id",t);console.log("ProjectModule: DEBUG - All employees for company:",U);const{data:J,error:q}=await Z.from("employees").select(`
          id,
          user_id,
          first_name,
          last_name,
          email,
          phone,
          position,
          status,
          qualifications,
          license
        `).eq("company_id",t).eq("status","Aktiv").order("created_at",{ascending:!1});if(console.log("ProjectModule: Employees query result:",J,q),q){console.error("ProjectModule: Error fetching employees:",q),d(!1);return}const ne=(J==null?void 0:J.filter(re=>re.user_id).map(re=>re.user_id))||[];let pe=[];if(ne.length>0){const{data:re,error:me}=await Z.from("profiles").select("id, first_name, last_name").in("id",ne);me||(pe=re||[])}const Q=(J==null?void 0:J.map(re=>{const me=pe.find(se=>se.id===re.user_id),he=(me==null?void 0:me.first_name)||re.first_name||"",ge=(me==null?void 0:me.last_name)||re.last_name||"";return{id:re.id,first_name:he,last_name:ge,name:`${he} ${ge}`.trim(),email:re.email,phone:re.phone,position:re.position,status:re.status,qualifications:re.qualifications||[],license:re.license,projects:[],user_id:re.user_id}}).filter(re=>{const me=re.first_name&&re.first_name.trim().length>0,he=re.last_name&&re.last_name.trim().length>0,ge=re.name&&re.name.trim().length>0&&re.name.trim()!==" ",se=me||he||ge;return console.log("ProjectModule: Employee filter check:",{employee:re.name,hasFirstName:me,hasLastName:he,hasValidName:ge,shouldInclude:se,user_id:re.user_id}),se||console.log("ProjectModule: Filtering out employee without proper name:",re),se}))||[];console.log("ProjectModule: Final employee list:",Q),o(Q)}catch(U){console.error("ProjectModule: fetchEmployees error:",U)}finally{d(!1)}},[t]);g.useEffect(()=>{u()},[u]);const[m,f]=g.useState(!1),[p,x]=g.useState(!1),[j,v]=g.useState(!1),[_,b]=g.useState(!1),[w,N]=g.useState(!1),[S,C]=g.useState(!1),[A,P]=g.useState(null),[M,z]=g.useState(null),R=(e==null?void 0:e.items)||[],D=(r==null?void 0:r.items)||[];console.log("Customers data:",D),console.log("Team members data:",i),console.log("Team members loading:",c);const B=D.length>0?D:[{id:"demo_customer_1",name:"Demo Kunde - Bitte echte Kunden hinzufügen",company_name:"Demo Kunde",contact_person:"Bitte echte Kunden hinzufügen",email:"demo@example.com",phone:"+49 000 000000",address:"Demo Adresse",projects:0,revenue:"0",status:"Demo"}],W=i,X=n||a||c;console.log("ProjectModule Debug:",{projectsResponse:e,projects:R,projectsLoading:n,isLoading:X});const ue={anfrage:R.filter(U=>U.status==="anfrage").length,besichtigung:R.filter(U=>U.status==="besichtigung").length,geplant:R.filter(U=>U.status==="geplant").length,in_bearbeitung:R.filter(U=>U.status==="in_bearbeitung").length,abgeschlossen:R.filter(U=>U.status==="abgeschlossen").length},de=R.reduce((U,te)=>{const J=Ny(te.description)||te.budget||0;return U+J},0),G=new Date().toISOString().split("T")[0],I=R.filter(U=>U.end_date&&U.end_date<G&&U.status!=="abgeschlossen"),V=D.filter(U=>U.status==="Aktiv").slice(0,5),$=()=>{f(!1)},F=()=>{x(!1)},O=()=>{x(!1)},K=U=>{z(U.id),b(!0)};return s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Projekte & Baustellen"}),s.jsxs(ee,{onClick:()=>f(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Neues Projekt"]})]}),s.jsx(Yee,{active:R.filter(U=>U.status!=="abgeschlossen").length,done:R.filter(U=>U.status==="abgeschlossen").length,budget:de||0,late:I.length}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsxs(Ne,{className:"pb-2 flex-row items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-100 text-green-800 border-green-200",children:"Aktuelle"}),s.jsx(Ce,{children:"Projekte"})]}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:["Heute • ",new Date().toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"})]})]}),s.jsx(ce,{className:"space-y-3",children:X?Array(3).fill(0).map((U,te)=>s.jsx("div",{className:"border rounded-xl p-3 shadow-softer",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx(dt,{className:"h-4 w-24 mb-2"}),s.jsx(dt,{className:"h-3 w-32 mb-1"}),s.jsx(dt,{className:"h-3 w-20"})]}),s.jsx(dt,{className:"h-6 w-16"})]})},te)):R.filter(U=>U.status!=="abgeschlossen").length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine Projekte vorhanden"}):R.filter(U=>U.status!=="abgeschlossen").map(U=>s.jsx("div",{className:"border rounded-xl p-3 shadow-softer cursor-pointer hover:shadow-md transition-shadow",onDoubleClick:()=>K(U),children:s.jsx(HC,{id:VC(U.id),name:U.name,status:U.status,budget:Ny(U.description)||U.budget||0,start:U.start_date,end:U.end_date,progress:U.status==="abgeschlossen"?100:U.status==="in_bearbeitung"?60:U.status==="geplant"?30:10,onOpen:()=>K(U)})},U.id))})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsx(Ne,{className:"pb-2",children:s.jsx(Ce,{children:"Verzögerte Projekte"})}),s.jsx(ce,{children:X?s.jsxs("div",{className:"space-y-2",children:[s.jsx(dt,{className:"h-16 w-full"}),s.jsx(dt,{className:"h-16 w-full"})]}):I.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine Projekte im Verzug 🎉"}):I.map(U=>s.jsx("div",{className:"border rounded-xl p-3 mb-2 cursor-pointer hover:shadow-md transition-shadow",onDoubleClick:()=>K(U),children:s.jsx(HC,{id:VC(U.id),name:U.name,status:U.status,budget:Ny(U.description)||U.budget||0,progress:U.status==="abgeschlossen"?100:U.status==="in_bearbeitung"?60:U.status==="geplant"?30:10,onOpen:()=>K(U)})},U.id))})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsx(Ne,{className:"pb-2",children:s.jsx(Ce,{children:"Projektstatus"})}),s.jsx(ce,{children:s.jsx(Xee,{counts:ue})})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsx(Ne,{className:"pb-2",children:s.jsx(Ce,{children:"Top Kunden"})}),s.jsx(ce,{className:"space-y-2",children:X?Array(3).fill(0).map((U,te)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(dt,{className:"h-4 w-24"}),s.jsx(dt,{className:"h-4 w-32"})]},te)):V.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"Hier erscheinen Kunden, sobald Projekte abgeschlossen sind."}):V.map(U=>s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{children:U.company_name||U.contact_person}),s.jsx("span",{className:"text-muted-foreground",children:U.email})]},U.id))})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsx(Ne,{className:"pb-2",children:s.jsx(Ce,{children:"Projekt Übersicht"})}),s.jsxs(ce,{className:"grid grid-cols-2 gap-2 text-sm",children:[s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-slate-50 text-slate-700 border-slate-200",children:["Gesamt: ",R.length]}),s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-amber-50 text-amber-700 border-amber-200",children:["In Planung: ",ue.geplant]}),s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-blue-50 text-blue-700 border-blue-200",children:["In Arbeit: ",ue.in_bearbeitung]}),s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-50 text-green-700 border-green-200",children:["Erledigt: ",ue.abgeschlossen]})]})]})]})]}),s.jsx(Ree,{isOpen:m,onClose:()=>f(!1),onProjectAdded:$,customers:B,teamMembers:W}),s.jsx(Iee,{isOpen:p,onClose:()=>x(!1),project:A,onProjectUpdated:F,onProjectDeleted:O}),s.jsx(Oee,{isOpen:j,onClose:()=>v(!1),project:A}),M&&s.jsx(Bee,{isOpen:_,onClose:()=>{b(!1),z(null)},projectId:M}),A&&s.jsx(zee,{isOpen:w,onClose:()=>N(!1),projectId:A.id,projectName:A.name,customerId:A.customer_id||"",onCalculationSaved:()=>{}}),A&&s.jsx(Qee,{isOpen:S,onClose:()=>C(!1),projectId:A.id,projectName:A.name})]})};function mo({title:t,value:e,className:n,valueClassName:r}){return s.jsxs("div",{className:Te("bg-card border rounded-xl px-4 py-4 flex items-center justify-between shadow-sm hover:shadow-md transition-shadow",n),children:[s.jsx("div",{className:"text-xs text-muted-foreground font-semibold uppercase tracking-wider",children:t}),s.jsx("div",{className:Te("text-2xl font-bold",r),children:e})]})}function pI({children:t,className:e}){return s.jsx("section",{"aria-label":"Kennzahlen",className:Te("grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4","bg-background/95 backdrop-blur-sm border rounded-2xl p-4 shadow-lg",e),children:t})}const ete=({totalEmployees:t,activeEmployees:e,onVacationEmployees:n,totalHours:r})=>s.jsxs(pI,{children:[s.jsx(mo,{title:"Mitarbeiter gesamt",value:t}),s.jsx(mo,{title:"Aktiv",value:e,valueClassName:"text-green-600"}),s.jsx(mo,{title:"Urlaub",value:n,valueClassName:"text-yellow-600"}),s.jsx(mo,{title:"Stunden (Monat)",value:r})]});var A1="Avatar",[tte,bae]=wr(A1),[nte,gI]=tte(A1),xI=g.forwardRef((t,e)=>{const{__scopeAvatar:n,...r}=t,[a,i]=g.useState("idle");return s.jsx(nte,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:s.jsx(nt.span,{...r,ref:e})})});xI.displayName=A1;var vI="AvatarImage",yI=g.forwardRef((t,e)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...i}=t,o=gI(vI,n),c=ste(r,i.referrerPolicy),d=_n(u=>{a(u),o.onImageLoadingStatusChange(u)});return Bn(()=>{c!=="idle"&&d(c)},[c,d]),c==="loaded"?s.jsx(nt.img,{...i,ref:e,src:r}):null});yI.displayName=vI;var _I="AvatarFallback",wI=g.forwardRef((t,e)=>{const{__scopeAvatar:n,delayMs:r,...a}=t,i=gI(_I,n),[o,c]=g.useState(r===void 0);return g.useEffect(()=>{if(r!==void 0){const d=window.setTimeout(()=>c(!0),r);return()=>window.clearTimeout(d)}},[r]),o&&i.imageLoadingStatus!=="loaded"?s.jsx(nt.span,{...a,ref:e}):null});wI.displayName=_I;function ste(t,e){const[n,r]=g.useState("idle");return Bn(()=>{if(!t){r("error");return}let a=!0;const i=new window.Image,o=c=>()=>{a&&r(c)};return r("loading"),i.onload=o("loaded"),i.onerror=o("error"),i.src=t,e&&(i.referrerPolicy=e),()=>{a=!1}},[t,e]),n}var bI=xI,jI=yI,NI=wI;const tf=g.forwardRef(({className:t,...e},n)=>s.jsx(bI,{ref:n,className:Te("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));tf.displayName=bI.displayName;const rte=g.forwardRef(({className:t,...e},n)=>s.jsx(jI,{ref:n,className:Te("aspect-square h-full w-full",t),...e}));rte.displayName=jI.displayName;const nf=g.forwardRef(({className:t,...e},n)=>s.jsx(NI,{ref:n,className:Te("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));nf.displayName=NI.displayName;const ate=({employee:t,onShowDetails:e,onEdit:n})=>{const r=i=>{switch(i){case"Aktiv":return"bg-green-100 text-green-800";case"Urlaub":return"bg-yellow-100 text-yellow-800";case"Krank":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a=i=>i.split(" ").map(o=>o[0]).join("");return s.jsx(oe,{className:"hover:shadow-lg transition-shadow",children:s.jsxs(ce,{className:"p-6 flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx(tf,{className:"h-12 w-12",children:s.jsx(nf,{children:a(t.name)})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h4",{className:"text-lg font-semibold",children:t.name}),s.jsx(Qe,{className:r(t.status),children:t.status})]}),s.jsx("p",{className:"text-gray-600 mb-2",children:t.position}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm mb-4 flex-grow",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Aktuelles Projekt:"}),s.jsx("p",{children:t.currentProject})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Stunden (Monat):"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(an,{className:"h-4 w-4"}),t.hoursThisMonth,"h"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Führerschein:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(Zb,{className:"h-4 w-4"}),t.license||"Nicht angegeben"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Resturlaub:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"h-4 w-4"}),t.vacationDays," Tage"]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Qualifikationen:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:t.qualifications.length>0?t.qualifications.map(i=>s.jsxs(Qe,{variant:"outline",className:"text-xs",children:[s.jsx(vf,{className:"h-3 w-3 mr-1"}),i]},i)):s.jsx("span",{className:"text-sm text-gray-400",children:"Keine Qualifikationen hinterlegt"})})]})]})]}),s.jsxs("div",{className:"flex gap-2 mt-auto",children:[s.jsx(ee,{size:"sm",variant:"outline",onClick:()=>e(t),children:"Details"}),s.jsxs(ee,{size:"sm",onClick:()=>n(t),children:[s.jsx(Tl,{className:"h-4 w-4 mr-1"}),"Bearbeiten"]})]})]})})},ite=({isOpen:t,onClose:e,onSubmit:n,isLoading:r})=>{const[a,i]=g.useState({email:"",firstName:"",lastName:"",position:"",phone:"",license:"",qualifications:[]}),[o,c]=g.useState(""),d=(v,_)=>{i(b=>({...b,[v]:_}))},u=()=>{o.trim()&&!a.qualifications.includes(o.trim())&&(i(v=>({...v,qualifications:[...v.qualifications,o.trim()]})),c(""))},m=v=>{i(_=>({..._,qualifications:_.qualifications.filter(b=>b!==v)}))},f=v=>{v.key==="Enter"&&(v.preventDefault(),u())},p=v=>{v.preventDefault(),n(a)},x=()=>{i({email:"",firstName:"",lastName:"",position:"",phone:"",license:"",qualifications:[]}),c("")},j=()=>{x(),e()};return s.jsx(Kt,{open:t,onOpenChange:j,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Neuen Mitarbeiter erstellen"}),s.jsx($n,{children:"Erstelle einen neuen Mitarbeiter. Der Mitarbeiter erhält eine E-Mail zur Bestätigung seines Kontos."})]}),s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"add-firstName",children:"Vorname"}),s.jsx(ae,{id:"add-firstName",type:"text",value:a.firstName,onChange:v=>d("firstName",v.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"add-lastName",children:"Nachname"}),s.jsx(ae,{id:"add-lastName",type:"text",value:a.lastName,onChange:v=>d("lastName",v.target.value),required:!0})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"add-email",children:"E-Mail"}),s.jsx(ae,{id:"add-email",type:"email",value:a.email,onChange:v=>d("email",v.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"add-position",children:"Position"}),s.jsx(ae,{id:"add-position",type:"text",value:a.position,onChange:v=>d("position",v.target.value),placeholder:"z.B. Elektriker, Elektroniker"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"add-phone",children:"Telefon"}),s.jsx(ae,{id:"add-phone",type:"tel",value:a.phone,onChange:v=>d("phone",v.target.value),placeholder:"+49 123 456789"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"add-license",children:"Führerschein"}),s.jsx(ae,{id:"add-license",type:"text",value:a.license,onChange:v=>d("license",v.target.value),placeholder:"z.B. B, BE"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"add-qualifications",children:"Qualifikationen"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ae,{id:"add-qualifications",type:"text",value:o,onChange:v=>c(v.target.value),onKeyPress:f,placeholder:"z.B. VDE 0100, Erste Hilfe"}),s.jsx(ee,{type:"button",onClick:u,size:"sm",children:s.jsx(rn,{className:"h-4 w-4"})})]}),a.qualifications.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:a.qualifications.map(v=>s.jsxs(Qe,{variant:"outline",className:"text-xs",children:[s.jsx(vf,{className:"h-3 w-3 mr-1"}),v,s.jsx("button",{type:"button",onClick:()=>m(v),className:"ml-1 hover:text-red-600",children:s.jsx(Ln,{className:"h-3 w-3"})})]},v))})]})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(ee,{type:"button",variant:"outline",onClick:j,children:"Abbrechen"}),s.jsx(ee,{type:"submit",disabled:r,children:r?"Wird erstellt...":"Mitarbeiter erstellen"})]})]})]})})},ote=({isOpen:t,onClose:e,employee:n})=>{const r=i=>{switch(i){case"Aktiv":return"bg-green-100 text-green-800";case"Urlaub":return"bg-yellow-100 text-yellow-800";case"Krank":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a=i=>i.split(" ").map(o=>o[0]).join("");return n?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-2xl",children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Mitarbeiterdetails"}),s.jsx($n,{children:"Detaillierte Informationen über den Mitarbeiter"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(tf,{className:"h-16 w-16",children:s.jsx(nf,{className:"text-lg",children:a(n.name)})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold",children:n.name}),s.jsx("p",{className:"text-gray-600",children:n.position}),s.jsx(Qe,{className:r(n.status),children:n.status})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(es,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:n.email})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Fd,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:n.phone||"Nicht angegeben"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zb,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm",children:["Führerschein: ",n.license||"Nicht angegeben"]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(an,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm",children:[n.hoursThisMonth,"h diesen Monat"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm",children:[n.vacationDays," Tage Resturlaub"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ci,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:n.currentProject})]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-2",children:"Qualifikationen"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:n.qualifications.length>0?n.qualifications.map(i=>s.jsxs(Qe,{variant:"outline",children:[s.jsx(vf,{className:"h-3 w-3 mr-1"}),i]},i)):s.jsx("span",{className:"text-sm text-gray-400",children:"Keine Qualifikationen hinterlegt"})})]}),s.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50",children:[s.jsx("h4",{className:"font-medium mb-2",children:"Dateien & Dokumente"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Diese Funktion wird bald verfügbar sein."})]})]})]})}):null},lte=({isOpen:t,onClose:e,employee:n,onSave:r})=>{const{toast:a}=Mt(),i=tG(),[o,c]=g.useState({name:"",position:"",email:"",phone:"",status:"Aktiv",license:"",qualifications:[],currentProject:"",hoursThisMonth:0,vacationDays:0}),[d,u]=g.useState("");g.useEffect(()=>{n&&c({name:n.name,position:n.position,email:n.email,phone:n.phone,status:n.status,license:n.license,qualifications:n.qualifications||[],currentProject:n.currentProject,hoursThisMonth:n.hoursThisMonth,vacationDays:n.vacationDays})},[n]);const m=(_,b)=>{c(w=>({...w,[_]:b}))},f=()=>{d.trim()&&!o.qualifications.includes(d.trim())&&(c(_=>({..._,qualifications:[..._.qualifications,d.trim()]})),u(""))},p=_=>{c(b=>({...b,qualifications:b.qualifications.filter(w=>w!==_)}))},x=_=>{_.key==="Enter"&&(_.preventDefault(),f())},j=_=>{_.preventDefault(),r(o)},v=()=>{n&&window.confirm(`Möchten Sie den Mitarbeiter "${n.name}" wirklich löschen?`)&&i.mutate(n.id,{onSuccess:()=>{a({title:"Mitarbeiter gelöscht",description:`${n.name} wurde erfolgreich gelöscht.`}),e()},onError:_=>{a({title:"Fehler beim Löschen",description:_.message,variant:"destructive"})}})};return n?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Mitarbeiter bearbeiten"}),s.jsx($n,{children:"Mitarbeiterdaten bearbeiten"})]}),s.jsxs("form",{onSubmit:j,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"name",children:"Name"}),s.jsx(ae,{id:"name",value:o.name,onChange:_=>m("name",_.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"position",children:"Position"}),s.jsx(ae,{id:"position",value:o.position,onChange:_=>m("position",_.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"email",children:"E-Mail"}),s.jsx(ae,{id:"email",type:"email",value:o.email,onChange:_=>m("email",_.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"phone",children:"Telefon"}),s.jsx(ae,{id:"phone",value:o.phone,onChange:_=>m("phone",_.target.value)})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"status",children:"Status"}),s.jsxs(mt,{value:o.status,onValueChange:_=>m("status",_),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Aktiv",children:"Aktiv"}),s.jsx(ye,{value:"Urlaub",children:"Urlaub"}),s.jsx(ye,{value:"Krank",children:"Krank"})]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"license",children:"Führerschein"}),s.jsx(ae,{id:"license",value:o.license,onChange:_=>m("license",_.target.value),placeholder:"z.B. B, BE"})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"qualifications",children:"Qualifikationen"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ae,{id:"qualifications",type:"text",value:d,onChange:_=>u(_.target.value),onKeyPress:x,placeholder:"z.B. VDE 0100, Erste Hilfe"}),s.jsx(ee,{type:"button",onClick:f,size:"sm",children:s.jsx(rn,{className:"h-4 w-4"})})]}),o.qualifications.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:o.qualifications.map(_=>s.jsxs(Qe,{variant:"outline",className:"text-xs",children:[s.jsx(vf,{className:"h-3 w-3 mr-1"}),_,s.jsx("button",{type:"button",onClick:()=>p(_),className:"ml-1 hover:text-red-600",children:s.jsx(Ln,{className:"h-3 w-3"})})]},_))})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"currentProject",children:"Aktuelles Projekt"}),s.jsx(ae,{id:"currentProject",value:o.currentProject,onChange:_=>m("currentProject",_.target.value)})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"hoursThisMonth",children:"Stunden (Monat)"}),s.jsx(ae,{id:"hoursThisMonth",type:"number",value:o.hoursThisMonth,onChange:_=>m("hoursThisMonth",parseInt(_.target.value))})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"vacationDays",children:"Resturlaub"}),s.jsx(ae,{id:"vacationDays",type:"number",value:o.vacationDays,onChange:_=>m("vacationDays",parseInt(_.target.value))})]})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(ee,{type:"button",variant:"outline",onClick:e,children:"Abbrechen"}),s.jsxs(ee,{type:"button",variant:"destructive",onClick:v,disabled:i.isPending,className:"flex items-center gap-2",children:[s.jsx(Fa,{className:"h-4 w-4"}),i.isPending?"Lösche...":"Löschen"]}),s.jsx(ee,{type:"submit",children:"Speichern"})]})]})]})}):null},cte=({onQuickAction:t})=>{const e=[{employee:"Keine Schulungen geplant",training:"",date:"",type:"Info"}],n=r=>{switch(r){case"Pflicht":return"bg-red-100 text-red-800";case"Weiterbildung":return"bg-blue-100 text-blue-800";case"Info":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(oS,{className:"h-5 w-5"}),"Anstehende Schulungen"]})}),s.jsx(ce,{children:s.jsx("div",{className:"space-y-3",children:e.map(r=>s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsx(Qe,{className:n(r.type),children:r.type})}),s.jsx("p",{className:"font-medium text-sm mb-1",children:r.employee}),r.training&&s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:r.training}),r.date&&s.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(Lt,{className:"h-3 w-3"}),r.date]})]},r.employee))})})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{className:"text-base",children:"Personalaktionen"})}),s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ee,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Urlaub planen"),children:[s.jsx(Lt,{className:"h-4 w-4 mr-2"}),"Urlaub planen"]}),s.jsxs(ee,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Arbeitszeiten"),children:[s.jsx(an,{className:"h-4 w-4 mr-2"}),"Arbeitszeiten"]}),s.jsxs(ee,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Schulung buchen"),children:[s.jsx(oS,{className:"h-4 w-4 mr-2"}),"Schulung buchen"]}),s.jsxs(ee,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Zertifikate"),children:[s.jsx(vf,{className:"h-4 w-4 mr-2"}),"Zertifikate"]})]})})]})]})},SI=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{className:"relative w-full overflow-auto",children:s.jsx("table",{ref:n,className:Te("w-full caption-bottom text-sm",t),...e})}));SI.displayName="Table";const kI=g.forwardRef(({className:t,...e},n)=>s.jsx("thead",{ref:n,className:Te("[&_tr]:border-b",t),...e}));kI.displayName="TableHeader";const CI=g.forwardRef(({className:t,...e},n)=>s.jsx("tbody",{ref:n,className:Te("[&_tr:last-child]:border-0",t),...e}));CI.displayName="TableBody";const dte=g.forwardRef(({className:t,...e},n)=>s.jsx("tfoot",{ref:n,className:Te("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...e}));dte.displayName="TableFooter";const qw=g.forwardRef(({className:t,...e},n)=>s.jsx("tr",{ref:n,className:Te("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...e}));qw.displayName="TableRow";const Wi=g.forwardRef(({className:t,...e},n)=>s.jsx("th",{ref:n,className:Te("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...e}));Wi.displayName="TableHead";const Hi=g.forwardRef(({className:t,...e},n)=>s.jsx("td",{ref:n,className:Te("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...e}));Hi.displayName="TableCell";const ute=g.forwardRef(({className:t,...e},n)=>s.jsx("caption",{ref:n,className:Te("mt-4 text-sm text-muted-foreground",t),...e}));ute.displayName="TableCaption";function hte(){const[t,e]=g.useState([]),[n,r]=g.useState(null),[a,i]=g.useState(0),[o,c]=g.useState(40),{data:d,isLoading:u,error:m}=o1(),f=(d==null?void 0:d.items)||[],p=async()=>{try{console.log("Fetching company working hours...");const{data:b,error:w}=await Z.from("company_settings").select("default_working_hours_start, default_working_hours_end, default_break_duration").limit(1);if(w){console.error("Error fetching working hours:",w);return}if(b){console.log("Working hours data:",b);const N=b.default_working_hours_start||"08:00",S=b.default_working_hours_end||"17:00",C=b.default_break_duration||60,[A,P]=N.split(":").map(Number),[M,z]=S.split(":").map(Number),R=A*60+P,W=(M*60+z-R-C)/60,X=W*5;console.log(`Calculated: ${W}h/Tag, ${X}h/Woche`),c(X)}}catch(b){console.error("Error calculating working hours:",b),c(40)}};g.useEffect(()=>{p();const b=localStorage.getItem("employeeWages");b&&e(JSON.parse(b))},[]),g.useEffect(()=>{localStorage.setItem("employeeWages",JSON.stringify(t))},[t]);const x=b=>{const w=t.find(N=>N.employee_id===b);return(w==null?void 0:w.hourly_wage)||0},j=b=>{r(b.id),i(x(b.id))},v=()=>{r(null),i(0)},_=b=>{const w=t.map(N=>N.employee_id===b?{...N,hourly_wage:a}:N);t.find(N=>N.employee_id===b)||w.push({employee_id:b,hourly_wage:a}),e(w),r(null),i(0),Ue.success("Stundenlohn wurde gespeichert")};return u?s.jsx(oe,{children:s.jsx(ce,{className:"p-6",children:s.jsx("div",{className:"text-center",children:"Lädt Mitarbeiterdaten..."})})}):m?s.jsx(oe,{children:s.jsx(ce,{className:"p-6",children:s.jsxs("div",{className:"text-center text-red-500",children:["Fehler beim Laden der Mitarbeiterdaten: ",m.message||"Unbekannter Fehler"]})})}):s.jsx("div",{className:"space-y-6",children:s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(lr,{className:"h-5 w-5"}),"Mitarbeiter Stundenlohn-Verwaltung (Vereinfacht)"]}),s.jsx(ds,{children:"Verwalten Sie Stundenlöhne Ihrer aktiven Mitarbeiter"})]}),s.jsxs(ce,{children:[s.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[s.jsxs("p",{className:"text-sm text-blue-800",children:["📋 ",s.jsx("strong",{children:"Arbeitszeit werden aus den Firmeneinstellungen berechnet (42.5h/Woche)"})]}),s.jsxs("p",{className:"text-sm text-orange-700 mt-1",children:["⚠️ ",s.jsx("strong",{children:"Hinweise:"})," Löhne werden temporär im Browser gespeichert"]})]}),f.length===0?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"Keine aktiven Mitarbeiter gefunden"}):s.jsxs(SI,{children:[s.jsx(kI,{children:s.jsxs(qw,{children:[s.jsxs(Wi,{children:[s.jsx(pr,{className:"h-4 w-4 inline mr-2"}),"Mitarbeiter"]}),s.jsxs(Wi,{children:[s.jsx(es,{className:"h-4 w-4 inline mr-2"}),"E-Mail"]}),s.jsxs(Wi,{children:[s.jsx(bc,{className:"h-4 w-4 inline mr-2"}),"Position"]}),s.jsx(Wi,{children:"Status"}),s.jsxs(Wi,{children:[s.jsx(lr,{className:"h-4 w-4 inline mr-2"}),"Stundenlohn"]}),s.jsx(Wi,{children:"Wochenlohn (ca.)"}),s.jsx(Wi,{children:"Aktionen"})]})}),s.jsx(CI,{children:f.map(b=>{const w=x(b.id),N=w*o,S=n===b.id;return s.jsxs(qw,{children:[s.jsx(Hi,{children:s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium",children:[b.first_name," ",b.last_name]}),b.phone&&s.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[s.jsx(Fd,{className:"h-3 w-3"}),b.phone]})]})}),s.jsx(Hi,{children:b.email}),s.jsx(Hi,{children:b.position||"-"}),s.jsx(Hi,{children:s.jsx(Qe,{variant:b.status==="Aktiv"?"default":"secondary",children:b.status})}),s.jsx(Hi,{children:S?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ae,{type:"number",step:"0.50",min:"0",value:a,onChange:C=>i(parseFloat(C.target.value)||0),className:"w-20"}),s.jsx("span",{className:"text-sm",children:"€/h"})]}):s.jsx("div",{className:"font-mono",children:w>0?`€${w.toFixed(2)}/h`:"Nicht festgelegt"})}),s.jsxs(Hi,{children:[s.jsx("div",{className:"font-mono text-green-600",children:N>0?`€${N.toFixed(2)}`:"-"}),N>0&&s.jsxs("div",{className:"text-xs text-gray-500",children:["bei ",o,"h/Woche"]})]}),s.jsx(Hi,{children:S?s.jsxs("div",{className:"flex gap-1",children:[s.jsx(ee,{size:"sm",onClick:()=>_(b.id),className:"h-8 w-8 p-0",children:s.jsx(Dh,{className:"h-3 w-3"})}),s.jsx(ee,{size:"sm",variant:"outline",onClick:v,className:"h-8 w-8 p-0",children:s.jsx(Ln,{className:"h-3 w-3"})})]}):s.jsx(ee,{size:"sm",variant:"outline",onClick:()=>j(b),className:"h-8 w-8 p-0",children:s.jsx(Tl,{className:"h-3 w-3"})})})]},b.id)})})]})]})]})})}const fte=()=>{const{toast:t}=Mt(),{user:e,session:n,inviteEmployee:r,companyId:a}=Fr(),i=ns(),[o,c]=g.useState(null),[d,u]=g.useState(!1),[m,f]=g.useState(!1),[p,x]=g.useState(!1),[j,v]=g.useState(!1),{data:_,isLoading:b,error:w}=o1(),N=(_==null?void 0:_.items)||[],S=g.useMemo(()=>N.map(W=>({id:W.id,name:W.name||`${W.first_name} ${W.last_name}`.trim()||W.email,position:W.position||"Mitarbeiter",email:W.email,phone:W.phone||"",status:W.status||"Aktiv",qualifications:Array.isArray(W.qualifications)?W.qualifications:[],license:W.license||"",currentProject:"-",hoursThisMonth:0,vacationDays:25})),[N]),C=async W=>{v(!0);try{console.log("Creating Supabase employee invitation:",W);const X=await r(W.email,{firstName:W.firstName,lastName:W.lastName,position:W.position,phone:W.phone,license:W.license,qualifications:W.qualifications});if(!X.success){console.error("Supabase invitation error:",X.error),Ue.error(`Fehler beim Senden der Einladung: ${X.error}`);return}Ue.success(`Mitarbeiter ${W.firstName} ${W.lastName} wurde erfolgreich eingeladen! 
        Eine Einladungs-E-Mail wurde an ${W.email} gesendet.`),i.invalidateQueries({queryKey:Ht.employees}),x(!1)}catch(X){console.error("Unexpected error:",X),Ue.error("Ein unerwarteter Fehler ist aufgetreten")}finally{v(!1)}},A=W=>{c(W),u(!0)},P=W=>{c(W),f(!0)},M=async W=>{var X;if(o)try{const ue=((X=W.name)==null?void 0:X.split(" "))||[],de=ue[0]||"",G=ue.slice(1).join(" ")||"",{error:I}=await Z.from("employees").update({first_name:de,last_name:G,position:W.position,phone:W.phone,status:W.status,license:W.license,qualifications:W.qualifications?JSON.stringify(W.qualifications):"[]"}).eq("id",o.id);if(I){console.error("Error updating employee:",I),Ue.error(`Fehler beim Aktualisieren: ${I.message}`);return}o.id&&de&&G&&await Z.from("profiles").update({first_name:de,last_name:G}).eq("id",o.id);const V={...o,...W};setEmployees($=>$.map(F=>F.id===o.id?V:F)),t({title:"Erfolg",description:"Mitarbeiter wurde erfolgreich aktualisiert."}),f(!1),c(null)}catch(ue){console.error("Error saving employee:",ue),Ue.error("Fehler beim Speichern der Mitarbeiteränderungen")}},z=W=>{t({title:"Info",description:`${W} wird geöffnet...`})},R=S.filter(W=>W.status==="Aktiv").length,D=S.filter(W=>W.status==="Urlaub").length,B=S.reduce((W,X)=>W+X.hoursThisMonth,0);return s.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[s.jsx("div",{className:"flex items-center justify-between mb-8",children:s.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Personalverwaltung"})}),s.jsxs(Is,{defaultValue:"overview",className:"w-full",children:[s.jsxs(js,{className:"grid w-full grid-cols-2",children:[s.jsx(Je,{value:"overview",children:"Mitarbeiterübersicht"}),s.jsx(Je,{value:"wages",children:"Stundenlohn-Verwaltung"})]}),s.jsxs(et,{value:"overview",className:"space-y-6",children:[s.jsx("div",{className:"flex justify-end",children:s.jsxs(ee,{onClick:()=>x(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Mitarbeiter hinzufügen"]})}),s.jsx(ete,{totalEmployees:S.length,activeEmployees:R,onVacationEmployees:D,totalHours:B}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Mitarbeiterliste"}),b?s.jsx("div",{className:"text-center p-6",children:s.jsx("p",{className:"text-gray-500",children:"Mitarbeiter werden geladen..."})}):S.length===0?s.jsxs("div",{className:"text-center p-6",children:[s.jsx("p",{className:"text-gray-500",children:"Noch keine Mitarbeiter vorhanden."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:'Klicken Sie auf "Mitarbeiter hinzufügen" um den ersten Mitarbeiter einzuladen.'})]}):S.map(W=>s.jsx(ate,{employee:W,onShowDetails:A,onEdit:P},W.id))]}),s.jsx(cte,{onQuickAction:z})]})]}),s.jsx(et,{value:"wages",children:s.jsx(hte,{})})]}),s.jsx(ite,{isOpen:p,onClose:()=>x(!1),onSubmit:C,isLoading:j}),s.jsx(ote,{isOpen:d,onClose:()=>u(!1),employee:o}),s.jsx(lte,{isOpen:m,onClose:()=>f(!1),employee:o,onSave:M})]})},mte=({isOpen:t,onClose:e,selectedMaterial:n,onAssignmentComplete:r})=>{const{user:a,companyId:i}=Fr(),[o,c]=g.useState("assign"),[d,u]=g.useState([]),[m,f]=g.useState([]),[p,x]=g.useState([]),[j,v]=g.useState([]),[_,b]=g.useState({material_id:(n==null?void 0:n.id)||"",employee_id:"",project_id:"",assigned_quantity:0,notes:""}),[w,N]=g.useState(!1);g.useEffect(()=>{t&&i&&S()},[t,i]),g.useEffect(()=>{n&&b(D=>({...D,material_id:n.id}))},[n]);const S=async()=>{N(!0);try{await Promise.all([C(),A(),P(),M()])}catch(D){console.error("Error fetching data:",D),Ue.error("Fehler beim Laden der Daten")}finally{N(!1)}},C=async()=>{const{data:D,error:B}=await Z.from("materials").select("id, name, current_stock, unit, category").eq("company_id",i).eq("is_active",!0).order("name");if(B){console.error("Error fetching materials:",B);return}u(D||[])},A=async()=>{const{data:D,error:B}=await Z.from("employees").select("id, first_name, last_name, email").eq("company_id",i).eq("status","active").order("first_name");if(B){console.error("Error fetching employees:",B);return}f(D||[])},P=async()=>{const{data:D,error:B}=await Z.from("projects").select("id, name").eq("company_id",i).order("name");if(B){console.error("Error fetching projects:",B);return}x(D||[])},M=async()=>{const{data:D,error:B}=await Z.from("project_material_assignments").select(`
        id,
        assigned_quantity,
        used_quantity,
        assigned_at,
        notes,
        materials:material_id (name, unit),
        employees:assigned_by (first_name, last_name),
        projects:project_id (name)
      `).order("assigned_at",{ascending:!1}).limit(20);if(B){console.error("Error fetching assignments:",B);return}const W=(D==null?void 0:D.map(X=>{var ue,de,G,I,V;return{...X,material_name:((ue=X.materials)==null?void 0:ue.name)||"Unbekannt",employee_name:`${((de=X.employees)==null?void 0:de.first_name)||""} ${((G=X.employees)==null?void 0:G.last_name)||""}`.trim()||"Unbekannt",project_name:((I=X.projects)==null?void 0:I.name)||"Unbekannt",unit:((V=X.materials)==null?void 0:V.unit)||"Stk"}}))||[];v(W)},z=async()=>{var B;if(!_.material_id||!_.employee_id||!_.project_id||!_.assigned_quantity){Ue.error("Bitte füllen Sie alle Pflichtfelder aus");return}const D=d.find(W=>W.id===_.material_id);if(D&&_.assigned_quantity>D.current_stock){Ue.error(`Nicht genügend Bestand verfügbar. Verfügbar: ${D.current_stock} ${D.unit}`);return}try{N(!0);const{error:W}=await Z.from("project_material_assignments").upsert({project_id:_.project_id,material_id:_.material_id,assigned_quantity:_.assigned_quantity,assigned_by:a==null?void 0:a.id,notes:_.notes});if(W)throw W;const{error:X}=await Z.from("material_stock_movements").insert({material_id:_.material_id,movement_type:"out",reference_type:"assignment",reference_id:_.project_id,quantity:-_.assigned_quantity,employee_id:_.employee_id,project_id:_.project_id,reason:`Material zugewiesen an ${(B=m.find(ue=>ue.id===_.employee_id))==null?void 0:B.first_name}`,created_by:a==null?void 0:a.id});if(X)throw X;Ue.success("Material wurde erfolgreich zugewiesen"),b({material_id:(n==null?void 0:n.id)||"",employee_id:"",project_id:"",assigned_quantity:0,notes:""}),await M(),r&&r()}catch(W){console.error("Error creating assignment:",W),Ue.error("Fehler beim Zuweisen des Materials")}finally{N(!1)}},R=d.find(D=>D.id===_.material_id);return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:[s.jsxs(Jt,{children:[s.jsxs(en,{className:"flex items-center gap-2",children:[s.jsx(qa,{className:"h-5 w-5"}),"Material-Zuweisung"]}),s.jsx($n,{children:"Weisen Sie Material einem Mitarbeiter für ein Projekt zu"})]}),s.jsxs("div",{className:"flex gap-2 mb-4",children:[s.jsx(ee,{variant:o==="assign"?"default":"outline",onClick:()=>c("assign"),children:"Material zuweisen"}),s.jsx(ee,{variant:o==="view"?"default":"outline",onClick:()=>c("view"),children:"Zuweisungen anzeigen"})]}),o==="assign"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Material *"}),s.jsxs(mt,{value:_.material_id,onValueChange:D=>b(B=>({...B,material_id:D})),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Material wählen"})}),s.jsx(ft,{children:d.map(D=>s.jsx(ye,{value:D.id,children:s.jsxs("div",{className:"flex justify-between items-center w-full",children:[s.jsx("span",{children:D.name}),s.jsxs(Qe,{variant:"outline",className:"ml-2",children:[D.current_stock," ",D.unit]})]})},D.id))})]}),R&&s.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded-lg",children:[s.jsxs("p",{className:"text-sm",children:[s.jsx("strong",{children:"Verfügbar:"})," ",R.current_stock," ",R.unit]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"Kategorie:"})," ",R.category]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mitarbeiter *"}),s.jsxs(mt,{value:_.employee_id,onValueChange:D=>b(B=>({...B,employee_id:D})),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Mitarbeiter wählen"})}),s.jsx(ft,{children:m.map(D=>s.jsxs(ye,{value:D.id,children:[D.first_name," ",D.last_name]},D.id))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Projekt *"}),s.jsxs(mt,{value:_.project_id,onValueChange:D=>b(B=>({...B,project_id:D})),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Projekt wählen"})}),s.jsx(ft,{children:p.map(D=>s.jsx(ye,{value:D.id,children:D.name},D.id))})]})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Menge * ",R&&`(${R.unit})`]}),s.jsx(ae,{type:"number",step:"0.1",min:"0",max:(R==null?void 0:R.current_stock)||999999,value:_.assigned_quantity,onChange:D=>b(B=>({...B,assigned_quantity:parseFloat(D.target.value)||0})),placeholder:"Zuzuweisende Menge"}),R&&_.assigned_quantity>R.current_stock&&s.jsxs("div",{className:"flex items-center gap-2 mt-1 text-red-600",children:[s.jsx(us,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:"Nicht genügend Bestand verfügbar!"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notizen (optional)"}),s.jsx(cn,{value:_.notes,onChange:D=>b(B=>({...B,notes:D.target.value})),placeholder:"Zusätzliche Informationen zur Zuweisung...",rows:3})]})]}),o==="view"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Aktuelle Zuweisungen"}),s.jsx("div",{className:"grid gap-4 max-h-96 overflow-y-auto",children:j.map(D=>s.jsx(oe,{children:s.jsxs(ce,{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium",children:D.material_name}),s.jsxs("p",{className:"text-sm text-gray-600",children:[D.employee_name," • ",D.project_name]})]}),s.jsxs(Qe,{variant:"outline",children:[D.used_quantity," / ",D.assigned_quantity," ",D.unit]})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Zugewiesen: ",new Date(D.assigned_at).toLocaleDateString("de-DE")]}),D.notes&&s.jsx("div",{className:"text-sm text-gray-600 mt-2 p-2 bg-gray-50 rounded",children:D.notes})]})},D.id))})]}),s.jsxs(ed,{children:[s.jsx(ee,{variant:"outline",onClick:e,children:"Schließen"}),o==="assign"&&s.jsxs(ee,{onClick:z,disabled:w||!_.material_id||!_.employee_id||!_.project_id||!_.assigned_quantity||R&&_.assigned_quantity>R.current_stock,children:[s.jsx(yf,{className:"h-4 w-4 mr-2"}),"Material zuweisen"]})]})]})})},Qm=["Fliesen & Keramik","Sanitär","Heizung","Elektro","Bauchemie","Werkzeuge","Befestigung","Dichtung & Abdichtung","Sonstiges"],KC=["Stück","m²","m","kg","l","Paket","Set","Rolle"],pte=()=>{const{toast:t}=Mt(),[e,n]=g.useState([]),[r,a]=g.useState([]),[i,o]=g.useState(""),[c,d]=g.useState("all"),[u,m]=g.useState(!1),[f,p]=g.useState(!1),[x,j]=g.useState(null),[v,_]=g.useState({name:"",category:"",supplier:"",unit:"Stück",currentPrice:0,notes:""});g.useEffect(()=>{b()},[]),g.useEffect(()=>{let D=e;i&&(D=D.filter(B=>B.name.toLowerCase().includes(i.toLowerCase())||B.supplier.toLowerCase().includes(i.toLowerCase()))),c&&c!=="all"&&(D=D.filter(B=>B.category===c)),a(D)},[e,i,c]);const b=()=>{const D=[{id:"1",name:"Bodenfliese 30x30cm Grau",category:"Fliesen & Keramik",supplier:"Fliesenmarkt GmbH",unit:"m²",currentPrice:24.99,previousPrice:22.5,lastUpdated:new Date(Date.now()-6048e5).toISOString(),isActive:!0,notes:"Gute Qualität, schnelle Lieferung"},{id:"2",name:"Fliesenkleber C1 25kg",category:"Bauchemie",supplier:"Bauchemie Express",unit:"Paket",currentPrice:12.5,previousPrice:13.2,lastUpdated:new Date(Date.now()-2592e5).toISOString(),isActive:!0},{id:"3",name:"Fugenmasse weiß 5kg",category:"Bauchemie",supplier:"Bauchemie Express",unit:"Paket",currentPrice:8.75,previousPrice:8.75,lastUpdated:new Date(Date.now()-12096e5).toISOString(),isActive:!0},{id:"4",name:"Mischbatterie Küche Edelstahl",category:"Sanitär",supplier:"Sanitär Partner",unit:"Stück",currentPrice:89.99,previousPrice:85,lastUpdated:new Date(Date.now()-864e5).toISOString(),isActive:!0},{id:"5",name:'Heizkörperventil 1/2"',category:"Heizung",supplier:"Heizung & Klima AG",unit:"Stück",currentPrice:15.5,previousPrice:16.2,lastUpdated:new Date(Date.now()-432e6).toISOString(),isActive:!0}];n(D)},w=()=>{const D={id:Date.now().toString(),name:v.name,category:v.category,supplier:v.supplier,unit:v.unit,currentPrice:v.currentPrice,previousPrice:v.currentPrice,lastUpdated:new Date().toISOString(),isActive:!0,notes:v.notes};n(B=>[...B,D]),A(),m(!1),t({title:"Material hinzugefügt",description:`${v.name} wurde zur Preisliste hinzugefügt.`})},N=D=>{j(D),_({name:D.name,category:D.category,supplier:D.supplier,unit:D.unit,currentPrice:D.currentPrice,notes:D.notes||""}),p(!0)},S=()=>{x&&(n(D=>D.map(B=>B.id===x.id?{...B,name:v.name,category:v.category,supplier:v.supplier,unit:v.unit,previousPrice:B.currentPrice,currentPrice:v.currentPrice,lastUpdated:new Date().toISOString(),notes:v.notes}:B)),A(),p(!1),j(null),t({title:"Material aktualisiert",description:`${v.name} wurde erfolgreich aktualisiert.`}))},C=D=>{n(B=>B.filter(W=>W.id!==D)),t({title:"Material entfernt",description:"Das Material wurde aus der Preisliste entfernt."})},A=()=>{_({name:"",category:"",supplier:"",unit:"Stück",currentPrice:0,notes:""})},P=D=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(D),M=D=>new Date(D).toLocaleDateString("de-DE"),z=(D,B)=>D>B?s.jsx(Eo,{className:"h-4 w-4 text-red-500",title:"Preis gestiegen"}):D<B?s.jsx(Yb,{className:"h-4 w-4 text-green-500",title:"Preis gefallen"}):null,R=(D,B)=>B===0?0:(D-B)/B*100;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(qa,{className:"h-6 w-6 text-blue-600"}),s.jsx("h2",{className:"text-2xl font-bold",children:"Materialpreise"})]}),s.jsxs(ee,{onClick:()=>m(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(oe,{children:s.jsxs(ce,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold",children:e.length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Materialien gesamt"})]})}),s.jsx(oe,{children:s.jsxs(ce,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(D=>D.currentPrice<D.previousPrice).length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Preise gefallen"})]})}),s.jsx(oe,{children:s.jsxs(ce,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.filter(D=>D.currentPrice>D.previousPrice).length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Preise gestiegen"})]})}),s.jsx(oe,{children:s.jsxs(ce,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold",children:Qm.length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Kategorien"})]})})]}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(Bd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx(ae,{placeholder:"Material oder Lieferant suchen...",value:i,onChange:D=>o(D.target.value),className:"pl-10"})]})}),s.jsx("div",{className:"w-full md:w-64",children:s.jsxs(mt,{value:c,onValueChange:d,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Kategorie wählen"})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"all",children:"Alle Kategorien"}),Qm.map(D=>s.jsx(ye,{value:D,children:D},D))]})]})}),(i||c&&c!=="all")&&s.jsx(ee,{variant:"outline",onClick:()=>{o(""),d("all")},children:"Filter zurücksetzen"})]})})}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{children:["Materialpreise (",r.length,")"]})}),s.jsx(ce,{children:s.jsx("div",{className:"space-y-4",children:r.length===0?s.jsx("div",{className:"text-center py-8 text-gray-500",children:i||c?"Keine Materialien gefunden.":"Noch keine Materialien vorhanden."}):r.map(D=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h3",{className:"font-semibold text-lg",children:D.name}),s.jsx(Qe,{variant:"outline",children:D.category}),z(D.currentPrice,D.previousPrice)]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Lieferant:"})," ",D.supplier]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Einheit:"})," ",D.unit]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Letzte Aktualisierung:"})," ",M(D.lastUpdated)]})]}),D.notes&&s.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Notizen:"})," ",D.notes]})]}),s.jsxs("div",{className:"text-right ml-4",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:P(D.currentPrice)}),s.jsxs("div",{className:"text-sm text-gray-500",children:["pro ",D.unit]}),D.previousPrice!==D.currentPrice&&s.jsxs("div",{className:`text-sm ${D.currentPrice>D.previousPrice?"text-red-600":"text-green-600"}`,children:[D.currentPrice>D.previousPrice?"+":"",R(D.currentPrice,D.previousPrice).toFixed(1),"%",s.jsxs("div",{className:"text-xs text-gray-500",children:["vorher: ",P(D.previousPrice)]})]}),s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsx(ee,{variant:"outline",size:"sm",onClick:()=>N(D),children:s.jsx(Tl,{className:"h-4 w-4"})}),s.jsx(ee,{variant:"outline",size:"sm",onClick:()=>C(D.id),className:"text-red-600 hover:text-red-700",children:s.jsx(Fa,{className:"h-4 w-4"})})]})]})]})},D.id))})})]}),s.jsx(Kt,{open:u,onOpenChange:m,children:s.jsxs(Wt,{children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Neues Material hinzufügen"}),s.jsx($n,{children:"Fügen Sie ein neues Material zur Preisliste hinzu."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"name",children:"Materialname *"}),s.jsx(ae,{id:"name",value:v.name,onChange:D=>_(B=>({...B,name:D.target.value})),placeholder:"z.B. Bodenfliese 30x30cm Grau",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"category",children:"Kategorie *"}),s.jsxs(mt,{value:v.category,onValueChange:D=>_(B=>({...B,category:D})),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Kategorie wählen"})}),s.jsx(ft,{children:Qm.map(D=>s.jsx(ye,{value:D,children:D},D))})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"unit",children:"Einheit *"}),s.jsxs(mt,{value:v.unit,onValueChange:D=>_(B=>({...B,unit:D})),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsx(ft,{children:KC.map(D=>s.jsx(ye,{value:D,children:D},D))})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"supplier",children:"Lieferant *"}),s.jsx(ae,{id:"supplier",value:v.supplier,onChange:D=>_(B=>({...B,supplier:D.target.value})),placeholder:"z.B. Baumarkt GmbH",required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"price",children:"Preis pro Einheit (€) *"}),s.jsx(ae,{id:"price",type:"number",step:"0.01",min:"0",value:v.currentPrice,onChange:D=>_(B=>({...B,currentPrice:parseFloat(D.target.value)||0})),required:!0})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"notes",children:"Notizen"}),s.jsx(ae,{id:"notes",value:v.notes,onChange:D=>_(B=>({...B,notes:D.target.value})),placeholder:"Zusätzliche Informationen (optional)"})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(ee,{variant:"outline",onClick:()=>{A(),m(!1)},children:"Abbrechen"}),s.jsx(ee,{onClick:w,disabled:!v.name||!v.category||!v.supplier,children:"Hinzufügen"})]})]})}),s.jsx(Kt,{open:f,onOpenChange:p,children:s.jsxs(Wt,{children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Material bearbeiten"}),s.jsx($n,{children:"Bearbeiten Sie die Informationen für das Material."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"edit-name",children:"Materialname *"}),s.jsx(ae,{id:"edit-name",value:v.name,onChange:D=>_(B=>({...B,name:D.target.value})),required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"edit-category",children:"Kategorie *"}),s.jsxs(mt,{value:v.category,onValueChange:D=>_(B=>({...B,category:D})),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsx(ft,{children:Qm.map(D=>s.jsx(ye,{value:D,children:D},D))})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"edit-unit",children:"Einheit *"}),s.jsxs(mt,{value:v.unit,onValueChange:D=>_(B=>({...B,unit:D})),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsx(ft,{children:KC.map(D=>s.jsx(ye,{value:D,children:D},D))})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"edit-supplier",children:"Lieferant *"}),s.jsx(ae,{id:"edit-supplier",value:v.supplier,onChange:D=>_(B=>({...B,supplier:D.target.value})),required:!0})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"edit-price",children:"Neuer Preis pro Einheit (€) *"}),s.jsx(ae,{id:"edit-price",type:"number",step:"0.01",min:"0",value:v.currentPrice,onChange:D=>_(B=>({...B,currentPrice:parseFloat(D.target.value)||0})),required:!0}),x&&s.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Aktueller Preis: ",P(x.currentPrice)]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"edit-notes",children:"Notizen"}),s.jsx(ae,{id:"edit-notes",value:v.notes,onChange:D=>_(B=>({...B,notes:D.target.value})),placeholder:"Zusätzliche Informationen (optional)"})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(ee,{variant:"outline",onClick:()=>{A(),p(!1),j(null)},children:"Abbrechen"}),s.jsx(ee,{onClick:S,disabled:!v.name||!v.category||!v.supplier,children:"Aktualisieren"})]})]})})]})},gte=()=>{const{user:t,companyId:e}=Fr(),[n,r]=g.useState("inventory"),[a,i]=g.useState([]),[o,c]=g.useState([]),[d,u]=g.useState([]),[m,f]=g.useState([]),[p,x]=g.useState([]),[j,v]=g.useState(!1),[_,b]=g.useState(""),[w,N]=g.useState(!1),[S,C]=g.useState(!1),[A,P]=g.useState(!1);g.useState(!1);const[M,z]=g.useState(!1),[R,D]=g.useState(null),[B,W]=g.useState({name:"",description:"",category:"",unit:"Stk",current_stock:0,min_stock:0,max_stock:0,unit_price:0,supplier_id:"",storage_location:""}),[X,ue]=g.useState({material_id:"",employee_id:"",project_id:"",quantity_used:0,notes:""});g.useEffect(()=>{e&&de()},[e]);const de=async()=>{v(!0);try{await Promise.all([G(),I(),V(),$(),F()])}catch(se){console.error("Error fetching data:",se),Ue.error("Fehler beim Laden der Daten")}finally{v(!1)}},G=async()=>{const{data:se,error:we}=await Z.from("materials").select(`
        *,
        suppliers:supplier_id (
          id,
          name
        )
      `).eq("company_id",e).eq("is_active",!0).order("name");if(we){console.error("Error fetching materials:",we);return}const Se=(se==null?void 0:se.map(qe=>{var Ye;return{...qe,supplier_name:((Ye=qe.suppliers)==null?void 0:Ye.name)||"Kein Lieferant"}}))||[];i(Se)},I=async()=>{const{data:se,error:we}=await Z.from("suppliers").select("*").eq("company_id",e).eq("is_active",!0).order("name");if(we){console.error("Error fetching suppliers:",we);return}c(se||[])},V=async()=>{const{data:se,error:we}=await Z.from("projects").select("id, name, status").eq("company_id",e).order("name");if(we){console.error("Error fetching projects:",we);return}u(se||[])},$=async()=>{const{data:se,error:we}=await Z.from("employees").select("id, first_name, last_name, email").eq("company_id",e).eq("status","active").order("first_name");if(we){console.error("Error fetching employees:",we);return}f(se||[])},F=async()=>{const{data:se,error:we}=await Z.from("employee_material_usage").select(`
        *,
        materials:material_id (name, unit),
        employees:employee_id (first_name, last_name),
        projects:project_id (name)
      `).order("created_at",{ascending:!1}).limit(50);if(we){console.error("Error fetching material usage:",we);return}const Se=(se==null?void 0:se.map(qe=>{var Ye,Et,be,Oe,Fe;return{...qe,material_name:((Ye=qe.materials)==null?void 0:Ye.name)||"Unbekannt",employee_name:`${(Et=qe.employees)==null?void 0:Et.first_name} ${(be=qe.employees)==null?void 0:be.last_name}`,project_name:((Oe=qe.projects)==null?void 0:Oe.name)||"Unbekannt",unit:((Fe=qe.materials)==null?void 0:Fe.unit)||"Stk"}}))||[];x(Se)},O=async()=>{try{const{error:se}=await Z.from("materials").insert({...B,company_id:e,created_by:t==null?void 0:t.id});if(se)throw se;Ue.success("Material wurde erfolgreich erstellt"),N(!1),J(),G()}catch(se){console.error("Error creating material:",se),Ue.error("Fehler beim Erstellen des Materials")}},K=async()=>{if(R)try{const{error:se}=await Z.from("materials").update({...B,updated_at:new Date().toISOString(),updated_by:t==null?void 0:t.id}).eq("id",R.id);if(se)throw se;Ue.success("Material wurde erfolgreich aktualisiert"),C(!1),D(null),J(),G()}catch(se){console.error("Error updating material:",se),Ue.error("Fehler beim Aktualisieren des Materials")}},U=async se=>{try{const{error:we}=await Z.from("materials").update({is_active:!1}).eq("id",se);if(we)throw we;Ue.success("Material wurde erfolgreich gelöscht"),G()}catch(we){console.error("Error deleting material:",we),Ue.error("Fehler beim Löschen des Materials")}},te=async()=>{try{const{error:se}=await Z.from("employee_material_usage").insert({...X,usage_date:new Date().toISOString().split("T")[0],created_by:t==null?void 0:t.id});if(se)throw se;Ue.success("Materialverbrauch wurde erfolgreich erfasst"),P(!1),q(),F(),G()}catch(se){console.error("Error recording material usage:",se),Ue.error("Fehler beim Erfassen des Materialverbrauchs")}},J=()=>{W({name:"",description:"",category:"",unit:"Stk",current_stock:0,min_stock:0,max_stock:0,unit_price:0,supplier_id:"",storage_location:""})},q=()=>{ue({material_id:"",employee_id:"",project_id:"",quantity_used:0,notes:""})},ne=se=>{D(se),W({name:se.name,description:se.description||"",category:se.category,unit:se.unit,current_stock:se.current_stock,min_stock:se.min_stock,max_stock:se.max_stock,unit_price:se.unit_price,supplier_id:se.supplier_id||"",storage_location:se.storage_location||""}),C(!0)},pe=(se,we)=>se<=we*.5?"bg-red-100 text-red-800":se<=we?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",Q=(se,we)=>se<=we*.5?"Kritisch":se<=we?"Niedrig":"Verfügbar",re=(se,we)=>Math.min(se/we*100,100),me=a.filter(se=>se.name.toLowerCase().includes(_.toLowerCase())||se.category.toLowerCase().includes(_.toLowerCase())),he=a.filter(se=>se.current_stock<=se.min_stock),ge=a.reduce((se,we)=>se+we.current_stock*we.unit_price,0);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-red-600 bg-clip-text text-transparent flex items-center gap-3",children:[s.jsx(qa,{className:"h-8 w-8 text-red-600"}),"Materialwirtschaft"]}),s.jsx("p",{className:"text-gray-600",children:"Vollständige Material- und Lagerverwaltung"})]}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(ee,{onClick:()=>N(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Materialien"}),s.jsx("p",{className:"text-2xl font-bold",children:a.length})]}),s.jsx(qa,{className:"h-8 w-8 text-blue-600"})]})})}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Lagerwert"}),s.jsxs("p",{className:"text-2xl font-bold",children:["€",ge.toLocaleString("de-DE",{maximumFractionDigits:0})]})]}),s.jsx(Eo,{className:"h-8 w-8 text-green-600"})]})})}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Niedrige Bestände"}),s.jsx("p",{className:"text-2xl font-bold",children:he.length})]}),s.jsx(us,{className:"h-8 w-8 text-yellow-600"})]})})}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Verbrauch (30 Tage)"}),s.jsx("p",{className:"text-2xl font-bold",children:p.length})]}),s.jsx(sh,{className:"h-8 w-8 text-purple-600"})]})})})]}),s.jsxs(Is,{value:n,onValueChange:r,className:"w-full",children:[s.jsxs(js,{className:"grid w-full grid-cols-5",children:[s.jsx(Je,{value:"inventory",children:"Lagerbestand"}),s.jsx(Je,{value:"usage",children:"Verbrauch"}),s.jsx(Je,{value:"assignments",children:"Zuweisungen"}),s.jsx(Je,{value:"prices",children:"Preise"}),s.jsx(Je,{value:"analytics",children:"Analysen"})]}),s.jsxs(et,{value:"inventory",className:"space-y-6 min-h-[600px]",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Bd,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(ae,{placeholder:"Material suchen...",className:"pl-10 w-64",value:_,onChange:se=>b(se.target.value)})]}),s.jsxs(ee,{variant:"outline",onClick:()=>P(!0),children:[s.jsx(GF,{className:"h-4 w-4 mr-2"}),"Verbrauch erfassen"]})]})}),s.jsx("div",{className:"grid gap-4",children:me.map(se=>s.jsx(oe,{className:"hover:shadow-lg transition-shadow",children:s.jsxs(ce,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h4",{className:"text-lg font-semibold",children:se.name}),s.jsx(Qe,{className:pe(se.current_stock,se.min_stock),children:Q(se.current_stock,se.min_stock)})]}),s.jsx("p",{className:"text-gray-600 mb-2",children:se.category}),s.jsx("p",{className:"text-sm text-gray-500",children:se.description})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-lg font-bold text-blue-600",children:["€",se.unit_price.toFixed(2),"/",se.unit]}),s.jsx("p",{className:"text-sm text-gray-500",children:se.supplier_name})]})]}),s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{children:"Lagerbestand"}),s.jsxs("span",{children:[se.current_stock," ",se.unit," / ",se.max_stock," ",se.unit]})]}),s.jsx(Pd,{value:re(se.current_stock,se.max_stock),className:"h-2"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Mindestbestand:"}),s.jsxs("p",{children:[se.min_stock," ",se.unit]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Lagerwert:"}),s.jsxs("p",{children:["€",(se.current_stock*se.unit_price).toFixed(2)]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Lagerort:"}),s.jsx("p",{children:se.storage_location||"Nicht angegeben"})]})]})]}),se.current_stock<=se.min_stock&&s.jsx("div",{className:"mb-4 p-2 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-yellow-800",children:[s.jsx(us,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Bestand unter Mindestmenge! Nachbestellung empfohlen."})]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ee,{size:"sm",variant:"outline",onClick:()=>ne(se),children:[s.jsx(Tl,{className:"h-4 w-4 mr-1"}),"Bearbeiten"]}),s.jsxs(ee,{size:"sm",variant:"outline",onClick:()=>{D(se),z(!0)},children:[s.jsx(yf,{className:"h-4 w-4 mr-1"}),"Zuweisen"]}),s.jsxs(ee,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",onClick:()=>U(se.id),children:[s.jsx(Fa,{className:"h-4 w-4 mr-1"}),"Löschen"]})]})]})},se.id))})]}),s.jsx(et,{value:"usage",className:"space-y-6 min-h-[600px]",children:s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsx(Ce,{children:"Materialverbrauch"}),s.jsx(ds,{children:"Übersicht über den Materialverbrauch der letzten 50 Einträge"})]}),s.jsx(ce,{children:s.jsx("div",{className:"space-y-4",children:p.map(se=>s.jsxs("div",{className:"flex justify-between items-center p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium",children:se.material_name}),s.jsxs("p",{className:"text-sm text-gray-600",children:[se.employee_name," • ",se.project_name]}),s.jsx("p",{className:"text-xs text-gray-500",children:new Date(se.usage_date).toLocaleDateString("de-DE")})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-bold",children:[se.quantity_used," ",se.unit]}),se.notes&&s.jsx("p",{className:"text-sm text-gray-600",children:se.notes})]})]},se.id))})})]})}),s.jsx(et,{value:"assignments",className:"space-y-6 min-h-[600px]",children:s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsx(Ce,{children:"Projekt-Zuweisungen"}),s.jsx(ds,{children:"Materialzuweisungen zu Projekten verwalten"})]}),s.jsx(ce,{children:s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(la,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Projekt-Zuweisungen werden hier angezeigt"}),s.jsx("p",{className:"text-sm",children:"Funktion wird in Kürze erweitert"})]})})]})}),s.jsx(et,{value:"analytics",className:"space-y-6 min-h-[600px]",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Bestandsanalyse"})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Materialien mit niedrigem Bestand:"}),s.jsx("span",{className:"font-bold text-red-600",children:he.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Durchschnittlicher Lagerwert pro Material:"}),s.jsxs("span",{className:"font-bold",children:["€",a.length>0?(ge/a.length).toFixed(2):0]})]})]})})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Verbrauchsanalyse"})}),s.jsx(ce,{children:s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(sh,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Detaillierte Verbrauchsanalysen"}),s.jsx("p",{className:"text-sm",children:"Werden in Kürze erweitert"})]})})]})]})}),s.jsx(et,{value:"prices",className:"space-y-6 min-h-[600px]",children:s.jsx(pte,{})})]}),s.jsx(Kt,{open:w,onOpenChange:N,children:s.jsxs(Wt,{className:"max-w-2xl",children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Material hinzufügen"}),s.jsx($n,{children:"Fügen Sie ein neues Material zu Ihrem Lager hinzu"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Name *"}),s.jsx(ae,{value:B.name,onChange:se=>W(we=>({...we,name:se.target.value})),placeholder:"Material-Name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kategorie"}),s.jsxs(mt,{value:B.category,onValueChange:se=>W(we=>({...we,category:se})),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Kategorie wählen"})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Kabel & Leitungen",children:"Kabel & Leitungen"}),s.jsx(ye,{value:"Installationsmaterial",children:"Installationsmaterial"}),s.jsx(ye,{value:"Schaltgeräte",children:"Schaltgeräte"}),s.jsx(ye,{value:"Werkzeuge",children:"Werkzeuge"}),s.jsx(ye,{value:"Sonstiges",children:"Sonstiges"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Einheit *"}),s.jsxs(mt,{value:B.unit,onValueChange:se=>W(we=>({...we,unit:se})),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Einheit"})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Stk",children:"Stück"}),s.jsx(ye,{value:"m",children:"Meter"}),s.jsx(ye,{value:"kg",children:"Kilogramm"}),s.jsx(ye,{value:"l",children:"Liter"}),s.jsx(ye,{value:"m²",children:"Quadratmeter"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Preis pro Einheit (€)"}),s.jsx(ae,{type:"number",step:"0.01",value:B.unit_price,onChange:se=>W(we=>({...we,unit_price:parseFloat(se.target.value)||0}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Aktueller Bestand"}),s.jsx(ae,{type:"number",value:B.current_stock,onChange:se=>W(we=>({...we,current_stock:parseFloat(se.target.value)||0}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mindestbestand"}),s.jsx(ae,{type:"number",value:B.min_stock,onChange:se=>W(we=>({...we,min_stock:parseFloat(se.target.value)||0}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Maximalbestand"}),s.jsx(ae,{type:"number",value:B.max_stock,onChange:se=>W(we=>({...we,max_stock:parseFloat(se.target.value)||0}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Lieferant"}),s.jsxs(mt,{value:B.supplier_id,onValueChange:se=>W(we=>({...we,supplier_id:se})),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Lieferant wählen"})}),s.jsx(ft,{children:o.map(se=>s.jsx(ye,{value:se.id,children:se.name},se.id))})]})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Beschreibung"}),s.jsx(cn,{value:B.description,onChange:se=>W(we=>({...we,description:se.target.value})),placeholder:"Beschreibung des Materials...",rows:3})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Lagerort"}),s.jsx(ae,{value:B.storage_location,onChange:se=>W(we=>({...we,storage_location:se.target.value})),placeholder:"z.B. Lager A, Regal 1"})]})]}),s.jsxs(ed,{children:[s.jsx(ee,{variant:"outline",onClick:()=>N(!1),children:"Abbrechen"}),s.jsx(ee,{onClick:O,disabled:!B.name,children:"Material erstellen"})]})]})}),s.jsx(Kt,{open:S,onOpenChange:C,children:s.jsxs(Wt,{className:"max-w-2xl",children:[s.jsx(Jt,{children:s.jsx(en,{children:"Material bearbeiten"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Name *"}),s.jsx(ae,{value:B.name,onChange:se=>W(we=>({...we,name:se.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Aktueller Bestand"}),s.jsx(ae,{type:"number",value:B.current_stock,onChange:se=>W(we=>({...we,current_stock:parseFloat(se.target.value)||0}))})]})]}),s.jsxs(ed,{children:[s.jsx(ee,{variant:"outline",onClick:()=>C(!1),children:"Abbrechen"}),s.jsx(ee,{onClick:K,children:"Aktualisieren"})]})]})}),s.jsx(Kt,{open:A,onOpenChange:P,children:s.jsxs(Wt,{children:[s.jsxs(Jt,{children:[s.jsx(en,{children:"Materialverbrauch erfassen"}),s.jsx($n,{children:"Erfassen Sie den Verbrauch von Material durch einen Mitarbeiter"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Material"}),s.jsxs(mt,{value:X.material_id,onValueChange:se=>ue(we=>({...we,material_id:se})),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Material wählen"})}),s.jsx(ft,{children:a.map(se=>s.jsxs(ye,{value:se.id,children:[se.name," (",se.current_stock," ",se.unit," verfügbar)"]},se.id))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mitarbeiter"}),s.jsxs(mt,{value:X.employee_id,onValueChange:se=>ue(we=>({...we,employee_id:se})),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Mitarbeiter wählen"})}),s.jsx(ft,{children:m.map(se=>s.jsxs(ye,{value:se.id,children:[se.first_name," ",se.last_name]},se.id))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Projekt"}),s.jsxs(mt,{value:X.project_id,onValueChange:se=>ue(we=>({...we,project_id:se})),children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Projekt wählen"})}),s.jsx(ft,{children:d.map(se=>s.jsx(ye,{value:se.id,children:se.name},se.id))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Verbrauchte Menge"}),s.jsx(ae,{type:"number",step:"0.1",value:X.quantity_used,onChange:se=>ue(we=>({...we,quantity_used:parseFloat(se.target.value)||0}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notizen (optional)"}),s.jsx(cn,{value:X.notes,onChange:se=>ue(we=>({...we,notes:se.target.value})),rows:2})]})]}),s.jsxs(ed,{children:[s.jsx(ee,{variant:"outline",onClick:()=>P(!1),children:"Abbrechen"}),s.jsx(ee,{onClick:te,disabled:!X.material_id||!X.employee_id||!X.project_id||!X.quantity_used,children:"Verbrauch erfassen"})]})]})}),s.jsx(mte,{isOpen:M,onClose:()=>z(!1),selectedMaterial:R,onAssignmentComplete:()=>{G(),F()}})]})},xte=({machine:t})=>{const e=a=>{switch(a){case"Verfügbar":return"bg-green-100 text-green-800";case"Im Einsatz":return"bg-blue-100 text-blue-800";case"Wartung fällig":return"bg-red-100 text-red-800";case"In Wartung":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},n=a=>{switch(a){case"Sehr gut":return"text-green-600";case"Gut":return"text-blue-600";case"Ausreichend":return"text-yellow-600";case"Wartung erforderlich":return"text-red-600";default:return"text-gray-600"}},r=a=>{switch(a){case"Verfügbar":return s.jsx(Ts,{className:"h-4 w-4 text-green-600"});case"Im Einsatz":return s.jsx(an,{className:"h-4 w-4 text-blue-600"});case"Wartung fällig":return s.jsx(us,{className:"h-4 w-4 text-red-600"});case"In Wartung":return s.jsx(e0,{className:"h-4 w-4 text-yellow-600"});default:return s.jsx(Ts,{className:"h-4 w-4 text-gray-600"})}};return s.jsx(oe,{className:"hover:shadow-lg transition-shadow",children:s.jsxs(ce,{className:"p-6 flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r(t.status),s.jsx("h4",{className:"text-lg font-semibold",children:t.name}),s.jsx(Qe,{className:e(t.status),children:t.status})]}),s.jsx("p",{className:"text-gray-600 mb-2",children:t.category}),s.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1 mb-2",children:[s.jsx(Ci,{className:"h-4 w-4"}),t.location]}),s.jsxs("p",{className:"text-sm flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-500",children:"Zustand:"}),s.jsx("span",{className:`font-medium ${n(t.condition)}`,children:t.condition})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",t.id]}),s.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[t.operatingHours,"h"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Betriebsstunden"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4 flex-grow",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Letzte Wartung:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"h-4 w-4"}),t.lastMaintenance]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Nächste Wartung:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"h-4 w-4"}),t.nextMaintenance]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"DGUV V3 Prüfung:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"h-4 w-4"}),t.dguv]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Nächste DGUV V3:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"h-4 w-4"}),t.nextDguv]})]})]}),t.status==="Wartung fällig"&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[s.jsx(us,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Wartung überfällig! Gerät nicht verwenden."})]})}),s.jsxs("div",{className:"flex gap-2 mt-auto",children:[s.jsx(ee,{size:"sm",variant:"outline",children:"Details"}),s.jsxs(ee,{size:"sm",variant:"outline",children:[s.jsx(Lt,{className:"h-4 w-4 mr-1"}),"Wartung"]}),t.status==="Wartung fällig"&&s.jsxs(ee,{size:"sm",className:"bg-red-600 hover:bg-red-700",children:[s.jsx(e0,{className:"h-4 w-4 mr-1"}),"Wartung planen"]})]})]})})},vte=({machines:t})=>{const e=t.length,n=t.filter(i=>i.status==="Verfügbar").length,r=t.filter(i=>i.status==="Im Einsatz").length,a=t.filter(i=>i.status==="Wartung fällig").length;return s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsx(oe,{children:s.jsxs(ce,{className:"flex items-center justify-between p-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Ger\\u00e4te gesamt"}),s.jsx("p",{className:"text-lg font-bold",children:e})]}),s.jsx(Co,{className:"w-5 h-5 text-blue-500"})]})}),s.jsx(oe,{children:s.jsxs(ce,{className:"flex items-center justify-between p-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Verf\\u00fcgbar"}),s.jsx("p",{className:"text-lg font-bold",children:n})]}),s.jsx(Ts,{className:"w-5 h-5 text-green-500"})]})}),s.jsx(oe,{children:s.jsxs(ce,{className:"flex items-center justify-between p-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Im Einsatz"}),s.jsx("p",{className:"text-lg font-bold",children:r})]}),s.jsx(an,{className:"w-5 h-5 text-yellow-500"})]})}),s.jsx(oe,{children:s.jsxs(ce,{className:"flex items-center justify-between p-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Wartung f\\u00e4llig"}),s.jsx("p",{className:"text-lg font-bold",children:a})]}),s.jsx(us,{className:"w-5 h-5 text-red-500"})]})})]})},yte=()=>{const t=[{machine:"Hubarbeitsbühne Genie GS-1932",type:"Wartung",date:"20.01.2024",priority:"Hoch"},{machine:"Bohrmaschine Hilti TE 6-A36",type:"Wartung",date:"15.03.2024",priority:"Mittel"},{machine:"Kabelzuggerät Greenlee 855GX",type:"Wartung",date:"08.04.2024",priority:"Niedrig"},{machine:"Messgerät Fluke 1587",type:"DGUV V3",date:"05.01.2025",priority:"Niedrig"}],e=n=>{switch(n){case"Hoch":return"bg-red-100 text-red-800";case"Mittel":return"bg-yellow-100 text-yellow-800";case"Niedrig":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"h-5 w-5"}),"Wartungsplan"]})}),s.jsx(ce,{children:s.jsx("div",{className:"space-y-3",children:t.map(n=>s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(Qe,{variant:"outline",className:"text-xs",children:n.type}),s.jsx(Qe,{className:e(n.priority),children:n.priority})]}),s.jsx("p",{className:"font-medium text-sm mb-1",children:n.machine}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(Lt,{className:"h-3 w-3"}),n.date]})]},`${n.machine}-${n.date}`))})})]})},_te=()=>s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{className:"text-base",children:"Geräteaktionen"})}),s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ee,{variant:"outline",className:"w-full justify-start",children:[s.jsx(Lt,{className:"h-4 w-4 mr-2"}),"Wartung planen"]}),s.jsxs(ee,{variant:"outline",className:"w-full justify-start",children:[s.jsx(Ts,{className:"h-4 w-4 mr-2"}),"DGUV V3 Prüfung"]}),s.jsxs(ee,{variant:"outline",className:"w-full justify-start",children:[s.jsx(Ci,{className:"h-4 w-4 mr-2"}),"Standort ändern"]}),s.jsxs(ee,{variant:"outline",className:"w-full justify-start",children:[s.jsx(Co,{className:"h-4 w-4 mr-2"}),"Inventar"]})]})})]}),wte=()=>s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{className:"text-base text-red-600",children:"Wartung überfällig"})}),s.jsx(ce,{className:"p-4",children:s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 rounded",children:[s.jsx("span",{className:"text-sm",children:"Hubarbeitsbühne"}),s.jsx("span",{className:"text-xs text-red-600",children:"3 Tage"})]})})})]}),bte=()=>{const t=[{id:"M001",name:"Bohrmaschine Hilti TE 6-A36",category:"Bohrgeräte",location:"Baustelle Müller GmbH",status:"Im Einsatz",lastMaintenance:"15.12.2023",nextMaintenance:"15.03.2024",dguv:"22.11.2023",nextDguv:"22.11.2024",operatingHours:324,condition:"Gut"},{id:"M002",name:"Messgerät Fluke 1587",category:"Messgeräte",location:"Lager",status:"Verfügbar",lastMaintenance:"10.01.2024",nextMaintenance:"10.07.2024",dguv:"05.01.2024",nextDguv:"05.01.2025",operatingHours:156,condition:"Sehr gut"},{id:"M003",name:"Hubarbeitsbühne Genie GS-1932",category:"Hebegeräte",location:"Baustelle Weber Bau",status:"Wartung fällig",lastMaintenance:"20.10.2023",nextMaintenance:"20.01.2024",dguv:"15.12.2023",nextDguv:"15.12.2024",operatingHours:892,condition:"Wartung erforderlich"},{id:"M004",name:"Kabelzuggerät Greenlee 855GX",category:"Installationshilfen",location:"Fahrzeug 1",status:"Im Einsatz",lastMaintenance:"08.01.2024",nextMaintenance:"08.04.2024",dguv:"30.11.2023",nextDguv:"30.11.2024",operatingHours:245,condition:"Gut"}];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-indigo-600 bg-clip-text text-transparent flex items-center gap-3",children:[s.jsx(Co,{className:"h-8 w-8 text-indigo-600"}),"Maschinen & Geräte"]}),s.jsx("p",{className:"text-gray-600",children:"Verwalten Sie Ihren Maschinenpark und Wartungsintervalle"})]}),s.jsxs(ee,{children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Gerät hinzufügen"]})]}),s.jsx(vte,{machines:t}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Maschinenübersicht"}),t.map(e=>s.jsx(xte,{machine:e},e.id))]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx(yte,{}),s.jsx(_te,{}),s.jsx(wte,{})]})]})]})},jte=()=>{const{toast:t}=Mt(),{data:e,isLoading:n}=dR(),{data:r,isLoading:a}=XZ(),{data:i,isLoading:o}=JZ(),[c,d]=g.useState([]),[u,m]=g.useState(!0),[f,p]=g.useState({hoursPerDay:0,breakHours:0,loaded:!1});uR();const[x,j]=g.useState("dashboard"),[v,_]=g.useState([]),[b,w]=g.useState(!1),[N,S]=g.useState(null),[C,A]=g.useState({}),[P,M]=g.useState(!1),[z,R]=g.useState({name:"",icon:"💼",items:[{name:"",value:"0"}]}),[D,B]=g.useState([]);g.useEffect(()=>{const q=localStorage.getItem("handwerkos_custom_categories");if(q)try{B(JSON.parse(q))}catch(ne){console.error("Error loading saved categories:",ne)}},[]),g.useEffect(()=>{D.length>0&&localStorage.setItem("handwerkos_custom_categories",JSON.stringify(D))},[D]),g.useEffect(()=>{console.log("🔄 Working hours state updated:",f)},[f]);const[W,X]=g.useState({miete:"1.000",nebenkosten:"300",reinigung:"100",fahrzeugLeasing:"500",fahrzeugVersicherung:"150",fahrzeugSteuer:"100",versicherungHaftpflicht:"200",versicherungRente:"300",versicherungBerufsunfaehigkeit:"150",verwaltungSoftware:"150",verwaltungSteuerberater:"250",verwaltungMarketing:"200",personalGehaelter:"708",personalSozialversicherung:"142",personalWeihnachtsgeld:"100"}),ue=()=>{const ne=1400+G().total+750+392+600,pe=D.reduce((Q,re)=>Q+re.total,0);return ne+pe},de=q=>q.reduce((ne,pe)=>{const Q=parseFloat(pe.value.replace(/[^\d.-]/g,""))||0;return ne+Q},0),G=()=>{if(console.log("FinanceModule calculatePersonnelCosts:",{employees:c,employeeCount:(c==null?void 0:c.length)||0,employeesLoading:u}),!c||c.length===0)return console.log("FinanceModule: No employees found, returning zero costs"),{totalSalaries:0,socialInsurance:0,bonuses:0,total:0,employeeCount:0};const q=localStorage.getItem("employeeWages"),ne=q?JSON.parse(q):[];console.log("💾 Loaded wages from localStorage:",ne);const pe=c.filter(Se=>{var Ye;const qe=(Ye=Se.status)==null?void 0:Ye.toLowerCase();return qe==="active"||qe==="aktiv"||!Se.status}),Q=pe.length,re=pe.reduce((Se,qe)=>{const Et=21.25*f.hoursPerDay,be=ne.find(lt=>lt.employee_id===qe.id),Oe=(be==null?void 0:be.hourly_wage)||qe.hourly_rate||0,Fe=Oe*Et;return console.log(`👷 Employee ${qe.first_name} ${qe.last_name}:`,{status:qe.status,hourly_rate_from_db:qe.hourly_rate,hourly_rate_from_localStorage:be==null?void 0:be.hourly_wage,hourly_rate_used:Oe,hours_per_month:Et,calculated_monthly:Fe.toFixed(2)+"€"}),(!qe.hourly_rate||qe.hourly_rate===0)&&console.warn(`⚠️ Employee ${qe.first_name} ${qe.last_name} has no hourly rate set!`),Se+Fe},0);console.log("💰 Total monthly salaries calculation:",{activeEmployeeCount:Q,totalMonthlySalaries:re.toFixed(2)+"€"});const he=re*.21,se=re*2/12,we={totalSalaries:re,socialInsurance:he,bonuses:se,total:re+he+se,employeeCount:Q};return console.log("Personnel costs calculation result:",we),we},I=()=>{const q=ue()/12,ne=8e3/12,pe=25e3/12,Q=q+ne+pe,re=21.25,me=f.hoursPerDay-f.breakHours,he=re*me,ge=Q/he,se=ge*1.3;return{minimumRate:ge,recommendedRate:se,totalAmount:Q,workingHours:he}};e!=null&&e.items;const V=(r==null?void 0:r.items)||[],$=i||{monthly_revenue:0,monthly_expenses:0,monthly_profit:0,total_outstanding:0,overdue_count:0,active_projects_profit:0,avg_profit_margin:0,revenue_trend:0,expense_trend:0,profit_trend:0},F=n||a||o||u,O=async()=>{try{console.log("⏰ Starting to fetch company working hours...",new Date().toISOString());const{data:q}=await Z.auth.getUser();if(!(q!=null&&q.user)){console.log("❌ No authenticated user");return}const{data:ne,error:pe}=await Z.from("profiles").select("company_id").eq("id",q.user.id).single();if(console.log("👤 Profile query result:",{profile:ne,profileError:pe}),!(ne!=null&&ne.company_id)){console.log("❌ No company_id found in profile");return}console.log("🔍 Fetching settings for company_id:",ne.company_id);const{data:Q,error:re}=await Z.from("company_settings").select("default_working_hours_start, default_working_hours_end, default_break_duration, company_id").eq("company_id",ne.company_id).single();if(console.log("📊 Query result:",{settings:Q,error:re}),re||!Q){console.log("⚠️ No company settings found, checking if we need to create them");const{data:Le,error:Nt}=await Z.from("company_settings").insert({company_id:ne.company_id,company_name:"Meine Firma",default_working_hours_start:"08:00:00",default_working_hours_end:"17:00:00",default_break_duration:30,default_tax_rate:19,default_currency:"EUR",quote_validity_days:30,invoice_prefix:"R",quote_prefix:"Q",order_prefix:"A"}).select().single();if(Nt){console.log("⚠️ Could not create settings, using default values. Error:",Nt),p({hoursPerDay:8,breakHours:.5,loaded:!0});return}console.log("✅ Created default company settings:",Le),p({hoursPerDay:9,breakHours:.5,loaded:!0});return}console.log("📋 Raw company settings:",Q);const me=Q.default_working_hours_start||"08:00",he=Q.default_working_hours_end||"17:00",ge=me.substring(0,5),se=he.substring(0,5),we=Q.default_break_duration||30,[Se,qe]=ge.split(":").map(Number),[Ye,Et]=se.split(":").map(Number),be=Se*60+qe,Oe=Ye*60+Et,Fe=Oe-be,lt=Fe/60,He=we/60;console.log("🔢 Calculated hours:",{startMinutes:be,endMinutes:Oe,workMinutesPerDay:Fe,hoursPerDay:lt,breakHours:He}),p({hoursPerDay:lt,breakHours:He,loaded:!0}),console.log("🕐 Company working hours loaded:",{startTime:ge,endTime:se,breakMinutes:we,hoursPerDay:lt,breakHours:He,productiveHours:lt-He})}catch(q){console.error("❌ ERROR fetching company working hours:",q),console.log("⚠️ Using fallback values due to error"),p({hoursPerDay:8,breakHours:.5,loaded:!0})}};g.useEffect(()=>{O(),(async()=>{try{m(!0);const{data:ne}=await Z.auth.getUser();if(!(ne!=null&&ne.user)){console.log("No authenticated user"),d([]),m(!1);return}const{data:pe}=await Z.from("profiles").select("company_id").eq("id",ne.user.id).single();if(!(pe!=null&&pe.company_id)){console.log("No company_id found"),d([]),m(!1);return}const{data:Q,error:re}=await Z.from("employees").select("id, first_name, last_name, status, hourly_rate, position").eq("company_id",pe.company_id);if(re)console.error("❌ Error fetching employees:",re),d([]);else{console.log("✅ Fetched employees successfully:",Q),console.log("📊 Employee details:",Q==null?void 0:Q.map(he=>({name:`${he.first_name} ${he.last_name}`,position:he.position,status:he.status,hourly_rate:he.hourly_rate,has_hourly_rate:he.hourly_rate!==null&&he.hourly_rate>0})));const me=(Q==null?void 0:Q.filter(he=>!he.hourly_rate||he.hourly_rate===0))||[];me.length>0&&console.warn("⚠️ Employees without hourly rate:",me.map(he=>`${he.first_name} ${he.last_name}`)),d(Q||[])}}catch(ne){console.error("Error in fetchEmployees:",ne),d([])}finally{m(!1)}})(),K()},[]),g.useEffect(()=>{if(console.log("🎯 Tab changed to:",x),x==="fixkosten"){console.log("📍 Tab is fixkosten, fetching working hours..."),O();const q=setInterval(()=>{console.log("🔄 Refreshing working hours (interval)..."),O()},5e3);return()=>{console.log("🛑 Clearing interval for working hours refresh"),clearInterval(q)}}},[x]),g.useEffect(()=>{const q=()=>{document.visibilityState==="visible"&&x==="fixkosten"&&O()},ne=()=>{x==="fixkosten"&&O()};return document.addEventListener("visibilitychange",q),window.addEventListener("focus",ne),()=>{document.removeEventListener("visibilitychange",q),window.removeEventListener("focus",ne)}},[x]);const K=async()=>{_([{month:"2024-08",revenue:22e3,expenses:16e3,profit:6e3},{month:"2024-09",revenue:28e3,expenses:19e3,profit:9e3},{month:"2024-10",revenue:31e3,expenses:22e3,profit:9e3},{month:"2024-11",revenue:26e3,expenses:18500,profit:7500},{month:"2024-12",revenue:35e3,expenses:24e3,profit:11e3},{month:"2025-01",revenue:25e3,expenses:18e3,profit:7e3}])},U=q=>{switch(q){case"materials":return"🧱";case"subcontractor":return"👷";case"labor":return"⏰";case"operating":return"🏢";default:return"📋"}},te=q=>{switch(q){case"materials":return"Material";case"subcontractor":return"Nachunternehmer";case"labor":return"Lohn";case"operating":return"Betriebskosten";default:return"Sonstiges"}},J=q=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(q);return F?s.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsx(dt,{className:"h-10 w-64"}),s.jsxs("div",{className:"flex gap-6",children:[s.jsx(dt,{className:"h-10 w-24"}),s.jsx(dt,{className:"h-10 w-32"})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:Array(4).fill(0).map((q,ne)=>s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(dt,{className:"h-4 w-20 mb-2"}),s.jsx(dt,{className:"h-8 w-16"}),s.jsx(dt,{className:"h-3 w-12 mt-1"})]}),s.jsx(dt,{className:"h-8 w-8 rounded-full"})]})})},ne))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(dt,{className:"h-6 w-32"})}),s.jsx(ce,{children:s.jsx("div",{className:"space-y-4",children:Array(5).fill(0).map((q,ne)=>s.jsx("div",{className:"border rounded p-4",children:s.jsx(dt,{className:"h-20 w-full"})},ne))})})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(dt,{className:"h-6 w-32"})}),s.jsx(ce,{children:s.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((q,ne)=>s.jsx("div",{className:"p-3 bg-gray-50 rounded",children:s.jsx(dt,{className:"h-16 w-full"})},ne))})})]})]})]}):s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Finanzen & Buchhaltung"}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs(ee,{variant:"outline",className:"rounded-full",children:[s.jsx(km,{className:"h-4 w-4 mr-2"}),"Export"]})})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsumsatz"}),s.jsx("p",{className:"text-2xl font-bold text-green-700",children:J($.monthly_revenue)})]}),s.jsx(lr,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsausgaben"}),s.jsx("p",{className:"text-2xl font-bold text-red-700",children:J($.monthly_expenses)})]}),s.jsx(Yb,{className:"h-8 w-8 text-red-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsgewinn"}),s.jsx("p",{className:"text-2xl font-bold text-blue-700",children:J($.monthly_profit)})]}),s.jsx(Eo,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Offene Posten"}),s.jsx("p",{className:"text-2xl font-bold text-orange-700",children:J($.total_outstanding)}),s.jsx(us,{className:"h-8 w-8 text-orange-500 opacity-50"})]})})})]}),s.jsxs(Is,{value:x,onValueChange:j,className:"w-full",children:[s.jsxs(js,{className:"grid w-full grid-cols-5 mb-6",children:[s.jsxs(Je,{value:"dashboard",className:"flex items-center gap-2",children:[s.jsx(sh,{className:"h-4 w-4"}),"Dashboard"]}),s.jsxs(Je,{value:"expenses",className:"flex items-center gap-2",children:[s.jsx(Mr,{className:"h-4 w-4"}),"Ausgaben"]}),s.jsxs(Je,{value:"fixkosten",className:"flex items-center gap-2",children:[s.jsx(Jr,{className:"h-4 w-4"}),"Betriebskosten"]}),s.jsxs(Je,{value:"reports",className:"flex items-center gap-2",children:[s.jsx(sh,{className:"h-4 w-4"}),"Berichte"]}),s.jsxs(Je,{value:"tax",className:"flex items-center gap-2",children:[s.jsx(lr,{className:"h-4 w-4"}),"Steuer"]})]}),s.jsx(et,{value:"dashboard",className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs(oe,{className:"lg:col-span-2",children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"📊 Umsatz-Verlauf (letzte 6 Monate)"})}),s.jsx(ce,{children:s.jsx("div",{className:"space-y-4",children:v.map((q,ne)=>{const pe=new Date(q.month+"-01").toLocaleDateString("de-DE",{month:"short",year:"numeric"}),Q=Math.max(...v.map(he=>he.revenue)),re=q.revenue/Q*100,me=q.expenses/Q*100;return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:pe}),s.jsxs("span",{className:"font-medium",children:[J(q.profit)," Gewinn"]})]}),s.jsxs("div",{className:"relative h-6 bg-gray-100 rounded",children:[s.jsx("div",{className:"absolute h-full bg-green-500 rounded",style:{width:`${re}%`}}),s.jsx("div",{className:"absolute h-full bg-red-400 rounded",style:{width:`${me}%`}})]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[s.jsxs("span",{children:["Umsatz: ",J(q.revenue)]}),s.jsxs("span",{children:["Ausgaben: ",J(q.expenses)]})]})]},ne)})})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"⚡ Schnellzugriff"})}),s.jsxs(ce,{className:"space-y-3",children:[s.jsxs(ee,{className:"w-full justify-start",variant:"outline",children:[s.jsx(wn,{className:"h-4 w-4 mr-2"}),"Neue Rechnung"]}),s.jsxs(ee,{className:"w-full justify-start",variant:"outline",children:[s.jsx(Mr,{className:"h-4 w-4 mr-2"}),"Ausgabe erfassen"]}),s.jsxs(ee,{className:"w-full justify-start",variant:"outline",children:[s.jsx(lr,{className:"h-4 w-4 mr-2"}),"Zahlung erfassen"]}),s.jsxs(ee,{className:"w-full justify-start",variant:"outline",children:[s.jsx(km,{className:"h-4 w-4 mr-2"}),"DATEV Export"]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"💎 Projekt-Rentabilität"})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm",children:"Aktive Projekte"}),s.jsx("span",{className:"font-medium",children:J($.active_projects_profit)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm",children:"Ø Gewinnmarge"}),s.jsxs(Qe,{variant:"outline",children:[$.avg_profit_margin.toFixed(1),"%"]})]})]})})]})]})]})}),s.jsx(et,{value:"expenses",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"💸 Ausgabenmanagement"})}),s.jsx(ce,{children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-4",children:"📋 Aktuelle Ausgaben"}),s.jsx("div",{className:"space-y-3",children:V.map(q=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-2xl",children:U(q.category)}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:q.description}),s.jsxs("p",{className:"text-sm text-gray-500",children:[te(q.category)," • ",new Date(q.date).toLocaleDateString("de-DE")]}),q.project&&s.jsxs("p",{className:"text-xs text-blue-600",children:["→ ",q.project]})]})]}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"font-bold text-red-600",children:J(q.amount)})})]},q.id))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-4",children:"📊 Ausgaben-Kategorien"}),s.jsx("div",{className:"space-y-3",children:["materials","subcontractor","labor","operating"].map(q=>{const ne=V.filter(Q=>Q.category===q),pe=ne.reduce((Q,re)=>Q+re.amount,0);return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xl",children:U(q)}),s.jsx("span",{className:"font-medium",children:te(q)})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-bold",children:J(pe)}),s.jsxs("p",{className:"text-sm text-gray-500",children:[ne.length," Ausgaben"]})]})]},q)})})]})]})})]})}),s.jsx(et,{value:"reports",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"📊 Finanzberichte & Auswertungen"})}),s.jsx(ce,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsxs(ee,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(wn,{className:"h-6 w-6"}),s.jsx("span",{children:"Offene Posten Liste"})]}),s.jsxs(ee,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(Eo,{className:"h-6 w-6"}),s.jsx("span",{children:"Umsatzauswertung"})]}),s.jsxs(ee,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(sh,{className:"h-6 w-6"}),s.jsx("span",{children:"Projekt-Rentabilität"})]}),s.jsxs(ee,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(Jr,{className:"h-6 w-6"}),s.jsx("span",{children:"Kostenanalyse"})]}),s.jsxs(ee,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(lr,{className:"h-6 w-6"}),s.jsx("span",{children:"Liquiditätsplanung"})]}),s.jsxs(ee,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(km,{className:"h-6 w-6"}),s.jsx("span",{children:"Jahresauswertung"})]})]})})]})}),s.jsx(et,{value:"tax",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"🏛️ Steuerliche Compliance"})}),s.jsx(ce,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-4",children:"📊 Umsatzsteuer"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Umsatz 19% USt"}),s.jsx("span",{className:"font-medium",children:J(18e3)})]}),s.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[s.jsx("span",{children:"Umsatzsteuer 19%"}),s.jsx("span",{children:J(3420)})]})]}),s.jsxs("div",{className:"p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Umsatz 7% USt"}),s.jsx("span",{className:"font-medium",children:J(2e3)})]}),s.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[s.jsx("span",{children:"Umsatzsteuer 7%"}),s.jsx("span",{children:J(140)})]})]}),s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("div",{className:"flex justify-between font-semibold",children:[s.jsx("span",{children:"Gesamte USt-Schuld"}),s.jsx("span",{className:"text-blue-600",children:J(3560)})]})})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-4",children:"📁 Export & Berichte"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(ee,{variant:"outline",className:"w-full justify-start",children:[s.jsx(km,{className:"h-4 w-4 mr-2"}),"DATEV-Export"]}),s.jsxs(ee,{variant:"outline",className:"w-full justify-start",children:[s.jsx(D_,{className:"h-4 w-4 mr-2"}),"CSV-Export"]}),s.jsxs(ee,{variant:"outline",className:"w-full justify-start",children:[s.jsx(wn,{className:"h-4 w-4 mr-2"}),"EÜR-Vorbereitung"]}),s.jsxs(ee,{variant:"outline",className:"w-full justify-start",children:[s.jsx(Co,{className:"h-4 w-4 mr-2"}),"Steuer-Einstellungen"]})]})]})]})})]})}),s.jsx(et,{value:"fixkosten",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(Jr,{className:"h-5 w-5"}),"💰 Betriebskosten (monatlich)"]}),s.jsx(ds,{children:"Verwalten Sie Ihre monatlichen Betriebskosten für die Stundensatz-Berechnung"})]}),s.jsxs(ce,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsxs(Ce,{className:"flex items-center gap-2 text-base",children:[s.jsx("span",{className:"text-xl",children:"🏢"}),"Betrieb & Büro"]})}),s.jsxs(ce,{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Miete/Pacht"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.miete,onChange:q=>X({...W,miete:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.miete," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Nebenkosten"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.nebenkosten,onChange:q=>X({...W,nebenkosten:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.nebenkosten," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Reinigung"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.reinigung,onChange:q=>X({...W,reinigung:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.reinigung," €"]})]}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:J(1400)})]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsxs(Ce,{className:"flex items-center gap-2 text-base",children:[s.jsx("span",{className:"text-xl",children:"👷‍♂️"}),"Personal"]})}),s.jsx(ce,{className:"space-y-2",children:(()=>{const q=G();return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm text-muted-foreground",children:["Fixgehälter Mitarbeiter (",q.employeeCount," MA)"]}),s.jsx("span",{className:"text-sm font-medium",children:J(q.totalSalaries)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Arbeitgeberanteile Sozialversicherung"}),s.jsx("span",{className:"text-sm font-medium",children:J(q.socialInsurance)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Weihnachts-/Urlaubsgeld"}),s.jsx("span",{className:"text-sm font-medium",children:J(q.bonuses)})]}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:J(q.total)})]}),q.employeeCount===0&&s.jsxs("div",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded mt-2",children:["⚠️ Keine aktiven Mitarbeiter gefunden. Personalkosten sind 0 €.",s.jsx("br",{}),s.jsx("span",{className:"text-xs",children:"Stellen Sie sicher, dass Mitarbeiter einen Stundenlohn haben und aktiv sind."})]}),q.employeeCount>0&&q.total===0&&s.jsx("div",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded mt-2",children:"⚠️ Mitarbeiter gefunden, aber keine Stundenlöhne eingetragen."})]})})()})]}),s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsxs(Ce,{className:"flex items-center gap-2 text-base",children:[s.jsx("span",{className:"text-xl",children:"🚗"}),"Fahrzeuge"]})}),s.jsxs(ce,{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Leasing/Abschreibung"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.fahrzeugLeasing,onChange:q=>X({...W,fahrzeugLeasing:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.fahrzeugLeasing," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Versicherung"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.fahrzeugVersicherung,onChange:q=>X({...W,fahrzeugVersicherung:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.fahrzeugVersicherung," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Steuer & Wartung"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.fahrzeugSteuer,onChange:q=>X({...W,fahrzeugSteuer:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.fahrzeugSteuer," €"]})]}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:J(9e3)})]})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsxs(Ce,{className:"flex items-center gap-2 text-base",children:[s.jsx("span",{className:"text-xl",children:"🛡️"}),"Versicherungen & Beiträge"]})}),s.jsxs(ce,{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Betriebshaftpflicht"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.versicherungHaftpflicht,onChange:q=>X({...W,versicherungHaftpflicht:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.versicherungHaftpflicht," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Berufsgenossenschaft"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.versicherungRente,onChange:q=>X({...W,versicherungRente:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.versicherungRente," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Kammer/Innung"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.versicherungBerufsunfaehigkeit,onChange:q=>X({...W,versicherungBerufsunfaehigkeit:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.versicherungBerufsunfaehigkeit," €"]})]}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:J(4700)})]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsxs(Ce,{className:"flex items-center gap-2 text-base",children:[s.jsx("span",{className:"text-xl",children:"🏭"}),"Verwaltung & Organisation"]})}),s.jsxs(ce,{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Software & Lizenzen"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.verwaltungSoftware,onChange:q=>X({...W,verwaltungSoftware:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.verwaltungSoftware," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Steuerberater"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.verwaltungSteuerberater,onChange:q=>X({...W,verwaltungSteuerberater:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.verwaltungSteuerberater," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Marketing & Werbung"}),b?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ae,{type:"text",value:W.verwaltungMarketing,onChange:q=>X({...W,verwaltungMarketing:q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[W.verwaltungMarketing," €"]})]}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:J(7200)})]})]})]}),D.map(q=>{const ne=b||N===q.id,pe=C[q.id]||q;return s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsxs(Ce,{className:"flex items-center justify-between text-base",children:[s.jsx("div",{className:"flex items-center gap-2",children:ne?s.jsxs(s.Fragment,{children:[s.jsx(ae,{type:"text",value:pe.icon,onChange:Q=>A({...C,[q.id]:{...pe,icon:Q.target.value}}),className:"w-12 h-8 text-center text-xl p-0"}),s.jsx(ae,{type:"text",value:pe.name,onChange:Q=>A({...C,[q.id]:{...pe,name:Q.target.value}}),className:"h-8 text-base font-semibold"})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-xl",children:q.icon}),s.jsx("span",{children:q.name})]})}),!b&&s.jsx(ee,{size:"sm",variant:"ghost",onClick:()=>{B(Q=>Q.filter(re=>re.id!==q.id))},className:"h-7 w-7 p-0 text-red-500 hover:text-red-700",children:s.jsx(Ln,{className:"h-4 w-4"})})]})}),s.jsxs(ce,{className:"space-y-2",children:[ne?s.jsxs(s.Fragment,{children:[pe.items.map((Q,re)=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ae,{type:"text",value:Q.name,onChange:me=>{const he=[...pe.items];he[re].name=me.target.value,A({...C,[q.id]:{...pe,items:he}})},className:"flex-1 h-7 text-sm"}),s.jsx(ae,{type:"text",value:Q.value,onChange:me=>{const he=[...pe.items];he[re].value=me.target.value,A({...C,[q.id]:{...pe,items:he}})},className:"w-20 h-7 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]},re)),s.jsxs(ee,{variant:"outline",size:"sm",className:"w-full h-7 mt-2",onClick:()=>{const Q=[...pe.items,{name:"",value:"0"}];A({...C,[q.id]:{...pe,items:Q}})},children:[s.jsx(rn,{className:"h-3 w-3 mr-1"}),"Zeile hinzufügen"]})]}):s.jsx(s.Fragment,{children:q.items.map((Q,re)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:Q.name}),s.jsxs("span",{className:"text-sm font-medium",children:[Q.value," €"]})]},re))}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:J(ne?de(pe.items):q.total)})]})]})]},q.id)}),P?s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsx(Ce,{className:"flex items-center gap-2 text-base",children:s.jsx(ae,{type:"text",placeholder:"🏢 Kategorie Name",value:z.name,onChange:q=>R({...z,name:q.target.value}),className:"text-base font-semibold border-none p-0 h-auto bg-transparent"})})}),s.jsxs(ce,{className:"space-y-2",children:[z.items.map((q,ne)=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ae,{type:"text",placeholder:"Kostenpunkt",value:q.name,onChange:pe=>{const Q=[...z.items];Q[ne].name=pe.target.value,R({...z,items:Q})},className:"flex-1 h-7 text-sm"}),s.jsx(ae,{type:"text",placeholder:"0",value:q.value,onChange:pe=>{const Q=[...z.items];Q[ne].value=pe.target.value,R({...z,items:Q})},className:"w-20 h-7 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]},ne)),s.jsxs(ee,{variant:"outline",size:"sm",className:"w-full h-7",onClick:()=>R({...z,items:[...z.items,{name:"",value:"0"}]}),children:[s.jsx(rn,{className:"h-3 w-3 mr-1"}),"Kostenpunkt hinzufügen"]}),s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsx(ee,{variant:"outline",size:"sm",onClick:()=>{M(!1),R({name:"",icon:"💼",items:[{name:"",value:"0"}]})},children:s.jsx(Ln,{className:"h-4 w-4"})}),s.jsx(ee,{size:"sm",onClick:()=>{if(z.name&&z.items.some(q=>q.name)){const q=de(z.items),ne={id:Date.now().toString(),name:z.name,icon:z.icon,items:z.items,total:q};B(pe=>[...pe,ne]),M(!1),R({name:"",icon:"💼",items:[{name:"",value:"0"}]}),t({title:"Kategorie erstellt",description:`"${z.name}" wurde erfolgreich hinzugefügt.`})}},children:s.jsx(Dh,{className:"h-4 w-4"})})]})]})]}):s.jsx(oe,{className:"border-dashed border-2 border-gray-300 hover:border-gray-400 transition-colors cursor-pointer",onClick:()=>M(!0),children:s.jsx(ce,{className:"flex items-center justify-center h-48 p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center mx-auto mb-3 transition-colors",children:s.jsx(rn,{className:"h-6 w-6 text-gray-400"})}),s.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Neue Kategorie"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"hinzufügen"})]})})})]})]}),s.jsx("div",{className:"flex justify-end gap-2",children:b?s.jsxs(s.Fragment,{children:[s.jsx(ee,{variant:"outline",size:"sm",onClick:()=>{w(!1),S(null),A({})},children:s.jsx(Ln,{className:"h-4 w-4"})}),s.jsx(ee,{size:"sm",onClick:()=>{Object.keys(C).forEach(q=>{const ne=C[q],pe={...ne,total:de(ne.items)};B(Q=>Q.map(re=>re.id===q?pe:re))}),w(!1),S(null),A({}),t({title:"Kosten aktualisiert",description:"Die Betriebskosten wurden erfolgreich gespeichert."})},children:s.jsx(Dh,{className:"h-4 w-4"})})]}):s.jsx(ee,{variant:"outline",size:"sm",onClick:()=>{w(!0);const q={};D.forEach(ne=>{q[ne.id]=ne}),A(q)},children:s.jsx(fB,{className:"h-4 w-4"})})})]})]}),s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:"⚡"}),"Stundensatz-Rechner"]}),s.jsx(ds,{children:"Automatische Berechnung basierend auf Betriebskosten"})]}),s.jsxs(ce,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsx(Y,{className:"text-sm text-muted-foreground",children:"Fixkosten (Betrieb)"}),s.jsxs("p",{className:"text-2xl font-bold",children:[J(ue()/12)," / Monat"]})]}),s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsx(Y,{className:"text-sm text-muted-foreground",children:"Variable Grundkosten"}),s.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[J(8e3/12)," / Monat"]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Material (netto), etc."})]}),s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsx(Y,{className:"text-sm text-muted-foreground",children:"Gewollter Gewinn"}),s.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[J(25e3/12)," / Monat"]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[s.jsx(Y,{className:"text-sm text-muted-foreground",children:"Arbeitstage 2025"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"text-xl font-semibold",children:"261 Tage"}),s.jsx(Qe,{variant:"outline",children:"8 Stunden"})]})]}),s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[s.jsx(Y,{className:"text-sm text-muted-foreground",children:"Urlaubstage:"}),s.jsx("p",{className:"text-lg",children:"- 30 Tage"})]}),s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[s.jsx(Y,{className:"text-sm text-muted-foreground",children:"Arbeitsstunden/Monat:"}),f.loaded?s.jsxs(s.Fragment,{children:[s.jsxs("p",{className:"text-xl font-semibold",children:[Math.round(21.25*f.hoursPerDay)," Stunden"]}),s.jsxs(Qe,{variant:"secondary",className:"mt-2",children:[Math.round(21.25*(f.hoursPerDay-f.breakHours))," Stunden (nach Pausen)"]}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["21,25 Tage × ",Number(f.hoursPerDay).toFixed(1),"h - ",Number(f.breakHours*60).toFixed(0)," Min. Pausen"]})]}):s.jsx("p",{className:"text-sm text-muted-foreground",children:"Lade Arbeitszeiten..."})]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[s.jsx(Y,{className:"text-sm text-muted-foreground",children:"Mindest-Stundensatz"}),s.jsx("p",{className:"text-3xl font-bold text-blue-600",children:J(I().minimumRate)}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["(",J(I().totalAmount)," ÷ ",I().workingHours,"h)"]})]}),s.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[s.jsx(Y,{className:"text-sm text-muted-foreground",children:"Empfohlener Stundensatz"}),s.jsx("p",{className:"text-3xl font-bold text-green-600",children:J(I().recommendedRate)}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"+30% Gewinnaufschlag & Rücklage"})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsxs(ee,{size:"lg",children:[s.jsx(Jr,{className:"h-4 w-4 mr-2"}),"Stundensatz anpassen"]})})]})]})]})})]})]})};var Nte="Separator",ZC="horizontal",Ste=["horizontal","vertical"],EI=g.forwardRef((t,e)=>{const{decorative:n,orientation:r=ZC,...a}=t,i=kte(r)?r:ZC,c=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return s.jsx(nt.div,{"data-orientation":i,...c,...a,ref:e})});EI.displayName=Nte;function kte(t){return Ste.includes(t)}var AI=EI;const mi=g.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...r},a)=>s.jsx(AI,{ref:a,decorative:n,orientation:e,className:Te("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));mi.displayName=AI.displayName;const Cte=()=>{const[t,e]=g.useState(new Date),[n,r]=g.useState("month"),[a,i]=g.useState("overview"),[o,c]=g.useState("all"),[d,u]=g.useState("all"),[m,f]=g.useState([]),[p,x]=g.useState([]),[j,v]=g.useState([]),[_,b]=g.useState([]),[w,N]=g.useState([]),[S,C]=g.useState(!0),{toast:A}=Mt();g.useEffect(()=>{P()},[]);const P=async()=>{C(!0);try{await Promise.all([M(),z(),R(),D(),B()])}catch(te){console.error("Error loading planner data:",te),A({title:"Fehler beim Laden",description:"Die Planerdaten konnten nicht geladen werden.",variant:"destructive"})}C(!1)},M=async()=>{const{data:te,error:J}=await Z.from("projects").select("*").order("start_date");if(J)throw J;f(te||[])},z=async()=>{try{const{data:te}=await Z.auth.getUser();if(!(te!=null&&te.user))return;const{data:J}=await Z.from("profiles").select("company_id").eq("id",te.user.id).single();if(!(J!=null&&J.company_id))return;const{data:q,error:ne}=await Z.from("employees").select("*").eq("company_id",J.company_id).neq("status","eingeladen").not("user_id","is",null).order("last_name");if(ne)throw ne;x(q||[])}catch(te){console.error("Error loading employees:",te)}},R=async()=>{const{data:te,error:J}=await Z.from("employee_absences").select(`
        *,
        employee:employees!employee_absences_employee_id_fkey(*)
      `).order("start_date");if(J)throw J;v(te||[])},D=async()=>{const{data:te,error:J}=await Z.from("calendar_events").select("*").order("start_date");if(J)throw J;b(te||[])},B=async()=>{const{data:te,error:J}=await Z.from("project_assignments").select(`
        *,
        project:projects(*),
        employee:employees(*)
      `).order("start_date");if(J)throw J;N(te||[])},W=()=>n==="week"?{start:ha(t,{weekStartsOn:1}),end:Gg(t,{weekStartsOn:1})}:{start:Rs(t),end:Zg(t)},{start:X,end:ue}=W();uY({start:X,end:ue});const de=()=>{e(n==="week"?CX(t,1):kX(t,1))},G=()=>{e(n==="week"?Jh(t,1):vr(t,1))},I=te=>{switch(te){case"urlaub":return"bg-green-500";case"krank":return"bg-red-500";case"fortbildung":return"bg-blue-500";case"elternzeit":return"bg-purple-500";default:return"bg-gray-500"}},V=te=>{switch(te){case"urlaub":return s.jsx(Lt,{className:"w-3 h-3"});case"krank":return s.jsx(ig,{className:"w-3 h-3"});case"fortbildung":return s.jsx(pr,{className:"w-3 h-3"});default:return s.jsx(an,{className:"w-3 h-3"})}},$=te=>{switch(te){case"genehmigt":return s.jsx(Ts,{className:"w-3 h-3 text-green-500"});case"abgelehnt":return s.jsx(Nl,{className:"w-3 h-3 text-red-500"});default:return s.jsx(an,{className:"w-3 h-3 text-yellow-500"})}},F=[...new Set(p.map(te=>te.department).filter(Boolean))];d==="all"||p.filter(te=>te.department===d);const O=()=>{const te=t.getFullYear(),J=Array.from({length:12},(pe,Q)=>Q),q=Array.from({length:31},(pe,Q)=>Q+1),ne=(pe,Q)=>{const re=new Date(te,pe,Q);if(re.getMonth()!==pe)return null;Ze(re,"yyyy-MM-dd");const me=[];return m.forEach(he=>{const ge=new Date(he.start_date),se=he.end_date?new Date(he.end_date):ge;re>=ge&&re<=se&&me.push({type:"project",item:he,color:he.color})}),j.forEach(he=>{const ge=new Date(he.start_date),se=new Date(he.end_date);re>=ge&&re<=se&&me.push({type:"absence",item:he,color:I(he.type).replace("bg-","")})}),_.forEach(he=>{const ge=new Date(he.start_date),se=new Date(he.end_date);re>=ge&&re<=se&&me.push({type:"event",item:he,color:he.color})}),me.length>0?me:null};return s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"120px repeat(31, 1fr)"},children:[s.jsx("div",{className:"p-3 border-r border-border font-medium text-center",children:"Monat"}),q.map(pe=>s.jsx("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:pe},pe))]}),J.map((pe,Q)=>s.jsxs("div",{className:`grid ${Q%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"120px repeat(31, 1fr)"},children:[s.jsx("div",{className:"p-3 border-r border-border font-medium text-center bg-muted/50",children:Ze(new Date(te,pe,1),"MMMM",{locale:sn})}),q.map(re=>{const he=new Date(te,pe,re).getMonth()===pe,ge=he?ne(pe,re):null,se=(Se,qe)=>{if(Se.type==="project"){const Ye=new Date(Se.item.start_date);return hs(Ye,qe)||Ye<qe&&re===1}if(Se.type==="absence"){const Ye=new Date(Se.item.start_date);return hs(Ye,qe)||Ye<qe&&re===1}if(Se.type==="event"){const Ye=new Date(Se.item.start_date);return hs(Ye,qe)||Ye<qe&&re===1}return!1},we=(Se,qe)=>{const Ye=new Date(te,pe,1),Et=new Date(te,pe+1,0);let be,Oe;Se.type==="project"?(be=new Date(Se.item.start_date),Oe=Se.item.end_date?new Date(Se.item.end_date):new Date):Se.type==="absence"?(be=new Date(Se.item.start_date),Oe=new Date(Se.item.end_date)):(be=new Date(Se.item.start_date),Oe=new Date(Se.item.end_date));const Fe=be<Ye?Ye:be,lt=Oe>Et?Et:Oe,He=Fe.getDate(),Le=lt.getDate();return Oe>Et?Et.getDate()-He+1:Le-He+1};return s.jsx("div",{className:`border-r border-border last:border-r-0 h-16 relative ${he?"":"bg-muted/30"}`,children:he&&ge&&s.jsx("div",{className:"absolute inset-0 p-1",children:ge.map((Se,qe)=>{var Oe,Fe,lt,He;const Ye=new Date(te,pe,re);if(!se(Se,Ye))return null;const be=we(Se);return s.jsxs("div",{className:"h-3 rounded text-white text-xs flex items-center justify-center font-medium shadow-sm absolute hover:h-4 hover:z-20 transition-all duration-200 group cursor-pointer",style:{backgroundColor:Se.type==="project"?Se.color:Se.type==="absence"?`rgb(${Se.color==="green-500"?"34 197 94":Se.color==="red-500"?"239 68 68":Se.color==="blue-500"?"59 130 246":"107 114 128"})`:Se.item.color,width:`${be*100}%`,left:0,top:`${2+qe*14}px`,zIndex:10},title:Se.type==="project"?`Projekt: ${Se.item.name}`:Se.type==="absence"?`${Se.item.type}: ${(Oe=Se.item.employee)==null?void 0:Oe.first_name} ${(Fe=Se.item.employee)==null?void 0:Fe.last_name}`:`Termin: ${Se.item.title}`,children:[be>=3&&s.jsxs(s.Fragment,{children:[Se.type==="project"&&s.jsx(bc,{className:"w-1.5 h-1.5"}),Se.type==="absence"&&V(Se.item.type),Se.type==="event"&&s.jsx(Lt,{className:"w-1.5 h-1.5"})]}),s.jsx("div",{className:"absolute top-[-32px] left-0 bg-background border border-border rounded px-2 py-1 text-xs text-foreground shadow-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-30",children:Se.type==="project"?Se.item.name:Se.type==="absence"?`${Se.item.type}: ${(lt=Se.item.employee)==null?void 0:lt.first_name} ${(He=Se.item.employee)==null?void 0:He.last_name}`:Se.item.title})]},`${Se.type}-${Se.item.id||qe}`)})})},re)})]},pe))]})})},K=()=>{const te=t.getMonth(),J=t.getFullYear(),q=new Date(J,te+1,0).getDate(),ne=Array.from({length:q},(re,me)=>me+1),pe=m.filter(re=>{const me=re.status.toLowerCase();if(me==="aktiv"||me==="geplant"||me==="in bearbeitung")return!0;const ge=new Date(re.start_date),se=re.end_date?new Date(re.end_date):new Date,we=new Date(J,te,1),Se=new Date(J,te+1,0);return ge<=Se&&se>=we}),Q=(re,me)=>{const he=new Date(J,te,me);return w.filter(ge=>{const se=new Date(ge.start_date),we=ge.end_date?new Date(ge.end_date):se;return ge.project_id===re&&he>=se&&he<=we})};return s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"200px repeat("+q+", 1fr)"},children:[s.jsx("div",{className:"p-3 border-r border-border font-medium",children:"Projekt"}),ne.map(re=>s.jsxs("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:[s.jsx("div",{children:re}),s.jsx("div",{className:"text-muted-foreground",children:Ze(new Date(J,te,re),"EEE",{locale:sn})})]},re))]}),pe.length===0?s.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:["Keine aktiven Projekte in ",Ze(t,"MMMM yyyy",{locale:sn})]}):pe.map((re,me)=>s.jsxs("div",{className:`grid ${me%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"200px repeat("+q+", 1fr)"},children:[s.jsxs("div",{className:"p-3 border-r border-border",children:[s.jsx("div",{className:"font-medium text-sm",children:re.name}),s.jsx("div",{className:"text-xs text-muted-foreground",children:re.location}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx(Qe,{variant:"outline",className:"text-xs",children:re.status}),s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:re.color},title:`Projekt: ${re.name}`})]})]}),s.jsxs("div",{className:"relative h-20",style:{gridColumn:`2 / ${q+2}`},children:[s.jsx("div",{className:"absolute inset-0 grid",style:{gridTemplateColumns:`repeat(${q}, 1fr)`},children:ne.map(he=>s.jsx("div",{className:"border-r border-border last:border-r-0"},he))}),(()=>{const he=new Date(re.start_date),ge=re.end_date?new Date(re.end_date):he,se=new Date(J,te,1),we=new Date(J,te+1,0),Se=he<se?1:he.getDate(),qe=ge>we?q:ge.getDate();if(ge<se||he>we)return null;const Ye=(qe-Se+1)/q*100,Et=(Se-1)/q*100;return s.jsxs("div",{className:"absolute top-2 h-12 rounded-md flex items-center px-3 text-white text-sm font-medium shadow-md z-10",style:{left:`${Et}%`,width:`${Ye}%`,backgroundColor:re.color,minWidth:"60px"},title:`${re.name} (${Ze(he,"dd.MM.yyyy")} - ${Ze(ge,"dd.MM.yyyy")})`,children:[s.jsx(bc,{className:"w-4 h-4 mr-2 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:re.name}),s.jsx("div",{className:"ml-auto flex items-center space-x-1",children:s.jsxs("span",{className:"text-xs opacity-90",children:[Ze(he,"dd.MM")," - ",Ze(ge,"dd.MM")]})})]})})(),ne.map(he=>{const ge=Q(re.id,he);if(ge.length===0)return null;const se=(he-1)/q*100,we=1/q*100;return s.jsxs("div",{className:"absolute bottom-1 h-4 bg-blue-100 dark:bg-blue-900 border border-blue-300 dark:border-blue-700 rounded flex items-center justify-center",style:{left:`${se}%`,width:`${we-1}%`,minWidth:"20px"},title:`${ge.length} Mitarbeiter: ${ge.map(Se=>{var qe,Ye;return`${(qe=Se.employee)==null?void 0:qe.first_name} ${(Ye=Se.employee)==null?void 0:Ye.last_name} (${Se.hours_per_day}h)`}).join(", ")}`,children:[s.jsx(pr,{className:"w-2 h-2 text-blue-600 dark:text-blue-400"}),s.jsx("span",{className:"text-xs ml-1 text-blue-600 dark:text-blue-400",children:ge.length})]},`assignments-${he}`)})]})]},re.id))]})})},U=()=>{const te=t.getMonth(),J=t.getFullYear(),q=new Date(J,te+1,0).getDate(),ne=Array.from({length:q},(Q,re)=>re+1),pe=p.filter(Q=>Q.status==="aktiv");return s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"200px repeat("+q+", 1fr)"},children:[s.jsx("div",{className:"p-3 border-r border-border font-medium",children:"Mitarbeiter"}),ne.map(Q=>s.jsxs("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:[s.jsx("div",{children:Q}),s.jsx("div",{className:"text-muted-foreground",children:Ze(new Date(J,te,Q),"EEE",{locale:sn})})]},Q))]}),pe.length===0?s.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:["Keine aktiven Mitarbeiter in ",Ze(t,"MMMM yyyy",{locale:sn})]}):pe.map((Q,re)=>{const me=j.filter(he=>{const ge=new Date(he.start_date),se=new Date(he.end_date),we=new Date(J,te,1),Se=new Date(J,te+1,0);return he.employee_id===Q.id&&ge<=Se&&se>=we});return s.jsxs("div",{className:`grid ${re%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"200px repeat("+q+", 1fr)"},children:[s.jsxs("div",{className:"p-3 border-r border-border",children:[s.jsxs("div",{className:"font-medium text-sm",children:[Q.first_name," ",Q.last_name]}),s.jsx("div",{className:"text-xs text-muted-foreground",children:Q.position}),s.jsx("div",{className:"text-xs text-muted-foreground",children:Q.department})]}),s.jsxs("div",{className:"relative h-20",style:{gridColumn:`2 / ${q+2}`},children:[s.jsx("div",{className:"absolute inset-0 grid",style:{gridTemplateColumns:`repeat(${q}, 1fr)`},children:ne.map(he=>s.jsx("div",{className:"border-r border-border last:border-r-0"},he))}),me.map((he,ge)=>{const se=new Date(he.start_date),we=new Date(he.end_date),Se=new Date(J,te,1),qe=new Date(J,te+1,0),Ye=se<Se?1:se.getDate(),be=((we>qe?q:we.getDate())-Ye+1)/q*100,Oe=(Ye-1)/q*100,Fe=2+ge*16;return s.jsxs("div",{className:`absolute h-12 rounded-md flex items-center px-3 text-white text-xs font-medium shadow-md z-10 ${I(he.type)}`,style:{left:`${Oe}%`,width:`${be}%`,top:`${Fe}px`,minWidth:"60px"},title:`${he.type} (${Ze(se,"dd.MM.yyyy")} - ${Ze(we,"dd.MM.yyyy")}) - ${he.status}${he.reason?` - ${he.reason}`:""}`,children:[V(he.type),s.jsx("span",{className:"ml-2 truncate",children:he.type}),s.jsxs("div",{className:"ml-auto flex items-center space-x-1",children:[$(he.status),s.jsxs("span",{className:"text-xs opacity-90",children:[Ze(se,"dd.MM")," - ",Ze(we,"dd.MM")]})]})]},he.id)}),ne.map(he=>{const ge=w.filter(Se=>{const qe=new Date(Se.start_date),Ye=Se.end_date?new Date(Se.end_date):qe,Et=new Date(J,te,he);return Se.employee_id===Q.id&&Et>=qe&&Et<=Ye});if(ge.length===0)return null;const se=(he-1)/q*100,we=1/q*100;return s.jsxs("div",{className:"absolute bottom-1 h-4 bg-blue-100 dark:bg-blue-900 border border-blue-300 dark:border-blue-700 rounded flex items-center justify-center",style:{left:`${se}%`,width:`${we-1}%`,minWidth:"20px"},title:`${ge.length} Projekt(e): ${ge.map(Se=>{var qe;return`${(qe=Se.project)==null?void 0:qe.name} (${Se.hours_per_day}h)`}).join(", ")}`,children:[s.jsx(bc,{className:"w-2 h-2 text-blue-600 dark:text-blue-400"}),s.jsx("span",{className:"text-xs ml-1 text-blue-600 dark:text-blue-400",children:ge.length})]},`assignments-${he}`)})]})]},Q.id)})]})})};return S?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{children:"Lade Planerdaten..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-teal-600 bg-clip-text text-transparent flex items-center gap-3",children:[s.jsx(Lt,{className:"h-8 w-8 text-teal-600"}),"Planer"]}),s.jsxs(Qe,{variant:"outline",className:"flex items-center space-x-1",children:[s.jsx(Lt,{className:"w-4 h-4"}),s.jsx("span",{children:"Ressourcenplanung"})]})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[a==="overview"&&s.jsxs(s.Fragment,{children:[s.jsxs(mt,{value:d,onValueChange:u,children:[s.jsx(ht,{className:"w-48",children:s.jsx(pt,{placeholder:"Alle Abteilungen"})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"all",children:"Alle Abteilungen"}),F.map(te=>s.jsx(ye,{value:te,children:te},te))]})]}),s.jsxs(mt,{value:o,onValueChange:te=>c(te),children:[s.jsx(ht,{className:"w-40",children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"all",children:"Alle anzeigen"}),s.jsx(ye,{value:"projects",children:"Nur Projekte"}),s.jsx(ye,{value:"absences",children:"Nur Abwesenheiten"}),s.jsx(ye,{value:"events",children:"Nur Termine"})]})]})]}),s.jsxs(mt,{value:n,onValueChange:te=>r(te),children:[s.jsx(ht,{className:"w-32",children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"week",children:"Woche"}),s.jsx(ye,{value:"month",children:"Monat"})]})]}),s.jsx(ee,{onClick:P,variant:"outline",size:"sm",children:"Aktualisieren"})]})]}),s.jsxs(Is,{value:a,onValueChange:te=>i(te),children:[s.jsxs(js,{className:"grid w-full grid-cols-4",children:[s.jsxs(Je,{value:"overview",className:"flex items-center space-x-2",children:[s.jsx(Lt,{className:"w-4 h-4"}),s.jsx("span",{children:"Übersicht"})]}),s.jsxs(Je,{value:"projects",className:"flex items-center space-x-2",children:[s.jsx(bc,{className:"w-4 h-4"}),s.jsx("span",{children:"Projekte"})]}),s.jsxs(Je,{value:"employees",className:"flex items-center space-x-2",children:[s.jsx(bi,{className:"w-4 h-4"}),s.jsx("span",{children:"Mitarbeiter"})]}),s.jsxs(Je,{value:"resources",className:"flex items-center space-x-2",children:[s.jsx(Ci,{className:"w-4 h-4"}),s.jsx("span",{children:"Ressourcen"})]})]}),s.jsx(et,{value:"overview",className:"space-y-4",children:s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-4",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(Ce,{className:"flex items-center space-x-2",children:[s.jsx(an,{className:"w-5 h-5"}),s.jsx("span",{children:n==="week"?`${Ze(X,"dd.MM",{locale:sn})} - ${Ze(ue,"dd.MM.yyyy",{locale:sn})}`:Ze(t,"MMMM yyyy",{locale:sn})})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ee,{variant:"outline",size:"sm",onClick:de,children:s.jsx(rh,{className:"w-4 h-4"})}),s.jsxs($a,{children:[s.jsx(Ua,{asChild:!0,children:s.jsxs(ee,{variant:"outline",size:"sm",className:Te("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),Ze(t,"MMMM yyyy",{locale:sn})]})}),s.jsx(aa,{className:"w-auto p-0",align:"start",children:s.jsx(ia,{mode:"single",selected:t,onSelect:te=>te&&e(te),initialFocus:!0,className:Te("p-3 pointer-events-auto")})})]}),s.jsx(ee,{variant:"outline",size:"sm",onClick:G,children:s.jsx(jl,{className:"w-4 h-4"})})]})]})}),s.jsxs(ce,{children:[O(),s.jsxs("div",{className:"mt-6 space-y-3",children:[s.jsx("h4",{className:"font-medium",children:"Legende"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),s.jsx("span",{children:"Urlaub"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),s.jsx("span",{children:"Krank"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),s.jsx("span",{children:"Projekte/Fortbildung"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded"}),s.jsx("span",{children:"Elternzeit"})]})]}),s.jsx(mi,{}),s.jsxs("div",{className:"flex items-center space-x-6 text-xs",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Ts,{className:"w-4 h-4 text-green-500"}),s.jsx("span",{children:"Genehmigt"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(an,{className:"w-4 h-4 text-yellow-500"}),s.jsx("span",{children:"Beantragt"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Nl,{className:"w-4 h-4 text-red-500"}),s.jsx("span",{children:"Abgelehnt"})]})]})]})]})]})}),s.jsx(et,{value:"projects",children:s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-4",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(Ce,{className:"flex items-center space-x-2",children:[s.jsx(bc,{className:"w-5 h-5"}),s.jsxs("span",{children:["Projektkalender - ",Ze(t,"yyyy",{locale:sn})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ee,{variant:"outline",size:"sm",onClick:de,children:s.jsx(rh,{className:"w-4 h-4"})}),s.jsxs($a,{children:[s.jsx(Ua,{asChild:!0,children:s.jsxs(ee,{variant:"outline",size:"sm",className:Te("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),Ze(t,"MMMM yyyy",{locale:sn})]})}),s.jsx(aa,{className:"w-auto p-0",align:"start",children:s.jsx(ia,{mode:"single",selected:t,onSelect:te=>te&&e(te),initialFocus:!0,className:Te("p-3 pointer-events-auto")})})]}),s.jsx(ee,{variant:"outline",size:"sm",onClick:G,children:s.jsx(jl,{className:"w-4 h-4"})})]})]})}),s.jsx(ce,{children:K()})]})}),s.jsx(et,{value:"employees",children:s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-4",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(Ce,{className:"flex items-center space-x-2",children:[s.jsx(bi,{className:"w-5 h-5"}),s.jsxs("span",{children:["Mitarbeiterkalender - ",Ze(t,"yyyy",{locale:sn})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ee,{variant:"outline",size:"sm",onClick:de,children:s.jsx(rh,{className:"w-4 h-4"})}),s.jsxs($a,{children:[s.jsx(Ua,{asChild:!0,children:s.jsxs(ee,{variant:"outline",size:"sm",className:Te("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),Ze(t,"MMMM yyyy",{locale:sn})]})}),s.jsx(aa,{className:"w-auto p-0",align:"start",children:s.jsx(ia,{mode:"single",selected:t,onSelect:te=>te&&e(te),initialFocus:!0,className:Te("p-3 pointer-events-auto")})})]}),s.jsx(ee,{variant:"outline",size:"sm",onClick:G,children:s.jsx(jl,{className:"w-4 h-4"})})]})]})}),s.jsx(ce,{children:U()})]})}),s.jsx(et,{value:"resources",children:s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Ressourcenplanung"})}),s.jsx(ce,{children:s.jsx("p",{className:"text-muted-foreground",children:"Ressourcenplanung wird hier implementiert..."})})]})})]})]})},Ete=t=>{const e=Math.floor(t/60),n=t%60;return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`};/*! Capacitor: https://capacitorjs.com/ - MIT License */var Dd;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Dd||(Dd={}));class Sy extends Error{constructor(e,n,r){super(e),this.message=e,this.code=n,this.data=r}}const Ate=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Pte=t=>{const e=t.CapacitorCustomPlatform||null,n=t.Capacitor||{},r=n.Plugins=n.Plugins||{},a=()=>e!==null?e.name:Ate(t),i=()=>a()!=="web",o=f=>{const p=u.get(f);return!!(p!=null&&p.platforms.has(a())||c(f))},c=f=>{var p;return(p=n.PluginHeaders)===null||p===void 0?void 0:p.find(x=>x.name===f)},d=f=>t.console.error(f),u=new Map,m=(f,p={})=>{const x=u.get(f);if(x)return console.warn(`Capacitor plugin "${f}" already registered. Cannot register plugins twice.`),x.proxy;const j=a(),v=c(f);let _;const b=async()=>(!_&&j in p?_=typeof p[j]=="function"?_=await p[j]():_=p[j]:e!==null&&!_&&"web"in p&&(_=typeof p.web=="function"?_=await p.web():_=p.web),_),w=(M,z)=>{var R,D;if(v){const B=v==null?void 0:v.methods.find(W=>z===W.name);if(B)return B.rtype==="promise"?W=>n.nativePromise(f,z.toString(),W):(W,X)=>n.nativeCallback(f,z.toString(),W,X);if(M)return(R=M[z])===null||R===void 0?void 0:R.bind(M)}else{if(M)return(D=M[z])===null||D===void 0?void 0:D.bind(M);throw new Sy(`"${f}" plugin is not implemented on ${j}`,Dd.Unimplemented)}},N=M=>{let z;const R=(...D)=>{const B=b().then(W=>{const X=w(W,M);if(X){const ue=X(...D);return z=ue==null?void 0:ue.remove,ue}else throw new Sy(`"${f}.${M}()" is not implemented on ${j}`,Dd.Unimplemented)});return M==="addListener"&&(B.remove=async()=>z()),B};return R.toString=()=>`${M.toString()}() { [capacitor code] }`,Object.defineProperty(R,"name",{value:M,writable:!1,configurable:!1}),R},S=N("addListener"),C=N("removeListener"),A=(M,z)=>{const R=S({eventName:M},z),D=async()=>{const W=await R;C({eventName:M,callbackId:W},z)},B=new Promise(W=>R.then(()=>W({remove:D})));return B.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await D()},B},P=new Proxy({},{get(M,z){switch(z){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return v?A:S;case"removeListener":return C;default:return N(z)}}});return r[f]=P,u.set(f,{name:f,proxy:P,platforms:new Set([...Object.keys(p),...v?[j]:[]])}),P};return n.convertFileSrc||(n.convertFileSrc=f=>f),n.getPlatform=a,n.handleError=d,n.isNativePlatform=i,n.isPluginAvailable=o,n.registerPlugin=m,n.Exception=Sy,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},Dte=t=>t.Capacitor=Pte(t),T0=Dte(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Yl=T0.registerPlugin;class PI{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(n);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,n);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,r){const a=this.listeners[e];if(!a){if(r){let i=this.retainedEventArguments[e];i||(i=[]),i.push(n),this.retainedEventArguments[e]=i}return}a.forEach(i=>i(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(e="not implemented"){return new T0.Exception(e,Dd.Unimplemented)}unavailable(e="not available"){return new T0.Exception(e,Dd.Unavailable)}async removeListener(e,n){const r=this.listeners[e];if(!r)return;const a=r.indexOf(n);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(r=>{this.notifyListeners(e,r)}))}}const GC=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),QC=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Tte extends PI{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[a,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=QC(a).trim(),i=QC(i).trim(),n[a]=i}),n}async setCookie(e){try{const n=GC(e.key),r=GC(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${a}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Yl("CapacitorCookies",{web:()=>new Tte});const Mte=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const a=r.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},r.onerror=a=>n(a),r.readAsDataURL(t)}),Rte=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(a=>a.toLocaleLowerCase()).reduce((a,i,o)=>(a[i]=t[e[o]],a),{})},Ite=(t,e=!0)=>t?Object.entries(t).reduce((r,a)=>{const[i,o]=a;let c,d;return Array.isArray(o)?(d="",o.forEach(u=>{c=e?encodeURIComponent(u):u,d+=`${i}=${c}&`}),d.slice(0,-1)):(c=e?encodeURIComponent(o):o,d=`${i}=${c}`),`${r}&${d}`},"").substr(1):null,Ote=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),a=Rte(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(a.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,c]of Object.entries(t.data||{}))i.set(o,c);n.body=i.toString()}else if(a.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((c,d)=>{i.append(d,c)});else for(const c of Object.keys(t.data))i.append(c,t.data[c]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(a.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class Lte extends PI{async request(e){const n=Ote(e,e.webFetchExtra),r=Ite(e.params,e.shouldEncodeUrlParams),a=r?`${e.url}?${r}`:e.url,i=await fetch(a,n),o=i.headers.get("content-type")||"";let{responseType:c="text"}=i.ok?e:{};o.includes("application/json")&&(c="json");let d,u;switch(c){case"arraybuffer":case"blob":u=await i.blob(),d=await Mte(u);break;case"json":d=await i.json();break;case"document":case"text":default:d=await i.text()}const m={};return i.headers.forEach((f,p)=>{m[p]=f}),{data:d,headers:m,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Yl("CapacitorHttp",{web:()=>new Lte});function Fte(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,n){return new Proxy({},{get(r,a){return(i,o,c)=>{const d=t.Capacitor.Plugins[n];if(d===void 0){c(new Error(`Capacitor plugin ${n} not found`));return}if(typeof d[a]!="function"){c(new Error(`Method ${a} not found in Capacitor plugin ${n}`));return}(async()=>{try{const u=await d[a](i);o(u)}catch(u){c(u)}})()}}})}})}function Bte(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,n){return t.cordova.plugins[n]}})}function zte(t=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!t?Fte(window):window.cordova!==void 0&&Bte(window))}const $te=Yl("Geolocation",{web:()=>Vd(()=>import("./web-CTny9G-c.js"),[]).then(t=>new t.GeolocationWeb)});zte();class Ute{constructor(){qn(this,"dbName","TimeTrackingOfflineDB");qn(this,"dbVersion",1);qn(this,"storeName","timeEntries")}async initDB(){return new Promise((e,n)=>{const r=indexedDB.open(this.dbName,this.dbVersion);r.onerror=()=>n(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=a=>{const i=a.target.result;if(!i.objectStoreNames.contains(this.storeName)){const o=i.createObjectStore(this.storeName,{keyPath:"id"});o.createIndex("status","status",{unique:!1}),o.createIndex("offline_created_at","offline_created_at",{unique:!1})}}})}async saveOfflineEntry(e){const a=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((i,o)=>{const c=a.put(e);c.onerror=()=>o(c.error),c.onsuccess=()=>i()})}async getOfflineEntries(){const r=(await this.initDB()).transaction([this.storeName],"readonly").objectStore(this.storeName);return new Promise((a,i)=>{const o=r.getAll();o.onerror=()=>i(o.error),o.onsuccess=()=>a(o.result)})}async removeOfflineEntry(e){const a=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((i,o)=>{const c=a.delete(e);c.onerror=()=>o(c.error),c.onsuccess=()=>i()})}async clearOfflineEntries(){const r=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((a,i)=>{const o=r.clear();o.onerror=()=>i(o.error),o.onsuccess=()=>a()})}}class qte{async getCurrentPosition(){try{const e=await $te.getCurrentPosition({enableHighAccuracy:!0,timeout:1e4}),n={lat:e.coords.latitude,lng:e.coords.longitude},r=await this.reverseGeocode(n.lat,n.lng);return{...n,address:r}}catch(e){throw console.error("Fehler beim Abrufen der GPS-Position:",e),new Error("GPS-Position konnte nicht ermittelt werden")}}async reverseGeocode(e,n){try{const r=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${n}&zoom=18&addressdetails=1`);if(!r.ok)throw new Error("Geocoding fehlgeschlagen");const a=await r.json(),i=[];return a.address.house_number&&i.push(a.address.house_number),a.address.road&&i.push(a.address.road),(a.address.city||a.address.town||a.address.village)&&i.push(a.address.city||a.address.town||a.address.village),i.length>0?i.join(", "):"Unbekannte Adresse"}catch(r){return console.warn("Reverse Geocoding fehlgeschlagen:",r),`${e.toFixed(6)}, ${n.toFixed(6)}`}}calculateDistance(e,n){const a=this.toRad(n.lat-e.lat),i=this.toRad(n.lng-e.lng),o=this.toRad(e.lat),c=this.toRad(n.lat),d=Math.sin(a/2)*Math.sin(a/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(o)*Math.cos(c);return 6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))*1e3}toRad(e){return e*(Math.PI/180)}isWithinRadius(e,n,r){return this.calculateDistance(e,n)<=r}}class ky{static isOnline(){return navigator.onLine}static onStatusChange(e){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n),window.addEventListener("offline",r),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}static async registerServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/sw.js");return console.log("Service Worker registriert:",e),e}catch(e){return console.error("Service Worker Registrierung fehlgeschlagen:",e),null}return null}static async triggerBackgroundSync(e){if("serviceWorker"in navigator&&navigator.serviceWorker.controller)try{const n=await navigator.serviceWorker.ready;n&&"sync"in n&&await n.sync.register(e)}catch(n){console.error("Background Sync fehlgeschlagen:",n)}}}const Wte=({open:t,onOpenChange:e,timeEntry:n,projects:r,onSave:a})=>{var z,R;const[i,o]=g.useState(""),[c,d]=g.useState(""),[u,m]=g.useState(""),[f,p]=g.useState(""),[x,j]=g.useState(0),[v,_]=g.useState(""),[b,w]=g.useState(""),[N,S]=g.useState(""),[C,A]=g.useState(!1),{toast:P}=Mt();g.useEffect(()=>{if(n){const D=Uc(n.start_time);if(o(Ze(D,"yyyy-MM-dd")),d(Ze(D,"HH:mm")),n.end_time){const B=Uc(n.end_time);m(Ze(B,"yyyy-MM-dd")),p(Ze(B,"HH:mm"))}else m(""),p("");j(n.break_duration||0),_(n.project_id||""),w(n.description||""),S(n.status)}},[n]);const M=async()=>{if(n){A(!0);try{const D=new Date(`${i}T${c}`).toISOString();let B=null;u&&f&&(B=new Date(`${u}T${f}`).toISOString());const W={start_time:D,end_time:B,break_duration:x,project_id:v||null,description:b||null,status:N},{error:X}=await Z.from("time_entries").update(W).eq("id",n.id);if(X)throw X;P({title:"Zeiteintrag aktualisiert",description:"Die Änderungen wurden erfolgreich gespeichert."}),a(),e(!1)}catch(D){console.error("Error updating time entry:",D),P({title:"Fehler beim Speichern",description:"Die Änderungen konnten nicht gespeichert werden.",variant:"destructive"})}finally{A(!1)}}};return n?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-2xl",children:[s.jsx(Jt,{children:s.jsxs(en,{children:["Zeiteintrag bearbeiten - ",(z=n.employee)==null?void 0:z.first_name," ",(R=n.employee)==null?void 0:R.last_name]})}),s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"start-date",children:"Startdatum"}),s.jsx(ae,{id:"start-date",type:"date",value:i,onChange:D=>o(D.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"start-time",children:"Startzeit"}),s.jsx(ae,{id:"start-time",type:"time",value:c,onChange:D=>d(D.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"end-date",children:"Enddatum"}),s.jsx(ae,{id:"end-date",type:"date",value:u,onChange:D=>m(D.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"end-time",children:"Endzeit"}),s.jsx(ae,{id:"end-time",type:"time",value:f,onChange:D=>p(D.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"break-duration",children:"Pausenzeit (Minuten)"}),s.jsx(ae,{id:"break-duration",type:"number",min:"0",value:x,onChange:D=>j(parseInt(D.target.value)||0)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"status",children:"Status"}),s.jsxs(mt,{value:N,onValueChange:S,children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"aktiv",children:"Aktiv"}),s.jsx(ye,{value:"pausiert",children:"Pausiert"}),s.jsx(ye,{value:"beendet",children:"Beendet"})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"project",children:"Projekt"}),s.jsxs(mt,{value:v,onValueChange:_,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Projekt auswählen"})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"",children:"Kein Projekt"}),r.map(D=>s.jsx(ye,{value:D.id,children:D.name},D.id))]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"description",children:"Beschreibung"}),s.jsx(cn,{id:"description",placeholder:"Beschreibung der Tätigkeit...",value:b,onChange:D=>w(D.target.value)})]})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(ee,{variant:"outline",onClick:()=>e(!1),children:"Abbrechen"}),s.jsx(ee,{onClick:M,disabled:C,children:C?"Speichere...":"Speichern"})]})]})}):null},Hte=()=>{var Et;const{toast:t}=Mt(),{userRole:e}=jg(),{data:n,isLoading:r}=GZ(),{data:a,isLoading:i}=lR(),{data:o,isLoading:c}=o1(),d=QZ(),u=YZ(),m=(n==null?void 0:n.items)||[],f=(a==null?void 0:a.items)||[],p=(o==null?void 0:o.items)||[],[x,j]=g.useState([]),[v,_]=g.useState([]);g.useState([]);const[b,w]=g.useState(null),[N,S]=g.useState(ky.isOnline()),[C,A]=g.useState(new Date);g.useState("");const[P,M]=g.useState("all"),[z,R]=g.useState("all"),[D,B]=g.useState(!1),[W,X]=g.useState(!1);g.useState(!1),g.useState(null);const[ue,de]=g.useState(""),[G,I]=g.useState(!1),[V,$]=g.useState(null),F=m.find(be=>be.status==="aktiv")||null,O=r||i||c,K=new Ute,U=new qte;g.useEffect(()=>(ky.registerServiceWorker(),ky.onStatusChange(Oe=>{S(Oe),Oe?(J(),t({title:"Wieder online",description:"Synchronisiere Offline-Daten..."})):t({title:"Offline-Modus",description:"Zeiteinträge werden lokal gespeichert.",variant:"destructive"})})),[]),g.useEffect(()=>{te(),q(),ne()},[C,P,z]);const te=async()=>{const{data:{user:be}}=await Z.auth.getUser();if(!be)return;const{data:Oe,error:Fe}=await Z.from("profiles").select("*").eq("id",be.id).single();if(Fe)throw t({title:"Profil konnte nicht geladen werden",description:Fe.message,variant:"destructive"}),Fe;w(Oe)},J=async()=>{var be,Oe,Fe,lt,He,Le;try{const Nt=await K.getOfflineEntries();for(const xt of Nt)try{d.mutate({employee_id:xt.employee_id,project_id:xt.project_id,start_time:xt.start_time,end_time:xt.end_time,description:xt.description,status:xt.status,start_location_lat:(be=xt.start_location)==null?void 0:be.lat,start_location_lng:(Oe=xt.start_location)==null?void 0:Oe.lng,start_location_address:(Fe=xt.start_location)==null?void 0:Fe.address,end_location_lat:(lt=xt.end_location)==null?void 0:lt.lat,end_location_lng:(He=xt.end_location)==null?void 0:He.lng,end_location_address:(Le=xt.end_location)==null?void 0:Le.address,is_offline_synced:!0,offline_created_at:xt.offline_created_at},{onSuccess:()=>{K.removeOfflineEntry(xt.id)}})}catch(Un){console.error("Error syncing offline entry:",Un)}Nt.length>0&&t({title:"Synchronisation abgeschlossen",description:`${Nt.length} Offline-Einträge wurden synchronisiert.`})}catch(Nt){console.error("Error syncing offline entries:",Nt)}},q=async()=>{const{data:be,error:Oe}=await Z.from("working_hours_config").select("*").order("is_default",{ascending:!1});if(Oe)throw Oe;_(be||[])},ne=async()=>{const be=Ze(C,"yyyy-MM"),{data:Oe,error:Fe}=await Z.from("employee_absences").select("*").gte("start_date",`${be}-01`).lte("end_date",`${be}-31`).eq("status","genehmigt");if(Fe)throw Fe;j(Oe||[])},pe=async(be,Oe)=>{if(!b){t({title:"Fehler",description:"Kein Mitarbeiter gefunden.",variant:"destructive"});return}if(F){t({title:"Zeiterfassung bereits aktiv",description:"Beenden Sie zuerst die aktuelle Zeiterfassung.",variant:"destructive"});return}let Fe;try{Fe=await U.getCurrentPosition()}catch(He){console.warn("GPS location not available:",He)}const lt={employee_id:b.id,project_id:be||null,start_time:new Date().toISOString(),description:Oe||null,status:"aktiv",start_location_lat:Fe==null?void 0:Fe.lat,start_location_lng:Fe==null?void 0:Fe.lng,start_location_address:Fe==null?void 0:Fe.address};if(!N){const He={id:crypto.randomUUID(),employee_id:b.id,project_id:be||void 0,start_time:new Date().toISOString(),description:Oe||void 0,status:"aktiv",start_location:Fe,offline_created_at:new Date().toISOString()};await K.saveOfflineEntry(He),t({title:"Offline gespeichert",description:"Zeiterfassung wird bei der nächsten Verbindung synchronisiert."});return}d.mutate(lt,{onSuccess:He=>{B(!1),t({title:"Zeiterfassung gestartet",description:Fe?`Gestartet an: ${Fe.address}`:"Die Zeiterfassung wurde erfolgreich gestartet."})},onError:()=>{t({title:"Fehler beim Starten",description:"Die Zeiterfassung konnte nicht gestartet werden.",variant:"destructive"})}})},Q=async()=>{if(!F)return;let be;try{be=await U.getCurrentPosition()}catch(Fe){console.warn("GPS location not available:",Fe)}const Oe={end_time:new Date().toISOString(),status:"beendet",end_location_lat:be==null?void 0:be.lat,end_location_lng:be==null?void 0:be.lng,end_location_address:be==null?void 0:be.address};u.mutate({id:F.id,data:Oe},{onSuccess:()=>{t({title:"Zeiterfassung beendet",description:be?`Beendet an: ${be.address}`:"Die Zeiterfassung wurde erfolgreich beendet."})},onError:()=>{t({title:"Fehler beim Stoppen",description:"Die Zeiterfassung konnte nicht gestoppt werden.",variant:"destructive"})}})},re=async()=>{if(!F)return;const be=F.status==="aktiv"?"pausiert":"aktiv";u.mutate({id:F.id,data:{status:be}},{onError:()=>{t({title:"Fehler",description:"Der Status konnte nicht geändert werden.",variant:"destructive"})}})},me=async(be,Oe,Fe)=>{if(!e||e!=="manager"){t({title:"Keine Berechtigung",description:"Nur Manager können Zeiterfassung für andere starten.",variant:"destructive"});return}const{data:lt}=await Z.from("time_entries").select("*").eq("employee_id",be).eq("status","aktiv").single();if(lt){t({title:"Zeiterfassung bereits aktiv",description:"Dieser Mitarbeiter hat bereits eine aktive Zeiterfassung.",variant:"destructive"});return}d.mutate({employee_id:be,project_id:Oe||null,start_time:new Date().toISOString(),description:Fe||null,status:"aktiv"},{onSuccess:He=>{var Le,Nt;t({title:"Zeiterfassung gestartet",description:`Zeiterfassung für ${(Le=He.employee)==null?void 0:Le.first_name} ${(Nt=He.employee)==null?void 0:Nt.last_name} wurde gestartet.`})},onError:()=>{t({title:"Fehler beim Starten",description:"Die Zeiterfassung konnte nicht gestartet werden.",variant:"destructive"})}})},he=async(be,Oe)=>{if(!e||e!=="manager"){t({title:"Keine Berechtigung",description:"Nur Manager können Arbeitszeiten ändern.",variant:"destructive"});return}const{data:Fe}=await Z.from("working_hours_config").select("*").eq("employee_id",be).single();if(Fe){const{error:lt}=await Z.from("working_hours_config").update(Oe).eq("id",Fe.id);if(lt){t({title:"Fehler beim Aktualisieren",description:"Die Arbeitszeiten konnten nicht aktualisiert werden.",variant:"destructive"});return}}else{const{error:lt}=await Z.from("working_hours_config").insert({employee_id:be,...Oe});if(lt){t({title:"Fehler beim Erstellen",description:"Die Arbeitszeiten konnten nicht erstellt werden.",variant:"destructive"});return}}q(),X(!1),t({title:"Arbeitszeiten aktualisiert",description:"Die Arbeitszeiten wurden erfolgreich gespeichert."})},ge=be=>v.find(Oe=>Oe.employee_id===be)||v.find(Oe=>Oe.is_default),se=()=>{const[be,Oe]=g.useState("08:00"),[Fe,lt]=g.useState("17:00"),[He,Le]=g.useState(30),[Nt,xt]=g.useState([1,2,3,4,5]);g.useEffect(()=>{if(ue){const yt=ge(ue);yt&&(Oe(yt.start_time.slice(0,5)),lt(yt.end_time.slice(0,5)),Le(yt.break_duration),xt(yt.working_days))}},[ue]);const Un=()=>{he(ue==="default"?null:ue,{start_time:be+":00",end_time:Fe+":00",break_duration:He,working_days:Nt,is_default:ue==="default"})},gs=yt=>{xt(dn=>dn.includes(yt)?dn.filter(Tn=>Tn!==yt):[...dn,yt].sort())};return s.jsx(Kt,{open:W,onOpenChange:X,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsx(Jt,{children:s.jsx(en,{children:"Arbeitszeiten konfigurieren"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{children:"Mitarbeiter"}),s.jsxs(mt,{value:ue,onValueChange:de,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Mitarbeiter wählen..."})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"default",children:"Standard (alle Mitarbeiter)"}),p.map(yt=>s.jsxs(ye,{value:yt.id,children:[yt.first_name," ",yt.last_name]},yt.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(Y,{children:"Arbeitsbeginn"}),s.jsx(ae,{type:"time",value:be,onChange:yt=>Oe(yt.target.value)})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Arbeitsende"}),s.jsx(ae,{type:"time",value:Fe,onChange:yt=>lt(yt.target.value)})]})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Pausendauer (Minuten)"}),s.jsx(ae,{type:"number",value:He,onChange:yt=>Le(Number(yt.target.value)),min:"0",max:"120"})]}),s.jsxs("div",{children:[s.jsx(Y,{children:"Arbeitstage"}),s.jsx("div",{className:"flex gap-2 mt-2",children:[{value:1,label:"Mo"},{value:2,label:"Di"},{value:3,label:"Mi"},{value:4,label:"Do"},{value:5,label:"Fr"},{value:6,label:"Sa"},{value:7,label:"So"}].map(yt=>s.jsx(ee,{variant:Nt.includes(yt.value)?"default":"outline",size:"sm",onClick:()=>gs(yt.value),children:yt.label},yt.value))})]}),s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx(ee,{variant:"outline",onClick:()=>X(!1),children:"Abbrechen"}),s.jsx(ee,{onClick:Un,disabled:!ue,children:"Speichern"})]})]})]})})},we=()=>{const[be,Oe]=g.useState(""),[Fe,lt]=g.useState(""),[He,Le]=g.useState(""),Nt=()=>{be&&(me(be,Fe==="none"?void 0:Fe||void 0,He||void 0),Oe(""),lt(""),Le(""),B(!1))};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"employee",children:"Mitarbeiter"}),s.jsxs(mt,{value:be,onValueChange:Oe,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Mitarbeiter auswählen..."})}),s.jsx(ft,{children:p.map(xt=>s.jsxs(ye,{value:xt.id,children:[xt.first_name," ",xt.last_name]},xt.id))})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"project",children:"Projekt (optional)"}),s.jsxs(mt,{value:Fe,onValueChange:lt,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Projekt auswählen..."})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"none",children:"Kein Projekt"}),f.map(xt=>s.jsx(ye,{value:xt.id,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:xt.color}}),xt.name]})},xt.id))]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"description",children:"Beschreibung (optional)"}),s.jsx(cn,{id:"description",value:He,onChange:xt=>Le(xt.target.value),placeholder:"Beschreibung der Tätigkeit..."})]}),s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx(ee,{variant:"outline",onClick:()=>B(!1),children:"Abbrechen"}),s.jsxs(ee,{onClick:Nt,disabled:!be,children:[s.jsx(Pu,{className:"w-4 h-4 mr-2"}),"Starten"]})]})]})},Se=(be,Oe)=>{const Fe=Uc(be),He=DC(new Date,Fe),Le=Math.floor(He/60),Nt=He%60;return`${Le}:${Nt.toString().padStart(2,"0")}h`},qe=()=>m.reduce((be,Oe)=>{if(Oe.status==="beendet"&&Oe.end_time){const Fe=Uc(Oe.start_time),lt=Uc(Oe.end_time);return be+DC(lt,Fe)}return be},0),Ye=()=>{const[be,Oe]=g.useState(""),[Fe,lt]=g.useState(""),He=()=>{pe(Fe==="none"?void 0:Fe||void 0,be||void 0),Oe(""),lt("")};return s.jsx(Kt,{open:D,onOpenChange:B,children:s.jsxs(Wt,{children:[s.jsx(Jt,{children:s.jsx(en,{children:e==="manager"?"Zeiterfassung starten":"Neue Zeiterfassung starten"})}),e==="manager"?s.jsx(we,{}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"project",children:"Projekt (optional)"}),s.jsxs(mt,{value:Fe,onValueChange:lt,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Projekt auswählen..."})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"none",children:"Kein Projekt"}),f.map(Le=>s.jsx(ye,{value:Le.id,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Le.color}}),Le.name]})},Le.id))]})]})]}),s.jsxs("div",{children:[s.jsx(Y,{htmlFor:"description",children:"Beschreibung (optional)"}),s.jsx(cn,{id:"description",value:be,onChange:Le=>Oe(Le.target.value),placeholder:"Was arbeiten Sie?"})]}),s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx(ee,{variant:"outline",onClick:()=>B(!1),children:"Abbrechen"}),s.jsxs(ee,{onClick:He,children:[s.jsx(Pu,{className:"w-4 h-4 mr-2"}),"Starten"]})]})]})]})})};return O?s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(dt,{className:"h-8 w-48"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx(dt,{className:"h-10 w-32"}),s.jsx(dt,{className:"h-10 w-40"})]})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl",children:[s.jsx(Ne,{className:"pb-2",children:s.jsx(dt,{className:"h-6 w-48"})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(dt,{className:"h-6 w-32 mb-2"}),s.jsx(dt,{className:"h-4 w-24"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx(dt,{className:"h-8 w-16 mb-2"}),s.jsx(dt,{className:"h-6 w-20"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(dt,{className:"h-10 flex-1"}),s.jsx(dt,{className:"h-10 flex-1"})]})]})})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl",children:[s.jsx(Ne,{className:"pb-2",children:s.jsx(dt,{className:"h-6 w-32"})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx(dt,{className:"h-10 w-full"}),s.jsx("div",{className:"space-y-3",children:Array(3).fill(0).map((be,Oe)=>s.jsx("div",{className:"border rounded-xl p-4",children:s.jsx(dt,{className:"h-16 w-full"})},Oe))})]})})]})]}):s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Zeiterfassung"}),s.jsxs("div",{className:"flex items-center gap-4",children:[e==="manager"&&s.jsxs(ee,{variant:"outline",onClick:()=>X(!0),className:"rounded-full",children:[s.jsx(Co,{className:"h-4 w-4 mr-2"}),"Arbeitszeiten"]}),s.jsxs(ee,{onClick:()=>B(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),e==="manager"?"Zeiterfassung starten":"Meine Zeiterfassung"]})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Heute erfasst"}),s.jsx("p",{className:"text-2xl font-bold",children:Ete(qe())})]}),s.jsx(an,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Aktive Mitarbeiter"}),s.jsx("p",{className:"text-2xl font-bold",children:m.filter(be=>be.status==="aktiv").length})]}),s.jsx(bi,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Pausierte"}),s.jsx("p",{className:"text-2xl font-bold",children:m.filter(be=>be.status==="pausiert").length})]}),s.jsx(M_,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),s.jsx("p",{className:"text-2xl font-bold",children:N?"Online":"Offline"})]}),N?s.jsx(dP,{className:"h-8 w-8 text-purple-500 opacity-50"}):s.jsx(Xb,{className:"h-8 w-8 text-red-500 opacity-50"})]})})})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl",children:[s.jsx(Ne,{className:"pb-2",children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(an,{className:"w-5 h-5"}),"Aktuelle Zeiterfassung"]})}),s.jsx(ce,{children:F?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-lg font-medium",children:((Et=F.project)==null?void 0:Et.name)||"Allgemeine Arbeitszeit"}),s.jsxs("p",{className:"text-muted-foreground",children:["Gestartet: ",Ze(Uc(F.start_time),"HH:mm",{locale:sn})]}),F.description&&s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:F.description})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-2xl font-bold",children:Se(F.start_time)}),s.jsx(Qe,{variant:F.status==="aktiv"?"default":"secondary",children:F.status==="aktiv"?"Aktiv":"Pausiert"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ee,{variant:"outline",onClick:re,className:"flex-1 rounded-xl",children:F.status==="aktiv"?s.jsxs(s.Fragment,{children:[s.jsx(M_,{className:"w-4 h-4 mr-2"}),"Pausieren"]}):s.jsxs(s.Fragment,{children:[s.jsx(Pu,{className:"w-4 h-4 mr-2"}),"Fortsetzen"]})}),s.jsxs(ee,{variant:"destructive",onClick:Q,className:"flex-1 rounded-xl",children:[s.jsx(Qb,{className:"w-4 h-4 mr-2"}),"Beenden"]})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(an,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Keine aktive Zeiterfassung"}),s.jsxs(ee,{onClick:()=>B(!0),children:[s.jsx(Pu,{className:"w-4 h-4 mr-2"}),"Zeiterfassung starten"]})]})})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl",children:[s.jsx(Ne,{className:"pb-2",children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(an,{className:"w-5 h-5"}),"Zeiterfassung"]})}),s.jsx(ce,{children:(()=>{const be=Ze(C,"yyyy-MM"),Oe=m.filter(Le=>{const Nt=Ze(new Date(Le.start_time),"yyyy-MM")===be,xt=z==="all"||!z||Le.employee_id===z;return Nt&&xt}),Fe=Oe.reduce((Le,Nt)=>{if(Nt.end_time){const xt=(new Date(Nt.end_time).getTime()-new Date(Nt.start_time).getTime())/36e5;return Le+xt}return Le},0),lt=Oe.reduce((Le,Nt)=>{const xt=Ze(new Date(Nt.start_time),"yyyy-MM-dd");return Le[xt]||(Le[xt]=[]),Le[xt].push(Nt),Le},{}),He=p.find(Le=>Le.id===z);return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex gap-4 items-end",children:s.jsxs("div",{className:"flex-1",children:[s.jsx(Y,{children:"Mitarbeiter auswählen"}),s.jsxs(mt,{value:z||"all",onValueChange:R,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Mitarbeiter wählen..."})}),s.jsxs(ft,{className:"bg-background border shadow-lg z-50",children:[s.jsx(ye,{value:"all",children:"Alle Mitarbeiter"}),p.length>0?p.map(Le=>s.jsxs(ye,{value:Le.id,children:[Le.first_name," ",Le.last_name]},Le.id)):s.jsx(ye,{value:"loading",disabled:!0,children:"Lade Mitarbeiter..."})]})]})]})}),s.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 p-4 rounded-lg border",children:[s.jsxs("h3",{className:"font-semibold text-lg mb-2",children:["Monatsübersicht ",Ze(C,"MMMM yyyy",{locale:sn}),He&&s.jsxs("span",{className:"text-base font-normal ml-2",children:["- ",He.first_name," ",He.last_name]})]}),s.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Fe.toFixed(1)," Stunden"]})]}),z&&z!=="all"?s.jsxs("div",{className:"space-y-3",children:[(()=>{const Le=new Date(C),Nt=Le.getFullYear(),xt=Le.getMonth(),Un=new Date(Nt,xt+1,0).getDate(),gs=[];for(let yt=1;yt<=Un;yt++){const dn=new Date(Nt,xt,yt),Tn=Ze(dn,"yyyy-MM-dd"),rs=dn.getDay(),Mn=rs===0||rs===6,bn=lt[Tn],je=x.some(_e=>{const $e=new Date(_e.start_date),Me=new Date(_e.end_date),Ee=new Date(Tn);return _e.employee_id===z&&_e.type==="urlaub"&&Ee>=$e&&Ee<=Me});gs.push({date:Tn,dateObject:dn,isWeekend:Mn,hasEntries:bn,isOnVacation:je,entries:bn||[]})}return gs.sort((yt,dn)=>new Date(dn.date).getTime()-new Date(yt.date).getTime()).map(({date:yt,dateObject:dn,isWeekend:Tn,hasEntries:rs,isOnVacation:Mn,entries:bn})=>{if(Mn&&!rs)return s.jsx("div",{className:"border rounded-lg overflow-hidden bg-yellow-50/50 border-yellow-200",children:s.jsx("div",{className:"bg-yellow-100/50 p-4 border-b",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h4",{className:"font-semibold text-yellow-800",children:Ze(dn,"EEEE, dd.MM.yyyy",{locale:sn})}),s.jsx("div",{className:"text-right",children:s.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-200 text-yellow-800",children:"Urlaub"})})]})})},yt);if(Tn&&!rs)return s.jsx("div",{className:"border rounded-lg overflow-hidden bg-gray-50/50",children:s.jsx("div",{className:"bg-gray-100/50 p-4 border-b",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h4",{className:"font-semibold text-gray-600",children:Ze(dn,"EEEE, dd.MM.yyyy",{locale:sn})}),s.jsx("div",{className:"text-right",children:s.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:"Freier Tag"})})]})})},yt);if(!rs)return null;const _e=bn.reduce((Ee,it)=>{if(it.end_time){const pn=new Date(it.end_time).getTime()-new Date(it.start_time).getTime();return Ee+pn/(1e3*60)}return Ee},0)/60,$e=bn.sort((Ee,it)=>new Date(Ee.start_time).getTime()-new Date(it.start_time).getTime())[0],Me=bn.sort((Ee,it)=>new Date(it.end_time||it.start_time).getTime()-new Date(Ee.end_time||Ee.start_time).getTime())[0];return s.jsxs("div",{className:Te("border rounded-lg overflow-hidden",Mn?"bg-yellow-50/50 border-yellow-200":Tn?"bg-amber-50/50 border-amber-200":""),children:[s.jsx("div",{className:Te("p-4 border-b",Mn?"bg-yellow-100/50":Tn?"bg-amber-100/50":"bg-muted/50"),children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h4",{className:Te("font-semibold",Mn?"text-yellow-800":""),children:Ze(dn,"EEEE, dd.MM.yyyy",{locale:sn})}),s.jsxs("div",{className:"flex gap-2 mt-1",children:[Mn&&s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-200 text-yellow-800 inline-block",children:"Urlaub (gearbeitet)"}),Tn&&s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-amber-200 text-amber-800 inline-block",children:"Wochenendarbeit"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-lg font-bold",children:[_e.toFixed(1),"h"]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[Ze(new Date($e.start_time),"HH:mm")," - ",Me.end_time?Ze(new Date(Me.end_time),"HH:mm"):"Aktiv"]})]})]})}),s.jsx("div",{className:"divide-y",children:bn.sort((Ee,it)=>new Date(Ee.start_time).getTime()-new Date(it.start_time).getTime()).map(Ee=>{const it=f.find(pa=>pa.id===Ee.project_id),pn=Ee.end_time?(new Date(Ee.end_time).getTime()-new Date(Ee.start_time).getTime())/(1e3*60*60):0,Ss=Ee.break_duration||0;return s.jsx("div",{className:"p-4 hover:bg-muted/30",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsxs("span",{className:"font-medium",children:[Ze(new Date(Ee.start_time),"HH:mm")," - ",Ee.end_time?Ze(new Date(Ee.end_time),"HH:mm"):"Aktiv"]}),s.jsx("span",{className:Te("px-2 py-1 rounded-full text-xs font-medium",Ee.status==="aktiv"?"bg-green-100 text-green-800":Ee.status==="beendet"?"bg-blue-100 text-blue-800":Ee.status==="pausiert"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:Ee.status==="aktiv"?"Aktiv":Ee.status==="beendet"?"Beendet":Ee.status==="pausiert"?"Pausiert":Ee.status})]}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Projekt:"})," ",(it==null?void 0:it.name)||"Kein Projekt"]}),Ee.description&&s.jsxs("p",{children:[s.jsx("strong",{children:"Beschreibung:"})," ",Ee.description]}),Ss>0&&s.jsxs("p",{children:[s.jsx("strong",{children:"Pause:"})," ",Ss," min"]})]})]}),s.jsxs("div",{className:"text-right ml-4 flex items-center gap-2",children:[Ee.end_time&&s.jsxs("span",{className:"text-lg font-bold",children:[pn.toFixed(1),"h"]}),e==="manager"&&s.jsx(ee,{size:"sm",variant:"outline",onClick:()=>{$(Ee),I(!0)},children:s.jsx(Tl,{className:"w-4 h-4"})})]})]})},Ee.id)})})]},yt)}).filter(Boolean)})(),Object.keys(lt).length===0&&s.jsx("div",{className:"p-8 text-center text-muted-foreground border rounded-lg",children:"Keine Zeiterfassungseinträge für den ausgewählten Mitarbeiter gefunden"})]}):s.jsx("div",{className:"p-8 text-center text-muted-foreground border rounded-lg",children:"Bitte wählen Sie einen Mitarbeiter aus, um die Zeiterfassung anzuzeigen"})]})})()})]}),s.jsx(Ye,{}),s.jsx(se,{}),s.jsx(Wte,{open:G,onOpenChange:I,timeEntry:V,projects:f,onSave:()=>{}})]})};function Vte({open:t,onOpenChange:e}){const[n,r]=g.useState(""),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(void 0),[m,f]=g.useState(""),[p,x]=g.useState(19),[j,v]=g.useState([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),{toast:_}=Mt(),b=ns(),{data:w=[]}=gr({queryKey:["customers"],queryFn:async()=>{const{data:B,error:W}=await Z.from("customers").select("id, company_name, contact_person").eq("status","Aktiv").order("company_name");if(W)throw W;return B}}),N=Xs({mutationFn:async B=>{const W=j.reduce(($,F)=>$+F.total_price,0),X=W*p/100,ue=W+X,{data:de,error:G}=await Z.from("quotes").insert({title:n,description:a,customer_id:o,valid_until:d?Ze(d,"yyyy-MM-dd"):null,tax_rate:p,net_amount:W,tax_amount:X,total_amount:ue,notes:m,quote_number:""}).select().single();if(G)throw G;const I=j.map(($,F)=>({quote_id:de.id,position:F+1,description:$.description,quantity:$.quantity,unit:$.unit,unit_price:$.unit_price,total_price:$.total_price})),{error:V}=await Z.from("document_items").insert(I);if(V)throw V;return de},onSuccess:()=>{_({title:"Erfolgreich",description:"Angebot wurde erfolgreich erstellt."}),b.invalidateQueries({queryKey:["quotes"]}),S()},onError:B=>{_({title:"Fehler",description:"Beim Erstellen des Angebots ist ein Fehler aufgetreten.",variant:"destructive"}),console.error("Error creating quote:",B)}}),S=()=>{r(""),i(""),c(""),u(void 0),f(""),x(19),v([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),e(!1)},C=()=>{const B={id:Date.now().toString(),description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0};v([...j,B])},A=B=>{j.length>1&&v(j.filter(W=>W.id!==B))},P=(B,W,X)=>{v(j.map(ue=>{if(ue.id===B){const de={...ue,[W]:X};return(W==="quantity"||W==="unit_price")&&(de.total_price=de.quantity*de.unit_price),de}return ue}))},M=j.reduce((B,W)=>B+W.total_price,0),z=M*p/100,R=M+z,D=B=>{if(B.preventDefault(),!n||!o||j.some(W=>!W.description)){_({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}N.mutate({})};return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Jt,{children:s.jsx(en,{children:"Neues Angebot erstellen"})}),s.jsxs("form",{onSubmit:D,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"title",children:"Titel *"}),s.jsx(ae,{id:"title",value:n,onChange:B=>r(B.target.value),placeholder:"Angebots-Titel eingeben",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"customer",children:"Kunde *"}),s.jsxs(mt,{value:o,onValueChange:c,required:!0,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Kunde auswählen"})}),s.jsx(ft,{children:w.map(B=>s.jsxs(ye,{value:B.id,children:[B.company_name," (",B.contact_person,")"]},B.id))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"description",children:"Beschreibung"}),s.jsx(cn,{id:"description",value:a,onChange:B=>i(B.target.value),placeholder:"Beschreibung des Angebots",rows:3})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{children:"Gültig bis"}),s.jsxs($a,{children:[s.jsx(Ua,{asChild:!0,children:s.jsxs(ee,{variant:"outline",className:Te("w-full justify-start text-left font-normal",!d&&"text-muted-foreground"),children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),d?Ze(d,"PPP",{locale:sn}):"Datum auswählen"]})}),s.jsx(aa,{className:"w-auto p-0",align:"start",children:s.jsx(ia,{mode:"single",selected:d,onSelect:u,initialFocus:!0})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"taxRate",children:"Steuersatz (%)"}),s.jsx(ae,{id:"taxRate",type:"number",step:"0.01",min:"0",max:"100",value:p,onChange:B=>x(parseFloat(B.target.value)||0)})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center justify-between",children:["Positionen",s.jsxs(ee,{type:"button",onClick:C,size:"sm",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Position hinzufügen"]})]})}),s.jsxs(ce,{className:"space-y-4",children:[j.map(B=>s.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[s.jsxs("div",{className:"col-span-4 space-y-2",children:[s.jsx(Y,{children:"Beschreibung *"}),s.jsx(ae,{value:B.description,onChange:W=>P(B.id,"description",W.target.value),placeholder:"Beschreibung der Position",required:!0})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(Y,{children:"Menge"}),s.jsx(ae,{type:"number",step:"0.01",min:"0",value:B.quantity,onChange:W=>P(B.id,"quantity",parseFloat(W.target.value)||0)})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(Y,{children:"Einheit"}),s.jsxs(mt,{value:B.unit,onValueChange:W=>P(B.id,"unit",W),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Stk.",children:"Stk."}),s.jsx(ye,{value:"h",children:"Stunden"}),s.jsx(ye,{value:"m",children:"Meter"}),s.jsx(ye,{value:"m²",children:"m²"}),s.jsx(ye,{value:"kg",children:"kg"}),s.jsx(ye,{value:"l",children:"Liter"})]})]})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(Y,{children:"Einzelpreis"}),s.jsx(ae,{type:"number",step:"0.01",min:"0",value:B.unit_price,onChange:W=>P(B.id,"unit_price",parseFloat(W.target.value)||0)})]}),s.jsxs("div",{className:"col-span-1 space-y-2",children:[s.jsx(Y,{children:"Gesamt"}),s.jsxs("div",{className:"text-sm font-medium p-2 bg-muted rounded",children:[B.total_price.toFixed(2)," €"]})]}),s.jsx("div",{className:"col-span-1",children:s.jsx(ee,{type:"button",variant:"ghost",size:"sm",onClick:()=>A(B.id),disabled:j.length===1,children:s.jsx(Fa,{className:"h-4 w-4"})})})]},B.id)),s.jsxs("div",{className:"border-t pt-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Nettosumme:"}),s.jsxs("span",{children:[M.toFixed(2)," €"]})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsxs("span",{children:["MwSt. (",p,"%):"]}),s.jsxs("span",{children:[z.toFixed(2)," €"]})]}),s.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[s.jsx("span",{children:"Gesamtsumme:"}),s.jsxs("span",{children:[R.toFixed(2)," €"]})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"notes",children:"Anmerkungen"}),s.jsx(cn,{id:"notes",value:m,onChange:B=>f(B.target.value),placeholder:"Zusätzliche Anmerkungen zum Angebot",rows:3})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(ee,{type:"button",variant:"outline",onClick:S,children:"Abbrechen"}),s.jsx(ee,{type:"submit",disabled:N.isPending,children:N.isPending?"Erstelle...":"Angebot erstellen"})]})]})]})})}function Kte({open:t,onOpenChange:e}){const[n,r]=g.useState(""),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(""),[m,f]=g.useState(new Date),[p,x]=g.useState(cs(new Date,30)),[j,v]=g.useState("30 Tage netto"),[_,b]=g.useState(""),[w,N]=g.useState(19),[S,C]=g.useState([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),{toast:A}=Mt(),P=ns(),{data:M=[]}=gr({queryKey:["customers"],queryFn:async()=>{const{data:$,error:F}=await Z.from("customers").select("id, company_name, contact_person").eq("status","Aktiv").order("company_name");if(F)throw F;return $}}),{data:z=[]}=gr({queryKey:["quotes-for-invoice"],queryFn:async()=>{const{data:$,error:F}=await Z.from("quotes").select("id, quote_number, title, customer_id").eq("status","Angenommen").order("created_at",{ascending:!1});if(F)throw F;return $}}),R=Xs({mutationFn:async $=>{const F=S.reduce((ne,pe)=>ne+pe.total_price,0),O=F*w/100,K=F+O,{data:U,error:te}=await Z.from("invoices").insert({title:n,description:a,customer_id:o,quote_id:d||null,invoice_date:Ze(m,"yyyy-MM-dd"),due_date:Ze(p,"yyyy-MM-dd"),payment_terms:j,tax_rate:w,net_amount:F,tax_amount:O,total_amount:K,notes:_,invoice_number:""}).select().single();if(te)throw te;const J=S.map((ne,pe)=>({invoice_id:U.id,position:pe+1,description:ne.description,quantity:ne.quantity,unit:ne.unit,unit_price:ne.unit_price,total_price:ne.total_price})),{error:q}=await Z.from("document_items").insert(J);if(q)throw q;return U},onSuccess:()=>{A({title:"Erfolgreich",description:"Rechnung wurde erfolgreich erstellt."}),P.invalidateQueries({queryKey:["invoices"]}),D()},onError:$=>{A({title:"Fehler",description:"Beim Erstellen der Rechnung ist ein Fehler aufgetreten.",variant:"destructive"}),console.error("Error creating invoice:",$)}}),D=()=>{r(""),i(""),c(""),u(""),f(new Date),x(cs(new Date,30)),v("30 Tage netto"),b(""),N(19),C([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),e(!1)},B=()=>{const $={id:Date.now().toString(),description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0};C([...S,$])},W=$=>{S.length>1&&C(S.filter(F=>F.id!==$))},X=($,F,O)=>{C(S.map(K=>{if(K.id===$){const U={...K,[F]:O};return(F==="quantity"||F==="unit_price")&&(U.total_price=U.quantity*U.unit_price),U}return K}))},ue=async $=>{if($)try{const{data:F,error:O}=await Z.from("quotes").select(`
          *,
          customer:customers(company_name, contact_person)
        `).eq("id",$).single();if(O)throw O;const{data:K,error:U}=await Z.from("document_items").select("*").eq("quote_id",$).order("position");if(U)throw U;if(r(`Rechnung für ${F.title}`),i(F.description||""),c(F.customer_id),N(F.tax_rate),b(F.notes||""),K&&K.length>0){const te=K.map(J=>({id:J.id,description:J.description,quantity:J.quantity,unit:J.unit,unit_price:J.unit_price,total_price:J.total_price}));C(te)}A({title:"Angebotsdaten geladen",description:"Die Daten aus dem Angebot wurden übernommen."})}catch(F){console.error("Error loading quote data:",F),A({title:"Fehler",description:"Beim Laden der Angebotsdaten ist ein Fehler aufgetreten.",variant:"destructive"})}},de=S.reduce(($,F)=>$+F.total_price,0),G=de*w/100,I=de+G,V=$=>{if($.preventDefault(),!n||!o||S.some(F=>!F.description)){A({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}R.mutate({})};return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Jt,{children:s.jsx(en,{children:"Neue Rechnung erstellen"})}),s.jsxs("form",{onSubmit:V,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"title",children:"Titel *"}),s.jsx(ae,{id:"title",value:n,onChange:$=>r($.target.value),placeholder:"Rechnungs-Titel eingeben",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"customer",children:"Kunde *"}),s.jsxs(mt,{value:o,onValueChange:c,required:!0,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Kunde auswählen"})}),s.jsx(ft,{children:M.map($=>s.jsxs(ye,{value:$.id,children:[$.company_name," (",$.contact_person,")"]},$.id))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"quote",children:"Basiert auf Angebot (optional)"}),s.jsxs(mt,{value:d,onValueChange:$=>{u($),$&&ue($)},children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Angebot auswählen (optional)"})}),s.jsx(ft,{children:z.map($=>s.jsxs(ye,{value:$.id,children:[$.quote_number," - ",$.title]},$.id))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"description",children:"Beschreibung"}),s.jsx(cn,{id:"description",value:a,onChange:$=>i($.target.value),placeholder:"Beschreibung der Rechnung",rows:3})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{children:"Rechnungsdatum"}),s.jsxs($a,{children:[s.jsx(Ua,{asChild:!0,children:s.jsxs(ee,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),Ze(m,"PPP",{locale:sn})]})}),s.jsx(aa,{className:"w-auto p-0",align:"start",children:s.jsx(ia,{mode:"single",selected:m,onSelect:$=>$&&f($),initialFocus:!0})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{children:"Fälligkeitsdatum"}),s.jsxs($a,{children:[s.jsx(Ua,{asChild:!0,children:s.jsxs(ee,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[s.jsx(Lt,{className:"mr-2 h-4 w-4"}),Ze(p,"PPP",{locale:sn})]})}),s.jsx(aa,{className:"w-auto p-0",align:"start",children:s.jsx(ia,{mode:"single",selected:p,onSelect:$=>$&&x($),initialFocus:!0})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"paymentTerms",children:"Zahlungsbedingungen"}),s.jsxs(mt,{value:j,onValueChange:v,children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Sofort",children:"Sofort"}),s.jsx(ye,{value:"7 Tage netto",children:"7 Tage netto"}),s.jsx(ye,{value:"14 Tage netto",children:"14 Tage netto"}),s.jsx(ye,{value:"30 Tage netto",children:"30 Tage netto"}),s.jsx(ye,{value:"60 Tage netto",children:"60 Tage netto"})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"taxRate",children:"Steuersatz (%)"}),s.jsx(ae,{id:"taxRate",type:"number",step:"0.01",min:"0",max:"100",value:w,onChange:$=>N(parseFloat($.target.value)||0),className:"w-32"})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center justify-between",children:["Positionen",s.jsxs(ee,{type:"button",onClick:B,size:"sm",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Position hinzufügen"]})]})}),s.jsxs(ce,{className:"space-y-4",children:[S.map($=>s.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[s.jsxs("div",{className:"col-span-4 space-y-2",children:[s.jsx(Y,{children:"Beschreibung *"}),s.jsx(ae,{value:$.description,onChange:F=>X($.id,"description",F.target.value),placeholder:"Beschreibung der Position",required:!0})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(Y,{children:"Menge"}),s.jsx(ae,{type:"number",step:"0.01",min:"0",value:$.quantity,onChange:F=>X($.id,"quantity",parseFloat(F.target.value)||0)})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(Y,{children:"Einheit"}),s.jsxs(mt,{value:$.unit,onValueChange:F=>X($.id,"unit",F),children:[s.jsx(ht,{children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Stk.",children:"Stk."}),s.jsx(ye,{value:"h",children:"Stunden"}),s.jsx(ye,{value:"m",children:"Meter"}),s.jsx(ye,{value:"m²",children:"m²"}),s.jsx(ye,{value:"kg",children:"kg"}),s.jsx(ye,{value:"l",children:"Liter"})]})]})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(Y,{children:"Einzelpreis"}),s.jsx(ae,{type:"number",step:"0.01",min:"0",value:$.unit_price,onChange:F=>X($.id,"unit_price",parseFloat(F.target.value)||0)})]}),s.jsxs("div",{className:"col-span-1 space-y-2",children:[s.jsx(Y,{children:"Gesamt"}),s.jsxs("div",{className:"text-sm font-medium p-2 bg-muted rounded",children:[$.total_price.toFixed(2)," €"]})]}),s.jsx("div",{className:"col-span-1",children:s.jsx(ee,{type:"button",variant:"ghost",size:"sm",onClick:()=>W($.id),disabled:S.length===1,children:s.jsx(Fa,{className:"h-4 w-4"})})})]},$.id)),s.jsxs("div",{className:"border-t pt-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Nettosumme:"}),s.jsxs("span",{children:[de.toFixed(2)," €"]})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsxs("span",{children:["MwSt. (",w,"%):"]}),s.jsxs("span",{children:[G.toFixed(2)," €"]})]}),s.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[s.jsx("span",{children:"Gesamtsumme:"}),s.jsxs("span",{children:[I.toFixed(2)," €"]})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"notes",children:"Anmerkungen"}),s.jsx(cn,{id:"notes",value:_,onChange:$=>b($.target.value),placeholder:"Zusätzliche Anmerkungen zur Rechnung",rows:3})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(ee,{type:"button",variant:"outline",onClick:D,children:"Abbrechen"}),s.jsx(ee,{type:"submit",disabled:R.isPending,children:R.isPending?"Erstelle...":"Rechnung erstellen"})]})]})]})})}const Zte=({quote:t,onRefresh:e})=>{const n=ZZ(),r=cR(),a=()=>{n.mutate(t.id,{onSuccess:()=>{e==null||e()}})},i=()=>{r.mutate({name:t.title,description:t.description,customer_id:t.customer_id,status:"neu",start_date:new Date().toISOString().split("T")[0],quote_id:t.id},{onSuccess:()=>{e==null||e()}})},o=n.isPending||r.isPending,c=t.status==="accepted"||t.status==="sent"||t.status==="versendet";return s.jsxs("div",{className:"flex space-x-1",children:[c&&s.jsxs(ee,{size:"sm",variant:"default",onClick:a,disabled:o,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[s.jsx(Kb,{className:"h-3 w-3 mr-1"}),"Auftrag erstellen"]}),s.jsxs(ee,{size:"sm",variant:"outline",onClick:i,disabled:o,title:"Direkt zu Projekt (überspringt Auftrag)",children:[s.jsx(la,{className:"h-3 w-3 mr-1"}),"Zu Projekt"]})]})},Gte=Ld("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Cp=g.forwardRef(({className:t,variant:e,...n},r)=>s.jsx("div",{ref:r,role:"alert",className:Te(Gte({variant:e}),t),...n}));Cp.displayName="Alert";const Qte=g.forwardRef(({className:t,...e},n)=>s.jsx("h5",{ref:n,className:Te("mb-1 font-medium leading-none tracking-tight",t),...e}));Qte.displayName="AlertTitle";const Ep=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{ref:n,className:Te("text-sm [&_p]:leading-relaxed",t),...e}));Ep.displayName="AlertDescription";function Yte({onOCRComplete:t,onError:e,className:n="",accept:r="image/*,.pdf",maxSize:a=10}){const[i,o]=g.useState(!1),[c,d]=g.useState(null),[u,m]=g.useState(0),f=nG({onSuccess:C=>{d(null),m(0),t==null||t(C)},onError:C=>{d(null),m(0),e==null||e(C.message)}}),p=g.useCallback(C=>{C.preventDefault(),o(!0)},[]),x=g.useCallback(C=>{C.preventDefault(),o(!1)},[]),j=g.useCallback(C=>{C.preventDefault(),o(!1);const A=Array.from(C.dataTransfer.files);A.length>0&&_(A[0])},[]),v=g.useCallback(C=>{const A=C.target.files;A&&A.length>0&&_(A[0]),C.target.value=""},[]),_=g.useCallback(C=>{if(!["image/jpeg","image/png","image/gif","image/bmp","image/webp","application/pdf"].includes(C.type)){e==null||e("Nur Bilddateien (JPEG, PNG, GIF, BMP, WebP) und PDF-Dateien sind erlaubt.");return}if(C.size/(1024*1024)>a){e==null||e(`Datei zu groß. Maximale Größe: ${a}MB`);return}d(C)},[a,e]),b=g.useCallback(async()=>{if(c)try{m(25),console.log("Starting OCR processing for:",c.name),await f.mutateAsync(c)}catch(C){console.error("OCR processing failed:",C),e==null||e(C instanceof Error?C.message:"OCR-Verarbeitung fehlgeschlagen"),d(null),m(0)}},[c,f,e]),w=g.useCallback(()=>{d(null),m(0)},[]),N=C=>{if(C===0)return"0 Bytes";const A=1024,P=["Bytes","KB","MB","GB"],M=Math.floor(Math.log(C)/Math.log(A));return parseFloat((C/Math.pow(A,M)).toFixed(2))+" "+P[M]},S=C=>C.type.startsWith("image/")?s.jsx(P_,{className:"h-8 w-8 text-blue-500"}):C.type==="application/pdf"?s.jsx(wn,{className:"h-8 w-8 text-red-500"}):s.jsx(wn,{className:"h-8 w-8 text-gray-500"});return c&&!f.isPending?s.jsx(oe,{className:n,children:s.jsx(ce,{className:"p-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[S(c),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium truncate",children:c.name}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsx("span",{children:N(c.size)}),s.jsx("span",{children:c.type}),s.jsx(Qe,{variant:"outline",children:"Bereit für OCR"})]})]}),s.jsx(ee,{variant:"ghost",size:"sm",onClick:w,children:s.jsx(Ln,{className:"h-4 w-4"})})]}),s.jsxs(Cp,{children:[s.jsx(ah,{className:"h-4 w-4"}),s.jsx(Ep,{children:"Die Datei wird mit OCR verarbeitet und automatisch in deutsche Rechnung konvertiert. Dieser Vorgang kann 10-30 Sekunden dauern."})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ee,{onClick:b,disabled:f.isPending,className:"flex-1",children:[s.jsx(ah,{className:"mr-2 h-4 w-4"}),"OCR starten"]}),s.jsx(ee,{variant:"outline",onClick:w,children:"Abbrechen"})]})]})})}):f.isPending?s.jsx(oe,{className:n,children:s.jsx(ce,{className:"p-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),s.jsx("h3",{className:"font-medium",children:"OCR-Verarbeitung läuft..."}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Rechnung wird analysiert und Daten extrahiert"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Fortschritt"}),s.jsxs("span",{children:[Math.round(u),"%"]})]}),s.jsx(Pd,{value:u,className:"h-2"})]}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Ts,{className:"h-4 w-4 text-green-500"}),s.jsx("span",{children:"Datei hochgeladen"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm mt-1",children:[s.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-primary"}),s.jsx("span",{children:"Tesseract OCR läuft..."})]})]}),s.jsxs(Cp,{children:[s.jsx(ig,{className:"h-4 w-4"}),s.jsx(Ep,{children:"Bitte warten Sie, bis die Verarbeitung abgeschlossen ist. Bei komplexen Dokumenten kann dies länger dauern."})]})]})})}):s.jsx(oe,{className:`transition-colors ${i?"border-primary bg-primary/5":"border-dashed"} ${n}`,onDragOver:p,onDragLeave:x,onDrop:j,children:s.jsx(ce,{className:"p-8",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center",children:s.jsx(cP,{className:`h-8 w-8 ${i?"text-primary":"text-muted-foreground"}`})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-medium",children:"Rechnung für OCR hochladen"}),s.jsx("p",{className:"text-muted-foreground",children:"Ziehen Sie eine Datei hierher oder klicken Sie zum Auswählen"})]}),s.jsx("div",{className:"flex justify-center",children:s.jsxs(ee,{variant:"outline",onClick:()=>{var C;return(C=document.getElementById("ocr-file-input"))==null?void 0:C.click()},children:[s.jsx(wn,{className:"mr-2 h-4 w-4"}),"Datei auswählen"]})}),s.jsx("input",{id:"ocr-file-input",type:"file",accept:r,onChange:v,className:"hidden"}),s.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[s.jsx("p",{children:"Unterstützte Formate: JPEG, PNG, GIF, BMP, WebP, PDF"}),s.jsxs("p",{children:["Maximale Dateigröße: ",a,"MB"]}),s.jsx("p",{children:"Empfohlen: Hochauflösende Scans für beste Ergebnisse"})]}),s.jsxs(Cp,{className:"border-green-500 bg-green-50",children:[s.jsx(xB,{className:"h-4 w-4 text-green-600"}),s.jsxs(Ep,{children:[s.jsx("strong",{className:"text-green-800",children:"KI-OCR aktiv:"})," OpenAI Vision erkennt Rechnungsdaten intelligent und extrahiert alle Felder automatisch - auch komplexe Tabellen!"]})]})]})})})}function Xte({ocrResult:t,onValidated:e,onRejected:n,onCancel:r}){var V,$,F;const{toast:a}=Mt(),[i,o]=g.useState(t.structured_data),[c,d]=g.useState(""),[u,m]=g.useState(!1),[f,p]=g.useState("basic"),[x,j]=g.useState(null),[v,_]=g.useState(!1),[b,w]=g.useState(!1);g.useEffect(()=>{o(t.structured_data),t.original_file_path&&t.original_file_path.startsWith("data:image")&&j(t.original_file_path)},[t]),g.useEffect(()=>{const O=K=>{K.key==="Escape"&&b&&w(!1)};return document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)},[b]);const N=async()=>{if(!v){_(!0);try{const O=[];if(i.invoiceNumber||O.push("Rechnungsnummer fehlt"),i.invoiceDate||O.push("Rechnungsdatum fehlt"),i.supplierName||O.push("Lieferantenname fehlt"),(!i.totalAmount||i.totalAmount<=0)&&O.push("Gesamtbetrag fehlt"),i.serviceDescription||O.push("Leistungsbeschreibung fehlt"),O.length>0){a({title:"Validierungsfehler",description:`Pflichtfelder fehlen: ${O.join(", ")}`,variant:"destructive"});return}await new Promise(K=>setTimeout(K,1e3)),a({title:"Rechnung validiert",description:"Die Rechnungsdaten wurden erfolgreich validiert."}),e==null||e(i)}catch{a({title:"Validierungsfehler",description:"Ein Fehler ist bei der Validierung aufgetreten.",variant:"destructive"})}finally{_(!1)}}},S=(O,K)=>{o(U=>({...U,[O]:K}))},C=(O,K)=>{const U=te=>Math.round(te*100)/100;o(te=>{const J={...te},q=O==="netAmount"?K:te.netAmount||0,ne=O==="vatAmount"?K:te.vatAmount||0;return O==="totalAmount"||te.totalAmount,O==="netAmount"?(J.netAmount=K,ne>0&&(J.totalAmount=U(K+ne))):O==="vatAmount"?(J.vatAmount=K,q>0&&(J.totalAmount=U(q+K))):O==="totalAmount"&&(J.totalAmount=K,q>0?J.vatAmount=U(K-q):ne>0&&(J.netAmount=U(K-ne))),J})},A=(O=19)=>{o(K=>({...K,taxRates:[...K.taxRates||[],O],netAmounts:{...K.netAmounts||{},[O.toString()]:0},taxAmounts:{...K.taxAmounts||{},[O.toString()]:0}}))},P=O=>{o(K=>{const U=[...K.taxRates||[]],te=U[O];U.splice(O,1);const J={...K.netAmounts||{}},q={...K.taxAmounts||{}};return delete J[te.toString()],delete q[te.toString()],{...K,taxRates:U,netAmounts:J,taxAmounts:q}})},M=(O,K,U)=>{o(te=>{const J=[...te.taxRates||[]],q={...te.netAmounts||{}},ne={...te.taxAmounts||{}},pe=J[O];return K==="rate"?(J[O]=U,pe!==U&&(q[U.toString()]=q[pe.toString()]||0,ne[U.toString()]=ne[pe.toString()]||0,delete q[pe.toString()],delete ne[pe.toString()])):K==="netAmount"?q[pe.toString()]=Math.round(U*100)/100:K==="taxAmount"&&(ne[pe.toString()]=Math.round(U*100)/100),{...te,taxRates:J,netAmounts:q,taxAmounts:ne}})},z=()=>{o(O=>{var K;return{...O,positions:[...O.positions||[],{position:(((K=O.positions)==null?void 0:K.length)||0)+1,description:"",quantity:1,unit:"Stk",unitPrice:0,totalPrice:0,vatRate:19}]}})},R=O=>{o(K=>{const U=[...K.positions||[]];return U.splice(O,1),U.forEach((te,J)=>{te.position=J+1}),{...K,positions:U}})},D=(O,K,U)=>{o(te=>{const J=[...te.positions||[]],q={...J[O]};return q[K]=U,(K==="quantity"||K==="unitPrice")&&(q.totalPrice=Math.round(q.quantity*q.unitPrice*100)/100),J[O]=q,{...te,positions:J}})},B=O=>{o(K=>{const U={...K,paymentTerms:O},te=K.invoiceDate;if(te&&O){const J=new Date(te);let q=30;const ne=O.match(/(\d+)\s*tage?/i);ne&&(q=parseInt(ne[1]));const pe=new Date(J);pe.setDate(pe.getDate()+q),U.dueDate=pe.toISOString().split("T")[0]}return U})},W=O=>{if(!O)return!0;const K={AT:/^AT[UB]\d{8}$/,BE:/^BE[01]\d{9}$/,BG:/^BG\d{9,10}$/,CY:/^CY\d{8}[A-Z]$/,CZ:/^CZ\d{8,10}$/,DE:/^DE\d{9}$/,DK:/^DK\d{8}$/,EE:/^EE\d{9}$/,EL:/^EL\d{9}$/,ES:/^ES[A-Z]\d{7}[A-Z]|\d{8}[A-Z]$/,FI:/^FI\d{8}$/,FR:/^FR[A-Z0-9]{2}\d{9}$/,GB:/^GB\d{9}|\d{12}|(GD|HA)\d{3}$/,HR:/^HR\d{11}$/,HU:/^HU\d{8}$/,IE:/^IE\d[A-Z0-9]\d{5}[A-Z]$/,IT:/^IT\d{11}$/,LT:/^LT\d{9}|\d{12}$/,LU:/^LU\d{8}$/,LV:/^LV\d{11}$/,MT:/^MT\d{8}$/,NL:/^NL\d{9}B\d{2}$/,PL:/^PL\d{10}$/,PT:/^PT\d{9}$/,RO:/^RO\d{2,10}$/,SE:/^SE\d{12}$/,SI:/^SI\d{8}$/,SK:/^SK\d{10}$/},U=O.substring(0,2).toUpperCase(),te=K[U];return te?te.test(O.toUpperCase()):!1},X=O=>{if(!O)return!0;const K=O.replace(/\s/g,"").toUpperCase();if(K.length<15||K.length>34||!/^[A-Z]{2}/.test(K)||!/^\d{2}/.test(K.substring(2,4)))return!1;const U=K.substring(4)+K.substring(0,4);let te="";for(let q=0;q<U.length;q++){const ne=U[q];ne>="A"&&ne<="Z"?te+=(ne.charCodeAt(0)-55).toString():te+=ne}let J=0;for(let q=0;q<te.length;q++)J=(J*10+parseInt(te[q]))%97;return J===1},ue=(O,K)=>O==="supplierVatId"&&K&&!W(K)?"Ungültige USt-IdNr. Format (z.B. DE123456789 für Deutschland)":O==="supplierIban"&&K&&!X(K)?"Ungültige IBAN. Prüfen Sie Format und Prüfziffer.":null,de=O=>O?O.toLocaleString("de-DE",{style:"currency",currency:"EUR"}):"0,00 €",G=O=>{if(O==null||O===0)return"";const K=O.toString(),U=K.split(".");if(U.length===1)return K;{const J=U[1].substring(0,6).replace(/0+$/,""),q=J.length<2?J.padEnd(2,"0"):J;return`${U[0]}.${q}`}},I=Object.entries(i).filter(([O,K])=>K!==void 0&&K!==""&&K!==0&&!(Array.isArray(K)&&K.length===0)&&!(typeof K=="object"&&Object.keys(K).length===0)).length;return s.jsxs("div",{className:"space-y-6 max-w-7xl mx-auto",children:[s.jsx(oe,{children:s.jsx(Ne,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/20",children:s.jsx(wn,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),s.jsxs("div",{children:[s.jsx(Ce,{children:"Rechnungsvalidierung"}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[I," Felder erfasst • Überprüfen und korrigieren Sie die Daten"]})]})]}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(ee,{variant:"outline",size:"sm",onClick:()=>m(!u),children:[u?s.jsx(rP,{className:"h-4 w-4"}):s.jsx(sa,{className:"h-4 w-4"}),"OCR-Text"]})})]})})}),s.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[x&&s.jsx("div",{className:"xl:col-span-1",children:s.jsxs(oe,{className:"h-fit sticky top-6",children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Original-Dokument"}),s.jsxs(ee,{variant:"outline",size:"sm",onClick:()=>w(!0),children:[s.jsx(sa,{className:"h-4 w-4 mr-2"}),"Vollbild"]})]})}),s.jsx(ce,{className:"p-0",children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:x,alt:"Invoice",className:"w-full h-auto rounded-b-lg cursor-zoom-in hover:shadow-lg transition-shadow",style:{maxHeight:"calc(100vh - 200px)",minHeight:"600px",objectFit:"contain",backgroundColor:"#f8f9fa"},onClick:()=>w(!0),title:"Klicken für Vollbildansicht"}),s.jsx("div",{className:"absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-xs",children:"Klicken zum Vergrößern"})]})})]})}),s.jsxs("div",{className:x?"xl:col-span-1":"xl:col-span-2",children:[s.jsx(oe,{children:s.jsx(ce,{className:"p-0",children:s.jsxs(Is,{value:f,onValueChange:p,children:[s.jsx("div",{className:"p-6 pb-0",children:s.jsxs(js,{className:"grid w-full grid-cols-6",children:[s.jsx(Je,{value:"basic",children:"Basis"}),s.jsx(Je,{value:"supplier",children:"Lieferant"}),s.jsx(Je,{value:"amounts",children:"Beträge"}),s.jsx(Je,{value:"positions",children:"Positionen"}),s.jsx(Je,{value:"references",children:"Referenzen"}),s.jsx(Je,{value:"additional",children:"Erweitert"})]})}),s.jsxs(et,{value:"basic",className:"p-6 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Y,{htmlFor:"invoiceNumber",className:"flex items-center gap-2",children:[s.jsx(iB,{className:"h-4 w-4"}),"Rechnungsnummer *"]}),s.jsx(ae,{id:"invoiceNumber",value:i.invoiceNumber||"",onChange:O=>S("invoiceNumber",O.target.value),className:i.invoiceNumber?"":"border-red-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Y,{htmlFor:"invoiceDate",className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"h-4 w-4"}),"Rechnungsdatum *"]}),s.jsx(ae,{id:"invoiceDate",type:"date",value:i.invoiceDate||"",onChange:O=>S("invoiceDate",O.target.value),className:i.invoiceDate?"":"border-red-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"serviceDate",children:"Leistungsdatum"}),s.jsx(ae,{id:"serviceDate",type:"date",value:i.serviceDate||"",onChange:O=>S("serviceDate",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"dueDate",children:"Fälligkeitsdatum"}),s.jsx(ae,{id:"dueDate",type:"date",value:i.dueDate||"",onChange:O=>S("dueDate",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"currency",children:"Währung"}),s.jsx(ae,{id:"currency",value:i.currency||"EUR",onChange:O=>S("currency",O.target.value)})]})]}),s.jsx(mi,{}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Y,{htmlFor:"serviceDescription",className:"flex items-center gap-2",children:[s.jsx(wn,{className:"h-4 w-4"}),"Leistungsbeschreibung *"]}),s.jsx(cn,{id:"serviceDescription",value:i.serviceDescription||"",onChange:O=>S("serviceDescription",O.target.value),className:i.serviceDescription?"":"border-red-500",rows:3})]})]}),s.jsx(et,{value:"supplier",className:"p-6 space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Y,{htmlFor:"supplierName",className:"flex items-center gap-2",children:[s.jsx(la,{className:"h-4 w-4"}),"Lieferant/Firma *"]}),s.jsx(ae,{id:"supplierName",value:i.supplierName||"",onChange:O=>S("supplierName",O.target.value),className:i.supplierName?"":"border-red-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Y,{htmlFor:"contactPerson",className:"flex items-center gap-2",children:[s.jsx(pr,{className:"h-4 w-4"}),"Ansprechpartner"]}),s.jsx(ae,{id:"contactPerson",value:i.contactPerson||"",onChange:O=>S("contactPerson",O.target.value)})]}),s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsxs(Y,{htmlFor:"supplierAddress",className:"flex items-center gap-2",children:[s.jsx(Ci,{className:"h-4 w-4"}),"Lieferantenadresse"]}),s.jsx(cn,{id:"supplierAddress",value:i.supplierAddress||"",onChange:O=>S("supplierAddress",O.target.value),rows:2})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"supplierVatId",children:"USt-IdNr."}),s.jsx(ae,{id:"supplierVatId",value:i.supplierVatId||"",onChange:O=>S("supplierVatId",O.target.value),placeholder:"DE123456789",className:i.supplierVatId&&!W(i.supplierVatId)?"border-red-500":""}),i.supplierVatId&&!W(i.supplierVatId)&&s.jsx("p",{className:"text-sm text-red-600",children:ue("supplierVatId",i.supplierVatId)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"supplierTaxNumber",children:"Steuernummer"}),s.jsx(ae,{id:"supplierTaxNumber",value:i.supplierTaxNumber||"",onChange:O=>S("supplierTaxNumber",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Y,{htmlFor:"supplierEmail",className:"flex items-center gap-2",children:[s.jsx(es,{className:"h-4 w-4"}),"E-Mail"]}),s.jsx(ae,{id:"supplierEmail",type:"email",value:i.supplierEmail||"",onChange:O=>S("supplierEmail",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Y,{htmlFor:"supplierPhone",className:"flex items-center gap-2",children:[s.jsx(Fd,{className:"h-4 w-4"}),"Telefon"]}),s.jsx(ae,{id:"supplierPhone",value:i.supplierPhone||"",onChange:O=>S("supplierPhone",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Y,{htmlFor:"supplierIban",className:"flex items-center gap-2",children:[s.jsx(nB,{className:"h-4 w-4"}),"IBAN"]}),s.jsx(ae,{id:"supplierIban",value:i.supplierIban||"",onChange:O=>S("supplierIban",O.target.value),placeholder:"DE89 3704 0044 0532 0130 00",className:i.supplierIban&&!X(i.supplierIban)?"border-red-500":""}),i.supplierIban&&!X(i.supplierIban)&&s.jsx("p",{className:"text-sm text-red-600",children:ue("supplierIban",i.supplierIban)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"supplierBic",children:"BIC"}),s.jsx(ae,{id:"supplierBic",value:i.supplierBic||"",onChange:O=>S("supplierBic",O.target.value),placeholder:"COBADEFFXXX"})]})]})}),s.jsxs(et,{value:"amounts",className:"p-6 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Y,{htmlFor:"totalAmount",className:"flex items-center gap-2",children:[s.jsx(Jr,{className:"h-4 w-4"}),"Gesamtbetrag (Brutto) *"]}),s.jsx(ae,{id:"totalAmount",type:"number",step:"0.01",value:G(i.totalAmount),onChange:O=>C("totalAmount",parseFloat(O.target.value)||0),className:i.totalAmount?"":"border-red-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"netAmount",children:"Nettobetrag"}),s.jsx(ae,{id:"netAmount",type:"number",step:"0.01",value:G(i.netAmount),onChange:O=>C("netAmount",parseFloat(O.target.value)||0)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"vatAmount",children:"MwSt-Betrag"}),s.jsx(ae,{id:"vatAmount",type:"number",step:"0.01",value:G(i.vatAmount),onChange:O=>C("vatAmount",parseFloat(O.target.value)||0)})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Y,{children:"Steuer-Sätze"}),s.jsx(ee,{type:"button",variant:"outline",size:"sm",onClick:()=>A(19),className:"h-8",children:"+ Steuer hinzufügen"})]}),s.jsxs("div",{className:"border rounded-lg",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 bg-gray-50 dark:bg-gray-800 font-medium text-sm",children:[s.jsx("div",{children:"Satz (%)"}),s.jsx("div",{children:"Nettobasis (€)"}),s.jsx("div",{children:"Steuerbetrag (€)"}),s.jsx("div",{className:"text-right",children:"Aktionen"})]}),(i.taxRates||[]).map((O,K)=>{var U,te;return s.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-t",children:[s.jsx(ae,{type:"number",step:"0.01",value:O,onChange:J=>M(K,"rate",parseFloat(J.target.value)||0),className:"h-8"}),s.jsx(ae,{type:"number",step:"0.01",value:G((U=i.netAmounts)==null?void 0:U[O.toString()]),onChange:J=>M(K,"netAmount",parseFloat(J.target.value)||0),className:"h-8"}),s.jsx(ae,{type:"number",step:"0.01",value:G((te=i.taxAmounts)==null?void 0:te[O.toString()]),onChange:J=>M(K,"taxAmount",parseFloat(J.target.value)||0),className:"h-8"}),s.jsx("div",{className:"text-right",children:s.jsx(ee,{type:"button",variant:"ghost",size:"sm",onClick:()=>P(K),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:s.jsx(Ln,{className:"h-4 w-4"})})})]},K)}),(!i.taxRates||i.taxRates.length===0)&&s.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:'Keine Steuersätze erfasst. Klicken Sie auf "+ Steuer hinzufügen" um zu beginnen.'})]}),s.jsxs("div",{className:"flex justify-end text-sm text-gray-600",children:["Summe MwSt: ",de(Object.values(i.taxAmounts||{}).reduce((O,K)=>O+K,0))]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(Y,{children:"Spezielle Steuerarten"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(za,{id:"hasReverseCharge",checked:i.hasReverseCharge||!1,onCheckedChange:O=>S("hasReverseCharge",O)}),s.jsx(Y,{htmlFor:"hasReverseCharge",className:"text-sm",children:"Reverse-Charge (Steuerschuldnerschaft des Leistungsempfängers)"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(za,{id:"isIntraCommunitySupply",checked:i.isIntraCommunitySupply||!1,onCheckedChange:O=>S("isIntraCommunitySupply",O)}),s.jsx(Y,{htmlFor:"isIntraCommunitySupply",className:"text-sm",children:"Innergemeinschaftliche Lieferung"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(za,{id:"isExport",checked:i.isExport||!1,onCheckedChange:O=>S("isExport",O)}),s.jsx(Y,{htmlFor:"isExport",className:"text-sm",children:"Ausfuhrlieferung"})]})]})]})]}),s.jsx(et,{value:"positions",className:"p-6 space-y-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Y,{className:"text-base font-semibold",children:"Rechnungspositionen"}),s.jsx(ee,{type:"button",variant:"outline",size:"sm",onClick:()=>z(),className:"h-8",children:"+ Position hinzufügen"})]}),s.jsxs("div",{className:"border rounded-lg",children:[s.jsxs("div",{className:"grid grid-cols-7 gap-2 p-3 bg-gray-50 dark:bg-gray-800 font-medium text-sm",children:[s.jsx("div",{children:"Pos."}),s.jsx("div",{children:"Beschreibung"}),s.jsx("div",{children:"Menge"}),s.jsx("div",{children:"Einheit"}),s.jsx("div",{children:"EP (€)"}),s.jsx("div",{children:"MwSt %"}),s.jsx("div",{className:"text-right",children:"Aktionen"})]}),(i.positions||[]).map((O,K)=>s.jsxs("div",{className:"grid grid-cols-7 gap-2 p-3 border-t",children:[s.jsx(ae,{type:"number",value:O.position||K+1,onChange:U=>D(K,"position",parseInt(U.target.value)||K+1),className:"h-8"}),s.jsx(ae,{type:"text",value:O.description,onChange:U=>D(K,"description",U.target.value),className:"h-8",placeholder:"Beschreibung..."}),s.jsx(ae,{type:"number",step:"0.01",value:O.quantity,onChange:U=>D(K,"quantity",parseFloat(U.target.value)||0),className:"h-8"}),s.jsx(ae,{type:"text",value:O.unit||"Stk",onChange:U=>D(K,"unit",U.target.value),className:"h-8"}),s.jsx(ae,{type:"number",step:"0.01",value:G(O.unitPrice),onChange:U=>D(K,"unitPrice",parseFloat(U.target.value)||0),className:"h-8"}),s.jsx(ae,{type:"number",step:"0.01",value:O.vatRate||19,onChange:U=>D(K,"vatRate",parseFloat(U.target.value)||19),className:"h-8"}),s.jsx("div",{className:"text-right",children:s.jsx(ee,{type:"button",variant:"ghost",size:"sm",onClick:()=>R(K),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:s.jsx(Ln,{className:"h-4 w-4"})})})]},K)),(!i.positions||i.positions.length===0)&&s.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:'Keine Positionen erfasst. Klicken Sie auf "+ Position hinzufügen" um zu beginnen.'})]}),i.positions&&i.positions.length>0&&s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg space-y-2",children:[s.jsx("div",{className:"font-medium",children:"Positionssummen:"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:["Netto gesamt: ",de(i.positions.reduce((O,K)=>O+K.quantity*K.unitPrice,0))]}),s.jsxs("div",{children:["MwSt gesamt: ",de(i.positions.reduce((O,K)=>{const U=K.quantity*K.unitPrice,te=(K.vatRate||19)/100;return O+U*te},0))]}),s.jsxs("div",{className:"font-medium",children:["Brutto gesamt: ",de(i.positions.reduce((O,K)=>{const U=K.quantity*K.unitPrice,te=(K.vatRate||19)/100;return O+U+U*te},0))]})]})]})]})}),s.jsxs(et,{value:"references",className:"p-6 space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx(Y,{className:"text-base font-semibold",children:"Zahlungsbedingungen"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"paymentTerms",children:'Zahlungsziel (z.B. "14 Tage, 2% Skonto")'}),s.jsx(ae,{id:"paymentTerms",value:i.paymentTerms||"",onChange:O=>B(O.target.value),placeholder:"z.B. 14 Tage netto"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"dueDate",children:"Fälligkeitsdatum *"}),s.jsx(ae,{id:"dueDate",type:"date",value:i.dueDate||"",onChange:O=>S("dueDate",O.target.value),className:i.dueDate?"":"border-yellow-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"paymentReference",children:"Zahlungsreferenz/Verwendungszweck"}),s.jsx(ae,{id:"paymentReference",value:i.paymentReference||"",onChange:O=>S("paymentReference",O.target.value),placeholder:"Verwendungszweck..."})]})]})]}),s.jsx(mi,{}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"orderNumber",children:"Bestellnummer"}),s.jsx(ae,{id:"orderNumber",value:i.orderNumber||"",onChange:O=>S("orderNumber",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"projectReference",children:"Projekt-Referenz"}),s.jsx(ae,{id:"projectReference",value:i.projectReference||"",onChange:O=>S("projectReference",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"deliveryNoteNumber",children:"Lieferscheinnummer"}),s.jsx(ae,{id:"deliveryNoteNumber",value:i.deliveryNoteNumber||"",onChange:O=>S("deliveryNoteNumber",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"paymentReference",children:"Zahlungsreferenz/Verwendungszweck"}),s.jsx(ae,{id:"paymentReference",value:i.paymentReference||"",onChange:O=>S("paymentReference",O.target.value)})]}),s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsx(Y,{htmlFor:"serviceLocation",children:"Liefer-/Leistungsort"}),s.jsx(ae,{id:"serviceLocation",value:i.serviceLocation||"",onChange:O=>S("serviceLocation",O.target.value)})]})]})]}),s.jsx(et,{value:"additional",className:"p-6 space-y-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"servicePeriodStart",children:"Leistungszeitraum - Von"}),s.jsx(ae,{id:"servicePeriodStart",type:"date",value:i.servicePeriodStart||"",onChange:O=>S("servicePeriodStart",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"servicePeriodEnd",children:"Leistungszeitraum - Bis"}),s.jsx(ae,{id:"servicePeriodEnd",type:"date",value:i.servicePeriodEnd||"",onChange:O=>S("servicePeriodEnd",O.target.value)})]})]}),s.jsx(mi,{}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{children:"Empfänger (Ihr Unternehmen)"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(ae,{placeholder:"Firmenname",value:i.customerName||"",onChange:O=>S("customerName",O.target.value)}),s.jsx(cn,{placeholder:"Adresse",value:i.customerAddress||"",onChange:O=>S("customerAddress",O.target.value),rows:2})]})]}),s.jsx(mi,{}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"validationNotes",children:"Validierungsnotizen"}),s.jsx(cn,{id:"validationNotes",value:c,onChange:O=>d(O.target.value),placeholder:"Notizen zur Validierung...",rows:3})]}),i.positions&&i.positions.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Y,{children:["Erkannte Rechnungspositionen (",i.positions.length,")"]}),s.jsx("div",{className:"border rounded-lg p-3 space-y-2 max-h-40 overflow-y-auto",children:i.positions.map((O,K)=>s.jsxs("div",{className:"text-sm p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[s.jsx("div",{className:"font-medium",children:O.description}),s.jsxs("div",{className:"text-gray-500",children:[O.quantity," ",O.unit||"Stk"," × ",de(O.unitPrice||0)," = ",de(O.totalPrice||0)]})]},K))})]})]})})]})})}),s.jsx(oe,{className:"shadow-lg border border-gray-200 dark:border-gray-700 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm",children:s.jsx(ce,{className:"p-4",children:s.jsx("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4",children:s.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400",children:[s.jsxs("div",{className:"flex items-center gap-2 bg-green-50 dark:bg-green-900/20 px-3 py-1.5 rounded-full",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),s.jsxs("span",{className:"font-medium text-green-700 dark:text-green-400",children:[I," von 30+ Feldern erfasst"]})]}),s.jsxs(Qe,{variant:"outline",className:`${(((V=t.confidence_scores)==null?void 0:V.overall)||0)>=.8?"bg-green-50 text-green-700 border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-800":((($=t.confidence_scores)==null?void 0:$.overall)||0)>=.6?"bg-yellow-50 text-yellow-700 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-800":"bg-red-50 text-red-700 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800"}`,children:[Math.round((((F=t.confidence_scores)==null?void 0:F.overall)||0)*100),"% Vertrauen"]})]})})})}),s.jsx(oe,{className:"shadow-lg border border-gray-200 dark:border-gray-700 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex justify-center items-center gap-3",children:[s.jsx(ee,{variant:"outline",onClick:r,className:"px-5 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800 border-gray-300 dark:border-gray-600 transition-all duration-200",children:"Abbrechen"}),s.jsxs(ee,{variant:"outline",onClick:n,className:"px-5 py-2 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/30 border-red-200 hover:border-red-300 dark:border-red-800 dark:hover:border-red-700 transition-all duration-200",children:[s.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Ablehnen"]}),s.jsx(ee,{onClick:N,disabled:v,className:"px-8 py-2 bg-green-600 hover:bg-green-700 text-white font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:v?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full"}),"Verarbeitung..."]}):s.jsxs(s.Fragment,{children:[s.jsx(xf,{className:"h-4 w-4 mr-2"}),"Validieren & Übernehmen"]})})]})})})]})]}),u&&s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(sa,{className:"h-5 w-5"}),"OCR Rohtext"]})}),s.jsx(ce,{children:s.jsx("pre",{className:"text-sm bg-gray-100 dark:bg-gray-800 p-4 rounded-lg whitespace-pre-wrap max-h-60 overflow-y-auto",children:t.extracted_text})})]}),b&&x&&s.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",onClick:()=>w(!1),children:s.jsxs("div",{className:"relative max-w-7xl max-h-full w-full h-full flex items-center justify-center",children:[s.jsx("button",{onClick:()=>w(!1),className:"absolute top-4 right-4 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",title:"Schließen (ESC)",children:s.jsx(Ln,{className:"h-6 w-6"})}),s.jsx("img",{src:x,alt:"Vergrößerte Rechnung",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",onClick:O=>O.stopPropagation()})]})})]})}function Jte(){const[t,e]=g.useState([]),[n,r]=g.useState(!0),[a,i]=g.useState(""),[o,c]=g.useState("all"),[d,u]=g.useState(null);g.useEffect(()=>{m()},[]);const m=async()=>{try{r(!0);const{data:{user:_}}=await Z.auth.getUser();if(!_)return;const{data:b,error:w}=await Z.from("supplier_invoices").select("*").eq("created_by",_.id).order("created_at",{ascending:!1});if(w){console.error("Error loading supplier invoices:",w);return}e(b||[])}catch(_){console.error("Failed to load supplier invoices:",_)}finally{r(!1)}},f=_=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(_),p=_=>new Date(_).toLocaleDateString("de-DE"),x=_=>{switch(_){case"pending":return s.jsxs(Qe,{variant:"outline",className:"bg-yellow-50 text-yellow-800 border-yellow-200",children:[s.jsx(an,{className:"h-3 w-3 mr-1"}),"Ausstehend"]});case"approved":return s.jsxs(Qe,{variant:"outline",className:"bg-blue-50 text-blue-800 border-blue-200",children:[s.jsx(Ts,{className:"h-3 w-3 mr-1"}),"Genehmigt"]});case"paid":return s.jsxs(Qe,{variant:"outline",className:"bg-green-50 text-green-800 border-green-200",children:[s.jsx(Ts,{className:"h-3 w-3 mr-1"}),"Bezahlt"]});case"cancelled":return s.jsxs(Qe,{variant:"outline",className:"bg-red-50 text-red-800 border-red-200",children:[s.jsx(Nl,{className:"h-3 w-3 mr-1"}),"Storniert"]});default:return s.jsx(Qe,{variant:"outline",children:_})}},j=async(_,b)=>{try{const{error:w}=await Z.from("supplier_invoices").update({status:b,updated_at:new Date().toISOString()}).eq("id",_);if(w){console.error("Error updating invoice status:",w);return}e(N=>N.map(S=>S.id===_?{...S,status:b}:S))}catch(w){console.error("Failed to update invoice status:",w)}},v=t.filter(_=>{const b=_.invoice_number.toLowerCase().includes(a.toLowerCase())||_.supplier_name.toLowerCase().includes(a.toLowerCase()),w=o==="all"||_.status===o;return b&&w});return n?s.jsx("div",{className:"flex items-center justify-center p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{children:"Lade Lieferantenrechnungen..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx(Mr,{className:"h-6 w-6"}),"Lieferantenrechnungen"]}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Verwalten Sie Ihre eingescannten und erstellten Lieferantenrechnungen"})]})}),s.jsx(oe,{children:s.jsx(ce,{className:"pt-6",children:s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(Bd,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),s.jsx(ae,{placeholder:"Nach Rechnungsnummer oder Lieferant suchen...",value:a,onChange:_=>i(_.target.value),className:"pl-9"})]})}),s.jsxs("select",{value:o,onChange:_=>c(_.target.value),className:"px-3 py-2 border rounded-md bg-background",children:[s.jsx("option",{value:"all",children:"Alle Status"}),s.jsx("option",{value:"pending",children:"Ausstehend"}),s.jsx("option",{value:"approved",children:"Genehmigt"}),s.jsx("option",{value:"paid",children:"Bezahlt"}),s.jsx("option",{value:"cancelled",children:"Storniert"})]})]})})}),v.length===0?s.jsx(oe,{children:s.jsx(ce,{className:"py-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Mr,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Rechnungen gefunden"}),s.jsx("p",{className:"text-muted-foreground",children:a||o!=="all"?"Keine Rechnungen entsprechen den aktuellen Filterkriterien.":"Sie haben noch keine Lieferantenrechnungen erstellt."})]})})}):s.jsx("div",{className:"grid gap-4",children:v.map(_=>s.jsx(oe,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>u(_),children:s.jsx(ce,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"space-y-3 flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h3",{className:"font-semibold text-lg",children:_.invoice_number}),_.ocr_result_id&&s.jsxs(Qe,{variant:"outline",className:"text-xs",children:[s.jsx(iS,{className:"h-3 w-3 mr-1"}),"OCR"]})]}),x(_.status)]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(la,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium",children:_.supplier_name})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("span",{children:["Datum: ",p(_.invoice_date)]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(lr,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"font-semibold text-primary",children:f(_.total_amount)})]})]}),(_.description||_.iban)&&s.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[_.description&&s.jsxs("div",{children:["Beschreibung: ",_.description]}),_.iban&&s.jsxs("div",{children:["IBAN: ",_.iban]})]}),_.vat_amount&&_.vat_amount>0&&s.jsxs("div",{className:"text-sm text-muted-foreground",children:["inkl. MwSt: ",f(_.vat_amount)]})]}),s.jsxs("div",{className:"flex gap-2 ml-4",children:[_.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsx(ee,{size:"sm",onClick:()=>j(_.id,"approved"),className:"bg-blue-600 hover:bg-blue-700",children:"Genehmigen"}),s.jsx(ee,{size:"sm",variant:"outline",onClick:()=>j(_.id,"cancelled"),className:"border-red-600 text-red-600 hover:bg-red-50",children:"Stornieren"})]}),_.status==="approved"&&s.jsx(ee,{size:"sm",onClick:()=>j(_.id,"paid"),className:"bg-green-600 hover:bg-green-700",children:"Als bezahlt markieren"})]})]})})},_.id))}),v.length>0&&s.jsx(oe,{className:"bg-muted/50",children:s.jsx(ce,{className:"pt-6",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"text-sm text-muted-foreground",children:[v.length," Rechnung",v.length!==1?"en":""," gefunden"]}),s.jsxs("span",{className:"font-semibold",children:["Gesamtsumme: ",f(v.filter(_=>_.status!=="cancelled").reduce((_,b)=>_+b.total_amount,0))]})]})})}),d&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>u(null),children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:_=>_.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx(Mr,{className:"h-6 w-6"}),"Rechnungsdetails"]}),s.jsx(ee,{variant:"ghost",size:"sm",onClick:()=>u(null),className:"hover:bg-gray-100",children:s.jsx(Nl,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Rechnungsinformationen"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Rechnungsnummer:"}),s.jsx("span",{className:"font-medium",children:d.invoice_number})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Lieferant:"}),s.jsx("span",{className:"font-medium",children:d.supplier_name})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Rechnungsdatum:"}),s.jsx("span",{children:p(d.invoice_date)})]}),d.due_date&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Fälligkeitsdatum:"}),s.jsx("span",{children:p(d.due_date)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Status:"}),x(d.status)]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Beträge"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Gesamtbetrag:"}),s.jsx("span",{className:"font-bold text-lg text-primary",children:f(d.total_amount)})]}),d.vat_amount&&d.vat_amount>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"MwSt-Betrag:"}),s.jsx("span",{children:f(d.vat_amount)})]})]})]})]}),d.description&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Beschreibung"}),s.jsx("p",{className:"text-sm text-muted-foreground bg-gray-50 p-3 rounded-lg",children:d.description})]}),d.iban&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Zahlungsinformationen"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"IBAN: "}),s.jsx("span",{className:"font-mono bg-gray-50 px-2 py-1 rounded",children:d.iban})]})]}),d.ocr_result_id&&s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[s.jsx(iS,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Diese Rechnung wurde über OCR erfasst"})]})}),s.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[d.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsxs(ee,{onClick:()=>{j(d.id,"approved"),u(null)},className:"bg-blue-600 hover:bg-blue-700",children:[s.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Genehmigen"]}),s.jsxs(ee,{variant:"outline",onClick:()=>{j(d.id,"cancelled"),u(null)},className:"border-red-600 text-red-600 hover:bg-red-50",children:[s.jsx(Nl,{className:"h-4 w-4 mr-2"}),"Stornieren"]})]}),d.status==="approved"&&s.jsxs(ee,{onClick:()=>{j(d.id,"paid"),u(null)},className:"bg-green-600 hover:bg-green-700",children:[s.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Als bezahlt markieren"]}),s.jsx(ee,{variant:"outline",onClick:()=>u(null),children:"Schließen"})]})]})]})})]})}function ene(){const[t,e]=g.useState(""),[n,r]=g.useState(!1),[a,i]=g.useState(!1),[o,c]=g.useState(null),{toast:d}=Mt(),{data:u,isLoading:m}=HZ(),{data:f,isLoading:p}=dR(),{data:x,isLoading:j}=eG(),{data:v,isLoading:_}=rG(),b=ns();VZ(),uR(),KZ();const w=(u==null?void 0:u.items)||[],N=(f==null?void 0:f.items)||[];x!=null&&x.items;const S=m||p||j,C=async(D,B,W)=>{var X;try{d({title:"E-Mail versendet",description:`${D==="quote"?"Angebot":"Rechnung"} wurde erfolgreich an ${((X=W.customer)==null?void 0:X.email)||"den Kunden"} versendet.`})}catch{d({title:"Fehler beim Versenden",description:"Die E-Mail konnte nicht versendet werden.",variant:"destructive"})}},A=D=>{switch(D){case"Entwurf":return"secondary";case"Versendet":return"default";case"Angenommen":case"Bezahlt":return"default";case"Abgelehnt":case"Storniert":return"destructive";case"Überfällig":return"destructive";case"Abgelaufen":return"secondary";default:return"default"}},P=(D,B="EUR")=>new Intl.NumberFormat("de-DE",{style:"currency",currency:B}).format(D),M=D=>new Date(D).toLocaleDateString("de-DE"),z=w.filter(D=>D.title.toLowerCase().includes(t.toLowerCase())||D.quote_number.toLowerCase().includes(t.toLowerCase())||D.customer.company_name.toLowerCase().includes(t.toLowerCase())),R=N.filter(D=>D.title.toLowerCase().includes(t.toLowerCase())||D.invoice_number.toLowerCase().includes(t.toLowerCase())||D.customer.company_name.toLowerCase().includes(t.toLowerCase()));return s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dokumente"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(ee,{onClick:()=>r(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),s.jsxs(ee,{onClick:()=>i(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Rechnung erstellen"]})]})]}),s.jsx(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:s.jsx(ce,{className:"p-4",children:s.jsx("div",{className:"flex items-center space-x-2",children:s.jsxs("div",{className:"relative flex-1 max-w-sm",children:[s.jsx(Bd,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),s.jsx(ae,{placeholder:"Dokumente suchen...",value:t,onChange:D=>e(D.target.value),className:"pl-8 rounded-xl"})]})})})}),s.jsxs(Is,{defaultValue:"quotes",className:"space-y-4",children:[s.jsxs(js,{children:[s.jsxs(Je,{value:"quotes",className:"flex items-center gap-2",children:[s.jsx(wn,{className:"h-4 w-4"}),"Angebote (",w.length,")"]}),s.jsxs(Je,{value:"invoices",className:"flex items-center gap-2",children:[s.jsx(Mr,{className:"h-4 w-4"}),"Rechnungen (",N.length,")"]}),s.jsxs(Je,{value:"ocr",className:"flex items-center gap-2",children:[s.jsx(ah,{className:"h-4 w-4"}),"OCR-Import ",v&&v.length>0&&s.jsx(Qe,{variant:"destructive",className:"ml-1 px-1.5 py-0.5 text-xs",children:v.length})]}),s.jsxs(Je,{value:"templates",className:"flex items-center gap-2",children:[s.jsx(wn,{className:"h-4 w-4"}),"Vorlagen"]})]}),s.jsx(et,{value:"quotes",className:"space-y-4",children:S?s.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((D,B)=>s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(dt,{className:"h-5 w-32"}),s.jsx(dt,{className:"h-6 w-20"})]}),s.jsx(dt,{className:"h-4 w-48 mb-2"}),s.jsx(dt,{className:"h-4 w-24"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx(dt,{className:"h-6 w-20 mb-2"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(dt,{className:"h-8 w-16"}),s.jsx(dt,{className:"h-8 w-16"})]})]})]})})},B))}):z.length===0?s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsxs(ce,{className:"py-8 text-center",children:[s.jsx(wn,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Angebote gefunden"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:t?"Keine Angebote entsprechen Ihren Suchkriterien.":"Erstellen Sie Ihr erstes Angebot."}),s.jsxs(ee,{onClick:()=>r(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]})]})}):s.jsx("div",{className:"grid gap-4",children:z.map(D=>s.jsx(oe,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h3",{className:"font-semibold",children:D.quote_number}),s.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${D.status==="Entwurf"?"bg-gray-100 text-gray-800":D.status==="Versendet"?"bg-blue-100 text-blue-800":D.status==="Angenommen"?"bg-green-100 text-green-800":D.status==="Abgelehnt"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:D.status})]}),s.jsx("h4",{className:"text-lg font-medium mb-1",children:D.title}),s.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[D.customer.company_name," • ",D.customer.contact_person]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Erstellt: ",M(D.quote_date)]}),D.valid_until&&s.jsxs("span",{children:["Gültig bis: ",M(D.valid_until)]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-xl font-bold mb-2",children:P(D.total_amount,D.currency)}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(ee,{variant:"ghost",size:"sm",title:"Ansehen",className:"rounded-xl",children:s.jsx(sa,{className:"h-4 w-4"})}),s.jsx(ee,{variant:"ghost",size:"sm",title:"Bearbeiten",className:"rounded-xl",children:s.jsx(Tl,{className:"h-4 w-4"})}),s.jsx(ee,{variant:"ghost",size:"sm",className:"rounded-xl",title:"Per E-Mail versenden",onClick:()=>C("quote",D.id,D),disabled:!1,children:s.jsx(es,{className:"h-4 w-4"})}),s.jsx(ee,{variant:"ghost",size:"sm",title:"Herunterladen",className:"rounded-xl",children:s.jsx(D_,{className:"h-4 w-4"})}),s.jsx(Zte,{quote:D,onRefresh:()=>b.invalidateQueries({queryKey:["quotes"]})})]})]})]})})},D.id))})}),s.jsx(et,{value:"invoices",className:"space-y-4",children:s.jsxs(Is,{defaultValue:"customer",className:"space-y-4",children:[s.jsxs(js,{children:[s.jsxs(Je,{value:"customer",children:["Kundenrechnungen (",N.length,")"]}),s.jsx(Je,{value:"supplier",children:"Lieferantenrechnungen"})]}),s.jsx(et,{value:"customer",className:"space-y-4",children:S?s.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((D,B)=>s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(dt,{className:"h-5 w-32"}),s.jsx(dt,{className:"h-6 w-20"})]}),s.jsx(dt,{className:"h-4 w-48 mb-2"}),s.jsx(dt,{className:"h-4 w-24"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx(dt,{className:"h-6 w-20 mb-2"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(dt,{className:"h-8 w-16"}),s.jsx(dt,{className:"h-8 w-16"})]})]})]})})},B))}):R.length===0?s.jsx(oe,{children:s.jsxs(ce,{className:"py-8 text-center",children:[s.jsx(Mr,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Kundenrechnungen gefunden"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:t?"Keine Kundenrechnungen entsprechen Ihren Suchkriterien.":"Erstellen Sie Ihre erste Kundenrechnung."}),s.jsxs(ee,{onClick:()=>i(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Kundenrechnung erstellen"]})]})}):s.jsx("div",{className:"grid gap-4",children:R.map(D=>s.jsx(oe,{className:"hover:shadow-lg transition-shadow",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h3",{className:"font-semibold",children:D.invoice_number}),s.jsx(Qe,{variant:A(D.status),children:D.status})]}),s.jsx("h4",{className:"text-lg font-medium mb-1",children:D.title}),s.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[D.customer.company_name," • ",D.customer.contact_person]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Erstellt: ",M(D.invoice_date)]}),s.jsxs("span",{children:["Fällig: ",M(D.due_date)]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-xl font-bold mb-2",children:P(D.total_amount,D.currency)}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(ee,{variant:"ghost",size:"sm",title:"Ansehen",children:s.jsx(sa,{className:"h-4 w-4"})}),s.jsx(ee,{variant:"ghost",size:"sm",title:"Bearbeiten",children:s.jsx(Tl,{className:"h-4 w-4"})}),s.jsx(ee,{variant:"ghost",size:"sm",title:"Per E-Mail versenden",onClick:()=>C("invoice",D.id,D),disabled:!1,children:s.jsx(es,{className:"h-4 w-4"})}),s.jsx(ee,{variant:"ghost",size:"sm",title:"Herunterladen",children:s.jsx(D_,{className:"h-4 w-4"})})]})]})]})})},D.id))})}),s.jsx(et,{value:"supplier",className:"space-y-4",children:s.jsx(Jte,{})})]})}),s.jsx(et,{value:"ocr",className:"space-y-4",children:o?s.jsx(Xte,{ocrResult:o,onValidated:D=>{c(null),d({title:"Rechnung validiert",description:"Die Rechnungsdaten wurden erfolgreich validiert und können übernommen werden."}),console.log("Validated invoice data:",D)},onRejected:()=>{c(null),d({title:"OCR-Ergebnis abgelehnt",description:"Das OCR-Ergebnis wurde abgelehnt."})},onCancel:()=>c(null)}):s.jsxs("div",{className:"space-y-6",children:[s.jsx(Yte,{onOCRComplete:D=>{c(D)},onError:D=>{d({title:"OCR-Fehler",description:D,variant:"destructive"})}}),v&&v.length>0&&s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(ah,{className:"h-5 w-5"}),"Ausstehende Validierungen (",v.length,")"]})}),s.jsx(ce,{children:s.jsx("div",{className:"space-y-4",children:v.map(D=>s.jsx(oe,{className:"border-orange-200 bg-orange-50",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h4",{className:"font-medium",children:D.structured_data.supplierName}),s.jsx(Qe,{variant:"outline",className:"bg-orange-100 text-orange-800",children:"Ausstehend"}),s.jsxs(Qe,{variant:"outline",children:[Math.round(D.confidence_scores.overall*100),"% Konfidenz"]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Rechnung: ",D.structured_data.invoiceNumber]}),s.jsxs("span",{children:["Betrag: ",D.structured_data.totalAmount.toLocaleString("de-DE",{style:"currency",currency:"EUR"})]}),s.jsxs("span",{children:["Datum: ",new Date(D.structured_data.date).toLocaleDateString("de-DE")]}),s.jsxs("span",{children:["Verarbeitet: ",new Date(D.created_at).toLocaleString("de-DE")]})]})]}),s.jsx(ee,{onClick:()=>c(D),size:"sm",children:"Validieren"})]})})},D.id))})})]}),s.jsx(oe,{className:"bg-blue-50 border-blue-200",children:s.jsx(ce,{className:"p-6",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(ah,{className:"h-6 w-6 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Automatische Rechnungserfassung mit OCR"}),s.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[s.jsx("li",{children:"• Laden Sie Bilder oder PDFs von Lieferantenrechnungen hoch"}),s.jsx("li",{children:"• OCR erkennt automatisch Rechnungsnummer, Betrag, Lieferant und Datum"}),s.jsx("li",{children:"• Validieren Sie die erkannten Daten vor der Übernahme"}),s.jsx("li",{children:"• Rechnungen werden automatisch in Ihrem System angelegt"})]})]})]})})})]})}),s.jsx(et,{value:"templates",className:"space-y-4",children:s.jsx(oe,{children:s.jsxs(ce,{className:"py-8 text-center",children:[s.jsx(wn,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Vorlagen-Manager"}),s.jsx("p",{className:"text-muted-foreground",children:"Die Vorlagen-Funktionalität wird bald verfügbar sein."})]})})})]}),s.jsx(Vte,{open:n,onOpenChange:r}),s.jsx(Kte,{open:a,onOpenChange:i})]})}function tne(){const{user:t,userProfile:e}=Fr(),{toast:n}=Mt(),[r,a]=g.useState([]),[i,o]=g.useState(null),[c,d]=g.useState(!1),[u,m]=g.useState(!0),[f,p]=g.useState(""),[x,j]=g.useState(!1);g.useEffect(()=>{v()},[t,e]);const v=async()=>{if(!(!t||!(e!=null&&e.company_id)))try{m(!0);const{data:S,error:C}=await Z.rpc("get_pending_invoice_validations",{manager_company_id:e.company_id});if(C)throw C;a(S||[])}catch(S){console.error("Error loading pending invoices:",S),n({title:"Fehler beim Laden",description:"Ausstehende Validierungen konnten nicht geladen werden.",variant:"destructive"})}finally{m(!1)}},_=async(S,C)=>{if(t)try{const{data:A,error:P}=await Z.rpc("validate_receipt",{receipt_id:S,manager_id:t.id,action:C,reason:C==="reject"?f:null,validated_data:C==="validate"?{validated_by_manager:!0}:null});if(P)throw P;await v(),o(null),d(!1),j(!1),p(""),n({title:C==="validate"?"Rechnung genehmigt":"Rechnung abgelehnt",description:C==="validate"?"Die Rechnung wurde erfolgreich validiert und genehmigt.":"Die Rechnung wurde abgelehnt und der Mitarbeiter wurde benachrichtigt.",variant:C==="validate"?"default":"destructive"})}catch(A){console.error(`Error ${C}ing invoice:`,A),n({title:"Fehler",description:`Rechnung konnte nicht ${C==="validate"?"genehmigt":"abgelehnt"} werden.`,variant:"destructive"})}},b=S=>{switch(S){case"submitted":return s.jsx(Qe,{variant:"outline",className:"bg-blue-50 text-blue-700",children:"Eingereicht"});case"pending":return s.jsx(Qe,{variant:"outline",className:"bg-yellow-50 text-yellow-700",children:"In Bearbeitung"});case"validated":return s.jsx(Qe,{variant:"outline",className:"bg-green-50 text-green-700",children:"Genehmigt"});case"rejected":return s.jsx(Qe,{variant:"outline",className:"bg-red-50 text-red-700",children:"Abgelehnt"});default:return s.jsx(Qe,{variant:"outline",children:S})}},w=S=>S?S.toLocaleString("de-DE",{style:"currency",currency:"EUR"}):"-",N=S=>S.startsWith("data:")?S:`${Z.storage.from("project-media").getPublicUrl(S).data.publicUrl}`;return u?s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(Mr,{className:"h-5 w-5"}),"Rechnungsvalidierung"]})}),s.jsx(ce,{children:s.jsx("div",{className:"flex items-center justify-center h-32",children:s.jsxs("div",{className:"text-center",children:[s.jsx(an,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-gray-400"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Lade ausstehende Validierungen..."})]})})})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(Mr,{className:"h-5 w-5"}),"Rechnungsvalidierung"]}),s.jsx(ds,{children:"Überprüfen und genehmigen Sie von Mitarbeitern eingereichte Rechnungen"})]}),s.jsxs(ce,{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:[r.length," ausstehende Validierungen"]}),s.jsx(ee,{onClick:v,variant:"outline",size:"sm",children:"Aktualisieren"})]}),r.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Mr,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Keine ausstehenden Validierungen"}),s.jsx("p",{className:"text-gray-500",children:"Alle eingereichten Rechnungen wurden bereits bearbeitet."})]}):s.jsx("div",{className:"space-y-4",children:r.map(S=>s.jsx(oe,{className:"border-l-4 border-l-blue-500",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h4",{className:"font-semibold",children:S.project_name}),b(S.validation_status)]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(pr,{className:"h-4 w-4"}),S.employee_name]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Lt,{className:"h-4 w-4"}),new Date(S.created_at).toLocaleDateString("de-DE")]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(lr,{className:"h-4 w-4"}),w(S.amount)]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(wn,{className:"h-4 w-4"}),S.document_name]})]}),S.description&&s.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded mb-3",children:S.description})]}),s.jsx("div",{className:"flex flex-col gap-2 ml-4",children:s.jsxs(Kt,{children:[s.jsx(aQ,{asChild:!0,children:s.jsxs(ee,{variant:"outline",size:"sm",onClick:()=>o(S),children:[s.jsx(sa,{className:"h-4 w-4 mr-2"}),"Prüfen"]})}),s.jsxs(Wt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(Jt,{children:s.jsxs(en,{children:["Rechnungsvalidierung - ",S.project_name]})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Original-Dokument"}),s.jsx("img",{src:N(S.file_url),alt:"Receipt",className:"w-full rounded border",style:{maxHeight:"400px",objectFit:"contain"}})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Details"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Mitarbeiter:"}),s.jsx("span",{className:"font-medium",children:S.employee_name})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Projekt:"}),s.jsx("span",{className:"font-medium",children:S.project_name})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Betrag:"}),s.jsx("span",{className:"font-medium",children:w(S.amount)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Eingereicht:"}),s.jsx("span",{className:"font-medium",children:new Date(S.created_at).toLocaleString("de-DE")})]})]})]}),S.description&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Beschreibung"}),s.jsx("p",{className:"text-sm bg-gray-50 p-3 rounded",children:S.description})]}),S.ocr_result&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"OCR-Ergebnis"}),s.jsxs("div",{className:"text-sm bg-blue-50 p-3 rounded",children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("span",{children:"Status:"}),s.jsx("span",{className:"font-medium",children:S.ocr_result.status})]}),S.ocr_result.confidence&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Vertrauen:"}),s.jsxs("span",{className:"font-medium",children:[Math.round(S.ocr_result.confidence*100),"%"]})]})]})]}),s.jsx(mi,{}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ee,{onClick:()=>_(S.id,"validate"),className:"flex-1",children:[s.jsx(xf,{className:"h-4 w-4 mr-2"}),"Genehmigen"]}),s.jsxs(ee,{variant:"outline",onClick:()=>{o(S),j(!0)},className:"flex-1 text-red-600 border-red-200 hover:bg-red-50",children:[s.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Ablehnen"]})]})]})]})]})]})})]})})},S.id))})]})]}),s.jsx(Kt,{open:x,onOpenChange:j,children:s.jsxs(Wt,{children:[s.jsx(Jt,{children:s.jsxs(en,{className:"flex items-center gap-2 text-red-600",children:[s.jsx(Ln,{className:"h-5 w-5"}),"Rechnung ablehnen"]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Bitte geben Sie einen Grund für die Ablehnung an. Der Mitarbeiter wird über die Ablehnung und den Grund informiert."}),s.jsx(cn,{placeholder:"Grund für die Ablehnung...",value:f,onChange:S=>p(S.target.value),rows:3}),s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx(ee,{variant:"outline",onClick:()=>{j(!1),p("")},children:"Abbrechen"}),s.jsxs(ee,{variant:"destructive",onClick:()=>i&&_(i.id,"reject"),disabled:!f.trim(),children:[s.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Ablehnen"]})]})]})]})})]})}function nne(){const{toast:t}=Mt(),[e,n]=g.useState(null),[r,a]=g.useState(!0),[i,o]=g.useState(!1),c=async()=>{try{console.log("Creating default settings...");const{data:{user:f}}=await Z.auth.getUser();if(!f)throw new Error("Nicht angemeldet");const p={company_name:"Meine Firma",address:"",postal_code:"",city:"",country:"Deutschland",phone:"",email:"",website:"",tax_id:"",default_working_hours_start:"08:00",default_working_hours_end:"17:00",default_break_duration:60,default_hourly_rate:50,default_overtime_rate:62.5,default_currency:"EUR",default_tax_rate:19,default_vacation_days:25,invoice_prefix:"RE",quote_prefix:"AN",project_prefix:"PR",is_active:!0};console.log("Inserting default settings:",p);const{data:x,error:j}=await Z.from("company_settings").insert(p).select().single();if(console.log("Insert result:",{data:x,error:j}),j)throw j;n(x),t({title:"Erfolg",description:"Standard-Einstellungen wurden erstellt."})}catch(f){const p=f instanceof Error?f.message:String(f);console.error("Error creating default settings:",f),t({title:"Fehler",description:`Standard-Einstellungen konnten nicht erstellt werden: ${p}`,variant:"destructive"})}},d=async()=>{try{console.log("Loading company settings...");const{data:{user:f},error:p}=await Z.auth.getUser();if(console.log("Current user:",f),console.log("Auth error:",p),p||!f)throw new Error("Nicht angemeldet");const{data:x,error:j}=await Z.from("company_settings").select("*").limit(1).maybeSingle();if(console.log("Load result:",{data:x,error:j}),j)throw console.error("Supabase error details:",j),j;x?n(x):(console.log("No settings found, creating default..."),await c())}catch(f){const p=f instanceof Error?f.message:String(f);console.error("Error loading settings:",f),t({title:"Fehler beim Laden",description:`Einstellungen konnten nicht geladen werden: ${p}`,variant:"destructive"})}finally{a(!1)}};g.useEffect(()=>{d()},[]);const u=async()=>{if(!(e!=null&&e.id)){t({title:"Fehler",description:"Keine gültige Einstellungs-ID gefunden.",variant:"destructive"});return}o(!0);try{console.log("Saving settings:",e);const{data:{user:f}}=await Z.auth.getUser();if(!f)throw new Error("Nicht angemeldet");const p={company_name:e.company_name,company_address:e.company_address,company_city:e.company_city,company_postal_code:e.company_postal_code,company_country:e.company_country,company_phone:e.company_phone,company_email:e.company_email,tax_number:e.tax_number,vat_id:e.vat_id,website:e.website,default_working_hours_start:e.default_working_hours_start,default_working_hours_end:e.default_working_hours_end,default_break_duration:e.default_break_duration,default_hourly_rate:e.default_hourly_rate,default_overtime_rate:e.default_overtime_rate,default_currency:e.default_currency,default_tax_rate:e.default_tax_rate,default_vacation_days:e.default_vacation_days,invoice_prefix:e.invoice_prefix,quote_prefix:e.quote_prefix,project_prefix:e.project_prefix};console.log("Update data:",p),console.log("Settings ID:",e.id);const{data:x,error:j}=await Z.from("company_settings").update(p).eq("id",e.id).select();if(console.log("Save result:",{data:x,error:j}),j)throw j;t({title:"Erfolgreich gespeichert",description:"Die Firmeneinstellungen wurden aktualisiert."})}catch(f){const p=f instanceof Error?f.message:String(f);console.error("Error saving settings:",f),t({title:"Fehler beim Speichern",description:`Einstellungen konnten nicht gespeichert werden: ${p}`,variant:"destructive"})}finally{o(!1)}},m=(f,p)=>{e&&n({...e,[f]:p})};return r?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-muted-foreground",children:"Lade Einstellungen..."})}):e?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-gray-600 bg-clip-text text-transparent flex items-center gap-3",children:[s.jsx(Co,{className:"h-8 w-8 text-gray-600"}),"Firmeneinstellungen"]}),s.jsx("p",{className:"text-muted-foreground",children:"Verwalten Sie alle wichtigen Firmeninformationen"})]}),s.jsx(ee,{onClick:u,disabled:i,children:i?"Speichere...":"Einstellungen speichern"})]}),s.jsxs("div",{className:"grid gap-6",children:[s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(la,{className:"h-5 w-5"}),"Firmeninformationen"]}),s.jsx(ds,{children:"Grundlegende Informationen über Ihr Unternehmen"})]}),s.jsxs(ce,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"company_name",children:"Firmenname"}),s.jsx(ae,{id:"company_name",value:e.company_name||"",onChange:f=>m("company_name",f.target.value),placeholder:"Ihr Firmenname"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"website",children:"Website"}),s.jsx(ae,{id:"website",value:e.website||"",onChange:f=>m("website",f.target.value),placeholder:"https://www.ihre-website.de"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"company_address",children:"Adresse"}),s.jsx(cn,{id:"company_address",value:e.company_address||"",onChange:f=>m("company_address",f.target.value),placeholder:"Straße und Hausnummer",rows:2})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"company_postal_code",children:"Postleitzahl"}),s.jsx(ae,{id:"company_postal_code",value:e.company_postal_code||"",onChange:f=>m("company_postal_code",f.target.value),placeholder:"12345"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"company_city",children:"Stadt"}),s.jsx(ae,{id:"company_city",value:e.company_city||"",onChange:f=>m("company_city",f.target.value),placeholder:"Ihre Stadt"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"company_country",children:"Land"}),s.jsx(ae,{id:"company_country",value:e.company_country||"",onChange:f=>m("company_country",f.target.value),placeholder:"Deutschland"})]})]})]})]}),s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(es,{className:"h-5 w-5"}),"Kontaktinformationen"]}),s.jsx(ds,{children:"Wie Kunden Sie erreichen können"})]}),s.jsxs(ce,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"company_phone",children:"Telefon"}),s.jsx(ae,{id:"company_phone",value:e.company_phone||"",onChange:f=>m("company_phone",f.target.value),placeholder:"+49 123 456789"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"company_email",children:"E-Mail"}),s.jsx(ae,{id:"company_email",type:"email",value:e.company_email||"",onChange:f=>m("company_email",f.target.value),placeholder:"info@ihre-firma.de"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"tax_number",children:"Steuernummer"}),s.jsx(ae,{id:"tax_number",value:e.tax_number||"",onChange:f=>m("tax_number",f.target.value),placeholder:"123/456/78901"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"vat_id",children:"USt-IdNr."}),s.jsx(ae,{id:"vat_id",value:e.vat_id||"",onChange:f=>m("vat_id",f.target.value),placeholder:"DE123456789"})]})]})]})]}),s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(an,{className:"h-5 w-5"}),"Arbeitszeiten"]}),s.jsx(ds,{children:"Standard-Arbeitszeiten für Berechnungen und Zeiterfassung"})]}),s.jsx(ce,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"default_working_hours_start",children:"Arbeitsbeginn"}),s.jsx(ae,{id:"default_working_hours_start",type:"time",value:e.default_working_hours_start||"08:00",onChange:f=>m("default_working_hours_start",f.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"default_working_hours_end",children:"Arbeitsende"}),s.jsx(ae,{id:"default_working_hours_end",type:"time",value:e.default_working_hours_end||"17:00",onChange:f=>m("default_working_hours_end",f.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"default_break_duration",children:"Pausendauer (Min.)"}),s.jsx(ae,{id:"default_break_duration",type:"number",value:e.default_break_duration||60,onChange:f=>m("default_break_duration",Number(f.target.value)),placeholder:"60"})]})]})})]}),s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(Gb,{className:"h-5 w-5"}),"Finanzeinstellungen"]}),s.jsx(ds,{children:"Standard-Werte für Preise und Steuern"})]}),s.jsxs(ce,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"default_hourly_rate",children:"Standard-Stundensatz (€)"}),s.jsx(ae,{id:"default_hourly_rate",type:"number",step:"0.50",value:e.default_hourly_rate||"",onChange:f=>m("default_hourly_rate",Number(f.target.value)),placeholder:"50.00"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"default_overtime_rate",children:"Überstunden-Satz (€)"}),s.jsx(ae,{id:"default_overtime_rate",type:"number",step:"0.50",value:e.default_overtime_rate||"",onChange:f=>m("default_overtime_rate",Number(f.target.value)),placeholder:"62.50"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"default_currency",children:"Währung"}),s.jsx(ae,{id:"default_currency",value:e.default_currency||"EUR",onChange:f=>m("default_currency",f.target.value),placeholder:"EUR"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"default_tax_rate",children:"Steuersatz (%)"}),s.jsx(ae,{id:"default_tax_rate",type:"number",step:"0.1",value:e.default_tax_rate||"",onChange:f=>m("default_tax_rate",Number(f.target.value)),placeholder:"19.0"})]})]})]})]}),s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"h-5 w-5"}),"Urlaubseinstellungen"]}),s.jsx(ds,{children:"Standard-Urlaubstage für neue Mitarbeiter"})]}),s.jsx(ce,{className:"space-y-4",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"default_vacation_days",children:"Standard Urlaubstage pro Jahr"}),s.jsx(ae,{id:"default_vacation_days",type:"number",min:"0",max:"50",value:e.default_vacation_days||25,onChange:f=>m("default_vacation_days",Number(f.target.value)),placeholder:"25"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Diese Anzahl wird automatisch jedem neuen Mitarbeiter bei der Erstellung zugewiesen"})]})})]}),s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(wn,{className:"h-5 w-5"}),"Dokumenteinstellungen"]}),s.jsx(ds,{children:"Präfixe für automatische Nummerierung"})]}),s.jsx(ce,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"invoice_prefix",children:"Rechnungs-Präfix"}),s.jsx(ae,{id:"invoice_prefix",value:e.invoice_prefix||"",onChange:f=>m("invoice_prefix",f.target.value),placeholder:"RE"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"quote_prefix",children:"Angebots-Präfix"}),s.jsx(ae,{id:"quote_prefix",value:e.quote_prefix||"",onChange:f=>m("quote_prefix",f.target.value),placeholder:"AN"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"project_prefix",children:"Projekt-Präfix"}),s.jsx(ae,{id:"project_prefix",value:e.project_prefix||"",onChange:f=>m("project_prefix",f.target.value),placeholder:"PR"})]})]})})]})]})]}):s.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[s.jsx("div",{className:"text-muted-foreground",children:"Keine Einstellungen gefunden"}),s.jsx(ee,{onClick:c,children:"Standard-Einstellungen erstellen"})]})}function sne(t,e){return g.useReducer((n,r)=>e[n][r]??n,t)}var P1="ScrollArea",[DI,jae]=wr(P1),[rne,Br]=DI(P1),TI=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:a,scrollHideDelay:i=600,...o}=t,[c,d]=g.useState(null),[u,m]=g.useState(null),[f,p]=g.useState(null),[x,j]=g.useState(null),[v,_]=g.useState(null),[b,w]=g.useState(0),[N,S]=g.useState(0),[C,A]=g.useState(!1),[P,M]=g.useState(!1),z=Tt(e,D=>d(D)),R=Gd(a);return s.jsx(rne,{scope:n,type:r,dir:R,scrollHideDelay:i,scrollArea:c,viewport:u,onViewportChange:m,content:f,onContentChange:p,scrollbarX:x,onScrollbarXChange:j,scrollbarXEnabled:C,onScrollbarXEnabledChange:A,scrollbarY:v,onScrollbarYChange:_,scrollbarYEnabled:P,onScrollbarYEnabledChange:M,onCornerWidthChange:w,onCornerHeightChange:S,children:s.jsx(nt.div,{dir:R,...o,ref:z,style:{position:"relative","--radix-scroll-area-corner-width":b+"px","--radix-scroll-area-corner-height":N+"px",...t.style}})})});TI.displayName=P1;var MI="ScrollAreaViewport",RI=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,asChild:a,nonce:i,...o}=t,c=Br(MI,n),d=g.useRef(null),u=Tt(e,d,c.onViewportChange);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:i}),s.jsx(nt.div,{"data-radix-scroll-area-viewport":"",...o,asChild:a,ref:u,style:{overflowX:c.scrollbarXEnabled?"scroll":"hidden",overflowY:c.scrollbarYEnabled?"scroll":"hidden",...t.style},children:mne({asChild:a,children:r},m=>s.jsx("div",{"data-radix-scroll-area-content":"",ref:c.onContentChange,style:{minWidth:c.scrollbarXEnabled?"fit-content":void 0},children:m}))})]})});RI.displayName=MI;var Qa="ScrollAreaScrollbar",D1=g.forwardRef((t,e)=>{const{forceMount:n,...r}=t,a=Br(Qa,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,c=t.orientation==="horizontal";return g.useEffect(()=>(c?i(!0):o(!0),()=>{c?i(!1):o(!1)}),[c,i,o]),a.type==="hover"?s.jsx(ane,{...r,ref:e,forceMount:n}):a.type==="scroll"?s.jsx(ine,{...r,ref:e,forceMount:n}):a.type==="auto"?s.jsx(II,{...r,ref:e,forceMount:n}):a.type==="always"?s.jsx(T1,{...r,ref:e}):null});D1.displayName=Qa;var ane=g.forwardRef((t,e)=>{const{forceMount:n,...r}=t,a=Br(Qa,t.__scopeScrollArea),[i,o]=g.useState(!1);return g.useEffect(()=>{const c=a.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),o(!0)},m=()=>{d=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",m),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",m)}}},[a.scrollArea,a.scrollHideDelay]),s.jsx(Gn,{present:n||i,children:s.jsx(II,{"data-state":i?"visible":"hidden",...r,ref:e})})}),ine=g.forwardRef((t,e)=>{const{forceMount:n,...r}=t,a=Br(Qa,t.__scopeScrollArea),i=t.orientation==="horizontal",o=Xg(()=>d("SCROLL_END"),100),[c,d]=sne("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return g.useEffect(()=>{if(c==="idle"){const u=window.setTimeout(()=>d("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(u)}},[c,a.scrollHideDelay,d]),g.useEffect(()=>{const u=a.viewport,m=i?"scrollLeft":"scrollTop";if(u){let f=u[m];const p=()=>{const x=u[m];f!==x&&(d("SCROLL"),o()),f=x};return u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)}},[a.viewport,i,d,o]),s.jsx(Gn,{present:n||c!=="hidden",children:s.jsx(T1,{"data-state":c==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:Re(t.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Re(t.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),II=g.forwardRef((t,e)=>{const n=Br(Qa,t.__scopeScrollArea),{forceMount:r,...a}=t,[i,o]=g.useState(!1),c=t.orientation==="horizontal",d=Xg(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,m=n.viewport.offsetHeight<n.viewport.scrollHeight;o(c?u:m)}},10);return Td(n.viewport,d),Td(n.content,d),s.jsx(Gn,{present:r||i,children:s.jsx(T1,{"data-state":i?"visible":"hidden",...a,ref:e})})}),T1=g.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,a=Br(Qa,t.__scopeScrollArea),i=g.useRef(null),o=g.useRef(0),[c,d]=g.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=zI(c.viewport,c.content),m={...r,sizes:c,onSizesChange:d,hasThumb:u>0&&u<1,onThumbChange:p=>i.current=p,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:p=>o.current=p};function f(p,x){return hne(p,o.current,c,x)}return n==="horizontal"?s.jsx(one,{...m,ref:e,onThumbPositionChange:()=>{if(a.viewport&&i.current){const p=a.viewport.scrollLeft,x=YC(p,c,a.dir);i.current.style.transform=`translate3d(${x}px, 0, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollLeft=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollLeft=f(p,a.dir))}}):n==="vertical"?s.jsx(lne,{...m,ref:e,onThumbPositionChange:()=>{if(a.viewport&&i.current){const p=a.viewport.scrollTop,x=YC(p,c);i.current.style.transform=`translate3d(0, ${x}px, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollTop=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollTop=f(p))}}):null}),one=g.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...a}=t,i=Br(Qa,t.__scopeScrollArea),[o,c]=g.useState(),d=g.useRef(null),u=Tt(e,d,i.onScrollbarXChange);return g.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),s.jsx(LI,{"data-orientation":"horizontal",...a,ref:u,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Yg(n)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.x),onDragScroll:m=>t.onDragScroll(m.x),onWheelScroll:(m,f)=>{if(i.viewport){const p=i.viewport.scrollLeft+m.deltaX;t.onWheelScroll(p),UI(p,f)&&m.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:R0(o.paddingLeft),paddingEnd:R0(o.paddingRight)}})}})}),lne=g.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...a}=t,i=Br(Qa,t.__scopeScrollArea),[o,c]=g.useState(),d=g.useRef(null),u=Tt(e,d,i.onScrollbarYChange);return g.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),s.jsx(LI,{"data-orientation":"vertical",...a,ref:u,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Yg(n)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.y),onDragScroll:m=>t.onDragScroll(m.y),onWheelScroll:(m,f)=>{if(i.viewport){const p=i.viewport.scrollTop+m.deltaY;t.onWheelScroll(p),UI(p,f)&&m.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:R0(o.paddingTop),paddingEnd:R0(o.paddingBottom)}})}})}),[cne,OI]=DI(Qa),LI=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:m,onResize:f,...p}=t,x=Br(Qa,n),[j,v]=g.useState(null),_=Tt(e,z=>v(z)),b=g.useRef(null),w=g.useRef(""),N=x.viewport,S=r.content-r.viewport,C=_n(m),A=_n(d),P=Xg(f,10);function M(z){if(b.current){const R=z.clientX-b.current.left,D=z.clientY-b.current.top;u({x:R,y:D})}}return g.useEffect(()=>{const z=R=>{const D=R.target;(j==null?void 0:j.contains(D))&&C(R,S)};return document.addEventListener("wheel",z,{passive:!1}),()=>document.removeEventListener("wheel",z,{passive:!1})},[N,j,S,C]),g.useEffect(A,[r,A]),Td(j,P),Td(x.content,P),s.jsx(cne,{scope:n,scrollbar:j,hasThumb:a,onThumbChange:_n(i),onThumbPointerUp:_n(o),onThumbPositionChange:A,onThumbPointerDown:_n(c),children:s.jsx(nt.div,{...p,ref:_,style:{position:"absolute",...p.style},onPointerDown:Re(t.onPointerDown,z=>{z.button===0&&(z.target.setPointerCapture(z.pointerId),b.current=j.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",x.viewport&&(x.viewport.style.scrollBehavior="auto"),M(z))}),onPointerMove:Re(t.onPointerMove,M),onPointerUp:Re(t.onPointerUp,z=>{const R=z.target;R.hasPointerCapture(z.pointerId)&&R.releasePointerCapture(z.pointerId),document.body.style.webkitUserSelect=w.current,x.viewport&&(x.viewport.style.scrollBehavior=""),b.current=null})})})}),M0="ScrollAreaThumb",FI=g.forwardRef((t,e)=>{const{forceMount:n,...r}=t,a=OI(M0,t.__scopeScrollArea);return s.jsx(Gn,{present:n||a.hasThumb,children:s.jsx(dne,{ref:e,...r})})}),dne=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...a}=t,i=Br(M0,n),o=OI(M0,n),{onThumbPositionChange:c}=o,d=Tt(e,f=>o.onThumbChange(f)),u=g.useRef(),m=Xg(()=>{u.current&&(u.current(),u.current=void 0)},100);return g.useEffect(()=>{const f=i.viewport;if(f){const p=()=>{if(m(),!u.current){const x=fne(f,c);u.current=x,c()}};return c(),f.addEventListener("scroll",p),()=>f.removeEventListener("scroll",p)}},[i.viewport,m,c]),s.jsx(nt.div,{"data-state":o.hasThumb?"visible":"hidden",...a,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Re(t.onPointerDownCapture,f=>{const x=f.target.getBoundingClientRect(),j=f.clientX-x.left,v=f.clientY-x.top;o.onThumbPointerDown({x:j,y:v})}),onPointerUp:Re(t.onPointerUp,o.onThumbPointerUp)})});FI.displayName=M0;var M1="ScrollAreaCorner",BI=g.forwardRef((t,e)=>{const n=Br(M1,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?s.jsx(une,{...t,ref:e}):null});BI.displayName=M1;var une=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,a=Br(M1,n),[i,o]=g.useState(0),[c,d]=g.useState(0),u=!!(i&&c);return Td(a.scrollbarX,()=>{var f;const m=((f=a.scrollbarX)==null?void 0:f.offsetHeight)||0;a.onCornerHeightChange(m),d(m)}),Td(a.scrollbarY,()=>{var f;const m=((f=a.scrollbarY)==null?void 0:f.offsetWidth)||0;a.onCornerWidthChange(m),o(m)}),u?s.jsx(nt.div,{...r,ref:e,style:{width:i,height:c,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function R0(t){return t?parseInt(t,10):0}function zI(t,e){const n=t/e;return isNaN(n)?0:n}function Yg(t){const e=zI(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function hne(t,e,n,r="ltr"){const a=Yg(n),i=a/2,o=e||i,c=a-o,d=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-c,m=n.content-n.viewport,f=r==="ltr"?[0,m]:[m*-1,0];return $I([d,u],f)(t)}function YC(t,e,n="ltr"){const r=Yg(e),a=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-a,o=e.content-e.viewport,c=i-r,d=n==="ltr"?[0,o]:[o*-1,0],u=Iw(t,d);return $I([0,o],[0,c])(u)}function $I(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function UI(t,e){return t>0&&t<e}var fne=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function a(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,c=n.top!==i.top;(o||c)&&e(),n=i,r=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(r)};function Xg(t,e){const n=_n(t),r=g.useRef(0);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),g.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function Td(t,e){const n=_n(e);Bn(()=>{let r=0;if(t){const a=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return a.observe(t),()=>{window.cancelAnimationFrame(r),a.unobserve(t)}}},[t,n])}function mne(t,e){const{asChild:n,children:r}=t;if(!n)return typeof e=="function"?e(r):e;const a=g.Children.only(r);return g.cloneElement(a,{children:typeof e=="function"?e(a.props.children):e})}var qI=TI,pne=RI,gne=BI;const Ww=g.forwardRef(({className:t,children:e,...n},r)=>s.jsxs(qI,{ref:r,className:Te("relative overflow-hidden",t),...n,children:[s.jsx(pne,{className:"h-full w-full rounded-[inherit]",children:e}),s.jsx(WI,{}),s.jsx(gne,{})]}));Ww.displayName=qI.displayName;const WI=g.forwardRef(({className:t,orientation:e="vertical",...n},r)=>s.jsx(D1,{ref:r,orientation:e,className:Te("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:s.jsx(FI,{className:"relative flex-1 rounded-full bg-border"})}));WI.displayName=D1.displayName;const xne=()=>{var ne,pe;const{toast:t}=Mt(),[e,n]=g.useState([]),[r,a]=g.useState([]),[i,o]=g.useState(null),[c,d]=g.useState([]),[u,m]=g.useState("inbox"),[f,p]=g.useState(""),[x,j]=g.useState(!1),[v,_]=g.useState(""),[b,w]=g.useState(!1),[N,S]=g.useState(!1),[C,A]=g.useState(!1),P=Q=>{try{return new Date(Q).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}catch{return"00:00"}},M=Q=>{try{return new Date(Q).toLocaleDateString("de-DE")}catch{return"01.01.2024"}},z=Q=>{try{const re=new Date(Q);return re.toLocaleDateString("de-DE")+" "+re.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}catch{return"01.01.2024 00:00"}},R={mail:es,"shopping-cart":gB,"message-square":aP,receipt:Mr,"help-circle":XF,newspaper:uB};g.useEffect(()=>{B(),W(),D()},[]),g.useEffect(()=>{if(v)return X(),ue()},[v]);const D=async()=>{try{const{data:{user:Q}}=await Z.auth.getUser();if(!Q){A(!1);return}console.log("Checking Gmail connection for user:",Q.id);const{data:re,error:me}=await Z.from("user_email_connections").select("*").eq("user_id",Q.id).eq("provider","gmail").eq("is_active",!0);console.log("Gmail connections query result:",{connections:re,error:me}),!me&&re&&re.length>0?(A(!0),console.log("Gmail connection found:",re[0])):(console.log("No active Gmail connection found, but enabling sync for testing"),A(!0))}catch(Q){console.error("Error checking Gmail connection:",Q),A(!0)}},B=async()=>{try{const{data:{user:Q}}=await Z.auth.getUser();if(!Q)return;const{data:re}=await Z.from("profiles").select("company_email").eq("id",Q.id).single();re!=null&&re.company_email&&_(re.company_email)}catch(Q){console.error("Error fetching company email:",Q)}},W=async()=>{try{const{data:Q,error:re}=await Z.from("email_categories").select("*").order("name");a(!re&&Q?Q:[{id:"orders",name:"Bestellungen",color:"#10b981",icon:"shopping-cart"},{id:"inquiries",name:"Anfragen",color:"#3b82f6",icon:"message-square"},{id:"invoices",name:"Rechnungen",color:"#f59e0b",icon:"receipt"},{id:"support",name:"Support",color:"#ef4444",icon:"help-circle"},{id:"newsletter",name:"Newsletter",color:"#8b5cf6",icon:"newspaper"}])}catch(Q){console.error("Error fetching categories:",Q)}},X=g.useCallback(async()=>{try{const{data:{user:Q}}=await Z.auth.getUser();if(Q){const{data:re}=await Z.from("profiles").select("company_id").eq("id",Q.id).single();if(re!=null&&re.company_id){const{data:me,error:he}=await Z.from("emails").select(`
              *,
              email_categories (name, color, icon),
              customers (company_name, contact_person, phone, website)
            `).eq("company_id",re.company_id).order("received_at",{ascending:!1}).limit(50);if(!he&&me){console.log(`Loaded ${me.length} real emails from database`);const ge=me.map(se=>({...se,reply_count:me.filter(we=>we.thread_id===se.thread_id).length-1}));n(ge);return}else console.error("Error loading emails from database:",he)}}}catch(Q){console.error("Error fetching emails:",Q)}console.log("No emails in database - user needs to sync Gmail first"),n([])},[]),ue=g.useCallback(()=>{const Q=Z.channel("emails-modern").on("postgres_changes",{event:"INSERT",schema:"public",table:"emails",filter:`recipient_email=eq.${v}`},re=>{const me=re.new;n(he=>[me,...he]),t({title:"📧 Neue E-Mail",description:`Von: ${me.sender_name||me.sender_email}`,action:s.jsx(ee,{size:"sm",onClick:()=>o(me),children:"Anzeigen"})})}).subscribe();return()=>Z.removeChannel(Q)},[v,t]),de=Q=>{o(Q),Q.is_read||G([Q.id],!0)},G=async(Q,re)=>{const{error:me}=await Z.from("emails").update({is_read:re}).in("id",Q);me||n(he=>he.map(ge=>Q.includes(ge.id)?{...ge,is_read:re}:ge))},I=async Q=>{const re=e.find(he=>he.id===Q);if(!re)return;const{error:me}=await Z.from("emails").update({is_starred:!re.is_starred}).eq("id",Q);me||n(he=>he.map(ge=>ge.id===Q?{...ge,is_starred:!re.is_starred}:ge))},V=async Q=>{const{error:re}=await Z.from("emails").update({is_archived:!0}).in("id",Q);re||(n(me=>me.filter(he=>!Q.includes(he.id))),d([]),t({title:"E-Mails archiviert",description:`${Q.length} E-Mail(s) wurden archiviert.`}))},$=Q=>{switch(Q){case"mark-read":G(c,!0);break;case"mark-unread":G(c,!1);break;case"archive":V(c);break;case"star":c.forEach(re=>I(re));break}},F=async Q=>{try{const{data:{user:re}}=await Z.auth.getUser();if(!re)return;const{data:me}=await Z.from("profiles").select("company_id").eq("id",re.id).single();if(!(me!=null&&me.company_id))return;let he=null;if(Q.customers){const{data:ge}=await Z.from("customers").select("id").eq("email",Q.sender_email).eq("company_id",me.company_id).single();if(ge)he=ge.id;else{const{data:se}=await Z.from("customers").insert({company_id:me.company_id,email:Q.sender_email,company_name:Q.customers.company_name,contact_person:Q.customers.contact_person}).select().single();se&&(he=se.id)}}if(he){const{data:ge,error:se}=await Z.from("quotes").insert({quote_number:`AG-${Date.now().toString().slice(-6)}`,company_id:me.company_id,customer_id:he,title:`Angebot bezüglich: ${Q.subject}`,description:`Automatisch erstellt aus E-Mail vom ${M(Q.received_at)}`,quote_date:new Date().toISOString().split("T")[0],valid_until:new Date(Date.now()+2592e6).toISOString().split("T")[0],status:"entwurf",total_amount:0,currency:"EUR"}).select().single();ge&&t({title:"Angebot erstellt",description:`Angebot ${ge.quote_number} wurde aus E-Mail erstellt.`})}}catch{t({title:"Fehler beim Erstellen",description:"Angebot konnte nicht erstellt werden.",variant:"destructive"})}},O=async Q=>{try{const{data:{user:re}}=await Z.auth.getUser();if(!re)return;const{data:me}=await Z.from("profiles").select("company_id").eq("id",re.id).single();if(!(me!=null&&me.company_id))return;let he=null;if(Q.customers){const{data:ge}=await Z.from("customers").select("id").eq("email",Q.sender_email).eq("company_id",me.company_id).single();ge&&(he=ge.id)}if(he){const{data:ge,error:se}=await Z.from("projects").insert({name:Q.subject||"Projekt aus E-Mail",customer_id:he,company_id:me.company_id,status:"anfrage",start_date:new Date().toISOString().split("T")[0],description:`Automatisch erstellt aus E-Mail vom ${z(Q.received_at)}.

Inhalt der E-Mail:
${Q.content.replace(/<[^>]*>/g,"")}`,budget:0}).select().single();ge&&t({title:"Projekt erstellt",description:`Projekt "${ge.name}" wurde aus E-Mail erstellt.`})}}catch{t({title:"Fehler beim Erstellen",description:"Projekt konnte nicht erstellt werden.",variant:"destructive"})}},K=e.filter(Q=>{var he,ge;const re=u==="inbox"?!Q.is_archived:u==="starred"?Q.is_starred:u==="unread"?!Q.is_read:((he=Q.email_categories)==null?void 0:he.name)===u,me=!f||Q.subject.toLowerCase().includes(f.toLowerCase())||((ge=Q.sender_name)==null?void 0:ge.toLowerCase().includes(f.toLowerCase()))||Q.sender_email.toLowerCase().includes(f.toLowerCase())||Q.content.toLowerCase().includes(f.toLowerCase());return re&&me}),U=Q=>{switch(Q){case"urgent":return s.jsx(ig,{className:"h-3 w-3 text-red-500"});case"high":return s.jsx(Kb,{className:"h-3 w-3 text-orange-500"});default:return null}},te=async()=>{try{const{data:{user:Q}}=await Z.auth.getUser();if(!Q){t({title:"Fehler",description:"Sie müssen angemeldet sein, um Gmail zu verbinden.",variant:"destructive"});return}const{data:re,error:me}=await Z.functions.invoke("initiate-gmail-oauth",{body:{user_id:Q.id}});if(re!=null&&re.authUrl){window.open(re.authUrl,"_blank","width=500,height=600"),t({title:"Gmail-Verbindung",description:"Ein neues Fenster wurde geöffnet. Bitte autorisieren Sie den Zugriff auf Gmail."});let he=0;const ge=setInterval(async()=>{he++,await D(),(C||he>=15)&&(clearInterval(ge),C&&t({title:"Gmail verbunden!",description:"Sie können jetzt E-Mails synchronisieren."}))},2e3)}else t({title:"Fehler",description:(me==null?void 0:me.message)||"Gmail-Verbindung konnte nicht gestartet werden.",variant:"destructive"})}catch(Q){console.error("Gmail OAuth error:",Q),t({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten.",variant:"destructive"})}},J=async()=>{var Q,re;try{console.log("Starting AI analysis for emails...");const me=e.filter(he=>!he.ai_category&&!he.ai_summary);if(me.length===0){console.log("No emails need AI analysis");return}console.log(`Analyzing ${me.length} emails with AI...`);for(const he of me.slice(0,5))try{const{data:ge,error:se}=await Z.functions.invoke("classify-email",{body:JSON.stringify({emailId:he.id,subject:he.subject,content:he.content,senderEmail:he.sender_email,senderName:he.sender_name})});if(ge&&!se){console.log(`AI analysis result for email ${he.id}:`,ge);const we={...he,ai_category:ge.category,ai_summary:ge.summary,ai_confidence:ge.confidence,priority:((Q=ge.extractedData)==null?void 0:Q.priority)||"normal"};n(Se=>Se.map(qe=>qe.id===he.id?we:qe)),await Z.from("emails").update({ai_category:ge.category,ai_summary:ge.summary,ai_confidence:ge.confidence,priority:((re=ge.extractedData)==null?void 0:re.priority)||"normal",processing_status:"completed"}).eq("id",he.id)}}catch(ge){console.error(`AI analysis failed for email ${he.id}:`,ge)}t({title:"KI-Analyse abgeschlossen",description:`${me.length} E-Mails wurden analysiert.`}),await X()}catch(me){console.error("AI analysis error:",me),t({title:"KI-Analyse Fehler",description:"Die KI-Analyse konnte nicht durchgeführt werden.",variant:"destructive"})}},q=async()=>{try{j(!0);const{data:{user:Q}}=await Z.auth.getUser();if(!Q){t({title:"Fehler",description:"Sie müssen angemeldet sein, um E-Mails zu synchronisieren.",variant:"destructive"}),j(!1);return}console.log("Starting Gmail sync for user:",Q.id);const re=new Promise((we,Se)=>setTimeout(()=>Se(new Error("Sync timeout after 30 seconds")),3e4)),me=Z.functions.invoke("sync-gmail-emails",{body:JSON.stringify({manual:!0,forceFullSync:!1}),headers:{"Content-Type":"application/json"}}),he=await Promise.race([me,re]),{data:ge,error:se}=he;console.log("Gmail sync response:",{data:ge,error:se}),ge!=null&&ge.success?(await X(),t({title:"Synchronisation erfolgreich",description:`${ge.synced_count||ge.totalSynced||0} neue E-Mails synchronisiert.`}),await J()):(console.error("Gmail sync failed:",se),t({title:"Synchronisationsfehler",description:(se==null?void 0:se.message)||(ge==null?void 0:ge.error)||"E-Mails konnten nicht synchronisiert werden.",variant:"destructive"}))}catch(Q){console.error("Gmail sync error:",Q),t({title:"Fehler",description:`Synchronisation fehlgeschlagen: ${Q.message}`,variant:"destructive"})}finally{j(!1)}};return s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"E-Mail Verwaltung"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(ee,{variant:C?"default":"outline",onClick:te,className:"rounded-full",children:[s.jsx(es,{className:"h-4 w-4 mr-2"}),C?"Gmail verbunden":"Gmail verbinden"]}),s.jsxs(ee,{variant:"outline",onClick:q,disabled:x||!C,className:"rounded-full",children:[s.jsx(iP,{className:`h-4 w-4 mr-2 ${x?"animate-spin":""}`}),"Synchronisieren"]}),s.jsxs(ee,{onClick:()=>S(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Neue E-Mail"]})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Ungelesen"}),s.jsx("p",{className:"text-2xl font-bold",children:e.filter(Q=>!Q.is_read).length})]}),s.jsx(es,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Markiert"}),s.jsx("p",{className:"text-2xl font-bold",children:e.filter(Q=>Q.is_starred).length})]}),s.jsx(_u,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Heute"}),s.jsx("p",{className:"text-2xl font-bold",children:e.filter(Q=>{try{return new Date(Q.received_at).toDateString()===new Date().toDateString()}catch{return!1}}).length})]}),s.jsx(Lt,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(ce,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"KI-Kategorien"}),s.jsx("p",{className:"text-2xl font-bold",children:e.filter(Q=>Q.ai_category).length})]}),s.jsx(Sm,{className:"h-8 w-8 text-purple-500 opacity-50"})]})})})]}),s.jsx(oe,{className:"shadow-soft rounded-2xl flex-1",style:{minHeight:"calc(100vh - 280px)"},children:s.jsx(ce,{className:"p-0",children:s.jsxs("div",{className:"flex",style:{height:"calc(100vh - 280px)"},children:[s.jsxs("div",{className:`${b?"w-16":"w-64"} border-r bg-muted/30 transition-all duration-200`,children:[s.jsxs("div",{className:"p-4 border-b",children:[s.jsx(ee,{size:"sm",variant:"ghost",onClick:()=>w(!b),className:"mb-4",children:b?s.jsx(jl,{className:"h-4 w-4"}):s.jsx(rh,{className:"h-4 w-4"})}),!b&&s.jsxs("div",{className:"relative",children:[s.jsx(Bd,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),s.jsx(ae,{placeholder:"E-Mails suchen...",value:f,onChange:Q=>p(Q.target.value),className:"pl-9 rounded-xl"})]})]}),s.jsxs("nav",{className:"flex-1 px-4 space-y-1",children:[s.jsxs(ee,{variant:u==="inbox"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m("inbox"),children:[s.jsx(es,{className:"h-4 w-4 mr-2"}),!b&&s.jsxs(s.Fragment,{children:["Posteingang",s.jsx(Qe,{variant:"secondary",className:"ml-auto",children:e.filter(Q=>!Q.is_archived).length})]})]}),s.jsxs(ee,{variant:u==="starred"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m("starred"),children:[s.jsx(_u,{className:"h-4 w-4 mr-2"}),!b&&s.jsxs(s.Fragment,{children:["Markiert",s.jsx(Qe,{variant:"secondary",className:"ml-auto",children:e.filter(Q=>Q.is_starred).length})]})]}),s.jsxs(ee,{variant:u==="unread"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m("unread"),children:[s.jsx(sa,{className:"h-4 w-4 mr-2"}),!b&&s.jsxs(s.Fragment,{children:["Ungelesen",s.jsx(Qe,{variant:"secondary",className:"ml-auto",children:e.filter(Q=>!Q.is_read).length})]})]}),!b&&s.jsx(mi,{className:"my-4"}),r.map(Q=>{const re=R[Q.icon]||es,me=e.filter(he=>{var ge;return((ge=he.email_categories)==null?void 0:ge.name)===Q.name}).length;return s.jsxs(ee,{variant:u===Q.name?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m(Q.name),children:[s.jsx(re,{className:"h-4 w-4 mr-2",style:{color:Q.color}}),!b&&s.jsxs(s.Fragment,{children:[Q.name,s.jsx(Qe,{variant:"secondary",className:"ml-auto",children:me})]})]},Q.id)})]}),!b&&s.jsx("div",{className:"p-4 border-t",children:s.jsxs(ee,{variant:"outline",className:"w-full rounded-xl",onClick:J,children:[s.jsx(Sm,{className:"h-4 w-4 mr-2"}),"KI-Analyse"]})})]}),s.jsxs("div",{className:"w-96 bg-background border-r flex flex-col",children:[c.length>0&&s.jsx("div",{className:"p-3 border-b bg-muted/50",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-sm text-muted-foreground",children:[c.length," ausgewählt"]}),s.jsx(ee,{size:"sm",variant:"ghost",onClick:()=>$("mark-read"),children:s.jsx(og,{className:"h-4 w-4"})}),s.jsx(ee,{size:"sm",variant:"ghost",onClick:()=>$("star"),children:s.jsx(_u,{className:"h-4 w-4"})}),s.jsx(ee,{size:"sm",variant:"ghost",onClick:()=>$("archive"),children:s.jsx(KF,{className:"h-4 w-4"})})]})}),s.jsx(Ww,{className:"flex-1",children:s.jsx("div",{className:"divide-y",children:K.map(Q=>{var re;return s.jsx("div",{className:`p-4 cursor-pointer transition-all hover:bg-accent/50 ${(i==null?void 0:i.id)===Q.id?"bg-accent border-r-2 border-primary":""} ${Q.is_read?"":"bg-blue-50/30 border-l-2 border-blue-500"}`,onClick:()=>de(Q),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(za,{checked:c.includes(Q.id),onCheckedChange:me=>{d(me?he=>[...he,Q.id]:he=>he.filter(ge=>ge!==Q.id))},onClick:me=>me.stopPropagation()}),s.jsx(tf,{className:"h-8 w-8 flex-shrink-0",children:s.jsx(nf,{children:((re=Q.sender_name)==null?void 0:re[0])||Q.sender_email[0].toUpperCase()})}),s.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:`text-sm truncate ${Q.is_read?"":"font-semibold"}`,children:Q.sender_name||Q.sender_email}),s.jsxs("div",{className:"flex items-center gap-1",children:[U(Q.priority),s.jsx("span",{className:"text-xs text-muted-foreground",children:P(Q.received_at)})]})]}),s.jsx("p",{className:`text-sm truncate ${Q.is_read?"":"font-semibold"}`,children:Q.subject}),s.jsxs("p",{className:"text-xs text-muted-foreground line-clamp-2",children:[Q.ai_summary||Q.content.replace(/<[^>]*>/g,"").substring(0,100),"..."]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[Q.is_starred&&s.jsx(_u,{className:"h-3 w-3 text-yellow-500 fill-current"}),Q.attachments&&Q.attachments.length>0&&s.jsx(hB,{className:"h-3 w-3 text-muted-foreground"}),Q.reply_count&&Q.reply_count>0&&s.jsx(Qe,{variant:"outline",className:"text-xs px-1 py-0",children:Q.reply_count})]}),Q.email_categories&&s.jsx(Qe,{variant:"outline",className:"text-xs",style:{borderColor:Q.email_categories.color,color:Q.email_categories.color},children:Q.email_categories.name})]})]})]})},Q.id)})})})]}),i?s.jsxs("div",{className:"flex-1 flex flex-col",children:[s.jsxs("div",{className:"p-6 border-b bg-card",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(tf,{className:"h-10 w-10",children:s.jsx(nf,{children:((ne=i.sender_name)==null?void 0:ne[0])||i.sender_email[0].toUpperCase()})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-medium",children:i.sender_name||i.sender_email}),s.jsx("p",{className:"text-sm text-muted-foreground",children:i.sender_email}),s.jsx("p",{className:"text-xs text-muted-foreground",children:z(i.received_at)})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ee,{size:"sm",variant:"ghost",onClick:()=>I(i.id),children:s.jsx(_u,{className:`h-4 w-4 ${i.is_starred?"text-yellow-500 fill-current":""}`})}),s.jsx(ee,{size:"sm",variant:"ghost",children:s.jsx(pB,{className:"h-4 w-4"})}),s.jsx(ee,{size:"sm",variant:"ghost",children:s.jsx(aB,{className:"h-4 w-4"})}),s.jsx(ee,{size:"sm",variant:"ghost",children:s.jsx(rB,{className:"h-4 w-4"})})]})]}),s.jsx("h2",{className:"text-xl font-semibold mb-4",children:i.subject}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.ai_category&&s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-purple-100 text-purple-800 border-purple-200",children:[s.jsx(Sm,{className:"h-3 w-3 mr-1"}),i.ai_category]}),i.customers&&s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-100 text-green-800 border-green-200",children:[s.jsx(la,{className:"h-3 w-3 mr-1"}),i.customers.company_name]})]}),i.ai_summary&&s.jsxs("div",{className:"bg-accent/50 p-4 rounded-xl mt-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Sm,{className:"h-4 w-4 text-primary"}),s.jsx("span",{className:"text-sm font-medium",children:"KI-Zusammenfassung"}),i.ai_confidence&&s.jsxs(Qe,{variant:"outline",className:"text-xs",children:[Math.round(i.ai_confidence*100),"% Konfidenz"]})]}),s.jsx("p",{className:"text-sm",children:i.ai_summary})]}),s.jsxs("div",{className:"flex gap-2 mt-4",children:[s.jsxs(ee,{size:"sm",onClick:()=>F(i),className:"rounded-xl",children:[s.jsx(wn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),s.jsxs(ee,{size:"sm",variant:"outline",onClick:()=>O(i),className:"rounded-xl",children:[s.jsx(la,{className:"h-4 w-4 mr-2"}),"Projekt anlegen"]}),((pe=i.customers)==null?void 0:pe.phone)&&s.jsx(ee,{size:"sm",variant:"outline",asChild:!0,className:"rounded-xl",children:s.jsxs("a",{href:`tel:${i.customers.phone}`,children:[s.jsx(Fd,{className:"h-4 w-4 mr-2"}),"Anrufen"]})})]})]}),s.jsx(Ww,{className:"flex-1 p-6",children:s.jsx("div",{className:"prose prose-sm max-w-none text-gray-800 dark:text-gray-200",style:{fontSize:"14px",lineHeight:"1.6"},dangerouslySetInnerHTML:{__html:i.html_content||i.content.replace(/\n/g,"<br>")}})})]}):s.jsx("div",{className:"flex-1 flex items-center justify-center bg-muted/20",children:s.jsxs("div",{className:"text-center",children:[s.jsx(es,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-lg font-medium mb-2",children:"Keine E-Mail ausgewählt"}),s.jsx("p",{className:"text-muted-foreground",children:"Wählen Sie eine E-Mail aus, um sie anzuzeigen"})]})})]})})})]})};function HI({open:t,onOpenChange:e,onSuccess:n}){const{toast:r}=Mt(),[a,i]=g.useState(!1),[o,c]=g.useState(0),[d,u]=g.useState({startDate:"",endDate:"",reason:"",type:"vacation"});g.useEffect(()=>{t&&m()},[t]);const m=async()=>{try{const{data:{user:j}}=await Z.auth.getUser();if(!j)return;const{data:v}=await Z.from("employees").select("id, vacation_days_total, vacation_days_used").eq("user_id",j.id).single();if(v){const _=(v.vacation_days_total||0)-(v.vacation_days_used||0);c(Math.max(0,_))}else{const{data:_}=await Z.from("company_settings").select("default_vacation_days").single();c((_==null?void 0:_.default_vacation_days)||25)}}catch(j){console.error("Error loading vacation balance:",j),c(0)}},f=(j,v)=>{if(!j||!v)return 0;const _=new Date(j),w=new Date(v).getTime()-_.getTime(),N=Math.ceil(w/(1e3*3600*24))+1;return Math.max(0,N)},p=async j=>{if(j.preventDefault(),!d.startDate||!d.endDate){r({title:"Fehler",description:"Bitte wählen Sie Start- und Enddatum aus",variant:"destructive"});return}const v=new Date(d.startDate),_=new Date(d.endDate);if(v>_){r({title:"Fehler",description:"Das Enddatum muss nach dem Startdatum liegen",variant:"destructive"});return}const b=f(d.startDate,d.endDate);if(d.type==="vacation"&&b>o){r({title:"Fehler",description:`Sie haben nur noch ${o} Urlaubstage verfügbar`,variant:"destructive"});return}i(!0);try{const{data:{user:w}}=await Z.auth.getUser();if(!w)throw new Error("Nicht angemeldet");const{data:N,error:S}=await Z.from("employees").select("id").eq("user_id",w.id).single();if(S||!N)throw new Error("Mitarbeiterdaten nicht gefunden");const{error:C}=await Z.from("vacation_requests").insert({employee_id:N.id,start_date:d.startDate,end_date:d.endDate,days_requested:b,request_type:d.type,reason:d.reason||null,status:"pending",created_by:w.id});if(C)throw C;r({title:"Antrag eingereicht",description:`Ihr ${d.type==="vacation"?"Urlaubs":"Abwesenheits"}antrag wurde erfolgreich eingereicht`}),u({startDate:"",endDate:"",reason:"",type:"vacation"}),e(!1),n==null||n()}catch(w){console.error("Error submitting vacation request:",w),r({title:"Fehler",description:w.message||"Antrag konnte nicht eingereicht werden",variant:"destructive"})}finally{i(!1)}},x=f(d.startDate,d.endDate);return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsx(Jt,{children:s.jsxs(en,{className:"flex items-center gap-2",children:[s.jsx(Lt,{className:"h-5 w-5"}),"Urlaubsantrag stellen"]})}),s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{children:"Verfügbare Urlaubstage:"}),s.jsxs("span",{className:"font-semibold text-blue-600",children:[o," Tage"]})]})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{children:"Art der Abwesenheit"}),s.jsxs("select",{value:d.type,onChange:j=>u(v=>({...v,type:j.target.value})),className:"w-full p-2 border rounded-md",children:[s.jsx("option",{value:"vacation",children:"Urlaub"}),s.jsx("option",{value:"sick",children:"Krankmeldung"}),s.jsx("option",{value:"personal",children:"Persönliche Angelegenheiten"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"startDate",children:"Von"}),s.jsx(ae,{id:"startDate",type:"date",value:d.startDate,onChange:j=>u(v=>({...v,startDate:j.target.value})),min:new Date().toISOString().split("T")[0],required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"endDate",children:"Bis"}),s.jsx(ae,{id:"endDate",type:"date",value:d.endDate,onChange:j=>u(v=>({...v,endDate:j.target.value})),min:d.startDate||new Date().toISOString().split("T")[0],required:!0})]})]}),x>0&&s.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(an,{className:"h-4 w-4"}),"Beantragte Tage:"]}),s.jsxs("span",{className:`font-semibold ${d.type==="vacation"&&x>o?"text-red-600":"text-green-600"}`,children:[x," ",x===1?"Tag":"Tage"]})]}),d.type==="vacation"&&x>o&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Nicht genügend Urlaubstage verfügbar"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(Y,{htmlFor:"reason",children:["Begründung ",d.type!=="vacation"&&"(erforderlich)"]}),s.jsx(cn,{id:"reason",value:d.reason,onChange:j=>u(v=>({...v,reason:j.target.value})),placeholder:d.type==="vacation"?"Optionale Begründung für den Urlaub...":"Bitte geben Sie eine Begründung an...",rows:3,required:d.type!=="vacation"})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsx(ee,{type:"submit",disabled:a||!d.startDate||!d.endDate,className:"flex-1",children:a?"Wird eingereicht...":"Antrag stellen"}),s.jsx(ee,{type:"button",variant:"outline",onClick:()=>e(!1),disabled:a,children:"Abbrechen"})]})]})]})})}function vne(){const{user:t,userRole:e}=Fr(),{toast:n}=Mt(),[r,a]=g.useState([]),[i,o]=g.useState({total_days:0,used_days:0,pending_days:0,available_days:0}),[c,d]=g.useState(!0),[u,m]=g.useState(!1),[f,p]=g.useState("my-requests"),x=e==="manager"||e==="admin";g.useEffect(()=>{t&&j()},[t,f]);const j=async()=>{d(!0);try{await Promise.all([v(),_()])}catch(S){console.error("Error loading vacation data:",S)}finally{d(!1)}},v=async()=>{if(t)try{const{data:S}=await Z.from("employees").select("vacation_days_total, vacation_days_used").eq("user_id",t.id).single();if(S){const{data:C}=await Z.from("vacation_requests").select("days_requested").eq("employee_id",S.id).eq("status","pending").eq("request_type","vacation"),A=(C==null?void 0:C.reduce((R,D)=>R+D.days_requested,0))||0,P=S.vacation_days_total||0,M=S.vacation_days_used||0,z=Math.max(0,P-M-A);o({total_days:P,used_days:M,pending_days:A,available_days:z})}else{const{data:C}=await Z.from("company_settings").select("default_vacation_days").single(),A=(C==null?void 0:C.default_vacation_days)||25;o({total_days:A,used_days:0,pending_days:0,available_days:A})}}catch(S){console.error("Error loading vacation balance:",S)}},_=async()=>{if(t)try{let S=Z.from("vacation_requests").select(`
          id,
          employee_id,
          start_date,
          end_date,
          days_requested,
          request_type,
          reason,
          status,
          created_at,
          approved_by,
          approved_at,
          employees!inner(
            id,
            first_name,
            last_name,
            user_id
          )
        `).order("created_at",{ascending:!1});if(f==="my-requests"||!x){const{data:M}=await Z.from("employees").select("id").eq("user_id",t.id).single();M&&(S=S.eq("employee_id",M.id))}const{data:C,error:A}=await S;if(A)throw A;const P=(C==null?void 0:C.map(M=>({id:M.id,employee_id:M.employee_id,employee_name:`${M.employees.first_name} ${M.employees.last_name}`,start_date:M.start_date,end_date:M.end_date,days_requested:M.days_requested,request_type:M.request_type,reason:M.reason,status:M.status,created_at:M.created_at,approved_by:M.approved_by,approved_at:M.approved_at})))||[];a(P)}catch(S){console.error("Error loading vacation requests:",S),n({title:"Fehler",description:"Urlaubsanträge konnten nicht geladen werden",variant:"destructive"})}},b=async(S,C)=>{const A=[...r];a(P=>P.filter(M=>M.id!==S));try{const P={status:C?"approved":"rejected",approved_by:t==null?void 0:t.id,approved_at:new Date().toISOString()},{error:M}=await Z.from("vacation_requests").update(P).eq("id",S);if(M)throw a(A),M;if(C){const z=r.find(R=>R.id===S);if(z&&z.request_type==="vacation"){const{error:R}=await Z.rpc("increment_vacation_days_used",{employee_id_param:z.employee_id,days_to_add:z.days_requested});R&&console.error("Error updating vacation days:",R)}}n({title:C?"Antrag genehmigt":"Antrag abgelehnt",description:`Der Urlaubsantrag wurde erfolgreich ${C?"genehmigt":"abgelehnt"}`}),setTimeout(()=>{j()},1e3)}catch(P){console.error("Error updating vacation request:",P),n({title:"Fehler",description:"Antrag konnte nicht aktualisiert werden",variant:"destructive"})}},w=S=>{switch(S){case"pending":return s.jsxs(Qe,{className:"bg-yellow-500",children:[s.jsx(ig,{className:"h-3 w-3 mr-1"}),"Ausstehend"]});case"approved":return s.jsxs(Qe,{className:"bg-green-500",children:[s.jsx(Ts,{className:"h-3 w-3 mr-1"}),"Genehmigt"]});case"rejected":return s.jsxs(Qe,{className:"bg-red-500",children:[s.jsx(Nl,{className:"h-3 w-3 mr-1"}),"Abgelehnt"]});default:return s.jsx(Qe,{variant:"outline",children:S})}},N=S=>{switch(S){case"vacation":return"Urlaub";case"sick":return"Krankmeldung";case"personal":return"Persönlich";default:return S}};return c?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-muted-foreground",children:"Lade Urlaubsdaten..."})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-gray-600 bg-clip-text text-transparent flex items-center gap-3",children:[s.jsx(Lt,{className:"h-8 w-8 text-gray-600"}),"Urlaubsverwaltung"]}),s.jsx("p",{className:"text-muted-foreground",children:"Verwalten Sie Ihre Urlaubsanträge und Abwesenheiten"})]}),s.jsxs(ee,{onClick:()=>m(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Neuer Antrag"]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(an,{className:"h-5 w-5"}),"Mein Urlaubskonto"]})}),s.jsx(ce,{children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.total_days}),s.jsx("div",{className:"text-sm text-blue-700",children:"Gesamte Tage"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.available_days}),s.jsx("div",{className:"text-sm text-green-700",children:"Verfügbar"})]}),s.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.pending_days}),s.jsx("div",{className:"text-sm text-orange-700",children:"Ausstehend"})]}),s.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-600",children:i.used_days}),s.jsx("div",{className:"text-sm text-gray-700",children:"Verbraucht"})]})]})})]}),x&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ee,{variant:f==="my-requests"?"default":"outline",onClick:()=>p("my-requests"),children:"Meine Anträge"}),s.jsx(ee,{variant:f==="all-requests"?"default":"outline",onClick:()=>p("all-requests"),children:"Alle Anträge"})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(pr,{className:"h-5 w-5"}),f==="all-requests"?"Alle Urlaubsanträge":"Meine Urlaubsanträge"]})}),s.jsx(ce,{children:r.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Lt,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Keine Anträge"}),s.jsx("p",{className:"text-gray-500",children:f==="all-requests"?"Es sind keine Urlaubsanträge vorhanden":"Sie haben noch keine Urlaubsanträge gestellt"})]}):s.jsx("div",{className:"space-y-4",children:r.map(S=>s.jsxs("div",{className:"border rounded-lg p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h4",{className:"font-semibold",children:f==="all-requests"?S.employee_name:N(S.request_type)}),w(S.status)]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[new Date(S.start_date).toLocaleDateString("de-DE")," - "," ",new Date(S.end_date).toLocaleDateString("de-DE")," (",S.days_requested," ",S.days_requested===1?"Tag":"Tage",")"]})]}),s.jsx("div",{className:"text-xs text-gray-500",children:new Date(S.created_at).toLocaleDateString("de-DE")})]}),S.reason&&s.jsx("div",{className:"mb-3",children:s.jsx("p",{className:"text-sm text-gray-700",children:S.reason})}),x&&f==="all-requests"&&S.status==="pending"&&s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsxs(ee,{size:"sm",onClick:()=>b(S.id,!0),className:"bg-green-600 hover:bg-green-700",children:[s.jsx(Ts,{className:"h-4 w-4 mr-1"}),"Genehmigen"]}),s.jsxs(ee,{size:"sm",variant:"outline",onClick:C=>{C.preventDefault(),C.stopPropagation(),b(S.id,!1)},className:"border-red-600 text-red-600 hover:bg-red-50",children:[s.jsx(Nl,{className:"h-4 w-4 mr-1"}),"Ablehnen"]})]}),S.approved_at&&s.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[S.status==="approved"?"Genehmigt":"Abgelehnt"," am"," ",new Date(S.approved_at).toLocaleDateString("de-DE")]})]},S.id))})})]}),s.jsx(HI,{open:u,onOpenChange:m,onSuccess:j})]})}class yne{async createOrderFromQuote(e){try{console.log("🔄 Creating order from quote:",e);const{data:n,error:r}=await Z.from("quotes").select("*").eq("id",e).single();if(r||!n)throw new Error("Angebot nicht gefunden");const a={order_number:`AUF-${Date.now().toString().slice(-6)}`,customer_id:n.customer_id,title:n.title||"Auftrag aus Angebot",description:n.description,order_date:new Date().toISOString().split("T")[0],due_date:n.valid_until||null,status:"confirmed",priority:"medium",total_amount:n.total_amount,currency:n.currency||"EUR",notes:`Automatisch erstellt aus Angebot ${n.quote_number}`,workflow_origin_type:"quote",workflow_origin_id:e},{data:i,error:o}=await Z.from("orders").insert(a).select().single();if(o)throw o;return await Z.from("quotes").update({status:"accepted",workflow_target_type:"order",workflow_target_id:i.id}).eq("id",e),await this.createOrUpdateWorkflowChain({quoteId:e,orderId:i.id,currentStep:"order",customerId:n.customer_id,metadata:{title:n.title||"Neuer Workflow",totalAmount:n.total_amount,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}),Aa({title:"Auftrag erstellt",description:`Auftrag ${a.order_number} wurde erfolgreich aus dem Angebot erstellt.`}),i.id}catch(n){return console.error("❌ Error creating order from quote:",n),Aa({title:"Fehler",description:"Auftrag konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async createProjectFromOrder(e){try{console.log("🔄 Creating project from order:",e);const{data:n,error:r}=await Z.from("orders").select("*, customers(company_name)").eq("id",e).single();if(r||!n)throw new Error("Auftrag nicht gefunden");const{data:a}=await Z.auth.getUser();if(!(a!=null&&a.user))throw new Error("Benutzer nicht authentifiziert");const{data:i}=await Z.from("profiles").select("company_id").eq("id",a.user.id).single();if(!(i!=null&&i.company_id))throw new Error("Firma nicht gefunden");const o={name:n.title,customer_id:n.customer_id,company_id:i.company_id,status:"geplant",start_date:new Date().toISOString().split("T")[0],end_date:n.due_date||null,location:null,budget:n.total_amount||0,description:`Automatisch erstellt aus Auftrag ${n.order_number}. ${n.description||""}`,workflow_origin_type:"order",workflow_origin_id:e},{data:c,error:d}=await Z.from("projects").insert(o).select().single();if(d)throw d;await Z.from("orders").update({status:"in_progress",workflow_target_type:"project",workflow_target_id:c.id}).eq("id",e);const u=await this.getWorkflowChain(e,"order");return u&&await this.createOrUpdateWorkflowChain({...u,projectId:c.id,currentStep:"project"}),Aa({title:"Projekt erstellt",description:`Projekt "${n.title}" wurde erfolgreich aus dem Auftrag erstellt.`}),c.id}catch(n){return console.error("❌ Error creating project from order:",n),Aa({title:"Fehler",description:"Projekt konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async createInvoiceFromProject(e){try{console.log("🔄 Creating invoice from project:",e);const{data:n,error:r}=await Z.from("projects").select("*, customers(company_name, address)").eq("id",e).single();if(r||!n)throw new Error("Projekt nicht gefunden");if(n.status!=="abgeschlossen")throw new Error("Rechnung kann nur für abgeschlossene Projekte erstellt werden");const a={invoice_number:`RG-${Date.now().toString().slice(-6)}`,customer_id:n.customer_id,issue_date:new Date().toISOString().split("T")[0],due_date:new Date(Date.now()+14*24*60*60*1e3).toISOString().split("T")[0],status:"draft",total_amount:n.budget||0,currency:"EUR",description:`Rechnung für Projekt: ${n.name}`,notes:`Automatisch erstellt aus Projekt ${n.name}`,workflow_origin_type:"project",workflow_origin_id:e},{data:i,error:o}=await Z.from("invoices").insert(a).select().single();if(o)throw o;await Z.from("projects").update({workflow_target_type:"invoice",workflow_target_id:i.id}).eq("id",e);const c=await this.getWorkflowChain(e,"project");return c&&await this.createOrUpdateWorkflowChain({...c,invoiceId:i.id,currentStep:"invoice"}),Aa({title:"Rechnung erstellt",description:`Rechnungsentwurf ${a.invoice_number} wurde erfolgreich erstellt.`}),i.id}catch(n){return console.error("❌ Error creating invoice from project:",n),Aa({title:"Fehler",description:"Rechnung konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async checkBudgetWarnings(){try{const{data:e}=await Z.from("projects").select("*").in("status",["geplant","in_bearbeitung"]),n=[];for(const r of e||[])if(r.budget&&r.budget>0){const a=r.budget*.95,i=a/r.budget*100;i>=90&&n.push({projectId:r.id,projectName:r.name,budget:r.budget,usedBudget:a,usagePercentage:i,type:"budget_warning"})}return n}catch(e){return console.error("❌ Error checking budget warnings:",e),[]}}async createOrUpdateWorkflowChain(e){try{const n={quote_id:e.quoteId||null,order_id:e.orderId||null,project_id:e.projectId||null,invoice_id:e.invoiceId||null,current_step:e.currentStep,customer_id:e.customerId,metadata:e.metadata,updated_at:new Date().toISOString()},r=Z.from("workflow_chains").select("id");e.quoteId?r.eq("quote_id",e.quoteId):e.orderId?r.eq("order_id",e.orderId):e.projectId&&r.eq("project_id",e.projectId);const{data:a}=await r.single();a?await Z.from("workflow_chains").update(n).eq("id",a.id):await Z.from("workflow_chains").insert({...n,created_at:new Date().toISOString()})}catch(n){console.error("❌ Error managing workflow chain:",n)}}async getWorkflowChain(e,n){try{const r=`${n}_id`,{data:a}=await Z.from("workflow_chains").select("*").eq(r,e).single();return a?{quoteId:a.quote_id,orderId:a.order_id,projectId:a.project_id,invoiceId:a.invoice_id,currentStep:a.current_step,customerId:a.customer_id,metadata:a.metadata}:null}catch(r){return console.error("❌ Error getting workflow chain:",r),null}}async getDashboardCriticalData(){try{const[e,n,r,a]=await Promise.all([this.checkBudgetWarnings(),this.getPendingQuotes(),this.getDelayedProjects(),this.getOverdueInvoices()]);return{overdueTasks:[...e,...r],budgetWarnings:e,pendingQuotes:n,delayedProjects:r,overdueInvoices:a}}catch(e){return console.error("❌ Error getting dashboard critical data:",e),{overdueTasks:[],budgetWarnings:[],pendingQuotes:[],delayedProjects:[],overdueInvoices:[]}}}async getPendingQuotes(){const{data:e}=await Z.from("quotes").select("*, customers(company_name)").eq("status","pending").order("created_at",{ascending:!1});return e||[]}async getDelayedProjects(){const{data:e}=await Z.from("projects").select("*").in("status",["geplant","in_bearbeitung"]).lt("end_date",new Date().toISOString().split("T")[0]);return e||[]}async getOverdueInvoices(){const{data:e}=await Z.from("invoices").select("*, customers(company_name)").eq("status","sent").lt("due_date",new Date().toISOString().split("T")[0]);return e||[]}async applyScheduleWithApproval(e){var n;return await DT("aiScheduleApply",{reason:"KI-Planung soll auf den Kalender angewendet werden.",metadata:{projectId:e.projectId,employeeCount:((n=e.employeeAssignments)==null?void 0:n.length)||0},userId:e.userId},async()=>(console.log("Applying AI schedule:",e),e))}}const _ne=new yne,wne=({onNavigate:t})=>{const[e,n]=g.useState({criticalAlerts:{budgetWarnings:0,overdueProjects:0,overdueInvoices:0,pendingQuotes:0},financialKPIs:{monthlyRevenue:0,monthlyExpenses:0,profit:0,profitMargin:0,outstandingAmount:0,revenuetrend:0},projectStatus:{active:0,planning:0,completed:0,delayed:0},teamOverview:{activeEmployees:0,todayHours:0,utilizationRate:0}}),[r,a]=g.useState(!0),[i,o]=g.useState([]),{toast:c}=Mt();g.useEffect(()=>{d();const v=setInterval(d,5*60*1e3);return()=>clearInterval(v)},[]);const d=async()=>{try{a(!0);const[v,_,b,w]=await Promise.all([_ne.getDashboardCriticalData(),u(),m(),f()]);o(v.overdueTasks),n({criticalAlerts:{budgetWarnings:v.budgetWarnings.length,overdueProjects:v.delayedProjects.length,overdueInvoices:v.overdueInvoices.length,pendingQuotes:v.pendingQuotes.length},financialKPIs:b,projectStatus:_,teamOverview:w})}catch(v){console.error("❌ Error loading dashboard data:",v),c({title:"Fehler beim Laden",description:"Dashboard-Daten konnten nicht geladen werden.",variant:"destructive"})}finally{a(!1)}},u=async()=>{const{data:v}=await Z.from("projects").select("status, end_date"),_=new Date().toISOString().split("T")[0],b={active:0,planning:0,completed:0,delayed:0};return v==null||v.forEach(w=>{switch(w.status){case"in_bearbeitung":b.active++;break;case"geplant":case"anfrage":case"besichtigung":b.planning++;break;case"abgeschlossen":b.completed++;break}w.end_date&&w.end_date<_&&w.status!=="abgeschlossen"&&b.delayed++}),b},m=async()=>({monthlyRevenue:45e3,monthlyExpenses:32e3,profit:13e3,profitMargin:28.9,outstandingAmount:8500,revenuetrend:12.5}),f=async()=>{const{data:v}=await Z.from("employees").select("status").neq("status","eingeladen");return{activeEmployees:(v==null?void 0:v.length)||0,todayHours:67.5,utilizationRate:85}},p=[{id:"new-quote",title:"Neues Angebot",description:"Angebot für Kunden erstellen",icon:wn,color:"bg-blue-500",onClick:()=>t==null?void 0:t("finance")},{id:"new-project",title:"Projekt anlegen",description:"Direktes Projekt erstellen",icon:la,color:"bg-green-500",onClick:()=>t==null?void 0:t("projects")},{id:"check-finances",title:"Finanzen prüfen",description:"Rechnungen und Ausgaben",icon:lr,color:"bg-purple-500",onClick:()=>t==null?void 0:t("finance")},{id:"team-overview",title:"Team Status",description:"Mitarbeiter und Zeiten",icon:bi,color:"bg-orange-500",onClick:()=>t==null?void 0:t("personal")}],x=v=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(v),j=()=>Object.values(e.criticalAlerts).reduce((v,_)=>v+_,0);return r?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"space-y-6 animate-fadeIn p-6 bg-gray-50 min-h-screen",children:[s.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),s.jsx("p",{className:"text-gray-600",children:"Zentrale Übersicht Ihres Handwerksbetriebs"})]}),j()>0&&s.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-red-50 border border-red-100 rounded-xl",children:[s.jsx(us,{className:"h-5 w-5 text-red-500"}),s.jsxs("span",{className:"text-red-700 font-medium",children:[j()," Punkte benötigen Aufmerksamkeit"]})]})]})}),s.jsxs(pI,{children:[s.jsx(mo,{title:"Offene Aufträge",value:e.projectStatus.active+e.projectStatus.planning,valueClassName:"text-blue-600"}),s.jsx(mo,{title:"Monatsumsatz",value:x(e.financialKPIs.monthlyRevenue),valueClassName:"text-green-600"}),s.jsx(mo,{title:"Offene Angebote",value:e.criticalAlerts.pendingQuotes,valueClassName:"text-orange-600"}),s.jsx(mo,{title:"Mitarbeiter",value:e.teamOverview.activeEmployees,valueClassName:"text-purple-600"})]}),s.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[s.jsxs("div",{className:"col-span-8 space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[s.jsx("div",{className:"p-6 border-b border-gray-100",children:s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Finanzübersicht"})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Umsatz"}),s.jsx("div",{className:"text-2xl font-bold text-green-600",children:x(e.financialKPIs.monthlyRevenue)})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Gewinn"}),s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x(e.financialKPIs.profit)})]})]}),s.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-700",children:"Gewinnmarge"}),s.jsxs("span",{className:"font-semibold text-gray-900",children:[e.financialKPIs.profitMargin,"%"]})]})})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[s.jsx("div",{className:"p-6 border-b border-gray-100",children:s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Schnellaktionen"})}),s.jsx("div",{className:"p-6",children:s.jsx("div",{className:"grid grid-cols-2 gap-4",children:p.map(v=>s.jsxs("button",{onClick:v.onClick,className:"flex items-center gap-4 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors text-left",children:[s.jsx("div",{className:`p-3 rounded-lg ${v.color}`,children:s.jsx(v.icon,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:v.title}),s.jsx("div",{className:"text-sm text-gray-500",children:v.description})]})]},v.id))})})]})]}),s.jsxs("div",{className:"col-span-4 space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Projektstatus"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Anfrage"})]}),s.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.planning})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"In Bearbeitung"})]}),s.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.active})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Abgeschlossen"})]}),s.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.completed})]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Team Übersicht"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-700",children:"Aktive Mitarbeiter"}),s.jsx("span",{className:"font-medium",children:e.teamOverview.activeEmployees})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-700",children:"Stunden heute"}),s.jsxs("span",{className:"font-medium",children:[e.teamOverview.todayHours,"h"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-700",children:"Auslastung"}),s.jsxs("span",{className:"font-medium",children:[e.teamOverview.utilizationRate,"%"]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Heute"}),s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-gray-500",children:"Keine Termine für heute"})})]})]})]}),s.jsxs(Is,{defaultValue:"kpis",className:"w-full hidden",children:[s.jsxs(js,{className:"grid w-full grid-cols-5",children:[s.jsx(Je,{value:"kpis",children:"Kennzahlen"}),s.jsx(Je,{value:"overview",children:"Übersicht"}),s.jsx(Je,{value:"financial",children:"Finanzen"}),s.jsx(Je,{value:"projects",children:"Projekte"}),s.jsx(Je,{value:"actions",children:"Schnellaktionen"})]}),s.jsxs(et,{value:"kpis",className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"📊 Aktuelle Kennzahlen"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[s.jsx(oe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("projects"),children:s.jsxs(ce,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(e0,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium",children:"Offene Aufträge"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active+e.projectStatus.planning}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"in Bearbeitung"})]})}),s.jsx(oe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("emails"),children:s.jsxs(ce,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(es,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"font-medium",children:"Ungelesene E-Mails"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:"0"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"neue Anfragen"})]})}),s.jsx(oe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("finance"),children:s.jsxs(ce,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(wn,{className:"w-5 h-5 text-orange-600"}),s.jsx("span",{className:"font-medium",children:"Offene Angebote"})]}),s.jsx("p",{className:"text-2xl font-bold text-orange-600",children:e.criticalAlerts.pendingQuotes}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"versendet"})]})}),s.jsx(oe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("finance"),children:s.jsxs(ce,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(lr,{className:"w-5 h-5 text-red-600"}),s.jsx("span",{className:"font-medium",children:"Offene Rechnungen"})]}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:e.criticalAlerts.overdueInvoices}),s.jsx("p",{className:"text-sm text-muted-foreground",children:x(e.financialKPIs.outstandingAmount)})]})}),s.jsx(oe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("timetracking"),children:s.jsxs(ce,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(an,{className:"w-5 h-5 text-purple-600"}),s.jsx("span",{className:"font-medium",children:"Stunden heute"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:e.teamOverview.todayHours}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"gearbeitet"})]})})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"📅 Heute / Nächste Termine"}),s.jsx(oe,{children:s.jsx(ce,{className:"p-4",children:s.jsx("p",{className:"text-muted-foreground",children:"Keine Termine für heute"})})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-3",children:"👥 Mitarbeiterübersicht"}),s.jsx(oe,{children:s.jsx(ce,{className:"p-3",children:s.jsx("div",{className:"space-y-2",children:e.teamOverview.activeEmployees>0?s.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/30 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500"}),s.jsxs("span",{className:"font-medium text-sm",children:[e.teamOverview.activeEmployees," Mitarbeiter"]})]}),s.jsx(ee,{variant:"outline",size:"sm",onClick:()=>t==null?void 0:t("timetracking"),children:"Zeitbericht"})]}):s.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine aktiven Mitarbeiter"})})})})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-3",children:"📨 Letzte E-Mails / Kundenanfragen"}),s.jsx(oe,{children:s.jsx(ce,{className:"p-3",children:s.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine neuen E-Mails"})})})]})]})]}),s.jsxs(et,{value:"overview",className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx(oe,{children:s.jsx(ce,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Monatsumsatz"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:x(e.financialKPIs.monthlyRevenue)})]}),s.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[s.jsx(Eo,{className:"h-4 w-4"}),s.jsxs("span",{className:"text-sm font-medium",children:["+",e.financialKPIs.revenuetrend,"%"]})]})]})})}),s.jsx(oe,{children:s.jsx(ce,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Gewinn"}),s.jsx("p",{className:"text-2xl font-bold",children:x(e.financialKPIs.profit)})]}),s.jsxs(Qe,{className:"bg-blue-100 text-blue-800",children:[e.financialKPIs.profitMargin,"%"]})]})})}),s.jsx(oe,{children:s.jsx(ce,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Aktive Projekte"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active})]}),s.jsx(la,{className:"h-8 w-8 text-blue-600"})]})})}),s.jsx(oe,{children:s.jsxs(ce,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Team Auslastung"}),s.jsxs("p",{className:"text-2xl font-bold",children:[e.teamOverview.utilizationRate,"%"]})]}),s.jsx(bi,{className:"h-8 w-8 text-purple-600"})]}),s.jsx(Pd,{value:e.teamOverview.utilizationRate,className:"mt-2"})]})})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Projekt-Pipeline"})}),s.jsx(ce,{children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:e.projectStatus.planning}),s.jsx("div",{className:"text-sm text-yellow-700",children:"In Planung"})]}),s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active}),s.jsx("div",{className:"text-sm text-blue-700",children:"In Bearbeitung"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.projectStatus.completed}),s.jsx("div",{className:"text-sm text-green-700",children:"Abgeschlossen"})]}),s.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.projectStatus.delayed}),s.jsx("div",{className:"text-sm text-red-700",children:"Verspätet"})]})]})})]})]}),s.jsx(et,{value:"financial",className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Finanzielle Kennzahlen"})}),s.jsxs(ce,{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Umsatz"}),s.jsx("span",{className:"font-bold text-green-600",children:x(e.financialKPIs.monthlyRevenue)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Ausgaben"}),s.jsx("span",{className:"font-bold text-red-600",children:x(e.financialKPIs.monthlyExpenses)})]}),s.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[s.jsx("span",{className:"font-semibold",children:"Gewinn"}),s.jsx("span",{className:"font-bold text-lg",children:x(e.financialKPIs.profit)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Gewinnmarge"}),s.jsxs("span",{className:"font-bold",children:[e.financialKPIs.profitMargin,"%"]})]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Ausstehende Beträge"})}),s.jsxs(ce,{children:[s.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:x(e.financialKPIs.outstandingAmount)}),s.jsx("p",{className:"text-sm text-gray-600",children:"Noch nicht bezahlte Rechnungen"}),s.jsxs(ee,{variant:"outline",className:"mt-4 w-full",onClick:()=>t==null?void 0:t("finance"),children:[s.jsx(lr,{className:"h-4 w-4 mr-2"}),"Rechnungen verwalten"]})]})]})]})}),s.jsx(et,{value:"projects",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsx(Ce,{children:"Projekt-Status Details"})}),s.jsx(ce,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),s.jsx("span",{children:"Projekte in Planung"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-bold",children:e.projectStatus.planning}),s.jsx(ee,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:s.jsx(sa,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),s.jsx("span",{children:"Aktive Projekte"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-bold",children:e.projectStatus.active}),s.jsx(ee,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:s.jsx(sa,{className:"h-4 w-4"})})]})]}),e.projectStatus.delayed>0&&s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-red-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(us,{className:"h-5 w-5 text-red-600"}),s.jsx("span",{className:"text-red-700",children:"Verspätete Projekte"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-bold text-red-600",children:e.projectStatus.delayed}),s.jsx(ee,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:s.jsx(sa,{className:"h-4 w-4"})})]})]})]})})]})}),s.jsx(et,{value:"actions",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsx(Ne,{children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx(vB,{className:"h-5 w-5 text-yellow-500"}),"Schnellaktionen"]})}),s.jsx(ce,{children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map(v=>s.jsxs(ee,{variant:"outline",className:"h-auto p-4 justify-start",onClick:v.onClick,children:[s.jsx("div",{className:`p-2 rounded-lg ${v.color} mr-4`,children:s.jsx(v.icon,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-semibold",children:v.title}),s.jsx("div",{className:"text-sm text-gray-500",children:v.description})]}),s.jsx(Kb,{className:"h-4 w-4 ml-auto"})]},v.id))})})]})})]})]})};var Hw=["Enter"," "],bne=["ArrowDown","PageUp","Home"],VI=["ArrowUp","PageDown","End"],jne=[...bne,...VI],Nne={ltr:[...Hw,"ArrowRight"],rtl:[...Hw,"ArrowLeft"]},Sne={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Ff="Menu",[sf,kne,Cne]=pf(Ff),[Xl,KI]=wr(Ff,[Cne,zo,Sg]),Jg=zo(),ZI=Sg(),[Ene,Jl]=Xl(Ff),[Ane,Bf]=Xl(Ff),GI=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:a,onOpenChange:i,modal:o=!0}=t,c=Jg(e),[d,u]=g.useState(null),m=g.useRef(!1),f=_n(i),p=Gd(a);return g.useEffect(()=>{const x=()=>{m.current=!0,document.addEventListener("pointerdown",j,{capture:!0,once:!0}),document.addEventListener("pointermove",j,{capture:!0,once:!0})},j=()=>m.current=!1;return document.addEventListener("keydown",x,{capture:!0}),()=>{document.removeEventListener("keydown",x,{capture:!0}),document.removeEventListener("pointerdown",j,{capture:!0}),document.removeEventListener("pointermove",j,{capture:!0})}},[]),s.jsx(cj,{...c,children:s.jsx(Ene,{scope:e,open:n,onOpenChange:f,content:d,onContentChange:u,children:s.jsx(Ane,{scope:e,onClose:g.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:m,dir:p,modal:o,children:r})})})};GI.displayName=Ff;var Pne="MenuAnchor",R1=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,a=Jg(n);return s.jsx(wf,{...a,...r,ref:e})});R1.displayName=Pne;var I1="MenuPortal",[Dne,QI]=Xl(I1,{forceMount:void 0}),YI=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:a}=t,i=Jl(I1,e);return s.jsx(Dne,{scope:e,forceMount:n,children:s.jsx(Gn,{present:n||i.open,children:s.jsx(Od,{asChild:!0,container:a,children:r})})})};YI.displayName=I1;var Rr="MenuContent",[Tne,O1]=Xl(Rr),XI=g.forwardRef((t,e)=>{const n=QI(Rr,t.__scopeMenu),{forceMount:r=n.forceMount,...a}=t,i=Jl(Rr,t.__scopeMenu),o=Bf(Rr,t.__scopeMenu);return s.jsx(sf.Provider,{scope:t.__scopeMenu,children:s.jsx(Gn,{present:r||i.open,children:s.jsx(sf.Slot,{scope:t.__scopeMenu,children:o.modal?s.jsx(Mne,{...a,ref:e}):s.jsx(Rne,{...a,ref:e})})})})}),Mne=g.forwardRef((t,e)=>{const n=Jl(Rr,t.__scopeMenu),r=g.useRef(null),a=Tt(e,r);return g.useEffect(()=>{const i=r.current;if(i)return zg(i)},[]),s.jsx(L1,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Re(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Rne=g.forwardRef((t,e)=>{const n=Jl(Rr,t.__scopeMenu);return s.jsx(L1,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),L1=g.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:c,onEntryFocus:d,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:f,onInteractOutside:p,onDismiss:x,disableOutsideScroll:j,...v}=t,_=Jl(Rr,n),b=Bf(Rr,n),w=Jg(n),N=ZI(n),S=kne(n),[C,A]=g.useState(null),P=g.useRef(null),M=Tt(e,P,_.onContentChange),z=g.useRef(0),R=g.useRef(""),D=g.useRef(0),B=g.useRef(null),W=g.useRef("right"),X=g.useRef(0),ue=j?Df:g.Fragment,de=j?{as:wi,allowPinchZoom:!0}:void 0,G=V=>{var q,ne;const $=R.current+V,F=S().filter(pe=>!pe.disabled),O=document.activeElement,K=(q=F.find(pe=>pe.ref.current===O))==null?void 0:q.textValue,U=F.map(pe=>pe.textValue),te=Vne(U,$,K),J=(ne=F.find(pe=>pe.textValue===te))==null?void 0:ne.ref.current;(function pe(Q){R.current=Q,window.clearTimeout(z.current),Q!==""&&(z.current=window.setTimeout(()=>pe(""),1e3))})($),J&&setTimeout(()=>J.focus())};g.useEffect(()=>()=>window.clearTimeout(z.current),[]),Fg();const I=g.useCallback(V=>{var F,O;return W.current===((F=B.current)==null?void 0:F.side)&&Zne(V,(O=B.current)==null?void 0:O.area)},[]);return s.jsx(Tne,{scope:n,searchRef:R,onItemEnter:g.useCallback(V=>{I(V)&&V.preventDefault()},[I]),onItemLeave:g.useCallback(V=>{var $;I(V)||(($=P.current)==null||$.focus(),A(null))},[I]),onTriggerLeave:g.useCallback(V=>{I(V)&&V.preventDefault()},[I]),pointerGraceTimerRef:D,onPointerGraceIntentChange:g.useCallback(V=>{B.current=V},[]),children:s.jsx(ue,{...de,children:s.jsx(Pf,{asChild:!0,trapped:a,onMountAutoFocus:Re(i,V=>{var $;V.preventDefault(),($=P.current)==null||$.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:s.jsx(Hl,{asChild:!0,disableOutsidePointerEvents:c,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:f,onInteractOutside:p,onDismiss:x,children:s.jsx(JD,{asChild:!0,...N,dir:b.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:A,onEntryFocus:Re(d,V=>{b.isUsingKeyboardRef.current||V.preventDefault()}),preventScrollOnEntryFocus:!0,children:s.jsx(ug,{role:"menu","aria-orientation":"vertical","data-state":mO(_.open),"data-radix-menu-content":"",dir:b.dir,...w,...v,ref:M,style:{outline:"none",...v.style},onKeyDown:Re(v.onKeyDown,V=>{const F=V.target.closest("[data-radix-menu-content]")===V.currentTarget,O=V.ctrlKey||V.altKey||V.metaKey,K=V.key.length===1;F&&(V.key==="Tab"&&V.preventDefault(),!O&&K&&G(V.key));const U=P.current;if(V.target!==U||!jne.includes(V.key))return;V.preventDefault();const J=S().filter(q=>!q.disabled).map(q=>q.ref.current);VI.includes(V.key)&&J.reverse(),Wne(J)}),onBlur:Re(t.onBlur,V=>{V.currentTarget.contains(V.target)||(window.clearTimeout(z.current),R.current="")}),onPointerMove:Re(t.onPointerMove,rf(V=>{const $=V.target,F=X.current!==V.clientX;if(V.currentTarget.contains($)&&F){const O=V.clientX>X.current?"right":"left";W.current=O,X.current=V.clientX}}))})})})})})})});XI.displayName=Rr;var Ine="MenuGroup",F1=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return s.jsx(nt.div,{role:"group",...r,ref:e})});F1.displayName=Ine;var One="MenuLabel",JI=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return s.jsx(nt.div,{...r,ref:e})});JI.displayName=One;var I0="MenuItem",XC="menu.itemSelect",ex=g.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...a}=t,i=g.useRef(null),o=Bf(I0,t.__scopeMenu),c=O1(I0,t.__scopeMenu),d=Tt(e,i),u=g.useRef(!1),m=()=>{const f=i.current;if(!n&&f){const p=new CustomEvent(XC,{bubbles:!0,cancelable:!0});f.addEventListener(XC,x=>r==null?void 0:r(x),{once:!0}),qb(f,p),p.defaultPrevented?u.current=!1:o.onClose()}};return s.jsx(eO,{...a,ref:d,disabled:n,onClick:Re(t.onClick,m),onPointerDown:f=>{var p;(p=t.onPointerDown)==null||p.call(t,f),u.current=!0},onPointerUp:Re(t.onPointerUp,f=>{var p;u.current||(p=f.currentTarget)==null||p.click()}),onKeyDown:Re(t.onKeyDown,f=>{const p=c.searchRef.current!=="";n||p&&f.key===" "||Hw.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});ex.displayName=I0;var eO=g.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...i}=t,o=O1(I0,n),c=ZI(n),d=g.useRef(null),u=Tt(e,d),[m,f]=g.useState(!1),[p,x]=g.useState("");return g.useEffect(()=>{const j=d.current;j&&x((j.textContent??"").trim())},[i.children]),s.jsx(sf.ItemSlot,{scope:n,disabled:r,textValue:a??p,children:s.jsx(eT,{asChild:!0,...c,focusable:!r,children:s.jsx(nt.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:u,onPointerMove:Re(t.onPointerMove,rf(j=>{r?o.onItemLeave(j):(o.onItemEnter(j),j.defaultPrevented||j.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Re(t.onPointerLeave,rf(j=>o.onItemLeave(j))),onFocus:Re(t.onFocus,()=>f(!0)),onBlur:Re(t.onBlur,()=>f(!1))})})})}),Lne="MenuCheckboxItem",tO=g.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...a}=t;return s.jsx(iO,{scope:t.__scopeMenu,checked:n,children:s.jsx(ex,{role:"menuitemcheckbox","aria-checked":O0(n)?"mixed":n,...a,ref:e,"data-state":z1(n),onSelect:Re(a.onSelect,()=>r==null?void 0:r(O0(n)?!0:!n),{checkForDefaultPrevented:!1})})})});tO.displayName=Lne;var nO="MenuRadioGroup",[Fne,Bne]=Xl(nO,{value:void 0,onValueChange:()=>{}}),sO=g.forwardRef((t,e)=>{const{value:n,onValueChange:r,...a}=t,i=_n(r);return s.jsx(Fne,{scope:t.__scopeMenu,value:n,onValueChange:i,children:s.jsx(F1,{...a,ref:e})})});sO.displayName=nO;var rO="MenuRadioItem",aO=g.forwardRef((t,e)=>{const{value:n,...r}=t,a=Bne(rO,t.__scopeMenu),i=n===a.value;return s.jsx(iO,{scope:t.__scopeMenu,checked:i,children:s.jsx(ex,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":z1(i),onSelect:Re(r.onSelect,()=>{var o;return(o=a.onValueChange)==null?void 0:o.call(a,n)},{checkForDefaultPrevented:!1})})})});aO.displayName=rO;var B1="MenuItemIndicator",[iO,zne]=Xl(B1,{checked:!1}),oO=g.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...a}=t,i=zne(B1,n);return s.jsx(Gn,{present:r||O0(i.checked)||i.checked===!0,children:s.jsx(nt.span,{...a,ref:e,"data-state":z1(i.checked)})})});oO.displayName=B1;var $ne="MenuSeparator",lO=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return s.jsx(nt.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});lO.displayName=$ne;var Une="MenuArrow",cO=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,a=Jg(n);return s.jsx(hg,{...a,...r,ref:e})});cO.displayName=Une;var qne="MenuSub",[Nae,dO]=Xl(qne),Vu="MenuSubTrigger",uO=g.forwardRef((t,e)=>{const n=Jl(Vu,t.__scopeMenu),r=Bf(Vu,t.__scopeMenu),a=dO(Vu,t.__scopeMenu),i=O1(Vu,t.__scopeMenu),o=g.useRef(null),{pointerGraceTimerRef:c,onPointerGraceIntentChange:d}=i,u={__scopeMenu:t.__scopeMenu},m=g.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return g.useEffect(()=>m,[m]),g.useEffect(()=>{const f=c.current;return()=>{window.clearTimeout(f),d(null)}},[c,d]),s.jsx(R1,{asChild:!0,...u,children:s.jsx(eO,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":mO(n.open),...t,ref:ng(e,a.onTriggerChange),onClick:f=>{var p;(p=t.onClick)==null||p.call(t,f),!(t.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Re(t.onPointerMove,rf(f=>{i.onItemEnter(f),!f.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),m()},100))})),onPointerLeave:Re(t.onPointerLeave,rf(f=>{var x,j;m();const p=(x=n.content)==null?void 0:x.getBoundingClientRect();if(p){const v=(j=n.content)==null?void 0:j.dataset.side,_=v==="right",b=_?-5:5,w=p[_?"left":"right"],N=p[_?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+b,y:f.clientY},{x:w,y:p.top},{x:N,y:p.top},{x:N,y:p.bottom},{x:w,y:p.bottom}],side:v}),window.clearTimeout(c.current),c.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Re(t.onKeyDown,f=>{var x;const p=i.searchRef.current!=="";t.disabled||p&&f.key===" "||Nne[r.dir].includes(f.key)&&(n.onOpenChange(!0),(x=n.content)==null||x.focus(),f.preventDefault())})})})});uO.displayName=Vu;var hO="MenuSubContent",fO=g.forwardRef((t,e)=>{const n=QI(Rr,t.__scopeMenu),{forceMount:r=n.forceMount,...a}=t,i=Jl(Rr,t.__scopeMenu),o=Bf(Rr,t.__scopeMenu),c=dO(hO,t.__scopeMenu),d=g.useRef(null),u=Tt(e,d);return s.jsx(sf.Provider,{scope:t.__scopeMenu,children:s.jsx(Gn,{present:r||i.open,children:s.jsx(sf.Slot,{scope:t.__scopeMenu,children:s.jsx(L1,{id:c.contentId,"aria-labelledby":c.triggerId,...a,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{var f;o.isUsingKeyboardRef.current&&((f=d.current)==null||f.focus()),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:Re(t.onFocusOutside,m=>{m.target!==c.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Re(t.onEscapeKeyDown,m=>{o.onClose(),m.preventDefault()}),onKeyDown:Re(t.onKeyDown,m=>{var x;const f=m.currentTarget.contains(m.target),p=Sne[o.dir].includes(m.key);f&&p&&(i.onOpenChange(!1),(x=c.trigger)==null||x.focus(),m.preventDefault())})})})})})});fO.displayName=hO;function mO(t){return t?"open":"closed"}function O0(t){return t==="indeterminate"}function z1(t){return O0(t)?"indeterminate":t?"checked":"unchecked"}function Wne(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function Hne(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function Vne(t,e,n){const a=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=Hne(t,Math.max(i,0));a.length===1&&(o=o.filter(u=>u!==n));const d=o.find(u=>u.toLowerCase().startsWith(a.toLowerCase()));return d!==n?d:void 0}function Kne(t,e){const{x:n,y:r}=t;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const c=e[i].x,d=e[i].y,u=e[o].x,m=e[o].y;d>r!=m>r&&n<(u-c)*(r-d)/(m-d)+c&&(a=!a)}return a}function Zne(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return Kne(n,e)}function rf(t){return e=>e.pointerType==="mouse"?t(e):void 0}var Gne=GI,Qne=R1,Yne=YI,Xne=XI,Jne=F1,ese=JI,tse=ex,nse=tO,sse=sO,rse=aO,ase=oO,ise=lO,ose=cO,lse=uO,cse=fO,$1="DropdownMenu",[dse,Sae]=wr($1,[KI]),Bs=KI(),[use,pO]=dse($1),gO=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:a,defaultOpen:i,onOpenChange:o,modal:c=!0}=t,d=Bs(e),u=g.useRef(null),[m=!1,f]=Lr({prop:a,defaultProp:i,onChange:o});return s.jsx(use,{scope:e,triggerId:dr(),triggerRef:u,contentId:dr(),open:m,onOpenChange:f,onOpenToggle:g.useCallback(()=>f(p=>!p),[f]),modal:c,children:s.jsx(Gne,{...d,open:m,onOpenChange:f,dir:r,modal:c,children:n})})};gO.displayName=$1;var xO="DropdownMenuTrigger",vO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=t,i=pO(xO,n),o=Bs(n);return s.jsx(Qne,{asChild:!0,...o,children:s.jsx(nt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:ng(e,i.triggerRef),onPointerDown:Re(t.onPointerDown,c=>{!r&&c.button===0&&c.ctrlKey===!1&&(i.onOpenToggle(),i.open||c.preventDefault())}),onKeyDown:Re(t.onKeyDown,c=>{r||(["Enter"," "].includes(c.key)&&i.onOpenToggle(),c.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(c.key)&&c.preventDefault())})})})});vO.displayName=xO;var hse="DropdownMenuPortal",yO=t=>{const{__scopeDropdownMenu:e,...n}=t,r=Bs(e);return s.jsx(Yne,{...r,...n})};yO.displayName=hse;var _O="DropdownMenuContent",wO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=pO(_O,n),i=Bs(n),o=g.useRef(!1);return s.jsx(Xne,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...r,ref:e,onCloseAutoFocus:Re(t.onCloseAutoFocus,c=>{var d;o.current||(d=a.triggerRef.current)==null||d.focus(),o.current=!1,c.preventDefault()}),onInteractOutside:Re(t.onInteractOutside,c=>{const d=c.detail.originalEvent,u=d.button===0&&d.ctrlKey===!0,m=d.button===2||u;(!a.modal||m)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});wO.displayName=_O;var fse="DropdownMenuGroup",mse=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Bs(n);return s.jsx(Jne,{...a,...r,ref:e})});mse.displayName=fse;var pse="DropdownMenuLabel",bO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Bs(n);return s.jsx(ese,{...a,...r,ref:e})});bO.displayName=pse;var gse="DropdownMenuItem",jO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Bs(n);return s.jsx(tse,{...a,...r,ref:e})});jO.displayName=gse;var xse="DropdownMenuCheckboxItem",NO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Bs(n);return s.jsx(nse,{...a,...r,ref:e})});NO.displayName=xse;var vse="DropdownMenuRadioGroup",yse=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Bs(n);return s.jsx(sse,{...a,...r,ref:e})});yse.displayName=vse;var _se="DropdownMenuRadioItem",SO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Bs(n);return s.jsx(rse,{...a,...r,ref:e})});SO.displayName=_se;var wse="DropdownMenuItemIndicator",kO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Bs(n);return s.jsx(ase,{...a,...r,ref:e})});kO.displayName=wse;var bse="DropdownMenuSeparator",CO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Bs(n);return s.jsx(ise,{...a,...r,ref:e})});CO.displayName=bse;var jse="DropdownMenuArrow",Nse=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Bs(n);return s.jsx(ose,{...a,...r,ref:e})});Nse.displayName=jse;var Sse="DropdownMenuSubTrigger",EO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Bs(n);return s.jsx(lse,{...a,...r,ref:e})});EO.displayName=Sse;var kse="DropdownMenuSubContent",AO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=Bs(n);return s.jsx(cse,{...a,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});AO.displayName=kse;var Cse=gO,Ese=vO,Ase=yO,PO=wO,DO=bO,TO=jO,MO=NO,RO=SO,IO=kO,OO=CO,LO=EO,FO=AO;const Pse=Cse,Dse=Ese,Tse=g.forwardRef(({className:t,inset:e,children:n,...r},a)=>s.jsxs(LO,{ref:a,className:Te("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",t),...r,children:[n,s.jsx(jl,{className:"ml-auto h-4 w-4"})]}));Tse.displayName=LO.displayName;const Mse=g.forwardRef(({className:t,...e},n)=>s.jsx(FO,{ref:n,className:Te("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));Mse.displayName=FO.displayName;const BO=g.forwardRef(({className:t,sideOffset:e=4,...n},r)=>s.jsx(Ase,{children:s.jsx(PO,{ref:r,sideOffset:e,className:Te("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));BO.displayName=PO.displayName;const Ap=g.forwardRef(({className:t,inset:e,...n},r)=>s.jsx(TO,{ref:r,className:Te("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",t),...n}));Ap.displayName=TO.displayName;const Rse=g.forwardRef(({className:t,children:e,checked:n,...r},a)=>s.jsxs(MO,{ref:a,className:Te("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(IO,{children:s.jsx(xf,{className:"h-4 w-4"})})}),e]}));Rse.displayName=MO.displayName;const Ise=g.forwardRef(({className:t,children:e,...n},r)=>s.jsxs(RO,{ref:r,className:Te("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(IO,{children:s.jsx(JF,{className:"h-2 w-2 fill-current"})})}),e]}));Ise.displayName=RO.displayName;const Ose=g.forwardRef(({className:t,inset:e,...n},r)=>s.jsx(DO,{ref:r,className:Te("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));Ose.displayName=DO.displayName;const Lse=g.forwardRef(({className:t,...e},n)=>s.jsx(OO,{ref:n,className:Te("-mx-1 my-1 h-px bg-muted",t),...e}));Lse.displayName=OO.displayName;function Fse(){const{theme:t,setTheme:e,actualTheme:n}=ej();return s.jsxs(Pse,{children:[s.jsx(Dse,{asChild:!0,children:s.jsxs(ee,{variant:"outline",size:"sm",className:"relative border-border/40 bg-background/80 backdrop-blur-sm hover:bg-accent/80 transition-all duration-200",children:[s.jsx(I_,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),s.jsx(T_,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),s.jsx("span",{className:"sr-only",children:"Theme wechseln"})]})}),s.jsxs(BO,{align:"end",className:"w-48 bg-background/95 backdrop-blur-sm border-border/40 shadow-lg",children:[s.jsxs(Ap,{onClick:()=>e("light"),className:`flex items-center gap-2 cursor-pointer ${t==="light"?"bg-accent text-accent-foreground":""}`,children:[s.jsx(I_,{className:"h-4 w-4"}),s.jsx("span",{children:"Hell"}),t==="light"&&s.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),s.jsxs(Ap,{onClick:()=>e("dark"),className:`flex items-center gap-2 cursor-pointer ${t==="dark"?"bg-accent text-accent-foreground":""}`,children:[s.jsx(T_,{className:"h-4 w-4"}),s.jsx("span",{children:"Dunkel"}),t==="dark"&&s.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),s.jsxs(Ap,{onClick:()=>e("system"),className:`flex items-center gap-2 cursor-pointer ${t==="system"?"bg-accent text-accent-foreground":""}`,children:[s.jsx(dB,{className:"h-4 w-4"}),s.jsx("span",{children:"System"}),t==="system"&&s.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]})]})]})}function Bse(){const{actualTheme:t,setTheme:e}=ej(),n=()=>{e(t==="light"?"dark":"light")};return s.jsxs(ee,{variant:"ghost",size:"sm",onClick:n,className:"relative h-9 w-9 p-0 rounded-full hover:bg-accent/80 transition-all duration-300 ease-out",children:[s.jsxs("div",{className:"relative h-4 w-4",children:[s.jsx(I_,{className:"absolute h-4 w-4 rotate-0 scale-100 transition-all duration-300 dark:-rotate-90 dark:scale-0"}),s.jsx(T_,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all duration-300 dark:rotate-0 dark:scale-100"})]}),s.jsx("span",{className:"sr-only",children:"Theme wechseln"})]})}const zse=()=>{var u;const{user:t,userRole:e,loading:n,signOut:r}=Fr(),a=Za(),[i,o]=g.useState("dashboard"),c=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768;if(g.useEffect(()=>{n||(t?e==="employee"?a("/employee"):e==="manager"&&c()&&Aa({title:"Mobile Gerät erkannt",description:"Für die beste Erfahrung verwenden Sie die Employee-App"}):a("/login"))},[t,e,n]),n)return s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!t||e==="employee"||e!=="manager")return null;const d=()=>{switch(i){case"customers":return s.jsx(LQ,{});case"projects":return s.jsx(Jee,{});case"personal":return s.jsx(fte,{});case"materials":return s.jsx(gte,{});case"machines":return s.jsx(bte,{});case"emails":return s.jsx(xne,{});case"documents":return s.jsx(ene,{});case"invoice-validation":return s.jsx(tne,{});case"finance":return s.jsx(jte,{});case"planner":return s.jsx(Cte,{});case"timetracking":return s.jsx(Hte,{});case"vacation":return s.jsx(vne,{});case"company-settings":return s.jsx(nne,{});default:return s.jsx(wne,{onNavigate:o})}};return s.jsxs("div",{className:"min-h-screen w-full bg-gray-50",children:[s.jsx(Qq,{activeModule:i,onModuleChange:o}),s.jsxs("div",{className:"ml-16 lg:ml-16 flex flex-col min-h-screen",children:[s.jsx("header",{className:"h-20 border-b border-white/20 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl sticky top-0 z-30 shadow-lg shadow-blue-500/10",children:s.jsxs("div",{className:"flex items-center justify-between h-full px-8",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:"/handwerkos-logo.svg",alt:"HandwerkOS Logo",className:"h-10 w-10 object-contain"}),s.jsx("h1",{className:"font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent text-3xl",children:"HandwerkOS"})]}),s.jsx(Qe,{variant:"secondary",className:"hidden sm:inline-flex bg-gradient-to-r from-blue-100 to-indigo-100 text-blue-700 border-0 shadow-sm",children:"Manager Dashboard"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(Fse,{}),s.jsxs(ee,{variant:"outline",size:"sm",onClick:()=>a("/employee"),className:"hidden sm:flex bg-white/50 hover:bg-white/80 border-white/30 backdrop-blur-sm shadow-lg transition-all duration-200 hover:scale-105",children:[s.jsx(yf,{className:"w-4 h-4 mr-2"}),"Mitarbeiter-Ansicht"]}),s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-slate-600 dark:text-slate-300 bg-white/30 dark:bg-slate-800/30 px-3 py-2 rounded-full backdrop-blur-sm",children:[s.jsx(pr,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline font-medium",children:((u=t==null?void 0:t.email)==null?void 0:u.split("@")[0])||"Admin"})]})]})]})}),s.jsx("main",{className:"flex-1 overflow-auto",children:d()})]})]})},JC=()=>{const[t,e]=g.useState(!0),[n,r]=g.useState(!1),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(""),[m,f]=g.useState(""),[p,x]=g.useState(""),[j,v]=g.useState(""),[_,b]=g.useState(""),[w,N]=g.useState(""),[S,C]=g.useState(""),[A,P]=g.useState(""),[M,z]=g.useState("Deutschland"),[R,D]=g.useState(""),[B,W]=g.useState(""),[X,ue]=g.useState(""),[de,G]=g.useState(!1),{signIn:I,signUp:V,updatePassword:$}=jg(),F=Za(),[O]=xj();g.useEffect(()=>{(async()=>{console.log("Current URL:",window.location.href),console.log("Search params:",window.location.search);const te=O.get("mode"),J=O.get("token");if(console.log("Auth check:",{mode:te,inviteToken:J}),te==="employee-setup"&&J){console.log("Processing employee invitation token:",J);try{const{data:q,error:ne}=await Z.from("employee_invitations").select("*").eq("invite_token",J).eq("status","pending").single();if(ne||!q){console.error("Invalid invitation token:",ne),Ue.error("Ungültiger oder abgelaufener Einladungslink. Bitte wenden Sie sich an Ihren Manager.");return}if(new Date(q.expires_at)<new Date){console.error("Invitation token expired"),Ue.error("Dieser Einladungslink ist abgelaufen. Bitte fordern Sie eine neue Einladung an.");return}console.log("Valid invitation found:",q),i(q.email),r(!0),window.invitationData=q}catch(q){console.error("Error validating invitation:",q),Ue.error("Fehler beim Validieren der Einladung.")}}else te==="employee-setup"&&!J&&Ue.error("Fehlender Einladungstoken. Bitte verwenden Sie den vollständigen Link aus der E-Mail.")})()},[O]);const K=async U=>{var te,J;U.preventDefault(),G(!0);try{if(n){const pe=window.invitationData;if(!pe){Ue.error("Einladungsdaten nicht gefunden. Bitte verwenden Sie den Link aus der E-Mail erneut."),r(!1);return}if(o!==d){Ue.error("Passwörter stimmen nicht überein");return}if(o.length<6){Ue.error("Passwort muss mindestens 6 Zeichen lang sein");return}console.log("Creating account for employee:",pe.email);try{const{data:Q,error:re}=await Z.auth.signUp({email:pe.email,password:o,options:{data:{first_name:((te=pe.employee_data)==null?void 0:te.firstName)||"",last_name:((J=pe.employee_data)==null?void 0:J.lastName)||"",company_id:pe.company_id}}});if(re){console.error("Error creating user account:",re),Ue.error(re.message||"Fehler beim Erstellen des Kontos");return}Q.user&&(await Z.from("employee_invitations").update({status:"accepted"}).eq("invite_token",pe.invite_token),await Z.from("user_roles").insert({user_id:Q.user.id,role:"employee"}),console.log("Employee account created successfully"),Ue.success("Konto erfolgreich erstellt! Sie können sich jetzt anmelden."),r(!1),e(!0),c(""),u(""))}catch(Q){console.error("Error during employee registration:",Q),Ue.error("Fehler beim Erstellen des Kontos")}return}if(t){const{error:pe,data:Q}=await I(a,o);if(pe)Ue.error(pe.message);else if(Q!=null&&Q.user){const{data:re}=await Z.from("user_roles").select("role").eq("user_id",Q.user.id).single(),me=(re==null?void 0:re.role)||"employee";F(me==="manager"?"/manager":"/employee")}else F("/manager");return}if(o.length<6){Ue.error("Passwort muss mindestens 6 Zeichen lang sein");return}if(o!==d){Ue.error("Passwörter stimmen nicht überein");return}const q={firstName:m,lastName:p,companyName:j,phone:_,streetAddress:w,postalCode:S,city:A,country:M,vatId:R,voucherCode:B,referralSource:X},{error:ne}=await V(a,o,q);ne?Ue.error(ne.message):Ue.success("Registrierung erfolgreich! Bitte bestätigen Sie Ihre E-Mail.")}finally{G(!1)}};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50",children:[s.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx("img",{src:"/handwerkos-logo.svg",alt:"HandwerkOS Logo",className:"h-12 w-12 object-contain"}),s.jsx("h1",{className:"text-3xl font-bold tracking-wide",children:"HandwerkOS"})]}),s.jsx("p",{className:"text-center text-blue-100 mt-2 text-sm",children:"Die moderne Software-Lösung für Handwerksbetriebe"})]}),s.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-120px)] p-4",children:s.jsxs(oe,{className:"w-full max-w-2xl shadow-xl border-0 bg-white/80 backdrop-blur-sm",children:[s.jsxs(Ne,{className:"text-center space-y-4 pb-8",children:[s.jsx(Ce,{className:"flex items-center justify-center gap-3 text-2xl font-bold text-gray-800",children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:s.jsx(lS,{className:"h-6 w-6 text-blue-600"})}),"Passwort erstellen"]}):t?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:s.jsx(pr,{className:"h-6 w-6 text-green-600"})}),"Anmeldung"]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-2 bg-orange-100 rounded-full",children:s.jsx(cS,{className:"h-6 w-6 text-orange-600"})}),"Registrierung"]})}),s.jsx(ds,{className:"text-base text-gray-600",children:n?"Erstellen Sie Ihr Passwort für Ihren HandwerkOS Account":t?"Willkommen zurück! Melden Sie sich in Ihrem HandwerkOS Account an":"Starten Sie jetzt mit HandwerkOS und digitalisieren Sie Ihren Betrieb"})]}),s.jsx(ce,{children:s.jsxs("form",{onSubmit:K,className:"space-y-4",children:[n?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"password",children:"Neues Passwort"}),s.jsx(ae,{id:"password",type:"password",value:o,onChange:U=>c(U.target.value),required:!0,placeholder:"Mindestens 6 Zeichen"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"confirmPassword",children:"Passwort bestätigen"}),s.jsx(ae,{id:"confirmPassword",type:"password",value:d,onChange:U=>u(U.target.value),required:!0,placeholder:"Passwort wiederholen"})]})]}):t?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"email",children:"E-Mail"}),s.jsx(ae,{id:"email",type:"email",value:a,onChange:U=>i(U.target.value),required:!0,placeholder:"ihre@email.de"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"password",children:"Passwort"}),s.jsx(ae,{id:"password",type:"password",value:o,onChange:U=>c(U.target.value),required:!0,placeholder:"Ihr Passwort"})]})]}):s.jsx(s.Fragment,{children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Persönliche Daten"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"firstName",children:"Vorname *"}),s.jsx(ae,{id:"firstName",type:"text",value:m,onChange:U=>f(U.target.value),required:!0,placeholder:"Ihr Vorname"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"lastName",children:"Nachname *"}),s.jsx(ae,{id:"lastName",type:"text",value:p,onChange:U=>x(U.target.value),required:!0,placeholder:"Ihr Nachname"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"email",children:"E-Mail *"}),s.jsx(ae,{id:"email",type:"email",value:a,onChange:U=>i(U.target.value),required:!0,placeholder:"ihre@email.de"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"phone",children:"Telefon"}),s.jsx(ae,{id:"phone",type:"tel",value:_,onChange:U=>b(U.target.value),placeholder:"+49 123 456789"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Firmendaten"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"companyName",children:"Firmenname *"}),s.jsx(ae,{id:"companyName",type:"text",value:j,onChange:U=>v(U.target.value),required:!0,placeholder:"Ihre Firma"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"vatId",children:"USt-IdNr."}),s.jsx(ae,{id:"vatId",type:"text",value:R,onChange:U=>D(U.target.value),placeholder:"DE123456789"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Zusätzliche Angaben (optional)"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"voucherCode",children:"Gutscheincode"}),s.jsx(ae,{id:"voucherCode",type:"text",value:B,onChange:U=>W(U.target.value),placeholder:"Falls vorhanden"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"referralSource",children:"Wie haben Sie von uns erfahren?"}),s.jsxs(mt,{value:X,onValueChange:ue,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Bitte auswählen"})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Google",children:"Google"}),s.jsx(ye,{value:"Social Media",children:"Social Media"}),s.jsx(ye,{value:"Empfehlung",children:"Empfehlung"}),s.jsx(ye,{value:"Werbung",children:"Werbung"}),s.jsx(ye,{value:"Messe",children:"Messe"}),s.jsx(ye,{value:"Sonstiges",children:"Sonstiges"})]})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Adresse"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"streetAddress",children:"Straße & Hausnummer"}),s.jsx(ae,{id:"streetAddress",type:"text",value:w,onChange:U=>N(U.target.value),placeholder:"Musterstraße 123"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"postalCode",children:"PLZ"}),s.jsx(ae,{id:"postalCode",type:"text",value:S,onChange:U=>C(U.target.value),placeholder:"12345"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"city",children:"Stadt"}),s.jsx(ae,{id:"city",type:"text",value:A,onChange:U=>P(U.target.value),placeholder:"Musterstadt"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"country",children:"Land"}),s.jsxs(mt,{value:M,onValueChange:z,children:[s.jsx(ht,{children:s.jsx(pt,{placeholder:"Land auswählen"})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"Deutschland",children:"Deutschland"}),s.jsx(ye,{value:"Österreich",children:"Österreich"}),s.jsx(ye,{value:"Schweiz",children:"Schweiz"}),s.jsx(ye,{value:"Niederlande",children:"Niederlande"}),s.jsx(ye,{value:"Belgien",children:"Belgien"}),s.jsx(ye,{value:"Frankreich",children:"Frankreich"})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Passwort"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"password",children:"Passwort *"}),s.jsx(ae,{id:"password",type:"password",value:o,onChange:U=>c(U.target.value),required:!0,placeholder:"Mindestens 6 Zeichen"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"confirmPassword",children:"Passwort bestätigen *"}),s.jsx(ae,{id:"confirmPassword",type:"password",value:d,onChange:U=>u(U.target.value),required:!0,placeholder:"Passwort wiederholen"})]})]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(za,{id:"terms",required:!0}),s.jsxs(Y,{htmlFor:"terms",className:"text-sm",children:["Ich stimme den"," ",s.jsx("a",{href:"#",className:"text-primary underline hover:no-underline",onClick:U=>U.preventDefault(),children:"Allgemeinen Geschäftsbedingungen"})," ","und der"," ",s.jsx("a",{href:"#",className:"text-primary underline hover:no-underline",onClick:U=>U.preventDefault(),children:"Datenschutzerklärung"})," ","zu *"]})]})})]})]})}),s.jsx(ee,{type:"submit",className:"w-full h-12 text-lg font-semibold bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 shadow-lg hover:shadow-xl transition-all duration-200",disabled:de,children:de?s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),n?"Wird erstellt...":t?"Wird angemeldet...":"Wird registriert..."]}):n?s.jsxs(s.Fragment,{children:[s.jsx(lS,{className:"h-5 w-5 mr-2"}),"Passwort erstellen"]}):t?s.jsxs(s.Fragment,{children:[s.jsx(pr,{className:"h-5 w-5 mr-2"}),"Jetzt anmelden"]}):s.jsxs(s.Fragment,{children:[s.jsx(cS,{className:"h-5 w-5 mr-2"}),"Kostenlos registrieren"]})}),!n&&s.jsx("div",{className:"text-center pt-4 border-t",children:s.jsx(ee,{type:"button",variant:"ghost",onClick:()=>e(!t),className:"text-sm text-gray-600 hover:text-blue-600 font-medium",children:t?"Noch kein Account? Jetzt kostenlos registrieren":"Bereits registriert? Zur Anmeldung"})})]})})]})}),s.jsxs("div",{className:"text-center pb-6",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"© 2024 HandwerkOS - Die digitale Zukunft des Handwerks"}),s.jsxs("div",{className:"flex justify-center gap-6 mt-2 text-xs text-gray-400",children:[s.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Datenschutz"}),s.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Impressum"}),s.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Support"})]})]})]})};var eE={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,r){r(e)})(gt,function(n){var r="1.9.4";function a(l){var h,y,k,T;for(y=1,k=arguments.length;y<k;y++){T=arguments[y];for(h in T)l[h]=T[h]}return l}var i=Object.create||function(){function l(){}return function(h){return l.prototype=h,new l}}();function o(l,h){var y=Array.prototype.slice;if(l.bind)return l.bind.apply(l,y.call(arguments,1));var k=y.call(arguments,2);return function(){return l.apply(h,k.length?k.concat(y.call(arguments)):arguments)}}var c=0;function d(l){return"_leaflet_id"in l||(l._leaflet_id=++c),l._leaflet_id}function u(l,h,y){var k,T,H,ie;return ie=function(){k=!1,T&&(H.apply(y,T),T=!1)},H=function(){k?T=arguments:(l.apply(y,arguments),setTimeout(ie,h),k=!0)},H}function m(l,h,y){var k=h[1],T=h[0],H=k-T;return l===k&&y?l:((l-T)%H+H)%H+T}function f(){return!1}function p(l,h){if(h===!1)return l;var y=Math.pow(10,h===void 0?6:h);return Math.round(l*y)/y}function x(l){return l.trim?l.trim():l.replace(/^\s+|\s+$/g,"")}function j(l){return x(l).split(/\s+/)}function v(l,h){Object.prototype.hasOwnProperty.call(l,"options")||(l.options=l.options?i(l.options):{});for(var y in h)l.options[y]=h[y];return l.options}function _(l,h,y){var k=[];for(var T in l)k.push(encodeURIComponent(y?T.toUpperCase():T)+"="+encodeURIComponent(l[T]));return(!h||h.indexOf("?")===-1?"?":"&")+k.join("&")}var b=/\{ *([\w_ -]+) *\}/g;function w(l,h){return l.replace(b,function(y,k){var T=h[k];if(T===void 0)throw new Error("No value provided for variable "+y);return typeof T=="function"&&(T=T(h)),T})}var N=Array.isArray||function(l){return Object.prototype.toString.call(l)==="[object Array]"};function S(l,h){for(var y=0;y<l.length;y++)if(l[y]===h)return y;return-1}var C="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function A(l){return window["webkit"+l]||window["moz"+l]||window["ms"+l]}var P=0;function M(l){var h=+new Date,y=Math.max(0,16-(h-P));return P=h+y,window.setTimeout(l,y)}var z=window.requestAnimationFrame||A("RequestAnimationFrame")||M,R=window.cancelAnimationFrame||A("CancelAnimationFrame")||A("CancelRequestAnimationFrame")||function(l){window.clearTimeout(l)};function D(l,h,y){if(y&&z===M)l.call(h);else return z.call(window,o(l,h))}function B(l){l&&R.call(window,l)}var W={__proto__:null,extend:a,create:i,bind:o,get lastId(){return c},stamp:d,throttle:u,wrapNum:m,falseFn:f,formatNum:p,trim:x,splitWords:j,setOptions:v,getParamString:_,template:w,isArray:N,indexOf:S,emptyImageUrl:C,requestFn:z,cancelFn:R,requestAnimFrame:D,cancelAnimFrame:B};function X(){}X.extend=function(l){var h=function(){v(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},y=h.__super__=this.prototype,k=i(y);k.constructor=h,h.prototype=k;for(var T in this)Object.prototype.hasOwnProperty.call(this,T)&&T!=="prototype"&&T!=="__super__"&&(h[T]=this[T]);return l.statics&&a(h,l.statics),l.includes&&(ue(l.includes),a.apply(null,[k].concat(l.includes))),a(k,l),delete k.statics,delete k.includes,k.options&&(k.options=y.options?i(y.options):{},a(k.options,l.options)),k._initHooks=[],k.callInitHooks=function(){if(!this._initHooksCalled){y.callInitHooks&&y.callInitHooks.call(this),this._initHooksCalled=!0;for(var H=0,ie=k._initHooks.length;H<ie;H++)k._initHooks[H].call(this)}},h},X.include=function(l){var h=this.prototype.options;return a(this.prototype,l),l.options&&(this.prototype.options=h,this.mergeOptions(l.options)),this},X.mergeOptions=function(l){return a(this.prototype.options,l),this},X.addInitHook=function(l){var h=Array.prototype.slice.call(arguments,1),y=typeof l=="function"?l:function(){this[l].apply(this,h)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(y),this};function ue(l){if(!(typeof L>"u"||!L||!L.Mixin)){l=N(l)?l:[l];for(var h=0;h<l.length;h++)l[h]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var de={on:function(l,h,y){if(typeof l=="object")for(var k in l)this._on(k,l[k],h);else{l=j(l);for(var T=0,H=l.length;T<H;T++)this._on(l[T],h,y)}return this},off:function(l,h,y){if(!arguments.length)delete this._events;else if(typeof l=="object")for(var k in l)this._off(k,l[k],h);else{l=j(l);for(var T=arguments.length===1,H=0,ie=l.length;H<ie;H++)T?this._off(l[H]):this._off(l[H],h,y)}return this},_on:function(l,h,y,k){if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}if(this._listens(l,h,y)===!1){y===this&&(y=void 0);var T={fn:h,ctx:y};k&&(T.once=!0),this._events=this._events||{},this._events[l]=this._events[l]||[],this._events[l].push(T)}},_off:function(l,h,y){var k,T,H;if(this._events&&(k=this._events[l],!!k)){if(arguments.length===1){if(this._firingCount)for(T=0,H=k.length;T<H;T++)k[T].fn=f;delete this._events[l];return}if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}var ie=this._listens(l,h,y);if(ie!==!1){var fe=k[ie];this._firingCount&&(fe.fn=f,this._events[l]=k=k.slice()),k.splice(ie,1)}}},fire:function(l,h,y){if(!this.listens(l,y))return this;var k=a({},h,{type:l,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var T=this._events[l];if(T){this._firingCount=this._firingCount+1||1;for(var H=0,ie=T.length;H<ie;H++){var fe=T[H],ve=fe.fn;fe.once&&this.off(l,ve,fe.ctx),ve.call(fe.ctx||this,k)}this._firingCount--}}return y&&this._propagateEvent(k),this},listens:function(l,h,y,k){typeof l!="string"&&console.warn('"string" type argument expected');var T=h;typeof h!="function"&&(k=!!h,T=void 0,y=void 0);var H=this._events&&this._events[l];if(H&&H.length&&this._listens(l,T,y)!==!1)return!0;if(k){for(var ie in this._eventParents)if(this._eventParents[ie].listens(l,h,y,k))return!0}return!1},_listens:function(l,h,y){if(!this._events)return!1;var k=this._events[l]||[];if(!h)return!!k.length;y===this&&(y=void 0);for(var T=0,H=k.length;T<H;T++)if(k[T].fn===h&&k[T].ctx===y)return T;return!1},once:function(l,h,y){if(typeof l=="object")for(var k in l)this._on(k,l[k],h,!0);else{l=j(l);for(var T=0,H=l.length;T<H;T++)this._on(l[T],h,y,!0)}return this},addEventParent:function(l){return this._eventParents=this._eventParents||{},this._eventParents[d(l)]=l,this},removeEventParent:function(l){return this._eventParents&&delete this._eventParents[d(l)],this},_propagateEvent:function(l){for(var h in this._eventParents)this._eventParents[h].fire(l.type,a({layer:l.target,propagatedFrom:l.target},l),!0)}};de.addEventListener=de.on,de.removeEventListener=de.clearAllEventListeners=de.off,de.addOneTimeEventListener=de.once,de.fireEvent=de.fire,de.hasEventListeners=de.listens;var G=X.extend(de);function I(l,h,y){this.x=y?Math.round(l):l,this.y=y?Math.round(h):h}var V=Math.trunc||function(l){return l>0?Math.floor(l):Math.ceil(l)};I.prototype={clone:function(){return new I(this.x,this.y)},add:function(l){return this.clone()._add($(l))},_add:function(l){return this.x+=l.x,this.y+=l.y,this},subtract:function(l){return this.clone()._subtract($(l))},_subtract:function(l){return this.x-=l.x,this.y-=l.y,this},divideBy:function(l){return this.clone()._divideBy(l)},_divideBy:function(l){return this.x/=l,this.y/=l,this},multiplyBy:function(l){return this.clone()._multiplyBy(l)},_multiplyBy:function(l){return this.x*=l,this.y*=l,this},scaleBy:function(l){return new I(this.x*l.x,this.y*l.y)},unscaleBy:function(l){return new I(this.x/l.x,this.y/l.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=V(this.x),this.y=V(this.y),this},distanceTo:function(l){l=$(l);var h=l.x-this.x,y=l.y-this.y;return Math.sqrt(h*h+y*y)},equals:function(l){return l=$(l),l.x===this.x&&l.y===this.y},contains:function(l){return l=$(l),Math.abs(l.x)<=Math.abs(this.x)&&Math.abs(l.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function $(l,h,y){return l instanceof I?l:N(l)?new I(l[0],l[1]):l==null?l:typeof l=="object"&&"x"in l&&"y"in l?new I(l.x,l.y):new I(l,h,y)}function F(l,h){if(l)for(var y=h?[l,h]:l,k=0,T=y.length;k<T;k++)this.extend(y[k])}F.prototype={extend:function(l){var h,y;if(!l)return this;if(l instanceof I||typeof l[0]=="number"||"x"in l)h=y=$(l);else if(l=O(l),h=l.min,y=l.max,!h||!y)return this;return!this.min&&!this.max?(this.min=h.clone(),this.max=y.clone()):(this.min.x=Math.min(h.x,this.min.x),this.max.x=Math.max(y.x,this.max.x),this.min.y=Math.min(h.y,this.min.y),this.max.y=Math.max(y.y,this.max.y)),this},getCenter:function(l){return $((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,l)},getBottomLeft:function(){return $(this.min.x,this.max.y)},getTopRight:function(){return $(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(l){var h,y;return typeof l[0]=="number"||l instanceof I?l=$(l):l=O(l),l instanceof F?(h=l.min,y=l.max):h=y=l,h.x>=this.min.x&&y.x<=this.max.x&&h.y>=this.min.y&&y.y<=this.max.y},intersects:function(l){l=O(l);var h=this.min,y=this.max,k=l.min,T=l.max,H=T.x>=h.x&&k.x<=y.x,ie=T.y>=h.y&&k.y<=y.y;return H&&ie},overlaps:function(l){l=O(l);var h=this.min,y=this.max,k=l.min,T=l.max,H=T.x>h.x&&k.x<y.x,ie=T.y>h.y&&k.y<y.y;return H&&ie},isValid:function(){return!!(this.min&&this.max)},pad:function(l){var h=this.min,y=this.max,k=Math.abs(h.x-y.x)*l,T=Math.abs(h.y-y.y)*l;return O($(h.x-k,h.y-T),$(y.x+k,y.y+T))},equals:function(l){return l?(l=O(l),this.min.equals(l.getTopLeft())&&this.max.equals(l.getBottomRight())):!1}};function O(l,h){return!l||l instanceof F?l:new F(l,h)}function K(l,h){if(l)for(var y=h?[l,h]:l,k=0,T=y.length;k<T;k++)this.extend(y[k])}K.prototype={extend:function(l){var h=this._southWest,y=this._northEast,k,T;if(l instanceof te)k=l,T=l;else if(l instanceof K){if(k=l._southWest,T=l._northEast,!k||!T)return this}else return l?this.extend(J(l)||U(l)):this;return!h&&!y?(this._southWest=new te(k.lat,k.lng),this._northEast=new te(T.lat,T.lng)):(h.lat=Math.min(k.lat,h.lat),h.lng=Math.min(k.lng,h.lng),y.lat=Math.max(T.lat,y.lat),y.lng=Math.max(T.lng,y.lng)),this},pad:function(l){var h=this._southWest,y=this._northEast,k=Math.abs(h.lat-y.lat)*l,T=Math.abs(h.lng-y.lng)*l;return new K(new te(h.lat-k,h.lng-T),new te(y.lat+k,y.lng+T))},getCenter:function(){return new te((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new te(this.getNorth(),this.getWest())},getSouthEast:function(){return new te(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(l){typeof l[0]=="number"||l instanceof te||"lat"in l?l=J(l):l=U(l);var h=this._southWest,y=this._northEast,k,T;return l instanceof K?(k=l.getSouthWest(),T=l.getNorthEast()):k=T=l,k.lat>=h.lat&&T.lat<=y.lat&&k.lng>=h.lng&&T.lng<=y.lng},intersects:function(l){l=U(l);var h=this._southWest,y=this._northEast,k=l.getSouthWest(),T=l.getNorthEast(),H=T.lat>=h.lat&&k.lat<=y.lat,ie=T.lng>=h.lng&&k.lng<=y.lng;return H&&ie},overlaps:function(l){l=U(l);var h=this._southWest,y=this._northEast,k=l.getSouthWest(),T=l.getNorthEast(),H=T.lat>h.lat&&k.lat<y.lat,ie=T.lng>h.lng&&k.lng<y.lng;return H&&ie},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(l,h){return l?(l=U(l),this._southWest.equals(l.getSouthWest(),h)&&this._northEast.equals(l.getNorthEast(),h)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function U(l,h){return l instanceof K?l:new K(l,h)}function te(l,h,y){if(isNaN(l)||isNaN(h))throw new Error("Invalid LatLng object: ("+l+", "+h+")");this.lat=+l,this.lng=+h,y!==void 0&&(this.alt=+y)}te.prototype={equals:function(l,h){if(!l)return!1;l=J(l);var y=Math.max(Math.abs(this.lat-l.lat),Math.abs(this.lng-l.lng));return y<=(h===void 0?1e-9:h)},toString:function(l){return"LatLng("+p(this.lat,l)+", "+p(this.lng,l)+")"},distanceTo:function(l){return ne.distance(this,J(l))},wrap:function(){return ne.wrapLatLng(this)},toBounds:function(l){var h=180*l/40075017,y=h/Math.cos(Math.PI/180*this.lat);return U([this.lat-h,this.lng-y],[this.lat+h,this.lng+y])},clone:function(){return new te(this.lat,this.lng,this.alt)}};function J(l,h,y){return l instanceof te?l:N(l)&&typeof l[0]!="object"?l.length===3?new te(l[0],l[1],l[2]):l.length===2?new te(l[0],l[1]):null:l==null?l:typeof l=="object"&&"lat"in l?new te(l.lat,"lng"in l?l.lng:l.lon,l.alt):h===void 0?null:new te(l,h,y)}var q={latLngToPoint:function(l,h){var y=this.projection.project(l),k=this.scale(h);return this.transformation._transform(y,k)},pointToLatLng:function(l,h){var y=this.scale(h),k=this.transformation.untransform(l,y);return this.projection.unproject(k)},project:function(l){return this.projection.project(l)},unproject:function(l){return this.projection.unproject(l)},scale:function(l){return 256*Math.pow(2,l)},zoom:function(l){return Math.log(l/256)/Math.LN2},getProjectedBounds:function(l){if(this.infinite)return null;var h=this.projection.bounds,y=this.scale(l),k=this.transformation.transform(h.min,y),T=this.transformation.transform(h.max,y);return new F(k,T)},infinite:!1,wrapLatLng:function(l){var h=this.wrapLng?m(l.lng,this.wrapLng,!0):l.lng,y=this.wrapLat?m(l.lat,this.wrapLat,!0):l.lat,k=l.alt;return new te(y,h,k)},wrapLatLngBounds:function(l){var h=l.getCenter(),y=this.wrapLatLng(h),k=h.lat-y.lat,T=h.lng-y.lng;if(k===0&&T===0)return l;var H=l.getSouthWest(),ie=l.getNorthEast(),fe=new te(H.lat-k,H.lng-T),ve=new te(ie.lat-k,ie.lng-T);return new K(fe,ve)}},ne=a({},q,{wrapLng:[-180,180],R:6371e3,distance:function(l,h){var y=Math.PI/180,k=l.lat*y,T=h.lat*y,H=Math.sin((h.lat-l.lat)*y/2),ie=Math.sin((h.lng-l.lng)*y/2),fe=H*H+Math.cos(k)*Math.cos(T)*ie*ie,ve=2*Math.atan2(Math.sqrt(fe),Math.sqrt(1-fe));return this.R*ve}}),pe=6378137,Q={R:pe,MAX_LATITUDE:85.0511287798,project:function(l){var h=Math.PI/180,y=this.MAX_LATITUDE,k=Math.max(Math.min(y,l.lat),-y),T=Math.sin(k*h);return new I(this.R*l.lng*h,this.R*Math.log((1+T)/(1-T))/2)},unproject:function(l){var h=180/Math.PI;return new te((2*Math.atan(Math.exp(l.y/this.R))-Math.PI/2)*h,l.x*h/this.R)},bounds:function(){var l=pe*Math.PI;return new F([-l,-l],[l,l])}()};function re(l,h,y,k){if(N(l)){this._a=l[0],this._b=l[1],this._c=l[2],this._d=l[3];return}this._a=l,this._b=h,this._c=y,this._d=k}re.prototype={transform:function(l,h){return this._transform(l.clone(),h)},_transform:function(l,h){return h=h||1,l.x=h*(this._a*l.x+this._b),l.y=h*(this._c*l.y+this._d),l},untransform:function(l,h){return h=h||1,new I((l.x/h-this._b)/this._a,(l.y/h-this._d)/this._c)}};function me(l,h,y,k){return new re(l,h,y,k)}var he=a({},ne,{code:"EPSG:3857",projection:Q,transformation:function(){var l=.5/(Math.PI*Q.R);return me(l,.5,-l,.5)}()}),ge=a({},he,{code:"EPSG:900913"});function se(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function we(l,h){var y="",k,T,H,ie,fe,ve;for(k=0,H=l.length;k<H;k++){for(fe=l[k],T=0,ie=fe.length;T<ie;T++)ve=fe[T],y+=(T?"L":"M")+ve.x+" "+ve.y;y+=h?at.svg?"z":"x":""}return y||"M0 0"}var Se=document.documentElement.style,qe="ActiveXObject"in window,Ye=qe&&!document.addEventListener,Et="msLaunchUri"in navigator&&!("documentMode"in document),be=Js("webkit"),Oe=Js("android"),Fe=Js("android 2")||Js("android 3"),lt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),He=Oe&&Js("Google")&&lt<537&&!("AudioNode"in window),Le=!!window.opera,Nt=!Et&&Js("chrome"),xt=Js("gecko")&&!be&&!Le&&!qe,Un=!Nt&&Js("safari"),gs=Js("phantom"),yt="OTransition"in Se,dn=navigator.platform.indexOf("Win")===0,Tn=qe&&"transition"in Se,rs="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Fe,Mn="MozPerspective"in Se,bn=!window.L_DISABLE_3D&&(Tn||rs||Mn)&&!yt&&!gs,je=typeof orientation<"u"||Js("mobile"),_e=je&&be,$e=je&&rs,Me=!window.PointerEvent&&window.MSPointerEvent,Ee=!!(window.PointerEvent||Me),it="ontouchstart"in window||!!window.TouchEvent,pn=!window.L_NO_TOUCH&&(it||Ee),Ss=je&&Le,pa=je&&xt,Ai=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Pi=function(){var l=!1;try{var h=Object.defineProperty({},"passive",{get:function(){l=!0}});window.addEventListener("testPassiveEventSupport",f,h),window.removeEventListener("testPassiveEventSupport",f,h)}catch{}return l}(),Jd=function(){return!!document.createElement("canvas").getContext}(),Di=!!(document.createElementNS&&se("svg").createSVGRect),Ti=!!Di&&function(){var l=document.createElement("div");return l.innerHTML="<svg/>",(l.firstChild&&l.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),zf=!Di&&function(){try{var l=document.createElement("div");l.innerHTML='<v:shape adj="1"/>';var h=l.firstChild;return h.style.behavior="url(#default#VML)",h&&typeof h.adj=="object"}catch{return!1}}(),ks=navigator.platform.indexOf("Mac")===0,ga=navigator.platform.indexOf("Linux")===0;function Js(l){return navigator.userAgent.toLowerCase().indexOf(l)>=0}var at={ie:qe,ielt9:Ye,edge:Et,webkit:be,android:Oe,android23:Fe,androidStock:He,opera:Le,chrome:Nt,gecko:xt,safari:Un,phantom:gs,opera12:yt,win:dn,ie3d:Tn,webkit3d:rs,gecko3d:Mn,any3d:bn,mobile:je,mobileWebkit:_e,mobileWebkit3d:$e,msPointer:Me,pointer:Ee,touch:pn,touchNative:it,mobileOpera:Ss,mobileGecko:pa,retina:Ai,passiveEvents:Pi,canvas:Jd,svg:Di,vml:zf,inlineSvg:Ti,mac:ks,linux:ga},G1=at.msPointer?"MSPointerDown":"pointerdown",Q1=at.msPointer?"MSPointerMove":"pointermove",Y1=at.msPointer?"MSPointerUp":"pointerup",X1=at.msPointer?"MSPointerCancel":"pointercancel",sx={touchstart:G1,touchmove:Q1,touchend:Y1,touchcancel:X1},J1={touchstart:j5,touchmove:$f,touchend:$f,touchcancel:$f},ec={},eN=!1;function v5(l,h,y){return h==="touchstart"&&b5(),J1[h]?(y=J1[h].bind(this,y),l.addEventListener(sx[h],y,!1),y):(console.warn("wrong event specified:",h),f)}function y5(l,h,y){if(!sx[h]){console.warn("wrong event specified:",h);return}l.removeEventListener(sx[h],y,!1)}function _5(l){ec[l.pointerId]=l}function w5(l){ec[l.pointerId]&&(ec[l.pointerId]=l)}function tN(l){delete ec[l.pointerId]}function b5(){eN||(document.addEventListener(G1,_5,!0),document.addEventListener(Q1,w5,!0),document.addEventListener(Y1,tN,!0),document.addEventListener(X1,tN,!0),eN=!0)}function $f(l,h){if(h.pointerType!==(h.MSPOINTER_TYPE_MOUSE||"mouse")){h.touches=[];for(var y in ec)h.touches.push(ec[y]);h.changedTouches=[h],l(h)}}function j5(l,h){h.MSPOINTER_TYPE_TOUCH&&h.pointerType===h.MSPOINTER_TYPE_TOUCH&&as(h),$f(l,h)}function N5(l){var h={},y,k;for(k in l)y=l[k],h[k]=y&&y.bind?y.bind(l):y;return l=h,h.type="dblclick",h.detail=2,h.isTrusted=!1,h._simulated=!0,h}var S5=200;function k5(l,h){l.addEventListener("dblclick",h);var y=0,k;function T(H){if(H.detail!==1){k=H.detail;return}if(!(H.pointerType==="mouse"||H.sourceCapabilities&&!H.sourceCapabilities.firesTouchEvents)){var ie=iN(H);if(!(ie.some(function(ve){return ve instanceof HTMLLabelElement&&ve.attributes.for})&&!ie.some(function(ve){return ve instanceof HTMLInputElement||ve instanceof HTMLSelectElement}))){var fe=Date.now();fe-y<=S5?(k++,k===2&&h(N5(H))):k=1,y=fe}}}return l.addEventListener("click",T),{dblclick:h,simDblclick:T}}function C5(l,h){l.removeEventListener("dblclick",h.dblclick),l.removeEventListener("click",h.simDblclick)}var rx=Wf(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),eu=Wf(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),nN=eu==="webkitTransition"||eu==="OTransition"?eu+"End":"transitionend";function sN(l){return typeof l=="string"?document.getElementById(l):l}function tu(l,h){var y=l.style[h]||l.currentStyle&&l.currentStyle[h];if((!y||y==="auto")&&document.defaultView){var k=document.defaultView.getComputedStyle(l,null);y=k?k[h]:null}return y==="auto"?null:y}function Xt(l,h,y){var k=document.createElement(l);return k.className=h||"",y&&y.appendChild(k),k}function jn(l){var h=l.parentNode;h&&h.removeChild(l)}function Uf(l){for(;l.firstChild;)l.removeChild(l.firstChild)}function tc(l){var h=l.parentNode;h&&h.lastChild!==l&&h.appendChild(l)}function nc(l){var h=l.parentNode;h&&h.firstChild!==l&&h.insertBefore(l,h.firstChild)}function ax(l,h){if(l.classList!==void 0)return l.classList.contains(h);var y=qf(l);return y.length>0&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(y)}function It(l,h){if(l.classList!==void 0)for(var y=j(h),k=0,T=y.length;k<T;k++)l.classList.add(y[k]);else if(!ax(l,h)){var H=qf(l);ix(l,(H?H+" ":"")+h)}}function Pn(l,h){l.classList!==void 0?l.classList.remove(h):ix(l,x((" "+qf(l)+" ").replace(" "+h+" "," ")))}function ix(l,h){l.className.baseVal===void 0?l.className=h:l.className.baseVal=h}function qf(l){return l.correspondingElement&&(l=l.correspondingElement),l.className.baseVal===void 0?l.className:l.className.baseVal}function br(l,h){"opacity"in l.style?l.style.opacity=h:"filter"in l.style&&E5(l,h)}function E5(l,h){var y=!1,k="DXImageTransform.Microsoft.Alpha";try{y=l.filters.item(k)}catch{if(h===1)return}h=Math.round(h*100),y?(y.Enabled=h!==100,y.Opacity=h):l.style.filter+=" progid:"+k+"(opacity="+h+")"}function Wf(l){for(var h=document.documentElement.style,y=0;y<l.length;y++)if(l[y]in h)return l[y];return!1}function Vo(l,h,y){var k=h||new I(0,0);l.style[rx]=(at.ie3d?"translate("+k.x+"px,"+k.y+"px)":"translate3d("+k.x+"px,"+k.y+"px,0)")+(y?" scale("+y+")":"")}function Rn(l,h){l._leaflet_pos=h,at.any3d?Vo(l,h):(l.style.left=h.x+"px",l.style.top=h.y+"px")}function Ko(l){return l._leaflet_pos||new I(0,0)}var nu,su,ox;if("onselectstart"in document)nu=function(){At(window,"selectstart",as)},su=function(){un(window,"selectstart",as)};else{var ru=Wf(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);nu=function(){if(ru){var l=document.documentElement.style;ox=l[ru],l[ru]="none"}},su=function(){ru&&(document.documentElement.style[ru]=ox,ox=void 0)}}function lx(){At(window,"dragstart",as)}function cx(){un(window,"dragstart",as)}var Hf,dx;function ux(l){for(;l.tabIndex===-1;)l=l.parentNode;l.style&&(Vf(),Hf=l,dx=l.style.outlineStyle,l.style.outlineStyle="none",At(window,"keydown",Vf))}function Vf(){Hf&&(Hf.style.outlineStyle=dx,Hf=void 0,dx=void 0,un(window,"keydown",Vf))}function rN(l){do l=l.parentNode;while((!l.offsetWidth||!l.offsetHeight)&&l!==document.body);return l}function hx(l){var h=l.getBoundingClientRect();return{x:h.width/l.offsetWidth||1,y:h.height/l.offsetHeight||1,boundingClientRect:h}}var A5={__proto__:null,TRANSFORM:rx,TRANSITION:eu,TRANSITION_END:nN,get:sN,getStyle:tu,create:Xt,remove:jn,empty:Uf,toFront:tc,toBack:nc,hasClass:ax,addClass:It,removeClass:Pn,setClass:ix,getClass:qf,setOpacity:br,testProp:Wf,setTransform:Vo,setPosition:Rn,getPosition:Ko,get disableTextSelection(){return nu},get enableTextSelection(){return su},disableImageDrag:lx,enableImageDrag:cx,preventOutline:ux,restoreOutline:Vf,getSizedParentNode:rN,getScale:hx};function At(l,h,y,k){if(h&&typeof h=="object")for(var T in h)mx(l,T,h[T],y);else{h=j(h);for(var H=0,ie=h.length;H<ie;H++)mx(l,h[H],y,k)}return this}var xa="_leaflet_events";function un(l,h,y,k){if(arguments.length===1)aN(l),delete l[xa];else if(h&&typeof h=="object")for(var T in h)px(l,T,h[T],y);else if(h=j(h),arguments.length===2)aN(l,function(fe){return S(h,fe)!==-1});else for(var H=0,ie=h.length;H<ie;H++)px(l,h[H],y,k);return this}function aN(l,h){for(var y in l[xa]){var k=y.split(/\d/)[0];(!h||h(k))&&px(l,k,null,null,y)}}var fx={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function mx(l,h,y,k){var T=h+d(y)+(k?"_"+d(k):"");if(l[xa]&&l[xa][T])return this;var H=function(fe){return y.call(k||l,fe||window.event)},ie=H;!at.touchNative&&at.pointer&&h.indexOf("touch")===0?H=v5(l,h,H):at.touch&&h==="dblclick"?H=k5(l,H):"addEventListener"in l?h==="touchstart"||h==="touchmove"||h==="wheel"||h==="mousewheel"?l.addEventListener(fx[h]||h,H,at.passiveEvents?{passive:!1}:!1):h==="mouseenter"||h==="mouseleave"?(H=function(fe){fe=fe||window.event,xx(l,fe)&&ie(fe)},l.addEventListener(fx[h],H,!1)):l.addEventListener(h,ie,!1):l.attachEvent("on"+h,H),l[xa]=l[xa]||{},l[xa][T]=H}function px(l,h,y,k,T){T=T||h+d(y)+(k?"_"+d(k):"");var H=l[xa]&&l[xa][T];if(!H)return this;!at.touchNative&&at.pointer&&h.indexOf("touch")===0?y5(l,h,H):at.touch&&h==="dblclick"?C5(l,H):"removeEventListener"in l?l.removeEventListener(fx[h]||h,H,!1):l.detachEvent("on"+h,H),l[xa][T]=null}function Zo(l){return l.stopPropagation?l.stopPropagation():l.originalEvent?l.originalEvent._stopped=!0:l.cancelBubble=!0,this}function gx(l){return mx(l,"wheel",Zo),this}function au(l){return At(l,"mousedown touchstart dblclick contextmenu",Zo),l._leaflet_disable_click=!0,this}function as(l){return l.preventDefault?l.preventDefault():l.returnValue=!1,this}function Go(l){return as(l),Zo(l),this}function iN(l){if(l.composedPath)return l.composedPath();for(var h=[],y=l.target;y;)h.push(y),y=y.parentNode;return h}function oN(l,h){if(!h)return new I(l.clientX,l.clientY);var y=hx(h),k=y.boundingClientRect;return new I((l.clientX-k.left)/y.x-h.clientLeft,(l.clientY-k.top)/y.y-h.clientTop)}var P5=at.linux&&at.chrome?window.devicePixelRatio:at.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function lN(l){return at.edge?l.wheelDeltaY/2:l.deltaY&&l.deltaMode===0?-l.deltaY/P5:l.deltaY&&l.deltaMode===1?-l.deltaY*20:l.deltaY&&l.deltaMode===2?-l.deltaY*60:l.deltaX||l.deltaZ?0:l.wheelDelta?(l.wheelDeltaY||l.wheelDelta)/2:l.detail&&Math.abs(l.detail)<32765?-l.detail*20:l.detail?l.detail/-32765*60:0}function xx(l,h){var y=h.relatedTarget;if(!y)return!0;try{for(;y&&y!==l;)y=y.parentNode}catch{return!1}return y!==l}var D5={__proto__:null,on:At,off:un,stopPropagation:Zo,disableScrollPropagation:gx,disableClickPropagation:au,preventDefault:as,stop:Go,getPropagationPath:iN,getMousePosition:oN,getWheelDelta:lN,isExternalTarget:xx,addListener:At,removeListener:un},cN=G.extend({run:function(l,h,y,k){this.stop(),this._el=l,this._inProgress=!0,this._duration=y||.25,this._easeOutPower=1/Math.max(k||.5,.2),this._startPos=Ko(l),this._offset=h.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=D(this._animate,this),this._step()},_step:function(l){var h=+new Date-this._startTime,y=this._duration*1e3;h<y?this._runFrame(this._easeOut(h/y),l):(this._runFrame(1),this._complete())},_runFrame:function(l,h){var y=this._startPos.add(this._offset.multiplyBy(l));h&&y._round(),Rn(this._el,y),this.fire("step")},_complete:function(){B(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(l){return 1-Math.pow(1-l,this._easeOutPower)}}),Gt=G.extend({options:{crs:he,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(l,h){h=v(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(l),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),h.zoom!==void 0&&(this._zoom=this._limitZoom(h.zoom)),h.center&&h.zoom!==void 0&&this.setView(J(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=eu&&at.any3d&&!at.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),At(this._proxy,nN,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(l,h,y){if(h=h===void 0?this._zoom:this._limitZoom(h),l=this._limitCenter(J(l),h,this.options.maxBounds),y=y||{},this._stop(),this._loaded&&!y.reset&&y!==!0){y.animate!==void 0&&(y.zoom=a({animate:y.animate},y.zoom),y.pan=a({animate:y.animate,duration:y.duration},y.pan));var k=this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(l,h,y.zoom):this._tryAnimatedPan(l,y.pan);if(k)return clearTimeout(this._sizeTimer),this}return this._resetView(l,h,y.pan&&y.pan.noMoveStart),this},setZoom:function(l,h){return this._loaded?this.setView(this.getCenter(),l,{zoom:h}):(this._zoom=l,this)},zoomIn:function(l,h){return l=l||(at.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+l,h)},zoomOut:function(l,h){return l=l||(at.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-l,h)},setZoomAround:function(l,h,y){var k=this.getZoomScale(h),T=this.getSize().divideBy(2),H=l instanceof I?l:this.latLngToContainerPoint(l),ie=H.subtract(T).multiplyBy(1-1/k),fe=this.containerPointToLatLng(T.add(ie));return this.setView(fe,h,{zoom:y})},_getBoundsCenterZoom:function(l,h){h=h||{},l=l.getBounds?l.getBounds():U(l);var y=$(h.paddingTopLeft||h.padding||[0,0]),k=$(h.paddingBottomRight||h.padding||[0,0]),T=this.getBoundsZoom(l,!1,y.add(k));if(T=typeof h.maxZoom=="number"?Math.min(h.maxZoom,T):T,T===1/0)return{center:l.getCenter(),zoom:T};var H=k.subtract(y).divideBy(2),ie=this.project(l.getSouthWest(),T),fe=this.project(l.getNorthEast(),T),ve=this.unproject(ie.add(fe).divideBy(2).add(H),T);return{center:ve,zoom:T}},fitBounds:function(l,h){if(l=U(l),!l.isValid())throw new Error("Bounds are not valid.");var y=this._getBoundsCenterZoom(l,h);return this.setView(y.center,y.zoom,h)},fitWorld:function(l){return this.fitBounds([[-90,-180],[90,180]],l)},panTo:function(l,h){return this.setView(l,this._zoom,{pan:h})},panBy:function(l,h){if(l=$(l).round(),h=h||{},!l.x&&!l.y)return this.fire("moveend");if(h.animate!==!0&&!this.getSize().contains(l))return this._resetView(this.unproject(this.project(this.getCenter()).add(l)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new cN,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),h.animate!==!1){It(this._mapPane,"leaflet-pan-anim");var y=this._getMapPanePos().subtract(l).round();this._panAnim.run(this._mapPane,y,h.duration||.25,h.easeLinearity)}else this._rawPanBy(l),this.fire("move").fire("moveend");return this},flyTo:function(l,h,y){if(y=y||{},y.animate===!1||!at.any3d)return this.setView(l,h,y);this._stop();var k=this.project(this.getCenter()),T=this.project(l),H=this.getSize(),ie=this._zoom;l=J(l),h=h===void 0?ie:h;var fe=Math.max(H.x,H.y),ve=fe*this.getZoomScale(ie,h),ke=T.distanceTo(k)||1,Ve=1.42,_t=Ve*Ve;function Bt(In){var rm=In?-1:1,y6=In?ve:fe,_6=ve*ve-fe*fe+rm*_t*_t*ke*ke,w6=2*y6*_t*ke,Ex=_6/w6,qN=Math.sqrt(Ex*Ex+1)-Ex,b6=qN<1e-9?-18:Math.log(qN);return b6}function Cs(In){return(Math.exp(In)-Math.exp(-In))/2}function Qn(In){return(Math.exp(In)+Math.exp(-In))/2}function Nr(In){return Cs(In)/Qn(In)}var zs=Bt(0);function lc(In){return fe*(Qn(zs)/Qn(zs+Ve*In))}function p6(In){return fe*(Qn(zs)*Nr(zs+Ve*In)-Cs(zs))/_t}function g6(In){return 1-Math.pow(1-In,1.5)}var x6=Date.now(),$N=(Bt(1)-zs)/Ve,v6=y.duration?1e3*y.duration:1e3*$N*.8;function UN(){var In=(Date.now()-x6)/v6,rm=g6(In)*$N;In<=1?(this._flyToFrame=D(UN,this),this._move(this.unproject(k.add(T.subtract(k).multiplyBy(p6(rm)/ke)),ie),this.getScaleZoom(fe/lc(rm),ie),{flyTo:!0})):this._move(l,h)._moveEnd(!0)}return this._moveStart(!0,y.noMoveStart),UN.call(this),this},flyToBounds:function(l,h){var y=this._getBoundsCenterZoom(l,h);return this.flyTo(y.center,y.zoom,h)},setMaxBounds:function(l){return l=U(l),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),l.isValid()?(this.options.maxBounds=l,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(l){var h=this.options.minZoom;return this.options.minZoom=l,this._loaded&&h!==l&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(l):this},setMaxZoom:function(l){var h=this.options.maxZoom;return this.options.maxZoom=l,this._loaded&&h!==l&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(l):this},panInsideBounds:function(l,h){this._enforcingBounds=!0;var y=this.getCenter(),k=this._limitCenter(y,this._zoom,U(l));return y.equals(k)||this.panTo(k,h),this._enforcingBounds=!1,this},panInside:function(l,h){h=h||{};var y=$(h.paddingTopLeft||h.padding||[0,0]),k=$(h.paddingBottomRight||h.padding||[0,0]),T=this.project(this.getCenter()),H=this.project(l),ie=this.getPixelBounds(),fe=O([ie.min.add(y),ie.max.subtract(k)]),ve=fe.getSize();if(!fe.contains(H)){this._enforcingBounds=!0;var ke=H.subtract(fe.getCenter()),Ve=fe.extend(H).getSize().subtract(ve);T.x+=ke.x<0?-Ve.x:Ve.x,T.y+=ke.y<0?-Ve.y:Ve.y,this.panTo(this.unproject(T),h),this._enforcingBounds=!1}return this},invalidateSize:function(l){if(!this._loaded)return this;l=a({animate:!1,pan:!0},l===!0?{animate:!0}:l);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var y=this.getSize(),k=h.divideBy(2).round(),T=y.divideBy(2).round(),H=k.subtract(T);return!H.x&&!H.y?this:(l.animate&&l.pan?this.panBy(H):(l.pan&&this._rawPanBy(H),this.fire("move"),l.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:y}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(l){if(l=this._locateOptions=a({timeout:1e4,watch:!1},l),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=o(this._handleGeolocationResponse,this),y=o(this._handleGeolocationError,this);return l.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,y,l):navigator.geolocation.getCurrentPosition(h,y,l),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(l){if(this._container._leaflet_id){var h=l.code,y=l.message||(h===1?"permission denied":h===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+y+"."})}},_handleGeolocationResponse:function(l){if(this._container._leaflet_id){var h=l.coords.latitude,y=l.coords.longitude,k=new te(h,y),T=k.toBounds(l.coords.accuracy*2),H=this._locateOptions;if(H.setView){var ie=this.getBoundsZoom(T);this.setView(k,H.maxZoom?Math.min(ie,H.maxZoom):ie)}var fe={latlng:k,bounds:T,timestamp:l.timestamp};for(var ve in l.coords)typeof l.coords[ve]=="number"&&(fe[ve]=l.coords[ve]);this.fire("locationfound",fe)}},addHandler:function(l,h){if(!h)return this;var y=this[l]=new h(this);return this._handlers.push(y),this.options[l]&&y.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),jn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(B(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var l;for(l in this._layers)this._layers[l].remove();for(l in this._panes)jn(this._panes[l]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(l,h){var y="leaflet-pane"+(l?" leaflet-"+l.replace("Pane","")+"-pane":""),k=Xt("div",y,h||this._mapPane);return l&&(this._panes[l]=k),k},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var l=this.getPixelBounds(),h=this.unproject(l.getBottomLeft()),y=this.unproject(l.getTopRight());return new K(h,y)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(l,h,y){l=U(l),y=$(y||[0,0]);var k=this.getZoom()||0,T=this.getMinZoom(),H=this.getMaxZoom(),ie=l.getNorthWest(),fe=l.getSouthEast(),ve=this.getSize().subtract(y),ke=O(this.project(fe,k),this.project(ie,k)).getSize(),Ve=at.any3d?this.options.zoomSnap:1,_t=ve.x/ke.x,Bt=ve.y/ke.y,Cs=h?Math.max(_t,Bt):Math.min(_t,Bt);return k=this.getScaleZoom(Cs,k),Ve&&(k=Math.round(k/(Ve/100))*(Ve/100),k=h?Math.ceil(k/Ve)*Ve:Math.floor(k/Ve)*Ve),Math.max(T,Math.min(H,k))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new I(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(l,h){var y=this._getTopLeftPoint(l,h);return new F(y,y.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(l){return this.options.crs.getProjectedBounds(l===void 0?this.getZoom():l)},getPane:function(l){return typeof l=="string"?this._panes[l]:l},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(l,h){var y=this.options.crs;return h=h===void 0?this._zoom:h,y.scale(l)/y.scale(h)},getScaleZoom:function(l,h){var y=this.options.crs;h=h===void 0?this._zoom:h;var k=y.zoom(l*y.scale(h));return isNaN(k)?1/0:k},project:function(l,h){return h=h===void 0?this._zoom:h,this.options.crs.latLngToPoint(J(l),h)},unproject:function(l,h){return h=h===void 0?this._zoom:h,this.options.crs.pointToLatLng($(l),h)},layerPointToLatLng:function(l){var h=$(l).add(this.getPixelOrigin());return this.unproject(h)},latLngToLayerPoint:function(l){var h=this.project(J(l))._round();return h._subtract(this.getPixelOrigin())},wrapLatLng:function(l){return this.options.crs.wrapLatLng(J(l))},wrapLatLngBounds:function(l){return this.options.crs.wrapLatLngBounds(U(l))},distance:function(l,h){return this.options.crs.distance(J(l),J(h))},containerPointToLayerPoint:function(l){return $(l).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(l){return $(l).add(this._getMapPanePos())},containerPointToLatLng:function(l){var h=this.containerPointToLayerPoint($(l));return this.layerPointToLatLng(h)},latLngToContainerPoint:function(l){return this.layerPointToContainerPoint(this.latLngToLayerPoint(J(l)))},mouseEventToContainerPoint:function(l){return oN(l,this._container)},mouseEventToLayerPoint:function(l){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(l))},mouseEventToLatLng:function(l){return this.layerPointToLatLng(this.mouseEventToLayerPoint(l))},_initContainer:function(l){var h=this._container=sN(l);if(h){if(h._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");At(h,"scroll",this._onScroll,this),this._containerId=d(h)},_initLayout:function(){var l=this._container;this._fadeAnimated=this.options.fadeAnimation&&at.any3d,It(l,"leaflet-container"+(at.touch?" leaflet-touch":"")+(at.retina?" leaflet-retina":"")+(at.ielt9?" leaflet-oldie":"")+(at.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=tu(l,"position");h!=="absolute"&&h!=="relative"&&h!=="fixed"&&h!=="sticky"&&(l.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var l=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Rn(this._mapPane,new I(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(It(l.markerPane,"leaflet-zoom-hide"),It(l.shadowPane,"leaflet-zoom-hide"))},_resetView:function(l,h,y){Rn(this._mapPane,new I(0,0));var k=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var T=this._zoom!==h;this._moveStart(T,y)._move(l,h)._moveEnd(T),this.fire("viewreset"),k&&this.fire("load")},_moveStart:function(l,h){return l&&this.fire("zoomstart"),h||this.fire("movestart"),this},_move:function(l,h,y,k){h===void 0&&(h=this._zoom);var T=this._zoom!==h;return this._zoom=h,this._lastCenter=l,this._pixelOrigin=this._getNewPixelOrigin(l),k?y&&y.pinch&&this.fire("zoom",y):((T||y&&y.pinch)&&this.fire("zoom",y),this.fire("move",y)),this},_moveEnd:function(l){return l&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return B(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(l){Rn(this._mapPane,this._getMapPanePos().subtract(l))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(l){this._targets={},this._targets[d(this._container)]=this;var h=l?un:At;h(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),at.any3d&&this.options.transform3DLimit&&(l?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){B(this._resizeRequest),this._resizeRequest=D(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var l=this._getMapPanePos();Math.max(Math.abs(l.x),Math.abs(l.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(l,h){for(var y=[],k,T=h==="mouseout"||h==="mouseover",H=l.target||l.srcElement,ie=!1;H;){if(k=this._targets[d(H)],k&&(h==="click"||h==="preclick")&&this._draggableMoved(k)){ie=!0;break}if(k&&k.listens(h,!0)&&(T&&!xx(H,l)||(y.push(k),T))||H===this._container)break;H=H.parentNode}return!y.length&&!ie&&!T&&this.listens(h,!0)&&(y=[this]),y},_isClickDisabled:function(l){for(;l&&l!==this._container;){if(l._leaflet_disable_click)return!0;l=l.parentNode}},_handleDOMEvent:function(l){var h=l.target||l.srcElement;if(!(!this._loaded||h._leaflet_disable_events||l.type==="click"&&this._isClickDisabled(h))){var y=l.type;y==="mousedown"&&ux(h),this._fireDOMEvent(l,y)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(l,h,y){if(l.type==="click"){var k=a({},l);k.type="preclick",this._fireDOMEvent(k,k.type,y)}var T=this._findEventTargets(l,h);if(y){for(var H=[],ie=0;ie<y.length;ie++)y[ie].listens(h,!0)&&H.push(y[ie]);T=H.concat(T)}if(T.length){h==="contextmenu"&&as(l);var fe=T[0],ve={originalEvent:l};if(l.type!=="keypress"&&l.type!=="keydown"&&l.type!=="keyup"){var ke=fe.getLatLng&&(!fe._radius||fe._radius<=10);ve.containerPoint=ke?this.latLngToContainerPoint(fe.getLatLng()):this.mouseEventToContainerPoint(l),ve.layerPoint=this.containerPointToLayerPoint(ve.containerPoint),ve.latlng=ke?fe.getLatLng():this.layerPointToLatLng(ve.layerPoint)}for(ie=0;ie<T.length;ie++)if(T[ie].fire(h,ve,!0),ve.originalEvent._stopped||T[ie].options.bubblingMouseEvents===!1&&S(this._mouseEvents,h)!==-1)return}},_draggableMoved:function(l){return l=l.dragging&&l.dragging.enabled()?l:this,l.dragging&&l.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var l=0,h=this._handlers.length;l<h;l++)this._handlers[l].disable()},whenReady:function(l,h){return this._loaded?l.call(h||this,{target:this}):this.on("load",l,h),this},_getMapPanePos:function(){return Ko(this._mapPane)||new I(0,0)},_moved:function(){var l=this._getMapPanePos();return l&&!l.equals([0,0])},_getTopLeftPoint:function(l,h){var y=l&&h!==void 0?this._getNewPixelOrigin(l,h):this.getPixelOrigin();return y.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(l,h){var y=this.getSize()._divideBy(2);return this.project(l,h)._subtract(y)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(l,h,y){var k=this._getNewPixelOrigin(y,h);return this.project(l,h)._subtract(k)},_latLngBoundsToNewLayerBounds:function(l,h,y){var k=this._getNewPixelOrigin(y,h);return O([this.project(l.getSouthWest(),h)._subtract(k),this.project(l.getNorthWest(),h)._subtract(k),this.project(l.getSouthEast(),h)._subtract(k),this.project(l.getNorthEast(),h)._subtract(k)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(l){return this.latLngToLayerPoint(l).subtract(this._getCenterLayerPoint())},_limitCenter:function(l,h,y){if(!y)return l;var k=this.project(l,h),T=this.getSize().divideBy(2),H=new F(k.subtract(T),k.add(T)),ie=this._getBoundsOffset(H,y,h);return Math.abs(ie.x)<=1&&Math.abs(ie.y)<=1?l:this.unproject(k.add(ie),h)},_limitOffset:function(l,h){if(!h)return l;var y=this.getPixelBounds(),k=new F(y.min.add(l),y.max.add(l));return l.add(this._getBoundsOffset(k,h))},_getBoundsOffset:function(l,h,y){var k=O(this.project(h.getNorthEast(),y),this.project(h.getSouthWest(),y)),T=k.min.subtract(l.min),H=k.max.subtract(l.max),ie=this._rebound(T.x,-H.x),fe=this._rebound(T.y,-H.y);return new I(ie,fe)},_rebound:function(l,h){return l+h>0?Math.round(l-h)/2:Math.max(0,Math.ceil(l))-Math.max(0,Math.floor(h))},_limitZoom:function(l){var h=this.getMinZoom(),y=this.getMaxZoom(),k=at.any3d?this.options.zoomSnap:1;return k&&(l=Math.round(l/k)*k),Math.max(h,Math.min(y,l))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Pn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(l,h){var y=this._getCenterOffset(l)._trunc();return(h&&h.animate)!==!0&&!this.getSize().contains(y)?!1:(this.panBy(y,h),!0)},_createAnimProxy:function(){var l=this._proxy=Xt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(l),this.on("zoomanim",function(h){var y=rx,k=this._proxy.style[y];Vo(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),k===this._proxy.style[y]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){jn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var l=this.getCenter(),h=this.getZoom();Vo(this._proxy,this.project(l,h),this.getZoomScale(h,1))},_catchTransitionEnd:function(l){this._animatingZoom&&l.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(l,h,y){if(this._animatingZoom)return!0;if(y=y||{},!this._zoomAnimated||y.animate===!1||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var k=this.getZoomScale(h),T=this._getCenterOffset(l)._divideBy(1-1/k);return y.animate!==!0&&!this.getSize().contains(T)?!1:(D(function(){this._moveStart(!0,y.noMoveStart||!1)._animateZoom(l,h,!0)},this),!0)},_animateZoom:function(l,h,y,k){this._mapPane&&(y&&(this._animatingZoom=!0,this._animateToCenter=l,this._animateToZoom=h,It(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:l,zoom:h,noUpdate:k}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Pn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function T5(l,h){return new Gt(l,h)}var zr=X.extend({options:{position:"topright"},initialize:function(l){v(this,l)},getPosition:function(){return this.options.position},setPosition:function(l){var h=this._map;return h&&h.removeControl(this),this.options.position=l,h&&h.addControl(this),this},getContainer:function(){return this._container},addTo:function(l){this.remove(),this._map=l;var h=this._container=this.onAdd(l),y=this.getPosition(),k=l._controlCorners[y];return It(h,"leaflet-control"),y.indexOf("bottom")!==-1?k.insertBefore(h,k.firstChild):k.appendChild(h),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(jn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(l){this._map&&l&&l.screenX>0&&l.screenY>0&&this._map.getContainer().focus()}}),iu=function(l){return new zr(l)};Gt.include({addControl:function(l){return l.addTo(this),this},removeControl:function(l){return l.remove(),this},_initControlPos:function(){var l=this._controlCorners={},h="leaflet-",y=this._controlContainer=Xt("div",h+"control-container",this._container);function k(T,H){var ie=h+T+" "+h+H;l[T+H]=Xt("div",ie,y)}k("top","left"),k("top","right"),k("bottom","left"),k("bottom","right")},_clearControlPos:function(){for(var l in this._controlCorners)jn(this._controlCorners[l]);jn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var dN=zr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(l,h,y,k){return y<k?-1:k<y?1:0}},initialize:function(l,h,y){v(this,y),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var k in l)this._addLayer(l[k],k);for(k in h)this._addLayer(h[k],k,!0)},onAdd:function(l){this._initLayout(),this._update(),this._map=l,l.on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(l){return zr.prototype.addTo.call(this,l),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(l,h){return this._addLayer(l,h),this._map?this._update():this},addOverlay:function(l,h){return this._addLayer(l,h,!0),this._map?this._update():this},removeLayer:function(l){l.off("add remove",this._onLayerChange,this);var h=this._getLayer(d(l));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this},expand:function(){It(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var l=this._map.getSize().y-(this._container.offsetTop+50);return l<this._section.clientHeight?(It(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=l+"px"):Pn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Pn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var l="leaflet-control-layers",h=this._container=Xt("div",l),y=this.options.collapsed;h.setAttribute("aria-haspopup",!0),au(h),gx(h);var k=this._section=Xt("section",l+"-list");y&&(this._map.on("click",this.collapse,this),At(h,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var T=this._layersLink=Xt("a",l+"-toggle",h);T.href="#",T.title="Layers",T.setAttribute("role","button"),At(T,{keydown:function(H){H.keyCode===13&&this._expandSafely()},click:function(H){as(H),this._expandSafely()}},this),y||this.expand(),this._baseLayersList=Xt("div",l+"-base",k),this._separator=Xt("div",l+"-separator",k),this._overlaysList=Xt("div",l+"-overlays",k),h.appendChild(k)},_getLayer:function(l){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&d(this._layers[h].layer)===l)return this._layers[h]},_addLayer:function(l,h,y){this._map&&l.on("add remove",this._onLayerChange,this),this._layers.push({layer:l,name:h,overlay:y}),this.options.sortLayers&&this._layers.sort(o(function(k,T){return this.options.sortFunction(k.layer,T.layer,k.name,T.name)},this)),this.options.autoZIndex&&l.setZIndex&&(this._lastZIndex++,l.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Uf(this._baseLayersList),Uf(this._overlaysList),this._layerControlInputs=[];var l,h,y,k,T=0;for(y=0;y<this._layers.length;y++)k=this._layers[y],this._addItem(k),h=h||k.overlay,l=l||!k.overlay,T+=k.overlay?0:1;return this.options.hideSingleBase&&(l=l&&T>1,this._baseLayersList.style.display=l?"":"none"),this._separator.style.display=h&&l?"":"none",this},_onLayerChange:function(l){this._handlingClick||this._update();var h=this._getLayer(d(l.target)),y=h.overlay?l.type==="add"?"overlayadd":"overlayremove":l.type==="add"?"baselayerchange":null;y&&this._map.fire(y,h)},_createRadioElement:function(l,h){var y='<input type="radio" class="leaflet-control-layers-selector" name="'+l+'"'+(h?' checked="checked"':"")+"/>",k=document.createElement("div");return k.innerHTML=y,k.firstChild},_addItem:function(l){var h=document.createElement("label"),y=this._map.hasLayer(l.layer),k;l.overlay?(k=document.createElement("input"),k.type="checkbox",k.className="leaflet-control-layers-selector",k.defaultChecked=y):k=this._createRadioElement("leaflet-base-layers_"+d(this),y),this._layerControlInputs.push(k),k.layerId=d(l.layer),At(k,"click",this._onInputClick,this);var T=document.createElement("span");T.innerHTML=" "+l.name;var H=document.createElement("span");h.appendChild(H),H.appendChild(k),H.appendChild(T);var ie=l.overlay?this._overlaysList:this._baseLayersList;return ie.appendChild(h),this._checkDisabledLayers(),h},_onInputClick:function(){if(!this._preventClick){var l=this._layerControlInputs,h,y,k=[],T=[];this._handlingClick=!0;for(var H=l.length-1;H>=0;H--)h=l[H],y=this._getLayer(h.layerId).layer,h.checked?k.push(y):h.checked||T.push(y);for(H=0;H<T.length;H++)this._map.hasLayer(T[H])&&this._map.removeLayer(T[H]);for(H=0;H<k.length;H++)this._map.hasLayer(k[H])||this._map.addLayer(k[H]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var l=this._layerControlInputs,h,y,k=this._map.getZoom(),T=l.length-1;T>=0;T--)h=l[T],y=this._getLayer(h.layerId).layer,h.disabled=y.options.minZoom!==void 0&&k<y.options.minZoom||y.options.maxZoom!==void 0&&k>y.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var l=this._section;this._preventClick=!0,At(l,"click",as),this.expand();var h=this;setTimeout(function(){un(l,"click",as),h._preventClick=!1})}}),M5=function(l,h,y){return new dN(l,h,y)},vx=zr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(l){var h="leaflet-control-zoom",y=Xt("div",h+" leaflet-bar"),k=this.options;return this._zoomInButton=this._createButton(k.zoomInText,k.zoomInTitle,h+"-in",y,this._zoomIn),this._zoomOutButton=this._createButton(k.zoomOutText,k.zoomOutTitle,h+"-out",y,this._zoomOut),this._updateDisabled(),l.on("zoomend zoomlevelschange",this._updateDisabled,this),y},onRemove:function(l){l.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(l){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(l.shiftKey?3:1))},_zoomOut:function(l){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(l.shiftKey?3:1))},_createButton:function(l,h,y,k,T){var H=Xt("a",y,k);return H.innerHTML=l,H.href="#",H.title=h,H.setAttribute("role","button"),H.setAttribute("aria-label",h),au(H),At(H,"click",Go),At(H,"click",T,this),At(H,"click",this._refocusOnMap,this),H},_updateDisabled:function(){var l=this._map,h="leaflet-disabled";Pn(this._zoomInButton,h),Pn(this._zoomOutButton,h),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||l._zoom===l.getMinZoom())&&(It(this._zoomOutButton,h),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||l._zoom===l.getMaxZoom())&&(It(this._zoomInButton,h),this._zoomInButton.setAttribute("aria-disabled","true"))}});Gt.mergeOptions({zoomControl:!0}),Gt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new vx,this.addControl(this.zoomControl))});var R5=function(l){return new vx(l)},uN=zr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(l){var h="leaflet-control-scale",y=Xt("div",h),k=this.options;return this._addScales(k,h+"-line",y),l.on(k.updateWhenIdle?"moveend":"move",this._update,this),l.whenReady(this._update,this),y},onRemove:function(l){l.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(l,h,y){l.metric&&(this._mScale=Xt("div",h,y)),l.imperial&&(this._iScale=Xt("div",h,y))},_update:function(){var l=this._map,h=l.getSize().y/2,y=l.distance(l.containerPointToLatLng([0,h]),l.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(y)},_updateScales:function(l){this.options.metric&&l&&this._updateMetric(l),this.options.imperial&&l&&this._updateImperial(l)},_updateMetric:function(l){var h=this._getRoundNum(l),y=h<1e3?h+" m":h/1e3+" km";this._updateScale(this._mScale,y,h/l)},_updateImperial:function(l){var h=l*3.2808399,y,k,T;h>5280?(y=h/5280,k=this._getRoundNum(y),this._updateScale(this._iScale,k+" mi",k/y)):(T=this._getRoundNum(h),this._updateScale(this._iScale,T+" ft",T/h))},_updateScale:function(l,h,y){l.style.width=Math.round(this.options.maxWidth*y)+"px",l.innerHTML=h},_getRoundNum:function(l){var h=Math.pow(10,(Math.floor(l)+"").length-1),y=l/h;return y=y>=10?10:y>=5?5:y>=3?3:y>=2?2:1,h*y}}),I5=function(l){return new uN(l)},O5='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',yx=zr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(at.inlineSvg?O5+" ":"")+"Leaflet</a>"},initialize:function(l){v(this,l),this._attributions={}},onAdd:function(l){l.attributionControl=this,this._container=Xt("div","leaflet-control-attribution"),au(this._container);for(var h in l._layers)l._layers[h].getAttribution&&this.addAttribution(l._layers[h].getAttribution());return this._update(),l.on("layeradd",this._addAttribution,this),this._container},onRemove:function(l){l.off("layeradd",this._addAttribution,this)},_addAttribution:function(l){l.layer.getAttribution&&(this.addAttribution(l.layer.getAttribution()),l.layer.once("remove",function(){this.removeAttribution(l.layer.getAttribution())},this))},setPrefix:function(l){return this.options.prefix=l,this._update(),this},addAttribution:function(l){return l?(this._attributions[l]||(this._attributions[l]=0),this._attributions[l]++,this._update(),this):this},removeAttribution:function(l){return l?(this._attributions[l]&&(this._attributions[l]--,this._update()),this):this},_update:function(){if(this._map){var l=[];for(var h in this._attributions)this._attributions[h]&&l.push(h);var y=[];this.options.prefix&&y.push(this.options.prefix),l.length&&y.push(l.join(", ")),this._container.innerHTML=y.join(' <span aria-hidden="true">|</span> ')}}});Gt.mergeOptions({attributionControl:!0}),Gt.addInitHook(function(){this.options.attributionControl&&new yx().addTo(this)});var L5=function(l){return new yx(l)};zr.Layers=dN,zr.Zoom=vx,zr.Scale=uN,zr.Attribution=yx,iu.layers=M5,iu.zoom=R5,iu.scale=I5,iu.attribution=L5;var va=X.extend({initialize:function(l){this._map=l},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});va.addTo=function(l,h){return l.addHandler(h,this),this};var F5={Events:de},hN=at.touch?"touchstart mousedown":"mousedown",Mi=G.extend({options:{clickTolerance:3},initialize:function(l,h,y,k){v(this,k),this._element=l,this._dragStartTarget=h||l,this._preventOutline=y},enable:function(){this._enabled||(At(this._dragStartTarget,hN,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Mi._dragging===this&&this.finishDrag(!0),un(this._dragStartTarget,hN,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(l){if(this._enabled&&(this._moved=!1,!ax(this._element,"leaflet-zoom-anim"))){if(l.touches&&l.touches.length!==1){Mi._dragging===this&&this.finishDrag();return}if(!(Mi._dragging||l.shiftKey||l.which!==1&&l.button!==1&&!l.touches)&&(Mi._dragging=this,this._preventOutline&&ux(this._element),lx(),nu(),!this._moving)){this.fire("down");var h=l.touches?l.touches[0]:l,y=rN(this._element);this._startPoint=new I(h.clientX,h.clientY),this._startPos=Ko(this._element),this._parentScale=hx(y);var k=l.type==="mousedown";At(document,k?"mousemove":"touchmove",this._onMove,this),At(document,k?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(l){if(this._enabled){if(l.touches&&l.touches.length>1){this._moved=!0;return}var h=l.touches&&l.touches.length===1?l.touches[0]:l,y=new I(h.clientX,h.clientY)._subtract(this._startPoint);!y.x&&!y.y||Math.abs(y.x)+Math.abs(y.y)<this.options.clickTolerance||(y.x/=this._parentScale.x,y.y/=this._parentScale.y,as(l),this._moved||(this.fire("dragstart"),this._moved=!0,It(document.body,"leaflet-dragging"),this._lastTarget=l.target||l.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),It(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(y),this._moving=!0,this._lastEvent=l,this._updatePosition())}},_updatePosition:function(){var l={originalEvent:this._lastEvent};this.fire("predrag",l),Rn(this._element,this._newPos),this.fire("drag",l)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(l){Pn(document.body,"leaflet-dragging"),this._lastTarget&&(Pn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),un(document,"mousemove touchmove",this._onMove,this),un(document,"mouseup touchend touchcancel",this._onUp,this),cx(),su();var h=this._moved&&this._moving;this._moving=!1,Mi._dragging=!1,h&&this.fire("dragend",{noInertia:l,distance:this._newPos.distanceTo(this._startPos)})}});function fN(l,h,y){var k,T=[1,4,2,8],H,ie,fe,ve,ke,Ve,_t,Bt;for(H=0,Ve=l.length;H<Ve;H++)l[H]._code=Qo(l[H],h);for(fe=0;fe<4;fe++){for(_t=T[fe],k=[],H=0,Ve=l.length,ie=Ve-1;H<Ve;ie=H++)ve=l[H],ke=l[ie],ve._code&_t?ke._code&_t||(Bt=Kf(ke,ve,_t,h,y),Bt._code=Qo(Bt,h),k.push(Bt)):(ke._code&_t&&(Bt=Kf(ke,ve,_t,h,y),Bt._code=Qo(Bt,h),k.push(Bt)),k.push(ve));l=k}return l}function mN(l,h){var y,k,T,H,ie,fe,ve,ke,Ve;if(!l||l.length===0)throw new Error("latlngs not passed");jr(l)||(console.warn("latlngs are not flat! Only the first ring will be used"),l=l[0]);var _t=J([0,0]),Bt=U(l),Cs=Bt.getNorthWest().distanceTo(Bt.getSouthWest())*Bt.getNorthEast().distanceTo(Bt.getNorthWest());Cs<1700&&(_t=_x(l));var Qn=l.length,Nr=[];for(y=0;y<Qn;y++){var zs=J(l[y]);Nr.push(h.project(J([zs.lat-_t.lat,zs.lng-_t.lng])))}for(fe=ve=ke=0,y=0,k=Qn-1;y<Qn;k=y++)T=Nr[y],H=Nr[k],ie=T.y*H.x-H.y*T.x,ve+=(T.x+H.x)*ie,ke+=(T.y+H.y)*ie,fe+=ie*3;fe===0?Ve=Nr[0]:Ve=[ve/fe,ke/fe];var lc=h.unproject($(Ve));return J([lc.lat+_t.lat,lc.lng+_t.lng])}function _x(l){for(var h=0,y=0,k=0,T=0;T<l.length;T++){var H=J(l[T]);h+=H.lat,y+=H.lng,k++}return J([h/k,y/k])}var B5={__proto__:null,clipPolygon:fN,polygonCenter:mN,centroid:_x};function pN(l,h){if(!h||!l.length)return l.slice();var y=h*h;return l=U5(l,y),l=$5(l,y),l}function gN(l,h,y){return Math.sqrt(ou(l,h,y,!0))}function z5(l,h,y){return ou(l,h,y)}function $5(l,h){var y=l.length,k=typeof Uint8Array<"u"?Uint8Array:Array,T=new k(y);T[0]=T[y-1]=1,wx(l,T,h,0,y-1);var H,ie=[];for(H=0;H<y;H++)T[H]&&ie.push(l[H]);return ie}function wx(l,h,y,k,T){var H=0,ie,fe,ve;for(fe=k+1;fe<=T-1;fe++)ve=ou(l[fe],l[k],l[T],!0),ve>H&&(ie=fe,H=ve);H>y&&(h[ie]=1,wx(l,h,y,k,ie),wx(l,h,y,ie,T))}function U5(l,h){for(var y=[l[0]],k=1,T=0,H=l.length;k<H;k++)q5(l[k],l[T])>h&&(y.push(l[k]),T=k);return T<H-1&&y.push(l[H-1]),y}var xN;function vN(l,h,y,k,T){var H=k?xN:Qo(l,y),ie=Qo(h,y),fe,ve,ke;for(xN=ie;;){if(!(H|ie))return[l,h];if(H&ie)return!1;fe=H||ie,ve=Kf(l,h,fe,y,T),ke=Qo(ve,y),fe===H?(l=ve,H=ke):(h=ve,ie=ke)}}function Kf(l,h,y,k,T){var H=h.x-l.x,ie=h.y-l.y,fe=k.min,ve=k.max,ke,Ve;return y&8?(ke=l.x+H*(ve.y-l.y)/ie,Ve=ve.y):y&4?(ke=l.x+H*(fe.y-l.y)/ie,Ve=fe.y):y&2?(ke=ve.x,Ve=l.y+ie*(ve.x-l.x)/H):y&1&&(ke=fe.x,Ve=l.y+ie*(fe.x-l.x)/H),new I(ke,Ve,T)}function Qo(l,h){var y=0;return l.x<h.min.x?y|=1:l.x>h.max.x&&(y|=2),l.y<h.min.y?y|=4:l.y>h.max.y&&(y|=8),y}function q5(l,h){var y=h.x-l.x,k=h.y-l.y;return y*y+k*k}function ou(l,h,y,k){var T=h.x,H=h.y,ie=y.x-T,fe=y.y-H,ve=ie*ie+fe*fe,ke;return ve>0&&(ke=((l.x-T)*ie+(l.y-H)*fe)/ve,ke>1?(T=y.x,H=y.y):ke>0&&(T+=ie*ke,H+=fe*ke)),ie=l.x-T,fe=l.y-H,k?ie*ie+fe*fe:new I(T,H)}function jr(l){return!N(l[0])||typeof l[0][0]!="object"&&typeof l[0][0]<"u"}function yN(l){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),jr(l)}function _N(l,h){var y,k,T,H,ie,fe,ve,ke;if(!l||l.length===0)throw new Error("latlngs not passed");jr(l)||(console.warn("latlngs are not flat! Only the first ring will be used"),l=l[0]);var Ve=J([0,0]),_t=U(l),Bt=_t.getNorthWest().distanceTo(_t.getSouthWest())*_t.getNorthEast().distanceTo(_t.getNorthWest());Bt<1700&&(Ve=_x(l));var Cs=l.length,Qn=[];for(y=0;y<Cs;y++){var Nr=J(l[y]);Qn.push(h.project(J([Nr.lat-Ve.lat,Nr.lng-Ve.lng])))}for(y=0,k=0;y<Cs-1;y++)k+=Qn[y].distanceTo(Qn[y+1])/2;if(k===0)ke=Qn[0];else for(y=0,H=0;y<Cs-1;y++)if(ie=Qn[y],fe=Qn[y+1],T=ie.distanceTo(fe),H+=T,H>k){ve=(H-k)/T,ke=[fe.x-ve*(fe.x-ie.x),fe.y-ve*(fe.y-ie.y)];break}var zs=h.unproject($(ke));return J([zs.lat+Ve.lat,zs.lng+Ve.lng])}var W5={__proto__:null,simplify:pN,pointToSegmentDistance:gN,closestPointOnSegment:z5,clipSegment:vN,_getEdgeIntersection:Kf,_getBitCode:Qo,_sqClosestPointOnSegment:ou,isFlat:jr,_flat:yN,polylineCenter:_N},bx={project:function(l){return new I(l.lng,l.lat)},unproject:function(l){return new te(l.y,l.x)},bounds:new F([-180,-90],[180,90])},jx={R:6378137,R_MINOR:6356752314245179e-9,bounds:new F([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(l){var h=Math.PI/180,y=this.R,k=l.lat*h,T=this.R_MINOR/y,H=Math.sqrt(1-T*T),ie=H*Math.sin(k),fe=Math.tan(Math.PI/4-k/2)/Math.pow((1-ie)/(1+ie),H/2);return k=-y*Math.log(Math.max(fe,1e-10)),new I(l.lng*h*y,k)},unproject:function(l){for(var h=180/Math.PI,y=this.R,k=this.R_MINOR/y,T=Math.sqrt(1-k*k),H=Math.exp(-l.y/y),ie=Math.PI/2-2*Math.atan(H),fe=0,ve=.1,ke;fe<15&&Math.abs(ve)>1e-7;fe++)ke=T*Math.sin(ie),ke=Math.pow((1-ke)/(1+ke),T/2),ve=Math.PI/2-2*Math.atan(H*ke)-ie,ie+=ve;return new te(ie*h,l.x*h/y)}},H5={__proto__:null,LonLat:bx,Mercator:jx,SphericalMercator:Q},V5=a({},ne,{code:"EPSG:3395",projection:jx,transformation:function(){var l=.5/(Math.PI*jx.R);return me(l,.5,-l,.5)}()}),wN=a({},ne,{code:"EPSG:4326",projection:bx,transformation:me(1/180,1,-1/180,.5)}),K5=a({},q,{projection:bx,transformation:me(1,0,-1,0),scale:function(l){return Math.pow(2,l)},zoom:function(l){return Math.log(l)/Math.LN2},distance:function(l,h){var y=h.lng-l.lng,k=h.lat-l.lat;return Math.sqrt(y*y+k*k)},infinite:!0});q.Earth=ne,q.EPSG3395=V5,q.EPSG3857=he,q.EPSG900913=ge,q.EPSG4326=wN,q.Simple=K5;var $r=G.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(l){return l.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(l){return l&&l.removeLayer(this),this},getPane:function(l){return this._map.getPane(l?this.options[l]||l:this.options.pane)},addInteractiveTarget:function(l){return this._map._targets[d(l)]=this,this},removeInteractiveTarget:function(l){return delete this._map._targets[d(l)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(l){var h=l.target;if(h.hasLayer(this)){if(this._map=h,this._zoomAnimated=h._zoomAnimated,this.getEvents){var y=this.getEvents();h.on(y,this),this.once("remove",function(){h.off(y,this)},this)}this.onAdd(h),this.fire("add"),h.fire("layeradd",{layer:this})}}});Gt.include({addLayer:function(l){if(!l._layerAdd)throw new Error("The provided object is not a Layer.");var h=d(l);return this._layers[h]?this:(this._layers[h]=l,l._mapToAdd=this,l.beforeAdd&&l.beforeAdd(this),this.whenReady(l._layerAdd,l),this)},removeLayer:function(l){var h=d(l);return this._layers[h]?(this._loaded&&l.onRemove(this),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:l}),l.fire("remove")),l._map=l._mapToAdd=null,this):this},hasLayer:function(l){return d(l)in this._layers},eachLayer:function(l,h){for(var y in this._layers)l.call(h,this._layers[y]);return this},_addLayers:function(l){l=l?N(l)?l:[l]:[];for(var h=0,y=l.length;h<y;h++)this.addLayer(l[h])},_addZoomLimit:function(l){(!isNaN(l.options.maxZoom)||!isNaN(l.options.minZoom))&&(this._zoomBoundLayers[d(l)]=l,this._updateZoomLevels())},_removeZoomLimit:function(l){var h=d(l);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels())},_updateZoomLevels:function(){var l=1/0,h=-1/0,y=this._getZoomSpan();for(var k in this._zoomBoundLayers){var T=this._zoomBoundLayers[k].options;l=T.minZoom===void 0?l:Math.min(l,T.minZoom),h=T.maxZoom===void 0?h:Math.max(h,T.maxZoom)}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=l===1/0?void 0:l,y!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var sc=$r.extend({initialize:function(l,h){v(this,h),this._layers={};var y,k;if(l)for(y=0,k=l.length;y<k;y++)this.addLayer(l[y])},addLayer:function(l){var h=this.getLayerId(l);return this._layers[h]=l,this._map&&this._map.addLayer(l),this},removeLayer:function(l){var h=l in this._layers?l:this.getLayerId(l);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this},hasLayer:function(l){var h=typeof l=="number"?l:this.getLayerId(l);return h in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(l){var h=Array.prototype.slice.call(arguments,1),y,k;for(y in this._layers)k=this._layers[y],k[l]&&k[l].apply(k,h);return this},onAdd:function(l){this.eachLayer(l.addLayer,l)},onRemove:function(l){this.eachLayer(l.removeLayer,l)},eachLayer:function(l,h){for(var y in this._layers)l.call(h,this._layers[y]);return this},getLayer:function(l){return this._layers[l]},getLayers:function(){var l=[];return this.eachLayer(l.push,l),l},setZIndex:function(l){return this.invoke("setZIndex",l)},getLayerId:function(l){return d(l)}}),Z5=function(l,h){return new sc(l,h)},Ya=sc.extend({addLayer:function(l){return this.hasLayer(l)?this:(l.addEventParent(this),sc.prototype.addLayer.call(this,l),this.fire("layeradd",{layer:l}))},removeLayer:function(l){return this.hasLayer(l)?(l in this._layers&&(l=this._layers[l]),l.removeEventParent(this),sc.prototype.removeLayer.call(this,l),this.fire("layerremove",{layer:l})):this},setStyle:function(l){return this.invoke("setStyle",l)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var l=new K;for(var h in this._layers){var y=this._layers[h];l.extend(y.getBounds?y.getBounds():y.getLatLng())}return l}}),G5=function(l,h){return new Ya(l,h)},rc=X.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(l){v(this,l)},createIcon:function(l){return this._createIcon("icon",l)},createShadow:function(l){return this._createIcon("shadow",l)},_createIcon:function(l,h){var y=this._getIconUrl(l);if(!y){if(l==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var k=this._createImg(y,h&&h.tagName==="IMG"?h:null);return this._setIconStyles(k,l),(this.options.crossOrigin||this.options.crossOrigin==="")&&(k.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),k},_setIconStyles:function(l,h){var y=this.options,k=y[h+"Size"];typeof k=="number"&&(k=[k,k]);var T=$(k),H=$(h==="shadow"&&y.shadowAnchor||y.iconAnchor||T&&T.divideBy(2,!0));l.className="leaflet-marker-"+h+" "+(y.className||""),H&&(l.style.marginLeft=-H.x+"px",l.style.marginTop=-H.y+"px"),T&&(l.style.width=T.x+"px",l.style.height=T.y+"px")},_createImg:function(l,h){return h=h||document.createElement("img"),h.src=l,h},_getIconUrl:function(l){return at.retina&&this.options[l+"RetinaUrl"]||this.options[l+"Url"]}});function Q5(l){return new rc(l)}var lu=rc.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(l){return typeof lu.imagePath!="string"&&(lu.imagePath=this._detectIconPath()),(this.options.imagePath||lu.imagePath)+rc.prototype._getIconUrl.call(this,l)},_stripUrl:function(l){var h=function(y,k,T){var H=k.exec(y);return H&&H[T]};return l=h(l,/^url\((['"])?(.+)\1\)$/,2),l&&h(l,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var l=Xt("div","leaflet-default-icon-path",document.body),h=tu(l,"background-image")||tu(l,"backgroundImage");if(document.body.removeChild(l),h=this._stripUrl(h),h)return h;var y=document.querySelector('link[href$="leaflet.css"]');return y?y.href.substring(0,y.href.length-11-1):""}}),bN=va.extend({initialize:function(l){this._marker=l},addHooks:function(){var l=this._marker._icon;this._draggable||(this._draggable=new Mi(l,l,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),It(l,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Pn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(l){var h=this._marker,y=h._map,k=this._marker.options.autoPanSpeed,T=this._marker.options.autoPanPadding,H=Ko(h._icon),ie=y.getPixelBounds(),fe=y.getPixelOrigin(),ve=O(ie.min._subtract(fe).add(T),ie.max._subtract(fe).subtract(T));if(!ve.contains(H)){var ke=$((Math.max(ve.max.x,H.x)-ve.max.x)/(ie.max.x-ve.max.x)-(Math.min(ve.min.x,H.x)-ve.min.x)/(ie.min.x-ve.min.x),(Math.max(ve.max.y,H.y)-ve.max.y)/(ie.max.y-ve.max.y)-(Math.min(ve.min.y,H.y)-ve.min.y)/(ie.min.y-ve.min.y)).multiplyBy(k);y.panBy(ke,{animate:!1}),this._draggable._newPos._add(ke),this._draggable._startPos._add(ke),Rn(h._icon,this._draggable._newPos),this._onDrag(l),this._panRequest=D(this._adjustPan.bind(this,l))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(l){this._marker.options.autoPan&&(B(this._panRequest),this._panRequest=D(this._adjustPan.bind(this,l)))},_onDrag:function(l){var h=this._marker,y=h._shadow,k=Ko(h._icon),T=h._map.layerPointToLatLng(k);y&&Rn(y,k),h._latlng=T,l.latlng=T,l.oldLatLng=this._oldLatLng,h.fire("move",l).fire("drag",l)},_onDragEnd:function(l){B(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",l)}}),Zf=$r.extend({options:{icon:new lu,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(l,h){v(this,h),this._latlng=J(l)},onAdd:function(l){this._zoomAnimated=this._zoomAnimated&&l.options.markerZoomAnimation,this._zoomAnimated&&l.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(l){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&l.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(l){var h=this._latlng;return this._latlng=J(l),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},setZIndexOffset:function(l){return this.options.zIndexOffset=l,this.update()},getIcon:function(){return this.options.icon},setIcon:function(l){return this.options.icon=l,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var l=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(l)}return this},_initIcon:function(){var l=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),y=l.icon.createIcon(this._icon),k=!1;y!==this._icon&&(this._icon&&this._removeIcon(),k=!0,l.title&&(y.title=l.title),y.tagName==="IMG"&&(y.alt=l.alt||"")),It(y,h),l.keyboard&&(y.tabIndex="0",y.setAttribute("role","button")),this._icon=y,l.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&At(y,"focus",this._panOnFocus,this);var T=l.icon.createShadow(this._shadow),H=!1;T!==this._shadow&&(this._removeShadow(),H=!0),T&&(It(T,h),T.alt=""),this._shadow=T,l.opacity<1&&this._updateOpacity(),k&&this.getPane().appendChild(this._icon),this._initInteraction(),T&&H&&this.getPane(l.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&un(this._icon,"focus",this._panOnFocus,this),jn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&jn(this._shadow),this._shadow=null},_setPos:function(l){this._icon&&Rn(this._icon,l),this._shadow&&Rn(this._shadow,l),this._zIndex=l.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(l){this._icon&&(this._icon.style.zIndex=this._zIndex+l)},_animateZoom:function(l){var h=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center).round();this._setPos(h)},_initInteraction:function(){if(this.options.interactive&&(It(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),bN)){var l=this.options.draggable;this.dragging&&(l=this.dragging.enabled(),this.dragging.disable()),this.dragging=new bN(this),l&&this.dragging.enable()}},setOpacity:function(l){return this.options.opacity=l,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var l=this.options.opacity;this._icon&&br(this._icon,l),this._shadow&&br(this._shadow,l)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var l=this._map;if(l){var h=this.options.icon.options,y=h.iconSize?$(h.iconSize):$(0,0),k=h.iconAnchor?$(h.iconAnchor):$(0,0);l.panInside(this._latlng,{paddingTopLeft:k,paddingBottomRight:y.subtract(k)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Y5(l,h){return new Zf(l,h)}var Ri=$r.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(l){this._renderer=l.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(l){return v(this,l),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&l&&Object.prototype.hasOwnProperty.call(l,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Gf=Ri.extend({options:{fill:!0,radius:10},initialize:function(l,h){v(this,h),this._latlng=J(l),this._radius=this.options.radius},setLatLng:function(l){var h=this._latlng;return this._latlng=J(l),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(l){return this.options.radius=this._radius=l,this.redraw()},getRadius:function(){return this._radius},setStyle:function(l){var h=l&&l.radius||this._radius;return Ri.prototype.setStyle.call(this,l),this.setRadius(h),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var l=this._radius,h=this._radiusY||l,y=this._clickTolerance(),k=[l+y,h+y];this._pxBounds=new F(this._point.subtract(k),this._point.add(k))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(l){return l.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function X5(l,h){return new Gf(l,h)}var Nx=Gf.extend({initialize:function(l,h,y){if(typeof h=="number"&&(h=a({},y,{radius:h})),v(this,h),this._latlng=J(l),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(l){return this._mRadius=l,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var l=[this._radius,this._radiusY||this._radius];return new K(this._map.layerPointToLatLng(this._point.subtract(l)),this._map.layerPointToLatLng(this._point.add(l)))},setStyle:Ri.prototype.setStyle,_project:function(){var l=this._latlng.lng,h=this._latlng.lat,y=this._map,k=y.options.crs;if(k.distance===ne.distance){var T=Math.PI/180,H=this._mRadius/ne.R/T,ie=y.project([h+H,l]),fe=y.project([h-H,l]),ve=ie.add(fe).divideBy(2),ke=y.unproject(ve).lat,Ve=Math.acos((Math.cos(H*T)-Math.sin(h*T)*Math.sin(ke*T))/(Math.cos(h*T)*Math.cos(ke*T)))/T;(isNaN(Ve)||Ve===0)&&(Ve=H/Math.cos(Math.PI/180*h)),this._point=ve.subtract(y.getPixelOrigin()),this._radius=isNaN(Ve)?0:ve.x-y.project([ke,l-Ve]).x,this._radiusY=ve.y-ie.y}else{var _t=k.unproject(k.project(this._latlng).subtract([this._mRadius,0]));this._point=y.latLngToLayerPoint(this._latlng),this._radius=this._point.x-y.latLngToLayerPoint(_t).x}this._updateBounds()}});function J5(l,h,y){return new Nx(l,h,y)}var Xa=Ri.extend({options:{smoothFactor:1,noClip:!1},initialize:function(l,h){v(this,h),this._setLatLngs(l)},getLatLngs:function(){return this._latlngs},setLatLngs:function(l){return this._setLatLngs(l),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(l){for(var h=1/0,y=null,k=ou,T,H,ie=0,fe=this._parts.length;ie<fe;ie++)for(var ve=this._parts[ie],ke=1,Ve=ve.length;ke<Ve;ke++){T=ve[ke-1],H=ve[ke];var _t=k(l,T,H,!0);_t<h&&(h=_t,y=k(l,T,H))}return y&&(y.distance=Math.sqrt(h)),y},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return _N(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(l,h){return h=h||this._defaultShape(),l=J(l),h.push(l),this._bounds.extend(l),this.redraw()},_setLatLngs:function(l){this._bounds=new K,this._latlngs=this._convertLatLngs(l)},_defaultShape:function(){return jr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(l){for(var h=[],y=jr(l),k=0,T=l.length;k<T;k++)y?(h[k]=J(l[k]),this._bounds.extend(h[k])):h[k]=this._convertLatLngs(l[k]);return h},_project:function(){var l=new F;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,l),this._bounds.isValid()&&l.isValid()&&(this._rawPxBounds=l,this._updateBounds())},_updateBounds:function(){var l=this._clickTolerance(),h=new I(l,l);this._rawPxBounds&&(this._pxBounds=new F([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)]))},_projectLatlngs:function(l,h,y){var k=l[0]instanceof te,T=l.length,H,ie;if(k){for(ie=[],H=0;H<T;H++)ie[H]=this._map.latLngToLayerPoint(l[H]),y.extend(ie[H]);h.push(ie)}else for(H=0;H<T;H++)this._projectLatlngs(l[H],h,y)},_clipPoints:function(){var l=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(l))){if(this.options.noClip){this._parts=this._rings;return}var h=this._parts,y,k,T,H,ie,fe,ve;for(y=0,T=0,H=this._rings.length;y<H;y++)for(ve=this._rings[y],k=0,ie=ve.length;k<ie-1;k++)fe=vN(ve[k],ve[k+1],l,k,!0),fe&&(h[T]=h[T]||[],h[T].push(fe[0]),(fe[1]!==ve[k+1]||k===ie-2)&&(h[T].push(fe[1]),T++))}},_simplifyPoints:function(){for(var l=this._parts,h=this.options.smoothFactor,y=0,k=l.length;y<k;y++)l[y]=pN(l[y],h)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(l,h){var y,k,T,H,ie,fe,ve=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(l))return!1;for(y=0,H=this._parts.length;y<H;y++)for(fe=this._parts[y],k=0,ie=fe.length,T=ie-1;k<ie;T=k++)if(!(!h&&k===0)&&gN(l,fe[T],fe[k])<=ve)return!0;return!1}});function e6(l,h){return new Xa(l,h)}Xa._flat=yN;var ac=Xa.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return mN(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(l){var h=Xa.prototype._convertLatLngs.call(this,l),y=h.length;return y>=2&&h[0]instanceof te&&h[0].equals(h[y-1])&&h.pop(),h},_setLatLngs:function(l){Xa.prototype._setLatLngs.call(this,l),jr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return jr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var l=this._renderer._bounds,h=this.options.weight,y=new I(h,h);if(l=new F(l.min.subtract(y),l.max.add(y)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(l))){if(this.options.noClip){this._parts=this._rings;return}for(var k=0,T=this._rings.length,H;k<T;k++)H=fN(this._rings[k],l,!0),H.length&&this._parts.push(H)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(l){var h=!1,y,k,T,H,ie,fe,ve,ke;if(!this._pxBounds||!this._pxBounds.contains(l))return!1;for(H=0,ve=this._parts.length;H<ve;H++)for(y=this._parts[H],ie=0,ke=y.length,fe=ke-1;ie<ke;fe=ie++)k=y[ie],T=y[fe],k.y>l.y!=T.y>l.y&&l.x<(T.x-k.x)*(l.y-k.y)/(T.y-k.y)+k.x&&(h=!h);return h||Xa.prototype._containsPoint.call(this,l,!0)}});function t6(l,h){return new ac(l,h)}var Ja=Ya.extend({initialize:function(l,h){v(this,h),this._layers={},l&&this.addData(l)},addData:function(l){var h=N(l)?l:l.features,y,k,T;if(h){for(y=0,k=h.length;y<k;y++)T=h[y],(T.geometries||T.geometry||T.features||T.coordinates)&&this.addData(T);return this}var H=this.options;if(H.filter&&!H.filter(l))return this;var ie=Qf(l,H);return ie?(ie.feature=Jf(l),ie.defaultOptions=ie.options,this.resetStyle(ie),H.onEachFeature&&H.onEachFeature(l,ie),this.addLayer(ie)):this},resetStyle:function(l){return l===void 0?this.eachLayer(this.resetStyle,this):(l.options=a({},l.defaultOptions),this._setLayerStyle(l,this.options.style),this)},setStyle:function(l){return this.eachLayer(function(h){this._setLayerStyle(h,l)},this)},_setLayerStyle:function(l,h){l.setStyle&&(typeof h=="function"&&(h=h(l.feature)),l.setStyle(h))}});function Qf(l,h){var y=l.type==="Feature"?l.geometry:l,k=y?y.coordinates:null,T=[],H=h&&h.pointToLayer,ie=h&&h.coordsToLatLng||Sx,fe,ve,ke,Ve;if(!k&&!y)return null;switch(y.type){case"Point":return fe=ie(k),jN(H,l,fe,h);case"MultiPoint":for(ke=0,Ve=k.length;ke<Ve;ke++)fe=ie(k[ke]),T.push(jN(H,l,fe,h));return new Ya(T);case"LineString":case"MultiLineString":return ve=Yf(k,y.type==="LineString"?0:1,ie),new Xa(ve,h);case"Polygon":case"MultiPolygon":return ve=Yf(k,y.type==="Polygon"?1:2,ie),new ac(ve,h);case"GeometryCollection":for(ke=0,Ve=y.geometries.length;ke<Ve;ke++){var _t=Qf({geometry:y.geometries[ke],type:"Feature",properties:l.properties},h);_t&&T.push(_t)}return new Ya(T);case"FeatureCollection":for(ke=0,Ve=y.features.length;ke<Ve;ke++){var Bt=Qf(y.features[ke],h);Bt&&T.push(Bt)}return new Ya(T);default:throw new Error("Invalid GeoJSON object.")}}function jN(l,h,y,k){return l?l(h,y):new Zf(y,k&&k.markersInheritOptions&&k)}function Sx(l){return new te(l[1],l[0],l[2])}function Yf(l,h,y){for(var k=[],T=0,H=l.length,ie;T<H;T++)ie=h?Yf(l[T],h-1,y):(y||Sx)(l[T]),k.push(ie);return k}function kx(l,h){return l=J(l),l.alt!==void 0?[p(l.lng,h),p(l.lat,h),p(l.alt,h)]:[p(l.lng,h),p(l.lat,h)]}function Xf(l,h,y,k){for(var T=[],H=0,ie=l.length;H<ie;H++)T.push(h?Xf(l[H],jr(l[H])?0:h-1,y,k):kx(l[H],k));return!h&&y&&T.length>0&&T.push(T[0].slice()),T}function ic(l,h){return l.feature?a({},l.feature,{geometry:h}):Jf(h)}function Jf(l){return l.type==="Feature"||l.type==="FeatureCollection"?l:{type:"Feature",properties:{},geometry:l}}var Cx={toGeoJSON:function(l){return ic(this,{type:"Point",coordinates:kx(this.getLatLng(),l)})}};Zf.include(Cx),Nx.include(Cx),Gf.include(Cx),Xa.include({toGeoJSON:function(l){var h=!jr(this._latlngs),y=Xf(this._latlngs,h?1:0,!1,l);return ic(this,{type:(h?"Multi":"")+"LineString",coordinates:y})}}),ac.include({toGeoJSON:function(l){var h=!jr(this._latlngs),y=h&&!jr(this._latlngs[0]),k=Xf(this._latlngs,y?2:h?1:0,!0,l);return h||(k=[k]),ic(this,{type:(y?"Multi":"")+"Polygon",coordinates:k})}}),sc.include({toMultiPoint:function(l){var h=[];return this.eachLayer(function(y){h.push(y.toGeoJSON(l).geometry.coordinates)}),ic(this,{type:"MultiPoint",coordinates:h})},toGeoJSON:function(l){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(h==="MultiPoint")return this.toMultiPoint(l);var y=h==="GeometryCollection",k=[];return this.eachLayer(function(T){if(T.toGeoJSON){var H=T.toGeoJSON(l);if(y)k.push(H.geometry);else{var ie=Jf(H);ie.type==="FeatureCollection"?k.push.apply(k,ie.features):k.push(ie)}}}),y?ic(this,{geometries:k,type:"GeometryCollection"}):{type:"FeatureCollection",features:k}}});function NN(l,h){return new Ja(l,h)}var n6=NN,em=$r.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(l,h,y){this._url=l,this._bounds=U(h),v(this,y)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(It(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){jn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(l){return this.options.opacity=l,this._image&&this._updateOpacity(),this},setStyle:function(l){return l.opacity&&this.setOpacity(l.opacity),this},bringToFront:function(){return this._map&&tc(this._image),this},bringToBack:function(){return this._map&&nc(this._image),this},setUrl:function(l){return this._url=l,this._image&&(this._image.src=l),this},setBounds:function(l){return this._bounds=U(l),this._map&&this._reset(),this},getEvents:function(){var l={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},setZIndex:function(l){return this.options.zIndex=l,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var l=this._url.tagName==="IMG",h=this._image=l?this._url:Xt("img");if(It(h,"leaflet-image-layer"),this._zoomAnimated&&It(h,"leaflet-zoom-animated"),this.options.className&&It(h,this.options.className),h.onselectstart=f,h.onmousemove=f,h.onload=o(this.fire,this,"load"),h.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),l){this._url=h.src;return}h.src=this._url,h.alt=this.options.alt},_animateZoom:function(l){var h=this._map.getZoomScale(l.zoom),y=this._map._latLngBoundsToNewLayerBounds(this._bounds,l.zoom,l.center).min;Vo(this._image,y,h)},_reset:function(){var l=this._image,h=new F(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),y=h.getSize();Rn(l,h.min),l.style.width=y.x+"px",l.style.height=y.y+"px"},_updateOpacity:function(){br(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var l=this.options.errorOverlayUrl;l&&this._url!==l&&(this._url=l,this._image.src=l)},getCenter:function(){return this._bounds.getCenter()}}),s6=function(l,h,y){return new em(l,h,y)},SN=em.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var l=this._url.tagName==="VIDEO",h=this._image=l?this._url:Xt("video");if(It(h,"leaflet-image-layer"),this._zoomAnimated&&It(h,"leaflet-zoom-animated"),this.options.className&&It(h,this.options.className),h.onselectstart=f,h.onmousemove=f,h.onloadeddata=o(this.fire,this,"load"),l){for(var y=h.getElementsByTagName("source"),k=[],T=0;T<y.length;T++)k.push(y[T].src);this._url=y.length>0?k:[h.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted,h.playsInline=!!this.options.playsInline;for(var H=0;H<this._url.length;H++){var ie=Xt("source");ie.src=this._url[H],h.appendChild(ie)}}});function r6(l,h,y){return new SN(l,h,y)}var kN=em.extend({_initImage:function(){var l=this._image=this._url;It(l,"leaflet-image-layer"),this._zoomAnimated&&It(l,"leaflet-zoom-animated"),this.options.className&&It(l,this.options.className),l.onselectstart=f,l.onmousemove=f}});function a6(l,h,y){return new kN(l,h,y)}var ya=$r.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(l,h){l&&(l instanceof te||N(l))?(this._latlng=J(l),v(this,h)):(v(this,l),this._source=h),this.options.content&&(this._content=this.options.content)},openOn:function(l){return l=arguments.length?l:this._source._map,l.hasLayer(this)||l.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(l){return this._map?this.close():(arguments.length?this._source=l:l=this._source,this._prepareOpen(),this.openOn(l._map)),this},onAdd:function(l){this._zoomAnimated=l._zoomAnimated,this._container||this._initLayout(),l._fadeAnimated&&br(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),l._fadeAnimated&&br(this._container,1),this.bringToFront(),this.options.interactive&&(It(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(l){l._fadeAnimated?(br(this._container,0),this._removeTimeout=setTimeout(o(jn,void 0,this._container),200)):jn(this._container),this.options.interactive&&(Pn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(l){return this._latlng=J(l),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(l){return this._content=l,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var l={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&tc(this._container),this},bringToBack:function(){return this._map&&nc(this._container),this},_prepareOpen:function(l){var h=this._source;if(!h._map)return!1;if(h instanceof Ya){h=null;var y=this._source._layers;for(var k in y)if(y[k]._map){h=y[k];break}if(!h)return!1;this._source=h}if(!l)if(h.getCenter)l=h.getCenter();else if(h.getLatLng)l=h.getLatLng();else if(h.getBounds)l=h.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(l),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var l=this._contentNode,h=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof h=="string")l.innerHTML=h;else{for(;l.hasChildNodes();)l.removeChild(l.firstChild);l.appendChild(h)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var l=this._map.latLngToLayerPoint(this._latlng),h=$(this.options.offset),y=this._getAnchor();this._zoomAnimated?Rn(this._container,l.add(y)):h=h.add(l).add(y);var k=this._containerBottom=-h.y,T=this._containerLeft=-Math.round(this._containerWidth/2)+h.x;this._container.style.bottom=k+"px",this._container.style.left=T+"px"}},_getAnchor:function(){return[0,0]}});Gt.include({_initOverlay:function(l,h,y,k){var T=h;return T instanceof l||(T=new l(k).setContent(h)),y&&T.setLatLng(y),T}}),$r.include({_initOverlay:function(l,h,y,k){var T=y;return T instanceof l?(v(T,k),T._source=this):(T=h&&!k?h:new l(k,this),T.setContent(y)),T}});var tm=ya.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(l){return l=arguments.length?l:this._source._map,!l.hasLayer(this)&&l._popup&&l._popup.options.autoClose&&l.removeLayer(l._popup),l._popup=this,ya.prototype.openOn.call(this,l)},onAdd:function(l){ya.prototype.onAdd.call(this,l),l.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ri||this._source.on("preclick",Zo))},onRemove:function(l){ya.prototype.onRemove.call(this,l),l.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ri||this._source.off("preclick",Zo))},getEvents:function(){var l=ya.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(l.preclick=this.close),this.options.keepInView&&(l.moveend=this._adjustPan),l},_initLayout:function(){var l="leaflet-popup",h=this._container=Xt("div",l+" "+(this.options.className||"")+" leaflet-zoom-animated"),y=this._wrapper=Xt("div",l+"-content-wrapper",h);if(this._contentNode=Xt("div",l+"-content",y),au(h),gx(this._contentNode),At(h,"contextmenu",Zo),this._tipContainer=Xt("div",l+"-tip-container",h),this._tip=Xt("div",l+"-tip",this._tipContainer),this.options.closeButton){var k=this._closeButton=Xt("a",l+"-close-button",h);k.setAttribute("role","button"),k.setAttribute("aria-label","Close popup"),k.href="#close",k.innerHTML='<span aria-hidden="true">&#215;</span>',At(k,"click",function(T){as(T),this.close()},this)}},_updateLayout:function(){var l=this._contentNode,h=l.style;h.width="",h.whiteSpace="nowrap";var y=l.offsetWidth;y=Math.min(y,this.options.maxWidth),y=Math.max(y,this.options.minWidth),h.width=y+1+"px",h.whiteSpace="",h.height="";var k=l.offsetHeight,T=this.options.maxHeight,H="leaflet-popup-scrolled";T&&k>T?(h.height=T+"px",It(l,H)):Pn(l,H),this._containerWidth=this._container.offsetWidth},_animateZoom:function(l){var h=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center),y=this._getAnchor();Rn(this._container,h.add(y))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var l=this._map,h=parseInt(tu(this._container,"marginBottom"),10)||0,y=this._container.offsetHeight+h,k=this._containerWidth,T=new I(this._containerLeft,-y-this._containerBottom);T._add(Ko(this._container));var H=l.layerPointToContainerPoint(T),ie=$(this.options.autoPanPadding),fe=$(this.options.autoPanPaddingTopLeft||ie),ve=$(this.options.autoPanPaddingBottomRight||ie),ke=l.getSize(),Ve=0,_t=0;H.x+k+ve.x>ke.x&&(Ve=H.x+k-ke.x+ve.x),H.x-Ve-fe.x<0&&(Ve=H.x-fe.x),H.y+y+ve.y>ke.y&&(_t=H.y+y-ke.y+ve.y),H.y-_t-fe.y<0&&(_t=H.y-fe.y),(Ve||_t)&&(this.options.keepInView&&(this._autopanning=!0),l.fire("autopanstart").panBy([Ve,_t]))}},_getAnchor:function(){return $(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),i6=function(l,h){return new tm(l,h)};Gt.mergeOptions({closePopupOnClick:!0}),Gt.include({openPopup:function(l,h,y){return this._initOverlay(tm,l,h,y).openOn(this),this},closePopup:function(l){return l=arguments.length?l:this._popup,l&&l.close(),this}}),$r.include({bindPopup:function(l,h){return this._popup=this._initOverlay(tm,this._popup,l,h),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(l){return this._popup&&(this instanceof Ya||(this._popup._source=this),this._popup._prepareOpen(l||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(l){return this._popup&&this._popup.setContent(l),this},getPopup:function(){return this._popup},_openPopup:function(l){if(!(!this._popup||!this._map)){Go(l);var h=l.layer||l.target;if(this._popup._source===h&&!(h instanceof Ri)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(l.latlng);return}this._popup._source=h,this.openPopup(l.latlng)}},_movePopup:function(l){this._popup.setLatLng(l.latlng)},_onKeyPress:function(l){l.originalEvent.keyCode===13&&this._openPopup(l)}});var nm=ya.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(l){ya.prototype.onAdd.call(this,l),this.setOpacity(this.options.opacity),l.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(l){ya.prototype.onRemove.call(this,l),l.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var l=ya.prototype.getEvents.call(this);return this.options.permanent||(l.preclick=this.close),l},_initLayout:function(){var l="leaflet-tooltip",h=l+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Xt("div",h),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(l){var h,y,k=this._map,T=this._container,H=k.latLngToContainerPoint(k.getCenter()),ie=k.layerPointToContainerPoint(l),fe=this.options.direction,ve=T.offsetWidth,ke=T.offsetHeight,Ve=$(this.options.offset),_t=this._getAnchor();fe==="top"?(h=ve/2,y=ke):fe==="bottom"?(h=ve/2,y=0):fe==="center"?(h=ve/2,y=ke/2):fe==="right"?(h=0,y=ke/2):fe==="left"?(h=ve,y=ke/2):ie.x<H.x?(fe="right",h=0,y=ke/2):(fe="left",h=ve+(Ve.x+_t.x)*2,y=ke/2),l=l.subtract($(h,y,!0)).add(Ve).add(_t),Pn(T,"leaflet-tooltip-right"),Pn(T,"leaflet-tooltip-left"),Pn(T,"leaflet-tooltip-top"),Pn(T,"leaflet-tooltip-bottom"),It(T,"leaflet-tooltip-"+fe),Rn(T,l)},_updatePosition:function(){var l=this._map.latLngToLayerPoint(this._latlng);this._setPosition(l)},setOpacity:function(l){this.options.opacity=l,this._container&&br(this._container,l)},_animateZoom:function(l){var h=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center);this._setPosition(h)},_getAnchor:function(){return $(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),o6=function(l,h){return new nm(l,h)};Gt.include({openTooltip:function(l,h,y){return this._initOverlay(nm,l,h,y).openOn(this),this},closeTooltip:function(l){return l.close(),this}}),$r.include({bindTooltip:function(l,h){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(nm,this._tooltip,l,h),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(l){if(!(!l&&this._tooltipHandlersAdded)){var h=l?"off":"on",y={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?y.add=this._openTooltip:(y.mouseover=this._openTooltip,y.mouseout=this.closeTooltip,y.click=this._openTooltip,this._map?this._addFocusListeners():y.add=this._addFocusListeners),this._tooltip.options.sticky&&(y.mousemove=this._moveTooltip),this[h](y),this._tooltipHandlersAdded=!l}},openTooltip:function(l){return this._tooltip&&(this instanceof Ya||(this._tooltip._source=this),this._tooltip._prepareOpen(l)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(l){return this._tooltip&&this._tooltip.setContent(l),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(l){var h=typeof l.getElement=="function"&&l.getElement();h&&(At(h,"focus",function(){this._tooltip._source=l,this.openTooltip()},this),At(h,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(l){var h=typeof l.getElement=="function"&&l.getElement();h&&h.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(l){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var h=this;this._map.once("moveend",function(){h._openOnceFlag=!1,h._openTooltip(l)});return}this._tooltip._source=l.layer||l.target,this.openTooltip(this._tooltip.options.sticky?l.latlng:void 0)}},_moveTooltip:function(l){var h=l.latlng,y,k;this._tooltip.options.sticky&&l.originalEvent&&(y=this._map.mouseEventToContainerPoint(l.originalEvent),k=this._map.containerPointToLayerPoint(y),h=this._map.layerPointToLatLng(k)),this._tooltip.setLatLng(h)}});var CN=rc.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(l){var h=l&&l.tagName==="DIV"?l:document.createElement("div"),y=this.options;if(y.html instanceof Element?(Uf(h),h.appendChild(y.html)):h.innerHTML=y.html!==!1?y.html:"",y.bgPos){var k=$(y.bgPos);h.style.backgroundPosition=-k.x+"px "+-k.y+"px"}return this._setIconStyles(h,"icon"),h},createShadow:function(){return null}});function l6(l){return new CN(l)}rc.Default=lu;var cu=$r.extend({options:{tileSize:256,opacity:1,updateWhenIdle:at.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(l){v(this,l)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(l){l._addZoomLimit(this)},onRemove:function(l){this._removeAllTiles(),jn(this._container),l._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(tc(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(nc(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(l){return this.options.opacity=l,this._updateOpacity(),this},setZIndex:function(l){return this.options.zIndex=l,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var l=this._clampZoom(this._map.getZoom());l!==this._tileZoom&&(this._tileZoom=l,this._updateLevels()),this._update()}return this},getEvents:function(){var l={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=u(this._onMoveEnd,this.options.updateInterval,this)),l.move=this._onMove),this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},createTile:function(){return document.createElement("div")},getTileSize:function(){var l=this.options.tileSize;return l instanceof I?l:new I(l,l)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(l){for(var h=this.getPane().children,y=-l(-1/0,1/0),k=0,T=h.length,H;k<T;k++)H=h[k].style.zIndex,h[k]!==this._container&&H&&(y=l(y,+H));isFinite(y)&&(this.options.zIndex=y+l(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!at.ielt9){br(this._container,this.options.opacity);var l=+new Date,h=!1,y=!1;for(var k in this._tiles){var T=this._tiles[k];if(!(!T.current||!T.loaded)){var H=Math.min(1,(l-T.loaded)/200);br(T.el,H),H<1?h=!0:(T.active?y=!0:this._onOpaqueTile(T),T.active=!0)}}y&&!this._noPrune&&this._pruneTiles(),h&&(B(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this))}},_onOpaqueTile:f,_initContainer:function(){this._container||(this._container=Xt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var l=this._tileZoom,h=this.options.maxZoom;if(l!==void 0){for(var y in this._levels)y=Number(y),this._levels[y].el.children.length||y===l?(this._levels[y].el.style.zIndex=h-Math.abs(l-y),this._onUpdateLevel(y)):(jn(this._levels[y].el),this._removeTilesAtZoom(y),this._onRemoveLevel(y),delete this._levels[y]);var k=this._levels[l],T=this._map;return k||(k=this._levels[l]={},k.el=Xt("div","leaflet-tile-container leaflet-zoom-animated",this._container),k.el.style.zIndex=h,k.origin=T.project(T.unproject(T.getPixelOrigin()),l).round(),k.zoom=l,this._setZoomTransform(k,T.getCenter(),T.getZoom()),f(k.el.offsetWidth),this._onCreateLevel(k)),this._level=k,k}},_onUpdateLevel:f,_onRemoveLevel:f,_onCreateLevel:f,_pruneTiles:function(){if(this._map){var l,h,y=this._map.getZoom();if(y>this.options.maxZoom||y<this.options.minZoom){this._removeAllTiles();return}for(l in this._tiles)h=this._tiles[l],h.retain=h.current;for(l in this._tiles)if(h=this._tiles[l],h.current&&!h.active){var k=h.coords;this._retainParent(k.x,k.y,k.z,k.z-5)||this._retainChildren(k.x,k.y,k.z,k.z+2)}for(l in this._tiles)this._tiles[l].retain||this._removeTile(l)}},_removeTilesAtZoom:function(l){for(var h in this._tiles)this._tiles[h].coords.z===l&&this._removeTile(h)},_removeAllTiles:function(){for(var l in this._tiles)this._removeTile(l)},_invalidateAll:function(){for(var l in this._levels)jn(this._levels[l].el),this._onRemoveLevel(Number(l)),delete this._levels[l];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(l,h,y,k){var T=Math.floor(l/2),H=Math.floor(h/2),ie=y-1,fe=new I(+T,+H);fe.z=+ie;var ve=this._tileCoordsToKey(fe),ke=this._tiles[ve];return ke&&ke.active?(ke.retain=!0,!0):(ke&&ke.loaded&&(ke.retain=!0),ie>k?this._retainParent(T,H,ie,k):!1)},_retainChildren:function(l,h,y,k){for(var T=2*l;T<2*l+2;T++)for(var H=2*h;H<2*h+2;H++){var ie=new I(T,H);ie.z=y+1;var fe=this._tileCoordsToKey(ie),ve=this._tiles[fe];if(ve&&ve.active){ve.retain=!0;continue}else ve&&ve.loaded&&(ve.retain=!0);y+1<k&&this._retainChildren(T,H,y+1,k)}},_resetView:function(l){var h=l&&(l.pinch||l.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h)},_animateZoom:function(l){this._setView(l.center,l.zoom,!0,l.noUpdate)},_clampZoom:function(l){var h=this.options;return h.minNativeZoom!==void 0&&l<h.minNativeZoom?h.minNativeZoom:h.maxNativeZoom!==void 0&&h.maxNativeZoom<l?h.maxNativeZoom:l},_setView:function(l,h,y,k){var T=Math.round(h);this.options.maxZoom!==void 0&&T>this.options.maxZoom||this.options.minZoom!==void 0&&T<this.options.minZoom?T=void 0:T=this._clampZoom(T);var H=this.options.updateWhenZooming&&T!==this._tileZoom;(!k||H)&&(this._tileZoom=T,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),T!==void 0&&this._update(l),y||this._pruneTiles(),this._noPrune=!!y),this._setZoomTransforms(l,h)},_setZoomTransforms:function(l,h){for(var y in this._levels)this._setZoomTransform(this._levels[y],l,h)},_setZoomTransform:function(l,h,y){var k=this._map.getZoomScale(y,l.zoom),T=l.origin.multiplyBy(k).subtract(this._map._getNewPixelOrigin(h,y)).round();at.any3d?Vo(l.el,T,k):Rn(l.el,T)},_resetGrid:function(){var l=this._map,h=l.options.crs,y=this._tileSize=this.getTileSize(),k=this._tileZoom,T=this._map.getPixelWorldBounds(this._tileZoom);T&&(this._globalTileRange=this._pxBoundsToTileRange(T)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(l.project([0,h.wrapLng[0]],k).x/y.x),Math.ceil(l.project([0,h.wrapLng[1]],k).x/y.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(l.project([h.wrapLat[0],0],k).y/y.x),Math.ceil(l.project([h.wrapLat[1],0],k).y/y.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(l){var h=this._map,y=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),k=h.getZoomScale(y,this._tileZoom),T=h.project(l,this._tileZoom).floor(),H=h.getSize().divideBy(k*2);return new F(T.subtract(H),T.add(H))},_update:function(l){var h=this._map;if(h){var y=this._clampZoom(h.getZoom());if(l===void 0&&(l=h.getCenter()),this._tileZoom!==void 0){var k=this._getTiledPixelBounds(l),T=this._pxBoundsToTileRange(k),H=T.getCenter(),ie=[],fe=this.options.keepBuffer,ve=new F(T.getBottomLeft().subtract([fe,-fe]),T.getTopRight().add([fe,-fe]));if(!(isFinite(T.min.x)&&isFinite(T.min.y)&&isFinite(T.max.x)&&isFinite(T.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ke in this._tiles){var Ve=this._tiles[ke].coords;(Ve.z!==this._tileZoom||!ve.contains(new I(Ve.x,Ve.y)))&&(this._tiles[ke].current=!1)}if(Math.abs(y-this._tileZoom)>1){this._setView(l,y);return}for(var _t=T.min.y;_t<=T.max.y;_t++)for(var Bt=T.min.x;Bt<=T.max.x;Bt++){var Cs=new I(Bt,_t);if(Cs.z=this._tileZoom,!!this._isValidTile(Cs)){var Qn=this._tiles[this._tileCoordsToKey(Cs)];Qn?Qn.current=!0:ie.push(Cs)}}if(ie.sort(function(zs,lc){return zs.distanceTo(H)-lc.distanceTo(H)}),ie.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Nr=document.createDocumentFragment();for(Bt=0;Bt<ie.length;Bt++)this._addTile(ie[Bt],Nr);this._level.el.appendChild(Nr)}}}},_isValidTile:function(l){var h=this._map.options.crs;if(!h.infinite){var y=this._globalTileRange;if(!h.wrapLng&&(l.x<y.min.x||l.x>y.max.x)||!h.wrapLat&&(l.y<y.min.y||l.y>y.max.y))return!1}if(!this.options.bounds)return!0;var k=this._tileCoordsToBounds(l);return U(this.options.bounds).overlaps(k)},_keyToBounds:function(l){return this._tileCoordsToBounds(this._keyToTileCoords(l))},_tileCoordsToNwSe:function(l){var h=this._map,y=this.getTileSize(),k=l.scaleBy(y),T=k.add(y),H=h.unproject(k,l.z),ie=h.unproject(T,l.z);return[H,ie]},_tileCoordsToBounds:function(l){var h=this._tileCoordsToNwSe(l),y=new K(h[0],h[1]);return this.options.noWrap||(y=this._map.wrapLatLngBounds(y)),y},_tileCoordsToKey:function(l){return l.x+":"+l.y+":"+l.z},_keyToTileCoords:function(l){var h=l.split(":"),y=new I(+h[0],+h[1]);return y.z=+h[2],y},_removeTile:function(l){var h=this._tiles[l];h&&(jn(h.el),delete this._tiles[l],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(l)}))},_initTile:function(l){It(l,"leaflet-tile");var h=this.getTileSize();l.style.width=h.x+"px",l.style.height=h.y+"px",l.onselectstart=f,l.onmousemove=f,at.ielt9&&this.options.opacity<1&&br(l,this.options.opacity)},_addTile:function(l,h){var y=this._getTilePos(l),k=this._tileCoordsToKey(l),T=this.createTile(this._wrapCoords(l),o(this._tileReady,this,l));this._initTile(T),this.createTile.length<2&&D(o(this._tileReady,this,l,null,T)),Rn(T,y),this._tiles[k]={el:T,coords:l,current:!0},h.appendChild(T),this.fire("tileloadstart",{tile:T,coords:l})},_tileReady:function(l,h,y){h&&this.fire("tileerror",{error:h,tile:y,coords:l});var k=this._tileCoordsToKey(l);y=this._tiles[k],y&&(y.loaded=+new Date,this._map._fadeAnimated?(br(y.el,0),B(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this)):(y.active=!0,this._pruneTiles()),h||(It(y.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:y.el,coords:l})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),at.ielt9||!this._map._fadeAnimated?D(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(l){return l.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(l){var h=new I(this._wrapX?m(l.x,this._wrapX):l.x,this._wrapY?m(l.y,this._wrapY):l.y);return h.z=l.z,h},_pxBoundsToTileRange:function(l){var h=this.getTileSize();return new F(l.min.unscaleBy(h).floor(),l.max.unscaleBy(h).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var l in this._tiles)if(!this._tiles[l].loaded)return!1;return!0}});function c6(l){return new cu(l)}var oc=cu.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(l,h){this._url=l,h=v(this,h),h.detectRetina&&at.retina&&h.maxZoom>0?(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom=Math.min(h.maxZoom,h.minZoom+1)):(h.zoomOffset++,h.maxZoom=Math.max(h.minZoom,h.maxZoom-1)),h.minZoom=Math.max(0,h.minZoom)):h.zoomReverse?h.minZoom=Math.min(h.maxZoom,h.minZoom):h.maxZoom=Math.max(h.minZoom,h.maxZoom),typeof h.subdomains=="string"&&(h.subdomains=h.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(l,h){return this._url===l&&h===void 0&&(h=!0),this._url=l,h||this.redraw(),this},createTile:function(l,h){var y=document.createElement("img");return At(y,"load",o(this._tileOnLoad,this,h,y)),At(y,"error",o(this._tileOnError,this,h,y)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(y.referrerPolicy=this.options.referrerPolicy),y.alt="",y.src=this.getTileUrl(l),y},getTileUrl:function(l){var h={r:at.retina?"@2x":"",s:this._getSubdomain(l),x:l.x,y:l.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var y=this._globalTileRange.max.y-l.y;this.options.tms&&(h.y=y),h["-y"]=y}return w(this._url,a(h,this.options))},_tileOnLoad:function(l,h){at.ielt9?setTimeout(o(l,this,null,h),0):l(null,h)},_tileOnError:function(l,h,y){var k=this.options.errorTileUrl;k&&h.getAttribute("src")!==k&&(h.src=k),l(y,h)},_onTileRemove:function(l){l.tile.onload=null},_getZoomForUrl:function(){var l=this._tileZoom,h=this.options.maxZoom,y=this.options.zoomReverse,k=this.options.zoomOffset;return y&&(l=h-l),l+k},_getSubdomain:function(l){var h=Math.abs(l.x+l.y)%this.options.subdomains.length;return this.options.subdomains[h]},_abortLoading:function(){var l,h;for(l in this._tiles)if(this._tiles[l].coords.z!==this._tileZoom&&(h=this._tiles[l].el,h.onload=f,h.onerror=f,!h.complete)){h.src=C;var y=this._tiles[l].coords;jn(h),delete this._tiles[l],this.fire("tileabort",{tile:h,coords:y})}},_removeTile:function(l){var h=this._tiles[l];if(h)return h.el.setAttribute("src",C),cu.prototype._removeTile.call(this,l)},_tileReady:function(l,h,y){if(!(!this._map||y&&y.getAttribute("src")===C))return cu.prototype._tileReady.call(this,l,h,y)}});function EN(l,h){return new oc(l,h)}var AN=oc.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(l,h){this._url=l;var y=a({},this.defaultWmsParams);for(var k in h)k in this.options||(y[k]=h[k]);h=v(this,h);var T=h.detectRetina&&at.retina?2:1,H=this.getTileSize();y.width=H.x*T,y.height=H.y*T,this.wmsParams=y},onAdd:function(l){this._crs=this.options.crs||l.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var h=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[h]=this._crs.code,oc.prototype.onAdd.call(this,l)},getTileUrl:function(l){var h=this._tileCoordsToNwSe(l),y=this._crs,k=O(y.project(h[0]),y.project(h[1])),T=k.min,H=k.max,ie=(this._wmsVersion>=1.3&&this._crs===wN?[T.y,T.x,H.y,H.x]:[T.x,T.y,H.x,H.y]).join(","),fe=oc.prototype.getTileUrl.call(this,l);return fe+_(this.wmsParams,fe,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ie},setParams:function(l,h){return a(this.wmsParams,l),h||this.redraw(),this}});function d6(l,h){return new AN(l,h)}oc.WMS=AN,EN.wms=d6;var ei=$r.extend({options:{padding:.1},initialize:function(l){v(this,l),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),It(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var l={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(l.zoomanim=this._onAnimZoom),l},_onAnimZoom:function(l){this._updateTransform(l.center,l.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(l,h){var y=this._map.getZoomScale(h,this._zoom),k=this._map.getSize().multiplyBy(.5+this.options.padding),T=this._map.project(this._center,h),H=k.multiplyBy(-y).add(T).subtract(this._map._getNewPixelOrigin(l,h));at.any3d?Vo(this._container,H,y):Rn(this._container,H)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var l in this._layers)this._layers[l]._reset()},_onZoomEnd:function(){for(var l in this._layers)this._layers[l]._project()},_updatePaths:function(){for(var l in this._layers)this._layers[l]._update()},_update:function(){var l=this.options.padding,h=this._map.getSize(),y=this._map.containerPointToLayerPoint(h.multiplyBy(-l)).round();this._bounds=new F(y,y.add(h.multiplyBy(1+l*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),PN=ei.extend({options:{tolerance:0},getEvents:function(){var l=ei.prototype.getEvents.call(this);return l.viewprereset=this._onViewPreReset,l},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ei.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var l=this._container=document.createElement("canvas");At(l,"mousemove",this._onMouseMove,this),At(l,"click dblclick mousedown mouseup contextmenu",this._onClick,this),At(l,"mouseout",this._handleMouseOut,this),l._leaflet_disable_events=!0,this._ctx=l.getContext("2d")},_destroyContainer:function(){B(this._redrawRequest),delete this._ctx,jn(this._container),un(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var l;this._redrawBounds=null;for(var h in this._layers)l=this._layers[h],l._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ei.prototype._update.call(this);var l=this._bounds,h=this._container,y=l.getSize(),k=at.retina?2:1;Rn(h,l.min),h.width=k*y.x,h.height=k*y.y,h.style.width=y.x+"px",h.style.height=y.y+"px",at.retina&&this._ctx.scale(2,2),this._ctx.translate(-l.min.x,-l.min.y),this.fire("update")}},_reset:function(){ei.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(l){this._updateDashArray(l),this._layers[d(l)]=l;var h=l._order={layer:l,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(l){this._requestRedraw(l)},_removePath:function(l){var h=l._order,y=h.next,k=h.prev;y?y.prev=k:this._drawLast=k,k?k.next=y:this._drawFirst=y,delete l._order,delete this._layers[d(l)],this._requestRedraw(l)},_updatePath:function(l){this._extendRedrawBounds(l),l._project(),l._update(),this._requestRedraw(l)},_updateStyle:function(l){this._updateDashArray(l),this._requestRedraw(l)},_updateDashArray:function(l){if(typeof l.options.dashArray=="string"){var h=l.options.dashArray.split(/[, ]+/),y=[],k,T;for(T=0;T<h.length;T++){if(k=Number(h[T]),isNaN(k))return;y.push(k)}l.options._dashArray=y}else l.options._dashArray=l.options.dashArray},_requestRedraw:function(l){this._map&&(this._extendRedrawBounds(l),this._redrawRequest=this._redrawRequest||D(this._redraw,this))},_extendRedrawBounds:function(l){if(l._pxBounds){var h=(l.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new F,this._redrawBounds.extend(l._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(l._pxBounds.max.add([h,h]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var l=this._redrawBounds;if(l){var h=l.getSize();this._ctx.clearRect(l.min.x,l.min.y,h.x,h.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var l,h=this._redrawBounds;if(this._ctx.save(),h){var y=h.getSize();this._ctx.beginPath(),this._ctx.rect(h.min.x,h.min.y,y.x,y.y),this._ctx.clip()}this._drawing=!0;for(var k=this._drawFirst;k;k=k.next)l=k.layer,(!h||l._pxBounds&&l._pxBounds.intersects(h))&&l._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(l,h){if(this._drawing){var y,k,T,H,ie=l._parts,fe=ie.length,ve=this._ctx;if(fe){for(ve.beginPath(),y=0;y<fe;y++){for(k=0,T=ie[y].length;k<T;k++)H=ie[y][k],ve[k?"lineTo":"moveTo"](H.x,H.y);h&&ve.closePath()}this._fillStroke(ve,l)}}},_updateCircle:function(l){if(!(!this._drawing||l._empty())){var h=l._point,y=this._ctx,k=Math.max(Math.round(l._radius),1),T=(Math.max(Math.round(l._radiusY),1)||k)/k;T!==1&&(y.save(),y.scale(1,T)),y.beginPath(),y.arc(h.x,h.y/T,k,0,Math.PI*2,!1),T!==1&&y.restore(),this._fillStroke(y,l)}},_fillStroke:function(l,h){var y=h.options;y.fill&&(l.globalAlpha=y.fillOpacity,l.fillStyle=y.fillColor||y.color,l.fill(y.fillRule||"evenodd")),y.stroke&&y.weight!==0&&(l.setLineDash&&l.setLineDash(h.options&&h.options._dashArray||[]),l.globalAlpha=y.opacity,l.lineWidth=y.weight,l.strokeStyle=y.color,l.lineCap=y.lineCap,l.lineJoin=y.lineJoin,l.stroke())},_onClick:function(l){for(var h=this._map.mouseEventToLayerPoint(l),y,k,T=this._drawFirst;T;T=T.next)y=T.layer,y.options.interactive&&y._containsPoint(h)&&(!(l.type==="click"||l.type==="preclick")||!this._map._draggableMoved(y))&&(k=y);this._fireEvent(k?[k]:!1,l)},_onMouseMove:function(l){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var h=this._map.mouseEventToLayerPoint(l);this._handleMouseHover(l,h)}},_handleMouseOut:function(l){var h=this._hoveredLayer;h&&(Pn(this._container,"leaflet-interactive"),this._fireEvent([h],l,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(l,h){if(!this._mouseHoverThrottled){for(var y,k,T=this._drawFirst;T;T=T.next)y=T.layer,y.options.interactive&&y._containsPoint(h)&&(k=y);k!==this._hoveredLayer&&(this._handleMouseOut(l),k&&(It(this._container,"leaflet-interactive"),this._fireEvent([k],l,"mouseover"),this._hoveredLayer=k)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,l),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(l,h,y){this._map._fireDOMEvent(h,y||h.type,l)},_bringToFront:function(l){var h=l._order;if(h){var y=h.next,k=h.prev;if(y)y.prev=k;else return;k?k.next=y:y&&(this._drawFirst=y),h.prev=this._drawLast,this._drawLast.next=h,h.next=null,this._drawLast=h,this._requestRedraw(l)}},_bringToBack:function(l){var h=l._order;if(h){var y=h.next,k=h.prev;if(k)k.next=y;else return;y?y.prev=k:k&&(this._drawLast=k),h.prev=null,h.next=this._drawFirst,this._drawFirst.prev=h,this._drawFirst=h,this._requestRedraw(l)}}});function DN(l){return at.canvas?new PN(l):null}var du=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(l){return document.createElement("<lvml:"+l+' class="lvml">')}}catch{}return function(l){return document.createElement("<"+l+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),u6={_initContainer:function(){this._container=Xt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ei.prototype._update.call(this),this.fire("update"))},_initPath:function(l){var h=l._container=du("shape");It(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",l._path=du("path"),h.appendChild(l._path),this._updateStyle(l),this._layers[d(l)]=l},_addPath:function(l){var h=l._container;this._container.appendChild(h),l.options.interactive&&l.addInteractiveTarget(h)},_removePath:function(l){var h=l._container;jn(h),l.removeInteractiveTarget(h),delete this._layers[d(l)]},_updateStyle:function(l){var h=l._stroke,y=l._fill,k=l.options,T=l._container;T.stroked=!!k.stroke,T.filled=!!k.fill,k.stroke?(h||(h=l._stroke=du("stroke")),T.appendChild(h),h.weight=k.weight+"px",h.color=k.color,h.opacity=k.opacity,k.dashArray?h.dashStyle=N(k.dashArray)?k.dashArray.join(" "):k.dashArray.replace(/( *, *)/g," "):h.dashStyle="",h.endcap=k.lineCap.replace("butt","flat"),h.joinstyle=k.lineJoin):h&&(T.removeChild(h),l._stroke=null),k.fill?(y||(y=l._fill=du("fill")),T.appendChild(y),y.color=k.fillColor||k.color,y.opacity=k.fillOpacity):y&&(T.removeChild(y),l._fill=null)},_updateCircle:function(l){var h=l._point.round(),y=Math.round(l._radius),k=Math.round(l._radiusY||y);this._setPath(l,l._empty()?"M0 0":"AL "+h.x+","+h.y+" "+y+","+k+" 0,"+65535*360)},_setPath:function(l,h){l._path.v=h},_bringToFront:function(l){tc(l._container)},_bringToBack:function(l){nc(l._container)}},sm=at.vml?du:se,uu=ei.extend({_initContainer:function(){this._container=sm("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=sm("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){jn(this._container),un(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ei.prototype._update.call(this);var l=this._bounds,h=l.getSize(),y=this._container;(!this._svgSize||!this._svgSize.equals(h))&&(this._svgSize=h,y.setAttribute("width",h.x),y.setAttribute("height",h.y)),Rn(y,l.min),y.setAttribute("viewBox",[l.min.x,l.min.y,h.x,h.y].join(" ")),this.fire("update")}},_initPath:function(l){var h=l._path=sm("path");l.options.className&&It(h,l.options.className),l.options.interactive&&It(h,"leaflet-interactive"),this._updateStyle(l),this._layers[d(l)]=l},_addPath:function(l){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(l._path),l.addInteractiveTarget(l._path)},_removePath:function(l){jn(l._path),l.removeInteractiveTarget(l._path),delete this._layers[d(l)]},_updatePath:function(l){l._project(),l._update()},_updateStyle:function(l){var h=l._path,y=l.options;h&&(y.stroke?(h.setAttribute("stroke",y.color),h.setAttribute("stroke-opacity",y.opacity),h.setAttribute("stroke-width",y.weight),h.setAttribute("stroke-linecap",y.lineCap),h.setAttribute("stroke-linejoin",y.lineJoin),y.dashArray?h.setAttribute("stroke-dasharray",y.dashArray):h.removeAttribute("stroke-dasharray"),y.dashOffset?h.setAttribute("stroke-dashoffset",y.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),y.fill?(h.setAttribute("fill",y.fillColor||y.color),h.setAttribute("fill-opacity",y.fillOpacity),h.setAttribute("fill-rule",y.fillRule||"evenodd")):h.setAttribute("fill","none"))},_updatePoly:function(l,h){this._setPath(l,we(l._parts,h))},_updateCircle:function(l){var h=l._point,y=Math.max(Math.round(l._radius),1),k=Math.max(Math.round(l._radiusY),1)||y,T="a"+y+","+k+" 0 1,0 ",H=l._empty()?"M0 0":"M"+(h.x-y)+","+h.y+T+y*2+",0 "+T+-y*2+",0 ";this._setPath(l,H)},_setPath:function(l,h){l._path.setAttribute("d",h)},_bringToFront:function(l){tc(l._path)},_bringToBack:function(l){nc(l._path)}});at.vml&&uu.include(u6);function TN(l){return at.svg||at.vml?new uu(l):null}Gt.include({getRenderer:function(l){var h=l.options.renderer||this._getPaneRenderer(l.options.pane)||this.options.renderer||this._renderer;return h||(h=this._renderer=this._createRenderer()),this.hasLayer(h)||this.addLayer(h),h},_getPaneRenderer:function(l){if(l==="overlayPane"||l===void 0)return!1;var h=this._paneRenderers[l];return h===void 0&&(h=this._createRenderer({pane:l}),this._paneRenderers[l]=h),h},_createRenderer:function(l){return this.options.preferCanvas&&DN(l)||TN(l)}});var MN=ac.extend({initialize:function(l,h){ac.prototype.initialize.call(this,this._boundsToLatLngs(l),h)},setBounds:function(l){return this.setLatLngs(this._boundsToLatLngs(l))},_boundsToLatLngs:function(l){return l=U(l),[l.getSouthWest(),l.getNorthWest(),l.getNorthEast(),l.getSouthEast()]}});function h6(l,h){return new MN(l,h)}uu.create=sm,uu.pointsToPath=we,Ja.geometryToLayer=Qf,Ja.coordsToLatLng=Sx,Ja.coordsToLatLngs=Yf,Ja.latLngToCoords=kx,Ja.latLngsToCoords=Xf,Ja.getFeature=ic,Ja.asFeature=Jf,Gt.mergeOptions({boxZoom:!0});var RN=va.extend({initialize:function(l){this._map=l,this._container=l._container,this._pane=l._panes.overlayPane,this._resetStateTimeout=0,l.on("unload",this._destroy,this)},addHooks:function(){At(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){un(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){jn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(l){if(!l.shiftKey||l.which!==1&&l.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),nu(),lx(),this._startPoint=this._map.mouseEventToContainerPoint(l),At(document,{contextmenu:Go,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(l){this._moved||(this._moved=!0,this._box=Xt("div","leaflet-zoom-box",this._container),It(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(l);var h=new F(this._point,this._startPoint),y=h.getSize();Rn(this._box,h.min),this._box.style.width=y.x+"px",this._box.style.height=y.y+"px"},_finish:function(){this._moved&&(jn(this._box),Pn(this._container,"leaflet-crosshair")),su(),cx(),un(document,{contextmenu:Go,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(l){if(!(l.which!==1&&l.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var h=new K(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h})}},_onKeyDown:function(l){l.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Gt.addInitHook("addHandler","boxZoom",RN),Gt.mergeOptions({doubleClickZoom:!0});var IN=va.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(l){var h=this._map,y=h.getZoom(),k=h.options.zoomDelta,T=l.originalEvent.shiftKey?y-k:y+k;h.options.doubleClickZoom==="center"?h.setZoom(T):h.setZoomAround(l.containerPoint,T)}});Gt.addInitHook("addHandler","doubleClickZoom",IN),Gt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ON=va.extend({addHooks:function(){if(!this._draggable){var l=this._map;this._draggable=new Mi(l._mapPane,l._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),l.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),l.on("zoomend",this._onZoomEnd,this),l.whenReady(this._onZoomEnd,this))}It(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Pn(this._map._container,"leaflet-grab"),Pn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var l=this._map;if(l._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var h=U(this._map.options.maxBounds);this._offsetLimit=O(this._map.latLngToContainerPoint(h.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(h.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;l.fire("movestart").fire("dragstart"),l.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(l){if(this._map.options.inertia){var h=this._lastTime=+new Date,y=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(y),this._times.push(h),this._prunePositions(h)}this._map.fire("move",l).fire("drag",l)},_prunePositions:function(l){for(;this._positions.length>1&&l-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var l=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(l).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(l,h){return l-(l-h)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var l=this._draggable._newPos.subtract(this._draggable._startPos),h=this._offsetLimit;l.x<h.min.x&&(l.x=this._viscousLimit(l.x,h.min.x)),l.y<h.min.y&&(l.y=this._viscousLimit(l.y,h.min.y)),l.x>h.max.x&&(l.x=this._viscousLimit(l.x,h.max.x)),l.y>h.max.y&&(l.y=this._viscousLimit(l.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(l)}},_onPreDragWrap:function(){var l=this._worldWidth,h=Math.round(l/2),y=this._initialWorldOffset,k=this._draggable._newPos.x,T=(k-h+y)%l+h-y,H=(k+h+y)%l-h-y,ie=Math.abs(T+y)<Math.abs(H+y)?T:H;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ie},_onDragEnd:function(l){var h=this._map,y=h.options,k=!y.inertia||l.noInertia||this._times.length<2;if(h.fire("dragend",l),k)h.fire("moveend");else{this._prunePositions(+new Date);var T=this._lastPos.subtract(this._positions[0]),H=(this._lastTime-this._times[0])/1e3,ie=y.easeLinearity,fe=T.multiplyBy(ie/H),ve=fe.distanceTo([0,0]),ke=Math.min(y.inertiaMaxSpeed,ve),Ve=fe.multiplyBy(ke/ve),_t=ke/(y.inertiaDeceleration*ie),Bt=Ve.multiplyBy(-_t/2).round();!Bt.x&&!Bt.y?h.fire("moveend"):(Bt=h._limitOffset(Bt,h.options.maxBounds),D(function(){h.panBy(Bt,{duration:_t,easeLinearity:ie,noMoveStart:!0,animate:!0})}))}}});Gt.addInitHook("addHandler","dragging",ON),Gt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var LN=va.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(l){this._map=l,this._setPanDelta(l.options.keyboardPanDelta),this._setZoomDelta(l.options.zoomDelta)},addHooks:function(){var l=this._map._container;l.tabIndex<=0&&(l.tabIndex="0"),At(l,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),un(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var l=document.body,h=document.documentElement,y=l.scrollTop||h.scrollTop,k=l.scrollLeft||h.scrollLeft;this._map._container.focus(),window.scrollTo(k,y)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(l){var h=this._panKeys={},y=this.keyCodes,k,T;for(k=0,T=y.left.length;k<T;k++)h[y.left[k]]=[-1*l,0];for(k=0,T=y.right.length;k<T;k++)h[y.right[k]]=[l,0];for(k=0,T=y.down.length;k<T;k++)h[y.down[k]]=[0,l];for(k=0,T=y.up.length;k<T;k++)h[y.up[k]]=[0,-1*l]},_setZoomDelta:function(l){var h=this._zoomKeys={},y=this.keyCodes,k,T;for(k=0,T=y.zoomIn.length;k<T;k++)h[y.zoomIn[k]]=l;for(k=0,T=y.zoomOut.length;k<T;k++)h[y.zoomOut[k]]=-l},_addHooks:function(){At(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){un(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(l){if(!(l.altKey||l.ctrlKey||l.metaKey)){var h=l.keyCode,y=this._map,k;if(h in this._panKeys){if(!y._panAnim||!y._panAnim._inProgress)if(k=this._panKeys[h],l.shiftKey&&(k=$(k).multiplyBy(3)),y.options.maxBounds&&(k=y._limitOffset($(k),y.options.maxBounds)),y.options.worldCopyJump){var T=y.wrapLatLng(y.unproject(y.project(y.getCenter()).add(k)));y.panTo(T)}else y.panBy(k)}else if(h in this._zoomKeys)y.setZoom(y.getZoom()+(l.shiftKey?3:1)*this._zoomKeys[h]);else if(h===27&&y._popup&&y._popup.options.closeOnEscapeKey)y.closePopup();else return;Go(l)}}});Gt.addInitHook("addHandler","keyboard",LN),Gt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var FN=va.extend({addHooks:function(){At(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){un(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(l){var h=lN(l),y=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(l),this._startTime||(this._startTime=+new Date);var k=Math.max(y-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),k),Go(l)},_performZoom:function(){var l=this._map,h=l.getZoom(),y=this._map.options.zoomSnap||0;l._stop();var k=this._delta/(this._map.options.wheelPxPerZoomLevel*4),T=4*Math.log(2/(1+Math.exp(-Math.abs(k))))/Math.LN2,H=y?Math.ceil(T/y)*y:T,ie=l._limitZoom(h+(this._delta>0?H:-H))-h;this._delta=0,this._startTime=null,ie&&(l.options.scrollWheelZoom==="center"?l.setZoom(h+ie):l.setZoomAround(this._lastMousePos,h+ie))}});Gt.addInitHook("addHandler","scrollWheelZoom",FN);var f6=600;Gt.mergeOptions({tapHold:at.touchNative&&at.safari&&at.mobile,tapTolerance:15});var BN=va.extend({addHooks:function(){At(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){un(this._map._container,"touchstart",this._onDown,this)},_onDown:function(l){if(clearTimeout(this._holdTimeout),l.touches.length===1){var h=l.touches[0];this._startPos=this._newPos=new I(h.clientX,h.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(At(document,"touchend",as),At(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",h))},this),f6),At(document,"touchend touchcancel contextmenu",this._cancel,this),At(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function l(){un(document,"touchend",as),un(document,"touchend touchcancel",l)},_cancel:function(){clearTimeout(this._holdTimeout),un(document,"touchend touchcancel contextmenu",this._cancel,this),un(document,"touchmove",this._onMove,this)},_onMove:function(l){var h=l.touches[0];this._newPos=new I(h.clientX,h.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(l,h){var y=new MouseEvent(l,{bubbles:!0,cancelable:!0,view:window,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY});y._simulated=!0,h.target.dispatchEvent(y)}});Gt.addInitHook("addHandler","tapHold",BN),Gt.mergeOptions({touchZoom:at.touch,bounceAtZoomLimits:!0});var zN=va.extend({addHooks:function(){It(this._map._container,"leaflet-touch-zoom"),At(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Pn(this._map._container,"leaflet-touch-zoom"),un(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(l){var h=this._map;if(!(!l.touches||l.touches.length!==2||h._animatingZoom||this._zooming)){var y=h.mouseEventToContainerPoint(l.touches[0]),k=h.mouseEventToContainerPoint(l.touches[1]);this._centerPoint=h.getSize()._divideBy(2),this._startLatLng=h.containerPointToLatLng(this._centerPoint),h.options.touchZoom!=="center"&&(this._pinchStartLatLng=h.containerPointToLatLng(y.add(k)._divideBy(2))),this._startDist=y.distanceTo(k),this._startZoom=h.getZoom(),this._moved=!1,this._zooming=!0,h._stop(),At(document,"touchmove",this._onTouchMove,this),At(document,"touchend touchcancel",this._onTouchEnd,this),as(l)}},_onTouchMove:function(l){if(!(!l.touches||l.touches.length!==2||!this._zooming)){var h=this._map,y=h.mouseEventToContainerPoint(l.touches[0]),k=h.mouseEventToContainerPoint(l.touches[1]),T=y.distanceTo(k)/this._startDist;if(this._zoom=h.getScaleZoom(T,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&T<1||this._zoom>h.getMaxZoom()&&T>1)&&(this._zoom=h._limitZoom(this._zoom)),h.options.touchZoom==="center"){if(this._center=this._startLatLng,T===1)return}else{var H=y._add(k)._divideBy(2)._subtract(this._centerPoint);if(T===1&&H.x===0&&H.y===0)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(H),this._zoom)}this._moved||(h._moveStart(!0,!1),this._moved=!0),B(this._animRequest);var ie=o(h._move,h,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=D(ie,this,!0),as(l)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,B(this._animRequest),un(document,"touchmove",this._onTouchMove,this),un(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Gt.addInitHook("addHandler","touchZoom",zN),Gt.BoxZoom=RN,Gt.DoubleClickZoom=IN,Gt.Drag=ON,Gt.Keyboard=LN,Gt.ScrollWheelZoom=FN,Gt.TapHold=BN,Gt.TouchZoom=zN,n.Bounds=F,n.Browser=at,n.CRS=q,n.Canvas=PN,n.Circle=Nx,n.CircleMarker=Gf,n.Class=X,n.Control=zr,n.DivIcon=CN,n.DivOverlay=ya,n.DomEvent=D5,n.DomUtil=A5,n.Draggable=Mi,n.Evented=G,n.FeatureGroup=Ya,n.GeoJSON=Ja,n.GridLayer=cu,n.Handler=va,n.Icon=rc,n.ImageOverlay=em,n.LatLng=te,n.LatLngBounds=K,n.Layer=$r,n.LayerGroup=sc,n.LineUtil=W5,n.Map=Gt,n.Marker=Zf,n.Mixin=F5,n.Path=Ri,n.Point=I,n.PolyUtil=B5,n.Polygon=ac,n.Polyline=Xa,n.Popup=tm,n.PosAnimation=cN,n.Projection=H5,n.Rectangle=MN,n.Renderer=ei,n.SVG=uu,n.SVGOverlay=kN,n.TileLayer=oc,n.Tooltip=nm,n.Transformation=re,n.Util=W,n.VideoOverlay=SN,n.bind=o,n.bounds=O,n.canvas=DN,n.circle=J5,n.circleMarker=X5,n.control=iu,n.divIcon=l6,n.extend=a,n.featureGroup=G5,n.geoJSON=NN,n.geoJson=n6,n.gridLayer=c6,n.icon=Q5,n.imageOverlay=s6,n.latLng=J,n.latLngBounds=U,n.layerGroup=Z5,n.map=T5,n.marker=Y5,n.point=$,n.polygon=t6,n.polyline=e6,n.popup=i6,n.rectangle=h6,n.setOptions=v,n.stamp=d,n.svg=TN,n.svgOverlay=a6,n.tileLayer=EN,n.tooltip=o6,n.transformation=me,n.version=r,n.videoOverlay=r6;var m6=window.L;n.noConflict=function(){return window.L=m6,this},window.L=n})})(eE,eE.exports);var Vw;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(Vw||(Vw={}));var tE;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(tE||(tE={}));const Cy=Yl("StatusBar"),$se=LR,Use=FR,qse=BR,zO=g.forwardRef(({className:t,...e},n)=>s.jsx($g,{className:Te("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));zO.displayName=$g.displayName;const Wse=Ld("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),$O=g.forwardRef(({side:t="right",className:e,children:n,...r},a)=>s.jsxs(qse,{children:[s.jsx(zO,{}),s.jsxs(Ug,{ref:a,className:Te(Wse({side:t}),e),...r,children:[n,s.jsxs(zR,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[s.jsx(Ln,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));$O.displayName=Ug.displayName;const UO=({className:t,...e})=>s.jsx("div",{className:Te("flex flex-col space-y-2 text-center sm:text-left",t),...e});UO.displayName="SheetHeader";const qO=g.forwardRef(({className:t,...e},n)=>s.jsx(qg,{ref:n,className:Te("text-lg font-semibold text-foreground",t),...e}));qO.displayName=qg.displayName;const WO=g.forwardRef(({className:t,...e},n)=>s.jsx(Wg,{ref:n,className:Te("text-sm text-muted-foreground",t),...e}));WO.displayName=Wg.displayName;const Ey=Yl("TimeTracking"),Ay=Yl("DeliveryNotes"),wc=Yl("OfflineSync"),il=class il{static getInstance(){return il.instance||(il.instance=new il),il.instance}async startTracking(e,n,r){try{return await Ey.startTimeTracking({projectId:e,projectName:n,description:r})}catch(a){throw console.error("Android time tracking start failed:",a),a}}async stopTracking(e){try{return await Ey.stopTimeTracking({notes:e})}catch(n){throw console.error("Android time tracking stop failed:",n),n}}async getActiveSession(){try{return await Ey.getActiveTimeTracking()}catch(e){throw console.error("Android get active session failed:",e),e}}};qn(il,"instance");let Kw=il;const ol=class ol{static getInstance(){return ol.instance||(ol.instance=new ol),ol.instance}async getPendingNotes(){try{return(await Ay.getPendingDeliveryNotes()).deliveryNotes}catch(e){throw console.error("Android get pending delivery notes failed:",e),e}}async signNote(e,n,r){try{return await Ay.signDeliveryNote({deliveryNoteId:e,signerName:n,signatureData:r})}catch(a){throw console.error("Android sign delivery note failed:",a),a}}async getPendingSignatures(){try{return(await Ay.getPendingSignatures()).pendingSignatures}catch(e){throw console.error("Android get pending signatures failed:",e),e}}};qn(ol,"instance");let L0=ol;const ll=class ll{static getInstance(){return ll.instance||(ll.instance=new ll),ll.instance}async addOfflineAction(e,n){try{return await wc.addOfflineAction({actionType:e,actionData:n})}catch(r){throw console.error("Android add offline action failed:",r),r}}async getNetworkStatus(){try{return await wc.getNetworkStatus()}catch(e){return console.error("Android get network status failed:",e),{connected:!1,connectionType:"none"}}}async getPendingActions(){try{return(await wc.getPendingActions()).pendingActions}catch(e){throw console.error("Android get pending actions failed:",e),e}}async markActionSynced(e){try{await wc.markActionSynced({actionId:e})}catch(n){throw console.error("Android mark action synced failed:",n),n}}async getQueueLength(){try{return(await wc.getQueueLength()).length}catch(e){return console.error("Android get queue length failed:",e),0}}async saveOfflineTimeEntry(e){try{return await wc.saveOfflineTimeEntry({timeEntry:e})}catch(n){throw console.error("Android save offline time entry failed:",n),n}}};qn(ll,"instance");let F0=ll;const Py=()=>window.Capacitor&&window.Capacitor.getPlatform()==="android",Ym=Kw.getInstance();L0.getInstance();F0.getInstance();const Hse=()=>{const t=L0.getInstance(),e=F0.getInstance();return{getPendingNotes:t.getPendingNotes.bind(t),signNote:t.signNote.bind(t),getPendingSignatures:t.getPendingSignatures.bind(t),addOfflineAction:e.addOfflineAction.bind(e)}},Vse=()=>{const[t,e]=g.useState({active:!1}),[n,r]=g.useState([]),[a,i]=g.useState(!1),o=T0.isNativePlatform(),c=g.useCallback(async()=>{if(!o){console.log("Not on native platform, using mock data"),e({active:!1});return}try{i(!0);const p=await Ym.getActiveTimeTracking();p!=null&&p.active&&(p!=null&&p.session)?e({active:!0,projectId:p.session.projectId,projectName:p.session.projectName,segmentType:"work",startTime:new Date(p.session.startTime).toISOString(),duration:p.session.durationMinutes,description:p.session.description}):e({active:!1})}catch(p){console.warn("Native time tracking check failed:",p),e({active:!1})}finally{i(!1)}},[o]),d=g.useCallback(async()=>{try{const p=localStorage.getItem("timeSegments");if(p){const x=JSON.parse(p);x.sort((j,v)=>new Date(v.started_at).getTime()-new Date(j.started_at).getTime()),r(x.slice(0,50))}else r([{id:"demo-1",employee_id:"user-1",project_id:"project-1",started_at:new Date(Date.now()-2*60*60*1e3).toISOString(),ended_at:new Date(Date.now()-1*60*60*1e3).toISOString(),duration_minutes_computed:60,segment_type:"work",status:"completed",description:"Installation Elektrik",project:{id:"project-1",name:"Baustelle Nord",customer:{name:"Mustermann GmbH"}}}])}catch(p){console.error("Error loading time segments:",p),r([])}},[]),u=g.useCallback(async(p,x="work",j,v)=>{if(!o)return Ue.error("Zeiterfassung nur auf mobilen Geräten verfügbar"),!1;try{i(!0);const _=await Ym.startTimeTracking(p,v||"Unbenanntes Projekt",j||"");if(_!=null&&_.success){Ue.success("Zeiterfassung gestartet"),e({active:!0,projectId:p,projectName:v,segmentType:x,startTime:new Date(_.startTime).toISOString(),duration:0,description:j});const w=[{id:`mobile-${Date.now()}`,employee_id:"current-user",project_id:p,started_at:new Date(_.startTime).toISOString(),segment_type:x,status:"active",description:j,project:{id:p,name:v||"Unbenanntes Projekt"}},...n];return r(w),localStorage.setItem("timeSegments",JSON.stringify(w)),!0}return!1}catch(_){return console.error("Error starting time tracking:",_),Ue.error("Fehler beim Starten der Zeiterfassung"),!1}finally{i(!1)}},[o,n]),m=g.useCallback(async p=>{if(!o)return Ue.error("Zeiterfassung nur auf mobilen Geräten verfügbar"),!1;try{i(!0);const x=await Ym.stopTimeTracking(p||"");if(x!=null&&x.success){Ue.success("Zeiterfassung beendet");const j=n.map(v=>v.status==="active"?{...v,ended_at:new Date(x.endTime).toISOString(),duration_minutes_computed:x.durationMinutes,status:"completed",notes:p}:v);return r(j),localStorage.setItem("timeSegments",JSON.stringify(j)),e({active:!1}),!0}return!1}catch(x){return console.error("Error stopping time tracking:",x),Ue.error("Fehler beim Beenden der Zeiterfassung"),!1}finally{i(!1)}},[o,n]),f=g.useCallback(async()=>{if(!o)return Ue.error("Zeiterfassung nur auf mobilen Geräten verfügbar"),!1;try{return await Ym.pauseTimeTracking(),Ue.info("Zeiterfassung pausiert"),!0}catch(p){return console.error("Error pausing time tracking:",p),Ue.error("Fehler beim Pausieren"),!1}},[o]);return g.useEffect(()=>{c(),d();const p=setInterval(c,3e4);return()=>clearInterval(p)},[c,d]),{activeTime:t,segments:n,isLoading:a,startTracking:u,stopTracking:m,pauseTracking:f,refreshData:()=>{c(),d()}}},HO=()=>{const[t,e]=g.useState([]),[n,r]=g.useState(!1),[a,i]=g.useState(!1),o=Py()?Hse():null,c=g.useCallback(async()=>{try{if(r(!0),Py()&&o)try{const f=(await o.getPendingNotes()).map(p=>({id:p.id,number:p.number,project_id:"android-project",customer_id:"android-customer",company_id:"android-company",status:p.status,delivery_date:new Date(p.createdAt).toISOString().split("T")[0],delivery_address:null,total_work_minutes:0,total_break_minutes:0,signature_data:null,signed_at:null,signed_by_name:null,pdf_url:null,pdf_generated_at:null,created_at:new Date(p.createdAt).toISOString(),updated_at:new Date(p.createdAt).toISOString(),project:{id:"android-project",name:p.projectName,customer:{id:"android-customer",name:p.customerName,email:null,phone:null}}}));e(f);return}catch(m){console.warn("Android delivery notes failed, falling back to web:",m)}try{const{data:m,error:f}=await Z.from("delivery_notes").select(`
            *,
            project:projects(
              id,
              name,
              customer:customers(id, name, email, phone)
            ),
            delivery_note_items(*),
            delivery_note_time_segments(
              time_segment:time_segments(started_at, ended_at, duration_minutes)
            )
          `).order("created_at",{ascending:!1});if(f&&!f.message.includes("relation")&&!f.message.includes("does not exist"))throw f;e(m||[])}catch(m){console.warn("Delivery notes tables not found, using mock data:",m.message),e([{id:"mock-1",number:"LS-2024-000001",project_id:"mock-project-1",customer_id:"mock-customer-1",company_id:"mock-company-1",status:"sent",delivery_date:new Date().toISOString().split("T")[0],delivery_address:null,total_work_minutes:480,total_break_minutes:60,signature_data:null,signed_at:null,signed_by_name:null,pdf_url:null,pdf_generated_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),project:{id:"mock-project-1",name:"Beispiel Baustelle",customer:{id:"mock-customer-1",name:"Max Mustermann GmbH",email:"max@example.com",phone:"+49 123 456789"}},delivery_note_items:[{id:"mock-item-1",delivery_note_id:"mock-1",item_type:"time",time_segment_id:"mock-time-1",material_id:null,description:"Arbeitszeit",quantity:8,unit:"Stunden",unit_price:45,total_price:360,sort_order:1}],delivery_note_time_segments:[{time_segment:{started_at:new Date(Date.now()-8*60*60*1e3).toISOString(),ended_at:new Date().toISOString(),duration_minutes:480}}]}])}}catch(m){console.error("Error in fetchDeliveryNotes:",m),e([])}finally{r(!1)}},[o]),d=g.useCallback(async(m,f,p)=>{try{if(Py()&&o)try{const x={paths:[],width:400,height:200},j=await o.signNote(m,p,x);if(j.success)return Ue.success("Lieferschein erfolgreich signiert (Android)"),await c(),j}catch(x){console.warn("Android delivery note signing failed, falling back to web:",x)}try{const{data:x,error:j}=await Z.rpc("rpc_sign_delivery_note",{p_delivery_note_id:m,p_signature_data:f,p_signer_name:p});if(j&&!j.message.includes("function")&&!j.message.includes("does not exist"))throw j;return Ue.success("Lieferschein erfolgreich signiert"),await c(),x}catch(x){if(x.message.includes("function")||x.message.includes("does not exist"))return console.warn("RPC function not found, using mock signing"),e(j=>j.map(v=>v.id===m?{...v,signature_data:f,signed_at:new Date().toISOString(),signed_by_name:p,status:"signed"}:v)),Ue.success("Lieferschein erfolgreich signiert (Demo-Modus)"),{id:m};throw x}}catch(x){throw console.error("Error signing delivery note:",x),Ue.error("Fehler beim Signieren des Lieferscheins"),x}},[c,o]),u=g.useCallback(async m=>{try{i(!0);const f={id:`mock-${Date.now()}`,number:`LS-${new Date().getFullYear()}-${Math.floor(Math.random()*1e3).toString().padStart(6,"0")}`,project_id:m.projectId,customer_id:m.customerId,company_id:"mock-company",status:"draft",delivery_date:m.deliveryDate||new Date().toISOString().split("T")[0],delivery_address:m.deliveryAddress,total_work_minutes:0,total_break_minutes:0,signature_data:null,signed_at:null,signed_by_name:null,pdf_url:null,pdf_generated_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return e(p=>[f,...p]),Ue.success("Lieferschein erstellt (Demo-Modus)"),f}catch(f){throw console.error("Error creating delivery note:",f),Ue.error("Fehler beim Erstellen des Lieferscheins"),f}finally{i(!1)}},[]);return{deliveryNotes:t,isLoading:n,isCreating:a,fetchDeliveryNotes:c,createDeliveryNote:u,signDeliveryNote:d}},Kse={isNativePlatform:()=>!1,getPlatform:()=>"web"},nE={setStyle:async t=>{console.log("StatusBar.setStyle (web mock):",t)},setBackgroundColor:async t=>{console.log("StatusBar.setBackgroundColor (web mock):",t)},show:async()=>{console.log("StatusBar.show (web mock)")},hide:async()=>{console.log("StatusBar.hide (web mock)")}},Zse={Dark:"DARK",Light:"LIGHT",Default:"DEFAULT"},sE={keepAwake:async()=>{console.log("KeepAwake.keepAwake (web mock)")},allowSleep:async()=>{console.log("KeepAwake.allowSleep (web mock)")}},Gse={impact:async t=>{console.log("Haptics.impact (web mock):",t)},vibrate:async t=>{console.log("Haptics.vibrate (web mock):",t)}},Xm={Heavy:"HEAVY",Medium:"MEDIUM",Light:"LIGHT"},Qse={getCurrentPosition:async t=>new Promise((e,n)=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(r=>{e({coords:{latitude:r.coords.latitude,longitude:r.coords.longitude,accuracy:r.coords.accuracy,altitude:r.coords.altitude,altitudeAccuracy:r.coords.altitudeAccuracy,heading:r.coords.heading,speed:r.coords.speed},timestamp:r.timestamp})},n,t):n(new Error("Geolocation not supported"))})},rE={getStatus:async()=>({connected:navigator.onLine,connectionType:navigator.onLine?"wifi":"none"}),addListener:(t,e)=>{if(t==="networkStatusChange"){const n=()=>e({connected:!0,connectionType:"wifi"}),r=()=>e({connected:!1,connectionType:"none"});return window.addEventListener("online",n),window.addEventListener("offline",r),{remove:()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}}return{remove:()=>{}}}},Dy={get:async t=>({value:localStorage.getItem(t.key)}),set:async t=>{localStorage.setItem(t.key,t.value)},remove:async t=>{localStorage.removeItem(t.key)},clear:async()=>{localStorage.clear()}},Yse={requestPermissions:async()=>({receive:"granted"}),register:async()=>{console.log("PushNotifications.register (web mock)")},addListener:(t,e)=>(console.log("PushNotifications.addListener (web mock):",t),{remove:()=>{}}),removeAllListeners:()=>{console.log("PushNotifications.removeAllListeners (web mock)")}},Xse={schedule:async t=>{console.log("LocalNotifications.schedule (web mock):",t)},cancel:async t=>{console.log("LocalNotifications.cancel (web mock):",t)}},VO=({isOpen:t,onClose:e,onSave:n,title:r="Lieferschein signieren",description:a="Bitte unterschreiben Sie zur Bestätigung des Erhalts der Leistungen",placeholder:i="Name des Unterzeichners",signerName:o,onSignerNameChange:c})=>{const d=g.useRef(null),[u,m]=g.useState(!1),[f,p]=g.useState(""),[x,j]=g.useState(!1),[v,_]=g.useState(!1),b=o!==void 0?o:f,w=c||p,[N,S]=g.useState([]),[C,A]=g.useState([]),P=400,M=200;g.useEffect(()=>{if(!t||!d.current)return;const G=d.current,I=G.getContext("2d");I&&(G.width=P,G.height=M,I.lineCap="round",I.lineJoin="round",I.strokeStyle="#1f2937",I.lineWidth=2,I.clearRect(0,0,P,M),I.fillStyle="#ffffff",I.fillRect(0,0,P,M),I.beginPath(),I.strokeStyle="#e5e7eb",I.lineWidth=1,I.setLineDash([5,5]),I.moveTo(20,M-30),I.lineTo(P-20,M-30),I.stroke(),I.setLineDash([]),I.font="12px system-ui",I.fillStyle="#6b7280",I.textAlign="center",I.fillText("Unterschrift",P/2,M-10),I.strokeStyle="#1f2937",I.lineWidth=2,C.forEach(V=>{V.length>1&&(I.beginPath(),I.moveTo(V[0].x,V[0].y),V.slice(1).forEach($=>{I.lineTo($.x,$.y)}),I.stroke())}))},[t,C]);const z=G=>{const V=d.current.getBoundingClientRect();let $,F;return"touches"in G?($=G.touches[0].clientX,F=G.touches[0].clientY):($=G.clientX,F=G.clientY),{x:($-V.left)*P/V.width,y:(F-V.top)*M/V.height}},R=G=>{G.preventDefault(),m(!0),_(!0);const I=z(G);S([I])},D=G=>{if(!u)return;G.preventDefault();const I=d.current,V=I==null?void 0:I.getContext("2d");if(!I||!V)return;const $=z(G),F=[...N,$];if(S(F),N.length>0){const O=N[N.length-1];V.beginPath(),V.moveTo(O.x,O.y),V.lineTo($.x,$.y),V.stroke()}},B=()=>{u&&(m(!1),N.length>0&&(A(G=>[...G,N]),S([])))},W=()=>{A([]),S([]),_(!1);const G=d.current,I=G==null?void 0:G.getContext("2d");!G||!I||(I.clearRect(0,0,P,M),I.fillStyle="#ffffff",I.fillRect(0,0,P,M),I.beginPath(),I.strokeStyle="#e5e7eb",I.lineWidth=1,I.setLineDash([5,5]),I.moveTo(20,M-30),I.lineTo(P-20,M-30),I.stroke(),I.setLineDash([]),I.font="12px system-ui",I.fillStyle="#6b7280",I.textAlign="center",I.fillText("Unterschrift",P/2,M-10),I.strokeStyle="#1f2937",I.lineWidth=2)},X=()=>{if(C.length===0)return"";let G="";return C.forEach(I=>{if(I.length>1){let V=`M ${I[0].x} ${I[0].y}`;I.slice(1).forEach($=>{V+=` L ${$.x} ${$.y}`}),G+=`<path d="${V}" stroke="#1f2937" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`}}),`
      <svg width="${P}" height="${M}" xmlns="http://www.w3.org/2000/svg">
        <rect width="100%" height="100%" fill="white"/>
        ${G}
        <line x1="20" y1="${M-30}" x2="${P-20}" y2="${M-30}" 
              stroke="#e5e7eb" stroke-width="1" stroke-dasharray="5,5"/>
        <text x="${P/2}" y="${M-10}" text-anchor="middle" 
              font-family="system-ui" font-size="12" fill="#6b7280">Unterschrift</text>
      </svg>
    `.trim()},ue=async()=>{if(!v){Ue.error("Bitte erstellen Sie zuerst eine Unterschrift");return}if(!b.trim()){Ue.error("Bitte geben Sie Ihren Namen ein");return}try{j(!0);const G=X();await n({svg:G,name:b.trim()}),W(),w(""),e()}catch(G){console.error("Error saving signature:",G),Ue.error(G.message||"Fehler beim Speichern der Unterschrift")}finally{j(!1)}},de=()=>{W(),c||p(""),e()};return s.jsx(Kt,{open:t,onOpenChange:de,children:s.jsxs(Wt,{className:"max-w-lg",children:[s.jsxs(Jt,{children:[s.jsxs(en,{className:"flex items-center gap-2",children:[s.jsx(Dl,{className:"h-5 w-5"}),r]}),s.jsx($n,{children:a})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"signer-name",children:"Name des Unterzeichners *"}),s.jsx(ae,{id:"signer-name",value:b,onChange:G=>w(G.target.value),placeholder:i,required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(Y,{children:"Unterschrift *"}),s.jsxs(ee,{type:"button",variant:"outline",size:"sm",onClick:W,disabled:!v,children:[s.jsx(R_,{className:"h-4 w-4 mr-1"}),"Löschen"]})]}),s.jsx(oe,{className:"relative",children:s.jsxs(ce,{className:"p-4",children:[s.jsx("canvas",{ref:d,className:"border border-gray-200 rounded-lg w-full cursor-crosshair touch-none",style:{maxWidth:"100%",height:"auto",aspectRatio:`${P}/${M}`},onMouseDown:R,onMouseMove:D,onMouseUp:B,onMouseLeave:B,onTouchStart:R,onTouchMove:D,onTouchEnd:B}),!v&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:s.jsxs("div",{className:"text-center text-muted-foreground",children:[s.jsx(Dl,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"Hier unterschreiben"}),s.jsx("p",{className:"text-xs mt-1 hidden sm:block",children:"Klicken und ziehen oder mit dem Finger zeichnen"}),s.jsx("p",{className:"text-xs mt-1 sm:hidden",children:"Mit dem Finger zeichnen"})]})})]})}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground sm:hidden",children:[s.jsx(oP,{className:"h-3 w-3"}),s.jsx("span",{children:"Tipp: Drehen Sie das Gerät für eine größere Signaturfläche"})]})]}),s.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 p-3 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[s.jsx(og,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-blue-900 dark:text-blue-100 font-medium",children:"Rechtsgültigkeit"}),s.jsx("p",{className:"text-blue-700 dark:text-blue-300 text-xs",children:"Ihre digitale Unterschrift hat die gleiche Rechtsgültigkeit wie eine handschriftliche Unterschrift und bestätigt den Erhalt der erbrachten Leistungen."})]})]})})]}),s.jsxs(ed,{children:[s.jsxs(ee,{variant:"outline",onClick:de,disabled:x,children:[s.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Abbrechen"]}),s.jsx(ee,{onClick:ue,disabled:!v||!b.trim()||x,children:x?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-current border-t-transparent rounded-full mr-2"}),"Speichere..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Dh,{className:"h-4 w-4 mr-2"}),"Unterschrift speichern"]})})]})]})})};class Jse{constructor(){qn(this,"QUEUE_KEY","offline_actions_queue");qn(this,"MAX_RETRIES",3)}async addAction(e,n){const r={id:`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:e,data:n,timestamp:new Date().toISOString(),retryCount:0},a=await this.getQueue();a.push(r),await this.saveQueue(a),console.log(`Added offline action: ${e}`,r)}async getQueue(){try{const{value:e}=await Dy.get({key:this.QUEUE_KEY});return e?JSON.parse(e):[]}catch(e){return console.error("Error getting offline queue:",e),[]}}async saveQueue(e){try{await Dy.set({key:this.QUEUE_KEY,value:JSON.stringify(e)})}catch(n){console.error("Error saving offline queue:",n)}}async processQueue(e){const n=await this.getQueue();if(n.length===0)return;console.log(`Processing ${n.length} offline actions`);const r=[];for(const a of n)try{await this.executeAction(a,e),console.log(`Successfully processed action: ${a.type}`,a.id)}catch(i){console.error(`Failed to process action: ${a.type}`,i),a.retryCount++,a.retryCount<this.MAX_RETRIES?r.push(a):console.warn(`Action ${a.id} exceeded max retries and will be discarded`)}await this.saveQueue(r)}async executeAction(e,n){var r,a,i,o,c,d,u,m,f,p;switch(e.type){case"START_TIME":await n.rpc("rpc_start_time_tracking",{p_employee_id:e.data.employee_id,p_project_id:e.data.project_id,p_notes:e.data.notes,p_location_lat:(r=e.data.location)==null?void 0:r.lat,p_location_lng:(a=e.data.location)==null?void 0:a.lng});break;case"STOP_TIME":await n.rpc("rpc_stop_time_tracking",{p_employee_id:e.data.employee_id,p_notes:e.data.notes,p_location_lat:(i=e.data.location)==null?void 0:i.lat,p_location_lng:(o=e.data.location)==null?void 0:o.lng});break;case"SWITCH_TIME":await n.rpc("rpc_switch_time_tracking",{p_employee_id:e.data.employee_id,p_project_id:e.data.project_id,p_notes:e.data.notes,p_location_lat:(c=e.data.location)==null?void 0:c.lat,p_location_lng:(d=e.data.location)==null?void 0:d.lng});break;case"CREATE_DELIVERY_NOTE":await n.rpc("rpc_create_delivery_note",{p_employee_id:e.data.employee_id,p_customer_id:e.data.customer_id,p_project_id:e.data.project_id,p_time_segment_ids:e.data.time_segment_ids,p_delivery_note_items:e.data.items,p_notes:e.data.notes,p_location_lat:(u=e.data.location)==null?void 0:u.lat,p_location_lng:(m=e.data.location)==null?void 0:m.lng});break;case"SIGN_DELIVERY_NOTE":await n.rpc("rpc_sign_delivery_note",{p_delivery_note_id:e.data.delivery_note_id,p_signature_data:e.data.signature_data,p_signer_name:e.data.signer_name,p_location_lat:(f=e.data.location)==null?void 0:f.lat,p_location_lng:(p=e.data.location)==null?void 0:p.lng});break;default:throw new Error(`Unknown action type: ${e.type}`)}}async clearQueue(){await Dy.remove({key:this.QUEUE_KEY})}async getQueueLength(){return(await this.getQueue()).length}}const Us=new Jse,KO=()=>{const[t,e]=g.useState({connected:!0,connectionType:"unknown"});return g.useEffect(()=>{let n=!0;const r=async()=>{try{const i=await rE.getStatus();n&&e({connected:i.connected,connectionType:i.connectionType})}catch(i){console.error("Error getting network status:",i)}},a=rE.addListener("networkStatusChange",i=>{n&&(e({connected:i.connected,connectionType:i.connectionType}),console.log("Network status changed:",i))});return r(),()=>{n=!1,a.remove()}},[]),t};class ere{constructor(){qn(this,"isInitialized",!1);qn(this,"currentToken",null)}async initialize(e){}setupListeners(e){}async updateUserToken(e,n){try{const{error:r}=await Z.from("employee_push_tokens").upsert({user_id:e,push_token:n,platform:Kse.getPlatform(),updated_at:new Date().toISOString()});r?console.error("Error updating push token:",r):console.log("Push token updated successfully")}catch(r){console.error("Error saving push token:",r)}}async showLocalNotification(e){try{await Xse.schedule({notifications:[{title:e.title,body:e.body,id:Date.now(),extra:e.data,iconColor:"#3b82f6",sound:"default"}]})}catch(n){console.error("Error showing local notification:",n)}}handleNotificationAction(e){const n=e.notification.data;if(n!=null&&n.actionUrl)window.location.href=n.actionUrl;else if(n!=null&&n.type)switch(n.type){case"time_reminder":window.location.hash="#/employee";break;case"delivery_note_signature":window.location.hash="#/employee";break;case"project_update":window.location.hash="#/employee";break;default:window.location.hash="#/employee"}}async scheduleTimeTrackingReminder(){}async cancelAllNotifications(){}async sendTestNotification(){await this.showLocalNotification({title:"HandwerkOS Test",body:"Push-Benachrichtigungen funktionieren!",data:{type:"test"}})}getCurrentToken(){return this.currentToken}async cleanup(e){if(e&&this.currentToken)try{await Z.from("employee_push_tokens").delete().eq("user_id",e).eq("push_token",this.currentToken)}catch(n){console.error("Error cleaning up push token:",n)}Yse.removeAllListeners(),this.isInitialized=!1,this.currentToken=null}}const Ty=new ere,tre=()=>{const{user:t}=Fr(),{activeTime:e,segments:n,isLoading:r,startTracking:a,stopTracking:i,pauseTracking:o,refreshData:c}=Vse(),{deliveryNotes:d,signDeliveryNote:u,fetchDeliveryNotes:m}=HO(),[f,p]=g.useState([]),[x,j]=g.useState(""),[v,_]=g.useState(""),[b,w]=g.useState(""),[N,S]=g.useState("work"),C=KO(),[A,P]=g.useState(null),[M,z]=g.useState(0),[R,D]=g.useState(!1),[B,W]=g.useState(!1),[X,ue]=g.useState(null),[de,G]=g.useState(new Date);g.useEffect(()=>{(async()=>{try{await nE.setStyle({style:Zse.Light}),await nE.setBackgroundColor({color:"#1f2937"}),e.active?await sE.keepAwake():await sE.allowSleep(),await I();const ne=await Us.getQueueLength();z(ne),t!=null&&t.id&&(await Ty.initialize(t.id),Ty.setupListeners(t.id),await Ty.scheduleTimeTrackingReminder())}catch(ne){console.error("Mobile setup error:",ne)}})()},[e.active,t==null?void 0:t.id]),g.useEffect(()=>{C.connected&&M>0&&$()},[C.connected,M]),g.useEffect(()=>{const q=setInterval(()=>{G(new Date)},1e3);return()=>clearInterval(q)},[]),g.useEffect(()=>{C.connected&&(V(),c(),m())},[C.connected,c,m]);const I=async()=>{try{const q=await Qse.getCurrentPosition({enableHighAccuracy:!0,timeout:1e4});return P({lat:q.coords.latitude,lng:q.coords.longitude}),q}catch(q){return console.error("Location error:",q),null}},V=async()=>{try{try{const{data:q,error:ne}=await Z.from("projects").select(`
            id,
            name,
            customer:customers(
              id,
              name,
              email
            )
          `).eq("status","active").order("name");if(ne&&!ne.message.includes("relation")&&!ne.message.includes("does not exist"))throw ne;p(q||[])}catch(q){if(q.message.includes("relation")||q.message.includes("does not exist"))console.warn("Projects table not found, using mock data"),p([{id:"mock-project-1",name:"Demo Baustelle Nord",customer:{id:"mock-customer-1",name:"Mustermann GmbH",email:"info@mustermann.de"}},{id:"mock-project-2",name:"Bürogebäude Zentrum",customer:{id:"mock-customer-2",name:"Bau AG",email:"contact@bau-ag.de"}},{id:"mock-project-3",name:"Wohnanlage Süd",customer:{id:"mock-customer-3",name:"Immobilien Partners",email:"office@immobilien-partners.de"}}]);else throw q}}catch(q){console.error("Error loading projects:",q),p([])}},$=async()=>{try{await Us.processQueue(Z);const q=await Us.getQueueLength();z(q),q===0&&Ue.success("Alle Offline-Aktionen erfolgreich synchronisiert")}catch(q){console.error("Error processing offline queue:",q)}},F=(q=Xm.Medium)=>{try{Gse.impact({style:q})}catch{}},O=async()=>{if(!x){Ue.error("Bitte wählen Sie ein Projekt aus");return}if(F(Xm.Light),!C.connected){await I(),await Us.addAction("START_TIME",{employee_id:t==null?void 0:t.id,project_id:x,notes:v,location:A});const q=await Us.getQueueLength();z(q),Ue.info("Aktion für Offline-Verarbeitung gespeichert");return}await I(),await a(x,N,v||void 0),_("")},K=async()=>{if(F(Xm.Heavy),!C.connected){await I(),await Us.addAction("STOP_TIME",{employee_id:t==null?void 0:t.id,notes:b,location:A});const q=await Us.getQueueLength();z(q),Ue.info("Aktion für Offline-Verarbeitung gespeichert");return}await i(b||void 0),w("")},U=async()=>{if(!x){Ue.error("Bitte wählen Sie ein Projekt aus");return}if(F(Xm.Light),!C.connected){await I(),await Us.addAction("SWITCH_TIME",{employee_id:t==null?void 0:t.id,project_id:x,notes:v,location:A});const ne=await Us.getQueueLength();z(ne),Ue.info("Aktion für Offline-Verarbeitung gespeichert");return}e.active&&await i(b);const q=f.find(ne=>ne.id===x);await a(x,N,v,q==null?void 0:q.name),_(""),w(""),D(!1)},te=async q=>{if(X){if(!C.connected){await I(),await Us.addAction("SIGN_DELIVERY_NOTE",{delivery_note_id:X.id,signature_data:{svg:q.svg},signer_name:q.name,location:A});const ne=await Us.getQueueLength();z(ne),Ue.info("Signatur für Offline-Verarbeitung gespeichert"),W(!1);return}await u(X.id,{svg:q.svg},q.name),W(!1),ue(null)}},J=(d==null?void 0:d.filter(q=>q.status==="sent"&&!q.signed_at))||[];return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-indigo-50 dark:from-gray-900 dark:via-gray-800 dark:to-blue-900 pb-20",children:[s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs(oe,{className:"border-0 shadow-lg",children:[s.jsx(Ne,{className:"pb-2",children:s.jsxs(Ce,{className:"flex items-center gap-2 text-lg",children:[s.jsx(lP,{className:"h-5 w-5"}),e.active?"Laufende Zeiterfassung":"Zeiterfassung starten"]})}),s.jsx(ce,{className:"space-y-3",children:e.active?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(Y,{className:"text-sm",children:"Notizen hinzufügen"}),s.jsx(cn,{value:b,onChange:q=>w(q.target.value),placeholder:"Notizen für diese Arbeitszeit...",rows:2,className:"text-sm resize-none"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(ee,{onClick:K,disabled:r,size:"lg",variant:"destructive",className:"w-full h-12 text-base",children:[s.jsx(Qb,{className:"h-5 w-5 mr-2"}),"Zeiterfassung beenden"]}),s.jsxs($se,{open:R,onOpenChange:D,children:[s.jsx(Use,{asChild:!0,children:s.jsxs(ee,{variant:"outline",size:"lg",className:"w-full h-10 text-sm border-2",children:[s.jsx(R_,{className:"h-4 w-4 mr-2"}),"Projekt wechseln"]})}),s.jsxs($O,{side:"bottom",className:"h-[80vh]",children:[s.jsxs(UO,{className:"text-left pb-4",children:[s.jsx(qO,{children:"Projekt wechseln"}),s.jsx(WO,{children:"Aktuelle Erfassung wird automatisch beendet und neue gestartet."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{children:"Neues Projekt"}),s.jsxs(mt,{value:x,onValueChange:j,children:[s.jsx(ht,{className:"h-12 text-base",children:s.jsx(pt,{placeholder:"Neues Projekt wählen..."})}),s.jsx(ft,{children:f.map(q=>s.jsx(ye,{value:q.id,children:s.jsxs("div",{className:"flex flex-col items-start py-1",children:[s.jsx("span",{className:"font-medium",children:q.name}),q.customer&&s.jsx("span",{className:"text-sm text-muted-foreground",children:q.customer.name})]})},q.id))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{children:"Neue Beschreibung"}),s.jsx(cn,{value:v,onChange:q=>_(q.target.value),placeholder:"Beschreibung für das neue Projekt...",rows:2,className:"text-base resize-none"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{children:"Notizen für vorherige Erfassung"}),s.jsx(cn,{value:b,onChange:q=>w(q.target.value),placeholder:"Abschlussnotizen...",rows:2,className:"text-base resize-none"})]}),s.jsxs(ee,{onClick:U,disabled:!x||r,size:"lg",className:"w-full h-14 text-lg bg-gradient-to-r from-blue-500 to-indigo-500",children:[s.jsx(R_,{className:"h-6 w-6 mr-2"}),"Projekt wechseln"]})]})]})]})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(Y,{className:"text-sm",children:"Projekt auswählen"}),s.jsxs(mt,{value:x,onValueChange:j,children:[s.jsx(ht,{className:"h-10 text-base",children:s.jsx(pt,{placeholder:"Projekt wählen..."})}),s.jsx(ft,{children:f.map(q=>s.jsx(ye,{value:q.id,children:s.jsxs("div",{className:"flex flex-col items-start py-1",children:[s.jsx("span",{className:"font-medium",children:q.name}),q.customer&&s.jsx("span",{className:"text-sm text-muted-foreground",children:q.customer.name})]})},q.id))})]})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(Y,{className:"text-sm",children:"Typ der Erfassung"}),s.jsxs(mt,{value:N,onValueChange:q=>S(q),children:[s.jsx(ht,{className:"h-10 text-base",children:s.jsx(pt,{})}),s.jsxs(ft,{children:[s.jsx(ye,{value:"work",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(an,{className:"h-4 w-4"}),"Arbeitszeit"]})}),s.jsx(ye,{value:"break",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(tB,{className:"h-4 w-4"}),"Pause"]})}),s.jsx(ye,{value:"drive",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zb,{className:"h-4 w-4"}),"Fahrtzeit"]})})]})]})]}),s.jsxs("div",{className:"space-y-1.5",children:[s.jsx(Y,{className:"text-sm",children:"Beschreibung (optional)"}),s.jsx(cn,{value:v,onChange:q=>_(q.target.value),placeholder:"Was werden Sie arbeiten?",rows:2,className:"text-sm resize-none"})]}),s.jsxs(ee,{onClick:O,disabled:!x||r,size:"lg",className:"w-full h-12 text-base bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600",children:[s.jsx(Pu,{className:"h-5 w-5 mr-2"}),"Zeiterfassung starten"]})]})})]}),J.length>0&&s.jsxs(oe,{className:"border-0 shadow-lg border-orange-200 bg-orange-50 dark:bg-orange-950",children:[s.jsxs(Ne,{className:"pb-2",children:[s.jsxs(Ce,{className:"flex items-center gap-2 text-orange-900 dark:text-orange-100 text-base",children:[s.jsx(Dl,{className:"h-4 w-4"}),"Zu signierende Lieferscheine (",J.length,")"]}),s.jsx(ds,{className:"text-orange-700 dark:text-orange-300 text-sm",children:"Diese Lieferscheine warten auf Ihre Unterschrift"})]}),s.jsx(ce,{className:"space-y-2",children:J.slice(0,3).map(q=>{var ne,pe;return s.jsxs("div",{className:"flex items-center justify-between p-2.5 bg-white dark:bg-gray-800 rounded-lg border",children:[s.jsxs("div",{className:"space-y-0.5",children:[s.jsx("div",{className:"font-medium text-sm",children:q.number}),s.jsxs("div",{className:"text-xs text-muted-foreground",children:[(ne=q.project)==null?void 0:ne.name," • ",(pe=q.project)==null?void 0:pe.customer.name]})]}),s.jsxs(ee,{size:"sm",onClick:()=>{ue(q),W(!0)},className:"bg-orange-600 hover:bg-orange-700 h-8 text-xs px-3",children:[s.jsx(Dl,{className:"h-3 w-3 mr-1"}),"Signieren"]})]},q.id)})})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(oe,{className:"border-0 shadow-md",children:s.jsxs(ce,{className:"p-3 text-center",children:[s.jsxs("div",{className:`inline-flex items-center gap-2 ${C.connected?"text-green-600":"text-red-600"}`,children:[C.connected?s.jsx(dP,{className:"h-4 w-4"}):s.jsx(Xb,{className:"h-4 w-4"}),s.jsx("span",{className:"font-medium text-sm",children:C.connected?"Online":"Offline"})]}),M>0&&s.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[M," wartende Aktion(en)"]})]})}),s.jsx(oe,{className:"border-0 shadow-md",children:s.jsxs(ce,{className:"p-3 text-center",children:[s.jsxs("div",{className:`inline-flex items-center gap-2 ${A?"text-blue-600":"text-gray-400"}`,children:[s.jsx(Ci,{className:"h-4 w-4"}),s.jsx("span",{className:"font-medium text-sm",children:"Standort"})]}),s.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:A?"Verfügbar":"Nicht verfügbar"})]})})]}),!C.connected&&s.jsx(oe,{className:"border-orange-200 bg-orange-50 dark:bg-orange-950",children:s.jsx(ce,{className:"p-3",children:s.jsxs("div",{className:"flex items-start gap-2.5",children:[s.jsx(us,{className:"h-4 w-4 text-orange-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"font-medium text-orange-900 dark:text-orange-100 text-sm",children:"Offline-Modus aktiv"}),s.jsx("div",{className:"text-xs text-orange-700 dark:text-orange-300",children:"Alle Aktionen werden gespeichert und synchronisiert, sobald eine Internetverbindung verfügbar ist."}),M>0&&s.jsxs("div",{className:"text-xs font-medium text-orange-800 dark:text-orange-200",children:[M," Aktion(en) warten auf Synchronisation"]})]})]})})}),C.connected&&M===0&&e.active&&s.jsx(oe,{className:"border-green-200 bg-green-50 dark:bg-green-950",children:s.jsx(ce,{className:"p-3",children:s.jsxs("div",{className:"flex items-center gap-2.5",children:[s.jsx(og,{className:"h-4 w-4 text-green-600"}),s.jsx("div",{className:"font-medium text-green-900 dark:text-green-100 text-sm",children:"Zeiterfassung läuft und wird live synchronisiert"})]})})})]}),s.jsx(VO,{isOpen:B,onClose:()=>{W(!1),ue(null)},onSave:te,title:`Lieferschein ${X==null?void 0:X.number} signieren`,description:"Bitte unterschreiben Sie zur Bestätigung des Erhalts der Leistungen"})]})},nre=({className:t=""})=>{Fr();const e=KO(),{deliveryNotes:n,fetchDeliveryNotes:r,signDeliveryNote:a}=HO(),[i,o]=g.useState(null),[c,d]=g.useState(!1),[u,m]=g.useState(""),[f,p]=g.useState(0),x=(n==null?void 0:n.filter(C=>C.status==="sent"&&!C.signed_at))||[];g.useEffect(()=>{r(),j()},[r]),g.useEffect(()=>{e.connected&&f>0&&v()},[e.connected,f]);const j=async()=>{const C=await Us.getQueueLength();p(C)},v=async()=>{try{await Us.processQueue(),await j(),f>0&&Ue.success("Offline-Signaturen erfolgreich synchronisiert")}catch(C){console.error("Error processing offline queue:",C)}},_=C=>{o(C),m(""),d(!0)},b=async C=>{if(i){if(!e.connected){await Us.addAction("SIGN_DELIVERY_NOTE",{delivery_note_id:i.id,signature_data:{svg:C.svg},signer_name:C.name,location:null}),await j(),Ue.info("Signatur für Offline-Verarbeitung gespeichert"),d(!1);return}try{await a(i.id,{svg:C.svg},C.name),d(!1),o(null),await r(),Ue.success("Lieferschein erfolgreich signiert")}catch(A){console.error("Error signing delivery note:",A),Ue.error("Fehler beim Signieren des Lieferscheins")}}},w=C=>{const A=Math.floor(C/60),P=C%60;return`${A}:${P.toString().padStart(2,"0")}h`},N=C=>new Date(C).toLocaleDateString("de-DE",{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"}),S=C=>new Date(C).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"});return x.length===0&&f===0?s.jsx("div",{className:`space-y-4 ${t}`,children:s.jsx(oe,{className:"border-0 shadow-lg",children:s.jsxs(ce,{className:"p-8 text-center",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx(og,{className:"h-12 w-12 mx-auto"})}),s.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Alle Lieferscheine signiert"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"Keine Lieferscheine warten auf Ihre Unterschrift"})]})})}):s.jsxs("div",{className:`space-y-4 ${t}`,children:[s.jsx(oe,{className:"border-0 shadow-lg bg-gradient-to-r from-orange-500 to-amber-500 text-white",children:s.jsx(Ne,{className:"pb-3",children:s.jsxs(Ce,{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Dl,{className:"h-6 w-6"}),s.jsx("span",{children:"Zu signierende Lieferscheine"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[f>0&&s.jsx(Qe,{variant:"secondary",className:"bg-yellow-500 text-white",children:f}),s.jsx(Qe,{variant:"secondary",className:"bg-white/20 text-white",children:x.length})]})]})})}),!e.connected&&s.jsx(oe,{className:"border-orange-200 bg-orange-50",children:s.jsxs(ce,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-orange-700",children:[s.jsx(oP,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"Offline-Modus"})]}),s.jsx("p",{className:"text-orange-600 text-sm mt-1",children:"Signaturen werden gespeichert und automatisch synchronisiert, sobald eine Internetverbindung verfügbar ist."}),f>0&&s.jsxs("div",{className:"text-sm font-medium text-orange-800 mt-2",children:[f," Signatur(en) warten auf Synchronisation"]})]})}),s.jsx("div",{className:"space-y-3",children:x.map(C=>{var A,P,M,z;return s.jsx(oe,{className:"border-0 shadow-md hover:shadow-lg transition-shadow",children:s.jsxs(ce,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(wn,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{className:"font-semibold text-lg",children:C.number})]}),s.jsx(Qe,{variant:"secondary",className:"bg-orange-100 text-orange-700",children:"Wartet auf Signatur"})]}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(qa,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"font-medium",children:((A=C.project)==null?void 0:A.name)||"Kein Projekt"})]}),((P=C.project)==null?void 0:P.customer)&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(pr,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{children:C.project.customer.name})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Lt,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{children:N(C.created_at)})]})]}),s.jsx(mi,{className:"my-3"}),((M=C.delivery_note_time_segments)==null?void 0:M.length)>0&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("h4",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:[s.jsx(lP,{className:"h-4 w-4"}),"Zeiterfassung (",C.delivery_note_time_segments.length," Einträge)"]}),s.jsxs("div",{className:"space-y-1",children:[C.delivery_note_time_segments.slice(0,3).map((R,D)=>s.jsxs("div",{className:"flex items-center justify-between text-sm bg-gray-50 p-2 rounded",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(an,{className:"h-3 w-3 text-gray-400"}),s.jsx("span",{children:N(R.time_segment.started_at)}),s.jsxs("span",{className:"text-gray-500",children:[S(R.time_segment.started_at)," - ",S(R.time_segment.ended_at)]})]}),s.jsx("span",{className:"font-medium",children:w(R.time_segment.duration_minutes)})]},D)),C.delivery_note_time_segments.length>3&&s.jsxs("div",{className:"text-xs text-gray-500 text-center py-1",children:["+",C.delivery_note_time_segments.length-3," weitere Einträge"]})]})]}),((z=C.delivery_note_items)==null?void 0:z.length)>0&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("h4",{className:"font-medium text-sm mb-2",children:["Materialien (",C.delivery_note_items.length," Positionen)"]}),s.jsxs("div",{className:"space-y-1",children:[C.delivery_note_items.slice(0,2).map((R,D)=>s.jsxs("div",{className:"flex items-center justify-between text-sm bg-gray-50 p-2 rounded",children:[s.jsx("span",{children:R.description}),s.jsxs("span",{className:"font-medium",children:[R.quantity," ",R.unit]})]},D)),C.delivery_note_items.length>2&&s.jsxs("div",{className:"text-xs text-gray-500 text-center py-1",children:["+",C.delivery_note_items.length-2," weitere Positionen"]})]})]}),C.location_lat&&C.location_lng&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-4",children:[s.jsx(Ci,{className:"h-4 w-4"}),s.jsx("span",{children:"Standort erfasst"})]}),C.notes&&s.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("strong",{children:"Hinweise:"})," ",C.notes]})}),s.jsxs(ee,{onClick:()=>_(C),className:"w-full h-12 text-lg bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600",children:[s.jsx(Dl,{className:"h-5 w-5 mr-2"}),"Lieferschein signieren"]})]})},C.id)})}),s.jsx(VO,{isOpen:c,onClose:()=>{d(!1),o(null)},onSave:b,title:`Lieferschein ${i==null?void 0:i.number} signieren`,description:"Bitte unterschreiben Sie zur Bestätigung des Erhalts der Leistungen",signerName:u,onSignerNameChange:m})]})},ZO=()=>{var Mn,bn;const{user:t,userRole:e}=Fr(),{toast:n}=Mt(),[r,a]=g.useState("home"),[i,o]=g.useState(navigator.onLine),[c,d]=g.useState(null),[u,m]=g.useState(null),[f,p]=g.useState([]),[x,j]=g.useState(!1),[v,_]=g.useState([]),[b,w]=g.useState([]),[N,S]=g.useState([]),[C,A]=g.useState(!1),[P,M]=g.useState(!1),[z,R]=g.useState(!1),[D,B]=g.useState(""),[W,X]=g.useState(""),[ue,de]=g.useState(""),[G,I]=g.useState(""),[V,$]=g.useState(null),F=g.useRef(null),O=g.useRef(null),K=g.useRef(null),[U,te]=g.useState(100),[J,q]=g.useState(0);g.useState(!1);const[ne,pe]=g.useState(!0),[Q,re]=g.useState(!1),[me,he]=g.useState({available:0,total:0});g.useState([]);const[ge,se]=g.useState({projectId:"",material:"",quantity:"",unit:"Stück"});g.useEffect(()=>{(async()=>{try{await Cy.setStyle({style:Vw.Dark}),await Cy.setOverlaysWebView({overlay:!1}),await Cy.show()}catch{console.log("StatusBar not available in web")}})()},[]),g.useEffect(()=>{const je=()=>{o(!0),xt(),gs()},_e=()=>o(!1);window.addEventListener("online",je),window.addEventListener("offline",_e),we();const Me=setInterval(()=>{te(Math.max(20,Math.floor(Math.random()*100)))},3e4);Ye(),Se(),qe(),pe(!1);const Ee=localStorage.getItem("activeTimeEntry");if(Ee){const it=JSON.parse(Ee);it.startTime&&(it.startTime=new Date(it.startTime)),it.endTime&&(it.endTime=new Date(it.endTime)),m(it)}return()=>{window.removeEventListener("online",je),window.removeEventListener("offline",_e),clearInterval(Me),be()}},[]);const we=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(je=>{const{latitude:_e,longitude:$e}=je.coords;d({lat:_e,lng:$e,address:"Baustelle Musterstraße 123, 12345 Berlin"})},je=>{console.error("Geolocation error:",je),n({title:"Standort",description:"Standort konnte nicht ermittelt werden",variant:"destructive"})},{enableHighAccuracy:!0})},Se=async()=>{if(!(!(t!=null&&t.id)||!i))try{const{data:je}=await Z.from("project_documents").select("*").eq("document_type","photo").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if(je){const Me=je.map(Ee=>{var it;return{id:Ee.id,projectId:Ee.project_id,fileName:Ee.name,fileUrl:Ee.file_url||"",description:((it=Ee.metadata)==null?void 0:it.description)||"",createdAt:new Date(Ee.created_at)}});_(Me)}const{data:_e}=await Z.from("project_documents").select("*").eq("document_type","receipt").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if(_e){const Me=_e.map(Ee=>{var it,pn;return{id:Ee.id,projectId:Ee.project_id,fileName:Ee.name,fileUrl:Ee.file_url||"",amount:((it=Ee.metadata)==null?void 0:it.amount)||0,description:((pn=Ee.metadata)==null?void 0:pn.description)||"",createdAt:new Date(Ee.created_at)}});w(Me)}const{data:$e}=await Z.from("project_comments").select("*").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if($e){const Me=$e.map(Ee=>({id:Ee.id,projectId:Ee.project_id,comment:Ee.comment,createdAt:new Date(Ee.created_at)}));S(Me)}}catch(je){console.error("Error loading existing data:",je)}},qe=async()=>{if(!(!(t!=null&&t.id)||!i))try{const{data:je}=await Z.from("employees").select("id, vacation_days_total, vacation_days_used").eq("user_id",t.id).single();if(je){const{data:_e}=await Z.from("vacation_requests").select("days_requested").eq("employee_id",je.id).eq("status","pending").eq("request_type","vacation"),$e=(_e==null?void 0:_e.reduce((pn,Ss)=>pn+Ss.days_requested,0))||0,Me=je.vacation_days_total||0,Ee=je.vacation_days_used||0,it=Math.max(0,Me-Ee-$e);he({available:it,total:Me})}else{const{data:_e}=await Z.from("company_settings").select("default_vacation_days").single(),$e=(_e==null?void 0:_e.default_vacation_days)||25;he({available:$e,total:$e})}}catch(je){console.error("Error loading vacation balance:",je)}},Ye=async()=>{if(!t||!t.id){p([{id:"mock-1",name:"Baustelle Musterstraße",status:"aktiv",location:"Musterstraße 123, Berlin",priority:"normal",assignedTo:["mock-user"],deadline:null}]);return}try{const{data:je,error:_e}=await Z.from("project_team_assignments").select(`
          project_id,
          projects:project_id (
            id,
            name,
            status,
            location,
            start_date,
            end_date,
            priority
          )
        `).eq("employee_id",t.id).eq("is_active",!0);if(_e){console.error("Error fetching assigned projects:",_e);const Me=[{id:"mock-1",name:"Baustelle Musterstraße",status:"aktiv",location:"Musterstraße 123, Berlin",priority:"normal",assignedTo:[(t==null?void 0:t.id)||"mock-user"],deadline:null}];p(Me);return}const $e=(je==null?void 0:je.map(Me=>({id:Me.projects.id,name:Me.projects.name,status:Me.projects.status||"in_bearbeitung",location:Me.projects.location||"Nicht angegeben",priority:Me.projects.priority||"normal",assignedTo:[(t==null?void 0:t.id)||"mock-user"],deadline:Me.projects.end_date})))||[];if($e.length===0){const Me=[{id:"mock-1",name:"Baustelle Musterstraße",status:"aktiv",location:"Musterstraße 123, Berlin",priority:"normal",assignedTo:[(t==null?void 0:t.id)||"mock-user"],deadline:null}];p(Me),q(0);return}p($e),q($e.filter(Me=>Me.priority==="urgent").length)}catch(je){console.error("Error in fetchAssignedProjects:",je),p([])}},Et=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Camera API not available");const je=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}},audio:!1});j(!0),setTimeout(()=>{O.current&&(O.current.srcObject=je,O.current.play().catch(_e=>{console.error("Error playing video:",_e)}))},100)}catch(je){console.error("Error accessing camera:",je);let _e="Kamera konnte nicht gestartet werden";je.name==="NotAllowedError"||je.name==="PermissionDeniedError"?_e="Kamera-Zugriff wurde verweigert. Bitte erlauben Sie den Kamera-Zugriff in den Browser-Einstellungen.":je.name==="NotFoundError"||je.name==="DevicesNotFoundError"?_e="Keine Kamera gefunden. Bitte stellen Sie sicher, dass eine Kamera angeschlossen ist.":je.name==="NotReadableError"||je.name==="TrackStartError"?_e="Kamera wird bereits von einer anderen Anwendung verwendet.":navigator.mediaDevices||(_e="Ihr Browser unterstützt keine Kamera-Funktionen. Bitte verwenden Sie einen modernen Browser."),n({title:"Kamera Fehler",description:_e,variant:"destructive"}),j(!1)}},be=()=>{O.current&&O.current.srcObject&&O.current.srcObject.getTracks().forEach(_e=>_e.stop()),j(!1)},Oe=async()=>{if(!O.current||!K.current||!V)return;const je=K.current,_e=O.current,$e=je.getContext("2d");$e&&(je.width=_e.videoWidth,je.height=_e.videoHeight,$e.drawImage(_e,0,0),je.toBlob(async Me=>{Me&&await Fe(Me,V)},"image/jpeg")),be()},Fe=async(je,_e)=>{var $e;try{const Me=`project-photo-${Date.now()}.jpg`,{data:Ee,error:it}=await Z.storage.from("project-media").upload(`${_e}/${Me}`,je);if(it)throw it;const{data:pn,error:Ss}=await Z.from("project_documents").insert({project_id:_e,name:Me,document_type:"photo",file_url:Ee.path,created_by:t==null?void 0:t.id,metadata:{description:D}});if(Ss)throw Ss;const pa={id:(($e=pn[0])==null?void 0:$e.id)||Date.now().toString(),projectId:_e,fileName:Me,fileUrl:Ee.path,description:D,createdAt:new Date};_(Ai=>[...Ai,pa]),B(""),A(!1),n({title:"Foto hochgeladen",description:"Foto wurde erfolgreich gespeichert"})}catch(Me){console.error("Error uploading photo:",Me),n({title:"Upload Fehler",description:"Foto konnte nicht hochgeladen werden",variant:"destructive"})}},lt=async(je,_e)=>{var $e;try{const Me=`receipt-${Date.now()}-${je.name}`,{data:Ee,error:it}=await Z.storage.from("project-media").upload(`${_e}/${Me}`,je);if(it)throw it;let pn=null;try{const Pi=await new Promise((Jd,Di)=>{const Ti=new FileReader;Ti.onload=()=>Jd(Ti.result),Ti.onerror=Di,Ti.readAsDataURL(je)});pn={status:"processed",confidence:.85,extracted_text:"OCR processing completed",processed_at:new Date().toISOString(),file_type:je.type,structured_data:{amount:parseFloat(ue)||0,description:W,filename:Me}}}catch(Pi){console.warn("OCR processing failed:",Pi),pn={status:"failed",error:"OCR processing failed",processed_at:new Date().toISOString()}}const{data:Ss,error:pa}=await Z.from("project_documents").insert({project_id:_e,name:Me,document_type:"receipt",file_url:Ee.path,created_by:t==null?void 0:t.id,validation_status:"submitted",ocr_result:pn,metadata:{amount:parseFloat(ue)||0,description:W,upload_type:"mobile_employee"}});if(pa)throw pa;const Ai={id:(($e=Ss[0])==null?void 0:$e.id)||Date.now().toString(),projectId:_e,fileName:Me,fileUrl:Ee.path,amount:parseFloat(ue)||0,description:W,createdAt:new Date};w(Pi=>[...Pi,Ai]),X(""),de(""),M(!1),n({title:"Rechnung eingereicht",description:"Rechnung wurde zur Manager-Validierung eingereicht und wartet auf Genehmigung."})}catch(Me){console.error("Error uploading receipt:",Me),n({title:"Upload Fehler",description:"Rechnung konnte nicht hochgeladen werden",variant:"destructive"})}},He=async(je,_e)=>{var $e;try{const{data:Me,error:Ee}=await Z.from("project_comments").insert({project_id:je,comment:_e,created_by:t==null?void 0:t.id});if(Ee)throw Ee;const it={id:(($e=Me[0])==null?void 0:$e.id)||Date.now().toString(),projectId:je,comment:_e,createdAt:new Date};S(pn=>[...pn,it]),I(""),R(!1),n({title:"Kommentar hinzugefügt",description:"Kommentar wurde erfolgreich gespeichert"})}catch(Me){console.error("Error adding comment:",Me),n({title:"Fehler",description:"Kommentar konnte nicht gespeichert werden",variant:"destructive"})}},Le=()=>{if(u){const je={...u,isActive:!1};m(je),localStorage.setItem("activeTimeEntry",JSON.stringify(je)),n({title:"Zeiterfassung pausiert",description:"Timer angehalten"})}},Nt=()=>{if(u){const je={...u,endTime:new Date,isActive:!1},_e=JSON.parse(localStorage.getItem("completedTimeEntries")||"[]");_e.push(je),localStorage.setItem("completedTimeEntries",JSON.stringify(_e)),m(null),localStorage.removeItem("activeTimeEntry");const $e=je.endTime instanceof Date?je.endTime:new Date(je.endTime),Me=je.startTime instanceof Date?je.startTime:new Date(je.startTime),Ee=Math.round(($e.getTime()-Me.getTime())/(1e3*60));n({title:"Zeiterfassung beendet",description:`${Ee} Minuten erfasst`}),i&&xt()}},xt=async()=>{const je=JSON.parse(localStorage.getItem("completedTimeEntries")||"[]");if(je.length>0&&i&&t)try{const{data:_e}=await Z.from("employees").select("id").eq("user_id",t.id).single();if(!_e){console.error("Employee not found for user");return}const $e=je.map(Ee=>({employee_id:_e.id,project_id:Ee.projectId,start_time:Ee.startTime,end_time:Ee.endTime,status:"beendet",description:Ee.description||null})),{error:Me}=await Z.from("time_entries").insert($e);if(Me)throw Me;localStorage.removeItem("completedTimeEntries"),n({title:"Synchronisation",description:`${je.length} Zeiteinträge synchronisiert`})}catch(_e){console.error("Sync failed:",_e),n({title:"Sync Fehler",description:"Zeiterfassung konnte nicht synchronisiert werden",variant:"destructive"})}},Un=()=>{if(!ge.material||!ge.quantity){n({title:"Fehler",description:"Material und Menge sind erforderlich",variant:"destructive"});return}const je={...ge,timestamp:new Date().toISOString(),location:c},_e=JSON.parse(localStorage.getItem("materialEntries")||"[]");_e.push(je),localStorage.setItem("materialEntries",JSON.stringify(_e)),se({projectId:"",material:"",quantity:"",unit:"Stück"}),n({title:"Material erfasst",description:`${je.quantity} ${je.unit} ${je.material}`}),i&&gs()},gs=async()=>{const je=JSON.parse(localStorage.getItem("materialEntries")||"[]");if(je.length>0&&i&&t)try{const{data:_e}=await Z.from("employees").select("id").eq("user_id",t.id).single();if(!_e){console.error("Employee not found for user");return}const $e=je.map(Ee=>({employee_id:_e.id,project_id:Ee.projectId,material_id:null,quantity_used:parseFloat(Ee.quantity),usage_date:new Date(Ee.timestamp).toISOString().split("T")[0],notes:`${Ee.material} (${Ee.unit}) - Mobile Entry`,created_by:t.id})),{error:Me}=await Z.from("employee_material_usage").insert($e);if(Me)throw Me;localStorage.removeItem("materialEntries"),n({title:"Synchronisation",description:`${je.length} Materialeinträge synchronisiert`})}catch(_e){console.error("Material sync failed:",_e),n({title:"Sync Fehler",description:"Materialeinträge konnten nicht synchronisiert werden",variant:"destructive"})}},yt=()=>{if(!u||!u.startTime)return"00:00:00";const je=new Date,_e=u.startTime instanceof Date?u.startTime:new Date(u.startTime),$e=je.getTime()-_e.getTime(),Me=Math.floor($e/(1e3*60*60)),Ee=Math.floor($e%(1e3*60*60)/(1e3*60)),it=Math.floor($e%(1e3*60)/1e3);return`${Me.toString().padStart(2,"0")}:${Ee.toString().padStart(2,"0")}:${it.toString().padStart(2,"0")}`},dn=()=>{var je;return s.jsxs("div",{className:"space-y-2 w-full overflow-hidden",children:[u&&s.jsx(oe,{className:"border-2 border-green-400 bg-green-50",children:s.jsxs(ce,{className:"p-3",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("h3",{className:"font-semibold text-green-800",children:"Timer läuft"}),s.jsx("div",{className:"text-2xl font-mono font-bold text-green-600",children:yt()})]}),s.jsx("p",{className:"text-green-700 text-sm mb-3",children:(je=f.find(_e=>_e.id===u.projectId))==null?void 0:je.name}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ee,{size:"sm",variant:"outline",onClick:Le,className:"flex-1",children:[s.jsx(M_,{className:"h-4 w-4 mr-2"}),"Pause"]}),s.jsxs(ee,{size:"sm",variant:"destructive",onClick:Nt,className:"flex-1",children:[s.jsx(Qb,{className:"h-4 w-4 mr-2"}),"Stoppen"]})]})]})}),s.jsxs(oe,{children:[s.jsx(Ne,{className:"p-3",children:s.jsxs(Ce,{className:"flex items-center gap-2",children:[s.jsx("span",{children:"Schnellaktionen"}),J>0&&s.jsx(Qe,{variant:"destructive",className:"rounded-full px-2 py-1",children:J})]})}),s.jsxs(ce,{className:"grid grid-cols-2 gap-2 p-3",children:[s.jsxs(ee,{className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>a("time"),children:[s.jsx(an,{className:"h-6 w-6"}),s.jsx("span",{className:"text-sm",children:"Zeit erfassen"})]}),s.jsxs(ee,{variant:"outline",className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>{var _e;$(((_e=f[0])==null?void 0:_e.id)||""),Et()},children:[s.jsx(P_,{className:"h-6 w-6"}),s.jsx("span",{className:"text-sm",children:"Foto machen"})]}),s.jsxs(ee,{variant:"outline",className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>a("docs"),children:[s.jsx(wn,{className:"h-6 w-6"}),s.jsx("span",{className:"text-sm",children:"Dokumentation"})]}),s.jsxs(ee,{variant:"outline",className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>re(!0),children:[s.jsx(Lt,{className:"h-6 w-6"}),s.jsx("span",{className:"text-sm",children:"Urlaub"}),me.available>0&&s.jsxs("span",{className:"text-xs text-green-600",children:[me.available," Tage"]})]})]})]}),s.jsxs(oe,{className:"overflow-hidden",children:[s.jsx(Ne,{className:"p-3",children:s.jsxs(Ce,{className:"flex items-center gap-1 text-sm",children:[s.jsx(qa,{className:"h-4 w-4"}),"Schnell-Material"]})}),s.jsxs(ce,{className:"space-y-2 p-3",children:[s.jsxs("select",{value:ge.projectId,onChange:_e=>se($e=>({...$e,projectId:_e.target.value})),className:"w-full p-1.5 border rounded text-xs",children:[s.jsx("option",{value:"",children:"Projekt wählen..."}),f.map(_e=>s.jsx("option",{value:_e.id,children:_e.name},_e.id))]}),s.jsx("input",{type:"text",placeholder:"Material...",value:ge.material,onChange:_e=>se($e=>({...$e,material:_e.target.value})),className:"w-full p-1.5 border rounded text-xs"}),s.jsxs("div",{className:"flex gap-0.5",children:[s.jsx("input",{type:"number",placeholder:"Menge",value:ge.quantity,onChange:_e=>se($e=>({...$e,quantity:_e.target.value})),className:"flex-1 min-w-0 p-1.5 border rounded text-xs"}),s.jsxs("select",{value:ge.unit,onChange:_e=>se($e=>({...$e,unit:_e.target.value})),className:"p-1.5 border rounded text-xs w-12",children:[s.jsx("option",{value:"Stück",children:"Stk"}),s.jsx("option",{value:"Meter",children:"m"}),s.jsx("option",{value:"kg",children:"kg"}),s.jsx("option",{value:"Liter",children:"L"})]})]}),s.jsx(ee,{onClick:Un,disabled:!ge.material||!ge.quantity,className:"w-full",size:"sm",children:"Material erfassen"})]})]})]})},Tn=()=>s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"📚 Dokumentation"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsx(Ce,{className:"text-base flex items-center gap-2",children:"📱 App Bedienung"})}),s.jsxs(ce,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Start-Tab:"})," Übersicht und Schnellzugriff"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Zeit-Tab:"})," Zeiterfassung starten/stoppen"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Signatur-Tab:"})," Lieferscheine digital unterschreiben"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Profil-Tab:"})," Persönliche Einstellungen"]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsx(Ce,{className:"text-base flex items-center gap-2",children:"⏱️ Zeiterfassung"})}),s.jsxs(ce,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Starten:"}),' Projekt auswählen → "Start" drücken']}),s.jsxs("div",{children:[s.jsx("strong",{children:"Pausieren:"}),' "Pause" für Unterbrechungen']}),s.jsxs("div",{children:[s.jsx("strong",{children:"Beenden:"}),' "Stop" → Notizen hinzufügen']}),s.jsxs("div",{children:[s.jsx("strong",{children:"Arten:"})," Arbeitszeit, Pause, Fahrtzeit"]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsx(Ce,{className:"text-base flex items-center gap-2",children:"✍️ Digitale Signaturen"})}),s.jsxs(ce,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Lieferschein:"})," Wareneingänge bestätigen"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Auftragsabschluss:"})," Arbeiten abzeichnen"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Qualitätskontrolle:"})," Prüfungen dokumentieren"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Speicherung:"})," Automatisch in der Cloud"]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsx(Ce,{className:"text-base flex items-center gap-2",children:"📶 Offline Modus"})}),s.jsxs(ce,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Zeiterfassung:"})," Funktioniert ohne Internet"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Signaturen:"})," Werden lokal gespeichert"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Synchronisation:"})," Automatisch bei Verbindung"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Status:"})," Symbol zeigt Verbindung an"]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsx(Ce,{className:"text-base flex items-center gap-2",children:"💡 Tipps & Tricks"})}),s.jsxs(ce,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Batterie sparen:"})," App läuft im Hintergrund"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Genauigkeit:"})," GPS für Standortverfolgung"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Daten:"})," Arbeitet auch im mobilen Netz"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Updates:"})," App automatisch aktualisieren"]})]})]}),s.jsxs(oe,{children:[s.jsx(Ne,{className:"pb-3",children:s.jsx(Ce,{className:"text-base flex items-center gap-2",children:"🆘 Support"})}),s.jsxs(ce,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Probleme:"})," IT-Abteilung kontaktieren"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Schulung:"})," Bei Fragen an Vorgesetzte wenden"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Version:"})," HandwerkOS Mobile v1.0"]})]})]})]})]}),rs=()=>s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Profil"}),s.jsx(oe,{children:s.jsxs(ce,{className:"p-3",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-2",children:s.jsx(pr,{className:"h-8 w-8 text-white"})}),s.jsx("h4",{className:"font-semibold",children:t==null?void 0:t.email}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Mitarbeiter"})]}),s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Status:"}),s.jsx(Qe,{variant:"outline",className:"text-green-600",children:"Aktiv"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Standort:"}),s.jsx("span",{className:"text-gray-600",children:c?"Verfügbar":"Nicht verfügbar"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Offline-Daten:"}),s.jsxs("span",{className:"text-gray-600",children:[JSON.parse(localStorage.getItem("completedTimeEntries")||"[]").length," Einträge"]})]})]})]})}),!i&&s.jsx(oe,{className:"border-orange-400 bg-orange-50",children:s.jsxs(ce,{className:"p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-orange-700",children:[s.jsx(Xb,{className:"h-4 w-4"}),s.jsx("span",{className:"font-medium",children:"Offline-Modus"})]}),s.jsx("p",{className:"text-orange-600 text-sm mt-1",children:"Daten werden bei nächster Verbindung synchronisiert."})]})})]});return s.jsxs("div",{className:"h-full bg-gray-50 flex flex-col relative overflow-hidden",style:{width:"100vw",maxWidth:"none",paddingTop:"44px"},children:[s.jsxs("div",{className:"flex-1 px-3 pt-2 pb-20 overflow-y-auto overflow-x-hidden",children:[r==="home"&&dn(),r==="docs"&&Tn(),r==="time"&&s.jsx("div",{className:"h-full -mx-3 -mb-16",style:{marginTop:"-52px"},children:s.jsx(tre,{})}),r==="signature"&&s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsx(nre,{className:"pb-4"})}),r==="profile"&&rs()]}),s.jsx("div",{className:"absolute left-0 right-0 bottom-0 bg-white border-t shadow-lg pb-safe",children:s.jsx("div",{className:"grid grid-cols-5 gap-1 p-2",children:[{id:"home",icon:oB,label:"Start"},{id:"docs",icon:wn,label:"Dokumentation"},{id:"time",icon:an,label:"Zeit"},{id:"signature",icon:Dl,label:"Signatur"},{id:"profile",icon:pr,label:"Profil"}].map(je=>s.jsxs(ee,{variant:r===je.id?"default":"ghost",size:"sm",onClick:()=>a(je.id),className:"flex flex-col gap-0.5 h-14 p-1 relative",children:[s.jsx(je.icon,{className:"h-4 w-4"}),s.jsx("span",{className:"text-xs",children:je.label})]},je.id))})}),x&&s.jsxs("div",{className:"fixed inset-0 z-50 bg-black",children:[s.jsx("video",{ref:O,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}),s.jsx("canvas",{ref:K,className:"hidden"}),s.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-4",children:[s.jsx(ee,{onClick:Oe,className:"bg-white text-black hover:bg-gray-200 rounded-full w-16 h-16",children:s.jsx(P_,{className:"h-8 w-8"})}),s.jsx(ee,{onClick:be,variant:"outline",className:"bg-white text-black hover:bg-gray-200 rounded-full w-16 h-16",children:s.jsx(Ln,{className:"h-8 w-8"})})]})]}),s.jsx(Kt,{open:P,onOpenChange:M,children:s.jsxs(Wt,{children:[s.jsx(Jt,{children:s.jsx(en,{children:"Rechnung hochladen"})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Datei auswählen"}),s.jsx("input",{ref:F,type:"file",accept:"image/*,.pdf",className:"w-full p-2 border rounded-md"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Betrag (optional)"}),s.jsx(ae,{type:"number",step:"0.01",placeholder:"0.00",value:ue,onChange:je=>de(je.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Beschreibung (optional)"}),s.jsx(cn,{placeholder:"Beschreibung der Rechnung...",value:W,onChange:je=>X(je.target.value)})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ee,{onClick:()=>{var _e,$e;const je=($e=(_e=F.current)==null?void 0:_e.files)==null?void 0:$e[0];je&&V&&lt(je,V)},disabled:!((bn=(Mn=F.current)==null?void 0:Mn.files)!=null&&bn[0]),className:"flex-1",children:[s.jsx(cP,{className:"h-4 w-4 mr-2"}),"Hochladen"]}),s.jsx(ee,{variant:"outline",onClick:()=>M(!1),children:"Abbrechen"})]})]})]})}),s.jsx(Kt,{open:z,onOpenChange:R,children:s.jsxs(Wt,{children:[s.jsx(Jt,{children:s.jsx(en,{children:"Notiz hinzufügen"})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kommentar"}),s.jsx(cn,{placeholder:"Ihre Notiz zum Projekt...",value:G,onChange:je=>I(je.target.value),rows:4})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ee,{onClick:()=>{G.trim()&&V&&He(V,G.trim())},disabled:!G.trim(),className:"flex-1",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Hinzufügen"]}),s.jsx(ee,{variant:"outline",onClick:()=>{R(!1),I("")},children:"Abbrechen"})]})]})]})}),s.jsx(HI,{open:Q,onOpenChange:re,onSuccess:qe})]})},GO=()=>{const{user:t,loading:e}=Fr(),n=Za();return g.useEffect(()=>{!e&&!t&&n("/auth")},[t,e,n]),e?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-gray-500",children:"Wird geladen..."})})}):t?s.jsx(ZO,{}):s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-gray-500",children:"Nicht angemeldet. Weiterleitung..."})})})},sre=()=>{const t=Za(),[e]=xj(),{toast:n}=Mt();return g.useEffect(()=>{(async()=>{const a=e.get("code"),i=e.get("error");if(i){n({title:"Gmail Verbindung fehlgeschlagen",description:`Fehler: ${i}`,variant:"destructive"}),t("/");return}if(!a){n({title:"Gmail Verbindung fehlgeschlagen",description:"Kein Autorisierungscode erhalten",variant:"destructive"}),t("/");return}try{const{data:{user:o}}=await Z.auth.getUser();if(!o){n({title:"Fehler",description:"Sie müssen angemeldet sein",variant:"destructive"}),t("/auth");return}const{data:c,error:d}=await Z.functions.invoke("gmail-oauth-callback",{body:{code:a}});d?(console.error("Gmail callback error:",d),n({title:"Gmail Verbindung fehlgeschlagen",description:d.message||"Ein Fehler ist aufgetreten",variant:"destructive"})):n({title:"Gmail erfolgreich verbunden",description:`E-Mail Konto ${c.email} wurde verbunden`})}catch(o){console.error("Error during Gmail callback:",o),n({title:"Gmail Verbindung fehlgeschlagen",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}t("/")})()},[e,t,n]),s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"mt-4 text-lg",children:"Gmail Verbindung wird verarbeitet..."})]})})},rre=()=>s.jsx("div",{className:"min-h-screen bg-background p-4",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs(Zi,{to:"/",className:"inline-flex items-center gap-2 text-primary hover:text-primary/80 mb-6",children:[s.jsx(ZF,{className:"h-4 w-4"}),"Zurück zur Startseite"]}),s.jsxs(oe,{children:[s.jsxs(Ne,{children:[s.jsx(Ce,{className:"text-3xl font-bold",children:"Datenschutzerklärung"}),s.jsxs("p",{className:"text-muted-foreground",children:["Zuletzt aktualisiert: ",new Date().toLocaleDateString("de-DE")]})]}),s.jsx(ce,{className:"prose prose-slate max-w-none",children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"1. Verantwortlicher"}),s.jsx("p",{className:"mb-4",children:"Verantwortlicher für die Datenverarbeitung auf dieser Website ist:"}),s.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[s.jsx("p",{className:"font-semibold",children:"HandwerkOS"}),s.jsx("p",{children:"E-Mail: info@handwerkos.de"}),s.jsx("p",{children:"Website: https://handwerkos.de"})]})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"2. Allgemeine Hinweise"}),s.jsx("p",{className:"mb-4",children:"Die folgenden Hinweise geben einen einfachen Überblick darüber, was mit Ihren personenbezogenen Daten passiert, wenn Sie diese Website besuchen. Personenbezogene Daten sind alle Daten, mit denen Sie persönlich identifiziert werden können."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"3. Datenerfassung auf dieser Website"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.1 Cookies"}),s.jsx("p",{className:"mb-4",children:"Diese Website verwendet Cookies. Cookies sind kleine Textdateien, die auf Ihrem Rechner abgelegt werden und die Ihr Browser speichert. Sie dienen dazu, unser Angebot nutzerfreundlicher, effektiver und sicherer zu machen."}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.2 Server-Log-Dateien"}),s.jsx("p",{className:"mb-4",children:"Der Provider der Seiten erhebt und speichert automatisch Informationen in so genannten Server-Log-Dateien, die Ihr Browser automatisch an uns übermittelt. Dies sind:"}),s.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[s.jsx("li",{children:"Browsertyp und Browserversion"}),s.jsx("li",{children:"Verwendetes Betriebssystem"}),s.jsx("li",{children:"Referrer URL"}),s.jsx("li",{children:"Hostname des zugreifenden Rechners"}),s.jsx("li",{children:"Uhrzeit der Serveranfrage"}),s.jsx("li",{children:"IP-Adresse"})]}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.3 Kontaktformular"}),s.jsx("p",{className:"mb-4",children:"Wenn Sie uns per Kontaktformular Anfragen zukommen lassen, werden Ihre Angaben aus dem Anfrageformular inklusive der von Ihnen dort angegebenen Kontaktdaten zwecks Bearbeitung der Anfrage und für den Fall von Anschlussfragen bei uns gespeichert."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"4. Registrierung und Nutzerkonten"}),s.jsx("p",{className:"mb-4",children:"Sie können sich auf dieser Website registrieren, um zusätzliche Funktionen zu nutzen. Die dazu eingegebenen Daten verwenden wir nur zum Zwecke der Nutzung des jeweiligen Angebotes oder Dienstes. Die bei der Registrierung abgefragten Pflichtangaben müssen vollständig angegeben werden."}),s.jsx("p",{className:"mb-4",children:"Folgende Daten werden bei der Registrierung erhoben:"}),s.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[s.jsx("li",{children:"E-Mail-Adresse"}),s.jsx("li",{children:"Firmenname"}),s.jsx("li",{children:"Vor- und Nachname"}),s.jsx("li",{children:"Telefonnummer"}),s.jsx("li",{children:"Adresse"}),s.jsx("li",{children:"Steuerliche Informationen (optional)"})]})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"5. Gmail-Integration"}),s.jsx("p",{className:"mb-4",children:"Unsere Software bietet die Möglichkeit, Ihr Gmail-Konto zu verbinden. Dabei werden folgende Daten verarbeitet:"}),s.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[s.jsx("li",{children:"E-Mail-Adresse Ihres Gmail-Kontos"}),s.jsx("li",{children:"Zugriffstokens für die Gmail-API"}),s.jsx("li",{children:"E-Mail-Inhalte zur Kategorisierung und Verarbeitung"})]}),s.jsx("p",{className:"mb-4",children:"Diese Daten werden nur zur Bereitstellung der E-Mail-Verwaltungsfunktionen verwendet und nicht an Dritte weitergegeben."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"6. Zeiterfassung und Mitarbeiterdaten"}),s.jsx("p",{className:"mb-4",children:"Unsere Software erfasst Arbeitszeiten und Mitarbeiterdaten. Dabei werden folgende Informationen gespeichert:"}),s.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[s.jsx("li",{children:"Arbeitszeiten (Start-, Endzeiten, Pausen)"}),s.jsx("li",{children:"Standortdaten (bei aktivierter Standorterfassung)"}),s.jsx("li",{children:"Mitarbeiterstammdaten"}),s.jsx("li",{children:"Projektbezogene Zeiterfassungen"})]})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"7. Ihre Rechte"}),s.jsx("p",{className:"mb-4",children:"Sie haben folgende Rechte:"}),s.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[s.jsx("li",{children:"Recht auf Auskunft über Ihre gespeicherten personenbezogenen Daten"}),s.jsx("li",{children:"Recht auf Berichtigung unrichtiger Daten"}),s.jsx("li",{children:"Recht auf Löschung Ihrer Daten"}),s.jsx("li",{children:"Recht auf Einschränkung der Datenverarbeitung"}),s.jsx("li",{children:"Recht auf Datenübertragbarkeit"}),s.jsx("li",{children:"Widerspruchsrecht gegen die Datenverarbeitung"})]})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"8. Datensicherheit"}),s.jsx("p",{className:"mb-4",children:"Wir verwenden innerhalb des Website-Besuchs das verbreitete SSL-Verfahren (Secure Socket Layer) in Verbindung mit der jeweils höchsten Verschlüsselungsstufe, die von Ihrem Browser unterstützt wird. Alle Daten werden verschlüsselt übertragen und in sicheren Rechenzentren gespeichert."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"9. Drittanbieter"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"9.1 Supabase"}),s.jsx("p",{className:"mb-4",children:"Wir nutzen Supabase als Backend-Dienstleister. Supabase verarbeitet Daten in unserem Auftrag und ist vertraglich zur Einhaltung der Datenschutzbestimmungen verpflichtet."}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"9.2 Google APIs"}),s.jsx("p",{className:"mb-4",children:"Für die Gmail-Integration nutzen wir Google APIs. Die Nutzung unterliegt den Datenschutzbestimmungen von Google."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"10. Änderungen dieser Datenschutzerklärung"}),s.jsx("p",{className:"mb-4",children:"Wir behalten uns vor, diese Datenschutzerklärung anzupassen, damit sie stets den aktuellen rechtlichen Anforderungen entspricht oder um Änderungen unserer Leistungen in der Datenschutzerklärung umzusetzen."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"11. Kontakt"}),s.jsx("p",{className:"mb-4",children:"Bei Fragen zum Datenschutz wenden Sie sich bitte an:"}),s.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[s.jsx("p",{children:"E-Mail: datenschutz@handwerkos.de"}),s.jsx("p",{children:"Oder nutzen Sie unser Kontaktformular auf der Website."})]})]})]})})]})]})}),are=()=>{const t=Hd();return g.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),s.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),s.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},ire=()=>{const t=Za(),[e]=xj(),[n,r]=g.useState(""),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(""),[m,f]=g.useState(""),[p,x]=g.useState(!1),[j,v]=g.useState(""),[_,b]=g.useState(null);g.useEffect(()=>{(async()=>{var C,A;const S=e.get("token");if(console.log("=== DEBUGGING TOKEN VALIDATION ==="),console.log("URL:",window.location.href),console.log("Token from URL:",S),!S){console.error("No token found in URL"),Ue.error("Fehlender Einladungstoken. Bitte verwenden Sie den vollständigen Link aus der E-Mail.");return}try{console.log("Attempting to validate token:",S);const{data:P,error:M}=await Z.from("employee_invitations").select("*");console.log("All invitations in DB:",P),console.log("List error:",M);const{data:z,error:R}=await Z.from("employee_invitations").select("*").eq("invite_token",S).eq("status","pending").single();if(console.log("Query result:",{invitation:z,inviteError:R}),R){console.error("Database error:",R),R.code==="PGRST116"?Ue.error("Einladung nicht gefunden. Möglicherweise wurde sie bereits verwendet oder ist abgelaufen."):Ue.error(`Datenbankfehler: ${R.message}`);return}if(!z){console.error("No invitation found for token"),Ue.error("Ungültiger Einladungslink. Bitte wenden Sie sich an Ihren Manager.");return}const D=new Date(z.expires_at),B=new Date;if(console.log("Token expires:",D),console.log("Current time:",B),console.log("Is expired:",D<B),D<B){console.error("Invitation token expired"),Ue.error("Dieser Einladungslink ist abgelaufen. Bitte fordern Sie eine neue Einladung an.");return}console.log("Valid invitation found:",z),console.log("Employee data:",z.employee_data),r(z.email),u(((C=z.employee_data)==null?void 0:C.firstName)||""),f(((A=z.employee_data)==null?void 0:A.lastName)||""),b(z)}catch(P){console.error("Exception during validation:",P),Ue.error(`Fehler beim Validieren der Einladung: ${P==null?void 0:P.message}`)}})()},[e]);const w=async N=>{if(N.preventDefault(),v(""),!_){v("Einladungsdaten nicht gefunden. Bitte verwenden Sie den Link aus der E-Mail erneut.");return}if(a!==o){v("Passwörter stimmen nicht überein");return}if(a.length<8){v("Passwort muss mindestens 8 Zeichen lang sein");return}x(!0);try{console.log("Creating account for employee:",_.email);const{data:S,error:C}=await Z.auth.signUp({email:_.email,password:a,options:{data:{first_name:d,last_name:m,company_id:_.company_id}}});if(C){console.error("Error creating user account:",C),v(C.message||"Fehler beim Erstellen des Kontos");return}S.user&&(await Z.from("employee_invitations").update({status:"accepted"}).eq("invite_token",_.invite_token),await Z.from("user_roles").insert({user_id:S.user.id,role:"employee"}),console.log("Employee account created successfully"),Ue.success("Konto erfolgreich erstellt! Sie werden zur Anmeldung weitergeleitet."),setTimeout(()=>t("/auth"),1500))}catch(S){console.error("Error during employee registration:",S),v("Fehler beim Erstellen des Kontos")}finally{x(!1)}};return _?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:s.jsxs(oe,{className:"w-full max-w-md",children:[s.jsxs(Ne,{className:"text-center",children:[s.jsx(Ce,{className:"text-2xl font-bold",children:"Willkommen im Team!"}),s.jsx(ds,{children:"Erstellen Sie Ihr Passwort für Ihr HandwerkOS-Konto"})]}),s.jsx(ce,{children:s.jsxs("form",{onSubmit:w,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"firstName",children:"Vorname"}),s.jsx(ae,{id:"firstName",type:"text",value:d,onChange:N=>u(N.target.value),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"lastName",children:"Nachname"}),s.jsx(ae,{id:"lastName",type:"text",value:m,onChange:N=>f(N.target.value),required:!0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"email",children:"E-Mail"}),s.jsx(ae,{id:"email",type:"email",value:n,disabled:!0,className:"bg-gray-50"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"password",children:"Passwort"}),s.jsx(ae,{id:"password",type:"password",value:a,onChange:N=>i(N.target.value),required:!0,minLength:8,placeholder:"Mindestens 8 Zeichen"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(Y,{htmlFor:"confirmPassword",children:"Passwort bestätigen"}),s.jsx(ae,{id:"confirmPassword",type:"password",value:o,onChange:N=>c(N.target.value),required:!0,minLength:8,placeholder:"Passwort wiederholen"})]}),j&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:j}),s.jsx(ee,{type:"submit",className:"w-full",disabled:p,children:p?"Konto wird erstellt...":"Konto erstellen"})]})})]})}):s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-gray-500",children:"Einladung wird validiert..."})})})},ore=[{title:"Angebote & Aufträge",desc:"Erstellen Sie Angebote in Minuten und wandeln Sie sie mit einem Klick in Aufträge und Rechnungen um.",Icon:wn},{title:"Projektmanagement",desc:"Aufgaben, Materialien, Dokumente und Fortschritt zentral im Blick.",Icon:eB},{title:"Zeiterfassung & Mobil",desc:"Einfache mobile Erfassung mit GPS‑Option – auch offline.",Icon:an},{title:"E‑Mail‑Integration",desc:"Gmail/IMAP verknüpfen und Mails Projekten & Kunden zuordnen.",Icon:es},{title:"Material & Lager",desc:"Bestände verwalten, Bedarf planen, Nachbestellungen vorbereiten.",Icon:QF},{title:"Finanzen & Rechnungen",desc:"Vom Angebot zur Rechnung – schnell, übersichtlich, zuverlässig.",Icon:lr}];function lre(){return s.jsxs("div",{className:"space-y-12",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Alles was Sie brauchen"}),s.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Eine vollständige Lösung für moderne Handwerksbetriebe – von der Angebotserstellung bis zur Abrechnung."})]}),s.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:ore.map(({title:t,desc:e,Icon:n},r)=>s.jsxs(oe,{className:"group relative p-8 border-0 bg-white/80 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/50 to-indigo-50/50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),s.jsxs("div",{className:"relative mb-6",children:[s.jsx("div",{className:"inline-flex h-14 w-14 items-center justify-center rounded-2xl bg-gradient-to-r from-blue-100 to-indigo-100 group-hover:from-blue-200 group-hover:to-indigo-200 transition-all duration-300",children:s.jsx(n,{className:"h-7 w-7 text-blue-600 group-hover:text-indigo-600 transition-colors duration-300"})}),s.jsx("div",{className:"absolute -top-2 -right-2 h-6 w-6 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-center text-white text-xs font-bold",children:r+1})]}),s.jsxs("div",{className:"relative space-y-3",children:[s.jsx("h3",{className:"text-xl font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:t}),s.jsx("p",{className:"text-slate-600 leading-relaxed",children:e})]}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-600 to-indigo-600 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"})]},t))}),s.jsx("div",{className:"text-center pt-8",children:s.jsxs("div",{className:"inline-flex items-center gap-2 text-sm text-slate-500 bg-slate-50 px-4 py-2 rounded-full",children:[s.jsx("svg",{className:"h-4 w-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"Alle Funktionen in einem System – keine separaten Tools erforderlich"})]})})]})}const cre=[{title:"Angebote & Rechnungen",desc:"Von der Anfrage bis zur Zahlung – alles nahtlos verbunden."},{title:"Projekte & Aufgaben",desc:"Status, Verantwortliche, Dokumente und Fortschritte im Team koordinieren."},{title:"Zeiten & Einsatzplanung",desc:"Zeiten erfassen, Auslastung sehen, Planung vereinfachen."},{title:"E‑Mails & Kommunikation",desc:"Zentrale Transparenz – nichts geht mehr verloren."}];function dre(){return s.jsxs("div",{className:"space-y-12",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Integrierte Module"}),s.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Alle wichtigen Bereiche Ihres Handwerksbetriebs in einer einzigen Plattform vereint."})]}),s.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:cre.map((t,e)=>s.jsxs(oe,{className:"group relative p-8 border-0 bg-white/80 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-500 hover:-translate-y-1 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/30 via-indigo-50/30 to-purple-50/30 opacity-0 group-hover:opacity-100 transition-all duration-500"}),s.jsxs("div",{className:"relative flex items-start gap-6",children:[s.jsxs("div",{className:"relative w-32 h-24 shrink-0 rounded-2xl border border-slate-200/50 bg-gradient-to-br from-slate-50 to-slate-100 overflow-hidden group-hover:shadow-xl transition-all duration-500",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-100/50 via-indigo-100/50 to-purple-100/50 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),s.jsxs("div",{className:"absolute inset-3 space-y-2",children:[s.jsx("div",{className:"h-2 bg-gradient-to-r from-blue-300 to-indigo-300 rounded-full w-3/4"}),s.jsx("div",{className:"h-2 bg-gradient-to-r from-indigo-300 to-purple-300 rounded-full w-1/2"}),s.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-1",children:[s.jsx("div",{className:"h-3 bg-blue-200/70 rounded"}),s.jsx("div",{className:"h-3 bg-indigo-200/70 rounded"})]})]}),s.jsx("div",{className:"absolute -top-2 -right-2 h-7 w-7 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-center text-white text-xs font-bold shadow-lg",children:e+1})]}),s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsx("h3",{className:"text-2xl font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:t.title}),s.jsx("p",{className:"text-slate-600 leading-relaxed text-lg",children:t.desc}),s.jsx("div",{className:"pt-2 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0",children:s.jsxs("div",{className:"inline-flex items-center text-blue-600 font-medium text-sm cursor-pointer",children:["Mehr erfahren",s.jsx("svg",{className:"ml-1 h-4 w-4 transition-transform group-hover:translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})})]})]}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-600 to-indigo-600 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-500 origin-left"})]},t.title))}),s.jsx("div",{className:"text-center pt-8",children:s.jsxs("div",{className:"inline-flex items-center gap-3 bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 rounded-2xl border border-blue-200/30",children:[s.jsxs("div",{className:"flex -space-x-2",children:[s.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-blue-500 to-blue-600 border-2 border-white flex items-center justify-center",children:s.jsx("span",{className:"text-white text-xs font-bold",children:"1"})}),s.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-indigo-500 to-indigo-600 border-2 border-white flex items-center justify-center",children:s.jsx("span",{className:"text-white text-xs font-bold",children:"2"})}),s.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-purple-500 to-purple-600 border-2 border-white flex items-center justify-center",children:s.jsx("span",{className:"text-white text-xs font-bold",children:"3"})})]}),s.jsx("span",{className:"text-slate-700 font-medium",children:"Alle Module arbeiten nahtlos zusammen"})]})})]})}const ure=[{title:"Gmail / IMAP",desc:"E‑Mails synchronisieren und Projekten zuordnen.",Icon:es},{title:"Google Kalender",desc:"Termine und Einsätze direkt im Kalender planen.",Icon:Lt}];function hre(){return s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-6",children:"Direkte Integrationen"}),s.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:ure.map(({title:t,desc:e,Icon:n})=>s.jsxs(oe,{className:"p-6 flex items-center gap-4 hover-scale",children:[s.jsx("div",{className:"inline-flex h-10 w-10 items-center justify-center rounded-md bg-primary/10 text-primary",children:s.jsx(n,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-1",children:t}),s.jsx("p",{className:"text-muted-foreground",children:e})]})]},t))})]})}const fre=[{quote:"Mit HandwerkOS erstellen wir Angebote schneller und behalten Projekte endlich zentral im Blick.",author:"Malerbetrieb Schuster"},{quote:"Unsere Monteure buchen Zeiten mobil – die Abrechnung geht dadurch viel zügiger.",author:"Elektro König"},{quote:"Die E‑Mail‑Zuordnung spart uns täglich Zeit, weil alles direkt beim Projekt liegt.",author:"Sanitär & Heizung Weber"}];function mre(){return s.jsxs("div",{className:"space-y-12",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Erfolgsgeschichten"}),s.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Über 1.000 Handwerksbetriebe vertrauen bereits auf HandwerkOS."})]}),s.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:fre.map((t,e)=>s.jsxs(oe,{className:"group relative p-8 border-0 bg-white/90 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 overflow-hidden",children:[s.jsx("div",{className:"absolute top-4 left-4 text-6xl text-blue-100/50 font-serif leading-none select-none",children:'"'}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/20 to-indigo-50/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),s.jsxs("div",{className:"relative space-y-6",children:[s.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((n,r)=>s.jsx("svg",{className:"h-5 w-5 text-yellow-400 fill-current",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},r))}),s.jsxs("blockquote",{className:"text-lg text-slate-700 leading-relaxed italic",children:['"',t.quote,'"']}),s.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-slate-100",children:[s.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center text-white font-bold text-lg",children:t.author.charAt(0)}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-slate-900",children:t.author}),s.jsx("div",{className:"text-sm text-slate-500",children:"Handwerksbetrieb"})]})]})]}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 to-indigo-500 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-center"})]},e))}),s.jsxs("div",{className:"flex justify-center items-center gap-8 pt-8",children:[s.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[s.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center",children:s.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-2xl text-slate-900",children:"1.000+"}),s.jsx("div",{className:"text-sm text-slate-600",children:"Zufriedene Betriebe"})]})]}),s.jsx("div",{className:"h-12 w-px bg-slate-200"}),s.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[s.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx("svg",{className:"h-6 w-6 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-2xl text-slate-900",children:"4.9/5"}),s.jsx("div",{className:"text-sm text-slate-600",children:"Bewertung"})]})]})]})]})}var U1="Collapsible",[pre,QO]=wr(U1),[gre,q1]=pre(U1),YO=g.forwardRef((t,e)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:i,onOpenChange:o,...c}=t,[d=!1,u]=Lr({prop:r,defaultProp:a,onChange:o});return s.jsx(gre,{scope:n,disabled:i,contentId:dr(),open:d,onOpenToggle:g.useCallback(()=>u(m=>!m),[u]),children:s.jsx(nt.div,{"data-state":H1(d),"data-disabled":i?"":void 0,...c,ref:e})})});YO.displayName=U1;var XO="CollapsibleTrigger",JO=g.forwardRef((t,e)=>{const{__scopeCollapsible:n,...r}=t,a=q1(XO,n);return s.jsx(nt.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":H1(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:e,onClick:Re(t.onClick,a.onOpenToggle)})});JO.displayName=XO;var W1="CollapsibleContent",e5=g.forwardRef((t,e)=>{const{forceMount:n,...r}=t,a=q1(W1,t.__scopeCollapsible);return s.jsx(Gn,{present:n||a.open,children:({present:i})=>s.jsx(xre,{...r,ref:e,present:i})})});e5.displayName=W1;var xre=g.forwardRef((t,e)=>{const{__scopeCollapsible:n,present:r,children:a,...i}=t,o=q1(W1,n),[c,d]=g.useState(r),u=g.useRef(null),m=Tt(e,u),f=g.useRef(0),p=f.current,x=g.useRef(0),j=x.current,v=o.open||c,_=g.useRef(v),b=g.useRef();return g.useEffect(()=>{const w=requestAnimationFrame(()=>_.current=!1);return()=>cancelAnimationFrame(w)},[]),Bn(()=>{const w=u.current;if(w){b.current=b.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const N=w.getBoundingClientRect();f.current=N.height,x.current=N.width,_.current||(w.style.transitionDuration=b.current.transitionDuration,w.style.animationName=b.current.animationName),d(r)}},[o.open,r]),s.jsx(nt.div,{"data-state":H1(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!v,...i,ref:m,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":j?`${j}px`:void 0,...t.style},children:v&&a})});function H1(t){return t?"open":"closed"}var vre=YO,yre=JO,_re=e5,Ei="Accordion",wre=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[V1,bre,jre]=pf(Ei),[tx,kae]=wr(Ei,[jre,QO]),K1=QO(),t5=Ae.forwardRef((t,e)=>{const{type:n,...r}=t,a=r,i=r;return s.jsx(V1.Provider,{scope:t.__scopeAccordion,children:n==="multiple"?s.jsx(Cre,{...i,ref:e}):s.jsx(kre,{...a,ref:e})})});t5.displayName=Ei;var[n5,Nre]=tx(Ei),[s5,Sre]=tx(Ei,{collapsible:!1}),kre=Ae.forwardRef((t,e)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:i=!1,...o}=t,[c,d]=Lr({prop:n,defaultProp:r,onChange:a});return s.jsx(n5,{scope:t.__scopeAccordion,value:c?[c]:[],onItemOpen:d,onItemClose:Ae.useCallback(()=>i&&d(""),[i,d]),children:s.jsx(s5,{scope:t.__scopeAccordion,collapsible:i,children:s.jsx(r5,{...o,ref:e})})})}),Cre=Ae.forwardRef((t,e)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...i}=t,[o=[],c]=Lr({prop:n,defaultProp:r,onChange:a}),d=Ae.useCallback(m=>c((f=[])=>[...f,m]),[c]),u=Ae.useCallback(m=>c((f=[])=>f.filter(p=>p!==m)),[c]);return s.jsx(n5,{scope:t.__scopeAccordion,value:o,onItemOpen:d,onItemClose:u,children:s.jsx(s5,{scope:t.__scopeAccordion,collapsible:!0,children:s.jsx(r5,{...i,ref:e})})})}),[Ere,nx]=tx(Ei),r5=Ae.forwardRef((t,e)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:i="vertical",...o}=t,c=Ae.useRef(null),d=Tt(c,e),u=bre(n),f=Gd(a)==="ltr",p=Re(t.onKeyDown,x=>{var M;if(!wre.includes(x.key))return;const j=x.target,v=u().filter(z=>{var R;return!((R=z.ref.current)!=null&&R.disabled)}),_=v.findIndex(z=>z.ref.current===j),b=v.length;if(_===-1)return;x.preventDefault();let w=_;const N=0,S=b-1,C=()=>{w=_+1,w>S&&(w=N)},A=()=>{w=_-1,w<N&&(w=S)};switch(x.key){case"Home":w=N;break;case"End":w=S;break;case"ArrowRight":i==="horizontal"&&(f?C():A());break;case"ArrowDown":i==="vertical"&&C();break;case"ArrowLeft":i==="horizontal"&&(f?A():C());break;case"ArrowUp":i==="vertical"&&A();break}const P=w%b;(M=v[P].ref.current)==null||M.focus()});return s.jsx(Ere,{scope:n,disabled:r,direction:a,orientation:i,children:s.jsx(V1.Slot,{scope:n,children:s.jsx(nt.div,{...o,"data-orientation":i,ref:d,onKeyDown:r?void 0:p})})})}),B0="AccordionItem",[Are,Z1]=tx(B0),a5=Ae.forwardRef((t,e)=>{const{__scopeAccordion:n,value:r,...a}=t,i=nx(B0,n),o=Nre(B0,n),c=K1(n),d=dr(),u=r&&o.value.includes(r)||!1,m=i.disabled||t.disabled;return s.jsx(Are,{scope:n,open:u,disabled:m,triggerId:d,children:s.jsx(vre,{"data-orientation":i.orientation,"data-state":u5(u),...c,...a,ref:e,disabled:m,open:u,onOpenChange:f=>{f?o.onItemOpen(r):o.onItemClose(r)}})})});a5.displayName=B0;var i5="AccordionHeader",o5=Ae.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,a=nx(Ei,n),i=Z1(i5,n);return s.jsx(nt.h3,{"data-orientation":a.orientation,"data-state":u5(i.open),"data-disabled":i.disabled?"":void 0,...r,ref:e})});o5.displayName=i5;var Zw="AccordionTrigger",l5=Ae.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,a=nx(Ei,n),i=Z1(Zw,n),o=Sre(Zw,n),c=K1(n);return s.jsx(V1.ItemSlot,{scope:n,children:s.jsx(yre,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":a.orientation,id:i.triggerId,...c,...r,ref:e})})});l5.displayName=Zw;var c5="AccordionContent",d5=Ae.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,a=nx(Ei,n),i=Z1(c5,n),o=K1(n);return s.jsx(_re,{role:"region","aria-labelledby":i.triggerId,"data-orientation":a.orientation,...o,...r,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});d5.displayName=c5;function u5(t){return t?"open":"closed"}var Pre=t5,Dre=a5,Tre=o5,h5=l5,f5=d5;const Mre=Pre,m5=g.forwardRef(({className:t,...e},n)=>s.jsx(Dre,{ref:n,className:Te("border-b",t),...e}));m5.displayName="AccordionItem";const p5=g.forwardRef(({className:t,children:e,...n},r)=>s.jsx(Tre,{className:"flex",children:s.jsxs(h5,{ref:r,className:Te("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...n,children:[e,s.jsx(ag,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));p5.displayName=h5.displayName;const g5=g.forwardRef(({className:t,children:e,...n},r)=>s.jsx(f5,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:s.jsx("div",{className:Te("pb-4 pt-0",t),children:e})}));g5.displayName=f5.displayName;const Rre=[{q:"Ist HandwerkOS DSGVO‑konform?",a:"Ja. Wir legen großen Wert auf Datenschutz und Sicherheit und unterstützen eine DSGVO‑konforme Nutzung."},{q:"Kann ich HandwerkOS mobil nutzen?",a:"Ja. HandwerkOS ist als Web‑App nutzbar und unterstützt iOS & Android über Capacitor."},{q:"Wie starte ich?",a:"Klicken Sie auf ‘Kostenlos testen’ – die Einrichtung dauert nur wenige Minuten."}];function Ire(){return s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-6",children:"Häufige Fragen"}),s.jsx(Mre,{type:"single",collapsible:!0,className:"w-full",children:Rre.map((t,e)=>s.jsxs(m5,{value:`faq-${e}`,children:[s.jsx(p5,{children:t.q}),s.jsx(g5,{children:t.a})]},e))})]})}function Ore(){return s.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600 p-12 md:p-16 text-white",children:[s.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),s.jsx("div",{className:"absolute -top-8 -right-8 h-32 w-32 rounded-full bg-white/10 blur-2xl"}),s.jsx("div",{className:"absolute -bottom-8 -left-8 h-40 w-40 rounded-full bg-white/5 blur-2xl"}),s.jsxs("div",{className:"relative text-center space-y-8",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h2",{className:"text-4xl md:text-6xl font-bold leading-tight",children:["Bereit für den",s.jsx("br",{}),s.jsx("span",{className:"bg-gradient-to-r from-yellow-300 to-orange-300 bg-clip-text text-transparent",children:"digitalen Wandel?"})]}),s.jsx("p",{className:"text-xl text-blue-100 max-w-2xl mx-auto leading-relaxed",children:"Schließen Sie sich über 1.000 Handwerksbetrieben an, die bereits auf HandwerkOS vertrauen. Starten Sie heute kostenlos – ohne Risiko, ohne Vertragsbindung."})]}),s.jsxs("div",{className:"flex flex-wrap justify-center gap-6 text-blue-100",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"30 Tage kostenlos"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"Keine Kreditkarte nötig"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"Sofort startklar"})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[s.jsx(Zi,{to:"/login",className:"inline-flex",children:s.jsx(ee,{size:"lg",className:"bg-white text-blue-600 hover:bg-blue-50 shadow-2xl text-lg px-12 py-6 h-auto font-bold rounded-2xl transition-all duration-300 hover:scale-105",children:"🚀 Jetzt kostenlos starten"})}),s.jsx(ee,{variant:"outline",size:"lg",className:"border-2 border-white/30 text-white hover:bg-white/10 backdrop-blur-sm text-lg px-8 py-6 h-auto rounded-2xl",children:"📞 Demo vereinbaren"})]}),s.jsxs("div",{className:"flex justify-center items-center gap-8 pt-8 text-blue-200",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-white",children:"1.000+"}),s.jsx("div",{className:"text-sm",children:"Betriebe"})]}),s.jsx("div",{className:"h-8 w-px bg-white/20"}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-white",children:"4.9/5"}),s.jsx("div",{className:"text-sm",children:"Bewertung"})]}),s.jsx("div",{className:"h-8 w-px bg-white/20"}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-white",children:"24/7"}),s.jsx("div",{className:"text-sm",children:"Support"})]})]})]})]})}const Lre={"@context":"https://schema.org","@type":"SoftwareApplication",name:"HandwerkOS – Handwerkersoftware",applicationCategory:"BusinessApplication",operatingSystem:"Web, iOS, Android",offers:{"@type":"Offer",price:"0",priceCurrency:"EUR"},description:"Moderne Handwerkersoftware für Angebote, Aufträge, Projekte und Zeiterfassung.",url:"https://handwerkos.de/handwerkersoftware"};function Fre(){return g.useEffect(()=>{document.title="Handwerkersoftware von HandwerkOS";const t=document.querySelector('meta[name="description"]')||document.head.appendChild(document.createElement("meta"));t.setAttribute("name","description"),t.setAttribute("content","Moderne Handwerkersoftware für Angebote, Aufträge, Projekte und Zeiterfassung. DSGVO-konform, mobil, integriert.");let e=document.querySelector('link[rel="canonical"]');e||(e=document.createElement("link"),e.rel="canonical",document.head.appendChild(e)),e.href=`${window.location.origin}/handwerkersoftware`;const n=document.createElement("script");n.type="application/ld+json",n.text=JSON.stringify(Lre),document.head.appendChild(n);const r={"@context":"https://schema.org","@type":"FAQPage",mainEntity:[{"@type":"Question",name:"Ist HandwerkOS DSGVO‑konform?",acceptedAnswer:{"@type":"Answer",text:"Ja. Wir legen großen Wert auf Datenschutz und Sicherheit und unterstützen eine DSGVO‑konforme Nutzung."}},{"@type":"Question",name:"Kann ich HandwerkOS mobil nutzen?",acceptedAnswer:{"@type":"Answer",text:"Ja. HandwerkOS ist als Web‑App nutzbar und unterstützt iOS & Android über Capacitor."}},{"@type":"Question",name:"Wie starte ich?",acceptedAnswer:{"@type":"Answer",text:"Klicken Sie auf ‘Kostenlos testen’ – die Einrichtung dauert nur wenige Minuten."}}]},a=document.createElement("script");return a.type="application/ld+json",a.text=JSON.stringify(r),document.head.appendChild(a),()=>{document.head.removeChild(n),document.head.removeChild(a)}},[]),s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 text-foreground",children:[s.jsxs("header",{className:"relative overflow-hidden bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:[s.jsxs("div",{className:"absolute inset-0 -z-10",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600/10 via-indigo-600/5 to-purple-600/10"}),s.jsx("div",{className:"absolute -top-20 -left-20 h-96 w-96 rounded-full bg-gradient-to-r from-blue-400/30 to-indigo-400/30 blur-3xl animate-pulse"}),s.jsx("div",{className:"absolute top-32 -right-20 h-80 w-80 rounded-full bg-gradient-to-r from-indigo-400/20 to-purple-400/20 blur-3xl animate-pulse delay-1000"}),s.jsx("div",{className:"absolute bottom-20 left-1/4 h-72 w-72 rounded-full bg-gradient-to-r from-purple-400/20 to-pink-400/20 blur-3xl animate-pulse delay-2000"}),s.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})]}),s.jsxs("nav",{className:"relative z-10 container flex items-center justify-between py-6",children:[s.jsxs(Zi,{to:"/",className:"flex items-center space-x-2",children:[s.jsx("img",{src:"/favicon-32x32.png",alt:"HandwerkOS Logo",className:"h-8 w-8"}),s.jsx("span",{className:"font-bold text-xl bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"HandwerkOS"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Bse,{}),s.jsx(Zi,{to:"/login",children:s.jsx(ee,{variant:"ghost",size:"sm",className:"hover:bg-white/80 dark:hover:bg-white/10",children:"Anmelden"})}),s.jsx(Zi,{to:"/login",children:s.jsx(ee,{size:"sm",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-lg",children:"Kostenlos testen"})})]})]}),s.jsx("section",{"aria-labelledby":"hero",className:"relative z-10 container py-12 md:py-20",children:s.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"inline-flex items-center rounded-full bg-white/80 backdrop-blur-sm px-4 py-2 shadow-sm border",children:s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"🚀 Moderne Handwerkersoftware"})}),s.jsxs("h1",{id:"hero",className:"text-5xl md:text-7xl font-bold tracking-tight leading-none",children:[s.jsx("span",{className:"bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"Handwerk"}),s.jsx("br",{}),s.jsx("span",{className:"text-slate-900",children:"neu gedacht"})]}),s.jsx("p",{className:"text-xl text-slate-600 leading-relaxed max-w-lg",children:"Die All-in-One Software für moderne Handwerksbetriebe. Projekte verwalten, Zeiten erfassen, Rechnungen erstellen – alles in einer Plattform."}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx(Zi,{to:"/login",children:s.jsxs(ee,{size:"lg",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-xl text-lg px-8 py-4 h-auto",children:["Jetzt kostenlos starten",s.jsx("svg",{className:"ml-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})}),s.jsx("a",{href:"#funktionen",className:"inline-flex",children:s.jsx(ee,{variant:"outline",size:"lg",className:"text-lg px-8 py-4 h-auto border-2 hover:bg-white/80 backdrop-blur-sm",children:"Demo ansehen"})})]}),s.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500 pt-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"DSGVO-konform"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"30 Tage kostenlos"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"Deutscher Support"})]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute -top-8 -left-8 h-72 w-72 rounded-full bg-gradient-to-r from-blue-200/40 to-indigo-200/40 blur-3xl"}),s.jsx("div",{className:"absolute -bottom-8 -right-8 h-80 w-80 rounded-full bg-gradient-to-r from-indigo-200/30 to-purple-200/30 blur-3xl"}),s.jsx("div",{className:"relative bg-white/80 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/20",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"h-4 bg-gradient-to-r from-blue-200 to-indigo-200 rounded-full w-3/4"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-indigo-200 to-purple-200 rounded-full w-1/2"}),s.jsx("div",{className:"h-32 bg-gradient-to-br from-slate-100 to-slate-200 rounded-lg flex items-center justify-center",children:s.jsx("div",{className:"text-slate-400 text-sm",children:"HandwerkOS Dashboard"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx("div",{className:"h-16 bg-gradient-to-r from-blue-100 to-indigo-100 rounded-lg"}),s.jsx("div",{className:"h-16 bg-gradient-to-r from-indigo-100 to-purple-100 rounded-lg"})]})]})})]})]})})]}),s.jsxs("main",{className:"space-y-24 md:space-y-32",children:[s.jsx("section",{id:"funktionen",className:"container py-16 md:py-24",children:s.jsx(lre,{})}),s.jsx("section",{id:"module",className:"bg-slate-50 dark:bg-slate-800/50 py-16 md:py-24",children:s.jsx("div",{className:"container",children:s.jsx(dre,{})})}),s.jsx("section",{id:"integrationen",className:"container py-16 md:py-24",children:s.jsx(hre,{})}),s.jsx("section",{id:"kundenstimmen",className:"bg-gradient-to-br from-blue-50/50 to-indigo-50/50 dark:from-slate-800/30 dark:to-slate-700/30 py-16 md:py-24",children:s.jsx("div",{className:"container",children:s.jsx(mre,{})})}),s.jsx("section",{id:"faq",className:"container py-16 md:py-24",children:s.jsx(Ire,{})}),s.jsx("section",{className:"container py-16 pb-24",children:s.jsx(Ore,{})})]}),s.jsx("footer",{className:"bg-slate-900 dark:bg-slate-950 text-white mt-24",children:s.jsxs("div",{className:"container py-12",children:[s.jsxs("div",{className:"grid md:grid-cols-4 gap-8",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"h-8 w-8 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-sm",children:"H"})}),s.jsx("span",{className:"font-bold text-xl",children:"HandwerkOS"})]}),s.jsx("p",{className:"text-slate-300 text-sm leading-relaxed",children:"Die moderne Software-Lösung für Handwerksbetriebe. Einfach, intuitiv und speziell für deutsche Handwerker entwickelt."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-semibold text-white",children:"Produkt"}),s.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[s.jsx("li",{children:s.jsx("a",{href:"#funktionen",className:"hover:text-white transition-colors",children:"Funktionen"})}),s.jsx("li",{children:s.jsx("a",{href:"#module",className:"hover:text-white transition-colors",children:"Module"})}),s.jsx("li",{children:s.jsx("a",{href:"#faq",className:"hover:text-white transition-colors",children:"FAQ"})}),s.jsx("li",{children:s.jsx(Zi,{to:"/login",className:"hover:text-white transition-colors",children:"Kostenlos testen"})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-semibold text-white",children:"Unternehmen"}),s.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Über uns"})}),s.jsx("li",{children:s.jsx("a",{href:"#kundenstimmen",className:"hover:text-white transition-colors",children:"Referenzen"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Karriere"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Kontakt"})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-semibold text-white",children:"Rechtliches"}),s.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[s.jsx("li",{children:s.jsx(Zi,{to:"/privacy",className:"hover:text-white transition-colors",children:"Datenschutz"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Impressum"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"AGB"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"DSGVO"})})]})]})]}),s.jsxs("div",{className:"border-t border-slate-800 mt-12 pt-8 flex flex-col md:flex-row items-center justify-between gap-4",children:[s.jsx("div",{className:"flex items-center gap-6 text-sm text-slate-400",children:s.jsxs("p",{children:["© ",new Date().getFullYear()," HandwerkOS GmbH. Alle Rechte vorbehalten."]})}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("svg",{className:"h-4 w-4 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"DSGVO-konform"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("svg",{className:"h-4 w-4 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z",clipRule:"evenodd"})}),s.jsx("span",{children:"Made in Germany"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("svg",{className:"h-4 w-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"4.9/5 Bewertung"})]})]})]})]})})]})}const x5=()=>{const[t,e]=g.useState(""),[n,r]=g.useState(""),[a,i]=g.useState(!1),[o,c]=g.useState(!1),{signIn:d}=jg(),u=Za(),m=async f=>{if(f.preventDefault(),!t||!n){Ue.error("Bitte füllen Sie alle Felder aus");return}c(!0);try{const p=await d(t,n),{data:{session:x}}=await Z.auth.getSession();if(x!=null&&x.user){const{data:j}=await Z.from("user_roles").select("role").eq("user_id",x.user.id).single(),v=(j==null?void 0:j.role)||"employee";Ue.success("Erfolgreich angemeldet"),u(v==="manager"?"/manager":"/employee")}else u("/")}catch(p){Ue.error("Anmeldung fehlgeschlagen: "+((p==null?void 0:p.message)||"Unbekannter Fehler"))}finally{c(!1)}};return s.jsxs("div",{className:"h-full bg-white flex flex-col justify-center",style:{paddingTop:"44px",paddingBottom:"20px"},children:[s.jsx("div",{className:"text-center mb-8",children:s.jsxs("div",{className:"flex justify-center items-center mb-2",children:[s.jsx("img",{src:"/favicon-32x32.png",alt:"HandwerkOS Logo",className:"h-6 w-6 mr-2",style:{imageRendering:"-webkit-optimize-contrast"},onError:f=>{var p;f.currentTarget.style.display="none",(p=f.currentTarget.nextElementSibling)==null||p.classList.remove("hidden")}}),s.jsx("div",{className:"bg-gray-100 p-1 rounded-full mr-2 hidden",children:s.jsx(e0,{className:"h-4 w-4 text-blue-600"})}),s.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"HandwerkOS"})]})}),s.jsx("div",{className:"px-6",children:s.jsxs("div",{className:"max-w-sm mx-auto",children:[s.jsxs("form",{onSubmit:m,className:"space-y-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx(Y,{htmlFor:"email",className:"text-gray-900 font-medium",children:"E-Mail"}),s.jsxs("div",{className:"relative",children:[s.jsx(pr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-600"}),s.jsx(ae,{id:"email",type:"email",value:t,onChange:f=>e(f.target.value),className:"pl-10 h-10 text-sm border-gray-300 bg-white text-gray-900 placeholder:text-gray-500",placeholder:"ihre.email@firma.de",disabled:o})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(Y,{htmlFor:"password",className:"text-gray-900 font-medium",children:"Passwort"}),s.jsxs("div",{className:"relative",children:[s.jsx(lB,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-600"}),s.jsx(ae,{id:"password",type:a?"text":"password",value:n,onChange:f=>r(f.target.value),className:"pl-10 pr-10 h-10 text-sm border-gray-300 bg-white text-gray-900 placeholder:text-gray-500",placeholder:"Ihr Passwort",disabled:o}),s.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-600",disabled:o,children:a?s.jsx(rP,{className:"h-5 w-5"}):s.jsx(sa,{className:"h-5 w-5"})})]})]}),s.jsx(ee,{type:"submit",className:"w-full h-10 text-sm bg-blue-500 hover:bg-blue-600 text-white font-medium shadow-sm mt-4",disabled:o,children:o?"Anmelden...":"Anmelden"})]}),s.jsxs("div",{className:"mt-4 text-center text-xs text-gray-600",children:[s.jsx("p",{children:"Probleme beim Anmelden?"}),s.jsx("p",{children:"Wenden Sie sich an Ihren Administrator"})]}),s.jsxs("div",{className:"mt-6 space-y-2 border-t pt-4",children:[s.jsx("p",{className:"text-xs text-gray-500 text-center mb-2",children:"Für Tests/Demo:"}),s.jsx(ee,{onClick:()=>u("/handwerkersoftware"),variant:"outline",className:"w-full text-xs h-8",children:"📄 Marketing Landing Page"}),s.jsx(ee,{onClick:()=>u("/manager"),variant:"outline",className:"w-full text-xs h-8",children:"👔 Manager Dashboard"}),s.jsx(ee,{onClick:()=>u("/employee"),variant:"outline",className:"w-full text-xs h-8",children:"👷 Mitarbeiter App"})]})]})})]})},Bre=()=>{const[t,e]=g.useState(null),[n,r]=g.useState(!0),a=Za();return g.useEffect(()=>{const i=async()=>{try{console.log("Checking auth and role...");const{data:{session:d}}=await Z.auth.getSession();if(e(!!d),d!=null&&d.user){console.log("User found:",d.user.id);const{data:u,error:m}=await Z.from("user_roles").select("role").eq("user_id",d.user.id).maybeSingle();console.log("Role data:",u,"Error:",m);let f="employee";if(u!=null&&u.role?f=u.role:(console.log("No role found for user, treating as employee"),f="employee"),console.log("User role:",f),f==="manager"){console.log("Redirecting manager to /manager"),a("/manager");return}}}catch(d){console.error("Error checking auth and role:",d)}finally{r(!1)}},o=setTimeout(()=>{console.log("Auth check timeout - proceeding without auth"),e(!1),r(!1)},5e3);i().then(()=>{clearTimeout(o)});const{data:{subscription:c}}=Z.auth.onAuthStateChange(async(d,u)=>{if(e(!!u),u!=null&&u.user&&d==="SIGNED_IN"){const{data:m}=await Z.from("user_roles").select("role").eq("user_id",u.user.id).single();((m==null?void 0:m.role)||"employee")==="manager"&&a("/manager")}});return()=>c.unsubscribe()},[a]),n?s.jsx("div",{className:"h-full bg-blue-50 flex items-center justify-center",style:{paddingTop:"44px",paddingBottom:"20px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Lade..."})]})}):t?s.jsx(GO,{}):s.jsx(x5,{})},zre=()=>{const{user:t,loading:e}=Fr(),[n,r]=g.useState(!1);return g.useEffect(()=>{!e&&!t?r(!0):!e&&t&&r(!1)},[t,e]),e?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-600 to-purple-700",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),s.jsx("p",{className:"text-white text-lg",children:"HandwerkOS wird geladen..."})]})}):n||!t?s.jsx(x5,{}):s.jsx(ZO,{})};class $re extends Ae.Component{constructor(n){super(n);qn(this,"resetError",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("Error Boundary caught an error:",n,r)}render(){if(this.state.hasError){if(this.props.fallback){const n=this.props.fallback;return s.jsx(n,{error:this.state.error,resetError:this.resetError})}return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:s.jsxs(oe,{className:"w-full max-w-lg",children:[s.jsxs(Ne,{className:"text-center",children:[s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("div",{className:"p-3 rounded-full bg-red-100",children:s.jsx(us,{className:"h-8 w-8 text-red-600"})})}),s.jsx(Ce,{className:"text-xl text-red-900",children:"Etwas ist schiefgelaufen"})]}),s.jsxs(ce,{className:"text-center space-y-4",children:[s.jsx("p",{className:"text-gray-600",children:"Es ist ein unerwarteter Fehler aufgetreten. Bitte versuchen Sie es erneut."}),this.state.error&&s.jsxs("details",{className:"text-left",children:[s.jsx("summary",{className:"cursor-pointer text-sm text-gray-500 hover:text-gray-700",children:"Technische Details anzeigen"}),s.jsx("pre",{className:"mt-2 p-3 bg-gray-100 rounded text-xs text-red-800 overflow-auto",children:this.state.error.toString()})]}),s.jsxs("div",{className:"flex gap-3 justify-center",children:[s.jsxs(ee,{onClick:this.resetError,className:"flex items-center gap-2",children:[s.jsx(iP,{className:"h-4 w-4"}),"Erneut versuchen"]}),s.jsx(ee,{variant:"outline",onClick:()=>window.location.reload(),children:"Seite neu laden"})]})]})]})})}return this.props.children}}const ln=new m9({defaultOptions:{queries:{retry:2,staleTime:5*60*1e3,refetchOnWindowFocus:!1}}}),Ure=()=>(g.useEffect(()=>{const t=[ct.on("CUSTOMER_CREATED",()=>{ln.invalidateQueries({queryKey:["customers"]})}),ct.on("CUSTOMER_UPDATED",()=>{ln.invalidateQueries({queryKey:["customers"]})}),ct.on("CUSTOMER_DELETED",()=>{ln.invalidateQueries({queryKey:["customers"]})}),ct.on("PROJECT_CREATED",()=>{ln.invalidateQueries({queryKey:["projects"]}),ln.invalidateQueries({queryKey:["financial-kpis"]})}),ct.on("PROJECT_UPDATED",()=>{ln.invalidateQueries({queryKey:["projects"]}),ln.invalidateQueries({queryKey:["financial-kpis"]})}),ct.on("PROJECT_STATUS_CHANGED",()=>{ln.invalidateQueries({queryKey:["projects"]}),ln.invalidateQueries({queryKey:["financial-kpis"]})}),ct.on("QUOTE_CREATED",()=>{ln.invalidateQueries({queryKey:["quotes"]})}),ct.on("QUOTE_UPDATED",()=>{ln.invalidateQueries({queryKey:["quotes"]})}),ct.on("QUOTE_ACCEPTED",()=>{ln.invalidateQueries({queryKey:["quotes"]}),ln.invalidateQueries({queryKey:["financial-kpis"]})}),ct.on("INVOICE_CREATED",()=>{ln.invalidateQueries({queryKey:["invoices"]}),ln.invalidateQueries({queryKey:["financial-kpis"]})}),ct.on("INVOICE_UPDATED",()=>{ln.invalidateQueries({queryKey:["invoices"]}),ln.invalidateQueries({queryKey:["financial-kpis"]})}),ct.on("INVOICE_PAID",()=>{ln.invalidateQueries({queryKey:["invoices"]}),ln.invalidateQueries({queryKey:["financial-kpis"]})}),ct.on("TIMESHEET_CREATED",()=>{ln.invalidateQueries({queryKey:["time-entries"]})}),ct.on("TIMESHEET_UPDATED",()=>{ln.invalidateQueries({queryKey:["time-entries"]})}),ct.on("STOCK_ADJUSTED",()=>{ln.invalidateQueries({queryKey:["materials"]}),ln.invalidateQueries({queryKey:["stock-counts"]})}),ct.on("STOCK_TRANSFER_COMPLETED",()=>{ln.invalidateQueries({queryKey:["materials"]}),ln.invalidateQueries({queryKey:["stock-transfers"]}),ln.invalidateQueries({queryKey:["stock-counts"]})})];return()=>{t.forEach(e=>ct.off(e))}},[]),null),qre=()=>s.jsx($re,{children:s.jsxs(y9,{client:ln,children:[s.jsx(Ure,{}),s.jsx(tz,{children:s.jsxs(X$,{children:[s.jsx(ez,{}),s.jsx(kz,{}),s.jsx(k7,{children:s.jsxs(v7,{children:[s.jsx(Sr,{path:"/",element:s.jsx(Fre,{})}),s.jsx(Sr,{path:"/app",element:s.jsx(zre,{})}),s.jsx(Sr,{path:"/mobile",element:s.jsx(Bre,{})}),s.jsx(Sr,{path:"/login",element:s.jsx(JC,{})}),s.jsx(Sr,{path:"/auth",element:s.jsx(JC,{})}),s.jsx(Sr,{path:"/manager",element:s.jsx(zse,{})}),s.jsx(Sr,{path:"/employee",element:s.jsx(GO,{})}),s.jsx(Sr,{path:"/auth/callback",element:s.jsx(sre,{})}),s.jsx(Sr,{path:"/privacy",element:s.jsx(rre,{})}),s.jsx(Sr,{path:"/mitarbeiter-setup",element:s.jsx(ire,{})}),s.jsx(Sr,{path:"*",element:s.jsx(are,{})})]})})]})})]})});DA(document.getElementById("root")).render(s.jsx(Zq,{children:s.jsx(Vq,{children:s.jsx(qre,{})})}));export{PI as W};
