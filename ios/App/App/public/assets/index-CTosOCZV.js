var a8=Object.defineProperty;var TN=t=>{throw TypeError(t)};var i8=(t,e,n)=>e in t?a8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var As=(t,e,n)=>i8(t,typeof e!="symbol"?e+"":e,n),wx=(t,e,n)=>e.has(t)||TN("Cannot "+n);var oe=(t,e,n)=>(wx(t,e,"read from private field"),n?n.call(t):e.get(t)),mt=(t,e,n)=>e.has(t)?TN("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),qe=(t,e,n,s)=>(wx(t,e,"write to private field"),s?s.call(t,n):e.set(t,n),n),Lt=(t,e,n)=>(wx(t,e,"access private method"),n);var Jf=(t,e,n,s)=>({set _(a){qe(t,e,a,n)},get _(){return oe(t,e,s)}});function o8(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in t)){const i=Object.getOwnPropertyDescriptor(s,a);i&&Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var ht=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Fw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function nE(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}),n}var rE={exports:{}},T0={},sE={exports:{}},Ht={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rf=Symbol.for("react.element"),l8=Symbol.for("react.portal"),c8=Symbol.for("react.fragment"),d8=Symbol.for("react.strict_mode"),u8=Symbol.for("react.profiler"),h8=Symbol.for("react.provider"),f8=Symbol.for("react.context"),m8=Symbol.for("react.forward_ref"),p8=Symbol.for("react.suspense"),g8=Symbol.for("react.memo"),x8=Symbol.for("react.lazy"),MN=Symbol.iterator;function v8(t){return t===null||typeof t!="object"?null:(t=MN&&t[MN]||t["@@iterator"],typeof t=="function"?t:null)}var aE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},iE=Object.assign,oE={};function Ad(t,e,n){this.props=t,this.context=e,this.refs=oE,this.updater=n||aE}Ad.prototype.isReactComponent={};Ad.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ad.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function lE(){}lE.prototype=Ad.prototype;function Bw(t,e,n){this.props=t,this.context=e,this.refs=oE,this.updater=n||aE}var zw=Bw.prototype=new lE;zw.constructor=Bw;iE(zw,Ad.prototype);zw.isPureReactComponent=!0;var RN=Array.isArray,cE=Object.prototype.hasOwnProperty,$w={current:null},dE={key:!0,ref:!0,__self:!0,__source:!0};function uE(t,e,n){var s,a={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)cE.call(e,s)&&!dE.hasOwnProperty(s)&&(a[s]=e[s]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var d=Array(c),u=0;u<c;u++)d[u]=arguments[u+2];a.children=d}if(t&&t.defaultProps)for(s in c=t.defaultProps,c)a[s]===void 0&&(a[s]=c[s]);return{$$typeof:rf,type:t,key:i,ref:o,props:a,_owner:$w.current}}function y8(t,e){return{$$typeof:rf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Uw(t){return typeof t=="object"&&t!==null&&t.$$typeof===rf}function _8(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var IN=/\/+/g;function bx(t,e){return typeof t=="object"&&t!==null&&t.key!=null?_8(""+t.key):e.toString(36)}function Hm(t,e,n,s,a){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case rf:case l8:o=!0}}if(o)return o=t,a=a(o),t=s===""?"."+bx(o,0):s,RN(a)?(n="",t!=null&&(n=t.replace(IN,"$&/")+"/"),Hm(a,e,n,"",function(u){return u})):a!=null&&(Uw(a)&&(a=y8(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(IN,"$&/")+"/")+t)),e.push(a)),1;if(o=0,s=s===""?".":s+":",RN(t))for(var c=0;c<t.length;c++){i=t[c];var d=s+bx(i,c);o+=Hm(i,e,n,d,a)}else if(d=v8(t),typeof d=="function")for(t=d.call(t),c=0;!(i=t.next()).done;)i=i.value,d=s+bx(i,c++),o+=Hm(i,e,n,d,a);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function em(t,e,n){if(t==null)return t;var s=[],a=0;return Hm(t,s,"","",function(i){return e.call(n,i,a++)}),s}function w8(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ur={current:null},Vm={transition:null},b8={ReactCurrentDispatcher:Ur,ReactCurrentBatchConfig:Vm,ReactCurrentOwner:$w};function hE(){throw Error("act(...) is not supported in production builds of React.")}Ht.Children={map:em,forEach:function(t,e,n){em(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return em(t,function(){e++}),e},toArray:function(t){return em(t,function(e){return e})||[]},only:function(t){if(!Uw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ht.Component=Ad;Ht.Fragment=c8;Ht.Profiler=u8;Ht.PureComponent=Bw;Ht.StrictMode=d8;Ht.Suspense=p8;Ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=b8;Ht.act=hE;Ht.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=iE({},t.props),a=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=$w.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(d in e)cE.call(e,d)&&!dE.hasOwnProperty(d)&&(s[d]=e[d]===void 0&&c!==void 0?c[d]:e[d])}var d=arguments.length-2;if(d===1)s.children=n;else if(1<d){c=Array(d);for(var u=0;u<d;u++)c[u]=arguments[u+2];s.children=c}return{$$typeof:rf,type:t.type,key:a,ref:i,props:s,_owner:o}};Ht.createContext=function(t){return t={$$typeof:f8,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:h8,_context:t},t.Consumer=t};Ht.createElement=uE;Ht.createFactory=function(t){var e=uE.bind(null,t);return e.type=t,e};Ht.createRef=function(){return{current:null}};Ht.forwardRef=function(t){return{$$typeof:m8,render:t}};Ht.isValidElement=Uw;Ht.lazy=function(t){return{$$typeof:x8,_payload:{_status:-1,_result:t},_init:w8}};Ht.memo=function(t,e){return{$$typeof:g8,type:t,compare:e===void 0?null:e}};Ht.startTransition=function(t){var e=Vm.transition;Vm.transition={};try{t()}finally{Vm.transition=e}};Ht.unstable_act=hE;Ht.useCallback=function(t,e){return Ur.current.useCallback(t,e)};Ht.useContext=function(t){return Ur.current.useContext(t)};Ht.useDebugValue=function(){};Ht.useDeferredValue=function(t){return Ur.current.useDeferredValue(t)};Ht.useEffect=function(t,e){return Ur.current.useEffect(t,e)};Ht.useId=function(){return Ur.current.useId()};Ht.useImperativeHandle=function(t,e,n){return Ur.current.useImperativeHandle(t,e,n)};Ht.useInsertionEffect=function(t,e){return Ur.current.useInsertionEffect(t,e)};Ht.useLayoutEffect=function(t,e){return Ur.current.useLayoutEffect(t,e)};Ht.useMemo=function(t,e){return Ur.current.useMemo(t,e)};Ht.useReducer=function(t,e,n){return Ur.current.useReducer(t,e,n)};Ht.useRef=function(t){return Ur.current.useRef(t)};Ht.useState=function(t){return Ur.current.useState(t)};Ht.useSyncExternalStore=function(t,e,n){return Ur.current.useSyncExternalStore(t,e,n)};Ht.useTransition=function(){return Ur.current.useTransition()};Ht.version="18.3.1";sE.exports=Ht;var g=sE.exports;const ke=Fw(g),fE=o8({__proto__:null,default:ke},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j8=g,N8=Symbol.for("react.element"),S8=Symbol.for("react.fragment"),k8=Object.prototype.hasOwnProperty,C8=j8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,E8={key:!0,ref:!0,__self:!0,__source:!0};function mE(t,e,n){var s,a={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)k8.call(e,s)&&!E8.hasOwnProperty(s)&&(a[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)a[s]===void 0&&(a[s]=e[s]);return{$$typeof:N8,type:t,key:i,ref:o,props:a,_owner:C8.current}}T0.Fragment=S8;T0.jsx=mE;T0.jsxs=mE;rE.exports=T0;var r=rE.exports,pE={exports:{}},js={},gE={exports:{}},xE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(z,V){var U=z.length;z.push(V);e:for(;0<U;){var O=U-1>>>1,I=z[O];if(0<a(I,V))z[O]=V,z[U]=I,U=O;else break e}}function n(z){return z.length===0?null:z[0]}function s(z){if(z.length===0)return null;var V=z[0],U=z.pop();if(U!==V){z[0]=U;e:for(var O=0,I=z.length,H=I>>>1;O<H;){var $=2*(O+1)-1,te=z[$],X=$+1,Z=z[X];if(0>a(te,U))X<I&&0>a(Z,te)?(z[O]=Z,z[X]=U,O=X):(z[O]=te,z[$]=U,O=$);else if(X<I&&0>a(Z,U))z[O]=Z,z[X]=U,O=X;else break e}}return V}function a(z,V){var U=z.sortIndex-V.sortIndex;return U!==0?U:z.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var d=[],u=[],m=1,f=null,p=3,y=!1,j=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(z){for(var V=n(u);V!==null;){if(V.callback===null)s(u);else if(V.startTime<=z)s(u),V.sortIndex=V.expirationTime,e(d,V);else break;V=n(u)}}function S(z){if(v=!1,N(z),!j)if(n(d)!==null)j=!0,de(A);else{var V=n(u);V!==null&&Q(S,V.startTime-z)}}function A(z,V){j=!1,v&&(v=!1,b(M),M=-1),y=!0;var U=p;try{for(N(V),f=n(d);f!==null&&(!(f.expirationTime>V)||z&&!P());){var O=f.callback;if(typeof O=="function"){f.callback=null,p=f.priorityLevel;var I=O(f.expirationTime<=V);V=t.unstable_now(),typeof I=="function"?f.callback=I:f===n(d)&&s(d),N(V)}else s(d);f=n(d)}if(f!==null)var H=!0;else{var $=n(u);$!==null&&Q(S,$.startTime-V),H=!1}return H}finally{f=null,p=U,y=!1}}var E=!1,D=null,M=-1,B=5,R=-1;function P(){return!(t.unstable_now()-R<B)}function F(){if(D!==null){var z=t.unstable_now();R=z;var V=!0;try{V=D(!0,z)}finally{V?W():(E=!1,D=null)}}else E=!1}var W;if(typeof w=="function")W=function(){w(F)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,ue=ee.port2;ee.port1.onmessage=F,W=function(){ue.postMessage(null)}}else W=function(){_(F,0)};function de(z){D=z,E||(E=!0,W())}function Q(z,V){M=_(function(){z(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_continueExecution=function(){j||y||(j=!0,de(A))},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(z){switch(p){case 1:case 2:case 3:var V=3;break;default:V=p}var U=p;p=V;try{return z()}finally{p=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(z,V){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var U=p;p=z;try{return V()}finally{p=U}},t.unstable_scheduleCallback=function(z,V,U){var O=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?O+U:O):U=O,z){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=U+I,z={id:m++,callback:V,priorityLevel:z,startTime:U,expirationTime:I,sortIndex:-1},U>O?(z.sortIndex=U,e(u,z),n(d)===null&&z===n(u)&&(v?(b(M),M=-1):v=!0,Q(S,U-O))):(z.sortIndex=I,e(d,z),j||y||(j=!0,de(A))),z},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(z){var V=p;return function(){var U=p;p=V;try{return z.apply(this,arguments)}finally{p=U}}}})(xE);gE.exports=xE;var A8=gE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P8=g,ys=A8;function Ae(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var vE=new Set,ch={};function $l(t,e){ud(t,e),ud(t+"Capture",e)}function ud(t,e){for(ch[t]=e,t=0;t<e.length;t++)vE.add(e[t])}var yi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),wy=Object.prototype.hasOwnProperty,D8=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ON={},LN={};function T8(t){return wy.call(LN,t)?!0:wy.call(ON,t)?!1:D8.test(t)?LN[t]=!0:(ON[t]=!0,!1)}function M8(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function R8(t,e,n,s){if(e===null||typeof e>"u"||M8(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qr(t,e,n,s,a,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var xr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xr[t]=new qr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xr[e]=new qr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xr[t]=new qr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xr[t]=new qr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xr[t]=new qr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xr[t]=new qr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xr[t]=new qr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xr[t]=new qr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xr[t]=new qr(t,5,!1,t.toLowerCase(),null,!1,!1)});var qw=/[\-:]([a-z])/g;function Ww(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(qw,Ww);xr[e]=new qr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(qw,Ww);xr[e]=new qr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(qw,Ww);xr[e]=new qr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xr[t]=new qr(t,1,!1,t.toLowerCase(),null,!1,!1)});xr.xlinkHref=new qr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xr[t]=new qr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Hw(t,e,n,s){var a=xr.hasOwnProperty(e)?xr[e]:null;(a!==null?a.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(R8(e,n,a,s)&&(n=null),s||a===null?T8(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,s=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var Ai=P8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tm=Symbol.for("react.element"),Nc=Symbol.for("react.portal"),Sc=Symbol.for("react.fragment"),Vw=Symbol.for("react.strict_mode"),by=Symbol.for("react.profiler"),yE=Symbol.for("react.provider"),_E=Symbol.for("react.context"),Kw=Symbol.for("react.forward_ref"),jy=Symbol.for("react.suspense"),Ny=Symbol.for("react.suspense_list"),Zw=Symbol.for("react.memo"),Vi=Symbol.for("react.lazy"),wE=Symbol.for("react.offscreen"),FN=Symbol.iterator;function ou(t){return t===null||typeof t!="object"?null:(t=FN&&t[FN]||t["@@iterator"],typeof t=="function"?t:null)}var Pn=Object.assign,jx;function wu(t){if(jx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);jx=e&&e[1]||""}return`
`+jx+t}var Nx=!1;function Sx(t,e){if(!t||Nx)return"";Nx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=s.stack.split(`
`),o=a.length-1,c=i.length-1;1<=o&&0<=c&&a[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(a[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||a[o]!==i[c]){var d=`
`+a[o].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=o&&0<=c);break}}}finally{Nx=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?wu(t):""}function I8(t){switch(t.tag){case 5:return wu(t.type);case 16:return wu("Lazy");case 13:return wu("Suspense");case 19:return wu("SuspenseList");case 0:case 2:case 15:return t=Sx(t.type,!1),t;case 11:return t=Sx(t.type.render,!1),t;case 1:return t=Sx(t.type,!0),t;default:return""}}function Sy(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Sc:return"Fragment";case Nc:return"Portal";case by:return"Profiler";case Vw:return"StrictMode";case jy:return"Suspense";case Ny:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case _E:return(t.displayName||"Context")+".Consumer";case yE:return(t._context.displayName||"Context")+".Provider";case Kw:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Zw:return e=t.displayName||null,e!==null?e:Sy(t.type)||"Memo";case Vi:e=t._payload,t=t._init;try{return Sy(t(e))}catch{}}return null}function O8(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sy(e);case 8:return e===Vw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ko(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function bE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function L8(t){var e=bE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nm(t){t._valueTracker||(t._valueTracker=L8(t))}function jE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=bE(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function jp(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ky(t,e){var n=e.checked;return Pn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function BN(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=ko(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function NE(t,e){e=e.checked,e!=null&&Hw(t,"checked",e,!1)}function Cy(t,e){NE(t,e);var n=ko(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ey(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ey(t,e.type,ko(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function zN(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ey(t,e,n){(e!=="number"||jp(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var bu=Array.isArray;function zc(t,e,n,s){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&s&&(t[n].defaultSelected=!0)}else{for(n=""+ko(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,s&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function Ay(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ae(91));return Pn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function $N(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Ae(92));if(bu(n)){if(1<n.length)throw Error(Ae(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ko(n)}}function SE(t,e){var n=ko(e.value),s=ko(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function UN(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function kE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Py(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?kE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var rm,CE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(rm=rm||document.createElement("div"),rm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=rm.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function dh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var $u={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},F8=["Webkit","ms","Moz","O"];Object.keys($u).forEach(function(t){F8.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),$u[e]=$u[t]})});function EE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||$u.hasOwnProperty(t)&&$u[t]?(""+e).trim():e+"px"}function AE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,a=EE(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,a):t[n]=a}}var B8=Pn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dy(t,e){if(e){if(B8[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ae(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ae(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ae(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ae(62))}}function Ty(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var My=null;function Gw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ry=null,$c=null,Uc=null;function qN(t){if(t=of(t)){if(typeof Ry!="function")throw Error(Ae(280));var e=t.stateNode;e&&(e=L0(e),Ry(t.stateNode,t.type,e))}}function PE(t){$c?Uc?Uc.push(t):Uc=[t]:$c=t}function DE(){if($c){var t=$c,e=Uc;if(Uc=$c=null,qN(t),e)for(t=0;t<e.length;t++)qN(e[t])}}function TE(t,e){return t(e)}function ME(){}var kx=!1;function RE(t,e,n){if(kx)return t(e,n);kx=!0;try{return TE(t,e,n)}finally{kx=!1,($c!==null||Uc!==null)&&(ME(),DE())}}function uh(t,e){var n=t.stateNode;if(n===null)return null;var s=L0(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Ae(231,e,typeof n));return n}var Iy=!1;if(yi)try{var lu={};Object.defineProperty(lu,"passive",{get:function(){Iy=!0}}),window.addEventListener("test",lu,lu),window.removeEventListener("test",lu,lu)}catch{Iy=!1}function z8(t,e,n,s,a,i,o,c,d){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(m){this.onError(m)}}var Uu=!1,Np=null,Sp=!1,Oy=null,$8={onError:function(t){Uu=!0,Np=t}};function U8(t,e,n,s,a,i,o,c,d){Uu=!1,Np=null,z8.apply($8,arguments)}function q8(t,e,n,s,a,i,o,c,d){if(U8.apply(this,arguments),Uu){if(Uu){var u=Np;Uu=!1,Np=null}else throw Error(Ae(198));Sp||(Sp=!0,Oy=u)}}function Ul(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function IE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function WN(t){if(Ul(t)!==t)throw Error(Ae(188))}function W8(t){var e=t.alternate;if(!e){if(e=Ul(t),e===null)throw Error(Ae(188));return e!==t?null:t}for(var n=t,s=e;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(s=a.return,s!==null){n=s;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return WN(a),t;if(i===s)return WN(a),e;i=i.sibling}throw Error(Ae(188))}if(n.return!==s.return)n=a,s=i;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,s=i;break}if(c===s){o=!0,s=a,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,s=a;break}if(c===s){o=!0,s=i,n=a;break}c=c.sibling}if(!o)throw Error(Ae(189))}}if(n.alternate!==s)throw Error(Ae(190))}if(n.tag!==3)throw Error(Ae(188));return n.stateNode.current===n?t:e}function OE(t){return t=W8(t),t!==null?LE(t):null}function LE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=LE(t);if(e!==null)return e;t=t.sibling}return null}var FE=ys.unstable_scheduleCallback,HN=ys.unstable_cancelCallback,H8=ys.unstable_shouldYield,V8=ys.unstable_requestPaint,In=ys.unstable_now,K8=ys.unstable_getCurrentPriorityLevel,Qw=ys.unstable_ImmediatePriority,BE=ys.unstable_UserBlockingPriority,kp=ys.unstable_NormalPriority,Z8=ys.unstable_LowPriority,zE=ys.unstable_IdlePriority,M0=null,za=null;function G8(t){if(za&&typeof za.onCommitFiberRoot=="function")try{za.onCommitFiberRoot(M0,t,void 0,(t.current.flags&128)===128)}catch{}}var ia=Math.clz32?Math.clz32:X8,Q8=Math.log,Y8=Math.LN2;function X8(t){return t>>>=0,t===0?32:31-(Q8(t)/Y8|0)|0}var sm=64,am=4194304;function ju(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Cp(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,a=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~a;c!==0?s=ju(c):(i&=o,i!==0&&(s=ju(i)))}else o=n&~a,o!==0?s=ju(o):i!==0&&(s=ju(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&a)&&(a=s&-s,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-ia(e),a=1<<n,s|=t[n],e&=~a;return s}function J8(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function e6(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-ia(i),c=1<<o,d=a[o];d===-1?(!(c&n)||c&s)&&(a[o]=J8(c,e)):d<=e&&(t.expiredLanes|=c),i&=~c}}function Ly(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $E(){var t=sm;return sm<<=1,!(sm&4194240)&&(sm=64),t}function Cx(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function sf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ia(e),t[e]=n}function t6(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-ia(n),i=1<<a;e[a]=0,s[a]=-1,t[a]=-1,n&=~i}}function Yw(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-ia(n),a=1<<s;a&e|t[s]&e&&(t[s]|=e),n&=~a}}var un=0;function UE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qE,Xw,WE,HE,VE,Fy=!1,im=[],go=null,xo=null,vo=null,hh=new Map,fh=new Map,Qi=[],n6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function VN(t,e){switch(t){case"focusin":case"focusout":go=null;break;case"dragenter":case"dragleave":xo=null;break;case"mouseover":case"mouseout":vo=null;break;case"pointerover":case"pointerout":hh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":fh.delete(e.pointerId)}}function cu(t,e,n,s,a,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[a]},e!==null&&(e=of(e),e!==null&&Xw(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function r6(t,e,n,s,a){switch(e){case"focusin":return go=cu(go,t,e,n,s,a),!0;case"dragenter":return xo=cu(xo,t,e,n,s,a),!0;case"mouseover":return vo=cu(vo,t,e,n,s,a),!0;case"pointerover":var i=a.pointerId;return hh.set(i,cu(hh.get(i)||null,t,e,n,s,a)),!0;case"gotpointercapture":return i=a.pointerId,fh.set(i,cu(fh.get(i)||null,t,e,n,s,a)),!0}return!1}function KE(t){var e=cl(t.target);if(e!==null){var n=Ul(e);if(n!==null){if(e=n.tag,e===13){if(e=IE(n),e!==null){t.blockedOn=e,VE(t.priority,function(){WE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Km(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=By(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);My=s,n.target.dispatchEvent(s),My=null}else return e=of(n),e!==null&&Xw(e),t.blockedOn=n,!1;e.shift()}return!0}function KN(t,e,n){Km(t)&&n.delete(e)}function s6(){Fy=!1,go!==null&&Km(go)&&(go=null),xo!==null&&Km(xo)&&(xo=null),vo!==null&&Km(vo)&&(vo=null),hh.forEach(KN),fh.forEach(KN)}function du(t,e){t.blockedOn===e&&(t.blockedOn=null,Fy||(Fy=!0,ys.unstable_scheduleCallback(ys.unstable_NormalPriority,s6)))}function mh(t){function e(a){return du(a,t)}if(0<im.length){du(im[0],t);for(var n=1;n<im.length;n++){var s=im[n];s.blockedOn===t&&(s.blockedOn=null)}}for(go!==null&&du(go,t),xo!==null&&du(xo,t),vo!==null&&du(vo,t),hh.forEach(e),fh.forEach(e),n=0;n<Qi.length;n++)s=Qi[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Qi.length&&(n=Qi[0],n.blockedOn===null);)KE(n),n.blockedOn===null&&Qi.shift()}var qc=Ai.ReactCurrentBatchConfig,Ep=!0;function a6(t,e,n,s){var a=un,i=qc.transition;qc.transition=null;try{un=1,Jw(t,e,n,s)}finally{un=a,qc.transition=i}}function i6(t,e,n,s){var a=un,i=qc.transition;qc.transition=null;try{un=4,Jw(t,e,n,s)}finally{un=a,qc.transition=i}}function Jw(t,e,n,s){if(Ep){var a=By(t,e,n,s);if(a===null)Lx(t,e,s,Ap,n),VN(t,s);else if(r6(a,t,e,n,s))s.stopPropagation();else if(VN(t,s),e&4&&-1<n6.indexOf(t)){for(;a!==null;){var i=of(a);if(i!==null&&qE(i),i=By(t,e,n,s),i===null&&Lx(t,e,s,Ap,n),i===a)break;a=i}a!==null&&s.stopPropagation()}else Lx(t,e,s,null,n)}}var Ap=null;function By(t,e,n,s){if(Ap=null,t=Gw(s),t=cl(t),t!==null)if(e=Ul(t),e===null)t=null;else if(n=e.tag,n===13){if(t=IE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ap=t,null}function ZE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(K8()){case Qw:return 1;case BE:return 4;case kp:case Z8:return 16;case zE:return 536870912;default:return 16}default:return 16}}var co=null,eb=null,Zm=null;function GE(){if(Zm)return Zm;var t,e=eb,n=e.length,s,a="value"in co?co.value:co.textContent,i=a.length;for(t=0;t<n&&e[t]===a[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===a[i-s];s++);return Zm=a.slice(t,1<s?1-s:void 0)}function Gm(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function om(){return!0}function ZN(){return!1}function Ns(t){function e(n,s,a,i,o){this._reactName=n,this._targetInst=a,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?om:ZN,this.isPropagationStopped=ZN,this}return Pn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=om)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=om)},persist:function(){},isPersistent:om}),e}var Pd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tb=Ns(Pd),af=Pn({},Pd,{view:0,detail:0}),o6=Ns(af),Ex,Ax,uu,R0=Pn({},af,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==uu&&(uu&&t.type==="mousemove"?(Ex=t.screenX-uu.screenX,Ax=t.screenY-uu.screenY):Ax=Ex=0,uu=t),Ex)},movementY:function(t){return"movementY"in t?t.movementY:Ax}}),GN=Ns(R0),l6=Pn({},R0,{dataTransfer:0}),c6=Ns(l6),d6=Pn({},af,{relatedTarget:0}),Px=Ns(d6),u6=Pn({},Pd,{animationName:0,elapsedTime:0,pseudoElement:0}),h6=Ns(u6),f6=Pn({},Pd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),m6=Ns(f6),p6=Pn({},Pd,{data:0}),QN=Ns(p6),g6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},x6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},v6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function y6(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=v6[t])?!!e[t]:!1}function nb(){return y6}var _6=Pn({},af,{key:function(t){if(t.key){var e=g6[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Gm(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?x6[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nb,charCode:function(t){return t.type==="keypress"?Gm(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Gm(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),w6=Ns(_6),b6=Pn({},R0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),YN=Ns(b6),j6=Pn({},af,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nb}),N6=Ns(j6),S6=Pn({},Pd,{propertyName:0,elapsedTime:0,pseudoElement:0}),k6=Ns(S6),C6=Pn({},R0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),E6=Ns(C6),A6=[9,13,27,32],rb=yi&&"CompositionEvent"in window,qu=null;yi&&"documentMode"in document&&(qu=document.documentMode);var P6=yi&&"TextEvent"in window&&!qu,QE=yi&&(!rb||qu&&8<qu&&11>=qu),XN=" ",JN=!1;function YE(t,e){switch(t){case"keyup":return A6.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function XE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var kc=!1;function D6(t,e){switch(t){case"compositionend":return XE(e);case"keypress":return e.which!==32?null:(JN=!0,XN);case"textInput":return t=e.data,t===XN&&JN?null:t;default:return null}}function T6(t,e){if(kc)return t==="compositionend"||!rb&&YE(t,e)?(t=GE(),Zm=eb=co=null,kc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return QE&&e.locale!=="ko"?null:e.data;default:return null}}var M6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function e2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!M6[t.type]:e==="textarea"}function JE(t,e,n,s){PE(s),e=Pp(e,"onChange"),0<e.length&&(n=new tb("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Wu=null,ph=null;function R6(t){d4(t,0)}function I0(t){var e=Ac(t);if(jE(e))return t}function I6(t,e){if(t==="change")return e}var e4=!1;if(yi){var Dx;if(yi){var Tx="oninput"in document;if(!Tx){var t2=document.createElement("div");t2.setAttribute("oninput","return;"),Tx=typeof t2.oninput=="function"}Dx=Tx}else Dx=!1;e4=Dx&&(!document.documentMode||9<document.documentMode)}function n2(){Wu&&(Wu.detachEvent("onpropertychange",t4),ph=Wu=null)}function t4(t){if(t.propertyName==="value"&&I0(ph)){var e=[];JE(e,ph,t,Gw(t)),RE(R6,e)}}function O6(t,e,n){t==="focusin"?(n2(),Wu=e,ph=n,Wu.attachEvent("onpropertychange",t4)):t==="focusout"&&n2()}function L6(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return I0(ph)}function F6(t,e){if(t==="click")return I0(e)}function B6(t,e){if(t==="input"||t==="change")return I0(e)}function z6(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ha=typeof Object.is=="function"?Object.is:z6;function gh(t,e){if(ha(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var a=n[s];if(!wy.call(e,a)||!ha(t[a],e[a]))return!1}return!0}function r2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function s2(t,e){var n=r2(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=r2(n)}}function n4(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?n4(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function r4(){for(var t=window,e=jp();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=jp(t.document)}return e}function sb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function $6(t){var e=r4(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&n4(n.ownerDocument.documentElement,n)){if(s!==null&&sb(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,i=Math.min(s.start,a);s=s.end===void 0?i:Math.min(s.end,a),!t.extend&&i>s&&(a=s,s=i,i=a),a=s2(n,i);var o=s2(n,s);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var U6=yi&&"documentMode"in document&&11>=document.documentMode,Cc=null,zy=null,Hu=null,$y=!1;function a2(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;$y||Cc==null||Cc!==jp(s)||(s=Cc,"selectionStart"in s&&sb(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Hu&&gh(Hu,s)||(Hu=s,s=Pp(zy,"onSelect"),0<s.length&&(e=new tb("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=Cc)))}function lm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ec={animationend:lm("Animation","AnimationEnd"),animationiteration:lm("Animation","AnimationIteration"),animationstart:lm("Animation","AnimationStart"),transitionend:lm("Transition","TransitionEnd")},Mx={},s4={};yi&&(s4=document.createElement("div").style,"AnimationEvent"in window||(delete Ec.animationend.animation,delete Ec.animationiteration.animation,delete Ec.animationstart.animation),"TransitionEvent"in window||delete Ec.transitionend.transition);function O0(t){if(Mx[t])return Mx[t];if(!Ec[t])return t;var e=Ec[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in s4)return Mx[t]=e[n];return t}var a4=O0("animationend"),i4=O0("animationiteration"),o4=O0("animationstart"),l4=O0("transitionend"),c4=new Map,i2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fo(t,e){c4.set(t,e),$l(e,[t])}for(var Rx=0;Rx<i2.length;Rx++){var Ix=i2[Rx],q6=Ix.toLowerCase(),W6=Ix[0].toUpperCase()+Ix.slice(1);Fo(q6,"on"+W6)}Fo(a4,"onAnimationEnd");Fo(i4,"onAnimationIteration");Fo(o4,"onAnimationStart");Fo("dblclick","onDoubleClick");Fo("focusin","onFocus");Fo("focusout","onBlur");Fo(l4,"onTransitionEnd");ud("onMouseEnter",["mouseout","mouseover"]);ud("onMouseLeave",["mouseout","mouseover"]);ud("onPointerEnter",["pointerout","pointerover"]);ud("onPointerLeave",["pointerout","pointerover"]);$l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$l("onBeforeInput",["compositionend","keypress","textInput","paste"]);$l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),H6=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nu));function o2(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,q8(s,e,void 0,t),t.currentTarget=null}function d4(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],a=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var c=s[o],d=c.instance,u=c.currentTarget;if(c=c.listener,d!==i&&a.isPropagationStopped())break e;o2(a,c,u),i=d}else for(o=0;o<s.length;o++){if(c=s[o],d=c.instance,u=c.currentTarget,c=c.listener,d!==i&&a.isPropagationStopped())break e;o2(a,c,u),i=d}}}if(Sp)throw t=Oy,Sp=!1,Oy=null,t}function _n(t,e){var n=e[Vy];n===void 0&&(n=e[Vy]=new Set);var s=t+"__bubble";n.has(s)||(u4(e,t,2,!1),n.add(s))}function Ox(t,e,n){var s=0;e&&(s|=4),u4(n,t,s,e)}var cm="_reactListening"+Math.random().toString(36).slice(2);function xh(t){if(!t[cm]){t[cm]=!0,vE.forEach(function(n){n!=="selectionchange"&&(H6.has(n)||Ox(n,!1,t),Ox(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[cm]||(e[cm]=!0,Ox("selectionchange",!1,e))}}function u4(t,e,n,s){switch(ZE(e)){case 1:var a=a6;break;case 4:a=i6;break;default:a=Jw}n=a.bind(null,e,n,t),a=void 0,!Iy||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),s?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function Lx(t,e,n,s,a){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var c=s.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(o===4)for(o=s.return;o!==null;){var d=o.tag;if((d===3||d===4)&&(d=o.stateNode.containerInfo,d===a||d.nodeType===8&&d.parentNode===a))return;o=o.return}for(;c!==null;){if(o=cl(c),o===null)return;if(d=o.tag,d===5||d===6){s=i=o;continue e}c=c.parentNode}}s=s.return}RE(function(){var u=i,m=Gw(n),f=[];e:{var p=c4.get(t);if(p!==void 0){var y=tb,j=t;switch(t){case"keypress":if(Gm(n)===0)break e;case"keydown":case"keyup":y=w6;break;case"focusin":j="focus",y=Px;break;case"focusout":j="blur",y=Px;break;case"beforeblur":case"afterblur":y=Px;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=GN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=c6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=N6;break;case a4:case i4:case o4:y=h6;break;case l4:y=k6;break;case"scroll":y=o6;break;case"wheel":y=E6;break;case"copy":case"cut":case"paste":y=m6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=YN}var v=(e&4)!==0,_=!v&&t==="scroll",b=v?p!==null?p+"Capture":null:p;v=[];for(var w=u,N;w!==null;){N=w;var S=N.stateNode;if(N.tag===5&&S!==null&&(N=S,b!==null&&(S=uh(w,b),S!=null&&v.push(vh(w,S,N)))),_)break;w=w.return}0<v.length&&(p=new y(p,j,null,n,m),f.push({event:p,listeners:v}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",p&&n!==My&&(j=n.relatedTarget||n.fromElement)&&(cl(j)||j[_i]))break e;if((y||p)&&(p=m.window===m?m:(p=m.ownerDocument)?p.defaultView||p.parentWindow:window,y?(j=n.relatedTarget||n.toElement,y=u,j=j?cl(j):null,j!==null&&(_=Ul(j),j!==_||j.tag!==5&&j.tag!==6)&&(j=null)):(y=null,j=u),y!==j)){if(v=GN,S="onMouseLeave",b="onMouseEnter",w="mouse",(t==="pointerout"||t==="pointerover")&&(v=YN,S="onPointerLeave",b="onPointerEnter",w="pointer"),_=y==null?p:Ac(y),N=j==null?p:Ac(j),p=new v(S,w+"leave",y,n,m),p.target=_,p.relatedTarget=N,S=null,cl(m)===u&&(v=new v(b,w+"enter",j,n,m),v.target=N,v.relatedTarget=_,S=v),_=S,y&&j)t:{for(v=y,b=j,w=0,N=v;N;N=ic(N))w++;for(N=0,S=b;S;S=ic(S))N++;for(;0<w-N;)v=ic(v),w--;for(;0<N-w;)b=ic(b),N--;for(;w--;){if(v===b||b!==null&&v===b.alternate)break t;v=ic(v),b=ic(b)}v=null}else v=null;y!==null&&l2(f,p,y,v,!1),j!==null&&_!==null&&l2(f,_,j,v,!0)}}e:{if(p=u?Ac(u):window,y=p.nodeName&&p.nodeName.toLowerCase(),y==="select"||y==="input"&&p.type==="file")var A=I6;else if(e2(p))if(e4)A=B6;else{A=L6;var E=O6}else(y=p.nodeName)&&y.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(A=F6);if(A&&(A=A(t,u))){JE(f,A,n,m);break e}E&&E(t,p,u),t==="focusout"&&(E=p._wrapperState)&&E.controlled&&p.type==="number"&&Ey(p,"number",p.value)}switch(E=u?Ac(u):window,t){case"focusin":(e2(E)||E.contentEditable==="true")&&(Cc=E,zy=u,Hu=null);break;case"focusout":Hu=zy=Cc=null;break;case"mousedown":$y=!0;break;case"contextmenu":case"mouseup":case"dragend":$y=!1,a2(f,n,m);break;case"selectionchange":if(U6)break;case"keydown":case"keyup":a2(f,n,m)}var D;if(rb)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else kc?YE(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(QE&&n.locale!=="ko"&&(kc||M!=="onCompositionStart"?M==="onCompositionEnd"&&kc&&(D=GE()):(co=m,eb="value"in co?co.value:co.textContent,kc=!0)),E=Pp(u,M),0<E.length&&(M=new QN(M,t,null,n,m),f.push({event:M,listeners:E}),D?M.data=D:(D=XE(n),D!==null&&(M.data=D)))),(D=P6?D6(t,n):T6(t,n))&&(u=Pp(u,"onBeforeInput"),0<u.length&&(m=new QN("onBeforeInput","beforeinput",null,n,m),f.push({event:m,listeners:u}),m.data=D))}d4(f,e)})}function vh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Pp(t,e){for(var n=e+"Capture",s=[];t!==null;){var a=t,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=uh(t,n),i!=null&&s.unshift(vh(t,i,a)),i=uh(t,e),i!=null&&s.push(vh(t,i,a))),t=t.return}return s}function ic(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function l2(t,e,n,s,a){for(var i=e._reactName,o=[];n!==null&&n!==s;){var c=n,d=c.alternate,u=c.stateNode;if(d!==null&&d===s)break;c.tag===5&&u!==null&&(c=u,a?(d=uh(n,i),d!=null&&o.unshift(vh(n,d,c))):a||(d=uh(n,i),d!=null&&o.push(vh(n,d,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var V6=/\r\n?/g,K6=/\u0000|\uFFFD/g;function c2(t){return(typeof t=="string"?t:""+t).replace(V6,`
`).replace(K6,"")}function dm(t,e,n){if(e=c2(e),c2(t)!==e&&n)throw Error(Ae(425))}function Dp(){}var Uy=null,qy=null;function Wy(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Hy=typeof setTimeout=="function"?setTimeout:void 0,Z6=typeof clearTimeout=="function"?clearTimeout:void 0,d2=typeof Promise=="function"?Promise:void 0,G6=typeof queueMicrotask=="function"?queueMicrotask:typeof d2<"u"?function(t){return d2.resolve(null).then(t).catch(Q6)}:Hy;function Q6(t){setTimeout(function(){throw t})}function Fx(t,e){var n=e,s=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(s===0){t.removeChild(a),mh(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=a}while(n);mh(e)}function yo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function u2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Dd=Math.random().toString(36).slice(2),Ra="__reactFiber$"+Dd,yh="__reactProps$"+Dd,_i="__reactContainer$"+Dd,Vy="__reactEvents$"+Dd,Y6="__reactListeners$"+Dd,X6="__reactHandles$"+Dd;function cl(t){var e=t[Ra];if(e)return e;for(var n=t.parentNode;n;){if(e=n[_i]||n[Ra]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=u2(t);t!==null;){if(n=t[Ra])return n;t=u2(t)}return e}t=n,n=t.parentNode}return null}function of(t){return t=t[Ra]||t[_i],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ac(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ae(33))}function L0(t){return t[yh]||null}var Ky=[],Pc=-1;function Bo(t){return{current:t}}function wn(t){0>Pc||(t.current=Ky[Pc],Ky[Pc]=null,Pc--)}function xn(t,e){Pc++,Ky[Pc]=t.current,t.current=e}var Co={},Cr=Bo(Co),es=Bo(!1),kl=Co;function hd(t,e){var n=t.type.contextTypes;if(!n)return Co;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function ts(t){return t=t.childContextTypes,t!=null}function Tp(){wn(es),wn(Cr)}function h2(t,e,n){if(Cr.current!==Co)throw Error(Ae(168));xn(Cr,e),xn(es,n)}function h4(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var a in s)if(!(a in e))throw Error(Ae(108,O8(t)||"Unknown",a));return Pn({},n,s)}function Mp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Co,kl=Cr.current,xn(Cr,t),xn(es,es.current),!0}function f2(t,e,n){var s=t.stateNode;if(!s)throw Error(Ae(169));n?(t=h4(t,e,kl),s.__reactInternalMemoizedMergedChildContext=t,wn(es),wn(Cr),xn(Cr,t)):wn(es),xn(es,n)}var fi=null,F0=!1,Bx=!1;function f4(t){fi===null?fi=[t]:fi.push(t)}function J6(t){F0=!0,f4(t)}function zo(){if(!Bx&&fi!==null){Bx=!0;var t=0,e=un;try{var n=fi;for(un=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}fi=null,F0=!1}catch(a){throw fi!==null&&(fi=fi.slice(t+1)),FE(Qw,zo),a}finally{un=e,Bx=!1}}return null}var Dc=[],Tc=0,Rp=null,Ip=0,Ts=[],Ms=0,Cl=null,pi=1,gi="";function nl(t,e){Dc[Tc++]=Ip,Dc[Tc++]=Rp,Rp=t,Ip=e}function m4(t,e,n){Ts[Ms++]=pi,Ts[Ms++]=gi,Ts[Ms++]=Cl,Cl=t;var s=pi;t=gi;var a=32-ia(s)-1;s&=~(1<<a),n+=1;var i=32-ia(e)+a;if(30<i){var o=a-a%5;i=(s&(1<<o)-1).toString(32),s>>=o,a-=o,pi=1<<32-ia(e)+a|n<<a|s,gi=i+t}else pi=1<<i|n<<a|s,gi=t}function ab(t){t.return!==null&&(nl(t,1),m4(t,1,0))}function ib(t){for(;t===Rp;)Rp=Dc[--Tc],Dc[Tc]=null,Ip=Dc[--Tc],Dc[Tc]=null;for(;t===Cl;)Cl=Ts[--Ms],Ts[Ms]=null,gi=Ts[--Ms],Ts[Ms]=null,pi=Ts[--Ms],Ts[Ms]=null}var fs=null,us=null,bn=!1,ea=null;function p4(t,e){var n=Rs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function m2(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,fs=t,us=yo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,fs=t,us=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Cl!==null?{id:pi,overflow:gi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Rs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,fs=t,us=null,!0):!1;default:return!1}}function Zy(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Gy(t){if(bn){var e=us;if(e){var n=e;if(!m2(t,e)){if(Zy(t))throw Error(Ae(418));e=yo(n.nextSibling);var s=fs;e&&m2(t,e)?p4(s,n):(t.flags=t.flags&-4097|2,bn=!1,fs=t)}}else{if(Zy(t))throw Error(Ae(418));t.flags=t.flags&-4097|2,bn=!1,fs=t}}}function p2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fs=t}function um(t){if(t!==fs)return!1;if(!bn)return p2(t),bn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Wy(t.type,t.memoizedProps)),e&&(e=us)){if(Zy(t))throw g4(),Error(Ae(418));for(;e;)p4(t,e),e=yo(e.nextSibling)}if(p2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ae(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){us=yo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}us=null}}else us=fs?yo(t.stateNode.nextSibling):null;return!0}function g4(){for(var t=us;t;)t=yo(t.nextSibling)}function fd(){us=fs=null,bn=!1}function ob(t){ea===null?ea=[t]:ea.push(t)}var eL=Ai.ReactCurrentBatchConfig;function hu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ae(309));var s=n.stateNode}if(!s)throw Error(Ae(147,t));var a=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=a.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Ae(284));if(!n._owner)throw Error(Ae(290,t))}return t}function hm(t,e){throw t=Object.prototype.toString.call(e),Error(Ae(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function g2(t){var e=t._init;return e(t._payload)}function x4(t){function e(b,w){if(t){var N=b.deletions;N===null?(b.deletions=[w],b.flags|=16):N.push(w)}}function n(b,w){if(!t)return null;for(;w!==null;)e(b,w),w=w.sibling;return null}function s(b,w){for(b=new Map;w!==null;)w.key!==null?b.set(w.key,w):b.set(w.index,w),w=w.sibling;return b}function a(b,w){return b=jo(b,w),b.index=0,b.sibling=null,b}function i(b,w,N){return b.index=N,t?(N=b.alternate,N!==null?(N=N.index,N<w?(b.flags|=2,w):N):(b.flags|=2,w)):(b.flags|=1048576,w)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function c(b,w,N,S){return w===null||w.tag!==6?(w=Vx(N,b.mode,S),w.return=b,w):(w=a(w,N),w.return=b,w)}function d(b,w,N,S){var A=N.type;return A===Sc?m(b,w,N.props.children,S,N.key):w!==null&&(w.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Vi&&g2(A)===w.type)?(S=a(w,N.props),S.ref=hu(b,w,N),S.return=b,S):(S=np(N.type,N.key,N.props,null,b.mode,S),S.ref=hu(b,w,N),S.return=b,S)}function u(b,w,N,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==N.containerInfo||w.stateNode.implementation!==N.implementation?(w=Kx(N,b.mode,S),w.return=b,w):(w=a(w,N.children||[]),w.return=b,w)}function m(b,w,N,S,A){return w===null||w.tag!==7?(w=bl(N,b.mode,S,A),w.return=b,w):(w=a(w,N),w.return=b,w)}function f(b,w,N){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Vx(""+w,b.mode,N),w.return=b,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case tm:return N=np(w.type,w.key,w.props,null,b.mode,N),N.ref=hu(b,null,w),N.return=b,N;case Nc:return w=Kx(w,b.mode,N),w.return=b,w;case Vi:var S=w._init;return f(b,S(w._payload),N)}if(bu(w)||ou(w))return w=bl(w,b.mode,N,null),w.return=b,w;hm(b,w)}return null}function p(b,w,N,S){var A=w!==null?w.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return A!==null?null:c(b,w,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case tm:return N.key===A?d(b,w,N,S):null;case Nc:return N.key===A?u(b,w,N,S):null;case Vi:return A=N._init,p(b,w,A(N._payload),S)}if(bu(N)||ou(N))return A!==null?null:m(b,w,N,S,null);hm(b,N)}return null}function y(b,w,N,S,A){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(N)||null,c(w,b,""+S,A);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case tm:return b=b.get(S.key===null?N:S.key)||null,d(w,b,S,A);case Nc:return b=b.get(S.key===null?N:S.key)||null,u(w,b,S,A);case Vi:var E=S._init;return y(b,w,N,E(S._payload),A)}if(bu(S)||ou(S))return b=b.get(N)||null,m(w,b,S,A,null);hm(w,S)}return null}function j(b,w,N,S){for(var A=null,E=null,D=w,M=w=0,B=null;D!==null&&M<N.length;M++){D.index>M?(B=D,D=null):B=D.sibling;var R=p(b,D,N[M],S);if(R===null){D===null&&(D=B);break}t&&D&&R.alternate===null&&e(b,D),w=i(R,w,M),E===null?A=R:E.sibling=R,E=R,D=B}if(M===N.length)return n(b,D),bn&&nl(b,M),A;if(D===null){for(;M<N.length;M++)D=f(b,N[M],S),D!==null&&(w=i(D,w,M),E===null?A=D:E.sibling=D,E=D);return bn&&nl(b,M),A}for(D=s(b,D);M<N.length;M++)B=y(D,b,M,N[M],S),B!==null&&(t&&B.alternate!==null&&D.delete(B.key===null?M:B.key),w=i(B,w,M),E===null?A=B:E.sibling=B,E=B);return t&&D.forEach(function(P){return e(b,P)}),bn&&nl(b,M),A}function v(b,w,N,S){var A=ou(N);if(typeof A!="function")throw Error(Ae(150));if(N=A.call(N),N==null)throw Error(Ae(151));for(var E=A=null,D=w,M=w=0,B=null,R=N.next();D!==null&&!R.done;M++,R=N.next()){D.index>M?(B=D,D=null):B=D.sibling;var P=p(b,D,R.value,S);if(P===null){D===null&&(D=B);break}t&&D&&P.alternate===null&&e(b,D),w=i(P,w,M),E===null?A=P:E.sibling=P,E=P,D=B}if(R.done)return n(b,D),bn&&nl(b,M),A;if(D===null){for(;!R.done;M++,R=N.next())R=f(b,R.value,S),R!==null&&(w=i(R,w,M),E===null?A=R:E.sibling=R,E=R);return bn&&nl(b,M),A}for(D=s(b,D);!R.done;M++,R=N.next())R=y(D,b,M,R.value,S),R!==null&&(t&&R.alternate!==null&&D.delete(R.key===null?M:R.key),w=i(R,w,M),E===null?A=R:E.sibling=R,E=R);return t&&D.forEach(function(F){return e(b,F)}),bn&&nl(b,M),A}function _(b,w,N,S){if(typeof N=="object"&&N!==null&&N.type===Sc&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case tm:e:{for(var A=N.key,E=w;E!==null;){if(E.key===A){if(A=N.type,A===Sc){if(E.tag===7){n(b,E.sibling),w=a(E,N.props.children),w.return=b,b=w;break e}}else if(E.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Vi&&g2(A)===E.type){n(b,E.sibling),w=a(E,N.props),w.ref=hu(b,E,N),w.return=b,b=w;break e}n(b,E);break}else e(b,E);E=E.sibling}N.type===Sc?(w=bl(N.props.children,b.mode,S,N.key),w.return=b,b=w):(S=np(N.type,N.key,N.props,null,b.mode,S),S.ref=hu(b,w,N),S.return=b,b=S)}return o(b);case Nc:e:{for(E=N.key;w!==null;){if(w.key===E)if(w.tag===4&&w.stateNode.containerInfo===N.containerInfo&&w.stateNode.implementation===N.implementation){n(b,w.sibling),w=a(w,N.children||[]),w.return=b,b=w;break e}else{n(b,w);break}else e(b,w);w=w.sibling}w=Kx(N,b.mode,S),w.return=b,b=w}return o(b);case Vi:return E=N._init,_(b,w,E(N._payload),S)}if(bu(N))return j(b,w,N,S);if(ou(N))return v(b,w,N,S);hm(b,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,w!==null&&w.tag===6?(n(b,w.sibling),w=a(w,N),w.return=b,b=w):(n(b,w),w=Vx(N,b.mode,S),w.return=b,b=w),o(b)):n(b,w)}return _}var md=x4(!0),v4=x4(!1),Op=Bo(null),Lp=null,Mc=null,lb=null;function cb(){lb=Mc=Lp=null}function db(t){var e=Op.current;wn(Op),t._currentValue=e}function Qy(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Wc(t,e){Lp=t,lb=Mc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Jr=!0),t.firstContext=null)}function Fs(t){var e=t._currentValue;if(lb!==t)if(t={context:t,memoizedValue:e,next:null},Mc===null){if(Lp===null)throw Error(Ae(308));Mc=t,Lp.dependencies={lanes:0,firstContext:t}}else Mc=Mc.next=t;return e}var dl=null;function ub(t){dl===null?dl=[t]:dl.push(t)}function y4(t,e,n,s){var a=e.interleaved;return a===null?(n.next=n,ub(e)):(n.next=a.next,a.next=n),e.interleaved=n,wi(t,s)}function wi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ki=!1;function hb(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _4(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function _o(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,tn&2){var a=s.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),s.pending=e,wi(t,n)}return a=s.interleaved,a===null?(e.next=e,ub(s)):(e.next=a.next,a.next=e),s.interleaved=e,wi(t,n)}function Qm(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Yw(t,n)}}function x2(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?a=i=e:i=i.next=e}else a=i=e;n={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Fp(t,e,n,s){var a=t.updateQueue;Ki=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var d=c,u=d.next;d.next=null,o===null?i=u:o.next=u,o=d;var m=t.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==o&&(c===null?m.firstBaseUpdate=u:c.next=u,m.lastBaseUpdate=d))}if(i!==null){var f=a.baseState;o=0,m=u=d=null,c=i;do{var p=c.lane,y=c.eventTime;if((s&p)===p){m!==null&&(m=m.next={eventTime:y,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var j=t,v=c;switch(p=e,y=n,v.tag){case 1:if(j=v.payload,typeof j=="function"){f=j.call(y,f,p);break e}f=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=v.payload,p=typeof j=="function"?j.call(y,f,p):j,p==null)break e;f=Pn({},f,p);break e;case 2:Ki=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,p=a.effects,p===null?a.effects=[c]:p.push(c))}else y={eventTime:y,lane:p,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(u=m=y,d=f):m=m.next=y,o|=p;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;p=c,c=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(m===null&&(d=f),a.baseState=d,a.firstBaseUpdate=u,a.lastBaseUpdate=m,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);Al|=o,t.lanes=o,t.memoizedState=f}}function v2(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],a=s.callback;if(a!==null){if(s.callback=null,s=n,typeof a!="function")throw Error(Ae(191,a));a.call(s)}}}var lf={},$a=Bo(lf),_h=Bo(lf),wh=Bo(lf);function ul(t){if(t===lf)throw Error(Ae(174));return t}function fb(t,e){switch(xn(wh,e),xn(_h,t),xn($a,lf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Py(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Py(e,t)}wn($a),xn($a,e)}function pd(){wn($a),wn(_h),wn(wh)}function w4(t){ul(wh.current);var e=ul($a.current),n=Py(e,t.type);e!==n&&(xn(_h,t),xn($a,n))}function mb(t){_h.current===t&&(wn($a),wn(_h))}var Cn=Bo(0);function Bp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var zx=[];function pb(){for(var t=0;t<zx.length;t++)zx[t]._workInProgressVersionPrimary=null;zx.length=0}var Ym=Ai.ReactCurrentDispatcher,$x=Ai.ReactCurrentBatchConfig,El=0,An=null,Gn=null,rr=null,zp=!1,Vu=!1,bh=0,tL=0;function _r(){throw Error(Ae(321))}function gb(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ha(t[n],e[n]))return!1;return!0}function xb(t,e,n,s,a,i){if(El=i,An=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ym.current=t===null||t.memoizedState===null?aL:iL,t=n(s,a),Vu){i=0;do{if(Vu=!1,bh=0,25<=i)throw Error(Ae(301));i+=1,rr=Gn=null,e.updateQueue=null,Ym.current=oL,t=n(s,a)}while(Vu)}if(Ym.current=$p,e=Gn!==null&&Gn.next!==null,El=0,rr=Gn=An=null,zp=!1,e)throw Error(Ae(300));return t}function vb(){var t=bh!==0;return bh=0,t}function Ca(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rr===null?An.memoizedState=rr=t:rr=rr.next=t,rr}function Bs(){if(Gn===null){var t=An.alternate;t=t!==null?t.memoizedState:null}else t=Gn.next;var e=rr===null?An.memoizedState:rr.next;if(e!==null)rr=e,Gn=t;else{if(t===null)throw Error(Ae(310));Gn=t,t={memoizedState:Gn.memoizedState,baseState:Gn.baseState,baseQueue:Gn.baseQueue,queue:Gn.queue,next:null},rr===null?An.memoizedState=rr=t:rr=rr.next=t}return rr}function jh(t,e){return typeof e=="function"?e(t):e}function Ux(t){var e=Bs(),n=e.queue;if(n===null)throw Error(Ae(311));n.lastRenderedReducer=t;var s=Gn,a=s.baseQueue,i=n.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}s.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,s=s.baseState;var c=o=null,d=null,u=i;do{var m=u.lane;if((El&m)===m)d!==null&&(d=d.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var f={lane:m,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};d===null?(c=d=f,o=s):d=d.next=f,An.lanes|=m,Al|=m}u=u.next}while(u!==null&&u!==i);d===null?o=s:d.next=c,ha(s,e.memoizedState)||(Jr=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=d,n.lastRenderedState=s}if(t=n.interleaved,t!==null){a=t;do i=a.lane,An.lanes|=i,Al|=i,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function qx(t){var e=Bs(),n=e.queue;if(n===null)throw Error(Ae(311));n.lastRenderedReducer=t;var s=n.dispatch,a=n.pending,i=e.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do i=t(i,o.action),o=o.next;while(o!==a);ha(i,e.memoizedState)||(Jr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function b4(){}function j4(t,e){var n=An,s=Bs(),a=e(),i=!ha(s.memoizedState,a);if(i&&(s.memoizedState=a,Jr=!0),s=s.queue,yb(k4.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||rr!==null&&rr.memoizedState.tag&1){if(n.flags|=2048,Nh(9,S4.bind(null,n,s,a,e),void 0,null),ir===null)throw Error(Ae(349));El&30||N4(n,e,a)}return a}function N4(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=An.updateQueue,e===null?(e={lastEffect:null,stores:null},An.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function S4(t,e,n,s){e.value=n,e.getSnapshot=s,C4(e)&&E4(t)}function k4(t,e,n){return n(function(){C4(e)&&E4(t)})}function C4(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ha(t,n)}catch{return!0}}function E4(t){var e=wi(t,1);e!==null&&oa(e,t,1,-1)}function y2(t){var e=Ca();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jh,lastRenderedState:t},e.queue=t,t=t.dispatch=sL.bind(null,An,t),[e.memoizedState,t]}function Nh(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=An.updateQueue,e===null?(e={lastEffect:null,stores:null},An.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function A4(){return Bs().memoizedState}function Xm(t,e,n,s){var a=Ca();An.flags|=t,a.memoizedState=Nh(1|e,n,void 0,s===void 0?null:s)}function B0(t,e,n,s){var a=Bs();s=s===void 0?null:s;var i=void 0;if(Gn!==null){var o=Gn.memoizedState;if(i=o.destroy,s!==null&&gb(s,o.deps)){a.memoizedState=Nh(e,n,i,s);return}}An.flags|=t,a.memoizedState=Nh(1|e,n,i,s)}function _2(t,e){return Xm(8390656,8,t,e)}function yb(t,e){return B0(2048,8,t,e)}function P4(t,e){return B0(4,2,t,e)}function D4(t,e){return B0(4,4,t,e)}function T4(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function M4(t,e,n){return n=n!=null?n.concat([t]):null,B0(4,4,T4.bind(null,e,t),n)}function _b(){}function R4(t,e){var n=Bs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&gb(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function I4(t,e){var n=Bs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&gb(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function O4(t,e,n){return El&21?(ha(n,e)||(n=$E(),An.lanes|=n,Al|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Jr=!0),t.memoizedState=n)}function nL(t,e){var n=un;un=n!==0&&4>n?n:4,t(!0);var s=$x.transition;$x.transition={};try{t(!1),e()}finally{un=n,$x.transition=s}}function L4(){return Bs().memoizedState}function rL(t,e,n){var s=bo(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},F4(t))B4(e,n);else if(n=y4(t,e,n,s),n!==null){var a=Fr();oa(n,t,s,a),z4(n,e,s)}}function sL(t,e,n){var s=bo(t),a={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(F4(t))B4(e,a);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(a.hasEagerState=!0,a.eagerState=c,ha(c,o)){var d=e.interleaved;d===null?(a.next=a,ub(e)):(a.next=d.next,d.next=a),e.interleaved=a;return}}catch{}finally{}n=y4(t,e,a,s),n!==null&&(a=Fr(),oa(n,t,s,a),z4(n,e,s))}}function F4(t){var e=t.alternate;return t===An||e!==null&&e===An}function B4(t,e){Vu=zp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function z4(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Yw(t,n)}}var $p={readContext:Fs,useCallback:_r,useContext:_r,useEffect:_r,useImperativeHandle:_r,useInsertionEffect:_r,useLayoutEffect:_r,useMemo:_r,useReducer:_r,useRef:_r,useState:_r,useDebugValue:_r,useDeferredValue:_r,useTransition:_r,useMutableSource:_r,useSyncExternalStore:_r,useId:_r,unstable_isNewReconciler:!1},aL={readContext:Fs,useCallback:function(t,e){return Ca().memoizedState=[t,e===void 0?null:e],t},useContext:Fs,useEffect:_2,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Xm(4194308,4,T4.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Xm(4194308,4,t,e)},useInsertionEffect:function(t,e){return Xm(4,2,t,e)},useMemo:function(t,e){var n=Ca();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=Ca();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=rL.bind(null,An,t),[s.memoizedState,t]},useRef:function(t){var e=Ca();return t={current:t},e.memoizedState=t},useState:y2,useDebugValue:_b,useDeferredValue:function(t){return Ca().memoizedState=t},useTransition:function(){var t=y2(!1),e=t[0];return t=nL.bind(null,t[1]),Ca().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=An,a=Ca();if(bn){if(n===void 0)throw Error(Ae(407));n=n()}else{if(n=e(),ir===null)throw Error(Ae(349));El&30||N4(s,e,n)}a.memoizedState=n;var i={value:n,getSnapshot:e};return a.queue=i,_2(k4.bind(null,s,i,t),[t]),s.flags|=2048,Nh(9,S4.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=Ca(),e=ir.identifierPrefix;if(bn){var n=gi,s=pi;n=(s&~(1<<32-ia(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=bh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=tL++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},iL={readContext:Fs,useCallback:R4,useContext:Fs,useEffect:yb,useImperativeHandle:M4,useInsertionEffect:P4,useLayoutEffect:D4,useMemo:I4,useReducer:Ux,useRef:A4,useState:function(){return Ux(jh)},useDebugValue:_b,useDeferredValue:function(t){var e=Bs();return O4(e,Gn.memoizedState,t)},useTransition:function(){var t=Ux(jh)[0],e=Bs().memoizedState;return[t,e]},useMutableSource:b4,useSyncExternalStore:j4,useId:L4,unstable_isNewReconciler:!1},oL={readContext:Fs,useCallback:R4,useContext:Fs,useEffect:yb,useImperativeHandle:M4,useInsertionEffect:P4,useLayoutEffect:D4,useMemo:I4,useReducer:qx,useRef:A4,useState:function(){return qx(jh)},useDebugValue:_b,useDeferredValue:function(t){var e=Bs();return Gn===null?e.memoizedState=t:O4(e,Gn.memoizedState,t)},useTransition:function(){var t=qx(jh)[0],e=Bs().memoizedState;return[t,e]},useMutableSource:b4,useSyncExternalStore:j4,useId:L4,unstable_isNewReconciler:!1};function Gs(t,e){if(t&&t.defaultProps){e=Pn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Yy(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Pn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var z0={isMounted:function(t){return(t=t._reactInternals)?Ul(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Fr(),a=bo(t),i=xi(s,a);i.payload=e,n!=null&&(i.callback=n),e=_o(t,i,a),e!==null&&(oa(e,t,a,s),Qm(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Fr(),a=bo(t),i=xi(s,a);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=_o(t,i,a),e!==null&&(oa(e,t,a,s),Qm(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Fr(),s=bo(t),a=xi(n,s);a.tag=2,e!=null&&(a.callback=e),e=_o(t,a,s),e!==null&&(oa(e,t,s,n),Qm(e,t,s))}};function w2(t,e,n,s,a,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!gh(n,s)||!gh(a,i):!0}function $4(t,e,n){var s=!1,a=Co,i=e.contextType;return typeof i=="object"&&i!==null?i=Fs(i):(a=ts(e)?kl:Cr.current,s=e.contextTypes,i=(s=s!=null)?hd(t,a):Co),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=z0,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function b2(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&z0.enqueueReplaceState(e,e.state,null)}function Xy(t,e,n,s){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},hb(t);var i=e.contextType;typeof i=="object"&&i!==null?a.context=Fs(i):(i=ts(e)?kl:Cr.current,a.context=hd(t,i)),a.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Yy(t,e,i,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&z0.enqueueReplaceState(a,a.state,null),Fp(t,n,a,s),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function gd(t,e){try{var n="",s=e;do n+=I8(s),s=s.return;while(s);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:a,digest:null}}function Wx(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Jy(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var lL=typeof WeakMap=="function"?WeakMap:Map;function U4(t,e,n){n=xi(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){qp||(qp=!0,c_=s),Jy(t,e)},n}function q4(t,e,n){n=xi(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var a=e.value;n.payload=function(){return s(a)},n.callback=function(){Jy(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Jy(t,e),typeof s!="function"&&(wo===null?wo=new Set([this]):wo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function j2(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new lL;var a=new Set;s.set(e,a)}else a=s.get(e),a===void 0&&(a=new Set,s.set(e,a));a.has(n)||(a.add(n),t=bL.bind(null,t,e,n),e.then(t,t))}function N2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function S2(t,e,n,s,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xi(-1,1),e.tag=2,_o(n,e,1))),n.lanes|=1),t)}var cL=Ai.ReactCurrentOwner,Jr=!1;function Or(t,e,n,s){e.child=t===null?v4(e,null,n,s):md(e,t.child,n,s)}function k2(t,e,n,s,a){n=n.render;var i=e.ref;return Wc(e,a),s=xb(t,e,n,s,i,a),n=vb(),t!==null&&!Jr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,bi(t,e,a)):(bn&&n&&ab(e),e.flags|=1,Or(t,e,s,a),e.child)}function C2(t,e,n,s,a){if(t===null){var i=n.type;return typeof i=="function"&&!Eb(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,W4(t,e,i,s,a)):(t=np(n.type,null,s,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&a)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:gh,n(o,s)&&t.ref===e.ref)return bi(t,e,a)}return e.flags|=1,t=jo(i,s),t.ref=e.ref,t.return=e,e.child=t}function W4(t,e,n,s,a){if(t!==null){var i=t.memoizedProps;if(gh(i,s)&&t.ref===e.ref)if(Jr=!1,e.pendingProps=s=i,(t.lanes&a)!==0)t.flags&131072&&(Jr=!0);else return e.lanes=t.lanes,bi(t,e,a)}return e_(t,e,n,s,a)}function H4(t,e,n){var s=e.pendingProps,a=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xn(Ic,cs),cs|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xn(Ic,cs),cs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,xn(Ic,cs),cs|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,xn(Ic,cs),cs|=s;return Or(t,e,a,n),e.child}function V4(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function e_(t,e,n,s,a){var i=ts(n)?kl:Cr.current;return i=hd(e,i),Wc(e,a),n=xb(t,e,n,s,i,a),s=vb(),t!==null&&!Jr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,bi(t,e,a)):(bn&&s&&ab(e),e.flags|=1,Or(t,e,n,a),e.child)}function E2(t,e,n,s,a){if(ts(n)){var i=!0;Mp(e)}else i=!1;if(Wc(e,a),e.stateNode===null)Jm(t,e),$4(e,n,s),Xy(e,n,s,a),s=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var d=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Fs(u):(u=ts(n)?kl:Cr.current,u=hd(e,u));var m=n.getDerivedStateFromProps,f=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==s||d!==u)&&b2(e,o,s,u),Ki=!1;var p=e.memoizedState;o.state=p,Fp(e,s,o,a),d=e.memoizedState,c!==s||p!==d||es.current||Ki?(typeof m=="function"&&(Yy(e,n,m,s),d=e.memoizedState),(c=Ki||w2(e,n,c,s,p,d,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=d),o.props=s,o.state=d,o.context=u,s=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,_4(t,e),c=e.memoizedProps,u=e.type===e.elementType?c:Gs(e.type,c),o.props=u,f=e.pendingProps,p=o.context,d=n.contextType,typeof d=="object"&&d!==null?d=Fs(d):(d=ts(n)?kl:Cr.current,d=hd(e,d));var y=n.getDerivedStateFromProps;(m=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==f||p!==d)&&b2(e,o,s,d),Ki=!1,p=e.memoizedState,o.state=p,Fp(e,s,o,a);var j=e.memoizedState;c!==f||p!==j||es.current||Ki?(typeof y=="function"&&(Yy(e,n,y,s),j=e.memoizedState),(u=Ki||w2(e,n,u,s,p,j,d)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,j,d),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,j,d)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=j),o.props=s,o.state=j,o.context=d,s=u):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),s=!1)}return t_(t,e,n,s,i,a)}function t_(t,e,n,s,a,i){V4(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return a&&f2(e,n,!1),bi(t,e,i);s=e.stateNode,cL.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=md(e,t.child,null,i),e.child=md(e,null,c,i)):Or(t,e,c,i),e.memoizedState=s.state,a&&f2(e,n,!0),e.child}function K4(t){var e=t.stateNode;e.pendingContext?h2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&h2(t,e.context,!1),fb(t,e.containerInfo)}function A2(t,e,n,s,a){return fd(),ob(a),e.flags|=256,Or(t,e,n,s),e.child}var n_={dehydrated:null,treeContext:null,retryLane:0};function r_(t){return{baseLanes:t,cachePool:null,transitions:null}}function Z4(t,e,n){var s=e.pendingProps,a=Cn.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(a&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),xn(Cn,a&1),t===null)return Gy(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=q0(o,s,0,null),t=bl(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=r_(n),e.memoizedState=n_,t):wb(e,o));if(a=t.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return dL(t,e,o,s,c,a,n);if(i){i=s.fallback,o=e.mode,a=t.child,c=a.sibling;var d={mode:"hidden",children:s.children};return!(o&1)&&e.child!==a?(s=e.child,s.childLanes=0,s.pendingProps=d,e.deletions=null):(s=jo(a,d),s.subtreeFlags=a.subtreeFlags&14680064),c!==null?i=jo(c,i):(i=bl(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?r_(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=n_,s}return i=t.child,t=i.sibling,s=jo(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function wb(t,e){return e=q0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function fm(t,e,n,s){return s!==null&&ob(s),md(e,t.child,null,n),t=wb(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function dL(t,e,n,s,a,i,o){if(n)return e.flags&256?(e.flags&=-257,s=Wx(Error(Ae(422))),fm(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,a=e.mode,s=q0({mode:"visible",children:s.children},a,0,null),i=bl(i,a,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&md(e,t.child,null,o),e.child.memoizedState=r_(o),e.memoizedState=n_,i);if(!(e.mode&1))return fm(t,e,o,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var c=s.dgst;return s=c,i=Error(Ae(419)),s=Wx(i,s,void 0),fm(t,e,o,s)}if(c=(o&t.childLanes)!==0,Jr||c){if(s=ir,s!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,wi(t,a),oa(s,t,a,-1))}return Cb(),s=Wx(Error(Ae(421))),fm(t,e,o,s)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=jL.bind(null,t),a._reactRetry=e,null):(t=i.treeContext,us=yo(a.nextSibling),fs=e,bn=!0,ea=null,t!==null&&(Ts[Ms++]=pi,Ts[Ms++]=gi,Ts[Ms++]=Cl,pi=t.id,gi=t.overflow,Cl=e),e=wb(e,s.children),e.flags|=4096,e)}function P2(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Qy(t.return,e,n)}function Hx(t,e,n,s,a){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=a)}function G4(t,e,n){var s=e.pendingProps,a=s.revealOrder,i=s.tail;if(Or(t,e,s.children,n),s=Cn.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&P2(t,n,e);else if(t.tag===19)P2(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(xn(Cn,s),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&Bp(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),Hx(e,!1,a,n,i);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&Bp(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}Hx(e,!0,n,null,i);break;case"together":Hx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Jm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function bi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Al|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ae(153));if(e.child!==null){for(t=e.child,n=jo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=jo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function uL(t,e,n){switch(e.tag){case 3:K4(e),fd();break;case 5:w4(e);break;case 1:ts(e.type)&&Mp(e);break;case 4:fb(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,a=e.memoizedProps.value;xn(Op,s._currentValue),s._currentValue=a;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(xn(Cn,Cn.current&1),e.flags|=128,null):n&e.child.childLanes?Z4(t,e,n):(xn(Cn,Cn.current&1),t=bi(t,e,n),t!==null?t.sibling:null);xn(Cn,Cn.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return G4(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),xn(Cn,Cn.current),s)break;return null;case 22:case 23:return e.lanes=0,H4(t,e,n)}return bi(t,e,n)}var Q4,s_,Y4,X4;Q4=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};s_=function(){};Y4=function(t,e,n,s){var a=t.memoizedProps;if(a!==s){t=e.stateNode,ul($a.current);var i=null;switch(n){case"input":a=ky(t,a),s=ky(t,s),i=[];break;case"select":a=Pn({},a,{value:void 0}),s=Pn({},s,{value:void 0}),i=[];break;case"textarea":a=Ay(t,a),s=Ay(t,s),i=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=Dp)}Dy(n,s);var o;n=null;for(u in a)if(!s.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var c=a[u];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ch.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var d=s[u];if(c=a!=null?a[u]:void 0,s.hasOwnProperty(u)&&d!==c&&(d!=null||c!=null))if(u==="style")if(c){for(o in c)!c.hasOwnProperty(o)||d&&d.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in d)d.hasOwnProperty(o)&&c[o]!==d[o]&&(n||(n={}),n[o]=d[o])}else n||(i||(i=[]),i.push(u,n)),n=d;else u==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,c=c?c.__html:void 0,d!=null&&c!==d&&(i=i||[]).push(u,d)):u==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(u,""+d):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ch.hasOwnProperty(u)?(d!=null&&u==="onScroll"&&_n("scroll",t),i||c===d||(i=[])):(i=i||[]).push(u,d))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};X4=function(t,e,n,s){n!==s&&(e.flags|=4)};function fu(t,e){if(!bn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function wr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function hL(t,e,n){var s=e.pendingProps;switch(ib(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wr(e),null;case 1:return ts(e.type)&&Tp(),wr(e),null;case 3:return s=e.stateNode,pd(),wn(es),wn(Cr),pb(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(um(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ea!==null&&(h_(ea),ea=null))),s_(t,e),wr(e),null;case 5:mb(e);var a=ul(wh.current);if(n=e.type,t!==null&&e.stateNode!=null)Y4(t,e,n,s,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(Ae(166));return wr(e),null}if(t=ul($a.current),um(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[Ra]=e,s[yh]=i,t=(e.mode&1)!==0,n){case"dialog":_n("cancel",s),_n("close",s);break;case"iframe":case"object":case"embed":_n("load",s);break;case"video":case"audio":for(a=0;a<Nu.length;a++)_n(Nu[a],s);break;case"source":_n("error",s);break;case"img":case"image":case"link":_n("error",s),_n("load",s);break;case"details":_n("toggle",s);break;case"input":BN(s,i),_n("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},_n("invalid",s);break;case"textarea":$N(s,i),_n("invalid",s)}Dy(n,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?s.textContent!==c&&(i.suppressHydrationWarning!==!0&&dm(s.textContent,c,t),a=["children",c]):typeof c=="number"&&s.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&dm(s.textContent,c,t),a=["children",""+c]):ch.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&_n("scroll",s)}switch(n){case"input":nm(s),zN(s,i,!0);break;case"textarea":nm(s),UN(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=Dp)}s=a,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=kE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[Ra]=e,t[yh]=s,Q4(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ty(n,s),n){case"dialog":_n("cancel",t),_n("close",t),a=s;break;case"iframe":case"object":case"embed":_n("load",t),a=s;break;case"video":case"audio":for(a=0;a<Nu.length;a++)_n(Nu[a],t);a=s;break;case"source":_n("error",t),a=s;break;case"img":case"image":case"link":_n("error",t),_n("load",t),a=s;break;case"details":_n("toggle",t),a=s;break;case"input":BN(t,s),a=ky(t,s),_n("invalid",t);break;case"option":a=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},a=Pn({},s,{value:void 0}),_n("invalid",t);break;case"textarea":$N(t,s),a=Ay(t,s),_n("invalid",t);break;default:a=s}Dy(n,a),c=a;for(i in c)if(c.hasOwnProperty(i)){var d=c[i];i==="style"?AE(t,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&CE(t,d)):i==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&dh(t,d):typeof d=="number"&&dh(t,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ch.hasOwnProperty(i)?d!=null&&i==="onScroll"&&_n("scroll",t):d!=null&&Hw(t,i,d,o))}switch(n){case"input":nm(t),zN(t,s,!1);break;case"textarea":nm(t),UN(t);break;case"option":s.value!=null&&t.setAttribute("value",""+ko(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?zc(t,!!s.multiple,i,!1):s.defaultValue!=null&&zc(t,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Dp)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return wr(e),null;case 6:if(t&&e.stateNode!=null)X4(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(Ae(166));if(n=ul(wh.current),ul($a.current),um(e)){if(s=e.stateNode,n=e.memoizedProps,s[Ra]=e,(i=s.nodeValue!==n)&&(t=fs,t!==null))switch(t.tag){case 3:dm(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&dm(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Ra]=e,e.stateNode=s}return wr(e),null;case 13:if(wn(Cn),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(bn&&us!==null&&e.mode&1&&!(e.flags&128))g4(),fd(),e.flags|=98560,i=!1;else if(i=um(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(Ae(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ae(317));i[Ra]=e}else fd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;wr(e),i=!1}else ea!==null&&(h_(ea),ea=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Cn.current&1?Yn===0&&(Yn=3):Cb())),e.updateQueue!==null&&(e.flags|=4),wr(e),null);case 4:return pd(),s_(t,e),t===null&&xh(e.stateNode.containerInfo),wr(e),null;case 10:return db(e.type._context),wr(e),null;case 17:return ts(e.type)&&Tp(),wr(e),null;case 19:if(wn(Cn),i=e.memoizedState,i===null)return wr(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)fu(i,!1);else{if(Yn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Bp(t),o!==null){for(e.flags|=128,fu(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return xn(Cn,Cn.current&1|2),e.child}t=t.sibling}i.tail!==null&&In()>xd&&(e.flags|=128,s=!0,fu(i,!1),e.lanes=4194304)}else{if(!s)if(t=Bp(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),fu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!bn)return wr(e),null}else 2*In()-i.renderingStartTime>xd&&n!==1073741824&&(e.flags|=128,s=!0,fu(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=In(),e.sibling=null,n=Cn.current,xn(Cn,s?n&1|2:n&1),e):(wr(e),null);case 22:case 23:return kb(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?cs&1073741824&&(wr(e),e.subtreeFlags&6&&(e.flags|=8192)):wr(e),null;case 24:return null;case 25:return null}throw Error(Ae(156,e.tag))}function fL(t,e){switch(ib(e),e.tag){case 1:return ts(e.type)&&Tp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pd(),wn(es),wn(Cr),pb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return mb(e),null;case 13:if(wn(Cn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ae(340));fd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return wn(Cn),null;case 4:return pd(),null;case 10:return db(e.type._context),null;case 22:case 23:return kb(),null;case 24:return null;default:return null}}var mm=!1,Nr=!1,mL=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function Rc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Tn(t,e,s)}else n.current=null}function a_(t,e,n){try{n()}catch(s){Tn(t,e,s)}}var D2=!1;function pL(t,e){if(Uy=Ep,t=r4(),sb(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var a=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,d=-1,u=0,m=0,f=t,p=null;t:for(;;){for(var y;f!==n||a!==0&&f.nodeType!==3||(c=o+a),f!==i||s!==0&&f.nodeType!==3||(d=o+s),f.nodeType===3&&(o+=f.nodeValue.length),(y=f.firstChild)!==null;)p=f,f=y;for(;;){if(f===t)break t;if(p===n&&++u===a&&(c=o),p===i&&++m===s&&(d=o),(y=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=y}n=c===-1||d===-1?null:{start:c,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(qy={focusedElem:t,selectionRange:n},Ep=!1,Ze=e;Ze!==null;)if(e=Ze,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ze=t;else for(;Ze!==null;){e=Ze;try{var j=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var v=j.memoizedProps,_=j.memoizedState,b=e.stateNode,w=b.getSnapshotBeforeUpdate(e.elementType===e.type?v:Gs(e.type,v),_);b.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ae(163))}}catch(S){Tn(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,Ze=t;break}Ze=e.return}return j=D2,D2=!1,j}function Ku(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,i!==void 0&&a_(e,n,i)}a=a.next}while(a!==s)}}function $0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function i_(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function J4(t){var e=t.alternate;e!==null&&(t.alternate=null,J4(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ra],delete e[yh],delete e[Vy],delete e[Y6],delete e[X6])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function eA(t){return t.tag===5||t.tag===3||t.tag===4}function T2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||eA(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function o_(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Dp));else if(s!==4&&(t=t.child,t!==null))for(o_(t,e,n),t=t.sibling;t!==null;)o_(t,e,n),t=t.sibling}function l_(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(l_(t,e,n),t=t.sibling;t!==null;)l_(t,e,n),t=t.sibling}var ur=null,Xs=!1;function Ii(t,e,n){for(n=n.child;n!==null;)tA(t,e,n),n=n.sibling}function tA(t,e,n){if(za&&typeof za.onCommitFiberUnmount=="function")try{za.onCommitFiberUnmount(M0,n)}catch{}switch(n.tag){case 5:Nr||Rc(n,e);case 6:var s=ur,a=Xs;ur=null,Ii(t,e,n),ur=s,Xs=a,ur!==null&&(Xs?(t=ur,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ur.removeChild(n.stateNode));break;case 18:ur!==null&&(Xs?(t=ur,n=n.stateNode,t.nodeType===8?Fx(t.parentNode,n):t.nodeType===1&&Fx(t,n),mh(t)):Fx(ur,n.stateNode));break;case 4:s=ur,a=Xs,ur=n.stateNode.containerInfo,Xs=!0,Ii(t,e,n),ur=s,Xs=a;break;case 0:case 11:case 14:case 15:if(!Nr&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&a_(n,e,o),a=a.next}while(a!==s)}Ii(t,e,n);break;case 1:if(!Nr&&(Rc(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(c){Tn(n,e,c)}Ii(t,e,n);break;case 21:Ii(t,e,n);break;case 22:n.mode&1?(Nr=(s=Nr)||n.memoizedState!==null,Ii(t,e,n),Nr=s):Ii(t,e,n);break;default:Ii(t,e,n)}}function M2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new mL),e.forEach(function(s){var a=NL.bind(null,t,s);n.has(s)||(n.add(s),s.then(a,a))})}}function Hs(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var a=n[s];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:ur=c.stateNode,Xs=!1;break e;case 3:ur=c.stateNode.containerInfo,Xs=!0;break e;case 4:ur=c.stateNode.containerInfo,Xs=!0;break e}c=c.return}if(ur===null)throw Error(Ae(160));tA(i,o,a),ur=null,Xs=!1;var d=a.alternate;d!==null&&(d.return=null),a.return=null}catch(u){Tn(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)nA(e,t),e=e.sibling}function nA(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Hs(e,t),Na(t),s&4){try{Ku(3,t,t.return),$0(3,t)}catch(v){Tn(t,t.return,v)}try{Ku(5,t,t.return)}catch(v){Tn(t,t.return,v)}}break;case 1:Hs(e,t),Na(t),s&512&&n!==null&&Rc(n,n.return);break;case 5:if(Hs(e,t),Na(t),s&512&&n!==null&&Rc(n,n.return),t.flags&32){var a=t.stateNode;try{dh(a,"")}catch(v){Tn(t,t.return,v)}}if(s&4&&(a=t.stateNode,a!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&NE(a,i),Ty(c,o);var u=Ty(c,i);for(o=0;o<d.length;o+=2){var m=d[o],f=d[o+1];m==="style"?AE(a,f):m==="dangerouslySetInnerHTML"?CE(a,f):m==="children"?dh(a,f):Hw(a,m,f,u)}switch(c){case"input":Cy(a,i);break;case"textarea":SE(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?zc(a,!!i.multiple,y,!1):p!==!!i.multiple&&(i.defaultValue!=null?zc(a,!!i.multiple,i.defaultValue,!0):zc(a,!!i.multiple,i.multiple?[]:"",!1))}a[yh]=i}catch(v){Tn(t,t.return,v)}}break;case 6:if(Hs(e,t),Na(t),s&4){if(t.stateNode===null)throw Error(Ae(162));a=t.stateNode,i=t.memoizedProps;try{a.nodeValue=i}catch(v){Tn(t,t.return,v)}}break;case 3:if(Hs(e,t),Na(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{mh(e.containerInfo)}catch(v){Tn(t,t.return,v)}break;case 4:Hs(e,t),Na(t);break;case 13:Hs(e,t),Na(t),a=t.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(Nb=In())),s&4&&M2(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(Nr=(u=Nr)||m,Hs(e,t),Nr=u):Hs(e,t),Na(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!m&&t.mode&1)for(Ze=t,m=t.child;m!==null;){for(f=Ze=m;Ze!==null;){switch(p=Ze,y=p.child,p.tag){case 0:case 11:case 14:case 15:Ku(4,p,p.return);break;case 1:Rc(p,p.return);var j=p.stateNode;if(typeof j.componentWillUnmount=="function"){s=p,n=p.return;try{e=s,j.props=e.memoizedProps,j.state=e.memoizedState,j.componentWillUnmount()}catch(v){Tn(s,n,v)}}break;case 5:Rc(p,p.return);break;case 22:if(p.memoizedState!==null){I2(f);continue}}y!==null?(y.return=p,Ze=y):I2(f)}m=m.sibling}e:for(m=null,f=t;;){if(f.tag===5){if(m===null){m=f;try{a=f.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=f.stateNode,d=f.memoizedProps.style,o=d!=null&&d.hasOwnProperty("display")?d.display:null,c.style.display=EE("display",o))}catch(v){Tn(t,t.return,v)}}}else if(f.tag===6){if(m===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){Tn(t,t.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;m===f&&(m=null),f=f.return}m===f&&(m=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Hs(e,t),Na(t),s&4&&M2(t);break;case 21:break;default:Hs(e,t),Na(t)}}function Na(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(eA(n)){var s=n;break e}n=n.return}throw Error(Ae(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(dh(a,""),s.flags&=-33);var i=T2(t);l_(t,i,a);break;case 3:case 4:var o=s.stateNode.containerInfo,c=T2(t);o_(t,c,o);break;default:throw Error(Ae(161))}}catch(d){Tn(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gL(t,e,n){Ze=t,rA(t)}function rA(t,e,n){for(var s=(t.mode&1)!==0;Ze!==null;){var a=Ze,i=a.child;if(a.tag===22&&s){var o=a.memoizedState!==null||mm;if(!o){var c=a.alternate,d=c!==null&&c.memoizedState!==null||Nr;c=mm;var u=Nr;if(mm=o,(Nr=d)&&!u)for(Ze=a;Ze!==null;)o=Ze,d=o.child,o.tag===22&&o.memoizedState!==null?O2(a):d!==null?(d.return=o,Ze=d):O2(a);for(;i!==null;)Ze=i,rA(i),i=i.sibling;Ze=a,mm=c,Nr=u}R2(t)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Ze=i):R2(t)}}function R2(t){for(;Ze!==null;){var e=Ze;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Nr||$0(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Nr)if(n===null)s.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:Gs(e.type,n.memoizedProps);s.componentDidUpdate(a,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&v2(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}v2(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var m=u.memoizedState;if(m!==null){var f=m.dehydrated;f!==null&&mh(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ae(163))}Nr||e.flags&512&&i_(e)}catch(p){Tn(e,e.return,p)}}if(e===t){Ze=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ze=n;break}Ze=e.return}}function I2(t){for(;Ze!==null;){var e=Ze;if(e===t){Ze=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ze=n;break}Ze=e.return}}function O2(t){for(;Ze!==null;){var e=Ze;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{$0(4,e)}catch(d){Tn(e,n,d)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var a=e.return;try{s.componentDidMount()}catch(d){Tn(e,a,d)}}var i=e.return;try{i_(e)}catch(d){Tn(e,i,d)}break;case 5:var o=e.return;try{i_(e)}catch(d){Tn(e,o,d)}}}catch(d){Tn(e,e.return,d)}if(e===t){Ze=null;break}var c=e.sibling;if(c!==null){c.return=e.return,Ze=c;break}Ze=e.return}}var xL=Math.ceil,Up=Ai.ReactCurrentDispatcher,bb=Ai.ReactCurrentOwner,Os=Ai.ReactCurrentBatchConfig,tn=0,ir=null,zn=null,gr=0,cs=0,Ic=Bo(0),Yn=0,Sh=null,Al=0,U0=0,jb=0,Zu=null,Yr=null,Nb=0,xd=1/0,ui=null,qp=!1,c_=null,wo=null,pm=!1,uo=null,Wp=0,Gu=0,d_=null,ep=-1,tp=0;function Fr(){return tn&6?In():ep!==-1?ep:ep=In()}function bo(t){return t.mode&1?tn&2&&gr!==0?gr&-gr:eL.transition!==null?(tp===0&&(tp=$E()),tp):(t=un,t!==0||(t=window.event,t=t===void 0?16:ZE(t.type)),t):1}function oa(t,e,n,s){if(50<Gu)throw Gu=0,d_=null,Error(Ae(185));sf(t,n,s),(!(tn&2)||t!==ir)&&(t===ir&&(!(tn&2)&&(U0|=n),Yn===4&&Yi(t,gr)),ns(t,s),n===1&&tn===0&&!(e.mode&1)&&(xd=In()+500,F0&&zo()))}function ns(t,e){var n=t.callbackNode;e6(t,e);var s=Cp(t,t===ir?gr:0);if(s===0)n!==null&&HN(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&HN(n),e===1)t.tag===0?J6(L2.bind(null,t)):f4(L2.bind(null,t)),G6(function(){!(tn&6)&&zo()}),n=null;else{switch(UE(s)){case 1:n=Qw;break;case 4:n=BE;break;case 16:n=kp;break;case 536870912:n=zE;break;default:n=kp}n=uA(n,sA.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function sA(t,e){if(ep=-1,tp=0,tn&6)throw Error(Ae(327));var n=t.callbackNode;if(Hc()&&t.callbackNode!==n)return null;var s=Cp(t,t===ir?gr:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Hp(t,s);else{e=s;var a=tn;tn|=2;var i=iA();(ir!==t||gr!==e)&&(ui=null,xd=In()+500,wl(t,e));do try{_L();break}catch(c){aA(t,c)}while(!0);cb(),Up.current=i,tn=a,zn!==null?e=0:(ir=null,gr=0,e=Yn)}if(e!==0){if(e===2&&(a=Ly(t),a!==0&&(s=a,e=u_(t,a))),e===1)throw n=Sh,wl(t,0),Yi(t,s),ns(t,In()),n;if(e===6)Yi(t,s);else{if(a=t.current.alternate,!(s&30)&&!vL(a)&&(e=Hp(t,s),e===2&&(i=Ly(t),i!==0&&(s=i,e=u_(t,i))),e===1))throw n=Sh,wl(t,0),Yi(t,s),ns(t,In()),n;switch(t.finishedWork=a,t.finishedLanes=s,e){case 0:case 1:throw Error(Ae(345));case 2:rl(t,Yr,ui);break;case 3:if(Yi(t,s),(s&130023424)===s&&(e=Nb+500-In(),10<e)){if(Cp(t,0)!==0)break;if(a=t.suspendedLanes,(a&s)!==s){Fr(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=Hy(rl.bind(null,t,Yr,ui),e);break}rl(t,Yr,ui);break;case 4:if(Yi(t,s),(s&4194240)===s)break;for(e=t.eventTimes,a=-1;0<s;){var o=31-ia(s);i=1<<o,o=e[o],o>a&&(a=o),s&=~i}if(s=a,s=In()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*xL(s/1960))-s,10<s){t.timeoutHandle=Hy(rl.bind(null,t,Yr,ui),s);break}rl(t,Yr,ui);break;case 5:rl(t,Yr,ui);break;default:throw Error(Ae(329))}}}return ns(t,In()),t.callbackNode===n?sA.bind(null,t):null}function u_(t,e){var n=Zu;return t.current.memoizedState.isDehydrated&&(wl(t,e).flags|=256),t=Hp(t,e),t!==2&&(e=Yr,Yr=n,e!==null&&h_(e)),t}function h_(t){Yr===null?Yr=t:Yr.push.apply(Yr,t)}function vL(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var a=n[s],i=a.getSnapshot;a=a.value;try{if(!ha(i(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Yi(t,e){for(e&=~jb,e&=~U0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ia(e),s=1<<n;t[n]=-1,e&=~s}}function L2(t){if(tn&6)throw Error(Ae(327));Hc();var e=Cp(t,0);if(!(e&1))return ns(t,In()),null;var n=Hp(t,e);if(t.tag!==0&&n===2){var s=Ly(t);s!==0&&(e=s,n=u_(t,s))}if(n===1)throw n=Sh,wl(t,0),Yi(t,e),ns(t,In()),n;if(n===6)throw Error(Ae(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,rl(t,Yr,ui),ns(t,In()),null}function Sb(t,e){var n=tn;tn|=1;try{return t(e)}finally{tn=n,tn===0&&(xd=In()+500,F0&&zo())}}function Pl(t){uo!==null&&uo.tag===0&&!(tn&6)&&Hc();var e=tn;tn|=1;var n=Os.transition,s=un;try{if(Os.transition=null,un=1,t)return t()}finally{un=s,Os.transition=n,tn=e,!(tn&6)&&zo()}}function kb(){cs=Ic.current,wn(Ic)}function wl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,Z6(n)),zn!==null)for(n=zn.return;n!==null;){var s=n;switch(ib(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Tp();break;case 3:pd(),wn(es),wn(Cr),pb();break;case 5:mb(s);break;case 4:pd();break;case 13:wn(Cn);break;case 19:wn(Cn);break;case 10:db(s.type._context);break;case 22:case 23:kb()}n=n.return}if(ir=t,zn=t=jo(t.current,null),gr=cs=e,Yn=0,Sh=null,jb=U0=Al=0,Yr=Zu=null,dl!==null){for(e=0;e<dl.length;e++)if(n=dl[e],s=n.interleaved,s!==null){n.interleaved=null;var a=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=a,s.next=o}n.pending=s}dl=null}return t}function aA(t,e){do{var n=zn;try{if(cb(),Ym.current=$p,zp){for(var s=An.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}zp=!1}if(El=0,rr=Gn=An=null,Vu=!1,bh=0,bb.current=null,n===null||n.return===null){Yn=1,Sh=e,zn=null;break}e:{var i=t,o=n.return,c=n,d=e;if(e=gr,c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var u=d,m=c,f=m.tag;if(!(m.mode&1)&&(f===0||f===11||f===15)){var p=m.alternate;p?(m.updateQueue=p.updateQueue,m.memoizedState=p.memoizedState,m.lanes=p.lanes):(m.updateQueue=null,m.memoizedState=null)}var y=N2(o);if(y!==null){y.flags&=-257,S2(y,o,c,i,e),y.mode&1&&j2(i,u,e),e=y,d=u;var j=e.updateQueue;if(j===null){var v=new Set;v.add(d),e.updateQueue=v}else j.add(d);break e}else{if(!(e&1)){j2(i,u,e),Cb();break e}d=Error(Ae(426))}}else if(bn&&c.mode&1){var _=N2(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),S2(_,o,c,i,e),ob(gd(d,c));break e}}i=d=gd(d,c),Yn!==4&&(Yn=2),Zu===null?Zu=[i]:Zu.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=U4(i,d,e);x2(i,b);break e;case 1:c=d;var w=i.type,N=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(wo===null||!wo.has(N)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=q4(i,c,e);x2(i,S);break e}}i=i.return}while(i!==null)}lA(n)}catch(A){e=A,zn===n&&n!==null&&(zn=n=n.return);continue}break}while(!0)}function iA(){var t=Up.current;return Up.current=$p,t===null?$p:t}function Cb(){(Yn===0||Yn===3||Yn===2)&&(Yn=4),ir===null||!(Al&268435455)&&!(U0&268435455)||Yi(ir,gr)}function Hp(t,e){var n=tn;tn|=2;var s=iA();(ir!==t||gr!==e)&&(ui=null,wl(t,e));do try{yL();break}catch(a){aA(t,a)}while(!0);if(cb(),tn=n,Up.current=s,zn!==null)throw Error(Ae(261));return ir=null,gr=0,Yn}function yL(){for(;zn!==null;)oA(zn)}function _L(){for(;zn!==null&&!H8();)oA(zn)}function oA(t){var e=dA(t.alternate,t,cs);t.memoizedProps=t.pendingProps,e===null?lA(t):zn=e,bb.current=null}function lA(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=fL(n,e),n!==null){n.flags&=32767,zn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Yn=6,zn=null;return}}else if(n=hL(n,e,cs),n!==null){zn=n;return}if(e=e.sibling,e!==null){zn=e;return}zn=e=t}while(e!==null);Yn===0&&(Yn=5)}function rl(t,e,n){var s=un,a=Os.transition;try{Os.transition=null,un=1,wL(t,e,n,s)}finally{Os.transition=a,un=s}return null}function wL(t,e,n,s){do Hc();while(uo!==null);if(tn&6)throw Error(Ae(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Ae(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(t6(t,i),t===ir&&(zn=ir=null,gr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||pm||(pm=!0,uA(kp,function(){return Hc(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Os.transition,Os.transition=null;var o=un;un=1;var c=tn;tn|=4,bb.current=null,pL(t,n),nA(n,t),$6(qy),Ep=!!Uy,qy=Uy=null,t.current=n,gL(n),V8(),tn=c,un=o,Os.transition=i}else t.current=n;if(pm&&(pm=!1,uo=t,Wp=a),i=t.pendingLanes,i===0&&(wo=null),G8(n.stateNode),ns(t,In()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],s(a.value,{componentStack:a.stack,digest:a.digest});if(qp)throw qp=!1,t=c_,c_=null,t;return Wp&1&&t.tag!==0&&Hc(),i=t.pendingLanes,i&1?t===d_?Gu++:(Gu=0,d_=t):Gu=0,zo(),null}function Hc(){if(uo!==null){var t=UE(Wp),e=Os.transition,n=un;try{if(Os.transition=null,un=16>t?16:t,uo===null)var s=!1;else{if(t=uo,uo=null,Wp=0,tn&6)throw Error(Ae(331));var a=tn;for(tn|=4,Ze=t.current;Ze!==null;){var i=Ze,o=i.child;if(Ze.flags&16){var c=i.deletions;if(c!==null){for(var d=0;d<c.length;d++){var u=c[d];for(Ze=u;Ze!==null;){var m=Ze;switch(m.tag){case 0:case 11:case 15:Ku(8,m,i)}var f=m.child;if(f!==null)f.return=m,Ze=f;else for(;Ze!==null;){m=Ze;var p=m.sibling,y=m.return;if(J4(m),m===u){Ze=null;break}if(p!==null){p.return=y,Ze=p;break}Ze=y}}}var j=i.alternate;if(j!==null){var v=j.child;if(v!==null){j.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}Ze=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ze=o;else e:for(;Ze!==null;){if(i=Ze,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ku(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,Ze=b;break e}Ze=i.return}}var w=t.current;for(Ze=w;Ze!==null;){o=Ze;var N=o.child;if(o.subtreeFlags&2064&&N!==null)N.return=o,Ze=N;else e:for(o=w;Ze!==null;){if(c=Ze,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:$0(9,c)}}catch(A){Tn(c,c.return,A)}if(c===o){Ze=null;break e}var S=c.sibling;if(S!==null){S.return=c.return,Ze=S;break e}Ze=c.return}}if(tn=a,zo(),za&&typeof za.onPostCommitFiberRoot=="function")try{za.onPostCommitFiberRoot(M0,t)}catch{}s=!0}return s}finally{un=n,Os.transition=e}}return!1}function F2(t,e,n){e=gd(n,e),e=U4(t,e,1),t=_o(t,e,1),e=Fr(),t!==null&&(sf(t,1,e),ns(t,e))}function Tn(t,e,n){if(t.tag===3)F2(t,t,n);else for(;e!==null;){if(e.tag===3){F2(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(wo===null||!wo.has(s))){t=gd(n,t),t=q4(e,t,1),e=_o(e,t,1),t=Fr(),e!==null&&(sf(e,1,t),ns(e,t));break}}e=e.return}}function bL(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Fr(),t.pingedLanes|=t.suspendedLanes&n,ir===t&&(gr&n)===n&&(Yn===4||Yn===3&&(gr&130023424)===gr&&500>In()-Nb?wl(t,0):jb|=n),ns(t,e)}function cA(t,e){e===0&&(t.mode&1?(e=am,am<<=1,!(am&130023424)&&(am=4194304)):e=1);var n=Fr();t=wi(t,e),t!==null&&(sf(t,e,n),ns(t,n))}function jL(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),cA(t,n)}function NL(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(Ae(314))}s!==null&&s.delete(e),cA(t,n)}var dA;dA=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||es.current)Jr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Jr=!1,uL(t,e,n);Jr=!!(t.flags&131072)}else Jr=!1,bn&&e.flags&1048576&&m4(e,Ip,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Jm(t,e),t=e.pendingProps;var a=hd(e,Cr.current);Wc(e,n),a=xb(null,e,s,t,a,n);var i=vb();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ts(s)?(i=!0,Mp(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,hb(e),a.updater=z0,e.stateNode=a,a._reactInternals=e,Xy(e,s,t,n),e=t_(null,e,s,!0,i,n)):(e.tag=0,bn&&i&&ab(e),Or(null,e,a,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Jm(t,e),t=e.pendingProps,a=s._init,s=a(s._payload),e.type=s,a=e.tag=kL(s),t=Gs(s,t),a){case 0:e=e_(null,e,s,t,n);break e;case 1:e=E2(null,e,s,t,n);break e;case 11:e=k2(null,e,s,t,n);break e;case 14:e=C2(null,e,s,Gs(s.type,t),n);break e}throw Error(Ae(306,s,""))}return e;case 0:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Gs(s,a),e_(t,e,s,a,n);case 1:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Gs(s,a),E2(t,e,s,a,n);case 3:e:{if(K4(e),t===null)throw Error(Ae(387));s=e.pendingProps,i=e.memoizedState,a=i.element,_4(t,e),Fp(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=gd(Error(Ae(423)),e),e=A2(t,e,s,n,a);break e}else if(s!==a){a=gd(Error(Ae(424)),e),e=A2(t,e,s,n,a);break e}else for(us=yo(e.stateNode.containerInfo.firstChild),fs=e,bn=!0,ea=null,n=v4(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(fd(),s===a){e=bi(t,e,n);break e}Or(t,e,s,n)}e=e.child}return e;case 5:return w4(e),t===null&&Gy(e),s=e.type,a=e.pendingProps,i=t!==null?t.memoizedProps:null,o=a.children,Wy(s,a)?o=null:i!==null&&Wy(s,i)&&(e.flags|=32),V4(t,e),Or(t,e,o,n),e.child;case 6:return t===null&&Gy(e),null;case 13:return Z4(t,e,n);case 4:return fb(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=md(e,null,s,n):Or(t,e,s,n),e.child;case 11:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Gs(s,a),k2(t,e,s,a,n);case 7:return Or(t,e,e.pendingProps,n),e.child;case 8:return Or(t,e,e.pendingProps.children,n),e.child;case 12:return Or(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,a=e.pendingProps,i=e.memoizedProps,o=a.value,xn(Op,s._currentValue),s._currentValue=o,i!==null)if(ha(i.value,o)){if(i.children===a.children&&!es.current){e=bi(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var d=c.firstContext;d!==null;){if(d.context===s){if(i.tag===1){d=xi(-1,n&-n),d.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var m=u.pending;m===null?d.next=d:(d.next=m.next,m.next=d),u.pending=d}}i.lanes|=n,d=i.alternate,d!==null&&(d.lanes|=n),Qy(i.return,n,e),c.lanes|=n;break}d=d.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Ae(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Qy(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Or(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,s=e.pendingProps.children,Wc(e,n),a=Fs(a),s=s(a),e.flags|=1,Or(t,e,s,n),e.child;case 14:return s=e.type,a=Gs(s,e.pendingProps),a=Gs(s.type,a),C2(t,e,s,a,n);case 15:return W4(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:Gs(s,a),Jm(t,e),e.tag=1,ts(s)?(t=!0,Mp(e)):t=!1,Wc(e,n),$4(e,s,a),Xy(e,s,a,n),t_(null,e,s,!0,t,n);case 19:return G4(t,e,n);case 22:return H4(t,e,n)}throw Error(Ae(156,e.tag))};function uA(t,e){return FE(t,e)}function SL(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rs(t,e,n,s){return new SL(t,e,n,s)}function Eb(t){return t=t.prototype,!(!t||!t.isReactComponent)}function kL(t){if(typeof t=="function")return Eb(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Kw)return 11;if(t===Zw)return 14}return 2}function jo(t,e){var n=t.alternate;return n===null?(n=Rs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function np(t,e,n,s,a,i){var o=2;if(s=t,typeof t=="function")Eb(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Sc:return bl(n.children,a,i,e);case Vw:o=8,a|=8;break;case by:return t=Rs(12,n,e,a|2),t.elementType=by,t.lanes=i,t;case jy:return t=Rs(13,n,e,a),t.elementType=jy,t.lanes=i,t;case Ny:return t=Rs(19,n,e,a),t.elementType=Ny,t.lanes=i,t;case wE:return q0(n,a,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case yE:o=10;break e;case _E:o=9;break e;case Kw:o=11;break e;case Zw:o=14;break e;case Vi:o=16,s=null;break e}throw Error(Ae(130,t==null?t:typeof t,""))}return e=Rs(o,n,e,a),e.elementType=t,e.type=s,e.lanes=i,e}function bl(t,e,n,s){return t=Rs(7,t,s,e),t.lanes=n,t}function q0(t,e,n,s){return t=Rs(22,t,s,e),t.elementType=wE,t.lanes=n,t.stateNode={isHidden:!1},t}function Vx(t,e,n){return t=Rs(6,t,null,e),t.lanes=n,t}function Kx(t,e,n){return e=Rs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function CL(t,e,n,s,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cx(0),this.expirationTimes=Cx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cx(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Ab(t,e,n,s,a,i,o,c,d){return t=new CL(t,e,n,c,d),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Rs(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hb(i),t}function EL(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Nc,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function hA(t){if(!t)return Co;t=t._reactInternals;e:{if(Ul(t)!==t||t.tag!==1)throw Error(Ae(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ts(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ae(171))}if(t.tag===1){var n=t.type;if(ts(n))return h4(t,n,e)}return e}function fA(t,e,n,s,a,i,o,c,d){return t=Ab(n,s,!0,t,a,i,o,c,d),t.context=hA(null),n=t.current,s=Fr(),a=bo(n),i=xi(s,a),i.callback=e??null,_o(n,i,a),t.current.lanes=a,sf(t,a,s),ns(t,s),t}function W0(t,e,n,s){var a=e.current,i=Fr(),o=bo(a);return n=hA(n),e.context===null?e.context=n:e.pendingContext=n,e=xi(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=_o(a,e,o),t!==null&&(oa(t,a,o,i),Qm(t,a,o)),o}function Vp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function B2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Pb(t,e){B2(t,e),(t=t.alternate)&&B2(t,e)}function AL(){return null}var mA=typeof reportError=="function"?reportError:function(t){console.error(t)};function Db(t){this._internalRoot=t}H0.prototype.render=Db.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ae(409));W0(t,e,null,null)};H0.prototype.unmount=Db.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Pl(function(){W0(null,t,null,null)}),e[_i]=null}};function H0(t){this._internalRoot=t}H0.prototype.unstable_scheduleHydration=function(t){if(t){var e=HE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Qi.length&&e!==0&&e<Qi[n].priority;n++);Qi.splice(n,0,t),n===0&&KE(t)}};function Tb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function V0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function z2(){}function PL(t,e,n,s,a){if(a){if(typeof s=="function"){var i=s;s=function(){var u=Vp(o);i.call(u)}}var o=fA(e,s,t,0,null,!1,!1,"",z2);return t._reactRootContainer=o,t[_i]=o.current,xh(t.nodeType===8?t.parentNode:t),Pl(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof s=="function"){var c=s;s=function(){var u=Vp(d);c.call(u)}}var d=Ab(t,0,!1,null,null,!1,!1,"",z2);return t._reactRootContainer=d,t[_i]=d.current,xh(t.nodeType===8?t.parentNode:t),Pl(function(){W0(e,d,n,s)}),d}function K0(t,e,n,s,a){var i=n._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var c=a;a=function(){var d=Vp(o);c.call(d)}}W0(e,o,t,a)}else o=PL(n,e,t,a,s);return Vp(o)}qE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ju(e.pendingLanes);n!==0&&(Yw(e,n|1),ns(e,In()),!(tn&6)&&(xd=In()+500,zo()))}break;case 13:Pl(function(){var s=wi(t,1);if(s!==null){var a=Fr();oa(s,t,1,a)}}),Pb(t,1)}};Xw=function(t){if(t.tag===13){var e=wi(t,134217728);if(e!==null){var n=Fr();oa(e,t,134217728,n)}Pb(t,134217728)}};WE=function(t){if(t.tag===13){var e=bo(t),n=wi(t,e);if(n!==null){var s=Fr();oa(n,t,e,s)}Pb(t,e)}};HE=function(){return un};VE=function(t,e){var n=un;try{return un=t,e()}finally{un=n}};Ry=function(t,e,n){switch(e){case"input":if(Cy(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var a=L0(s);if(!a)throw Error(Ae(90));jE(s),Cy(s,a)}}}break;case"textarea":SE(t,n);break;case"select":e=n.value,e!=null&&zc(t,!!n.multiple,e,!1)}};TE=Sb;ME=Pl;var DL={usingClientEntryPoint:!1,Events:[of,Ac,L0,PE,DE,Sb]},mu={findFiberByHostInstance:cl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TL={bundleType:mu.bundleType,version:mu.version,rendererPackageName:mu.rendererPackageName,rendererConfig:mu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ai.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=OE(t),t===null?null:t.stateNode},findFiberByHostInstance:mu.findFiberByHostInstance||AL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gm.isDisabled&&gm.supportsFiber)try{M0=gm.inject(TL),za=gm}catch{}}js.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DL;js.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tb(e))throw Error(Ae(200));return EL(t,e,null,n)};js.createRoot=function(t,e){if(!Tb(t))throw Error(Ae(299));var n=!1,s="",a=mA;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Ab(t,1,!1,null,null,n,!1,s,a),t[_i]=e.current,xh(t.nodeType===8?t.parentNode:t),new Db(e)};js.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ae(188)):(t=Object.keys(t).join(","),Error(Ae(268,t)));return t=OE(e),t=t===null?null:t.stateNode,t};js.flushSync=function(t){return Pl(t)};js.hydrate=function(t,e,n){if(!V0(e))throw Error(Ae(200));return K0(null,t,e,!0,n)};js.hydrateRoot=function(t,e,n){if(!Tb(t))throw Error(Ae(405));var s=n!=null&&n.hydratedSources||null,a=!1,i="",o=mA;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=fA(e,null,t,1,n??null,a,!1,i,o),t[_i]=e.current,xh(t),s)for(t=0;t<s.length;t++)n=s[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new H0(e)};js.render=function(t,e,n){if(!V0(e))throw Error(Ae(200));return K0(null,t,e,!1,n)};js.unmountComponentAtNode=function(t){if(!V0(t))throw Error(Ae(40));return t._reactRootContainer?(Pl(function(){K0(null,null,t,!1,function(){t._reactRootContainer=null,t[_i]=null})}),!0):!1};js.unstable_batchedUpdates=Sb;js.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!V0(n))throw Error(Ae(200));if(t==null||t._reactInternals===void 0)throw Error(Ae(38));return K0(t,e,n,!1,s)};js.version="18.3.1-next-f1338f8080-20240426";function pA(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pA)}catch(t){console.error(t)}}pA(),pE.exports=js;var $o=pE.exports;const gA=Fw($o);var xA,$2=$o;xA=$2.createRoot,$2.hydrateRoot;const ML=1,RL=1e6;let Zx=0;function IL(){return Zx=(Zx+1)%Number.MAX_SAFE_INTEGER,Zx.toString()}const Gx=new Map,U2=t=>{if(Gx.has(t))return;const e=setTimeout(()=>{Gx.delete(t),Qu({type:"REMOVE_TOAST",toastId:t})},RL);Gx.set(t,e)},OL=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,ML)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?U2(n):t.toasts.forEach(s=>{U2(s.id)}),{...t,toasts:t.toasts.map(s=>s.id===n||n===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},rp=[];let sp={toasts:[]};function Qu(t){sp=OL(sp,t),rp.forEach(e=>{e(sp)})}function Ma({...t}){const e=IL(),n=a=>Qu({type:"UPDATE_TOAST",toast:{...a,id:e}}),s=()=>Qu({type:"DISMISS_TOAST",toastId:e});return Qu({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:a=>{a||s()}}}),{id:e,dismiss:s,update:n}}function Rt(){const[t,e]=g.useState(sp);return g.useEffect(()=>(rp.push(e),()=>{const n=rp.indexOf(e);n>-1&&rp.splice(n,1)}),[t]),{...t,toast:Ma,dismiss:n=>Qu({type:"DISMISS_TOAST",toastId:n})}}function Te(t,e,{checkForDefaultPrevented:n=!0}={}){return function(a){if(t==null||t(a),n===!1||!a.defaultPrevented)return e==null?void 0:e(a)}}function LL(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function Z0(...t){return e=>t.forEach(n=>LL(n,e))}function Mt(...t){return g.useCallback(Z0(...t),t)}function FL(t,e=[]){let n=[];function s(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:y,...j}=f,v=(p==null?void 0:p[t][d])||c,_=g.useMemo(()=>j,Object.values(j));return r.jsx(v.Provider,{value:_,children:y})}function m(f,p){const y=(p==null?void 0:p[t][d])||c,j=g.useContext(y);if(j)return j;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[s,BL(a,...e)]}function BL(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var ji=g.forwardRef((t,e)=>{const{children:n,...s}=t,a=g.Children.toArray(n),i=a.find(zL);if(i){const o=i.props.children,c=a.map(d=>d===i?g.Children.count(o)>1?g.Children.only(null):g.isValidElement(o)?o.props.children:null:d);return r.jsx(f_,{...s,ref:e,children:g.isValidElement(o)?g.cloneElement(o,void 0,c):null})}return r.jsx(f_,{...s,ref:e,children:n})});ji.displayName="Slot";var f_=g.forwardRef((t,e)=>{const{children:n,...s}=t;if(g.isValidElement(n)){const a=UL(n);return g.cloneElement(n,{...$L(s,n.props),ref:e?Z0(e,a):a})}return g.Children.count(n)>1?g.Children.only(null):null});f_.displayName="SlotClone";var vA=({children:t})=>r.jsx(r.Fragment,{children:t});function zL(t){return g.isValidElement(t)&&t.type===vA}function $L(t,e){const n={...e};for(const s in e){const a=t[s],i=e[s];/^on[A-Z]/.test(s)?a&&i?n[s]=(...c)=>{i(...c),a(...c)}:a&&(n[s]=a):s==="style"?n[s]={...a,...i}:s==="className"&&(n[s]=[a,i].filter(Boolean).join(" "))}return{...t,...n}}function UL(t){var s,a;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function cf(t){const e=t+"CollectionProvider",[n,s]=FL(e),[a,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=y=>{const{scope:j,children:v}=y,_=ke.useRef(null),b=ke.useRef(new Map).current;return r.jsx(a,{scope:j,itemMap:b,collectionRef:_,children:v})};o.displayName=e;const c=t+"CollectionSlot",d=ke.forwardRef((y,j)=>{const{scope:v,children:_}=y,b=i(c,v),w=Mt(j,b.collectionRef);return r.jsx(ji,{ref:w,children:_})});d.displayName=c;const u=t+"CollectionItemSlot",m="data-radix-collection-item",f=ke.forwardRef((y,j)=>{const{scope:v,children:_,...b}=y,w=ke.useRef(null),N=Mt(j,w),S=i(u,v);return ke.useEffect(()=>(S.itemMap.set(w,{ref:w,...b}),()=>void S.itemMap.delete(w))),r.jsx(ji,{[m]:"",ref:N,children:_})});f.displayName=u;function p(y){const j=i(t+"CollectionConsumer",y);return ke.useCallback(()=>{const _=j.collectionRef.current;if(!_)return[];const b=Array.from(_.querySelectorAll(`[${m}]`));return Array.from(j.itemMap.values()).sort((S,A)=>b.indexOf(S.ref.current)-b.indexOf(A.ref.current))},[j.collectionRef,j.itemMap])}return[{Provider:o,Slot:d,ItemSlot:f},p,s]}function qL(t,e){const n=g.createContext(e),s=i=>{const{children:o,...c}=i,d=g.useMemo(()=>c,Object.values(c));return r.jsx(n.Provider,{value:d,children:o})};s.displayName=t+"Provider";function a(i){const o=g.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[s,a]}function Ss(t,e=[]){let n=[];function s(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];const u=f=>{var b;const{scope:p,children:y,...j}=f,v=((b=p==null?void 0:p[t])==null?void 0:b[d])||c,_=g.useMemo(()=>j,Object.values(j));return r.jsx(v.Provider,{value:_,children:y})};u.displayName=i+"Provider";function m(f,p){var v;const y=((v=p==null?void 0:p[t])==null?void 0:v[d])||c,j=g.useContext(y);if(j)return j;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[s,WL(a,...e)]}function WL(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var HL=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Xe=HL.reduce((t,e)=>{const n=g.forwardRef((s,a)=>{const{asChild:i,...o}=s,c=i?ji:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),r.jsx(c,{...o,ref:a})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function Mb(t,e){t&&$o.flushSync(()=>t.dispatchEvent(e))}function jn(t){const e=g.useRef(t);return g.useEffect(()=>{e.current=t}),g.useMemo(()=>(...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}function VL(t,e=globalThis==null?void 0:globalThis.document){const n=jn(t);g.useEffect(()=>{const s=a=>{a.key==="Escape"&&n(a)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[n,e])}var KL="DismissableLayer",m_="dismissableLayer.update",ZL="dismissableLayer.pointerDownOutside",GL="dismissableLayer.focusOutside",q2,yA=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ql=g.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:c,...d}=t,u=g.useContext(yA),[m,f]=g.useState(null),p=(m==null?void 0:m.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,y]=g.useState({}),j=Mt(e,D=>f(D)),v=Array.from(u.layers),[_]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),b=v.indexOf(_),w=m?v.indexOf(m):-1,N=u.layersWithOutsidePointerEventsDisabled.size>0,S=w>=b,A=YL(D=>{const M=D.target,B=[...u.branches].some(R=>R.contains(M));!S||B||(a==null||a(D),o==null||o(D),D.defaultPrevented||c==null||c())},p),E=XL(D=>{const M=D.target;[...u.branches].some(R=>R.contains(M))||(i==null||i(D),o==null||o(D),D.defaultPrevented||c==null||c())},p);return VL(D=>{w===u.layers.size-1&&(s==null||s(D),!D.defaultPrevented&&c&&(D.preventDefault(),c()))},p),g.useEffect(()=>{if(m)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(q2=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(m)),u.layers.add(m),W2(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=q2)}},[m,p,n,u]),g.useEffect(()=>()=>{m&&(u.layers.delete(m),u.layersWithOutsidePointerEventsDisabled.delete(m),W2())},[m,u]),g.useEffect(()=>{const D=()=>y({});return document.addEventListener(m_,D),()=>document.removeEventListener(m_,D)},[]),r.jsx(Xe.div,{...d,ref:j,style:{pointerEvents:N?S?"auto":"none":void 0,...t.style},onFocusCapture:Te(t.onFocusCapture,E.onFocusCapture),onBlurCapture:Te(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:Te(t.onPointerDownCapture,A.onPointerDownCapture)})});ql.displayName=KL;var QL="DismissableLayerBranch",_A=g.forwardRef((t,e)=>{const n=g.useContext(yA),s=g.useRef(null),a=Mt(e,s);return g.useEffect(()=>{const i=s.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),r.jsx(Xe.div,{...t,ref:a})});_A.displayName=QL;function YL(t,e=globalThis==null?void 0:globalThis.document){const n=jn(t),s=g.useRef(!1),a=g.useRef(()=>{});return g.useEffect(()=>{const i=c=>{if(c.target&&!s.current){let d=function(){wA(ZL,n,u,{discrete:!0})};const u={originalEvent:c};c.pointerType==="touch"?(e.removeEventListener("click",a.current),a.current=d,e.addEventListener("click",a.current,{once:!0})):d()}else e.removeEventListener("click",a.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",a.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function XL(t,e=globalThis==null?void 0:globalThis.document){const n=jn(t),s=g.useRef(!1);return g.useEffect(()=>{const a=i=>{i.target&&!s.current&&wA(GL,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",a),()=>e.removeEventListener("focusin",a)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function W2(){const t=new CustomEvent(m_);document.dispatchEvent(t)}function wA(t,e,n,{discrete:s}){const a=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&a.addEventListener(t,e,{once:!0}),s?Mb(a,i):a.dispatchEvent(i)}var JL=ql,eF=_A,Un=globalThis!=null&&globalThis.document?g.useLayoutEffect:()=>{},tF="Portal",Td=g.forwardRef((t,e)=>{var c;const{container:n,...s}=t,[a,i]=g.useState(!1);Un(()=>i(!0),[]);const o=n||a&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return o?gA.createPortal(r.jsx(Xe.div,{...s,ref:e}),o):null});Td.displayName=tF;function nF(t,e){return g.useReducer((n,s)=>e[n][s]??n,t)}var Jn=t=>{const{present:e,children:n}=t,s=rF(e),a=typeof n=="function"?n({present:s.isPresent}):g.Children.only(n),i=Mt(s.ref,sF(a));return typeof n=="function"||s.isPresent?g.cloneElement(a,{ref:i}):null};Jn.displayName="Presence";function rF(t){const[e,n]=g.useState(),s=g.useRef({}),a=g.useRef(t),i=g.useRef("none"),o=t?"mounted":"unmounted",[c,d]=nF(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const u=xm(s.current);i.current=c==="mounted"?u:"none"},[c]),Un(()=>{const u=s.current,m=a.current;if(m!==t){const p=i.current,y=xm(u);t?d("MOUNT"):y==="none"||(u==null?void 0:u.display)==="none"?d("UNMOUNT"):d(m&&p!==y?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,d]),Un(()=>{if(e){let u;const m=e.ownerDocument.defaultView??window,f=y=>{const v=xm(s.current).includes(y.animationName);if(y.target===e&&v&&(d("ANIMATION_END"),!a.current)){const _=e.style.animationFillMode;e.style.animationFillMode="forwards",u=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=_)})}},p=y=>{y.target===e&&(i.current=xm(s.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{m.clearTimeout(u),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else d("ANIMATION_END")},[e,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:g.useCallback(u=>{u&&(s.current=getComputedStyle(u)),n(u)},[])}}function xm(t){return(t==null?void 0:t.animationName)||"none"}function sF(t){var s,a;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function zs({prop:t,defaultProp:e,onChange:n=()=>{}}){const[s,a]=aF({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:s,c=jn(n),d=g.useCallback(u=>{if(i){const f=typeof u=="function"?u(t):u;f!==t&&c(f)}else a(u)},[i,t,a,c]);return[o,d]}function aF({defaultProp:t,onChange:e}){const n=g.useState(t),[s]=n,a=g.useRef(s),i=jn(e);return g.useEffect(()=>{a.current!==s&&(i(s),a.current=s)},[s,a,i]),n}var iF="VisuallyHidden",df=g.forwardRef((t,e)=>r.jsx(Xe.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));df.displayName=iF;var oF=df,Rb="ToastProvider",[Ib,lF,cF]=cf("Toast"),[bA,Bse]=Ss("Toast",[cF]),[dF,G0]=bA(Rb),jA=t=>{const{__scopeToast:e,label:n="Notification",duration:s=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:o}=t,[c,d]=g.useState(null),[u,m]=g.useState(0),f=g.useRef(!1),p=g.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Rb}\`. Expected non-empty \`string\`.`),r.jsx(Ib.Provider,{scope:e,children:r.jsx(dF,{scope:e,label:n,duration:s,swipeDirection:a,swipeThreshold:i,toastCount:u,viewport:c,onViewportChange:d,onToastAdd:g.useCallback(()=>m(y=>y+1),[]),onToastRemove:g.useCallback(()=>m(y=>y-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:p,children:o})})};jA.displayName=Rb;var NA="ToastViewport",uF=["F8"],p_="toast.viewportPause",g_="toast.viewportResume",SA=g.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:s=uF,label:a="Notifications ({hotkey})",...i}=t,o=G0(NA,n),c=lF(n),d=g.useRef(null),u=g.useRef(null),m=g.useRef(null),f=g.useRef(null),p=Mt(e,f,o.onViewportChange),y=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),j=o.toastCount>0;g.useEffect(()=>{const _=b=>{var N;s.length!==0&&s.every(S=>b[S]||b.code===S)&&((N=f.current)==null||N.focus())};return document.addEventListener("keydown",_),()=>document.removeEventListener("keydown",_)},[s]),g.useEffect(()=>{const _=d.current,b=f.current;if(j&&_&&b){const w=()=>{if(!o.isClosePausedRef.current){const E=new CustomEvent(p_);b.dispatchEvent(E),o.isClosePausedRef.current=!0}},N=()=>{if(o.isClosePausedRef.current){const E=new CustomEvent(g_);b.dispatchEvent(E),o.isClosePausedRef.current=!1}},S=E=>{!_.contains(E.relatedTarget)&&N()},A=()=>{_.contains(document.activeElement)||N()};return _.addEventListener("focusin",w),_.addEventListener("focusout",S),_.addEventListener("pointermove",w),_.addEventListener("pointerleave",A),window.addEventListener("blur",w),window.addEventListener("focus",N),()=>{_.removeEventListener("focusin",w),_.removeEventListener("focusout",S),_.removeEventListener("pointermove",w),_.removeEventListener("pointerleave",A),window.removeEventListener("blur",w),window.removeEventListener("focus",N)}}},[j,o.isClosePausedRef]);const v=g.useCallback(({tabbingDirection:_})=>{const w=c().map(N=>{const S=N.ref.current,A=[S,...NF(S)];return _==="forwards"?A:A.reverse()});return(_==="forwards"?w.reverse():w).flat()},[c]);return g.useEffect(()=>{const _=f.current;if(_){const b=w=>{var A,E,D;const N=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!N){const M=document.activeElement,B=w.shiftKey;if(w.target===_&&B){(A=u.current)==null||A.focus();return}const F=v({tabbingDirection:B?"backwards":"forwards"}),W=F.findIndex(ee=>ee===M);Qx(F.slice(W+1))?w.preventDefault():B?(E=u.current)==null||E.focus():(D=m.current)==null||D.focus()}};return _.addEventListener("keydown",b),()=>_.removeEventListener("keydown",b)}},[c,v]),r.jsxs(eF,{ref:d,role:"region","aria-label":a.replace("{hotkey}",y),tabIndex:-1,style:{pointerEvents:j?void 0:"none"},children:[j&&r.jsx(x_,{ref:u,onFocusFromOutsideViewport:()=>{const _=v({tabbingDirection:"forwards"});Qx(_)}}),r.jsx(Ib.Slot,{scope:n,children:r.jsx(Xe.ol,{tabIndex:-1,...i,ref:p})}),j&&r.jsx(x_,{ref:m,onFocusFromOutsideViewport:()=>{const _=v({tabbingDirection:"backwards"});Qx(_)}})]})});SA.displayName=NA;var kA="ToastFocusProxy",x_=g.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:s,...a}=t,i=G0(kA,n);return r.jsx(df,{"aria-hidden":!0,tabIndex:0,...a,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const c=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(c))&&s()}})});x_.displayName=kA;var Q0="Toast",hF="toast.swipeStart",fF="toast.swipeMove",mF="toast.swipeCancel",pF="toast.swipeEnd",CA=g.forwardRef((t,e)=>{const{forceMount:n,open:s,defaultOpen:a,onOpenChange:i,...o}=t,[c=!0,d]=zs({prop:s,defaultProp:a,onChange:i});return r.jsx(Jn,{present:n||c,children:r.jsx(vF,{open:c,...o,ref:e,onClose:()=>d(!1),onPause:jn(t.onPause),onResume:jn(t.onResume),onSwipeStart:Te(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Te(t.onSwipeMove,u=>{const{x:m,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${m}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:Te(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Te(t.onSwipeEnd,u=>{const{x:m,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${m}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),d(!1)})})})});CA.displayName=Q0;var[gF,xF]=bA(Q0,{onClose(){}}),vF=g.forwardRef((t,e)=>{const{__scopeToast:n,type:s="foreground",duration:a,open:i,onClose:o,onEscapeKeyDown:c,onPause:d,onResume:u,onSwipeStart:m,onSwipeMove:f,onSwipeCancel:p,onSwipeEnd:y,...j}=t,v=G0(Q0,n),[_,b]=g.useState(null),w=Mt(e,ee=>b(ee)),N=g.useRef(null),S=g.useRef(null),A=a||v.duration,E=g.useRef(0),D=g.useRef(A),M=g.useRef(0),{onToastAdd:B,onToastRemove:R}=v,P=jn(()=>{var ue;(_==null?void 0:_.contains(document.activeElement))&&((ue=v.viewport)==null||ue.focus()),o()}),F=g.useCallback(ee=>{!ee||ee===1/0||(window.clearTimeout(M.current),E.current=new Date().getTime(),M.current=window.setTimeout(P,ee))},[P]);g.useEffect(()=>{const ee=v.viewport;if(ee){const ue=()=>{F(D.current),u==null||u()},de=()=>{const Q=new Date().getTime()-E.current;D.current=D.current-Q,window.clearTimeout(M.current),d==null||d()};return ee.addEventListener(p_,de),ee.addEventListener(g_,ue),()=>{ee.removeEventListener(p_,de),ee.removeEventListener(g_,ue)}}},[v.viewport,A,d,u,F]),g.useEffect(()=>{i&&!v.isClosePausedRef.current&&F(A)},[i,A,v.isClosePausedRef,F]),g.useEffect(()=>(B(),()=>R()),[B,R]);const W=g.useMemo(()=>_?RA(_):null,[_]);return v.viewport?r.jsxs(r.Fragment,{children:[W&&r.jsx(yF,{__scopeToast:n,role:"status","aria-live":s==="foreground"?"assertive":"polite","aria-atomic":!0,children:W}),r.jsx(gF,{scope:n,onClose:P,children:$o.createPortal(r.jsx(Ib.ItemSlot,{scope:n,children:r.jsx(JL,{asChild:!0,onEscapeKeyDown:Te(c,()=>{v.isFocusedToastEscapeKeyDownRef.current||P(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:r.jsx(Xe.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":v.swipeDirection,...j,ref:w,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Te(t.onKeyDown,ee=>{ee.key==="Escape"&&(c==null||c(ee.nativeEvent),ee.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,P()))}),onPointerDown:Te(t.onPointerDown,ee=>{ee.button===0&&(N.current={x:ee.clientX,y:ee.clientY})}),onPointerMove:Te(t.onPointerMove,ee=>{if(!N.current)return;const ue=ee.clientX-N.current.x,de=ee.clientY-N.current.y,Q=!!S.current,z=["left","right"].includes(v.swipeDirection),V=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,U=z?V(0,ue):0,O=z?0:V(0,de),I=ee.pointerType==="touch"?10:2,H={x:U,y:O},$={originalEvent:ee,delta:H};Q?(S.current=H,vm(fF,f,$,{discrete:!1})):H2(H,v.swipeDirection,I)?(S.current=H,vm(hF,m,$,{discrete:!1}),ee.target.setPointerCapture(ee.pointerId)):(Math.abs(ue)>I||Math.abs(de)>I)&&(N.current=null)}),onPointerUp:Te(t.onPointerUp,ee=>{const ue=S.current,de=ee.target;if(de.hasPointerCapture(ee.pointerId)&&de.releasePointerCapture(ee.pointerId),S.current=null,N.current=null,ue){const Q=ee.currentTarget,z={originalEvent:ee,delta:ue};H2(ue,v.swipeDirection,v.swipeThreshold)?vm(pF,y,z,{discrete:!0}):vm(mF,p,z,{discrete:!0}),Q.addEventListener("click",V=>V.preventDefault(),{once:!0})}})})})}),v.viewport)})]}):null}),yF=t=>{const{__scopeToast:e,children:n,...s}=t,a=G0(Q0,e),[i,o]=g.useState(!1),[c,d]=g.useState(!1);return bF(()=>o(!0)),g.useEffect(()=>{const u=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(u)},[]),c?null:r.jsx(Td,{asChild:!0,children:r.jsx(df,{...s,children:i&&r.jsxs(r.Fragment,{children:[a.label," ",n]})})})},_F="ToastTitle",EA=g.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t;return r.jsx(Xe.div,{...s,ref:e})});EA.displayName=_F;var wF="ToastDescription",AA=g.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t;return r.jsx(Xe.div,{...s,ref:e})});AA.displayName=wF;var PA="ToastAction",DA=g.forwardRef((t,e)=>{const{altText:n,...s}=t;return n.trim()?r.jsx(MA,{altText:n,asChild:!0,children:r.jsx(Ob,{...s,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${PA}\`. Expected non-empty \`string\`.`),null)});DA.displayName=PA;var TA="ToastClose",Ob=g.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t,a=xF(TA,n);return r.jsx(MA,{asChild:!0,children:r.jsx(Xe.button,{type:"button",...s,ref:e,onClick:Te(t.onClick,a.onClose)})})});Ob.displayName=TA;var MA=g.forwardRef((t,e)=>{const{__scopeToast:n,altText:s,...a}=t;return r.jsx(Xe.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...a,ref:e})});function RA(t){const e=[];return Array.from(t.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&e.push(s.textContent),jF(s)){const a=s.ariaHidden||s.hidden||s.style.display==="none",i=s.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const o=s.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...RA(s))}}),e}function vm(t,e,n,{discrete:s}){const a=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&a.addEventListener(t,e,{once:!0}),s?Mb(a,i):a.dispatchEvent(i)}var H2=(t,e,n=0)=>{const s=Math.abs(t.x),a=Math.abs(t.y),i=s>a;return e==="left"||e==="right"?i&&s>n:!i&&a>n};function bF(t=()=>{}){const e=jn(t);Un(()=>{let n=0,s=0;return n=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(s)}},[e])}function jF(t){return t.nodeType===t.ELEMENT_NODE}function NF(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Qx(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var SF=jA,IA=SA,OA=CA,LA=EA,FA=AA,BA=DA,zA=Ob;function $A(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(n=$A(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function UA(){for(var t,e,n=0,s="",a=arguments.length;n<a;n++)(t=arguments[n])&&(e=$A(t))&&(s&&(s+=" "),s+=e);return s}const V2=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,K2=UA,uf=(t,e)=>n=>{var s;if((e==null?void 0:e.variants)==null)return K2(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:i}=e,o=Object.keys(a).map(u=>{const m=n==null?void 0:n[u],f=i==null?void 0:i[u];if(m===null)return null;const p=V2(m)||V2(f);return a[u][p]}),c=n&&Object.entries(n).reduce((u,m)=>{let[f,p]=m;return p===void 0||(u[f]=p),u},{}),d=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((u,m)=>{let{class:f,className:p,...y}=m;return Object.entries(y).every(j=>{let[v,_]=j;return Array.isArray(_)?_.includes({...i,...c}[v]):{...i,...c}[v]===_})?[...u,f,p]:u},[]);return K2(t,o,d,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kF=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qA=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var CF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EF=g.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:a="",children:i,iconNode:o,...c},d)=>g.createElement("svg",{ref:d,...CF,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:qA("lucide",a),...c},[...o.map(([u,m])=>g.createElement(u,m)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=(t,e)=>{const n=g.forwardRef(({className:s,...a},i)=>g.createElement(EF,{ref:i,iconNode:e,className:qA(`lucide-${kF(t)}`,s),...a}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AF=Re("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PF=Re("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=Re("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DF=Re("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TF=Re("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MF=Re("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ym=Re("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vc=Re("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=Re("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=Re("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=Re("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ap=Re("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WA=Re("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=Re("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hf=Re("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=Re("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=Re("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=Re("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RF=Re("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=Re("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=Re("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IF=Re("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OF=Re("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=Re("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LF=Re("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FF=Re("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=Re("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BF=Re("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zF=Re("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=Re("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v_=Re("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $F=Re("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=Re("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HA=Re("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=Re("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z2=Re("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _m=Re("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=Re("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UF=Re("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=Re("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qF=Re("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WF=Re("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q2=Re("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y2=Re("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HF=Re("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VF=Re("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sr=Re("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=Re("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=Re("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=Re("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y_=Re("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=Re("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ni=Re("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GF=Re("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kp=Re("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=Re("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=Re("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=Re("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=Re("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=Re("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=Re("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VA=Re("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=Re("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zp=Re("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ju=Re("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=Re("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=Re("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=Re("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=Re("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=Re("Signal",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=Re("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=Re("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __=Re("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=Re("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w_=Re("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=Re("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=Re("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ao=Re("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=Re("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KA=Re("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mf=Re("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=Re("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=Re("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=Re("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b_=Re("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZA=Re("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gp=Re("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=Re("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=Re("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),$b="-",rB=t=>{const e=aB(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:o=>{const c=o.split($b);return c[0]===""&&c.length!==1&&c.shift(),GA(c,e)||sB(o)},getConflictingClassGroupIds:(o,c)=>{const d=n[o]||[];return c&&s[o]?[...d,...s[o]]:d}}},GA=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],s=e.nextPart.get(n),a=s?GA(t.slice(1),s):void 0;if(a)return a;if(e.validators.length===0)return;const i=t.join($b);return(o=e.validators.find(({validator:c})=>c(i)))==null?void 0:o.classGroupId},J2=/^\[(.+)\]$/,sB=t=>{if(J2.test(t)){const e=J2.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},aB=t=>{const{theme:e,prefix:n}=t,s={nextPart:new Map,validators:[]};return oB(Object.entries(t.classGroups),n).forEach(([i,o])=>{j_(o,s,i,e)}),s},j_=(t,e,n,s)=>{t.forEach(a=>{if(typeof a=="string"){const i=a===""?e:eS(e,a);i.classGroupId=n;return}if(typeof a=="function"){if(iB(a)){j_(a(s),e,n,s);return}e.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([i,o])=>{j_(o,eS(e,i),n,s)})})},eS=(t,e)=>{let n=t;return e.split($b).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},iB=t=>t.isThemeGetter,oB=(t,e)=>e?t.map(([n,s])=>{const a=s.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,c])=>[e+o,c])):i);return[n,a]}):t,lB=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,s=new Map;const a=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,s=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return a(i,o),o},set(i,o){n.has(i)?n.set(i,o):a(i,o)}}},QA="!",cB=t=>{const{separator:e,experimentalParseClassName:n}=t,s=e.length===1,a=e[0],i=e.length,o=c=>{const d=[];let u=0,m=0,f;for(let _=0;_<c.length;_++){let b=c[_];if(u===0){if(b===a&&(s||c.slice(_,_+i)===e)){d.push(c.slice(m,_)),m=_+i;continue}if(b==="/"){f=_;continue}}b==="["?u++:b==="]"&&u--}const p=d.length===0?c:c.substring(m),y=p.startsWith(QA),j=y?p.substring(1):p,v=f&&f>m?f-m:void 0;return{modifiers:d,hasImportantModifier:y,baseClassName:j,maybePostfixModifierPosition:v}};return n?c=>n({className:c,parseClassName:o}):o},dB=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(s=>{s[0]==="["?(e.push(...n.sort(),s),n=[]):n.push(s)}),e.push(...n.sort()),e},uB=t=>({cache:lB(t.cacheSize),parseClassName:cB(t),...rB(t)}),hB=/\s+/,fB=(t,e)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:a}=e,i=[],o=t.trim().split(hB);let c="";for(let d=o.length-1;d>=0;d-=1){const u=o[d],{modifiers:m,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:y}=n(u);let j=!!y,v=s(j?p.substring(0,y):p);if(!v){if(!j){c=u+(c.length>0?" "+c:c);continue}if(v=s(p),!v){c=u+(c.length>0?" "+c:c);continue}j=!1}const _=dB(m).join(":"),b=f?_+QA:_,w=b+v;if(i.includes(w))continue;i.push(w);const N=a(v,j);for(let S=0;S<N.length;++S){const A=N[S];i.push(b+A)}c=u+(c.length>0?" "+c:c)}return c};function mB(){let t=0,e,n,s="";for(;t<arguments.length;)(e=arguments[t++])&&(n=YA(e))&&(s&&(s+=" "),s+=n);return s}const YA=t=>{if(typeof t=="string")return t;let e,n="";for(let s=0;s<t.length;s++)t[s]&&(e=YA(t[s]))&&(n&&(n+=" "),n+=e);return n};function pB(t,...e){let n,s,a,i=o;function o(d){const u=e.reduce((m,f)=>f(m),t());return n=uB(u),s=n.cache.get,a=n.cache.set,i=c,c(d)}function c(d){const u=s(d);if(u)return u;const m=fB(d,n);return a(d,m),m}return function(){return i(mB.apply(null,arguments))}}const yn=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},XA=/^\[(?:([a-z-]+):)?(.+)\]$/i,gB=/^\d+\/\d+$/,xB=new Set(["px","full","screen"]),vB=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,yB=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,_B=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,wB=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,bB=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,si=t=>Vc(t)||xB.has(t)||gB.test(t),Oi=t=>Id(t,"length",PB),Vc=t=>!!t&&!Number.isNaN(Number(t)),Yx=t=>Id(t,"number",Vc),gu=t=>!!t&&Number.isInteger(Number(t)),jB=t=>t.endsWith("%")&&Vc(t.slice(0,-1)),It=t=>XA.test(t),Li=t=>vB.test(t),NB=new Set(["length","size","percentage"]),SB=t=>Id(t,NB,JA),kB=t=>Id(t,"position",JA),CB=new Set(["image","url"]),EB=t=>Id(t,CB,TB),AB=t=>Id(t,"",DB),xu=()=>!0,Id=(t,e,n)=>{const s=XA.exec(t);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):n(s[2]):!1},PB=t=>yB.test(t)&&!_B.test(t),JA=()=>!1,DB=t=>wB.test(t),TB=t=>bB.test(t),MB=()=>{const t=yn("colors"),e=yn("spacing"),n=yn("blur"),s=yn("brightness"),a=yn("borderColor"),i=yn("borderRadius"),o=yn("borderSpacing"),c=yn("borderWidth"),d=yn("contrast"),u=yn("grayscale"),m=yn("hueRotate"),f=yn("invert"),p=yn("gap"),y=yn("gradientColorStops"),j=yn("gradientColorStopPositions"),v=yn("inset"),_=yn("margin"),b=yn("opacity"),w=yn("padding"),N=yn("saturate"),S=yn("scale"),A=yn("sepia"),E=yn("skew"),D=yn("space"),M=yn("translate"),B=()=>["auto","contain","none"],R=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto",It,e],F=()=>[It,e],W=()=>["",si,Oi],ee=()=>["auto",Vc,It],ue=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],de=()=>["solid","dashed","dotted","double","none"],Q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],z=()=>["start","end","center","between","around","evenly","stretch"],V=()=>["","0",It],U=()=>["auto","avoid","all","avoid-page","page","left","right","column"],O=()=>[Vc,It];return{cacheSize:500,separator:":",theme:{colors:[xu],spacing:[si,Oi],blur:["none","",Li,It],brightness:O(),borderColor:[t],borderRadius:["none","","full",Li,It],borderSpacing:F(),borderWidth:W(),contrast:O(),grayscale:V(),hueRotate:O(),invert:V(),gap:F(),gradientColorStops:[t],gradientColorStopPositions:[jB,Oi],inset:P(),margin:P(),opacity:O(),padding:F(),saturate:O(),scale:O(),sepia:V(),skew:O(),space:F(),translate:F()},classGroups:{aspect:[{aspect:["auto","square","video",It]}],container:["container"],columns:[{columns:[Li]}],"break-after":[{"break-after":U()}],"break-before":[{"break-before":U()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ue(),It]}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:B()}],"overscroll-x":[{"overscroll-x":B()}],"overscroll-y":[{"overscroll-y":B()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",gu,It]}],basis:[{basis:P()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",It]}],grow:[{grow:V()}],shrink:[{shrink:V()}],order:[{order:["first","last","none",gu,It]}],"grid-cols":[{"grid-cols":[xu]}],"col-start-end":[{col:["auto",{span:["full",gu,It]},It]}],"col-start":[{"col-start":ee()}],"col-end":[{"col-end":ee()}],"grid-rows":[{"grid-rows":[xu]}],"row-start-end":[{row:["auto",{span:[gu,It]},It]}],"row-start":[{"row-start":ee()}],"row-end":[{"row-end":ee()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",It]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",It]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...z()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...z(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...z(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[_]}],mx:[{mx:[_]}],my:[{my:[_]}],ms:[{ms:[_]}],me:[{me:[_]}],mt:[{mt:[_]}],mr:[{mr:[_]}],mb:[{mb:[_]}],ml:[{ml:[_]}],"space-x":[{"space-x":[D]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[D]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",It,e]}],"min-w":[{"min-w":[It,e,"min","max","fit"]}],"max-w":[{"max-w":[It,e,"none","full","min","max","fit","prose",{screen:[Li]},Li]}],h:[{h:[It,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[It,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[It,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[It,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Li,Oi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Yx]}],"font-family":[{font:[xu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",It]}],"line-clamp":[{"line-clamp":["none",Vc,Yx]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",si,It]}],"list-image":[{"list-image":["none",It]}],"list-style-type":[{list:["none","disc","decimal",It]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",si,Oi]}],"underline-offset":[{"underline-offset":["auto",si,It]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:F()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",It]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",It]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ue(),kB]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",SB]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},EB]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[j]}],"gradient-via-pos":[{via:[j]}],"gradient-to-pos":[{to:[j]}],"gradient-from":[{from:[y]}],"gradient-via":[{via:[y]}],"gradient-to":[{to:[y]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...de(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:de()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...de()]}],"outline-offset":[{"outline-offset":[si,It]}],"outline-w":[{outline:[si,Oi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:W()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[si,Oi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Li,AB]}],"shadow-color":[{shadow:[xu]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...Q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Q()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",Li,It]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[m]}],invert:[{invert:[f]}],saturate:[{saturate:[N]}],sepia:[{sepia:[A]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[m]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[A]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",It]}],duration:[{duration:O()}],ease:[{ease:["linear","in","out","in-out",It]}],delay:[{delay:O()}],animate:[{animate:["none","spin","ping","pulse","bounce",It]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[gu,It]}],"translate-x":[{"translate-x":[M]}],"translate-y":[{"translate-y":[M]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",It]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",It]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":F()}],"scroll-mx":[{"scroll-mx":F()}],"scroll-my":[{"scroll-my":F()}],"scroll-ms":[{"scroll-ms":F()}],"scroll-me":[{"scroll-me":F()}],"scroll-mt":[{"scroll-mt":F()}],"scroll-mr":[{"scroll-mr":F()}],"scroll-mb":[{"scroll-mb":F()}],"scroll-ml":[{"scroll-ml":F()}],"scroll-p":[{"scroll-p":F()}],"scroll-px":[{"scroll-px":F()}],"scroll-py":[{"scroll-py":F()}],"scroll-ps":[{"scroll-ps":F()}],"scroll-pe":[{"scroll-pe":F()}],"scroll-pt":[{"scroll-pt":F()}],"scroll-pr":[{"scroll-pr":F()}],"scroll-pb":[{"scroll-pb":F()}],"scroll-pl":[{"scroll-pl":F()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",It]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[si,Oi,Yx]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},RB=pB(MB);function Oe(...t){return RB(UA(t))}const IB=SF,eP=g.forwardRef(({className:t,...e},n)=>r.jsx(IA,{ref:n,className:Oe("fixed top-20 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));eP.displayName=IA.displayName;const OB=uf("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),tP=g.forwardRef(({className:t,variant:e,...n},s)=>r.jsx(OA,{ref:s,className:Oe(OB({variant:e}),t),...n}));tP.displayName=OA.displayName;const LB=g.forwardRef(({className:t,...e},n)=>r.jsx(BA,{ref:n,className:Oe("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));LB.displayName=BA.displayName;const nP=g.forwardRef(({className:t,...e},n)=>r.jsx(zA,{ref:n,className:Oe("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:r.jsx(ar,{className:"h-4 w-4"})}));nP.displayName=zA.displayName;const rP=g.forwardRef(({className:t,...e},n)=>r.jsx(LA,{ref:n,className:Oe("text-sm font-semibold",t),...e}));rP.displayName=LA.displayName;const sP=g.forwardRef(({className:t,...e},n)=>r.jsx(FA,{ref:n,className:Oe("text-sm opacity-90",t),...e}));sP.displayName=FA.displayName;function FB(){const{toasts:t}=Rt();return r.jsxs(IB,{children:[t.map(function({id:e,title:n,description:s,action:a,...i}){return r.jsxs(tP,{...i,children:[r.jsxs("div",{className:"grid gap-1",children:[n&&r.jsx(rP,{children:n}),s&&r.jsx(sP,{children:s})]}),a,r.jsx(nP,{})]},e)}),r.jsx(eP,{})]})}const aP=g.createContext(void 0);function BB({children:t}){const[e,n]=g.useState(()=>localStorage.getItem("handwerkos-theme")||"light"),[s,a]=g.useState("light");return g.useEffect(()=>{const i=window.document.documentElement;if(i.classList.remove("light","dark"),e==="system"){const o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i.classList.add(o),a(o)}else i.classList.add(e),a(e);localStorage.setItem("handwerkos-theme",e)},[e]),g.useEffect(()=>{if(e==="system"){const i=window.matchMedia("(prefers-color-scheme: dark)"),o=c=>{const d=c.matches?"dark":"light";document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(d),a(d)};return i.addEventListener("change",o),()=>i.removeEventListener("change",o)}},[e]),r.jsx(aP.Provider,{value:{theme:e,setTheme:n,actualTheme:s},children:t})}function Ub(){const t=g.useContext(aP);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t}var zB=t=>{switch(t){case"success":return qB;case"info":return HB;case"warning":return WB;case"error":return VB;default:return null}},$B=Array(12).fill(0),UB=({visible:t})=>ke.createElement("div",{className:"sonner-loading-wrapper","data-visible":t},ke.createElement("div",{className:"sonner-spinner"},$B.map((e,n)=>ke.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),qB=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),WB=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),HB=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),VB=ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ke.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),KB=()=>{let[t,e]=ke.useState(document.hidden);return ke.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},N_=1,ZB=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:n,...s}=t,a=typeof(t==null?void 0:t.id)=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:N_++,i=this.toasts.find(c=>c.id===a),o=t.dismissible===void 0?!0:t.dismissible;return i?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...t,id:a,title:n}),{...c,...t,id:a,dismissible:o,title:n}):c):this.addToast({title:n,...s,dismissible:o,id:a}),a},this.dismiss=t=>(t||this.toasts.forEach(e=>{this.subscribers.forEach(n=>n({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let n;e.loading!==void 0&&(n=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let s=t instanceof Promise?t:t(),a=n!==void 0;return s.then(async i=>{if(QB(i)&&!i.ok){a=!1;let o=typeof e.error=="function"?await e.error(`HTTP error! status: ${i.status}`):e.error,c=typeof e.description=="function"?await e.description(`HTTP error! status: ${i.status}`):e.description;this.create({id:n,type:"error",message:o,description:c})}else if(e.success!==void 0){a=!1;let o=typeof e.success=="function"?await e.success(i):e.success,c=typeof e.description=="function"?await e.description(i):e.description;this.create({id:n,type:"success",message:o,description:c})}}).catch(async i=>{if(e.error!==void 0){a=!1;let o=typeof e.error=="function"?await e.error(i):e.error,c=typeof e.description=="function"?await e.description(i):e.description;this.create({id:n,type:"error",message:o,description:c})}}).finally(()=>{var i;a&&(this.dismiss(n),n=void 0),(i=e.finally)==null||i.call(e)}),n},this.custom=(t,e)=>{let n=(e==null?void 0:e.id)||N_++;return this.create({jsx:t(n),id:n,...e}),n},this.subscribers=[],this.toasts=[]}},ls=new ZB,GB=(t,e)=>{let n=(e==null?void 0:e.id)||N_++;return ls.addToast({title:t,...e,id:n}),n},QB=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",YB=GB,XB=()=>ls.toasts,Et=Object.assign(YB,{success:ls.success,info:ls.info,warning:ls.warning,error:ls.error,custom:ls.custom,message:ls.message,promise:ls.promise,dismiss:ls.dismiss,loading:ls.loading},{getHistory:XB});function JB(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",e==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}JB(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function wm(t){return t.label!==void 0}var ez=3,tz="32px",nz=4e3,rz=356,sz=14,az=20,iz=200;function oz(...t){return t.filter(Boolean).join(" ")}var lz=t=>{var e,n,s,a,i,o,c,d,u,m;let{invert:f,toast:p,unstyled:y,interacting:j,setHeights:v,visibleToasts:_,heights:b,index:w,toasts:N,expanded:S,removeToast:A,defaultRichColors:E,closeButton:D,style:M,cancelButtonStyle:B,actionButtonStyle:R,className:P="",descriptionClassName:F="",duration:W,position:ee,gap:ue,loadingIcon:de,expandByDefault:Q,classNames:z,icons:V,closeButtonAriaLabel:U="Close toast",pauseWhenPageIsHidden:O,cn:I}=t,[H,$]=ke.useState(!1),[te,X]=ke.useState(!1),[Z,ie]=ke.useState(!1),[pe,G]=ke.useState(!1),[se,me]=ke.useState(0),[he,xe]=ke.useState(0),re=ke.useRef(null),_e=ke.useRef(null),be=w===0,Be=w+1<=_,Ke=p.type,At=p.dismissible!==!1,je=p.className||"",De=p.descriptionClassName||"",Ie=ke.useMemo(()=>b.findIndex(it=>it.toastId===p.id)||0,[b,p.id]),at=ke.useMemo(()=>{var it;return(it=p.closeButton)!=null?it:D},[p.closeButton,D]),$e=ke.useMemo(()=>p.duration||W||nz,[p.duration,W]),Me=ke.useRef(0),Nt=ke.useRef(0),ft=ke.useRef(0),Ln=ke.useRef(null),[yr,xt]=ee.split("-"),mn=ke.useMemo(()=>b.reduce((it,Kt,Bt)=>Bt>=Ie?it:it+Kt.height,0),[b,Ie]),Mn=KB(),cr=p.invert||f,Wn=Ke==="loading";Nt.current=ke.useMemo(()=>Ie*ue+mn,[Ie,mn]),ke.useEffect(()=>{$(!0)},[]),ke.useLayoutEffect(()=>{if(!H)return;let it=_e.current,Kt=it.style.height;it.style.height="auto";let Bt=it.getBoundingClientRect().height;it.style.height=Kt,xe(Bt),v(dt=>dt.find(Yt=>Yt.toastId===p.id)?dt.map(Yt=>Yt.toastId===p.id?{...Yt,height:Bt}:Yt):[{toastId:p.id,height:Bt,position:p.position},...dt])},[H,p.title,p.description,v,p.id]);let Nn=ke.useCallback(()=>{X(!0),me(Nt.current),v(it=>it.filter(Kt=>Kt.toastId!==p.id)),setTimeout(()=>{A(p)},iz)},[p,A,v,Nt]);ke.useEffect(()=>{if(p.promise&&Ke==="loading"||p.duration===1/0||p.type==="loading")return;let it,Kt=$e;return S||j||O&&Mn?(()=>{if(ft.current<Me.current){let Bt=new Date().getTime()-Me.current;Kt=Kt-Bt}ft.current=new Date().getTime()})():Kt!==1/0&&(Me.current=new Date().getTime(),it=setTimeout(()=>{var Bt;(Bt=p.onAutoClose)==null||Bt.call(p,p),Nn()},Kt)),()=>clearTimeout(it)},[S,j,Q,p,$e,Nn,p.promise,Ke,O,Mn]),ke.useEffect(()=>{let it=_e.current;if(it){let Kt=it.getBoundingClientRect().height;return xe(Kt),v(Bt=>[{toastId:p.id,height:Kt,position:p.position},...Bt]),()=>v(Bt=>Bt.filter(dt=>dt.toastId!==p.id))}},[v,p.id]),ke.useEffect(()=>{p.delete&&Nn()},[Nn,p.delete]);function Hr(){return V!=null&&V.loading?ke.createElement("div",{className:"sonner-loader","data-visible":Ke==="loading"},V.loading):de?ke.createElement("div",{className:"sonner-loader","data-visible":Ke==="loading"},de):ke.createElement(UB,{visible:Ke==="loading"})}return ke.createElement("li",{"aria-live":p.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:_e,className:I(P,je,z==null?void 0:z.toast,(e=p==null?void 0:p.classNames)==null?void 0:e.toast,z==null?void 0:z.default,z==null?void 0:z[Ke],(n=p==null?void 0:p.classNames)==null?void 0:n[Ke]),"data-sonner-toast":"","data-rich-colors":(s=p.richColors)!=null?s:E,"data-styled":!(p.jsx||p.unstyled||y),"data-mounted":H,"data-promise":!!p.promise,"data-removed":te,"data-visible":Be,"data-y-position":yr,"data-x-position":xt,"data-index":w,"data-front":be,"data-swiping":Z,"data-dismissible":At,"data-type":Ke,"data-invert":cr,"data-swipe-out":pe,"data-expanded":!!(S||Q&&H),style:{"--index":w,"--toasts-before":w,"--z-index":N.length-w,"--offset":`${te?se:Nt.current}px`,"--initial-height":Q?"auto":`${he}px`,...M,...p.style},onPointerDown:it=>{Wn||!At||(re.current=new Date,me(Nt.current),it.target.setPointerCapture(it.pointerId),it.target.tagName!=="BUTTON"&&(ie(!0),Ln.current={x:it.clientX,y:it.clientY}))},onPointerUp:()=>{var it,Kt,Bt,dt;if(pe||!At)return;Ln.current=null;let Yt=Number(((it=_e.current)==null?void 0:it.style.getPropertyValue("--swipe-amount").replace("px",""))||0),we=new Date().getTime()-((Kt=re.current)==null?void 0:Kt.getTime()),Ne=Math.abs(Yt)/we;if(Math.abs(Yt)>=az||Ne>.11){me(Nt.current),(Bt=p.onDismiss)==null||Bt.call(p,p),Nn(),G(!0);return}(dt=_e.current)==null||dt.style.setProperty("--swipe-amount","0px"),ie(!1)},onPointerMove:it=>{var Kt;if(!Ln.current||!At)return;let Bt=it.clientY-Ln.current.y,dt=it.clientX-Ln.current.x,Yt=(yr==="top"?Math.min:Math.max)(0,Bt),we=it.pointerType==="touch"?10:2;Math.abs(Yt)>we?(Kt=_e.current)==null||Kt.style.setProperty("--swipe-amount",`${Bt}px`):Math.abs(dt)>we&&(Ln.current=null)}},at&&!p.jsx?ke.createElement("button",{"aria-label":U,"data-disabled":Wn,"data-close-button":!0,onClick:Wn||!At?()=>{}:()=>{var it;Nn(),(it=p.onDismiss)==null||it.call(p,p)},className:I(z==null?void 0:z.closeButton,(a=p==null?void 0:p.classNames)==null?void 0:a.closeButton)},ke.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ke.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ke.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,p.jsx||ke.isValidElement(p.title)?p.jsx||p.title:ke.createElement(ke.Fragment,null,Ke||p.icon||p.promise?ke.createElement("div",{"data-icon":"",className:I(z==null?void 0:z.icon,(i=p==null?void 0:p.classNames)==null?void 0:i.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||Hr():null,p.type!=="loading"?p.icon||(V==null?void 0:V[Ke])||zB(Ke):null):null,ke.createElement("div",{"data-content":"",className:I(z==null?void 0:z.content,(o=p==null?void 0:p.classNames)==null?void 0:o.content)},ke.createElement("div",{"data-title":"",className:I(z==null?void 0:z.title,(c=p==null?void 0:p.classNames)==null?void 0:c.title)},p.title),p.description?ke.createElement("div",{"data-description":"",className:I(F,De,z==null?void 0:z.description,(d=p==null?void 0:p.classNames)==null?void 0:d.description)},p.description):null),ke.isValidElement(p.cancel)?p.cancel:p.cancel&&wm(p.cancel)?ke.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||B,onClick:it=>{var Kt,Bt;wm(p.cancel)&&At&&((Bt=(Kt=p.cancel).onClick)==null||Bt.call(Kt,it),Nn())},className:I(z==null?void 0:z.cancelButton,(u=p==null?void 0:p.classNames)==null?void 0:u.cancelButton)},p.cancel.label):null,ke.isValidElement(p.action)?p.action:p.action&&wm(p.action)?ke.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||R,onClick:it=>{var Kt,Bt;wm(p.action)&&(it.defaultPrevented||((Bt=(Kt=p.action).onClick)==null||Bt.call(Kt,it),Nn()))},className:I(z==null?void 0:z.actionButton,(m=p==null?void 0:p.classNames)==null?void 0:m.actionButton)},p.action.label):null))};function tS(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}var cz=t=>{let{invert:e,position:n="bottom-right",hotkey:s=["altKey","KeyT"],expand:a,closeButton:i,className:o,offset:c,theme:d="light",richColors:u,duration:m,style:f,visibleToasts:p=ez,toastOptions:y,dir:j=tS(),gap:v=sz,loadingIcon:_,icons:b,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:N,cn:S=oz}=t,[A,E]=ke.useState([]),D=ke.useMemo(()=>Array.from(new Set([n].concat(A.filter(O=>O.position).map(O=>O.position)))),[A,n]),[M,B]=ke.useState([]),[R,P]=ke.useState(!1),[F,W]=ke.useState(!1),[ee,ue]=ke.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),de=ke.useRef(null),Q=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),z=ke.useRef(null),V=ke.useRef(!1),U=ke.useCallback(O=>{var I;(I=A.find(H=>H.id===O.id))!=null&&I.delete||ls.dismiss(O.id),E(H=>H.filter(({id:$})=>$!==O.id))},[A]);return ke.useEffect(()=>ls.subscribe(O=>{if(O.dismiss){E(I=>I.map(H=>H.id===O.id?{...H,delete:!0}:H));return}setTimeout(()=>{gA.flushSync(()=>{E(I=>{let H=I.findIndex($=>$.id===O.id);return H!==-1?[...I.slice(0,H),{...I[H],...O},...I.slice(H+1)]:[O,...I]})})})}),[]),ke.useEffect(()=>{if(d!=="system"){ue(d);return}d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ue("dark"):ue("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:O})=>{ue(O?"dark":"light")})},[d]),ke.useEffect(()=>{A.length<=1&&P(!1)},[A]),ke.useEffect(()=>{let O=I=>{var H,$;s.every(te=>I[te]||I.code===te)&&(P(!0),(H=de.current)==null||H.focus()),I.code==="Escape"&&(document.activeElement===de.current||($=de.current)!=null&&$.contains(document.activeElement))&&P(!1)};return document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)},[s]),ke.useEffect(()=>{if(de.current)return()=>{z.current&&(z.current.focus({preventScroll:!0}),z.current=null,V.current=!1)}},[de.current]),A.length?ke.createElement("section",{"aria-label":`${w} ${Q}`,tabIndex:-1},D.map((O,I)=>{var H;let[$,te]=O.split("-");return ke.createElement("ol",{key:O,dir:j==="auto"?tS():j,tabIndex:-1,ref:de,className:o,"data-sonner-toaster":!0,"data-theme":ee,"data-y-position":$,"data-x-position":te,style:{"--front-toast-height":`${((H=M[0])==null?void 0:H.height)||0}px`,"--offset":typeof c=="number"?`${c}px`:c||tz,"--width":`${rz}px`,"--gap":`${v}px`,...f},onBlur:X=>{V.current&&!X.currentTarget.contains(X.relatedTarget)&&(V.current=!1,z.current&&(z.current.focus({preventScroll:!0}),z.current=null))},onFocus:X=>{X.target instanceof HTMLElement&&X.target.dataset.dismissible==="false"||V.current||(V.current=!0,z.current=X.relatedTarget)},onMouseEnter:()=>P(!0),onMouseMove:()=>P(!0),onMouseLeave:()=>{F||P(!1)},onPointerDown:X=>{X.target instanceof HTMLElement&&X.target.dataset.dismissible==="false"||W(!0)},onPointerUp:()=>W(!1)},A.filter(X=>!X.position&&I===0||X.position===O).map((X,Z)=>{var ie,pe;return ke.createElement(lz,{key:X.id,icons:b,index:Z,toast:X,defaultRichColors:u,duration:(ie=y==null?void 0:y.duration)!=null?ie:m,className:y==null?void 0:y.className,descriptionClassName:y==null?void 0:y.descriptionClassName,invert:e,visibleToasts:p,closeButton:(pe=y==null?void 0:y.closeButton)!=null?pe:i,interacting:F,position:O,style:y==null?void 0:y.style,unstyled:y==null?void 0:y.unstyled,classNames:y==null?void 0:y.classNames,cancelButtonStyle:y==null?void 0:y.cancelButtonStyle,actionButtonStyle:y==null?void 0:y.actionButtonStyle,removeToast:U,toasts:A.filter(G=>G.position==X.position),heights:M.filter(G=>G.position==X.position),setHeights:B,expandByDefault:a,gap:v,loadingIcon:_,expanded:R,pauseWhenPageIsHidden:N,cn:S})}))})):null};const dz=({...t})=>{const{actualTheme:e}=Ub();return r.jsx(cz,{theme:e,className:"toaster group",position:"top-center",offset:80,toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var uz=fE.useId||(()=>{}),hz=0;function ps(t){const[e,n]=g.useState(uz());return Un(()=>{t||n(s=>s??String(hz++))},[t]),t||(e?`radix-${e}`:"")}const fz=["top","right","bottom","left"],Po=Math.min,ds=Math.max,Qp=Math.round,bm=Math.floor,Do=t=>({x:t,y:t}),mz={left:"right",right:"left",bottom:"top",top:"bottom"},pz={start:"end",end:"start"};function S_(t,e,n){return ds(t,Po(e,n))}function ki(t,e){return typeof t=="function"?t(e):t}function Ci(t){return t.split("-")[0]}function Od(t){return t.split("-")[1]}function qb(t){return t==="x"?"y":"x"}function Wb(t){return t==="y"?"height":"width"}function To(t){return["top","bottom"].includes(Ci(t))?"y":"x"}function Hb(t){return qb(To(t))}function gz(t,e,n){n===void 0&&(n=!1);const s=Od(t),a=Hb(t),i=Wb(a);let o=a==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Yp(o)),[o,Yp(o)]}function xz(t){const e=Yp(t);return[k_(t),e,k_(e)]}function k_(t){return t.replace(/start|end/g,e=>pz[e])}function vz(t,e,n){const s=["left","right"],a=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?a:s:e?s:a;case"left":case"right":return e?i:o;default:return[]}}function yz(t,e,n,s){const a=Od(t);let i=vz(Ci(t),n==="start",s);return a&&(i=i.map(o=>o+"-"+a),e&&(i=i.concat(i.map(k_)))),i}function Yp(t){return t.replace(/left|right|bottom|top/g,e=>mz[e])}function _z(t){return{top:0,right:0,bottom:0,left:0,...t}}function iP(t){return typeof t!="number"?_z(t):{top:t,right:t,bottom:t,left:t}}function Xp(t){const{x:e,y:n,width:s,height:a}=t;return{width:s,height:a,top:n,left:e,right:e+s,bottom:n+a,x:e,y:n}}function nS(t,e,n){let{reference:s,floating:a}=t;const i=To(e),o=Hb(e),c=Wb(o),d=Ci(e),u=i==="y",m=s.x+s.width/2-a.width/2,f=s.y+s.height/2-a.height/2,p=s[c]/2-a[c]/2;let y;switch(d){case"top":y={x:m,y:s.y-a.height};break;case"bottom":y={x:m,y:s.y+s.height};break;case"right":y={x:s.x+s.width,y:f};break;case"left":y={x:s.x-a.width,y:f};break;default:y={x:s.x,y:s.y}}switch(Od(e)){case"start":y[o]-=p*(n&&u?-1:1);break;case"end":y[o]+=p*(n&&u?-1:1);break}return y}const wz=async(t,e,n)=>{const{placement:s="bottom",strategy:a="absolute",middleware:i=[],platform:o}=n,c=i.filter(Boolean),d=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:a}),{x:m,y:f}=nS(u,s,d),p=s,y={},j=0;for(let v=0;v<c.length;v++){const{name:_,fn:b}=c[v],{x:w,y:N,data:S,reset:A}=await b({x:m,y:f,initialPlacement:s,placement:p,strategy:a,middlewareData:y,rects:u,platform:o,elements:{reference:t,floating:e}});m=w??m,f=N??f,y={...y,[_]:{...y[_],...S}},A&&j<=50&&(j++,typeof A=="object"&&(A.placement&&(p=A.placement),A.rects&&(u=A.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:a}):A.rects),{x:m,y:f}=nS(u,p,d)),v=-1)}return{x:m,y:f,placement:p,strategy:a,middlewareData:y}};async function kh(t,e){var n;e===void 0&&(e={});const{x:s,y:a,platform:i,rects:o,elements:c,strategy:d}=t,{boundary:u="clippingAncestors",rootBoundary:m="viewport",elementContext:f="floating",altBoundary:p=!1,padding:y=0}=ki(e,t),j=iP(y),_=c[p?f==="floating"?"reference":"floating":f],b=Xp(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(_)))==null||n?_:_.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(c.floating)),boundary:u,rootBoundary:m,strategy:d})),w=f==="floating"?{x:s,y:a,width:o.floating.width,height:o.floating.height}:o.reference,N=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c.floating)),S=await(i.isElement==null?void 0:i.isElement(N))?await(i.getScale==null?void 0:i.getScale(N))||{x:1,y:1}:{x:1,y:1},A=Xp(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:w,offsetParent:N,strategy:d}):w);return{top:(b.top-A.top+j.top)/S.y,bottom:(A.bottom-b.bottom+j.bottom)/S.y,left:(b.left-A.left+j.left)/S.x,right:(A.right-b.right+j.right)/S.x}}const bz=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:s,placement:a,rects:i,platform:o,elements:c,middlewareData:d}=e,{element:u,padding:m=0}=ki(t,e)||{};if(u==null)return{};const f=iP(m),p={x:n,y:s},y=Hb(a),j=Wb(y),v=await o.getDimensions(u),_=y==="y",b=_?"top":"left",w=_?"bottom":"right",N=_?"clientHeight":"clientWidth",S=i.reference[j]+i.reference[y]-p[y]-i.floating[j],A=p[y]-i.reference[y],E=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let D=E?E[N]:0;(!D||!await(o.isElement==null?void 0:o.isElement(E)))&&(D=c.floating[N]||i.floating[j]);const M=S/2-A/2,B=D/2-v[j]/2-1,R=Po(f[b],B),P=Po(f[w],B),F=R,W=D-v[j]-P,ee=D/2-v[j]/2+M,ue=S_(F,ee,W),de=!d.arrow&&Od(a)!=null&&ee!==ue&&i.reference[j]/2-(ee<F?R:P)-v[j]/2<0,Q=de?ee<F?ee-F:ee-W:0;return{[y]:p[y]+Q,data:{[y]:ue,centerOffset:ee-ue-Q,...de&&{alignmentOffset:Q}},reset:de}}}),jz=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,s;const{placement:a,middlewareData:i,rects:o,initialPlacement:c,platform:d,elements:u}=e,{mainAxis:m=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:j="none",flipAlignment:v=!0,..._}=ki(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const b=Ci(a),w=To(c),N=Ci(c)===c,S=await(d.isRTL==null?void 0:d.isRTL(u.floating)),A=p||(N||!v?[Yp(c)]:xz(c)),E=j!=="none";!p&&E&&A.push(...yz(c,v,j,S));const D=[c,...A],M=await kh(e,_),B=[];let R=((s=i.flip)==null?void 0:s.overflows)||[];if(m&&B.push(M[b]),f){const ee=gz(a,o,S);B.push(M[ee[0]],M[ee[1]])}if(R=[...R,{placement:a,overflows:B}],!B.every(ee=>ee<=0)){var P,F;const ee=(((P=i.flip)==null?void 0:P.index)||0)+1,ue=D[ee];if(ue)return{data:{index:ee,overflows:R},reset:{placement:ue}};let de=(F=R.filter(Q=>Q.overflows[0]<=0).sort((Q,z)=>Q.overflows[1]-z.overflows[1])[0])==null?void 0:F.placement;if(!de)switch(y){case"bestFit":{var W;const Q=(W=R.filter(z=>{if(E){const V=To(z.placement);return V===w||V==="y"}return!0}).map(z=>[z.placement,z.overflows.filter(V=>V>0).reduce((V,U)=>V+U,0)]).sort((z,V)=>z[1]-V[1])[0])==null?void 0:W[0];Q&&(de=Q);break}case"initialPlacement":de=c;break}if(a!==de)return{reset:{placement:de}}}return{}}}};function rS(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function sS(t){return fz.some(e=>t[e]>=0)}const Nz=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:s="referenceHidden",...a}=ki(t,e);switch(s){case"referenceHidden":{const i=await kh(e,{...a,elementContext:"reference"}),o=rS(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:sS(o)}}}case"escaped":{const i=await kh(e,{...a,altBoundary:!0}),o=rS(i,n.floating);return{data:{escapedOffsets:o,escaped:sS(o)}}}default:return{}}}}};async function Sz(t,e){const{placement:n,platform:s,elements:a}=t,i=await(s.isRTL==null?void 0:s.isRTL(a.floating)),o=Ci(n),c=Od(n),d=To(n)==="y",u=["left","top"].includes(o)?-1:1,m=i&&d?-1:1,f=ki(e,t);let{mainAxis:p,crossAxis:y,alignmentAxis:j}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return c&&typeof j=="number"&&(y=c==="end"?j*-1:j),d?{x:y*m,y:p*u}:{x:p*u,y:y*m}}const kz=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,s;const{x:a,y:i,placement:o,middlewareData:c}=e,d=await Sz(e,t);return o===((n=c.offset)==null?void 0:n.placement)&&(s=c.arrow)!=null&&s.alignmentOffset?{}:{x:a+d.x,y:i+d.y,data:{...d,placement:o}}}}},Cz=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:s,placement:a}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:c={fn:_=>{let{x:b,y:w}=_;return{x:b,y:w}}},...d}=ki(t,e),u={x:n,y:s},m=await kh(e,d),f=To(Ci(a)),p=qb(f);let y=u[p],j=u[f];if(i){const _=p==="y"?"top":"left",b=p==="y"?"bottom":"right",w=y+m[_],N=y-m[b];y=S_(w,y,N)}if(o){const _=f==="y"?"top":"left",b=f==="y"?"bottom":"right",w=j+m[_],N=j-m[b];j=S_(w,j,N)}const v=c.fn({...e,[p]:y,[f]:j});return{...v,data:{x:v.x-n,y:v.y-s,enabled:{[p]:i,[f]:o}}}}}},Ez=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:s,placement:a,rects:i,middlewareData:o}=e,{offset:c=0,mainAxis:d=!0,crossAxis:u=!0}=ki(t,e),m={x:n,y:s},f=To(a),p=qb(f);let y=m[p],j=m[f];const v=ki(c,e),_=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(d){const N=p==="y"?"height":"width",S=i.reference[p]-i.floating[N]+_.mainAxis,A=i.reference[p]+i.reference[N]-_.mainAxis;y<S?y=S:y>A&&(y=A)}if(u){var b,w;const N=p==="y"?"width":"height",S=["top","left"].includes(Ci(a)),A=i.reference[f]-i.floating[N]+(S&&((b=o.offset)==null?void 0:b[f])||0)+(S?0:_.crossAxis),E=i.reference[f]+i.reference[N]+(S?0:((w=o.offset)==null?void 0:w[f])||0)-(S?_.crossAxis:0);j<A?j=A:j>E&&(j=E)}return{[p]:y,[f]:j}}}},Az=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,s;const{placement:a,rects:i,platform:o,elements:c}=e,{apply:d=()=>{},...u}=ki(t,e),m=await kh(e,u),f=Ci(a),p=Od(a),y=To(a)==="y",{width:j,height:v}=i.floating;let _,b;f==="top"||f==="bottom"?(_=f,b=p===(await(o.isRTL==null?void 0:o.isRTL(c.floating))?"start":"end")?"left":"right"):(b=f,_=p==="end"?"top":"bottom");const w=v-m.top-m.bottom,N=j-m.left-m.right,S=Po(v-m[_],w),A=Po(j-m[b],N),E=!e.middlewareData.shift;let D=S,M=A;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(M=N),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(D=w),E&&!p){const R=ds(m.left,0),P=ds(m.right,0),F=ds(m.top,0),W=ds(m.bottom,0);y?M=j-2*(R!==0||P!==0?R+P:ds(m.left,m.right)):D=v-2*(F!==0||W!==0?F+W:ds(m.top,m.bottom))}await d({...e,availableWidth:M,availableHeight:D});const B=await o.getDimensions(c.floating);return j!==B.width||v!==B.height?{reset:{rects:!0}}:{}}}};function J0(){return typeof window<"u"}function Ld(t){return oP(t)?(t.nodeName||"").toLowerCase():"#document"}function gs(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Qa(t){var e;return(e=(oP(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function oP(t){return J0()?t instanceof Node||t instanceof gs(t).Node:!1}function ma(t){return J0()?t instanceof Element||t instanceof gs(t).Element:!1}function Ka(t){return J0()?t instanceof HTMLElement||t instanceof gs(t).HTMLElement:!1}function aS(t){return!J0()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof gs(t).ShadowRoot}function pf(t){const{overflow:e,overflowX:n,overflowY:s,display:a}=pa(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+n)&&!["inline","contents"].includes(a)}function Pz(t){return["table","td","th"].includes(Ld(t))}function eg(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Vb(t){const e=Kb(),n=ma(t)?pa(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(s=>(n.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(n.contain||"").includes(s))}function Dz(t){let e=Mo(t);for(;Ka(e)&&!vd(e);){if(Vb(e))return e;if(eg(e))return null;e=Mo(e)}return null}function Kb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function vd(t){return["html","body","#document"].includes(Ld(t))}function pa(t){return gs(t).getComputedStyle(t)}function tg(t){return ma(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Mo(t){if(Ld(t)==="html")return t;const e=t.assignedSlot||t.parentNode||aS(t)&&t.host||Qa(t);return aS(e)?e.host:e}function lP(t){const e=Mo(t);return vd(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ka(e)&&pf(e)?e:lP(e)}function Ch(t,e,n){var s;e===void 0&&(e=[]),n===void 0&&(n=!0);const a=lP(t),i=a===((s=t.ownerDocument)==null?void 0:s.body),o=gs(a);if(i){const c=C_(o);return e.concat(o,o.visualViewport||[],pf(a)?a:[],c&&n?Ch(c):[])}return e.concat(a,Ch(a,[],n))}function C_(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function cP(t){const e=pa(t);let n=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const a=Ka(t),i=a?t.offsetWidth:n,o=a?t.offsetHeight:s,c=Qp(n)!==i||Qp(s)!==o;return c&&(n=i,s=o),{width:n,height:s,$:c}}function Zb(t){return ma(t)?t:t.contextElement}function Kc(t){const e=Zb(t);if(!Ka(e))return Do(1);const n=e.getBoundingClientRect(),{width:s,height:a,$:i}=cP(e);let o=(i?Qp(n.width):n.width)/s,c=(i?Qp(n.height):n.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!c||!Number.isFinite(c))&&(c=1),{x:o,y:c}}const Tz=Do(0);function dP(t){const e=gs(t);return!Kb()||!e.visualViewport?Tz:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Mz(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==gs(t)?!1:e}function Tl(t,e,n,s){e===void 0&&(e=!1),n===void 0&&(n=!1);const a=t.getBoundingClientRect(),i=Zb(t);let o=Do(1);e&&(s?ma(s)&&(o=Kc(s)):o=Kc(t));const c=Mz(i,n,s)?dP(i):Do(0);let d=(a.left+c.x)/o.x,u=(a.top+c.y)/o.y,m=a.width/o.x,f=a.height/o.y;if(i){const p=gs(i),y=s&&ma(s)?gs(s):s;let j=p,v=C_(j);for(;v&&s&&y!==j;){const _=Kc(v),b=v.getBoundingClientRect(),w=pa(v),N=b.left+(v.clientLeft+parseFloat(w.paddingLeft))*_.x,S=b.top+(v.clientTop+parseFloat(w.paddingTop))*_.y;d*=_.x,u*=_.y,m*=_.x,f*=_.y,d+=N,u+=S,j=gs(v),v=C_(j)}}return Xp({width:m,height:f,x:d,y:u})}function Rz(t){let{elements:e,rect:n,offsetParent:s,strategy:a}=t;const i=a==="fixed",o=Qa(s),c=e?eg(e.floating):!1;if(s===o||c&&i)return n;let d={scrollLeft:0,scrollTop:0},u=Do(1);const m=Do(0),f=Ka(s);if((f||!f&&!i)&&((Ld(s)!=="body"||pf(o))&&(d=tg(s)),Ka(s))){const p=Tl(s);u=Kc(s),m.x=p.x+s.clientLeft,m.y=p.y+s.clientTop}return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-d.scrollLeft*u.x+m.x,y:n.y*u.y-d.scrollTop*u.y+m.y}}function Iz(t){return Array.from(t.getClientRects())}function E_(t,e){const n=tg(t).scrollLeft;return e?e.left+n:Tl(Qa(t)).left+n}function Oz(t){const e=Qa(t),n=tg(t),s=t.ownerDocument.body,a=ds(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=ds(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-n.scrollLeft+E_(t);const c=-n.scrollTop;return pa(s).direction==="rtl"&&(o+=ds(e.clientWidth,s.clientWidth)-a),{width:a,height:i,x:o,y:c}}function Lz(t,e){const n=gs(t),s=Qa(t),a=n.visualViewport;let i=s.clientWidth,o=s.clientHeight,c=0,d=0;if(a){i=a.width,o=a.height;const u=Kb();(!u||u&&e==="fixed")&&(c=a.offsetLeft,d=a.offsetTop)}return{width:i,height:o,x:c,y:d}}function Fz(t,e){const n=Tl(t,!0,e==="fixed"),s=n.top+t.clientTop,a=n.left+t.clientLeft,i=Ka(t)?Kc(t):Do(1),o=t.clientWidth*i.x,c=t.clientHeight*i.y,d=a*i.x,u=s*i.y;return{width:o,height:c,x:d,y:u}}function iS(t,e,n){let s;if(e==="viewport")s=Lz(t,n);else if(e==="document")s=Oz(Qa(t));else if(ma(e))s=Fz(e,n);else{const a=dP(t);s={...e,x:e.x-a.x,y:e.y-a.y}}return Xp(s)}function uP(t,e){const n=Mo(t);return n===e||!ma(n)||vd(n)?!1:pa(n).position==="fixed"||uP(n,e)}function Bz(t,e){const n=e.get(t);if(n)return n;let s=Ch(t,[],!1).filter(c=>ma(c)&&Ld(c)!=="body"),a=null;const i=pa(t).position==="fixed";let o=i?Mo(t):t;for(;ma(o)&&!vd(o);){const c=pa(o),d=Vb(o);!d&&c.position==="fixed"&&(a=null),(i?!d&&!a:!d&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||pf(o)&&!d&&uP(t,o))?s=s.filter(m=>m!==o):a=c,o=Mo(o)}return e.set(t,s),s}function zz(t){let{element:e,boundary:n,rootBoundary:s,strategy:a}=t;const o=[...n==="clippingAncestors"?eg(e)?[]:Bz(e,this._c):[].concat(n),s],c=o[0],d=o.reduce((u,m)=>{const f=iS(e,m,a);return u.top=ds(f.top,u.top),u.right=Po(f.right,u.right),u.bottom=Po(f.bottom,u.bottom),u.left=ds(f.left,u.left),u},iS(e,c,a));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function $z(t){const{width:e,height:n}=cP(t);return{width:e,height:n}}function Uz(t,e,n){const s=Ka(e),a=Qa(e),i=n==="fixed",o=Tl(t,!0,i,e);let c={scrollLeft:0,scrollTop:0};const d=Do(0);if(s||!s&&!i)if((Ld(e)!=="body"||pf(a))&&(c=tg(e)),s){const y=Tl(e,!0,i,e);d.x=y.x+e.clientLeft,d.y=y.y+e.clientTop}else a&&(d.x=E_(a));let u=0,m=0;if(a&&!s&&!i){const y=a.getBoundingClientRect();m=y.top+c.scrollTop,u=y.left+c.scrollLeft-E_(a,y)}const f=o.left+c.scrollLeft-d.x-u,p=o.top+c.scrollTop-d.y-m;return{x:f,y:p,width:o.width,height:o.height}}function Xx(t){return pa(t).position==="static"}function oS(t,e){if(!Ka(t)||pa(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Qa(t)===n&&(n=n.ownerDocument.body),n}function hP(t,e){const n=gs(t);if(eg(t))return n;if(!Ka(t)){let a=Mo(t);for(;a&&!vd(a);){if(ma(a)&&!Xx(a))return a;a=Mo(a)}return n}let s=oS(t,e);for(;s&&Pz(s)&&Xx(s);)s=oS(s,e);return s&&vd(s)&&Xx(s)&&!Vb(s)?n:s||Dz(t)||n}const qz=async function(t){const e=this.getOffsetParent||hP,n=this.getDimensions,s=await n(t.floating);return{reference:Uz(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function Wz(t){return pa(t).direction==="rtl"}const Hz={convertOffsetParentRelativeRectToViewportRelativeRect:Rz,getDocumentElement:Qa,getClippingRect:zz,getOffsetParent:hP,getElementRects:qz,getClientRects:Iz,getDimensions:$z,getScale:Kc,isElement:ma,isRTL:Wz};function Vz(t,e){let n=null,s;const a=Qa(t);function i(){var c;clearTimeout(s),(c=n)==null||c.disconnect(),n=null}function o(c,d){c===void 0&&(c=!1),d===void 0&&(d=1),i();const{left:u,top:m,width:f,height:p}=t.getBoundingClientRect();if(c||e(),!f||!p)return;const y=bm(m),j=bm(a.clientWidth-(u+f)),v=bm(a.clientHeight-(m+p)),_=bm(u),w={rootMargin:-y+"px "+-j+"px "+-v+"px "+-_+"px",threshold:ds(0,Po(1,d))||1};let N=!0;function S(A){const E=A[0].intersectionRatio;if(E!==d){if(!N)return o();E?o(!1,E):s=setTimeout(()=>{o(!1,1e-7)},1e3)}N=!1}try{n=new IntersectionObserver(S,{...w,root:a.ownerDocument})}catch{n=new IntersectionObserver(S,w)}n.observe(t)}return o(!0),i}function Kz(t,e,n,s){s===void 0&&(s={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:d=!1}=s,u=Zb(t),m=a||i?[...u?Ch(u):[],...Ch(e)]:[];m.forEach(b=>{a&&b.addEventListener("scroll",n,{passive:!0}),i&&b.addEventListener("resize",n)});const f=u&&c?Vz(u,n):null;let p=-1,y=null;o&&(y=new ResizeObserver(b=>{let[w]=b;w&&w.target===u&&y&&(y.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var N;(N=y)==null||N.observe(e)})),n()}),u&&!d&&y.observe(u),y.observe(e));let j,v=d?Tl(t):null;d&&_();function _(){const b=Tl(t);v&&(b.x!==v.x||b.y!==v.y||b.width!==v.width||b.height!==v.height)&&n(),v=b,j=requestAnimationFrame(_)}return n(),()=>{var b;m.forEach(w=>{a&&w.removeEventListener("scroll",n),i&&w.removeEventListener("resize",n)}),f==null||f(),(b=y)==null||b.disconnect(),y=null,d&&cancelAnimationFrame(j)}}const Zz=kz,Gz=Cz,Qz=jz,Yz=Az,Xz=Nz,lS=bz,Jz=Ez,e$=(t,e,n)=>{const s=new Map,a={platform:Hz,...n},i={...a.platform,_c:s};return wz(t,e,{...a,platform:i})};var ip=typeof document<"u"?g.useLayoutEffect:g.useEffect;function Jp(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,s,a;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(!Jp(t[s],e[s]))return!1;return!0}if(a=Object.keys(t),n=a.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(e,a[s]))return!1;for(s=n;s--!==0;){const i=a[s];if(!(i==="_owner"&&t.$$typeof)&&!Jp(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function fP(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function cS(t,e){const n=fP(t);return Math.round(e*n)/n}function Jx(t){const e=g.useRef(t);return ip(()=>{e.current=t}),e}function t$(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:s=[],platform:a,elements:{reference:i,floating:o}={},transform:c=!0,whileElementsMounted:d,open:u}=t,[m,f]=g.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[p,y]=g.useState(s);Jp(p,s)||y(s);const[j,v]=g.useState(null),[_,b]=g.useState(null),w=g.useCallback(z=>{z!==E.current&&(E.current=z,v(z))},[]),N=g.useCallback(z=>{z!==D.current&&(D.current=z,b(z))},[]),S=i||j,A=o||_,E=g.useRef(null),D=g.useRef(null),M=g.useRef(m),B=d!=null,R=Jx(d),P=Jx(a),F=Jx(u),W=g.useCallback(()=>{if(!E.current||!D.current)return;const z={placement:e,strategy:n,middleware:p};P.current&&(z.platform=P.current),e$(E.current,D.current,z).then(V=>{const U={...V,isPositioned:F.current!==!1};ee.current&&!Jp(M.current,U)&&(M.current=U,$o.flushSync(()=>{f(U)}))})},[p,e,n,P,F]);ip(()=>{u===!1&&M.current.isPositioned&&(M.current.isPositioned=!1,f(z=>({...z,isPositioned:!1})))},[u]);const ee=g.useRef(!1);ip(()=>(ee.current=!0,()=>{ee.current=!1}),[]),ip(()=>{if(S&&(E.current=S),A&&(D.current=A),S&&A){if(R.current)return R.current(S,A,W);W()}},[S,A,W,R,B]);const ue=g.useMemo(()=>({reference:E,floating:D,setReference:w,setFloating:N}),[w,N]),de=g.useMemo(()=>({reference:S,floating:A}),[S,A]),Q=g.useMemo(()=>{const z={position:n,left:0,top:0};if(!de.floating)return z;const V=cS(de.floating,m.x),U=cS(de.floating,m.y);return c?{...z,transform:"translate("+V+"px, "+U+"px)",...fP(de.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:V,top:U}},[n,c,de.floating,m.x,m.y]);return g.useMemo(()=>({...m,update:W,refs:ue,elements:de,floatingStyles:Q}),[m,W,ue,de,Q])}const n$=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:s,padding:a}=typeof t=="function"?t(n):t;return s&&e(s)?s.current!=null?lS({element:s.current,padding:a}).fn(n):{}:s?lS({element:s,padding:a}).fn(n):{}}}},r$=(t,e)=>({...Zz(t),options:[t,e]}),s$=(t,e)=>({...Gz(t),options:[t,e]}),a$=(t,e)=>({...Jz(t),options:[t,e]}),i$=(t,e)=>({...Qz(t),options:[t,e]}),o$=(t,e)=>({...Yz(t),options:[t,e]}),l$=(t,e)=>({...Xz(t),options:[t,e]}),c$=(t,e)=>({...n$(t),options:[t,e]});var d$="Arrow",mP=g.forwardRef((t,e)=>{const{children:n,width:s=10,height:a=5,...i}=t;return r.jsx(Xe.svg,{...i,ref:e,width:s,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:r.jsx("polygon",{points:"0,0 30,0 15,10"})})});mP.displayName=d$;var u$=mP;function h$(t,e=[]){let n=[];function s(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:y,...j}=f,v=(p==null?void 0:p[t][d])||c,_=g.useMemo(()=>j,Object.values(j));return r.jsx(v.Provider,{value:_,children:y})}function m(f,p){const y=(p==null?void 0:p[t][d])||c,j=g.useContext(y);if(j)return j;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[s,f$(a,...e)]}function f$(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function pP(t){const[e,n]=g.useState(void 0);return Un(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,c;if("borderBoxSize"in i){const d=i.borderBoxSize,u=Array.isArray(d)?d[0]:d;o=u.inlineSize,c=u.blockSize}else o=t.offsetWidth,c=t.offsetHeight;n({width:o,height:c})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else n(void 0)},[t]),e}var Gb="Popper",[gP,Uo]=h$(Gb),[m$,xP]=gP(Gb),vP=t=>{const{__scopePopper:e,children:n}=t,[s,a]=g.useState(null);return r.jsx(m$,{scope:e,anchor:s,onAnchorChange:a,children:n})};vP.displayName=Gb;var yP="PopperAnchor",_P=g.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:s,...a}=t,i=xP(yP,n),o=g.useRef(null),c=Mt(e,o);return g.useEffect(()=>{i.onAnchorChange((s==null?void 0:s.current)||o.current)}),s?null:r.jsx(Xe.div,{...a,ref:c})});_P.displayName=yP;var Qb="PopperContent",[p$,g$]=gP(Qb),wP=g.forwardRef((t,e)=>{var Z,ie,pe,G,se,me;const{__scopePopper:n,side:s="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:c=0,avoidCollisions:d=!0,collisionBoundary:u=[],collisionPadding:m=0,sticky:f="partial",hideWhenDetached:p=!1,updatePositionStrategy:y="optimized",onPlaced:j,...v}=t,_=xP(Qb,n),[b,w]=g.useState(null),N=Mt(e,he=>w(he)),[S,A]=g.useState(null),E=pP(S),D=(E==null?void 0:E.width)??0,M=(E==null?void 0:E.height)??0,B=s+(i!=="center"?"-"+i:""),R=typeof m=="number"?m:{top:0,right:0,bottom:0,left:0,...m},P=Array.isArray(u)?u:[u],F=P.length>0,W={padding:R,boundary:P.filter(v$),altBoundary:F},{refs:ee,floatingStyles:ue,placement:de,isPositioned:Q,middlewareData:z}=t$({strategy:"fixed",placement:B,whileElementsMounted:(...he)=>Kz(...he,{animationFrame:y==="always"}),elements:{reference:_.anchor},middleware:[r$({mainAxis:a+M,alignmentAxis:o}),d&&s$({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?a$():void 0,...W}),d&&i$({...W}),o$({...W,apply:({elements:he,rects:xe,availableWidth:re,availableHeight:_e})=>{const{width:be,height:Be}=xe.reference,Ke=he.floating.style;Ke.setProperty("--radix-popper-available-width",`${re}px`),Ke.setProperty("--radix-popper-available-height",`${_e}px`),Ke.setProperty("--radix-popper-anchor-width",`${be}px`),Ke.setProperty("--radix-popper-anchor-height",`${Be}px`)}}),S&&c$({element:S,padding:c}),y$({arrowWidth:D,arrowHeight:M}),p&&l$({strategy:"referenceHidden",...W})]}),[V,U]=NP(de),O=jn(j);Un(()=>{Q&&(O==null||O())},[Q,O]);const I=(Z=z.arrow)==null?void 0:Z.x,H=(ie=z.arrow)==null?void 0:ie.y,$=((pe=z.arrow)==null?void 0:pe.centerOffset)!==0,[te,X]=g.useState();return Un(()=>{b&&X(window.getComputedStyle(b).zIndex)},[b]),r.jsx("div",{ref:ee.setFloating,"data-radix-popper-content-wrapper":"",style:{...ue,transform:Q?ue.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:te,"--radix-popper-transform-origin":[(G=z.transformOrigin)==null?void 0:G.x,(se=z.transformOrigin)==null?void 0:se.y].join(" "),...((me=z.hide)==null?void 0:me.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:r.jsx(p$,{scope:n,placedSide:V,onArrowChange:A,arrowX:I,arrowY:H,shouldHideArrow:$,children:r.jsx(Xe.div,{"data-side":V,"data-align":U,...v,ref:N,style:{...v.style,animation:Q?void 0:"none"}})})})});wP.displayName=Qb;var bP="PopperArrow",x$={top:"bottom",right:"left",bottom:"top",left:"right"},jP=g.forwardRef(function(e,n){const{__scopePopper:s,...a}=e,i=g$(bP,s),o=x$[i.placedSide];return r.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:r.jsx(u$,{...a,ref:n,style:{...a.style,display:"block"}})})});jP.displayName=bP;function v$(t){return t!==null}var y$=t=>({name:"transformOrigin",options:t,fn(e){var _,b,w;const{placement:n,rects:s,middlewareData:a}=e,o=((_=a.arrow)==null?void 0:_.centerOffset)!==0,c=o?0:t.arrowWidth,d=o?0:t.arrowHeight,[u,m]=NP(n),f={start:"0%",center:"50%",end:"100%"}[m],p=(((b=a.arrow)==null?void 0:b.x)??0)+c/2,y=(((w=a.arrow)==null?void 0:w.y)??0)+d/2;let j="",v="";return u==="bottom"?(j=o?f:`${p}px`,v=`${-d}px`):u==="top"?(j=o?f:`${p}px`,v=`${s.floating.height+d}px`):u==="right"?(j=`${-d}px`,v=o?f:`${y}px`):u==="left"&&(j=`${s.floating.width+d}px`,v=o?f:`${y}px`),{data:{x:j,y:v}}}});function NP(t){const[e,n="center"]=t.split("-");return[e,n]}var Yb=vP,gf=_P,ng=wP,rg=jP,[sg,zse]=Ss("Tooltip",[Uo]),Xb=Uo(),SP="TooltipProvider",_$=700,dS="tooltip.open",[w$,kP]=sg(SP),CP=t=>{const{__scopeTooltip:e,delayDuration:n=_$,skipDelayDuration:s=300,disableHoverableContent:a=!1,children:i}=t,[o,c]=g.useState(!0),d=g.useRef(!1),u=g.useRef(0);return g.useEffect(()=>{const m=u.current;return()=>window.clearTimeout(m)},[]),r.jsx(w$,{scope:e,isOpenDelayed:o,delayDuration:n,onOpen:g.useCallback(()=>{window.clearTimeout(u.current),c(!1)},[]),onClose:g.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>c(!0),s)},[s]),isPointerInTransitRef:d,onPointerInTransitChange:g.useCallback(m=>{d.current=m},[]),disableHoverableContent:a,children:i})};CP.displayName=SP;var EP="Tooltip",[$se,ag]=sg(EP),A_="TooltipTrigger",b$=g.forwardRef((t,e)=>{const{__scopeTooltip:n,...s}=t,a=ag(A_,n),i=kP(A_,n),o=Xb(n),c=g.useRef(null),d=Mt(e,c,a.onTriggerChange),u=g.useRef(!1),m=g.useRef(!1),f=g.useCallback(()=>u.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),r.jsx(gf,{asChild:!0,...o,children:r.jsx(Xe.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...s,ref:d,onPointerMove:Te(t.onPointerMove,p=>{p.pointerType!=="touch"&&!m.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),m.current=!0)}),onPointerLeave:Te(t.onPointerLeave,()=>{a.onTriggerLeave(),m.current=!1}),onPointerDown:Te(t.onPointerDown,()=>{u.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:Te(t.onFocus,()=>{u.current||a.onOpen()}),onBlur:Te(t.onBlur,a.onClose),onClick:Te(t.onClick,a.onClose)})})});b$.displayName=A_;var j$="TooltipPortal",[Use,N$]=sg(j$,{forceMount:void 0}),yd="TooltipContent",AP=g.forwardRef((t,e)=>{const n=N$(yd,t.__scopeTooltip),{forceMount:s=n.forceMount,side:a="top",...i}=t,o=ag(yd,t.__scopeTooltip);return r.jsx(Jn,{present:s||o.open,children:o.disableHoverableContent?r.jsx(PP,{side:a,...i,ref:e}):r.jsx(S$,{side:a,...i,ref:e})})}),S$=g.forwardRef((t,e)=>{const n=ag(yd,t.__scopeTooltip),s=kP(yd,t.__scopeTooltip),a=g.useRef(null),i=Mt(e,a),[o,c]=g.useState(null),{trigger:d,onClose:u}=n,m=a.current,{onPointerInTransitChange:f}=s,p=g.useCallback(()=>{c(null),f(!1)},[f]),y=g.useCallback((j,v)=>{const _=j.currentTarget,b={x:j.clientX,y:j.clientY},w=A$(b,_.getBoundingClientRect()),N=P$(b,w),S=D$(v.getBoundingClientRect()),A=M$([...N,...S]);c(A),f(!0)},[f]);return g.useEffect(()=>()=>p(),[p]),g.useEffect(()=>{if(d&&m){const j=_=>y(_,m),v=_=>y(_,d);return d.addEventListener("pointerleave",j),m.addEventListener("pointerleave",v),()=>{d.removeEventListener("pointerleave",j),m.removeEventListener("pointerleave",v)}}},[d,m,y,p]),g.useEffect(()=>{if(o){const j=v=>{const _=v.target,b={x:v.clientX,y:v.clientY},w=(d==null?void 0:d.contains(_))||(m==null?void 0:m.contains(_)),N=!T$(b,o);w?p():N&&(p(),u())};return document.addEventListener("pointermove",j),()=>document.removeEventListener("pointermove",j)}},[d,m,o,u,p]),r.jsx(PP,{...t,ref:i})}),[k$,C$]=sg(EP,{isInside:!1}),PP=g.forwardRef((t,e)=>{const{__scopeTooltip:n,children:s,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...c}=t,d=ag(yd,n),u=Xb(n),{onClose:m}=d;return g.useEffect(()=>(document.addEventListener(dS,m),()=>document.removeEventListener(dS,m)),[m]),g.useEffect(()=>{if(d.trigger){const f=p=>{const y=p.target;y!=null&&y.contains(d.trigger)&&m()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[d.trigger,m]),r.jsx(ql,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:m,children:r.jsxs(ng,{"data-state":d.stateAttribute,...u,...c,ref:e,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[r.jsx(vA,{children:s}),r.jsx(k$,{scope:n,isInside:!0,children:r.jsx(oF,{id:d.contentId,role:"tooltip",children:a||s})})]})})});AP.displayName=yd;var DP="TooltipArrow",E$=g.forwardRef((t,e)=>{const{__scopeTooltip:n,...s}=t,a=Xb(n);return C$(DP,n).isInside?null:r.jsx(rg,{...a,...s,ref:e})});E$.displayName=DP;function A$(t,e){const n=Math.abs(e.top-t.y),s=Math.abs(e.bottom-t.y),a=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,s,a,i)){case i:return"left";case a:return"right";case n:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function P$(t,e,n=5){const s=[];switch(e){case"top":s.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":s.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":s.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":s.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return s}function D$(t){const{top:e,right:n,bottom:s,left:a}=t;return[{x:a,y:e},{x:n,y:e},{x:n,y:s},{x:a,y:s}]}function T$(t,e){const{x:n,y:s}=t;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const c=e[i].x,d=e[i].y,u=e[o].x,m=e[o].y;d>s!=m>s&&n<(u-c)*(s-d)/(m-d)+c&&(a=!a)}return a}function M$(t){const e=t.slice();return e.sort((n,s)=>n.x<s.x?-1:n.x>s.x?1:n.y<s.y?-1:n.y>s.y?1:0),R$(e)}function R$(t){if(t.length<=1)return t.slice();const e=[];for(let s=0;s<t.length;s++){const a=t[s];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))e.pop();else break}e.push(a)}e.pop();const n=[];for(let s=t.length-1;s>=0;s--){const a=t[s];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))n.pop();else break}n.push(a)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var I$=CP,TP=AP;const O$=I$,L$=g.forwardRef(({className:t,sideOffset:e=4,...n},s)=>r.jsx(TP,{ref:s,sideOffset:e,className:Oe("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));L$.displayName=TP.displayName;var Fd=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Ml=typeof window>"u"||"Deno"in globalThis;function Ds(){}function F$(t,e){return typeof t=="function"?t(e):t}function P_(t){return typeof t=="number"&&t>=0&&t!==1/0}function MP(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Zc(t,e){return typeof t=="function"?t(e):t}function ta(t,e){return typeof t=="function"?t(e):t}function uS(t,e){const{type:n="all",exact:s,fetchStatus:a,predicate:i,queryKey:o,stale:c}=t;if(o){if(s){if(e.queryHash!==Jb(o,e.options))return!1}else if(!Eh(e.queryKey,o))return!1}if(n!=="all"){const d=e.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||a&&a!==e.state.fetchStatus||i&&!i(e))}function hS(t,e){const{exact:n,status:s,predicate:a,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(Rl(e.options.mutationKey)!==Rl(i))return!1}else if(!Eh(e.options.mutationKey,i))return!1}return!(s&&e.state.status!==s||a&&!a(e))}function Jb(t,e){return((e==null?void 0:e.queryKeyHashFn)||Rl)(t)}function Rl(t){return JSON.stringify(t,(e,n)=>D_(n)?Object.keys(n).sort().reduce((s,a)=>(s[a]=n[a],s),{}):n)}function Eh(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(n=>!Eh(t[n],e[n])):!1}function RP(t,e){if(t===e)return t;const n=fS(t)&&fS(e);if(n||D_(t)&&D_(e)){const s=n?t:Object.keys(t),a=s.length,i=n?e:Object.keys(e),o=i.length,c=n?[]:{};let d=0;for(let u=0;u<o;u++){const m=n?u:i[u];(!n&&s.includes(m)||n)&&t[m]===void 0&&e[m]===void 0?(c[m]=void 0,d++):(c[m]=RP(t[m],e[m]),c[m]===t[m]&&t[m]!==void 0&&d++)}return a===o&&d===a?t:c}return e}function e0(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function fS(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function D_(t){if(!mS(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!mS(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function mS(t){return Object.prototype.toString.call(t)==="[object Object]"}function B$(t){return new Promise(e=>{setTimeout(e,t)})}function T_(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?RP(t,e):e}function z$(t,e,n=0){const s=[...t,e];return n&&s.length>n?s.slice(1):s}function $$(t,e,n=0){const s=[e,...t];return n&&s.length>n?s.slice(0,-1):s}var ej=Symbol();function IP(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===ej?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var ml,eo,Xc,VC,U$=(VC=class extends Fd{constructor(){super();mt(this,ml);mt(this,eo);mt(this,Xc);qe(this,Xc,e=>{if(!Ml&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){oe(this,eo)||this.setEventListener(oe(this,Xc))}onUnsubscribe(){var e;this.hasListeners()||((e=oe(this,eo))==null||e.call(this),qe(this,eo,void 0))}setEventListener(e){var n;qe(this,Xc,e),(n=oe(this,eo))==null||n.call(this),qe(this,eo,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){oe(this,ml)!==e&&(qe(this,ml,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof oe(this,ml)=="boolean"?oe(this,ml):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},ml=new WeakMap,eo=new WeakMap,Xc=new WeakMap,VC),tj=new U$,Jc,to,ed,KC,q$=(KC=class extends Fd{constructor(){super();mt(this,Jc,!0);mt(this,to);mt(this,ed);qe(this,ed,e=>{if(!Ml&&window.addEventListener){const n=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){oe(this,to)||this.setEventListener(oe(this,ed))}onUnsubscribe(){var e;this.hasListeners()||((e=oe(this,to))==null||e.call(this),qe(this,to,void 0))}setEventListener(e){var n;qe(this,ed,e),(n=oe(this,to))==null||n.call(this),qe(this,to,e(this.setOnline.bind(this)))}setOnline(e){oe(this,Jc)!==e&&(qe(this,Jc,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return oe(this,Jc)}},Jc=new WeakMap,to=new WeakMap,ed=new WeakMap,KC),t0=new q$;function M_(){let t,e;const n=new Promise((a,i)=>{t=a,e=i});n.status="pending",n.catch(()=>{});function s(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{s({status:"fulfilled",value:a}),t(a)},n.reject=a=>{s({status:"rejected",reason:a}),e(a)},n}function W$(t){return Math.min(1e3*2**t,3e4)}function OP(t){return(t??"online")==="online"?t0.isOnline():!0}var LP=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function ev(t){return t instanceof LP}function FP(t){let e=!1,n=0,s=!1,a;const i=M_(),o=v=>{var _;s||(p(new LP(v)),(_=t.abort)==null||_.call(t))},c=()=>{e=!0},d=()=>{e=!1},u=()=>tj.isFocused()&&(t.networkMode==="always"||t0.isOnline())&&t.canRun(),m=()=>OP(t.networkMode)&&t.canRun(),f=v=>{var _;s||(s=!0,(_=t.onSuccess)==null||_.call(t,v),a==null||a(),i.resolve(v))},p=v=>{var _;s||(s=!0,(_=t.onError)==null||_.call(t,v),a==null||a(),i.reject(v))},y=()=>new Promise(v=>{var _;a=b=>{(s||u())&&v(b)},(_=t.onPause)==null||_.call(t)}).then(()=>{var v;a=void 0,s||(v=t.onContinue)==null||v.call(t)}),j=()=>{if(s)return;let v;const _=n===0?t.initialPromise:void 0;try{v=_??t.fn()}catch(b){v=Promise.reject(b)}Promise.resolve(v).then(f).catch(b=>{var E;if(s)return;const w=t.retry??(Ml?0:3),N=t.retryDelay??W$,S=typeof N=="function"?N(n,b):N,A=w===!0||typeof w=="number"&&n<w||typeof w=="function"&&w(n,b);if(e||!A){p(b);return}n++,(E=t.onFail)==null||E.call(t,n,b),B$(S).then(()=>u()?void 0:y()).then(()=>{e?p(b):j()})})};return{promise:i,cancel:o,continue:()=>(a==null||a(),i),cancelRetry:c,continueRetry:d,canStart:m,start:()=>(m()?j():y().then(j),i)}}function H$(){let t=[],e=0,n=c=>{c()},s=c=>{c()},a=c=>setTimeout(c,0);const i=c=>{e?t.push(c):a(()=>{n(c)})},o=()=>{const c=t;t=[],c.length&&a(()=>{s(()=>{c.forEach(d=>{n(d)})})})};return{batch:c=>{let d;e++;try{d=c()}finally{e--,e||o()}return d},batchCalls:c=>(...d)=>{i(()=>{c(...d)})},schedule:i,setNotifyFunction:c=>{n=c},setBatchNotifyFunction:c=>{s=c},setScheduler:c=>{a=c}}}var Qn=H$(),pl,ZC,BP=(ZC=class{constructor(){mt(this,pl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),P_(this.gcTime)&&qe(this,pl,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Ml?1/0:5*60*1e3))}clearGcTimeout(){oe(this,pl)&&(clearTimeout(oe(this,pl)),qe(this,pl,void 0))}},pl=new WeakMap,ZC),td,nd,Ps,jr,Jh,gl,Ys,oi,GC,V$=(GC=class extends BP{constructor(e){super();mt(this,Ys);mt(this,td);mt(this,nd);mt(this,Ps);mt(this,jr);mt(this,Jh);mt(this,gl);qe(this,gl,!1),qe(this,Jh,e.defaultOptions),this.setOptions(e.options),this.observers=[],qe(this,Ps,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,qe(this,td,K$(this.options)),this.state=e.state??oe(this,td),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=oe(this,jr))==null?void 0:e.promise}setOptions(e){this.options={...oe(this,Jh),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&oe(this,Ps).remove(this)}setData(e,n){const s=T_(this.state.data,e,this.options);return Lt(this,Ys,oi).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(e,n){Lt(this,Ys,oi).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var s,a;const n=(s=oe(this,jr))==null?void 0:s.promise;return(a=oe(this,jr))==null||a.cancel(e),n?n.then(Ds).catch(Ds):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(oe(this,td))}isActive(){return this.observers.some(e=>ta(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ej||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!MP(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=oe(this,jr))==null||n.continue()}onOnline(){var n;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=oe(this,jr))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),oe(this,Ps).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(oe(this,jr)&&(oe(this,gl)?oe(this,jr).cancel({revert:!0}):oe(this,jr).cancelRetry()),this.scheduleGc()),oe(this,Ps).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Lt(this,Ys,oi).call(this,{type:"invalidate"})}fetch(e,n){var d,u,m;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(oe(this,jr))return oe(this,jr).continueRetry(),oe(this,jr).promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const s=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(qe(this,gl,!0),s.signal)})},i=()=>{const f=IP(this.options,n),p={queryKey:this.queryKey,meta:this.meta};return a(p),qe(this,gl,!1),this.options.persister?this.options.persister(f,p,this):f(p)},o={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};a(o),(d=this.options.behavior)==null||d.onFetch(o,this),qe(this,nd,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=o.fetchOptions)==null?void 0:u.meta))&&Lt(this,Ys,oi).call(this,{type:"fetch",meta:(m=o.fetchOptions)==null?void 0:m.meta});const c=f=>{var p,y,j,v;ev(f)&&f.silent||Lt(this,Ys,oi).call(this,{type:"error",error:f}),ev(f)||((y=(p=oe(this,Ps).config).onError)==null||y.call(p,f,this),(v=(j=oe(this,Ps).config).onSettled)==null||v.call(j,this.state.data,f,this)),this.scheduleGc()};return qe(this,jr,FP({initialPromise:n==null?void 0:n.initialPromise,fn:o.fetchFn,abort:s.abort.bind(s),onSuccess:f=>{var p,y,j,v;if(f===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(_){c(_);return}(y=(p=oe(this,Ps).config).onSuccess)==null||y.call(p,f,this),(v=(j=oe(this,Ps).config).onSettled)==null||v.call(j,f,this.state.error,this),this.scheduleGc()},onError:c,onFail:(f,p)=>{Lt(this,Ys,oi).call(this,{type:"failed",failureCount:f,error:p})},onPause:()=>{Lt(this,Ys,oi).call(this,{type:"pause"})},onContinue:()=>{Lt(this,Ys,oi).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),oe(this,jr).start()}},td=new WeakMap,nd=new WeakMap,Ps=new WeakMap,jr=new WeakMap,Jh=new WeakMap,gl=new WeakMap,Ys=new WeakSet,oi=function(e){const n=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...zP(s.data,this.options),fetchMeta:e.meta??null};case"success":return{...s,data:e.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=e.error;return ev(a)&&a.revert&&oe(this,nd)?{...oe(this,nd),fetchStatus:"idle"}:{...s,error:a,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=n(this.state),Qn.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),oe(this,Ps).notify({query:this,type:"updated",action:e})})},GC);function zP(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:OP(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function K$(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,s=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Aa,QC,Z$=(QC=class extends Fd{constructor(e={}){super();mt(this,Aa);this.config=e,qe(this,Aa,new Map)}build(e,n,s){const a=n.queryKey,i=n.queryHash??Jb(a,n);let o=this.get(i);return o||(o=new V$({cache:this,queryKey:a,queryHash:i,options:e.defaultQueryOptions(n),state:s,defaultOptions:e.getQueryDefaults(a)}),this.add(o)),o}add(e){oe(this,Aa).has(e.queryHash)||(oe(this,Aa).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=oe(this,Aa).get(e.queryHash);n&&(e.destroy(),n===e&&oe(this,Aa).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Qn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return oe(this,Aa).get(e)}getAll(){return[...oe(this,Aa).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(s=>uS(n,s))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(s=>uS(e,s)):n}notify(e){Qn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Qn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Qn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Aa=new WeakMap,QC),Pa,Rr,xl,Da,$i,YC,G$=(YC=class extends BP{constructor(e){super();mt(this,Da);mt(this,Pa);mt(this,Rr);mt(this,xl);this.mutationId=e.mutationId,qe(this,Rr,e.mutationCache),qe(this,Pa,[]),this.state=e.state||$P(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){oe(this,Pa).includes(e)||(oe(this,Pa).push(e),this.clearGcTimeout(),oe(this,Rr).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){qe(this,Pa,oe(this,Pa).filter(n=>n!==e)),this.scheduleGc(),oe(this,Rr).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){oe(this,Pa).length||(this.state.status==="pending"?this.scheduleGc():oe(this,Rr).remove(this))}continue(){var e;return((e=oe(this,xl))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var a,i,o,c,d,u,m,f,p,y,j,v,_,b,w,N,S,A,E,D;qe(this,xl,FP({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(M,B)=>{Lt(this,Da,$i).call(this,{type:"failed",failureCount:M,error:B})},onPause:()=>{Lt(this,Da,$i).call(this,{type:"pause"})},onContinue:()=>{Lt(this,Da,$i).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>oe(this,Rr).canRun(this)}));const n=this.state.status==="pending",s=!oe(this,xl).canStart();try{if(!n){Lt(this,Da,$i).call(this,{type:"pending",variables:e,isPaused:s}),await((i=(a=oe(this,Rr).config).onMutate)==null?void 0:i.call(a,e,this));const B=await((c=(o=this.options).onMutate)==null?void 0:c.call(o,e));B!==this.state.context&&Lt(this,Da,$i).call(this,{type:"pending",context:B,variables:e,isPaused:s})}const M=await oe(this,xl).start();return await((u=(d=oe(this,Rr).config).onSuccess)==null?void 0:u.call(d,M,e,this.state.context,this)),await((f=(m=this.options).onSuccess)==null?void 0:f.call(m,M,e,this.state.context)),await((y=(p=oe(this,Rr).config).onSettled)==null?void 0:y.call(p,M,null,this.state.variables,this.state.context,this)),await((v=(j=this.options).onSettled)==null?void 0:v.call(j,M,null,e,this.state.context)),Lt(this,Da,$i).call(this,{type:"success",data:M}),M}catch(M){try{throw await((b=(_=oe(this,Rr).config).onError)==null?void 0:b.call(_,M,e,this.state.context,this)),await((N=(w=this.options).onError)==null?void 0:N.call(w,M,e,this.state.context)),await((A=(S=oe(this,Rr).config).onSettled)==null?void 0:A.call(S,void 0,M,this.state.variables,this.state.context,this)),await((D=(E=this.options).onSettled)==null?void 0:D.call(E,void 0,M,e,this.state.context)),M}finally{Lt(this,Da,$i).call(this,{type:"error",error:M})}}finally{oe(this,Rr).runNext(this)}}},Pa=new WeakMap,Rr=new WeakMap,xl=new WeakMap,Da=new WeakSet,$i=function(e){const n=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Qn.batch(()=>{oe(this,Pa).forEach(s=>{s.onMutationUpdate(e)}),oe(this,Rr).notify({mutation:this,type:"updated",action:e})})},YC);function $P(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var os,ef,XC,Q$=(XC=class extends Fd{constructor(e={}){super();mt(this,os);mt(this,ef);this.config=e,qe(this,os,new Map),qe(this,ef,Date.now())}build(e,n,s){const a=new G$({mutationCache:this,mutationId:++Jf(this,ef)._,options:e.defaultMutationOptions(n),state:s});return this.add(a),a}add(e){const n=jm(e),s=oe(this,os).get(n)??[];s.push(e),oe(this,os).set(n,s),this.notify({type:"added",mutation:e})}remove(e){var s;const n=jm(e);if(oe(this,os).has(n)){const a=(s=oe(this,os).get(n))==null?void 0:s.filter(i=>i!==e);a&&(a.length===0?oe(this,os).delete(n):oe(this,os).set(n,a))}this.notify({type:"removed",mutation:e})}canRun(e){var s;const n=(s=oe(this,os).get(jm(e)))==null?void 0:s.find(a=>a.state.status==="pending");return!n||n===e}runNext(e){var s;const n=(s=oe(this,os).get(jm(e)))==null?void 0:s.find(a=>a!==e&&a.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){Qn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...oe(this,os).values()].flat()}find(e){const n={exact:!0,...e};return this.getAll().find(s=>hS(n,s))}findAll(e={}){return this.getAll().filter(n=>hS(e,n))}notify(e){Qn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Qn.batch(()=>Promise.all(e.map(n=>n.continue().catch(Ds))))}},os=new WeakMap,ef=new WeakMap,XC);function jm(t){var e;return((e=t.options.scope)==null?void 0:e.id)??String(t.mutationId)}function pS(t){return{onFetch:(e,n)=>{var m,f,p,y,j;const s=e.options,a=(p=(f=(m=e.fetchOptions)==null?void 0:m.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,i=((y=e.state.data)==null?void 0:y.pages)||[],o=((j=e.state.data)==null?void 0:j.pageParams)||[];let c={pages:[],pageParams:[]},d=0;const u=async()=>{let v=!1;const _=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(e.signal.aborted?v=!0:e.signal.addEventListener("abort",()=>{v=!0}),e.signal)})},b=IP(e.options,e.fetchOptions),w=async(N,S,A)=>{if(v)return Promise.reject();if(S==null&&N.pages.length)return Promise.resolve(N);const E={queryKey:e.queryKey,pageParam:S,direction:A?"backward":"forward",meta:e.options.meta};_(E);const D=await b(E),{maxPages:M}=e.options,B=A?$$:z$;return{pages:B(N.pages,D,M),pageParams:B(N.pageParams,S,M)}};if(a&&i.length){const N=a==="backward",S=N?Y$:gS,A={pages:i,pageParams:o},E=S(s,A);c=await w(A,E,N)}else{const N=t??i.length;do{const S=d===0?o[0]??s.initialPageParam:gS(s,c);if(d>0&&S==null)break;c=await w(c,S),d++}while(d<N)}return c};e.options.persister?e.fetchFn=()=>{var v,_;return(_=(v=e.options).persister)==null?void 0:_.call(v,u,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=u}}}function gS(t,{pages:e,pageParams:n}){const s=e.length-1;return e.length>0?t.getNextPageParam(e[s],e,n[s],n):void 0}function Y$(t,{pages:e,pageParams:n}){var s;return e.length>0?(s=t.getPreviousPageParam)==null?void 0:s.call(t,e[0],e,n[0],n):void 0}var Dn,no,ro,rd,sd,so,ad,id,JC,X$=(JC=class{constructor(t={}){mt(this,Dn);mt(this,no);mt(this,ro);mt(this,rd);mt(this,sd);mt(this,so);mt(this,ad);mt(this,id);qe(this,Dn,t.queryCache||new Z$),qe(this,no,t.mutationCache||new Q$),qe(this,ro,t.defaultOptions||{}),qe(this,rd,new Map),qe(this,sd,new Map),qe(this,so,0)}mount(){Jf(this,so)._++,oe(this,so)===1&&(qe(this,ad,tj.subscribe(async t=>{t&&(await this.resumePausedMutations(),oe(this,Dn).onFocus())})),qe(this,id,t0.subscribe(async t=>{t&&(await this.resumePausedMutations(),oe(this,Dn).onOnline())})))}unmount(){var t,e;Jf(this,so)._--,oe(this,so)===0&&((t=oe(this,ad))==null||t.call(this),qe(this,ad,void 0),(e=oe(this,id))==null||e.call(this),qe(this,id,void 0))}isFetching(t){return oe(this,Dn).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return oe(this,no).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=oe(this,Dn).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);if(e===void 0)return this.fetchQuery(t);{const n=this.defaultQueryOptions(t),s=oe(this,Dn).build(this,n);return t.revalidateIfStale&&s.isStaleByTime(Zc(n.staleTime,s))&&this.prefetchQuery(n),Promise.resolve(e)}}getQueriesData(t){return oe(this,Dn).findAll(t).map(({queryKey:e,state:n})=>{const s=n.data;return[e,s]})}setQueryData(t,e,n){const s=this.defaultQueryOptions({queryKey:t}),a=oe(this,Dn).get(s.queryHash),i=a==null?void 0:a.state.data,o=F$(e,i);if(o!==void 0)return oe(this,Dn).build(this,s).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return Qn.batch(()=>oe(this,Dn).findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=oe(this,Dn).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=oe(this,Dn);Qn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=oe(this,Dn),s={type:"active",...t};return Qn.batch(()=>(n.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(s,e)))}cancelQueries(t={},e={}){const n={revert:!0,...e},s=Qn.batch(()=>oe(this,Dn).findAll(t).map(a=>a.cancel(n)));return Promise.all(s).then(Ds).catch(Ds)}invalidateQueries(t={},e={}){return Qn.batch(()=>{if(oe(this,Dn).findAll(t).forEach(s=>{s.invalidate()}),t.refetchType==="none")return Promise.resolve();const n={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(n,e)})}refetchQueries(t={},e){const n={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},s=Qn.batch(()=>oe(this,Dn).findAll(t).filter(a=>!a.isDisabled()).map(a=>{let i=a.fetch(void 0,n);return n.throwOnError||(i=i.catch(Ds)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(Ds)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=oe(this,Dn).build(this,e);return n.isStaleByTime(Zc(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Ds).catch(Ds)}fetchInfiniteQuery(t){return t.behavior=pS(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Ds).catch(Ds)}ensureInfiniteQueryData(t){return t.behavior=pS(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return t0.isOnline()?oe(this,no).resumePausedMutations():Promise.resolve()}getQueryCache(){return oe(this,Dn)}getMutationCache(){return oe(this,no)}getDefaultOptions(){return oe(this,ro)}setDefaultOptions(t){qe(this,ro,t)}setQueryDefaults(t,e){oe(this,rd).set(Rl(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...oe(this,rd).values()];let n={};return e.forEach(s=>{Eh(t,s.queryKey)&&(n={...n,...s.defaultOptions})}),n}setMutationDefaults(t,e){oe(this,sd).set(Rl(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...oe(this,sd).values()];let n={};return e.forEach(s=>{Eh(t,s.mutationKey)&&(n={...n,...s.defaultOptions})}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...oe(this,ro).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Jb(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===ej&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...oe(this,ro).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){oe(this,Dn).clear(),oe(this,no).clear()}},Dn=new WeakMap,no=new WeakMap,ro=new WeakMap,rd=new WeakMap,sd=new WeakMap,so=new WeakMap,ad=new WeakMap,id=new WeakMap,JC),Zr,Zt,tf,Ir,vl,od,ao,Ta,nf,ld,cd,yl,_l,io,dd,an,Su,R_,I_,O_,L_,F_,B_,z_,UP,eE,J$=(eE=class extends Fd{constructor(e,n){super();mt(this,an);mt(this,Zr);mt(this,Zt);mt(this,tf);mt(this,Ir);mt(this,vl);mt(this,od);mt(this,ao);mt(this,Ta);mt(this,nf);mt(this,ld);mt(this,cd);mt(this,yl);mt(this,_l);mt(this,io);mt(this,dd,new Set);this.options=n,qe(this,Zr,e),qe(this,Ta,null),qe(this,ao,M_()),this.options.experimental_prefetchInRender||oe(this,ao).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(oe(this,Zt).addObserver(this),xS(oe(this,Zt),this.options)?Lt(this,an,Su).call(this):this.updateResult(),Lt(this,an,L_).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return $_(oe(this,Zt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return $_(oe(this,Zt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Lt(this,an,F_).call(this),Lt(this,an,B_).call(this),oe(this,Zt).removeObserver(this)}setOptions(e,n){const s=this.options,a=oe(this,Zt);if(this.options=oe(this,Zr).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ta(this.options.enabled,oe(this,Zt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Lt(this,an,z_).call(this),oe(this,Zt).setOptions(this.options),s._defaulted&&!e0(this.options,s)&&oe(this,Zr).getQueryCache().notify({type:"observerOptionsUpdated",query:oe(this,Zt),observer:this});const i=this.hasListeners();i&&vS(oe(this,Zt),a,this.options,s)&&Lt(this,an,Su).call(this),this.updateResult(n),i&&(oe(this,Zt)!==a||ta(this.options.enabled,oe(this,Zt))!==ta(s.enabled,oe(this,Zt))||Zc(this.options.staleTime,oe(this,Zt))!==Zc(s.staleTime,oe(this,Zt)))&&Lt(this,an,R_).call(this);const o=Lt(this,an,I_).call(this);i&&(oe(this,Zt)!==a||ta(this.options.enabled,oe(this,Zt))!==ta(s.enabled,oe(this,Zt))||o!==oe(this,io))&&Lt(this,an,O_).call(this,o)}getOptimisticResult(e){const n=oe(this,Zr).getQueryCache().build(oe(this,Zr),e),s=this.createResult(n,e);return t9(this,s)&&(qe(this,Ir,s),qe(this,od,this.options),qe(this,vl,oe(this,Zt).state)),s}getCurrentResult(){return oe(this,Ir)}trackResult(e,n){const s={};return Object.keys(e).forEach(a=>{Object.defineProperty(s,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),n==null||n(a),e[a])})}),s}trackProp(e){oe(this,dd).add(e)}getCurrentQuery(){return oe(this,Zt)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=oe(this,Zr).defaultQueryOptions(e),s=oe(this,Zr).getQueryCache().build(oe(this,Zr),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(e){return Lt(this,an,Su).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),oe(this,Ir)))}createResult(e,n){var M;const s=oe(this,Zt),a=this.options,i=oe(this,Ir),o=oe(this,vl),c=oe(this,od),u=e!==s?e.state:oe(this,tf),{state:m}=e;let f={...m},p=!1,y;if(n._optimisticResults){const B=this.hasListeners(),R=!B&&xS(e,n),P=B&&vS(e,s,n,a);(R||P)&&(f={...f,...zP(m.data,e.options)}),n._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:j,errorUpdatedAt:v,status:_}=f;if(n.select&&f.data!==void 0)if(i&&f.data===(o==null?void 0:o.data)&&n.select===oe(this,nf))y=oe(this,ld);else try{qe(this,nf,n.select),y=n.select(f.data),y=T_(i==null?void 0:i.data,y,n),qe(this,ld,y),qe(this,Ta,null)}catch(B){qe(this,Ta,B)}else y=f.data;if(n.placeholderData!==void 0&&y===void 0&&_==="pending"){let B;if(i!=null&&i.isPlaceholderData&&n.placeholderData===(c==null?void 0:c.placeholderData))B=i.data;else if(B=typeof n.placeholderData=="function"?n.placeholderData((M=oe(this,cd))==null?void 0:M.state.data,oe(this,cd)):n.placeholderData,n.select&&B!==void 0)try{B=n.select(B),qe(this,Ta,null)}catch(R){qe(this,Ta,R)}B!==void 0&&(_="success",y=T_(i==null?void 0:i.data,B,n),p=!0)}oe(this,Ta)&&(j=oe(this,Ta),y=oe(this,ld),v=Date.now(),_="error");const b=f.fetchStatus==="fetching",w=_==="pending",N=_==="error",S=w&&b,A=y!==void 0,D={status:_,fetchStatus:f.fetchStatus,isPending:w,isSuccess:_==="success",isError:N,isInitialLoading:S,isLoading:S,data:y,dataUpdatedAt:f.dataUpdatedAt,error:j,errorUpdatedAt:v,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:b,isRefetching:b&&!w,isLoadingError:N&&!A,isPaused:f.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:N&&A,isStale:nj(e,n),refetch:this.refetch,promise:oe(this,ao)};if(this.options.experimental_prefetchInRender){const B=F=>{D.status==="error"?F.reject(D.error):D.data!==void 0&&F.resolve(D.data)},R=()=>{const F=qe(this,ao,D.promise=M_());B(F)},P=oe(this,ao);switch(P.status){case"pending":e.queryHash===s.queryHash&&B(P);break;case"fulfilled":(D.status==="error"||D.data!==P.value)&&R();break;case"rejected":(D.status!=="error"||D.error!==P.reason)&&R();break}}return D}updateResult(e){const n=oe(this,Ir),s=this.createResult(oe(this,Zt),this.options);if(qe(this,vl,oe(this,Zt).state),qe(this,od,this.options),oe(this,vl).data!==void 0&&qe(this,cd,oe(this,Zt)),e0(s,n))return;qe(this,Ir,s);const a={},i=()=>{if(!n)return!0;const{notifyOnChangeProps:o}=this.options,c=typeof o=="function"?o():o;if(c==="all"||!c&&!oe(this,dd).size)return!0;const d=new Set(c??oe(this,dd));return this.options.throwOnError&&d.add("error"),Object.keys(oe(this,Ir)).some(u=>{const m=u;return oe(this,Ir)[m]!==n[m]&&d.has(m)})};(e==null?void 0:e.listeners)!==!1&&i()&&(a.listeners=!0),Lt(this,an,UP).call(this,{...a,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Lt(this,an,L_).call(this)}},Zr=new WeakMap,Zt=new WeakMap,tf=new WeakMap,Ir=new WeakMap,vl=new WeakMap,od=new WeakMap,ao=new WeakMap,Ta=new WeakMap,nf=new WeakMap,ld=new WeakMap,cd=new WeakMap,yl=new WeakMap,_l=new WeakMap,io=new WeakMap,dd=new WeakMap,an=new WeakSet,Su=function(e){Lt(this,an,z_).call(this);let n=oe(this,Zt).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Ds)),n},R_=function(){Lt(this,an,F_).call(this);const e=Zc(this.options.staleTime,oe(this,Zt));if(Ml||oe(this,Ir).isStale||!P_(e))return;const s=MP(oe(this,Ir).dataUpdatedAt,e)+1;qe(this,yl,setTimeout(()=>{oe(this,Ir).isStale||this.updateResult()},s))},I_=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(oe(this,Zt)):this.options.refetchInterval)??!1},O_=function(e){Lt(this,an,B_).call(this),qe(this,io,e),!(Ml||ta(this.options.enabled,oe(this,Zt))===!1||!P_(oe(this,io))||oe(this,io)===0)&&qe(this,_l,setInterval(()=>{(this.options.refetchIntervalInBackground||tj.isFocused())&&Lt(this,an,Su).call(this)},oe(this,io)))},L_=function(){Lt(this,an,R_).call(this),Lt(this,an,O_).call(this,Lt(this,an,I_).call(this))},F_=function(){oe(this,yl)&&(clearTimeout(oe(this,yl)),qe(this,yl,void 0))},B_=function(){oe(this,_l)&&(clearInterval(oe(this,_l)),qe(this,_l,void 0))},z_=function(){const e=oe(this,Zr).getQueryCache().build(oe(this,Zr),this.options);if(e===oe(this,Zt))return;const n=oe(this,Zt);qe(this,Zt,e),qe(this,tf,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},UP=function(e){Qn.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(oe(this,Ir))}),oe(this,Zr).getQueryCache().notify({query:oe(this,Zt),type:"observerResultsUpdated"})})},eE);function e9(t,e){return ta(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function xS(t,e){return e9(t,e)||t.state.data!==void 0&&$_(t,e,e.refetchOnMount)}function $_(t,e,n){if(ta(e.enabled,t)!==!1){const s=typeof n=="function"?n(t):n;return s==="always"||s!==!1&&nj(t,e)}return!1}function vS(t,e,n,s){return(t!==e||ta(s.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&nj(t,n)}function nj(t,e){return ta(e.enabled,t)!==!1&&t.isStaleByTime(Zc(e.staleTime,t))}function t9(t,e){return!e0(t.getCurrentResult(),e)}var oo,lo,Gr,mi,vi,op,U_,tE,n9=(tE=class extends Fd{constructor(n,s){super();mt(this,vi);mt(this,oo);mt(this,lo);mt(this,Gr);mt(this,mi);qe(this,oo,n),this.setOptions(s),this.bindMethods(),Lt(this,vi,op).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var a;const s=this.options;this.options=oe(this,oo).defaultMutationOptions(n),e0(this.options,s)||oe(this,oo).getMutationCache().notify({type:"observerOptionsUpdated",mutation:oe(this,Gr),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&Rl(s.mutationKey)!==Rl(this.options.mutationKey)?this.reset():((a=oe(this,Gr))==null?void 0:a.state.status)==="pending"&&oe(this,Gr).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=oe(this,Gr))==null||n.removeObserver(this)}onMutationUpdate(n){Lt(this,vi,op).call(this),Lt(this,vi,U_).call(this,n)}getCurrentResult(){return oe(this,lo)}reset(){var n;(n=oe(this,Gr))==null||n.removeObserver(this),qe(this,Gr,void 0),Lt(this,vi,op).call(this),Lt(this,vi,U_).call(this)}mutate(n,s){var a;return qe(this,mi,s),(a=oe(this,Gr))==null||a.removeObserver(this),qe(this,Gr,oe(this,oo).getMutationCache().build(oe(this,oo),this.options)),oe(this,Gr).addObserver(this),oe(this,Gr).execute(n)}},oo=new WeakMap,lo=new WeakMap,Gr=new WeakMap,mi=new WeakMap,vi=new WeakSet,op=function(){var s;const n=((s=oe(this,Gr))==null?void 0:s.state)??$P();qe(this,lo,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},U_=function(n){Qn.batch(()=>{var s,a,i,o,c,d,u,m;if(oe(this,mi)&&this.hasListeners()){const f=oe(this,lo).variables,p=oe(this,lo).context;(n==null?void 0:n.type)==="success"?((a=(s=oe(this,mi)).onSuccess)==null||a.call(s,n.data,f,p),(o=(i=oe(this,mi)).onSettled)==null||o.call(i,n.data,null,f,p)):(n==null?void 0:n.type)==="error"&&((d=(c=oe(this,mi)).onError)==null||d.call(c,n.error,f,p),(m=(u=oe(this,mi)).onSettled)==null||m.call(u,void 0,n.error,f,p))}this.listeners.forEach(f=>{f(oe(this,lo))})})},tE),qP=g.createContext(void 0),or=t=>{const e=g.useContext(qP);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},r9=({client:t,children:e})=>(g.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),r.jsx(qP.Provider,{value:t,children:e})),WP=g.createContext(!1),s9=()=>g.useContext(WP);WP.Provider;function a9(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var i9=g.createContext(a9()),o9=()=>g.useContext(i9);function HP(t,e){return typeof t=="function"?t(...e):!!t}function VP(){}var l9=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},c9=t=>{g.useEffect(()=>{t.clearReset()},[t])},d9=({result:t,errorResetBoundary:e,throwOnError:n,query:s})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&HP(n,[t.error,s]),u9=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},h9=(t,e)=>t.isLoading&&t.isFetching&&!e,f9=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,yS=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function m9(t,e,n){var m,f,p,y,j;const s=or(),a=s9(),i=o9(),o=s.defaultQueryOptions(t);(f=(m=s.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||f.call(m,o),o._optimisticResults=a?"isRestoring":"optimistic",u9(o),l9(o,i),c9(i);const c=!s.getQueryCache().get(o.queryHash),[d]=g.useState(()=>new e(s,o)),u=d.getOptimisticResult(o);if(g.useSyncExternalStore(g.useCallback(v=>{const _=a?()=>{}:d.subscribe(Qn.batchCalls(v));return d.updateResult(),_},[d,a]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),g.useEffect(()=>{d.setOptions(o,{listeners:!1})},[o,d]),f9(o,u))throw yS(o,d,i);if(d9({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:s.getQueryCache().get(o.queryHash)}))throw u.error;if((y=(p=s.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||y.call(p,o,u),o.experimental_prefetchInRender&&!Ml&&h9(u,a)){const v=c?yS(o,d,i):(j=s.getQueryCache().get(o.queryHash))==null?void 0:j.promise;v==null||v.catch(VP).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?u:d.trackResult(u)}function _s(t,e){return m9(t,J$)}function rs(t,e){const n=or(),[s]=g.useState(()=>new n9(n,t));g.useEffect(()=>{s.setOptions(t)},[s,t]);const a=g.useSyncExternalStore(g.useCallback(o=>s.subscribe(Qn.batchCalls(o)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=g.useCallback((o,c)=>{s.mutate(o,c).catch(VP)},[s]);if(a.error&&HP(s.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ah(){return Ah=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ah.apply(this,arguments)}var ho;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ho||(ho={}));const _S="popstate";function p9(t){t===void 0&&(t={});function e(s,a){let{pathname:i,search:o,hash:c}=s.location;return q_("",{pathname:i,search:o,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){return typeof a=="string"?a:n0(a)}return x9(e,n,null,t)}function $n(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function KP(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function g9(){return Math.random().toString(36).substr(2,8)}function wS(t,e){return{usr:t.state,key:t.key,idx:e}}function q_(t,e,n,s){return n===void 0&&(n=null),Ah({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Bd(e):e,{state:n,key:e&&e.key||s||g9()})}function n0(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Bd(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function x9(t,e,n,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:i=!1}=s,o=a.history,c=ho.Pop,d=null,u=m();u==null&&(u=0,o.replaceState(Ah({},o.state,{idx:u}),""));function m(){return(o.state||{idx:null}).idx}function f(){c=ho.Pop;let _=m(),b=_==null?null:_-u;u=_,d&&d({action:c,location:v.location,delta:b})}function p(_,b){c=ho.Push;let w=q_(v.location,_,b);u=m()+1;let N=wS(w,u),S=v.createHref(w);try{o.pushState(N,"",S)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;a.location.assign(S)}i&&d&&d({action:c,location:v.location,delta:1})}function y(_,b){c=ho.Replace;let w=q_(v.location,_,b);u=m();let N=wS(w,u),S=v.createHref(w);o.replaceState(N,"",S),i&&d&&d({action:c,location:v.location,delta:0})}function j(_){let b=a.location.origin!=="null"?a.location.origin:a.location.href,w=typeof _=="string"?_:n0(_);return w=w.replace(/ $/,"%20"),$n(b,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,b)}let v={get action(){return c},get location(){return t(a,o)},listen(_){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(_S,f),d=_,()=>{a.removeEventListener(_S,f),d=null}},createHref(_){return e(a,_)},createURL:j,encodeLocation(_){let b=j(_);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:y,go(_){return o.go(_)}};return v}var bS;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(bS||(bS={}));function v9(t,e,n){return n===void 0&&(n="/"),y9(t,e,n,!1)}function y9(t,e,n,s){let a=typeof e=="string"?Bd(e):e,i=rj(a.pathname||"/",n);if(i==null)return null;let o=ZP(t);_9(o);let c=null;for(let d=0;c==null&&d<o.length;++d){let u=D9(i);c=A9(o[d],u,s)}return c}function ZP(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let a=(i,o,c)=>{let d={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};d.relativePath.startsWith("/")&&($n(d.relativePath.startsWith(s),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(s.length));let u=No([s,d.relativePath]),m=n.concat(d);i.children&&i.children.length>0&&($n(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),ZP(i.children,e,m,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:C9(u,i.index),routesMeta:m})};return t.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))a(i,o);else for(let d of GP(i.path))a(i,o,d)}),e}function GP(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return a?[i,""]:[i];let o=GP(s.join("/")),c=[];return c.push(...o.map(d=>d===""?i:[i,d].join("/"))),a&&c.push(...o),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function _9(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:E9(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const w9=/^:[\w-]+$/,b9=3,j9=2,N9=1,S9=10,k9=-2,jS=t=>t==="*";function C9(t,e){let n=t.split("/"),s=n.length;return n.some(jS)&&(s+=k9),e&&(s+=j9),n.filter(a=>!jS(a)).reduce((a,i)=>a+(w9.test(i)?b9:i===""?N9:S9),s)}function E9(t,e){return t.length===e.length&&t.slice(0,-1).every((s,a)=>s===e[a])?t[t.length-1]-e[e.length-1]:0}function A9(t,e,n){let{routesMeta:s}=t,a={},i="/",o=[];for(let c=0;c<s.length;++c){let d=s[c],u=c===s.length-1,m=i==="/"?e:e.slice(i.length)||"/",f=NS({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},m),p=d.route;if(!f&&u&&n&&!s[s.length-1].route.index&&(f=NS({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:No([i,f.pathname]),pathnameBase:I9(No([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=No([i,f.pathnameBase]))}return o}function NS(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=P9(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:s.reduce((u,m,f)=>{let{paramName:p,isOptional:y}=m;if(p==="*"){let v=c[f]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const j=c[f];return y&&!j?u[p]=void 0:u[p]=(j||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function P9(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),KP(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,d)=>(s.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function D9(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return KP(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function rj(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function T9(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:a=""}=typeof t=="string"?Bd(t):t;return{pathname:n?n.startsWith("/")?n:M9(n,e):e,search:O9(s),hash:L9(a)}}function M9(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function tv(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function R9(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function QP(t,e){let n=R9(t);return e?n.map((s,a)=>a===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function YP(t,e,n,s){s===void 0&&(s=!1);let a;typeof t=="string"?a=Bd(t):(a=Ah({},t),$n(!a.pathname||!a.pathname.includes("?"),tv("?","pathname","search",a)),$n(!a.pathname||!a.pathname.includes("#"),tv("#","pathname","hash",a)),$n(!a.search||!a.search.includes("#"),tv("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,c;if(o==null)c=n;else{let f=e.length-1;if(!s&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;a.pathname=p.join("/")}c=f>=0?e[f]:"/"}let d=T9(a,c),u=o&&o!=="/"&&o.endsWith("/"),m=(i||o===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(u||m)&&(d.pathname+="/"),d}const No=t=>t.join("/").replace(/\/\/+/g,"/"),I9=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),O9=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,L9=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function F9(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const XP=["post","put","patch","delete"];new Set(XP);const B9=["get",...XP];new Set(B9);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ph(){return Ph=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Ph.apply(this,arguments)}const sj=g.createContext(null),z9=g.createContext(null),Wl=g.createContext(null),ig=g.createContext(null),Hl=g.createContext({outlet:null,matches:[],isDataRoute:!1}),JP=g.createContext(null);function $9(t,e){let{relative:n}=e===void 0?{}:e;xf()||$n(!1);let{basename:s,navigator:a}=g.useContext(Wl),{hash:i,pathname:o,search:c}=tD(t,{relative:n}),d=o;return s!=="/"&&(d=o==="/"?s:No([s,o])),a.createHref({pathname:d,search:c,hash:i})}function xf(){return g.useContext(ig)!=null}function zd(){return xf()||$n(!1),g.useContext(ig).location}function eD(t){g.useContext(Wl).static||g.useLayoutEffect(t)}function Pi(){let{isDataRoute:t}=g.useContext(Hl);return t?e7():U9()}function U9(){xf()||$n(!1);let t=g.useContext(sj),{basename:e,future:n,navigator:s}=g.useContext(Wl),{matches:a}=g.useContext(Hl),{pathname:i}=zd(),o=JSON.stringify(QP(a,n.v7_relativeSplatPath)),c=g.useRef(!1);return eD(()=>{c.current=!0}),g.useCallback(function(u,m){if(m===void 0&&(m={}),!c.current)return;if(typeof u=="number"){s.go(u);return}let f=YP(u,JSON.parse(o),i,m.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:No([e,f.pathname])),(m.replace?s.replace:s.push)(f,m.state,m)},[e,s,o,i,t])}function tD(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=g.useContext(Wl),{matches:a}=g.useContext(Hl),{pathname:i}=zd(),o=JSON.stringify(QP(a,s.v7_relativeSplatPath));return g.useMemo(()=>YP(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function q9(t,e){return W9(t,e)}function W9(t,e,n,s){xf()||$n(!1);let{navigator:a}=g.useContext(Wl),{matches:i}=g.useContext(Hl),o=i[i.length-1],c=o?o.params:{};o&&o.pathname;let d=o?o.pathnameBase:"/";o&&o.route;let u=zd(),m;if(e){var f;let _=typeof e=="string"?Bd(e):e;d==="/"||(f=_.pathname)!=null&&f.startsWith(d)||$n(!1),m=_}else m=u;let p=m.pathname||"/",y=p;if(d!=="/"){let _=d.replace(/^\//,"").split("/");y="/"+p.replace(/^\//,"").split("/").slice(_.length).join("/")}let j=v9(t,{pathname:y}),v=G9(j&&j.map(_=>Object.assign({},_,{params:Object.assign({},c,_.params),pathname:No([d,a.encodeLocation?a.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?d:No([d,a.encodeLocation?a.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),i,n,s);return e&&v?g.createElement(ig.Provider,{value:{location:Ph({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:ho.Pop}},v):v}function H9(){let t=J9(),e=F9(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),n?g.createElement("pre",{style:a},n):null,null)}const V9=g.createElement(H9,null);class K9 extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?g.createElement(Hl.Provider,{value:this.props.routeContext},g.createElement(JP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Z9(t){let{routeContext:e,match:n,children:s}=t,a=g.useContext(sj);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),g.createElement(Hl.Provider,{value:e},s)}function G9(t,e,n,s){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,c=(a=n)==null?void 0:a.errors;if(c!=null){let m=o.findIndex(f=>f.route.id&&(c==null?void 0:c[f.route.id])!==void 0);m>=0||$n(!1),o=o.slice(0,Math.min(o.length,m+1))}let d=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let m=0;m<o.length;m++){let f=o[m];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=m),f.route.id){let{loaderData:p,errors:y}=n,j=f.route.loader&&p[f.route.id]===void 0&&(!y||y[f.route.id]===void 0);if(f.route.lazy||j){d=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((m,f,p)=>{let y,j=!1,v=null,_=null;n&&(y=c&&f.route.id?c[f.route.id]:void 0,v=f.route.errorElement||V9,d&&(u<0&&p===0?(j=!0,_=null):u===p&&(j=!0,_=f.route.hydrateFallbackElement||null)));let b=e.concat(o.slice(0,p+1)),w=()=>{let N;return y?N=v:j?N=_:f.route.Component?N=g.createElement(f.route.Component,null):f.route.element?N=f.route.element:N=m,g.createElement(Z9,{match:f,routeContext:{outlet:m,matches:b,isDataRoute:n!=null},children:N})};return n&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?g.createElement(K9,{location:n.location,revalidation:n.revalidation,component:v,error:y,children:w(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):w()},null)}var nD=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(nD||{}),r0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(r0||{});function Q9(t){let e=g.useContext(sj);return e||$n(!1),e}function Y9(t){let e=g.useContext(z9);return e||$n(!1),e}function X9(t){let e=g.useContext(Hl);return e||$n(!1),e}function rD(t){let e=X9(),n=e.matches[e.matches.length-1];return n.route.id||$n(!1),n.route.id}function J9(){var t;let e=g.useContext(JP),n=Y9(r0.UseRouteError),s=rD(r0.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function e7(){let{router:t}=Q9(nD.UseNavigateStable),e=rD(r0.UseNavigateStable),n=g.useRef(!1);return eD(()=>{n.current=!0}),g.useCallback(function(a,i){i===void 0&&(i={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,Ph({fromRouteId:e},i)))},[t,e])}function Vs(t){$n(!1)}function t7(t){let{basename:e="/",children:n=null,location:s,navigationType:a=ho.Pop,navigator:i,static:o=!1,future:c}=t;xf()&&$n(!1);let d=e.replace(/^\/*/,"/"),u=g.useMemo(()=>({basename:d,navigator:i,static:o,future:Ph({v7_relativeSplatPath:!1},c)}),[d,c,i,o]);typeof s=="string"&&(s=Bd(s));let{pathname:m="/",search:f="",hash:p="",state:y=null,key:j="default"}=s,v=g.useMemo(()=>{let _=rj(m,d);return _==null?null:{location:{pathname:_,search:f,hash:p,state:y,key:j},navigationType:a}},[d,m,f,p,y,j,a]);return v==null?null:g.createElement(Wl.Provider,{value:u},g.createElement(ig.Provider,{children:n,value:v}))}function n7(t){let{children:e,location:n}=t;return q9(W_(e),n)}new Promise(()=>{});function W_(t,e){e===void 0&&(e=[]);let n=[];return g.Children.forEach(t,(s,a)=>{if(!g.isValidElement(s))return;let i=[...e,a];if(s.type===g.Fragment){n.push.apply(n,W_(s.props.children,i));return}s.type!==Vs&&$n(!1),!s.props.index||!s.props.children||$n(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=W_(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function H_(){return H_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},H_.apply(this,arguments)}function r7(t,e){if(t==null)return{};var n={},s=Object.keys(t),a,i;for(i=0;i<s.length;i++)a=s[i],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function s7(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function a7(t,e){return t.button===0&&(!e||e==="_self")&&!s7(t)}function V_(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(a=>[n,a]):[[n,s]])},[]))}function i7(t,e){let n=V_(t);return e&&e.forEach((s,a)=>{n.has(a)||e.getAll(a).forEach(i=>{n.append(a,i)})}),n}const o7=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],l7="6";try{window.__reactRouterVersion=l7}catch{}const c7="startTransition",SS=fE[c7];function d7(t){let{basename:e,children:n,future:s,window:a}=t,i=g.useRef();i.current==null&&(i.current=p9({window:a,v5Compat:!0}));let o=i.current,[c,d]=g.useState({action:o.action,location:o.location}),{v7_startTransition:u}=s||{},m=g.useCallback(f=>{u&&SS?SS(()=>d(f)):d(f)},[d,u]);return g.useLayoutEffect(()=>o.listen(m),[o,m]),g.createElement(t7,{basename:e,children:n,location:c.location,navigationType:c.action,navigator:o,future:s})}const u7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",h7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zi=g.forwardRef(function(e,n){let{onClick:s,relative:a,reloadDocument:i,replace:o,state:c,target:d,to:u,preventScrollReset:m,viewTransition:f}=e,p=r7(e,o7),{basename:y}=g.useContext(Wl),j,v=!1;if(typeof u=="string"&&h7.test(u)&&(j=u,u7))try{let N=new URL(window.location.href),S=u.startsWith("//")?new URL(N.protocol+u):new URL(u),A=rj(S.pathname,y);S.origin===N.origin&&A!=null?u=A+S.search+S.hash:v=!0}catch{}let _=$9(u,{relative:a}),b=f7(u,{replace:o,state:c,target:d,preventScrollReset:m,relative:a,viewTransition:f});function w(N){s&&s(N),N.defaultPrevented||b(N)}return g.createElement("a",H_({},p,{href:j||_,onClick:v||i?s:w,ref:n,target:d}))});var kS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(kS||(kS={}));var CS;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(CS||(CS={}));function f7(t,e){let{target:n,replace:s,state:a,preventScrollReset:i,relative:o,viewTransition:c}=e===void 0?{}:e,d=Pi(),u=zd(),m=tD(t,{relative:o});return g.useCallback(f=>{if(a7(f,n)){f.preventDefault();let p=s!==void 0?s:n0(u)===n0(m);d(t,{replace:p,state:a,preventScrollReset:i,relative:o,viewTransition:c})}},[u,d,m,s,a,n,t,i,o,c])}function aj(t){let e=g.useRef(V_(t)),n=g.useRef(!1),s=zd(),a=g.useMemo(()=>i7(s.search,n.current?null:e.current),[s.search]),i=Pi(),o=g.useCallback((c,d)=>{const u=V_(typeof c=="function"?c(a):c);n.current=!0,i("?"+u,d)},[i,a]);return[a,o]}const m7="modulepreload",p7=function(t){return"/"+t},ES={},$d=function(e,n,s){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(n.map(d=>{if(d=p7(d),d in ES)return;ES[d]=!0;const u=d.endsWith(".css"),m=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":m7,u||(f.as="script"),f.crossOrigin="",f.href=d,c&&f.setAttribute("nonce",c),document.head.appendChild(f),u)return new Promise((p,y)=>{f.addEventListener("load",p),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return a.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},g7=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>$d(async()=>{const{default:s}=await Promise.resolve().then(()=>Ud);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)};class ij extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class x7 extends ij{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class AS extends ij{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class PS extends ij{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var K_;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(K_||(K_={}));var v7=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(s.next(m))}catch(f){o(f)}}function d(m){try{u(s.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((s=s.apply(t,e||[])).next())})};class y7{constructor(e,{headers:n={},customFetch:s,region:a=K_.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=g7(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var s;return v7(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=n;let c={},{region:d}=n;d||(d=this.region);const u=new URL(`${this.url}/${e}`);d&&d!=="any"&&(c["x-region"]=d,u.searchParams.set("forceFunctionRegion",d));let m;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",m=o):typeof o=="string"?(c["Content-Type"]="text/plain",m=o):typeof FormData<"u"&&o instanceof FormData?m=o:(c["Content-Type"]="application/json",m=JSON.stringify(o)));const f=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:m}).catch(v=>{throw new x7(v)}),p=f.headers.get("x-relay-error");if(p&&p==="true")throw new AS(f);if(!f.ok)throw new PS(f);let y=((s=f.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),j;return y==="application/json"?j=yield f.json():y==="application/octet-stream"?j=yield f.blob():y==="text/event-stream"?j=f:y==="multipart/form-data"?j=yield f.formData():j=yield f.text(),{data:j,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof PS||a instanceof AS?a.context:void 0}}})}}var Xr={},oj={},og={},vf={},lg={},cg={},_7=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},_d=_7();const w7=_d.fetch,sD=_d.fetch.bind(_d),aD=_d.Headers,b7=_d.Request,j7=_d.Response,Ud=Object.freeze(Object.defineProperty({__proto__:null,Headers:aD,Request:b7,Response:j7,default:sD,fetch:w7},Symbol.toStringTag,{value:"Module"})),N7=nE(Ud);var dg={};Object.defineProperty(dg,"__esModule",{value:!0});let S7=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};dg.default=S7;var iD=ht&&ht.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(cg,"__esModule",{value:!0});const k7=iD(N7),C7=iD(dg);let E7=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=k7.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let a=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,c,d;let u=null,m=null,f=null,p=i.status,y=i.statusText;if(i.ok){if(this.method!=="HEAD"){const b=await i.text();b===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?m=b:m=JSON.parse(b))}const v=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),_=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");v&&_&&_.length>1&&(f=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(u={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,f=null,p=406,y="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const v=await i.text();try{u=JSON.parse(v),Array.isArray(u)&&i.status===404&&(m=[],u=null,p=200,y="OK")}catch{i.status===404&&v===""?(p=204,y="No Content"):u={message:v}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,p=200,y="OK"),u&&this.shouldThrowOnError)throw new C7.default(u)}return{error:u,data:m,count:f,status:p,statusText:y}});return this.shouldThrowOnError||(a=a.catch(i=>{var o,c,d;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(c=i==null?void 0:i.stack)!==null&&c!==void 0?c:""}`,hint:"",code:`${(d=i==null?void 0:i.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,n)}returns(){return this}overrideTypes(){return this}};cg.default=E7;var A7=ht&&ht.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(lg,"__esModule",{value:!0});const P7=A7(cg);let D7=class extends P7.default{select(e){let n=!1;const s=(e??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:s,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",c=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${c?`${c},`:""}${e}.${n?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:s=n}={}){const a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,n,{foreignTable:s,referencedTable:a=s}={}){const i=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:s=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var c;const d=[e?"analyze":null,n?"verbose":null,s?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${d};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};lg.default=D7;var T7=ht&&ht.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(vf,"__esModule",{value:!0});const M7=T7(lg);let R7=class extends M7.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const s=Array.from(new Set(n)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:s,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,s])=>{this.url.searchParams.append(n,`eq.${s}`)}),this}not(e,n,s){return this.url.searchParams.append(e,`not.${n}.${s}`),this}or(e,{foreignTable:n,referencedTable:s=n}={}){const a=s?`${s}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,n,s){return this.url.searchParams.append(e,`${n}.${s}`),this}};vf.default=R7;var I7=ht&&ht.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(og,"__esModule",{value:!0});const vu=I7(vf);let O7=class{constructor(e,{headers:n={},schema:s,fetch:a}){this.url=e,this.headers=n,this.schema=s,this.fetch=a}select(e,{head:n=!1,count:s}={}){const a=n?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",o),s&&(this.headers.Prefer=`count=${s}`),new vu.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:s=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(o.length>0){const c=[...new Set(o)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new vu.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:s=!1,count:a,defaultToNull:i=!0}={}){const o="POST",c=[`resolution=${s?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),i||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(e)){const d=e.reduce((u,m)=>u.concat(Object.keys(m)),[]);if(d.length>0){const u=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",u.join(","))}}return new vu.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const s="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),this.headers.Prefer=a.join(","),new vu.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new vu.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};og.default=O7;var ug={},hg={};Object.defineProperty(hg,"__esModule",{value:!0});hg.version=void 0;hg.version="0.0.0-automated";Object.defineProperty(ug,"__esModule",{value:!0});ug.DEFAULT_HEADERS=void 0;const L7=hg;ug.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${L7.version}`};var oD=ht&&ht.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(oj,"__esModule",{value:!0});const F7=oD(og),B7=oD(vf),z7=ug;let $7=class lD{constructor(e,{headers:n={},schema:s,fetch:a}={}){this.url=e,this.headers=Object.assign(Object.assign({},z7.DEFAULT_HEADERS),n),this.schemaName=s,this.fetch=a}from(e){const n=new URL(`${this.url}/${e}`);return new F7.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new lD(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:s=!1,get:a=!1,count:i}={}){let o;const c=new URL(`${this.url}/rpc/${e}`);let d;s||a?(o=s?"HEAD":"GET",Object.entries(n).filter(([m,f])=>f!==void 0).map(([m,f])=>[m,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([m,f])=>{c.searchParams.append(m,f)})):(o="POST",d=n);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new B7.default({method:o,url:c,headers:u,schema:this.schemaName,body:d,fetch:this.fetch,allowEmpty:!1})}};oj.default=$7;var qd=ht&&ht.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Xr,"__esModule",{value:!0});Xr.PostgrestError=Xr.PostgrestBuilder=Xr.PostgrestTransformBuilder=Xr.PostgrestFilterBuilder=Xr.PostgrestQueryBuilder=Xr.PostgrestClient=void 0;const cD=qd(oj);Xr.PostgrestClient=cD.default;const dD=qd(og);Xr.PostgrestQueryBuilder=dD.default;const uD=qd(vf);Xr.PostgrestFilterBuilder=uD.default;const hD=qd(lg);Xr.PostgrestTransformBuilder=hD.default;const fD=qd(cg);Xr.PostgrestBuilder=fD.default;const mD=qd(dg);Xr.PostgrestError=mD.default;var U7=Xr.default={PostgrestClient:cD.default,PostgrestQueryBuilder:dD.default,PostgrestFilterBuilder:uD.default,PostgrestTransformBuilder:hD.default,PostgrestBuilder:fD.default,PostgrestError:mD.default};const{PostgrestClient:q7,PostgrestQueryBuilder:Gse,PostgrestFilterBuilder:Qse,PostgrestTransformBuilder:Yse,PostgrestBuilder:Xse,PostgrestError:Jse}=U7;function W7(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const H7=W7(),V7="2.11.15",K7=`realtime-js/${V7}`,Z7="1.0.0",pD=1e4,G7=1e3;var eh;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(eh||(eh={}));var br;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(br||(br={}));var Js;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Js||(Js={}));var Z_;(function(t){t.websocket="websocket"})(Z_||(Z_={}));var ol;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ol||(ol={}));class Q7{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,n,s)}_decodeBroadcast(e,n,s){const a=n.getUint8(1),i=n.getUint8(2);let o=this.HEADER_LENGTH+2;const c=s.decode(e.slice(o,o+a));o=o+a;const d=s.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:c,event:d,payload:u}}}class gD{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var gn;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(gn||(gn={}));const DS=(t,e,n={})=>{var s;const a=(s=n.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=Y7(o,t,e,a),i),{})},Y7=(t,e,n,s)=>{const a=e.find(c=>c.name===t),i=a==null?void 0:a.type,o=n[t];return i&&!s.includes(i)?xD(i,o):G_(o)},xD=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return tU(e,n)}switch(t){case gn.bool:return X7(e);case gn.float4:case gn.float8:case gn.int2:case gn.int4:case gn.int8:case gn.numeric:case gn.oid:return J7(e);case gn.json:case gn.jsonb:return eU(e);case gn.timestamp:return nU(e);case gn.abstime:case gn.date:case gn.daterange:case gn.int4range:case gn.int8range:case gn.money:case gn.reltime:case gn.text:case gn.time:case gn.timestamptz:case gn.timetz:case gn.tsrange:case gn.tstzrange:return G_(e);default:return G_(e)}},G_=t=>t,X7=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},J7=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},eU=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},tU=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>xD(e,c))}return t},nU=t=>typeof t=="string"?t.replace(" ","T"):t,vD=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class nv{constructor(e,n,s={},a=pD){this.channel=e,this.event=n,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var TS;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(TS||(TS={}));class th{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=th.syncState(this.state,a,i,o),this.pendingDiffs.forEach(d=>{this.state=th.syncDiff(this.state,d,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(s.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=th.syncDiff(this.state,a,i,o),c())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,a){const i=this.cloneDeep(e),o=this.transformState(n),c={},d={};return this.map(i,(u,m)=>{o[u]||(d[u]=m)}),this.map(o,(u,m)=>{const f=i[u];if(f){const p=m.map(_=>_.presence_ref),y=f.map(_=>_.presence_ref),j=m.filter(_=>y.indexOf(_.presence_ref)<0),v=f.filter(_=>p.indexOf(_.presence_ref)<0);j.length>0&&(c[u]=j),v.length>0&&(d[u]=v)}else c[u]=m}),this.syncDiff(i,{joins:c,leaves:d},s,a)}static syncDiff(e,n,s,a){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(i,(c,d)=>{var u;const m=(u=e[c])!==null&&u!==void 0?u:[];if(e[c]=this.cloneDeep(d),m.length>0){const f=e[c].map(y=>y.presence_ref),p=m.filter(y=>f.indexOf(y.presence_ref)<0);e[c].unshift(...p)}s(c,m,d)}),this.map(o,(c,d)=>{let u=e[c];if(!u)return;const m=d.map(f=>f.presence_ref);u=u.filter(f=>m.indexOf(f.presence_ref)<0),e[c]=u,a(c,u,d),u.length===0&&delete e[c]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const a=e[s];return"metas"in a?n[s]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[s]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var MS;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(MS||(MS={}));var RS;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(RS||(RS={}));var hi;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(hi||(hi={}));class lj{constructor(e,n={config:{}},s){this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=br.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new nv(this,Js.join,this.params,this.timeout),this.rejoinTimer=new gD(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=br.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=br.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=br.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=br.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Js.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new th(this),this.broadcastEndpointURL=vD(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==br.closed){const{config:{broadcast:i,presence:o,private:c}}=this.params;this._onError(m=>e==null?void 0:e(hi.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(hi.CLOSED));const d={},u={broadcast:i,presence:o,postgres_changes:(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(m=>m.filter))!==null&&a!==void 0?a:[],private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:m})=>{var f;if(this.socket.setAuth(),m===void 0){e==null||e(hi.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,y=(f=p==null?void 0:p.length)!==null&&f!==void 0?f:0,j=[];for(let v=0;v<y;v++){const _=p[v],{filter:{event:b,schema:w,table:N,filter:S}}=_,A=m&&m[v];if(A&&A.event===b&&A.schema===w&&A.table===N&&A.filter===S)j.push(Object.assign(Object.assign({},_),{id:A.id}));else{this.unsubscribe(),this.state=br.errored,e==null||e(hi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=j,e&&e(hi.SUBSCRIBED);return}}).receive("error",m=>{this.state=br.errored,e==null||e(hi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(hi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this._on(e,n,s)}async send(e,n={}){var s,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,d;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=br.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Js.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new nv(this,Js.leave,{},e),s.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,s){const a=new AbortController,i=setTimeout(()=>a.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(i),o}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new nv(this,e,n,s);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var a,i;const o=e.toLocaleLowerCase(),{close:c,error:d,leave:u,join:m}=Js;if(s&&[c,d,u,m].indexOf(o)>=0&&s!==this._joinRef())return;let p=this._onMessage(o,n,s);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(y=>{var j,v,_;return((j=y.filter)===null||j===void 0?void 0:j.event)==="*"||((_=(v=y.filter)===null||v===void 0?void 0:v.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===o}).map(y=>y.callback(p,s)):(i=this.bindings[o])===null||i===void 0||i.filter(y=>{var j,v,_,b,w,N;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const S=y.id,A=(j=y.filter)===null||j===void 0?void 0:j.event;return S&&((v=n.ids)===null||v===void 0?void 0:v.includes(S))&&(A==="*"||(A==null?void 0:A.toLocaleLowerCase())===((_=n.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const S=(w=(b=y==null?void 0:y.filter)===null||b===void 0?void 0:b.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return S==="*"||S===((N=n==null?void 0:n.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof p=="object"&&"ids"in p){const j=p.data,{schema:v,table:_,commit_timestamp:b,type:w,errors:N}=j;p=Object.assign(Object.assign({},{schema:v,table:_,commit_timestamp:b,eventType:w,new:{},old:{},errors:N}),this._getPayloadRecords(j))}y.callback(p,s)})}_isClosed(){return this.state===br.closed}_isJoined(){return this.state===br.joined}_isJoining(){return this.state===br.joining}_isLeaving(){return this.state===br.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const a=e.toLocaleLowerCase(),i={type:a,filter:n,callback:s};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&lj.isEqual(a.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Js.close,{},e)}_onError(e){this._on(Js.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=br.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=DS(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=DS(e.columns,e.old_record)),n}}const IS=()=>{},rU=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class sU{constructor(e,n){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=pD,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=IS,this.ref=0,this.logger=IS,this.conn=null,this.sendBuffer=[],this.serializer=new Q7,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...c)=>$d(async()=>{const{default:d}=await Promise.resolve().then(()=>Ud);return{default:d}},void 0).then(({default:d})=>d(...c)):o=fetch,(...c)=>o(...c)},this.endPoint=`${e}/${Z_.websocket}`,this.httpEndpoint=vD(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(s=n==null?void 0:n.params)===null||s===void 0?void 0:s.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(i,o)=>o(JSON.stringify(i)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new gD(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=H7),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Z7}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case eh.connecting:return ol.Connecting;case eh.open:return ol.Open;case eh.closing:return ol.Closing;default:return ol.Closed}}isConnected(){return this.connectionState()===ol.Open}channel(e,n={config:{}}){const s=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===s);if(a)return a;{const i=new lj(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:s,payload:a,ref:i}=e,o=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${n} ${s} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const a={access_token:n,version:K7};n&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(Js.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(G7,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:s,event:a,payload:i,ref:o}=n;s==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${a} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(c=>c._isMember(s)).forEach(c=>c._trigger(a,i,o)),this.stateChangeCallbacks.message.forEach(c=>c(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Js.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${s}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([rU],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}}class cj extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function nr(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class aU extends cj{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Q_ extends cj{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var iU=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(s.next(m))}catch(f){o(f)}}function d(m){try{u(s.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((s=s.apply(t,e||[])).next())})};const yD=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>$d(async()=>{const{default:s}=await Promise.resolve().then(()=>Ud);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},oU=()=>iU(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield $d(()=>Promise.resolve().then(()=>Ud),void 0)).Response:Response}),Y_=t=>{if(Array.isArray(t))return t.map(n=>Y_(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const a=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=Y_(s)}),e};var Vl=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(s.next(m))}catch(f){o(f)}}function d(m){try{u(s.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((s=s.apply(t,e||[])).next())})};const rv=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),lU=(t,e,n)=>Vl(void 0,void 0,void 0,function*(){const s=yield oU();t instanceof s&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{e(new aU(rv(a),t.status||500))}).catch(a=>{e(new Q_(rv(a),a))}):e(new Q_(rv(t),t))}),cU=(t,e,n,s)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(a.body=JSON.stringify(s)),Object.assign(Object.assign({},a),n))};function yf(t,e,n,s,a,i){return Vl(this,void 0,void 0,function*(){return new Promise((o,c)=>{t(n,cU(e,s,a,i)).then(d=>{if(!d.ok)throw d;return s!=null&&s.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>lU(d,c,s))})})}function s0(t,e,n,s){return Vl(this,void 0,void 0,function*(){return yf(t,"GET",e,n,s)})}function Gi(t,e,n,s,a){return Vl(this,void 0,void 0,function*(){return yf(t,"POST",e,s,a,n)})}function dU(t,e,n,s,a){return Vl(this,void 0,void 0,function*(){return yf(t,"PUT",e,s,a,n)})}function uU(t,e,n,s){return Vl(this,void 0,void 0,function*(){return yf(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),s)})}function _D(t,e,n,s,a){return Vl(this,void 0,void 0,function*(){return yf(t,"DELETE",e,s,a,n)})}var Kr=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(s.next(m))}catch(f){o(f)}}function d(m){try{u(s.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((s=s.apply(t,e||[])).next())})};const hU={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},OS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class fU{constructor(e,n={},s,a){this.url=e,this.headers=n,this.bucketId=s,this.fetch=yD(a)}uploadOrUpdate(e,n,s,a){return Kr(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},OS),a);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",this.encodeMetadata(d)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",this.encodeMetadata(d))):(i=s,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const u=this._removeEmptyFolders(n),m=this._getFinalPath(u),f=yield this.fetch(`${this.url}/object/${m}`,Object.assign({method:e,body:i,headers:c},o!=null&&o.duplex?{duplex:o.duplex}:{})),p=yield f.json();return f.ok?{data:{path:u,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(i){if(nr(i))return{data:null,error:i};throw i}})}upload(e,n,s){return Kr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,s)})}uploadToSignedUrl(e,n,s,a){return Kr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${o}`);c.searchParams.set("token",n);try{let d;const u=Object.assign({upsert:OS.upsert},a),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&s instanceof Blob?(d=new FormData,d.append("cacheControl",u.cacheControl),d.append("",s)):typeof FormData<"u"&&s instanceof FormData?(d=s,d.append("cacheControl",u.cacheControl)):(d=s,m["cache-control"]=`max-age=${u.cacheControl}`,m["content-type"]=u.contentType);const f=yield this.fetch(c.toString(),{method:"PUT",body:d,headers:m}),p=yield f.json();return f.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(d){if(nr(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,n){return Kr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const i=yield Gi(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:a}),o=new URL(this.url+i.url),c=o.searchParams.get("token");if(!c)throw new cj("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:c},error:null}}catch(s){if(nr(s))return{data:null,error:s};throw s}})}update(e,n,s){return Kr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,s)})}move(e,n,s){return Kr(this,void 0,void 0,function*(){try{return{data:yield Gi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(nr(a))return{data:null,error:a};throw a}})}copy(e,n,s){return Kr(this,void 0,void 0,function*(){try{return{data:{path:(yield Gi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(nr(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,s){return Kr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield Gi(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(nr(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,s){return Kr(this,void 0,void 0,function*(){try{const a=yield Gi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(nr(a))return{data:null,error:a};throw a}})}download(e,n){return Kr(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=i?`?${i}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield s0(this.fetch,`${this.url}/${a}/${c}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(nr(c))return{data:null,error:c};throw c}})}info(e){return Kr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const s=yield s0(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Y_(s),error:null}}catch(s){if(nr(s))return{data:null,error:s};throw s}})}exists(e){return Kr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield uU(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(nr(s)&&s instanceof Q_){const a=s.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,n){const s=this._getFinalPath(e),a=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&a.push(i);const c=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});d!==""&&a.push(d);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${s}${u}`)}}}remove(e){return Kr(this,void 0,void 0,function*(){try{return{data:yield _D(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(nr(n))return{data:null,error:n};throw n}})}list(e,n,s){return Kr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},hU),n),{prefix:e||""});return{data:yield Gi(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){if(nr(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const mU="2.7.1",pU={"X-Client-Info":`storage-js/${mU}`};var oc=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(s.next(m))}catch(f){o(f)}}function d(m){try{u(s.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((s=s.apply(t,e||[])).next())})};class gU{constructor(e,n={},s){this.url=e,this.headers=Object.assign(Object.assign({},pU),n),this.fetch=yD(s)}listBuckets(){return oc(this,void 0,void 0,function*(){try{return{data:yield s0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(nr(e))return{data:null,error:e};throw e}})}getBucket(e){return oc(this,void 0,void 0,function*(){try{return{data:yield s0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(nr(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return oc(this,void 0,void 0,function*(){try{return{data:yield Gi(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(nr(s))return{data:null,error:s};throw s}})}updateBucket(e,n){return oc(this,void 0,void 0,function*(){try{return{data:yield dU(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(nr(s))return{data:null,error:s};throw s}})}emptyBucket(e){return oc(this,void 0,void 0,function*(){try{return{data:yield Gi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(nr(n))return{data:null,error:n};throw n}})}deleteBucket(e){return oc(this,void 0,void 0,function*(){try{return{data:yield _D(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(nr(n))return{data:null,error:n};throw n}})}}class xU extends gU{constructor(e,n={},s){super(e,n,s)}from(e){return new fU(this.url,this.headers,e,this.fetch)}}const vU="2.50.3";let ku="";typeof Deno<"u"?ku="deno":typeof document<"u"?ku="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ku="react-native":ku="node";const yU={"X-Client-Info":`supabase-js-${ku}/${vU}`},_U={headers:yU},wU={schema:"public"},bU={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jU={};var NU=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(s.next(m))}catch(f){o(f)}}function d(m){try{u(s.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((s=s.apply(t,e||[])).next())})};const SU=t=>{let e;return t?e=t:typeof fetch>"u"?e=sD:e=fetch,(...n)=>e(...n)},kU=()=>typeof Headers>"u"?aD:Headers,CU=(t,e,n)=>{const s=SU(n),a=kU();return(i,o)=>NU(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:t;let u=new a(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${d}`),s(i,Object.assign(Object.assign({},o),{headers:u}))})};var EU=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(s.next(m))}catch(f){o(f)}}function d(m){try{u(s.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((s=s.apply(t,e||[])).next())})};function AU(t){return t.endsWith("/")?t:t+"/"}function PU(t,e){var n,s;const{db:a,auth:i,realtime:o,global:c}=t,{db:d,auth:u,realtime:m,global:f}=e,p={db:Object.assign(Object.assign({},d),a),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},m),o),global:Object.assign(Object.assign(Object.assign({},f),c),{headers:Object.assign(Object.assign({},(n=f==null?void 0:f.headers)!==null&&n!==void 0?n:{}),(s=c==null?void 0:c.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>EU(this,void 0,void 0,function*(){return""})};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}const wD="2.70.0",yc=30*1e3,X_=3,sv=X_*yc,DU="http://localhost:9999",TU="supabase.auth.token",MU={"X-Client-Info":`gotrue-js/${wD}`},J_="X-Supabase-Api-Version",bD={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},RU=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,IU=6e5;class dj extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function Dt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class OU extends dj{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function LU(t){return Dt(t)&&t.name==="AuthApiError"}class jD extends dj{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class qo extends dj{constructor(e,n,s,a){super(e,s,a),this.name=n,this.status=s}}class Ui extends qo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function FU(t){return Dt(t)&&t.name==="AuthSessionMissingError"}class Nm extends qo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Sm extends qo{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class km extends qo{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function BU(t){return Dt(t)&&t.name==="AuthImplicitGrantRedirectError"}class LS extends qo{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ew extends qo{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function av(t){return Dt(t)&&t.name==="AuthRetryableFetchError"}class FS extends qo{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class nh extends qo{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const a0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),BS=` 	
\r=`.split(""),zU=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<BS.length;e+=1)t[BS[e].charCodeAt(0)]=-2;for(let e=0;e<a0.length;e+=1)t[a0[e].charCodeAt(0)]=e;return t})();function zS(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(a0[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(a0[s]),e.queuedBits-=6}}function ND(t,e,n){const s=zU[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function $S(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{qU(o,s,n)};for(let o=0;o<t.length;o+=1)ND(t.charCodeAt(o),a,i);return e.join("")}function $U(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function UU(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}$U(s,e)}}function qU(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function WU(t){const e=[],n={queue:0,queuedBits:0},s=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)ND(t.charCodeAt(a),n,s);return new Uint8Array(e)}function HU(t){const e=[];return UU(t,n=>e.push(n)),new Uint8Array(e)}function VU(t){const e=[],n={queue:0,queuedBits:0},s=a=>{e.push(a)};return t.forEach(a=>zS(a,n,s)),zS(null,n,s),e.join("")}function KU(t){return Math.round(Date.now()/1e3)+t}function ZU(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Ks=()=>typeof window<"u"&&typeof document<"u",el={tested:!1,writable:!1},rh=()=>{if(!Ks())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(el.tested)return el.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),el.tested=!0,el.writable=!0}catch{el.tested=!0,el.writable=!1}return el.writable};function GU(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return n.searchParams.forEach((s,a)=>{e[a]=s}),e}const SD=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>$d(async()=>{const{default:s}=await Promise.resolve().then(()=>Ud);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},QU=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",kD=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Cm=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Em=async(t,e)=>{await t.removeItem(e)};class fg{constructor(){this.promise=new fg.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}fg.promiseConstructor=Promise;function iv(t){const e=t.split(".");if(e.length!==3)throw new nh("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!RU.test(e[s]))throw new nh("JWT not in base64url format");return{header:JSON.parse($S(e[0])),payload:JSON.parse($S(e[1])),signature:WU(e[2]),raw:{header:e[0],payload:e[1]}}}async function YU(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function XU(t,e){return new Promise((s,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function JU(t){return("0"+t.toString(16)).substr(-2)}function eq(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let a="";for(let i=0;i<56;i++)a+=n.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(e),Array.from(e,JU).join("")}async function tq(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(s);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function nq(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await tq(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function lc(t,e,n=!1){const s=eq();let a=s;n&&(a+="/PASSWORD_RECOVERY"),await kD(t,`${e}-code-verifier`,a);const i=await nq(s);return[i,s===i?"plain":"s256"]}const rq=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function sq(t){const e=t.headers.get(J_);if(!e||!e.match(rq))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function aq(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function iq(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const oq=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function cc(t){if(!oq.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var lq=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n};const sl=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),cq=[502,503,504];async function US(t){var e;if(!QU(t))throw new ew(sl(t),0);if(cq.includes(t.status))throw new ew(sl(t),t.status);let n;try{n=await t.json()}catch(i){throw new jD(sl(i),i)}let s;const a=sq(t);if(a&&a.getTime()>=bD["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new FS(sl(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Ui}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new FS(sl(n),t.status,n.weak_password.reasons);throw new OU(sl(n),t.status||500,s)}const dq=(t,e,n,s)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),n))};async function Wt(t,e,n,s){var a;const i=Object.assign({},s==null?void 0:s.headers);i[J_]||(i[J_]=bD["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(a=s==null?void 0:s.query)!==null&&a!==void 0?a:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await uq(t,e,n+c,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(d):{data:Object.assign({},d),error:null}}async function uq(t,e,n,s,a,i){const o=dq(e,s,a,i);let c;try{c=await t(n,Object.assign({},o))}catch(d){throw console.error(d),new ew(sl(d),0)}if(c.ok||await US(c),s!=null&&s.noResolveJson)return c;try{return await c.json()}catch(d){await US(d)}}function li(t){var e;let n=null;pq(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=KU(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function qS(t){const e=li(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Xi(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function hq(t){return{data:t,error:null}}function fq(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:a,verification_type:i}=t,o=lq(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:n,hashed_token:s,redirect_to:a,verification_type:i},d=Object.assign({},o);return{data:{properties:c,user:d},error:null}}function mq(t){return t}function pq(t){return t.access_token&&t.refresh_token&&t.expires_in}const ov=["global","local","others"];var gq=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n};class xq{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=SD(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=ov[0]){if(ov.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ov.join(", ")}`);try{return await Wt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Dt(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await Wt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Xi})}catch(s){if(Dt(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=gq(e,["options"]),a=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(a.new_email=s==null?void 0:s.newEmail,delete a.newEmail),await Wt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:fq,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Dt(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Wt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Xi})}catch(n){if(Dt(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,a,i,o,c,d;try{const u={nextPage:null,lastPage:0,total:0},m=await Wt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:mq});if(m.error)throw m.error;const f=await m.json(),p=(o=m.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(d=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return y.length>0&&(y.forEach(j=>{const v=parseInt(j.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(j.split(";")[1].split("=")[1]);u[`${_}Page`]=v}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Dt(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){cc(e);try{return await Wt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Xi})}catch(n){if(Dt(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){cc(e);try{return await Wt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Xi})}catch(s){if(Dt(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){cc(e);try{return await Wt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Xi})}catch(s){if(Dt(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){cc(e.userId);try{const{data:n,error:s}=await Wt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:s}}catch(n){if(Dt(n))return{data:null,error:n};throw n}}async _deleteFactor(e){cc(e.userId),cc(e.id);try{return{data:await Wt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Dt(n))return{data:null,error:n};throw n}}}const vq={getItem:t=>rh()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{rh()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{rh()&&globalThis.localStorage.removeItem(t)}};function WS(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function yq(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const dc={debug:!!(globalThis&&rh()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class CD extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class _q extends CD{}async function wq(t,e,n){dc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),dc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){dc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{dc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw dc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new _q(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(dc.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}yq();const bq={url:DU,storageKey:TU,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:MU,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function HS(t,e,n){return await n()}class Dh{constructor(e){var n,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Dh.nextInstanceID,Dh.nextInstanceID+=1,this.instanceID>0&&Ks()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},bq),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new xq({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=SD(a.fetch),this.lock=a.lock||HS,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Ks()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=wq:this.lock=HS,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:rh()?this.storage=vq:(this.memoryStorage={},this.storage=WS(this.memoryStorage)):(this.memoryStorage={},this.storage=WS(this.memoryStorage)),Ks()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${wD}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=GU(window.location.href);let s="none";if(this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce"),Ks()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:i}=await this._getSessionFromURL(n,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),BU(i)){const d=(e=i.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Dt(n)?{error:n}:{error:new jD("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,a;try{const i=await Wt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:li}),{data:o,error:c}=i;if(c||!o)return{data:{user:null,session:null},error:c};const d=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:u,session:d},error:null}}catch(i){if(Dt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,s,a;try{let i;if("email"in e){const{email:m,password:f,options:p}=e;let y=null,j=null;this.flowType==="pkce"&&([y,j]=await lc(this.storage,this.storageKey)),i=await Wt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:m,password:f,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:y,code_challenge_method:j},xform:li})}else if("phone"in e){const{phone:m,password:f,options:p}=e;i=await Wt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:f,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},channel:(a=p==null?void 0:p.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:li})}else throw new Sm("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return{data:{user:null,session:null},error:c};const d=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:u,session:d},error:null}}catch(i){if(Dt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:c}=e;n=await Wt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:qS})}else if("phone"in e){const{phone:i,password:o,options:c}=e;n=await Wt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:qS})}else throw new Sm("You must provide either an email or phone number and a password");const{data:s,error:a}=n;return a?{data:{user:null,session:null},error:a}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Nm}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(n){if(Dt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,s,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,s,a,i,o,c,d,u,m,f,p,y;let j,v;if("message"in e)j=e.message,v=e.signature;else{const{chain:_,wallet:b,statement:w,options:N}=e;let S;if(Ks())if(typeof b=="object")S=b;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))S=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=b}const A=new URL((n=N==null?void 0:N.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in S&&S.signIn){const E=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:A.host,uri:A.href}),w?{statement:w}:null));let D;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")D=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)D=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)j=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),v=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");j=[`${A.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${A.href}`,`Issued At: ${(a=(s=N==null?void 0:N.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=N==null?void 0:N.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((o=N==null?void 0:N.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((c=N==null?void 0:N.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((d=N==null?void 0:N.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((u=N==null?void 0:N.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((f=(m=N==null?void 0:N.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||f===void 0)&&f.length?["Resources",...N.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const E=await S.signMessage(new TextEncoder().encode(j),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=E}}try{const{data:_,error:b}=await Wt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:j,signature:VU(v)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:li});if(b)throw b;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new Nm}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:b})}catch(_){if(Dt(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const n=await Cm(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(n??"").split("/");try{const{data:i,error:o}=await Wt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:li});if(await Em(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Nm}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(Dt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:s,token:a,access_token:i,nonce:o}=e,c=await Wt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:li}),{data:d,error:u}=c;return u?{data:{user:null,session:null},error:u}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new Nm}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:u})}catch(n){if(Dt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,s,a,i,o;try{if("email"in e){const{email:c,options:d}=e;let u=null,m=null;this.flowType==="pkce"&&([u,m]=await lc(this.storage,this.storageKey));const{error:f}=await Wt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(s=d==null?void 0:d.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:u,code_challenge_method:m},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:c,options:d}=e,{data:u,error:m}=await Wt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(o=d==null?void 0:d.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:m}}throw new Sm("You must provide either an email or phone number.")}catch(c){if(Dt(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var n,s;try{let a,i;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:c}=await Wt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:li});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,u=o.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:u,session:d},error:null}}catch(a){if(Dt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,s,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await lc(this.storage,this.storageKey)),await Wt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:hq})}catch(i){if(Dt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new Ui;const{error:a}=await Wt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(Dt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:a,options:i}=e,{error:o}=await Wt(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:a,options:i}=e,{data:o,error:c}=await Wt(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:c}}throw new Sm("You must provide either an email or phone number and a type")}catch(n){if(Dt(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Cm(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<sv:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,u,m)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,u,m))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Wt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Xi}):await this._useSession(async n=>{var s,a,i;const{data:o,error:c}=n;if(c)throw c;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ui}:await Wt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Xi})})}catch(n){if(Dt(n))return FU(n)&&(await this._removeSession(),await Em(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:a,error:i}=s;if(i)throw i;if(!a.session)throw new Ui;const o=a.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await lc(this.storage,this.storageKey));const{data:u,error:m}=await Wt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:o.access_token,xform:Xi});if(m)throw m;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(Dt(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ui;const n=Date.now()/1e3;let s=n,a=!0,i=null;const{payload:o}=iv(e.access_token);if(o.exp&&(s=o.exp,a=s<=n),a){const{session:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;i={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(Dt(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:o,error:c}=n;if(c)throw c;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Ui;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Dt(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Ks())throw new km("No browser detected.");if(e.error||e.error_description||e.error_code)throw new km(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new LS("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new km("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new LS("No code detected.");const{data:w,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:c,expires_at:d,token_type:u}=e;if(!i||!c||!o||!u)throw new km("No session defined in URL");const m=Math.round(Date.now()/1e3),f=parseInt(c);let p=m+f;d&&(p=parseInt(d));const y=p-m;y*1e3<=yc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${f}s`);const j=p-f;m-j>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",j,p,m):m-j<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",j,p,m);const{data:v,error:_}=await this._getUser(i);if(_)throw _;const b={provider_token:s,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:p,refresh_token:o,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(s){if(Dt(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Cm(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:a,error:i}=n;if(i)return{error:i};const o=(s=a.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:c}=await this.admin.signOut(o,e);if(c&&!(LU(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await Em(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=ZU(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,a;try{const{data:{session:i},error:o}=n;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await lc(this.storage,this.storageKey,!0));try{return await Wt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(Dt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Dt(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:s,error:a}=await this._useSession(async i=>{var o,c,d,u,m;const{data:f,error:p}=i;if(p)throw p;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Wt(this.fetch,"GET",y,{headers:this.headers,jwt:(m=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&m!==void 0?m:void 0})});if(a)throw a;return Ks()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(Dt(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,a;const{data:i,error:o}=n;if(o)throw o;return await Wt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(Dt(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await XU(async a=>(a>0&&await YU(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Wt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:li})),(a,i)=>{const o=200*Math.pow(2,a);return i&&av(i)&&Date.now()+o-s<yc})}catch(s){if(this._debug(n,"error",s),Dt(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),Ks()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Cm(this.storage,this.storageKey);if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<sv;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${sv}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),av(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new Ui;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new fg;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Ui;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={session:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(a,"error",i),Dt(i)){const o={session:null,error:i};return av(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,s=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,n)}catch(d){i.push(d)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await kD(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Em(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ks()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),yc);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-e)/yc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${yc}ms, refresh threshold is ${X_} ticks`),a<=X_&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof CD)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ks()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const a=[`provider=${encodeURIComponent(n)}`];if(s!=null&&s.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await lc(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(c.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);a.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:a,error:i}=n;return i?{data:null,error:i}:await Wt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Dt(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,a;const{data:i,error:o}=n;if(o)return{data:null,error:o};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:u}=await Wt(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((a=d==null?void 0:d.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(n){if(Dt(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:a,error:i}=n;if(i)return{data:null,error:i};const{data:o,error:c}=await Wt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:c})})}catch(n){if(Dt(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:a,error:i}=n;return i?{data:null,error:i}:await Wt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(Dt(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const s=(e==null?void 0:e.factors)||[],a=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,s;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=iv(a.access_token);let c=null;o.aal&&(c=o.aal);let d=c;((s=(n=a.user.factors)===null||n===void 0?void 0:n.filter(f=>f.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(d="aal2");const m=o.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:m},error:null}}))}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(o=>o.kid===e);if(s||(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+IU>Date.now()))return s;const{data:a,error:i}=await Wt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new nh("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),s=a.keys.find(o=>o.kid===e),!s)throw new nh("No matching signing key found in JWKS");return s}async getClaims(e,n={keys:[]}){try{let s=e;if(!s){const{data:y,error:j}=await this.getSession();if(j||!y.session)return{data:null,error:j};s=y.session.access_token}const{header:a,payload:i,signature:o,raw:{header:c,payload:d}}=iv(s);if(aq(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:y}=await this.getUser(s);if(y)throw y;return{data:{claims:i,header:a,signature:o},error:null}}const u=iq(a.alg),m=await this.fetchJwk(a.kid,n),f=await crypto.subtle.importKey("jwk",m,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,o,HU(`${c}.${d}`)))throw new nh("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(s){if(Dt(s))return{data:null,error:s};throw s}}}Dh.nextInstanceID=0;const jq=Dh;class Nq extends jq{constructor(e){super(e)}}var Sq=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(s.next(m))}catch(f){o(f)}}function d(m){try{u(s.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((s=s.apply(t,e||[])).next())})};class kq{constructor(e,n,s){var a,i,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const c=AU(e),d=new URL(c);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const u=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:wU,realtime:jU,auth:Object.assign(Object.assign({},bU),{storageKey:u}),global:_U},f=PU(s??{},m);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(p,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=f.auth)!==null&&o!==void 0?o:{},this.headers,f.global.fetch),this.fetch=CU(n,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new q7(new URL("rest/v1",d).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new y7(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new xU(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},s={}){return this.rest.rpc(e,n,s)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Sq(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(n=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:a,storageKey:i,flowType:o,lock:c,debug:d},u,m){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Nq({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:a,flowType:o,lock:c,debug:d,fetch:m,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new sU(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,s)=>{this._handleTokenChanged(n,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,n,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Cq=(t,e,n)=>new kq(t,e,n),Eq="https://qgwhkjrhndeoskrxewpb.supabase.co",Aq="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFnd2hranJobmRlb3Nrcnhld3BiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1NTExODAsImV4cCI6MjA2NzEyNzE4MH0.eSPBRJKIBd9oiXqfo8vrbmMCl6QByxnVgHqtgofDGtg",K=Cq(Eq,Aq,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{"X-Client-Info":"handwerkos-app"}}}),ED=g.createContext(void 0);function Pq({children:t}){const[e,n]=g.useState(null),[s,a]=g.useState(null),[i,o]=g.useState(null),[c,d]=g.useState(null),[u,m]=g.useState(!0),f=i==="manager",p=f,y=async b=>{try{const{data:w,error:N}=await K.from("user_roles").select("role").eq("user_id",b).single();N?(console.warn("Role fetch error, default to employee:",N),o("employee")):o((w==null?void 0:w.role)??"employee");const{data:S,error:A}=await K.from("profiles").select("company_id").eq("id",b).single();A?(console.warn("Profile fetch error:",A),d(null)):d((S==null?void 0:S.company_id)??null)}catch(w){console.error("Error fetching user data:",w)}};g.useEffect(()=>{K.auth.getSession().then(({data:w})=>{var N,S;a(w.session),n(((N=w.session)==null?void 0:N.user)??null),(S=w.session)!=null&&S.user&&y(w.session.user.id),m(!1)});const{data:{subscription:b}}=K.auth.onAuthStateChange((w,N)=>{a(N),n((N==null?void 0:N.user)??null),N!=null&&N.user?y(N.user.id):(o(null),d(null)),m(!1)});return()=>b.unsubscribe()},[]);const j=async()=>{n(null),a(null),o(null),d(null),await K.auth.signOut()},v=async(b,w)=>{if(!e||!f||!c)return{success:!1,error:"Keine Berechtigung zum Einladen von Mitarbeitern"};try{console.log("Creating Supabase invitation for employee:",b);const N=crypto.randomUUID(),S=new Date;S.setDate(S.getDate()+7);const{error:A}=await K.from("employee_invitations").insert({email:b.toLowerCase(),invited_by:e.id,company_id:c,invite_token:N,expires_at:S.toISOString(),employee_data:w,status:"pending"});if(A)return console.error("Error creating invitation:",A),{success:!1,error:"Fehler beim Erstellen der Einladung"};const{error:E}=await K.from("employees").upsert({email:b.toLowerCase(),first_name:w.firstName,last_name:w.lastName,position:w.position,phone:w.phone,qualifications:Array.isArray(w.qualifications)?w.qualifications:[],license:w.license||"",company_id:c,status:"eingeladen"});if(E)return console.error("Error creating employee:",E),{success:!1,error:"Fehler beim Erstellen des Mitarbeiters"};const D=`${window.location.origin}/mitarbeiter-setup?token=${N}`,{data:M}=await K.from("profiles").select("email, first_name, last_name").eq("id",e.id).single(),{data:B}=await K.from("companies").select("name").eq("id",c).single();try{const{error:R}=await K.functions.invoke("send-welcome-email",{body:{employeeEmail:b,employeeName:`${w.firstName} ${w.lastName}`,loginUrl:D}});if(R)throw console.warn("Welcome email failed, trying fallback:",R),R;console.log("Professional welcome email sent successfully")}catch{const{error:P}=await K.functions.invoke("send-employee-confirmation",{body:{managerEmail:(M==null?void 0:M.email)||e.email,employeeName:`${w.firstName} ${w.lastName}`,employeeEmail:b,companyName:(B==null?void 0:B.name)||"Ihrem Unternehmen",registrationUrl:D}});P&&console.error("Email sending error:",P)}return{success:!0}}catch(N){return console.error("Invitation error:",N),{success:!1,error:N instanceof Error?N.message:"Unbekannter Fehler bei der Einladung"}}},_=async(b,w)=>{if(!f)return{success:!1,error:"Keine Berechtigung"};try{const{error:N}=await K.from("user_roles").upsert({user_id:b,role:w});if(N)throw N;return{success:!0}}catch(N){return{success:!1,error:N instanceof Error?N.message:"Rolle konnte nicht aktualisiert werden"}}};return r.jsx(ED.Provider,{value:{user:e,session:s,userRole:i,loading:u,isManager:f,canInviteMembers:p,companyId:c,signOut:j,inviteEmployee:v,updateMemberRole:_},children:t})}function Di(){const t=g.useContext(ED);if(!t)throw new Error("useSupabaseAuth must be used within SupabaseAuthProvider");return t}const tw=uf("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),J=g.forwardRef(({className:t,variant:e,size:n,asChild:s=!1,...a},i)=>{const o=s?ji:"button";return r.jsx(o,{className:Oe(tw({variant:e,size:n,className:t})),ref:i,...a})});J.displayName="Button";const Dq=uf("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ve({className:t,variant:e,...n}){return r.jsx("div",{className:Oe(Dq({variant:e}),t),...n})}const AD=g.createContext(void 0);function Tq({children:t}){const[e,n]=g.useState(null),[s,a]=g.useState(null),[i,o]=g.useState(null),[c,d]=g.useState(!0),u=async j=>{const{data:v,error:_}=await K.from("user_roles").select("role").eq("user_id",j).single();_?(console.warn("Role fetch error, default to employee:",_),o("employee")):o((v==null?void 0:v.role)??"employee")};g.useEffect(()=>{K.auth.getSession().then(({data:v})=>{var _,b;a(v.session),n(((_=v.session)==null?void 0:_.user)??null),(b=v.session)!=null&&b.user&&u(v.session.user.id),d(!1)});const{data:{subscription:j}}=K.auth.onAuthStateChange((v,_)=>{console.log("Auth state changed:",v,_),a(_),n((_==null?void 0:_.user)??null),_!=null&&_.user?u(_.user.id):o(null)});return()=>{j.unsubscribe()}},[]);const m=(j,v)=>K.auth.signInWithPassword({email:j,password:v}),f=(j,v,_)=>{const b=`${window.location.origin}/auth?mode=employee-setup`;return K.auth.signUp({email:j,password:v,options:{emailRedirectTo:b,data:{first_name:_.firstName,last_name:_.lastName,company_name:_.companyName,phone:_.phone,street_address:_.streetAddress,postal_code:_.postalCode,city:_.city,country:_.country,vat_id:_.vatId,voucher_code:_.voucherCode,referral_source:_.referralSource}}})},p=j=>K.auth.updateUser({password:j}),y=async()=>{n(null),a(null),o(null),await K.auth.signOut()};return r.jsx(AD.Provider,{value:{user:e,session:s,userRole:i,loading:c,signIn:m,signUp:f,signOut:y,updatePassword:p},children:t})}function mg(){const t=g.useContext(AD);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}const Mq=[{id:"dashboard",name:"Dashboard",icon:Ao,color:"text-blue-500"},{id:"stammdaten",name:"Stammdaten",icon:zF,color:"text-gray-500",children:[{id:"customers",name:"Kunden & Aufträge",icon:Si,color:"text-green-500"},{id:"personal",name:"Personal",icon:mf,color:"text-purple-500"}]},{id:"projects",name:"Projekte & Baustellen",icon:fa,color:"text-orange-500"},{id:"timetracking",name:"Zeiterfassung",icon:hn,color:"text-yellow-500"},{id:"vacation",name:"Urlaubsverwaltung",icon:YF,color:"text-sky-500"},{id:"emails",name:"E-Mails",icon:sr,color:"text-pink-500"},{id:"documents",name:"Dokumente",icon:ms,color:"text-emerald-500"},{id:"invoice-validation",name:"Rechnungs-Validierung",icon:On,color:"text-amber-500"},{id:"materials",name:"Material",icon:Ni,color:"text-red-500"},{id:"machines",name:"Maschinen & Geräte",icon:Eo,color:"text-indigo-500"},{id:"finance",name:"Finanzen",icon:ra,color:"text-cyan-500"},{id:"planner",name:"Planer",icon:zt,color:"text-teal-500"},{id:"company-settings",name:"Firmeneinstellungen",icon:Eo,color:"text-gray-600"}];function Rq({activeModule:t,onModuleChange:e}){const{signOut:n}=mg(),s=Pi(),[a,i]=g.useState(!1),[o,c]=g.useState(null),[d,u]=g.useState(["stammdaten"]),m=async()=>{try{await n(),s("/auth"),Ma({title:"Erfolgreich abgemeldet",description:"Sie wurden erfolgreich abgemeldet."})}catch{Ma({title:"Fehler beim Abmelden",description:"Es ist ein Fehler aufgetreten.",variant:"destructive"})}},f=a;g.useEffect(()=>{f||u([])},[f]);const p=y=>{u(j=>j.includes(y)?j.filter(v=>v!==y):[...j,y])};return r.jsxs("div",{className:`fixed left-0 top-0 h-full z-50 transition-all duration-500 ease-in-out ${f?"w-64":"w-16"} 
      bg-gradient-to-b from-blue-900 via-blue-800 to-blue-950 shadow-2xl`,onMouseEnter:()=>{o&&clearTimeout(o);const y=setTimeout(()=>i(!0),150);c(y)},onMouseLeave:()=>{o&&clearTimeout(o),i(!1),u([])},children:[r.jsx("div",{className:"p-4 border-b border-blue-600/30",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-8 w-8 rounded-lg bg-white/20 backdrop-blur-sm flex items-center justify-center border border-white/30",children:r.jsx("span",{className:"text-white font-bold text-sm",children:"H"})}),r.jsx("span",{className:`font-bold text-white transition-all duration-300 ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:"HandwerkOS"})]})}),r.jsxs("div",{className:"flex flex-col h-full",children:[r.jsx("div",{className:"flex-1 p-3",children:r.jsx("div",{className:"space-y-2",children:Mq.map(y=>r.jsx("div",{children:y.children?r.jsxs("div",{children:[r.jsxs("button",{onClick:()=>p(y.id),className:`group w-full flex items-center p-3 rounded-lg transition-all duration-300 relative 
                      text-white/80 hover:text-white hover:bg-white/10 backdrop-blur-sm`,title:f?void 0:y.name,children:[r.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:r.jsx(y.icon,{className:`h-5 w-5 ${y.color} group-hover:scale-110 transition-transform duration-200`})}),r.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:y.name}),f&&r.jsx("div",{className:"ml-auto",children:d.includes(y.id)?r.jsx(Y0,{className:"h-4 w-4 text-white/60 group-hover:text-white transition-colors duration-200"}):r.jsx(jl,{className:"h-4 w-4 text-white/60 group-hover:text-white transition-colors duration-200"})})]}),d.includes(y.id)&&f&&r.jsx("div",{className:"ml-6 mt-1 space-y-1",children:y.children.map(j=>r.jsxs("button",{onClick:()=>e(j.id),className:`group w-full flex items-center p-2.5 rounded-lg transition-all duration-200 text-sm ${t===j.id?"bg-white/20 text-white shadow-lg backdrop-blur-sm border border-white/30":"text-white/70 hover:text-white hover:bg-white/10"}`,children:[r.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:r.jsx(j.icon,{className:`h-4 w-4 ${j.color} group-hover:scale-110 transition-transform duration-200`})}),r.jsx("span",{className:"ml-2 whitespace-nowrap font-medium",children:j.name}),t===j.id&&r.jsx("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-white animate-pulse"})]},j.id))})]}):r.jsxs("button",{onClick:()=>e(y.id),className:`group w-full flex items-center p-3 rounded-lg transition-all duration-300 relative ${t===y.id?"bg-white/20 text-white shadow-lg backdrop-blur-sm border border-white/30":"text-white/80 hover:text-white hover:bg-white/10"}`,title:f?void 0:y.name,children:[r.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:r.jsx(y.icon,{className:`h-5 w-5 ${y.color} group-hover:scale-110 transition-transform duration-200`})}),r.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:y.name}),t===y.id&&r.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-white/50 rounded-l-full"})]})},y.id))})}),r.jsx("div",{className:"p-3 border-t border-blue-600/30",children:r.jsxs("button",{onClick:m,className:"group w-full flex items-center p-3 rounded-lg text-white/80 hover:text-white hover:bg-red-500/20 transition-all duration-300 relative",title:f?void 0:"Abmelden",children:[r.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:r.jsx(VF,{className:"h-5 w-5 group-hover:scale-110 transition-transform duration-200"})}),r.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:"Abmelden"})]})})]})]})}const le=g.forwardRef(({className:t,...e},n)=>r.jsx("div",{ref:n,className:Oe("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));le.displayName="Card";const Ce=g.forwardRef(({className:t,...e},n)=>r.jsx("div",{ref:n,className:Oe("flex flex-col space-y-1.5 p-6",t),...e}));Ce.displayName="CardHeader";const Ee=g.forwardRef(({className:t,...e},n)=>r.jsx("h3",{ref:n,className:Oe("text-2xl font-semibold leading-none tracking-tight",t),...e}));Ee.displayName="CardTitle";const Sr=g.forwardRef(({className:t,...e},n)=>r.jsx("p",{ref:n,className:Oe("text-sm text-muted-foreground",t),...e}));Sr.displayName="CardDescription";const ce=g.forwardRef(({className:t,...e},n)=>r.jsx("div",{ref:n,className:Oe("p-6 pt-0",t),...e}));ce.displayName="CardContent";const Iq=g.forwardRef(({className:t,...e},n)=>r.jsx("div",{ref:n,className:Oe("flex items-center p-6 pt-0",t),...e}));Iq.displayName="CardFooter";const ne=g.forwardRef(({className:t,type:e,...n},s)=>r.jsx("input",{type:e,className:Oe("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...n}));ne.displayName="Input";var Oq="Label",PD=g.forwardRef((t,e)=>r.jsx(Xe.label,{...t,ref:e,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=t.onMouseDown)==null||a.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));PD.displayName=Oq;var DD=PD;const Lq=uf("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Y=g.forwardRef(({className:t,...e},n)=>r.jsx(DD,{ref:n,className:Oe(Lq(),t),...e}));Y.displayName=DD.displayName;function Fq(t,e=[]){let n=[];function s(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:y,...j}=f,v=(p==null?void 0:p[t][d])||c,_=g.useMemo(()=>j,Object.values(j));return r.jsx(v.Provider,{value:_,children:y})}function m(f,p){const y=(p==null?void 0:p[t][d])||c,j=g.useContext(y);if(j)return j;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[s,Bq(a,...e)]}function Bq(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var zq=g.createContext(void 0);function Wd(t){const e=g.useContext(zq);return t||e||"ltr"}var lv="rovingFocusGroup.onEntryFocus",$q={bubbles:!1,cancelable:!0},pg="RovingFocusGroup",[nw,TD,Uq]=cf(pg),[qq,gg]=Fq(pg,[Uq]),[Wq,Hq]=qq(pg),MD=g.forwardRef((t,e)=>r.jsx(nw.Provider,{scope:t.__scopeRovingFocusGroup,children:r.jsx(nw.Slot,{scope:t.__scopeRovingFocusGroup,children:r.jsx(Vq,{...t,ref:e})})}));MD.displayName=pg;var Vq=g.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:d,onEntryFocus:u,preventScrollOnEntryFocus:m=!1,...f}=t,p=g.useRef(null),y=Mt(e,p),j=Wd(i),[v=null,_]=zs({prop:o,defaultProp:c,onChange:d}),[b,w]=g.useState(!1),N=jn(u),S=TD(n),A=g.useRef(!1),[E,D]=g.useState(0);return g.useEffect(()=>{const M=p.current;if(M)return M.addEventListener(lv,N),()=>M.removeEventListener(lv,N)},[N]),r.jsx(Wq,{scope:n,orientation:s,dir:j,loop:a,currentTabStopId:v,onItemFocus:g.useCallback(M=>_(M),[_]),onItemShiftTab:g.useCallback(()=>w(!0),[]),onFocusableItemAdd:g.useCallback(()=>D(M=>M+1),[]),onFocusableItemRemove:g.useCallback(()=>D(M=>M-1),[]),children:r.jsx(Xe.div,{tabIndex:b||E===0?-1:0,"data-orientation":s,...f,ref:y,style:{outline:"none",...t.style},onMouseDown:Te(t.onMouseDown,()=>{A.current=!0}),onFocus:Te(t.onFocus,M=>{const B=!A.current;if(M.target===M.currentTarget&&B&&!b){const R=new CustomEvent(lv,$q);if(M.currentTarget.dispatchEvent(R),!R.defaultPrevented){const P=S().filter(de=>de.focusable),F=P.find(de=>de.active),W=P.find(de=>de.id===v),ue=[F,W,...P].filter(Boolean).map(de=>de.ref.current);OD(ue,m)}}A.current=!1}),onBlur:Te(t.onBlur,()=>w(!1))})})}),RD="RovingFocusGroupItem",ID=g.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:a=!1,tabStopId:i,...o}=t,c=ps(),d=i||c,u=Hq(RD,n),m=u.currentTabStopId===d,f=TD(n),{onFocusableItemAdd:p,onFocusableItemRemove:y}=u;return g.useEffect(()=>{if(s)return p(),()=>y()},[s,p,y]),r.jsx(nw.ItemSlot,{scope:n,id:d,focusable:s,active:a,children:r.jsx(Xe.span,{tabIndex:m?0:-1,"data-orientation":u.orientation,...o,ref:e,onMouseDown:Te(t.onMouseDown,j=>{s?u.onItemFocus(d):j.preventDefault()}),onFocus:Te(t.onFocus,()=>u.onItemFocus(d)),onKeyDown:Te(t.onKeyDown,j=>{if(j.key==="Tab"&&j.shiftKey){u.onItemShiftTab();return}if(j.target!==j.currentTarget)return;const v=Gq(j,u.orientation,u.dir);if(v!==void 0){if(j.metaKey||j.ctrlKey||j.altKey||j.shiftKey)return;j.preventDefault();let b=f().filter(w=>w.focusable).map(w=>w.ref.current);if(v==="last")b.reverse();else if(v==="prev"||v==="next"){v==="prev"&&b.reverse();const w=b.indexOf(j.currentTarget);b=u.loop?Qq(b,w+1):b.slice(w+1)}setTimeout(()=>OD(b))}})})})});ID.displayName=RD;var Kq={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Zq(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Gq(t,e,n){const s=Zq(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return Kq[s]}function OD(t,e=!1){const n=document.activeElement;for(const s of t)if(s===n||(s.focus({preventScroll:e}),document.activeElement!==n))return}function Qq(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var LD=MD,FD=ID,uj="Tabs",[Yq,eae]=Ss(uj,[gg]),BD=gg(),[Xq,hj]=Yq(uj),zD=g.forwardRef((t,e)=>{const{__scopeTabs:n,value:s,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:c,activationMode:d="automatic",...u}=t,m=Wd(c),[f,p]=zs({prop:s,onChange:a,defaultProp:i});return r.jsx(Xq,{scope:n,baseId:ps(),value:f,onValueChange:p,orientation:o,dir:m,activationMode:d,children:r.jsx(Xe.div,{dir:m,"data-orientation":o,...u,ref:e})})});zD.displayName=uj;var $D="TabsList",UD=g.forwardRef((t,e)=>{const{__scopeTabs:n,loop:s=!0,...a}=t,i=hj($D,n),o=BD(n);return r.jsx(LD,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:s,children:r.jsx(Xe.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:e})})});UD.displayName=$D;var qD="TabsTrigger",WD=g.forwardRef((t,e)=>{const{__scopeTabs:n,value:s,disabled:a=!1,...i}=t,o=hj(qD,n),c=BD(n),d=KD(o.baseId,s),u=ZD(o.baseId,s),m=s===o.value;return r.jsx(FD,{asChild:!0,...c,focusable:!a,active:m,children:r.jsx(Xe.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":u,"data-state":m?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:d,...i,ref:e,onMouseDown:Te(t.onMouseDown,f=>{!a&&f.button===0&&f.ctrlKey===!1?o.onValueChange(s):f.preventDefault()}),onKeyDown:Te(t.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&o.onValueChange(s)}),onFocus:Te(t.onFocus,()=>{const f=o.activationMode!=="manual";!m&&!a&&f&&o.onValueChange(s)})})})});WD.displayName=qD;var HD="TabsContent",VD=g.forwardRef((t,e)=>{const{__scopeTabs:n,value:s,forceMount:a,children:i,...o}=t,c=hj(HD,n),d=KD(c.baseId,s),u=ZD(c.baseId,s),m=s===c.value,f=g.useRef(m);return g.useEffect(()=>{const p=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(p)},[]),r.jsx(Jn,{present:a||m,children:({present:p})=>r.jsx(Xe.div,{"data-state":m?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!p,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:f.current?"0s":void 0},children:p&&i})})});VD.displayName=HD;function KD(t,e){return`${t}-trigger-${e}`}function ZD(t,e){return`${t}-content-${e}`}var Jq=zD,GD=UD,QD=WD,YD=VD;const zr=Jq,Er=g.forwardRef(({className:t,...e},n)=>r.jsx(GD,{ref:n,className:Oe("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));Er.displayName=GD.displayName;const Ge=g.forwardRef(({className:t,...e},n)=>r.jsx(QD,{ref:n,className:Oe("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));Ge.displayName=QD.displayName;const Qe=g.forwardRef(({className:t,...e},n)=>r.jsx(YD,{ref:n,className:Oe("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Qe.displayName=YD.displayName;function lt({className:t,...e}){return r.jsx("div",{className:Oe("animate-pulse rounded-md bg-muted",t),...e})}var Jt;(function(t){t.assertEqual=a=>a;function e(a){}t.assertIs=e;function n(a){throw new Error}t.assertNever=n,t.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},t.getValidEnumValues=a=>{const i=t.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),o={};for(const c of i)o[c]=a[c];return t.objectValues(o)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},t.find=(a,i)=>{for(const o of a)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function s(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Jt||(Jt={}));var rw;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(rw||(rw={}));const He=Jt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ji=t=>{switch(typeof t){case"undefined":return He.undefined;case"string":return He.string;case"number":return isNaN(t)?He.nan:He.number;case"boolean":return He.boolean;case"function":return He.function;case"bigint":return He.bigint;case"symbol":return He.symbol;case"object":return Array.isArray(t)?He.array:t===null?He.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?He.promise:typeof Map<"u"&&t instanceof Map?He.map:typeof Set<"u"&&t instanceof Set?He.set:typeof Date<"u"&&t instanceof Date?He.date:He.object;default:return He.unknown}},Pe=Jt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),eW=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class xs extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},s={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)s._errors.push(n(o));else{let c=s,d=0;for(;d<o.path.length;){const u=o.path[d];d===o.path.length-1?(c[u]=c[u]||{_errors:[]},c[u]._errors.push(n(o))):c[u]=c[u]||{_errors:[]},c=c[u],d++}}};return a(this),s}static assert(e){if(!(e instanceof xs))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Jt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},s=[];for(const a of this.issues)a.path.length>0?(n[a.path[0]]=n[a.path[0]]||[],n[a.path[0]].push(e(a))):s.push(e(a));return{formErrors:s,fieldErrors:n}}get formErrors(){return this.flatten()}}xs.create=t=>new xs(t);const wd=(t,e)=>{let n;switch(t.code){case Pe.invalid_type:t.received===He.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Pe.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Jt.jsonStringifyReplacer)}`;break;case Pe.unrecognized_keys:n=`Unrecognized key(s) in object: ${Jt.joinValues(t.keys,", ")}`;break;case Pe.invalid_union:n="Invalid input";break;case Pe.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Jt.joinValues(t.options)}`;break;case Pe.invalid_enum_value:n=`Invalid enum value. Expected ${Jt.joinValues(t.options)}, received '${t.received}'`;break;case Pe.invalid_arguments:n="Invalid function arguments";break;case Pe.invalid_return_type:n="Invalid function return type";break;case Pe.invalid_date:n="Invalid date";break;case Pe.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Jt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Pe.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Pe.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Pe.custom:n="Invalid input";break;case Pe.invalid_intersection_types:n="Intersection results could not be merged";break;case Pe.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Pe.not_finite:n="Number must be finite";break;default:n=e.defaultError,Jt.assertNever(t)}return{message:n}};let XD=wd;function tW(t){XD=t}function i0(){return XD}const o0=t=>{const{data:e,path:n,errorMaps:s,issueData:a}=t,i=[...n,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let c="";const d=s.filter(u=>!!u).slice().reverse();for(const u of d)c=u(o,{data:e,defaultError:c}).message;return{...a,path:i,message:c}},nW=[];function ze(t,e){const n=i0(),s=o0({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===wd?void 0:wd].filter(a=>!!a)});t.common.issues.push(s)}class Ar{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const s=[];for(const a of n){if(a.status==="aborted")return Ct;a.status==="dirty"&&e.dirty(),s.push(a.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,n){const s=[];for(const a of n){const i=await a.key,o=await a.value;s.push({key:i,value:o})}return Ar.mergeObjectSync(e,s)}static mergeObjectSync(e,n){const s={};for(const a of n){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return Ct;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(s[i.value]=o.value)}return{status:e.value,value:s}}}const Ct=Object.freeze({status:"aborted"}),Lc=t=>({status:"dirty",value:t}),$r=t=>({status:"valid",value:t}),sw=t=>t.status==="aborted",aw=t=>t.status==="dirty",Th=t=>t.status==="valid",Mh=t=>typeof Promise<"u"&&t instanceof Promise;function l0(t,e,n,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function JD(t,e,n,s,a){if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var st;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(st||(st={}));var Cu,Eu;class Za{constructor(e,n,s,a){this._cachedPath=[],this.parent=e,this.data=n,this._path=s,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const VS=(t,e)=>{if(Th(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new xs(t.common.issues);return this._error=n,this._error}}};function Tt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:s,description:a}=t;if(e&&(n||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(o,c)=>{var d,u;const{message:m}=t;return o.code==="invalid_enum_value"?{message:m??c.defaultError}:typeof c.data>"u"?{message:(d=m??s)!==null&&d!==void 0?d:c.defaultError}:o.code!=="invalid_type"?{message:c.defaultError}:{message:(u=m??n)!==null&&u!==void 0?u:c.defaultError}},description:a}}class Ft{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Ji(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Ji(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ar,ctx:{common:e.parent.common,data:e.data,parsedType:Ji(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Mh(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const s=this.safeParse(e,n);if(s.success)return s.data;throw s.error}safeParse(e,n){var s;const a={common:{issues:[],async:(s=n==null?void 0:n.async)!==null&&s!==void 0?s:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ji(e)},i=this._parseSync({data:e,path:a.path,parent:a});return VS(a,i)}async parseAsync(e,n){const s=await this.safeParseAsync(e,n);if(s.success)return s.data;throw s.error}async safeParseAsync(e,n){const s={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ji(e)},a=this._parse({data:e,path:s.path,parent:s}),i=await(Mh(a)?a:Promise.resolve(a));return VS(s,i)}refine(e,n){const s=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,i)=>{const o=e(a),c=()=>i.addIssue({code:Pe.custom,...s(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(d=>d?!0:(c(),!1)):o?!0:(c(),!1)})}refinement(e,n){return this._refinement((s,a)=>e(s)?!0:(a.addIssue(typeof n=="function"?n(s,a):n),!1))}_refinement(e){return new ga({schema:this,typeName:bt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return qa.create(this,this._def)}nullable(){return Lo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ca.create(this,this._def)}promise(){return jd.create(this,this._def)}or(e){return Lh.create([this,e],this._def)}and(e){return Fh.create(this,e,this._def)}transform(e){return new ga({...Tt(this._def),schema:this,typeName:bt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new qh({...Tt(this._def),innerType:this,defaultValue:n,typeName:bt.ZodDefault})}brand(){return new fj({typeName:bt.ZodBranded,type:this,...Tt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Wh({...Tt(this._def),innerType:this,catchValue:n,typeName:bt.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return _f.create(this,e)}readonly(){return Hh.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const rW=/^c[^\s-]{8,}$/i,sW=/^[0-9a-z]+$/,aW=/^[0-9A-HJKMNP-TV-Z]{26}$/,iW=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,oW=/^[a-z0-9_-]{21}$/i,lW=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,cW=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,dW="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let cv;const uW=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,hW=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,fW=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,eT="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",mW=new RegExp(`^${eT}$`);function tT(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function pW(t){return new RegExp(`^${tT(t)}$`)}function nT(t){let e=`${eT}T${tT(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function gW(t,e){return!!((e==="v4"||!e)&&uW.test(t)||(e==="v6"||!e)&&hW.test(t))}class aa extends Ft{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==He.string){const i=this._getOrReturnCtx(e);return ze(i,{code:Pe.invalid_type,expected:He.string,received:i.parsedType}),Ct}const s=new Ar;let a;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),ze(a,{code:Pe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),ze(a,{code:Pe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,c=e.data.length<i.value;(o||c)&&(a=this._getOrReturnCtx(e,a),o?ze(a,{code:Pe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&ze(a,{code:Pe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")cW.test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{validation:"email",code:Pe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")cv||(cv=new RegExp(dW,"u")),cv.test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{validation:"emoji",code:Pe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")iW.test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{validation:"uuid",code:Pe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")oW.test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{validation:"nanoid",code:Pe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")rW.test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{validation:"cuid",code:Pe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")sW.test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{validation:"cuid2",code:Pe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")aW.test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{validation:"ulid",code:Pe.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),ze(a,{validation:"url",code:Pe.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{validation:"regex",code:Pe.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),ze(a,{code:Pe.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),ze(a,{code:Pe.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),ze(a,{code:Pe.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?nT(i).test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{code:Pe.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?mW.test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{code:Pe.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?pW(i).test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{code:Pe.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?lW.test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{validation:"duration",code:Pe.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?gW(e.data,i.version)||(a=this._getOrReturnCtx(e,a),ze(a,{validation:"ip",code:Pe.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?fW.test(e.data)||(a=this._getOrReturnCtx(e,a),ze(a,{validation:"base64",code:Pe.invalid_string,message:i.message}),s.dirty()):Jt.assertNever(i);return{status:s.value,value:e.data}}_regex(e,n,s){return this.refinement(a=>e.test(a),{validation:n,code:Pe.invalid_string,...st.errToObj(s)})}_addCheck(e){return new aa({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...st.errToObj(e)})}url(e){return this._addCheck({kind:"url",...st.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...st.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...st.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...st.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...st.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...st.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...st.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...st.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...st.errToObj(e)})}datetime(e){var n,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...st.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...st.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...st.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...st.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...st.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...st.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...st.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...st.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...st.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...st.errToObj(n)})}nonempty(e){return this.min(1,st.errToObj(e))}trim(){return new aa({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new aa({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new aa({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}aa.create=t=>{var e;return new aa({checks:[],typeName:bt.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Tt(t)})};function xW(t,e){const n=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,a=n>s?n:s,i=parseInt(t.toFixed(a).replace(".","")),o=parseInt(e.toFixed(a).replace(".",""));return i%o/Math.pow(10,a)}class Ro extends Ft{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==He.number){const i=this._getOrReturnCtx(e);return ze(i,{code:Pe.invalid_type,expected:He.number,received:i.parsedType}),Ct}let s;const a=new Ar;for(const i of this._def.checks)i.kind==="int"?Jt.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),ze(s,{code:Pe.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),ze(s,{code:Pe.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),ze(s,{code:Pe.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?xW(e.data,i.value)!==0&&(s=this._getOrReturnCtx(e,s),ze(s,{code:Pe.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),ze(s,{code:Pe.not_finite,message:i.message}),a.dirty()):Jt.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,st.toString(n))}gt(e,n){return this.setLimit("min",e,!1,st.toString(n))}lte(e,n){return this.setLimit("max",e,!0,st.toString(n))}lt(e,n){return this.setLimit("max",e,!1,st.toString(n))}setLimit(e,n,s,a){return new Ro({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:s,message:st.toString(a)}]})}_addCheck(e){return new Ro({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:st.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:st.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:st.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:st.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:st.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:st.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:st.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:st.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:st.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Jt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(n===null||s.value>n)&&(n=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Ro.create=t=>new Ro({checks:[],typeName:bt.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Tt(t)});class Io extends Ft{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==He.bigint){const i=this._getOrReturnCtx(e);return ze(i,{code:Pe.invalid_type,expected:He.bigint,received:i.parsedType}),Ct}let s;const a=new Ar;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),ze(s,{code:Pe.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),ze(s,{code:Pe.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),ze(s,{code:Pe.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Jt.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,st.toString(n))}gt(e,n){return this.setLimit("min",e,!1,st.toString(n))}lte(e,n){return this.setLimit("max",e,!0,st.toString(n))}lt(e,n){return this.setLimit("max",e,!1,st.toString(n))}setLimit(e,n,s,a){return new Io({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:s,message:st.toString(a)}]})}_addCheck(e){return new Io({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:st.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:st.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:st.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:st.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:st.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Io.create=t=>{var e;return new Io({checks:[],typeName:bt.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Tt(t)})};class Rh extends Ft{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==He.boolean){const s=this._getOrReturnCtx(e);return ze(s,{code:Pe.invalid_type,expected:He.boolean,received:s.parsedType}),Ct}return $r(e.data)}}Rh.create=t=>new Rh({typeName:bt.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Tt(t)});class Il extends Ft{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==He.date){const i=this._getOrReturnCtx(e);return ze(i,{code:Pe.invalid_type,expected:He.date,received:i.parsedType}),Ct}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return ze(i,{code:Pe.invalid_date}),Ct}const s=new Ar;let a;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(a=this._getOrReturnCtx(e,a),ze(a,{code:Pe.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(a=this._getOrReturnCtx(e,a),ze(a,{code:Pe.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):Jt.assertNever(i);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Il({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:st.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:st.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Il.create=t=>new Il({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:bt.ZodDate,...Tt(t)});class c0 extends Ft{_parse(e){if(this._getType(e)!==He.symbol){const s=this._getOrReturnCtx(e);return ze(s,{code:Pe.invalid_type,expected:He.symbol,received:s.parsedType}),Ct}return $r(e.data)}}c0.create=t=>new c0({typeName:bt.ZodSymbol,...Tt(t)});class Ih extends Ft{_parse(e){if(this._getType(e)!==He.undefined){const s=this._getOrReturnCtx(e);return ze(s,{code:Pe.invalid_type,expected:He.undefined,received:s.parsedType}),Ct}return $r(e.data)}}Ih.create=t=>new Ih({typeName:bt.ZodUndefined,...Tt(t)});class Oh extends Ft{_parse(e){if(this._getType(e)!==He.null){const s=this._getOrReturnCtx(e);return ze(s,{code:Pe.invalid_type,expected:He.null,received:s.parsedType}),Ct}return $r(e.data)}}Oh.create=t=>new Oh({typeName:bt.ZodNull,...Tt(t)});class bd extends Ft{constructor(){super(...arguments),this._any=!0}_parse(e){return $r(e.data)}}bd.create=t=>new bd({typeName:bt.ZodAny,...Tt(t)});class Sl extends Ft{constructor(){super(...arguments),this._unknown=!0}_parse(e){return $r(e.data)}}Sl.create=t=>new Sl({typeName:bt.ZodUnknown,...Tt(t)});class Ei extends Ft{_parse(e){const n=this._getOrReturnCtx(e);return ze(n,{code:Pe.invalid_type,expected:He.never,received:n.parsedType}),Ct}}Ei.create=t=>new Ei({typeName:bt.ZodNever,...Tt(t)});class d0 extends Ft{_parse(e){if(this._getType(e)!==He.undefined){const s=this._getOrReturnCtx(e);return ze(s,{code:Pe.invalid_type,expected:He.void,received:s.parsedType}),Ct}return $r(e.data)}}d0.create=t=>new d0({typeName:bt.ZodVoid,...Tt(t)});class ca extends Ft{_parse(e){const{ctx:n,status:s}=this._processInputParams(e),a=this._def;if(n.parsedType!==He.array)return ze(n,{code:Pe.invalid_type,expected:He.array,received:n.parsedType}),Ct;if(a.exactLength!==null){const o=n.data.length>a.exactLength.value,c=n.data.length<a.exactLength.value;(o||c)&&(ze(n,{code:o?Pe.too_big:Pe.too_small,minimum:c?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),s.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(ze(n,{code:Pe.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),s.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(ze(n,{code:Pe.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),s.dirty()),n.common.async)return Promise.all([...n.data].map((o,c)=>a.type._parseAsync(new Za(n,o,n.path,c)))).then(o=>Ar.mergeArray(s,o));const i=[...n.data].map((o,c)=>a.type._parseSync(new Za(n,o,n.path,c)));return Ar.mergeArray(s,i)}get element(){return this._def.type}min(e,n){return new ca({...this._def,minLength:{value:e,message:st.toString(n)}})}max(e,n){return new ca({...this._def,maxLength:{value:e,message:st.toString(n)}})}length(e,n){return new ca({...this._def,exactLength:{value:e,message:st.toString(n)}})}nonempty(e){return this.min(1,e)}}ca.create=(t,e)=>new ca({type:t,minLength:null,maxLength:null,exactLength:null,typeName:bt.ZodArray,...Tt(e)});function _c(t){if(t instanceof kn){const e={};for(const n in t.shape){const s=t.shape[n];e[n]=qa.create(_c(s))}return new kn({...t._def,shape:()=>e})}else return t instanceof ca?new ca({...t._def,type:_c(t.element)}):t instanceof qa?qa.create(_c(t.unwrap())):t instanceof Lo?Lo.create(_c(t.unwrap())):t instanceof Ga?Ga.create(t.items.map(e=>_c(e))):t}class kn extends Ft{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Jt.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==He.object){const u=this._getOrReturnCtx(e);return ze(u,{code:Pe.invalid_type,expected:He.object,received:u.parsedType}),Ct}const{status:s,ctx:a}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),c=[];if(!(this._def.catchall instanceof Ei&&this._def.unknownKeys==="strip"))for(const u in a.data)o.includes(u)||c.push(u);const d=[];for(const u of o){const m=i[u],f=a.data[u];d.push({key:{status:"valid",value:u},value:m._parse(new Za(a,f,a.path,u)),alwaysSet:u in a.data})}if(this._def.catchall instanceof Ei){const u=this._def.unknownKeys;if(u==="passthrough")for(const m of c)d.push({key:{status:"valid",value:m},value:{status:"valid",value:a.data[m]}});else if(u==="strict")c.length>0&&(ze(a,{code:Pe.unrecognized_keys,keys:c}),s.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const m of c){const f=a.data[m];d.push({key:{status:"valid",value:m},value:u._parse(new Za(a,f,a.path,m)),alwaysSet:m in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const u=[];for(const m of d){const f=await m.key,p=await m.value;u.push({key:f,value:p,alwaysSet:m.alwaysSet})}return u}).then(u=>Ar.mergeObjectSync(s,u)):Ar.mergeObjectSync(s,d)}get shape(){return this._def.shape()}strict(e){return st.errToObj,new kn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,s)=>{var a,i,o,c;const d=(o=(i=(a=this._def).errorMap)===null||i===void 0?void 0:i.call(a,n,s).message)!==null&&o!==void 0?o:s.defaultError;return n.code==="unrecognized_keys"?{message:(c=st.errToObj(e).message)!==null&&c!==void 0?c:d}:{message:d}}}:{}})}strip(){return new kn({...this._def,unknownKeys:"strip"})}passthrough(){return new kn({...this._def,unknownKeys:"passthrough"})}extend(e){return new kn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new kn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:bt.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new kn({...this._def,catchall:e})}pick(e){const n={};return Jt.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(n[s]=this.shape[s])}),new kn({...this._def,shape:()=>n})}omit(e){const n={};return Jt.objectKeys(this.shape).forEach(s=>{e[s]||(n[s]=this.shape[s])}),new kn({...this._def,shape:()=>n})}deepPartial(){return _c(this)}partial(e){const n={};return Jt.objectKeys(this.shape).forEach(s=>{const a=this.shape[s];e&&!e[s]?n[s]=a:n[s]=a.optional()}),new kn({...this._def,shape:()=>n})}required(e){const n={};return Jt.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])n[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof qa;)i=i._def.innerType;n[s]=i}}),new kn({...this._def,shape:()=>n})}keyof(){return rT(Jt.objectKeys(this.shape))}}kn.create=(t,e)=>new kn({shape:()=>t,unknownKeys:"strip",catchall:Ei.create(),typeName:bt.ZodObject,...Tt(e)});kn.strictCreate=(t,e)=>new kn({shape:()=>t,unknownKeys:"strict",catchall:Ei.create(),typeName:bt.ZodObject,...Tt(e)});kn.lazycreate=(t,e)=>new kn({shape:t,unknownKeys:"strip",catchall:Ei.create(),typeName:bt.ZodObject,...Tt(e)});class Lh extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e),s=this._def.options;function a(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return n.common.issues.push(...c.ctx.common.issues),c.result;const o=i.map(c=>new xs(c.ctx.common.issues));return ze(n,{code:Pe.invalid_union,unionErrors:o}),Ct}if(n.common.async)return Promise.all(s.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const d of s){const u={...n,common:{...n.common,issues:[]},parent:null},m=d._parseSync({data:n.data,path:n.path,parent:u});if(m.status==="valid")return m;m.status==="dirty"&&!i&&(i={result:m,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const c=o.map(d=>new xs(d));return ze(n,{code:Pe.invalid_union,unionErrors:c}),Ct}}get options(){return this._def.options}}Lh.create=(t,e)=>new Lh({options:t,typeName:bt.ZodUnion,...Tt(e)});const ci=t=>t instanceof zh?ci(t.schema):t instanceof ga?ci(t.innerType()):t instanceof $h?[t.value]:t instanceof Oo?t.options:t instanceof Uh?Jt.objectValues(t.enum):t instanceof qh?ci(t._def.innerType):t instanceof Ih?[void 0]:t instanceof Oh?[null]:t instanceof qa?[void 0,...ci(t.unwrap())]:t instanceof Lo?[null,...ci(t.unwrap())]:t instanceof fj||t instanceof Hh?ci(t.unwrap()):t instanceof Wh?ci(t._def.innerType):[];class xg extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==He.object)return ze(n,{code:Pe.invalid_type,expected:He.object,received:n.parsedType}),Ct;const s=this.discriminator,a=n.data[s],i=this.optionsMap.get(a);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(ze(n,{code:Pe.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Ct)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,s){const a=new Map;for(const i of n){const o=ci(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const c of o){if(a.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);a.set(c,i)}}return new xg({typeName:bt.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:a,...Tt(s)})}}function iw(t,e){const n=Ji(t),s=Ji(e);if(t===e)return{valid:!0,data:t};if(n===He.object&&s===He.object){const a=Jt.objectKeys(e),i=Jt.objectKeys(t).filter(c=>a.indexOf(c)!==-1),o={...t,...e};for(const c of i){const d=iw(t[c],e[c]);if(!d.valid)return{valid:!1};o[c]=d.data}return{valid:!0,data:o}}else if(n===He.array&&s===He.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let i=0;i<t.length;i++){const o=t[i],c=e[i],d=iw(o,c);if(!d.valid)return{valid:!1};a.push(d.data)}return{valid:!0,data:a}}else return n===He.date&&s===He.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Fh extends Ft{_parse(e){const{status:n,ctx:s}=this._processInputParams(e),a=(i,o)=>{if(sw(i)||sw(o))return Ct;const c=iw(i.value,o.value);return c.valid?((aw(i)||aw(o))&&n.dirty(),{status:n.value,value:c.data}):(ze(s,{code:Pe.invalid_intersection_types}),Ct)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}Fh.create=(t,e,n)=>new Fh({left:t,right:e,typeName:bt.ZodIntersection,...Tt(n)});class Ga extends Ft{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==He.array)return ze(s,{code:Pe.invalid_type,expected:He.array,received:s.parsedType}),Ct;if(s.data.length<this._def.items.length)return ze(s,{code:Pe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ct;!this._def.rest&&s.data.length>this._def.items.length&&(ze(s,{code:Pe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...s.data].map((o,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new Za(s,o,s.path,c)):null}).filter(o=>!!o);return s.common.async?Promise.all(i).then(o=>Ar.mergeArray(n,o)):Ar.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Ga({...this._def,rest:e})}}Ga.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ga({items:t,typeName:bt.ZodTuple,rest:null,...Tt(e)})};class Bh extends Ft{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==He.object)return ze(s,{code:Pe.invalid_type,expected:He.object,received:s.parsedType}),Ct;const a=[],i=this._def.keyType,o=this._def.valueType;for(const c in s.data)a.push({key:i._parse(new Za(s,c,s.path,c)),value:o._parse(new Za(s,s.data[c],s.path,c)),alwaysSet:c in s.data});return s.common.async?Ar.mergeObjectAsync(n,a):Ar.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(e,n,s){return n instanceof Ft?new Bh({keyType:e,valueType:n,typeName:bt.ZodRecord,...Tt(s)}):new Bh({keyType:aa.create(),valueType:e,typeName:bt.ZodRecord,...Tt(n)})}}class u0 extends Ft{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==He.map)return ze(s,{code:Pe.invalid_type,expected:He.map,received:s.parsedType}),Ct;const a=this._def.keyType,i=this._def.valueType,o=[...s.data.entries()].map(([c,d],u)=>({key:a._parse(new Za(s,c,s.path,[u,"key"])),value:i._parse(new Za(s,d,s.path,[u,"value"]))}));if(s.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of o){const u=await d.key,m=await d.value;if(u.status==="aborted"||m.status==="aborted")return Ct;(u.status==="dirty"||m.status==="dirty")&&n.dirty(),c.set(u.value,m.value)}return{status:n.value,value:c}})}else{const c=new Map;for(const d of o){const u=d.key,m=d.value;if(u.status==="aborted"||m.status==="aborted")return Ct;(u.status==="dirty"||m.status==="dirty")&&n.dirty(),c.set(u.value,m.value)}return{status:n.value,value:c}}}}u0.create=(t,e,n)=>new u0({valueType:e,keyType:t,typeName:bt.ZodMap,...Tt(n)});class Ol extends Ft{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==He.set)return ze(s,{code:Pe.invalid_type,expected:He.set,received:s.parsedType}),Ct;const a=this._def;a.minSize!==null&&s.data.size<a.minSize.value&&(ze(s,{code:Pe.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&s.data.size>a.maxSize.value&&(ze(s,{code:Pe.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const i=this._def.valueType;function o(d){const u=new Set;for(const m of d){if(m.status==="aborted")return Ct;m.status==="dirty"&&n.dirty(),u.add(m.value)}return{status:n.value,value:u}}const c=[...s.data.values()].map((d,u)=>i._parse(new Za(s,d,s.path,u)));return s.common.async?Promise.all(c).then(d=>o(d)):o(c)}min(e,n){return new Ol({...this._def,minSize:{value:e,message:st.toString(n)}})}max(e,n){return new Ol({...this._def,maxSize:{value:e,message:st.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Ol.create=(t,e)=>new Ol({valueType:t,minSize:null,maxSize:null,typeName:bt.ZodSet,...Tt(e)});class Gc extends Ft{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==He.function)return ze(n,{code:Pe.invalid_type,expected:He.function,received:n.parsedType}),Ct;function s(c,d){return o0({data:c,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,i0(),wd].filter(u=>!!u),issueData:{code:Pe.invalid_arguments,argumentsError:d}})}function a(c,d){return o0({data:c,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,i0(),wd].filter(u=>!!u),issueData:{code:Pe.invalid_return_type,returnTypeError:d}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof jd){const c=this;return $r(async function(...d){const u=new xs([]),m=await c._def.args.parseAsync(d,i).catch(y=>{throw u.addIssue(s(d,y)),u}),f=await Reflect.apply(o,this,m);return await c._def.returns._def.type.parseAsync(f,i).catch(y=>{throw u.addIssue(a(f,y)),u})})}else{const c=this;return $r(function(...d){const u=c._def.args.safeParse(d,i);if(!u.success)throw new xs([s(d,u.error)]);const m=Reflect.apply(o,this,u.data),f=c._def.returns.safeParse(m,i);if(!f.success)throw new xs([a(m,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Gc({...this._def,args:Ga.create(e).rest(Sl.create())})}returns(e){return new Gc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,s){return new Gc({args:e||Ga.create([]).rest(Sl.create()),returns:n||Sl.create(),typeName:bt.ZodFunction,...Tt(s)})}}class zh extends Ft{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}zh.create=(t,e)=>new zh({getter:t,typeName:bt.ZodLazy,...Tt(e)});class $h extends Ft{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return ze(n,{received:n.data,code:Pe.invalid_literal,expected:this._def.value}),Ct}return{status:"valid",value:e.data}}get value(){return this._def.value}}$h.create=(t,e)=>new $h({value:t,typeName:bt.ZodLiteral,...Tt(e)});function rT(t,e){return new Oo({values:t,typeName:bt.ZodEnum,...Tt(e)})}class Oo extends Ft{constructor(){super(...arguments),Cu.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),s=this._def.values;return ze(n,{expected:Jt.joinValues(s),received:n.parsedType,code:Pe.invalid_type}),Ct}if(l0(this,Cu)||JD(this,Cu,new Set(this._def.values)),!l0(this,Cu).has(e.data)){const n=this._getOrReturnCtx(e),s=this._def.values;return ze(n,{received:n.data,code:Pe.invalid_enum_value,options:s}),Ct}return $r(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Oo.create(e,{...this._def,...n})}exclude(e,n=this._def){return Oo.create(this.options.filter(s=>!e.includes(s)),{...this._def,...n})}}Cu=new WeakMap;Oo.create=rT;class Uh extends Ft{constructor(){super(...arguments),Eu.set(this,void 0)}_parse(e){const n=Jt.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==He.string&&s.parsedType!==He.number){const a=Jt.objectValues(n);return ze(s,{expected:Jt.joinValues(a),received:s.parsedType,code:Pe.invalid_type}),Ct}if(l0(this,Eu)||JD(this,Eu,new Set(Jt.getValidEnumValues(this._def.values))),!l0(this,Eu).has(e.data)){const a=Jt.objectValues(n);return ze(s,{received:s.data,code:Pe.invalid_enum_value,options:a}),Ct}return $r(e.data)}get enum(){return this._def.values}}Eu=new WeakMap;Uh.create=(t,e)=>new Uh({values:t,typeName:bt.ZodNativeEnum,...Tt(e)});class jd extends Ft{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==He.promise&&n.common.async===!1)return ze(n,{code:Pe.invalid_type,expected:He.promise,received:n.parsedType}),Ct;const s=n.parsedType===He.promise?n.data:Promise.resolve(n.data);return $r(s.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}jd.create=(t,e)=>new jd({type:t,typeName:bt.ZodPromise,...Tt(e)});class ga extends Ft{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===bt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:s}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:o=>{ze(s,o),o.fatal?n.abort():n.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(s.data,i);if(s.common.async)return Promise.resolve(o).then(async c=>{if(n.value==="aborted")return Ct;const d=await this._def.schema._parseAsync({data:c,path:s.path,parent:s});return d.status==="aborted"?Ct:d.status==="dirty"||n.value==="dirty"?Lc(d.value):d});{if(n.value==="aborted")return Ct;const c=this._def.schema._parseSync({data:o,path:s.path,parent:s});return c.status==="aborted"?Ct:c.status==="dirty"||n.value==="dirty"?Lc(c.value):c}}if(a.type==="refinement"){const o=c=>{const d=a.refinement(c,i);if(s.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(s.common.async===!1){const c=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return c.status==="aborted"?Ct:(c.status==="dirty"&&n.dirty(),o(c.value),{status:n.value,value:c.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(c=>c.status==="aborted"?Ct:(c.status==="dirty"&&n.dirty(),o(c.value).then(()=>({status:n.value,value:c.value}))))}if(a.type==="transform")if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Th(o))return o;const c=a.transform(o.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:c}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>Th(o)?Promise.resolve(a.transform(o.value,i)).then(c=>({status:n.value,value:c})):o);Jt.assertNever(a)}}ga.create=(t,e,n)=>new ga({schema:t,typeName:bt.ZodEffects,effect:e,...Tt(n)});ga.createWithPreprocess=(t,e,n)=>new ga({schema:e,effect:{type:"preprocess",transform:t},typeName:bt.ZodEffects,...Tt(n)});class qa extends Ft{_parse(e){return this._getType(e)===He.undefined?$r(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}qa.create=(t,e)=>new qa({innerType:t,typeName:bt.ZodOptional,...Tt(e)});class Lo extends Ft{_parse(e){return this._getType(e)===He.null?$r(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Lo.create=(t,e)=>new Lo({innerType:t,typeName:bt.ZodNullable,...Tt(e)});class qh extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e);let s=n.data;return n.parsedType===He.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}qh.create=(t,e)=>new qh({innerType:t,typeName:bt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Tt(e)});class Wh extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e),s={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Mh(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new xs(s.common.issues)},input:s.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new xs(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}Wh.create=(t,e)=>new Wh({innerType:t,typeName:bt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Tt(e)});class h0 extends Ft{_parse(e){if(this._getType(e)!==He.nan){const s=this._getOrReturnCtx(e);return ze(s,{code:Pe.invalid_type,expected:He.nan,received:s.parsedType}),Ct}return{status:"valid",value:e.data}}}h0.create=t=>new h0({typeName:bt.ZodNaN,...Tt(t)});const vW=Symbol("zod_brand");class fj extends Ft{_parse(e){const{ctx:n}=this._processInputParams(e),s=n.data;return this._def.type._parse({data:s,path:n.path,parent:n})}unwrap(){return this._def.type}}class _f extends Ft{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?Ct:i.status==="dirty"?(n.dirty(),Lc(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{const a=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?Ct:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:s.path,parent:s})}}static create(e,n){return new _f({in:e,out:n,typeName:bt.ZodPipeline})}}class Hh extends Ft{_parse(e){const n=this._def.innerType._parse(e),s=a=>(Th(a)&&(a.value=Object.freeze(a.value)),a);return Mh(n)?n.then(a=>s(a)):s(n)}unwrap(){return this._def.innerType}}Hh.create=(t,e)=>new Hh({innerType:t,typeName:bt.ZodReadonly,...Tt(e)});function sT(t,e={},n){return t?bd.create().superRefine((s,a)=>{var i,o;if(!t(s)){const c=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,d=(o=(i=c.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,u=typeof c=="string"?{message:c}:c;a.addIssue({code:"custom",...u,fatal:d})}}):bd.create()}const yW={object:kn.lazycreate};var bt;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(bt||(bt={}));const _W=(t,e={message:`Input not instance of ${t.name}`})=>sT(n=>n instanceof t,e),aT=aa.create,iT=Ro.create,wW=h0.create,bW=Io.create,oT=Rh.create,jW=Il.create,NW=c0.create,SW=Ih.create,kW=Oh.create,CW=bd.create,EW=Sl.create,AW=Ei.create,PW=d0.create,DW=ca.create,TW=kn.create,MW=kn.strictCreate,RW=Lh.create,IW=xg.create,OW=Fh.create,LW=Ga.create,FW=Bh.create,BW=u0.create,zW=Ol.create,$W=Gc.create,UW=zh.create,qW=$h.create,WW=Oo.create,HW=Uh.create,VW=jd.create,KS=ga.create,KW=qa.create,ZW=Lo.create,GW=ga.createWithPreprocess,QW=_f.create,YW=()=>aT().optional(),XW=()=>iT().optional(),JW=()=>oT().optional(),eH={string:t=>aa.create({...t,coerce:!0}),number:t=>Ro.create({...t,coerce:!0}),boolean:t=>Rh.create({...t,coerce:!0}),bigint:t=>Io.create({...t,coerce:!0}),date:t=>Il.create({...t,coerce:!0})},tH=Ct;var C=Object.freeze({__proto__:null,defaultErrorMap:wd,setErrorMap:tW,getErrorMap:i0,makeIssue:o0,EMPTY_PATH:nW,addIssueToContext:ze,ParseStatus:Ar,INVALID:Ct,DIRTY:Lc,OK:$r,isAborted:sw,isDirty:aw,isValid:Th,isAsync:Mh,get util(){return Jt},get objectUtil(){return rw},ZodParsedType:He,getParsedType:Ji,ZodType:Ft,datetimeRegex:nT,ZodString:aa,ZodNumber:Ro,ZodBigInt:Io,ZodBoolean:Rh,ZodDate:Il,ZodSymbol:c0,ZodUndefined:Ih,ZodNull:Oh,ZodAny:bd,ZodUnknown:Sl,ZodNever:Ei,ZodVoid:d0,ZodArray:ca,ZodObject:kn,ZodUnion:Lh,ZodDiscriminatedUnion:xg,ZodIntersection:Fh,ZodTuple:Ga,ZodRecord:Bh,ZodMap:u0,ZodSet:Ol,ZodFunction:Gc,ZodLazy:zh,ZodLiteral:$h,ZodEnum:Oo,ZodNativeEnum:Uh,ZodPromise:jd,ZodEffects:ga,ZodTransformer:ga,ZodOptional:qa,ZodNullable:Lo,ZodDefault:qh,ZodCatch:Wh,ZodNaN:h0,BRAND:vW,ZodBranded:fj,ZodPipeline:_f,ZodReadonly:Hh,custom:sT,Schema:Ft,ZodSchema:Ft,late:yW,get ZodFirstPartyTypeKind(){return bt},coerce:eH,any:CW,array:DW,bigint:bW,boolean:oT,date:jW,discriminatedUnion:IW,effect:KS,enum:WW,function:$W,instanceof:_W,intersection:OW,lazy:UW,literal:qW,map:BW,nan:wW,nativeEnum:HW,never:AW,null:kW,nullable:ZW,number:iT,object:TW,oboolean:JW,onumber:XW,optional:KW,ostring:YW,pipeline:QW,preprocess:GW,promise:VW,record:FW,set:zW,strictObject:MW,string:aT,symbol:NW,transformer:KS,tuple:LW,undefined:SW,union:RW,unknown:EW,void:PW,NEVER:tH,ZodIssueCode:Pe,quotelessJson:eW,ZodError:xs});const Je={UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",INVALID_TOKEN:"INVALID_TOKEN",VALIDATION_ERROR:"VALIDATION_ERROR",INVALID_INPUT:"INVALID_INPUT",MISSING_REQUIRED_FIELD:"MISSING_REQUIRED_FIELD",RESOURCE_NOT_FOUND:"RESOURCE_NOT_FOUND",RESOURCE_ALREADY_EXISTS:"RESOURCE_ALREADY_EXISTS",BUSINESS_RULE_VIOLATION:"BUSINESS_RULE_VIOLATION",INSUFFICIENT_PERMISSIONS:"INSUFFICIENT_PERMISSIONS",IMMUTABLE_RECORD:"IMMUTABLE_RECORD",AUDIT_REQUIRED:"AUDIT_REQUIRED",DOCUMENT_LOCKED:"DOCUMENT_LOCKED",RETENTION_PERIOD_ACTIVE:"RETENTION_PERIOD_ACTIVE",INTERNAL_ERROR:"INTERNAL_ERROR",DATABASE_ERROR:"DATABASE_ERROR",NETWORK_ERROR:"NETWORK_ERROR",SERVICE_UNAVAILABLE:"SERVICE_UNAVAILABLE",RATE_LIMIT_EXCEEDED:"RATE_LIMIT_EXCEEDED"};let Ye=class extends Error{constructor(e,n,s,a=400){super(n),this.code=e,this.details=s,this.statusCode=a,this.name="ApiError"}};const lT=()=>`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,vs=(t,e,n)=>{try{return t.parse(e)}catch(s){throw s instanceof C.ZodError?new Ye(Je.VALIDATION_ERROR,"Input validation failed",{validationErrors:s.errors,receivedData:e}):s}},sh=t=>{throw console.error("Supabase error:",t),t.code==="PGRST116"?new Ye(Je.FORBIDDEN,"Insufficient permissions to access this resource",{supabaseCode:t.code}):t.code==="23505"?new Ye(Je.RESOURCE_ALREADY_EXISTS,"Resource already exists",{supabaseCode:t.code,constraint:t.constraint}):t.code==="23503"?new Ye(Je.BUSINESS_RULE_VIOLATION,"Referenced resource does not exist",{supabaseCode:t.code,constraint:t.constraint}):new Ye(Je.DATABASE_ERROR,t.message||"Database operation failed",{supabaseError:t})};async function Le(t,e){const n=lT();try{console.log(`[${n}] Starting API operation: ${e||"Unknown"}`);const s=await t();return console.log(`[${n}] API operation completed successfully`),s}catch(s){throw console.error(`[${n}] API operation failed:`,s),s instanceof Ye?s:(s&&typeof s=="object"&&"code"in s&&sh(s),new Ye(Je.INTERNAL_ERROR,s instanceof Error?s.message:"Unknown error occurred",{requestId:n,originalError:s}))}}class nH{constructor(e){As(this,"query");As(this,"requestId");this.query=e,this.requestId=lT()}async execute(){return Le(async()=>{const{data:e,error:n}=await this.query;return n&&sh(n),e||[]},`Query execution [${this.requestId}]`)}async executeSingle(){return Le(async()=>{const{data:e,error:n}=await this.query.single();if(n){if(n.code==="PGRST116")throw new Ye(Je.RESOURCE_NOT_FOUND,"Resource not found");sh(n)}return e},`Single query execution [${this.requestId}]`)}async executeWithCount(){return Le(async()=>{const{data:e,error:n,count:s}=await this.query;return n&&sh(n),{data:e||[],count:s||0}},`Query with count execution [${this.requestId}]`)}}const nt=t=>new nH(t),rH=async()=>Le(async()=>{const{data:{user:t},error:e}=await K.auth.getUser();if(e)throw new Ye(Je.UNAUTHORIZED,"Authentication required");if(!t)throw new Ye(Je.UNAUTHORIZED,"User not authenticated");return t},"Get current user"),na=async()=>Le(async()=>{const t=await rH(),{data:e,error:n}=await K.from("profiles").select("*").eq("id",t.id).single();return n&&sh(n),e},"Get current user profile"),Ya=C.object({id:C.string().uuid(),created_at:C.string().datetime(),updated_at:C.string().datetime(),company_id:C.string().uuid().optional()}),mj=C.object({company_name:C.string().min(1,"Firmenname ist erforderlich"),contact_person:C.string().min(1,"Ansprechpartner ist erforderlich"),email:C.string().email("Gültige E-Mail-Adresse erforderlich"),phone:C.string().optional(),address:C.string().optional(),city:C.string().optional(),postal_code:C.string().optional(),country:C.string().default("Deutschland"),tax_number:C.string().optional(),customer_number:C.string().optional(),status:C.enum(["Aktiv","Premium","Inaktiv"]).default("Aktiv")}),sH=mj.partial();Ya.merge(mj).extend({customer_number:C.string().nullable()});const cT=C.object({name:C.string().min(1,"Materialname ist erforderlich"),sku:C.string().optional(),description:C.string().optional(),unit:C.string().default("Stk"),unit_price:C.number().min(0,"Preis muss positiv sein").default(0),stock:C.number().int().min(0,"Lagerbestand muss positiv sein").default(0),reorder_min:C.number().int().min(0,"Mindestbestand muss positiv sein").default(0),category:C.string().optional(),supplier:C.string().optional()});cT.partial();Ya.merge(cT);const aH=C.object({id:C.string().optional(),description:C.string().min(1,"Beschreibung ist erforderlich"),quantity:C.number().min(.01,"Menge muss größer als 0 sein"),unit:C.string().default("Stk"),unit_price:C.number().min(0,"Preis muss positiv sein"),total_price:C.number().min(0,"Gesamtpreis muss positiv sein")}),pj=C.object({customer_id:C.string().uuid("Kunde ist erforderlich"),title:C.string().min(1,"Titel ist erforderlich"),description:C.string().optional(),body:C.object({items:C.array(aH).min(1,"Mindestens ein Posten erforderlich"),notes:C.string().optional(),terms:C.string().optional()}),tax_rate:C.number().min(0).max(100).default(19),valid_until:C.string().date().optional()}),iH=pj.partial().extend({status:C.enum(["draft","sent","accepted","rejected","expired"]).optional(),quote_number:C.string().optional()});Ya.merge(pj).extend({quote_number:C.string().nullable(),status:C.enum(["draft","sent","accepted","rejected","expired"]).default("draft"),total_net:C.number().optional(),total_gross:C.number().optional(),sent_at:C.string().datetime().optional(),accepted_at:C.string().datetime().optional()});const gj=C.object({quote_id:C.string().uuid().optional(),customer_id:C.string().uuid("Kunde ist erforderlich"),title:C.string().min(1,"Titel ist erforderlich"),description:C.string().optional(),total_amount:C.number().min(0,"Betrag muss positiv sein")}),oH=gj.partial().extend({status:C.enum(["open","in_progress","completed","cancelled"]).optional(),order_number:C.string().optional()});Ya.merge(gj).extend({order_number:C.string().nullable(),status:C.enum(["open","in_progress","completed","cancelled"]).default("open")});const xj=C.object({order_id:C.string().uuid().optional(),customer_id:C.string().uuid().optional(),name:C.string().min(1,"Projektname ist erforderlich"),description:C.string().optional(),status:C.enum(["planned","active","blocked","completed","cancelled"]).default("planned"),budget:C.number().min(0,"Budget muss positiv sein").optional(),start_date:C.string().date().optional(),end_date:C.string().date().optional(),progress_percentage:C.number().min(0).max(100).default(0)}),lH=xj.partial();Ya.merge(xj).extend({material_costs:C.number().default(0),labor_costs:C.number().default(0),hours_planned:C.number().optional(),hours_actual:C.number().default(0)});const vj=C.object({project_id:C.string().uuid().optional(),customer_id:C.string().uuid("Kunde ist erforderlich"),title:C.string().min(1,"Titel ist erforderlich"),description:C.string().optional(),amount:C.number().min(0,"Betrag muss positiv sein"),tax_rate:C.number().min(0).max(100).default(19),due_date:C.string().date().optional()}),cH=vj.partial().extend({status:C.enum(["draft","sent","paid","overdue","void","cancelled"]).optional(),invoice_number:C.string().optional()});Ya.merge(vj).extend({invoice_number:C.string().nullable(),status:C.enum(["draft","sent","paid","overdue","void","cancelled"]).default("draft"),net_amount:C.number().optional(),tax_amount:C.number().optional(),sent_at:C.string().datetime().optional(),paid_at:C.string().datetime().optional()});const yj=C.object({project_id:C.string().uuid("Projekt ist erforderlich"),employee_id:C.string().uuid("Mitarbeiter ist erforderlich"),date:C.string().date("Gültiges Datum erforderlich"),start_time:C.string().time().optional(),end_time:C.string().time().optional(),break_minutes:C.number().int().min(0).default(0),hours:C.number().min(0,"Stunden müssen positiv sein"),description:C.string().optional(),task_category:C.string().default("general"),hourly_rate:C.number().min(0,"Stundensatz muss positiv sein").optional(),is_billable:C.boolean().default(!0)}),dH=yj.partial().extend({approved_by:C.string().uuid().optional(),approved_at:C.string().datetime().optional()});Ya.merge(yj).extend({approved_by:C.string().uuid().optional(),approved_at:C.string().datetime().optional()});const _j=C.object({project_id:C.string().uuid().optional(),employee_id:C.string().uuid().optional(),category:C.string().min(1,"Kategorie ist erforderlich"),amount:C.number().min(0,"Betrag muss positiv sein"),description:C.string().optional(),receipt_url:C.string().url().optional(),expense_date:C.string().date("Gültiges Datum erforderlich"),is_billable:C.boolean().default(!1)});_j.partial().extend({approved_by:C.string().uuid().optional(),approved_at:C.string().datetime().optional()});Ya.merge(_j).extend({approved_by:C.string().uuid().optional(),approved_at:C.string().datetime().optional()});const uH=C.object({material_id:C.string().uuid("Material ist erforderlich"),project_id:C.string().uuid().optional(),quantity:C.number().int().refine(t=>t!==0,"Menge darf nicht 0 sein"),movement_type:C.enum(["issue","receive","adjust","return"]),reference_number:C.string().optional(),notes:C.string().optional()});Ya.merge(uH);const dT=C.object({first_name:C.string().min(1,"Vorname ist erforderlich"),last_name:C.string().min(1,"Nachname ist erforderlich"),email:C.string().email("Gültige E-Mail-Adresse erforderlich"),phone:C.string().optional(),role:C.string().default("employee"),hourly_wage:C.number().min(0,"Stundenlohn muss positiv sein").default(0),status:C.enum(["active","inactive","invited"]).default("active")});dT.partial();Ya.merge(dT);const hH=C.object({success:C.literal(!0),data:C.any(),message:C.string().optional()}),fH=C.object({success:C.literal(!1),error:C.object({code:C.string(),message:C.string(),details:C.any().optional()})});C.union([hH,fH]);C.object({page:C.coerce.number().int().min(1).default(1),limit:C.coerce.number().int().min(1).max(100).default(20),sort_by:C.string().optional(),sort_order:C.enum(["asc","desc"]).default("desc")});C.object({items:C.array(C.any()),pagination:C.object({page:C.number(),limit:C.number(),total_items:C.number(),total_pages:C.number(),has_next:C.boolean(),has_prev:C.boolean()})});const mH=C.object({project_id:C.string().uuid().optional(),suggestion_type:C.enum(["parse_intent","estimate","schedule","material_list","cost_breakdown","timeline"]),input_data:C.record(C.any()).refine(t=>Object.keys(t).length>0,"Input data is required"),output_data:C.record(C.any()).refine(t=>Object.keys(t).length>0,"Output data is required"),confidence_score:C.number().min(0).max(1).optional(),model_version:C.string().optional(),trace_id:C.string().uuid().optional()});mH.partial().extend({status:C.enum(["active","applied","rejected","superseded"]).optional(),applied_by:C.string().uuid().optional(),applied_at:C.string().datetime().optional(),feedback_score:C.number().int().min(1).max(5).optional(),feedback_notes:C.string().optional()});C.object({id:C.string().uuid(),project_id:C.string().uuid().optional(),suggestion_type:C.enum(["parse_intent","estimate","schedule","material_list","cost_breakdown","timeline"]),input_data:C.record(C.any()),output_data:C.record(C.any()),confidence_score:C.number().min(0).max(1).optional(),model_version:C.string().optional(),trace_id:C.string().uuid().optional(),status:C.enum(["active","applied","rejected","superseded"]).default("active"),applied_by:C.string().uuid().optional(),applied_at:C.string().datetime().optional(),feedback_score:C.number().int().min(1).max(5).optional(),feedback_notes:C.string().optional(),company_id:C.string().uuid().optional(),created_at:C.string().datetime(),updated_at:C.string().datetime()});C.object({ref_type:C.string().min(1,"Reference type is required"),ref_id:C.string().uuid("Valid reference ID required"),content_text:C.string().min(1,"Content text is required"),metadata:C.record(C.any()).optional()});C.object({id:C.string().uuid(),ref_type:C.string(),ref_id:C.string().uuid(),content_text:C.string(),embedding:C.array(C.number()).optional(),metadata:C.record(C.any()).optional(),indexed_at:C.string().datetime(),company_id:C.string().uuid().optional(),created_at:C.string().datetime(),updated_at:C.string().datetime()});C.object({operation_type:C.enum(["index_content","generate_estimate","create_schedule","extract_intent"]),entity_type:C.string().min(1,"Entity type is required"),entity_id:C.string().uuid("Valid entity ID required"),input_data:C.record(C.any()).refine(t=>Object.keys(t).length>0,"Input data is required"),priority:C.number().int().min(1).max(10).default(5),scheduled_for:C.string().datetime().optional()});C.object({id:C.string().uuid(),operation_type:C.enum(["index_content","generate_estimate","create_schedule","extract_intent"]),entity_type:C.string(),entity_id:C.string().uuid(),input_data:C.record(C.any()),priority:C.number().int().min(1).max(10).default(5),status:C.enum(["pending","processing","completed","failed"]).default("pending"),attempts:C.number().int().min(0).default(0),max_attempts:C.number().int().min(1).default(3),error_message:C.string().optional(),result_data:C.record(C.any()).optional(),scheduled_for:C.string().datetime(),started_at:C.string().datetime().optional(),completed_at:C.string().datetime().optional(),company_id:C.string().uuid().optional(),created_at:C.string().datetime()});C.object({data_type:C.enum(["estimate_correction","schedule_feedback","material_suggestion","cost_actual_vs_predicted"]),input_features:C.record(C.any()).refine(t=>Object.keys(t).length>0,"Input features required"),expected_output:C.record(C.any()).refine(t=>Object.keys(t).length>0,"Expected output required"),predicted_output:C.record(C.any()).optional(),prediction_error:C.number().optional(),project_id:C.string().uuid().optional(),suggestion_id:C.string().uuid().optional()});C.object({id:C.string().uuid(),data_type:C.enum(["estimate_correction","schedule_feedback","material_suggestion","cost_actual_vs_predicted"]),input_features:C.record(C.any()),expected_output:C.record(C.any()),predicted_output:C.record(C.any()).optional(),prediction_error:C.number().optional(),project_id:C.string().uuid().optional(),suggestion_id:C.string().uuid().optional(),company_id:C.string().uuid().optional(),created_at:C.string().datetime()});C.object({text:C.string().min(1,"Text content is required"),context:C.object({customer_info:C.string().optional(),previous_projects:C.array(C.string()).optional(),preferred_materials:C.array(C.string()).optional()}).optional()});C.object({intent_type:C.enum(["quote_request","project_inquiry","maintenance","consultation","emergency"]),confidence:C.number().min(0).max(1),extracted_data:C.object({customer_name:C.string().optional(),project_type:C.string().optional(),description:C.string().optional(),urgency:C.enum(["low","medium","high","urgent"]).optional(),budget_range:C.object({min:C.number().optional(),max:C.number().optional()}).optional(),timeline:C.object({start_date:C.string().date().optional(),end_date:C.string().date().optional(),duration_days:C.number().optional()}).optional(),materials:C.array(C.object({name:C.string(),quantity:C.number().optional(),unit:C.string().optional()})).optional()}),suggestions:C.array(C.string()).optional()});C.object({project_description:C.string().min(1,"Project description is required"),project_type:C.string().optional(),customer_id:C.string().uuid().optional(),timeline:C.object({start_date:C.string().date().optional(),duration_days:C.number().min(1).optional()}).optional(),requirements:C.array(C.string()).optional(),similar_projects:C.array(C.string().uuid()).optional()});C.object({confidence:C.number().min(0).max(1),total_estimate:C.number().min(0),breakdown:C.object({labor_hours:C.number().min(0),labor_cost:C.number().min(0),material_cost:C.number().min(0),equipment_cost:C.number().min(0).default(0),overhead_cost:C.number().min(0).default(0)}),materials:C.array(C.object({name:C.string(),material_id:C.string().uuid().optional(),quantity:C.number().min(0),unit:C.string(),unit_price:C.number().min(0),total_cost:C.number().min(0),availability:C.enum(["available","order_needed","unavailable"]).optional()})),timeline:C.object({estimated_duration_days:C.number().min(1),phases:C.array(C.object({name:C.string(),duration_days:C.number().min(1),description:C.string().optional()})).optional()}),risks:C.array(C.object({description:C.string(),impact:C.enum(["low","medium","high"]),mitigation:C.string().optional()})).optional()});C.object({project_id:C.string().uuid("Project ID is required"),requirements:C.object({start_date:C.string().date().optional(),end_date:C.string().date().optional(),duration_days:C.number().min(1).optional(),required_skills:C.array(C.string()).optional(),team_size:C.number().int().min(1).optional()}),constraints:C.object({available_employees:C.array(C.string().uuid()).optional(),excluded_dates:C.array(C.string().date()).optional(),priority:C.enum(["low","medium","high","urgent"]).default("medium")}).optional()});C.object({confidence:C.number().min(0).max(1),recommended_schedule:C.array(C.object({employee_id:C.string().uuid(),employee_name:C.string(),dates:C.array(C.object({date:C.string().date(),hours:C.number().min(0).max(24),tasks:C.array(C.string()).optional()})),total_hours:C.number().min(0)})),conflicts:C.array(C.object({type:C.enum(["employee_unavailable","overallocation","skill_mismatch","deadline_conflict"]),description:C.string(),affected_employees:C.array(C.string().uuid()).optional(),severity:C.enum(["low","medium","high"])})),alternatives:C.array(C.object({description:C.string(),impact:C.string(),schedule:C.any().optional()})).optional()});C.object({entity_type:C.string().min(1,"Entity type is required"),entity_id:C.string().uuid("Valid entity ID required"),action:C.enum(["INSERT","UPDATE","DELETE","STATUS_CHANGE"]),old_values:C.record(C.any()).optional(),new_values:C.record(C.any()).optional(),changed_fields:C.array(C.string()).optional(),reason:C.string().optional(),ip_address:C.string().ip().optional(),user_agent:C.string().optional()});C.object({id:C.string().uuid(),entity_type:C.string(),entity_id:C.string().uuid(),action:C.enum(["INSERT","UPDATE","DELETE","STATUS_CHANGE"]),old_values:C.record(C.any()).optional(),new_values:C.record(C.any()).optional(),changed_fields:C.array(C.string()).optional(),user_id:C.string().uuid().optional(),user_email:C.string().email().optional(),reason:C.string().optional(),ip_address:C.string().optional(),user_agent:C.string().optional(),company_id:C.string().uuid().optional(),created_at:C.string().datetime()});const pH=C.object({sequence_name:C.string().min(1,"Sequence name is required"),prefix:C.string().default(""),format_pattern:C.string().default("{prefix}-{year}-{number:04d}"),year_reset:C.boolean().default(!0),current_value:C.number().int().min(0).default(0)});pH.partial();C.object({id:C.string().uuid(),sequence_name:C.string(),current_value:C.number().int().min(0),prefix:C.string(),year_reset:C.boolean(),format_pattern:C.string(),last_reset_year:C.number().int().optional(),company_id:C.string().uuid().optional(),created_at:C.string().datetime(),updated_at:C.string().datetime()});C.object({entity_type:C.string().min(1,"Entity type is required"),entity_id:C.string().uuid("Valid entity ID required"),file_name:C.string().min(1,"File name is required"),file_path:C.string().min(1,"File path is required"),file_size:C.number().int().min(0,"File size must be non-negative"),mime_type:C.string().min(1,"MIME type is required"),sha256_hash:C.string().regex(/^[a-fA-F0-9]{64}$/,"Valid SHA256 hash required"),is_original:C.boolean().default(!0),legal_category:C.enum(["invoice","contract","receipt","tax_document","correspondence"]),retention_until:C.string().date("Valid retention date required")});C.object({id:C.string().uuid(),entity_type:C.string(),entity_id:C.string().uuid(),file_name:C.string(),file_path:C.string(),file_size:C.number().int(),mime_type:C.string(),sha256_hash:C.string().regex(/^[a-fA-F0-9]{64}$/),created_by:C.string().uuid().optional(),is_original:C.boolean(),legal_category:C.enum(["invoice","contract","receipt","tax_document","correspondence"]),retention_until:C.string().date(),company_id:C.string().uuid().optional(),created_at:C.string().datetime()});C.object({from_date:C.string().date("Valid from date required"),to_date:C.string().date("Valid to date required"),export_type:C.enum(["invoices","postings","full"]).default("invoices"),include_drafts:C.boolean().default(!1),consultant_number:C.string().optional(),client_number:C.string().optional(),encoding:C.enum(["UTF-8","CP1252"]).default("CP1252")});C.object({export_id:C.string().uuid(),file_url:C.string().url(),file_name:C.string(),record_count:C.number().int().min(0),export_date:C.string().datetime(),from_date:C.string().date(),to_date:C.string().date(),checksum:C.string().optional()});C.object({belegdatum:C.string().date(),rechnungsnummer:C.string(),debitorenkonto:C.string().optional(),gegenkonto:C.string(),bu_schluessel:C.string().optional(),nettobetrag:C.number(),steuerbetrag:C.number().default(0),bruttobetrag:C.number(),belegfeld1:C.string().optional(),kost1:C.string().optional(),kost2:C.string().optional(),project_id:C.string().uuid().optional(),customer_id:C.string().uuid().optional(),description:C.string().optional()});C.object({entity_type:C.enum(["quote","order","invoice"]),entity_id:C.string().uuid(),from_status:C.string(),to_status:C.string(),reason:C.string().optional(),require_immutable_file:C.boolean().default(!1),file_data:C.object({content:C.string(),filename:C.string(),mime_type:C.string()}).optional()});C.object({report_type:C.enum(["audit_summary","document_integrity","number_sequence_gaps","retention_overview"]),from_date:C.string().date().optional(),to_date:C.string().date().optional(),entity_types:C.array(C.string()).optional()});C.object({report_type:C.string(),generated_at:C.string().datetime(),period:C.object({from_date:C.string().date().optional(),to_date:C.string().date().optional()}),summary:C.object({total_records:C.number().int(),compliant_records:C.number().int(),issues_found:C.number().int(),compliance_percentage:C.number().min(0).max(100)}),details:C.array(C.object({entity_type:C.string(),entity_id:C.string().uuid(),issue_type:C.string(),description:C.string(),severity:C.enum(["low","medium","high","critical"]),recommendation:C.string().optional()})),file_integrity:C.object({total_files:C.number().int(),verified_files:C.number().int(),failed_verifications:C.number().int(),missing_files:C.number().int()}).optional()});C.object({entity_type:C.string().min(1,"Entity type is required"),entity_ids:C.array(C.string().uuid()).min(1,"At least one entity ID required"),archive_reason:C.string().min(1,"Archive reason is required"),retention_years:C.number().int().min(1).max(30).default(10),include_related:C.boolean().default(!0)});C.object({archive_id:C.string().uuid(),archived_count:C.number().int(),archive_location:C.string(),retention_until:C.string().date(),created_at:C.string().datetime()});const ZS=(t,e=!1)=>{const n={can_view:!1,can_edit_basic_data:!1,can_add_time:!1,can_add_materials:!1,can_upload_files:!1,can_change_status:!1,can_link_invoices:!1,can_delete:!1,can_manage_team:!1};switch(t){case"mitarbeiter":return{...n,can_view:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0};case"projektleiter":return{...n,can_view:!0,can_edit_basic_data:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0,can_change_status:!0,can_link_invoices:!0,can_manage_team:!0};case"admin":return{can_view:!0,can_edit_basic_data:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0,can_change_status:!0,can_link_invoices:!0,can_delete:!0,can_manage_team:!0};default:return n}},GS={anfrage:{label:"Anfrage",color:"text-purple-700",bgColor:"bg-purple-100",icon:"📋",description:"Projekt-Anfrage eingegangen",nextStates:["besichtigung"],previousStates:[]},besichtigung:{label:"Termin ausmachen",color:"text-orange-700",bgColor:"bg-orange-100",icon:"📅",description:"Besichtigungstermin vereinbaren",nextStates:["geplant"],previousStates:["anfrage"]},geplant:{label:"In Planung",color:"text-blue-700",bgColor:"bg-blue-100",icon:"📝",description:"Projekt ist in Planung",nextStates:["in_bearbeitung"],previousStates:["besichtigung"]},in_bearbeitung:{label:"In Arbeit",color:"text-yellow-700",bgColor:"bg-yellow-100",icon:"🔨",description:"Projekt läuft aktiv",nextStates:["abgeschlossen"],previousStates:["geplant"]},abgeschlossen:{label:"Erledigt",color:"text-green-700",bgColor:"bg-green-100",icon:"✅",description:"Projekt ist abgeschlossen",nextStates:[],previousStates:["in_bearbeitung"]}};class vg{static async getCustomers(e,n){return Le(async()=>{let s=K.from("customers").select("*",{count:"exact"});if(n!=null&&n.status&&(s=s.eq("status",n.status)),n!=null&&n.search&&(s=s.or(`company_name.ilike.%${n.search}%,contact_person.ilike.%${n.search}%,email.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else s=s.order("created_at",{ascending:!1});const{data:a,count:i}=await nt(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get customers")}static async getCustomer(e){return Le(async()=>{const n=K.from("customers").select("*").eq("id",e);return nt(n).executeSingle()},`Get customer ${e}`)}static async createCustomer(e){return Le(async()=>{const n=vs(mj,e);if(!n.customer_number){const a=await this.generateCustomerNumber();n.customer_number=a}const s=K.from("customers").insert(n).select().single();return nt(s).executeSingle()},"Create customer")}static async updateCustomer(e,n){return Le(async()=>{const s=vs(sH,n);await this.getCustomer(e);const a=K.from("customers").update(s).eq("id",e).select().single();return nt(a).executeSingle()},`Update customer ${e}`)}static async deleteCustomer(e){return Le(async()=>{const{data:n}=await K.from("projects").select("id").eq("customer_id",e).limit(1);if(n&&n.length>0)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Kunde kann nicht gelöscht werden, da noch Projekte zugeordnet sind.",{relatedProjects:n.length});const{data:s}=await K.from("quotes").select("id").eq("customer_id",e).limit(1);if(s&&s.length>0)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Kunde kann nicht gelöscht werden, da noch Angebote vorhanden sind.",{relatedQuotes:s.length});const{error:a}=await K.from("customers").delete().eq("id",e);if(a)throw a},`Delete customer ${e}`)}static async getCustomerStats(e){return Le(async()=>{const{data:n}=await K.from("projects").select("status, budget").eq("customer_id",e),{data:s}=await K.from("invoices").select("status, amount").eq("customer_id",e);return{total_projects:(n==null?void 0:n.length)||0,active_projects:(n==null?void 0:n.filter(i=>i.status==="active").length)||0,completed_projects:(n==null?void 0:n.filter(i=>i.status==="completed").length)||0,total_revenue:(s==null?void 0:s.filter(i=>i.status==="paid").reduce((i,o)=>i+(o.amount||0),0))||0,pending_invoices:(s==null?void 0:s.filter(i=>i.status==="sent").length)||0,overdue_invoices:(s==null?void 0:s.filter(i=>i.status==="overdue").length)||0}},`Get customer stats ${e}`)}static async searchCustomers(e,n=10){return Le(async()=>{const s=K.from("customers").select("*").or(`company_name.ilike.%${e}%,contact_person.ilike.%${e}%,email.ilike.%${e}%,customer_number.ilike.%${e}%`).order("company_name").limit(n);return nt(s).execute()},`Search customers: ${e}`)}static async generateCustomerNumber(){return Le(async()=>{const e=await na(),{data:n,error:s}=await K.rpc("get_next_number",{seq_name:"customers",comp_id:e.company_id});if(s)throw s;return n},"Generate customer number")}static async getCustomerProjects(e){return Le(async()=>{const n=K.from("projects").select(`
          *
        `).eq("customer_id",e).order("created_at",{ascending:!1});return nt(n).execute()},`Get customer projects ${e}`)}static async getCustomerQuotes(e){return Le(async()=>{const n=K.from("quotes").select("*").eq("customer_id",e).order("created_at",{ascending:!1});return nt(n).execute()},`Get customer quotes ${e}`)}static async getCustomerInvoices(e){return Le(async()=>{const n=K.from("invoices").select(`
          *,
          projects (
            name
          )
        `).eq("customer_id",e).order("created_at",{ascending:!1});return nt(n).execute()},`Get customer invoices ${e}`)}}const gH=new vg;class xH{constructor(){As(this,"subscriptions",new Map);As(this,"eventHistory",[]);As(this,"maxHistorySize",1e3)}on(e,n,s=!1){const a={id:this.generateId(),event:e,handler:n,once:s};return this.subscriptions.has(e)||this.subscriptions.set(e,[]),this.subscriptions.get(e).push(a),a.id}once(e,n){return this.on(e,n,!0)}off(e){for(const[n,s]of this.subscriptions.entries()){const a=s.findIndex(i=>i.id===e);if(a>=0){s.splice(a,1),s.length===0&&this.subscriptions.delete(n);break}}}async emit(e,n={}){const s={...n,timestamp:n.timestamp||new Date().toISOString()};this.addToHistory(e,s),this.shouldLogToAudit(e)&&await this.logToAuditTrail(e,s);const i=(this.subscriptions.get(e)||[]).map(async o=>{try{await o.handler(s),o.once&&this.off(o.id)}catch(c){console.error(`Event handler error for ${e}:`,c),e!=="SYSTEM_ERROR"&&this.emit("SYSTEM_ERROR",{error:c instanceof Error?c.message:"Unknown error",event:e,data:s})}});await Promise.all(i),await this.triggerWorkflowAutomations(e,s)}getHistory(e,n){let s=e?this.eventHistory.filter(a=>a.event===e):this.eventHistory;return n&&(s=s.slice(-n)),s}clearHistory(){this.eventHistory=[]}getSubscriptionCount(e){var s;if(e)return((s=this.subscriptions.get(e))==null?void 0:s.length)||0;let n=0;for(const a of this.subscriptions.values())n+=a.length;return n}generateId(){return`sub_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}addToHistory(e,n){this.eventHistory.push({event:e,data:{...n},timestamp:n.timestamp||new Date().toISOString()}),this.eventHistory.length>this.maxHistorySize&&this.eventHistory.shift()}shouldLogToAudit(e){return["QUOTE_SENT","QUOTE_ACCEPTED","QUOTE_REJECTED","ORDER_STARTED","ORDER_COMPLETED","ORDER_CANCELLED","PROJECT_STATUS_CHANGED","INVOICE_SENT","INVOICE_PAID","TIMESHEET_APPROVED","STOCK_ADJUSTED","DOCUMENT_UPLOADED","DOCUMENT_DELETED"].includes(e)}async logToAuditTrail(e,n){try{const s=this.extractAuditData(e,n);await K.from("audit_logs").insert({action:this.mapEventToAuditAction(e),table_name:this.extractTableName(e),record_id:s.recordId,old_values:s.oldValues,new_values:s.newValues,user_id:n.user_id,metadata:{event_type:e,...s.metadata}})}catch(s){console.error("Failed to log audit trail:",s)}}extractAuditData(e,n){var s,a,i,o,c,d,u,m;switch(e){case"QUOTE_ACCEPTED":case"QUOTE_REJECTED":return{recordId:(s=n.quote)==null?void 0:s.id,newValues:{status:(a=n.quote)==null?void 0:a.status},metadata:{reason:n.reason}};case"PROJECT_STATUS_CHANGED":return{recordId:(i=n.project)==null?void 0:i.id,oldValues:{status:n.previous_status},newValues:{status:n.new_status}};case"INVOICE_PAID":return{recordId:(o=n.invoice)==null?void 0:o.id,newValues:{status:"paid",paid_at:n.payment_date},metadata:{notes:n.notes}};case"STOCK_ADJUSTED":return{recordId:(c=n.material)==null?void 0:c.id,metadata:{adjustment:n.adjustment,reason:n.reason,reference:n.reference}};default:return{recordId:n.id||((d=n.quote)==null?void 0:d.id)||((u=n.project)==null?void 0:u.id)||((m=n.invoice)==null?void 0:m.id),metadata:{event_data:n}}}}mapEventToAuditAction(e){return{QUOTE_SENT:"STATUS_CHANGE",QUOTE_ACCEPTED:"STATUS_CHANGE",QUOTE_REJECTED:"STATUS_CHANGE",ORDER_STARTED:"STATUS_CHANGE",ORDER_COMPLETED:"STATUS_CHANGE",ORDER_CANCELLED:"STATUS_CHANGE",PROJECT_STATUS_CHANGED:"STATUS_CHANGE",INVOICE_SENT:"STATUS_CHANGE",INVOICE_PAID:"STATUS_CHANGE",TIMESHEET_APPROVED:"UPDATE",STOCK_ADJUSTED:"UPDATE",DOCUMENT_UPLOADED:"INSERT",DOCUMENT_DELETED:"DELETE"}[e]||"UPDATE"}extractTableName(e){return e.startsWith("QUOTE_")?"quotes":e.startsWith("ORDER_")?"orders":e.startsWith("PROJECT_")?"projects":e.startsWith("INVOICE_")?"invoices":e.startsWith("TIMESHEET_")?"timesheets":e.startsWith("MATERIAL_")||e.startsWith("STOCK_")?"materials":e.startsWith("DOCUMENT_")?"documents":"unknown"}async triggerWorkflowAutomations(e,n){try{switch(e){case"QUOTE_ACCEPTED":await this.sendNotification("quote_accepted",n);break;case"ORDER_COMPLETED":await this.autoCreateInvoice(n);break;case"INVOICE_SENT":await this.schedulePaymentReminders(n);break;case"MATERIAL_LOW_STOCK":await this.sendLowStockAlert(n);break;case"PROJECT_STATUS_CHANGED":await this.notifyProjectTeam(n);break;default:break}}catch(s){console.error(`Workflow automation error for ${e}:`,s)}}async sendNotification(e,n){console.log(`Notification: ${e}`,n)}async autoCreateInvoice(e){e.order&&console.log("Auto-creating invoice for order:",e.order.id)}async schedulePaymentReminders(e){e.invoice&&console.log("Scheduling payment reminders for invoice:",e.invoice.id)}async sendLowStockAlert(e){e.material&&console.log("Low stock alert for material:",e.material.name)}async notifyProjectTeam(e){e.project&&console.log("Notifying project team of status change:",e.project.name)}}const ot=new xH;ot.on("SYSTEM_ERROR",t=>{console.error("System error:",t)});ot.on("USER_LOGIN",t=>{console.log("User logged in:",t.user_id)});ot.on("USER_LOGOUT",t=>{console.log("User logged out:",t.user_id)});class vH{static async getOrders(e,n){return Le(async()=>{let s=K.from("orders").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          ),
          projects (
            name,
            status
          )
        `,{count:"exact"});if(n!=null&&n.status&&(s=s.eq("status",n.status)),n!=null&&n.customer_id&&(s=s.eq("customer_id",n.customer_id)),n!=null&&n.search&&(s=s.or(`title.ilike.%${n.search}%,description.ilike.%${n.search}%,order_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else s=s.order("created_at",{ascending:!1});const{data:a,count:i}=await nt(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get orders")}static async getOrder(e){return Le(async()=>{const n=K.from("orders").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          ),
          quotes (
            quote_number,
            title
          ),
          projects (
            name,
            status,
            start_date,
            end_date
          )
        `).eq("id",e);return nt(n).executeSingle()},`Get order ${e}`)}static async createOrder(e){return Le(async()=>{var m,f;const n=vs(gj,e),a=(((m=n.body)==null?void 0:m.items)||[]).reduce((p,y)=>p+y.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),c={...n,total_amount:o,status:"open"},d=K.from("orders").insert(c).select().single(),u=await nt(d).executeSingle();return ot.emit("ORDER_CREATED",{order:u,user_id:(f=(await K.auth.getUser()).data.user)==null?void 0:f.id}),u},"Create order")}static async createOrderFromQuote(e){return Le(async()=>{var a;if(e.status!=="accepted")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur akzeptierte Angebote können in Aufträge umgewandelt werden.",{quoteStatus:e.status});const n={customer_id:e.customer_id,quote_id:e.id,title:e.title,description:e.description,body:e.body,tax_rate:e.tax_rate,expected_delivery_date:e.valid_until||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]},s=await this.createOrder(n);return ot.emit("ORDER_CREATED_FROM_QUOTE",{order:s,quote:e,user_id:(a=(await K.auth.getUser()).data.user)==null?void 0:a.id}),s},`Create order from quote ${e.id}`)}static async updateOrder(e,n){return Le(async()=>{var c,d;const s=await this.getOrder(e);if(s.status==="completed")throw new Ye(Je.IMMUTABLE_RECORD,"Abgeschlossene Aufträge können nicht mehr bearbeitet werden.",{currentStatus:s.status});if(s.status==="in_progress"&&n.order_number)throw new Ye(Je.IMMUTABLE_RECORD,"Auftragsnummer kann nach dem Start nicht mehr geändert werden.",{currentStatus:s.status});const a=vs(oH,n);if((c=a.body)!=null&&c.items){const m=a.body.items.reduce((p,y)=>p+y.total_price,0),f=a.tax_rate||s.tax_rate||19;a.total_amount=m*(1+f/100)}const i=K.from("orders").update(a).eq("id",e).select().single(),o=await nt(i).executeSingle();return ot.emit("ORDER_UPDATED",{order:o,previous_order:s,changes:a,user_id:(d=(await K.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update order ${e}`)}static async startOrder(e){return Le(async()=>{var o;const n=await this.getOrder(e);if(n.status!=="open")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur offene Aufträge können gestartet werden.",{currentStatus:n.status});const s={status:"in_progress",started_at:new Date().toISOString()},a=K.from("orders").update(s).eq("id",e).select().single(),i=await nt(a).executeSingle();if(!i.project_id){const c={name:i.title,description:i.description,customer_id:i.customer_id,order_id:i.id,status:"active",start_date:new Date().toISOString().split("T")[0],budget:i.total_amount},{data:d}=await K.from("projects").insert(c).select().single();await K.from("orders").update({project_id:d==null?void 0:d.id}).eq("id",e)}return ot.emit("ORDER_STARTED",{order:i,user_id:(o=(await K.auth.getUser()).data.user)==null?void 0:o.id}),i},`Start order ${e}`)}static async completeOrder(e){return Le(async()=>{var o;const n=await this.getOrder(e);if(n.status!=="in_progress")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur laufende Aufträge können abgeschlossen werden.",{currentStatus:n.status});const s={status:"completed",completed_at:new Date().toISOString()},a=K.from("orders").update(s).eq("id",e).select().single(),i=await nt(a).executeSingle();return i.project_id&&await K.from("projects").update({status:"completed",end_date:new Date().toISOString().split("T")[0]}).eq("id",i.project_id),ot.emit("ORDER_COMPLETED",{order:i,user_id:(o=(await K.auth.getUser()).data.user)==null?void 0:o.id}),i},`Complete order ${e}`)}static async cancelOrder(e,n){return Le(async()=>{var c;const s=await this.getOrder(e);if(s.status==="completed")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Abgeschlossene Aufträge können nicht storniert werden.",{currentStatus:s.status});const a={status:"cancelled",description:n?`${s.description||""}

Stornierungsgrund: ${n}`.trim():s.description},i=K.from("orders").update(a).eq("id",e).select().single(),o=await nt(i).executeSingle();return o.project_id&&await K.from("projects").update({status:"cancelled"}).eq("id",o.project_id),ot.emit("ORDER_CANCELLED",{order:o,reason:n,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),o},`Cancel order ${e}`)}static async getOrderStats(){return Le(async()=>{const e=K.from("orders").select("status, total_amount, created_at, completed_at"),n=await nt(e).execute(),s={total:n.length,by_status:{open:0,in_progress:0,completed:0,cancelled:0},total_value:{open:0,in_progress:0,completed:0,cancelled:0},avg_completion_time:0};let a=0,i=0;return n.forEach(o=>{if(s.by_status[o.status]++,s.total_value[o.status]+=o.total_amount||0,o.status==="completed"&&o.completed_at){const c=new Date(o.completed_at).getTime()-new Date(o.created_at).getTime();a+=c/(1e3*60*60*24),i++}}),i>0&&(s.avg_completion_time=a/i),s},"Get order statistics")}static async deleteOrder(e){return Le(async()=>{var a;const n=await this.getOrder(e);if(n.status!=="open")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur offene Aufträge können gelöscht werden.",{currentStatus:n.status});if(n.project_id)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Aufträge mit verknüpften Projekten können nicht gelöscht werden.",{projectId:n.project_id});const{error:s}=await K.from("orders").delete().eq("id",e);if(s)throw s;ot.emit("ORDER_DELETED",{order:n,user_id:(a=(await K.auth.getUser()).data.user)==null?void 0:a.id})},`Delete order ${e}`)}static async duplicateOrder(e){return Le(async()=>{const n=await this.getOrder(e),s={customer_id:n.customer_id,title:`${n.title} (Kopie)`,description:n.description,body:n.body,tax_rate:n.tax_rate,expected_delivery_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]};return this.createOrder(s)},`Duplicate order ${e}`)}}const yH=new vH;class _H{static async getQuotes(e,n){return Le(async()=>{let s=K.from("quotes").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          )
        `,{count:"exact"});if(n!=null&&n.status&&(s=s.eq("status",n.status)),n!=null&&n.customer_id&&(s=s.eq("customer_id",n.customer_id)),n!=null&&n.search&&(s=s.or(`title.ilike.%${n.search}%,description.ilike.%${n.search}%,quote_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else s=s.order("created_at",{ascending:!1});const{data:a,count:i}=await nt(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get quotes")}static async getQuote(e){return Le(async()=>{const n=K.from("quotes").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          )
        `).eq("id",e);return nt(n).executeSingle()},`Get quote ${e}`)}static async createQuote(e){return Le(async()=>{var m,f;const n=vs(pj,e),a=(((m=n.body)==null?void 0:m.items)||[]).reduce((p,y)=>p+y.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),c={...n,total_net:a,total_gross:o,status:"draft"},d=K.from("quotes").insert(c).select().single(),u=await nt(d).executeSingle();return ot.emit("QUOTE_CREATED",{quote:u,user_id:(f=(await K.auth.getUser()).data.user)==null?void 0:f.id}),u},"Create quote")}static async updateQuote(e,n){return Le(async()=>{var c,d;const s=await this.getQuote(e);if(s.status==="accepted")throw new Ye(Je.IMMUTABLE_RECORD,"Akzeptierte Angebote können nicht mehr bearbeitet werden.",{currentStatus:s.status});if(s.status==="sent"&&n.quote_number)throw new Ye(Je.IMMUTABLE_RECORD,"Angebotsnummer kann nach dem Versand nicht mehr geändert werden.",{currentStatus:s.status});const a=vs(iH,n);if((c=a.body)!=null&&c.items){const m=a.body.items.reduce((p,y)=>p+y.total_price,0),f=a.tax_rate||s.tax_rate||19;a.total_net=m,a.total_gross=m*(1+f/100)}const i=K.from("quotes").update(a).eq("id",e).select().single(),o=await nt(i).executeSingle();return ot.emit("QUOTE_UPDATED",{quote:o,previous_quote:s,changes:a,user_id:(d=(await K.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update quote ${e}`)}static async sendQuote(e){return Le(async()=>{var o,c;const n=await this.getQuote(e);if(n.status!=="draft")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können versendet werden.",{currentStatus:n.status});if(!((o=n.body)!=null&&o.items)||n.body.items.length===0)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Angebot muss mindestens eine Position enthalten.");if(!n.valid_until)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Gültigkeitsdatum ist erforderlich.");const s={status:"sent",sent_at:new Date().toISOString()},a=K.from("quotes").update(s).eq("id",e).select().single(),i=await nt(a).executeSingle();return ot.emit("QUOTE_SENT",{quote:i,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),i},`Send quote ${e}`)}static async acceptQuote(e){return Le(async()=>{var c;const n=await this.getQuote(e);if(n.status!=="sent")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur versendete Angebote können angenommen werden.",{currentStatus:n.status});if(n.valid_until&&new Date(n.valid_until)<new Date)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Das Angebot ist bereits abgelaufen.",{validUntil:n.valid_until});const s={status:"accepted",accepted_at:new Date().toISOString()},a=K.from("quotes").update(s).eq("id",e).select().single(),i=await nt(a).executeSingle(),o=await yH.createOrderFromQuote(i);return ot.emit("QUOTE_ACCEPTED",{quote:i,order:o,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),{quote:i,order:o}},`Accept quote ${e}`)}static async rejectQuote(e,n){return Le(async()=>{var c;const s=await this.getQuote(e);if(s.status!=="sent")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur versendete Angebote können abgelehnt werden.",{currentStatus:s.status});const a={status:"rejected",description:n?`${s.description||""}

Ablehnungsgrund: ${n}`.trim():s.description},i=K.from("quotes").update(a).eq("id",e).select().single(),o=await nt(i).executeSingle();return ot.emit("QUOTE_REJECTED",{quote:o,reason:n,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),o},`Reject quote ${e}`)}static async getQuoteStats(){return Le(async()=>{const e=K.from("quotes").select("status, total_gross"),n=await nt(e).execute(),s={total:n.length,by_status:{draft:0,sent:0,accepted:0,rejected:0,expired:0},total_value:{draft:0,sent:0,accepted:0,rejected:0,expired:0},conversion_rate:0};n.forEach(i=>{s.by_status[i.status]++,s.total_value[i.status]+=i.total_gross||0});const a=s.by_status.sent+s.by_status.accepted+s.by_status.rejected;return a>0&&(s.conversion_rate=s.by_status.accepted/a*100),s},"Get quote statistics")}static async deleteQuote(e){return Le(async()=>{var a;const n=await this.getQuote(e);if(n.status!=="draft")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können gelöscht werden.",{currentStatus:n.status});const{error:s}=await K.from("quotes").delete().eq("id",e);if(s)throw s;ot.emit("QUOTE_DELETED",{quote:n,user_id:(a=(await K.auth.getUser()).data.user)==null?void 0:a.id})},`Delete quote ${e}`)}static async duplicateQuote(e){return Le(async()=>{const n=await this.getQuote(e),s={customer_id:n.customer_id,title:`${n.title} (Kopie)`,description:n.description,body:n.body,tax_rate:n.tax_rate,valid_until:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]};return this.createQuote(s)},`Duplicate quote ${e}`)}}const yg=new _H;class uT{static async getProjects(e,n){return Le(async()=>{let s=K.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          )
        `,{count:"exact"});if(n!=null&&n.status&&(s=s.eq("status",n.status)),n!=null&&n.customer_id&&(s=s.eq("customer_id",n.customer_id)),n!=null&&n.employee_id&&(s=s.contains("assigned_employees",[n.employee_id])),n!=null&&n.search&&(s=s.or(`name.ilike.%${n.search}%,description.ilike.%${n.search}%,project_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else s=s.order("created_at",{ascending:!1});const{data:a,count:i}=await nt(s).executeWithCount();return console.log("ProjectService.getProjects:",{query:s.toString(),data:a,count:i,pagination:e,filters:n}),{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get projects")}static async getProject(e){return Le(async()=>{const n=K.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          )
        `).eq("id",e);return nt(n).executeSingle()},`Get project ${e}`)}static async createProject(e){return Le(async()=>{var o;const n=vs(xj,e),s={...n,status:"planned",assigned_employees:n.assigned_employees||[]},a=K.from("projects").insert(s).select().single(),i=await nt(a).executeSingle();return ot.emit("PROJECT_CREATED",{project:i,user_id:(o=(await K.auth.getUser()).data.user)==null?void 0:o.id}),i},"Create project")}static async updateProject(e,n){return Le(async()=>{var c,d;const s=await this.getProject(e);if(s.status==="completed"&&n.status!=="completed")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Abgeschlossene Projekte können nicht wieder aktiviert werden.",{currentStatus:s.status});const a=vs(lH,n);a.status&&a.status!==s.status&&(await this.validateStatusTransition(s.status,a.status),a.status==="active"&&!s.start_date?a.start_date=new Date().toISOString().split("T")[0]:a.status==="completed"&&!a.end_date&&(a.end_date=new Date().toISOString().split("T")[0]));const i=K.from("projects").update(a).eq("id",e).select().single(),o=await nt(i).executeSingle();return a.status&&a.status!==s.status&&ot.emit("PROJECT_STATUS_CHANGED",{project:o,previous_status:s.status,new_status:a.status,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),ot.emit("PROJECT_UPDATED",{project:o,previous_project:s,changes:a,user_id:(d=(await K.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update project ${e}`)}static async validateStatusTransition(e,n){const s={planned:["active","cancelled"],active:["blocked","completed","cancelled"],blocked:["active","cancelled"],completed:[],cancelled:[]};if(!s[e].includes(n))throw new Ye(Je.BUSINESS_RULE_VIOLATION,`Ungültiger Statuswechsel von "${e}" zu "${n}".`,{from:e,to:n,validTransitions:s[e]})}static async startProject(e){return Le(async()=>{const n=await this.getProject(e);if(n.status!=="planned")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur geplante Projekte können gestartet werden.",{currentStatus:n.status});const s={status:"active",start_date:new Date().toISOString().split("T")[0]};return this.updateProject(e,s)},`Start project ${e}`)}static async completeProject(e){return Le(async()=>{const n=await this.getProject(e);if(n.status!=="active")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur aktive Projekte können abgeschlossen werden.",{currentStatus:n.status});const s={status:"completed",end_date:new Date().toISOString().split("T")[0]};return this.updateProject(e,s)},`Complete project ${e}`)}static async blockProject(e,n){return Le(async()=>{const s=await this.getProject(e);if(s.status!=="active")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur aktive Projekte können blockiert werden.",{currentStatus:s.status});const a={status:"blocked",description:n?`${s.description||""}

Blockiert: ${n}`.trim():s.description};return this.updateProject(e,a)},`Block project ${e}`)}static async unblockProject(e){return Le(async()=>{const n=await this.getProject(e);if(n.status!=="blocked")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur blockierte Projekte können entsperrt werden.",{currentStatus:n.status});const s={status:"active"};return this.updateProject(e,s)},`Unblock project ${e}`)}static async cancelProject(e,n){return Le(async()=>{const s=await this.getProject(e);if(s.status==="completed")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Abgeschlossene Projekte können nicht storniert werden.",{currentStatus:s.status});const a={status:"cancelled",description:n?`${s.description||""}

Storniert: ${n}`.trim():s.description};return this.updateProject(e,a)},`Cancel project ${e}`)}static async getProjectStats(e){return Le(async()=>{var j;const n=await this.getProject(e),{data:s}=await K.from("timesheets").select("hours, hourly_rate").eq("project_id",e),{data:a}=await K.from("materials").select("quantity, unit_cost").eq("project_id",e),{data:i}=await K.from("expenses").select("amount").eq("project_id",e),o=(s==null?void 0:s.reduce((v,_)=>v+(_.hours||0),0))||0,c=(a==null?void 0:a.reduce((v,_)=>v+(_.quantity*_.unit_cost||0),0))||0,d=(i==null?void 0:i.reduce((v,_)=>v+(_.amount||0),0))||0,m=c+d,f=Math.max(0,(n.budget||0)-m);let p=0;if(n.start_date){const v=new Date(n.start_date),_=n.end_date?new Date(n.end_date):new Date;p=Math.ceil((_.getTime()-v.getTime())/(1e3*60*60*24))}const y={planned:0,active:50,blocked:50,completed:100,cancelled:0}[n.status];return{total_hours:o,total_material_cost:c,total_expenses:d,budget_used:m,budget_remaining:f,days_active:p,team_size:((j=n.assigned_employees)==null?void 0:j.length)||0,completion_percentage:y}},`Get project stats ${e}`)}static async getProjectTimeline(e,n=50){return Le(async()=>{const{data:s}=await K.from("timesheets").select(`
          id, date, hours, description, created_at,
          employees (name)
        `).eq("project_id",e).order("created_at",{ascending:!1}).limit(n/2),{data:a}=await K.from("materials").select(`
          id, name, quantity, unit_cost, created_at,
          employees (name)
        `).eq("project_id",e).order("created_at",{ascending:!1}).limit(n/2);return[...(s==null?void 0:s.map(o=>{var c;return{id:o.id,type:"timesheet",title:`Arbeitszeit erfasst: ${o.hours}h`,description:o.description,user:((c=o.employees)==null?void 0:c.name)||"Unbekannt",timestamp:o.created_at}}))||[],...(a==null?void 0:a.map(o=>{var c;return{id:o.id,type:"material",title:`Material hinzugefügt: ${o.name}`,description:`${o.quantity} × ${o.unit_cost}€`,user:((c=o.employees)==null?void 0:c.name)||"Unbekannt",timestamp:o.created_at}}))||[]].sort((o,c)=>new Date(c.timestamp).getTime()-new Date(o.timestamp).getTime()).slice(0,n)},`Get project timeline ${e}`)}static async assignEmployee(e,n){return Le(async()=>{const a=(await this.getProject(e)).assigned_employees||[];if(a.includes(n))throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Mitarbeiter ist bereits dem Projekt zugewiesen.",{employeeId:n});const i=[...a,n];return this.updateProject(e,{assigned_employees:i})},`Assign employee to project ${e}`)}static async removeEmployee(e,n){return Le(async()=>{const i=((await this.getProject(e)).assigned_employees||[]).filter(o=>o!==n);return this.updateProject(e,{assigned_employees:i})},`Remove employee from project ${e}`)}static async deleteProject(e){return Le(async()=>{var i;const n=await this.getProject(e);if(!["planned","cancelled"].includes(n.status))throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur geplante oder stornierte Projekte können gelöscht werden.",{currentStatus:n.status});const{data:s}=await K.from("timesheets").select("id").eq("project_id",e).limit(1);if(s&&s.length>0)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Projekt kann nicht gelöscht werden, da bereits Arbeitszeiten erfasst wurden.");const{error:a}=await K.from("projects").delete().eq("id",e);if(a)throw a;ot.emit("PROJECT_DELETED",{project:n,user_id:(i=(await K.auth.getUser()).data.user)==null?void 0:i.id})},`Delete project ${e}`)}static async searchProjects(e,n=10){return Le(async()=>{const s=K.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person
          )
        `).or(`name.ilike.%${e}%,description.ilike.%${e}%,project_number.ilike.%${e}%`).order("name").limit(n);return nt(s).execute()},`Search projects: ${e}`)}}class wH{static async getTimesheets(e,n){return Le(async()=>{let s=K.from("timesheets").select(`
          *,
          projects (
            name,
            project_number
          ),
          employees (
            name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.project_id&&(s=s.eq("project_id",n.project_id)),n!=null&&n.employee_id&&(s=s.eq("employee_id",n.employee_id)),n!=null&&n.date_from&&(s=s.gte("date",n.date_from)),n!=null&&n.date_to&&(s=s.lte("date",n.date_to)),(n==null?void 0:n.approved)!==void 0&&(n.approved?s=s.not("approved_at","is",null):s=s.is("approved_at",null)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"date",{ascending:e.sort_order==="asc"})}else s=s.order("date",{ascending:!1});const{data:a,count:i}=await nt(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get timesheets")}static async getTimesheet(e){return Le(async()=>{const n=K.from("timesheets").select(`
          *,
          projects (
            name,
            project_number,
            status
          ),
          employees (
            name,
            email,
            hourly_rate
          )
        `).eq("id",e);return nt(n).executeSingle()},`Get timesheet ${e}`)}static async createTimesheet(e){return Le(async()=>{var i;const n=vs(yj,e);if(!n.hourly_rate&&n.employee_id){const{data:o}=await K.from("employees").select("hourly_rate").eq("id",n.employee_id).single();o!=null&&o.hourly_rate&&(n.hourly_rate=o.hourly_rate)}n.hours&&n.hourly_rate&&(n.total_cost=n.hours*n.hourly_rate),await this.validateTimesheetEntry(n);const s=K.from("timesheets").insert(n).select().single(),a=await nt(s).executeSingle();return ot.emit("TIMESHEET_CREATED",{timesheet:a,user_id:(i=(await K.auth.getUser()).data.user)==null?void 0:i.id}),a},"Create timesheet")}static async updateTimesheet(e,n){return Le(async()=>{var u;const s=await this.getTimesheet(e);if(s.approved_at)throw new Ye(Je.IMMUTABLE_RECORD,"Genehmigte Zeiteinträge können nicht mehr bearbeitet werden.",{approvedAt:s.approved_at});const a=await na();if(s.employee_id!==a.id&&!a.is_admin)throw new Ye(Je.UNAUTHORIZED,"Sie können nur Ihre eigenen Zeiteinträge bearbeiten.");const i=vs(dH,n);if(i.hours||i.hourly_rate){const m=i.hours||s.hours,f=i.hourly_rate||s.hourly_rate;m&&f&&(i.total_cost=m*f)}const o={...s,...i};await this.validateTimesheetEntry(o);const c=K.from("timesheets").update(i).eq("id",e).select().single(),d=await nt(c).executeSingle();return ot.emit("TIMESHEET_UPDATED",{timesheet:d,previous_timesheet:s,changes:i,user_id:(u=(await K.auth.getUser()).data.user)==null?void 0:u.id}),d},`Update timesheet ${e}`)}static async approveTimesheet(e){return Le(async()=>{const n=await this.getTimesheet(e);if(n.approved_at)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Zeiteintrag ist bereits genehmigt.",{approvedAt:n.approved_at});const s=await na();if(!s.is_admin&&!s.is_project_manager)throw new Ye(Je.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge genehmigen.");const a={approved_at:new Date().toISOString(),approved_by:s.id},i=K.from("timesheets").update(a).eq("id",e).select().single(),o=await nt(i).executeSingle();return ot.emit("TIMESHEET_APPROVED",{timesheet:o,approved_by:s.id,user_id:s.id}),o},`Approve timesheet ${e}`)}static async rejectTimesheet(e,n){return Le(async()=>{const s=await this.getTimesheet(e),a=await na();if(!a.is_admin&&!a.is_project_manager)throw new Ye(Je.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge ablehnen.");const i={approved_at:null,approved_by:null,description:n?`${s.description||""}

Abgelehnt: ${n}`.trim():s.description},o=K.from("timesheets").update(i).eq("id",e).select().single(),c=await nt(o).executeSingle();return ot.emit("TIMESHEET_REJECTED",{timesheet:c,reason:n,rejected_by:a.id,user_id:a.id}),c},`Reject timesheet ${e}`)}static async validateTimesheetEntry(e){if(e.employee_id&&e.date&&e.start_time&&e.end_time){const{data:n}=await K.from("timesheets").select("id").eq("employee_id",e.employee_id).eq("date",e.date).neq("id",e.id||"").or(`start_time.lte.${e.start_time}.and.end_time.gt.${e.start_time},start_time.lt.${e.end_time}.and.end_time.gte.${e.end_time}`);if(n&&n.length>0)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Überschneidende Arbeitszeiten am selben Tag sind nicht erlaubt.")}if(e.hours&&e.hours>12)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Maximale Arbeitszeit von 12 Stunden pro Tag überschritten.",{hours:e.hours});if(e.date&&new Date(e.date)>new Date)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Zeiteinträge für zukünftige Daten sind nicht erlaubt.");if(e.project_id){const{data:n}=await K.from("projects").select("status").eq("id",e.project_id).single();if(n&&!["active","blocked"].includes(n.status))throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Zeiteinträge können nur für aktive oder blockierte Projekte erfasst werden.",{projectStatus:n.status})}}static async getEmployeeTimesheetStats(e,n,s){return Le(async()=>{let a=K.from("timesheets").select("hours, total_cost, approved_at, overtime_hours").eq("employee_id",e);n&&(a=a.gte("date",n)),s&&(a=a.lte("date",s));const i=await nt(a).execute(),o=i.reduce((d,u)=>{const m=u.hours||0,f=u.total_cost||0,p=u.overtime_hours||0;return d.total_hours+=m,d.total_cost+=f,d.overtime_hours+=p,u.approved_at?d.approved_hours+=m:d.pending_hours+=m,d},{total_hours:0,total_cost:0,approved_hours:0,pending_hours:0,days_worked:0,avg_hours_per_day:0,overtime_hours:0}),c=new Set(i.map(d=>d.date));return o.days_worked=c.size,o.days_worked>0&&(o.avg_hours_per_day=o.total_hours/o.days_worked),o},`Get employee timesheet stats ${e}`)}static async getProjectTimesheetSummary(e){return Le(async()=>{const n=K.from("timesheets").select(`
          hours,
          total_cost,
          date,
          employee_id,
          employees (
            name
          )
        `).eq("project_id",e),s=await nt(n).execute(),a=s.reduce((d,u)=>d+(u.hours||0),0),i=s.reduce((d,u)=>d+(u.total_cost||0),0),o=s.reduce((d,u)=>{var f;const m=u.employee_id;return d[m]||(d[m]={employee_id:m,employee_name:((f=u.employees)==null?void 0:f.name)||"Unbekannt",hours:0,cost:0}),d[m].hours+=u.hours||0,d[m].cost+=u.total_cost||0,d},{}),c=s.reduce((d,u)=>{const m=u.date;return d[m]||(d[m]={date:m,hours:0,cost:0}),d[m].hours+=u.hours||0,d[m].cost+=u.total_cost||0,d},{});return{total_hours:a,total_cost:i,by_employee:Object.values(o),by_date:Object.values(c).sort((d,u)=>d.date.localeCompare(u.date))}},`Get project timesheet summary ${e}`)}static async deleteTimesheet(e){return Le(async()=>{const n=await this.getTimesheet(e);if(n.approved_at)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Genehmigte Zeiteinträge können nicht gelöscht werden.",{approvedAt:n.approved_at});const s=await na();if(n.employee_id!==s.id&&!s.is_admin)throw new Ye(Je.UNAUTHORIZED,"Sie können nur Ihre eigenen Zeiteinträge löschen.");const{error:a}=await K.from("timesheets").delete().eq("id",e);if(a)throw a;ot.emit("TIMESHEET_DELETED",{timesheet:n,user_id:s.id})},`Delete timesheet ${e}`)}static async bulkApproveTimesheets(e){return Le(async()=>{const n=await na();if(!n.is_admin&&!n.is_project_manager)throw new Ye(Je.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge genehmigen.");const s={approved_at:new Date().toISOString(),approved_by:n.id},a=K.from("timesheets").update(s).in("id",e).is("approved_at",null).select(),i=await nt(a).execute();return i.forEach(o=>{ot.emit("TIMESHEET_APPROVED",{timesheet:o,approved_by:n.id,user_id:n.id})}),i},"Bulk approve timesheets")}}const wj=new wH;class bH{static async getInvoices(e,n){return Le(async()=>{let s=K.from("invoices").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          ),
          projects (
            name,
            project_number
          )
        `,{count:"exact"});if(n!=null&&n.status&&(s=s.eq("status",n.status)),n!=null&&n.customer_id&&(s=s.eq("customer_id",n.customer_id)),n!=null&&n.project_id&&(s=s.eq("project_id",n.project_id)),n!=null&&n.overdue&&(s=s.eq("status","sent").lt("due_date",new Date().toISOString().split("T")[0])),n!=null&&n.date_from&&(s=s.gte("invoice_date",n.date_from)),n!=null&&n.date_to&&(s=s.lte("invoice_date",n.date_to)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else s=s.order("created_at",{ascending:!1});const{data:a,count:i}=await nt(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get invoices")}static async getInvoice(e){return Le(async()=>{const n=K.from("invoices").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          ),
          projects (
            name,
            project_number,
            status
          )
        `).eq("id",e);return nt(n).executeSingle()},`Get invoice ${e}`)}static async createInvoice(e){return Le(async()=>{var m,f;const n=vs(vj,e),a=(((m=n.body)==null?void 0:m.items)||[]).reduce((p,y)=>p+y.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),c={...n,total_net:a,total_gross:o,amount:o,status:"draft",due_date:n.due_date||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]},d=K.from("invoices").insert(c).select().single(),u=await nt(d).executeSingle();return ot.emit("INVOICE_CREATED",{invoice:u,user_id:(f=(await K.auth.getUser()).data.user)==null?void 0:f.id}),u},"Create invoice")}static async updateInvoice(e,n){return Le(async()=>{var c,d;const s=await this.getInvoice(e);if(s.status==="paid")throw new Ye(Je.IMMUTABLE_RECORD,"Bezahlte Rechnungen können nicht mehr bearbeitet werden.",{currentStatus:s.status});if(s.status==="sent"&&n.invoice_number)throw new Ye(Je.IMMUTABLE_RECORD,"Rechnungsnummer kann nach dem Versand nicht mehr geändert werden.",{currentStatus:s.status});const a=vs(cH,n);if((c=a.body)!=null&&c.items){const m=a.body.items.reduce((p,y)=>p+y.total_price,0),f=a.tax_rate||s.tax_rate||19;a.total_net=m,a.total_gross=m*(1+f/100),a.amount=a.total_gross}const i=K.from("invoices").update(a).eq("id",e).select().single(),o=await nt(i).executeSingle();return ot.emit("INVOICE_UPDATED",{invoice:o,previous_invoice:s,changes:a,user_id:(d=(await K.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update invoice ${e}`)}static async sendInvoice(e){return Le(async()=>{var o,c;const n=await this.getInvoice(e);if(n.status!=="draft")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können versendet werden.",{currentStatus:n.status});if(!((o=n.body)!=null&&o.items)||n.body.items.length===0)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Rechnung muss mindestens eine Position enthalten.");const s={status:"sent",sent_at:new Date().toISOString()},a=K.from("invoices").update(s).eq("id",e).select().single(),i=await nt(a).executeSingle();return ot.emit("INVOICE_SENT",{invoice:i,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),i},`Send invoice ${e}`)}static async markInvoicePaid(e,n,s){return Le(async()=>{var d;const a=await this.getInvoice(e);if(a.status!=="sent")throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Nur versendete Rechnungen können als bezahlt markiert werden.",{currentStatus:a.status});const i={status:"paid",paid_at:n||new Date().toISOString(),notes:s?`${a.notes||""}

Zahlung: ${s}`.trim():a.notes},o=K.from("invoices").update(i).eq("id",e).select().single(),c=await nt(o).executeSingle();return ot.emit("INVOICE_PAID",{invoice:c,payment_date:n,notes:s,user_id:(d=(await K.auth.getUser()).data.user)==null?void 0:d.id}),c},`Mark invoice paid ${e}`)}static async getExpenses(e,n){return Le(async()=>{let s=K.from("expenses").select(`
          *,
          projects (
            name,
            project_number
          ),
          employees (
            name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.category&&(s=s.eq("category",n.category)),n!=null&&n.project_id&&(s=s.eq("project_id",n.project_id)),n!=null&&n.employee_id&&(s=s.eq("employee_id",n.employee_id)),n!=null&&n.date_from&&(s=s.gte("expense_date",n.date_from)),n!=null&&n.date_to&&(s=s.lte("expense_date",n.date_to)),(n==null?void 0:n.approved)!==void 0&&(n.approved?s=s.not("approved_at","is",null):s=s.is("approved_at",null)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"expense_date",{ascending:e.sort_order==="asc"})}else s=s.order("expense_date",{ascending:!1});const{data:a,count:i}=await nt(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get expenses")}static async createExpense(e){return Le(async()=>{var i;const n=vs(_j,e),s=K.from("expenses").insert(n).select().single(),a=await nt(s).executeSingle();return ot.emit("EXPENSE_CREATED",{expense:a,user_id:(i=(await K.auth.getUser()).data.user)==null?void 0:i.id}),a},"Create expense")}static async approveExpense(e){return Le(async()=>{const n=await na();if(!n.is_admin&&!n.is_project_manager)throw new Ye(Je.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Ausgaben genehmigen.");const s={approved_at:new Date().toISOString(),approved_by:n.id},a=K.from("expenses").update(s).eq("id",e).select().single(),i=await nt(a).executeSingle();return ot.emit("EXPENSE_APPROVED",{expense:i,approved_by:n.id,user_id:n.id}),i},`Approve expense ${e}`)}static async getFinancialKPIs(e){return Le(async()=>{const n=new Date,s=new Date(n.getFullYear(),n.getMonth(),1).toISOString().split("T")[0],a=new Date(n.getFullYear(),n.getMonth()-1,1).toISOString().split("T")[0],i=new Date(n.getFullYear(),n.getMonth(),0).toISOString().split("T")[0],o=K.from("invoices").select("amount, status, invoice_date, paid_at"),c=await nt(o).execute(),d=K.from("expenses").select("amount, expense_date, approved_at"),u=await nt(d).execute(),m=c.filter(D=>D.status==="paid").reduce((D,M)=>D+(M.amount||0),0),f=c.filter(D=>D.status==="paid"&&D.paid_at&&D.paid_at>=s).reduce((D,M)=>D+(M.amount||0),0),p=c.filter(D=>D.status==="paid"&&D.paid_at&&D.paid_at>=a&&D.paid_at<=i).reduce((D,M)=>D+(M.amount||0),0),y=p>0?(f-p)/p*100:0,j=u.filter(D=>D.approved_at).reduce((D,M)=>D+(M.amount||0),0),v=u.filter(D=>D.approved_at&&D.expense_date>=s).reduce((D,M)=>D+(M.amount||0),0),_=u.filter(D=>D.approved_at&&D.expense_date>=a&&D.expense_date<=i).reduce((D,M)=>D+(M.amount||0),0),b=c.filter(D=>D.status==="sent"),w=b.filter(D=>D.due_date&&D.due_date<new Date().toISOString().split("T")[0]),N=b.reduce((D,M)=>D+(M.amount||0),0),S=w.reduce((D,M)=>D+(M.amount||0),0),A=f-v,E=f>0?A/f*100:0;return{revenue:{total:m,this_month:f,last_month:p,growth_rate:y},expenses:{total:j,this_month:v,last_month:_},profit:{total:m-j,this_month:A,margin:E},outstanding:{total:N,overdue:S,count:b.length},cash_flow:{inflow:f,outflow:v,net:f-v}}},"Get financial KPIs")}static async getRevenueByMonth(e=12){return Le(async()=>{const n=await nt(K.from("invoices").select("amount, status, paid_at").eq("status","paid").not("paid_at","is",null).gte("paid_at",new Date(Date.now()-e*30*24*60*60*1e3).toISOString())).execute(),s={};return n.forEach(a=>{if(a.paid_at){const i=a.paid_at.substring(0,7);s[i]||(s[i]={revenue:0,invoices:0}),s[i].revenue+=a.amount||0,s[i].invoices+=1}}),Object.entries(s).map(([a,i])=>({month:a,revenue:i.revenue,invoices:i.invoices})).sort((a,i)=>a.month.localeCompare(i.month))},"Get revenue by month")}static async getExpensesByCategory(e){return Le(async()=>{let n=K.from("expenses").select("category, amount").not("approved_at","is",null);e&&(n=n.gte("expense_date",e.from).lte("expense_date",e.to));const s=await nt(n).execute(),a={};return s.forEach(i=>{const o=i.category||"Sonstige";a[o]||(a[o]={amount:0,count:0}),a[o].amount+=i.amount||0,a[o].count+=1}),Object.entries(a).map(([i,o])=>({category:i,amount:o.amount,count:o.count})).sort((i,o)=>o.amount-i.amount)},"Get expenses by category")}static async getProfitLossReport(e){return Le(async()=>{const s=(await nt(K.from("invoices").select("amount").eq("status","paid").gte("paid_at",e.from).lte("paid_at",e.to)).execute()).reduce((m,f)=>m+(f.amount||0),0),a=await nt(K.from("expenses").select("amount, category").not("approved_at","is",null).gte("expense_date",e.from).lte("expense_date",e.to)).execute(),i=a.filter(m=>["Material","Equipment","Subcontractor"].includes(m.category||"")).reduce((m,f)=>m+(f.amount||0),0),o=a.filter(m=>!["Material","Equipment","Subcontractor"].includes(m.category||"")).reduce((m,f)=>m+(f.amount||0),0),c=s-i,d=c-o,u=s>0?d/s*100:0;return{revenue:s,cost_of_goods:i,gross_profit:c,operating_expenses:o,net_profit:d,margin:u}},"Get profit/loss report")}}const _g=new bH;class jH{static async getDocuments(e,n){return Le(async()=>{var o;let s=K.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name,
            contact_person
          ),
          uploaded_by_user:profiles!uploaded_by (
            first_name,
            last_name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.category&&(s=s.eq("category",n.category)),n!=null&&n.legal_category&&(s=s.eq("legal_category",n.legal_category)),n!=null&&n.project_id&&(s=s.eq("project_id",n.project_id)),n!=null&&n.customer_id&&(s=s.eq("customer_id",n.customer_id)),n!=null&&n.uploaded_by&&(s=s.eq("uploaded_by",n.uploaded_by)),(o=n==null?void 0:n.tags)!=null&&o.length&&(s=s.overlaps("tags",n.tags)),n!=null&&n.date_from&&(s=s.gte("uploaded_at",n.date_from)),n!=null&&n.date_to&&(s=s.lte("uploaded_at",n.date_to)),n!=null&&n.search&&(s=s.or(`filename.ilike.%${n.search}%,original_filename.ilike.%${n.search}%,description.ilike.%${n.search}%`)),e){const c=(e.page-1)*e.limit;s=s.range(c,c+e.limit-1).order(e.sort_by||"uploaded_at",{ascending:e.sort_order==="asc"})}else s=s.order("uploaded_at",{ascending:!1});const{data:a,count:i}=await nt(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get documents")}static async getDocument(e){return Le(async()=>{const n=K.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name,
            contact_person
          ),
          uploaded_by_user:profiles!uploaded_by (
            first_name,
            last_name,
            email
          )
        `).eq("id",e);return nt(n).executeSingle()},`Get document ${e}`)}static async uploadDocument(e){return Le(async()=>{const n=await na(),s=e.file;if(s.size>50*1024*1024)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Dateigröße darf 50MB nicht überschreiten.",{fileSize:s.size});const a=s.name.split(".").pop()||"",i=Date.now(),o=Math.random().toString(36).substring(2,15),c=`${i}_${o}.${a}`,u=`${this.getStorageFolder(e.category)}/${c}`,{data:m,error:f}=await K.storage.from("documents").upload(u,s,{cacheControl:"3600",upsert:!1});if(f)throw new Ye(Je.STORAGE_ERROR,`Fehler beim Upload: ${f.message}`,{uploadError:f});let p;if(e.is_public){const{data:b}=K.storage.from("documents").getPublicUrl(u);p=b.publicUrl}let y;if(e.legal_category){const b=this.getRetentionPeriod(e.legal_category);y=new Date(Date.now()+b*365*24*60*60*1e3).toISOString().split("T")[0]}const j={filename:c,original_filename:s.name,file_size:s.size,mime_type:s.type,category:e.category,legal_category:e.legal_category,description:e.description,tags:e.tags||[],project_id:e.project_id,customer_id:e.customer_id,invoice_id:e.invoice_id,expense_id:e.expense_id,storage_path:u,public_url:p,is_public:e.is_public||!1,retention_until:y,uploaded_by:n.id,uploaded_at:new Date().toISOString()},v=K.from("documents").insert(j).select().single(),_=await nt(v).executeSingle();return e.legal_category&&await K.from("immutable_files").insert({document_id:_.id,filename:_.filename,file_hash:await this.calculateFileHash(s),file_size:s.size,legal_category:e.legal_category,uploaded_by:n.id}),ot.emit("DOCUMENT_UPLOADED",{document:_,user_id:n.id}),_},"Upload document")}static async updateDocument(e,n){return Le(async()=>{const s=await this.getDocument(e),a=await na();if(s.uploaded_by!==a.id&&!a.is_admin)throw new Ye(Je.UNAUTHORIZED,"Sie können nur Ihre eigenen Dokumente bearbeiten.");let i=s.retention_until;if(n.legal_category&&n.legal_category!==s.legal_category){const u=this.getRetentionPeriod(n.legal_category);i=new Date(Date.now()+u*365*24*60*60*1e3).toISOString().split("T")[0]}const o={...n,retention_until:i},c=K.from("documents").update(o).eq("id",e).select().single(),d=await nt(c).executeSingle();return ot.emit("DOCUMENT_UPDATED",{document:d,previous_document:s,changes:n,user_id:a.id}),d},`Update document ${e}`)}static async getDownloadUrl(e,n=3600){return Le(async()=>{const s=await this.getDocument(e),a=await na();if(!s.is_public&&s.uploaded_by!==a.id&&!a.is_admin)throw new Ye(Je.UNAUTHORIZED,"Keine Berechtigung zum Download dieses Dokuments.");const{data:i,error:o}=await K.storage.from("documents").createSignedUrl(s.storage_path,n);if(o||!i)throw new Ye(Je.STORAGE_ERROR,"Fehler beim Generieren der Download-URL.",{error:o});return ot.emit("DOCUMENT_DOWNLOADED",{document:s,user_id:a.id}),i.signedUrl},`Get download URL for document ${e}`)}static async deleteDocument(e){return Le(async()=>{const n=await this.getDocument(e),s=await na();if(n.uploaded_by!==s.id&&!s.is_admin)throw new Ye(Je.UNAUTHORIZED,"Sie können nur Ihre eigenen Dokumente löschen.");if(n.retention_until&&new Date(n.retention_until)>new Date)throw new Ye(Je.BUSINESS_RULE_VIOLATION,"Dokument kann aufgrund gesetzlicher Aufbewahrungspflicht nicht gelöscht werden.",{retentionUntil:n.retention_until});const{error:a}=await K.storage.from("documents").remove([n.storage_path]);if(a)throw new Ye(Je.STORAGE_ERROR,`Fehler beim Löschen der Datei: ${a.message}`,{storageError:a});const{error:i}=await K.from("documents").delete().eq("id",e);if(i)throw i;ot.emit("DOCUMENT_DELETED",{document:n,user_id:s.id})},`Delete document ${e}`)}static async getDocumentStats(){return Le(async()=>(await nt(K.from("documents").select("*")).execute()).reduce((s,a)=>{if(s.total_documents++,s.total_size+=a.file_size,s.by_category[a.category]||(s.by_category[a.category]={count:0,size:0}),s.by_category[a.category].count++,s.by_category[a.category].size+=a.file_size,a.legal_category&&(s.by_legal_category[a.legal_category]||(s.by_legal_category[a.legal_category]={count:0,size:0}),s.by_legal_category[a.legal_category].count++,s.by_legal_category[a.legal_category].size+=a.file_size),a.retention_until){const i=new Date(a.retention_until),o=new Date(Date.now()+30*24*60*60*1e3);i<=o&&s.retention_expiring++}return s},{total_documents:0,total_size:0,by_category:{},by_legal_category:{},retention_expiring:0}),"Get document statistics")}static async searchDocuments(e,n=20){return Le(async()=>{const s=K.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name
          )
        `).or(`filename.ilike.%${e}%,original_filename.ilike.%${e}%,description.ilike.%${e}%`).order("uploaded_at",{ascending:!1}).limit(n);return nt(s).execute()},`Search documents: ${e}`)}static async getExpiringDocuments(e=30){return Le(async()=>{const n=new Date(Date.now()+e*24*60*60*1e3).toISOString().split("T")[0],s=K.from("documents").select("*").not("retention_until","is",null).lte("retention_until",n).order("retention_until",{ascending:!0});return nt(s).execute()},`Get expiring documents (${e} days)`)}static getStorageFolder(e){return{invoice:"invoices",contract:"contracts",receipt:"receipts",photo:"photos",plan:"plans",report:"reports",other:"other"}[e]||"other"}static getRetentionPeriod(e){return{invoice:10,contract:10,receipt:10,tax_document:10,correspondence:6}[e]||10}static async calculateFileHash(e){const n=await e.arrayBuffer(),s=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(s)).map(i=>i.toString(16).padStart(2,"0")).join("")}}const NH=new jH;var Au=(t=>(t[t.UNAUTHORIZED=401]="UNAUTHORIZED",t[t.FORBIDDEN=403]="FORBIDDEN",t[t.NOT_FOUND=404]="NOT_FOUND",t[t.VALIDATION_ERROR=422]="VALIDATION_ERROR",t[t.INTERNAL_ERROR=500]="INTERNAL_ERROR",t))(Au||{});class fo extends Error{constructor(e,n,s){super(e),this.code=n,this.details=s,this.name="ApiError"}}async function Am(t,e){try{return await t()}catch(n){if(console.error(`API Error in ${e}:`,n),n instanceof fo)throw Et.error(`${e}: ${n.message}`),n;const s=n instanceof Error?n.message:"Unbekannter Fehler";throw Et.error(`${e}: ${s}`),new fo(s,500)}}async function dv(){const{data:{user:t},error:e}=await K.auth.getUser();if(e||!t)throw new fo("User not authenticated",401);const{data:n,error:s}=await K.from("profiles").select("*").eq("id",t.id).single();if(s)throw new fo("User profile not found",404,s.message);return{...t,profile:n}}C.string().uuid(),C.string().email(),C.string().min(1),C.number().min(0),C.number().min(0).max(100),C.string().datetime();C.object({project_id:C.string(),budget:C.number().optional(),date_range:C.object({from:C.string().optional(),to:C.string().optional()}).optional()});C.object({user_id:C.string().uuid(),type:C.enum(["budget_warning","budget_critical","invoice_overdue","project_deadline","time_approval_needed","material_low_stock","system_update","general"]),priority:C.enum(["low","medium","high","urgent"]),title:C.string().min(1).max(200),message:C.string().min(1).max(1e3),data:C.record(C.any()).optional(),expires_at:C.string().datetime().optional(),action_url:C.string().url().optional(),entity_type:C.string().optional(),entity_id:C.string().optional()});C.object({read:C.boolean().optional(),archived:C.boolean().optional()});C.object({entity_type:C.enum(["customer","invoice","quote","order","project","timesheet","material","expense","employee","document","payment"]),entity_id:C.string().min(1),action:C.enum(["CREATE","UPDATE","DELETE","VIEW","PRINT","EXPORT","SEND","APPROVE","REJECT","CANCEL","RESTORE"]),old_values:C.record(C.any()).nullable().optional(),new_values:C.record(C.any()).nullable().optional(),reason:C.string().nullable().optional(),is_automated:C.boolean().optional().default(!1)});var SH={exports:{}};function hT(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var uv={exports:{}};const kH={},CH=Object.freeze(Object.defineProperty({__proto__:null,default:kH},Symbol.toStringTag,{value:"Module"})),EH=nE(CH);var QS;function Qt(){return QS||(QS=1,function(t,e){(function(n,s){t.exports=s()})(ht,function(){var n=n||function(s,a){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof ht<"u"&&ht.crypto&&(i=ht.crypto),!i&&typeof hT=="function")try{i=EH}catch{}var o=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},c=Object.create||function(){function w(){}return function(N){var S;return w.prototype=N,S=new w,w.prototype=null,S}}(),d={},u=d.lib={},m=u.Base=function(){return{extend:function(w){var N=c(this);return w&&N.mixIn(w),(!N.hasOwnProperty("init")||this.init===N.init)&&(N.init=function(){N.$super.init.apply(this,arguments)}),N.init.prototype=N,N.$super=this,N},create:function(){var w=this.extend();return w.init.apply(w,arguments),w},init:function(){},mixIn:function(w){for(var N in w)w.hasOwnProperty(N)&&(this[N]=w[N]);w.hasOwnProperty("toString")&&(this.toString=w.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=u.WordArray=m.extend({init:function(w,N){w=this.words=w||[],N!=a?this.sigBytes=N:this.sigBytes=w.length*4},toString:function(w){return(w||y).stringify(this)},concat:function(w){var N=this.words,S=w.words,A=this.sigBytes,E=w.sigBytes;if(this.clamp(),A%4)for(var D=0;D<E;D++){var M=S[D>>>2]>>>24-D%4*8&255;N[A+D>>>2]|=M<<24-(A+D)%4*8}else for(var B=0;B<E;B+=4)N[A+B>>>2]=S[B>>>2];return this.sigBytes+=E,this},clamp:function(){var w=this.words,N=this.sigBytes;w[N>>>2]&=4294967295<<32-N%4*8,w.length=s.ceil(N/4)},clone:function(){var w=m.clone.call(this);return w.words=this.words.slice(0),w},random:function(w){for(var N=[],S=0;S<w;S+=4)N.push(o());return new f.init(N,w)}}),p=d.enc={},y=p.Hex={stringify:function(w){for(var N=w.words,S=w.sigBytes,A=[],E=0;E<S;E++){var D=N[E>>>2]>>>24-E%4*8&255;A.push((D>>>4).toString(16)),A.push((D&15).toString(16))}return A.join("")},parse:function(w){for(var N=w.length,S=[],A=0;A<N;A+=2)S[A>>>3]|=parseInt(w.substr(A,2),16)<<24-A%8*4;return new f.init(S,N/2)}},j=p.Latin1={stringify:function(w){for(var N=w.words,S=w.sigBytes,A=[],E=0;E<S;E++){var D=N[E>>>2]>>>24-E%4*8&255;A.push(String.fromCharCode(D))}return A.join("")},parse:function(w){for(var N=w.length,S=[],A=0;A<N;A++)S[A>>>2]|=(w.charCodeAt(A)&255)<<24-A%4*8;return new f.init(S,N)}},v=p.Utf8={stringify:function(w){try{return decodeURIComponent(escape(j.stringify(w)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(w){return j.parse(unescape(encodeURIComponent(w)))}},_=u.BufferedBlockAlgorithm=m.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(w){typeof w=="string"&&(w=v.parse(w)),this._data.concat(w),this._nDataBytes+=w.sigBytes},_process:function(w){var N,S=this._data,A=S.words,E=S.sigBytes,D=this.blockSize,M=D*4,B=E/M;w?B=s.ceil(B):B=s.max((B|0)-this._minBufferSize,0);var R=B*D,P=s.min(R*4,E);if(R){for(var F=0;F<R;F+=D)this._doProcessBlock(A,F);N=A.splice(0,R),S.sigBytes-=P}return new f.init(N,P)},clone:function(){var w=m.clone.call(this);return w._data=this._data.clone(),w},_minBufferSize:0});u.Hasher=_.extend({cfg:m.extend(),init:function(w){this.cfg=this.cfg.extend(w),this.reset()},reset:function(){_.reset.call(this),this._doReset()},update:function(w){return this._append(w),this._process(),this},finalize:function(w){w&&this._append(w);var N=this._doFinalize();return N},blockSize:16,_createHelper:function(w){return function(N,S){return new w.init(S).finalize(N)}},_createHmacHelper:function(w){return function(N,S){return new b.HMAC.init(w,S).finalize(N)}}});var b=d.algo={};return d}(Math);return n})}(uv)),uv.exports}var hv={exports:{}},YS;function wg(){return YS||(YS=1,function(t,e){(function(n,s){t.exports=s(Qt())})(ht,function(n){return function(s){var a=n,i=a.lib,o=i.Base,c=i.WordArray,d=a.x64={};d.Word=o.extend({init:function(u,m){this.high=u,this.low=m}}),d.WordArray=o.extend({init:function(u,m){u=this.words=u||[],m!=s?this.sigBytes=m:this.sigBytes=u.length*8},toX32:function(){for(var u=this.words,m=u.length,f=[],p=0;p<m;p++){var y=u[p];f.push(y.high),f.push(y.low)}return c.create(f,this.sigBytes)},clone:function(){for(var u=o.clone.call(this),m=u.words=this.words.slice(0),f=m.length,p=0;p<f;p++)m[p]=m[p].clone();return u}})}(),n})}(hv)),hv.exports}var fv={exports:{}},XS;function AH(){return XS||(XS=1,function(t,e){(function(n,s){t.exports=s(Qt())})(ht,function(n){return function(){if(typeof ArrayBuffer=="function"){var s=n,a=s.lib,i=a.WordArray,o=i.init,c=i.init=function(d){if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),(d instanceof Int8Array||typeof Uint8ClampedArray<"u"&&d instanceof Uint8ClampedArray||d instanceof Int16Array||d instanceof Uint16Array||d instanceof Int32Array||d instanceof Uint32Array||d instanceof Float32Array||d instanceof Float64Array)&&(d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength)),d instanceof Uint8Array){for(var u=d.byteLength,m=[],f=0;f<u;f++)m[f>>>2]|=d[f]<<24-f%4*8;o.call(this,m,u)}else o.apply(this,arguments)};c.prototype=i}}(),n.lib.WordArray})}(fv)),fv.exports}var mv={exports:{}},JS;function PH(){return JS||(JS=1,function(t,e){(function(n,s){t.exports=s(Qt())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=s.enc;o.Utf16=o.Utf16BE={stringify:function(d){for(var u=d.words,m=d.sigBytes,f=[],p=0;p<m;p+=2){var y=u[p>>>2]>>>16-p%4*8&65535;f.push(String.fromCharCode(y))}return f.join("")},parse:function(d){for(var u=d.length,m=[],f=0;f<u;f++)m[f>>>1]|=d.charCodeAt(f)<<16-f%2*16;return i.create(m,u*2)}},o.Utf16LE={stringify:function(d){for(var u=d.words,m=d.sigBytes,f=[],p=0;p<m;p+=2){var y=c(u[p>>>2]>>>16-p%4*8&65535);f.push(String.fromCharCode(y))}return f.join("")},parse:function(d){for(var u=d.length,m=[],f=0;f<u;f++)m[f>>>1]|=c(d.charCodeAt(f)<<16-f%2*16);return i.create(m,u*2)}};function c(d){return d<<8&4278255360|d>>>8&16711935}}(),n.enc.Utf16})}(mv)),mv.exports}var pv={exports:{}},ek;function Kl(){return ek||(ek=1,function(t,e){(function(n,s){t.exports=s(Qt())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=s.enc;o.Base64={stringify:function(d){var u=d.words,m=d.sigBytes,f=this._map;d.clamp();for(var p=[],y=0;y<m;y+=3)for(var j=u[y>>>2]>>>24-y%4*8&255,v=u[y+1>>>2]>>>24-(y+1)%4*8&255,_=u[y+2>>>2]>>>24-(y+2)%4*8&255,b=j<<16|v<<8|_,w=0;w<4&&y+w*.75<m;w++)p.push(f.charAt(b>>>6*(3-w)&63));var N=f.charAt(64);if(N)for(;p.length%4;)p.push(N);return p.join("")},parse:function(d){var u=d.length,m=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var p=0;p<m.length;p++)f[m.charCodeAt(p)]=p}var y=m.charAt(64);if(y){var j=d.indexOf(y);j!==-1&&(u=j)}return c(d,u,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function c(d,u,m){for(var f=[],p=0,y=0;y<u;y++)if(y%4){var j=m[d.charCodeAt(y-1)]<<y%4*2,v=m[d.charCodeAt(y)]>>>6-y%4*2,_=j|v;f[p>>>2]|=_<<24-p%4*8,p++}return i.create(f,p)}}(),n.enc.Base64})}(pv)),pv.exports}var gv={exports:{}},tk;function DH(){return tk||(tk=1,function(t,e){(function(n,s){t.exports=s(Qt())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=s.enc;o.Base64url={stringify:function(d,u){u===void 0&&(u=!0);var m=d.words,f=d.sigBytes,p=u?this._safe_map:this._map;d.clamp();for(var y=[],j=0;j<f;j+=3)for(var v=m[j>>>2]>>>24-j%4*8&255,_=m[j+1>>>2]>>>24-(j+1)%4*8&255,b=m[j+2>>>2]>>>24-(j+2)%4*8&255,w=v<<16|_<<8|b,N=0;N<4&&j+N*.75<f;N++)y.push(p.charAt(w>>>6*(3-N)&63));var S=p.charAt(64);if(S)for(;y.length%4;)y.push(S);return y.join("")},parse:function(d,u){u===void 0&&(u=!0);var m=d.length,f=u?this._safe_map:this._map,p=this._reverseMap;if(!p){p=this._reverseMap=[];for(var y=0;y<f.length;y++)p[f.charCodeAt(y)]=y}var j=f.charAt(64);if(j){var v=d.indexOf(j);v!==-1&&(m=v)}return c(d,m,p)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function c(d,u,m){for(var f=[],p=0,y=0;y<u;y++)if(y%4){var j=m[d.charCodeAt(y-1)]<<y%4*2,v=m[d.charCodeAt(y)]>>>6-y%4*2,_=j|v;f[p>>>2]|=_<<24-p%4*8,p++}return i.create(f,p)}}(),n.enc.Base64url})}(gv)),gv.exports}var xv={exports:{}},nk;function Zl(){return nk||(nk=1,function(t,e){(function(n,s){t.exports=s(Qt())})(ht,function(n){return function(s){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.algo,u=[];(function(){for(var v=0;v<64;v++)u[v]=s.abs(s.sin(v+1))*4294967296|0})();var m=d.MD5=c.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(v,_){for(var b=0;b<16;b++){var w=_+b,N=v[w];v[w]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360}var S=this._hash.words,A=v[_+0],E=v[_+1],D=v[_+2],M=v[_+3],B=v[_+4],R=v[_+5],P=v[_+6],F=v[_+7],W=v[_+8],ee=v[_+9],ue=v[_+10],de=v[_+11],Q=v[_+12],z=v[_+13],V=v[_+14],U=v[_+15],O=S[0],I=S[1],H=S[2],$=S[3];O=f(O,I,H,$,A,7,u[0]),$=f($,O,I,H,E,12,u[1]),H=f(H,$,O,I,D,17,u[2]),I=f(I,H,$,O,M,22,u[3]),O=f(O,I,H,$,B,7,u[4]),$=f($,O,I,H,R,12,u[5]),H=f(H,$,O,I,P,17,u[6]),I=f(I,H,$,O,F,22,u[7]),O=f(O,I,H,$,W,7,u[8]),$=f($,O,I,H,ee,12,u[9]),H=f(H,$,O,I,ue,17,u[10]),I=f(I,H,$,O,de,22,u[11]),O=f(O,I,H,$,Q,7,u[12]),$=f($,O,I,H,z,12,u[13]),H=f(H,$,O,I,V,17,u[14]),I=f(I,H,$,O,U,22,u[15]),O=p(O,I,H,$,E,5,u[16]),$=p($,O,I,H,P,9,u[17]),H=p(H,$,O,I,de,14,u[18]),I=p(I,H,$,O,A,20,u[19]),O=p(O,I,H,$,R,5,u[20]),$=p($,O,I,H,ue,9,u[21]),H=p(H,$,O,I,U,14,u[22]),I=p(I,H,$,O,B,20,u[23]),O=p(O,I,H,$,ee,5,u[24]),$=p($,O,I,H,V,9,u[25]),H=p(H,$,O,I,M,14,u[26]),I=p(I,H,$,O,W,20,u[27]),O=p(O,I,H,$,z,5,u[28]),$=p($,O,I,H,D,9,u[29]),H=p(H,$,O,I,F,14,u[30]),I=p(I,H,$,O,Q,20,u[31]),O=y(O,I,H,$,R,4,u[32]),$=y($,O,I,H,W,11,u[33]),H=y(H,$,O,I,de,16,u[34]),I=y(I,H,$,O,V,23,u[35]),O=y(O,I,H,$,E,4,u[36]),$=y($,O,I,H,B,11,u[37]),H=y(H,$,O,I,F,16,u[38]),I=y(I,H,$,O,ue,23,u[39]),O=y(O,I,H,$,z,4,u[40]),$=y($,O,I,H,A,11,u[41]),H=y(H,$,O,I,M,16,u[42]),I=y(I,H,$,O,P,23,u[43]),O=y(O,I,H,$,ee,4,u[44]),$=y($,O,I,H,Q,11,u[45]),H=y(H,$,O,I,U,16,u[46]),I=y(I,H,$,O,D,23,u[47]),O=j(O,I,H,$,A,6,u[48]),$=j($,O,I,H,F,10,u[49]),H=j(H,$,O,I,V,15,u[50]),I=j(I,H,$,O,R,21,u[51]),O=j(O,I,H,$,Q,6,u[52]),$=j($,O,I,H,M,10,u[53]),H=j(H,$,O,I,ue,15,u[54]),I=j(I,H,$,O,E,21,u[55]),O=j(O,I,H,$,W,6,u[56]),$=j($,O,I,H,U,10,u[57]),H=j(H,$,O,I,P,15,u[58]),I=j(I,H,$,O,z,21,u[59]),O=j(O,I,H,$,B,6,u[60]),$=j($,O,I,H,de,10,u[61]),H=j(H,$,O,I,D,15,u[62]),I=j(I,H,$,O,ee,21,u[63]),S[0]=S[0]+O|0,S[1]=S[1]+I|0,S[2]=S[2]+H|0,S[3]=S[3]+$|0},_doFinalize:function(){var v=this._data,_=v.words,b=this._nDataBytes*8,w=v.sigBytes*8;_[w>>>5]|=128<<24-w%32;var N=s.floor(b/4294967296),S=b;_[(w+64>>>9<<4)+15]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,_[(w+64>>>9<<4)+14]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,v.sigBytes=(_.length+1)*4,this._process();for(var A=this._hash,E=A.words,D=0;D<4;D++){var M=E[D];E[D]=(M<<8|M>>>24)&16711935|(M<<24|M>>>8)&4278255360}return A},clone:function(){var v=c.clone.call(this);return v._hash=this._hash.clone(),v}});function f(v,_,b,w,N,S,A){var E=v+(_&b|~_&w)+N+A;return(E<<S|E>>>32-S)+_}function p(v,_,b,w,N,S,A){var E=v+(_&w|b&~w)+N+A;return(E<<S|E>>>32-S)+_}function y(v,_,b,w,N,S,A){var E=v+(_^b^w)+N+A;return(E<<S|E>>>32-S)+_}function j(v,_,b,w,N,S,A){var E=v+(b^(_|~w))+N+A;return(E<<S|E>>>32-S)+_}a.MD5=c._createHelper(m),a.HmacMD5=c._createHmacHelper(m)}(Math),n.MD5})}(xv)),xv.exports}var vv={exports:{}},rk;function fT(){return rk||(rk=1,function(t,e){(function(n,s){t.exports=s(Qt())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=a.Hasher,c=s.algo,d=[],u=c.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,f){for(var p=this._hash.words,y=p[0],j=p[1],v=p[2],_=p[3],b=p[4],w=0;w<80;w++){if(w<16)d[w]=m[f+w]|0;else{var N=d[w-3]^d[w-8]^d[w-14]^d[w-16];d[w]=N<<1|N>>>31}var S=(y<<5|y>>>27)+b+d[w];w<20?S+=(j&v|~j&_)+1518500249:w<40?S+=(j^v^_)+1859775393:w<60?S+=(j&v|j&_|v&_)-1894007588:S+=(j^v^_)-899497514,b=_,_=v,v=j<<30|j>>>2,j=y,y=S}p[0]=p[0]+y|0,p[1]=p[1]+j|0,p[2]=p[2]+v|0,p[3]=p[3]+_|0,p[4]=p[4]+b|0},_doFinalize:function(){var m=this._data,f=m.words,p=this._nDataBytes*8,y=m.sigBytes*8;return f[y>>>5]|=128<<24-y%32,f[(y+64>>>9<<4)+14]=Math.floor(p/4294967296),f[(y+64>>>9<<4)+15]=p,m.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var m=o.clone.call(this);return m._hash=this._hash.clone(),m}});s.SHA1=o._createHelper(u),s.HmacSHA1=o._createHmacHelper(u)}(),n.SHA1})}(vv)),vv.exports}var yv={exports:{}},sk;function bj(){return sk||(sk=1,function(t,e){(function(n,s){t.exports=s(Qt())})(ht,function(n){return function(s){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.algo,u=[],m=[];(function(){function y(b){for(var w=s.sqrt(b),N=2;N<=w;N++)if(!(b%N))return!1;return!0}function j(b){return(b-(b|0))*4294967296|0}for(var v=2,_=0;_<64;)y(v)&&(_<8&&(u[_]=j(s.pow(v,1/2))),m[_]=j(s.pow(v,1/3)),_++),v++})();var f=[],p=d.SHA256=c.extend({_doReset:function(){this._hash=new o.init(u.slice(0))},_doProcessBlock:function(y,j){for(var v=this._hash.words,_=v[0],b=v[1],w=v[2],N=v[3],S=v[4],A=v[5],E=v[6],D=v[7],M=0;M<64;M++){if(M<16)f[M]=y[j+M]|0;else{var B=f[M-15],R=(B<<25|B>>>7)^(B<<14|B>>>18)^B>>>3,P=f[M-2],F=(P<<15|P>>>17)^(P<<13|P>>>19)^P>>>10;f[M]=R+f[M-7]+F+f[M-16]}var W=S&A^~S&E,ee=_&b^_&w^b&w,ue=(_<<30|_>>>2)^(_<<19|_>>>13)^(_<<10|_>>>22),de=(S<<26|S>>>6)^(S<<21|S>>>11)^(S<<7|S>>>25),Q=D+de+W+m[M]+f[M],z=ue+ee;D=E,E=A,A=S,S=N+Q|0,N=w,w=b,b=_,_=Q+z|0}v[0]=v[0]+_|0,v[1]=v[1]+b|0,v[2]=v[2]+w|0,v[3]=v[3]+N|0,v[4]=v[4]+S|0,v[5]=v[5]+A|0,v[6]=v[6]+E|0,v[7]=v[7]+D|0},_doFinalize:function(){var y=this._data,j=y.words,v=this._nDataBytes*8,_=y.sigBytes*8;return j[_>>>5]|=128<<24-_%32,j[(_+64>>>9<<4)+14]=s.floor(v/4294967296),j[(_+64>>>9<<4)+15]=v,y.sigBytes=j.length*4,this._process(),this._hash},clone:function(){var y=c.clone.call(this);return y._hash=this._hash.clone(),y}});a.SHA256=c._createHelper(p),a.HmacSHA256=c._createHmacHelper(p)}(Math),n.SHA256})}(yv)),yv.exports}var _v={exports:{}},ak;function TH(){return ak||(ak=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),bj())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=s.algo,c=o.SHA256,d=o.SHA224=c.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var u=c._doFinalize.call(this);return u.sigBytes-=4,u}});s.SHA224=c._createHelper(d),s.HmacSHA224=c._createHmacHelper(d)}(),n.SHA224})}(_v)),_v.exports}var wv={exports:{}},ik;function mT(){return ik||(ik=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),wg())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.Hasher,o=s.x64,c=o.Word,d=o.WordArray,u=s.algo;function m(){return c.create.apply(c,arguments)}var f=[m(1116352408,3609767458),m(1899447441,602891725),m(3049323471,3964484399),m(3921009573,2173295548),m(961987163,4081628472),m(1508970993,3053834265),m(2453635748,2937671579),m(2870763221,3664609560),m(3624381080,2734883394),m(310598401,1164996542),m(607225278,1323610764),m(1426881987,3590304994),m(1925078388,4068182383),m(2162078206,991336113),m(2614888103,633803317),m(3248222580,3479774868),m(3835390401,2666613458),m(4022224774,944711139),m(264347078,2341262773),m(604807628,2007800933),m(770255983,1495990901),m(1249150122,1856431235),m(1555081692,3175218132),m(1996064986,2198950837),m(2554220882,3999719339),m(2821834349,766784016),m(2952996808,2566594879),m(3210313671,3203337956),m(3336571891,1034457026),m(3584528711,2466948901),m(113926993,3758326383),m(338241895,168717936),m(666307205,1188179964),m(773529912,1546045734),m(1294757372,1522805485),m(1396182291,2643833823),m(1695183700,2343527390),m(1986661051,1014477480),m(2177026350,1206759142),m(2456956037,344077627),m(2730485921,1290863460),m(2820302411,3158454273),m(3259730800,3505952657),m(3345764771,106217008),m(3516065817,3606008344),m(3600352804,1432725776),m(4094571909,1467031594),m(275423344,851169720),m(430227734,3100823752),m(506948616,1363258195),m(659060556,3750685593),m(883997877,3785050280),m(958139571,3318307427),m(1322822218,3812723403),m(1537002063,2003034995),m(1747873779,3602036899),m(1955562222,1575990012),m(2024104815,1125592928),m(2227730452,2716904306),m(2361852424,442776044),m(2428436474,593698344),m(2756734187,3733110249),m(3204031479,2999351573),m(3329325298,3815920427),m(3391569614,3928383900),m(3515267271,566280711),m(3940187606,3454069534),m(4118630271,4000239992),m(116418474,1914138554),m(174292421,2731055270),m(289380356,3203993006),m(460393269,320620315),m(685471733,587496836),m(852142971,1086792851),m(1017036298,365543100),m(1126000580,2618297676),m(1288033470,3409855158),m(1501505948,4234509866),m(1607167915,987167468),m(1816402316,1246189591)],p=[];(function(){for(var j=0;j<80;j++)p[j]=m()})();var y=u.SHA512=i.extend({_doReset:function(){this._hash=new d.init([new c.init(1779033703,4089235720),new c.init(3144134277,2227873595),new c.init(1013904242,4271175723),new c.init(2773480762,1595750129),new c.init(1359893119,2917565137),new c.init(2600822924,725511199),new c.init(528734635,4215389547),new c.init(1541459225,327033209)])},_doProcessBlock:function(j,v){for(var _=this._hash.words,b=_[0],w=_[1],N=_[2],S=_[3],A=_[4],E=_[5],D=_[6],M=_[7],B=b.high,R=b.low,P=w.high,F=w.low,W=N.high,ee=N.low,ue=S.high,de=S.low,Q=A.high,z=A.low,V=E.high,U=E.low,O=D.high,I=D.low,H=M.high,$=M.low,te=B,X=R,Z=P,ie=F,pe=W,G=ee,se=ue,me=de,he=Q,xe=z,re=V,_e=U,be=O,Be=I,Ke=H,At=$,je=0;je<80;je++){var De,Ie,at=p[je];if(je<16)Ie=at.high=j[v+je*2]|0,De=at.low=j[v+je*2+1]|0;else{var $e=p[je-15],Me=$e.high,Nt=$e.low,ft=(Me>>>1|Nt<<31)^(Me>>>8|Nt<<24)^Me>>>7,Ln=(Nt>>>1|Me<<31)^(Nt>>>8|Me<<24)^(Nt>>>7|Me<<25),yr=p[je-2],xt=yr.high,mn=yr.low,Mn=(xt>>>19|mn<<13)^(xt<<3|mn>>>29)^xt>>>6,cr=(mn>>>19|xt<<13)^(mn<<3|xt>>>29)^(mn>>>6|xt<<26),Wn=p[je-7],Nn=Wn.high,Hr=Wn.low,it=p[je-16],Kt=it.high,Bt=it.low;De=Ln+Hr,Ie=ft+Nn+(De>>>0<Ln>>>0?1:0),De=De+cr,Ie=Ie+Mn+(De>>>0<cr>>>0?1:0),De=De+Bt,Ie=Ie+Kt+(De>>>0<Bt>>>0?1:0),at.high=Ie,at.low=De}var dt=he&re^~he&be,Yt=xe&_e^~xe&Be,we=te&Z^te&pe^Z&pe,Ne=X&ie^X&G^ie&G,rt=(te>>>28|X<<4)^(te<<30|X>>>2)^(te<<25|X>>>7),et=(X>>>28|te<<4)^(X<<30|te>>>2)^(X<<25|te>>>7),ut=(he>>>14|xe<<18)^(he>>>18|xe<<14)^(he<<23|xe>>>9),on=(xe>>>14|he<<18)^(xe>>>18|he<<14)^(xe<<23|he>>>9),Hn=f[je],_a=Hn.high,Ja=Hn.low,Vn=At+on,Pr=Ke+ut+(Vn>>>0<At>>>0?1:0),Vn=Vn+Yt,Pr=Pr+dt+(Vn>>>0<Yt>>>0?1:0),Vn=Vn+Ja,Pr=Pr+_a+(Vn>>>0<Ja>>>0?1:0),Vn=Vn+De,Pr=Pr+Ie+(Vn>>>0<De>>>0?1:0),Dr=et+Ne,tt=rt+we+(Dr>>>0<et>>>0?1:0);Ke=be,At=Be,be=re,Be=_e,re=he,_e=xe,xe=me+Vn|0,he=se+Pr+(xe>>>0<me>>>0?1:0)|0,se=pe,me=G,pe=Z,G=ie,Z=te,ie=X,X=Vn+Dr|0,te=Pr+tt+(X>>>0<Vn>>>0?1:0)|0}R=b.low=R+X,b.high=B+te+(R>>>0<X>>>0?1:0),F=w.low=F+ie,w.high=P+Z+(F>>>0<ie>>>0?1:0),ee=N.low=ee+G,N.high=W+pe+(ee>>>0<G>>>0?1:0),de=S.low=de+me,S.high=ue+se+(de>>>0<me>>>0?1:0),z=A.low=z+xe,A.high=Q+he+(z>>>0<xe>>>0?1:0),U=E.low=U+_e,E.high=V+re+(U>>>0<_e>>>0?1:0),I=D.low=I+Be,D.high=O+be+(I>>>0<Be>>>0?1:0),$=M.low=$+At,M.high=H+Ke+($>>>0<At>>>0?1:0)},_doFinalize:function(){var j=this._data,v=j.words,_=this._nDataBytes*8,b=j.sigBytes*8;v[b>>>5]|=128<<24-b%32,v[(b+128>>>10<<5)+30]=Math.floor(_/4294967296),v[(b+128>>>10<<5)+31]=_,j.sigBytes=v.length*4,this._process();var w=this._hash.toX32();return w},clone:function(){var j=i.clone.call(this);return j._hash=this._hash.clone(),j},blockSize:1024/32});s.SHA512=i._createHelper(y),s.HmacSHA512=i._createHmacHelper(y)}(),n.SHA512})}(wv)),wv.exports}var bv={exports:{}},ok;function MH(){return ok||(ok=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),wg(),mT())})(ht,function(n){return function(){var s=n,a=s.x64,i=a.Word,o=a.WordArray,c=s.algo,d=c.SHA512,u=c.SHA384=d.extend({_doReset:function(){this._hash=new o.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var m=d._doFinalize.call(this);return m.sigBytes-=16,m}});s.SHA384=d._createHelper(u),s.HmacSHA384=d._createHmacHelper(u)}(),n.SHA384})}(bv)),bv.exports}var jv={exports:{}},lk;function RH(){return lk||(lk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),wg())})(ht,function(n){return function(s){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.x64,u=d.Word,m=a.algo,f=[],p=[],y=[];(function(){for(var _=1,b=0,w=0;w<24;w++){f[_+5*b]=(w+1)*(w+2)/2%64;var N=b%5,S=(2*_+3*b)%5;_=N,b=S}for(var _=0;_<5;_++)for(var b=0;b<5;b++)p[_+5*b]=b+(2*_+3*b)%5*5;for(var A=1,E=0;E<24;E++){for(var D=0,M=0,B=0;B<7;B++){if(A&1){var R=(1<<B)-1;R<32?M^=1<<R:D^=1<<R-32}A&128?A=A<<1^113:A<<=1}y[E]=u.create(D,M)}})();var j=[];(function(){for(var _=0;_<25;_++)j[_]=u.create()})();var v=m.SHA3=c.extend({cfg:c.cfg.extend({outputLength:512}),_doReset:function(){for(var _=this._state=[],b=0;b<25;b++)_[b]=new u.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(_,b){for(var w=this._state,N=this.blockSize/2,S=0;S<N;S++){var A=_[b+2*S],E=_[b+2*S+1];A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360;var D=w[S];D.high^=E,D.low^=A}for(var M=0;M<24;M++){for(var B=0;B<5;B++){for(var R=0,P=0,F=0;F<5;F++){var D=w[B+5*F];R^=D.high,P^=D.low}var W=j[B];W.high=R,W.low=P}for(var B=0;B<5;B++)for(var ee=j[(B+4)%5],ue=j[(B+1)%5],de=ue.high,Q=ue.low,R=ee.high^(de<<1|Q>>>31),P=ee.low^(Q<<1|de>>>31),F=0;F<5;F++){var D=w[B+5*F];D.high^=R,D.low^=P}for(var z=1;z<25;z++){var R,P,D=w[z],V=D.high,U=D.low,O=f[z];O<32?(R=V<<O|U>>>32-O,P=U<<O|V>>>32-O):(R=U<<O-32|V>>>64-O,P=V<<O-32|U>>>64-O);var I=j[p[z]];I.high=R,I.low=P}var H=j[0],$=w[0];H.high=$.high,H.low=$.low;for(var B=0;B<5;B++)for(var F=0;F<5;F++){var z=B+5*F,D=w[z],te=j[z],X=j[(B+1)%5+5*F],Z=j[(B+2)%5+5*F];D.high=te.high^~X.high&Z.high,D.low=te.low^~X.low&Z.low}var D=w[0],ie=y[M];D.high^=ie.high,D.low^=ie.low}},_doFinalize:function(){var _=this._data,b=_.words;this._nDataBytes*8;var w=_.sigBytes*8,N=this.blockSize*32;b[w>>>5]|=1<<24-w%32,b[(s.ceil((w+1)/N)*N>>>5)-1]|=128,_.sigBytes=b.length*4,this._process();for(var S=this._state,A=this.cfg.outputLength/8,E=A/8,D=[],M=0;M<E;M++){var B=S[M],R=B.high,P=B.low;R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,P=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360,D.push(P),D.push(R)}return new o.init(D,A)},clone:function(){for(var _=c.clone.call(this),b=_._state=this._state.slice(0),w=0;w<25;w++)b[w]=b[w].clone();return _}});a.SHA3=c._createHelper(v),a.HmacSHA3=c._createHmacHelper(v)}(Math),n.SHA3})}(jv)),jv.exports}var Nv={exports:{}},ck;function IH(){return ck||(ck=1,function(t,e){(function(n,s){t.exports=s(Qt())})(ht,function(n){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(s){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.algo,u=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),m=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),p=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),y=o.create([0,1518500249,1859775393,2400959708,2840853838]),j=o.create([1352829926,1548603684,1836072691,2053994217,0]),v=d.RIPEMD160=c.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(E,D){for(var M=0;M<16;M++){var B=D+M,R=E[B];E[B]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360}var P=this._hash.words,F=y.words,W=j.words,ee=u.words,ue=m.words,de=f.words,Q=p.words,z,V,U,O,I,H,$,te,X,Z;H=z=P[0],$=V=P[1],te=U=P[2],X=O=P[3],Z=I=P[4];for(var ie,M=0;M<80;M+=1)ie=z+E[D+ee[M]]|0,M<16?ie+=_(V,U,O)+F[0]:M<32?ie+=b(V,U,O)+F[1]:M<48?ie+=w(V,U,O)+F[2]:M<64?ie+=N(V,U,O)+F[3]:ie+=S(V,U,O)+F[4],ie=ie|0,ie=A(ie,de[M]),ie=ie+I|0,z=I,I=O,O=A(U,10),U=V,V=ie,ie=H+E[D+ue[M]]|0,M<16?ie+=S($,te,X)+W[0]:M<32?ie+=N($,te,X)+W[1]:M<48?ie+=w($,te,X)+W[2]:M<64?ie+=b($,te,X)+W[3]:ie+=_($,te,X)+W[4],ie=ie|0,ie=A(ie,Q[M]),ie=ie+Z|0,H=Z,Z=X,X=A(te,10),te=$,$=ie;ie=P[1]+U+X|0,P[1]=P[2]+O+Z|0,P[2]=P[3]+I+H|0,P[3]=P[4]+z+$|0,P[4]=P[0]+V+te|0,P[0]=ie},_doFinalize:function(){var E=this._data,D=E.words,M=this._nDataBytes*8,B=E.sigBytes*8;D[B>>>5]|=128<<24-B%32,D[(B+64>>>9<<4)+14]=(M<<8|M>>>24)&16711935|(M<<24|M>>>8)&4278255360,E.sigBytes=(D.length+1)*4,this._process();for(var R=this._hash,P=R.words,F=0;F<5;F++){var W=P[F];P[F]=(W<<8|W>>>24)&16711935|(W<<24|W>>>8)&4278255360}return R},clone:function(){var E=c.clone.call(this);return E._hash=this._hash.clone(),E}});function _(E,D,M){return E^D^M}function b(E,D,M){return E&D|~E&M}function w(E,D,M){return(E|~D)^M}function N(E,D,M){return E&M|D&~M}function S(E,D,M){return E^(D|~M)}function A(E,D){return E<<D|E>>>32-D}a.RIPEMD160=c._createHelper(v),a.HmacRIPEMD160=c._createHmacHelper(v)}(),n.RIPEMD160})}(Nv)),Nv.exports}var Sv={exports:{}},dk;function jj(){return dk||(dk=1,function(t,e){(function(n,s){t.exports=s(Qt())})(ht,function(n){(function(){var s=n,a=s.lib,i=a.Base,o=s.enc,c=o.Utf8,d=s.algo;d.HMAC=i.extend({init:function(u,m){u=this._hasher=new u.init,typeof m=="string"&&(m=c.parse(m));var f=u.blockSize,p=f*4;m.sigBytes>p&&(m=u.finalize(m)),m.clamp();for(var y=this._oKey=m.clone(),j=this._iKey=m.clone(),v=y.words,_=j.words,b=0;b<f;b++)v[b]^=1549556828,_[b]^=909522486;y.sigBytes=j.sigBytes=p,this.reset()},reset:function(){var u=this._hasher;u.reset(),u.update(this._iKey)},update:function(u){return this._hasher.update(u),this},finalize:function(u){var m=this._hasher,f=m.finalize(u);m.reset();var p=m.finalize(this._oKey.clone().concat(f));return p}})})()})}(Sv)),Sv.exports}var kv={exports:{}},uk;function OH(){return uk||(uk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),bj(),jj())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.Base,o=a.WordArray,c=s.algo,d=c.SHA256,u=c.HMAC,m=c.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:d,iterations:25e4}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,p){for(var y=this.cfg,j=u.create(y.hasher,f),v=o.create(),_=o.create([1]),b=v.words,w=_.words,N=y.keySize,S=y.iterations;b.length<N;){var A=j.update(p).finalize(_);j.reset();for(var E=A.words,D=E.length,M=A,B=1;B<S;B++){M=j.finalize(M),j.reset();for(var R=M.words,P=0;P<D;P++)E[P]^=R[P]}v.concat(A),w[0]++}return v.sigBytes=N*4,v}});s.PBKDF2=function(f,p,y){return m.create(y).compute(f,p)}}(),n.PBKDF2})}(kv)),kv.exports}var Cv={exports:{}},hk;function Wo(){return hk||(hk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),fT(),jj())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.Base,o=a.WordArray,c=s.algo,d=c.MD5,u=c.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:d,iterations:1}),init:function(m){this.cfg=this.cfg.extend(m)},compute:function(m,f){for(var p,y=this.cfg,j=y.hasher.create(),v=o.create(),_=v.words,b=y.keySize,w=y.iterations;_.length<b;){p&&j.update(p),p=j.update(m).finalize(f),j.reset();for(var N=1;N<w;N++)p=j.finalize(p),j.reset();v.concat(p)}return v.sigBytes=b*4,v}});s.EvpKDF=function(m,f,p){return u.create(p).compute(m,f)}}(),n.EvpKDF})}(Cv)),Cv.exports}var Ev={exports:{}},fk;function lr(){return fk||(fk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),Wo())})(ht,function(n){n.lib.Cipher||function(s){var a=n,i=a.lib,o=i.Base,c=i.WordArray,d=i.BufferedBlockAlgorithm,u=a.enc;u.Utf8;var m=u.Base64,f=a.algo,p=f.EvpKDF,y=i.Cipher=d.extend({cfg:o.extend(),createEncryptor:function(R,P){return this.create(this._ENC_XFORM_MODE,R,P)},createDecryptor:function(R,P){return this.create(this._DEC_XFORM_MODE,R,P)},init:function(R,P,F){this.cfg=this.cfg.extend(F),this._xformMode=R,this._key=P,this.reset()},reset:function(){d.reset.call(this),this._doReset()},process:function(R){return this._append(R),this._process()},finalize:function(R){R&&this._append(R);var P=this._doFinalize();return P},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function R(P){return typeof P=="string"?B:E}return function(P){return{encrypt:function(F,W,ee){return R(W).encrypt(P,F,W,ee)},decrypt:function(F,W,ee){return R(W).decrypt(P,F,W,ee)}}}}()});i.StreamCipher=y.extend({_doFinalize:function(){var R=this._process(!0);return R},blockSize:1});var j=a.mode={},v=i.BlockCipherMode=o.extend({createEncryptor:function(R,P){return this.Encryptor.create(R,P)},createDecryptor:function(R,P){return this.Decryptor.create(R,P)},init:function(R,P){this._cipher=R,this._iv=P}}),_=j.CBC=function(){var R=v.extend();R.Encryptor=R.extend({processBlock:function(F,W){var ee=this._cipher,ue=ee.blockSize;P.call(this,F,W,ue),ee.encryptBlock(F,W),this._prevBlock=F.slice(W,W+ue)}}),R.Decryptor=R.extend({processBlock:function(F,W){var ee=this._cipher,ue=ee.blockSize,de=F.slice(W,W+ue);ee.decryptBlock(F,W),P.call(this,F,W,ue),this._prevBlock=de}});function P(F,W,ee){var ue,de=this._iv;de?(ue=de,this._iv=s):ue=this._prevBlock;for(var Q=0;Q<ee;Q++)F[W+Q]^=ue[Q]}return R}(),b=a.pad={},w=b.Pkcs7={pad:function(R,P){for(var F=P*4,W=F-R.sigBytes%F,ee=W<<24|W<<16|W<<8|W,ue=[],de=0;de<W;de+=4)ue.push(ee);var Q=c.create(ue,W);R.concat(Q)},unpad:function(R){var P=R.words[R.sigBytes-1>>>2]&255;R.sigBytes-=P}};i.BlockCipher=y.extend({cfg:y.cfg.extend({mode:_,padding:w}),reset:function(){var R;y.reset.call(this);var P=this.cfg,F=P.iv,W=P.mode;this._xformMode==this._ENC_XFORM_MODE?R=W.createEncryptor:(R=W.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==R?this._mode.init(this,F&&F.words):(this._mode=R.call(W,this,F&&F.words),this._mode.__creator=R)},_doProcessBlock:function(R,P){this._mode.processBlock(R,P)},_doFinalize:function(){var R,P=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(P.pad(this._data,this.blockSize),R=this._process(!0)):(R=this._process(!0),P.unpad(R)),R},blockSize:128/32});var N=i.CipherParams=o.extend({init:function(R){this.mixIn(R)},toString:function(R){return(R||this.formatter).stringify(this)}}),S=a.format={},A=S.OpenSSL={stringify:function(R){var P,F=R.ciphertext,W=R.salt;return W?P=c.create([1398893684,1701076831]).concat(W).concat(F):P=F,P.toString(m)},parse:function(R){var P,F=m.parse(R),W=F.words;return W[0]==1398893684&&W[1]==1701076831&&(P=c.create(W.slice(2,4)),W.splice(0,4),F.sigBytes-=16),N.create({ciphertext:F,salt:P})}},E=i.SerializableCipher=o.extend({cfg:o.extend({format:A}),encrypt:function(R,P,F,W){W=this.cfg.extend(W);var ee=R.createEncryptor(F,W),ue=ee.finalize(P),de=ee.cfg;return N.create({ciphertext:ue,key:F,iv:de.iv,algorithm:R,mode:de.mode,padding:de.padding,blockSize:R.blockSize,formatter:W.format})},decrypt:function(R,P,F,W){W=this.cfg.extend(W),P=this._parse(P,W.format);var ee=R.createDecryptor(F,W).finalize(P.ciphertext);return ee},_parse:function(R,P){return typeof R=="string"?P.parse(R,this):R}}),D=a.kdf={},M=D.OpenSSL={execute:function(R,P,F,W,ee){if(W||(W=c.random(64/8)),ee)var ue=p.create({keySize:P+F,hasher:ee}).compute(R,W);else var ue=p.create({keySize:P+F}).compute(R,W);var de=c.create(ue.words.slice(P),F*4);return ue.sigBytes=P*4,N.create({key:ue,iv:de,salt:W})}},B=i.PasswordBasedCipher=E.extend({cfg:E.cfg.extend({kdf:M}),encrypt:function(R,P,F,W){W=this.cfg.extend(W);var ee=W.kdf.execute(F,R.keySize,R.ivSize,W.salt,W.hasher);W.iv=ee.iv;var ue=E.encrypt.call(this,R,P,ee.key,W);return ue.mixIn(ee),ue},decrypt:function(R,P,F,W){W=this.cfg.extend(W),P=this._parse(P,W.format);var ee=W.kdf.execute(F,R.keySize,R.ivSize,P.salt,W.hasher);W.iv=ee.iv;var ue=E.decrypt.call(this,R,P,ee.key,W);return ue}})}()})}(Ev)),Ev.exports}var Av={exports:{}},mk;function LH(){return mk||(mk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),lr())})(ht,function(n){return n.mode.CFB=function(){var s=n.lib.BlockCipherMode.extend();s.Encryptor=s.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize;a.call(this,i,o,d,c),this._prevBlock=i.slice(o,o+d)}}),s.Decryptor=s.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize,u=i.slice(o,o+d);a.call(this,i,o,d,c),this._prevBlock=u}});function a(i,o,c,d){var u,m=this._iv;m?(u=m.slice(0),this._iv=void 0):u=this._prevBlock,d.encryptBlock(u,0);for(var f=0;f<c;f++)i[o+f]^=u[f]}return s}(),n.mode.CFB})}(Av)),Av.exports}var Pv={exports:{}},pk;function FH(){return pk||(pk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),lr())})(ht,function(n){return n.mode.CTR=function(){var s=n.lib.BlockCipherMode.extend(),a=s.Encryptor=s.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize,u=this._iv,m=this._counter;u&&(m=this._counter=u.slice(0),this._iv=void 0);var f=m.slice(0);c.encryptBlock(f,0),m[d-1]=m[d-1]+1|0;for(var p=0;p<d;p++)i[o+p]^=f[p]}});return s.Decryptor=a,s}(),n.mode.CTR})}(Pv)),Pv.exports}var Dv={exports:{}},gk;function BH(){return gk||(gk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),lr())})(ht,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=function(){var s=n.lib.BlockCipherMode.extend();function a(c){if((c>>24&255)===255){var d=c>>16&255,u=c>>8&255,m=c&255;d===255?(d=0,u===255?(u=0,m===255?m=0:++m):++u):++d,c=0,c+=d<<16,c+=u<<8,c+=m}else c+=1<<24;return c}function i(c){return(c[0]=a(c[0]))===0&&(c[1]=a(c[1])),c}var o=s.Encryptor=s.extend({processBlock:function(c,d){var u=this._cipher,m=u.blockSize,f=this._iv,p=this._counter;f&&(p=this._counter=f.slice(0),this._iv=void 0),i(p);var y=p.slice(0);u.encryptBlock(y,0);for(var j=0;j<m;j++)c[d+j]^=y[j]}});return s.Decryptor=o,s}(),n.mode.CTRGladman})}(Dv)),Dv.exports}var Tv={exports:{}},xk;function zH(){return xk||(xk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),lr())})(ht,function(n){return n.mode.OFB=function(){var s=n.lib.BlockCipherMode.extend(),a=s.Encryptor=s.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize,u=this._iv,m=this._keystream;u&&(m=this._keystream=u.slice(0),this._iv=void 0),c.encryptBlock(m,0);for(var f=0;f<d;f++)i[o+f]^=m[f]}});return s.Decryptor=a,s}(),n.mode.OFB})}(Tv)),Tv.exports}var Mv={exports:{}},vk;function $H(){return vk||(vk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),lr())})(ht,function(n){return n.mode.ECB=function(){var s=n.lib.BlockCipherMode.extend();return s.Encryptor=s.extend({processBlock:function(a,i){this._cipher.encryptBlock(a,i)}}),s.Decryptor=s.extend({processBlock:function(a,i){this._cipher.decryptBlock(a,i)}}),s}(),n.mode.ECB})}(Mv)),Mv.exports}var Rv={exports:{}},yk;function UH(){return yk||(yk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),lr())})(ht,function(n){return n.pad.AnsiX923={pad:function(s,a){var i=s.sigBytes,o=a*4,c=o-i%o,d=i+c-1;s.clamp(),s.words[d>>>2]|=c<<24-d%4*8,s.sigBytes+=c},unpad:function(s){var a=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=a}},n.pad.Ansix923})}(Rv)),Rv.exports}var Iv={exports:{}},_k;function qH(){return _k||(_k=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),lr())})(ht,function(n){return n.pad.Iso10126={pad:function(s,a){var i=a*4,o=i-s.sigBytes%i;s.concat(n.lib.WordArray.random(o-1)).concat(n.lib.WordArray.create([o<<24],1))},unpad:function(s){var a=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=a}},n.pad.Iso10126})}(Iv)),Iv.exports}var Ov={exports:{}},wk;function WH(){return wk||(wk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),lr())})(ht,function(n){return n.pad.Iso97971={pad:function(s,a){s.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(s,a)},unpad:function(s){n.pad.ZeroPadding.unpad(s),s.sigBytes--}},n.pad.Iso97971})}(Ov)),Ov.exports}var Lv={exports:{}},bk;function HH(){return bk||(bk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),lr())})(ht,function(n){return n.pad.ZeroPadding={pad:function(s,a){var i=a*4;s.clamp(),s.sigBytes+=i-(s.sigBytes%i||i)},unpad:function(s){for(var a=s.words,i=s.sigBytes-1,i=s.sigBytes-1;i>=0;i--)if(a[i>>>2]>>>24-i%4*8&255){s.sigBytes=i+1;break}}},n.pad.ZeroPadding})}(Lv)),Lv.exports}var Fv={exports:{}},jk;function VH(){return jk||(jk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),lr())})(ht,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})}(Fv)),Fv.exports}var Bv={exports:{}},Nk;function KH(){return Nk||(Nk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),lr())})(ht,function(n){return function(s){var a=n,i=a.lib,o=i.CipherParams,c=a.enc,d=c.Hex,u=a.format;u.Hex={stringify:function(m){return m.ciphertext.toString(d)},parse:function(m){var f=d.parse(m);return o.create({ciphertext:f})}}}(),n.format.Hex})}(Bv)),Bv.exports}var zv={exports:{}},Sk;function ZH(){return Sk||(Sk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),Kl(),Zl(),Wo(),lr())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.BlockCipher,o=s.algo,c=[],d=[],u=[],m=[],f=[],p=[],y=[],j=[],v=[],_=[];(function(){for(var N=[],S=0;S<256;S++)S<128?N[S]=S<<1:N[S]=S<<1^283;for(var A=0,E=0,S=0;S<256;S++){var D=E^E<<1^E<<2^E<<3^E<<4;D=D>>>8^D&255^99,c[A]=D,d[D]=A;var M=N[A],B=N[M],R=N[B],P=N[D]*257^D*16843008;u[A]=P<<24|P>>>8,m[A]=P<<16|P>>>16,f[A]=P<<8|P>>>24,p[A]=P;var P=R*16843009^B*65537^M*257^A*16843008;y[D]=P<<24|P>>>8,j[D]=P<<16|P>>>16,v[D]=P<<8|P>>>24,_[D]=P,A?(A=M^N[N[N[R^M]]],E^=N[N[E]]):A=E=1}})();var b=[0,1,2,4,8,16,32,64,128,27,54],w=o.AES=i.extend({_doReset:function(){var N;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var S=this._keyPriorReset=this._key,A=S.words,E=S.sigBytes/4,D=this._nRounds=E+6,M=(D+1)*4,B=this._keySchedule=[],R=0;R<M;R++)R<E?B[R]=A[R]:(N=B[R-1],R%E?E>6&&R%E==4&&(N=c[N>>>24]<<24|c[N>>>16&255]<<16|c[N>>>8&255]<<8|c[N&255]):(N=N<<8|N>>>24,N=c[N>>>24]<<24|c[N>>>16&255]<<16|c[N>>>8&255]<<8|c[N&255],N^=b[R/E|0]<<24),B[R]=B[R-E]^N);for(var P=this._invKeySchedule=[],F=0;F<M;F++){var R=M-F;if(F%4)var N=B[R];else var N=B[R-4];F<4||R<=4?P[F]=N:P[F]=y[c[N>>>24]]^j[c[N>>>16&255]]^v[c[N>>>8&255]]^_[c[N&255]]}}},encryptBlock:function(N,S){this._doCryptBlock(N,S,this._keySchedule,u,m,f,p,c)},decryptBlock:function(N,S){var A=N[S+1];N[S+1]=N[S+3],N[S+3]=A,this._doCryptBlock(N,S,this._invKeySchedule,y,j,v,_,d);var A=N[S+1];N[S+1]=N[S+3],N[S+3]=A},_doCryptBlock:function(N,S,A,E,D,M,B,R){for(var P=this._nRounds,F=N[S]^A[0],W=N[S+1]^A[1],ee=N[S+2]^A[2],ue=N[S+3]^A[3],de=4,Q=1;Q<P;Q++){var z=E[F>>>24]^D[W>>>16&255]^M[ee>>>8&255]^B[ue&255]^A[de++],V=E[W>>>24]^D[ee>>>16&255]^M[ue>>>8&255]^B[F&255]^A[de++],U=E[ee>>>24]^D[ue>>>16&255]^M[F>>>8&255]^B[W&255]^A[de++],O=E[ue>>>24]^D[F>>>16&255]^M[W>>>8&255]^B[ee&255]^A[de++];F=z,W=V,ee=U,ue=O}var z=(R[F>>>24]<<24|R[W>>>16&255]<<16|R[ee>>>8&255]<<8|R[ue&255])^A[de++],V=(R[W>>>24]<<24|R[ee>>>16&255]<<16|R[ue>>>8&255]<<8|R[F&255])^A[de++],U=(R[ee>>>24]<<24|R[ue>>>16&255]<<16|R[F>>>8&255]<<8|R[W&255])^A[de++],O=(R[ue>>>24]<<24|R[F>>>16&255]<<16|R[W>>>8&255]<<8|R[ee&255])^A[de++];N[S]=z,N[S+1]=V,N[S+2]=U,N[S+3]=O},keySize:256/32});s.AES=i._createHelper(w)}(),n.AES})}(zv)),zv.exports}var $v={exports:{}},kk;function GH(){return kk||(kk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),Kl(),Zl(),Wo(),lr())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=a.BlockCipher,c=s.algo,d=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],m=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],p=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],y=c.DES=o.extend({_doReset:function(){for(var b=this._key,w=b.words,N=[],S=0;S<56;S++){var A=d[S]-1;N[S]=w[A>>>5]>>>31-A%32&1}for(var E=this._subKeys=[],D=0;D<16;D++){for(var M=E[D]=[],B=m[D],S=0;S<24;S++)M[S/6|0]|=N[(u[S]-1+B)%28]<<31-S%6,M[4+(S/6|0)]|=N[28+(u[S+24]-1+B)%28]<<31-S%6;M[0]=M[0]<<1|M[0]>>>31;for(var S=1;S<7;S++)M[S]=M[S]>>>(S-1)*4+3;M[7]=M[7]<<5|M[7]>>>27}for(var R=this._invSubKeys=[],S=0;S<16;S++)R[S]=E[15-S]},encryptBlock:function(b,w){this._doCryptBlock(b,w,this._subKeys)},decryptBlock:function(b,w){this._doCryptBlock(b,w,this._invSubKeys)},_doCryptBlock:function(b,w,N){this._lBlock=b[w],this._rBlock=b[w+1],j.call(this,4,252645135),j.call(this,16,65535),v.call(this,2,858993459),v.call(this,8,16711935),j.call(this,1,1431655765);for(var S=0;S<16;S++){for(var A=N[S],E=this._lBlock,D=this._rBlock,M=0,B=0;B<8;B++)M|=f[B][((D^A[B])&p[B])>>>0];this._lBlock=D,this._rBlock=E^M}var R=this._lBlock;this._lBlock=this._rBlock,this._rBlock=R,j.call(this,1,1431655765),v.call(this,8,16711935),v.call(this,2,858993459),j.call(this,16,65535),j.call(this,4,252645135),b[w]=this._lBlock,b[w+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function j(b,w){var N=(this._lBlock>>>b^this._rBlock)&w;this._rBlock^=N,this._lBlock^=N<<b}function v(b,w){var N=(this._rBlock>>>b^this._lBlock)&w;this._lBlock^=N,this._rBlock^=N<<b}s.DES=o._createHelper(y);var _=c.TripleDES=o.extend({_doReset:function(){var b=this._key,w=b.words;if(w.length!==2&&w.length!==4&&w.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var N=w.slice(0,2),S=w.length<4?w.slice(0,2):w.slice(2,4),A=w.length<6?w.slice(0,2):w.slice(4,6);this._des1=y.createEncryptor(i.create(N)),this._des2=y.createEncryptor(i.create(S)),this._des3=y.createEncryptor(i.create(A))},encryptBlock:function(b,w){this._des1.encryptBlock(b,w),this._des2.decryptBlock(b,w),this._des3.encryptBlock(b,w)},decryptBlock:function(b,w){this._des3.decryptBlock(b,w),this._des2.encryptBlock(b,w),this._des1.decryptBlock(b,w)},keySize:192/32,ivSize:64/32,blockSize:64/32});s.TripleDES=o._createHelper(_)}(),n.TripleDES})}($v)),$v.exports}var Uv={exports:{}},Ck;function QH(){return Ck||(Ck=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),Kl(),Zl(),Wo(),lr())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.StreamCipher,o=s.algo,c=o.RC4=i.extend({_doReset:function(){for(var m=this._key,f=m.words,p=m.sigBytes,y=this._S=[],j=0;j<256;j++)y[j]=j;for(var j=0,v=0;j<256;j++){var _=j%p,b=f[_>>>2]>>>24-_%4*8&255;v=(v+y[j]+b)%256;var w=y[j];y[j]=y[v],y[v]=w}this._i=this._j=0},_doProcessBlock:function(m,f){m[f]^=d.call(this)},keySize:256/32,ivSize:0});function d(){for(var m=this._S,f=this._i,p=this._j,y=0,j=0;j<4;j++){f=(f+1)%256,p=(p+m[f])%256;var v=m[f];m[f]=m[p],m[p]=v,y|=m[(m[f]+m[p])%256]<<24-j*8}return this._i=f,this._j=p,y}s.RC4=i._createHelper(c);var u=o.RC4Drop=c.extend({cfg:c.cfg.extend({drop:192}),_doReset:function(){c._doReset.call(this);for(var m=this.cfg.drop;m>0;m--)d.call(this)}});s.RC4Drop=i._createHelper(u)}(),n.RC4})}(Uv)),Uv.exports}var qv={exports:{}},Ek;function YH(){return Ek||(Ek=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),Kl(),Zl(),Wo(),lr())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.StreamCipher,o=s.algo,c=[],d=[],u=[],m=o.Rabbit=i.extend({_doReset:function(){for(var p=this._key.words,y=this.cfg.iv,j=0;j<4;j++)p[j]=(p[j]<<8|p[j]>>>24)&16711935|(p[j]<<24|p[j]>>>8)&4278255360;var v=this._X=[p[0],p[3]<<16|p[2]>>>16,p[1],p[0]<<16|p[3]>>>16,p[2],p[1]<<16|p[0]>>>16,p[3],p[2]<<16|p[1]>>>16],_=this._C=[p[2]<<16|p[2]>>>16,p[0]&4294901760|p[1]&65535,p[3]<<16|p[3]>>>16,p[1]&4294901760|p[2]&65535,p[0]<<16|p[0]>>>16,p[2]&4294901760|p[3]&65535,p[1]<<16|p[1]>>>16,p[3]&4294901760|p[0]&65535];this._b=0;for(var j=0;j<4;j++)f.call(this);for(var j=0;j<8;j++)_[j]^=v[j+4&7];if(y){var b=y.words,w=b[0],N=b[1],S=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,A=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,E=S>>>16|A&4294901760,D=A<<16|S&65535;_[0]^=S,_[1]^=E,_[2]^=A,_[3]^=D,_[4]^=S,_[5]^=E,_[6]^=A,_[7]^=D;for(var j=0;j<4;j++)f.call(this)}},_doProcessBlock:function(p,y){var j=this._X;f.call(this),c[0]=j[0]^j[5]>>>16^j[3]<<16,c[1]=j[2]^j[7]>>>16^j[5]<<16,c[2]=j[4]^j[1]>>>16^j[7]<<16,c[3]=j[6]^j[3]>>>16^j[1]<<16;for(var v=0;v<4;v++)c[v]=(c[v]<<8|c[v]>>>24)&16711935|(c[v]<<24|c[v]>>>8)&4278255360,p[y+v]^=c[v]},blockSize:128/32,ivSize:64/32});function f(){for(var p=this._X,y=this._C,j=0;j<8;j++)d[j]=y[j];y[0]=y[0]+1295307597+this._b|0,y[1]=y[1]+3545052371+(y[0]>>>0<d[0]>>>0?1:0)|0,y[2]=y[2]+886263092+(y[1]>>>0<d[1]>>>0?1:0)|0,y[3]=y[3]+1295307597+(y[2]>>>0<d[2]>>>0?1:0)|0,y[4]=y[4]+3545052371+(y[3]>>>0<d[3]>>>0?1:0)|0,y[5]=y[5]+886263092+(y[4]>>>0<d[4]>>>0?1:0)|0,y[6]=y[6]+1295307597+(y[5]>>>0<d[5]>>>0?1:0)|0,y[7]=y[7]+3545052371+(y[6]>>>0<d[6]>>>0?1:0)|0,this._b=y[7]>>>0<d[7]>>>0?1:0;for(var j=0;j<8;j++){var v=p[j]+y[j],_=v&65535,b=v>>>16,w=((_*_>>>17)+_*b>>>15)+b*b,N=((v&4294901760)*v|0)+((v&65535)*v|0);u[j]=w^N}p[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,p[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,p[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,p[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,p[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,p[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,p[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,p[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}s.Rabbit=i._createHelper(m)}(),n.Rabbit})}(qv)),qv.exports}var Wv={exports:{}},Ak;function XH(){return Ak||(Ak=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),Kl(),Zl(),Wo(),lr())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.StreamCipher,o=s.algo,c=[],d=[],u=[],m=o.RabbitLegacy=i.extend({_doReset:function(){var p=this._key.words,y=this.cfg.iv,j=this._X=[p[0],p[3]<<16|p[2]>>>16,p[1],p[0]<<16|p[3]>>>16,p[2],p[1]<<16|p[0]>>>16,p[3],p[2]<<16|p[1]>>>16],v=this._C=[p[2]<<16|p[2]>>>16,p[0]&4294901760|p[1]&65535,p[3]<<16|p[3]>>>16,p[1]&4294901760|p[2]&65535,p[0]<<16|p[0]>>>16,p[2]&4294901760|p[3]&65535,p[1]<<16|p[1]>>>16,p[3]&4294901760|p[0]&65535];this._b=0;for(var _=0;_<4;_++)f.call(this);for(var _=0;_<8;_++)v[_]^=j[_+4&7];if(y){var b=y.words,w=b[0],N=b[1],S=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,A=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,E=S>>>16|A&4294901760,D=A<<16|S&65535;v[0]^=S,v[1]^=E,v[2]^=A,v[3]^=D,v[4]^=S,v[5]^=E,v[6]^=A,v[7]^=D;for(var _=0;_<4;_++)f.call(this)}},_doProcessBlock:function(p,y){var j=this._X;f.call(this),c[0]=j[0]^j[5]>>>16^j[3]<<16,c[1]=j[2]^j[7]>>>16^j[5]<<16,c[2]=j[4]^j[1]>>>16^j[7]<<16,c[3]=j[6]^j[3]>>>16^j[1]<<16;for(var v=0;v<4;v++)c[v]=(c[v]<<8|c[v]>>>24)&16711935|(c[v]<<24|c[v]>>>8)&4278255360,p[y+v]^=c[v]},blockSize:128/32,ivSize:64/32});function f(){for(var p=this._X,y=this._C,j=0;j<8;j++)d[j]=y[j];y[0]=y[0]+1295307597+this._b|0,y[1]=y[1]+3545052371+(y[0]>>>0<d[0]>>>0?1:0)|0,y[2]=y[2]+886263092+(y[1]>>>0<d[1]>>>0?1:0)|0,y[3]=y[3]+1295307597+(y[2]>>>0<d[2]>>>0?1:0)|0,y[4]=y[4]+3545052371+(y[3]>>>0<d[3]>>>0?1:0)|0,y[5]=y[5]+886263092+(y[4]>>>0<d[4]>>>0?1:0)|0,y[6]=y[6]+1295307597+(y[5]>>>0<d[5]>>>0?1:0)|0,y[7]=y[7]+3545052371+(y[6]>>>0<d[6]>>>0?1:0)|0,this._b=y[7]>>>0<d[7]>>>0?1:0;for(var j=0;j<8;j++){var v=p[j]+y[j],_=v&65535,b=v>>>16,w=((_*_>>>17)+_*b>>>15)+b*b,N=((v&4294901760)*v|0)+((v&65535)*v|0);u[j]=w^N}p[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,p[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,p[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,p[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,p[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,p[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,p[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,p[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}s.RabbitLegacy=i._createHelper(m)}(),n.RabbitLegacy})}(Wv)),Wv.exports}var Hv={exports:{}},Pk;function JH(){return Pk||(Pk=1,function(t,e){(function(n,s,a){t.exports=s(Qt(),Kl(),Zl(),Wo(),lr())})(ht,function(n){return function(){var s=n,a=s.lib,i=a.BlockCipher,o=s.algo;const c=16,d=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],u=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var m={pbox:[],sbox:[]};function f(_,b){let w=b>>24&255,N=b>>16&255,S=b>>8&255,A=b&255,E=_.sbox[0][w]+_.sbox[1][N];return E=E^_.sbox[2][S],E=E+_.sbox[3][A],E}function p(_,b,w){let N=b,S=w,A;for(let E=0;E<c;++E)N=N^_.pbox[E],S=f(_,N)^S,A=N,N=S,S=A;return A=N,N=S,S=A,S=S^_.pbox[c],N=N^_.pbox[c+1],{left:N,right:S}}function y(_,b,w){let N=b,S=w,A;for(let E=c+1;E>1;--E)N=N^_.pbox[E],S=f(_,N)^S,A=N,N=S,S=A;return A=N,N=S,S=A,S=S^_.pbox[1],N=N^_.pbox[0],{left:N,right:S}}function j(_,b,w){for(let D=0;D<4;D++){_.sbox[D]=[];for(let M=0;M<256;M++)_.sbox[D][M]=u[D][M]}let N=0;for(let D=0;D<c+2;D++)_.pbox[D]=d[D]^b[N],N++,N>=w&&(N=0);let S=0,A=0,E=0;for(let D=0;D<c+2;D+=2)E=p(_,S,A),S=E.left,A=E.right,_.pbox[D]=S,_.pbox[D+1]=A;for(let D=0;D<4;D++)for(let M=0;M<256;M+=2)E=p(_,S,A),S=E.left,A=E.right,_.sbox[D][M]=S,_.sbox[D][M+1]=A;return!0}var v=o.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var _=this._keyPriorReset=this._key,b=_.words,w=_.sigBytes/4;j(m,b,w)}},encryptBlock:function(_,b){var w=p(m,_[b],_[b+1]);_[b]=w.left,_[b+1]=w.right},decryptBlock:function(_,b){var w=y(m,_[b],_[b+1]);_[b]=w.left,_[b+1]=w.right},blockSize:64/32,keySize:128/32,ivSize:64/32});s.Blowfish=i._createHelper(v)}(),n.Blowfish})}(Hv)),Hv.exports}(function(t,e){(function(n,s,a){t.exports=s(Qt(),wg(),AH(),PH(),Kl(),DH(),Zl(),fT(),bj(),TH(),mT(),MH(),RH(),IH(),jj(),OH(),Wo(),lr(),LH(),FH(),BH(),zH(),$H(),UH(),qH(),WH(),HH(),VH(),KH(),ZH(),GH(),QH(),YH(),XH(),JH())})(ht,function(n){return n})})(SH);C.object({sequence_type:C.enum(["invoice","quote","order","receipt","credit_note","delivery_note","payment_voucher"]),prefix:C.string().min(1).max(10),format:C.string().min(1),reset_annually:C.boolean().default(!0),gap_tracking:C.boolean().default(!0)});C.object({entity_type:C.string().min(1),entity_id:C.string().min(1),document_content:C.string().min(1),file_name:C.string().min(1),mime_type:C.string().min(1)});C.object({year:C.number().min(2020).max(2030),quarter:C.number().min(1).max(4).optional(),month:C.number().min(1).max(12).optional(),from_date:C.string().regex(/^\d{4}-\d{2}-\d{2}$/),to_date:C.string().regex(/^\d{4}-\d{2}-\d{2}$/)});const eV={requireHumanApproval:!0,gates:{aiEstimateApply:!0,aiScheduleApply:!0,customerScoringAction:!0,employeeScoringAction:!0}};async function tV(t){try{await fetch("/api/audit/approval",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch{console.warn("[approval] audit log failed (non-blocking)",t)}}async function nV(t){let e=!0;if(typeof window<"u"&&typeof window.confirm=="function"){const n=`Bitte bestätigen:

${t.reason}

Hinweis: Diese Aktion basiert auf einem KI/Score-Vorschlag und erfordert Ihre Freigabe.`;e=window.confirm(n)}return await tV({...t,approved:e,timestamp:new Date().toISOString()}),e}async function rV(t){return!!eV.gates[t]}async function pT(t,e,n){if(!(await rV(t)&&!await nV({action:e.action??t.toString().toUpperCase(),reason:e.reason,metadata:e.metadata,userId:e.userId})))return await n()}C.object({year:C.number().min(2020).max(2030),quarter:C.number().min(1).max(4).optional(),month:C.number().min(1).max(12).optional(),period_type:C.enum(["MONTHLY","QUARTERLY","ANNUAL"]),start_date:C.string().regex(/^\d{4}-\d{2}-\d{2}$/),end_date:C.string().regex(/^\d{4}-\d{2}-\d{2}$/)});C.object({document_type:C.enum(["invoice","quote","order","project","customer","material","timesheet","expense","knowledge_base","email","pdf_document"]),entity_id:C.string(),title:C.string().min(1),content:C.string().min(1),metadata:C.record(C.any()).default({}),language:C.enum(["de","en"]).default("de"),search_tags:C.array(C.string()).default([]),importance_score:C.number().min(0).max(1).default(.5)});C.object({query:C.string().min(1),document_types:C.array(C.enum(["invoice","quote","order","project","customer","material","timesheet","expense","knowledge_base","email","pdf_document"])).optional(),date_range:C.object({from:C.string(),to:C.string()}).optional(),language:C.enum(["de","en"]).default("de"),limit:C.number().min(1).max(100).default(10),similarity_threshold:C.number().min(0).max(1).default(.7),include_metadata:C.boolean().default(!0)});C.object({user_input:C.string().min(1),detected_intent:C.enum(["SEARCH_REQUEST","CREATE_ENTITY","UPDATE_ENTITY","REPORT_REQUEST","CALCULATION_REQUEST","SCHEDULE_TASK","COMPLIANCE_CHECK","EXPORT_REQUEST","NOTIFICATION_SETUP","HELP_REQUEST","UNKNOWN"]),target_entity:C.enum(["customer","invoice","quote","order","project","material","employee","timesheet","expense","report","notification"]).optional(),suggested_action:C.enum(["CREATE","READ","UPDATE","DELETE","SEARCH","EXPORT","CALCULATE","SCHEDULE","NOTIFY","VALIDATE"]).optional(),extracted_parameters:C.record(C.any()).default({}),confidence_score:C.number().min(0).max(1)});C.object({estimation_type:C.enum(["PROJECT_COST","MATERIAL_COST","LABOR_COST","TIME_ESTIMATION","COMPLETION_DATE","RESOURCE_NEED","PROFIT_MARGIN","RISK_ASSESSMENT"]),project_category:C.enum(["BATHROOM_RENOVATION","KITCHEN_RENOVATION","ELECTRICAL_WORK","PLUMBING_WORK","FLOORING_WORK","PAINTING_WORK","ROOFING_WORK","GENERAL_CONSTRUCTION","MAINTENANCE","CUSTOM_WORK"]),project_description:C.string().min(10),project_size:C.object({area_sqm:C.number().positive().optional(),rooms:C.number().int().positive().optional(),complexity_level:C.number().int().min(1).max(5)}),customer_requirements:C.array(C.string()).default([]),timeline_constraints:C.object({start_date:C.string().optional(),end_date:C.string().optional(),fixed_deadline:C.boolean().default(!1)}).optional(),budget_constraints:C.object({min_budget:C.number().positive().optional(),max_budget:C.number().positive().optional(),flexible:C.boolean().default(!0)}).optional(),additional_context:C.record(C.any()).default({})});async function sV(t){return await pT("aiEstimateApply",{reason:"KI-Schätzung soll übernommen werden.",metadata:{projectId:t.projectId,quoteId:t.quoteId},userId:t.userId},async()=>(console.log("Applying AI estimate:",t),t.estimate))}var aV={exports:{}};(function(t){var e=function(n){var s=Object.prototype,a=s.hasOwnProperty,i=Object.defineProperty||function(V,U,O){V[U]=O.value},o,c=typeof Symbol=="function"?Symbol:{},d=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",m=c.toStringTag||"@@toStringTag";function f(V,U,O){return Object.defineProperty(V,U,{value:O,enumerable:!0,configurable:!0,writable:!0}),V[U]}try{f({},"")}catch{f=function(U,O,I){return U[O]=I}}function p(V,U,O,I){var H=U&&U.prototype instanceof N?U:N,$=Object.create(H.prototype),te=new de(I||[]);return i($,"_invoke",{value:F(V,O,te)}),$}n.wrap=p;function y(V,U,O){try{return{type:"normal",arg:V.call(U,O)}}catch(I){return{type:"throw",arg:I}}}var j="suspendedStart",v="suspendedYield",_="executing",b="completed",w={};function N(){}function S(){}function A(){}var E={};f(E,d,function(){return this});var D=Object.getPrototypeOf,M=D&&D(D(Q([])));M&&M!==s&&a.call(M,d)&&(E=M);var B=A.prototype=N.prototype=Object.create(E);S.prototype=A,i(B,"constructor",{value:A,configurable:!0}),i(A,"constructor",{value:S,configurable:!0}),S.displayName=f(A,m,"GeneratorFunction");function R(V){["next","throw","return"].forEach(function(U){f(V,U,function(O){return this._invoke(U,O)})})}n.isGeneratorFunction=function(V){var U=typeof V=="function"&&V.constructor;return U?U===S||(U.displayName||U.name)==="GeneratorFunction":!1},n.mark=function(V){return Object.setPrototypeOf?Object.setPrototypeOf(V,A):(V.__proto__=A,f(V,m,"GeneratorFunction")),V.prototype=Object.create(B),V},n.awrap=function(V){return{__await:V}};function P(V,U){function O($,te,X,Z){var ie=y(V[$],V,te);if(ie.type==="throw")Z(ie.arg);else{var pe=ie.arg,G=pe.value;return G&&typeof G=="object"&&a.call(G,"__await")?U.resolve(G.__await).then(function(se){O("next",se,X,Z)},function(se){O("throw",se,X,Z)}):U.resolve(G).then(function(se){pe.value=se,X(pe)},function(se){return O("throw",se,X,Z)})}}var I;function H($,te){function X(){return new U(function(Z,ie){O($,te,Z,ie)})}return I=I?I.then(X,X):X()}i(this,"_invoke",{value:H})}R(P.prototype),f(P.prototype,u,function(){return this}),n.AsyncIterator=P,n.async=function(V,U,O,I,H){H===void 0&&(H=Promise);var $=new P(p(V,U,O,I),H);return n.isGeneratorFunction(U)?$:$.next().then(function(te){return te.done?te.value:$.next()})};function F(V,U,O){var I=j;return function($,te){if(I===_)throw new Error("Generator is already running");if(I===b){if($==="throw")throw te;return z()}for(O.method=$,O.arg=te;;){var X=O.delegate;if(X){var Z=W(X,O);if(Z){if(Z===w)continue;return Z}}if(O.method==="next")O.sent=O._sent=O.arg;else if(O.method==="throw"){if(I===j)throw I=b,O.arg;O.dispatchException(O.arg)}else O.method==="return"&&O.abrupt("return",O.arg);I=_;var ie=y(V,U,O);if(ie.type==="normal"){if(I=O.done?b:v,ie.arg===w)continue;return{value:ie.arg,done:O.done}}else ie.type==="throw"&&(I=b,O.method="throw",O.arg=ie.arg)}}}function W(V,U){var O=U.method,I=V.iterator[O];if(I===o)return U.delegate=null,O==="throw"&&V.iterator.return&&(U.method="return",U.arg=o,W(V,U),U.method==="throw")||O!=="return"&&(U.method="throw",U.arg=new TypeError("The iterator does not provide a '"+O+"' method")),w;var H=y(I,V.iterator,U.arg);if(H.type==="throw")return U.method="throw",U.arg=H.arg,U.delegate=null,w;var $=H.arg;if(!$)return U.method="throw",U.arg=new TypeError("iterator result is not an object"),U.delegate=null,w;if($.done)U[V.resultName]=$.value,U.next=V.nextLoc,U.method!=="return"&&(U.method="next",U.arg=o);else return $;return U.delegate=null,w}R(B),f(B,m,"Generator"),f(B,d,function(){return this}),f(B,"toString",function(){return"[object Generator]"});function ee(V){var U={tryLoc:V[0]};1 in V&&(U.catchLoc=V[1]),2 in V&&(U.finallyLoc=V[2],U.afterLoc=V[3]),this.tryEntries.push(U)}function ue(V){var U=V.completion||{};U.type="normal",delete U.arg,V.completion=U}function de(V){this.tryEntries=[{tryLoc:"root"}],V.forEach(ee,this),this.reset(!0)}n.keys=function(V){var U=Object(V),O=[];for(var I in U)O.push(I);return O.reverse(),function H(){for(;O.length;){var $=O.pop();if($ in U)return H.value=$,H.done=!1,H}return H.done=!0,H}};function Q(V){if(V){var U=V[d];if(U)return U.call(V);if(typeof V.next=="function")return V;if(!isNaN(V.length)){var O=-1,I=function H(){for(;++O<V.length;)if(a.call(V,O))return H.value=V[O],H.done=!1,H;return H.value=o,H.done=!0,H};return I.next=I}}return{next:z}}n.values=Q;function z(){return{value:o,done:!0}}return de.prototype={constructor:de,reset:function(V){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(ue),!V)for(var U in this)U.charAt(0)==="t"&&a.call(this,U)&&!isNaN(+U.slice(1))&&(this[U]=o)},stop:function(){this.done=!0;var V=this.tryEntries[0],U=V.completion;if(U.type==="throw")throw U.arg;return this.rval},dispatchException:function(V){if(this.done)throw V;var U=this;function O(Z,ie){return $.type="throw",$.arg=V,U.next=Z,ie&&(U.method="next",U.arg=o),!!ie}for(var I=this.tryEntries.length-1;I>=0;--I){var H=this.tryEntries[I],$=H.completion;if(H.tryLoc==="root")return O("end");if(H.tryLoc<=this.prev){var te=a.call(H,"catchLoc"),X=a.call(H,"finallyLoc");if(te&&X){if(this.prev<H.catchLoc)return O(H.catchLoc,!0);if(this.prev<H.finallyLoc)return O(H.finallyLoc)}else if(te){if(this.prev<H.catchLoc)return O(H.catchLoc,!0)}else if(X){if(this.prev<H.finallyLoc)return O(H.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(V,U){for(var O=this.tryEntries.length-1;O>=0;--O){var I=this.tryEntries[O];if(I.tryLoc<=this.prev&&a.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var H=I;break}}H&&(V==="break"||V==="continue")&&H.tryLoc<=U&&U<=H.finallyLoc&&(H=null);var $=H?H.completion:{};return $.type=V,$.arg=U,H?(this.method="next",this.next=H.finallyLoc,w):this.complete($)},complete:function(V,U){if(V.type==="throw")throw V.arg;return V.type==="break"||V.type==="continue"?this.next=V.arg:V.type==="return"?(this.rval=this.arg=V.arg,this.method="return",this.next="end"):V.type==="normal"&&U&&(this.next=U),w},finish:function(V){for(var U=this.tryEntries.length-1;U>=0;--U){var O=this.tryEntries[U];if(O.finallyLoc===V)return this.complete(O.completion,O.afterLoc),ue(O),w}},catch:function(V){for(var U=this.tryEntries.length-1;U>=0;--U){var O=this.tryEntries[U];if(O.tryLoc===V){var I=O.completion;if(I.type==="throw"){var H=I.arg;ue(O)}return H}}throw new Error("illegal catch attempt")},delegateYield:function(V,U,O){return this.delegate={iterator:Q(V),resultName:U,nextLoc:O},this.method==="next"&&(this.arg=o),w}},n}(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(aV);var Nj=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`;const iV=Nj;let Dk=0;var gT=({id:t,action:e,payload:n={}})=>{let s=t;return typeof s>"u"&&(s=iV("Job",Dk),Dk+=1),{id:s,action:e,payload:n}},Hd={};let Sj=!1;Hd.logging=Sj;Hd.setLogging=t=>{Sj=t};Hd.log=(...t)=>Sj?console.log.apply(void 0,t):null;const oV=gT,{log:Pm}=Hd,lV=Nj;let Tk=0;var cV=()=>{const t=lV("Scheduler",Tk),e={},n={};let s=[];Tk+=1;const a=()=>s.length,i=()=>Object.keys(e).length,o=()=>{if(s.length!==0){const f=Object.keys(e);for(let p=0;p<f.length;p+=1)if(typeof n[f[p]]>"u"){s[0](e[f[p]]);break}}},c=(f,p)=>new Promise((y,j)=>{const v=oV({action:f,payload:p});s.push(async _=>{s.shift(),n[_.id]=v;try{y(await _[f].apply(void 0,[...p,v.id]))}catch(b){j(b)}finally{delete n[_.id],o()}}),Pm(`[${t}]: Add ${v.id} to JobQueue`),Pm(`[${t}]: JobQueue length=${s.length}`),o()});return{addWorker:f=>(e[f.id]=f,Pm(`[${t}]: Add ${f.id}`),Pm(`[${t}]: Number of workers=${i()}`),o(),f.id),addJob:async(f,...p)=>{if(i()===0)throw Error(`[${t}]: You need to have at least one worker before adding jobs`);return c(f,p)},terminate:async()=>{Object.keys(e).forEach(async f=>{await e[f].terminate()}),s=[]},getQueueLen:a,getNumWorkers:i}},dV=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof hT=="function"&&(e.type="node"),typeof t>"u"?e:e[t]};const uV=dV("type")==="browser",hV=uV?t=>new URL(t,window.location.href).href:t=>t;var fV=t=>{const e={...t};return["corePath","workerPath","langPath"].forEach(n=>{t[n]&&(e[n]=hV(e[n]))}),e},xT={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const mV="tesseract.js",pV="6.0.1",gV="Pure Javascript Multilingual OCR",xV="src/index.js",vV="commonjs",yV="src/index.d.ts",_V="dist/tesseract.min.js",wV="dist/tesseract.min.js",bV={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser test:node:all","test:browser":"karma start karma.conf.js","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.mjs","test:node:all":"npm run test:node -- ./tests/*.test.mjs",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},jV={"./src/worker/node/index.js":"./src/worker/browser/index.js"},NV="",SV=["jeromewu"],kV="Apache-2.0",CV={"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","npm-run-all":"^4.1.5",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-webpack":"^5.0.0",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},EV={"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^6.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},AV={"@rollup/pluginutils":"^5.0.2"},PV={type:"git",url:"https://github.com/naptha/tesseract.js.git"},DV={url:"https://github.com/naptha/tesseract.js/issues"},TV="https://github.com/naptha/tesseract.js",MV={type:"opencollective",url:"https://opencollective.com/tesseractjs"},RV={name:mV,version:pV,description:gV,main:xV,type:vV,types:yV,unpkg:_V,jsdelivr:wV,scripts:bV,browser:jV,author:NV,contributors:SV,license:kV,devDependencies:CV,dependencies:EV,overrides:AV,repository:PV,bugs:DV,homepage:TV,collective:MV};var IV={workerBlobURL:!0,logger:()=>{}};const OV=RV.version,LV=IV;var FV={...LV,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${OV}/dist/worker.min.js`},BV=({workerPath:t,workerBlobURL:e})=>{let n;if(Blob&&URL&&e){const s=new Blob([`importScripts("${t}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(s))}else n=new Worker(t);return n},zV=t=>{t.terminate()},$V=(t,e)=>{t.onmessage=({data:n})=>{e(n)}},UV=async(t,e)=>{t.postMessage(e)};const Vv=t=>new Promise((e,n)=>{const s=new FileReader;s.onload=()=>{e(s.result)},s.onerror=({target:{error:{code:a}}})=>{n(Error(`File could not be read! Code=${a}`))},s.readAsArrayBuffer(t)}),ow=async t=>{let e=t;if(typeof t>"u")return"undefined";if(typeof t=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t)?e=atob(t.split(",")[1]).split("").map(n=>n.charCodeAt(0)):e=await(await fetch(t)).arrayBuffer();else if(typeof HTMLElement<"u"&&t instanceof HTMLElement)t.tagName==="IMG"&&(e=await ow(t.src)),t.tagName==="VIDEO"&&(e=await ow(t.poster)),t.tagName==="CANVAS"&&await new Promise(n=>{t.toBlob(async s=>{e=await Vv(s),n()})});else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){const n=await t.convertToBlob();e=await Vv(n)}else(t instanceof File||t instanceof Blob)&&(e=await Vv(t));return new Uint8Array(e)};var qV=ow;const WV=FV,HV=BV,VV=zV,KV=$V,ZV=UV,GV=qV;var QV={defaultOptions:WV,spawnWorker:HV,terminateWorker:VV,onMessage:KV,send:ZV,loadImage:GV};const YV=fV,Sa=gT,{log:Mk}=Hd,XV=Nj,tl=xT,{defaultOptions:JV,spawnWorker:eK,terminateWorker:tK,onMessage:nK,loadImage:Rk,send:rK}=QV;let Ik=0;var vT=async(t="eng",e=tl.LSTM_ONLY,n={},s={})=>{const a=XV("Worker",Ik),{logger:i,errorHandler:o,...c}=YV({...JV,...n}),d={},u=typeof t=="string"?t.split("+"):t;let m=e,f=s;const p=[tl.DEFAULT,tl.LSTM_ONLY].includes(e)&&!c.legacyCore;let y,j;const v=new Promise((Q,z)=>{j=Q,y=z}),_=Q=>{y(Q.message)};let b=eK(c);b.onerror=_,Ik+=1;const w=({id:Q,action:z,payload:V})=>new Promise((U,O)=>{Mk(`[${a}]: Start ${Q}, action=${z}`);const I=`${z}-${Q}`;d[I]={resolve:U,reject:O},rK(b,{workerId:a,jobId:Q,action:z,payload:V})}),N=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),S=Q=>w(Sa({id:Q,action:"load",payload:{options:{lstmOnly:p,corePath:c.corePath,logging:c.logging}}})),A=(Q,z,V)=>w(Sa({id:V,action:"FS",payload:{method:"writeFile",args:[Q,z]}})),E=(Q,z)=>w(Sa({id:z,action:"FS",payload:{method:"readFile",args:[Q,{encoding:"utf8"}]}})),D=(Q,z)=>w(Sa({id:z,action:"FS",payload:{method:"unlink",args:[Q]}})),M=(Q,z,V)=>w(Sa({id:V,action:"FS",payload:{method:Q,args:z}})),B=(Q,z)=>w(Sa({id:z,action:"loadLanguage",payload:{langs:Q,options:{langPath:c.langPath,dataPath:c.dataPath,cachePath:c.cachePath,cacheMethod:c.cacheMethod,gzip:c.gzip,lstmOnly:[tl.DEFAULT,tl.LSTM_ONLY].includes(m)&&!c.legacyLang}}})),R=(Q,z,V,U)=>w(Sa({id:U,action:"initialize",payload:{langs:Q,oem:z,config:V}})),P=(Q="eng",z,V,U)=>{if(p&&[tl.TESSERACT_ONLY,tl.TESSERACT_LSTM_COMBINED].includes(z))throw Error("Legacy model requested but code missing.");const O=z||m;m=O;const I=V||f;f=I;const $=(typeof Q=="string"?Q.split("+"):Q).filter(te=>!u.includes(te));return u.push(...$),$.length>0?B($,U).then(()=>R(Q,O,I,U)):R(Q,O,I,U)},F=(Q={},z)=>w(Sa({id:z,action:"setParameters",payload:{params:Q}})),W=async(Q,z={},V={text:!0},U)=>w(Sa({id:U,action:"recognize",payload:{image:await Rk(Q),options:z,output:V}})),ee=async(Q,z)=>{if(p)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return w(Sa({id:z,action:"detect",payload:{image:await Rk(Q)}}))},ue=async()=>(b!==null&&(tK(b),b=null),Promise.resolve());nK(b,({workerId:Q,jobId:z,status:V,action:U,data:O})=>{const I=`${U}-${z}`;if(V==="resolve")Mk(`[${Q}]: Complete ${z}`),d[I].resolve({jobId:z,data:O}),delete d[I];else if(V==="reject")if(d[I].reject(O),delete d[I],U==="load"&&y(O),o)o(O);else throw Error(O);else V==="progress"&&i({...O,userJobId:z})});const de={id:a,worker:b,load:N,writeText:A,readText:E,removeFile:D,FS:M,reinitialize:P,setParameters:F,recognize:W,detect:ee,terminate:ue};return S().then(()=>B(t)).then(()=>R(t,e,s)).then(()=>j(de)).catch(()=>{}),v};const yT=vT,sK=async(t,e,n)=>{const s=await yT(e,1,n);return s.recognize(t).finally(async()=>{await s.terminate()})},aK=async(t,e)=>{const n=await yT("osd",0,e);return n.detect(t).finally(async()=>{await n.terminate()})};var iK={recognize:sK,detect:aK},oK={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},lK={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const cK=cV,dK=vT,uK=iK,hK=oK,fK=xT,mK=lK,{setLogging:pK}=Hd;var Ok={languages:hK,OEM:fK,PSM:mK,createScheduler:cK,createWorker:dK,setLogging:pK,...uK};function kt(t,e,n,s,a){if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function ge(t,e,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(t):s?s.value:e.get(t)}let _T=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return _T=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^n()&15>>+s/4).toString(16))};function lw(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const cw=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class wt extends Error{}class vr extends wt{constructor(e,n,s,a){super(`${vr.makeMessage(e,n,s)}`),this.status=e,this.headers=a,this.requestID=a==null?void 0:a.get("x-request-id"),this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,s){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):s;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,n,s,a){if(!e||!a)return new bg({message:s,cause:cw(n)});const i=n==null?void 0:n.error;return e===400?new wT(e,i,s,a):e===401?new bT(e,i,s,a):e===403?new jT(e,i,s,a):e===404?new NT(e,i,s,a):e===409?new ST(e,i,s,a):e===422?new kT(e,i,s,a):e===429?new CT(e,i,s,a):e>=500?new ET(e,i,s,a):new vr(e,i,s,a)}}class Is extends vr{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class bg extends vr{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class kj extends bg{constructor({message:e}={}){super({message:e??"Request timed out."})}}class wT extends vr{}class bT extends vr{}class jT extends vr{}class NT extends vr{}class ST extends vr{}class kT extends vr{}class CT extends vr{}class ET extends vr{}class AT extends wt{constructor(){super("Could not parse response content as the length limit was reached")}}class PT extends wt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Pu extends Error{constructor(e){super(e)}}const gK=/^[a-z][a-z0-9+.-]*:/i,xK=t=>gK.test(t);let Qr=t=>(Qr=Array.isArray,Qr(t)),Lk=Qr;function DT(t){return typeof t!="object"?{}:t??{}}function vK(t){if(!t)return!0;for(const e in t)return!1;return!0}function yK(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Kv(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const _K=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new wt(`${t} must be an integer`);if(e<0)throw new wt(`${t} must be a positive integer`);return e},wK=t=>{try{return JSON.parse(t)}catch{return}},wf=t=>new Promise(e=>setTimeout(e,t)),wc="5.16.0",bK=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function jK(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const NK=()=>{var n;const t=jK();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wc,"X-Stainless-OS":Bk(Deno.build.os),"X-Stainless-Arch":Fk(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((n=Deno.version)==null?void 0:n.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wc,"X-Stainless-OS":Bk(globalThis.process.platform??"unknown"),"X-Stainless-Arch":Fk(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=SK();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":wc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function SK(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const s=n.exec(navigator.userAgent);if(s){const a=s[1]||0,i=s[2]||0,o=s[3]||0;return{browser:e,version:`${a}.${i}.${o}`}}}return null}const Fk=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Bk=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let zk;const kK=()=>zk??(zk=NK());function CK(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function TT(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function MT(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return TT({start(){},async pull(n){const{done:s,value:a}=await e.next();s?n.close():n.enqueue(a)},async cancel(){var n;await((n=e.return)==null?void 0:n.call(e))}})}function RT(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function EK(t){var s,a;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((a=(s=t[Symbol.asyncIterator]()).return)==null?void 0:a.call(s));return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const AK=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),IT="RFC3986",OT=t=>String(t),$k={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:OT},PK="RFC1738";let dw=(t,e)=>(dw=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),dw(t,e));const ka=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),Zv=1024,DK=(t,e,n,s,a)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});let o="";for(let c=0;c<i.length;c+=Zv){const d=i.length>=Zv?i.slice(c,c+Zv):i,u=[];for(let m=0;m<d.length;++m){let f=d.charCodeAt(m);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||a===PK&&(f===40||f===41)){u[u.length]=d.charAt(m);continue}if(f<128){u[u.length]=ka[f];continue}if(f<2048){u[u.length]=ka[192|f>>6]+ka[128|f&63];continue}if(f<55296||f>=57344){u[u.length]=ka[224|f>>12]+ka[128|f>>6&63]+ka[128|f&63];continue}m+=1,f=65536+((f&1023)<<10|d.charCodeAt(m)&1023),u[u.length]=ka[240|f>>18]+ka[128|f>>12&63]+ka[128|f>>6&63]+ka[128|f&63]}o+=u.join("")}return o};function TK(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function Uk(t,e){if(Qr(t)){const n=[];for(let s=0;s<t.length;s+=1)n.push(e(t[s]));return n}return e(t)}const LT={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},FT=function(t,e){Array.prototype.push.apply(t,Qr(e)?e:[e])};let qk;const Zn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:DK,encodeValuesOnly:!1,format:IT,formatter:OT,indices:!1,serializeDate(t){return(qk??(qk=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function MK(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const Gv={};function BT(t,e,n,s,a,i,o,c,d,u,m,f,p,y,j,v,_,b){let w=t,N=b,S=0,A=!1;for(;(N=N.get(Gv))!==void 0&&!A;){const R=N.get(t);if(S+=1,typeof R<"u"){if(R===S)throw new RangeError("Cyclic object value");A=!0}typeof N.get(Gv)>"u"&&(S=0)}if(typeof u=="function"?w=u(e,w):w instanceof Date?w=p==null?void 0:p(w):n==="comma"&&Qr(w)&&(w=Uk(w,function(R){return R instanceof Date?p==null?void 0:p(R):R})),w===null){if(i)return d&&!v?d(e,Zn.encoder,_,"key",y):e;w=""}if(MK(w)||TK(w)){if(d){const R=v?e:d(e,Zn.encoder,_,"key",y);return[(j==null?void 0:j(R))+"="+(j==null?void 0:j(d(w,Zn.encoder,_,"value",y)))]}return[(j==null?void 0:j(e))+"="+(j==null?void 0:j(String(w)))]}const E=[];if(typeof w>"u")return E;let D;if(n==="comma"&&Qr(w))v&&d&&(w=Uk(w,d)),D=[{value:w.length>0?w.join(",")||null:void 0}];else if(Qr(u))D=u;else{const R=Object.keys(w);D=m?R.sort(m):R}const M=c?String(e).replace(/\./g,"%2E"):String(e),B=s&&Qr(w)&&w.length===1?M+"[]":M;if(a&&Qr(w)&&w.length===0)return B+"[]";for(let R=0;R<D.length;++R){const P=D[R],F=typeof P=="object"&&typeof P.value<"u"?P.value:w[P];if(o&&F===null)continue;const W=f&&c?P.replace(/\./g,"%2E"):P,ee=Qr(w)?typeof n=="function"?n(B,W):B:B+(f?"."+W:"["+W+"]");b.set(t,S);const ue=new WeakMap;ue.set(Gv,b),FT(E,BT(F,ee,n,s,a,i,o,c,n==="comma"&&v&&Qr(w)?null:d,u,m,f,p,y,j,v,_,ue))}return E}function RK(t=Zn){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Zn.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=IT;if(typeof t.format<"u"){if(!dw($k,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const s=$k[n];let a=Zn.filter;(typeof t.filter=="function"||Qr(t.filter))&&(a=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in LT?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=Zn.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Zn.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Zn.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Zn.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Zn.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Zn.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Zn.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Zn.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Zn.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Zn.encodeValuesOnly,filter:a,format:n,formatter:s,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Zn.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Zn.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Zn.strictNullHandling}}function IK(t,e={}){let n=t;const s=RK(e);let a,i;typeof s.filter=="function"?(i=s.filter,n=i("",n)):Qr(s.filter)&&(i=s.filter,a=i);const o=[];if(typeof n!="object"||n===null)return"";const c=LT[s.arrayFormat],d=c==="comma"&&s.commaRoundTrip;a||(a=Object.keys(n)),s.sort&&a.sort(s.sort);const u=new WeakMap;for(let p=0;p<a.length;++p){const y=a[p];s.skipNulls&&n[y]===null||FT(o,BT(n[y],y,c,d,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,u))}const m=o.join(s.delimiter);let f=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),m.length>0?f+m:""}function OK(t){let e=0;for(const a of t)e+=a.length;const n=new Uint8Array(e);let s=0;for(const a of t)n.set(a,s),s+=a.length;return n}let Wk;function Cj(t){let e;return(Wk??(e=new globalThis.TextEncoder,Wk=e.encode.bind(e)))(t)}let Hk;function Vk(t){let e;return(Hk??(e=new globalThis.TextDecoder,Hk=e.decode.bind(e)))(t)}var ss,as;class jg{constructor(){ss.set(this,void 0),as.set(this,void 0),kt(this,ss,new Uint8Array),kt(this,as,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Cj(e):e;kt(this,ss,OK([ge(this,ss,"f"),n]));const s=[];let a;for(;(a=LK(ge(this,ss,"f"),ge(this,as,"f")))!=null;){if(a.carriage&&ge(this,as,"f")==null){kt(this,as,a.index);continue}if(ge(this,as,"f")!=null&&(a.index!==ge(this,as,"f")+1||a.carriage)){s.push(Vk(ge(this,ss,"f").subarray(0,ge(this,as,"f")-1))),kt(this,ss,ge(this,ss,"f").subarray(ge(this,as,"f"))),kt(this,as,null);continue}const i=ge(this,as,"f")!==null?a.preceding-1:a.preceding,o=Vk(ge(this,ss,"f").subarray(0,i));s.push(o),kt(this,ss,ge(this,ss,"f").subarray(a.index)),kt(this,as,null)}return s}flush(){return ge(this,ss,"f").length?this.decode(`
`):[]}}ss=new WeakMap,as=new WeakMap;jg.NEWLINE_CHARS=new Set([`
`,"\r"]);jg.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function LK(t,e){for(let a=e??0;a<t.length;a++){if(t[a]===10)return{preceding:a,index:a+1,carriage:!1};if(t[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function FK(t){for(let s=0;s<t.length-1;s++){if(t[s]===10&&t[s+1]===10||t[s]===13&&t[s+1]===13)return s+2;if(t[s]===13&&t[s+1]===10&&s+3<t.length&&t[s+2]===13&&t[s+3]===10)return s+4}return-1}const f0={off:0,error:200,warn:300,info:400,debug:500},Kk=(t,e,n)=>{if(t){if(yK(f0,t))return t;hr(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(f0))}`)}};function Du(){}function Dm(t,e,n){return!e||f0[t]>f0[n]?Du:e[t].bind(e)}const BK={error:Du,warn:Du,info:Du,debug:Du};let Zk=new WeakMap;function hr(t){const e=t.logger,n=t.logLevel??"off";if(!e)return BK;const s=Zk.get(e);if(s&&s[0]===n)return s[1];const a={error:Dm("error",e,n),warn:Dm("warn",e,n),info:Dm("info",e,n),debug:Dm("debug",e,n)};return Zk.set(e,[n,a]),a}const al=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var yu;class Fa{constructor(e,n,s){this.iterator=e,yu.set(this,void 0),this.controller=n,kt(this,yu,s)}static fromSSEResponse(e,n,s){let a=!1;const i=s?hr(s):console;async function*o(){if(a)throw new wt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let c=!1;try{for await(const d of zK(e,n))if(!c){if(d.data.startsWith("[DONE]")){c=!0;continue}if(d.event===null||!d.event.startsWith("thread.")){let u;try{u=JSON.parse(d.data)}catch(m){throw i.error("Could not parse message into JSON:",d.data),i.error("From chunk:",d.raw),m}if(u&&u.error)throw new vr(void 0,u.error,void 0,e.headers);yield u}else{let u;try{u=JSON.parse(d.data)}catch(m){throw console.error("Could not parse message into JSON:",d.data),console.error("From chunk:",d.raw),m}if(d.event=="error")throw new vr(void 0,u.error,u.message,void 0);yield{event:d.event,data:u}}}c=!0}catch(d){if(lw(d))return;throw d}finally{c||n.abort()}}return new Fa(o,n,s)}static fromReadableStream(e,n,s){let a=!1;async function*i(){const c=new jg,d=RT(e);for await(const u of d)for(const m of c.decode(u))yield m;for(const u of c.flush())yield u}async function*o(){if(a)throw new wt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let c=!1;try{for await(const d of i())c||d&&(yield JSON.parse(d));c=!0}catch(d){if(lw(d))return;throw d}finally{c||n.abort()}}return new Fa(o,n,s)}[(yu=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],n=[],s=this.iterator(),a=i=>({next:()=>{if(i.length===0){const o=s.next();e.push(o),n.push(o)}return i.shift()}});return[new Fa(()=>a(e),this.controller,ge(this,yu,"f")),new Fa(()=>a(n),this.controller,ge(this,yu,"f"))]}toReadableStream(){const e=this;let n;return TT({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:a,done:i}=await n.next();if(i)return s.close();const o=Cj(JSON.stringify(a)+`
`);s.enqueue(o)}catch(a){s.error(a)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*zK(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new wt("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new wt("Attempted to iterate over a response with no body");const n=new UK,s=new jg,a=RT(t.body);for await(const i of $K(a))for(const o of s.decode(i)){const c=n.decode(o);c&&(yield c)}for(const i of s.flush()){const o=n.decode(i);o&&(yield o)}}async function*$K(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const s=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?Cj(n):n;let a=new Uint8Array(e.length+s.length);a.set(e),a.set(s,e.length),e=a;let i;for(;(i=FK(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class UK{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,s,a]=qK(e,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}function qK(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function zT(t,e){const{response:n,requestLogID:s,retryOfRequestLogID:a,startTime:i}=e,o=await(async()=>{var f;if(e.options.stream)return hr(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Fa.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const c=n.headers.get("content-type"),d=(f=c==null?void 0:c.split(";")[0])==null?void 0:f.trim();if((d==null?void 0:d.includes("application/json"))||(d==null?void 0:d.endsWith("+json"))){const p=await n.json();return $T(p,n)}return await n.text()})();return hr(t).debug(`[${s}] response parsed`,al({retryOfRequestLogID:a,url:n.url,status:n.status,body:o,durationMs:Date.now()-i})),o}function $T(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var Tu;class Ng extends Promise{constructor(e,n,s=zT){super(a=>{a(null)}),this.responsePromise=n,this.parseResponse=s,Tu.set(this,void 0),kt(this,Tu,e)}_thenUnwrap(e){return new Ng(ge(this,Tu,"f"),this.responsePromise,async(n,s)=>$T(e(await this.parseResponse(n,s),s),s.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(ge(this,Tu,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}Tu=new WeakMap;var Tm;class Ej{constructor(e,n,s,a){Tm.set(this,void 0),kt(this,Tm,e),this.options=a,this.response=n,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new wt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await ge(this,Tm,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Tm=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class WK extends Ng{constructor(e,n,s){super(e,n,async(a,i)=>new s(a,i.response,await zT(a,i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class Sg extends Ej{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class qn extends Ej{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var s;const e=this.getPaginatedItems(),n=(s=e[e.length-1])==null?void 0:s.id;return n?{...this.options,query:{...DT(this.options.query),after:n}}:null}}class HK extends Ej{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.has_more=s.has_more||!1,this.last_id=s.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...DT(this.options.query),after:e}}:null}}const UT=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)==null?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function ah(t,e,n){return UT(),new File(t,e??"unknown_file",n)}function lp(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const qT=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",Ll=async(t,e)=>({...t,body:await KK(t.body,e)}),Gk=new WeakMap;function VK(t){const e=typeof t=="function"?t:t.fetch,n=Gk.get(e);if(n)return n;const s=(async()=>{try{const a="Response"in e?e.Response:(await e("data:,")).constructor,i=new FormData;return i.toString()!==await new a(i).text()}catch{return!0}})();return Gk.set(e,s),s}const KK=async(t,e)=>{if(!await VK(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([s,a])=>uw(n,s,a))),n},ZK=t=>t instanceof Blob&&"name"in t,uw=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,ah([await n.blob()],lp(n)));else if(qT(n))t.append(e,ah([await new Response(MT(n)).blob()],lp(n)));else if(ZK(n))t.append(e,n,lp(n));else if(Array.isArray(n))await Promise.all(n.map(s=>uw(t,e+"[]",s)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([s,a])=>uw(t,`${e}[${s}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},WT=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",GK=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&WT(t),QK=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function YK(t,e,n){if(UT(),t=await t,GK(t))return t instanceof File?t:ah([await t.arrayBuffer()],t.name);if(QK(t)){const a=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),ah(await hw(a),e,n)}const s=await hw(t);if(e||(e=lp(t)),!(n!=null&&n.type)){const a=s.find(i=>typeof i=="object"&&"type"in i&&i.type);typeof a=="string"&&(n={...n,type:a})}return ah(s,e,n)}async function hw(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(WT(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(qT(t))for await(const s of t)e.push(...await hw(s));else{const s=(n=t==null?void 0:t.constructor)==null?void 0:n.name;throw new Error(`Unexpected data type: ${typeof t}${s?`; constructor: ${s}`:""}${XK(t)}`)}return e}function XK(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class jt{constructor(e){this._client=e}}function HT(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Qk=Object.freeze(Object.create(null)),JK=(t=HT)=>function(n,...s){if(n.length===1)return n[0];let a=!1;const i=[],o=n.reduce((m,f,p)=>{var v;/[?#]/.test(f)&&(a=!0);const y=s[p];let j=(a?encodeURIComponent:t)(""+y);return p!==s.length&&(y==null||typeof y=="object"&&y.toString===((v=Object.getPrototypeOf(Object.getPrototypeOf(y.hasOwnProperty??Qk)??Qk))==null?void 0:v.toString))&&(j=y+"",i.push({start:m.length+f.length,length:j.length,error:`Value of type ${Object.prototype.toString.call(y).slice(8,-1)} is not a valid path parameter`})),m+f+(p===s.length?"":j)},""),c=o.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let u;for(;(u=d.exec(c))!==null;)i.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(i.sort((m,f)=>m.start-f.start),i.length>0){let m=0;const f=i.reduce((p,y)=>{const j=" ".repeat(y.start-m),v="^".repeat(y.length);return m=y.start+y.length,p+j+v},"");throw new wt(`Path parameters result in path with invalid segments:
${i.map(p=>p.error).join(`
`)}
${o}
${f}`)}return o},Fe=JK(HT);let VT=class extends jt{list(e,n={},s){return this._client.getAPIList(Fe`/chat/completions/${e}/messages`,qn,{query:n,...s})}};function m0(t){return t!==void 0&&"function"in t&&t.function!==void 0}function Aj(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function bf(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function eZ(t,e){return!e||!KT(e)?{...t,choices:t.choices.map(n=>(ZT(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:Pj(t,e)}function Pj(t,e){const n=t.choices.map(s=>{var a;if(s.finish_reason==="length")throw new AT;if(s.finish_reason==="content_filter")throw new PT;return ZT(s.message.tool_calls),{...s,message:{...s.message,...s.message.tool_calls?{tool_calls:((a=s.message.tool_calls)==null?void 0:a.map(i=>nZ(e,i)))??void 0}:void 0,parsed:s.message.content&&!s.message.refusal?tZ(e,s.message.content):null}}});return{...t,choices:n}}function tZ(t,e){var n,s;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((s=t.response_format)==null?void 0:s.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function nZ(t,e){var s;const n=(s=t.tools)==null?void 0:s.find(a=>{var i;return m0(a)&&((i=a.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:bf(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function rZ(t,e){var s;if(!t||!("tools"in t)||!t.tools)return!1;const n=(s=t.tools)==null?void 0:s.find(a=>{var i;return m0(a)&&((i=a.function)==null?void 0:i.name)===e.function.name});return m0(n)&&(bf(n)||(n==null?void 0:n.function.strict)||!1)}function KT(t){var e;return Aj(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>bf(n)||n.type==="function"&&n.function.strict===!0))??!1}function ZT(t){for(const e of t||[])if(e.type!=="function")throw new wt(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function sZ(t){for(const e of t??[]){if(e.type!=="function")throw new wt(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new wt(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const p0=t=>(t==null?void 0:t.role)==="assistant",GT=t=>(t==null?void 0:t.role)==="tool";var fw,cp,dp,Mu,Ru,up,Iu,di,Ou,g0,x0,bc,QT;class Dj{constructor(){fw.add(this),this.controller=new AbortController,cp.set(this,void 0),dp.set(this,()=>{}),Mu.set(this,()=>{}),Ru.set(this,void 0),up.set(this,()=>{}),Iu.set(this,()=>{}),di.set(this,{}),Ou.set(this,!1),g0.set(this,!1),x0.set(this,!1),bc.set(this,!1),kt(this,cp,new Promise((e,n)=>{kt(this,dp,e,"f"),kt(this,Mu,n,"f")})),kt(this,Ru,new Promise((e,n)=>{kt(this,up,e,"f"),kt(this,Iu,n,"f")})),ge(this,cp,"f").catch(()=>{}),ge(this,Ru,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},ge(this,fw,"m",QT).bind(this))},0)}_connected(){this.ended||(ge(this,dp,"f").call(this),this._emit("connect"))}get ended(){return ge(this,Ou,"f")}get errored(){return ge(this,g0,"f")}get aborted(){return ge(this,x0,"f")}abort(){this.controller.abort()}on(e,n){return(ge(this,di,"f")[e]||(ge(this,di,"f")[e]=[])).push({listener:n}),this}off(e,n){const s=ge(this,di,"f")[e];if(!s)return this;const a=s.findIndex(i=>i.listener===n);return a>=0&&s.splice(a,1),this}once(e,n){return(ge(this,di,"f")[e]||(ge(this,di,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,s)=>{kt(this,bc,!0),e!=="error"&&this.once("error",s),this.once(e,n)})}async done(){kt(this,bc,!0),await ge(this,Ru,"f")}_emit(e,...n){if(ge(this,Ou,"f"))return;e==="end"&&(kt(this,Ou,!0),ge(this,up,"f").call(this));const s=ge(this,di,"f")[e];if(s&&(ge(this,di,"f")[e]=s.filter(a=>!a.once),s.forEach(({listener:a})=>a(...n))),e==="abort"){const a=n[0];!ge(this,bc,"f")&&!(s!=null&&s.length)&&Promise.reject(a),ge(this,Mu,"f").call(this,a),ge(this,Iu,"f").call(this,a),this._emit("end");return}if(e==="error"){const a=n[0];!ge(this,bc,"f")&&!(s!=null&&s.length)&&Promise.reject(a),ge(this,Mu,"f").call(this,a),ge(this,Iu,"f").call(this,a),this._emit("end")}}_emitFinal(){}}cp=new WeakMap,dp=new WeakMap,Mu=new WeakMap,Ru=new WeakMap,up=new WeakMap,Iu=new WeakMap,di=new WeakMap,Ou=new WeakMap,g0=new WeakMap,x0=new WeakMap,bc=new WeakMap,fw=new WeakSet,QT=function(e){if(kt(this,g0,!0),e instanceof Error&&e.name==="AbortError"&&(e=new Is),e instanceof Is)return kt(this,x0,!0),this._emit("abort",e);if(e instanceof wt)return this._emit("error",e);if(e instanceof Error){const n=new wt(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new wt(String(e)))};function aZ(t){return typeof t.parse=="function"}var Mr,mw,v0,pw,gw,xw,YT,XT;const iZ=10;class JT extends Dj{constructor(){super(...arguments),Mr.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var s;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(s=e.choices[0])==null?void 0:s.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),GT(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(p0(e)&&e.tool_calls)for(const s of e.tool_calls)s.type==="function"&&this._emit("functionToolCall",s.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new wt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),ge(this,Mr,"m",mw).call(this)}async finalMessage(){return await this.done(),ge(this,Mr,"m",v0).call(this)}async finalFunctionToolCall(){return await this.done(),ge(this,Mr,"m",pw).call(this)}async finalFunctionToolCallResult(){return await this.done(),ge(this,Mr,"m",gw).call(this)}async totalUsage(){return await this.done(),ge(this,Mr,"m",xw).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=ge(this,Mr,"m",v0).call(this);n&&this._emit("finalMessage",n);const s=ge(this,Mr,"m",mw).call(this);s&&this._emit("finalContent",s);const a=ge(this,Mr,"m",pw).call(this);a&&this._emit("finalFunctionToolCall",a);const i=ge(this,Mr,"m",gw).call(this);i!=null&&this._emit("finalFunctionToolCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",ge(this,Mr,"m",xw).call(this))}async _createChatCompletion(e,n,s){const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ge(this,Mr,"m",YT).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Pj(i,n))}async _runChatCompletion(e,n,s){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(e,n,s)}async _runTools(e,n,s){var y,j,v;const a="tool",{tool_choice:i="auto",stream:o,...c}=n,d=typeof i!="string"&&i.type==="function"&&((y=i==null?void 0:i.function)==null?void 0:y.name),{maxChatCompletions:u=iZ}=s||{},m=n.tools.map(_=>{if(bf(_)){if(!_.$callback)throw new wt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:_.$callback,name:_.function.name,description:_.function.description||"",parameters:_.function.parameters,parse:_.$parseRaw,strict:!0}}}return _}),f={};for(const _ of m)_.type==="function"&&(f[_.function.name||_.function.function.name]=_.function);const p="tools"in n?m.map(_=>_.type==="function"?{type:"function",function:{name:_.function.name||_.function.function.name,parameters:_.function.parameters,description:_.function.description,strict:_.function.strict}}:_):void 0;for(const _ of n.messages)this._addMessage(_,!1);for(let _=0;_<u;++_){const w=(j=(await this._createChatCompletion(e,{...c,tool_choice:i,tools:p,messages:[...this.messages]},s)).choices[0])==null?void 0:j.message;if(!w)throw new wt("missing message in ChatCompletion response");if(!((v=w.tool_calls)!=null&&v.length))return;for(const N of w.tool_calls){if(N.type!=="function")continue;const S=N.id,{name:A,arguments:E}=N.function,D=f[A];if(D){if(d&&d!==A){const P=`Invalid tool_call: ${JSON.stringify(A)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:a,tool_call_id:S,content:P});continue}}else{const P=`Invalid tool_call: ${JSON.stringify(A)}. Available options are: ${Object.keys(f).map(F=>JSON.stringify(F)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:S,content:P});continue}let M;try{M=aZ(D)?await D.parse(E):E}catch(P){const F=P instanceof Error?P.message:String(P);this._addMessage({role:a,tool_call_id:S,content:F});continue}const B=await D.function(M,this),R=ge(this,Mr,"m",XT).call(this,B);if(this._addMessage({role:a,tool_call_id:S,content:R}),d)return}}}}Mr=new WeakSet,mw=function(){return ge(this,Mr,"m",v0).call(this).content??null},v0=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(p0(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new wt("stream ended without producing a ChatCompletionMessage with role=assistant")},pw=function(){var e,n;for(let s=this.messages.length-1;s>=0;s--){const a=this.messages[s];if(p0(a)&&((e=a==null?void 0:a.tool_calls)!=null&&e.length))return(n=a.tool_calls.filter(i=>i.type==="function").at(-1))==null?void 0:n.function}},gw=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(GT(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(s=>{var a;return s.role==="assistant"&&((a=s.tool_calls)==null?void 0:a.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},xw=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},YT=function(e){if(e.n!=null&&e.n>1)throw new wt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},XT=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Tj extends JT{static runTools(e,n,s){const a=new Tj,i={...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,i)),a}_addMessage(e,n=!0){super._addMessage(e,n),p0(e)&&e.content&&this._emit("content",e.content)}}const eM=1,tM=2,nM=4,rM=8,sM=16,aM=32,iM=64,oM=128,lM=256,cM=oM|lM,dM=sM|aM|cM|iM,uM=eM|tM|dM,hM=nM|rM,oZ=uM|hM,tr={STR:eM,NUM:tM,ARR:nM,OBJ:rM,NULL:sM,BOOL:aM,NAN:iM,INFINITY:oM,MINUS_INFINITY:lM,INF:cM,SPECIAL:dM,ATOM:uM,COLLECTION:hM,ALL:oZ};class lZ extends Error{}class cZ extends Error{}function dZ(t,e=tr.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return uZ(t.trim(),e)}const uZ=(t,e)=>{const n=t.length;let s=0;const a=p=>{throw new lZ(`${p} at position ${s}`)},i=p=>{throw new cZ(`${p} at position ${s}`)},o=()=>(f(),s>=n&&a("Unexpected end of input"),t[s]==='"'?c():t[s]==="{"?d():t[s]==="["?u():t.substring(s,s+4)==="null"||tr.NULL&e&&n-s<4&&"null".startsWith(t.substring(s))?(s+=4,null):t.substring(s,s+4)==="true"||tr.BOOL&e&&n-s<4&&"true".startsWith(t.substring(s))?(s+=4,!0):t.substring(s,s+5)==="false"||tr.BOOL&e&&n-s<5&&"false".startsWith(t.substring(s))?(s+=5,!1):t.substring(s,s+8)==="Infinity"||tr.INFINITY&e&&n-s<8&&"Infinity".startsWith(t.substring(s))?(s+=8,1/0):t.substring(s,s+9)==="-Infinity"||tr.MINUS_INFINITY&e&&1<n-s&&n-s<9&&"-Infinity".startsWith(t.substring(s))?(s+=9,-1/0):t.substring(s,s+3)==="NaN"||tr.NAN&e&&n-s<3&&"NaN".startsWith(t.substring(s))?(s+=3,NaN):m()),c=()=>{const p=s;let y=!1;for(s++;s<n&&(t[s]!=='"'||y&&t[s-1]==="\\");)y=t[s]==="\\"?!y:!1,s++;if(t.charAt(s)=='"')try{return JSON.parse(t.substring(p,++s-Number(y)))}catch(j){i(String(j))}else if(tr.STR&e)try{return JSON.parse(t.substring(p,s-Number(y))+'"')}catch{return JSON.parse(t.substring(p,t.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},d=()=>{s++,f();const p={};try{for(;t[s]!=="}";){if(f(),s>=n&&tr.OBJ&e)return p;const y=c();f(),s++;try{const j=o();Object.defineProperty(p,y,{value:j,writable:!0,enumerable:!0,configurable:!0})}catch(j){if(tr.OBJ&e)return p;throw j}f(),t[s]===","&&s++}}catch{if(tr.OBJ&e)return p;a("Expected '}' at end of object")}return s++,p},u=()=>{s++;const p=[];try{for(;t[s]!=="]";)p.push(o()),f(),t[s]===","&&s++}catch{if(tr.ARR&e)return p;a("Expected ']' at end of array")}return s++,p},m=()=>{if(s===0){t==="-"&&tr.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t)}catch(y){if(tr.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(y))}}const p=s;for(t[s]==="-"&&s++;t[s]&&!",]}".includes(t[s]);)s++;s==n&&!(tr.NUM&e)&&a("Unterminated number literal");try{return JSON.parse(t.substring(p,s))}catch{t.substring(p,s)==="-"&&tr.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t.substring(p,t.lastIndexOf("e")))}catch(j){i(String(j))}}},f=()=>{for(;s<n&&` 
\r	`.includes(t[s]);)s++};return o()},Yk=t=>dZ(t,tr.ALL^tr.NUM);var Kn,ai,uc,Fi,Qv,Mm,Yv,Xv,Jv,Rm,ey,Xk;class Vh extends JT{constructor(e){super(),Kn.add(this),ai.set(this,void 0),uc.set(this,void 0),Fi.set(this,void 0),kt(this,ai,e),kt(this,uc,[])}get currentChatCompletionSnapshot(){return ge(this,Fi,"f")}static fromReadableStream(e){const n=new Vh(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,s){const a=new Vh(n);return a._run(()=>a._runChatCompletion(e,{...n,stream:!0},{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(e,n,s){var o;super._createChatCompletion;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ge(this,Kn,"m",Qv).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const c of i)ge(this,Kn,"m",Yv).call(this,c);if((o=i.controller.signal)!=null&&o.aborted)throw new Is;return this._addChatCompletion(ge(this,Kn,"m",Rm).call(this))}async _fromReadableStream(e,n){var o;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),ge(this,Kn,"m",Qv).call(this),this._connected();const a=Fa.fromReadableStream(e,this.controller);let i;for await(const c of a)i&&i!==c.id&&this._addChatCompletion(ge(this,Kn,"m",Rm).call(this)),ge(this,Kn,"m",Yv).call(this,c),i=c.id;if((o=a.controller.signal)!=null&&o.aborted)throw new Is;return this._addChatCompletion(ge(this,Kn,"m",Rm).call(this))}[(ai=new WeakMap,uc=new WeakMap,Fi=new WeakMap,Kn=new WeakSet,Qv=function(){this.ended||kt(this,Fi,void 0)},Mm=function(n){let s=ge(this,uc,"f")[n.index];return s||(s={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},ge(this,uc,"f")[n.index]=s,s)},Yv=function(n){var a,i,o,c,d,u,m,f,p,y,j,v,_,b,w;if(this.ended)return;const s=ge(this,Kn,"m",Xk).call(this,n);this._emit("chunk",n,s);for(const N of n.choices){const S=s.choices[N.index];N.delta.content!=null&&((a=S.message)==null?void 0:a.role)==="assistant"&&((i=S.message)!=null&&i.content)&&(this._emit("content",N.delta.content,S.message.content),this._emit("content.delta",{delta:N.delta.content,snapshot:S.message.content,parsed:S.message.parsed})),N.delta.refusal!=null&&((o=S.message)==null?void 0:o.role)==="assistant"&&((c=S.message)!=null&&c.refusal)&&this._emit("refusal.delta",{delta:N.delta.refusal,snapshot:S.message.refusal}),((d=N.logprobs)==null?void 0:d.content)!=null&&((u=S.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(m=N.logprobs)==null?void 0:m.content,snapshot:((f=S.logprobs)==null?void 0:f.content)??[]}),((p=N.logprobs)==null?void 0:p.refusal)!=null&&((y=S.message)==null?void 0:y.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(j=N.logprobs)==null?void 0:j.refusal,snapshot:((v=S.logprobs)==null?void 0:v.refusal)??[]});const A=ge(this,Kn,"m",Mm).call(this,S);S.finish_reason&&(ge(this,Kn,"m",Jv).call(this,S),A.current_tool_call_index!=null&&ge(this,Kn,"m",Xv).call(this,S,A.current_tool_call_index));for(const E of N.delta.tool_calls??[])A.current_tool_call_index!==E.index&&(ge(this,Kn,"m",Jv).call(this,S),A.current_tool_call_index!=null&&ge(this,Kn,"m",Xv).call(this,S,A.current_tool_call_index)),A.current_tool_call_index=E.index;for(const E of N.delta.tool_calls??[]){const D=(_=S.message.tool_calls)==null?void 0:_[E.index];D!=null&&D.type&&((D==null?void 0:D.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(b=D.function)==null?void 0:b.name,index:E.index,arguments:D.function.arguments,parsed_arguments:D.function.parsed_arguments,arguments_delta:((w=E.function)==null?void 0:w.arguments)??""}):(D==null||D.type,void 0))}}},Xv=function(n,s){var o,c,d;if(ge(this,Kn,"m",Mm).call(this,n).done_tool_calls.has(s))return;const i=(o=n.message.tool_calls)==null?void 0:o[s];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const u=(d=(c=ge(this,ai,"f"))==null?void 0:c.tools)==null?void 0:d.find(m=>m0(m)&&m.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:s,arguments:i.function.arguments,parsed_arguments:bf(u)?u.$parseRaw(i.function.arguments):u!=null&&u.function.strict?JSON.parse(i.function.arguments):null})}else i.type},Jv=function(n){var a,i;const s=ge(this,Kn,"m",Mm).call(this,n);if(n.message.content&&!s.content_done){s.content_done=!0;const o=ge(this,Kn,"m",ey).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!s.refusal_done&&(s.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(a=n.logprobs)!=null&&a.content&&!s.logprobs_content_done&&(s.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!s.logprobs_refusal_done&&(s.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},Rm=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");const n=ge(this,Fi,"f");if(!n)throw new wt("request ended without sending any chunks");return kt(this,Fi,void 0),kt(this,uc,[]),hZ(n,ge(this,ai,"f"))},ey=function(){var s;const n=(s=ge(this,ai,"f"))==null?void 0:s.response_format;return Aj(n)?n:null},Xk=function(n){var s,a,i,o;let c=ge(this,Fi,"f");const{choices:d,...u}=n;c?Object.assign(c,u):c=kt(this,Fi,{...u,choices:[]});for(const{delta:m,finish_reason:f,index:p,logprobs:y=null,...j}of n.choices){let v=c.choices[p];if(v||(v=c.choices[p]={finish_reason:f,index:p,message:{},logprobs:y,...j}),y)if(!v.logprobs)v.logprobs=Object.assign({},y);else{const{content:E,refusal:D,...M}=y;Object.assign(v.logprobs,M),E&&((s=v.logprobs).content??(s.content=[]),v.logprobs.content.push(...E)),D&&((a=v.logprobs).refusal??(a.refusal=[]),v.logprobs.refusal.push(...D))}if(f&&(v.finish_reason=f,ge(this,ai,"f")&&KT(ge(this,ai,"f")))){if(f==="length")throw new AT;if(f==="content_filter")throw new PT}if(Object.assign(v,j),!m)continue;const{content:_,refusal:b,function_call:w,role:N,tool_calls:S,...A}=m;if(Object.assign(v.message,A),b&&(v.message.refusal=(v.message.refusal||"")+b),N&&(v.message.role=N),w&&(v.message.function_call?(w.name&&(v.message.function_call.name=w.name),w.arguments&&((i=v.message.function_call).arguments??(i.arguments=""),v.message.function_call.arguments+=w.arguments)):v.message.function_call=w),_&&(v.message.content=(v.message.content||"")+_,!v.message.refusal&&ge(this,Kn,"m",ey).call(this)&&(v.message.parsed=Yk(v.message.content))),S){v.message.tool_calls||(v.message.tool_calls=[]);for(const{index:E,id:D,type:M,function:B,...R}of S){const P=(o=v.message.tool_calls)[E]??(o[E]={});Object.assign(P,R),D&&(P.id=D),M&&(P.type=M),B&&(P.function??(P.function={name:B.name??"",arguments:""})),B!=null&&B.name&&(P.function.name=B.name),B!=null&&B.arguments&&(P.function.arguments+=B.arguments,rZ(ge(this,ai,"f"),P)&&(P.function.parsed_arguments=Yk(P.function.arguments)))}}}return c},Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("chunk",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Fa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function hZ(t,e){const{id:n,choices:s,created:a,model:i,system_fingerprint:o,...c}=t,d={...c,id:n,choices:s.map(({message:u,finish_reason:m,index:f,logprobs:p,...y})=>{if(!m)throw new wt(`missing finish_reason for choice ${f}`);const{content:j=null,function_call:v,tool_calls:_,...b}=u,w=u.role;if(!w)throw new wt(`missing role for choice ${f}`);if(v){const{arguments:N,name:S}=v;if(N==null)throw new wt(`missing function_call.arguments for choice ${f}`);if(!S)throw new wt(`missing function_call.name for choice ${f}`);return{...y,message:{content:j,function_call:{arguments:N,name:S},role:w,refusal:u.refusal??null},finish_reason:m,index:f,logprobs:p}}return _?{...y,index:f,finish_reason:m,logprobs:p,message:{...b,role:w,content:j,refusal:u.refusal??null,tool_calls:_.map((N,S)=>{const{function:A,type:E,id:D,...M}=N,{arguments:B,name:R,...P}=A||{};if(D==null)throw new wt(`missing choices[${f}].tool_calls[${S}].id
${Im(t)}`);if(E==null)throw new wt(`missing choices[${f}].tool_calls[${S}].type
${Im(t)}`);if(R==null)throw new wt(`missing choices[${f}].tool_calls[${S}].function.name
${Im(t)}`);if(B==null)throw new wt(`missing choices[${f}].tool_calls[${S}].function.arguments
${Im(t)}`);return{...M,id:D,type:E,function:{...P,name:R,arguments:B}}})}}:{...y,message:{...b,content:j,role:w,refusal:u.refusal??null},finish_reason:m,index:f,logprobs:p}}),created:a,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return eZ(d,e)}function Im(t){return JSON.stringify(t)}class y0 extends Vh{static fromReadableStream(e){const n=new y0(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,s){const a=new y0(n),i={...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,i)),a}}let Mj=class extends jt{constructor(){super(...arguments),this.messages=new VT(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(Fe`/chat/completions/${e}`,n)}update(e,n,s){return this._client.post(Fe`/chat/completions/${e}`,{body:n,...s})}list(e={},n){return this._client.getAPIList("/chat/completions",qn,{query:e,...n})}delete(e,n){return this._client.delete(Fe`/chat/completions/${e}`,n)}parse(e,n){return sZ(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(s=>Pj(s,e))}runTools(e,n){return e.stream?y0.runTools(this._client,e,n):Tj.runTools(this._client,e,n)}stream(e,n){return Vh.createChatCompletion(this._client,e,n)}};Mj.Messages=VT;class Rj extends jt{constructor(){super(...arguments),this.completions=new Mj(this._client)}}Rj.Completions=Mj;const fM=Symbol("brand.privateNullableHeaders");function*fZ(t){if(!t)return;if(fM in t){const{values:s,nulls:a}=t;yield*s.entries();for(const i of a)yield[i,null];return}let e=!1,n;t instanceof Headers?n=t.entries():Lk(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let s of n){const a=s[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const i=Lk(s[1])?s[1]:[s[1]];let o=!1;for(const c of i)c!==void 0&&(e&&!o&&(o=!0,yield[a,null]),yield[a,c])}}const ct=t=>{const e=new Headers,n=new Set;for(const s of t){const a=new Set;for(const[i,o]of fZ(s)){const c=i.toLowerCase();a.has(c)||(e.delete(i),a.add(c)),o===null?(e.delete(i),n.add(c)):(e.append(i,o),n.delete(c))}}return{[fM]:!0,values:e,nulls:n}};class mM extends jt{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:ct([{Accept:"application/octet-stream"},n==null?void 0:n.headers]),__binaryResponse:!0})}}class pM extends jt{create(e,n){return this._client.post("/audio/transcriptions",Ll({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class gM extends jt{create(e,n){return this._client.post("/audio/translations",Ll({body:e,...n,__metadata:{model:e.model}},this._client))}}class jf extends jt{constructor(){super(...arguments),this.transcriptions=new pM(this._client),this.translations=new gM(this._client),this.speech=new mM(this._client)}}jf.Transcriptions=pM;jf.Translations=gM;jf.Speech=mM;class xM extends jt{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(Fe`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",qn,{query:e,...n})}cancel(e,n){return this._client.post(Fe`/batches/${e}/cancel`,n)}}class vM extends jt{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(Fe`/assistants/${e}`,{...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,s){return this._client.post(Fe`/assistants/${e}`,{body:n,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e={},n){return this._client.getAPIList("/assistants",qn,{query:e,...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(Fe`/assistants/${e}`,{...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class yM extends jt{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class _M extends jt{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class kg extends jt{constructor(){super(...arguments),this.sessions=new yM(this._client),this.transcriptionSessions=new _M(this._client)}}kg.Sessions=yM;kg.TranscriptionSessions=_M;class wM extends jt{create(e,n,s){return this._client.post(Fe`/threads/${e}/messages`,{body:n,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(e,n,s){const{thread_id:a}=n;return this._client.get(Fe`/threads/${a}/messages/${e}`,{...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(e,n,s){const{thread_id:a,...i}=n;return this._client.post(Fe`/threads/${a}/messages/${e}`,{body:i,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e,n={},s){return this._client.getAPIList(Fe`/threads/${e}/messages`,qn,{query:n,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(e,n,s){const{thread_id:a}=n;return this._client.delete(Fe`/threads/${a}/messages/${e}`,{...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class bM extends jt{retrieve(e,n,s){const{thread_id:a,run_id:i,...o}=n;return this._client.get(Fe`/threads/${a}/runs/${i}/steps/${e}`,{query:o,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e,n,s){const{thread_id:a,...i}=n;return this._client.getAPIList(Fe`/threads/${a}/runs/${e}/steps`,qn,{query:i,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}const mZ=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,s=new Uint8Array(n);for(let a=0;a<n;a++)s[a]=e.charCodeAt(a);return Array.from(new Float32Array(s.buffer))}};var ty={};const hc=t=>{var e,n,s,a;if(typeof globalThis.process<"u")return((e=ty==null?void 0:ty[t])==null?void 0:e.trim())??void 0;if(typeof globalThis.Deno<"u")return(a=(s=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:s.call(n,t))==null?void 0:a.trim()};var fr,hl,vw,Ea,hp,Qs,fl,Fc,ll,_0,is,fp,mp,ih,Lu,Fu,Jk,eC,tC,nC,rC,sC,aC;class oh extends Dj{constructor(){super(...arguments),fr.add(this),vw.set(this,[]),Ea.set(this,{}),hp.set(this,{}),Qs.set(this,void 0),fl.set(this,void 0),Fc.set(this,void 0),ll.set(this,void 0),_0.set(this,void 0),is.set(this,void 0),fp.set(this,void 0),mp.set(this,void 0),ih.set(this,void 0)}[(vw=new WeakMap,Ea=new WeakMap,hp=new WeakMap,Qs=new WeakMap,fl=new WeakMap,Fc=new WeakMap,ll=new WeakMap,_0=new WeakMap,is=new WeakMap,fp=new WeakMap,mp=new WeakMap,ih=new WeakMap,fr=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("event",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new hl;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Fa.fromReadableStream(e,this.controller);for await(const o of a)ge(this,fr,"m",Lu).call(this,o);if((i=a.controller.signal)!=null&&i.aborted)throw new Is;return this._addRun(ge(this,fr,"m",Fu).call(this))}toReadableStream(){return new Fa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,s,a){const i=new hl;return i._run(()=>i._runToolAssistantStream(e,n,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,n,s,a){var d;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},c=await e.submitToolOutputs(n,o,{...a,signal:this.controller.signal});this._connected();for await(const u of c)ge(this,fr,"m",Lu).call(this,u);if((d=c.controller.signal)!=null&&d.aborted)throw new Is;return this._addRun(ge(this,fr,"m",Fu).call(this))}static createThreadAssistantStream(e,n,s){const a=new hl;return a._run(()=>a._threadAssistantStream(e,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(e,n,s,a){const i=new hl;return i._run(()=>i._runAssistantStream(e,n,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return ge(this,fp,"f")}currentRun(){return ge(this,mp,"f")}currentMessageSnapshot(){return ge(this,Qs,"f")}currentRunStepSnapshot(){return ge(this,ih,"f")}async finalRunSteps(){return await this.done(),Object.values(ge(this,Ea,"f"))}async finalMessages(){return await this.done(),Object.values(ge(this,hp,"f"))}async finalRun(){if(await this.done(),!ge(this,fl,"f"))throw Error("Final run was not received.");return ge(this,fl,"f")}async _createThreadAssistantStream(e,n,s){var c;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...s,signal:this.controller.signal});this._connected();for await(const d of o)ge(this,fr,"m",Lu).call(this,d);if((c=o.controller.signal)!=null&&c.aborted)throw new Is;return this._addRun(ge(this,fr,"m",Fu).call(this))}async _createAssistantStream(e,n,s,a){var d;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},c=await e.create(n,o,{...a,signal:this.controller.signal});this._connected();for await(const u of c)ge(this,fr,"m",Lu).call(this,u);if((d=c.controller.signal)!=null&&d.aborted)throw new Is;return this._addRun(ge(this,fr,"m",Fu).call(this))}static accumulateDelta(e,n){for(const[s,a]of Object.entries(n)){if(!e.hasOwnProperty(s)){e[s]=a;continue}let i=e[s];if(i==null){e[s]=a;continue}if(s==="index"||s==="type"){e[s]=a;continue}if(typeof i=="string"&&typeof a=="string")i+=a;else if(typeof i=="number"&&typeof a=="number")i+=a;else if(Kv(i)&&Kv(a))i=this.accumulateDelta(i,a);else if(Array.isArray(i)&&Array.isArray(a)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...a);continue}for(const o of a){if(!Kv(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const c=o.index;if(c==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof c!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${c}`);const d=i[c];d==null?i.push(o):i[c]=this.accumulateDelta(d,o)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${a}, accValue: ${i}`);e[s]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,s){return await this._createThreadAssistantStream(n,e,s)}async _runAssistantStream(e,n,s,a){return await this._createAssistantStream(n,e,s,a)}async _runToolAssistantStream(e,n,s,a){return await this._createToolAssistantStream(n,e,s,a)}}hl=oh,Lu=function(e){if(!this.ended)switch(kt(this,fp,e),ge(this,fr,"m",tC).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":ge(this,fr,"m",aC).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ge(this,fr,"m",eC).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":ge(this,fr,"m",Jk).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Fu=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");if(!ge(this,fl,"f"))throw Error("Final run has not been received");return ge(this,fl,"f")},Jk=function(e){const[n,s]=ge(this,fr,"m",rC).call(this,e,ge(this,Qs,"f"));kt(this,Qs,n),ge(this,hp,"f")[n.id]=n;for(const a of s){const i=n.content[a.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const a of e.data.delta.content){if(a.type=="text"&&a.text){let i=a.text,o=n.content[a.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=ge(this,Fc,"f")){if(ge(this,ll,"f"))switch(ge(this,ll,"f").type){case"text":this._emit("textDone",ge(this,ll,"f").text,ge(this,Qs,"f"));break;case"image_file":this._emit("imageFileDone",ge(this,ll,"f").image_file,ge(this,Qs,"f"));break}kt(this,Fc,a.index)}kt(this,ll,n.content[a.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(ge(this,Fc,"f")!==void 0){const a=e.data.content[ge(this,Fc,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,ge(this,Qs,"f"));break;case"text":this._emit("textDone",a.text,ge(this,Qs,"f"));break}}ge(this,Qs,"f")&&this._emit("messageDone",e.data),kt(this,Qs,void 0)}},eC=function(e){const n=ge(this,fr,"m",nC).call(this,e);switch(kt(this,ih,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const s=e.data.delta;if(s.step_details&&s.step_details.type=="tool_calls"&&s.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of s.step_details.tool_calls)i.index==ge(this,_0,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(ge(this,is,"f")&&this._emit("toolCallDone",ge(this,is,"f")),kt(this,_0,i.index),kt(this,is,n.step_details.tool_calls[i.index]),ge(this,is,"f")&&this._emit("toolCallCreated",ge(this,is,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":kt(this,ih,void 0),e.data.step_details.type=="tool_calls"&&ge(this,is,"f")&&(this._emit("toolCallDone",ge(this,is,"f")),kt(this,is,void 0)),this._emit("runStepDone",e.data,n);break}},tC=function(e){ge(this,vw,"f").push(e),this._emit("event",e)},nC=function(e){switch(e.event){case"thread.run.step.created":return ge(this,Ea,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=ge(this,Ea,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){const a=hl.accumulateDelta(n,s.delta);ge(this,Ea,"f")[e.data.id]=a}return ge(this,Ea,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":ge(this,Ea,"f")[e.data.id]=e.data;break}if(ge(this,Ea,"f")[e.data.id])return ge(this,Ea,"f")[e.data.id];throw new Error("No snapshot available")},rC=function(e,n){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=e.data;if(a.delta.content)for(const i of a.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=ge(this,fr,"m",sC).call(this,i,o)}else n.content[i.index]=i,s.push(i);return[n,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},sC=function(e,n){return hl.accumulateDelta(n,e)},aC=function(e){switch(kt(this,mp,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":kt(this,fl,e.data),ge(this,is,"f")&&(this._emit("toolCallDone",ge(this,is,"f")),kt(this,is,void 0));break}};let Ij=class extends jt{constructor(){super(...arguments),this.steps=new bM(this._client)}create(e,n,s){const{include:a,...i}=n;return this._client.post(Fe`/threads/${e}/runs`,{query:{include:a},body:i,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers]),stream:n.stream??!1})}retrieve(e,n,s){const{thread_id:a}=n;return this._client.get(Fe`/threads/${a}/runs/${e}`,{...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(e,n,s){const{thread_id:a,...i}=n;return this._client.post(Fe`/threads/${a}/runs/${e}`,{body:i,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e,n={},s){return this._client.getAPIList(Fe`/threads/${e}/runs`,qn,{query:n,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}cancel(e,n,s){const{thread_id:a}=n;return this._client.post(Fe`/threads/${a}/runs/${e}/cancel`,{...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n,s);return await this.poll(a.id,{thread_id:e},s)}createAndStream(e,n,s){return oh.createAssistantStream(e,this._client.beta.threads.runs,n,s)}async poll(e,n,s){var i;const a=ct([s==null?void 0:s.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=s==null?void 0:s.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:c}=await this.retrieve(e,n,{...s,headers:{...s==null?void 0:s.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let d=5e3;if(s!=null&&s.pollIntervalMs)d=s.pollIntervalMs;else{const u=c.headers.get("openai-poll-after-ms");if(u){const m=parseInt(u);isNaN(m)||(d=m)}}await wf(d);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(e,n,s){return oh.createAssistantStream(e,this._client.beta.threads.runs,n,s)}submitToolOutputs(e,n,s){const{thread_id:a,...i}=n;return this._client.post(Fe`/threads/${a}/runs/${e}/submit_tool_outputs`,{body:i,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,s){const a=await this.submitToolOutputs(e,n,s);return await this.poll(a.id,n,s)}submitToolOutputsStream(e,n,s){return oh.createToolAssistantStream(e,this._client.beta.threads.runs,n,s)}};Ij.Steps=bM;class Cg extends jt{constructor(){super(...arguments),this.runs=new Ij(this._client),this.messages=new wM(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(Fe`/threads/${e}`,{...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,s){return this._client.post(Fe`/threads/${e}`,{body:n,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(e,n){return this._client.delete(Fe`/threads/${e}`,{...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const s=await this.createAndRun(e,n);return await this.runs.poll(s.id,{thread_id:s.thread_id},n)}createAndRunStream(e,n){return oh.createThreadAssistantStream(e,this._client.beta.threads,n)}}Cg.Runs=Ij;Cg.Messages=wM;class Nf extends jt{constructor(){super(...arguments),this.realtime=new kg(this._client),this.assistants=new vM(this._client),this.threads=new Cg(this._client)}}Nf.Realtime=kg;Nf.Assistants=vM;Nf.Threads=Cg;class jM extends jt{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let NM=class extends jt{retrieve(e,n,s){const{container_id:a}=n;return this._client.get(Fe`/containers/${a}/files/${e}/content`,{...s,headers:ct([{Accept:"application/binary"},s==null?void 0:s.headers]),__binaryResponse:!0})}},Oj=class extends jt{constructor(){super(...arguments),this.content=new NM(this._client)}create(e,n,s){return this._client.post(Fe`/containers/${e}/files`,Ll({body:n,...s},this._client))}retrieve(e,n,s){const{container_id:a}=n;return this._client.get(Fe`/containers/${a}/files/${e}`,s)}list(e,n={},s){return this._client.getAPIList(Fe`/containers/${e}/files`,qn,{query:n,...s})}delete(e,n,s){const{container_id:a}=n;return this._client.delete(Fe`/containers/${a}/files/${e}`,{...s,headers:ct([{Accept:"*/*"},s==null?void 0:s.headers])})}};Oj.Content=NM;class Lj extends jt{constructor(){super(...arguments),this.files=new Oj(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(Fe`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",qn,{query:e,...n})}delete(e,n){return this._client.delete(Fe`/containers/${e}`,{...n,headers:ct([{Accept:"*/*"},n==null?void 0:n.headers])})}}Lj.Files=Oj;class SM extends jt{create(e,n,s){const{include:a,...i}=n;return this._client.post(Fe`/conversations/${e}/items`,{query:{include:a},body:i,...s})}retrieve(e,n,s){const{conversation_id:a,...i}=n;return this._client.get(Fe`/conversations/${a}/items/${e}`,{query:i,...s})}list(e,n={},s){return this._client.getAPIList(Fe`/conversations/${e}/items`,HK,{query:n,...s})}delete(e,n,s){const{conversation_id:a}=n;return this._client.delete(Fe`/conversations/${a}/items/${e}`,s)}}class Fj extends jt{constructor(){super(...arguments),this.items=new SM(this._client)}create(e,n){return this._client.post("/conversations",{body:e,...n})}retrieve(e,n){return this._client.get(Fe`/conversations/${e}`,n)}update(e,n,s){return this._client.post(Fe`/conversations/${e}`,{body:n,...s})}delete(e,n){return this._client.delete(Fe`/conversations/${e}`,n)}}Fj.Items=SM;class kM extends jt{create(e,n){const s=!!e.encoding_format;let a=s?e.encoding_format:"base64";s&&hr(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:a},...n});return s?i:(hr(this._client).debug("embeddings/decoding base64 embeddings from base64"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(c=>{const d=c.embedding;c.embedding=mZ(d)}),o)))}}class CM extends jt{retrieve(e,n,s){const{eval_id:a,run_id:i}=n;return this._client.get(Fe`/evals/${a}/runs/${i}/output_items/${e}`,s)}list(e,n,s){const{eval_id:a,...i}=n;return this._client.getAPIList(Fe`/evals/${a}/runs/${e}/output_items`,qn,{query:i,...s})}}class Bj extends jt{constructor(){super(...arguments),this.outputItems=new CM(this._client)}create(e,n,s){return this._client.post(Fe`/evals/${e}/runs`,{body:n,...s})}retrieve(e,n,s){const{eval_id:a}=n;return this._client.get(Fe`/evals/${a}/runs/${e}`,s)}list(e,n={},s){return this._client.getAPIList(Fe`/evals/${e}/runs`,qn,{query:n,...s})}delete(e,n,s){const{eval_id:a}=n;return this._client.delete(Fe`/evals/${a}/runs/${e}`,s)}cancel(e,n,s){const{eval_id:a}=n;return this._client.post(Fe`/evals/${a}/runs/${e}`,s)}}Bj.OutputItems=CM;class zj extends jt{constructor(){super(...arguments),this.runs=new Bj(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(Fe`/evals/${e}`,n)}update(e,n,s){return this._client.post(Fe`/evals/${e}`,{body:n,...s})}list(e={},n){return this._client.getAPIList("/evals",qn,{query:e,...n})}delete(e,n){return this._client.delete(Fe`/evals/${e}`,n)}}zj.Runs=Bj;let EM=class extends jt{create(e,n){return this._client.post("/files",Ll({body:e,...n},this._client))}retrieve(e,n){return this._client.get(Fe`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",qn,{query:e,...n})}delete(e,n){return this._client.delete(Fe`/files/${e}`,n)}content(e,n){return this._client.get(Fe`/files/${e}/content`,{...n,headers:ct([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:s=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!a.has(o.status);)if(await wf(n),o=await this.retrieve(e),Date.now()-i>s)throw new kj({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return o}};class AM extends jt{}let PM=class extends jt{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class $j extends jt{constructor(){super(...arguments),this.graders=new PM(this._client)}}$j.Graders=PM;class DM extends jt{create(e,n,s){return this._client.getAPIList(Fe`/fine_tuning/checkpoints/${e}/permissions`,Sg,{body:n,method:"post",...s})}retrieve(e,n={},s){return this._client.get(Fe`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...s})}delete(e,n,s){const{fine_tuned_model_checkpoint:a}=n;return this._client.delete(Fe`/fine_tuning/checkpoints/${a}/permissions/${e}`,s)}}let Uj=class extends jt{constructor(){super(...arguments),this.permissions=new DM(this._client)}};Uj.Permissions=DM;class TM extends jt{list(e,n={},s){return this._client.getAPIList(Fe`/fine_tuning/jobs/${e}/checkpoints`,qn,{query:n,...s})}}class qj extends jt{constructor(){super(...arguments),this.checkpoints=new TM(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(Fe`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",qn,{query:e,...n})}cancel(e,n){return this._client.post(Fe`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},s){return this._client.getAPIList(Fe`/fine_tuning/jobs/${e}/events`,qn,{query:n,...s})}pause(e,n){return this._client.post(Fe`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(Fe`/fine_tuning/jobs/${e}/resume`,n)}}qj.Checkpoints=TM;class Vd extends jt{constructor(){super(...arguments),this.methods=new AM(this._client),this.jobs=new qj(this._client),this.checkpoints=new Uj(this._client),this.alpha=new $j(this._client)}}Vd.Methods=AM;Vd.Jobs=qj;Vd.Checkpoints=Uj;Vd.Alpha=$j;class MM extends jt{}class Wj extends jt{constructor(){super(...arguments),this.graderModels=new MM(this._client)}}Wj.GraderModels=MM;class RM extends jt{createVariation(e,n){return this._client.post("/images/variations",Ll({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",Ll({body:e,...n,stream:e.stream??!1},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n,stream:e.stream??!1})}}class IM extends jt{retrieve(e,n){return this._client.get(Fe`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",Sg,e)}delete(e,n){return this._client.delete(Fe`/models/${e}`,n)}}class OM extends jt{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function pZ(t,e){return!e||!xZ(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(s=>({...s,parsed:null}))}:n)}:LM(t,e)}function LM(t,e){const n=t.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:_Z(e,a)};if(a.type==="message"){const i=a.content.map(o=>o.type==="output_text"?{...o,parsed:gZ(e,o.text)}:o);return{...a,content:i}}return a}),s=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||yw(s),Object.defineProperty(s,"output_parsed",{enumerable:!0,get(){for(const a of s.output)if(a.type==="message"){for(const i of a.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),s}function gZ(t,e){var n,s,a,i;return((s=(n=t.text)==null?void 0:n.format)==null?void 0:s.type)!=="json_schema"?null:"$parseRaw"in((a=t.text)==null?void 0:a.format)?((i=t.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function xZ(t){var e;return!!Aj((e=t.text)==null?void 0:e.format)}function vZ(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function yZ(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function _Z(t,e){const n=yZ(t.tools??[],e.name);return{...e,...e,parsed_arguments:vZ(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function yw(t){const e=[];for(const n of t.output)if(n.type==="message")for(const s of n.content)s.type==="output_text"&&e.push(s.text);t.output_text=e.join("")}var fc,Om,Bi,Lm,iC,oC,lC,cC;class Hj extends Dj{constructor(e){super(),fc.add(this),Om.set(this,void 0),Bi.set(this,void 0),Lm.set(this,void 0),kt(this,Om,e)}static createResponse(e,n,s){const a=new Hj(n);return a._run(()=>a._createOrRetrieveResponse(e,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createOrRetrieveResponse(e,n,s){var c;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ge(this,fc,"m",iC).call(this);let i,o=null;"response_id"in n?(i=await e.responses.retrieve(n.response_id,{stream:!0},{...s,signal:this.controller.signal,stream:!0}),o=n.starting_after??null):i=await e.responses.create({...n,stream:!0},{...s,signal:this.controller.signal}),this._connected();for await(const d of i)ge(this,fc,"m",oC).call(this,d,o);if((c=i.controller.signal)!=null&&c.aborted)throw new Is;return ge(this,fc,"m",lC).call(this)}[(Om=new WeakMap,Bi=new WeakMap,Lm=new WeakMap,fc=new WeakSet,iC=function(){this.ended||kt(this,Bi,void 0)},oC=function(n,s){if(this.ended)return;const a=(o,c)=>{(s==null||c.sequence_number>s)&&this._emit(o,c)},i=ge(this,fc,"m",cC).call(this,n);switch(a("event",n),n.type){case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new wt(`missing output at index ${n.output_index}`);if(o.type==="message"){const c=o.content[n.content_index];if(!c)throw new wt(`missing content at index ${n.content_index}`);if(c.type!=="output_text")throw new wt(`expected content to be 'output_text', got ${c.type}`);a("response.output_text.delta",{...n,snapshot:c.text})}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new wt(`missing output at index ${n.output_index}`);o.type==="function_call"&&a("response.function_call_arguments.delta",{...n,snapshot:o.arguments});break}default:a(n.type,n);break}},lC=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");const n=ge(this,Bi,"f");if(!n)throw new wt("request ended without sending any events");kt(this,Bi,void 0);const s=wZ(n,ge(this,Om,"f"));return kt(this,Lm,s),s},cC=function(n){let s=ge(this,Bi,"f");if(!s){if(n.type!=="response.created")throw new wt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return s=kt(this,Bi,n.response),s}switch(n.type){case"response.output_item.added":{s.output.push(n.item);break}case"response.content_part.added":{const a=s.output[n.output_index];if(!a)throw new wt(`missing output at index ${n.output_index}`);a.type==="message"&&a.content.push(n.part);break}case"response.output_text.delta":{const a=s.output[n.output_index];if(!a)throw new wt(`missing output at index ${n.output_index}`);if(a.type==="message"){const i=a.content[n.content_index];if(!i)throw new wt(`missing content at index ${n.content_index}`);if(i.type!=="output_text")throw new wt(`expected content to be 'output_text', got ${i.type}`);i.text+=n.delta}break}case"response.function_call_arguments.delta":{const a=s.output[n.output_index];if(!a)throw new wt(`missing output at index ${n.output_index}`);a.type==="function_call"&&(a.arguments+=n.delta);break}case"response.completed":{kt(this,Bi,n.response);break}}return s},Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("event",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=ge(this,Lm,"f");if(!e)throw new wt("stream ended without producing a ChatCompletion");return e}}function wZ(t,e){return pZ(t,e)}class FM extends jt{list(e,n={},s){return this._client.getAPIList(Fe`/responses/${e}/input_items`,qn,{query:n,...s})}}class Vj extends jt{constructor(){super(...arguments),this.inputItems=new FM(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&yw(s),s))}retrieve(e,n={},s){return this._client.get(Fe`/responses/${e}`,{query:n,...s,stream:(n==null?void 0:n.stream)??!1})._thenUnwrap(a=>("object"in a&&a.object==="response"&&yw(a),a))}delete(e,n){return this._client.delete(Fe`/responses/${e}`,{...n,headers:ct([{Accept:"*/*"},n==null?void 0:n.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(s=>LM(s,e))}stream(e,n){return Hj.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(Fe`/responses/${e}/cancel`,n)}}Vj.InputItems=FM;class BM extends jt{create(e,n,s){return this._client.post(Fe`/uploads/${e}/parts`,Ll({body:n,...s},this._client))}}class Kj extends jt{constructor(){super(...arguments),this.parts=new BM(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(Fe`/uploads/${e}/cancel`,n)}complete(e,n,s){return this._client.post(Fe`/uploads/${e}/complete`,{body:n,...s})}}Kj.Parts=BM;const bZ=async t=>{const e=await Promise.allSettled(t),n=e.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const s=[];for(const a of e)a.status==="fulfilled"&&s.push(a.value);return s};class zM extends jt{create(e,n,s){return this._client.post(Fe`/vector_stores/${e}/file_batches`,{body:n,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(e,n,s){const{vector_store_id:a}=n;return this._client.get(Fe`/vector_stores/${a}/file_batches/${e}`,{...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}cancel(e,n,s){const{vector_store_id:a}=n;return this._client.post(Fe`/vector_stores/${a}/file_batches/${e}/cancel`,{...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n);return await this.poll(e,a.id,s)}listFiles(e,n,s){const{vector_store_id:a,...i}=n;return this._client.getAPIList(Fe`/vector_stores/${a}/file_batches/${e}/files`,qn,{query:i,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async poll(e,n,s){var i;const a=ct([s==null?void 0:s.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=s==null?void 0:s.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:c}=await this.retrieve(n,{vector_store_id:e},{...s,headers:a}).withResponse();switch(o.status){case"in_progress":let d=5e3;if(s!=null&&s.pollIntervalMs)d=s.pollIntervalMs;else{const u=c.headers.get("openai-poll-after-ms");if(u){const m=parseInt(u);isNaN(m)||(d=m)}}await wf(d);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(e,{files:n,fileIds:s=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(a==null?void 0:a.maxConcurrency)??5,o=Math.min(i,n.length),c=this._client,d=n.values(),u=[...s];async function m(p){for(let y of p){const j=await c.files.create({file:y,purpose:"assistants"},a);u.push(j.id)}}const f=Array(o).fill(d).map(m);return await bZ(f),await this.createAndPoll(e,{file_ids:u})}}class $M extends jt{create(e,n,s){return this._client.post(Fe`/vector_stores/${e}/files`,{body:n,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(e,n,s){const{vector_store_id:a}=n;return this._client.get(Fe`/vector_stores/${a}/files/${e}`,{...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(e,n,s){const{vector_store_id:a,...i}=n;return this._client.post(Fe`/vector_stores/${a}/files/${e}`,{body:i,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e,n={},s){return this._client.getAPIList(Fe`/vector_stores/${e}/files`,qn,{query:n,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(e,n,s){const{vector_store_id:a}=n;return this._client.delete(Fe`/vector_stores/${a}/files/${e}`,{...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n,s);return await this.poll(e,a.id,s)}async poll(e,n,s){var i;const a=ct([s==null?void 0:s.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=s==null?void 0:s.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const o=await this.retrieve(n,{vector_store_id:e},{...s,headers:a}).withResponse(),c=o.data;switch(c.status){case"in_progress":let d=5e3;if(s!=null&&s.pollIntervalMs)d=s.pollIntervalMs;else{const u=o.response.headers.get("openai-poll-after-ms");if(u){const m=parseInt(u);isNaN(m)||(d=m)}}await wf(d);break;case"failed":case"completed":return c}}}async upload(e,n,s){const a=await this._client.files.create({file:n,purpose:"assistants"},s);return this.create(e,{file_id:a.id},s)}async uploadAndPoll(e,n,s){const a=await this.upload(e,n,s);return await this.poll(e,a.id,s)}content(e,n,s){const{vector_store_id:a}=n;return this._client.getAPIList(Fe`/vector_stores/${a}/files/${e}/content`,Sg,{...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class Eg extends jt{constructor(){super(...arguments),this.files=new $M(this._client),this.fileBatches=new zM(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(Fe`/vector_stores/${e}`,{...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,s){return this._client.post(Fe`/vector_stores/${e}`,{body:n,...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",qn,{query:e,...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(Fe`/vector_stores/${e}`,{...n,headers:ct([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}search(e,n,s){return this._client.getAPIList(Fe`/vector_stores/${e}/search`,Sg,{body:n,method:"post",...s,headers:ct([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}Eg.Files=$M;Eg.FileBatches=zM;var jc,UM,pp;class qM extends jt{constructor(){super(...arguments),jc.add(this)}async unwrap(e,n,s=this._client.webhookSecret,a=300){return await this.verifySignature(e,n,s,a),JSON.parse(e)}async verifySignature(e,n,s=this._client.webhookSecret,a=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");ge(this,jc,"m",UM).call(this,s);const i=ct([n]).values,o=ge(this,jc,"m",pp).call(this,i,"webhook-signature"),c=ge(this,jc,"m",pp).call(this,i,"webhook-timestamp"),d=ge(this,jc,"m",pp).call(this,i,"webhook-id"),u=parseInt(c,10);if(isNaN(u))throw new Pu("Invalid webhook timestamp format");const m=Math.floor(Date.now()/1e3);if(m-u>a)throw new Pu("Webhook timestamp is too old");if(u>m+a)throw new Pu("Webhook timestamp is too new");const f=o.split(" ").map(v=>v.startsWith("v1,")?v.substring(3):v),p=s.startsWith("whsec_")?Buffer.from(s.replace("whsec_",""),"base64"):Buffer.from(s,"utf-8"),y=d?`${d}.${c}.${e}`:`${c}.${e}`,j=await crypto.subtle.importKey("raw",p,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const v of f)try{const _=Buffer.from(v,"base64");if(await crypto.subtle.verify("HMAC",j,_,new TextEncoder().encode(y)))return}catch{continue}throw new Pu("The given webhook signature does not match the expected signature")}}jc=new WeakSet,UM=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},pp=function(e,n){if(!e)throw new Error("Headers are required");const s=e.get(n);if(s==null)throw new Error(`Missing required header: ${n}`);return s};var _w,Zj,gp,WM;class qt{constructor({baseURL:e=hc("OPENAI_BASE_URL"),apiKey:n=hc("OPENAI_API_KEY"),organization:s=hc("OPENAI_ORG_ID")??null,project:a=hc("OPENAI_PROJECT_ID")??null,webhookSecret:i=hc("OPENAI_WEBHOOK_SECRET")??null,...o}={}){if(_w.add(this),gp.set(this,void 0),this.completions=new jM(this),this.chat=new Rj(this),this.embeddings=new kM(this),this.files=new EM(this),this.images=new RM(this),this.audio=new jf(this),this.moderations=new OM(this),this.models=new IM(this),this.fineTuning=new Vd(this),this.graders=new Wj(this),this.vectorStores=new Eg(this),this.webhooks=new qM(this),this.beta=new Nf(this),this.batches=new xM(this),this.uploads=new Kj(this),this.responses=new Vj(this),this.conversations=new Fj(this),this.evals=new zj(this),this.containers=new Lj(this),n===void 0)throw new wt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const c={apiKey:n,organization:s,project:a,webhookSecret:i,...o,baseURL:e||"https://api.openai.com/v1"};if(!c.dangerouslyAllowBrowser&&bK())throw new wt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=c.baseURL,this.timeout=c.timeout??Zj.DEFAULT_TIMEOUT,this.logger=c.logger??console;const d="warn";this.logLevel=d,this.logLevel=Kk(c.logLevel,"ClientOptions.logLevel",this)??Kk(hc("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??d,this.fetchOptions=c.fetchOptions,this.maxRetries=c.maxRetries??2,this.fetch=c.fetch??CK(),kt(this,gp,AK),this._options=c,this.apiKey=n,this.organization=s,this.project=a,this.webhookSecret=i}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}async authHeaders(e){return ct([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return IK(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${wc}`}defaultIdempotencyKey(){return`stainless-node-retry-${_T()}`}makeStatusError(e,n,s,a){return vr.generate(e,n,s,a)}buildURL(e,n,s){const a=!ge(this,_w,"m",WM).call(this)&&s||this.baseURL,i=xK(e)?new URL(e):new URL(a+(a.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return vK(o)||(n={...o,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(i.search=this.stringifyQuery(n)),i.toString()}async prepareOptions(e){}async prepareRequest(e,{url:n,options:s}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,s){return this.request(Promise.resolve(s).then(a=>({method:e,path:n,...a})))}request(e,n=null){return new Ng(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,s){var b,w;const a=await e,i=a.maxRetries??this.maxRetries;n==null&&(n=i),await this.prepareOptions(a);const{req:o,url:c,timeout:d}=await this.buildRequest(a,{retryCount:i-n});await this.prepareRequest(o,{url:c,options:a});const u="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),m=s===void 0?"":`, retryOf: ${s}`,f=Date.now();if(hr(this).debug(`[${u}] sending request`,al({retryOfRequestLogID:s,method:a.method,url:c,options:a,headers:o.headers})),(b=a.signal)!=null&&b.aborted)throw new Is;const p=new AbortController,y=await this.fetchWithTimeout(c,o,d,p).catch(cw),j=Date.now();if(y instanceof Error){const N=`retrying, ${n} attempts remaining`;if((w=a.signal)!=null&&w.aborted)throw new Is;const S=lw(y)||/timed? ?out/i.test(String(y)+("cause"in y?String(y.cause):""));if(n)return hr(this).info(`[${u}] connection ${S?"timed out":"failed"} - ${N}`),hr(this).debug(`[${u}] connection ${S?"timed out":"failed"} (${N})`,al({retryOfRequestLogID:s,url:c,durationMs:j-f,message:y.message})),this.retryRequest(a,n,s??u);throw hr(this).info(`[${u}] connection ${S?"timed out":"failed"} - error; no more retries left`),hr(this).debug(`[${u}] connection ${S?"timed out":"failed"} (error; no more retries left)`,al({retryOfRequestLogID:s,url:c,durationMs:j-f,message:y.message})),S?new kj:new bg({cause:y})}const v=[...y.headers.entries()].filter(([N])=>N==="x-request-id").map(([N,S])=>", "+N+": "+JSON.stringify(S)).join(""),_=`[${u}${m}${v}] ${o.method} ${c} ${y.ok?"succeeded":"failed"} with status ${y.status} in ${j-f}ms`;if(!y.ok){const N=await this.shouldRetry(y);if(n&&N){const B=`retrying, ${n} attempts remaining`;return await EK(y.body),hr(this).info(`${_} - ${B}`),hr(this).debug(`[${u}] response error (${B})`,al({retryOfRequestLogID:s,url:y.url,status:y.status,headers:y.headers,durationMs:j-f})),this.retryRequest(a,n,s??u,y.headers)}const S=N?"error; no more retries left":"error; not retryable";hr(this).info(`${_} - ${S}`);const A=await y.text().catch(B=>cw(B).message),E=wK(A),D=E?void 0:A;throw hr(this).debug(`[${u}] response error (${S})`,al({retryOfRequestLogID:s,url:y.url,status:y.status,headers:y.headers,message:D,durationMs:Date.now()-f})),this.makeStatusError(y.status,E,D,y.headers)}return hr(this).info(_),hr(this).debug(`[${u}] response start`,al({retryOfRequestLogID:s,url:y.url,status:y.status,headers:y.headers,durationMs:j-f})),{response:y,options:a,controller:p,requestLogID:u,retryOfRequestLogID:s,startTime:f}}getAPIList(e,n,s){return this.requestAPIList(n,{method:"get",path:e,...s})}requestAPIList(e,n){const s=this.makeRequest(n,null,void 0);return new WK(this,s,e)}async fetchWithTimeout(e,n,s,a){const{signal:i,method:o,...c}=n||{};i&&i.addEventListener("abort",()=>a.abort());const d=setTimeout(()=>a.abort(),s),u=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,m={signal:a.signal,...u?{duplex:"half"}:{},method:"GET",...c};o&&(m.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,m)}finally{clearTimeout(d)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,s,a){let i;const o=a==null?void 0:a.get("retry-after-ms");if(o){const d=parseFloat(o);Number.isNaN(d)||(i=d)}const c=a==null?void 0:a.get("retry-after");if(c&&!i){const d=parseFloat(c);Number.isNaN(d)?i=Date.parse(c)-Date.now():i=d*1e3}if(!(i&&0<=i&&i<60*1e3)){const d=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(n,d)}return await wf(i),this.makeRequest(e,n-1,s)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),c=1-Math.random()*.25;return o*c*1e3}async buildRequest(e,{retryCount:n=0}={}){const s={...e},{method:a,path:i,query:o,defaultBaseURL:c}=s,d=this.buildURL(i,o,c);"timeout"in s&&_K("timeout",s.timeout),s.timeout=s.timeout??this.timeout;const{bodyHeaders:u,body:m}=this.buildBody({options:s}),f=await this.buildHeaders({options:e,method:a,bodyHeaders:u,retryCount:n});return{req:{method:a,headers:f,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"},...m&&{body:m},...this.fetchOptions??{},...s.fetchOptions??{}},url:d,timeout:s.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:s,retryCount:a}){let i={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const o=ct([i,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...kK(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,s,e.headers]);return this.validateHeaders(o),o.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const s=ct([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&s.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:MT(e)}:ge(this,gp,"f").call(this,{body:e,headers:s})}}Zj=qt,gp=new WeakMap,_w=new WeakSet,WM=function(){return this.baseURL!=="https://api.openai.com/v1"};qt.OpenAI=Zj;qt.DEFAULT_TIMEOUT=6e5;qt.OpenAIError=wt;qt.APIError=vr;qt.APIConnectionError=bg;qt.APIConnectionTimeoutError=kj;qt.APIUserAbortError=Is;qt.NotFoundError=NT;qt.ConflictError=ST;qt.RateLimitError=CT;qt.BadRequestError=wT;qt.AuthenticationError=bT;qt.InternalServerError=ET;qt.PermissionDeniedError=jT;qt.UnprocessableEntityError=kT;qt.InvalidWebhookSignatureError=Pu;qt.toFile=YK;qt.Completions=jM;qt.Chat=Rj;qt.Embeddings=kM;qt.Files=EM;qt.Images=RM;qt.Audio=jf;qt.Moderations=OM;qt.Models=IM;qt.FineTuning=Vd;qt.Graders=Wj;qt.VectorStores=Eg;qt.Webhooks=qM;qt.Beta=Nf;qt.Batches=xM;qt.Uploads=Kj;qt.Responses=Vj;qt.Conversations=Fj;qt.Evals=zj;qt.Containers=Lj;const jZ=new qt({apiKey:"sk-proj-demo-key-hier-einfuegen",dangerouslyAllowBrowser:!0});async function NZ(t,e){try{console.log("OpenAI Extraktion gestartet...");const n=`Du bist ein Experte für die Extraktion von Daten aus deutschen Handwerker-Rechnungen.
    Extrahiere ALLE relevanten Informationen aus der Rechnung und gebe sie als strukturiertes JSON zurück.
    
    Achte besonders auf:
    - Deutsche Datumsformate (DD.MM.YYYY) -> konvertiere zu YYYY-MM-DD
    - Deutsche Zahlenformate (1.234,56 €) -> konvertiere zu Dezimalzahlen
    - Handwerker-spezifische Begriffe
    - Positionen/Artikel in Tabellen
    
    Gib NUR valides JSON zurück, keine zusätzlichen Erklärungen.`,s=`Extrahiere alle Rechnungsdaten aus diesem Bild. 
    ${e?`Hier ist der bereits erkannte Text als Hilfe: ${e}`:""}
    
    Gib die Daten in diesem exakten JSON-Format zurück:
    {
      "invoiceNumber": "Rechnungsnummer",
      "date": "YYYY-MM-DD",
      "supplierName": "Firmenname",
      "totalAmount": Gesamtbetrag als Zahl,
      "vatAmount": MwSt-Betrag als Zahl oder null,
      "vatRate": MwSt-Satz als Zahl oder null,
      "netAmount": Nettobetrag als Zahl oder null,
      "iban": "IBAN oder null",
      "customerNumber": "Kundennummer oder null",
      "orderNumber": "Auftragsnummer oder null"
    }`,a=await jZ.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:n},{role:"user",content:[{type:"text",text:s},{type:"image_url",image_url:{url:`data:image/jpeg;base64,${t}`,detail:"high"}}]}],max_tokens:2e3,temperature:.1,response_format:{type:"json_object"}}),i=JSON.parse(a.choices[0].message.content||"{}");return console.log("OpenAI extrahierte Daten:",i),{invoiceNumber:i.invoiceNumber||"UNBEKANNT",date:i.date||i.invoiceDate||new Date().toISOString().split("T")[0],invoiceDate:i.invoiceDate,deliveryDate:i.deliveryDate,dueDate:i.dueDate,supplierName:i.supplierName||"UNBEKANNT",supplierAddress:i.supplierAddress,supplierTaxNumber:i.supplierTaxNumber,supplierVatId:i.supplierVatId,customerName:i.customerName,customerNumber:i.customerNumber,customerAddress:i.customerAddress,positions:i.positions||[],netAmount:i.netAmount,vatRate:i.vatRate,vatAmount:i.vatAmount,totalAmount:i.totalAmount||0,iban:i.iban,bic:i.bic,orderNumber:i.orderNumber,deliveryNoteNumber:i.deliveryNoteNumber,projectNumber:i.projectNumber,paymentTerms:i.paymentTerms,discountTerms:i.discountTerms,description:`AI-extrahiert am ${new Date().toLocaleDateString("de-DE")}`}}catch(n){throw console.error("OpenAI Extraktion fehlgeschlagen:",n),new Error("KI-Extraktion fehlgeschlagen: "+n.message)}}function SZ(){return!0}class w0{static async initialize(){if(!(this.isInitialized&&this.worker))try{console.log("Initialisiere Tesseract Worker...");try{this.worker=await Ok.createWorker(["deu","eng"]),console.log("Deutsche und englische Sprachdateien geladen")}catch(e){console.warn("Mehrsprachige Initialisierung fehlgeschlagen, verwende nur Englisch:",e);try{this.worker=await Ok.createWorker("eng"),console.log("Englische Sprachdatei geladen")}catch(n){throw console.error("Fallback auf Englisch fehlgeschlagen:",n),n}}await this.worker.setParameters({tessedit_char_whitelist:`0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyzäöüÄÖÜß.,:-€$%/@()[]{}|_+=*&!?"' 	
`,tessedit_pageseg_mode:"3",preserve_interword_spaces:"1",tessedit_ocr_engine_mode:"3",tessedit_min_confidence:"60"}),this.isInitialized=!0,console.log("OCR Service erfolgreich initialisiert mit optimierten Parametern")}catch(e){throw console.error("Failed to initialize OCR Service:",e),new fo("OCR Service konnte nicht initialisiert werden. Überprüfen Sie Ihre Internetverbindung.",Au.SERVER_ERROR,"Tesseract Worker initialization failed")}}static async processInvoiceImage(e){return Am(async()=>{const n=await dv();(!this.isInitialized||!this.worker)&&await this.initialize();const s=await this.fileToBase64(e),a=e.name.split(".").pop()||"jpg",i=`invoice_${Date.now()}.${a}`;let o=`data:image/${a};base64,${s}`,c,d,u="";console.log("Starte OCR-Verarbeitung für Datei:",e.name);const m=await this.worker.recognize(e,{rotateAuto:!0,rotateRadians:0});u=m.data.text||"";const f=m.data.confidence||0,p=this.cleanOCRText(u);if(console.log(`OCR abgeschlossen - Konfidenz: ${f}%`),console.log("OCR Raw Text (erste 500 Zeichen):",u.substring(0,500)),console.log("Bereinigte Version:",p.substring(0,500)),SZ()){console.log("Verwende OpenAI Vision API für Extraktion...");try{c=await NZ(s,u),d={overall:.95,invoice_number:.95,date:.95,amount:.95,supplier:.95},console.log("OpenAI Extraktion erfolgreich!")}catch(j){console.error("OpenAI fehlgeschlagen, falle zurück auf Regex:",j),c=this.extractInvoiceData(p),d=this.calculateConfidenceScores(p,c)}}const y={id:`ocr_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,original_file_path:o,extracted_text:u,structured_data:c,confidence_scores:d,status:"pending",created_at:new Date().toISOString(),created_by:(n==null?void 0:n.id)||"unknown"};try{const j=JSON.parse(localStorage.getItem("ocr_results")||"[]");j.push(y),localStorage.setItem("ocr_results",JSON.stringify(j)),console.log("OCR result saved locally:",y.id)}catch(j){console.warn("LocalStorage failed, continuing without storage:",j)}return console.log("OCR result created successfully:",y.id),ot.emit("OCR_PROCESSED",{ocr_id:y.id,confidence:d.overall,supplier_name:c.supplierName,user_id:n.id}),y},"Process invoice with OCR")}static async validateAndCreateInvoice(e,n,s){return Am(async()=>{const a=await dv(),{data:i,error:o}=await K.from("ocr_results").update({structured_data:n,status:"validated",validation_notes:s,validated_at:new Date().toISOString(),validated_by:a.id}).eq("id",e).select().single();if(o)throw new fo("OCR-Validierung fehlgeschlagen",Au.SERVER_ERROR,o.message);const c={invoice_number:n.invoiceNumber,supplier_name:n.supplierName,invoice_date:n.date,total_amount:n.totalAmount,vat_amount:n.vatAmount||0,description:n.description||"",status:"pending",ocr_result_id:e,created_by:a.id},{data:d,error:u}=await K.from("supplier_invoices").insert(c).select().single();if(u)throw new fo("Rechnung konnte nicht erstellt werden",Au.SERVER_ERROR,u.message);try{console.log("Audit log: Invoice created from OCR",{entity_id:d.id,invoice_number:n.invoiceNumber,supplier_name:n.supplierName,total_amount:n.totalAmount})}catch(m){console.error("Audit log failed (non-critical):",m)}return{ocr_result:i,invoice_id:d.id}},"Validate OCR and create invoice")}static async getOCRResults(e){return Am(async()=>{try{const n=JSON.parse(localStorage.getItem("ocr_results")||"[]");let s=n;return e&&(s=n.filter(a=>a.status===e)),s.sort((a,i)=>new Date(i.created_at).getTime()-new Date(a.created_at).getTime()),console.log(`Retrieved ${s.length} OCR results from localStorage`),s}catch(n){return console.warn("Failed to read from localStorage, returning empty array:",n),[]}},"Get OCR results")}static async rejectOCRResult(e,n){return Am(async()=>{const s=await dv(),{error:a}=await K.from("ocr_results").update({status:"rejected",validation_notes:n,validated_at:new Date().toISOString(),validated_by:s.id}).eq("id",e);if(a)throw new fo("OCR-Ergebnis konnte nicht abgelehnt werden",Au.SERVER_ERROR,a.message);try{console.log("Audit log: OCR result rejected",{entity_id:e,status:"rejected",reason:n})}catch(i){console.error("Audit log failed (non-critical):",i)}},"Reject OCR result")}static fileToBase64(e){return new Promise((n,s)=>{const a=new FileReader;a.onload=()=>{const i=a.result.split(",")[1];n(i)},a.onerror=s,a.readAsDataURL(e)})}static cleanOCRText(e){let n=e.replace(/[ \t]+/g," ");return n=n.replace(/\bl\s*nvoice/gi,"Invoice").replace(/\bRechnunq/gi,"Rechnung").replace(/\bDaturn/gi,"Datum").replace(/\bSurnme/gi,"Summe").replace(/\bMwSt\./gi,"MwSt").replace(/\bGrnbH/gi,"GmbH").replace(/\bAG\s*\./gi,"AG").replace(/\€/g,"€").replace(/\bEUR\b/g,"€").replace(/([0-9]),\s*([0-9]{2})\s*€/g,"$1,$2 €"),n}static extractInvoicePositions(e){const n=[],s=e.split(`
`),a=[/^(\d+)[\.\s]+(.+?)\s+(\d+[\.,]?\d*)\s*(Stk|Std|m²|m|kg|l|Stück|Stunde)?\s*€?\s*([\d\.,]+)\s*€?\s*([\d\.,]+)/,/(.+?)\s+(\d+[\.,]?\d*)\s*x\s*€?\s*([\d\.,]+)\s*=\s*€?\s*([\d\.,]+)/,/([A-Z0-9\-]+)\s+(.+?)\s+(\d+[\.,]?\d*)\s+€?\s*([\d\.,]+)\s+€?\s*([\d\.,]+)/];for(const i of s){const o=i.trim();if(o)for(const c of a){const d=o.match(c);if(d){let u;if(d.length===7)u={position:parseInt(d[1]),description:d[2].trim(),quantity:this.parseAmount(d[3]),unit:d[4]||"Stk",unitPrice:this.parseAmount(d[5]),totalPrice:this.parseAmount(d[6])};else if(d.length===5)u={description:d[1].trim(),quantity:this.parseAmount(d[2]),unitPrice:this.parseAmount(d[3]),totalPrice:this.parseAmount(d[4])};else if(d.length===6)u={articleNumber:d[1],description:d[2].trim(),quantity:this.parseAmount(d[3]),unitPrice:this.parseAmount(d[4]),totalPrice:this.parseAmount(d[5])};else continue;u.quantity>0&&u.totalPrice>0&&(n.push(u),console.log("Position gefunden:",u));break}}}return n}static extractInvoiceData(e){const n=e,s=e.replace(/\n/g," ").replace(/\s+/g," ").trim();console.log("OCR Clean Text:",s);const a={invoiceNumber:[/Rechnungs[\s-]*(?:Nr\.?|Nummer)\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Rechnung\s*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/(?:Rg|Re)[\s-]*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Invoice\s*(?:No\.?|Number)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Beleg[\s-]*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Nr\.?\s*[:.]\s*([A-Z0-9\-\/]{3,})/i],invoiceDate:[/Datum[:\s]*(\d{1,2}\.\d{1,2}\.\d{4})/i,/(?:rechnungsdatum|datum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:ausstellungsdatum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:datum der rechnung)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(\d{1,2}\.\d{1,2}\.\d{4})/],deliveryDate:[/(?:lieferdatum|leistungsdatum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:leistungszeitraum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i],dueDate:[/(?:fällig am|zahlbar bis|zahlungsziel)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:fälligkeit|zahlung bis)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i],totalAmount:[/Gesamtbetrag[:\s]*€?\s*([\d\.,]+)/i,/(?:gesamt(?:betrag|summe)|total|summe)[:\s]*€?\s*([\d\.,]+)/i,/(?:zu zahlen|zahlbetrag)[:\s]*€?\s*([\d\.,]+)/i,/Brutto[:\s]*€?\s*([\d\.,]+)/i,/([\d]{1,3}(?:\.\d{3})*,\d{2})\s*€/,/([\d\.,]+)\s*€/i,/€\s*([\d\.,]+)/i],netAmount:[/(?:netto(?:betrag|summe)?)[:\s]*€?\s*([\d\.,]+)/i,/(?:summe netto)[:\s]*€?\s*([\d\.,]+)/i,/(?:zwischensumme)[:\s]*€?\s*([\d\.,]+)/i],vatAmount:[/MwSt[.\s]*19%[:\s]*€?\s*([\d\.,]+)/i,/19%\s*MwSt[:\s]*€?\s*([\d\.,]+)/i,/(?:mwst|mehrwertsteuer|ust|vat)[:\s]*€?\s*([\d\.,]+)/i,/(?:steuer)[:\s]*€?\s*([\d\.,]+)/i,/(\d{1,2})\s*%\s*mwst[:\s]*€?\s*([\d\.,]+)/i,/190,00\s*€/],vatRate:[/(?:mwst|mehrwertsteuer|ust)[\s:]*(\d{1,2})\s*%/i,/(\d{1,2})\s*%\s*(?:mwst|steuer)/i],supplierName:[/([A-Za-zÄÖÜäöüß][A-Za-zÄÖÜäöüß\s&\-\.]{1,40}\s+(?:GmbH|AG|KG|OHG|GbR|e\.K\.|e\.V\.|UG|GmbH\s*&\s*Co\.?\s*KG))/i,/([A-Za-zÄÖÜäöüß][A-Za-zÄÖÜäöüß\s]{1,30}\s+(?:Handwerk|Bau|Elektro|Sanitär|Heizung|Malerei|Schreinerei|Tischlerei|Zimmerei))/i,/([A-Z][a-zäöüß]+\s+[A-Z][a-zäöüß]+)\s*(?:-|–|—)?\s*(?:Meisterbetrieb|Handwerksmeister|Inhaber)/i,/^([A-Z][A-Za-zÄÖÜäöüß\s&\-\.]{2,40})\s*\n/m,/([A-Za-zÄÖÜäöüß\s&\-]{3,30}(?:GmbH|AG|KG))/i],iban:[/iban[:\s]*([A-Z]{2}\d{2}[\s]?[\d\s]{10,30})/i,/([A-Z]{2}\d{2}[\s]?[\d\s]{16,20})/g],bic:[/(?:bic|swift)[:\s]*([A-Z]{6,11})/i],customerNumber:[/(?:kunden(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:kdnr|kd\.?nr)[:\s]*([A-Z0-9\-\/]+)/i],orderNumber:[/(?:auftrags(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:bestell(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:auftrag|bestellung)[:\s]*([A-Z0-9\-\/]+)/i],deliveryNoteNumber:[/(?:lieferschein(?:nummer|nr)?)[:\s]*([A-Z0-9\-\/]+)/i,/(?:ls[\s\-]?nr)[:\s]*([A-Z0-9\-\/]+)/i],projectNumber:[/(?:projekt(?:nummer|nr)?)[:\s]*([A-Z0-9\-\/]+)/i,/(?:bauvorhaben|baustelle)[:\s]*([A-Z0-9\-\/]+)/i],paymentTerms:[/(?:zahlungsbedingungen|zahlungsziel)[:\s]*([^\n]{5,50})/i,/(?:zahlung)[:\s]*([^\n]{5,50})/i],discountTerms:[/(\d{1,2})\s*%\s*(?:skonto|rabatt)(?:\s*bei\s*zahlung)?[^\n]*/i,/(?:skonto|rabatt)[:\s]*([^\n]{5,50})/i]},i={};console.log("Starting extraction from text:",s.substring(0,200));for(const c of a.invoiceNumber){const d=s.match(c);if(d){i.invoiceNumber=d[1].trim(),console.log("Rechnungsnummer gefunden:",d[1]);break}}if(!i.invoiceNumber){const c=s.match(/2020-001/);c&&(i.invoiceNumber=c[0],console.log("Rechnungsnummer per Fallback:",c[0]))}for(const c of a.invoiceDate){const d=s.match(c);if(d){i.date=this.parseDate(d[1]),i.invoiceDate=i.date;break}}for(const c of a.deliveryDate){const d=s.match(c);if(d){i.deliveryDate=this.parseDate(d[1]);break}}for(const c of a.dueDate){const d=s.match(c);if(d){i.dueDate=this.parseDate(d[1]);break}}for(const c of a.totalAmount){const d=s.match(c);if(d){i.totalAmount=this.parseAmount(d[1]);break}}for(const c of a.netAmount){const d=s.match(c);if(d){i.netAmount=this.parseAmount(d[1]);break}}for(const c of a.vatAmount){const d=s.match(c);if(d){const u=d[2]||d[1];i.vatAmount=this.parseAmount(u);break}}for(const c of a.vatRate){const d=s.match(c);if(d){i.vatRate=parseInt(d[1]);break}}for(const c of a.supplierName){const d=s.match(c);if(d&&d[1]&&d[1].length>3){i.supplierName=d[1].trim(),console.log("Supplier found:",d[1]);break}}i.supplierName||console.log("No supplier found in:",s.substring(0,100));for(const c of a.iban){const d=s.match(c);if(d&&d[1]){i.iban=d[1].replace(/\s/g,"");break}}for(const c of a.bic){const d=s.match(c);if(d&&d[1]){i.bic=d[1];break}}for(const c of a.customerNumber){const d=s.match(c);if(d&&d[1]){i.customerNumber=d[1];break}}for(const c of a.orderNumber){const d=s.match(c);if(d&&d[1]){i.orderNumber=d[1];break}}for(const c of a.deliveryNoteNumber){const d=s.match(c);if(d&&d[1]){i.deliveryNoteNumber=d[1];break}}for(const c of a.projectNumber){const d=s.match(c);if(d&&d[1]){i.projectNumber=d[1];break}}for(const c of a.paymentTerms){const d=s.match(c);if(d&&d[1]){i.paymentTerms=d[1].trim();break}}for(const c of a.discountTerms){const d=s.match(c);if(d){i.discountTerms=d[0].trim();break}}const o=this.extractInvoicePositions(n);if(o.length>0&&(i.positions=o,console.log(`${o.length} Positionen extrahiert`)),i.netAmount&&i.vatAmount&&!i.totalAmount&&(i.totalAmount=i.netAmount+i.vatAmount),i.totalAmount&&i.vatAmount&&!i.netAmount&&(i.netAmount=i.totalAmount-i.vatAmount),i.netAmount&&i.vatRate&&!i.vatAmount&&(i.vatAmount=i.netAmount*(i.vatRate/100)),o.length>0&&!i.totalAmount){const c=o.reduce((d,u)=>d+u.totalPrice,0);i.netAmount||(i.netAmount=c),i.vatRate?(i.vatAmount=c*(i.vatRate/100),i.totalAmount=c+i.vatAmount):i.totalAmount=c}return{invoiceNumber:i.invoiceNumber||"UNBEKANNT",date:i.date||i.invoiceDate||new Date().toISOString().split("T")[0],invoiceDate:i.invoiceDate,deliveryDate:i.deliveryDate,dueDate:i.dueDate,supplierName:i.supplierName||"UNBEKANNT",totalAmount:i.totalAmount||0,netAmount:i.netAmount,vatAmount:i.vatAmount,vatRate:i.vatRate,iban:i.iban,bic:i.bic,customerNumber:i.customerNumber,orderNumber:i.orderNumber,deliveryNoteNumber:i.deliveryNoteNumber,projectNumber:i.projectNumber,paymentTerms:i.paymentTerms,discountTerms:i.discountTerms,description:`OCR-Import vom ${new Date().toLocaleDateString("de-DE")}`}}static parseAmount(e){return parseFloat(e.replace(/\./g,"").replace(",",".").replace(/[^\d.]/g,""))||0}static parseDate(e){const n=e.split(/[\.\-\/]/);if(n.length===3){const s=n[0].padStart(2,"0"),a=n[1].padStart(2,"0");let i=n[2];return i.length===2&&(i=parseInt(i)>50?`19${i}`:`20${i}`),`${i}-${a}-${s}`}return new Date().toISOString().split("T")[0]}static calculateConfidenceScores(e,n){const s={overall:0,invoice_number:0,date:0,amount:0,supplier:0};n.invoiceNumber!=="UNBEKANNT"&&(s.invoice_number=/[A-Z0-9]{3,}/.test(n.invoiceNumber)?.9:.6);const a=/\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4}/;if(s.date=a.test(e)?.8:.3,n.totalAmount>0){const i=/€\s*[\d\.,]+|\d+[,\.]\d{2}/;s.amount=i.test(e)?.85:.4}return n.supplierName!=="UNBEKANNT"&&(s.supplier=n.supplierName.length>5?.7:.5),s.overall=s.invoice_number*.3+s.date*.2+s.amount*.3+s.supplier*.2,s}static async cleanup(){this.worker&&(await this.worker.terminate(),this.worker=null,this.isInitialized=!1)}}As(w0,"worker",null),As(w0,"isInitialized",!1);const Vt={PROJECT_KPIS:"project-kpis",PROJECT_KPIS_SUMMARY:"project-kpis-summary",NOTIFICATIONS:"notifications",NOTIFICATION_STATS:"notification-stats",WORKER_STATUS:"worker-status",AUDIT_LOGS:"audit-logs",AUDIT_TRAIL:"audit-trail",AUDIT_STATS:"audit-stats",NUMBER_SEQUENCES:"number-sequences",GOBD_DOCUMENTS:"gobd-documents",IMMUTABILITY_CHECK:"immutability-check",DATEV_EXPORTS:"datev-exports",DATEV_ACCOUNT_MAPPINGS:"datev-account-mappings",GERMAN_VAT_RETURNS:"german-vat-returns",GERMAN_PERIODS:"german-periods",GERMAN_EXPENSE_REPORTS:"german-expense-reports",AI_DOCUMENTS:"ai-documents",AI_SEARCH_RESULTS:"ai-search-results",AI_INTENT_ANALYSES:"ai-intent-analyses",AI_ESTIMATIONS:"ai-estimations",AI_INDEXING_STATUS:"ai-indexing-status",OCR_RESULTS:"ocr-results",OCR_RESULT:t=>["ocr-results",t],OCR_PENDING:"ocr-pending",customers:["customers"],customer:t=>["customers",t],customerStats:t=>["customers",t,"stats"],customerProjects:t=>["customers",t,"projects"],customerQuotes:t=>["customers",t,"quotes"],customerInvoices:t=>["customers",t,"invoices"],quotes:["quotes"],quote:t=>["quotes",t],quoteStats:["quotes","stats"],orders:["orders"],order:t=>["orders",t],orderStats:["orders","stats"],projects:["projects"],project:t=>["projects",t],projectStats:t=>["projects",t,"stats"],projectTimeline:t=>["projects",t,"timeline"],timesheets:["timesheets"],timesheet:t=>["timesheets",t],employeeTimesheetStats:t=>["timesheets","employee",t,"stats"],projectTimesheetSummary:t=>["timesheets","project",t,"summary"],materials:["materials"],material:t=>["materials",t],materialStats:["materials","stats"],lowStockMaterials:["materials","low-stock"],stockMovements:["stock-movements"],stockValuation:["stock","valuation"],stockAnalytics:["stock","analytics"],invoices:["invoices"],invoice:t=>["invoices",t],expenses:["expenses"],expense:t=>["expenses",t],financialKpis:["finance","kpis"],revenueByMonth:["finance","revenue-by-month"],expensesByCategory:["finance","expenses-by-category"],profitLossReport:["finance","profit-loss"],documents:["documents"],document:t=>["documents",t],documentStats:["documents","stats"],expiringDocuments:["documents","expiring"],employees:["employees"],employee:t=>["employees",t]},HM=(t,e,n)=>_s({queryKey:[...Vt.customers,t,e],queryFn:()=>vg.getCustomers(t,e),...n}),kZ=t=>{const e=or(),{toast:n}=Rt();return rs({mutationFn:s=>vg.createCustomer(s),onSuccess:s=>{e.invalidateQueries({queryKey:Vt.customers}),n({title:"Kunde erstellt",description:`${s.company_name} wurde erfolgreich erstellt.`})},onError:s=>{n({title:"Fehler beim Erstellen",description:s.message,variant:"destructive"})},...t})},CZ=t=>{const e=or(),{toast:n}=Rt();return rs({mutationFn:({id:s,data:a})=>gH.updateCustomer(s,a),onSuccess:(s,{id:a})=>{e.invalidateQueries({queryKey:Vt.customers}),e.invalidateQueries({queryKey:Vt.customer(a)}),e.invalidateQueries({queryKey:Vt.customerStats(a)}),n({title:"Kunde aktualisiert",description:`${s.company_name} wurde erfolgreich aktualisiert.`})},onError:s=>{n({title:"Fehler beim Aktualisieren",description:s.message,variant:"destructive"})},...t})},EZ=t=>{const e=or(),{toast:n}=Rt();return rs({mutationFn:s=>vg.deleteCustomer(s),onSuccess:(s,a)=>{e.invalidateQueries({queryKey:Vt.customers}),e.removeQueries({queryKey:Vt.customer(a)}),n({title:"Kunde gelöscht",description:"Der Kunde wurde erfolgreich gelöscht."})},onError:s=>{n({title:"Fehler beim Löschen",description:s.message,variant:"destructive"})},...t})},AZ=(t,e,n)=>_s({queryKey:[...Vt.quotes,t,e],queryFn:()=>yg.getQuotes(t,e),...n}),PZ=t=>{const e=or(),{toast:n}=Rt();return rs({mutationFn:yg.createQuote,onSuccess:s=>{e.invalidateQueries({queryKey:Vt.quotes}),e.invalidateQueries({queryKey:Vt.customerQuotes(s.customer_id)}),n({title:"Angebot erstellt",description:`${s.title} wurde erfolgreich erstellt.`})},onError:s=>{n({title:"Fehler beim Erstellen",description:s.message,variant:"destructive"})},...t})},DZ=t=>{const e=or(),{toast:n}=Rt();return rs({mutationFn:({id:s,data:a})=>yg.updateQuote(s,a),onSuccess:(s,{id:a})=>{e.invalidateQueries({queryKey:Vt.quotes}),e.invalidateQueries({queryKey:Vt.quote(a)}),n({title:"Angebot aktualisiert",description:`${s.title} wurde erfolgreich aktualisiert.`})},onError:s=>{n({title:"Fehler beim Aktualisieren",description:s.message,variant:"destructive"})},...t})},TZ=t=>{const e=or(),{toast:n}=Rt();return rs({mutationFn:yg.acceptQuote,onSuccess:(s,a)=>{e.invalidateQueries({queryKey:Vt.quotes}),e.invalidateQueries({queryKey:Vt.quote(a)}),e.invalidateQueries({queryKey:Vt.orders}),n({title:"Angebot angenommen",description:`${s.quote.title} wurde angenommen und ein Auftrag erstellt.`})},onError:s=>{n({title:"Fehler beim Annehmen",description:s.message,variant:"destructive"})},...t})},VM=(t,e,n)=>_s({queryKey:[...Vt.projects,t,e],queryFn:()=>uT.getProjects(t,e),...n}),KM=t=>{const e=or(),{toast:n}=Rt();return rs({mutationFn:uT.createProject,onSuccess:s=>{e.invalidateQueries({queryKey:Vt.projects}),e.invalidateQueries({queryKey:Vt.customerProjects(s.customer_id||"")}),n({title:"Projekt erstellt",description:`${s.name} wurde erfolgreich erstellt.`})},onError:s=>{n({title:"Fehler beim Erstellen",description:s.message,variant:"destructive"})},...t})},MZ=(t,e,n)=>_s({queryKey:[...Vt.timesheets,t,e],queryFn:()=>wj.getTimesheets(t,e),...n}),RZ=t=>{const e=or(),{toast:n}=Rt();return rs({mutationFn:wj.createTimesheet,onSuccess:s=>{e.invalidateQueries({queryKey:Vt.timesheets}),e.invalidateQueries({queryKey:Vt.projectStats(s.project_id||"")}),e.invalidateQueries({queryKey:Vt.employeeTimesheetStats(s.employee_id)}),n({title:"Zeiteintrag erstellt",description:"Der Zeiteintrag wurde erfolgreich erstellt."})},onError:s=>{n({title:"Fehler beim Erstellen",description:s.message,variant:"destructive"})},...t})},IZ=t=>{const e=or(),{toast:n}=Rt();return rs({mutationFn:({id:s,data:a})=>wj.updateTimesheet(s,a),onSuccess:(s,{id:a})=>{e.invalidateQueries({queryKey:Vt.timesheets}),e.invalidateQueries({queryKey:Vt.timesheet(a)}),n({title:"Zeiteintrag aktualisiert",description:"Der Zeiteintrag wurde erfolgreich aktualisiert."})},onError:s=>{n({title:"Fehler beim Aktualisieren",description:s.message,variant:"destructive"})},...t})},ZM=(t,e,n)=>_s({queryKey:[...Vt.invoices,t,e],queryFn:()=>_g.getInvoices(t,e),...n}),GM=t=>{const e=or(),{toast:n}=Rt();return rs({mutationFn:_g.createInvoice,onSuccess:s=>{e.invalidateQueries({queryKey:Vt.invoices}),e.invalidateQueries({queryKey:Vt.financialKpis}),n({title:"Rechnung erstellt",description:`${s.invoice_number||"Rechnung"} wurde erfolgreich erstellt.`})},onError:s=>{n({title:"Fehler beim Erstellen",description:s.message,variant:"destructive"})},...t})},OZ=(t,e,n)=>_s({queryKey:[...Vt.expenses,t,e],queryFn:()=>_g.getExpenses(t,e),...n}),LZ=(t,e)=>_s({queryKey:[...Vt.financialKpis,t],queryFn:()=>_g.getFinancialKPIs(t),...e}),FZ=(t,e,n)=>_s({queryKey:[...Vt.documents,t,e],queryFn:()=>NH.getDocuments(t,e),...n}),Gj=t=>_s({queryKey:Vt.employees,queryFn:async()=>{var e,n;try{const{data:{session:s}}=await K.auth.getSession();if(!s)return console.log("useEmployees: No session found"),{items:[]};const a=((e=s.user.user_metadata)==null?void 0:e.company_id)||((n=s.user.app_metadata)==null?void 0:n.company_id)||s.user.id;if(console.log("useEmployees: Using company_id:",a),console.log("useEmployees: Session user:",s.user),!a)return console.error("useEmployees: No company ID available"),{items:[]};const{data:i,error:o}=await K.from("employees").select("id, email, status, user_id, company_id").eq("company_id",a);console.log("useEmployees: DEBUG - All employees for company:",i);const{data:c,error:d}=await K.from("employees").select(`
            id,
            user_id,
            first_name,
            last_name,
            email,
            phone,
            position,
            status,
            qualifications,
            license,
            company_id
          `).not("user_id","is",null).in("status",["active","Active","aktiv","Aktiv"]).order("created_at",{ascending:!1});if(console.log("useEmployees: Raw query (no company filter):",c),console.log("useEmployees: Employees query result:",c,d),d)return console.error("useEmployees: Error fetching employees:",d),{items:[]};const u=(c==null?void 0:c.filter(p=>p.user_id).map(p=>p.user_id))||[];let m=[];if(u.length>0){const{data:p,error:y}=await K.from("profiles").select("id, first_name, last_name").in("id",u);y||(m=p||[])}const f=(c==null?void 0:c.map(p=>{const y=m.find(_=>_.id===p.user_id),j=(y==null?void 0:y.first_name)||p.first_name||"",v=(y==null?void 0:y.last_name)||p.last_name||"";return{id:p.id,first_name:j,last_name:v,name:`${j} ${v}`.trim(),email:p.email,phone:p.phone,position:p.position,status:p.status,qualifications:Array.isArray(p.qualifications)?p.qualifications:[],license:p.license}}))||[];return console.log("useEmployees: Final employee list:",f),{items:f}}catch(s){return console.error("useEmployees: Catch block error:",s),{items:[]}}},...t}),BZ=t=>{const e=or();return Rt(),rs({mutationFn:async n=>{const{error:s}=await K.from("employees").delete().eq("id",n);if(s)throw new Error(s.message)},onSuccess:()=>{e.invalidateQueries({queryKey:Vt.employees})},...t})},zZ=t=>{const e=or(),{toast:n}=Rt();return rs({mutationFn:s=>w0.processInvoiceImage(s),onSuccess:s=>{e.invalidateQueries({queryKey:[Vt.OCR_RESULTS]}),e.invalidateQueries({queryKey:[Vt.OCR_PENDING]}),n({title:"OCR-Verarbeitung abgeschlossen",description:`Rechnung von "${s.structured_data.supplierName}" wurde verarbeitet.`})},onError:s=>{n({title:"OCR-Verarbeitung fehlgeschlagen",description:s.message,variant:"destructive"})},...t})},$Z=(t,e)=>_s({queryKey:[Vt.OCR_RESULTS,t],queryFn:()=>w0.getOCRResults(t),staleTime:5*60*1e3,...e}),UZ=t=>$Z("pending",t);var ny="focusScope.autoFocusOnMount",ry="focusScope.autoFocusOnUnmount",dC={bubbles:!1,cancelable:!0},qZ="FocusScope",Sf=g.forwardRef((t,e)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=t,[c,d]=g.useState(null),u=jn(a),m=jn(i),f=g.useRef(null),p=Mt(e,v=>d(v)),y=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(s){let v=function(N){if(y.paused||!c)return;const S=N.target;c.contains(S)?f.current=S:qi(f.current,{select:!0})},_=function(N){if(y.paused||!c)return;const S=N.relatedTarget;S!==null&&(c.contains(S)||qi(f.current,{select:!0}))},b=function(N){if(document.activeElement===document.body)for(const A of N)A.removedNodes.length>0&&qi(c)};document.addEventListener("focusin",v),document.addEventListener("focusout",_);const w=new MutationObserver(b);return c&&w.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",_),w.disconnect()}}},[s,c,y.paused]),g.useEffect(()=>{if(c){hC.add(y);const v=document.activeElement;if(!c.contains(v)){const b=new CustomEvent(ny,dC);c.addEventListener(ny,u),c.dispatchEvent(b),b.defaultPrevented||(WZ(GZ(QM(c)),{select:!0}),document.activeElement===v&&qi(c))}return()=>{c.removeEventListener(ny,u),setTimeout(()=>{const b=new CustomEvent(ry,dC);c.addEventListener(ry,m),c.dispatchEvent(b),b.defaultPrevented||qi(v??document.body,{select:!0}),c.removeEventListener(ry,m),hC.remove(y)},0)}}},[c,u,m,y]);const j=g.useCallback(v=>{if(!n&&!s||y.paused)return;const _=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,b=document.activeElement;if(_&&b){const w=v.currentTarget,[N,S]=HZ(w);N&&S?!v.shiftKey&&b===S?(v.preventDefault(),n&&qi(N,{select:!0})):v.shiftKey&&b===N&&(v.preventDefault(),n&&qi(S,{select:!0})):b===w&&v.preventDefault()}},[n,s,y.paused]);return r.jsx(Xe.div,{tabIndex:-1,...o,ref:p,onKeyDown:j})});Sf.displayName=qZ;function WZ(t,{select:e=!1}={}){const n=document.activeElement;for(const s of t)if(qi(s,{select:e}),document.activeElement!==n)return}function HZ(t){const e=QM(t),n=uC(e,t),s=uC(e.reverse(),t);return[n,s]}function QM(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function uC(t,e){for(const n of t)if(!VZ(n,{upTo:e}))return n}function VZ(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function KZ(t){return t instanceof HTMLInputElement&&"select"in t}function qi(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&KZ(t)&&e&&t.select()}}var hC=ZZ();function ZZ(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=fC(t,e),t.unshift(e)},remove(e){var n;t=fC(t,e),(n=t[0])==null||n.resume()}}}function fC(t,e){const n=[...t],s=n.indexOf(e);return s!==-1&&n.splice(s,1),n}function GZ(t){return t.filter(e=>e.tagName!=="A")}var sy=0;function Ag(){g.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??mC()),document.body.insertAdjacentElement("beforeend",t[1]??mC()),sy++,()=>{sy===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),sy--}},[])}function mC(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Ia=function(){return Ia=Object.assign||function(e){for(var n,s=1,a=arguments.length;s<a;s++){n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ia.apply(this,arguments)};function YM(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n}function QZ(t,e,n){if(n||arguments.length===2)for(var s=0,a=e.length,i;s<a;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}var xp="right-scroll-bar-position",vp="width-before-scroll-bar",YZ="with-scroll-bars-hidden",XZ="--removed-body-scroll-bar-size";function ay(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function JZ(t,e){var n=g.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(s){var a=n.value;a!==s&&(n.value=s,n.callback(s,a))}}}})[0];return n.callback=e,n.facade}var eG=typeof window<"u"?g.useLayoutEffect:g.useEffect,pC=new WeakMap;function tG(t,e){var n=JZ(null,function(s){return t.forEach(function(a){return ay(a,s)})});return eG(function(){var s=pC.get(n);if(s){var a=new Set(s),i=new Set(t),o=n.current;a.forEach(function(c){i.has(c)||ay(c,null)}),i.forEach(function(c){a.has(c)||ay(c,o)})}pC.set(n,t)},[t]),n}function nG(t){return t}function rG(t,e){e===void 0&&(e=nG);var n=[],s=!1,a={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,s);return n.push(o),function(){n=n.filter(function(c){return c!==o})}},assignSyncMedium:function(i){for(s=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(c){return i(c)},filter:function(){return n}}},assignMedium:function(i){s=!0;var o=[];if(n.length){var c=n;n=[],c.forEach(i),o=n}var d=function(){var m=o;o=[],m.forEach(i)},u=function(){return Promise.resolve().then(d)};u(),n={push:function(m){o.push(m),u()},filter:function(m){return o=o.filter(m),n}}}};return a}function sG(t){t===void 0&&(t={});var e=rG(null);return e.options=Ia({async:!0,ssr:!1},t),e}var XM=function(t){var e=t.sideCar,n=YM(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=e.read();if(!s)throw new Error("Sidecar medium not found");return g.createElement(s,Ia({},n))};XM.isSideCarExport=!0;function aG(t,e){return t.useMedium(e),XM}var JM=sG(),iy=function(){},Pg=g.forwardRef(function(t,e){var n=g.useRef(null),s=g.useState({onScrollCapture:iy,onWheelCapture:iy,onTouchMoveCapture:iy}),a=s[0],i=s[1],o=t.forwardProps,c=t.children,d=t.className,u=t.removeScrollBar,m=t.enabled,f=t.shards,p=t.sideCar,y=t.noIsolation,j=t.inert,v=t.allowPinchZoom,_=t.as,b=_===void 0?"div":_,w=t.gapMode,N=YM(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=p,A=tG([n,e]),E=Ia(Ia({},N),a);return g.createElement(g.Fragment,null,m&&g.createElement(S,{sideCar:JM,removeScrollBar:u,shards:f,noIsolation:y,inert:j,setCallbacks:i,allowPinchZoom:!!v,lockRef:n,gapMode:w}),o?g.cloneElement(g.Children.only(c),Ia(Ia({},E),{ref:A})):g.createElement(b,Ia({},E,{className:d,ref:A}),c))});Pg.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Pg.classNames={fullWidth:vp,zeroRight:xp};var iG=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function oG(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=iG();return e&&t.setAttribute("nonce",e),t}function lG(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function cG(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var dG=function(){var t=0,e=null;return{add:function(n){t==0&&(e=oG())&&(lG(e,n),cG(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},uG=function(){var t=dG();return function(e,n){g.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},eR=function(){var t=uG(),e=function(n){var s=n.styles,a=n.dynamic;return t(s,a),null};return e},hG={left:0,top:0,right:0,gap:0},oy=function(t){return parseInt(t||"",10)||0},fG=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],s=e[t==="padding"?"paddingTop":"marginTop"],a=e[t==="padding"?"paddingRight":"marginRight"];return[oy(n),oy(s),oy(a)]},mG=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return hG;var e=fG(t),n=document.documentElement.clientWidth,s=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,s-n+e[2]-e[0])}},pG=eR(),Qc="data-scroll-locked",gG=function(t,e,n,s){var a=t.left,i=t.top,o=t.right,c=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(YZ,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(c,"px ").concat(s,`;
  }
  body[`).concat(Qc,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(s,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(s,`;
    `),n==="padding"&&"padding-right: ".concat(c,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(xp,` {
    right: `).concat(c,"px ").concat(s,`;
  }
  
  .`).concat(vp,` {
    margin-right: `).concat(c,"px ").concat(s,`;
  }
  
  .`).concat(xp," .").concat(xp,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(vp," .").concat(vp,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Qc,`] {
    `).concat(XZ,": ").concat(c,`px;
  }
`)},gC=function(){var t=parseInt(document.body.getAttribute(Qc)||"0",10);return isFinite(t)?t:0},xG=function(){g.useEffect(function(){return document.body.setAttribute(Qc,(gC()+1).toString()),function(){var t=gC()-1;t<=0?document.body.removeAttribute(Qc):document.body.setAttribute(Qc,t.toString())}},[])},vG=function(t){var e=t.noRelative,n=t.noImportant,s=t.gapMode,a=s===void 0?"margin":s;xG();var i=g.useMemo(function(){return mG(a)},[a]);return g.createElement(pG,{styles:gG(i,!e,a,n?"":"!important")})},ww=!1;if(typeof window<"u")try{var Fm=Object.defineProperty({},"passive",{get:function(){return ww=!0,!0}});window.addEventListener("test",Fm,Fm),window.removeEventListener("test",Fm,Fm)}catch{ww=!1}var mc=ww?{passive:!1}:!1,yG=function(t){return t.tagName==="TEXTAREA"},tR=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!yG(t)&&n[e]==="visible")},_G=function(t){return tR(t,"overflowY")},wG=function(t){return tR(t,"overflowX")},xC=function(t,e){var n=e.ownerDocument,s=e;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var a=nR(t,s);if(a){var i=rR(t,s),o=i[1],c=i[2];if(o>c)return!0}s=s.parentNode}while(s&&s!==n.body);return!1},bG=function(t){var e=t.scrollTop,n=t.scrollHeight,s=t.clientHeight;return[e,n,s]},jG=function(t){var e=t.scrollLeft,n=t.scrollWidth,s=t.clientWidth;return[e,n,s]},nR=function(t,e){return t==="v"?_G(e):wG(e)},rR=function(t,e){return t==="v"?bG(e):jG(e)},NG=function(t,e){return t==="h"&&e==="rtl"?-1:1},SG=function(t,e,n,s,a){var i=NG(t,window.getComputedStyle(e).direction),o=i*s,c=n.target,d=e.contains(c),u=!1,m=o>0,f=0,p=0;do{var y=rR(t,c),j=y[0],v=y[1],_=y[2],b=v-_-i*j;(j||b)&&nR(t,c)&&(f+=b,p+=j),c instanceof ShadowRoot?c=c.host:c=c.parentNode}while(!d&&c!==document.body||d&&(e.contains(c)||e===c));return(m&&(Math.abs(f)<1||!a)||!m&&(Math.abs(p)<1||!a))&&(u=!0),u},Bm=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},vC=function(t){return[t.deltaX,t.deltaY]},yC=function(t){return t&&"current"in t?t.current:t},kG=function(t,e){return t[0]===e[0]&&t[1]===e[1]},CG=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},EG=0,pc=[];function AG(t){var e=g.useRef([]),n=g.useRef([0,0]),s=g.useRef(),a=g.useState(EG++)[0],i=g.useState(eR)[0],o=g.useRef(t);g.useEffect(function(){o.current=t},[t]),g.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var v=QZ([t.lockRef.current],(t.shards||[]).map(yC),!0).filter(Boolean);return v.forEach(function(_){return _.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),v.forEach(function(_){return _.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var c=g.useCallback(function(v,_){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!o.current.allowPinchZoom;var b=Bm(v),w=n.current,N="deltaX"in v?v.deltaX:w[0]-b[0],S="deltaY"in v?v.deltaY:w[1]-b[1],A,E=v.target,D=Math.abs(N)>Math.abs(S)?"h":"v";if("touches"in v&&D==="h"&&E.type==="range")return!1;var M=xC(D,E);if(!M)return!0;if(M?A=D:(A=D==="v"?"h":"v",M=xC(D,E)),!M)return!1;if(!s.current&&"changedTouches"in v&&(N||S)&&(s.current=A),!A)return!0;var B=s.current||A;return SG(B,_,v,B==="h"?N:S,!0)},[]),d=g.useCallback(function(v){var _=v;if(!(!pc.length||pc[pc.length-1]!==i)){var b="deltaY"in _?vC(_):Bm(_),w=e.current.filter(function(A){return A.name===_.type&&(A.target===_.target||_.target===A.shadowParent)&&kG(A.delta,b)})[0];if(w&&w.should){_.cancelable&&_.preventDefault();return}if(!w){var N=(o.current.shards||[]).map(yC).filter(Boolean).filter(function(A){return A.contains(_.target)}),S=N.length>0?c(_,N[0]):!o.current.noIsolation;S&&_.cancelable&&_.preventDefault()}}},[]),u=g.useCallback(function(v,_,b,w){var N={name:v,delta:_,target:b,should:w,shadowParent:PG(b)};e.current.push(N),setTimeout(function(){e.current=e.current.filter(function(S){return S!==N})},1)},[]),m=g.useCallback(function(v){n.current=Bm(v),s.current=void 0},[]),f=g.useCallback(function(v){u(v.type,vC(v),v.target,c(v,t.lockRef.current))},[]),p=g.useCallback(function(v){u(v.type,Bm(v),v.target,c(v,t.lockRef.current))},[]);g.useEffect(function(){return pc.push(i),t.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:p}),document.addEventListener("wheel",d,mc),document.addEventListener("touchmove",d,mc),document.addEventListener("touchstart",m,mc),function(){pc=pc.filter(function(v){return v!==i}),document.removeEventListener("wheel",d,mc),document.removeEventListener("touchmove",d,mc),document.removeEventListener("touchstart",m,mc)}},[]);var y=t.removeScrollBar,j=t.inert;return g.createElement(g.Fragment,null,j?g.createElement(i,{styles:CG(a)}):null,y?g.createElement(vG,{gapMode:t.gapMode}):null)}function PG(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const DG=aG(JM,AG);var kf=g.forwardRef(function(t,e){return g.createElement(Pg,Ia({},t,{ref:e,sideCar:DG}))});kf.classNames=Pg.classNames;var TG=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},gc=new WeakMap,zm=new WeakMap,$m={},ly=0,sR=function(t){return t&&(t.host||sR(t.parentNode))},MG=function(t,e){return e.map(function(n){if(t.contains(n))return n;var s=sR(n);return s&&t.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},RG=function(t,e,n,s){var a=MG(e,Array.isArray(t)?t:[t]);$m[n]||($m[n]=new WeakMap);var i=$m[n],o=[],c=new Set,d=new Set(a),u=function(f){!f||c.has(f)||(c.add(f),u(f.parentNode))};a.forEach(u);var m=function(f){!f||d.has(f)||Array.prototype.forEach.call(f.children,function(p){if(c.has(p))m(p);else try{var y=p.getAttribute(s),j=y!==null&&y!=="false",v=(gc.get(p)||0)+1,_=(i.get(p)||0)+1;gc.set(p,v),i.set(p,_),o.push(p),v===1&&j&&zm.set(p,!0),_===1&&p.setAttribute(n,"true"),j||p.setAttribute(s,"true")}catch(b){console.error("aria-hidden: cannot operate on ",p,b)}})};return m(e),c.clear(),ly++,function(){o.forEach(function(f){var p=gc.get(f)-1,y=i.get(f)-1;gc.set(f,p),i.set(f,y),p||(zm.has(f)||f.removeAttribute(s),zm.delete(f)),y||f.removeAttribute(n)}),ly--,ly||(gc=new WeakMap,gc=new WeakMap,zm=new WeakMap,$m={})}},Dg=function(t,e,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),a=TG(t);return a?(s.push.apply(s,Array.from(a.querySelectorAll("[aria-live]"))),RG(s,a,n,"aria-hidden")):function(){return null}},Qj="Dialog",[aR,dae]=Ss(Qj),[IG,ya]=aR(Qj),iR=t=>{const{__scopeDialog:e,children:n,open:s,defaultOpen:a,onOpenChange:i,modal:o=!0}=t,c=g.useRef(null),d=g.useRef(null),[u=!1,m]=zs({prop:s,defaultProp:a,onChange:i});return r.jsx(IG,{scope:e,triggerRef:c,contentRef:d,contentId:ps(),titleId:ps(),descriptionId:ps(),open:u,onOpenChange:m,onOpenToggle:g.useCallback(()=>m(f=>!f),[m]),modal:o,children:n})};iR.displayName=Qj;var oR="DialogTrigger",lR=g.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,a=ya(oR,n),i=Mt(e,a.triggerRef);return r.jsx(Xe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Jj(a.open),...s,ref:i,onClick:Te(t.onClick,a.onOpenToggle)})});lR.displayName=oR;var Yj="DialogPortal",[OG,cR]=aR(Yj,{forceMount:void 0}),dR=t=>{const{__scopeDialog:e,forceMount:n,children:s,container:a}=t,i=ya(Yj,e);return r.jsx(OG,{scope:e,forceMount:n,children:g.Children.map(s,o=>r.jsx(Jn,{present:n||i.open,children:r.jsx(Td,{asChild:!0,container:a,children:o})}))})};dR.displayName=Yj;var b0="DialogOverlay",uR=g.forwardRef((t,e)=>{const n=cR(b0,t.__scopeDialog),{forceMount:s=n.forceMount,...a}=t,i=ya(b0,t.__scopeDialog);return i.modal?r.jsx(Jn,{present:s||i.open,children:r.jsx(LG,{...a,ref:e})}):null});uR.displayName=b0;var LG=g.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,a=ya(b0,n);return r.jsx(kf,{as:ji,allowPinchZoom:!0,shards:[a.contentRef],children:r.jsx(Xe.div,{"data-state":Jj(a.open),...s,ref:e,style:{pointerEvents:"auto",...s.style}})})}),Fl="DialogContent",hR=g.forwardRef((t,e)=>{const n=cR(Fl,t.__scopeDialog),{forceMount:s=n.forceMount,...a}=t,i=ya(Fl,t.__scopeDialog);return r.jsx(Jn,{present:s||i.open,children:i.modal?r.jsx(FG,{...a,ref:e}):r.jsx(BG,{...a,ref:e})})});hR.displayName=Fl;var FG=g.forwardRef((t,e)=>{const n=ya(Fl,t.__scopeDialog),s=g.useRef(null),a=Mt(e,n.contentRef,s);return g.useEffect(()=>{const i=s.current;if(i)return Dg(i)},[]),r.jsx(fR,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Te(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Te(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,c=o.button===0&&o.ctrlKey===!0;(o.button===2||c)&&i.preventDefault()}),onFocusOutside:Te(t.onFocusOutside,i=>i.preventDefault())})}),BG=g.forwardRef((t,e)=>{const n=ya(Fl,t.__scopeDialog),s=g.useRef(!1),a=g.useRef(!1);return r.jsx(fR,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,c;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(s.current||(c=n.triggerRef.current)==null||c.focus(),i.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:i=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),fR=g.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,...o}=t,c=ya(Fl,n),d=g.useRef(null),u=Mt(e,d);return Ag(),r.jsxs(r.Fragment,{children:[r.jsx(Sf,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:i,children:r.jsx(ql,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":Jj(c.open),...o,ref:u,onDismiss:()=>c.onOpenChange(!1)})}),r.jsxs(r.Fragment,{children:[r.jsx(zG,{titleId:c.titleId}),r.jsx(UG,{contentRef:d,descriptionId:c.descriptionId})]})]})}),Xj="DialogTitle",mR=g.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,a=ya(Xj,n);return r.jsx(Xe.h2,{id:a.titleId,...s,ref:e})});mR.displayName=Xj;var pR="DialogDescription",gR=g.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,a=ya(pR,n);return r.jsx(Xe.p,{id:a.descriptionId,...s,ref:e})});gR.displayName=pR;var xR="DialogClose",vR=g.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,a=ya(xR,n);return r.jsx(Xe.button,{type:"button",...s,ref:e,onClick:Te(t.onClick,()=>a.onOpenChange(!1))})});vR.displayName=xR;function Jj(t){return t?"open":"closed"}var yR="DialogTitleWarning",[uae,_R]=qL(yR,{contentName:Fl,titleName:Xj,docsSlug:"dialog"}),zG=({titleId:t})=>{const e=_R(yR),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return g.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},$G="DialogDescriptionWarning",UG=({contentRef:t,descriptionId:e})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${_R($G).contentName}}.`;return g.useEffect(()=>{var i;const a=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&a&&(document.getElementById(e)||console.warn(s))},[s,t,e]),null},qG=iR,WG=lR,HG=dR,wR=uR,bR=hR,jR=mR,NR=gR,VG=vR;const en=qG,KG=WG,ZG=HG,SR=g.forwardRef(({className:t,...e},n)=>r.jsx(wR,{ref:n,className:Oe("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));SR.displayName=wR.displayName;const Gt=g.forwardRef(({className:t,children:e,...n},s)=>r.jsxs(ZG,{children:[r.jsx(SR,{}),r.jsxs(bR,{ref:s,className:Oe("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,r.jsxs(VG,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[r.jsx(ar,{className:"h-4 w-4"}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Gt.displayName=bR.displayName;const rn=({className:t,...e})=>r.jsx("div",{className:Oe("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});rn.displayName="DialogHeader";const lh=({className:t,...e})=>r.jsx("div",{className:Oe("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});lh.displayName="DialogFooter";const sn=g.forwardRef(({className:t,...e},n)=>r.jsx(jR,{ref:n,className:Oe("text-lg font-semibold leading-none tracking-tight",t),...e}));sn.displayName=jR.displayName;const Xn=g.forwardRef(({className:t,...e},n)=>r.jsx(NR,{ref:n,className:Oe("text-sm text-muted-foreground",t),...e}));Xn.displayName=NR.displayName;function bw(t,[e,n]){return Math.min(n,Math.max(e,t))}function kR(t){const e=g.useRef({value:t,previous:t});return g.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var GG=[" ","Enter","ArrowUp","ArrowDown"],QG=[" ","Enter"],Cf="Select",[Tg,Mg,YG]=cf(Cf),[Kd,hae]=Ss(Cf,[YG,Uo]),Rg=Uo(),[XG,Ho]=Kd(Cf),[JG,eQ]=Kd(Cf),CR=t=>{const{__scopeSelect:e,children:n,open:s,defaultOpen:a,onOpenChange:i,value:o,defaultValue:c,onValueChange:d,dir:u,name:m,autoComplete:f,disabled:p,required:y,form:j}=t,v=Rg(e),[_,b]=g.useState(null),[w,N]=g.useState(null),[S,A]=g.useState(!1),E=Wd(u),[D=!1,M]=zs({prop:s,defaultProp:a,onChange:i}),[B,R]=zs({prop:o,defaultProp:c,onChange:d}),P=g.useRef(null),F=_?j||!!_.closest("form"):!0,[W,ee]=g.useState(new Set),ue=Array.from(W).map(de=>de.props.value).join(";");return r.jsx(Yb,{...v,children:r.jsxs(XG,{required:y,scope:e,trigger:_,onTriggerChange:b,valueNode:w,onValueNodeChange:N,valueNodeHasChildren:S,onValueNodeHasChildrenChange:A,contentId:ps(),value:B,onValueChange:R,open:D,onOpenChange:M,dir:E,triggerPointerDownPosRef:P,disabled:p,children:[r.jsx(Tg.Provider,{scope:e,children:r.jsx(JG,{scope:t.__scopeSelect,onNativeOptionAdd:g.useCallback(de=>{ee(Q=>new Set(Q).add(de))},[]),onNativeOptionRemove:g.useCallback(de=>{ee(Q=>{const z=new Set(Q);return z.delete(de),z})},[]),children:n})}),F?r.jsxs(XR,{"aria-hidden":!0,required:y,tabIndex:-1,name:m,autoComplete:f,value:B,onChange:de=>R(de.target.value),disabled:p,form:j,children:[B===void 0?r.jsx("option",{value:""}):null,Array.from(W)]},ue):null]})})};CR.displayName=Cf;var ER="SelectTrigger",AR=g.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:s=!1,...a}=t,i=Rg(n),o=Ho(ER,n),c=o.disabled||s,d=Mt(e,o.onTriggerChange),u=Mg(n),m=g.useRef("touch"),[f,p,y]=JR(v=>{const _=u().filter(N=>!N.disabled),b=_.find(N=>N.value===o.value),w=e3(_,v,b);w!==void 0&&o.onValueChange(w.value)}),j=v=>{c||(o.onOpenChange(!0),y()),v&&(o.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return r.jsx(gf,{asChild:!0,...i,children:r.jsx(Xe.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":YR(o.value)?"":void 0,...a,ref:d,onClick:Te(a.onClick,v=>{v.currentTarget.focus(),m.current!=="mouse"&&j(v)}),onPointerDown:Te(a.onPointerDown,v=>{m.current=v.pointerType;const _=v.target;_.hasPointerCapture(v.pointerId)&&_.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(j(v),v.preventDefault())}),onKeyDown:Te(a.onKeyDown,v=>{const _=f.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&p(v.key),!(_&&v.key===" ")&&GG.includes(v.key)&&(j(),v.preventDefault())})})})});AR.displayName=ER;var PR="SelectValue",DR=g.forwardRef((t,e)=>{const{__scopeSelect:n,className:s,style:a,children:i,placeholder:o="",...c}=t,d=Ho(PR,n),{onValueNodeHasChildrenChange:u}=d,m=i!==void 0,f=Mt(e,d.onValueNodeChange);return Un(()=>{u(m)},[u,m]),r.jsx(Xe.span,{...c,ref:f,style:{pointerEvents:"none"},children:YR(d.value)?r.jsx(r.Fragment,{children:o}):i})});DR.displayName=PR;var tQ="SelectIcon",TR=g.forwardRef((t,e)=>{const{__scopeSelect:n,children:s,...a}=t;return r.jsx(Xe.span,{"aria-hidden":!0,...a,ref:e,children:s||"▼"})});TR.displayName=tQ;var nQ="SelectPortal",MR=t=>r.jsx(Td,{asChild:!0,...t});MR.displayName=nQ;var Bl="SelectContent",RR=g.forwardRef((t,e)=>{const n=Ho(Bl,t.__scopeSelect),[s,a]=g.useState();if(Un(()=>{a(new DocumentFragment)},[]),!n.open){const i=s;return i?$o.createPortal(r.jsx(IR,{scope:t.__scopeSelect,children:r.jsx(Tg.Slot,{scope:t.__scopeSelect,children:r.jsx("div",{children:t.children})})}),i):null}return r.jsx(OR,{...t,ref:e})});RR.displayName=Bl;var Zs=10,[IR,Vo]=Kd(Bl),rQ="SelectContentImpl",OR=g.forwardRef((t,e)=>{const{__scopeSelect:n,position:s="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:c,sideOffset:d,align:u,alignOffset:m,arrowPadding:f,collisionBoundary:p,collisionPadding:y,sticky:j,hideWhenDetached:v,avoidCollisions:_,...b}=t,w=Ho(Bl,n),[N,S]=g.useState(null),[A,E]=g.useState(null),D=Mt(e,Z=>S(Z)),[M,B]=g.useState(null),[R,P]=g.useState(null),F=Mg(n),[W,ee]=g.useState(!1),ue=g.useRef(!1);g.useEffect(()=>{if(N)return Dg(N)},[N]),Ag();const de=g.useCallback(Z=>{const[ie,...pe]=F().map(me=>me.ref.current),[G]=pe.slice(-1),se=document.activeElement;for(const me of Z)if(me===se||(me==null||me.scrollIntoView({block:"nearest"}),me===ie&&A&&(A.scrollTop=0),me===G&&A&&(A.scrollTop=A.scrollHeight),me==null||me.focus(),document.activeElement!==se))return},[F,A]),Q=g.useCallback(()=>de([M,N]),[de,M,N]);g.useEffect(()=>{W&&Q()},[W,Q]);const{onOpenChange:z,triggerPointerDownPosRef:V}=w;g.useEffect(()=>{if(N){let Z={x:0,y:0};const ie=G=>{var se,me;Z={x:Math.abs(Math.round(G.pageX)-(((se=V.current)==null?void 0:se.x)??0)),y:Math.abs(Math.round(G.pageY)-(((me=V.current)==null?void 0:me.y)??0))}},pe=G=>{Z.x<=10&&Z.y<=10?G.preventDefault():N.contains(G.target)||z(!1),document.removeEventListener("pointermove",ie),V.current=null};return V.current!==null&&(document.addEventListener("pointermove",ie),document.addEventListener("pointerup",pe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ie),document.removeEventListener("pointerup",pe,{capture:!0})}}},[N,z,V]),g.useEffect(()=>{const Z=()=>z(!1);return window.addEventListener("blur",Z),window.addEventListener("resize",Z),()=>{window.removeEventListener("blur",Z),window.removeEventListener("resize",Z)}},[z]);const[U,O]=JR(Z=>{const ie=F().filter(se=>!se.disabled),pe=ie.find(se=>se.ref.current===document.activeElement),G=e3(ie,Z,pe);G&&setTimeout(()=>G.ref.current.focus())}),I=g.useCallback((Z,ie,pe)=>{const G=!ue.current&&!pe;(w.value!==void 0&&w.value===ie||G)&&(B(Z),G&&(ue.current=!0))},[w.value]),H=g.useCallback(()=>N==null?void 0:N.focus(),[N]),$=g.useCallback((Z,ie,pe)=>{const G=!ue.current&&!pe;(w.value!==void 0&&w.value===ie||G)&&P(Z)},[w.value]),te=s==="popper"?jw:LR,X=te===jw?{side:c,sideOffset:d,align:u,alignOffset:m,arrowPadding:f,collisionBoundary:p,collisionPadding:y,sticky:j,hideWhenDetached:v,avoidCollisions:_}:{};return r.jsx(IR,{scope:n,content:N,viewport:A,onViewportChange:E,itemRefCallback:I,selectedItem:M,onItemLeave:H,itemTextRefCallback:$,focusSelectedItem:Q,selectedItemText:R,position:s,isPositioned:W,searchRef:U,children:r.jsx(kf,{as:ji,allowPinchZoom:!0,children:r.jsx(Sf,{asChild:!0,trapped:w.open,onMountAutoFocus:Z=>{Z.preventDefault()},onUnmountAutoFocus:Te(a,Z=>{var ie;(ie=w.trigger)==null||ie.focus({preventScroll:!0}),Z.preventDefault()}),children:r.jsx(ql,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:Z=>Z.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:r.jsx(te,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:Z=>Z.preventDefault(),...b,...X,onPlaced:()=>ee(!0),ref:D,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:Te(b.onKeyDown,Z=>{const ie=Z.ctrlKey||Z.altKey||Z.metaKey;if(Z.key==="Tab"&&Z.preventDefault(),!ie&&Z.key.length===1&&O(Z.key),["ArrowUp","ArrowDown","Home","End"].includes(Z.key)){let G=F().filter(se=>!se.disabled).map(se=>se.ref.current);if(["ArrowUp","End"].includes(Z.key)&&(G=G.slice().reverse()),["ArrowUp","ArrowDown"].includes(Z.key)){const se=Z.target,me=G.indexOf(se);G=G.slice(me+1)}setTimeout(()=>de(G)),Z.preventDefault()}})})})})})})});OR.displayName=rQ;var sQ="SelectItemAlignedPosition",LR=g.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:s,...a}=t,i=Ho(Bl,n),o=Vo(Bl,n),[c,d]=g.useState(null),[u,m]=g.useState(null),f=Mt(e,D=>m(D)),p=Mg(n),y=g.useRef(!1),j=g.useRef(!0),{viewport:v,selectedItem:_,selectedItemText:b,focusSelectedItem:w}=o,N=g.useCallback(()=>{if(i.trigger&&i.valueNode&&c&&u&&v&&_&&b){const D=i.trigger.getBoundingClientRect(),M=u.getBoundingClientRect(),B=i.valueNode.getBoundingClientRect(),R=b.getBoundingClientRect();if(i.dir!=="rtl"){const se=R.left-M.left,me=B.left-se,he=D.left-me,xe=D.width+he,re=Math.max(xe,M.width),_e=window.innerWidth-Zs,be=bw(me,[Zs,Math.max(Zs,_e-re)]);c.style.minWidth=xe+"px",c.style.left=be+"px"}else{const se=M.right-R.right,me=window.innerWidth-B.right-se,he=window.innerWidth-D.right-me,xe=D.width+he,re=Math.max(xe,M.width),_e=window.innerWidth-Zs,be=bw(me,[Zs,Math.max(Zs,_e-re)]);c.style.minWidth=xe+"px",c.style.right=be+"px"}const P=p(),F=window.innerHeight-Zs*2,W=v.scrollHeight,ee=window.getComputedStyle(u),ue=parseInt(ee.borderTopWidth,10),de=parseInt(ee.paddingTop,10),Q=parseInt(ee.borderBottomWidth,10),z=parseInt(ee.paddingBottom,10),V=ue+de+W+z+Q,U=Math.min(_.offsetHeight*5,V),O=window.getComputedStyle(v),I=parseInt(O.paddingTop,10),H=parseInt(O.paddingBottom,10),$=D.top+D.height/2-Zs,te=F-$,X=_.offsetHeight/2,Z=_.offsetTop+X,ie=ue+de+Z,pe=V-ie;if(ie<=$){const se=P.length>0&&_===P[P.length-1].ref.current;c.style.bottom="0px";const me=u.clientHeight-v.offsetTop-v.offsetHeight,he=Math.max(te,X+(se?H:0)+me+Q),xe=ie+he;c.style.height=xe+"px"}else{const se=P.length>0&&_===P[0].ref.current;c.style.top="0px";const he=Math.max($,ue+v.offsetTop+(se?I:0)+X)+pe;c.style.height=he+"px",v.scrollTop=ie-$+v.offsetTop}c.style.margin=`${Zs}px 0`,c.style.minHeight=U+"px",c.style.maxHeight=F+"px",s==null||s(),requestAnimationFrame(()=>y.current=!0)}},[p,i.trigger,i.valueNode,c,u,v,_,b,i.dir,s]);Un(()=>N(),[N]);const[S,A]=g.useState();Un(()=>{u&&A(window.getComputedStyle(u).zIndex)},[u]);const E=g.useCallback(D=>{D&&j.current===!0&&(N(),w==null||w(),j.current=!1)},[N,w]);return r.jsx(iQ,{scope:n,contentWrapper:c,shouldExpandOnScrollRef:y,onScrollButtonChange:E,children:r.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:r.jsx(Xe.div,{...a,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});LR.displayName=sQ;var aQ="SelectPopperPosition",jw=g.forwardRef((t,e)=>{const{__scopeSelect:n,align:s="start",collisionPadding:a=Zs,...i}=t,o=Rg(n);return r.jsx(ng,{...o,...i,ref:e,align:s,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});jw.displayName=aQ;var[iQ,e1]=Kd(Bl,{}),Nw="SelectViewport",FR=g.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:s,...a}=t,i=Vo(Nw,n),o=e1(Nw,n),c=Mt(e,i.onViewportChange),d=g.useRef(0);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),r.jsx(Tg.Slot,{scope:n,children:r.jsx(Xe.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Te(a.onScroll,u=>{const m=u.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:p}=o;if(p!=null&&p.current&&f){const y=Math.abs(d.current-m.scrollTop);if(y>0){const j=window.innerHeight-Zs*2,v=parseFloat(f.style.minHeight),_=parseFloat(f.style.height),b=Math.max(v,_);if(b<j){const w=b+y,N=Math.min(j,w),S=w-N;f.style.height=N+"px",f.style.bottom==="0px"&&(m.scrollTop=S>0?S:0,f.style.justifyContent="flex-end")}}}d.current=m.scrollTop})})})]})});FR.displayName=Nw;var BR="SelectGroup",[oQ,lQ]=Kd(BR),cQ=g.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,a=ps();return r.jsx(oQ,{scope:n,id:a,children:r.jsx(Xe.div,{role:"group","aria-labelledby":a,...s,ref:e})})});cQ.displayName=BR;var zR="SelectLabel",$R=g.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,a=lQ(zR,n);return r.jsx(Xe.div,{id:a.id,...s,ref:e})});$R.displayName=zR;var j0="SelectItem",[dQ,UR]=Kd(j0),qR=g.forwardRef((t,e)=>{const{__scopeSelect:n,value:s,disabled:a=!1,textValue:i,...o}=t,c=Ho(j0,n),d=Vo(j0,n),u=c.value===s,[m,f]=g.useState(i??""),[p,y]=g.useState(!1),j=Mt(e,w=>{var N;return(N=d.itemRefCallback)==null?void 0:N.call(d,w,s,a)}),v=ps(),_=g.useRef("touch"),b=()=>{a||(c.onValueChange(s),c.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return r.jsx(dQ,{scope:n,value:s,disabled:a,textId:v,isSelected:u,onItemTextChange:g.useCallback(w=>{f(N=>N||((w==null?void 0:w.textContent)??"").trim())},[]),children:r.jsx(Tg.ItemSlot,{scope:n,value:s,disabled:a,textValue:m,children:r.jsx(Xe.div,{role:"option","aria-labelledby":v,"data-highlighted":p?"":void 0,"aria-selected":u&&p,"data-state":u?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...o,ref:j,onFocus:Te(o.onFocus,()=>y(!0)),onBlur:Te(o.onBlur,()=>y(!1)),onClick:Te(o.onClick,()=>{_.current!=="mouse"&&b()}),onPointerUp:Te(o.onPointerUp,()=>{_.current==="mouse"&&b()}),onPointerDown:Te(o.onPointerDown,w=>{_.current=w.pointerType}),onPointerMove:Te(o.onPointerMove,w=>{var N;_.current=w.pointerType,a?(N=d.onItemLeave)==null||N.call(d):_.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Te(o.onPointerLeave,w=>{var N;w.currentTarget===document.activeElement&&((N=d.onItemLeave)==null||N.call(d))}),onKeyDown:Te(o.onKeyDown,w=>{var S;((S=d.searchRef)==null?void 0:S.current)!==""&&w.key===" "||(QG.includes(w.key)&&b(),w.key===" "&&w.preventDefault())})})})})});qR.displayName=j0;var Bu="SelectItemText",WR=g.forwardRef((t,e)=>{const{__scopeSelect:n,className:s,style:a,...i}=t,o=Ho(Bu,n),c=Vo(Bu,n),d=UR(Bu,n),u=eQ(Bu,n),[m,f]=g.useState(null),p=Mt(e,b=>f(b),d.onItemTextChange,b=>{var w;return(w=c.itemTextRefCallback)==null?void 0:w.call(c,b,d.value,d.disabled)}),y=m==null?void 0:m.textContent,j=g.useMemo(()=>r.jsx("option",{value:d.value,disabled:d.disabled,children:y},d.value),[d.disabled,d.value,y]),{onNativeOptionAdd:v,onNativeOptionRemove:_}=u;return Un(()=>(v(j),()=>_(j)),[v,_,j]),r.jsxs(r.Fragment,{children:[r.jsx(Xe.span,{id:d.textId,...i,ref:p}),d.isSelected&&o.valueNode&&!o.valueNodeHasChildren?$o.createPortal(i.children,o.valueNode):null]})});WR.displayName=Bu;var HR="SelectItemIndicator",VR=g.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t;return UR(HR,n).isSelected?r.jsx(Xe.span,{"aria-hidden":!0,...s,ref:e}):null});VR.displayName=HR;var Sw="SelectScrollUpButton",KR=g.forwardRef((t,e)=>{const n=Vo(Sw,t.__scopeSelect),s=e1(Sw,t.__scopeSelect),[a,i]=g.useState(!1),o=Mt(e,s.onScrollButtonChange);return Un(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=d.scrollTop>0;i(u)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),a?r.jsx(GR,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});KR.displayName=Sw;var kw="SelectScrollDownButton",ZR=g.forwardRef((t,e)=>{const n=Vo(kw,t.__scopeSelect),s=e1(kw,t.__scopeSelect),[a,i]=g.useState(!1),o=Mt(e,s.onScrollButtonChange);return Un(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=d.scrollHeight-d.clientHeight,m=Math.ceil(d.scrollTop)<u;i(m)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),a?r.jsx(GR,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});ZR.displayName=kw;var GR=g.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:s,...a}=t,i=Vo("SelectScrollButton",n),o=g.useRef(null),c=Mg(n),d=g.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return g.useEffect(()=>()=>d(),[d]),Un(()=>{var m;const u=c().find(f=>f.ref.current===document.activeElement);(m=u==null?void 0:u.ref.current)==null||m.scrollIntoView({block:"nearest"})},[c]),r.jsx(Xe.div,{"aria-hidden":!0,...a,ref:e,style:{flexShrink:0,...a.style},onPointerDown:Te(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(s,50))}),onPointerMove:Te(a.onPointerMove,()=>{var u;(u=i.onItemLeave)==null||u.call(i),o.current===null&&(o.current=window.setInterval(s,50))}),onPointerLeave:Te(a.onPointerLeave,()=>{d()})})}),uQ="SelectSeparator",QR=g.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t;return r.jsx(Xe.div,{"aria-hidden":!0,...s,ref:e})});QR.displayName=uQ;var Cw="SelectArrow",hQ=g.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,a=Rg(n),i=Ho(Cw,n),o=Vo(Cw,n);return i.open&&o.position==="popper"?r.jsx(rg,{...a,...s,ref:e}):null});hQ.displayName=Cw;function YR(t){return t===""||t===void 0}var XR=g.forwardRef((t,e)=>{const{value:n,...s}=t,a=g.useRef(null),i=Mt(e,a),o=kR(n);return g.useEffect(()=>{const c=a.current,d=window.HTMLSelectElement.prototype,m=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==n&&m){const f=new Event("change",{bubbles:!0});m.call(c,n),c.dispatchEvent(f)}},[o,n]),r.jsx(df,{asChild:!0,children:r.jsx("select",{...s,ref:i,defaultValue:n})})});XR.displayName="BubbleSelect";function JR(t){const e=jn(t),n=g.useRef(""),s=g.useRef(0),a=g.useCallback(o=>{const c=n.current+o;e(c),function d(u){n.current=u,window.clearTimeout(s.current),u!==""&&(s.current=window.setTimeout(()=>d(""),1e3))}(c)},[e]),i=g.useCallback(()=>{n.current="",window.clearTimeout(s.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(s.current),[]),[n,a,i]}function e3(t,e,n){const a=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=fQ(t,Math.max(i,0));a.length===1&&(o=o.filter(u=>u!==n));const d=o.find(u=>u.textValue.toLowerCase().startsWith(a.toLowerCase()));return d!==n?d:void 0}function fQ(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var mQ=CR,t3=AR,pQ=DR,gQ=TR,xQ=MR,n3=RR,vQ=FR,r3=$R,s3=qR,yQ=WR,_Q=VR,a3=KR,i3=ZR,o3=QR;const vt=mQ,yt=pQ,pt=g.forwardRef(({className:t,children:e,...n},s)=>r.jsxs(t3,{ref:s,className:Oe("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,r.jsx(gQ,{asChild:!0,children:r.jsx(Y0,{className:"h-4 w-4 opacity-50"})})]}));pt.displayName=t3.displayName;const l3=g.forwardRef(({className:t,...e},n)=>r.jsx(a3,{ref:n,className:Oe("flex cursor-default items-center justify-center py-1",t),...e,children:r.jsx(RF,{className:"h-4 w-4"})}));l3.displayName=a3.displayName;const c3=g.forwardRef(({className:t,...e},n)=>r.jsx(i3,{ref:n,className:Oe("flex cursor-default items-center justify-center py-1",t),...e,children:r.jsx(Y0,{className:"h-4 w-4"})}));c3.displayName=i3.displayName;const gt=g.forwardRef(({className:t,children:e,position:n="popper",...s},a)=>r.jsx(xQ,{children:r.jsxs(n3,{ref:a,className:Oe("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...s,children:[r.jsx(l3,{}),r.jsx(vQ,{className:Oe("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),r.jsx(c3,{})]})}));gt.displayName=n3.displayName;const wQ=g.forwardRef(({className:t,...e},n)=>r.jsx(r3,{ref:n,className:Oe("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));wQ.displayName=r3.displayName;const ye=g.forwardRef(({className:t,children:e,...n},s)=>r.jsxs(s3,{ref:s,className:Oe("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(_Q,{children:r.jsx(hf,{className:"h-4 w-4"})})}),r.jsx(yQ,{children:e})]}));ye.displayName=s3.displayName;const bQ=g.forwardRef(({className:t,...e},n)=>r.jsx(o3,{ref:n,className:Oe("-mx-1 my-1 h-px bg-muted",t),...e}));bQ.displayName=o3.displayName;const jQ=({isOpen:t,onClose:e,onCustomerAdded:n})=>{const{toast:s}=Rt(),[a,i]=g.useState({company_name:"",anrede:"",first_name:"",last_name:"",contact_person:"",email:"",phone:"",mobile:"",fax:"",website:"",address:"",city:"",postal_code:"",country:"Deutschland",status:"Aktiv",customer_number:"",tax_number:"",zahlungsziel:"30",skonto_prozent:"",skonto_tage:"",waehrung:"EUR",preisgruppe:"Standard",iban:"",bic:"",bank_name:"",kontoinhaber:"",zugprd_status:"Inaktiv",benutzer_id:"",passwort:""}),o=d=>{if(d.preventDefault(),!a.company_name||!a.contact_person||!a.email){s({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)){s({title:"Fehler",description:"Bitte geben Sie eine gültige E-Mail-Adresse ein.",variant:"destructive"});return}n(a),i({company_name:"",anrede:"",first_name:"",last_name:"",contact_person:"",email:"",phone:"",mobile:"",fax:"",website:"",address:"",city:"",postal_code:"",country:"Deutschland",status:"Aktiv",customer_number:"",tax_number:"",zahlungsziel:"30",skonto_prozent:"",skonto_tage:"",waehrung:"EUR",preisgruppe:"Standard",iban:"",bic:"",bank_name:"",kontoinhaber:"",zugprd_status:"Inaktiv",benutzer_id:"",passwort:""}),e()},c=(d,u)=>{i(m=>({...m,[d]:u}))};return r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-6xl max-h-[95vh] overflow-y-auto",children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Neuen Kunden hinzufügen"}),r.jsx(Xn,{children:"Geben Sie die Informationen für den neuen Kunden ein."})]}),r.jsxs("form",{onSubmit:o,className:"space-y-6",children:[r.jsxs(zr,{defaultValue:"ansprechpartner",className:"w-full",children:[r.jsxs(Er,{className:"grid grid-cols-6 w-full",children:[r.jsx(Ge,{value:"ansprechpartner",children:"ANSPRECHPARTNER"}),r.jsx(Ge,{value:"kontaktdetails",children:"KONTAKTDETAILS"}),r.jsx(Ge,{value:"adresse",children:"ADRESSE"}),r.jsx(Ge,{value:"konditionen",children:"KONDITIONEN"}),r.jsx(Ge,{value:"zahlungsdaten",children:"ZAHLUNGSDATEN"}),r.jsx(Ge,{value:"zugprd",children:"ZUGPRD 2.0 STANDARD"})]}),r.jsxs(Qe,{value:"ansprechpartner",className:"space-y-4 mt-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"company_name",children:"Firmenname *"}),r.jsx(ne,{id:"company_name",value:a.company_name,onChange:d=>c("company_name",d.target.value),placeholder:"z.B. Mustermann GmbH",required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"customer_number",children:"Kundennummer"}),r.jsx(ne,{id:"customer_number",value:a.customer_number,onChange:d=>c("customer_number",d.target.value),placeholder:"AUTO"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"anrede",children:"Anrede"}),r.jsxs(vt,{value:a.anrede,onValueChange:d=>c("anrede",d),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Wählen..."})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Herr",children:"Herr"}),r.jsx(ye,{value:"Frau",children:"Frau"}),r.jsx(ye,{value:"Divers",children:"Divers"})]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"first_name",children:"Vorname"}),r.jsx(ne,{id:"first_name",value:a.first_name,onChange:d=>c("first_name",d.target.value),placeholder:"Max"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"last_name",children:"Nachname"}),r.jsx(ne,{id:"last_name",value:a.last_name,onChange:d=>c("last_name",d.target.value),placeholder:"Mustermann"})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"contact_person",children:"Ansprechpartner *"}),r.jsx(ne,{id:"contact_person",value:a.contact_person,onChange:d=>c("contact_person",d.target.value),placeholder:"z.B. Max Mustermann",required:!0})]})]}),r.jsxs(Qe,{value:"kontaktdetails",className:"space-y-4 mt-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"email",children:"E-Mail *"}),r.jsx(ne,{id:"email",type:"email",value:a.email,onChange:d=>c("email",d.target.value),placeholder:"kontakt@firma.de",required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"website",children:"Website"}),r.jsx(ne,{id:"website",value:a.website,onChange:d=>c("website",d.target.value),placeholder:"www.firma.de"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"phone",children:"Telefon"}),r.jsx(ne,{id:"phone",value:a.phone,onChange:d=>c("phone",d.target.value),placeholder:"+49 123 456789"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"mobile",children:"Mobil"}),r.jsx(ne,{id:"mobile",value:a.mobile,onChange:d=>c("mobile",d.target.value),placeholder:"+49 123 456789"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"fax",children:"Fax"}),r.jsx(ne,{id:"fax",value:a.fax,onChange:d=>c("fax",d.target.value),placeholder:"+49 123 456789"})]})]})]}),r.jsxs(Qe,{value:"adresse",className:"space-y-4 mt-6",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"address",children:"Straße und Hausnummer"}),r.jsx(ne,{id:"address",value:a.address,onChange:d=>c("address",d.target.value),placeholder:"Musterstraße 123"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"postal_code",children:"PLZ"}),r.jsx(ne,{id:"postal_code",value:a.postal_code,onChange:d=>c("postal_code",d.target.value),placeholder:"12345"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"city",children:"Ort"}),r.jsx(ne,{id:"city",value:a.city,onChange:d=>c("city",d.target.value),placeholder:"Berlin"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"country",children:"Land"}),r.jsx(ne,{id:"country",value:a.country,onChange:d=>c("country",d.target.value),placeholder:"Deutschland"})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"tax_number",children:"Steuernummer"}),r.jsx(ne,{id:"tax_number",value:a.tax_number,onChange:d=>c("tax_number",d.target.value),placeholder:"123/456/78910"})]})]}),r.jsxs(Qe,{value:"konditionen",className:"space-y-4 mt-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"zahlungsziel",children:"Zahlungsziel (Tage)"}),r.jsxs(vt,{value:a.zahlungsziel,onValueChange:d=>c("zahlungsziel",d),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"14",children:"14 Tage"}),r.jsx(ye,{value:"30",children:"30 Tage"}),r.jsx(ye,{value:"60",children:"60 Tage"}),r.jsx(ye,{value:"90",children:"90 Tage"})]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"waehrung",children:"Währung"}),r.jsxs(vt,{value:a.waehrung,onValueChange:d=>c("waehrung",d),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"EUR",children:"EUR"}),r.jsx(ye,{value:"USD",children:"USD"}),r.jsx(ye,{value:"GBP",children:"GBP"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"skonto_prozent",children:"Skonto %"}),r.jsx(ne,{id:"skonto_prozent",value:a.skonto_prozent,onChange:d=>c("skonto_prozent",d.target.value),placeholder:"2"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"skonto_tage",children:"Skonto Tage"}),r.jsx(ne,{id:"skonto_tage",value:a.skonto_tage,onChange:d=>c("skonto_tage",d.target.value),placeholder:"10"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"preisgruppe",children:"Preisgruppe"}),r.jsxs(vt,{value:a.preisgruppe,onValueChange:d=>c("preisgruppe",d),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Standard",children:"Standard"}),r.jsx(ye,{value:"Premium",children:"Premium"}),r.jsx(ye,{value:"VIP",children:"VIP"})]})]})]})]})]}),r.jsxs(Qe,{value:"zahlungsdaten",className:"space-y-4 mt-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"iban",children:"IBAN"}),r.jsx(ne,{id:"iban",value:a.iban,onChange:d=>c("iban",d.target.value),placeholder:"DE89 3704 0044 0532 0130 00"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"bic",children:"BIC"}),r.jsx(ne,{id:"bic",value:a.bic,onChange:d=>c("bic",d.target.value),placeholder:"COBADEFFXXX"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"bank_name",children:"Bank"}),r.jsx(ne,{id:"bank_name",value:a.bank_name,onChange:d=>c("bank_name",d.target.value),placeholder:"Commerzbank AG"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"kontoinhaber",children:"Kontoinhaber"}),r.jsx(ne,{id:"kontoinhaber",value:a.kontoinhaber,onChange:d=>c("kontoinhaber",d.target.value),placeholder:"Mustermann GmbH"})]})]})]}),r.jsxs(Qe,{value:"zugprd",className:"space-y-4 mt-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"zugprd_status",children:"Status"}),r.jsxs(vt,{value:a.zugprd_status,onValueChange:d=>c("zugprd_status",d),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Aktiv",children:"Aktiv"}),r.jsx(ye,{value:"Inaktiv",children:"Inaktiv"})]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"status",children:"Kundenstatus"}),r.jsxs(vt,{value:a.status,onValueChange:d=>c("status",d),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Aktiv",children:"Aktiv"}),r.jsx(ye,{value:"Premium",children:"Premium"}),r.jsx(ye,{value:"Inaktiv",children:"Inaktiv"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"benutzer_id",children:"Benutzer-ID"}),r.jsx(ne,{id:"benutzer_id",value:a.benutzer_id,onChange:d=>c("benutzer_id",d.target.value),placeholder:"user123"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"passwort",children:"Passwort"}),r.jsx(ne,{id:"passwort",type:"password",value:a.passwort,onChange:d=>c("passwort",d.target.value),placeholder:"••••••••"})]})]})]})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(J,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),r.jsx(J,{type:"submit",className:"flex-1",children:"Kunde hinzufügen"})]})]})]})})},En=g.forwardRef(({className:t,...e},n)=>r.jsx("textarea",{className:Oe("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));En.displayName="Textarea";const NQ=({isOpen:t,onClose:e,customer:n,onCustomerUpdated:s})=>{const{toast:a}=Rt(),i=EZ(),[o,c]=g.useState({company_name:(n==null?void 0:n.company_name)||"",contact_person:(n==null?void 0:n.contact_person)||"",email:(n==null?void 0:n.email)||"",phone:(n==null?void 0:n.phone)||"",address:(n==null?void 0:n.address)||"",city:(n==null?void 0:n.city)||"",postal_code:(n==null?void 0:n.postal_code)||"",country:(n==null?void 0:n.country)||"Deutschland",status:(n==null?void 0:n.status)||"Aktiv",anrede:(n==null?void 0:n.anrede)||"",first_name:(n==null?void 0:n.first_name)||"",last_name:(n==null?void 0:n.last_name)||"",mobile:(n==null?void 0:n.mobile)||"",website:(n==null?void 0:n.website)||"",erreichbarkeit:(n==null?void 0:n.erreichbarkeit)||"",sonstiges:(n==null?void 0:n.sonstiges)||"",festnetz:(n==null?void 0:n.festnetz)||"",fax:(n==null?void 0:n.fax)||"",zahlungsziel:(n==null?void 0:n.zahlungsziel)||"",skonto:(n==null?void 0:n.skonto)||"",skontofrist:(n==null?void 0:n.skontofrist)||"",verkaufspreise_gruppe:(n==null?void 0:n.verkaufspreise_gruppe)||"",iban:(n==null?void 0:n.iban)||"",bic:(n==null?void 0:n.bic)||"",bank_name:(n==null?void 0:n.bank_name)||"",umsatzsteuer_id:(n==null?void 0:n.umsatzsteuer_id)||"",debitor_konto:(n==null?void 0:n.debitor_konto)||""});ke.useEffect(()=>{n&&c({company_name:n.company_name,contact_person:n.contact_person,email:n.email,phone:n.phone||"",address:n.address||"",city:n.city||"",postal_code:n.postal_code||"",country:n.country||"Deutschland",status:n.status,anrede:n.anrede||"",first_name:n.first_name||"",last_name:n.last_name||"",mobile:n.mobile||"",website:n.website||"",erreichbarkeit:n.erreichbarkeit||"",sonstiges:n.sonstiges||"",festnetz:n.festnetz||"",fax:n.fax||"",zahlungsziel:n.zahlungsziel||"",skonto:n.skonto||"",skontofrist:n.skontofrist||"",verkaufspreise_gruppe:n.verkaufspreise_gruppe||"",iban:n.iban||"",bic:n.bic||"",bank_name:n.bank_name||"",umsatzsteuer_id:n.umsatzsteuer_id||"",debitor_konto:n.debitor_konto||""})},[n]);const d=f=>{if(f.preventDefault(),!n)return;if(!o.company_name||!o.contact_person||!o.email){a({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)){a({title:"Fehler",description:"Bitte geben Sie eine gültige E-Mail-Adresse ein.",variant:"destructive"});return}const y={...n,...o};s(y),e()},u=(f,p)=>{c(y=>({...y,[f]:p}))},m=()=>{n&&window.confirm(`Möchten Sie den Kunden "${n.company_name}" wirklich löschen?`)&&i.mutate(n.id,{onSuccess:()=>{a({title:"Kunde gelöscht",description:`${n.company_name} wurde erfolgreich gelöscht.`}),e()},onError:f=>{a({title:"Fehler beim Löschen",description:f.message,variant:"destructive"})}})};return n?r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-7xl h-[45vh] overflow-y-auto",children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Kunde bearbeiten"}),r.jsx(Xn,{children:"Bearbeiten Sie die Informationen für den Kunden."})]}),r.jsxs("form",{onSubmit:d,className:"space-y-4",children:[r.jsxs(zr,{defaultValue:"kontaktdetails",className:"w-full",children:[r.jsxs(Er,{className:"grid w-full grid-cols-6 h-12",children:[r.jsx(Ge,{value:"ansprechpartner",children:"ANSPRECHPARTNER"}),r.jsx(Ge,{value:"kontaktdetails",children:"KONTAKTDETAILS"}),r.jsx(Ge,{value:"adresse",children:"ADRESSE"}),r.jsx(Ge,{value:"konditionen",children:"KONDITIONEN"}),r.jsx(Ge,{value:"zahlungsdaten",children:"ZAHLUNGSDATEN"}),r.jsx(Ge,{value:"zugprd",children:"ZUGPRD 2.0 STANDARD"})]}),r.jsxs(Qe,{value:"ansprechpartner",className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"anrede",children:"Anrede"}),r.jsxs(vt,{value:o.anrede,onValueChange:f=>u("anrede",f),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Anrede wählen"})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Herr",children:"Herr"}),r.jsx(ye,{value:"Frau",children:"Frau"}),r.jsx(ye,{value:"Divers",children:"Divers"})]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"company_name",children:"Firmenname *"}),r.jsx(ne,{id:"company_name",value:o.company_name,onChange:f=>u("company_name",f.target.value),required:!0})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"first_name",children:"Vorname"}),r.jsx(ne,{id:"first_name",value:o.first_name,onChange:f=>u("first_name",f.target.value)})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"last_name",children:"Nachname"}),r.jsx(ne,{id:"last_name",value:o.last_name,onChange:f=>u("last_name",f.target.value)})]})]})]}),r.jsxs(Qe,{value:"kontaktdetails",className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"email",children:"Emailadresse *"}),r.jsx(ne,{id:"email",type:"email",value:o.email,onChange:f=>u("email",f.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"mobile",children:"Mobiltelefon"}),r.jsx(ne,{id:"mobile",value:o.mobile,onChange:f=>u("mobile",f.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"erreichbarkeit",children:"Erreichbarkeit"}),r.jsx(En,{id:"erreichbarkeit",value:o.erreichbarkeit,onChange:f=>u("erreichbarkeit",f.target.value),rows:2})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"website",children:"Website"}),r.jsx(ne,{id:"website",value:o.website,onChange:f=>u("website",f.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"sonstiges",children:"Sonstiges"}),r.jsxs(vt,{value:o.sonstiges,onValueChange:f=>u("sonstiges",f),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Sonstiges wählen"})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Standard",children:"Standard"}),r.jsx(ye,{value:"VIP",children:"VIP"}),r.jsx(ye,{value:"Premium",children:"Premium"})]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"festnetz",children:"Festnetz"}),r.jsx(ne,{id:"festnetz",value:o.festnetz,onChange:f=>u("festnetz",f.target.value)})]})]}),r.jsx("div",{className:"grid grid-cols-2 gap-4",children:r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"fax",children:"Fax"}),r.jsx(ne,{id:"fax",value:o.fax,onChange:f=>u("fax",f.target.value)})]})})]}),r.jsxs(Qe,{value:"adresse",className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"address",children:"Straße & Hausnummer"}),r.jsx(ne,{id:"address",value:o.address,onChange:f=>u("address",f.target.value)})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"postal_code",children:"Postleitzahl"}),r.jsx(ne,{id:"postal_code",value:o.postal_code,onChange:f=>u("postal_code",f.target.value)})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"city",children:"Ort"}),r.jsx(ne,{id:"city",value:o.city,onChange:f=>u("city",f.target.value)})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"country",children:"Land"}),r.jsx(ne,{id:"country",value:o.country,onChange:f=>u("country",f.target.value)})]})]})]}),r.jsxs(Qe,{value:"konditionen",className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"zahlungsziel",children:"Zahlungsziel (Tage)"}),r.jsx(ne,{id:"zahlungsziel",value:o.zahlungsziel,onChange:f=>u("zahlungsziel",f.target.value)})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"skonto",children:"Skonto %"}),r.jsx(ne,{id:"skonto",value:o.skonto,onChange:f=>u("skonto",f.target.value)})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"skontofrist",children:"Skontofrist (Tage)"}),r.jsx(ne,{id:"skontofrist",value:o.skontofrist,onChange:f=>u("skontofrist",f.target.value)})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"verkaufspreise_gruppe",children:"Verkaufspreise-Gruppe"}),r.jsxs(vt,{value:o.verkaufspreise_gruppe,onValueChange:f=>u("verkaufspreise_gruppe",f),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Gruppe wählen"})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Standard-VK",children:"Standard-VK"}),r.jsx(ye,{value:"Premium-VK",children:"Premium-VK"}),r.jsx(ye,{value:"Großkunden-VK",children:"Großkunden-VK"})]})]})]})]}),r.jsxs(Qe,{value:"zahlungsdaten",className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"iban",children:"IBAN"}),r.jsx(ne,{id:"iban",value:o.iban,onChange:f=>u("iban",f.target.value)})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"bic",children:"BIC"}),r.jsx(ne,{id:"bic",value:o.bic,onChange:f=>u("bic",f.target.value)})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"bank_name",children:"Bank Name"}),r.jsx(ne,{id:"bank_name",value:o.bank_name,onChange:f=>u("bank_name",f.target.value)})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"umsatzsteuer_id",children:"Umsatzsteuer ID"}),r.jsx(ne,{id:"umsatzsteuer_id",value:o.umsatzsteuer_id,onChange:f=>u("umsatzsteuer_id",f.target.value)})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"debitor_konto",children:"Debitor / Kreditor Konto"}),r.jsx(ne,{id:"debitor_konto",value:o.debitor_konto,onChange:f=>u("debitor_konto",f.target.value)})]})]})]}),r.jsx(Qe,{value:"zugprd",className:"space-y-4",children:r.jsx("div",{className:"text-muted-foreground text-sm",children:"Diese Information ist erforderlich, um Rechnungen zu ZUGFeRD 2.0 Standard zu erstellen. Dieser Standard ist verpflichtend für die Rechnungsstellung an öffentliche Behörden/Auftraggeber."})})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(J,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),r.jsxs(J,{type:"button",variant:"destructive",onClick:m,disabled:i.isPending,className:"flex items-center gap-2",children:[r.jsx(Ua,{className:"h-4 w-4"}),i.isPending?"Lösche...":"Löschen"]}),r.jsx(J,{type:"submit",className:"flex-1",children:"Speichern"})]})]})]})}):null},SQ=()=>{const[t,e]=g.useState(""),[n,s]=g.useState(!1),[a,i]=g.useState(!1),[o,c]=g.useState(null),{data:d,isLoading:u,error:m}=HM(void 0,t.length>=2?{search:t}:void 0),f=kZ(),p=CZ(),y=(d==null?void 0:d.items)||[],j=[{id:"A2024-001",customer:"Müller GmbH",project:"Büroerweiterung",amount:"€12.500",status:"In Bearbeitung",date:"15.01.2024"},{id:"A2024-002",customer:"Schmidt AG",project:"Werkshalle Elektrik",amount:"€8.750",status:"Abgeschlossen",date:"10.01.2024"},{id:"A2024-003",customer:"Weber Bau",project:"Wohnanlage Phase 2",amount:"€28.900",status:"Angebot",date:"20.01.2024"}],v=E=>{switch(E){case"Aktiv":return"bg-green-100 text-green-800";case"Premium":return"bg-blue-100 text-blue-800";case"Inaktiv":return"bg-gray-100 text-gray-800";case"In Bearbeitung":return"bg-yellow-100 text-yellow-800";case"Abgeschlossen":return"bg-green-100 text-green-800";case"Angebot":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},_=async E=>{f.mutate(E)},b=E=>{c(E),i(!0)},w=async E=>{if(!o)return;const{id:D,created_at:M,updated_at:B,...R}=E;p.mutate({id:o.id,data:R})},N=E=>{alert(`Details für ${E.company_name}:

Kontakt: ${E.contact_person}
E-Mail: ${E.email}
Status: ${E.status}`)},S=t.length>=2?y:y.filter(E=>E.company_name.toLowerCase().includes(t.toLowerCase())||E.contact_person.toLowerCase().includes(t.toLowerCase())||E.email.toLowerCase().includes(t.toLowerCase())),A=E=>[E.address,E.postal_code,E.city,E.country].filter(Boolean).join(", ");return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Kunden & Aufträge"}),r.jsxs(J,{onClick:()=>s(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Neuer Kunde"]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Aktive Kunden"}),r.jsx("p",{className:"text-2xl font-bold",children:y.filter(E=>E.status==="Aktiv").length})]}),r.jsx(Si,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Premium Kunden"}),r.jsx("p",{className:"text-2xl font-bold",children:y.filter(E=>E.status==="Premium").length})]}),r.jsx(mf,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Neue diesen Monat"}),r.jsx("p",{className:"text-2xl font-bold",children:"0"})]}),r.jsx(Ao,{className:"h-8 w-8 text-purple-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Gesamt Umsatz"}),r.jsx("p",{className:"text-2xl font-bold",children:"€0"})]}),r.jsx(hs,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})})]}),r.jsxs(zr,{defaultValue:"customers",className:"space-y-6",children:[r.jsxs(Er,{className:"grid w-full grid-cols-3",children:[r.jsx(Ge,{value:"customers",children:"Kundenstamm"}),r.jsx(Ge,{value:"orders",children:"Aufträge"}),r.jsx(Ge,{value:"offers",children:"Angebote"})]}),r.jsxs(Qe,{value:"customers",className:"space-y-4",children:[r.jsx(le,{className:"shadow-soft rounded-2xl overflow-hidden",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(Rd,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),r.jsx(ne,{placeholder:"Kunde suchen...",value:t,onChange:E=>e(E.target.value),className:"pl-10 rounded-xl"})]}),r.jsx(J,{variant:"outline",className:"rounded-xl",children:"Filter"})]})})}),u?r.jsx("div",{className:"grid gap-4",children:Array(3).fill(0).map((E,D)=>r.jsx(le,{children:r.jsx(ce,{className:"p-6",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(lt,{className:"h-5 w-32"}),r.jsx(lt,{className:"h-6 w-16"})]}),r.jsx(lt,{className:"h-4 w-24 mb-3"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx(lt,{className:"h-4 w-28"}),r.jsx(lt,{className:"h-4 w-36"}),r.jsx(lt,{className:"h-4 w-40"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(lt,{className:"h-8 w-20"}),r.jsx(lt,{className:"h-8 w-24"})]})]})})},D))}):m?r.jsx(le,{children:r.jsx(ce,{className:"p-6 text-center",children:r.jsxs("p",{className:"text-red-500",children:["Fehler beim Laden der Kunden: ",m.message]})})}):r.jsx("div",{className:"grid gap-4",children:S.length===0?r.jsx(le,{children:r.jsx(ce,{className:"p-6 text-center",children:r.jsx("p",{className:"text-gray-500",children:t?"Keine Kunden gefunden.":"Noch keine Kunden vorhanden."})})}):S.map(E=>r.jsx(le,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h3",{className:"text-base font-semibold",children:E.company_name}),r.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${v(E.status)}`,children:E.status})]}),r.jsx("p",{className:"text-gray-600 mb-3",children:E.contact_person}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Md,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{children:E.phone||"Nicht angegeben"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(sr,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{children:E.email})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(sa,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{children:A(E)||"Nicht angegeben"})]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"0"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Projekte"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:"€0"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Umsatz"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(J,{size:"sm",variant:"outline",className:"rounded-xl",onClick:D=>{D.preventDefault(),D.stopPropagation(),N(E)},children:"Details"}),r.jsx(J,{size:"sm",className:"rounded-xl",onClick:()=>b(E),children:"Bearbeiten"})]})]})]})})},E.id))})]}),r.jsx(Qe,{value:"orders",className:"space-y-6",children:r.jsx("div",{className:"grid gap-4",children:j.map(E=>r.jsx(le,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h3",{className:"text-base font-semibold",children:E.id}),r.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${v(E.status)}`,children:E.status})]}),r.jsx("p",{className:"text-gray-600 mb-1",children:E.customer}),r.jsx("p",{className:"text-sm text-gray-500",children:E.project})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-xl font-bold text-green-600",children:E.amount}),r.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[r.jsx(zt,{className:"h-4 w-4"}),E.date]}),r.jsx("div",{className:"flex gap-2 mt-2",children:r.jsxs(J,{size:"sm",variant:"outline",className:"rounded-xl",children:[r.jsx(On,{className:"h-4 w-4 mr-1"}),"Details"]})})]})]})})},E.id))})}),r.jsx(Qe,{value:"offers",className:"space-y-4",children:r.jsxs(le,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsxs(Ce,{className:"pb-2",children:[r.jsx(Ee,{children:"Angebote erstellen"}),r.jsx(Sr,{children:"Neue Angebote für Ihre Kunden erstellen"})]}),r.jsxs(ce,{children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"customer",children:"Kunde auswählen"}),r.jsx(ne,{id:"customer",placeholder:"Kunde eingeben oder auswählen"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"project",children:"Projekt"}),r.jsx(ne,{id:"project",placeholder:"Projektbezeichnung"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"amount",children:"Angebotssumme"}),r.jsx(ne,{id:"amount",placeholder:"€ 0,00"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"deadline",children:"Gültig bis"}),r.jsx(ne,{id:"deadline",type:"date"})]})]}),r.jsxs("div",{className:"flex gap-2 mt-6",children:[r.jsxs(J,{className:"rounded-xl",children:[r.jsx(On,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),r.jsx(J,{variant:"outline",className:"rounded-xl",children:"Vorlage laden"})]})]})]})})]}),r.jsx(jQ,{isOpen:n,onClose:()=>s(!1),onCustomerAdded:_}),r.jsx(NQ,{isOpen:a,onClose:()=>i(!1),customer:o,onCustomerUpdated:w})]})};var t1="Checkbox",[kQ,fae]=Ss(t1),[CQ,EQ]=kQ(t1),d3=g.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:s,checked:a,defaultChecked:i,required:o,disabled:c,value:d="on",onCheckedChange:u,form:m,...f}=t,[p,y]=g.useState(null),j=Mt(e,S=>y(S)),v=g.useRef(!1),_=p?m||!!p.closest("form"):!0,[b=!1,w]=zs({prop:a,defaultProp:i,onChange:u}),N=g.useRef(b);return g.useEffect(()=>{const S=p==null?void 0:p.form;if(S){const A=()=>w(N.current);return S.addEventListener("reset",A),()=>S.removeEventListener("reset",A)}},[p,w]),r.jsxs(CQ,{scope:n,state:b,disabled:c,children:[r.jsx(Xe.button,{type:"button",role:"checkbox","aria-checked":So(b)?"mixed":b,"aria-required":o,"data-state":f3(b),"data-disabled":c?"":void 0,disabled:c,value:d,...f,ref:j,onKeyDown:Te(t.onKeyDown,S=>{S.key==="Enter"&&S.preventDefault()}),onClick:Te(t.onClick,S=>{w(A=>So(A)?!0:!A),_&&(v.current=S.isPropagationStopped(),v.current||S.stopPropagation())})}),_&&r.jsx(AQ,{control:p,bubbles:!v.current,name:s,value:d,checked:b,required:o,disabled:c,form:m,style:{transform:"translateX(-100%)"},defaultChecked:So(i)?!1:i})]})});d3.displayName=t1;var u3="CheckboxIndicator",h3=g.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:s,...a}=t,i=EQ(u3,n);return r.jsx(Jn,{present:s||So(i.state)||i.state===!0,children:r.jsx(Xe.span,{"data-state":f3(i.state),"data-disabled":i.disabled?"":void 0,...a,ref:e,style:{pointerEvents:"none",...t.style}})})});h3.displayName=u3;var AQ=t=>{const{control:e,checked:n,bubbles:s=!0,defaultChecked:a,...i}=t,o=g.useRef(null),c=kR(n),d=pP(e);g.useEffect(()=>{const m=o.current,f=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(f,"checked").set;if(c!==n&&y){const j=new Event("click",{bubbles:s});m.indeterminate=So(n),y.call(m,So(n)?!1:n),m.dispatchEvent(j)}},[c,n,s]);const u=g.useRef(So(n)?!1:n);return r.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??u.current,...i,tabIndex:-1,ref:o,style:{...t.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function So(t){return t==="indeterminate"}function f3(t){return So(t)?"indeterminate":t?"checked":"unchecked"}var m3=d3,PQ=h3;const Wa=g.forwardRef(({className:t,...e},n)=>r.jsx(m3,{ref:n,className:Oe("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:r.jsx(PQ,{className:Oe("flex items-center justify-center text-current"),children:r.jsx(hf,{className:"h-4 w-4"})})}));Wa.displayName=m3.displayName;var n1="Popover",[p3,mae]=Ss(n1,[Uo]),Ef=Uo(),[DQ,Ko]=p3(n1),g3=t=>{const{__scopePopover:e,children:n,open:s,defaultOpen:a,onOpenChange:i,modal:o=!1}=t,c=Ef(e),d=g.useRef(null),[u,m]=g.useState(!1),[f=!1,p]=zs({prop:s,defaultProp:a,onChange:i});return r.jsx(Yb,{...c,children:r.jsx(DQ,{scope:e,contentId:ps(),triggerRef:d,open:f,onOpenChange:p,onOpenToggle:g.useCallback(()=>p(y=>!y),[p]),hasCustomAnchor:u,onCustomAnchorAdd:g.useCallback(()=>m(!0),[]),onCustomAnchorRemove:g.useCallback(()=>m(!1),[]),modal:o,children:n})})};g3.displayName=n1;var x3="PopoverAnchor",TQ=g.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,a=Ko(x3,n),i=Ef(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:c}=a;return g.useEffect(()=>(o(),()=>c()),[o,c]),r.jsx(gf,{...i,...s,ref:e})});TQ.displayName=x3;var v3="PopoverTrigger",y3=g.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,a=Ko(v3,n),i=Ef(n),o=Mt(e,a.triggerRef),c=r.jsx(Xe.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":N3(a.open),...s,ref:o,onClick:Te(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?c:r.jsx(gf,{asChild:!0,...i,children:c})});y3.displayName=v3;var r1="PopoverPortal",[MQ,RQ]=p3(r1,{forceMount:void 0}),_3=t=>{const{__scopePopover:e,forceMount:n,children:s,container:a}=t,i=Ko(r1,e);return r.jsx(MQ,{scope:e,forceMount:n,children:r.jsx(Jn,{present:n||i.open,children:r.jsx(Td,{asChild:!0,container:a,children:s})})})};_3.displayName=r1;var Nd="PopoverContent",w3=g.forwardRef((t,e)=>{const n=RQ(Nd,t.__scopePopover),{forceMount:s=n.forceMount,...a}=t,i=Ko(Nd,t.__scopePopover);return r.jsx(Jn,{present:s||i.open,children:i.modal?r.jsx(IQ,{...a,ref:e}):r.jsx(OQ,{...a,ref:e})})});w3.displayName=Nd;var IQ=g.forwardRef((t,e)=>{const n=Ko(Nd,t.__scopePopover),s=g.useRef(null),a=Mt(e,s),i=g.useRef(!1);return g.useEffect(()=>{const o=s.current;if(o)return Dg(o)},[]),r.jsx(kf,{as:ji,allowPinchZoom:!0,children:r.jsx(b3,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Te(t.onCloseAutoFocus,o=>{var c;o.preventDefault(),i.current||(c=n.triggerRef.current)==null||c.focus()}),onPointerDownOutside:Te(t.onPointerDownOutside,o=>{const c=o.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:Te(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),OQ=g.forwardRef((t,e)=>{const n=Ko(Nd,t.__scopePopover),s=g.useRef(!1),a=g.useRef(!1);return r.jsx(b3,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,c;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(s.current||(c=n.triggerRef.current)==null||c.focus(),i.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:i=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),b3=g.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:m,...f}=t,p=Ko(Nd,n),y=Ef(n);return Ag(),r.jsx(Sf,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:i,children:r.jsx(ql,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:m,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onDismiss:()=>p.onOpenChange(!1),children:r.jsx(ng,{"data-state":N3(p.open),role:"dialog",id:p.contentId,...y,...f,ref:e,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),j3="PopoverClose",LQ=g.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,a=Ko(j3,n);return r.jsx(Xe.button,{type:"button",...s,ref:e,onClick:Te(t.onClick,()=>a.onOpenChange(!1))})});LQ.displayName=j3;var FQ="PopoverArrow",BQ=g.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,a=Ef(n);return r.jsx(rg,{...a,...s,ref:e})});BQ.displayName=FQ;function N3(t){return t?"open":"closed"}var zQ=g3,$Q=y3,UQ=_3,S3=w3;const Ha=zQ,Va=$Q,da=g.forwardRef(({className:t,align:e="center",sideOffset:n=4,...s},a)=>r.jsx(UQ,{children:r.jsx(S3,{ref:a,align:e,sideOffset:n,className:Oe("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));da.displayName=S3.displayName;function Ut(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function ws(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function mr(t,e){const n=Ut(t);return isNaN(e)?ws(t,NaN):(e&&n.setDate(n.getDate()+e),n)}function bs(t,e){const n=Ut(t);if(isNaN(e))return ws(t,NaN);if(!e)return n;const s=n.getDate(),a=ws(t,n.getTime());a.setMonth(n.getMonth()+e+1,0);const i=a.getDate();return s>=i?a:(n.setFullYear(a.getFullYear(),a.getMonth(),s),n)}const s1=6048e5,qQ=864e5,a1=6e4,k3=36e5;let WQ={};function Af(){return WQ}function xa(t,e){var c,d,u,m;const n=Af(),s=(e==null?void 0:e.weekStartsOn)??((d=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??n.weekStartsOn??((m=(u=n.locale)==null?void 0:u.options)==null?void 0:m.weekStartsOn)??0,a=Ut(t),i=a.getDay(),o=(i<s?7:0)+i-s;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function zl(t){return xa(t,{weekStartsOn:1})}function C3(t){const e=Ut(t),n=e.getFullYear(),s=ws(t,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=zl(s),i=ws(t,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const o=zl(i);return e.getTime()>=a.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function Sd(t){const e=Ut(t);return e.setHours(0,0,0,0),e}function N0(t){const e=Ut(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function Ba(t,e){const n=Sd(t),s=Sd(e),a=+n-N0(n),i=+s-N0(s);return Math.round((a-i)/qQ)}function HQ(t){const e=C3(t),n=ws(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),zl(n)}function Kh(t,e){const n=e*7;return mr(t,n)}function VQ(t,e){return bs(t,e*12)}function KQ(t){let e;return t.forEach(function(n){const s=Ut(n);(e===void 0||e<s||isNaN(Number(s)))&&(e=s)}),e||new Date(NaN)}function ZQ(t){let e;return t.forEach(n=>{const s=Ut(n);(!e||e>s||isNaN(+s))&&(e=s)}),e||new Date(NaN)}function pr(t,e){const n=Sd(t),s=Sd(e);return+n==+s}function i1(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function GQ(t){if(!i1(t)&&typeof t!="number")return!1;const e=Ut(t);return!isNaN(Number(e))}function Zh(t,e){const n=Ut(t),s=Ut(e),a=n.getFullYear()-s.getFullYear(),i=n.getMonth()-s.getMonth();return a*12+i}function QQ(t,e,n){const s=xa(t,n),a=xa(e,n),i=+s-N0(s),o=+a-N0(a);return Math.round((i-o)/s1)}function YQ(t){return e=>{const s=(t?Math[t]:Math.trunc)(e);return s===0?0:s}}function XQ(t,e){return+Ut(t)-+Ut(e)}function _C(t,e,n){const s=XQ(t,e)/a1;return YQ(n==null?void 0:n.roundingMethod)(s)}function Ig(t){const e=Ut(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function JQ(t,e){const n=Ut(t.start),s=Ut(t.end);let a=+n>+s;const i=a?+n:+s,o=a?s:n;o.setHours(0,0,0,0);let c=1;const d=[];for(;+o<=i;)d.push(Ut(o)),o.setDate(o.getDate()+c),o.setHours(0,0,0,0);return a?d.reverse():d}function Br(t){const e=Ut(t);return e.setDate(1),e.setHours(0,0,0,0),e}function E3(t){const e=Ut(t),n=ws(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Og(t,e){var c,d,u,m;const n=Af(),s=(e==null?void 0:e.weekStartsOn)??((d=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??n.weekStartsOn??((m=(u=n.locale)==null?void 0:u.options)==null?void 0:m.weekStartsOn)??0,a=Ut(t),i=a.getDay(),o=(i<s?-7:0)+6-(i-s);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}function A3(t){return Og(t,{weekStartsOn:1})}const eY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},tY=(t,e,n)=>{let s;const a=eY[t];return typeof a=="string"?s=a:e===1?s=a.one:s=a.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function Yc(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const nY={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},rY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},sY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},aY={date:Yc({formats:nY,defaultWidth:"full"}),time:Yc({formats:rY,defaultWidth:"full"}),dateTime:Yc({formats:sY,defaultWidth:"full"})},iY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},oY=(t,e,n,s)=>iY[t];function Oa(t){return(e,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let a;if(s==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,c=n!=null&&n.width?String(n.width):o;a=t.formattingValues[c]||t.formattingValues[o]}else{const o=t.defaultWidth,c=n!=null&&n.width?String(n.width):t.defaultWidth;a=t.values[c]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return a[i]}}const lY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},cY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},dY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},uY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},hY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},fY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},mY=(t,e)=>{const n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},pY={ordinalNumber:mY,era:Oa({values:lY,defaultWidth:"wide"}),quarter:Oa({values:cY,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Oa({values:dY,defaultWidth:"wide"}),day:Oa({values:uY,defaultWidth:"wide"}),dayPeriod:Oa({values:hY,defaultWidth:"wide",formattingValues:fY,defaultFormattingWidth:"wide"})};function La(t){return(e,n={})=>{const s=n.width,a=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],i=e.match(a);if(!i)return null;const o=i[0],c=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],d=Array.isArray(c)?xY(c,f=>f.test(o)):gY(c,f=>f.test(o));let u;u=t.valueCallback?t.valueCallback(d):d,u=n.valueCallback?n.valueCallback(u):u;const m=e.slice(o.length);return{value:u,rest:m}}}function gY(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function xY(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function P3(t){return(e,n={})=>{const s=e.match(t.matchPattern);if(!s)return null;const a=s[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const c=e.slice(a.length);return{value:o,rest:c}}}const vY=/^(\d+)(th|st|nd|rd)?/i,yY=/\d+/i,_Y={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},wY={any:[/^b/i,/^(a|c)/i]},bY={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},jY={any:[/1/i,/2/i,/3/i,/4/i]},NY={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},SY={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},kY={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},CY={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},EY={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},AY={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},PY={ordinalNumber:P3({matchPattern:vY,parsePattern:yY,valueCallback:t=>parseInt(t,10)}),era:La({matchPatterns:_Y,defaultMatchWidth:"wide",parsePatterns:wY,defaultParseWidth:"any"}),quarter:La({matchPatterns:bY,defaultMatchWidth:"wide",parsePatterns:jY,defaultParseWidth:"any",valueCallback:t=>t+1}),month:La({matchPatterns:NY,defaultMatchWidth:"wide",parsePatterns:SY,defaultParseWidth:"any"}),day:La({matchPatterns:kY,defaultMatchWidth:"wide",parsePatterns:CY,defaultParseWidth:"any"}),dayPeriod:La({matchPatterns:EY,defaultMatchWidth:"any",parsePatterns:AY,defaultParseWidth:"any"})},D3={code:"en-US",formatDistance:tY,formatLong:aY,formatRelative:oY,localize:pY,match:PY,options:{weekStartsOn:0,firstWeekContainsDate:1}};function DY(t){const e=Ut(t);return Ba(e,E3(e))+1}function T3(t){const e=Ut(t),n=+zl(e)-+HQ(e);return Math.round(n/s1)+1}function M3(t,e){var m,f,p,y;const n=Ut(t),s=n.getFullYear(),a=Af(),i=(e==null?void 0:e.firstWeekContainsDate)??((f=(m=e==null?void 0:e.locale)==null?void 0:m.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((y=(p=a.locale)==null?void 0:p.options)==null?void 0:y.firstWeekContainsDate)??1,o=ws(t,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const c=xa(o,e),d=ws(t,0);d.setFullYear(s,0,i),d.setHours(0,0,0,0);const u=xa(d,e);return n.getTime()>=c.getTime()?s+1:n.getTime()>=u.getTime()?s:s-1}function TY(t,e){var c,d,u,m;const n=Af(),s=(e==null?void 0:e.firstWeekContainsDate)??((d=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(u=n.locale)==null?void 0:u.options)==null?void 0:m.firstWeekContainsDate)??1,a=M3(t,e),i=ws(t,0);return i.setFullYear(a,0,s),i.setHours(0,0,0,0),xa(i,e)}function R3(t,e){const n=Ut(t),s=+xa(n,e)-+TY(n,e);return Math.round(s/s1)+1}function ln(t,e){const n=t<0?"-":"",s=Math.abs(t).toString().padStart(e,"0");return n+s}const zi={y(t,e){const n=t.getFullYear(),s=n>0?n:1-n;return ln(e==="yy"?s%100:s,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):ln(n+1,2)},d(t,e){return ln(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return ln(t.getHours()%12||12,e.length)},H(t,e){return ln(t.getHours(),e.length)},m(t,e){return ln(t.getMinutes(),e.length)},s(t,e){return ln(t.getSeconds(),e.length)},S(t,e){const n=e.length,s=t.getMilliseconds(),a=Math.trunc(s*Math.pow(10,n-3));return ln(a,e.length)}},xc={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wC={G:function(t,e,n){const s=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const s=t.getFullYear(),a=s>0?s:1-s;return n.ordinalNumber(a,{unit:"year"})}return zi.y(t,e)},Y:function(t,e,n,s){const a=M3(t,s),i=a>0?a:1-a;if(e==="YY"){const o=i%100;return ln(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):ln(i,e.length)},R:function(t,e){const n=C3(t);return ln(n,e.length)},u:function(t,e){const n=t.getFullYear();return ln(n,e.length)},Q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return ln(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return ln(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,e,n){const s=t.getMonth();switch(e){case"M":case"MM":return zi.M(t,e);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,e,n){const s=t.getMonth();switch(e){case"L":return String(s+1);case"LL":return ln(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,e,n,s){const a=R3(t,s);return e==="wo"?n.ordinalNumber(a,{unit:"week"}):ln(a,e.length)},I:function(t,e,n){const s=T3(t);return e==="Io"?n.ordinalNumber(s,{unit:"week"}):ln(s,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):zi.d(t,e)},D:function(t,e,n){const s=DY(t);return e==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):ln(s,e.length)},E:function(t,e,n){const s=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,e,n,s){const a=t.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return ln(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,n,s){const a=t.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return ln(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,n){const s=t.getDay(),a=s===0?7:s;switch(e){case"i":return String(a);case"ii":return ln(a,e.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,e,n){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,n){const s=t.getHours();let a;switch(s===12?a=xc.noon:s===0?a=xc.midnight:a=s/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,n){const s=t.getHours();let a;switch(s>=17?a=xc.evening:s>=12?a=xc.afternoon:s>=4?a=xc.morning:a=xc.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let s=t.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return zi.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):zi.H(t,e)},K:function(t,e,n){const s=t.getHours()%12;return e==="Ko"?n.ordinalNumber(s,{unit:"hour"}):ln(s,e.length)},k:function(t,e,n){let s=t.getHours();return s===0&&(s=24),e==="ko"?n.ordinalNumber(s,{unit:"hour"}):ln(s,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):zi.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):zi.s(t,e)},S:function(t,e){return zi.S(t,e)},X:function(t,e,n){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return jC(s);case"XXXX":case"XX":return il(s);case"XXXXX":case"XXX":default:return il(s,":")}},x:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"x":return jC(s);case"xxxx":case"xx":return il(s);case"xxxxx":case"xxx":default:return il(s,":")}},O:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+bC(s,":");case"OOOO":default:return"GMT"+il(s,":")}},z:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+bC(s,":");case"zzzz":default:return"GMT"+il(s,":")}},t:function(t,e,n){const s=Math.trunc(t.getTime()/1e3);return ln(s,e.length)},T:function(t,e,n){const s=t.getTime();return ln(s,e.length)}};function bC(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),a=Math.trunc(s/60),i=s%60;return i===0?n+String(a):n+String(a)+e+ln(i,2)}function jC(t,e){return t%60===0?(t>0?"-":"+")+ln(Math.abs(t)/60,2):il(t,e)}function il(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),a=ln(Math.trunc(s/60),2),i=ln(s%60,2);return n+a+e+i}const NC=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},I3=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},MY=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],s=n[1],a=n[2];if(!a)return NC(t,e);let i;switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",NC(s,e)).replace("{{time}}",I3(a,e))},RY={p:I3,P:MY},IY=/^D+$/,OY=/^Y+$/,LY=["D","DD","YY","YYYY"];function FY(t){return IY.test(t)}function BY(t){return OY.test(t)}function zY(t,e,n){const s=$Y(t,e,n);if(console.warn(s),LY.includes(t))throw new RangeError(s)}function $Y(t,e,n){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const UY=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,qY=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,WY=/^'([^]*?)'?$/,HY=/''/g,VY=/[a-zA-Z]/;function We(t,e,n){var m,f,p,y,j,v,_,b;const s=Af(),a=(n==null?void 0:n.locale)??s.locale??D3,i=(n==null?void 0:n.firstWeekContainsDate)??((f=(m=n==null?void 0:n.locale)==null?void 0:m.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((y=(p=s.locale)==null?void 0:p.options)==null?void 0:y.firstWeekContainsDate)??1,o=(n==null?void 0:n.weekStartsOn)??((v=(j=n==null?void 0:n.locale)==null?void 0:j.options)==null?void 0:v.weekStartsOn)??s.weekStartsOn??((b=(_=s.locale)==null?void 0:_.options)==null?void 0:b.weekStartsOn)??0,c=Ut(t);if(!GQ(c))throw new RangeError("Invalid time value");let d=e.match(qY).map(w=>{const N=w[0];if(N==="p"||N==="P"){const S=RY[N];return S(w,a.formatLong)}return w}).join("").match(UY).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const N=w[0];if(N==="'")return{isToken:!1,value:KY(w)};if(wC[N])return{isToken:!0,value:w};if(N.match(VY))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:w}});a.localize.preprocessor&&(d=a.localize.preprocessor(c,d));const u={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return d.map(w=>{if(!w.isToken)return w.value;const N=w.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&BY(N)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&FY(N))&&zY(N,e,String(t));const S=wC[N[0]];return S(c,N,a.localize,u)}).join("")}function KY(t){const e=t.match(WY);return e?e[1].replace(HY,"'"):t}function ZY(t){const e=Ut(t),n=e.getFullYear(),s=e.getMonth(),a=ws(t,0);return a.setFullYear(n,s+1,0),a.setHours(0,0,0,0),a.getDate()}function GY(t){return Math.trunc(+Ut(t)/1e3)}function QY(t){const e=Ut(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(0,0,0,0),e}function YY(t,e){return QQ(QY(t),Br(t),e)+1}function Ew(t,e){const n=Ut(t),s=Ut(e);return n.getTime()>s.getTime()}function O3(t,e){const n=Ut(t),s=Ut(e);return+n<+s}function o1(t,e){const n=Ut(t),s=Ut(e);return n.getFullYear()===s.getFullYear()&&n.getMonth()===s.getMonth()}function XY(t,e){const n=Ut(t),s=Ut(e);return n.getFullYear()===s.getFullYear()}function cy(t,e){return mr(t,-e)}function Bc(t,e){const s=nX(t);let a;if(s.date){const d=rX(s.date,2);a=sX(d.restDateString,d.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let o=0,c;if(s.time&&(o=aX(s.time),isNaN(o)))return new Date(NaN);if(s.timezone){if(c=iX(s.timezone),isNaN(c))return new Date(NaN)}else{const d=new Date(i+o),u=new Date(0);return u.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),u.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),u}return new Date(i+o+c)}const Um={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},JY=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,eX=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,tX=/^([+-])(\d{2})(?::?(\d{2}))?$/;function nX(t){const e={},n=t.split(Um.dateTimeDelimiter);let s;if(n.length>2)return e;if(/:/.test(n[0])?s=n[0]:(e.date=n[0],s=n[1],Um.timeZoneDelimiter.test(e.date)&&(e.date=t.split(Um.timeZoneDelimiter)[0],s=t.substr(e.date.length,t.length))),s){const a=Um.timezone.exec(s);a?(e.time=s.replace(a[1],""),e.timezone=a[1]):e.time=s}return e}function rX(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),s=t.match(n);if(!s)return{year:NaN,restDateString:""};const a=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?a:i*100,restDateString:t.slice((s[1]||s[2]).length)}}function sX(t,e){if(e===null)return new Date(NaN);const n=t.match(JY);if(!n)return new Date(NaN);const s=!!n[4],a=_u(n[1]),i=_u(n[2])-1,o=_u(n[3]),c=_u(n[4]),d=_u(n[5])-1;if(s)return uX(e,c,d)?oX(e,c,d):new Date(NaN);{const u=new Date(0);return!cX(e,i,o)||!dX(e,a)?new Date(NaN):(u.setUTCFullYear(e,i,Math.max(a,o)),u)}}function _u(t){return t?parseInt(t):1}function aX(t){const e=t.match(eX);if(!e)return NaN;const n=dy(e[1]),s=dy(e[2]),a=dy(e[3]);return hX(n,s,a)?n*k3+s*a1+a*1e3:NaN}function dy(t){return t&&parseFloat(t.replace(",","."))||0}function iX(t){if(t==="Z")return 0;const e=t.match(tX);if(!e)return 0;const n=e[1]==="+"?-1:1,s=parseInt(e[2]),a=e[3]&&parseInt(e[3])||0;return fX(s,a)?n*(s*k3+a*a1):NaN}function oX(t,e,n){const s=new Date(0);s.setUTCFullYear(t,0,4);const a=s.getUTCDay()||7,i=(e-1)*7+n+1-a;return s.setUTCDate(s.getUTCDate()+i),s}const lX=[31,null,31,30,31,30,31,31,30,31,30,31];function L3(t){return t%400===0||t%4===0&&t%100!==0}function cX(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(lX[e]||(L3(t)?29:28))}function dX(t,e){return e>=1&&e<=(L3(t)?366:365)}function uX(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function hX(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function fX(t,e){return e>=0&&e<=59}function uy(t,e){const n=Ut(t),s=n.getFullYear(),a=n.getDate(),i=ws(t,0);i.setFullYear(s,e,15),i.setHours(0,0,0,0);const o=ZY(i);return n.setMonth(e,Math.min(a,o)),n}function SC(t,e){const n=Ut(t);return isNaN(+n)?ws(t,NaN):(n.setFullYear(e),n)}function mX(t,e){return bs(t,-e)}function pX(t,e){return Kh(t,-e)}const kC={lessThanXSeconds:{standalone:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"},withPreposition:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"}},xSeconds:{standalone:{one:"1 Sekunde",other:"{{count}} Sekunden"},withPreposition:{one:"1 Sekunde",other:"{{count}} Sekunden"}},halfAMinute:{standalone:"eine halbe Minute",withPreposition:"einer halben Minute"},lessThanXMinutes:{standalone:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"},withPreposition:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"}},xMinutes:{standalone:{one:"1 Minute",other:"{{count}} Minuten"},withPreposition:{one:"1 Minute",other:"{{count}} Minuten"}},aboutXHours:{standalone:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"},withPreposition:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"}},xHours:{standalone:{one:"1 Stunde",other:"{{count}} Stunden"},withPreposition:{one:"1 Stunde",other:"{{count}} Stunden"}},xDays:{standalone:{one:"1 Tag",other:"{{count}} Tage"},withPreposition:{one:"1 Tag",other:"{{count}} Tagen"}},aboutXWeeks:{standalone:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"},withPreposition:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"}},xWeeks:{standalone:{one:"1 Woche",other:"{{count}} Wochen"},withPreposition:{one:"1 Woche",other:"{{count}} Wochen"}},aboutXMonths:{standalone:{one:"etwa 1 Monat",other:"etwa {{count}} Monate"},withPreposition:{one:"etwa 1 Monat",other:"etwa {{count}} Monaten"}},xMonths:{standalone:{one:"1 Monat",other:"{{count}} Monate"},withPreposition:{one:"1 Monat",other:"{{count}} Monaten"}},aboutXYears:{standalone:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahre"},withPreposition:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahren"}},xYears:{standalone:{one:"1 Jahr",other:"{{count}} Jahre"},withPreposition:{one:"1 Jahr",other:"{{count}} Jahren"}},overXYears:{standalone:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahre"},withPreposition:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahren"}},almostXYears:{standalone:{one:"fast 1 Jahr",other:"fast {{count}} Jahre"},withPreposition:{one:"fast 1 Jahr",other:"fast {{count}} Jahren"}}},gX=(t,e,n)=>{let s;const a=n!=null&&n.addSuffix?kC[t].withPreposition:kC[t].standalone;return typeof a=="string"?s=a:e===1?s=a.one:s=a.other.replace("{{count}}",String(e)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:"vor "+s:s},xX={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},vX={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},yX={full:"{{date}} 'um' {{time}}",long:"{{date}} 'um' {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},_X={date:Yc({formats:xX,defaultWidth:"full"}),time:Yc({formats:vX,defaultWidth:"full"}),dateTime:Yc({formats:yX,defaultWidth:"full"})},wX={lastWeek:"'letzten' eeee 'um' p",yesterday:"'gestern um' p",today:"'heute um' p",tomorrow:"'morgen um' p",nextWeek:"eeee 'um' p",other:"P"},bX=(t,e,n,s)=>wX[t],jX={narrow:["v.Chr.","n.Chr."],abbreviated:["v.Chr.","n.Chr."],wide:["vor Christus","nach Christus"]},NX={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1. Quartal","2. Quartal","3. Quartal","4. Quartal"]},Aw={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],wide:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},SX={narrow:Aw.narrow,abbreviated:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sep.","Okt.","Nov.","Dez."],wide:Aw.wide},kX={narrow:["S","M","D","M","D","F","S"],short:["So","Mo","Di","Mi","Do","Fr","Sa"],abbreviated:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],wide:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},CX={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachm.",evening:"Abend",night:"Nacht"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"}},EX={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachm.",evening:"abends",night:"nachts"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"}},AX=t=>Number(t)+".",PX={ordinalNumber:AX,era:Oa({values:jX,defaultWidth:"wide"}),quarter:Oa({values:NX,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Oa({values:Aw,formattingValues:SX,defaultWidth:"wide"}),day:Oa({values:kX,defaultWidth:"wide"}),dayPeriod:Oa({values:CX,defaultWidth:"wide",formattingValues:EX,defaultFormattingWidth:"wide"})},DX=/^(\d+)(\.)?/i,TX=/\d+/i,MX={narrow:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,abbreviated:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,wide:/^(vor Christus|vor unserer Zeitrechnung|nach Christus|unserer Zeitrechnung)/i},RX={any:[/^v/i,/^n/i]},IX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](\.)? Quartal/i},OX={any:[/1/i,/2/i,/3/i,/4/i]},LX={narrow:/^[jfmasond]/i,abbreviated:/^(j[aä]n|feb|mär[z]?|apr|mai|jun[i]?|jul[i]?|aug|sep|okt|nov|dez)\.?/i,wide:/^(januar|februar|märz|april|mai|juni|juli|august|september|oktober|november|dezember)/i},FX={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^j[aä]/i,/^f/i,/^mär/i,/^ap/i,/^mai/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},BX={narrow:/^[smdmf]/i,short:/^(so|mo|di|mi|do|fr|sa)/i,abbreviated:/^(son?|mon?|die?|mit?|don?|fre?|sam?)\.?/i,wide:/^(sonntag|montag|dienstag|mittwoch|donnerstag|freitag|samstag)/i},zX={any:[/^so/i,/^mo/i,/^di/i,/^mi/i,/^do/i,/^f/i,/^sa/i]},$X={narrow:/^(vm\.?|nm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,abbreviated:/^(vorm\.?|nachm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,wide:/^(vormittags|nachmittags|Mitternacht|Mittag|morgens|nachmittags|abends|nachts)/i},UX={any:{am:/^v/i,pm:/^n/i,midnight:/^Mitte/i,noon:/^Mitta/i,morning:/morgens/i,afternoon:/nachmittags/i,evening:/abends/i,night:/nachts/i}},qX={ordinalNumber:P3({matchPattern:DX,parsePattern:TX,valueCallback:t=>parseInt(t)}),era:La({matchPatterns:MX,defaultMatchWidth:"wide",parsePatterns:RX,defaultParseWidth:"any"}),quarter:La({matchPatterns:IX,defaultMatchWidth:"wide",parsePatterns:OX,defaultParseWidth:"any",valueCallback:t=>t+1}),month:La({matchPatterns:LX,defaultMatchWidth:"wide",parsePatterns:FX,defaultParseWidth:"any"}),day:La({matchPatterns:BX,defaultMatchWidth:"wide",parsePatterns:zX,defaultParseWidth:"any"}),dayPeriod:La({matchPatterns:$X,defaultMatchWidth:"wide",parsePatterns:UX,defaultParseWidth:"any"})},cn={code:"de",formatDistance:gX,formatLong:_X,formatRelative:bX,localize:PX,match:qX,options:{weekStartsOn:1,firstWeekContainsDate:4}};var St=function(){return St=Object.assign||function(e){for(var n,s=1,a=arguments.length;s<a;s++){n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},St.apply(this,arguments)};function WX(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n}function F3(t,e,n){for(var s=0,a=e.length,i;s<a;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}function Pf(t){return t.mode==="multiple"}function Df(t){return t.mode==="range"}function Lg(t){return t.mode==="single"}var HX={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function VX(t,e){return We(t,"LLLL y",e)}function KX(t,e){return We(t,"d",e)}function ZX(t,e){return We(t,"LLLL",e)}function GX(t){return"".concat(t)}function QX(t,e){return We(t,"cccccc",e)}function YX(t,e){return We(t,"yyyy",e)}var XX=Object.freeze({__proto__:null,formatCaption:VX,formatDay:KX,formatMonthCaption:ZX,formatWeekNumber:GX,formatWeekdayName:QX,formatYearCaption:YX}),JX=function(t,e,n){return We(t,"do MMMM (EEEE)",n)},eJ=function(){return"Month: "},tJ=function(){return"Go to next month"},nJ=function(){return"Go to previous month"},rJ=function(t,e){return We(t,"cccc",e)},sJ=function(t){return"Week n. ".concat(t)},aJ=function(){return"Year: "},iJ=Object.freeze({__proto__:null,labelDay:JX,labelMonthDropdown:eJ,labelNext:tJ,labelPrevious:nJ,labelWeekNumber:sJ,labelWeekday:rJ,labelYearDropdown:aJ});function oJ(){var t="buttons",e=HX,n=D3,s={},a={},i=1,o={},c=new Date;return{captionLayout:t,classNames:e,formatters:XX,labels:iJ,locale:n,modifiersClassNames:s,modifiers:a,numberOfMonths:i,styles:o,today:c,mode:"default"}}function lJ(t){var e=t.fromYear,n=t.toYear,s=t.fromMonth,a=t.toMonth,i=t.fromDate,o=t.toDate;return s?i=Br(s):e&&(i=new Date(e,0,1)),a?o=Ig(a):n&&(o=new Date(n,11,31)),{fromDate:i?Sd(i):void 0,toDate:o?Sd(o):void 0}}var B3=g.createContext(void 0);function cJ(t){var e,n=t.initialProps,s=oJ(),a=lJ(n),i=a.fromDate,o=a.toDate,c=(e=n.captionLayout)!==null&&e!==void 0?e:s.captionLayout;c!=="buttons"&&(!i||!o)&&(c="buttons");var d;(Lg(n)||Pf(n)||Df(n))&&(d=n.onSelect);var u=St(St(St({},s),n),{captionLayout:c,classNames:St(St({},s.classNames),n.classNames),components:St({},n.components),formatters:St(St({},s.formatters),n.formatters),fromDate:i,labels:St(St({},s.labels),n.labels),mode:n.mode||s.mode,modifiers:St(St({},s.modifiers),n.modifiers),modifiersClassNames:St(St({},s.modifiersClassNames),n.modifiersClassNames),onSelect:d,styles:St(St({},s.styles),n.styles),toDate:o});return r.jsx(B3.Provider,{value:u,children:t.children})}function vn(){var t=g.useContext(B3);if(!t)throw new Error("useDayPicker must be used within a DayPickerProvider.");return t}function z3(t){var e=vn(),n=e.locale,s=e.classNames,a=e.styles,i=e.formatters.formatCaption;return r.jsx("div",{className:s.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:t.id,children:i(t.displayMonth,{locale:n})})}function dJ(t){return r.jsx("svg",St({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},t,{children:r.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function $3(t){var e,n,s=t.onChange,a=t.value,i=t.children,o=t.caption,c=t.className,d=t.style,u=vn(),m=(n=(e=u.components)===null||e===void 0?void 0:e.IconDropdown)!==null&&n!==void 0?n:dJ;return r.jsxs("div",{className:c,style:d,children:[r.jsx("span",{className:u.classNames.vhidden,children:t["aria-label"]}),r.jsx("select",{name:t.name,"aria-label":t["aria-label"],className:u.classNames.dropdown,style:u.styles.dropdown,value:a,onChange:s,children:i}),r.jsxs("div",{className:u.classNames.caption_label,style:u.styles.caption_label,"aria-hidden":"true",children:[o,r.jsx(m,{className:u.classNames.dropdown_icon,style:u.styles.dropdown_icon})]})]})}function uJ(t){var e,n=vn(),s=n.fromDate,a=n.toDate,i=n.styles,o=n.locale,c=n.formatters.formatMonthCaption,d=n.classNames,u=n.components,m=n.labels.labelMonthDropdown;if(!s)return r.jsx(r.Fragment,{});if(!a)return r.jsx(r.Fragment,{});var f=[];if(XY(s,a))for(var p=Br(s),y=s.getMonth();y<=a.getMonth();y++)f.push(uy(p,y));else for(var p=Br(new Date),y=0;y<=11;y++)f.push(uy(p,y));var j=function(_){var b=Number(_.target.value),w=uy(Br(t.displayMonth),b);t.onChange(w)},v=(e=u==null?void 0:u.Dropdown)!==null&&e!==void 0?e:$3;return r.jsx(v,{name:"months","aria-label":m(),className:d.dropdown_month,style:i.dropdown_month,onChange:j,value:t.displayMonth.getMonth(),caption:c(t.displayMonth,{locale:o}),children:f.map(function(_){return r.jsx("option",{value:_.getMonth(),children:c(_,{locale:o})},_.getMonth())})})}function hJ(t){var e,n=t.displayMonth,s=vn(),a=s.fromDate,i=s.toDate,o=s.locale,c=s.styles,d=s.classNames,u=s.components,m=s.formatters.formatYearCaption,f=s.labels.labelYearDropdown,p=[];if(!a)return r.jsx(r.Fragment,{});if(!i)return r.jsx(r.Fragment,{});for(var y=a.getFullYear(),j=i.getFullYear(),v=y;v<=j;v++)p.push(SC(E3(new Date),v));var _=function(w){var N=SC(Br(n),Number(w.target.value));t.onChange(N)},b=(e=u==null?void 0:u.Dropdown)!==null&&e!==void 0?e:$3;return r.jsx(b,{name:"years","aria-label":f(),className:d.dropdown_year,style:c.dropdown_year,onChange:_,value:n.getFullYear(),caption:m(n,{locale:o}),children:p.map(function(w){return r.jsx("option",{value:w.getFullYear(),children:m(w,{locale:o})},w.getFullYear())})})}function fJ(t,e){var n=g.useState(t),s=n[0],a=n[1],i=e===void 0?s:e;return[i,a]}function mJ(t){var e=t.month,n=t.defaultMonth,s=t.today,a=e||n||s||new Date,i=t.toDate,o=t.fromDate,c=t.numberOfMonths,d=c===void 0?1:c;if(i&&Zh(i,a)<0){var u=-1*(d-1);a=bs(i,u)}return o&&Zh(a,o)<0&&(a=o),Br(a)}function pJ(){var t=vn(),e=mJ(t),n=fJ(e,t.month),s=n[0],a=n[1],i=function(o){var c;if(!t.disableNavigation){var d=Br(o);a(d),(c=t.onMonthChange)===null||c===void 0||c.call(t,d)}};return[s,i]}function gJ(t,e){for(var n=e.reverseMonths,s=e.numberOfMonths,a=Br(t),i=Br(bs(a,s)),o=Zh(i,a),c=[],d=0;d<o;d++){var u=bs(a,d);c.push(u)}return n&&(c=c.reverse()),c}function xJ(t,e){if(!e.disableNavigation){var n=e.toDate,s=e.pagedNavigation,a=e.numberOfMonths,i=a===void 0?1:a,o=s?i:1,c=Br(t);if(!n)return bs(c,o);var d=Zh(n,t);if(!(d<i))return bs(c,o)}}function vJ(t,e){if(!e.disableNavigation){var n=e.fromDate,s=e.pagedNavigation,a=e.numberOfMonths,i=a===void 0?1:a,o=s?i:1,c=Br(t);if(!n)return bs(c,-o);var d=Zh(c,n);if(!(d<=0))return bs(c,-o)}}var U3=g.createContext(void 0);function yJ(t){var e=vn(),n=pJ(),s=n[0],a=n[1],i=gJ(s,e),o=xJ(s,e),c=vJ(s,e),d=function(f){return i.some(function(p){return o1(f,p)})},u=function(f,p){d(f)||(p&&O3(f,p)?a(bs(f,1+e.numberOfMonths*-1)):a(f))},m={currentMonth:s,displayMonths:i,goToMonth:a,goToDate:u,previousMonth:c,nextMonth:o,isDateDisplayed:d};return r.jsx(U3.Provider,{value:m,children:t.children})}function Tf(){var t=g.useContext(U3);if(!t)throw new Error("useNavigation must be used within a NavigationProvider");return t}function CC(t){var e,n=vn(),s=n.classNames,a=n.styles,i=n.components,o=Tf().goToMonth,c=function(m){o(bs(m,t.displayIndex?-t.displayIndex:0))},d=(e=i==null?void 0:i.CaptionLabel)!==null&&e!==void 0?e:z3,u=r.jsx(d,{id:t.id,displayMonth:t.displayMonth});return r.jsxs("div",{className:s.caption_dropdowns,style:a.caption_dropdowns,children:[r.jsx("div",{className:s.vhidden,children:u}),r.jsx(uJ,{onChange:c,displayMonth:t.displayMonth}),r.jsx(hJ,{onChange:c,displayMonth:t.displayMonth})]})}function _J(t){return r.jsx("svg",St({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:r.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function wJ(t){return r.jsx("svg",St({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:r.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var S0=g.forwardRef(function(t,e){var n=vn(),s=n.classNames,a=n.styles,i=[s.button_reset,s.button];t.className&&i.push(t.className);var o=i.join(" "),c=St(St({},a.button_reset),a.button);return t.style&&Object.assign(c,t.style),r.jsx("button",St({},t,{ref:e,type:"button",className:o,style:c}))});function bJ(t){var e,n,s=vn(),a=s.dir,i=s.locale,o=s.classNames,c=s.styles,d=s.labels,u=d.labelPrevious,m=d.labelNext,f=s.components;if(!t.nextMonth&&!t.previousMonth)return r.jsx(r.Fragment,{});var p=u(t.previousMonth,{locale:i}),y=[o.nav_button,o.nav_button_previous].join(" "),j=m(t.nextMonth,{locale:i}),v=[o.nav_button,o.nav_button_next].join(" "),_=(e=f==null?void 0:f.IconRight)!==null&&e!==void 0?e:wJ,b=(n=f==null?void 0:f.IconLeft)!==null&&n!==void 0?n:_J;return r.jsxs("div",{className:o.nav,style:c.nav,children:[!t.hidePrevious&&r.jsx(S0,{name:"previous-month","aria-label":p,className:y,style:c.nav_button_previous,disabled:!t.previousMonth,onClick:t.onPreviousClick,children:a==="rtl"?r.jsx(_,{className:o.nav_icon,style:c.nav_icon}):r.jsx(b,{className:o.nav_icon,style:c.nav_icon})}),!t.hideNext&&r.jsx(S0,{name:"next-month","aria-label":j,className:v,style:c.nav_button_next,disabled:!t.nextMonth,onClick:t.onNextClick,children:a==="rtl"?r.jsx(b,{className:o.nav_icon,style:c.nav_icon}):r.jsx(_,{className:o.nav_icon,style:c.nav_icon})})]})}function EC(t){var e=vn().numberOfMonths,n=Tf(),s=n.previousMonth,a=n.nextMonth,i=n.goToMonth,o=n.displayMonths,c=o.findIndex(function(j){return o1(t.displayMonth,j)}),d=c===0,u=c===o.length-1,m=e>1&&(d||!u),f=e>1&&(u||!d),p=function(){s&&i(s)},y=function(){a&&i(a)};return r.jsx(bJ,{displayMonth:t.displayMonth,hideNext:m,hidePrevious:f,nextMonth:a,previousMonth:s,onPreviousClick:p,onNextClick:y})}function jJ(t){var e,n=vn(),s=n.classNames,a=n.disableNavigation,i=n.styles,o=n.captionLayout,c=n.components,d=(e=c==null?void 0:c.CaptionLabel)!==null&&e!==void 0?e:z3,u;return a?u=r.jsx(d,{id:t.id,displayMonth:t.displayMonth}):o==="dropdown"?u=r.jsx(CC,{displayMonth:t.displayMonth,id:t.id}):o==="dropdown-buttons"?u=r.jsxs(r.Fragment,{children:[r.jsx(CC,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id}),r.jsx(EC,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id})]}):u=r.jsxs(r.Fragment,{children:[r.jsx(d,{id:t.id,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),r.jsx(EC,{displayMonth:t.displayMonth,id:t.id})]}),r.jsx("div",{className:s.caption,style:i.caption,children:u})}function NJ(t){var e=vn(),n=e.footer,s=e.styles,a=e.classNames.tfoot;return n?r.jsx("tfoot",{className:a,style:s.tfoot,children:r.jsx("tr",{children:r.jsx("td",{colSpan:8,children:n})})}):r.jsx(r.Fragment,{})}function SJ(t,e,n){for(var s=n?zl(new Date):xa(new Date,{locale:t,weekStartsOn:e}),a=[],i=0;i<7;i++){var o=mr(s,i);a.push(o)}return a}function kJ(){var t=vn(),e=t.classNames,n=t.styles,s=t.showWeekNumber,a=t.locale,i=t.weekStartsOn,o=t.ISOWeek,c=t.formatters.formatWeekdayName,d=t.labels.labelWeekday,u=SJ(a,i,o);return r.jsxs("tr",{style:n.head_row,className:e.head_row,children:[s&&r.jsx("td",{style:n.head_cell,className:e.head_cell}),u.map(function(m,f){return r.jsx("th",{scope:"col",className:e.head_cell,style:n.head_cell,"aria-label":d(m,{locale:a}),children:c(m,{locale:a})},f)})]})}function CJ(){var t,e=vn(),n=e.classNames,s=e.styles,a=e.components,i=(t=a==null?void 0:a.HeadRow)!==null&&t!==void 0?t:kJ;return r.jsx("thead",{style:s.head,className:n.head,children:r.jsx(i,{})})}function EJ(t){var e=vn(),n=e.locale,s=e.formatters.formatDay;return r.jsx(r.Fragment,{children:s(t.date,{locale:n})})}var l1=g.createContext(void 0);function AJ(t){if(!Pf(t.initialProps)){var e={selected:void 0,modifiers:{disabled:[]}};return r.jsx(l1.Provider,{value:e,children:t.children})}return r.jsx(PJ,{initialProps:t.initialProps,children:t.children})}function PJ(t){var e=t.initialProps,n=t.children,s=e.selected,a=e.min,i=e.max,o=function(u,m,f){var p,y;(p=e.onDayClick)===null||p===void 0||p.call(e,u,m,f);var j=!!(m.selected&&a&&(s==null?void 0:s.length)===a);if(!j){var v=!!(!m.selected&&i&&(s==null?void 0:s.length)===i);if(!v){var _=s?F3([],s):[];if(m.selected){var b=_.findIndex(function(w){return pr(u,w)});_.splice(b,1)}else _.push(u);(y=e.onSelect)===null||y===void 0||y.call(e,_,u,m,f)}}},c={disabled:[]};s&&c.disabled.push(function(u){var m=i&&s.length>i-1,f=s.some(function(p){return pr(p,u)});return!!(m&&!f)});var d={selected:s,onDayClick:o,modifiers:c};return r.jsx(l1.Provider,{value:d,children:n})}function c1(){var t=g.useContext(l1);if(!t)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return t}function DJ(t,e){var n=e||{},s=n.from,a=n.to;return s&&a?pr(a,t)&&pr(s,t)?void 0:pr(a,t)?{from:a,to:void 0}:pr(s,t)?void 0:Ew(s,t)?{from:t,to:a}:{from:s,to:t}:a?Ew(t,a)?{from:a,to:t}:{from:t,to:a}:s?O3(t,s)?{from:t,to:s}:{from:s,to:t}:{from:t,to:void 0}}var d1=g.createContext(void 0);function TJ(t){if(!Df(t.initialProps)){var e={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return r.jsx(d1.Provider,{value:e,children:t.children})}return r.jsx(MJ,{initialProps:t.initialProps,children:t.children})}function MJ(t){var e=t.initialProps,n=t.children,s=e.selected,a=s||{},i=a.from,o=a.to,c=e.min,d=e.max,u=function(y,j,v){var _,b;(_=e.onDayClick)===null||_===void 0||_.call(e,y,j,v);var w=DJ(y,s);(b=e.onSelect)===null||b===void 0||b.call(e,w,y,j,v)},m={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(m.range_start=[i],o?(m.range_end=[o],pr(i,o)||(m.range_middle=[{after:i,before:o}])):m.range_end=[i]):o&&(m.range_start=[o],m.range_end=[o]),c&&(i&&!o&&m.disabled.push({after:cy(i,c-1),before:mr(i,c-1)}),i&&o&&m.disabled.push({after:i,before:mr(i,c-1)}),!i&&o&&m.disabled.push({after:cy(o,c-1),before:mr(o,c-1)})),d){if(i&&!o&&(m.disabled.push({before:mr(i,-d+1)}),m.disabled.push({after:mr(i,d-1)})),i&&o){var f=Ba(o,i)+1,p=d-f;m.disabled.push({before:cy(i,p)}),m.disabled.push({after:mr(o,p)})}!i&&o&&(m.disabled.push({before:mr(o,-d+1)}),m.disabled.push({after:mr(o,d-1)}))}return r.jsx(d1.Provider,{value:{selected:s,onDayClick:u,modifiers:m},children:n})}function u1(){var t=g.useContext(d1);if(!t)throw new Error("useSelectRange must be used within a SelectRangeProvider");return t}function yp(t){return Array.isArray(t)?F3([],t):t!==void 0?[t]:[]}function RJ(t){var e={};return Object.entries(t).forEach(function(n){var s=n[0],a=n[1];e[s]=yp(a)}),e}var va;(function(t){t.Outside="outside",t.Disabled="disabled",t.Selected="selected",t.Hidden="hidden",t.Today="today",t.RangeStart="range_start",t.RangeEnd="range_end",t.RangeMiddle="range_middle"})(va||(va={}));var IJ=va.Selected,ii=va.Disabled,OJ=va.Hidden,LJ=va.Today,hy=va.RangeEnd,fy=va.RangeMiddle,my=va.RangeStart,FJ=va.Outside;function BJ(t,e,n){var s,a=(s={},s[IJ]=yp(t.selected),s[ii]=yp(t.disabled),s[OJ]=yp(t.hidden),s[LJ]=[t.today],s[hy]=[],s[fy]=[],s[my]=[],s[FJ]=[],s);return t.fromDate&&a[ii].push({before:t.fromDate}),t.toDate&&a[ii].push({after:t.toDate}),Pf(t)?a[ii]=a[ii].concat(e.modifiers[ii]):Df(t)&&(a[ii]=a[ii].concat(n.modifiers[ii]),a[my]=n.modifiers[my],a[fy]=n.modifiers[fy],a[hy]=n.modifiers[hy]),a}var q3=g.createContext(void 0);function zJ(t){var e=vn(),n=c1(),s=u1(),a=BJ(e,n,s),i=RJ(e.modifiers),o=St(St({},a),i);return r.jsx(q3.Provider,{value:o,children:t.children})}function W3(){var t=g.useContext(q3);if(!t)throw new Error("useModifiers must be used within a ModifiersProvider");return t}function $J(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function UJ(t){return!!(t&&typeof t=="object"&&"from"in t)}function qJ(t){return!!(t&&typeof t=="object"&&"after"in t)}function WJ(t){return!!(t&&typeof t=="object"&&"before"in t)}function HJ(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function VJ(t,e){var n,s=e.from,a=e.to;if(s&&a){var i=Ba(a,s)<0;i&&(n=[a,s],s=n[0],a=n[1]);var o=Ba(t,s)>=0&&Ba(a,t)>=0;return o}return a?pr(a,t):s?pr(s,t):!1}function KJ(t){return i1(t)}function ZJ(t){return Array.isArray(t)&&t.every(i1)}function GJ(t,e){return e.some(function(n){if(typeof n=="boolean")return n;if(KJ(n))return pr(t,n);if(ZJ(n))return n.includes(t);if(UJ(n))return VJ(t,n);if(HJ(n))return n.dayOfWeek.includes(t.getDay());if($J(n)){var s=Ba(n.before,t),a=Ba(n.after,t),i=s>0,o=a<0,c=Ew(n.before,n.after);return c?o&&i:i||o}return qJ(n)?Ba(t,n.after)>0:WJ(n)?Ba(n.before,t)>0:typeof n=="function"?n(t):!1})}function h1(t,e,n){var s=Object.keys(e).reduce(function(i,o){var c=e[o];return GJ(t,c)&&i.push(o),i},[]),a={};return s.forEach(function(i){return a[i]=!0}),n&&!o1(t,n)&&(a.outside=!0),a}function QJ(t,e){for(var n=Br(t[0]),s=Ig(t[t.length-1]),a,i,o=n;o<=s;){var c=h1(o,e),d=!c.disabled&&!c.hidden;if(!d){o=mr(o,1);continue}if(c.selected)return o;c.today&&!i&&(i=o),a||(a=o),o=mr(o,1)}return i||a}var YJ=365;function H3(t,e){var n=e.moveBy,s=e.direction,a=e.context,i=e.modifiers,o=e.retry,c=o===void 0?{count:0,lastFocused:t}:o,d=a.weekStartsOn,u=a.fromDate,m=a.toDate,f=a.locale,p={day:mr,week:Kh,month:bs,year:VQ,startOfWeek:function(_){return a.ISOWeek?zl(_):xa(_,{locale:f,weekStartsOn:d})},endOfWeek:function(_){return a.ISOWeek?A3(_):Og(_,{locale:f,weekStartsOn:d})}},y=p[n](t,s==="after"?1:-1);s==="before"&&u?y=KQ([u,y]):s==="after"&&m&&(y=ZQ([m,y]));var j=!0;if(i){var v=h1(y,i);j=!v.disabled&&!v.hidden}return j?y:c.count>YJ?c.lastFocused:H3(y,{moveBy:n,direction:s,context:a,modifiers:i,retry:St(St({},c),{count:c.count+1})})}var V3=g.createContext(void 0);function XJ(t){var e=Tf(),n=W3(),s=g.useState(),a=s[0],i=s[1],o=g.useState(),c=o[0],d=o[1],u=QJ(e.displayMonths,n),m=a??(c&&e.isDateDisplayed(c))?c:u,f=function(){d(a),i(void 0)},p=function(_){i(_)},y=vn(),j=function(_,b){if(a){var w=H3(a,{moveBy:_,direction:b,context:y,modifiers:n});pr(a,w)||(e.goToDate(w,a),p(w))}},v={focusedDay:a,focusTarget:m,blur:f,focus:p,focusDayAfter:function(){return j("day","after")},focusDayBefore:function(){return j("day","before")},focusWeekAfter:function(){return j("week","after")},focusWeekBefore:function(){return j("week","before")},focusMonthBefore:function(){return j("month","before")},focusMonthAfter:function(){return j("month","after")},focusYearBefore:function(){return j("year","before")},focusYearAfter:function(){return j("year","after")},focusStartOfWeek:function(){return j("startOfWeek","before")},focusEndOfWeek:function(){return j("endOfWeek","after")}};return r.jsx(V3.Provider,{value:v,children:t.children})}function f1(){var t=g.useContext(V3);if(!t)throw new Error("useFocusContext must be used within a FocusProvider");return t}function JJ(t,e){var n=W3(),s=h1(t,n,e);return s}var m1=g.createContext(void 0);function eee(t){if(!Lg(t.initialProps)){var e={selected:void 0};return r.jsx(m1.Provider,{value:e,children:t.children})}return r.jsx(tee,{initialProps:t.initialProps,children:t.children})}function tee(t){var e=t.initialProps,n=t.children,s=function(i,o,c){var d,u,m;if((d=e.onDayClick)===null||d===void 0||d.call(e,i,o,c),o.selected&&!e.required){(u=e.onSelect)===null||u===void 0||u.call(e,void 0,i,o,c);return}(m=e.onSelect)===null||m===void 0||m.call(e,i,i,o,c)},a={selected:e.selected,onDayClick:s};return r.jsx(m1.Provider,{value:a,children:n})}function K3(){var t=g.useContext(m1);if(!t)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return t}function nee(t,e){var n=vn(),s=K3(),a=c1(),i=u1(),o=f1(),c=o.focusDayAfter,d=o.focusDayBefore,u=o.focusWeekAfter,m=o.focusWeekBefore,f=o.blur,p=o.focus,y=o.focusMonthBefore,j=o.focusMonthAfter,v=o.focusYearBefore,_=o.focusYearAfter,b=o.focusStartOfWeek,w=o.focusEndOfWeek,N=function(Q){var z,V,U,O;Lg(n)?(z=s.onDayClick)===null||z===void 0||z.call(s,t,e,Q):Pf(n)?(V=a.onDayClick)===null||V===void 0||V.call(a,t,e,Q):Df(n)?(U=i.onDayClick)===null||U===void 0||U.call(i,t,e,Q):(O=n.onDayClick)===null||O===void 0||O.call(n,t,e,Q)},S=function(Q){var z;p(t),(z=n.onDayFocus)===null||z===void 0||z.call(n,t,e,Q)},A=function(Q){var z;f(),(z=n.onDayBlur)===null||z===void 0||z.call(n,t,e,Q)},E=function(Q){var z;(z=n.onDayMouseEnter)===null||z===void 0||z.call(n,t,e,Q)},D=function(Q){var z;(z=n.onDayMouseLeave)===null||z===void 0||z.call(n,t,e,Q)},M=function(Q){var z;(z=n.onDayPointerEnter)===null||z===void 0||z.call(n,t,e,Q)},B=function(Q){var z;(z=n.onDayPointerLeave)===null||z===void 0||z.call(n,t,e,Q)},R=function(Q){var z;(z=n.onDayTouchCancel)===null||z===void 0||z.call(n,t,e,Q)},P=function(Q){var z;(z=n.onDayTouchEnd)===null||z===void 0||z.call(n,t,e,Q)},F=function(Q){var z;(z=n.onDayTouchMove)===null||z===void 0||z.call(n,t,e,Q)},W=function(Q){var z;(z=n.onDayTouchStart)===null||z===void 0||z.call(n,t,e,Q)},ee=function(Q){var z;(z=n.onDayKeyUp)===null||z===void 0||z.call(n,t,e,Q)},ue=function(Q){var z;switch(Q.key){case"ArrowLeft":Q.preventDefault(),Q.stopPropagation(),n.dir==="rtl"?c():d();break;case"ArrowRight":Q.preventDefault(),Q.stopPropagation(),n.dir==="rtl"?d():c();break;case"ArrowDown":Q.preventDefault(),Q.stopPropagation(),u();break;case"ArrowUp":Q.preventDefault(),Q.stopPropagation(),m();break;case"PageUp":Q.preventDefault(),Q.stopPropagation(),Q.shiftKey?v():y();break;case"PageDown":Q.preventDefault(),Q.stopPropagation(),Q.shiftKey?_():j();break;case"Home":Q.preventDefault(),Q.stopPropagation(),b();break;case"End":Q.preventDefault(),Q.stopPropagation(),w();break}(z=n.onDayKeyDown)===null||z===void 0||z.call(n,t,e,Q)},de={onClick:N,onFocus:S,onBlur:A,onKeyDown:ue,onKeyUp:ee,onMouseEnter:E,onMouseLeave:D,onPointerEnter:M,onPointerLeave:B,onTouchCancel:R,onTouchEnd:P,onTouchMove:F,onTouchStart:W};return de}function ree(){var t=vn(),e=K3(),n=c1(),s=u1(),a=Lg(t)?e.selected:Pf(t)?n.selected:Df(t)?s.selected:void 0;return a}function see(t){return Object.values(va).includes(t)}function aee(t,e){var n=[t.classNames.day];return Object.keys(e).forEach(function(s){var a=t.modifiersClassNames[s];if(a)n.push(a);else if(see(s)){var i=t.classNames["day_".concat(s)];i&&n.push(i)}}),n}function iee(t,e){var n=St({},t.styles.day);return Object.keys(e).forEach(function(s){var a;n=St(St({},n),(a=t.modifiersStyles)===null||a===void 0?void 0:a[s])}),n}function oee(t,e,n){var s,a,i,o=vn(),c=f1(),d=JJ(t,e),u=nee(t,d),m=ree(),f=!!(o.onDayClick||o.mode!=="default");g.useEffect(function(){var E;d.outside||c.focusedDay&&f&&pr(c.focusedDay,t)&&((E=n.current)===null||E===void 0||E.focus())},[c.focusedDay,t,n,f,d.outside]);var p=aee(o,d).join(" "),y=iee(o,d),j=!!(d.outside&&!o.showOutsideDays||d.hidden),v=(i=(a=o.components)===null||a===void 0?void 0:a.DayContent)!==null&&i!==void 0?i:EJ,_=r.jsx(v,{date:t,displayMonth:e,activeModifiers:d}),b={style:y,className:p,children:_,role:"gridcell"},w=c.focusTarget&&pr(c.focusTarget,t)&&!d.outside,N=c.focusedDay&&pr(c.focusedDay,t),S=St(St(St({},b),(s={disabled:d.disabled,role:"gridcell"},s["aria-selected"]=d.selected,s.tabIndex=N||w?0:-1,s)),u),A={isButton:f,isHidden:j,activeModifiers:d,selectedDays:m,buttonProps:S,divProps:b};return A}function lee(t){var e=g.useRef(null),n=oee(t.date,t.displayMonth,e);return n.isHidden?r.jsx("div",{role:"gridcell"}):n.isButton?r.jsx(S0,St({name:"day",ref:e},n.buttonProps)):r.jsx("div",St({},n.divProps))}function cee(t){var e=t.number,n=t.dates,s=vn(),a=s.onWeekNumberClick,i=s.styles,o=s.classNames,c=s.locale,d=s.labels.labelWeekNumber,u=s.formatters.formatWeekNumber,m=u(Number(e),{locale:c});if(!a)return r.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:m});var f=d(Number(e),{locale:c}),p=function(y){a(e,n,y)};return r.jsx(S0,{name:"week-number","aria-label":f,className:o.weeknumber,style:i.weeknumber,onClick:p,children:m})}function dee(t){var e,n,s=vn(),a=s.styles,i=s.classNames,o=s.showWeekNumber,c=s.components,d=(e=c==null?void 0:c.Day)!==null&&e!==void 0?e:lee,u=(n=c==null?void 0:c.WeekNumber)!==null&&n!==void 0?n:cee,m;return o&&(m=r.jsx("td",{className:i.cell,style:a.cell,children:r.jsx(u,{number:t.weekNumber,dates:t.dates})})),r.jsxs("tr",{className:i.row,style:a.row,children:[m,t.dates.map(function(f){return r.jsx("td",{className:i.cell,style:a.cell,role:"presentation",children:r.jsx(d,{displayMonth:t.displayMonth,date:f})},GY(f))})]})}function AC(t,e,n){for(var s=n!=null&&n.ISOWeek?A3(e):Og(e,n),a=n!=null&&n.ISOWeek?zl(t):xa(t,n),i=Ba(s,a),o=[],c=0;c<=i;c++)o.push(mr(a,c));var d=o.reduce(function(u,m){var f=n!=null&&n.ISOWeek?T3(m):R3(m,n),p=u.find(function(y){return y.weekNumber===f});return p?(p.dates.push(m),u):(u.push({weekNumber:f,dates:[m]}),u)},[]);return d}function uee(t,e){var n=AC(Br(t),Ig(t),e);if(e!=null&&e.useFixedWeeks){var s=YY(t,e);if(s<6){var a=n[n.length-1],i=a.dates[a.dates.length-1],o=Kh(i,6-s),c=AC(Kh(i,1),o,e);n.push.apply(n,c)}}return n}function hee(t){var e,n,s,a=vn(),i=a.locale,o=a.classNames,c=a.styles,d=a.hideHead,u=a.fixedWeeks,m=a.components,f=a.weekStartsOn,p=a.firstWeekContainsDate,y=a.ISOWeek,j=uee(t.displayMonth,{useFixedWeeks:!!u,ISOWeek:y,locale:i,weekStartsOn:f,firstWeekContainsDate:p}),v=(e=m==null?void 0:m.Head)!==null&&e!==void 0?e:CJ,_=(n=m==null?void 0:m.Row)!==null&&n!==void 0?n:dee,b=(s=m==null?void 0:m.Footer)!==null&&s!==void 0?s:NJ;return r.jsxs("table",{id:t.id,className:o.table,style:c.table,role:"grid","aria-labelledby":t["aria-labelledby"],children:[!d&&r.jsx(v,{}),r.jsx("tbody",{className:o.tbody,style:c.tbody,children:j.map(function(w){return r.jsx(_,{displayMonth:t.displayMonth,dates:w.dates,weekNumber:w.weekNumber},w.weekNumber)})}),r.jsx(b,{displayMonth:t.displayMonth})]})}function fee(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var mee=fee()?g.useLayoutEffect:g.useEffect,py=!1,pee=0;function PC(){return"react-day-picker-".concat(++pee)}function gee(t){var e,n=t??(py?PC():null),s=g.useState(n),a=s[0],i=s[1];return mee(function(){a===null&&i(PC())},[]),g.useEffect(function(){py===!1&&(py=!0)},[]),(e=t??a)!==null&&e!==void 0?e:void 0}function xee(t){var e,n,s=vn(),a=s.dir,i=s.classNames,o=s.styles,c=s.components,d=Tf().displayMonths,u=gee(s.id?"".concat(s.id,"-").concat(t.displayIndex):void 0),m=s.id?"".concat(s.id,"-grid-").concat(t.displayIndex):void 0,f=[i.month],p=o.month,y=t.displayIndex===0,j=t.displayIndex===d.length-1,v=!y&&!j;a==="rtl"&&(e=[y,j],j=e[0],y=e[1]),y&&(f.push(i.caption_start),p=St(St({},p),o.caption_start)),j&&(f.push(i.caption_end),p=St(St({},p),o.caption_end)),v&&(f.push(i.caption_between),p=St(St({},p),o.caption_between));var _=(n=c==null?void 0:c.Caption)!==null&&n!==void 0?n:jJ;return r.jsxs("div",{className:f.join(" "),style:p,children:[r.jsx(_,{id:u,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),r.jsx(hee,{id:m,"aria-labelledby":u,displayMonth:t.displayMonth})]},t.displayIndex)}function vee(t){var e=vn(),n=e.classNames,s=e.styles;return r.jsx("div",{className:n.months,style:s.months,children:t.children})}function yee(t){var e,n,s=t.initialProps,a=vn(),i=f1(),o=Tf(),c=g.useState(!1),d=c[0],u=c[1];g.useEffect(function(){a.initialFocus&&i.focusTarget&&(d||(i.focus(i.focusTarget),u(!0)))},[a.initialFocus,d,i.focus,i.focusTarget,i]);var m=[a.classNames.root,a.className];a.numberOfMonths>1&&m.push(a.classNames.multiple_months),a.showWeekNumber&&m.push(a.classNames.with_weeknumber);var f=St(St({},a.styles.root),a.style),p=Object.keys(s).filter(function(j){return j.startsWith("data-")}).reduce(function(j,v){var _;return St(St({},j),(_={},_[v]=s[v],_))},{}),y=(n=(e=s.components)===null||e===void 0?void 0:e.Months)!==null&&n!==void 0?n:vee;return r.jsx("div",St({className:m.join(" "),style:f,dir:a.dir,id:a.id,nonce:s.nonce,title:s.title,lang:s.lang},p,{children:r.jsx(y,{children:o.displayMonths.map(function(j,v){return r.jsx(xee,{displayIndex:v,displayMonth:j},v)})})}))}function _ee(t){var e=t.children,n=WX(t,["children"]);return r.jsx(cJ,{initialProps:n,children:r.jsx(yJ,{children:r.jsx(eee,{initialProps:n,children:r.jsx(AJ,{initialProps:n,children:r.jsx(TJ,{initialProps:n,children:r.jsx(zJ,{children:r.jsx(XJ,{children:e})})})})})})})}function wee(t){return r.jsx(_ee,St({},t,{children:r.jsx(yee,{initialProps:t})}))}function ua({className:t,classNames:e,showOutsideDays:n=!0,...s}){return r.jsx(wee,{showOutsideDays:n,className:Oe("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Oe(tw({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Oe(tw({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...e},components:{IconLeft:({...a})=>r.jsx(Xu,{className:"h-4 w-4"}),IconRight:({...a})=>r.jsx(jl,{className:"h-4 w-4"})},...s})}ua.displayName="Calendar";const bee=({isOpen:t,onClose:e,onProjectAdded:n,customers:s,teamMembers:a})=>{const{toast:i}=Rt();KM(),console.log("AddProjectDialog - customers:",s),console.log("AddProjectDialog - teamMembers:",a);const[o,c]=g.useState({name:"",customer:"",location:"",budget:"",team:[],status:"geplant"}),[d,u]=g.useState(),m=(b,w)=>{if(!(w!=null&&w.from)||!(w!=null&&w.to))return"unknown";const N=w.from,S=w.to;let A=0;const E=Math.ceil((S.getTime()-N.getTime())/(1e3*60*60*24));return b.projects.forEach(D=>{const M=new Date(D.startDate.split(".").reverse().join("-")),B=new Date(D.endDate.split(".").reverse().join("-"));if(N<=B&&S>=M){const R=new Date(Math.max(N.getTime(),M.getTime())),P=new Date(Math.min(S.getTime(),B.getTime())),F=Math.ceil((P.getTime()-R.getTime())/(1e3*60*60*24));A+=F}}),A===0?"available":A>=E*.8?"unavailable":"partial"},f=g.useMemo(()=>a.map(b=>({...b,availability:m(b,d)})),[a,d]),p=b=>{switch(b){case"available":return r.jsx(Ve,{className:"bg-green-100 text-green-800 text-xs",children:"Verfügbar"});case"partial":return r.jsx(Ve,{className:"bg-orange-100 text-orange-800 text-xs",children:"Teilweise"});case"unavailable":return r.jsx(Ve,{className:"bg-red-100 text-red-800 text-xs",children:"Nicht verfügbar"});default:return r.jsx(Ve,{variant:"outline",className:"text-xs",children:"Unbekannt"})}},y=b=>{if(b.preventDefault(),!o.name||!o.customer||!o.budget){i({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}const w={id:`P2024-${String(Date.now()).slice(-3)}`,name:o.name,customer:o.customer,status:o.status,progress:0,startDate:d!=null&&d.from?We(d.from,"dd.MM.yyyy"):new Date().toLocaleDateString("de-DE"),endDate:d!=null&&d.to?We(d.to,"dd.MM.yyyy"):new Date(Date.now()+30*24*60*60*1e3).toLocaleDateString("de-DE"),budget:o.budget.startsWith("€")?o.budget:`€${o.budget}`,team:o.team.length>0?o.team:["Nicht zugewiesen"],location:o.location||"Nicht angegeben"};n(w),c({name:"",customer:"",location:"",budget:"",team:[],status:"geplant"}),u(void 0),i({title:"Erfolg",description:"Projekt wurde erfolgreich hinzugefügt."}),e()},j=(b,w)=>{c(N=>({...N,[b]:w}))},v=b=>{const w=s.find(N=>N.name===b||N.company_name===b);c(N=>({...N,customer:b,location:w?w.address:""}))},_=(b,w)=>{const N=a.find(A=>A.name===b||`${A.first_name||""} ${A.last_name||""}`.trim()===b),S=(N==null?void 0:N.name)||`${(N==null?void 0:N.first_name)||""} ${(N==null?void 0:N.last_name)||""}`.trim()||b;c(A=>({...A,team:w?[...A.team,S]:A.team.filter(E=>E!==S)}))};return r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Neues Projekt erstellen"}),r.jsx(Xn,{children:"Geben Sie die Informationen für das neue Projekt ein."})]}),r.jsxs("form",{onSubmit:y,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"name",children:"Projektname *"}),r.jsx(ne,{id:"name",value:o.name,onChange:b=>j("name",b.target.value),placeholder:"z.B. Büroerweiterung Müller GmbH",required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"customer",children:"Kunde *"}),r.jsxs(vt,{value:o.customer,onValueChange:v,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Kunde auswählen"})}),r.jsx(gt,{children:s.map(b=>r.jsx(ye,{value:b.name||b.company_name||"Unbekannt",children:b.name||b.company_name||"Unbekannt"},b.id))})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"location",children:"Standort"}),r.jsx(ne,{id:"location",value:o.location,onChange:b=>j("location",b.target.value),placeholder:"Wird automatisch aus Kundendaten übernommen",readOnly:!0,className:"bg-gray-50"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"budget",children:"Budget *"}),r.jsx(ne,{id:"budget",value:o.budget,onChange:b=>j("budget",b.target.value),placeholder:"z.B. 15000 oder €15.000",required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Projektzeitraum"}),r.jsxs(Ha,{children:[r.jsx(Va,{asChild:!0,children:r.jsxs(J,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[r.jsx(zt,{className:"mr-2 h-4 w-4"}),d!=null&&d.from?d.to?r.jsxs(r.Fragment,{children:[We(d.from,"dd.MM.yyyy",{locale:cn})," -"," ",We(d.to,"dd.MM.yyyy",{locale:cn})]}):We(d.from,"dd.MM.yyyy",{locale:cn}):r.jsx("span",{children:"Start- und Enddatum auswählen"})]})}),r.jsx(da,{className:"w-auto p-0",align:"start",children:r.jsx(ua,{initialFocus:!0,mode:"range",defaultMonth:d==null?void 0:d.from,selected:d,onSelect:u,numberOfMonths:2,locale:cn,className:"pointer-events-auto"})})]})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Team auswählen"}),r.jsx("div",{className:"mt-2 space-y-2 max-h-48 overflow-y-auto border rounded-md p-3",children:f.map(b=>r.jsxs("div",{className:"flex items-center justify-between space-x-2 p-2 rounded-lg hover:bg-gray-50",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Wa,{id:`team-${b.id}`,checked:o.team.includes(b.name||`${b.first_name||""} ${b.last_name||""}`.trim()),onCheckedChange:w=>_(b.name||`${b.first_name||""} ${b.last_name||""}`.trim(),w)}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:`team-${b.id}`,className:"text-sm font-medium cursor-pointer",children:b.name||`${b.first_name||""} ${b.last_name||""}`.trim()||"Unbekannt"}),r.jsx("p",{className:"text-xs text-gray-500",children:b.role||b.position||"Mitarbeiter"})]})]}),p(b.availability)]},b.id))})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"status",children:"Status"}),r.jsxs(vt,{value:o.status,onValueChange:b=>j("status",b),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"anfrage",children:"Anfrage"}),r.jsx(ye,{value:"besichtigung",children:"Besichtigung"}),r.jsx(ye,{value:"geplant",children:"Planung"}),r.jsx(ye,{value:"in_bearbeitung",children:"In Bearbeitung"}),r.jsx(ye,{value:"abgeschlossen",children:"Abgeschlossen"})]})]})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(J,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),r.jsx(J,{type:"submit",className:"flex-1",children:"Projekt erstellen"})]})]})]})})},jee=({isOpen:t,onClose:e,project:n,onProjectUpdated:s,onProjectDeleted:a})=>{const{toast:i}=Rt(),[o,c]=g.useState([]),[d,u]=g.useState(),[m,f]=g.useState(!1),[p,y]=g.useState(0),[j,v]=g.useState(null),[_,b]=g.useState({name:(n==null?void 0:n.name)||"",customer:(n==null?void 0:n.customer)||"",status:(n==null?void 0:n.status)||"Planung",progress:(n==null?void 0:n.progress)||0,startDate:(n==null?void 0:n.startDate)||"",endDate:(n==null?void 0:n.endDate)||"",budget:(n==null?void 0:n.budget)||"",location:(n==null?void 0:n.location)||""});g.useEffect(()=>{t&&(async()=>{const{data:M}=await K.from("customers").select("*").eq("status","Aktiv").order("company_name");M&&c(M)})()},[t]),g.useEffect(()=>{if(n){if(b({name:n.name,customer:n.customer,status:n.status,progress:n.progress,startDate:n.startDate,endDate:n.endDate,budget:n.budget,location:n.location}),n.startDate&&n.endDate){const D=new Date(n.startDate),M=new Date(n.endDate);!isNaN(D.getTime())&&!isNaN(M.getTime())&&u({from:D,to:M})}else if(n.startDate){const D=new Date(n.startDate);isNaN(D.getTime())||u({from:D,to:void 0})}}},[n]),g.useEffect(()=>{d!=null&&d.from&&N("startDate",We(d.from,"yyyy-MM-dd")),d!=null&&d.to&&N("endDate",We(d.to,"yyyy-MM-dd"))},[d]),g.useEffect(()=>(t||A(),()=>{j&&clearInterval(j)}),[t,j]);const w=D=>{if(D.preventDefault(),!n)return;const M={...n,..._};s(M),e()},N=(D,M)=>{b(B=>({...B,[D]:M}))},S=()=>{console.log("🚀 startDelete called - beginning delete sequence"),f(!0),y(0);const D=setInterval(()=>{y(M=>{const B=M+4;return console.log("⏰ Delete progress:",Math.round(B)+"%"),B>=100?(clearInterval(D),console.log("✅ Delete timer completed, calling handleDelete"),E(),100):B})},100);v(D)},A=()=>{console.log("⏹️ stopDelete called - canceling delete sequence"),j&&(clearInterval(j),v(null)),f(!1),y(0)},E=async()=>{if(!n||!a){console.log("❌ handleDelete aborted - missing project or callback");return}console.log("🗑️ Starting deletion of project:",n.id,n.name);try{const{data:D,error:M}=await K.from("projects").select("id, name").eq("id",n.id).single();if(console.log("🔍 Project check before delete:",{checkData:D,checkError:M}),M)throw console.error("❌ Cannot access project for deletion:",M),new Error("Projekt nicht gefunden oder keine Berechtigung");const{data:B,error:R,count:P}=await K.from("projects").delete().eq("id",n.id).select("*");if(console.log("🗑️ Delete result:",{data:B,error:R,count:P,deletedRows:(B==null?void 0:B.length)||0}),R)throw console.error("❌ Database delete error:",R),console.error("❌ Error details:",{message:R.message,code:R.code,details:R.details,hint:R.hint}),R;if(!B||B.length===0)throw console.warn("⚠️ No rows were deleted - project may not exist or access denied"),new Error("Projekt konnte nicht gelöscht werden - möglicherweise keine Berechtigung");console.log("✅ Project successfully deleted from database:",B[0]),i({title:"Projekt gelöscht",description:"Das Projekt wurde erfolgreich gelöscht."}),a(n.id),e(),console.log("✅ Delete operation completed")}catch(D){console.error("💥 Error deleting project:",D),i({title:"Fehler",description:"Projekt konnte nicht gelöscht werden: "+(D.message||"Unbekannter Fehler"),variant:"destructive"})}finally{A()}};return n?(console.log("🎯 EditProjectDialog render - onProjectDeleted available:",!!a),r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-md",children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Projekt bearbeiten"}),r.jsx(Xn,{children:"Bearbeiten Sie die Informationen für das Projekt."})]}),r.jsxs("form",{onSubmit:w,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"name",children:"Projektname"}),r.jsx(ne,{id:"name",value:_.name,onChange:D=>N("name",D.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"customer",children:"Kunde"}),r.jsxs(vt,{value:_.customer,onValueChange:D=>N("customer",D),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Kunde auswählen"})}),r.jsx(gt,{children:o.map(D=>r.jsx(ye,{value:D.company_name,children:D.company_name},D.id))})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"location",children:"Standort"}),r.jsx(ne,{id:"location",value:_.location,onChange:D=>N("location",D.target.value)})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"budget",children:"Budget"}),r.jsx(ne,{id:"budget",value:_.budget,onChange:D=>N("budget",D.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Projektzeitraum"}),r.jsxs(Ha,{children:[r.jsx(Va,{asChild:!0,children:r.jsxs(J,{variant:"outline",className:Oe("w-full justify-start text-left font-normal",!d&&"text-muted-foreground"),children:[r.jsx(zt,{className:"mr-2 h-4 w-4"}),d!=null&&d.from?d.to?r.jsxs(r.Fragment,{children:[We(d.from,"dd.MM.yyyy")," -"," ",We(d.to,"dd.MM.yyyy")]}):We(d.from,"dd.MM.yyyy"):r.jsx("span",{children:"Zeitraum auswählen"})]})}),r.jsx(da,{className:"w-auto p-0",align:"start",children:r.jsx(ua,{initialFocus:!0,mode:"range",defaultMonth:d==null?void 0:d.from,selected:d,onSelect:u,numberOfMonths:2,className:Oe("p-3 pointer-events-auto")})})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"status",children:"Status"}),r.jsxs(vt,{value:_.status,onValueChange:D=>N("status",D),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Anfrage",children:"Anfrage"}),r.jsx(ye,{value:"Besichtigung",children:"Besichtigung"}),r.jsx(ye,{value:"Planung",children:"Planung"}),r.jsx(ye,{value:"In Bearbeitung",children:"In Bearbeitung"}),r.jsx(ye,{value:"Abgeschlossen",children:"Abgeschlossen"})]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"progress",children:"Fortschritt (%)"}),r.jsx(ne,{id:"progress",type:"number",min:"0",max:"100",value:_.progress,onChange:D=>N("progress",parseInt(D.target.value))})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx("div",{className:"flex-1",children:r.jsx("div",{className:"relative",children:r.jsxs(J,{type:"button",variant:"destructive",className:"w-full relative overflow-hidden",onClick:()=>console.log("🖱️ Delete button clicked!"),onMouseDown:a?S:void 0,onMouseUp:a?A:void 0,onMouseLeave:a?A:void 0,onTouchStart:a?S:void 0,onTouchEnd:a?A:void 0,disabled:!a,children:[m&&r.jsx("div",{className:"absolute inset-0 bg-white/30 transition-all duration-100 ease-linear",style:{width:`${p}%`,left:0}}),r.jsx(Ua,{className:"h-4 w-4 mr-2 relative z-10"}),r.jsx("span",{className:"relative z-10",children:m?"Löschen...":"Projekt löschen"})]})})}),r.jsx(J,{type:"button",variant:"outline",onClick:e,children:"Abbrechen"}),r.jsx(J,{type:"submit",children:"Speichern"})]})]})]})})):null},Nee=({isOpen:t,onClose:e,project:n})=>{const[s,a]=g.useState([]),[i,o]=g.useState(!1),[c,d]=g.useState(""),[u,m]=g.useState(""),[f,p]=g.useState(""),[y,j]=g.useState(""),[v,_]=g.useState("geplant");g.useEffect(()=>{t&&n&&b(n.id)},[t,n]);const b=async N=>{o(!0),a([]),o(!1)},w=async N=>{N.preventDefault(),n&&c.trim()&&(console.log("Add task functionality not yet implemented"),d(""),m(""),p(""),j(""),_("geplant"),b(n.id))};return n?r.jsx(en,{open:t,onOpenChange:N=>!N&&e(),children:r.jsx(Gt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:r.jsxs(zr,{defaultValue:"overview",className:"w-full",children:[r.jsxs(rn,{className:"pb-2",children:[r.jsxs(sn,{children:[n.name," – Details"]}),r.jsxs(Er,{children:[r.jsx(Ge,{value:"overview",children:"Übersicht"}),r.jsx(Ge,{value:"tasks",children:"Teilaufgaben"})]})]}),r.jsx(Qe,{value:"overview",className:"mt-0",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Kunde"})}),r.jsx(ce,{children:n.customer})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Status"})}),r.jsx(ce,{children:n.status})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Budget"})}),r.jsx(ce,{children:n.budget||"n/a"})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Standort"})}),r.jsx(ce,{children:n.location||"n/a"})]})]})}),r.jsx(Qe,{value:"tasks",className:"mt-0",children:r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Aufgabenplan"}),i?r.jsx("p",{children:"Aufgaben werden geladen…"}):s.length===0?r.jsx("p",{children:"Keine Teilaufgaben vorhanden."}):r.jsx("ul",{className:"space-y-2",children:s.map(N=>r.jsxs("li",{className:"border rounded-md p-2",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium",children:N.name}),r.jsx("span",{className:"text-xs text-gray-500",children:N.status})]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N.description||"–"}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[N.start_date&&`Start: ${N.start_date}`," ",N.end_date&&`· Ende: ${N.end_date}`]})]},N.id))}),r.jsxs("form",{onSubmit:w,className:"mt-6 space-y-2",children:[r.jsx("h4",{className:"font-semibold",children:"Neue Aufgabe"}),r.jsx("input",{type:"text",className:"border rounded-md p-2 w-full",placeholder:"Name der Aufgabe",value:c,onChange:N=>d(N.target.value),required:!0}),r.jsx("textarea",{className:"border rounded-md p-2 w-full",placeholder:"Beschreibung",value:u,onChange:N=>m(N.target.value),rows:3}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"date",className:"border rounded-md p-2 flex-1",value:f,onChange:N=>p(N.target.value)}),r.jsx("input",{type:"date",className:"border rounded-md p-2 flex-1",value:y,onChange:N=>j(N.target.value)})]}),r.jsxs("select",{className:"border rounded-md p-2 w-full",value:v,onChange:N=>_(N.target.value),children:[r.jsx("option",{value:"geplant",children:"Geplant"}),r.jsx("option",{value:"in_bearbeitung",children:"In Bearbeitung"}),r.jsx("option",{value:"abgeschlossen",children:"Abgeschlossen"})]}),r.jsx(J,{type:"submit",className:"w-full",children:"Aufgabe hinzufügen"})]})]})})]})})}):null},See=({isOpen:t,onClose:e,projectId:n,onTimeEntryAdded:s})=>{const{toast:a}=Rt(),[i,o]=g.useState({work_date:new Date().toISOString().split("T")[0],start_time:"08:00",end_time:"17:00",task_description:"",category:"ausfuehrung"}),[c,d]=g.useState(new Date),[u,m]=g.useState(!1),[f,p]=g.useState(!1),y=async b=>{if(b.preventDefault(),!i.task_description.trim()){a({title:"Fehler",description:"Bitte geben Sie eine Tätigkeitsbeschreibung ein.",variant:"destructive"});return}if(i.start_time>=i.end_time){a({title:"Fehler",description:"Die Endzeit muss nach der Startzeit liegen.",variant:"destructive"});return}p(!0);try{const w=new Date(`${i.work_date}T${i.start_time}`),S=(new Date(`${i.work_date}T${i.end_time}`).getTime()-w.getTime())/(1e3*60*60),A={...i,work_date:We(c,"yyyy-MM-dd")};s(A),a({title:"Erfolg",description:`Arbeitszeit von ${S.toFixed(1)} Stunden erfasst.`}),o({work_date:new Date().toISOString().split("T")[0],start_time:"08:00",end_time:"17:00",task_description:"",category:"ausfuehrung"}),d(new Date),m(!1),e()}catch{a({title:"Fehler",description:"Arbeitszeit konnte nicht erfasst werden.",variant:"destructive"})}finally{p(!1)}},j=(b,w)=>{o(N=>({...N,[b]:w}))},_=(()=>{if(!i.start_time||!i.end_time)return 0;const b=new Date(`${i.work_date}T${i.start_time}`),w=new Date(`${i.work_date}T${i.end_time}`);return w<=b?0:(w.getTime()-b.getTime())/(1e3*60*60)})();return r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-md",children:[r.jsxs(rn,{children:[r.jsxs(sn,{className:"flex items-center gap-2",children:[r.jsx(hn,{className:"h-5 w-5"}),"Arbeitszeit erfassen"]}),r.jsx(Xn,{children:"Erfassen Sie Ihre Arbeitszeiten für dieses Projekt."})]}),r.jsxs("form",{onSubmit:y,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"work_date",children:"Arbeitsdatum *"}),r.jsxs(Ha,{children:[r.jsx(Va,{asChild:!0,children:r.jsxs(J,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[r.jsx(zt,{className:"mr-2 h-4 w-4"}),We(c,"dd.MM.yyyy",{locale:cn})]})}),r.jsx(da,{className:"w-auto p-0",align:"start",children:r.jsx(ua,{mode:"single",selected:c,onSelect:b=>{b&&(d(b),j("work_date",We(b,"yyyy-MM-dd")))},initialFocus:!0,locale:cn})})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"start_time",children:"Von *"}),r.jsx(ne,{id:"start_time",type:"time",value:i.start_time,onChange:b=>j("start_time",b.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"end_time",children:"Bis *"}),r.jsx(ne,{id:"end_time",type:"time",value:i.end_time,onChange:b=>j("end_time",b.target.value),required:!0})]})]}),r.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"Gesamtstunden:"}),r.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[_.toFixed(1),"h"]})]}),_>8&&r.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[r.jsx(Wa,{id:"overtime",checked:u,onCheckedChange:b=>m(b)}),r.jsxs("label",{htmlFor:"overtime",className:"text-sm text-orange-600 cursor-pointer",children:["Überstunden (",(_-8).toFixed(1),"h)"]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"category",children:"Kategorie *"}),r.jsxs(vt,{value:i.category,onValueChange:b=>j("category",b),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"planung",children:"Planung"}),r.jsx(ye,{value:"ausfuehrung",children:"Ausführung"}),r.jsx(ye,{value:"nacharbeit",children:"Nacharbeit"}),r.jsx(ye,{value:"dokumentation",children:"Dokumentation"}),r.jsx(ye,{value:"sonstiges",children:"Sonstiges"})]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"task_description",children:"Tätigkeitsbeschreibung *"}),r.jsx(En,{id:"task_description",placeholder:"Beschreiben Sie Ihre durchgeführten Arbeiten...",value:i.task_description,onChange:b=>j("task_description",b.target.value),rows:3,required:!0})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(J,{type:"button",variant:"outline",onClick:e,className:"flex-1",disabled:f,children:"Abbrechen"}),r.jsx(J,{type:"submit",className:"flex-1",disabled:f||_===0,children:f?"Speichern...":"Zeit erfassen"})]})]})]})})},kee=({isOpen:t,onClose:e,projectId:n,onMaterialEntryAdded:s})=>{const{toast:a}=Rt(),[i,o]=g.useState({entry_date:new Date().toISOString().split("T")[0],material_name:"",quantity:1,unit:"Stück",unit_cost:0,category:"baumaterial",supplier:""}),[c,d]=g.useState(new Date),[u,m]=g.useState(!1),f=async _=>{if(_.preventDefault(),!i.material_name.trim()){a({title:"Fehler",description:"Bitte geben Sie einen Materialnamen ein.",variant:"destructive"});return}if(i.quantity<=0){a({title:"Fehler",description:"Die Menge muss größer als 0 sein.",variant:"destructive"});return}if(i.unit_cost<0){a({title:"Fehler",description:"Der Stückpreis kann nicht negativ sein.",variant:"destructive"});return}m(!0);try{const b={...i,entry_date:We(c,"yyyy-MM-dd")};s(b);const w=i.quantity*i.unit_cost;a({title:"Erfolg",description:`Material im Wert von ${w.toFixed(2)}€ erfasst.`}),o({entry_date:new Date().toISOString().split("T")[0],material_name:"",quantity:1,unit:"Stück",unit_cost:0,category:"baumaterial",supplier:""}),d(new Date),e()}catch{a({title:"Fehler",description:"Material konnte nicht erfasst werden.",variant:"destructive"})}finally{m(!1)}},p=(_,b)=>{o(w=>({...w,[_]:b}))},j=i.quantity*i.unit_cost,v=["Stück","kg","g","Liter","ml","m","cm","mm","m²","cm²","Paket","Karton","Rolle","Meter","qm","Sack","Palette"];return r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-md",children:[r.jsxs(rn,{children:[r.jsxs(sn,{className:"flex items-center gap-2",children:[r.jsx(Ni,{className:"h-5 w-5"}),"Material erfassen"]}),r.jsx(Xn,{children:"Erfassen Sie verwendete Materialien für dieses Projekt."})]}),r.jsxs("form",{onSubmit:f,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"entry_date",children:"Datum *"}),r.jsxs(Ha,{children:[r.jsx(Va,{asChild:!0,children:r.jsxs(J,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[r.jsx(zt,{className:"mr-2 h-4 w-4"}),We(c,"dd.MM.yyyy",{locale:cn})]})}),r.jsx(da,{className:"w-auto p-0",align:"start",children:r.jsx(ua,{mode:"single",selected:c,onSelect:_=>{_&&(d(_),p("entry_date",We(_,"yyyy-MM-dd")))},initialFocus:!0,locale:cn})})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"material_name",children:"Materialname *"}),r.jsx(ne,{id:"material_name",placeholder:"z.B. Zement, Kabel, Schrauben...",value:i.material_name,onChange:_=>p("material_name",_.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"category",children:"Kategorie *"}),r.jsxs(vt,{value:i.category,onValueChange:_=>p("category",_),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"baumaterial",children:"Baumaterial"}),r.jsx(ye,{value:"werkzeug",children:"Werkzeug"}),r.jsx(ye,{value:"verbrauchsmaterial",children:"Verbrauchsmaterial"}),r.jsx(ye,{value:"sonstiges",children:"Sonstiges"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"quantity",children:"Menge *"}),r.jsx(ne,{id:"quantity",type:"number",min:"0.01",step:"0.01",value:i.quantity,onChange:_=>p("quantity",parseFloat(_.target.value)||0),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"unit",children:"Einheit *"}),r.jsxs(vt,{value:i.unit,onValueChange:_=>p("unit",_),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsx(gt,{children:v.map(_=>r.jsx(ye,{value:_,children:_},_))})]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"unit_cost",children:"Stückpreis (€) *"}),r.jsx(ne,{id:"unit_cost",type:"number",min:"0",step:"0.01",placeholder:"0.00",value:i.unit_cost,onChange:_=>p("unit_cost",parseFloat(_.target.value)||0),required:!0})]}),r.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ra,{className:"h-4 w-4 text-blue-600"}),r.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Gesamtkosten:"})]}),r.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[j.toFixed(2),"€"]})]}),r.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[i.quantity," ",i.unit," × ",i.unit_cost.toFixed(2),"€"]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"supplier",children:"Lieferant"}),r.jsx(ne,{id:"supplier",placeholder:"z.B. Baumarkt, Großhandel...",value:i.supplier,onChange:_=>p("supplier",_.target.value)})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(J,{type:"button",variant:"outline",onClick:e,className:"flex-1",disabled:u,children:"Abbrechen"}),r.jsx(J,{type:"submit",className:"flex-1",disabled:u||!i.material_name.trim()||i.quantity<=0,children:u?"Speichern...":"Material erfassen"})]})]})]})})},Cee=({isOpen:t,onClose:e,projectId:n})=>{const{toast:s}=Rt(),[a,i]=g.useState(null),[o,c]=g.useState(!0),[d,u]=g.useState("mitarbeiter"),[m,f]=g.useState({can_view:!1,can_edit_basic_data:!1,can_add_time:!1,can_add_materials:!1,can_upload_files:!1,can_change_status:!1,can_link_invoices:!1,can_delete:!1,can_manage_team:!1}),[p,y]=g.useState("overview"),[j,v]=g.useState(!1),[_,b]=g.useState(!1),[w,N]=g.useState(!1),[S,A]=g.useState([]);g.useEffect(()=>{t&&n&&E()},[t,n]);const E=async()=>{c(!0);try{const{data:Q}=await K.auth.getUser();if(!(Q!=null&&Q.user)){s({title:"Fehler",description:"Benutzer nicht authentifiziert",variant:"destructive"});return}const{data:z}=await K.from("profiles").select("company_id").eq("id",Q.user.id).single();if(!(z!=null&&z.company_id)){s({title:"Fehler",description:"Benutzer-Unternehmen nicht gefunden",variant:"destructive"});return}const{data:V,error:U}=await K.from("projects").select("*").eq("id",n).eq("company_id",z.company_id).single();if(U||!V){s({title:"Fehler",description:"Projekt nicht gefunden",variant:"destructive"});return}let O=null;if(V.customer_id){const{data:$e}=await K.from("customers").select("*").eq("id",V.customer_id).single();O=$e}const{data:I,error:H}=await K.from("time_entries").select("hours_worked").eq("project_id",n);H&&console.log("Time entries table might not exist yet:",H.message);const $=(I==null?void 0:I.reduce(($e,Me)=>$e+(Me.hours_worked||0),0))||0,{data:te,error:X}=await K.from("material_entries").select("total_cost").eq("project_id",n);X&&console.log("Material entries table might not exist yet:",X.message);const Z=(te==null?void 0:te.reduce(($e,Me)=>$e+(Me.total_cost||0),0))||0,{data:ie,error:pe}=await K.from("project_team_members").select("employee_id, employees!inner(first_name, last_name, email)").eq("project_id",n);pe&&console.log("Project team members table might not exist yet:",pe.message);const{data:G,error:se}=await K.from("project_comments").select("id").eq("project_id",n);se&&console.log("Project comments table might not exist yet:",se.message);const{data:me,error:he}=await K.from("project_documents").select("id").eq("project_id",n);he&&console.log("Project documents table might not exist yet:",he.message);const xe=V.budget||0,re=Z+$*50,_e=xe>0?Math.round(re/xe*100):0,be=new Date(V.start_date||new Date),Be=new Date(V.end_date||new Date),Ke=new Date,At=Math.max(0,Math.floor((Ke.getTime()-be.getTime())/(1e3*60*60*24))),je=Math.max(0,Math.floor((Be.getTime()-Ke.getTime())/(1e3*60*60*24))),De={id:V.id,company_id:V.company_id,project_name:V.name,customer_id:V.customer_id||"",start_date:V.start_date||new Date().toISOString().split("T")[0],planned_end_date:V.end_date||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],status:V.status??"geplant",project_address:V.address||V.location||V.project_address||(O==null?void 0:O.address)||"Nicht angegeben",project_description:V.description||"Keine Beschreibung",linked_invoices:[],linked_offers:[],created_at:V.created_at||new Date().toISOString(),updated_at:V.updated_at||new Date().toISOString(),created_by:Q.user.id,assigned_team:(ie==null?void 0:ie.map($e=>$e.employee_id))||[],customer:O?{company_name:O.company_name,contact_person:O.contact_person,email:O.email,phone:O.phone}:{company_name:"Unbekannter Kunde",contact_person:"Nicht verfügbar",email:"nicht-verfuegbar@example.com",phone:void 0},stats:{total_hours_logged:$>0?$:45.5,total_material_cost:Z>0?Z:2850,total_project_cost:xe||re||12750,budget_utilization:_e>0?_e:68,days_active:At,days_remaining:je,team_size:(ie==null?void 0:ie.length)||3,documents_count:(me==null?void 0:me.length)||8,comments_count:(G==null?void 0:G.length)||12,last_activity:new Date().toISOString()},recent_activities:[],team_members:(ie==null?void 0:ie.length)>0?ie.map($e=>({id:$e.employee_id,name:`${$e.employees.first_name} ${$e.employees.last_name}`.trim(),role:"team_member",email:$e.employees.email,hours_this_week:0})):[{id:"demo_1",name:"Max Mustermann",role:"projektleiter",email:"max@example.com",hours_this_week:32.5},{id:"demo_2",name:"Anna Schmidt",role:"admin",email:"anna@example.com",hours_this_week:28}],permissions:ZS("admin",!0)},Ie="admin";u(Ie),f(ZS(Ie,!0));const at=[];if(G&&G.length>0){const{data:$e}=await K.from("project_comments").select("id, content, created_at, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(5);$e&&$e.forEach(Me=>{at.push({id:`comment_${Me.id}`,project_id:n,event_type:"comment",title:"Neuer Kommentar hinzugefügt",description:Me.content.substring(0,100)+(Me.content.length>100?"...":""),user_name:`${Me.profiles.first_name} ${Me.profiles.last_name}`,user_role:"team_member",timestamp:Me.created_at})})}if(I&&I.length>0){const{data:$e}=await K.from("time_entries").select("id, hours_worked, work_date, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(3);$e&&$e.forEach(Me=>{at.push({id:`time_${Me.id}`,project_id:n,event_type:"time",title:"Arbeitszeit erfasst",description:`${Me.hours_worked}h am ${new Date(Me.work_date).toLocaleDateString("de-DE")}`,user_name:`${Me.profiles.first_name} ${Me.profiles.last_name}`,user_role:"team_member",timestamp:Me.work_date})})}if(te&&te.length>0){const{data:$e}=await K.from("material_entries").select("id, material_name, quantity, total_cost, created_at, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(3);$e&&$e.forEach(Me=>{at.push({id:`material_${Me.id}`,project_id:n,event_type:"material",title:"Material hinzugefügt",description:`${Me.material_name} (${Me.quantity}x) - ${Me.total_cost}€`,user_name:`${Me.profiles.first_name} ${Me.profiles.last_name}`,user_role:"team_member",timestamp:Me.created_at})})}at.sort(($e,Me)=>new Date(Me.timestamp).getTime()-new Date($e.timestamp).getTime()),De.recent_activities=at.length>0?at.slice(0,10):[{id:"demo_activity_1",project_id:n,event_type:"comment",title:"Neuer Kommentar hinzugefügt",description:"Materiallieferung für Freitag geplant",user_name:"Max Mustermann",user_role:"projektleiter",timestamp:new Date(Date.now()-2*60*60*1e3).toISOString()},{id:"demo_activity_2",project_id:n,event_type:"document",title:"Dokument hochgeladen",description:"Bauplan_Final.pdf",user_name:"Anna Schmidt",user_role:"admin",timestamp:new Date(Date.now()-6*60*60*1e3).toISOString()}],i(De)}catch(Q){console.error("Error fetching project data:",Q),s({title:"Fehler",description:"Projektdaten konnten nicht geladen werden",variant:"destructive"})}finally{c(!1)}},D=async()=>{var Q;try{const{data:z}=await K.auth.getUser();if(!(z!=null&&z.user))return;const{data:V}=await K.from("profiles").select("company_id").eq("id",z.user.id).single();if(!(V!=null&&V.company_id))return;const{data:U}=await K.from("employees").select("id, first_name, last_name, email, position, status").eq("company_id",V.company_id).eq("status","active"),O=((Q=a==null?void 0:a.team_members)==null?void 0:Q.map($=>$.id))||[];let I=[];const H=new Date().toISOString().split("T")[0];for(const $ of U||[]){if(O.includes($.id))continue;const{data:te}=await K.from("vacation_requests").select("*").eq("employee_id",$.id).in("status",["approved","pending"]).lte("start_date",H).gte("end_date",H);if(te&&te.length>0){I.push({...$,availability_status:"unavailable",reason:te[0].request_type==="vacation"?"Im Urlaub":"Krankgemeldet"});continue}const{data:X}=await K.from("project_team_members").select("project_id, projects!inner(start_date, end_date, name, status)").eq("employee_id",$.id).neq("project_id",n).in("projects.status",["in_bearbeitung","geplant"]);(X==null?void 0:X.some(ie=>{const pe=ie.projects.start_date,G=ie.projects.end_date,se=a==null?void 0:a.start_date,me=a==null?void 0:a.end_date;return!pe||!G||!se||!me?!1:pe<=me&&G>=se}))?I.push({...$,availability_status:"busy",reason:`In ${X==null?void 0:X.length} anderen Projekten`}):I.push({...$,availability_status:"available",reason:"Verfügbar"})}A(I)}catch(z){console.error("Error loading available employees:",z)}},M=async Q=>{try{const z=S.find(O=>O.id===Q);if(!z)return;const V={id:Q,name:`${z.first_name} ${z.last_name}`.trim(),role:z.position||"team_member",email:z.email,hours_this_week:0};i(O=>O?{...O,team_members:[...O.team_members||[],V]}:null),A(O=>O.filter(I=>I.id!==Q)),N(!1);const{error:U}=await K.from("project_team_members").insert({project_id:n,employee_id:Q,assigned_at:new Date().toISOString()});if(U){console.error("Error adding team member:",U),i(O=>O?{...O,team_members:O.team_members.filter(I=>I.id!==Q)}:null),A(O=>[...O,z]),s({title:"Fehler",description:"Team-Mitglied konnte nicht hinzugefügt werden",variant:"destructive"});return}s({title:"Erfolg",description:"Team-Mitglied wurde erfolgreich hinzugefügt"})}catch(z){console.error("Error adding team member:",z),s({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}},B=async Q=>{try{const z=a==null?void 0:a.team_members.find(U=>U.id===Q);if(!z)return;i(U=>U?{...U,team_members:U.team_members.filter(O=>O.id!==Q)}:null);const{error:V}=await K.from("project_team_members").delete().eq("project_id",n).eq("employee_id",Q);if(V){console.error("Error removing team member:",V),i(U=>U?{...U,team_members:[...U.team_members,z]}:null),s({title:"Fehler",description:"Team-Mitglied konnte nicht entfernt werden",variant:"destructive"});return}s({title:"Erfolg",description:"Team-Mitglied wurde erfolgreich entfernt"})}catch(z){console.error("Error removing team member:",z),s({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}},R=async Q=>{if(!(!a||!m.can_change_status))try{const{error:z}=await K.from("projects").update({status:Q}).eq("id",a.id);if(z)throw z;i(V=>V?{...V,status:Q}:null),s({title:"Erfolg",description:"Projektstatus wurde aktualisiert"})}catch{s({title:"Fehler",description:"Status konnte nicht geändert werden",variant:"destructive"})}},P=Q=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(Q),F=Q=>new Date(Q).toLocaleDateString("de-DE"),W=Q=>new Date(Q).toLocaleString("de-DE"),ee=Q=>GS[Q]||GS.geplant,ue=Q=>`P${Q.split("-").join("").substring(0,6).toUpperCase()}`;if(o)return r.jsx(en,{open:t,onOpenChange:e,children:r.jsx(Gt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Projektdaten werden geladen..."})]})})})});if(!a)return r.jsx(en,{open:t,onOpenChange:e,children:r.jsx(Gt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full",children:r.jsxs("div",{className:"text-center py-8",children:[r.jsx(kr,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Projekt nicht gefunden"}),r.jsx("p",{className:"text-gray-600",children:"Das angeforderte Projekt konnte nicht geladen werden."}),r.jsx(J,{onClick:e,className:"mt-4",children:"Schließen"})]})})});const de=ee(a.status);return console.log("Project status:",a.status,"Status config:",de),r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:[r.jsxs(zr,{value:p,onValueChange:y,className:"w-full",children:[r.jsxs(rn,{className:"pb-2",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{children:[r.jsxs(sn,{className:"text-2xl flex items-center gap-2",children:[r.jsx(fa,{className:"h-6 w-6"}),a.project_name]}),r.jsxs(Xn,{className:"flex items-center gap-4 mt-1",children:[r.jsxs(Ve,{className:`${de.bgColor} ${de.color} text-sm`,children:[de.icon," ",de.label]}),r.jsxs("span",{className:"text-gray-500",children:["ID: ",ue(a.id)]})]})]}),r.jsx("div",{className:"flex items-center gap-4",children:r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Budget / Genutzt"}),r.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[P(a.budget||0)," / ",P(a.stats.total_project_cost||0)]})]})})]}),r.jsxs(Er,{className:"grid w-full grid-cols-5 mb-4",children:[r.jsx(Ge,{value:"overview",children:"Übersicht"}),r.jsx(Ge,{value:"time",children:"Zeiten"}),r.jsx(Ge,{value:"materials",children:"Material"}),r.jsx(Ge,{value:"documents",children:"Dokumente"}),r.jsx(Ge,{value:"comments",children:"Kommentare"})]})]}),r.jsxs(Qe,{value:"overview",className:"space-y-4 min-h-[600px] mt-0",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Gesamtstunden"}),r.jsxs("p",{className:"text-2xl font-bold",children:[a.stats.total_hours_logged,"h"]})]}),r.jsx(hn,{className:"h-8 w-8 text-blue-500"})]})})}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Materialkosten"}),r.jsx("p",{className:"text-2xl font-bold",children:P(a.stats.total_material_cost)})]}),r.jsx(Fb,{className:"h-8 w-8 text-green-500"})]})})}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Budget-Nutzung"}),r.jsxs("p",{className:"text-2xl font-bold",children:[a.stats.budget_utilization,"%"]})]}),r.jsx(kr,{className:`h-8 w-8 ${a.stats.budget_utilization>80?"text-red-500":"text-yellow-500"}`})]})})}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Team-Größe"}),r.jsx("p",{className:"text-2xl font-bold",children:a.stats.team_size})]}),r.jsx(Si,{className:"h-8 w-8 text-purple-500"})]})})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Projektdetails"})}),r.jsxs(ce,{className:"space-y-4",children:[r.jsx("div",{className:"flex items-center justify-between mb-4",children:r.jsxs("div",{className:"flex items-center gap-6",children:[r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Start:"})," ",F(a.start_date)]}),r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Ende:"})," ",F(a.planned_end_date)]})]})}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Standort"}),r.jsxs("p",{className:"font-medium flex items-center gap-2",children:[r.jsx(sa,{className:"h-4 w-4"}),a.project_address]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Verbleibende Tage"}),r.jsxs("p",{className:"font-medium",children:[a.stats.days_remaining," Tage"]})]})]})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Kundeninformationen"})}),r.jsxs(ce,{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Unternehmen"}),r.jsx("p",{className:"font-medium",children:a.customer.company_name})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Ansprechpartner"}),r.jsx("p",{className:"font-medium",children:a.customer.contact_person})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(sr,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-sm",children:a.customer.email})]}),a.customer.phone&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Md,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-sm",children:a.customer.phone})]})]})]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center justify-between",children:["Team-Mitglieder",m.can_manage_team&&r.jsxs(J,{size:"sm",variant:"outline",onClick:()=>{D(),N(!0)},children:[r.jsx(dn,{className:"h-4 w-4 mr-1"}),"Hinzufügen"]})]})}),r.jsx(ce,{className:"space-y-3",children:a.team_members.map(Q=>r.jsx(le,{className:"shadow-soft rounded-2xl overflow-hidden",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{children:r.jsx("p",{className:"font-medium",children:Q.name})}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-sm font-medium",children:[Q.hours_this_week,"h"]}),r.jsx("p",{className:"text-xs text-gray-500",children:"diese Woche"})]}),m.can_manage_team&&r.jsx(J,{size:"sm",variant:"ghost",onClick:()=>B(Q.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:r.jsx(ar,{className:"h-4 w-4"})})]})]})})},Q.id))})]}),m.can_change_status&&r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Status ändern"})}),r.jsxs(ce,{className:"space-y-2",children:[de.previousStates&&de.previousStates.length>0&&r.jsxs(r.Fragment,{children:[de.previousStates.map(Q=>{const z=ee(Q);return r.jsxs(J,{variant:"outline",size:"sm",className:"w-full justify-start text-gray-600",onClick:()=>R(Q),children:[r.jsx("span",{className:"mr-2",children:"←"})," Zurück zu ",z.label]},Q)}),de.nextStates.length>0&&r.jsx("div",{className:"border-t my-2"})]}),de.nextStates.map(Q=>{const z=ee(Q);return r.jsxs(J,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>R(Q),children:[z.icon," ",z.label]},Q)})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Letzte Aktivitäten"})}),r.jsx(ce,{className:"space-y-3",children:a.recent_activities.map(Q=>r.jsxs("div",{className:"border-l-2 border-blue-200 pl-3",children:[r.jsx("p",{className:"text-sm font-medium",children:Q.title}),r.jsx("p",{className:"text-xs text-gray-600",children:Q.description}),r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsx("span",{className:"text-xs text-gray-500",children:Q.user_name}),r.jsx("span",{className:"text-xs text-gray-400",children:"•"}),r.jsx("span",{className:"text-xs text-gray-500",children:W(Q.timestamp)})]})]},Q.id))})]})]})]})]}),r.jsxs(Qe,{value:"time",className:"space-y-4 min-h-[600px] mt-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Zeiterfassung"}),m.can_add_time&&r.jsxs(J,{onClick:()=>v(!0),children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Zeit erfassen"]})]}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsx("p",{className:"text-gray-500",children:"Zeiteinträge werden hier angezeigt..."})})})]}),r.jsxs(Qe,{value:"materials",className:"space-y-4 min-h-[600px] mt-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Materialverwaltung"}),m.can_add_materials&&r.jsxs(J,{onClick:()=>b(!0),children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsx("p",{className:"text-gray-500",children:"Materialeinträge werden hier angezeigt..."})})})]}),r.jsxs(Qe,{value:"documents",className:"space-y-4 min-h-[600px] mt-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Dokumente"}),m.can_upload_files&&r.jsxs(J,{children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Datei hochladen"]})]}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsx("p",{className:"text-gray-500",children:"Projektdokumente werden hier angezeigt..."})})})]}),r.jsxs(Qe,{value:"comments",className:"space-y-4 min-h-[600px] mt-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Kommentare & Notizen"}),r.jsxs(J,{children:[r.jsx(Bb,{className:"h-4 w-4 mr-2"}),"Kommentar hinzufügen"]})]}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsx("p",{className:"text-gray-500",children:"Projektkommentare werden hier angezeigt..."})})})]})]}),r.jsx(See,{isOpen:j,onClose:()=>v(!1),projectId:a.id,onTimeEntryAdded:Q=>{console.log("Time entry added:",Q),s({title:"Erfolg",description:"Arbeitszeit wurde erfasst"})}}),r.jsx(kee,{isOpen:_,onClose:()=>b(!1),projectId:a.id,onMaterialEntryAdded:Q=>{console.log("Material entry added:",Q),s({title:"Erfolg",description:"Material wurde erfasst"})}}),w&&r.jsx(en,{open:w,onOpenChange:N,children:r.jsxs(Gt,{children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Team-Mitglied hinzufügen"}),r.jsx(Xn,{children:"Wählen Sie einen Mitarbeiter aus, der dem Projekt hinzugefügt werden soll."})]}),r.jsx("div",{className:"space-y-4",children:S.length===0?r.jsx("p",{className:"text-sm text-gray-500",children:"Keine verfügbaren Mitarbeiter gefunden oder alle sind bereits dem Projekt zugewiesen."}):r.jsx("div",{className:"space-y-2",children:S.map(Q=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:`w-3 h-3 rounded-full ${Q.availability_status==="available"?"bg-green-500":Q.availability_status==="busy"?"bg-yellow-500":"bg-red-500"}`,title:Q.reason})}),r.jsxs("div",{children:[r.jsxs("p",{className:"font-medium",children:[Q.first_name," ",Q.last_name]}),r.jsxs("p",{className:"text-sm text-gray-500",children:[Q.position,r.jsxs("span",{className:`ml-2 text-xs ${Q.availability_status==="available"?"text-green-600":Q.availability_status==="busy"?"text-yellow-600":"text-red-600"}`,children:["• ",Q.reason]})]})]})]}),r.jsx(J,{size:"sm",onClick:()=>M(Q.id),children:r.jsx(dn,{className:"h-4 w-4"})})]},Q.id))})})]})})]})})},Eee=({isOpen:t,onClose:e,projectId:n,projectName:s,customerId:a,onCalculationSaved:i})=>{const{toast:o}=Rt(),[c,d]=g.useState({projectId:n,projectName:s,customerId:a,materials:[],labor:[],subcontractors:[],travelCosts:0,travelDescription:"",safetyBuffer:10,profitMargin:20,materialCosts:0,laborCosts:0,subcontractorCosts:0,totalBaseCosts:0,totalCostsWithBuffer:0,finalPrice:0,notes:""});g.useEffect(()=>{t&&n&&u()},[t,n]);const u=async()=>{try{const{data:E}=await K.from("projects").select("description").eq("id",n).single();if(E!=null&&E.description){const D=E.description.match(/\[PRECALC:(.*?)\]/);if(D)try{const M=JSON.parse(D[1]);console.log("📊 Loading existing calculation:",M),d(B=>({...B,...M,projectId:n,projectName:s,customerId:a})),o({title:"Bestehende Kalkulation geladen",description:"Die vorhandene Vor-Kalkulation wurde geladen."})}catch(M){console.warn("Error parsing existing calculation:",M)}}}catch(E){console.error("Error loading existing calculation:",E)}};g.useEffect(()=>{m()},[c.materials,c.labor,c.subcontractors,c.travelCosts,c.safetyBuffer,c.profitMargin]);const m=()=>{const E=c.materials.reduce((F,W)=>{const ue=W.quantity*W.pricePerUnit*(1+W.markup/100);return F+ue},0),D=c.labor.reduce((F,W)=>F+W.hours*W.workers*W.hourlyRate,0),M=c.subcontractors.reduce((F,W)=>F+W.cost,0),B=E+D+M+c.travelCosts,R=B*(1+c.safetyBuffer/100),P=R*(1+c.profitMargin/100);d(F=>({...F,materialCosts:E,laborCosts:D,subcontractorCosts:M,totalBaseCosts:B,totalCostsWithBuffer:R,finalPrice:P}))},f=()=>{const E={id:Date.now().toString(),name:"",quantity:1,unit:"Stück",pricePerUnit:0,markup:15,totalCost:0,isEstimate:!1};d(D=>({...D,materials:[...D.materials,E]}))},p=()=>{const E={id:Date.now().toString(),description:"",hours:8,workers:1,hourlyRate:45,totalCost:0,isEstimate:!1};d(D=>({...D,labor:[...D.labor,E]}))},y=()=>{const E={id:Date.now().toString(),description:"",supplier:"",cost:0};d(D=>({...D,subcontractors:[...D.subcontractors,E]}))},j=E=>{d(D=>({...D,materials:D.materials.filter(M=>M.id!==E)}))},v=E=>{d(D=>({...D,labor:D.labor.filter(M=>M.id!==E)}))},_=E=>{d(D=>({...D,subcontractors:D.subcontractors.filter(M=>M.id!==E)}))},b=(E,D,M)=>{d(B=>({...B,materials:B.materials.map(R=>R.id===E?{...R,[D]:M}:R)}))},w=(E,D,M)=>{d(B=>({...B,labor:B.labor.map(R=>R.id===E?{...R,[D]:M}:R)}))},N=(E,D,M)=>{d(B=>({...B,subcontractors:B.subcontractors.map(R=>R.id===E?{...R,[D]:M}:R)}))},S=async()=>{try{const E={...c,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if((c.isEstimate||c.materials.some(F=>F.isEstimate))&&!await sV({projectId:n,estimate:E,userId:void 0}))return;const D=`[PRECALC:${JSON.stringify(E)}]`,M={},{data:B}=await K.from("projects").select("description, budget").eq("id",n).single();let R=D;B!=null&&B.description&&!B.description.includes("[PRECALC:")?R=`${B.description} ${D}`:B!=null&&B.description&&B.description.includes("[PRECALC:")&&(R=B.description.replace(/\[PRECALC:.*?\]/,D)),M.description=R,M.budget=Math.round(c.finalPrice),console.log("💰 Setting project budget to:",M.budget);const{error:P}=await K.from("projects").update(M).eq("id",n);if(P)throw P;o({title:"Vor-Kalkulation gespeichert",description:`Budget wurde auf €${c.finalPrice.toFixed(2)} gesetzt`}),i==null||i(E),e()}catch(E){console.error("Error saving pre-calculation:",E),o({title:"Fehler",description:"Vor-Kalkulation konnte nicht gespeichert werden",variant:"destructive"})}},A=E=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(E);return r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(rn,{children:[r.jsxs(sn,{className:"flex items-center gap-2",children:[r.jsx(ra,{className:"h-5 w-5"}),"Vor-Kalkulation: ",s]}),r.jsx(Xn,{children:"Detaillierte Kostenberechnung für das Projekt erstellen"})]}),r.jsxs(zr,{defaultValue:"materials",className:"w-full",children:[r.jsxs(Er,{className:"grid w-full grid-cols-5",children:[r.jsx(Ge,{value:"materials",children:"Material"}),r.jsx(Ge,{value:"labor",children:"Arbeitszeit"}),r.jsx(Ge,{value:"subcontractors",children:"Fremdleistungen"}),r.jsx(Ge,{value:"costs",children:"Zusatzkosten"}),r.jsx(Ge,{value:"summary",children:"Zusammenfassung"})]}),r.jsxs(Qe,{value:"materials",className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Materialkosten"}),r.jsxs(J,{onClick:f,size:"sm",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),r.jsxs("div",{className:"space-y-4",children:[c.materials.map((E,D)=>r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"grid grid-cols-8 gap-4 items-center",children:[r.jsxs("div",{children:[r.jsx(Y,{children:"Material"}),r.jsx(ne,{value:E.name,onChange:M=>b(E.id,"name",M.target.value),placeholder:"z.B. Fliesen 30x30cm"})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Menge"}),r.jsx(ne,{type:"number",value:E.quantity,onChange:M=>b(E.id,"quantity",parseFloat(M.target.value)||0)})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Einheit"}),r.jsxs(vt,{value:E.unit,onValueChange:M=>b(E.id,"unit",M),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Stück",children:"Stück"}),r.jsx(ye,{value:"m²",children:"m²"}),r.jsx(ye,{value:"m",children:"m"}),r.jsx(ye,{value:"kg",children:"kg"}),r.jsx(ye,{value:"l",children:"l"}),r.jsx(ye,{value:"Paket",children:"Paket"})]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Preis/Einheit"}),r.jsx(ne,{type:"number",step:"0.01",value:E.pricePerUnit,onChange:M=>b(E.id,"pricePerUnit",parseFloat(M.target.value)||0)})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Aufschlag %"}),r.jsx(ne,{type:"number",value:E.markup,onChange:M=>b(E.id,"markup",parseFloat(M.target.value)||0)})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Gesamt"}),r.jsx("div",{className:"font-bold",children:A(E.quantity*E.pricePerUnit*(1+E.markup/100))})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Schätzung"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Wa,{checked:E.isEstimate,onCheckedChange:M=>b(E.id,"isEstimate",M)}),r.jsx("span",{className:"text-sm text-gray-600",children:E.isEstimate?"Schätzung":"Bestätigt"})]})]}),r.jsx("div",{children:r.jsx(J,{variant:"outline",size:"sm",onClick:()=>j(E.id),className:"text-red-600",children:r.jsx(Ua,{className:"h-4 w-4"})})})]})})},E.id)),c.materials.length===0&&r.jsx("div",{className:"text-center text-gray-500 py-8",children:'Noch keine Materialien hinzugefügt. Klicken Sie auf "Material hinzufügen" um zu beginnen.'})]}),r.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-semibold",children:"Gesamte Materialkosten:"}),r.jsx("span",{className:"text-xl font-bold text-blue-600",children:A(c.materialCosts)})]})})]}),r.jsxs(Qe,{value:"labor",className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Arbeitszeit & Lohnkosten"}),r.jsxs(J,{onClick:p,size:"sm",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Arbeitsposition hinzufügen"]})]}),r.jsxs("div",{className:"space-y-4",children:[c.labor.map(E=>r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"grid grid-cols-7 gap-4 items-center",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx(Y,{children:"Arbeitsposition"}),r.jsx(ne,{value:E.description,onChange:D=>w(E.id,"description",D.target.value),placeholder:"z.B. Fliesen verlegen"})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Stunden"}),r.jsx(ne,{type:"number",step:"0.5",value:E.hours,onChange:D=>w(E.id,"hours",parseFloat(D.target.value)||0)})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Personen"}),r.jsx(ne,{type:"number",value:E.workers,onChange:D=>w(E.id,"workers",parseInt(D.target.value)||1)})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"€/Stunde"}),r.jsx(ne,{type:"number",step:"0.01",value:E.hourlyRate,onChange:D=>w(E.id,"hourlyRate",parseFloat(D.target.value)||0)})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Gesamt"}),r.jsx("div",{className:"font-bold",children:A(E.hours*E.workers*E.hourlyRate)})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Schätzung"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Wa,{checked:E.isEstimate,onCheckedChange:D=>w(E.id,"isEstimate",D)}),r.jsx("span",{className:"text-sm text-gray-600",children:E.isEstimate?"Schätzung":"Bestätigt"})]}),r.jsx(J,{variant:"outline",size:"sm",onClick:()=>v(E.id),className:"text-red-600 mt-2",children:r.jsx(Ua,{className:"h-4 w-4"})})]})]})})},E.id)),c.labor.length===0&&r.jsx("div",{className:"text-center text-gray-500 py-8",children:"Noch keine Arbeitspositionen hinzugefügt."})]}),r.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-semibold",children:"Gesamte Lohnkosten:"}),r.jsx("span",{className:"text-xl font-bold text-green-600",children:A(c.laborCosts)})]})})]}),r.jsxs(Qe,{value:"subcontractors",className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Fremdleistungen & Subunternehmer"}),r.jsxs(J,{onClick:y,size:"sm",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Fremdleistung hinzufügen"]})]}),r.jsxs("div",{className:"space-y-4",children:[c.subcontractors.map(E=>r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx(Y,{children:"Leistung"}),r.jsx(ne,{value:E.description,onChange:D=>N(E.id,"description",D.target.value),placeholder:"z.B. Elektroinstallation"})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Anbieter"}),r.jsx(ne,{value:E.supplier,onChange:D=>N(E.id,"supplier",D.target.value),placeholder:"Firma/Name"})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Kosten"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(ne,{type:"number",step:"0.01",value:E.cost,onChange:D=>N(E.id,"cost",parseFloat(D.target.value)||0)}),r.jsx(J,{variant:"outline",size:"sm",onClick:()=>_(E.id),className:"text-red-600",children:r.jsx(Ua,{className:"h-4 w-4"})})]})]})]})})},E.id)),c.subcontractors.length===0&&r.jsx("div",{className:"text-center text-gray-500 py-8",children:"Noch keine Fremdleistungen hinzugefügt."})]}),r.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-semibold",children:"Gesamte Fremdleistungen:"}),r.jsx("span",{className:"text-xl font-bold text-purple-600",children:A(c.subcontractorCosts)})]})})]}),r.jsxs(Qe,{value:"costs",className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Zusatzkosten & Zuschläge"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Fahrtkosten"})}),r.jsxs(ce,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{children:"Beschreibung"}),r.jsx(ne,{value:c.travelDescription,onChange:E=>d(D=>({...D,travelDescription:E.target.value})),placeholder:"z.B. 50km Anfahrt × 2 Fahrten"})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Kosten"}),r.jsx(ne,{type:"number",step:"0.01",value:c.travelCosts,onChange:E=>d(D=>({...D,travelCosts:parseFloat(E.target.value)||0}))})]})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Zuschläge & Margen"})}),r.jsxs(ce,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{children:"Sicherheitszuschlag (%)"}),r.jsx(ne,{type:"number",value:c.safetyBuffer,onChange:E=>d(D=>({...D,safetyBuffer:parseFloat(E.target.value)||0}))}),r.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Üblich: 5-15% für unvorhergesehene Kosten"})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Gewinnmarge (%)"}),r.jsx(ne,{type:"number",value:c.profitMargin,onChange:E=>d(D=>({...D,profitMargin:parseFloat(E.target.value)||0}))}),r.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Üblich: 15-25% je nach Wettbewerb"})]})]})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Notizen & Bemerkungen"})}),r.jsx(ce,{children:r.jsx(En,{value:c.notes,onChange:E=>d(D=>({...D,notes:E.target.value})),placeholder:"Zusätzliche Hinweise zur Kalkulation...",rows:4})})]})]}),r.jsxs(Qe,{value:"summary",className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Kalkulationsergebnis"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Kostenaufstellung"})}),r.jsxs(ce,{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Materialkosten:"}),r.jsx("span",{className:"font-medium",children:A(c.materialCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Lohnkosten:"}),r.jsx("span",{className:"font-medium",children:A(c.laborCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fremdleistungen:"}),r.jsx("span",{className:"font-medium",children:A(c.subcontractorCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fahrtkosten:"}),r.jsx("span",{className:"font-medium",children:A(c.travelCosts)})]}),r.jsx("hr",{}),r.jsxs("div",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Grundkosten:"}),r.jsx("span",{children:A(c.totalBaseCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:["+ Sicherheit (",c.safetyBuffer,"%):"]}),r.jsx("span",{children:A(c.totalCostsWithBuffer-c.totalBaseCosts)})]}),r.jsxs("div",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Kosten mit Puffer:"}),r.jsx("span",{children:A(c.totalCostsWithBuffer)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:["+ Gewinn (",c.profitMargin,"%):"]}),r.jsx("span",{children:A(c.finalPrice-c.totalCostsWithBuffer)})]}),r.jsx("hr",{className:"border-2"}),r.jsxs("div",{className:"flex justify-between text-xl font-bold text-green-600",children:[r.jsx("span",{children:"Verkaufspreis:"}),r.jsx("span",{children:A(c.finalPrice)})]})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Kennzahlen"})}),r.jsxs(ce,{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Materialanteil:"}),r.jsxs("span",{children:[(c.materialCosts/c.totalBaseCosts*100||0).toFixed(1),"%"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Lohnanteil:"}),r.jsxs("span",{children:[(c.laborCosts/c.totalBaseCosts*100||0).toFixed(1),"%"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fremdleistungsanteil:"}),r.jsxs("span",{children:[(c.subcontractorCosts/c.totalBaseCosts*100||0).toFixed(1),"%"]})]}),r.jsx("hr",{}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Deckungsbeitrag:"}),r.jsx("span",{className:"font-medium",children:A(c.finalPrice-c.totalBaseCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Deckungsgrad:"}),r.jsxs("span",{children:[((c.finalPrice/c.totalBaseCosts-1)*100||0).toFixed(1),"%"]})]})]})]})]}),c.notes&&r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Notizen"})}),r.jsx(ce,{children:r.jsx("div",{className:"whitespace-pre-wrap text-sm",children:c.notes})})]})]})]}),r.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[r.jsx(J,{variant:"outline",onClick:e,children:"Abbrechen"}),r.jsx("div",{className:"flex gap-2",children:r.jsxs(J,{onClick:S,className:"flex items-center gap-2",children:[r.jsx(Zp,{className:"h-4 w-4"}),"Kalkulation speichern"]})})]})]})})};function Aee(t,e=[]){let n=[];function s(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:y,...j}=f,v=(p==null?void 0:p[t][d])||c,_=g.useMemo(()=>j,Object.values(j));return r.jsx(v.Provider,{value:_,children:y})}function m(f,p){const y=(p==null?void 0:p[t][d])||c,j=g.useContext(y);if(j)return j;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[s,Pee(a,...e)]}function Pee(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var p1="Progress",g1=100,[Dee,pae]=Aee(p1),[Tee,Mee]=Dee(p1),Z3=g.forwardRef((t,e)=>{const{__scopeProgress:n,value:s=null,max:a,getValueLabel:i=Ree,...o}=t;(a||a===0)&&!DC(a)&&console.error(Iee(`${a}`,"Progress"));const c=DC(a)?a:g1;s!==null&&!TC(s,c)&&console.error(Oee(`${s}`,"Progress"));const d=TC(s,c)?s:null,u=k0(d)?i(d,c):void 0;return r.jsx(Tee,{scope:n,value:d,max:c,children:r.jsx(Xe.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":k0(d)?d:void 0,"aria-valuetext":u,role:"progressbar","data-state":Y3(d,c),"data-value":d??void 0,"data-max":c,...o,ref:e})})});Z3.displayName=p1;var G3="ProgressIndicator",Q3=g.forwardRef((t,e)=>{const{__scopeProgress:n,...s}=t,a=Mee(G3,n);return r.jsx(Xe.div,{"data-state":Y3(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...s,ref:e})});Q3.displayName=G3;function Ree(t,e){return`${Math.round(t/e*100)}%`}function Y3(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function k0(t){return typeof t=="number"}function DC(t){return k0(t)&&!isNaN(t)&&t>0}function TC(t,e){return k0(t)&&!isNaN(t)&&t<=e&&t>=0}function Iee(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${g1}\`.`}function Oee(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${g1} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var X3=Z3,Lee=Q3;const kd=g.forwardRef(({className:t,value:e,...n},s)=>r.jsx(X3,{ref:s,className:Oe("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:r.jsx(Lee,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));kd.displayName=X3.displayName;const Fee=({isOpen:t,onClose:e,projectId:n,projectName:s})=>{const{toast:a}=Rt(),[i,o]=g.useState(null),[c,d]=g.useState(null),[u,m]=g.useState(!0);g.useEffect(()=>{t&&n&&f()},[t,n]);const f=async()=>{m(!0);try{const{data:b,error:w}=await K.from("projects").select("*").eq("id",n).single();if(w||!b)throw new Error("Projekt nicht gefunden");let N=null;if(b.description){const ee=b.description.match(/\[PRECALC:(.*?)\]/);if(ee)try{N=JSON.parse(ee[1]),d(N)}catch(ue){console.warn("Fehler beim Parsen der Vor-Kalkulation:",ue)}}const S=[{hours:45,hourlyRate:45,cost:45*45},{hours:12,hourlyRate:55,cost:12*55}],A=[{name:"Fliesen",cost:850},{name:"Kleber",cost:120},{name:"Fugenmasse",cost:75}],E=N||{materialCosts:0,laborCosts:0,subcontractorCosts:0,travelCosts:0,totalBaseCosts:0,finalPrice:b.budget||0,profitMargin:20},D=A.reduce((ee,ue)=>ee+ue.cost,0),M=S.reduce((ee,ue)=>ee+ue.cost,0),B=D+M,R=b.budget||E.finalPrice,P=R-B,F=R>0?P/R*100:0,W={project:b,plannedMaterialCosts:E.materialCosts||0,plannedLaborCosts:E.laborCosts||0,plannedSubcontractorCosts:E.subcontractorCosts||0,plannedTravelCosts:E.travelCosts||0,plannedTotalCosts:E.totalBaseCosts||0,plannedPrice:E.finalPrice||0,plannedProfit:(E.finalPrice||0)-(E.totalBaseCosts||0),plannedProfitMargin:E.profitMargin||20,actualMaterialCosts:D,actualLaborCosts:M,actualSubcontractorCosts:0,actualTravelCosts:50,actualTotalCosts:B,actualPrice:R,actualProfit:P,actualProfitMargin:F,materialDeviation:D-(E.materialCosts||0),laborDeviation:M-(E.laborCosts||0),subcontractorDeviation:0,totalCostDeviation:B-(E.totalBaseCosts||0),profitDeviation:P-((E.finalPrice||0)-(E.totalBaseCosts||0)),budgetUtilization:E.totalBaseCosts>0?B/E.totalBaseCosts*100:0,efficiency:E.laborCosts>0?E.laborCosts/M*100:100,status:P>0?"profitable":P===0?"break_even":"loss"};o(W)}catch(b){console.error("Fehler beim Laden der Rentabilitätsdaten:",b),a({title:"Fehler",description:"Rentabilitätsdaten konnten nicht geladen werden",variant:"destructive"})}finally{m(!1)}},p=b=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(b),y=(b,w=1)=>`${b.toFixed(w)}%`,j=b=>b>0?"text-red-600":b<0?"text-green-600":"text-gray-600",v=b=>b>0?r.jsx(Ao,{className:"h-4 w-4 text-red-600"}):b<0?r.jsx(zb,{className:"h-4 w-4 text-green-600"}):r.jsx(Lr,{className:"h-4 w-4 text-gray-600"}),_=b=>{switch(b){case"profitable":return r.jsx(Ve,{className:"bg-green-100 text-green-800",children:"Rentabel"});case"break_even":return r.jsx(Ve,{className:"bg-yellow-100 text-yellow-800",children:"Break-Even"});case"loss":return r.jsx(Ve,{className:"bg-red-100 text-red-800",children:"Verlust"});default:return r.jsx(Ve,{variant:"outline",children:"Unbekannt"})}};return u?r.jsx(en,{open:t,onOpenChange:e,children:r.jsx(Gt,{className:"max-w-4xl",children:r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Rentabilitätsdaten werden geladen..."})]})})})}):i?r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(rn,{children:[r.jsxs(sn,{className:"flex items-center gap-2",children:[r.jsx(ra,{className:"h-5 w-5"}),"Nachkalkulation & Rentabilität: ",s]}),r.jsxs(Xn,{className:"flex items-center gap-4",children:[r.jsx("span",{children:"Vergleich von geplanten und tatsächlichen Kosten"}),_(i.status)]})]}),r.jsxs(zr,{defaultValue:"overview",className:"w-full",children:[r.jsxs(Er,{className:"grid w-full grid-cols-5",children:[r.jsx(Ge,{value:"overview",children:"Übersicht"}),r.jsx(Ge,{value:"costs",children:"Kostenanalyse"}),r.jsx(Ge,{value:"estimates",children:"Schätzungen vs. Ist"}),r.jsx(Ge,{value:"deviations",children:"Abweichungen"}),r.jsx(Ge,{value:"kpis",children:"Kennzahlen"})]}),r.jsxs(Qe,{value:"overview",className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-3",children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(Fb,{className:"h-5 w-5 text-green-600"}),"Gewinn"]})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Geplant:"}),r.jsx("span",{children:p(i.plannedProfit)})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Tatsächlich:"}),r.jsx("span",{className:i.actualProfit>=0?"text-green-600 font-semibold":"text-red-600 font-semibold",children:p(i.actualProfit)})]}),r.jsxs("div",{className:"flex justify-between items-center text-sm border-t pt-2",children:[r.jsx("span",{className:"text-gray-600",children:"Abweichung:"}),r.jsxs("div",{className:"flex items-center gap-1",children:[v(i.profitDeviation),r.jsx("span",{className:j(i.profitDeviation),children:p(Math.abs(i.profitDeviation))})]})]})]})})]}),r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-3",children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(Ni,{className:"h-5 w-5 text-blue-600"}),"Budget-Nutzung"]})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Geplante Kosten:"}),r.jsx("span",{children:p(i.plannedTotalCosts)})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Tatsächliche Kosten:"}),r.jsx("span",{children:p(i.actualTotalCosts)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Auslastung:"}),r.jsx("span",{className:i.budgetUtilization>100?"text-red-600 font-semibold":"text-green-600",children:y(i.budgetUtilization)})]}),r.jsx(kd,{value:Math.min(i.budgetUtilization,100),className:"h-2"})]})]})})]}),r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-3",children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(hn,{className:"h-5 w-5 text-purple-600"}),"Arbeitseffizienz"]})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Geplante Stunden:"}),r.jsxs("span",{children:[(i.plannedLaborCosts/45).toFixed(1),"h"]})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Tatsächliche Stunden:"}),r.jsxs("span",{children:[(i.actualLaborCosts/45).toFixed(1),"h"]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Effizienz:"}),r.jsx("span",{className:i.efficiency>=100?"text-green-600 font-semibold":"text-orange-600",children:y(i.efficiency)})]}),r.jsx(kd,{value:Math.min(i.efficiency,100),className:"h-2"})]})]})})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Projekt-Zusammenfassung"})}),r.jsx(ce,{children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p(i.actualPrice)}),r.jsx("div",{className:"text-sm text-gray-600",children:"Verkaufspreis"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:p(i.actualTotalCosts)}),r.jsx("div",{className:"text-sm text-gray-600",children:"Gesamtkosten"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:`text-2xl font-bold ${i.actualProfit>=0?"text-green-600":"text-red-600"}`,children:p(i.actualProfit)}),r.jsx("div",{className:"text-sm text-gray-600",children:"Gewinn/Verlust"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:`text-2xl font-bold ${i.actualProfitMargin>=0?"text-green-600":"text-red-600"}`,children:y(i.actualProfitMargin)}),r.jsx("div",{className:"text-sm text-gray-600",children:"Gewinnmarge"})]})]})})]})]}),r.jsx(Qe,{value:"costs",className:"space-y-6",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Geplante Kosten"})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Material:"}),r.jsx("span",{children:p(i.plannedMaterialCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Lohn:"}),r.jsx("span",{children:p(i.plannedLaborCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fremdleistungen:"}),r.jsx("span",{children:p(i.plannedSubcontractorCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fahrtkosten:"}),r.jsx("span",{children:p(i.plannedTravelCosts)})]}),r.jsx("hr",{}),r.jsxs("div",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Gesamt:"}),r.jsx("span",{children:p(i.plannedTotalCosts)})]})]})})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Tatsächliche Kosten"})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Material:"}),r.jsx("span",{children:p(i.actualMaterialCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Lohn:"}),r.jsx("span",{children:p(i.actualLaborCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fremdleistungen:"}),r.jsx("span",{children:p(i.actualSubcontractorCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fahrtkosten:"}),r.jsx("span",{children:p(i.actualTravelCosts)})]}),r.jsx("hr",{}),r.jsxs("div",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Gesamt:"}),r.jsx("span",{children:p(i.actualTotalCosts)})]})]})})]})]})}),r.jsx(Qe,{value:"estimates",className:"space-y-6",children:r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(ra,{className:"h-5 w-5 text-blue-600"}),"Schätzungen vs. Bestätigte Werte vs. Tatsächlicher Verbrauch"]}),r.jsx(CardDescription,{children:"Vergleich zwischen geschätzten Werten, bestätigten Planungswerten und dem tatsächlichen Materialverbrauch"})]}),r.jsx(ce,{children:c?r.jsxs("div",{className:"space-y-6",children:[c.materials&&c.materials.length>0&&r.jsxs("div",{children:[r.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[r.jsx(Ni,{className:"h-4 w-4"}),"Material-Vergleich"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-6 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[r.jsx("span",{children:"Material"}),r.jsx("span",{children:"Geplant"}),r.jsx("span",{children:"Status"}),r.jsx("span",{children:"Tatsächlich"}),r.jsx("span",{children:"Abweichung"}),r.jsx("span",{children:"Typ"})]}),c.materials.map((b,w)=>{const N=w===0?850:w===1?120:95,S=b.quantity*b.pricePerUnit*(1+b.markup/100),A=N-S;return r.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-b",children:[r.jsx("span",{className:"text-sm",children:b.name||"Material "+(w+1)}),r.jsx("span",{className:"text-sm",children:p(S)}),r.jsx("div",{children:b.isEstimate?r.jsx(Ve,{variant:"outline",className:"text-orange-600 border-orange-600 text-xs",children:"Schätzung"}):r.jsx(Ve,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Bestätigt"})}),r.jsx("span",{className:"text-sm",children:p(N)}),r.jsxs("div",{className:"flex items-center gap-1",children:[v(A),r.jsx("span",{className:`text-sm ${j(A)}`,children:p(Math.abs(A))})]}),r.jsxs("span",{className:"text-xs text-gray-500",children:[b.unit," (",b.quantity,"x)"]})]},b.id)})]})]}),c.labor&&c.labor.length>0&&r.jsxs("div",{children:[r.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[r.jsx(Si,{className:"h-4 w-4"}),"Arbeitszeit-Vergleich"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-6 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[r.jsx("span",{children:"Arbeitsposition"}),r.jsx("span",{children:"Geplant"}),r.jsx("span",{children:"Status"}),r.jsx("span",{children:"Tatsächlich"}),r.jsx("span",{children:"Abweichung"}),r.jsx("span",{children:"Details"})]}),c.labor.map((b,w)=>{const N=w===0?2025:660,S=b.hours*b.workers*b.hourlyRate,A=N-S;return r.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-b",children:[r.jsx("span",{className:"text-sm",children:b.description||"Arbeitsposition "+(w+1)}),r.jsx("span",{className:"text-sm",children:p(S)}),r.jsx("div",{children:b.isEstimate?r.jsx(Ve,{variant:"outline",className:"text-orange-600 border-orange-600 text-xs",children:"Schätzung"}):r.jsx(Ve,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Bestätigt"})}),r.jsx("span",{className:"text-sm",children:p(N)}),r.jsxs("div",{className:"flex items-center gap-1",children:[v(A),r.jsx("span",{className:`text-sm ${j(A)}`,children:p(Math.abs(A))})]}),r.jsxs("span",{className:"text-xs text-gray-500",children:[b.hours,"h × ",b.workers," Pers."]})]},b.id)})]})]}),r.jsxs("div",{className:"mt-6",children:[r.jsx("h4",{className:"font-semibold mb-4",children:"Schätzungsgenauigkeit"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx(le,{className:"bg-orange-50",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:c.materials?c.materials.filter(b=>b.isEstimate).length:0}),r.jsx("div",{className:"text-sm text-orange-700",children:"Material-Schätzungen"})]})})}),r.jsx(le,{className:"bg-green-50",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.materials?c.materials.filter(b=>!b.isEstimate).length:0}),r.jsx("div",{className:"text-sm text-green-700",children:"Bestätigte Materialien"})]})})}),r.jsx(le,{className:"bg-blue-50",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[c.materials&&c.labor?Math.round(100-Math.abs(i.totalCostDeviation)/i.plannedTotalCosts*100):0,"%"]}),r.jsx("div",{className:"text-sm text-blue-700",children:"Gesamt-Genauigkeit"})]})})})]})]}),r.jsx("div",{className:"mt-6",children:r.jsxs(le,{className:"bg-blue-50",children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center gap-2 text-blue-700",children:[r.jsx(kr,{className:"h-5 w-5"}),"Empfehlungen für zukünftige Schätzungen"]})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-2 text-blue-700",children:[r.jsx("p",{children:"• Als Schätzung markierte Positionen sollten vor Projektbeginn noch einmal überprüft werden"}),r.jsx("p",{children:"• Verwenden Sie bestätigte Werte aus ähnlichen abgeschlossenen Projekten"}),r.jsx("p",{children:"• Planen Sie für geschätzte Positionen einen höheren Sicherheitspuffer ein"}),r.jsx("p",{children:"• Dokumentieren Sie Abweichungen zwischen Schätzungen und tatsächlichen Werten für bessere zukünftige Kalkulationen"})]})})]})})]}):r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(ra,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Vor-Kalkulation verfügbar"}),r.jsx("p",{children:"Für dieses Projekt wurde keine detaillierte Vor-Kalkulation mit Schätzungsmarkierungen erstellt."})]})})]})}),r.jsxs(Qe,{value:"deviations",className:"space-y-6",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Kostenabweichungen"})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[r.jsx("span",{children:"Kategorie"}),r.jsx("span",{children:"Geplant"}),r.jsx("span",{children:"Tatsächlich"}),r.jsx("span",{children:"Abweichung"})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[r.jsx("span",{children:"Material"}),r.jsx("span",{children:p(i.plannedMaterialCosts)}),r.jsx("span",{children:p(i.actualMaterialCosts)}),r.jsxs("div",{className:"flex items-center gap-2",children:[v(i.materialDeviation),r.jsx("span",{className:j(i.materialDeviation),children:p(Math.abs(i.materialDeviation))})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[r.jsx("span",{children:"Lohn"}),r.jsx("span",{children:p(i.plannedLaborCosts)}),r.jsx("span",{children:p(i.actualLaborCosts)}),r.jsxs("div",{className:"flex items-center gap-2",children:[v(i.laborDeviation),r.jsx("span",{className:j(i.laborDeviation),children:p(Math.abs(i.laborDeviation))})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center border-t pt-2",children:[r.jsx("span",{className:"font-semibold",children:"Gesamtabweichung"}),r.jsx("span",{className:"font-semibold",children:p(i.plannedTotalCosts)}),r.jsx("span",{className:"font-semibold",children:p(i.actualTotalCosts)}),r.jsxs("div",{className:"flex items-center gap-2",children:[v(i.totalCostDeviation),r.jsx("span",{className:`font-semibold ${j(i.totalCostDeviation)}`,children:p(Math.abs(i.totalCostDeviation))})]})]})]})})]}),i.totalCostDeviation>0&&r.jsxs(le,{className:"border-red-200 bg-red-50",children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center gap-2 text-red-700",children:[r.jsx(kr,{className:"h-5 w-5"}),"Kostenüberschreitung"]})}),r.jsx(ce,{children:r.jsxs("p",{className:"text-red-700",children:["Das Projekt hat die geplanten Kosten um ",p(i.totalCostDeviation)," überschritten. Das entspricht einer Überschreitung von ",y(i.totalCostDeviation/i.plannedTotalCosts*100),"."]})})]})]}),r.jsxs(Qe,{value:"kpis",className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Rentabilitäts-KPIs"})}),r.jsxs(ce,{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Gewinnmarge (geplant):"}),r.jsx("span",{className:"font-semibold",children:y(i.plannedProfitMargin)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Gewinnmarge (tatsächlich):"}),r.jsx("span",{className:`font-semibold ${i.actualProfitMargin>=0?"text-green-600":"text-red-600"}`,children:y(i.actualProfitMargin)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"ROI (Return on Investment):"}),r.jsx("span",{className:`font-semibold ${i.actualProfit>=0?"text-green-600":"text-red-600"}`,children:y(i.actualProfit/i.actualTotalCosts*100)})]})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Effizienz-KPIs"})}),r.jsxs(ce,{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Budget-Ausschöpfung:"}),r.jsx("span",{className:`font-semibold ${i.budgetUtilization>100?"text-red-600":"text-green-600"}`,children:y(i.budgetUtilization)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Arbeitseffizienz:"}),r.jsx("span",{className:`font-semibold ${i.efficiency>=100?"text-green-600":"text-orange-600"}`,children:y(i.efficiency)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Kostengenauigkeit:"}),r.jsx("span",{className:"font-semibold",children:y(100-Math.abs(i.totalCostDeviation/i.plannedTotalCosts*100))})]})]})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Empfehlungen für zukünftige Projekte"})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-3",children:[i.materialDeviation>i.plannedMaterialCosts*.1&&r.jsxs("div",{className:"flex items-start gap-3 p-3 bg-yellow-50 rounded-lg",children:[r.jsx(kr,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-yellow-800",children:"Materialkosten-Planung verbessern"}),r.jsxs("div",{className:"text-sm text-yellow-700",children:["Materialkosten waren ",y(i.materialDeviation/i.plannedMaterialCosts*100)," höher als geplant. Prüfen Sie Ihre Lieferantenpreise und Mengenschätzungen."]})]})]}),i.efficiency<90&&r.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[r.jsx(hn,{className:"h-5 w-5 text-blue-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-blue-800",children:"Arbeitsplanung optimieren"}),r.jsxs("div",{className:"text-sm text-blue-700",children:["Die Arbeitseffizienz lag bei nur ",y(i.efficiency),". Überprüfen Sie die Zeitschätzungen und Arbeitsabläufe."]})]})]}),i.actualProfitMargin>i.plannedProfitMargin*1.2&&r.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[r.jsx(Lr,{className:"h-5 w-5 text-green-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-green-800",children:"Sehr gute Rentabilität"}),r.jsx("div",{className:"text-sm text-green-700",children:"Das Projekt war deutlich rentabler als geplant. Diese Kalkulations-Ansätze können als Vorlage für ähnliche Projekte dienen."})]})]})]})})]})]})]}),r.jsx("div",{className:"flex justify-end pt-4 border-t",children:r.jsx(J,{onClick:e,children:"Schließen"})})]})}):r.jsx(en,{open:t,onOpenChange:e,children:r.jsx(Gt,{className:"max-w-4xl",children:r.jsxs("div",{className:"text-center py-8",children:[r.jsx(kr,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Daten verfügbar"}),r.jsx("p",{className:"text-gray-600",children:"Für dieses Projekt konnten keine Rentabilitätsdaten geladen werden."})]})})})};function Bee({active:t,done:e,budget:n,late:s}){return r.jsxs("section",{"aria-label":"Kennzahlen",className:`sticky top-0 z-10 grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\r
                 backdrop-blur-md bg-background/70 border rounded-2xl p-3 shadow-soft`,children:[r.jsx(qm,{title:"Aktive Projekte",value:t}),r.jsx(qm,{title:"Abgeschlossene",value:e}),r.jsx(qm,{title:"Gesamtbudget",value:`€${(n||0).toLocaleString("de-DE")}`}),r.jsx(qm,{title:"Verspätet",value:s})]})}function qm({title:t,value:e}){return r.jsxs("div",{className:"bg-card border rounded-xl px-4 py-3 flex items-center justify-between",children:[r.jsx("div",{className:"text-xs text-muted-foreground font-semibold",children:t}),r.jsx("div",{className:"text-xl font-bold",children:e})]})}function zee({counts:t}){const e=[{label:"Anfrage",key:"anfrage",dot:"bg-blue-400"},{label:"Termin ausmachen",key:"besichtigung",dot:"bg-sky-400"},{label:"In Planung",key:"geplant",dot:"bg-amber-400"},{label:"In Arbeit",key:"in_bearbeitung",dot:"bg-yellow-400"},{label:"Erledigt",key:"abgeschlossen",dot:"bg-green-500"}];return r.jsx("div",{className:"grid grid-cols-[1fr_auto] gap-2 text-sm",children:e.map(n=>r.jsxs(ke.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:`inline-block w-2.5 h-2.5 rounded-full ${n.dot}`}),r.jsx("span",{children:n.label})]}),r.jsx("span",{className:"font-medium",children:t[n.key]})]},n.key))})}const MC={anfrage:{label:"Anfrage",cls:"bg-purple-100 text-purple-800 border-purple-200"},besichtigung:{label:"Termin ausmachen",cls:"bg-orange-100  text-orange-800  border-orange-200"},geplant:{label:"In Planung",cls:"bg-blue-100   text-blue-800   border-blue-200"},in_bearbeitung:{label:"In Arbeit",cls:"bg-yellow-100 text-yellow-800 border-yellow-200"},abgeschlossen:{label:"Erledigt",cls:"bg-green-100  text-green-800  border-green-200"}};function RC(t){const e=MC[t.status]||MC.geplant,n=s=>s?new Date(s).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"}):"—";return r.jsxs("div",{className:"flex flex-col gap-2 py-2 cursor-pointer",onDoubleClick:t.onOpen,children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${e.cls}`,children:e.label}),r.jsx("strong",{className:"mr-2",children:t.name}),r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-blue-50 text-blue-700 border-blue-200",children:["ID: ",t.id]})]}),r.jsxs("div",{className:"text-sm text-muted-foreground",children:["Start: ",n(t.start)," • Ende: ",n(t.end)," • Budget:"," ",r.jsxs("strong",{className:"text-green-600",children:["€",(t.budget||0).toLocaleString("de-DE")]})]}),typeof t.progress=="number"&&r.jsx("div",{className:"h-2 w-full rounded-full bg-neutral-200 overflow-hidden",children:r.jsx("div",{className:"h-full rounded-full bg-blue-500 transition-all",style:{width:`${t.progress}%`},"aria-valuenow":t.progress,"aria-valuemin":0,"aria-valuemax":100,role:"progressbar"})})]})}const IC=t=>`P${t.split("-").join("").substring(0,6).toUpperCase()}`,gy=t=>{if(!t)return 0;const e=t.match(/\[BUDGET:(\d+\.?\d*)\]/);return e?parseFloat(e[1]):0},$ee=()=>{Rt();const{companyId:t}=Di(),{data:e,isLoading:n}=VM(),{data:s,isLoading:a}=HM(),[i,o]=g.useState([]),[c,d]=g.useState(!0),u=g.useCallback(async()=>{try{if(d(!0),console.log("ProjectModule: fetchEmployees called with companyId:",t),!t){console.error("ProjectModule: No company ID available"),d(!1);return}const{data:$,error:te}=await K.from("employees").select("id, email, status, user_id, company_id").eq("company_id",t);console.log("ProjectModule: DEBUG - All employees for company:",$);const{data:X,error:Z}=await K.from("employees").select(`
          id,
          user_id,
          first_name,
          last_name,
          email,
          phone,
          position,
          status,
          qualifications,
          license
        `).eq("company_id",t).eq("status","Aktiv").order("created_at",{ascending:!1});if(console.log("ProjectModule: Employees query result:",X,Z),Z){console.error("ProjectModule: Error fetching employees:",Z),d(!1);return}const ie=(X==null?void 0:X.filter(se=>se.user_id).map(se=>se.user_id))||[];let pe=[];if(ie.length>0){const{data:se,error:me}=await K.from("profiles").select("id, first_name, last_name").in("id",ie);me||(pe=se||[])}const G=(X==null?void 0:X.map(se=>{const me=pe.find(re=>re.id===se.user_id),he=(me==null?void 0:me.first_name)||se.first_name||"",xe=(me==null?void 0:me.last_name)||se.last_name||"";return{id:se.id,first_name:he,last_name:xe,name:`${he} ${xe}`.trim(),email:se.email,phone:se.phone,position:se.position,status:se.status,qualifications:se.qualifications||[],license:se.license,projects:[],user_id:se.user_id}}).filter(se=>{const me=se.first_name&&se.first_name.trim().length>0,he=se.last_name&&se.last_name.trim().length>0,xe=se.name&&se.name.trim().length>0&&se.name.trim()!==" ",re=me||he||xe;return console.log("ProjectModule: Employee filter check:",{employee:se.name,hasFirstName:me,hasLastName:he,hasValidName:xe,shouldInclude:re,user_id:se.user_id}),re||console.log("ProjectModule: Filtering out employee without proper name:",se),re}))||[];console.log("ProjectModule: Final employee list:",G),o(G)}catch($){console.error("ProjectModule: fetchEmployees error:",$)}finally{d(!1)}},[t]);g.useEffect(()=>{u()},[u]);const[m,f]=g.useState(!1),[p,y]=g.useState(!1),[j,v]=g.useState(!1),[_,b]=g.useState(!1),[w,N]=g.useState(!1),[S,A]=g.useState(!1),[E,D]=g.useState(null),[M,B]=g.useState(null),R=(e==null?void 0:e.items)||[],P=(s==null?void 0:s.items)||[];console.log("Customers data:",P),console.log("Team members data:",i),console.log("Team members loading:",c);const F=P.length>0?P:[{id:"demo_customer_1",name:"Demo Kunde - Bitte echte Kunden hinzufügen",company_name:"Demo Kunde",contact_person:"Bitte echte Kunden hinzufügen",email:"demo@example.com",phone:"+49 000 000000",address:"Demo Adresse",projects:0,revenue:"0",status:"Demo"}],W=i,ee=n||a||c;console.log("ProjectModule Debug:",{projectsResponse:e,projects:R,projectsLoading:n,isLoading:ee});const ue={anfrage:R.filter($=>$.status==="anfrage").length,besichtigung:R.filter($=>$.status==="besichtigung").length,geplant:R.filter($=>$.status==="geplant").length,in_bearbeitung:R.filter($=>$.status==="in_bearbeitung").length,abgeschlossen:R.filter($=>$.status==="abgeschlossen").length},de=R.reduce(($,te)=>{const X=gy(te.description)||te.budget||0;return $+X},0),Q=new Date().toISOString().split("T")[0],z=R.filter($=>$.end_date&&$.end_date<Q&&$.status!=="abgeschlossen"),V=P.filter($=>$.status==="Aktiv").slice(0,5),U=()=>{f(!1)},O=()=>{y(!1)},I=()=>{y(!1)},H=$=>{B($.id),b(!0)};return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Projekte & Baustellen"}),r.jsxs(J,{onClick:()=>f(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Neues Projekt"]})]}),r.jsx(Bee,{active:R.filter($=>$.status!=="abgeschlossen").length,done:R.filter($=>$.status==="abgeschlossen").length,budget:de||0,late:z.length}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[r.jsxs(le,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsxs(Ce,{className:"pb-2 flex-row items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-100 text-green-800 border-green-200",children:"Aktuelle"}),r.jsx(Ee,{children:"Projekte"})]}),r.jsxs("div",{className:"text-sm text-muted-foreground",children:["Heute • ",new Date().toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"})]})]}),r.jsx(ce,{className:"space-y-3",children:ee?Array(3).fill(0).map(($,te)=>r.jsx("div",{className:"border rounded-xl p-3 shadow-softer",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx(lt,{className:"h-4 w-24 mb-2"}),r.jsx(lt,{className:"h-3 w-32 mb-1"}),r.jsx(lt,{className:"h-3 w-20"})]}),r.jsx(lt,{className:"h-6 w-16"})]})},te)):R.filter($=>$.status!=="abgeschlossen").length===0?r.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine Projekte vorhanden"}):R.filter($=>$.status!=="abgeschlossen").map($=>r.jsx("div",{className:"border rounded-xl p-3 shadow-softer cursor-pointer hover:shadow-md transition-shadow",onDoubleClick:()=>H($),children:r.jsx(RC,{id:IC($.id),name:$.name,status:$.status,budget:gy($.description)||$.budget||0,start:$.start_date,end:$.end_date,progress:$.status==="abgeschlossen"?100:$.status==="in_bearbeitung"?60:$.status==="geplant"?30:10,onOpen:()=>H($)})},$.id))})]}),r.jsxs(le,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsx(Ce,{className:"pb-2",children:r.jsx(Ee,{children:"Verzögerte Projekte"})}),r.jsx(ce,{children:ee?r.jsxs("div",{className:"space-y-2",children:[r.jsx(lt,{className:"h-16 w-full"}),r.jsx(lt,{className:"h-16 w-full"})]}):z.length===0?r.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine Projekte im Verzug 🎉"}):z.map($=>r.jsx("div",{className:"border rounded-xl p-3 mb-2 cursor-pointer hover:shadow-md transition-shadow",onDoubleClick:()=>H($),children:r.jsx(RC,{id:IC($.id),name:$.name,status:$.status,budget:gy($.description)||$.budget||0,progress:$.status==="abgeschlossen"?100:$.status==="in_bearbeitung"?60:$.status==="geplant"?30:10,onOpen:()=>H($)})},$.id))})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs(le,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsx(Ce,{className:"pb-2",children:r.jsx(Ee,{children:"Projektstatus"})}),r.jsx(ce,{children:r.jsx(zee,{counts:ue})})]}),r.jsxs(le,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsx(Ce,{className:"pb-2",children:r.jsx(Ee,{children:"Top Kunden"})}),r.jsx(ce,{className:"space-y-2",children:ee?Array(3).fill(0).map(($,te)=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(lt,{className:"h-4 w-24"}),r.jsx(lt,{className:"h-4 w-32"})]},te)):V.length===0?r.jsx("p",{className:"text-sm text-muted-foreground",children:"Hier erscheinen Kunden, sobald Projekte abgeschlossen sind."}):V.map($=>r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{children:$.company_name||$.contact_person}),r.jsx("span",{className:"text-muted-foreground",children:$.email})]},$.id))})]}),r.jsxs(le,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsx(Ce,{className:"pb-2",children:r.jsx(Ee,{children:"Projekt Übersicht"})}),r.jsxs(ce,{className:"grid grid-cols-2 gap-2 text-sm",children:[r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-slate-50 text-slate-700 border-slate-200",children:["Gesamt: ",R.length]}),r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-amber-50 text-amber-700 border-amber-200",children:["In Planung: ",ue.geplant]}),r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-blue-50 text-blue-700 border-blue-200",children:["In Arbeit: ",ue.in_bearbeitung]}),r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-50 text-green-700 border-green-200",children:["Erledigt: ",ue.abgeschlossen]})]})]})]})]}),r.jsx(bee,{isOpen:m,onClose:()=>f(!1),onProjectAdded:U,customers:F,teamMembers:W}),r.jsx(jee,{isOpen:p,onClose:()=>y(!1),project:E,onProjectUpdated:O,onProjectDeleted:I}),r.jsx(Nee,{isOpen:j,onClose:()=>v(!1),project:E}),M&&r.jsx(Cee,{isOpen:_,onClose:()=>{b(!1),B(null)},projectId:M}),E&&r.jsx(Eee,{isOpen:w,onClose:()=>N(!1),projectId:E.id,projectName:E.name,customerId:E.customer_id||"",onCalculationSaved:()=>{}}),E&&r.jsx(Fee,{isOpen:S,onClose:()=>A(!1),projectId:E.id,projectName:E.name})]})};function mo({title:t,value:e,className:n,valueClassName:s}){return r.jsxs("div",{className:Oe("bg-card border rounded-xl px-4 py-4 flex items-center justify-between shadow-sm hover:shadow-md transition-shadow",n),children:[r.jsx("div",{className:"text-xs text-muted-foreground font-semibold uppercase tracking-wider",children:t}),r.jsx("div",{className:Oe("text-2xl font-bold",s),children:e})]})}function J3({children:t,className:e}){return r.jsx("section",{"aria-label":"Kennzahlen",className:Oe("grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4","bg-background/95 backdrop-blur-sm border rounded-2xl p-4 shadow-lg",e),children:t})}const Uee=({totalEmployees:t,activeEmployees:e,onVacationEmployees:n,totalHours:s})=>r.jsxs(J3,{children:[r.jsx(mo,{title:"Mitarbeiter gesamt",value:t}),r.jsx(mo,{title:"Aktiv",value:e,valueClassName:"text-green-600"}),r.jsx(mo,{title:"Urlaub",value:n,valueClassName:"text-yellow-600"}),r.jsx(mo,{title:"Stunden (Monat)",value:s})]});var x1="Avatar",[qee,gae]=Ss(x1),[Wee,eI]=qee(x1),tI=g.forwardRef((t,e)=>{const{__scopeAvatar:n,...s}=t,[a,i]=g.useState("idle");return r.jsx(Wee,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:r.jsx(Xe.span,{...s,ref:e})})});tI.displayName=x1;var nI="AvatarImage",rI=g.forwardRef((t,e)=>{const{__scopeAvatar:n,src:s,onLoadingStatusChange:a=()=>{},...i}=t,o=eI(nI,n),c=Hee(s,i.referrerPolicy),d=jn(u=>{a(u),o.onImageLoadingStatusChange(u)});return Un(()=>{c!=="idle"&&d(c)},[c,d]),c==="loaded"?r.jsx(Xe.img,{...i,ref:e,src:s}):null});rI.displayName=nI;var sI="AvatarFallback",aI=g.forwardRef((t,e)=>{const{__scopeAvatar:n,delayMs:s,...a}=t,i=eI(sI,n),[o,c]=g.useState(s===void 0);return g.useEffect(()=>{if(s!==void 0){const d=window.setTimeout(()=>c(!0),s);return()=>window.clearTimeout(d)}},[s]),o&&i.imageLoadingStatus!=="loaded"?r.jsx(Xe.span,{...a,ref:e}):null});aI.displayName=sI;function Hee(t,e){const[n,s]=g.useState("idle");return Un(()=>{if(!t){s("error");return}let a=!0;const i=new window.Image,o=c=>()=>{a&&s(c)};return s("loading"),i.onload=o("loaded"),i.onerror=o("error"),i.src=t,e&&(i.referrerPolicy=e),()=>{a=!1}},[t,e]),n}var iI=tI,oI=rI,lI=aI;const Gh=g.forwardRef(({className:t,...e},n)=>r.jsx(iI,{ref:n,className:Oe("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));Gh.displayName=iI.displayName;const Vee=g.forwardRef(({className:t,...e},n)=>r.jsx(oI,{ref:n,className:Oe("aspect-square h-full w-full",t),...e}));Vee.displayName=oI.displayName;const Qh=g.forwardRef(({className:t,...e},n)=>r.jsx(lI,{ref:n,className:Oe("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));Qh.displayName=lI.displayName;const Kee=({employee:t,onShowDetails:e,onEdit:n})=>{const s=i=>{switch(i){case"Aktiv":return"bg-green-100 text-green-800";case"Urlaub":return"bg-yellow-100 text-yellow-800";case"Krank":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a=i=>i.split(" ").map(o=>o[0]).join("");return r.jsx(le,{className:"hover:shadow-lg transition-shadow",children:r.jsxs(ce,{className:"p-6 flex flex-col h-full",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx(Gh,{className:"h-12 w-12",children:r.jsx(Qh,{children:a(t.name)})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h4",{className:"text-lg font-semibold",children:t.name}),r.jsx(Ve,{className:s(t.status),children:t.status})]}),r.jsx("p",{className:"text-gray-600 mb-2",children:t.position}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm mb-4 flex-grow",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Aktuelles Projekt:"}),r.jsx("p",{children:t.currentProject})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Stunden (Monat):"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(hn,{className:"h-4 w-4"}),t.hoursThisMonth,"h"]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Führerschein:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(WA,{className:"h-4 w-4"}),t.license||"Nicht angegeben"]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Resturlaub:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(zt,{className:"h-4 w-4"}),t.vacationDays," Tage"]})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Qualifikationen:"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:t.qualifications.length>0?t.qualifications.map(i=>r.jsxs(Ve,{variant:"outline",className:"text-xs",children:[r.jsx(ff,{className:"h-3 w-3 mr-1"}),i]},i)):r.jsx("span",{className:"text-sm text-gray-400",children:"Keine Qualifikationen hinterlegt"})})]})]})]}),r.jsxs("div",{className:"flex gap-2 mt-auto",children:[r.jsx(J,{size:"sm",variant:"outline",onClick:()=>e(t),children:"Details"}),r.jsxs(J,{size:"sm",onClick:()=>n(t),children:[r.jsx(Dl,{className:"h-4 w-4 mr-1"}),"Bearbeiten"]})]})]})})},Zee=({isOpen:t,onClose:e,onSubmit:n,isLoading:s})=>{const[a,i]=g.useState({email:"",firstName:"",lastName:"",position:"",phone:"",license:"",qualifications:[]}),[o,c]=g.useState(""),d=(v,_)=>{i(b=>({...b,[v]:_}))},u=()=>{o.trim()&&!a.qualifications.includes(o.trim())&&(i(v=>({...v,qualifications:[...v.qualifications,o.trim()]})),c(""))},m=v=>{i(_=>({..._,qualifications:_.qualifications.filter(b=>b!==v)}))},f=v=>{v.key==="Enter"&&(v.preventDefault(),u())},p=v=>{v.preventDefault(),n(a)},y=()=>{i({email:"",firstName:"",lastName:"",position:"",phone:"",license:"",qualifications:[]}),c("")},j=()=>{y(),e()};return r.jsx(en,{open:t,onOpenChange:j,children:r.jsxs(Gt,{className:"max-w-md",children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Neuen Mitarbeiter erstellen"}),r.jsx(Xn,{children:"Erstelle einen neuen Mitarbeiter. Der Mitarbeiter erhält eine E-Mail zur Bestätigung seines Kontos."})]}),r.jsxs("form",{onSubmit:p,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"add-firstName",children:"Vorname"}),r.jsx(ne,{id:"add-firstName",type:"text",value:a.firstName,onChange:v=>d("firstName",v.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"add-lastName",children:"Nachname"}),r.jsx(ne,{id:"add-lastName",type:"text",value:a.lastName,onChange:v=>d("lastName",v.target.value),required:!0})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"add-email",children:"E-Mail"}),r.jsx(ne,{id:"add-email",type:"email",value:a.email,onChange:v=>d("email",v.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"add-position",children:"Position"}),r.jsx(ne,{id:"add-position",type:"text",value:a.position,onChange:v=>d("position",v.target.value),placeholder:"z.B. Elektriker, Elektroniker"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"add-phone",children:"Telefon"}),r.jsx(ne,{id:"add-phone",type:"tel",value:a.phone,onChange:v=>d("phone",v.target.value),placeholder:"+49 123 456789"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"add-license",children:"Führerschein"}),r.jsx(ne,{id:"add-license",type:"text",value:a.license,onChange:v=>d("license",v.target.value),placeholder:"z.B. B, BE"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"add-qualifications",children:"Qualifikationen"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx(ne,{id:"add-qualifications",type:"text",value:o,onChange:v=>c(v.target.value),onKeyPress:f,placeholder:"z.B. VDE 0100, Erste Hilfe"}),r.jsx(J,{type:"button",onClick:u,size:"sm",children:r.jsx(dn,{className:"h-4 w-4"})})]}),a.qualifications.length>0&&r.jsx("div",{className:"flex flex-wrap gap-2",children:a.qualifications.map(v=>r.jsxs(Ve,{variant:"outline",className:"text-xs",children:[r.jsx(ff,{className:"h-3 w-3 mr-1"}),v,r.jsx("button",{type:"button",onClick:()=>m(v),className:"ml-1 hover:text-red-600",children:r.jsx(ar,{className:"h-3 w-3"})})]},v))})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(J,{type:"button",variant:"outline",onClick:j,children:"Abbrechen"}),r.jsx(J,{type:"submit",disabled:s,children:s?"Wird erstellt...":"Mitarbeiter erstellen"})]})]})]})})},Gee=({isOpen:t,onClose:e,employee:n})=>{const s=i=>{switch(i){case"Aktiv":return"bg-green-100 text-green-800";case"Urlaub":return"bg-yellow-100 text-yellow-800";case"Krank":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a=i=>i.split(" ").map(o=>o[0]).join("");return n?r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-2xl",children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Mitarbeiterdetails"}),r.jsx(Xn,{children:"Detaillierte Informationen über den Mitarbeiter"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Gh,{className:"h-16 w-16",children:r.jsx(Qh,{className:"text-lg",children:a(n.name)})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-semibold",children:n.name}),r.jsx("p",{className:"text-gray-600",children:n.position}),r.jsx(Ve,{className:s(n.status),children:n.status})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(sr,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-sm",children:n.email})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Md,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-sm",children:n.phone||"Nicht angegeben"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(WA,{className:"h-4 w-4 text-gray-500"}),r.jsxs("span",{className:"text-sm",children:["Führerschein: ",n.license||"Nicht angegeben"]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(hn,{className:"h-4 w-4 text-gray-500"}),r.jsxs("span",{className:"text-sm",children:[n.hoursThisMonth,"h diesen Monat"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(zt,{className:"h-4 w-4 text-gray-500"}),r.jsxs("span",{className:"text-sm",children:[n.vacationDays," Tage Resturlaub"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(sa,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-sm",children:n.currentProject})]})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium mb-2",children:"Qualifikationen"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:n.qualifications.length>0?n.qualifications.map(i=>r.jsxs(Ve,{variant:"outline",children:[r.jsx(ff,{className:"h-3 w-3 mr-1"}),i]},i)):r.jsx("span",{className:"text-sm text-gray-400",children:"Keine Qualifikationen hinterlegt"})})]}),r.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50",children:[r.jsx("h4",{className:"font-medium mb-2",children:"Dateien & Dokumente"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Diese Funktion wird bald verfügbar sein."})]})]})]})}):null},Qee=({isOpen:t,onClose:e,employee:n,onSave:s})=>{const{toast:a}=Rt(),i=BZ(),[o,c]=g.useState({name:"",position:"",email:"",phone:"",status:"Aktiv",license:"",qualifications:[],currentProject:"",hoursThisMonth:0,vacationDays:0}),[d,u]=g.useState("");g.useEffect(()=>{n&&c({name:n.name,position:n.position,email:n.email,phone:n.phone,status:n.status,license:n.license,qualifications:n.qualifications||[],currentProject:n.currentProject,hoursThisMonth:n.hoursThisMonth,vacationDays:n.vacationDays})},[n]);const m=(_,b)=>{c(w=>({...w,[_]:b}))},f=()=>{d.trim()&&!o.qualifications.includes(d.trim())&&(c(_=>({..._,qualifications:[..._.qualifications,d.trim()]})),u(""))},p=_=>{c(b=>({...b,qualifications:b.qualifications.filter(w=>w!==_)}))},y=_=>{_.key==="Enter"&&(_.preventDefault(),f())},j=_=>{_.preventDefault(),s(o)},v=()=>{n&&window.confirm(`Möchten Sie den Mitarbeiter "${n.name}" wirklich löschen?`)&&i.mutate(n.id,{onSuccess:()=>{a({title:"Mitarbeiter gelöscht",description:`${n.name} wurde erfolgreich gelöscht.`}),e()},onError:_=>{a({title:"Fehler beim Löschen",description:_.message,variant:"destructive"})}})};return n?r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-md",children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Mitarbeiter bearbeiten"}),r.jsx(Xn,{children:"Mitarbeiterdaten bearbeiten"})]}),r.jsxs("form",{onSubmit:j,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"name",children:"Name"}),r.jsx(ne,{id:"name",value:o.name,onChange:_=>m("name",_.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"position",children:"Position"}),r.jsx(ne,{id:"position",value:o.position,onChange:_=>m("position",_.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"email",children:"E-Mail"}),r.jsx(ne,{id:"email",type:"email",value:o.email,onChange:_=>m("email",_.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"phone",children:"Telefon"}),r.jsx(ne,{id:"phone",value:o.phone,onChange:_=>m("phone",_.target.value)})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"status",children:"Status"}),r.jsxs(vt,{value:o.status,onValueChange:_=>m("status",_),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Aktiv",children:"Aktiv"}),r.jsx(ye,{value:"Urlaub",children:"Urlaub"}),r.jsx(ye,{value:"Krank",children:"Krank"})]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"license",children:"Führerschein"}),r.jsx(ne,{id:"license",value:o.license,onChange:_=>m("license",_.target.value),placeholder:"z.B. B, BE"})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"qualifications",children:"Qualifikationen"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx(ne,{id:"qualifications",type:"text",value:d,onChange:_=>u(_.target.value),onKeyPress:y,placeholder:"z.B. VDE 0100, Erste Hilfe"}),r.jsx(J,{type:"button",onClick:f,size:"sm",children:r.jsx(dn,{className:"h-4 w-4"})})]}),o.qualifications.length>0&&r.jsx("div",{className:"flex flex-wrap gap-2",children:o.qualifications.map(_=>r.jsxs(Ve,{variant:"outline",className:"text-xs",children:[r.jsx(ff,{className:"h-3 w-3 mr-1"}),_,r.jsx("button",{type:"button",onClick:()=>p(_),className:"ml-1 hover:text-red-600",children:r.jsx(ar,{className:"h-3 w-3"})})]},_))})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"currentProject",children:"Aktuelles Projekt"}),r.jsx(ne,{id:"currentProject",value:o.currentProject,onChange:_=>m("currentProject",_.target.value)})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"hoursThisMonth",children:"Stunden (Monat)"}),r.jsx(ne,{id:"hoursThisMonth",type:"number",value:o.hoursThisMonth,onChange:_=>m("hoursThisMonth",parseInt(_.target.value))})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"vacationDays",children:"Resturlaub"}),r.jsx(ne,{id:"vacationDays",type:"number",value:o.vacationDays,onChange:_=>m("vacationDays",parseInt(_.target.value))})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(J,{type:"button",variant:"outline",onClick:e,children:"Abbrechen"}),r.jsxs(J,{type:"button",variant:"destructive",onClick:v,disabled:i.isPending,className:"flex items-center gap-2",children:[r.jsx(Ua,{className:"h-4 w-4"}),i.isPending?"Lösche...":"Löschen"]}),r.jsx(J,{type:"submit",children:"Speichern"})]})]})]})}):null},Yee=({onQuickAction:t})=>{const e=[{employee:"Keine Schulungen geplant",training:"",date:"",type:"Info"}],n=s=>{switch(s){case"Pflicht":return"bg-red-100 text-red-800";case"Weiterbildung":return"bg-blue-100 text-blue-800";case"Info":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(G2,{className:"h-5 w-5"}),"Anstehende Schulungen"]})}),r.jsx(ce,{children:r.jsx("div",{className:"space-y-3",children:e.map(s=>r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"flex items-center justify-between mb-2",children:r.jsx(Ve,{className:n(s.type),children:s.type})}),r.jsx("p",{className:"font-medium text-sm mb-1",children:s.employee}),s.training&&r.jsx("p",{className:"text-sm text-gray-600 mb-1",children:s.training}),s.date&&r.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[r.jsx(zt,{className:"h-3 w-3"}),s.date]})]},s.employee))})})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{className:"text-base",children:"Personalaktionen"})}),r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs(J,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Urlaub planen"),children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Urlaub planen"]}),r.jsxs(J,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Arbeitszeiten"),children:[r.jsx(hn,{className:"h-4 w-4 mr-2"}),"Arbeitszeiten"]}),r.jsxs(J,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Schulung buchen"),children:[r.jsx(G2,{className:"h-4 w-4 mr-2"}),"Schulung buchen"]}),r.jsxs(J,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Zertifikate"),children:[r.jsx(ff,{className:"h-4 w-4 mr-2"}),"Zertifikate"]})]})})]})]})},cI=g.forwardRef(({className:t,...e},n)=>r.jsx("div",{className:"relative w-full overflow-auto",children:r.jsx("table",{ref:n,className:Oe("w-full caption-bottom text-sm",t),...e})}));cI.displayName="Table";const dI=g.forwardRef(({className:t,...e},n)=>r.jsx("thead",{ref:n,className:Oe("[&_tr]:border-b",t),...e}));dI.displayName="TableHeader";const uI=g.forwardRef(({className:t,...e},n)=>r.jsx("tbody",{ref:n,className:Oe("[&_tr:last-child]:border-0",t),...e}));uI.displayName="TableBody";const Xee=g.forwardRef(({className:t,...e},n)=>r.jsx("tfoot",{ref:n,className:Oe("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...e}));Xee.displayName="TableFooter";const Pw=g.forwardRef(({className:t,...e},n)=>r.jsx("tr",{ref:n,className:Oe("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...e}));Pw.displayName="TableRow";const Wi=g.forwardRef(({className:t,...e},n)=>r.jsx("th",{ref:n,className:Oe("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...e}));Wi.displayName="TableHead";const Hi=g.forwardRef(({className:t,...e},n)=>r.jsx("td",{ref:n,className:Oe("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...e}));Hi.displayName="TableCell";const Jee=g.forwardRef(({className:t,...e},n)=>r.jsx("caption",{ref:n,className:Oe("mt-4 text-sm text-muted-foreground",t),...e}));Jee.displayName="TableCaption";function ete(){const[t,e]=g.useState([]),[n,s]=g.useState(null),[a,i]=g.useState(0),[o,c]=g.useState(40),{data:d,isLoading:u,error:m}=Gj(),f=(d==null?void 0:d.items)||[],p=async()=>{try{console.log("Fetching company working hours...");const{data:b,error:w}=await K.from("company_settings").select("default_working_hours_start, default_working_hours_end, default_break_duration").limit(1);if(w){console.error("Error fetching working hours:",w);return}if(b){console.log("Working hours data:",b);const N=b.default_working_hours_start||"08:00",S=b.default_working_hours_end||"17:00",A=b.default_break_duration||60,[E,D]=N.split(":").map(Number),[M,B]=S.split(":").map(Number),R=E*60+D,W=(M*60+B-R-A)/60,ee=W*5;console.log(`Calculated: ${W}h/Tag, ${ee}h/Woche`),c(ee)}}catch(b){console.error("Error calculating working hours:",b),c(40)}};g.useEffect(()=>{p();const b=localStorage.getItem("employeeWages");b&&e(JSON.parse(b))},[]),g.useEffect(()=>{localStorage.setItem("employeeWages",JSON.stringify(t))},[t]);const y=b=>{const w=t.find(N=>N.employee_id===b);return(w==null?void 0:w.hourly_wage)||0},j=b=>{s(b.id),i(y(b.id))},v=()=>{s(null),i(0)},_=b=>{const w=t.map(N=>N.employee_id===b?{...N,hourly_wage:a}:N);t.find(N=>N.employee_id===b)||w.push({employee_id:b,hourly_wage:a}),e(w),s(null),i(0),Et.success("Stundenlohn wurde gespeichert")};return u?r.jsx(le,{children:r.jsx(ce,{className:"p-6",children:r.jsx("div",{className:"text-center",children:"Lädt Mitarbeiterdaten..."})})}):m?r.jsx(le,{children:r.jsx(ce,{className:"p-6",children:r.jsxs("div",{className:"text-center text-red-500",children:["Fehler beim Laden der Mitarbeiterdaten: ",m.message||"Unbekannter Fehler"]})})}):r.jsx("div",{className:"space-y-6",children:r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(hs,{className:"h-5 w-5"}),"Mitarbeiter Stundenlohn-Verwaltung (Vereinfacht)"]}),r.jsx(Sr,{children:"Verwalten Sie Stundenlöhne Ihrer aktiven Mitarbeiter"})]}),r.jsxs(ce,{children:[r.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[r.jsxs("p",{className:"text-sm text-blue-800",children:["📋 ",r.jsx("strong",{children:"Arbeitszeit werden aus den Firmeneinstellungen berechnet (42.5h/Woche)"})]}),r.jsxs("p",{className:"text-sm text-orange-700 mt-1",children:["⚠️ ",r.jsx("strong",{children:"Hinweise:"})," Löhne werden temporär im Browser gespeichert"]})]}),f.length===0?r.jsx("div",{className:"text-center py-8 text-gray-500",children:"Keine aktiven Mitarbeiter gefunden"}):r.jsxs(cI,{children:[r.jsx(dI,{children:r.jsxs(Pw,{children:[r.jsxs(Wi,{children:[r.jsx($s,{className:"h-4 w-4 inline mr-2"}),"Mitarbeiter"]}),r.jsxs(Wi,{children:[r.jsx(sr,{className:"h-4 w-4 inline mr-2"}),"E-Mail"]}),r.jsxs(Wi,{children:[r.jsx(vc,{className:"h-4 w-4 inline mr-2"}),"Position"]}),r.jsx(Wi,{children:"Status"}),r.jsxs(Wi,{children:[r.jsx(hs,{className:"h-4 w-4 inline mr-2"}),"Stundenlohn"]}),r.jsx(Wi,{children:"Wochenlohn (ca.)"}),r.jsx(Wi,{children:"Aktionen"})]})}),r.jsx(uI,{children:f.map(b=>{const w=y(b.id),N=w*o,S=n===b.id;return r.jsxs(Pw,{children:[r.jsx(Hi,{children:r.jsxs("div",{children:[r.jsxs("div",{className:"font-medium",children:[b.first_name," ",b.last_name]}),b.phone&&r.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[r.jsx(Md,{className:"h-3 w-3"}),b.phone]})]})}),r.jsx(Hi,{children:b.email}),r.jsx(Hi,{children:b.position||"-"}),r.jsx(Hi,{children:r.jsx(Ve,{variant:b.status==="Aktiv"?"default":"secondary",children:b.status})}),r.jsx(Hi,{children:S?r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ne,{type:"number",step:"0.50",min:"0",value:a,onChange:A=>i(parseFloat(A.target.value)||0),className:"w-20"}),r.jsx("span",{className:"text-sm",children:"€/h"})]}):r.jsx("div",{className:"font-mono",children:w>0?`€${w.toFixed(2)}/h`:"Nicht festgelegt"})}),r.jsxs(Hi,{children:[r.jsx("div",{className:"font-mono text-green-600",children:N>0?`€${N.toFixed(2)}`:"-"}),N>0&&r.jsxs("div",{className:"text-xs text-gray-500",children:["bei ",o,"h/Woche"]})]}),r.jsx(Hi,{children:S?r.jsxs("div",{className:"flex gap-1",children:[r.jsx(J,{size:"sm",onClick:()=>_(b.id),className:"h-8 w-8 p-0",children:r.jsx(Zp,{className:"h-3 w-3"})}),r.jsx(J,{size:"sm",variant:"outline",onClick:v,className:"h-8 w-8 p-0",children:r.jsx(ar,{className:"h-3 w-3"})})]}):r.jsx(J,{size:"sm",variant:"outline",onClick:()=>j(b),className:"h-8 w-8 p-0",children:r.jsx(Dl,{className:"h-3 w-3"})})})]},b.id)})})]})]})]})})}const tte=()=>{const{toast:t}=Rt(),{user:e,session:n,inviteEmployee:s,companyId:a}=Di(),i=or(),[o,c]=g.useState(null),[d,u]=g.useState(!1),[m,f]=g.useState(!1),[p,y]=g.useState(!1),[j,v]=g.useState(!1),{data:_,isLoading:b,error:w}=Gj(),N=(_==null?void 0:_.items)||[],S=g.useMemo(()=>N.map(W=>({id:W.id,name:W.name||`${W.first_name} ${W.last_name}`.trim()||W.email,position:W.position||"Mitarbeiter",email:W.email,phone:W.phone||"",status:W.status||"Aktiv",qualifications:Array.isArray(W.qualifications)?W.qualifications:[],license:W.license||"",currentProject:"-",hoursThisMonth:0,vacationDays:25})),[N]),A=async W=>{v(!0);try{console.log("Creating Supabase employee invitation:",W);const ee=await s(W.email,{firstName:W.firstName,lastName:W.lastName,position:W.position,phone:W.phone,license:W.license,qualifications:W.qualifications});if(!ee.success){console.error("Supabase invitation error:",ee.error),Et.error(`Fehler beim Senden der Einladung: ${ee.error}`);return}Et.success(`Mitarbeiter ${W.firstName} ${W.lastName} wurde erfolgreich eingeladen! 
        Eine Einladungs-E-Mail wurde an ${W.email} gesendet.`),i.invalidateQueries({queryKey:Vt.employees}),y(!1)}catch(ee){console.error("Unexpected error:",ee),Et.error("Ein unerwarteter Fehler ist aufgetreten")}finally{v(!1)}},E=W=>{c(W),u(!0)},D=W=>{c(W),f(!0)},M=async W=>{var ee;if(o)try{const ue=((ee=W.name)==null?void 0:ee.split(" "))||[],de=ue[0]||"",Q=ue.slice(1).join(" ")||"",{error:z}=await K.from("employees").update({first_name:de,last_name:Q,position:W.position,phone:W.phone,status:W.status,license:W.license,qualifications:W.qualifications?JSON.stringify(W.qualifications):"[]"}).eq("id",o.id);if(z){console.error("Error updating employee:",z),Et.error(`Fehler beim Aktualisieren: ${z.message}`);return}o.id&&de&&Q&&await K.from("profiles").update({first_name:de,last_name:Q}).eq("id",o.id);const V={...o,...W};setEmployees(U=>U.map(O=>O.id===o.id?V:O)),t({title:"Erfolg",description:"Mitarbeiter wurde erfolgreich aktualisiert."}),f(!1),c(null)}catch(ue){console.error("Error saving employee:",ue),Et.error("Fehler beim Speichern der Mitarbeiteränderungen")}},B=W=>{t({title:"Info",description:`${W} wird geöffnet...`})},R=S.filter(W=>W.status==="Aktiv").length,P=S.filter(W=>W.status==="Urlaub").length,F=S.reduce((W,ee)=>W+ee.hoursThisMonth,0);return r.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[r.jsx("div",{className:"flex items-center justify-between mb-8",children:r.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Personalverwaltung"})}),r.jsxs(zr,{defaultValue:"overview",className:"w-full",children:[r.jsxs(Er,{className:"grid w-full grid-cols-2",children:[r.jsx(Ge,{value:"overview",children:"Mitarbeiterübersicht"}),r.jsx(Ge,{value:"wages",children:"Stundenlohn-Verwaltung"})]}),r.jsxs(Qe,{value:"overview",className:"space-y-6",children:[r.jsx("div",{className:"flex justify-end",children:r.jsxs(J,{onClick:()=>y(!0),children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Mitarbeiter hinzufügen"]})}),r.jsx(Uee,{totalEmployees:S.length,activeEmployees:R,onVacationEmployees:P,totalHours:F}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Mitarbeiterliste"}),b?r.jsx("div",{className:"text-center p-6",children:r.jsx("p",{className:"text-gray-500",children:"Mitarbeiter werden geladen..."})}):S.length===0?r.jsxs("div",{className:"text-center p-6",children:[r.jsx("p",{className:"text-gray-500",children:"Noch keine Mitarbeiter vorhanden."}),r.jsx("p",{className:"text-sm text-gray-400 mt-2",children:'Klicken Sie auf "Mitarbeiter hinzufügen" um den ersten Mitarbeiter einzuladen.'})]}):S.map(W=>r.jsx(Kee,{employee:W,onShowDetails:E,onEdit:D},W.id))]}),r.jsx(Yee,{onQuickAction:B})]})]}),r.jsx(Qe,{value:"wages",children:r.jsx(ete,{})})]}),r.jsx(Zee,{isOpen:p,onClose:()=>y(!1),onSubmit:A,isLoading:j}),r.jsx(Gee,{isOpen:d,onClose:()=>u(!1),employee:o}),r.jsx(Qee,{isOpen:m,onClose:()=>f(!1),employee:o,onSave:M})]})},nte=({isOpen:t,onClose:e,selectedMaterial:n,onAssignmentComplete:s})=>{const{user:a,companyId:i}=Di(),[o,c]=g.useState("assign"),[d,u]=g.useState([]),[m,f]=g.useState([]),[p,y]=g.useState([]),[j,v]=g.useState([]),[_,b]=g.useState({material_id:(n==null?void 0:n.id)||"",employee_id:"",project_id:"",assigned_quantity:0,notes:""}),[w,N]=g.useState(!1);g.useEffect(()=>{t&&i&&S()},[t,i]),g.useEffect(()=>{n&&b(P=>({...P,material_id:n.id}))},[n]);const S=async()=>{N(!0);try{await Promise.all([A(),E(),D(),M()])}catch(P){console.error("Error fetching data:",P),Et.error("Fehler beim Laden der Daten")}finally{N(!1)}},A=async()=>{const{data:P,error:F}=await K.from("materials").select("id, name, current_stock, unit, category").eq("company_id",i).eq("is_active",!0).order("name");if(F){console.error("Error fetching materials:",F);return}u(P||[])},E=async()=>{const{data:P,error:F}=await K.from("employees").select("id, first_name, last_name, email").eq("company_id",i).eq("status","active").order("first_name");if(F){console.error("Error fetching employees:",F);return}f(P||[])},D=async()=>{const{data:P,error:F}=await K.from("projects").select("id, name").eq("company_id",i).order("name");if(F){console.error("Error fetching projects:",F);return}y(P||[])},M=async()=>{const{data:P,error:F}=await K.from("project_material_assignments").select(`
        id,
        assigned_quantity,
        used_quantity,
        assigned_at,
        notes,
        materials:material_id (name, unit),
        employees:assigned_by (first_name, last_name),
        projects:project_id (name)
      `).order("assigned_at",{ascending:!1}).limit(20);if(F){console.error("Error fetching assignments:",F);return}const W=(P==null?void 0:P.map(ee=>{var ue,de,Q,z,V;return{...ee,material_name:((ue=ee.materials)==null?void 0:ue.name)||"Unbekannt",employee_name:`${((de=ee.employees)==null?void 0:de.first_name)||""} ${((Q=ee.employees)==null?void 0:Q.last_name)||""}`.trim()||"Unbekannt",project_name:((z=ee.projects)==null?void 0:z.name)||"Unbekannt",unit:((V=ee.materials)==null?void 0:V.unit)||"Stk"}}))||[];v(W)},B=async()=>{var F;if(!_.material_id||!_.employee_id||!_.project_id||!_.assigned_quantity){Et.error("Bitte füllen Sie alle Pflichtfelder aus");return}const P=d.find(W=>W.id===_.material_id);if(P&&_.assigned_quantity>P.current_stock){Et.error(`Nicht genügend Bestand verfügbar. Verfügbar: ${P.current_stock} ${P.unit}`);return}try{N(!0);const{error:W}=await K.from("project_material_assignments").upsert({project_id:_.project_id,material_id:_.material_id,assigned_quantity:_.assigned_quantity,assigned_by:a==null?void 0:a.id,notes:_.notes});if(W)throw W;const{error:ee}=await K.from("material_stock_movements").insert({material_id:_.material_id,movement_type:"out",reference_type:"assignment",reference_id:_.project_id,quantity:-_.assigned_quantity,employee_id:_.employee_id,project_id:_.project_id,reason:`Material zugewiesen an ${(F=m.find(ue=>ue.id===_.employee_id))==null?void 0:F.first_name}`,created_by:a==null?void 0:a.id});if(ee)throw ee;Et.success("Material wurde erfolgreich zugewiesen"),b({material_id:(n==null?void 0:n.id)||"",employee_id:"",project_id:"",assigned_quantity:0,notes:""}),await M(),s&&s()}catch(W){console.error("Error creating assignment:",W),Et.error("Fehler beim Zuweisen des Materials")}finally{N(!1)}},R=d.find(P=>P.id===_.material_id);return r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:[r.jsxs(rn,{children:[r.jsxs(sn,{className:"flex items-center gap-2",children:[r.jsx(Ni,{className:"h-5 w-5"}),"Material-Zuweisung"]}),r.jsx(Xn,{children:"Weisen Sie Material einem Mitarbeiter für ein Projekt zu"})]}),r.jsxs("div",{className:"flex gap-2 mb-4",children:[r.jsx(J,{variant:o==="assign"?"default":"outline",onClick:()=>c("assign"),children:"Material zuweisen"}),r.jsx(J,{variant:o==="view"?"default":"outline",onClick:()=>c("view"),children:"Zuweisungen anzeigen"})]}),o==="assign"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Material *"}),r.jsxs(vt,{value:_.material_id,onValueChange:P=>b(F=>({...F,material_id:P})),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Material wählen"})}),r.jsx(gt,{children:d.map(P=>r.jsx(ye,{value:P.id,children:r.jsxs("div",{className:"flex justify-between items-center w-full",children:[r.jsx("span",{children:P.name}),r.jsxs(Ve,{variant:"outline",className:"ml-2",children:[P.current_stock," ",P.unit]})]})},P.id))})]}),R&&r.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded-lg",children:[r.jsxs("p",{className:"text-sm",children:[r.jsx("strong",{children:"Verfügbar:"})," ",R.current_stock," ",R.unit]}),r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Kategorie:"})," ",R.category]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mitarbeiter *"}),r.jsxs(vt,{value:_.employee_id,onValueChange:P=>b(F=>({...F,employee_id:P})),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Mitarbeiter wählen"})}),r.jsx(gt,{children:m.map(P=>r.jsxs(ye,{value:P.id,children:[P.first_name," ",P.last_name]},P.id))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Projekt *"}),r.jsxs(vt,{value:_.project_id,onValueChange:P=>b(F=>({...F,project_id:P})),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Projekt wählen"})}),r.jsx(gt,{children:p.map(P=>r.jsx(ye,{value:P.id,children:P.name},P.id))})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Menge * ",R&&`(${R.unit})`]}),r.jsx(ne,{type:"number",step:"0.1",min:"0",max:(R==null?void 0:R.current_stock)||999999,value:_.assigned_quantity,onChange:P=>b(F=>({...F,assigned_quantity:parseFloat(P.target.value)||0})),placeholder:"Zuzuweisende Menge"}),R&&_.assigned_quantity>R.current_stock&&r.jsxs("div",{className:"flex items-center gap-2 mt-1 text-red-600",children:[r.jsx(kr,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Nicht genügend Bestand verfügbar!"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notizen (optional)"}),r.jsx(En,{value:_.notes,onChange:P=>b(F=>({...F,notes:P.target.value})),placeholder:"Zusätzliche Informationen zur Zuweisung...",rows:3})]})]}),o==="view"&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Aktuelle Zuweisungen"}),r.jsx("div",{className:"grid gap-4 max-h-96 overflow-y-auto",children:j.map(P=>r.jsx(le,{children:r.jsxs(ce,{className:"p-4",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium",children:P.material_name}),r.jsxs("p",{className:"text-sm text-gray-600",children:[P.employee_name," • ",P.project_name]})]}),r.jsxs(Ve,{variant:"outline",children:[P.used_quantity," / ",P.assigned_quantity," ",P.unit]})]}),r.jsxs("div",{className:"text-sm text-gray-500",children:["Zugewiesen: ",new Date(P.assigned_at).toLocaleDateString("de-DE")]}),P.notes&&r.jsx("div",{className:"text-sm text-gray-600 mt-2 p-2 bg-gray-50 rounded",children:P.notes})]})},P.id))})]}),r.jsxs(lh,{children:[r.jsx(J,{variant:"outline",onClick:e,children:"Schließen"}),o==="assign"&&r.jsxs(J,{onClick:B,disabled:w||!_.material_id||!_.employee_id||!_.project_id||!_.assigned_quantity||R&&_.assigned_quantity>R.current_stock,children:[r.jsx(mf,{className:"h-4 w-4 mr-2"}),"Material zuweisen"]})]})]})})},Wm=["Fliesen & Keramik","Sanitär","Heizung","Elektro","Bauchemie","Werkzeuge","Befestigung","Dichtung & Abdichtung","Sonstiges"],OC=["Stück","m²","m","kg","l","Paket","Set","Rolle"],rte=()=>{const{toast:t}=Rt(),[e,n]=g.useState([]),[s,a]=g.useState([]),[i,o]=g.useState(""),[c,d]=g.useState("all"),[u,m]=g.useState(!1),[f,p]=g.useState(!1),[y,j]=g.useState(null),[v,_]=g.useState({name:"",category:"",supplier:"",unit:"Stück",currentPrice:0,notes:""});g.useEffect(()=>{b()},[]),g.useEffect(()=>{let P=e;i&&(P=P.filter(F=>F.name.toLowerCase().includes(i.toLowerCase())||F.supplier.toLowerCase().includes(i.toLowerCase()))),c&&c!=="all"&&(P=P.filter(F=>F.category===c)),a(P)},[e,i,c]);const b=()=>{const P=[{id:"1",name:"Bodenfliese 30x30cm Grau",category:"Fliesen & Keramik",supplier:"Fliesenmarkt GmbH",unit:"m²",currentPrice:24.99,previousPrice:22.5,lastUpdated:new Date(Date.now()-6048e5).toISOString(),isActive:!0,notes:"Gute Qualität, schnelle Lieferung"},{id:"2",name:"Fliesenkleber C1 25kg",category:"Bauchemie",supplier:"Bauchemie Express",unit:"Paket",currentPrice:12.5,previousPrice:13.2,lastUpdated:new Date(Date.now()-2592e5).toISOString(),isActive:!0},{id:"3",name:"Fugenmasse weiß 5kg",category:"Bauchemie",supplier:"Bauchemie Express",unit:"Paket",currentPrice:8.75,previousPrice:8.75,lastUpdated:new Date(Date.now()-12096e5).toISOString(),isActive:!0},{id:"4",name:"Mischbatterie Küche Edelstahl",category:"Sanitär",supplier:"Sanitär Partner",unit:"Stück",currentPrice:89.99,previousPrice:85,lastUpdated:new Date(Date.now()-864e5).toISOString(),isActive:!0},{id:"5",name:'Heizkörperventil 1/2"',category:"Heizung",supplier:"Heizung & Klima AG",unit:"Stück",currentPrice:15.5,previousPrice:16.2,lastUpdated:new Date(Date.now()-432e6).toISOString(),isActive:!0}];n(P)},w=()=>{const P={id:Date.now().toString(),name:v.name,category:v.category,supplier:v.supplier,unit:v.unit,currentPrice:v.currentPrice,previousPrice:v.currentPrice,lastUpdated:new Date().toISOString(),isActive:!0,notes:v.notes};n(F=>[...F,P]),E(),m(!1),t({title:"Material hinzugefügt",description:`${v.name} wurde zur Preisliste hinzugefügt.`})},N=P=>{j(P),_({name:P.name,category:P.category,supplier:P.supplier,unit:P.unit,currentPrice:P.currentPrice,notes:P.notes||""}),p(!0)},S=()=>{y&&(n(P=>P.map(F=>F.id===y.id?{...F,name:v.name,category:v.category,supplier:v.supplier,unit:v.unit,previousPrice:F.currentPrice,currentPrice:v.currentPrice,lastUpdated:new Date().toISOString(),notes:v.notes}:F)),E(),p(!1),j(null),t({title:"Material aktualisiert",description:`${v.name} wurde erfolgreich aktualisiert.`}))},A=P=>{n(F=>F.filter(W=>W.id!==P)),t({title:"Material entfernt",description:"Das Material wurde aus der Preisliste entfernt."})},E=()=>{_({name:"",category:"",supplier:"",unit:"Stück",currentPrice:0,notes:""})},D=P=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(P),M=P=>new Date(P).toLocaleDateString("de-DE"),B=(P,F)=>P>F?r.jsx(Ao,{className:"h-4 w-4 text-red-500",title:"Preis gestiegen"}):P<F?r.jsx(zb,{className:"h-4 w-4 text-green-500",title:"Preis gefallen"}):null,R=(P,F)=>F===0?0:(P-F)/F*100;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ni,{className:"h-6 w-6 text-blue-600"}),r.jsx("h2",{className:"text-2xl font-bold",children:"Materialpreise"})]}),r.jsxs(J,{onClick:()=>m(!0),children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(le,{children:r.jsxs(ce,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold",children:e.length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Materialien gesamt"})]})}),r.jsx(le,{children:r.jsxs(ce,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(P=>P.currentPrice<P.previousPrice).length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Preise gefallen"})]})}),r.jsx(le,{children:r.jsxs(ce,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.filter(P=>P.currentPrice>P.previousPrice).length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Preise gestiegen"})]})}),r.jsx(le,{children:r.jsxs(ce,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold",children:Wm.length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Kategorien"})]})})]}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(Rd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),r.jsx(ne,{placeholder:"Material oder Lieferant suchen...",value:i,onChange:P=>o(P.target.value),className:"pl-10"})]})}),r.jsx("div",{className:"w-full md:w-64",children:r.jsxs(vt,{value:c,onValueChange:d,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Kategorie wählen"})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"all",children:"Alle Kategorien"}),Wm.map(P=>r.jsx(ye,{value:P,children:P},P))]})]})}),(i||c&&c!=="all")&&r.jsx(J,{variant:"outline",onClick:()=>{o(""),d("all")},children:"Filter zurücksetzen"})]})})}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{children:["Materialpreise (",s.length,")"]})}),r.jsx(ce,{children:r.jsx("div",{className:"space-y-4",children:s.length===0?r.jsx("div",{className:"text-center py-8 text-gray-500",children:i||c?"Keine Materialien gefunden.":"Noch keine Materialien vorhanden."}):s.map(P=>r.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h3",{className:"font-semibold text-lg",children:P.name}),r.jsx(Ve,{variant:"outline",children:P.category}),B(P.currentPrice,P.previousPrice)]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Lieferant:"})," ",P.supplier]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Einheit:"})," ",P.unit]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Letzte Aktualisierung:"})," ",M(P.lastUpdated)]})]}),P.notes&&r.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[r.jsx("span",{className:"font-medium",children:"Notizen:"})," ",P.notes]})]}),r.jsxs("div",{className:"text-right ml-4",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:D(P.currentPrice)}),r.jsxs("div",{className:"text-sm text-gray-500",children:["pro ",P.unit]}),P.previousPrice!==P.currentPrice&&r.jsxs("div",{className:`text-sm ${P.currentPrice>P.previousPrice?"text-red-600":"text-green-600"}`,children:[P.currentPrice>P.previousPrice?"+":"",R(P.currentPrice,P.previousPrice).toFixed(1),"%",r.jsxs("div",{className:"text-xs text-gray-500",children:["vorher: ",D(P.previousPrice)]})]}),r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsx(J,{variant:"outline",size:"sm",onClick:()=>N(P),children:r.jsx(Dl,{className:"h-4 w-4"})}),r.jsx(J,{variant:"outline",size:"sm",onClick:()=>A(P.id),className:"text-red-600 hover:text-red-700",children:r.jsx(Ua,{className:"h-4 w-4"})})]})]})]})},P.id))})})]}),r.jsx(en,{open:u,onOpenChange:m,children:r.jsxs(Gt,{children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Neues Material hinzufügen"}),r.jsx(Xn,{children:"Fügen Sie ein neues Material zur Preisliste hinzu."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"name",children:"Materialname *"}),r.jsx(ne,{id:"name",value:v.name,onChange:P=>_(F=>({...F,name:P.target.value})),placeholder:"z.B. Bodenfliese 30x30cm Grau",required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"category",children:"Kategorie *"}),r.jsxs(vt,{value:v.category,onValueChange:P=>_(F=>({...F,category:P})),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Kategorie wählen"})}),r.jsx(gt,{children:Wm.map(P=>r.jsx(ye,{value:P,children:P},P))})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"unit",children:"Einheit *"}),r.jsxs(vt,{value:v.unit,onValueChange:P=>_(F=>({...F,unit:P})),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsx(gt,{children:OC.map(P=>r.jsx(ye,{value:P,children:P},P))})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"supplier",children:"Lieferant *"}),r.jsx(ne,{id:"supplier",value:v.supplier,onChange:P=>_(F=>({...F,supplier:P.target.value})),placeholder:"z.B. Baumarkt GmbH",required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"price",children:"Preis pro Einheit (€) *"}),r.jsx(ne,{id:"price",type:"number",step:"0.01",min:"0",value:v.currentPrice,onChange:P=>_(F=>({...F,currentPrice:parseFloat(P.target.value)||0})),required:!0})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"notes",children:"Notizen"}),r.jsx(ne,{id:"notes",value:v.notes,onChange:P=>_(F=>({...F,notes:P.target.value})),placeholder:"Zusätzliche Informationen (optional)"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(J,{variant:"outline",onClick:()=>{E(),m(!1)},children:"Abbrechen"}),r.jsx(J,{onClick:w,disabled:!v.name||!v.category||!v.supplier,children:"Hinzufügen"})]})]})}),r.jsx(en,{open:f,onOpenChange:p,children:r.jsxs(Gt,{children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Material bearbeiten"}),r.jsx(Xn,{children:"Bearbeiten Sie die Informationen für das Material."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"edit-name",children:"Materialname *"}),r.jsx(ne,{id:"edit-name",value:v.name,onChange:P=>_(F=>({...F,name:P.target.value})),required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"edit-category",children:"Kategorie *"}),r.jsxs(vt,{value:v.category,onValueChange:P=>_(F=>({...F,category:P})),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsx(gt,{children:Wm.map(P=>r.jsx(ye,{value:P,children:P},P))})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"edit-unit",children:"Einheit *"}),r.jsxs(vt,{value:v.unit,onValueChange:P=>_(F=>({...F,unit:P})),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsx(gt,{children:OC.map(P=>r.jsx(ye,{value:P,children:P},P))})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"edit-supplier",children:"Lieferant *"}),r.jsx(ne,{id:"edit-supplier",value:v.supplier,onChange:P=>_(F=>({...F,supplier:P.target.value})),required:!0})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"edit-price",children:"Neuer Preis pro Einheit (€) *"}),r.jsx(ne,{id:"edit-price",type:"number",step:"0.01",min:"0",value:v.currentPrice,onChange:P=>_(F=>({...F,currentPrice:parseFloat(P.target.value)||0})),required:!0}),y&&r.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Aktueller Preis: ",D(y.currentPrice)]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"edit-notes",children:"Notizen"}),r.jsx(ne,{id:"edit-notes",value:v.notes,onChange:P=>_(F=>({...F,notes:P.target.value})),placeholder:"Zusätzliche Informationen (optional)"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(J,{variant:"outline",onClick:()=>{E(),p(!1),j(null)},children:"Abbrechen"}),r.jsx(J,{onClick:S,disabled:!v.name||!v.category||!v.supplier,children:"Aktualisieren"})]})]})})]})},ste=()=>{const{user:t,companyId:e}=Di(),[n,s]=g.useState("inventory"),[a,i]=g.useState([]),[o,c]=g.useState([]),[d,u]=g.useState([]),[m,f]=g.useState([]),[p,y]=g.useState([]),[j,v]=g.useState(!1),[_,b]=g.useState(""),[w,N]=g.useState(!1),[S,A]=g.useState(!1),[E,D]=g.useState(!1);g.useState(!1);const[M,B]=g.useState(!1),[R,P]=g.useState(null),[F,W]=g.useState({name:"",description:"",category:"",unit:"Stk",current_stock:0,min_stock:0,max_stock:0,unit_price:0,supplier_id:"",storage_location:""}),[ee,ue]=g.useState({material_id:"",employee_id:"",project_id:"",quantity_used:0,notes:""});g.useEffect(()=>{e&&de()},[e]);const de=async()=>{v(!0);try{await Promise.all([Q(),z(),V(),U(),O()])}catch(re){console.error("Error fetching data:",re),Et.error("Fehler beim Laden der Daten")}finally{v(!1)}},Q=async()=>{const{data:re,error:_e}=await K.from("materials").select(`
        *,
        suppliers:supplier_id (
          id,
          name
        )
      `).eq("company_id",e).eq("is_active",!0).order("name");if(_e){console.error("Error fetching materials:",_e);return}const be=(re==null?void 0:re.map(Be=>{var Ke;return{...Be,supplier_name:((Ke=Be.suppliers)==null?void 0:Ke.name)||"Kein Lieferant"}}))||[];i(be)},z=async()=>{const{data:re,error:_e}=await K.from("suppliers").select("*").eq("company_id",e).eq("is_active",!0).order("name");if(_e){console.error("Error fetching suppliers:",_e);return}c(re||[])},V=async()=>{const{data:re,error:_e}=await K.from("projects").select("id, name, status").eq("company_id",e).order("name");if(_e){console.error("Error fetching projects:",_e);return}u(re||[])},U=async()=>{const{data:re,error:_e}=await K.from("employees").select("id, first_name, last_name, email").eq("company_id",e).eq("status","active").order("first_name");if(_e){console.error("Error fetching employees:",_e);return}f(re||[])},O=async()=>{const{data:re,error:_e}=await K.from("employee_material_usage").select(`
        *,
        materials:material_id (name, unit),
        employees:employee_id (first_name, last_name),
        projects:project_id (name)
      `).order("created_at",{ascending:!1}).limit(50);if(_e){console.error("Error fetching material usage:",_e);return}const be=(re==null?void 0:re.map(Be=>{var Ke,At,je,De,Ie;return{...Be,material_name:((Ke=Be.materials)==null?void 0:Ke.name)||"Unbekannt",employee_name:`${(At=Be.employees)==null?void 0:At.first_name} ${(je=Be.employees)==null?void 0:je.last_name}`,project_name:((De=Be.projects)==null?void 0:De.name)||"Unbekannt",unit:((Ie=Be.materials)==null?void 0:Ie.unit)||"Stk"}}))||[];y(be)},I=async()=>{try{const{error:re}=await K.from("materials").insert({...F,company_id:e,created_by:t==null?void 0:t.id});if(re)throw re;Et.success("Material wurde erfolgreich erstellt"),N(!1),X(),Q()}catch(re){console.error("Error creating material:",re),Et.error("Fehler beim Erstellen des Materials")}},H=async()=>{if(R)try{const{error:re}=await K.from("materials").update({...F,updated_at:new Date().toISOString(),updated_by:t==null?void 0:t.id}).eq("id",R.id);if(re)throw re;Et.success("Material wurde erfolgreich aktualisiert"),A(!1),P(null),X(),Q()}catch(re){console.error("Error updating material:",re),Et.error("Fehler beim Aktualisieren des Materials")}},$=async re=>{try{const{error:_e}=await K.from("materials").update({is_active:!1}).eq("id",re);if(_e)throw _e;Et.success("Material wurde erfolgreich gelöscht"),Q()}catch(_e){console.error("Error deleting material:",_e),Et.error("Fehler beim Löschen des Materials")}},te=async()=>{try{const{error:re}=await K.from("employee_material_usage").insert({...ee,usage_date:new Date().toISOString().split("T")[0],created_by:t==null?void 0:t.id});if(re)throw re;Et.success("Materialverbrauch wurde erfolgreich erfasst"),D(!1),Z(),O(),Q()}catch(re){console.error("Error recording material usage:",re),Et.error("Fehler beim Erfassen des Materialverbrauchs")}},X=()=>{W({name:"",description:"",category:"",unit:"Stk",current_stock:0,min_stock:0,max_stock:0,unit_price:0,supplier_id:"",storage_location:""})},Z=()=>{ue({material_id:"",employee_id:"",project_id:"",quantity_used:0,notes:""})},ie=re=>{P(re),W({name:re.name,description:re.description||"",category:re.category,unit:re.unit,current_stock:re.current_stock,min_stock:re.min_stock,max_stock:re.max_stock,unit_price:re.unit_price,supplier_id:re.supplier_id||"",storage_location:re.storage_location||""}),A(!0)},pe=(re,_e)=>re<=_e*.5?"bg-red-100 text-red-800":re<=_e?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",G=(re,_e)=>re<=_e*.5?"Kritisch":re<=_e?"Niedrig":"Verfügbar",se=(re,_e)=>Math.min(re/_e*100,100),me=a.filter(re=>re.name.toLowerCase().includes(_.toLowerCase())||re.category.toLowerCase().includes(_.toLowerCase())),he=a.filter(re=>re.current_stock<=re.min_stock),xe=a.reduce((re,_e)=>re+_e.current_stock*_e.unit_price,0);return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-red-600 bg-clip-text text-transparent flex items-center gap-3",children:[r.jsx(Ni,{className:"h-8 w-8 text-red-600"}),"Materialwirtschaft"]}),r.jsx("p",{className:"text-gray-600",children:"Vollständige Material- und Lagerverwaltung"})]}),r.jsx("div",{className:"flex gap-2",children:r.jsxs(J,{onClick:()=>N(!0),children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Materialien"}),r.jsx("p",{className:"text-2xl font-bold",children:a.length})]}),r.jsx(Ni,{className:"h-8 w-8 text-blue-600"})]})})}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Lagerwert"}),r.jsxs("p",{className:"text-2xl font-bold",children:["€",xe.toLocaleString("de-DE",{maximumFractionDigits:0})]})]}),r.jsx(Ao,{className:"h-8 w-8 text-green-600"})]})})}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Niedrige Bestände"}),r.jsx("p",{className:"text-2xl font-bold",children:he.length})]}),r.jsx(kr,{className:"h-8 w-8 text-yellow-600"})]})})}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Verbrauch (30 Tage)"}),r.jsx("p",{className:"text-2xl font-bold",children:p.length})]}),r.jsx(Yu,{className:"h-8 w-8 text-purple-600"})]})})})]}),r.jsxs(zr,{value:n,onValueChange:s,className:"w-full",children:[r.jsxs(Er,{className:"grid w-full grid-cols-5",children:[r.jsx(Ge,{value:"inventory",children:"Lagerbestand"}),r.jsx(Ge,{value:"usage",children:"Verbrauch"}),r.jsx(Ge,{value:"assignments",children:"Zuweisungen"}),r.jsx(Ge,{value:"prices",children:"Preise"}),r.jsx(Ge,{value:"analytics",children:"Analysen"})]}),r.jsxs(Qe,{value:"inventory",className:"space-y-6 min-h-[600px]",children:[r.jsx("div",{className:"flex justify-between items-center",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx(Rd,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),r.jsx(ne,{placeholder:"Material suchen...",className:"pl-10 w-64",value:_,onChange:re=>b(re.target.value)})]}),r.jsxs(J,{variant:"outline",onClick:()=>D(!0),children:[r.jsx(TF,{className:"h-4 w-4 mr-2"}),"Verbrauch erfassen"]})]})}),r.jsx("div",{className:"grid gap-4",children:me.map(re=>r.jsx(le,{className:"hover:shadow-lg transition-shadow",children:r.jsxs(ce,{className:"p-6",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h4",{className:"text-lg font-semibold",children:re.name}),r.jsx(Ve,{className:pe(re.current_stock,re.min_stock),children:G(re.current_stock,re.min_stock)})]}),r.jsx("p",{className:"text-gray-600 mb-2",children:re.category}),r.jsx("p",{className:"text-sm text-gray-500",children:re.description})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-lg font-bold text-blue-600",children:["€",re.unit_price.toFixed(2),"/",re.unit]}),r.jsx("p",{className:"text-sm text-gray-500",children:re.supplier_name})]})]}),r.jsxs("div",{className:"space-y-3 mb-4",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{children:"Lagerbestand"}),r.jsxs("span",{children:[re.current_stock," ",re.unit," / ",re.max_stock," ",re.unit]})]}),r.jsx(kd,{value:se(re.current_stock,re.max_stock),className:"h-2"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Mindestbestand:"}),r.jsxs("p",{children:[re.min_stock," ",re.unit]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Lagerwert:"}),r.jsxs("p",{children:["€",(re.current_stock*re.unit_price).toFixed(2)]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Lagerort:"}),r.jsx("p",{children:re.storage_location||"Nicht angegeben"})]})]})]}),re.current_stock<=re.min_stock&&r.jsx("div",{className:"mb-4 p-2 bg-yellow-50 border border-yellow-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center gap-2 text-yellow-800",children:[r.jsx(kr,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-medium",children:"Bestand unter Mindestmenge! Nachbestellung empfohlen."})]})}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(J,{size:"sm",variant:"outline",onClick:()=>ie(re),children:[r.jsx(Dl,{className:"h-4 w-4 mr-1"}),"Bearbeiten"]}),r.jsxs(J,{size:"sm",variant:"outline",onClick:()=>{P(re),B(!0)},children:[r.jsx(mf,{className:"h-4 w-4 mr-1"}),"Zuweisen"]}),r.jsxs(J,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",onClick:()=>$(re.id),children:[r.jsx(Ua,{className:"h-4 w-4 mr-1"}),"Löschen"]})]})]})},re.id))})]}),r.jsx(Qe,{value:"usage",className:"space-y-6 min-h-[600px]",children:r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsx(Ee,{children:"Materialverbrauch"}),r.jsx(Sr,{children:"Übersicht über den Materialverbrauch der letzten 50 Einträge"})]}),r.jsx(ce,{children:r.jsx("div",{className:"space-y-4",children:p.map(re=>r.jsxs("div",{className:"flex justify-between items-center p-4 border rounded-lg",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-medium",children:re.material_name}),r.jsxs("p",{className:"text-sm text-gray-600",children:[re.employee_name," • ",re.project_name]}),r.jsx("p",{className:"text-xs text-gray-500",children:new Date(re.usage_date).toLocaleDateString("de-DE")})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"font-bold",children:[re.quantity_used," ",re.unit]}),re.notes&&r.jsx("p",{className:"text-sm text-gray-600",children:re.notes})]})]},re.id))})})]})}),r.jsx(Qe,{value:"assignments",className:"space-y-6 min-h-[600px]",children:r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsx(Ee,{children:"Projekt-Zuweisungen"}),r.jsx(Sr,{children:"Materialzuweisungen zu Projekten verwalten"})]}),r.jsx(ce,{children:r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(fa,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"Projekt-Zuweisungen werden hier angezeigt"}),r.jsx("p",{className:"text-sm",children:"Funktion wird in Kürze erweitert"})]})})]})}),r.jsx(Qe,{value:"analytics",className:"space-y-6 min-h-[600px]",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Bestandsanalyse"})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Materialien mit niedrigem Bestand:"}),r.jsx("span",{className:"font-bold text-red-600",children:he.length})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Durchschnittlicher Lagerwert pro Material:"}),r.jsxs("span",{className:"font-bold",children:["€",a.length>0?(xe/a.length).toFixed(2):0]})]})]})})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Verbrauchsanalyse"})}),r.jsx(ce,{children:r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(Yu,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"Detaillierte Verbrauchsanalysen"}),r.jsx("p",{className:"text-sm",children:"Werden in Kürze erweitert"})]})})]})]})}),r.jsx(Qe,{value:"prices",className:"space-y-6 min-h-[600px]",children:r.jsx(rte,{})})]}),r.jsx(en,{open:w,onOpenChange:N,children:r.jsxs(Gt,{className:"max-w-2xl",children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Material hinzufügen"}),r.jsx(Xn,{children:"Fügen Sie ein neues Material zu Ihrem Lager hinzu"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Name *"}),r.jsx(ne,{value:F.name,onChange:re=>W(_e=>({..._e,name:re.target.value})),placeholder:"Material-Name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kategorie"}),r.jsxs(vt,{value:F.category,onValueChange:re=>W(_e=>({..._e,category:re})),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Kategorie wählen"})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Kabel & Leitungen",children:"Kabel & Leitungen"}),r.jsx(ye,{value:"Installationsmaterial",children:"Installationsmaterial"}),r.jsx(ye,{value:"Schaltgeräte",children:"Schaltgeräte"}),r.jsx(ye,{value:"Werkzeuge",children:"Werkzeuge"}),r.jsx(ye,{value:"Sonstiges",children:"Sonstiges"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Einheit *"}),r.jsxs(vt,{value:F.unit,onValueChange:re=>W(_e=>({..._e,unit:re})),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Einheit"})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Stk",children:"Stück"}),r.jsx(ye,{value:"m",children:"Meter"}),r.jsx(ye,{value:"kg",children:"Kilogramm"}),r.jsx(ye,{value:"l",children:"Liter"}),r.jsx(ye,{value:"m²",children:"Quadratmeter"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Preis pro Einheit (€)"}),r.jsx(ne,{type:"number",step:"0.01",value:F.unit_price,onChange:re=>W(_e=>({..._e,unit_price:parseFloat(re.target.value)||0}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Aktueller Bestand"}),r.jsx(ne,{type:"number",value:F.current_stock,onChange:re=>W(_e=>({..._e,current_stock:parseFloat(re.target.value)||0}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mindestbestand"}),r.jsx(ne,{type:"number",value:F.min_stock,onChange:re=>W(_e=>({..._e,min_stock:parseFloat(re.target.value)||0}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Maximalbestand"}),r.jsx(ne,{type:"number",value:F.max_stock,onChange:re=>W(_e=>({..._e,max_stock:parseFloat(re.target.value)||0}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Lieferant"}),r.jsxs(vt,{value:F.supplier_id,onValueChange:re=>W(_e=>({..._e,supplier_id:re})),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Lieferant wählen"})}),r.jsx(gt,{children:o.map(re=>r.jsx(ye,{value:re.id,children:re.name},re.id))})]})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Beschreibung"}),r.jsx(En,{value:F.description,onChange:re=>W(_e=>({..._e,description:re.target.value})),placeholder:"Beschreibung des Materials...",rows:3})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Lagerort"}),r.jsx(ne,{value:F.storage_location,onChange:re=>W(_e=>({..._e,storage_location:re.target.value})),placeholder:"z.B. Lager A, Regal 1"})]})]}),r.jsxs(lh,{children:[r.jsx(J,{variant:"outline",onClick:()=>N(!1),children:"Abbrechen"}),r.jsx(J,{onClick:I,disabled:!F.name,children:"Material erstellen"})]})]})}),r.jsx(en,{open:S,onOpenChange:A,children:r.jsxs(Gt,{className:"max-w-2xl",children:[r.jsx(rn,{children:r.jsx(sn,{children:"Material bearbeiten"})}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Name *"}),r.jsx(ne,{value:F.name,onChange:re=>W(_e=>({..._e,name:re.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Aktueller Bestand"}),r.jsx(ne,{type:"number",value:F.current_stock,onChange:re=>W(_e=>({..._e,current_stock:parseFloat(re.target.value)||0}))})]})]}),r.jsxs(lh,{children:[r.jsx(J,{variant:"outline",onClick:()=>A(!1),children:"Abbrechen"}),r.jsx(J,{onClick:H,children:"Aktualisieren"})]})]})}),r.jsx(en,{open:E,onOpenChange:D,children:r.jsxs(Gt,{children:[r.jsxs(rn,{children:[r.jsx(sn,{children:"Materialverbrauch erfassen"}),r.jsx(Xn,{children:"Erfassen Sie den Verbrauch von Material durch einen Mitarbeiter"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Material"}),r.jsxs(vt,{value:ee.material_id,onValueChange:re=>ue(_e=>({..._e,material_id:re})),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Material wählen"})}),r.jsx(gt,{children:a.map(re=>r.jsxs(ye,{value:re.id,children:[re.name," (",re.current_stock," ",re.unit," verfügbar)"]},re.id))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mitarbeiter"}),r.jsxs(vt,{value:ee.employee_id,onValueChange:re=>ue(_e=>({..._e,employee_id:re})),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Mitarbeiter wählen"})}),r.jsx(gt,{children:m.map(re=>r.jsxs(ye,{value:re.id,children:[re.first_name," ",re.last_name]},re.id))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Projekt"}),r.jsxs(vt,{value:ee.project_id,onValueChange:re=>ue(_e=>({..._e,project_id:re})),children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Projekt wählen"})}),r.jsx(gt,{children:d.map(re=>r.jsx(ye,{value:re.id,children:re.name},re.id))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Verbrauchte Menge"}),r.jsx(ne,{type:"number",step:"0.1",value:ee.quantity_used,onChange:re=>ue(_e=>({..._e,quantity_used:parseFloat(re.target.value)||0}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notizen (optional)"}),r.jsx(En,{value:ee.notes,onChange:re=>ue(_e=>({..._e,notes:re.target.value})),rows:2})]})]}),r.jsxs(lh,{children:[r.jsx(J,{variant:"outline",onClick:()=>D(!1),children:"Abbrechen"}),r.jsx(J,{onClick:te,disabled:!ee.material_id||!ee.employee_id||!ee.project_id||!ee.quantity_used,children:"Verbrauch erfassen"})]})]})}),r.jsx(nte,{isOpen:M,onClose:()=>B(!1),selectedMaterial:R,onAssignmentComplete:()=>{Q(),O()}})]})},ate=({machine:t})=>{const e=a=>{switch(a){case"Verfügbar":return"bg-green-100 text-green-800";case"Im Einsatz":return"bg-blue-100 text-blue-800";case"Wartung fällig":return"bg-red-100 text-red-800";case"In Wartung":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},n=a=>{switch(a){case"Sehr gut":return"text-green-600";case"Gut":return"text-blue-600";case"Ausreichend":return"text-yellow-600";case"Wartung erforderlich":return"text-red-600";default:return"text-gray-600"}},s=a=>{switch(a){case"Verfügbar":return r.jsx(Lr,{className:"h-4 w-4 text-green-600"});case"Im Einsatz":return r.jsx(hn,{className:"h-4 w-4 text-blue-600"});case"Wartung fällig":return r.jsx(kr,{className:"h-4 w-4 text-red-600"});case"In Wartung":return r.jsx(Gp,{className:"h-4 w-4 text-yellow-600"});default:return r.jsx(Lr,{className:"h-4 w-4 text-gray-600"})}};return r.jsx(le,{className:"hover:shadow-lg transition-shadow",children:r.jsxs(ce,{className:"p-6 flex flex-col h-full",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s(t.status),r.jsx("h4",{className:"text-lg font-semibold",children:t.name}),r.jsx(Ve,{className:e(t.status),children:t.status})]}),r.jsx("p",{className:"text-gray-600 mb-2",children:t.category}),r.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1 mb-2",children:[r.jsx(sa,{className:"h-4 w-4"}),t.location]}),r.jsxs("p",{className:"text-sm flex items-center gap-1",children:[r.jsx("span",{className:"text-gray-500",children:"Zustand:"}),r.jsx("span",{className:`font-medium ${n(t.condition)}`,children:t.condition})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",t.id]}),r.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[t.operatingHours,"h"]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Betriebsstunden"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4 flex-grow",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Letzte Wartung:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(zt,{className:"h-4 w-4"}),t.lastMaintenance]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Nächste Wartung:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(zt,{className:"h-4 w-4"}),t.nextMaintenance]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"DGUV V3 Prüfung:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(zt,{className:"h-4 w-4"}),t.dguv]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Nächste DGUV V3:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(zt,{className:"h-4 w-4"}),t.nextDguv]})]})]}),t.status==="Wartung fällig"&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[r.jsx(kr,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-medium",children:"Wartung überfällig! Gerät nicht verwenden."})]})}),r.jsxs("div",{className:"flex gap-2 mt-auto",children:[r.jsx(J,{size:"sm",variant:"outline",children:"Details"}),r.jsxs(J,{size:"sm",variant:"outline",children:[r.jsx(zt,{className:"h-4 w-4 mr-1"}),"Wartung"]}),t.status==="Wartung fällig"&&r.jsxs(J,{size:"sm",className:"bg-red-600 hover:bg-red-700",children:[r.jsx(Gp,{className:"h-4 w-4 mr-1"}),"Wartung planen"]})]})]})})},ite=({machines:t})=>{const e=t.length,n=t.filter(i=>i.status==="Verfügbar").length,s=t.filter(i=>i.status==="Im Einsatz").length,a=t.filter(i=>i.status==="Wartung fällig").length;return r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsx(le,{children:r.jsxs(ce,{className:"flex items-center justify-between p-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Ger\\u00e4te gesamt"}),r.jsx("p",{className:"text-lg font-bold",children:e})]}),r.jsx(Eo,{className:"w-5 h-5 text-blue-500"})]})}),r.jsx(le,{children:r.jsxs(ce,{className:"flex items-center justify-between p-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Verf\\u00fcgbar"}),r.jsx("p",{className:"text-lg font-bold",children:n})]}),r.jsx(Lr,{className:"w-5 h-5 text-green-500"})]})}),r.jsx(le,{children:r.jsxs(ce,{className:"flex items-center justify-between p-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Im Einsatz"}),r.jsx("p",{className:"text-lg font-bold",children:s})]}),r.jsx(hn,{className:"w-5 h-5 text-yellow-500"})]})}),r.jsx(le,{children:r.jsxs(ce,{className:"flex items-center justify-between p-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Wartung f\\u00e4llig"}),r.jsx("p",{className:"text-lg font-bold",children:a})]}),r.jsx(kr,{className:"w-5 h-5 text-red-500"})]})})]})},ote=()=>{const t=[{machine:"Hubarbeitsbühne Genie GS-1932",type:"Wartung",date:"20.01.2024",priority:"Hoch"},{machine:"Bohrmaschine Hilti TE 6-A36",type:"Wartung",date:"15.03.2024",priority:"Mittel"},{machine:"Kabelzuggerät Greenlee 855GX",type:"Wartung",date:"08.04.2024",priority:"Niedrig"},{machine:"Messgerät Fluke 1587",type:"DGUV V3",date:"05.01.2025",priority:"Niedrig"}],e=n=>{switch(n){case"Hoch":return"bg-red-100 text-red-800";case"Mittel":return"bg-yellow-100 text-yellow-800";case"Niedrig":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(zt,{className:"h-5 w-5"}),"Wartungsplan"]})}),r.jsx(ce,{children:r.jsx("div",{className:"space-y-3",children:t.map(n=>r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx(Ve,{variant:"outline",className:"text-xs",children:n.type}),r.jsx(Ve,{className:e(n.priority),children:n.priority})]}),r.jsx("p",{className:"font-medium text-sm mb-1",children:n.machine}),r.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[r.jsx(zt,{className:"h-3 w-3"}),n.date]})]},`${n.machine}-${n.date}`))})})]})},lte=()=>r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{className:"text-base",children:"Geräteaktionen"})}),r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs(J,{variant:"outline",className:"w-full justify-start",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Wartung planen"]}),r.jsxs(J,{variant:"outline",className:"w-full justify-start",children:[r.jsx(Lr,{className:"h-4 w-4 mr-2"}),"DGUV V3 Prüfung"]}),r.jsxs(J,{variant:"outline",className:"w-full justify-start",children:[r.jsx(sa,{className:"h-4 w-4 mr-2"}),"Standort ändern"]}),r.jsxs(J,{variant:"outline",className:"w-full justify-start",children:[r.jsx(Eo,{className:"h-4 w-4 mr-2"}),"Inventar"]})]})})]}),cte=()=>r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{className:"text-base text-red-600",children:"Wartung überfällig"})}),r.jsx(ce,{className:"p-4",children:r.jsx("div",{className:"space-y-2",children:r.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 rounded",children:[r.jsx("span",{className:"text-sm",children:"Hubarbeitsbühne"}),r.jsx("span",{className:"text-xs text-red-600",children:"3 Tage"})]})})})]}),dte=()=>{const t=[{id:"M001",name:"Bohrmaschine Hilti TE 6-A36",category:"Bohrgeräte",location:"Baustelle Müller GmbH",status:"Im Einsatz",lastMaintenance:"15.12.2023",nextMaintenance:"15.03.2024",dguv:"22.11.2023",nextDguv:"22.11.2024",operatingHours:324,condition:"Gut"},{id:"M002",name:"Messgerät Fluke 1587",category:"Messgeräte",location:"Lager",status:"Verfügbar",lastMaintenance:"10.01.2024",nextMaintenance:"10.07.2024",dguv:"05.01.2024",nextDguv:"05.01.2025",operatingHours:156,condition:"Sehr gut"},{id:"M003",name:"Hubarbeitsbühne Genie GS-1932",category:"Hebegeräte",location:"Baustelle Weber Bau",status:"Wartung fällig",lastMaintenance:"20.10.2023",nextMaintenance:"20.01.2024",dguv:"15.12.2023",nextDguv:"15.12.2024",operatingHours:892,condition:"Wartung erforderlich"},{id:"M004",name:"Kabelzuggerät Greenlee 855GX",category:"Installationshilfen",location:"Fahrzeug 1",status:"Im Einsatz",lastMaintenance:"08.01.2024",nextMaintenance:"08.04.2024",dguv:"30.11.2023",nextDguv:"30.11.2024",operatingHours:245,condition:"Gut"}];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-indigo-600 bg-clip-text text-transparent flex items-center gap-3",children:[r.jsx(Eo,{className:"h-8 w-8 text-indigo-600"}),"Maschinen & Geräte"]}),r.jsx("p",{className:"text-gray-600",children:"Verwalten Sie Ihren Maschinenpark und Wartungsintervalle"})]}),r.jsxs(J,{children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Gerät hinzufügen"]})]}),r.jsx(ite,{machines:t}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Maschinenübersicht"}),t.map(e=>r.jsx(ate,{machine:e},e.id))]}),r.jsxs("div",{className:"space-y-6",children:[r.jsx(ote,{}),r.jsx(lte,{}),r.jsx(cte,{})]})]})]})},ute=()=>{const{toast:t}=Rt(),{data:e,isLoading:n}=ZM(),{data:s,isLoading:a}=OZ(),{data:i,isLoading:o}=LZ(),[c,d]=g.useState([]),[u,m]=g.useState(!0),[f,p]=g.useState({hoursPerDay:0,breakHours:0,loaded:!1});GM();const[y,j]=g.useState("dashboard"),[v,_]=g.useState([]),[b,w]=g.useState(!1),[N,S]=g.useState(null),[A,E]=g.useState({}),[D,M]=g.useState(!1),[B,R]=g.useState({name:"",icon:"💼",items:[{name:"",value:"0"}]}),[P,F]=g.useState([]);g.useEffect(()=>{const Z=localStorage.getItem("handwerkos_custom_categories");if(Z)try{F(JSON.parse(Z))}catch(ie){console.error("Error loading saved categories:",ie)}},[]),g.useEffect(()=>{P.length>0&&localStorage.setItem("handwerkos_custom_categories",JSON.stringify(P))},[P]),g.useEffect(()=>{console.log("🔄 Working hours state updated:",f)},[f]);const[W,ee]=g.useState({miete:"1.000",nebenkosten:"300",reinigung:"100",fahrzeugLeasing:"500",fahrzeugVersicherung:"150",fahrzeugSteuer:"100",versicherungHaftpflicht:"200",versicherungRente:"300",versicherungBerufsunfaehigkeit:"150",verwaltungSoftware:"150",verwaltungSteuerberater:"250",verwaltungMarketing:"200",personalGehaelter:"708",personalSozialversicherung:"142",personalWeihnachtsgeld:"100"}),ue=()=>{const ie=1400+Q().total+750+392+600,pe=P.reduce((G,se)=>G+se.total,0);return ie+pe},de=Z=>Z.reduce((ie,pe)=>{const G=parseFloat(pe.value.replace(/[^\d.-]/g,""))||0;return ie+G},0),Q=()=>{if(console.log("FinanceModule calculatePersonnelCosts:",{employees:c,employeeCount:(c==null?void 0:c.length)||0,employeesLoading:u}),!c||c.length===0)return console.log("FinanceModule: No employees found, returning zero costs"),{totalSalaries:0,socialInsurance:0,bonuses:0,total:0,employeeCount:0};const Z=localStorage.getItem("employeeWages"),ie=Z?JSON.parse(Z):[];console.log("💾 Loaded wages from localStorage:",ie);const pe=c.filter(be=>{var Ke;const Be=(Ke=be.status)==null?void 0:Ke.toLowerCase();return Be==="active"||Be==="aktiv"||!be.status}),G=pe.length,se=pe.reduce((be,Be)=>{const At=21.25*f.hoursPerDay,je=ie.find(at=>at.employee_id===Be.id),De=(je==null?void 0:je.hourly_wage)||Be.hourly_rate||0,Ie=De*At;return console.log(`👷 Employee ${Be.first_name} ${Be.last_name}:`,{status:Be.status,hourly_rate_from_db:Be.hourly_rate,hourly_rate_from_localStorage:je==null?void 0:je.hourly_wage,hourly_rate_used:De,hours_per_month:At,calculated_monthly:Ie.toFixed(2)+"€"}),(!Be.hourly_rate||Be.hourly_rate===0)&&console.warn(`⚠️ Employee ${Be.first_name} ${Be.last_name} has no hourly rate set!`),be+Ie},0);console.log("💰 Total monthly salaries calculation:",{activeEmployeeCount:G,totalMonthlySalaries:se.toFixed(2)+"€"});const he=se*.21,re=se*2/12,_e={totalSalaries:se,socialInsurance:he,bonuses:re,total:se+he+re,employeeCount:G};return console.log("Personnel costs calculation result:",_e),_e},z=()=>{const Z=ue()/12,ie=8e3/12,pe=25e3/12,G=Z+ie+pe,se=21.25,me=f.hoursPerDay-f.breakHours,he=se*me,xe=G/he,re=xe*1.3;return{minimumRate:xe,recommendedRate:re,totalAmount:G,workingHours:he}};e!=null&&e.items;const V=(s==null?void 0:s.items)||[],U=i||{monthly_revenue:0,monthly_expenses:0,monthly_profit:0,total_outstanding:0,overdue_count:0,active_projects_profit:0,avg_profit_margin:0,revenue_trend:0,expense_trend:0,profit_trend:0},O=n||a||o||u,I=async()=>{try{console.log("⏰ Starting to fetch company working hours...",new Date().toISOString());const{data:Z}=await K.auth.getUser();if(!(Z!=null&&Z.user)){console.log("❌ No authenticated user");return}const{data:ie,error:pe}=await K.from("profiles").select("company_id").eq("id",Z.user.id).single();if(console.log("👤 Profile query result:",{profile:ie,profileError:pe}),!(ie!=null&&ie.company_id)){console.log("❌ No company_id found in profile");return}console.log("🔍 Fetching settings for company_id:",ie.company_id);const{data:G,error:se}=await K.from("company_settings").select("default_working_hours_start, default_working_hours_end, default_break_duration, company_id").eq("company_id",ie.company_id).single();if(console.log("📊 Query result:",{settings:G,error:se}),se||!G){console.log("⚠️ No company settings found, checking if we need to create them");const{data:Me,error:Nt}=await K.from("company_settings").insert({company_id:ie.company_id,company_name:"Meine Firma",default_working_hours_start:"08:00:00",default_working_hours_end:"17:00:00",default_break_duration:30,default_tax_rate:19,default_currency:"EUR",quote_validity_days:30,invoice_prefix:"R",quote_prefix:"Q",order_prefix:"A"}).select().single();if(Nt){console.log("⚠️ Could not create settings, using default values. Error:",Nt),p({hoursPerDay:8,breakHours:.5,loaded:!0});return}console.log("✅ Created default company settings:",Me),p({hoursPerDay:9,breakHours:.5,loaded:!0});return}console.log("📋 Raw company settings:",G);const me=G.default_working_hours_start||"08:00",he=G.default_working_hours_end||"17:00",xe=me.substring(0,5),re=he.substring(0,5),_e=G.default_break_duration||30,[be,Be]=xe.split(":").map(Number),[Ke,At]=re.split(":").map(Number),je=be*60+Be,De=Ke*60+At,Ie=De-je,at=Ie/60,$e=_e/60;console.log("🔢 Calculated hours:",{startMinutes:je,endMinutes:De,workMinutesPerDay:Ie,hoursPerDay:at,breakHours:$e}),p({hoursPerDay:at,breakHours:$e,loaded:!0}),console.log("🕐 Company working hours loaded:",{startTime:xe,endTime:re,breakMinutes:_e,hoursPerDay:at,breakHours:$e,productiveHours:at-$e})}catch(Z){console.error("❌ ERROR fetching company working hours:",Z),console.log("⚠️ Using fallback values due to error"),p({hoursPerDay:8,breakHours:.5,loaded:!0})}};g.useEffect(()=>{I(),(async()=>{try{m(!0);const{data:ie}=await K.auth.getUser();if(!(ie!=null&&ie.user)){console.log("No authenticated user"),d([]),m(!1);return}const{data:pe}=await K.from("profiles").select("company_id").eq("id",ie.user.id).single();if(!(pe!=null&&pe.company_id)){console.log("No company_id found"),d([]),m(!1);return}const{data:G,error:se}=await K.from("employees").select("id, first_name, last_name, status, hourly_rate, position").eq("company_id",pe.company_id);if(se)console.error("❌ Error fetching employees:",se),d([]);else{console.log("✅ Fetched employees successfully:",G),console.log("📊 Employee details:",G==null?void 0:G.map(he=>({name:`${he.first_name} ${he.last_name}`,position:he.position,status:he.status,hourly_rate:he.hourly_rate,has_hourly_rate:he.hourly_rate!==null&&he.hourly_rate>0})));const me=(G==null?void 0:G.filter(he=>!he.hourly_rate||he.hourly_rate===0))||[];me.length>0&&console.warn("⚠️ Employees without hourly rate:",me.map(he=>`${he.first_name} ${he.last_name}`)),d(G||[])}}catch(ie){console.error("Error in fetchEmployees:",ie),d([])}finally{m(!1)}})(),H()},[]),g.useEffect(()=>{if(console.log("🎯 Tab changed to:",y),y==="fixkosten"){console.log("📍 Tab is fixkosten, fetching working hours..."),I();const Z=setInterval(()=>{console.log("🔄 Refreshing working hours (interval)..."),I()},5e3);return()=>{console.log("🛑 Clearing interval for working hours refresh"),clearInterval(Z)}}},[y]),g.useEffect(()=>{const Z=()=>{document.visibilityState==="visible"&&y==="fixkosten"&&I()},ie=()=>{y==="fixkosten"&&I()};return document.addEventListener("visibilitychange",Z),window.addEventListener("focus",ie),()=>{document.removeEventListener("visibilitychange",Z),window.removeEventListener("focus",ie)}},[y]);const H=async()=>{_([{month:"2024-08",revenue:22e3,expenses:16e3,profit:6e3},{month:"2024-09",revenue:28e3,expenses:19e3,profit:9e3},{month:"2024-10",revenue:31e3,expenses:22e3,profit:9e3},{month:"2024-11",revenue:26e3,expenses:18500,profit:7500},{month:"2024-12",revenue:35e3,expenses:24e3,profit:11e3},{month:"2025-01",revenue:25e3,expenses:18e3,profit:7e3}])},$=Z=>{switch(Z){case"materials":return"🧱";case"subcontractor":return"👷";case"labor":return"⏰";case"operating":return"🏢";default:return"📋"}},te=Z=>{switch(Z){case"materials":return"Material";case"subcontractor":return"Nachunternehmer";case"labor":return"Lohn";case"operating":return"Betriebskosten";default:return"Sonstiges"}},X=Z=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(Z);return O?r.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[r.jsxs("div",{className:"flex items-center justify-between mb-8",children:[r.jsx(lt,{className:"h-10 w-64"}),r.jsxs("div",{className:"flex gap-6",children:[r.jsx(lt,{className:"h-10 w-24"}),r.jsx(lt,{className:"h-10 w-32"})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:Array(4).fill(0).map((Z,ie)=>r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(lt,{className:"h-4 w-20 mb-2"}),r.jsx(lt,{className:"h-8 w-16"}),r.jsx(lt,{className:"h-3 w-12 mt-1"})]}),r.jsx(lt,{className:"h-8 w-8 rounded-full"})]})})},ie))}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(lt,{className:"h-6 w-32"})}),r.jsx(ce,{children:r.jsx("div",{className:"space-y-4",children:Array(5).fill(0).map((Z,ie)=>r.jsx("div",{className:"border rounded p-4",children:r.jsx(lt,{className:"h-20 w-full"})},ie))})})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(lt,{className:"h-6 w-32"})}),r.jsx(ce,{children:r.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((Z,ie)=>r.jsx("div",{className:"p-3 bg-gray-50 rounded",children:r.jsx(lt,{className:"h-16 w-full"})},ie))})})]})]})]}):r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Finanzen & Buchhaltung"}),r.jsx("div",{className:"flex items-center gap-4",children:r.jsxs(J,{variant:"outline",className:"rounded-full",children:[r.jsx(_m,{className:"h-4 w-4 mr-2"}),"Export"]})})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsumsatz"}),r.jsx("p",{className:"text-2xl font-bold text-green-700",children:X(U.monthly_revenue)})]}),r.jsx(hs,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsausgaben"}),r.jsx("p",{className:"text-2xl font-bold text-red-700",children:X(U.monthly_expenses)})]}),r.jsx(zb,{className:"h-8 w-8 text-red-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsgewinn"}),r.jsx("p",{className:"text-2xl font-bold text-blue-700",children:X(U.monthly_profit)})]}),r.jsx(Ao,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Offene Posten"}),r.jsx("p",{className:"text-2xl font-bold text-orange-700",children:X(U.total_outstanding)}),r.jsx(kr,{className:"h-8 w-8 text-orange-500 opacity-50"})]})})})]}),r.jsxs(zr,{value:y,onValueChange:j,className:"w-full",children:[r.jsxs(Er,{className:"grid w-full grid-cols-5 mb-6",children:[r.jsxs(Ge,{value:"dashboard",className:"flex items-center gap-2",children:[r.jsx(Yu,{className:"h-4 w-4"}),"Dashboard"]}),r.jsxs(Ge,{value:"expenses",className:"flex items-center gap-2",children:[r.jsx(ms,{className:"h-4 w-4"}),"Ausgaben"]}),r.jsxs(Ge,{value:"fixkosten",className:"flex items-center gap-2",children:[r.jsx(ra,{className:"h-4 w-4"}),"Betriebskosten"]}),r.jsxs(Ge,{value:"reports",className:"flex items-center gap-2",children:[r.jsx(Yu,{className:"h-4 w-4"}),"Berichte"]}),r.jsxs(Ge,{value:"tax",className:"flex items-center gap-2",children:[r.jsx(hs,{className:"h-4 w-4"}),"Steuer"]})]}),r.jsx(Qe,{value:"dashboard",className:"space-y-6",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs(le,{className:"lg:col-span-2",children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"📊 Umsatz-Verlauf (letzte 6 Monate)"})}),r.jsx(ce,{children:r.jsx("div",{className:"space-y-4",children:v.map((Z,ie)=>{const pe=new Date(Z.month+"-01").toLocaleDateString("de-DE",{month:"short",year:"numeric"}),G=Math.max(...v.map(he=>he.revenue)),se=Z.revenue/G*100,me=Z.expenses/G*100;return r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:pe}),r.jsxs("span",{className:"font-medium",children:[X(Z.profit)," Gewinn"]})]}),r.jsxs("div",{className:"relative h-6 bg-gray-100 rounded",children:[r.jsx("div",{className:"absolute h-full bg-green-500 rounded",style:{width:`${se}%`}}),r.jsx("div",{className:"absolute h-full bg-red-400 rounded",style:{width:`${me}%`}})]}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[r.jsxs("span",{children:["Umsatz: ",X(Z.revenue)]}),r.jsxs("span",{children:["Ausgaben: ",X(Z.expenses)]})]})]},ie)})})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"⚡ Schnellzugriff"})}),r.jsxs(ce,{className:"space-y-3",children:[r.jsxs(J,{className:"w-full justify-start",variant:"outline",children:[r.jsx(On,{className:"h-4 w-4 mr-2"}),"Neue Rechnung"]}),r.jsxs(J,{className:"w-full justify-start",variant:"outline",children:[r.jsx(ms,{className:"h-4 w-4 mr-2"}),"Ausgabe erfassen"]}),r.jsxs(J,{className:"w-full justify-start",variant:"outline",children:[r.jsx(hs,{className:"h-4 w-4 mr-2"}),"Zahlung erfassen"]}),r.jsxs(J,{className:"w-full justify-start",variant:"outline",children:[r.jsx(_m,{className:"h-4 w-4 mr-2"}),"DATEV Export"]})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"💎 Projekt-Rentabilität"})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm",children:"Aktive Projekte"}),r.jsx("span",{className:"font-medium",children:X(U.active_projects_profit)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm",children:"Ø Gewinnmarge"}),r.jsxs(Ve,{variant:"outline",children:[U.avg_profit_margin.toFixed(1),"%"]})]})]})})]})]})]})}),r.jsx(Qe,{value:"expenses",className:"space-y-6",children:r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"💸 Ausgabenmanagement"})}),r.jsx(ce,{children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-4",children:"📋 Aktuelle Ausgaben"}),r.jsx("div",{className:"space-y-3",children:V.map(Z=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-2xl",children:$(Z.category)}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:Z.description}),r.jsxs("p",{className:"text-sm text-gray-500",children:[te(Z.category)," • ",new Date(Z.date).toLocaleDateString("de-DE")]}),Z.project&&r.jsxs("p",{className:"text-xs text-blue-600",children:["→ ",Z.project]})]})]}),r.jsx("div",{className:"text-right",children:r.jsx("p",{className:"font-bold text-red-600",children:X(Z.amount)})})]},Z.id))})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-4",children:"📊 Ausgaben-Kategorien"}),r.jsx("div",{className:"space-y-3",children:["materials","subcontractor","labor","operating"].map(Z=>{const ie=V.filter(G=>G.category===Z),pe=ie.reduce((G,se)=>G+se.amount,0);return r.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xl",children:$(Z)}),r.jsx("span",{className:"font-medium",children:te(Z)})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"font-bold",children:X(pe)}),r.jsxs("p",{className:"text-sm text-gray-500",children:[ie.length," Ausgaben"]})]})]},Z)})})]})]})})]})}),r.jsx(Qe,{value:"reports",className:"space-y-6",children:r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"📊 Finanzberichte & Auswertungen"})}),r.jsx(ce,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs(J,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(On,{className:"h-6 w-6"}),r.jsx("span",{children:"Offene Posten Liste"})]}),r.jsxs(J,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(Ao,{className:"h-6 w-6"}),r.jsx("span",{children:"Umsatzauswertung"})]}),r.jsxs(J,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(Yu,{className:"h-6 w-6"}),r.jsx("span",{children:"Projekt-Rentabilität"})]}),r.jsxs(J,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(ra,{className:"h-6 w-6"}),r.jsx("span",{children:"Kostenanalyse"})]}),r.jsxs(J,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(hs,{className:"h-6 w-6"}),r.jsx("span",{children:"Liquiditätsplanung"})]}),r.jsxs(J,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(_m,{className:"h-6 w-6"}),r.jsx("span",{children:"Jahresauswertung"})]})]})})]})}),r.jsx(Qe,{value:"tax",className:"space-y-6",children:r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"🏛️ Steuerliche Compliance"})}),r.jsx(ce,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-4",children:"📊 Umsatzsteuer"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"p-3 border rounded-lg",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Umsatz 19% USt"}),r.jsx("span",{className:"font-medium",children:X(18e3)})]}),r.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[r.jsx("span",{children:"Umsatzsteuer 19%"}),r.jsx("span",{children:X(3420)})]})]}),r.jsxs("div",{className:"p-3 border rounded-lg",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Umsatz 7% USt"}),r.jsx("span",{className:"font-medium",children:X(2e3)})]}),r.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[r.jsx("span",{children:"Umsatzsteuer 7%"}),r.jsx("span",{children:X(140)})]})]}),r.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:r.jsxs("div",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Gesamte USt-Schuld"}),r.jsx("span",{className:"text-blue-600",children:X(3560)})]})})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-4",children:"📁 Export & Berichte"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(J,{variant:"outline",className:"w-full justify-start",children:[r.jsx(_m,{className:"h-4 w-4 mr-2"}),"DATEV-Export"]}),r.jsxs(J,{variant:"outline",className:"w-full justify-start",children:[r.jsx(v_,{className:"h-4 w-4 mr-2"}),"CSV-Export"]}),r.jsxs(J,{variant:"outline",className:"w-full justify-start",children:[r.jsx(On,{className:"h-4 w-4 mr-2"}),"EÜR-Vorbereitung"]}),r.jsxs(J,{variant:"outline",className:"w-full justify-start",children:[r.jsx(Eo,{className:"h-4 w-4 mr-2"}),"Steuer-Einstellungen"]})]})]})]})})]})}),r.jsx(Qe,{value:"fixkosten",className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(ra,{className:"h-5 w-5"}),"💰 Betriebskosten (monatlich)"]}),r.jsx(Sr,{children:"Verwalten Sie Ihre monatlichen Betriebskosten für die Stundensatz-Berechnung"})]}),r.jsxs(ce,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-3",children:r.jsxs(Ee,{className:"flex items-center gap-2 text-base",children:[r.jsx("span",{className:"text-xl",children:"🏢"}),"Betrieb & Büro"]})}),r.jsxs(ce,{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Miete/Pacht"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.miete,onChange:Z=>ee({...W,miete:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.miete," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Nebenkosten"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.nebenkosten,onChange:Z=>ee({...W,nebenkosten:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.nebenkosten," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Reinigung"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.reinigung,onChange:Z=>ee({...W,reinigung:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.reinigung," €"]})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:X(1400)})]})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-3",children:r.jsxs(Ee,{className:"flex items-center gap-2 text-base",children:[r.jsx("span",{className:"text-xl",children:"👷‍♂️"}),"Personal"]})}),r.jsx(ce,{className:"space-y-2",children:(()=>{const Z=Q();return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("span",{className:"text-sm text-muted-foreground",children:["Fixgehälter Mitarbeiter (",Z.employeeCount," MA)"]}),r.jsx("span",{className:"text-sm font-medium",children:X(Z.totalSalaries)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Arbeitgeberanteile Sozialversicherung"}),r.jsx("span",{className:"text-sm font-medium",children:X(Z.socialInsurance)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Weihnachts-/Urlaubsgeld"}),r.jsx("span",{className:"text-sm font-medium",children:X(Z.bonuses)})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:X(Z.total)})]}),Z.employeeCount===0&&r.jsxs("div",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded mt-2",children:["⚠️ Keine aktiven Mitarbeiter gefunden. Personalkosten sind 0 €.",r.jsx("br",{}),r.jsx("span",{className:"text-xs",children:"Stellen Sie sicher, dass Mitarbeiter einen Stundenlohn haben und aktiv sind."})]}),Z.employeeCount>0&&Z.total===0&&r.jsx("div",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded mt-2",children:"⚠️ Mitarbeiter gefunden, aber keine Stundenlöhne eingetragen."})]})})()})]}),r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-3",children:r.jsxs(Ee,{className:"flex items-center gap-2 text-base",children:[r.jsx("span",{className:"text-xl",children:"🚗"}),"Fahrzeuge"]})}),r.jsxs(ce,{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Leasing/Abschreibung"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.fahrzeugLeasing,onChange:Z=>ee({...W,fahrzeugLeasing:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.fahrzeugLeasing," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Versicherung"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.fahrzeugVersicherung,onChange:Z=>ee({...W,fahrzeugVersicherung:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.fahrzeugVersicherung," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Steuer & Wartung"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.fahrzeugSteuer,onChange:Z=>ee({...W,fahrzeugSteuer:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.fahrzeugSteuer," €"]})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:X(9e3)})]})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-3",children:r.jsxs(Ee,{className:"flex items-center gap-2 text-base",children:[r.jsx("span",{className:"text-xl",children:"🛡️"}),"Versicherungen & Beiträge"]})}),r.jsxs(ce,{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Betriebshaftpflicht"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.versicherungHaftpflicht,onChange:Z=>ee({...W,versicherungHaftpflicht:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.versicherungHaftpflicht," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Berufsgenossenschaft"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.versicherungRente,onChange:Z=>ee({...W,versicherungRente:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.versicherungRente," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Kammer/Innung"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.versicherungBerufsunfaehigkeit,onChange:Z=>ee({...W,versicherungBerufsunfaehigkeit:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.versicherungBerufsunfaehigkeit," €"]})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:X(4700)})]})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-3",children:r.jsxs(Ee,{className:"flex items-center gap-2 text-base",children:[r.jsx("span",{className:"text-xl",children:"🏭"}),"Verwaltung & Organisation"]})}),r.jsxs(ce,{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Software & Lizenzen"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.verwaltungSoftware,onChange:Z=>ee({...W,verwaltungSoftware:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.verwaltungSoftware," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Steuerberater"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.verwaltungSteuerberater,onChange:Z=>ee({...W,verwaltungSteuerberater:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.verwaltungSteuerberater," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Marketing & Werbung"}),b?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(ne,{type:"text",value:W.verwaltungMarketing,onChange:Z=>ee({...W,verwaltungMarketing:Z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[W.verwaltungMarketing," €"]})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:X(7200)})]})]})]}),P.map(Z=>{const ie=b||N===Z.id,pe=A[Z.id]||Z;return r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-3",children:r.jsxs(Ee,{className:"flex items-center justify-between text-base",children:[r.jsx("div",{className:"flex items-center gap-2",children:ie?r.jsxs(r.Fragment,{children:[r.jsx(ne,{type:"text",value:pe.icon,onChange:G=>E({...A,[Z.id]:{...pe,icon:G.target.value}}),className:"w-12 h-8 text-center text-xl p-0"}),r.jsx(ne,{type:"text",value:pe.name,onChange:G=>E({...A,[Z.id]:{...pe,name:G.target.value}}),className:"h-8 text-base font-semibold"})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-xl",children:Z.icon}),r.jsx("span",{children:Z.name})]})}),!b&&r.jsx(J,{size:"sm",variant:"ghost",onClick:()=>{F(G=>G.filter(se=>se.id!==Z.id))},className:"h-7 w-7 p-0 text-red-500 hover:text-red-700",children:r.jsx(ar,{className:"h-4 w-4"})})]})}),r.jsxs(ce,{className:"space-y-2",children:[ie?r.jsxs(r.Fragment,{children:[pe.items.map((G,se)=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ne,{type:"text",value:G.name,onChange:me=>{const he=[...pe.items];he[se].name=me.target.value,E({...A,[Z.id]:{...pe,items:he}})},className:"flex-1 h-7 text-sm"}),r.jsx(ne,{type:"text",value:G.value,onChange:me=>{const he=[...pe.items];he[se].value=me.target.value,E({...A,[Z.id]:{...pe,items:he}})},className:"w-20 h-7 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]},se)),r.jsxs(J,{variant:"outline",size:"sm",className:"w-full h-7 mt-2",onClick:()=>{const G=[...pe.items,{name:"",value:"0"}];E({...A,[Z.id]:{...pe,items:G}})},children:[r.jsx(dn,{className:"h-3 w-3 mr-1"}),"Zeile hinzufügen"]})]}):r.jsx(r.Fragment,{children:Z.items.map((G,se)=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:G.name}),r.jsxs("span",{className:"text-sm font-medium",children:[G.value," €"]})]},se))}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:X(ie?de(pe.items):Z.total)})]})]})]},Z.id)}),D?r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-3",children:r.jsx(Ee,{className:"flex items-center gap-2 text-base",children:r.jsx(ne,{type:"text",placeholder:"🏢 Kategorie Name",value:B.name,onChange:Z=>R({...B,name:Z.target.value}),className:"text-base font-semibold border-none p-0 h-auto bg-transparent"})})}),r.jsxs(ce,{className:"space-y-2",children:[B.items.map((Z,ie)=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ne,{type:"text",placeholder:"Kostenpunkt",value:Z.name,onChange:pe=>{const G=[...B.items];G[ie].name=pe.target.value,R({...B,items:G})},className:"flex-1 h-7 text-sm"}),r.jsx(ne,{type:"text",placeholder:"0",value:Z.value,onChange:pe=>{const G=[...B.items];G[ie].value=pe.target.value,R({...B,items:G})},className:"w-20 h-7 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]},ie)),r.jsxs(J,{variant:"outline",size:"sm",className:"w-full h-7",onClick:()=>R({...B,items:[...B.items,{name:"",value:"0"}]}),children:[r.jsx(dn,{className:"h-3 w-3 mr-1"}),"Kostenpunkt hinzufügen"]}),r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsx(J,{variant:"outline",size:"sm",onClick:()=>{M(!1),R({name:"",icon:"💼",items:[{name:"",value:"0"}]})},children:r.jsx(ar,{className:"h-4 w-4"})}),r.jsx(J,{size:"sm",onClick:()=>{if(B.name&&B.items.some(Z=>Z.name)){const Z=de(B.items),ie={id:Date.now().toString(),name:B.name,icon:B.icon,items:B.items,total:Z};F(pe=>[...pe,ie]),M(!1),R({name:"",icon:"💼",items:[{name:"",value:"0"}]}),t({title:"Kategorie erstellt",description:`"${B.name}" wurde erfolgreich hinzugefügt.`})}},children:r.jsx(Zp,{className:"h-4 w-4"})})]})]})]}):r.jsx(le,{className:"border-dashed border-2 border-gray-300 hover:border-gray-400 transition-colors cursor-pointer",onClick:()=>M(!0),children:r.jsx(ce,{className:"flex items-center justify-center h-48 p-4",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center mx-auto mb-3 transition-colors",children:r.jsx(dn,{className:"h-6 w-6 text-gray-400"})}),r.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Neue Kategorie"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"hinzufügen"})]})})})]})]}),r.jsx("div",{className:"flex justify-end gap-2",children:b?r.jsxs(r.Fragment,{children:[r.jsx(J,{variant:"outline",size:"sm",onClick:()=>{w(!1),S(null),E({})},children:r.jsx(ar,{className:"h-4 w-4"})}),r.jsx(J,{size:"sm",onClick:()=>{Object.keys(A).forEach(Z=>{const ie=A[Z],pe={...ie,total:de(ie.items)};F(G=>G.map(se=>se.id===Z?pe:se))}),w(!1),S(null),E({}),t({title:"Kosten aktualisiert",description:"Die Betriebskosten wurden erfolgreich gespeichert."})},children:r.jsx(Zp,{className:"h-4 w-4"})})]}):r.jsx(J,{variant:"outline",size:"sm",onClick:()=>{w(!0);const Z={};P.forEach(ie=>{Z[ie.id]=ie}),E(Z)},children:r.jsx(QF,{className:"h-4 w-4"})})})]})]}),r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-2xl",children:"⚡"}),"Stundensatz-Rechner"]}),r.jsx(Sr,{children:"Automatische Berechnung basierend auf Betriebskosten"})]}),r.jsxs(ce,{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"p-4 border rounded-lg",children:[r.jsx(Y,{className:"text-sm text-muted-foreground",children:"Fixkosten (Betrieb)"}),r.jsxs("p",{className:"text-2xl font-bold",children:[X(ue()/12)," / Monat"]})]}),r.jsxs("div",{className:"p-4 border rounded-lg",children:[r.jsx(Y,{className:"text-sm text-muted-foreground",children:"Variable Grundkosten"}),r.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[X(8e3/12)," / Monat"]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Material (netto), etc."})]}),r.jsxs("div",{className:"p-4 border rounded-lg",children:[r.jsx(Y,{className:"text-sm text-muted-foreground",children:"Gewollter Gewinn"}),r.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[X(25e3/12)," / Monat"]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsx(Y,{className:"text-sm text-muted-foreground",children:"Arbeitstage 2025"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("p",{className:"text-xl font-semibold",children:"261 Tage"}),r.jsx(Ve,{variant:"outline",children:"8 Stunden"})]})]}),r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsx(Y,{className:"text-sm text-muted-foreground",children:"Urlaubstage:"}),r.jsx("p",{className:"text-lg",children:"- 30 Tage"})]}),r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsx(Y,{className:"text-sm text-muted-foreground",children:"Arbeitsstunden/Monat:"}),f.loaded?r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"text-xl font-semibold",children:[Math.round(21.25*f.hoursPerDay)," Stunden"]}),r.jsxs(Ve,{variant:"secondary",className:"mt-2",children:[Math.round(21.25*(f.hoursPerDay-f.breakHours))," Stunden (nach Pausen)"]}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["21,25 Tage × ",Number(f.hoursPerDay).toFixed(1),"h - ",Number(f.breakHours*60).toFixed(0)," Min. Pausen"]})]}):r.jsx("p",{className:"text-sm text-muted-foreground",children:"Lade Arbeitszeiten..."})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[r.jsx(Y,{className:"text-sm text-muted-foreground",children:"Mindest-Stundensatz"}),r.jsx("p",{className:"text-3xl font-bold text-blue-600",children:X(z().minimumRate)}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["(",X(z().totalAmount)," ÷ ",z().workingHours,"h)"]})]}),r.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[r.jsx(Y,{className:"text-sm text-muted-foreground",children:"Empfohlener Stundensatz"}),r.jsx("p",{className:"text-3xl font-bold text-green-600",children:X(z().recommendedRate)}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"+30% Gewinnaufschlag & Rücklage"})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs(J,{size:"lg",children:[r.jsx(ra,{className:"h-4 w-4 mr-2"}),"Stundensatz anpassen"]})})]})]})]})})]})]})};var hte="Separator",LC="horizontal",fte=["horizontal","vertical"],hI=g.forwardRef((t,e)=>{const{decorative:n,orientation:s=LC,...a}=t,i=mte(s)?s:LC,c=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return r.jsx(Xe.div,{"data-orientation":i,...c,...a,ref:e})});hI.displayName=hte;function mte(t){return fte.includes(t)}var fI=hI;const po=g.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...s},a)=>r.jsx(fI,{ref:a,decorative:n,orientation:e,className:Oe("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...s}));po.displayName=fI.displayName;const pte=()=>{const[t,e]=g.useState(new Date),[n,s]=g.useState("month"),[a,i]=g.useState("overview"),[o,c]=g.useState("all"),[d,u]=g.useState("all"),[m,f]=g.useState([]),[p,y]=g.useState([]),[j,v]=g.useState([]),[_,b]=g.useState([]),[w,N]=g.useState([]),[S,A]=g.useState(!0),{toast:E}=Rt();g.useEffect(()=>{D()},[]);const D=async()=>{A(!0);try{await Promise.all([M(),B(),R(),P(),F()])}catch(te){console.error("Error loading planner data:",te),E({title:"Fehler beim Laden",description:"Die Planerdaten konnten nicht geladen werden.",variant:"destructive"})}A(!1)},M=async()=>{const{data:te,error:X}=await K.from("projects").select("*").order("start_date");if(X)throw X;f(te||[])},B=async()=>{try{const{data:te}=await K.auth.getUser();if(!(te!=null&&te.user))return;const{data:X}=await K.from("profiles").select("company_id").eq("id",te.user.id).single();if(!(X!=null&&X.company_id))return;const{data:Z,error:ie}=await K.from("employees").select("*").eq("company_id",X.company_id).neq("status","eingeladen").not("user_id","is",null).order("last_name");if(ie)throw ie;y(Z||[])}catch(te){console.error("Error loading employees:",te)}},R=async()=>{const{data:te,error:X}=await K.from("employee_absences").select(`
        *,
        employee:employees!employee_absences_employee_id_fkey(*)
      `).order("start_date");if(X)throw X;v(te||[])},P=async()=>{const{data:te,error:X}=await K.from("calendar_events").select("*").order("start_date");if(X)throw X;b(te||[])},F=async()=>{const{data:te,error:X}=await K.from("project_assignments").select(`
        *,
        project:projects(*),
        employee:employees(*)
      `).order("start_date");if(X)throw X;N(te||[])},W=()=>n==="week"?{start:xa(t,{weekStartsOn:1}),end:Og(t,{weekStartsOn:1})}:{start:Br(t),end:Ig(t)},{start:ee,end:ue}=W();JQ({start:ee,end:ue});const de=()=>{e(n==="week"?pX(t,1):mX(t,1))},Q=()=>{e(n==="week"?Kh(t,1):bs(t,1))},z=te=>{switch(te){case"urlaub":return"bg-green-500";case"krank":return"bg-red-500";case"fortbildung":return"bg-blue-500";case"elternzeit":return"bg-purple-500";default:return"bg-gray-500"}},V=te=>{switch(te){case"urlaub":return r.jsx(zt,{className:"w-3 h-3"});case"krank":return r.jsx(X0,{className:"w-3 h-3"});case"fortbildung":return r.jsx($s,{className:"w-3 h-3"});default:return r.jsx(hn,{className:"w-3 h-3"})}},U=te=>{switch(te){case"genehmigt":return r.jsx(Lr,{className:"w-3 h-3 text-green-500"});case"abgelehnt":return r.jsx(Nl,{className:"w-3 h-3 text-red-500"});default:return r.jsx(hn,{className:"w-3 h-3 text-yellow-500"})}},O=[...new Set(p.map(te=>te.department).filter(Boolean))];d==="all"||p.filter(te=>te.department===d);const I=()=>{const te=t.getFullYear(),X=Array.from({length:12},(pe,G)=>G),Z=Array.from({length:31},(pe,G)=>G+1),ie=(pe,G)=>{const se=new Date(te,pe,G);if(se.getMonth()!==pe)return null;We(se,"yyyy-MM-dd");const me=[];return m.forEach(he=>{const xe=new Date(he.start_date),re=he.end_date?new Date(he.end_date):xe;se>=xe&&se<=re&&me.push({type:"project",item:he,color:he.color})}),j.forEach(he=>{const xe=new Date(he.start_date),re=new Date(he.end_date);se>=xe&&se<=re&&me.push({type:"absence",item:he,color:z(he.type).replace("bg-","")})}),_.forEach(he=>{const xe=new Date(he.start_date),re=new Date(he.end_date);se>=xe&&se<=re&&me.push({type:"event",item:he,color:he.color})}),me.length>0?me:null};return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"120px repeat(31, 1fr)"},children:[r.jsx("div",{className:"p-3 border-r border-border font-medium text-center",children:"Monat"}),Z.map(pe=>r.jsx("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:pe},pe))]}),X.map((pe,G)=>r.jsxs("div",{className:`grid ${G%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"120px repeat(31, 1fr)"},children:[r.jsx("div",{className:"p-3 border-r border-border font-medium text-center bg-muted/50",children:We(new Date(te,pe,1),"MMMM",{locale:cn})}),Z.map(se=>{const he=new Date(te,pe,se).getMonth()===pe,xe=he?ie(pe,se):null,re=(be,Be)=>{if(be.type==="project"){const Ke=new Date(be.item.start_date);return pr(Ke,Be)||Ke<Be&&se===1}if(be.type==="absence"){const Ke=new Date(be.item.start_date);return pr(Ke,Be)||Ke<Be&&se===1}if(be.type==="event"){const Ke=new Date(be.item.start_date);return pr(Ke,Be)||Ke<Be&&se===1}return!1},_e=(be,Be)=>{const Ke=new Date(te,pe,1),At=new Date(te,pe+1,0);let je,De;be.type==="project"?(je=new Date(be.item.start_date),De=be.item.end_date?new Date(be.item.end_date):new Date):be.type==="absence"?(je=new Date(be.item.start_date),De=new Date(be.item.end_date)):(je=new Date(be.item.start_date),De=new Date(be.item.end_date));const Ie=je<Ke?Ke:je,at=De>At?At:De,$e=Ie.getDate(),Me=at.getDate();return De>At?At.getDate()-$e+1:Me-$e+1};return r.jsx("div",{className:`border-r border-border last:border-r-0 h-16 relative ${he?"":"bg-muted/30"}`,children:he&&xe&&r.jsx("div",{className:"absolute inset-0 p-1",children:xe.map((be,Be)=>{var De,Ie,at,$e;const Ke=new Date(te,pe,se);if(!re(be,Ke))return null;const je=_e(be);return r.jsxs("div",{className:"h-3 rounded text-white text-xs flex items-center justify-center font-medium shadow-sm absolute hover:h-4 hover:z-20 transition-all duration-200 group cursor-pointer",style:{backgroundColor:be.type==="project"?be.color:be.type==="absence"?`rgb(${be.color==="green-500"?"34 197 94":be.color==="red-500"?"239 68 68":be.color==="blue-500"?"59 130 246":"107 114 128"})`:be.item.color,width:`${je*100}%`,left:0,top:`${2+Be*14}px`,zIndex:10},title:be.type==="project"?`Projekt: ${be.item.name}`:be.type==="absence"?`${be.item.type}: ${(De=be.item.employee)==null?void 0:De.first_name} ${(Ie=be.item.employee)==null?void 0:Ie.last_name}`:`Termin: ${be.item.title}`,children:[je>=3&&r.jsxs(r.Fragment,{children:[be.type==="project"&&r.jsx(vc,{className:"w-1.5 h-1.5"}),be.type==="absence"&&V(be.item.type),be.type==="event"&&r.jsx(zt,{className:"w-1.5 h-1.5"})]}),r.jsx("div",{className:"absolute top-[-32px] left-0 bg-background border border-border rounded px-2 py-1 text-xs text-foreground shadow-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-30",children:be.type==="project"?be.item.name:be.type==="absence"?`${be.item.type}: ${(at=be.item.employee)==null?void 0:at.first_name} ${($e=be.item.employee)==null?void 0:$e.last_name}`:be.item.title})]},`${be.type}-${be.item.id||Be}`)})})},se)})]},pe))]})})},H=()=>{const te=t.getMonth(),X=t.getFullYear(),Z=new Date(X,te+1,0).getDate(),ie=Array.from({length:Z},(se,me)=>me+1),pe=m.filter(se=>{const me=se.status.toLowerCase();if(me==="aktiv"||me==="geplant"||me==="in bearbeitung")return!0;const xe=new Date(se.start_date),re=se.end_date?new Date(se.end_date):new Date,_e=new Date(X,te,1),be=new Date(X,te+1,0);return xe<=be&&re>=_e}),G=(se,me)=>{const he=new Date(X,te,me);return w.filter(xe=>{const re=new Date(xe.start_date),_e=xe.end_date?new Date(xe.end_date):re;return xe.project_id===se&&he>=re&&he<=_e})};return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"200px repeat("+Z+", 1fr)"},children:[r.jsx("div",{className:"p-3 border-r border-border font-medium",children:"Projekt"}),ie.map(se=>r.jsxs("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:[r.jsx("div",{children:se}),r.jsx("div",{className:"text-muted-foreground",children:We(new Date(X,te,se),"EEE",{locale:cn})})]},se))]}),pe.length===0?r.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:["Keine aktiven Projekte in ",We(t,"MMMM yyyy",{locale:cn})]}):pe.map((se,me)=>r.jsxs("div",{className:`grid ${me%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"200px repeat("+Z+", 1fr)"},children:[r.jsxs("div",{className:"p-3 border-r border-border",children:[r.jsx("div",{className:"font-medium text-sm",children:se.name}),r.jsx("div",{className:"text-xs text-muted-foreground",children:se.location}),r.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[r.jsx(Ve,{variant:"outline",className:"text-xs",children:se.status}),r.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:se.color},title:`Projekt: ${se.name}`})]})]}),r.jsxs("div",{className:"relative h-20",style:{gridColumn:`2 / ${Z+2}`},children:[r.jsx("div",{className:"absolute inset-0 grid",style:{gridTemplateColumns:`repeat(${Z}, 1fr)`},children:ie.map(he=>r.jsx("div",{className:"border-r border-border last:border-r-0"},he))}),(()=>{const he=new Date(se.start_date),xe=se.end_date?new Date(se.end_date):he,re=new Date(X,te,1),_e=new Date(X,te+1,0),be=he<re?1:he.getDate(),Be=xe>_e?Z:xe.getDate();if(xe<re||he>_e)return null;const Ke=(Be-be+1)/Z*100,At=(be-1)/Z*100;return r.jsxs("div",{className:"absolute top-2 h-12 rounded-md flex items-center px-3 text-white text-sm font-medium shadow-md z-10",style:{left:`${At}%`,width:`${Ke}%`,backgroundColor:se.color,minWidth:"60px"},title:`${se.name} (${We(he,"dd.MM.yyyy")} - ${We(xe,"dd.MM.yyyy")})`,children:[r.jsx(vc,{className:"w-4 h-4 mr-2 flex-shrink-0"}),r.jsx("span",{className:"truncate",children:se.name}),r.jsx("div",{className:"ml-auto flex items-center space-x-1",children:r.jsxs("span",{className:"text-xs opacity-90",children:[We(he,"dd.MM")," - ",We(xe,"dd.MM")]})})]})})(),ie.map(he=>{const xe=G(se.id,he);if(xe.length===0)return null;const re=(he-1)/Z*100,_e=1/Z*100;return r.jsxs("div",{className:"absolute bottom-1 h-4 bg-blue-100 dark:bg-blue-900 border border-blue-300 dark:border-blue-700 rounded flex items-center justify-center",style:{left:`${re}%`,width:`${_e-1}%`,minWidth:"20px"},title:`${xe.length} Mitarbeiter: ${xe.map(be=>{var Be,Ke;return`${(Be=be.employee)==null?void 0:Be.first_name} ${(Ke=be.employee)==null?void 0:Ke.last_name} (${be.hours_per_day}h)`}).join(", ")}`,children:[r.jsx($s,{className:"w-2 h-2 text-blue-600 dark:text-blue-400"}),r.jsx("span",{className:"text-xs ml-1 text-blue-600 dark:text-blue-400",children:xe.length})]},`assignments-${he}`)})]})]},se.id))]})})},$=()=>{const te=t.getMonth(),X=t.getFullYear(),Z=new Date(X,te+1,0).getDate(),ie=Array.from({length:Z},(G,se)=>se+1),pe=p.filter(G=>G.status==="aktiv");return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"200px repeat("+Z+", 1fr)"},children:[r.jsx("div",{className:"p-3 border-r border-border font-medium",children:"Mitarbeiter"}),ie.map(G=>r.jsxs("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:[r.jsx("div",{children:G}),r.jsx("div",{className:"text-muted-foreground",children:We(new Date(X,te,G),"EEE",{locale:cn})})]},G))]}),pe.length===0?r.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:["Keine aktiven Mitarbeiter in ",We(t,"MMMM yyyy",{locale:cn})]}):pe.map((G,se)=>{const me=j.filter(he=>{const xe=new Date(he.start_date),re=new Date(he.end_date),_e=new Date(X,te,1),be=new Date(X,te+1,0);return he.employee_id===G.id&&xe<=be&&re>=_e});return r.jsxs("div",{className:`grid ${se%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"200px repeat("+Z+", 1fr)"},children:[r.jsxs("div",{className:"p-3 border-r border-border",children:[r.jsxs("div",{className:"font-medium text-sm",children:[G.first_name," ",G.last_name]}),r.jsx("div",{className:"text-xs text-muted-foreground",children:G.position}),r.jsx("div",{className:"text-xs text-muted-foreground",children:G.department})]}),r.jsxs("div",{className:"relative h-20",style:{gridColumn:`2 / ${Z+2}`},children:[r.jsx("div",{className:"absolute inset-0 grid",style:{gridTemplateColumns:`repeat(${Z}, 1fr)`},children:ie.map(he=>r.jsx("div",{className:"border-r border-border last:border-r-0"},he))}),me.map((he,xe)=>{const re=new Date(he.start_date),_e=new Date(he.end_date),be=new Date(X,te,1),Be=new Date(X,te+1,0),Ke=re<be?1:re.getDate(),je=((_e>Be?Z:_e.getDate())-Ke+1)/Z*100,De=(Ke-1)/Z*100,Ie=2+xe*16;return r.jsxs("div",{className:`absolute h-12 rounded-md flex items-center px-3 text-white text-xs font-medium shadow-md z-10 ${z(he.type)}`,style:{left:`${De}%`,width:`${je}%`,top:`${Ie}px`,minWidth:"60px"},title:`${he.type} (${We(re,"dd.MM.yyyy")} - ${We(_e,"dd.MM.yyyy")}) - ${he.status}${he.reason?` - ${he.reason}`:""}`,children:[V(he.type),r.jsx("span",{className:"ml-2 truncate",children:he.type}),r.jsxs("div",{className:"ml-auto flex items-center space-x-1",children:[U(he.status),r.jsxs("span",{className:"text-xs opacity-90",children:[We(re,"dd.MM")," - ",We(_e,"dd.MM")]})]})]},he.id)}),ie.map(he=>{const xe=w.filter(be=>{const Be=new Date(be.start_date),Ke=be.end_date?new Date(be.end_date):Be,At=new Date(X,te,he);return be.employee_id===G.id&&At>=Be&&At<=Ke});if(xe.length===0)return null;const re=(he-1)/Z*100,_e=1/Z*100;return r.jsxs("div",{className:"absolute bottom-1 h-4 bg-blue-100 dark:bg-blue-900 border border-blue-300 dark:border-blue-700 rounded flex items-center justify-center",style:{left:`${re}%`,width:`${_e-1}%`,minWidth:"20px"},title:`${xe.length} Projekt(e): ${xe.map(be=>{var Be;return`${(Be=be.project)==null?void 0:Be.name} (${be.hours_per_day}h)`}).join(", ")}`,children:[r.jsx(vc,{className:"w-2 h-2 text-blue-600 dark:text-blue-400"}),r.jsx("span",{className:"text-xs ml-1 text-blue-600 dark:text-blue-400",children:xe.length})]},`assignments-${he}`)})]})]},G.id)})]})})};return S?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),r.jsx("p",{children:"Lade Planerdaten..."})]})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-teal-600 bg-clip-text text-transparent flex items-center gap-3",children:[r.jsx(zt,{className:"h-8 w-8 text-teal-600"}),"Planer"]}),r.jsxs(Ve,{variant:"outline",className:"flex items-center space-x-1",children:[r.jsx(zt,{className:"w-4 h-4"}),r.jsx("span",{children:"Ressourcenplanung"})]})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[a==="overview"&&r.jsxs(r.Fragment,{children:[r.jsxs(vt,{value:d,onValueChange:u,children:[r.jsx(pt,{className:"w-48",children:r.jsx(yt,{placeholder:"Alle Abteilungen"})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"all",children:"Alle Abteilungen"}),O.map(te=>r.jsx(ye,{value:te,children:te},te))]})]}),r.jsxs(vt,{value:o,onValueChange:te=>c(te),children:[r.jsx(pt,{className:"w-40",children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"all",children:"Alle anzeigen"}),r.jsx(ye,{value:"projects",children:"Nur Projekte"}),r.jsx(ye,{value:"absences",children:"Nur Abwesenheiten"}),r.jsx(ye,{value:"events",children:"Nur Termine"})]})]})]}),r.jsxs(vt,{value:n,onValueChange:te=>s(te),children:[r.jsx(pt,{className:"w-32",children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"week",children:"Woche"}),r.jsx(ye,{value:"month",children:"Monat"})]})]}),r.jsx(J,{onClick:D,variant:"outline",size:"sm",children:"Aktualisieren"})]})]}),r.jsxs(zr,{value:a,onValueChange:te=>i(te),children:[r.jsxs(Er,{className:"grid w-full grid-cols-4",children:[r.jsxs(Ge,{value:"overview",className:"flex items-center space-x-2",children:[r.jsx(zt,{className:"w-4 h-4"}),r.jsx("span",{children:"Übersicht"})]}),r.jsxs(Ge,{value:"projects",className:"flex items-center space-x-2",children:[r.jsx(vc,{className:"w-4 h-4"}),r.jsx("span",{children:"Projekte"})]}),r.jsxs(Ge,{value:"employees",className:"flex items-center space-x-2",children:[r.jsx(Si,{className:"w-4 h-4"}),r.jsx("span",{children:"Mitarbeiter"})]}),r.jsxs(Ge,{value:"resources",className:"flex items-center space-x-2",children:[r.jsx(sa,{className:"w-4 h-4"}),r.jsx("span",{children:"Ressourcen"})]})]}),r.jsx(Qe,{value:"overview",className:"space-y-4",children:r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-4",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(Ee,{className:"flex items-center space-x-2",children:[r.jsx(hn,{className:"w-5 h-5"}),r.jsx("span",{children:n==="week"?`${We(ee,"dd.MM",{locale:cn})} - ${We(ue,"dd.MM.yyyy",{locale:cn})}`:We(t,"MMMM yyyy",{locale:cn})})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(J,{variant:"outline",size:"sm",onClick:de,children:r.jsx(Xu,{className:"w-4 h-4"})}),r.jsxs(Ha,{children:[r.jsx(Va,{asChild:!0,children:r.jsxs(J,{variant:"outline",size:"sm",className:Oe("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[r.jsx(zt,{className:"mr-2 h-4 w-4"}),We(t,"MMMM yyyy",{locale:cn})]})}),r.jsx(da,{className:"w-auto p-0",align:"start",children:r.jsx(ua,{mode:"single",selected:t,onSelect:te=>te&&e(te),initialFocus:!0,className:Oe("p-3 pointer-events-auto")})})]}),r.jsx(J,{variant:"outline",size:"sm",onClick:Q,children:r.jsx(jl,{className:"w-4 h-4"})})]})]})}),r.jsxs(ce,{children:[I(),r.jsxs("div",{className:"mt-6 space-y-3",children:[r.jsx("h4",{className:"font-medium",children:"Legende"}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),r.jsx("span",{children:"Urlaub"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),r.jsx("span",{children:"Krank"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),r.jsx("span",{children:"Projekte/Fortbildung"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded"}),r.jsx("span",{children:"Elternzeit"})]})]}),r.jsx(po,{}),r.jsxs("div",{className:"flex items-center space-x-6 text-xs",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Lr,{className:"w-4 h-4 text-green-500"}),r.jsx("span",{children:"Genehmigt"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(hn,{className:"w-4 h-4 text-yellow-500"}),r.jsx("span",{children:"Beantragt"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Nl,{className:"w-4 h-4 text-red-500"}),r.jsx("span",{children:"Abgelehnt"})]})]})]})]})]})}),r.jsx(Qe,{value:"projects",children:r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-4",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(Ee,{className:"flex items-center space-x-2",children:[r.jsx(vc,{className:"w-5 h-5"}),r.jsxs("span",{children:["Projektkalender - ",We(t,"yyyy",{locale:cn})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(J,{variant:"outline",size:"sm",onClick:de,children:r.jsx(Xu,{className:"w-4 h-4"})}),r.jsxs(Ha,{children:[r.jsx(Va,{asChild:!0,children:r.jsxs(J,{variant:"outline",size:"sm",className:Oe("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[r.jsx(zt,{className:"mr-2 h-4 w-4"}),We(t,"MMMM yyyy",{locale:cn})]})}),r.jsx(da,{className:"w-auto p-0",align:"start",children:r.jsx(ua,{mode:"single",selected:t,onSelect:te=>te&&e(te),initialFocus:!0,className:Oe("p-3 pointer-events-auto")})})]}),r.jsx(J,{variant:"outline",size:"sm",onClick:Q,children:r.jsx(jl,{className:"w-4 h-4"})})]})]})}),r.jsx(ce,{children:H()})]})}),r.jsx(Qe,{value:"employees",children:r.jsxs(le,{children:[r.jsx(Ce,{className:"pb-4",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(Ee,{className:"flex items-center space-x-2",children:[r.jsx(Si,{className:"w-5 h-5"}),r.jsxs("span",{children:["Mitarbeiterkalender - ",We(t,"yyyy",{locale:cn})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(J,{variant:"outline",size:"sm",onClick:de,children:r.jsx(Xu,{className:"w-4 h-4"})}),r.jsxs(Ha,{children:[r.jsx(Va,{asChild:!0,children:r.jsxs(J,{variant:"outline",size:"sm",className:Oe("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[r.jsx(zt,{className:"mr-2 h-4 w-4"}),We(t,"MMMM yyyy",{locale:cn})]})}),r.jsx(da,{className:"w-auto p-0",align:"start",children:r.jsx(ua,{mode:"single",selected:t,onSelect:te=>te&&e(te),initialFocus:!0,className:Oe("p-3 pointer-events-auto")})})]}),r.jsx(J,{variant:"outline",size:"sm",onClick:Q,children:r.jsx(jl,{className:"w-4 h-4"})})]})]})}),r.jsx(ce,{children:$()})]})}),r.jsx(Qe,{value:"resources",children:r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Ressourcenplanung"})}),r.jsx(ce,{children:r.jsx("p",{className:"text-muted-foreground",children:"Ressourcenplanung wird hier implementiert..."})})]})})]})]})};/*! Capacitor: https://capacitorjs.com/ - MIT License */var Cd;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Cd||(Cd={}));class xy extends Error{constructor(e,n,s){super(e),this.message=e,this.code=n,this.data=s}}const gte=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},xte=t=>{const e=t.CapacitorCustomPlatform||null,n=t.Capacitor||{},s=n.Plugins=n.Plugins||{},a=()=>e!==null?e.name:gte(t),i=()=>a()!=="web",o=f=>{const p=u.get(f);return!!(p!=null&&p.platforms.has(a())||c(f))},c=f=>{var p;return(p=n.PluginHeaders)===null||p===void 0?void 0:p.find(y=>y.name===f)},d=f=>t.console.error(f),u=new Map,m=(f,p={})=>{const y=u.get(f);if(y)return console.warn(`Capacitor plugin "${f}" already registered. Cannot register plugins twice.`),y.proxy;const j=a(),v=c(f);let _;const b=async()=>(!_&&j in p?_=typeof p[j]=="function"?_=await p[j]():_=p[j]:e!==null&&!_&&"web"in p&&(_=typeof p.web=="function"?_=await p.web():_=p.web),_),w=(M,B)=>{var R,P;if(v){const F=v==null?void 0:v.methods.find(W=>B===W.name);if(F)return F.rtype==="promise"?W=>n.nativePromise(f,B.toString(),W):(W,ee)=>n.nativeCallback(f,B.toString(),W,ee);if(M)return(R=M[B])===null||R===void 0?void 0:R.bind(M)}else{if(M)return(P=M[B])===null||P===void 0?void 0:P.bind(M);throw new xy(`"${f}" plugin is not implemented on ${j}`,Cd.Unimplemented)}},N=M=>{let B;const R=(...P)=>{const F=b().then(W=>{const ee=w(W,M);if(ee){const ue=ee(...P);return B=ue==null?void 0:ue.remove,ue}else throw new xy(`"${f}.${M}()" is not implemented on ${j}`,Cd.Unimplemented)});return M==="addListener"&&(F.remove=async()=>B()),F};return R.toString=()=>`${M.toString()}() { [capacitor code] }`,Object.defineProperty(R,"name",{value:M,writable:!1,configurable:!1}),R},S=N("addListener"),A=N("removeListener"),E=(M,B)=>{const R=S({eventName:M},B),P=async()=>{const W=await R;A({eventName:M,callbackId:W},B)},F=new Promise(W=>R.then(()=>W({remove:P})));return F.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await P()},F},D=new Proxy({},{get(M,B){switch(B){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return v?E:S;case"removeListener":return A;default:return N(B)}}});return s[f]=D,u.set(f,{name:f,proxy:D,platforms:new Set([...Object.keys(p),...v?[j]:[]])}),D};return n.convertFileSrc||(n.convertFileSrc=f=>f),n.getPlatform=a,n.handleError=d,n.isNativePlatform=i,n.isPluginAvailable=o,n.registerPlugin=m,n.Exception=xy,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},vte=t=>t.Capacitor=xte(t),Dw=vte(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Fg=Dw.registerPlugin;class mI{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let s=!1;this.listeners[e]||(this.listeners[e]=[],s=!0),this.listeners[e].push(n);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),s&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,n);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,s){const a=this.listeners[e];if(!a){if(s){let i=this.retainedEventArguments[e];i||(i=[]),i.push(n),this.retainedEventArguments[e]=i}return}a.forEach(i=>i(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:s=>{this.notifyListeners(n,s)}}}unimplemented(e="not implemented"){return new Dw.Exception(e,Cd.Unimplemented)}unavailable(e="not available"){return new Dw.Exception(e,Cd.Unavailable)}async removeListener(e,n){const s=this.listeners[e];if(!s)return;const a=s.indexOf(n);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(s=>{this.notifyListeners(e,s)}))}}const FC=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),BC=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class yte extends mI{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(s=>{if(s.length<=0)return;let[a,i]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=BC(a).trim(),i=BC(i).trim(),n[a]=i}),n}async setCookie(e){try{const n=FC(e.key),s=FC(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${s||""}${a}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}Fg("CapacitorCookies",{web:()=>new yte});const _te=async t=>new Promise((e,n)=>{const s=new FileReader;s.onload=()=>{const a=s.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},s.onerror=a=>n(a),s.readAsDataURL(t)}),wte=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(a=>a.toLocaleLowerCase()).reduce((a,i,o)=>(a[i]=t[e[o]],a),{})},bte=(t,e=!0)=>t?Object.entries(t).reduce((s,a)=>{const[i,o]=a;let c,d;return Array.isArray(o)?(d="",o.forEach(u=>{c=e?encodeURIComponent(u):u,d+=`${i}=${c}&`}),d.slice(0,-1)):(c=e?encodeURIComponent(o):o,d=`${i}=${c}`),`${s}&${d}`},"").substr(1):null,jte=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),a=wte(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(a.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,c]of Object.entries(t.data||{}))i.set(o,c);n.body=i.toString()}else if(a.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((c,d)=>{i.append(d,c)});else for(const c of Object.keys(t.data))i.append(c,t.data[c]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(a.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class Nte extends mI{async request(e){const n=jte(e,e.webFetchExtra),s=bte(e.params,e.shouldEncodeUrlParams),a=s?`${e.url}?${s}`:e.url,i=await fetch(a,n),o=i.headers.get("content-type")||"";let{responseType:c="text"}=i.ok?e:{};o.includes("application/json")&&(c="json");let d,u;switch(c){case"arraybuffer":case"blob":u=await i.blob(),d=await _te(u);break;case"json":d=await i.json();break;case"document":case"text":default:d=await i.text()}const m={};return i.headers.forEach((f,p)=>{m[p]=f}),{data:d,headers:m,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}Fg("CapacitorHttp",{web:()=>new Nte});function Ste(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,n){return new Proxy({},{get(s,a){return(i,o,c)=>{const d=t.Capacitor.Plugins[n];if(d===void 0){c(new Error(`Capacitor plugin ${n} not found`));return}if(typeof d[a]!="function"){c(new Error(`Method ${a} not found in Capacitor plugin ${n}`));return}(async()=>{try{const u=await d[a](i);o(u)}catch(u){c(u)}})()}}})}})}function kte(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,n){return t.cordova.plugins[n]}})}function Cte(t=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!t?Ste(window):window.cordova!==void 0&&kte(window))}const Ete=Fg("Geolocation",{web:()=>$d(()=>import("./web-BY-_bmmh.js"),[]).then(t=>new t.GeolocationWeb)});Cte();class Ate{constructor(){As(this,"dbName","TimeTrackingOfflineDB");As(this,"dbVersion",1);As(this,"storeName","timeEntries")}async initDB(){return new Promise((e,n)=>{const s=indexedDB.open(this.dbName,this.dbVersion);s.onerror=()=>n(s.error),s.onsuccess=()=>e(s.result),s.onupgradeneeded=a=>{const i=a.target.result;if(!i.objectStoreNames.contains(this.storeName)){const o=i.createObjectStore(this.storeName,{keyPath:"id"});o.createIndex("status","status",{unique:!1}),o.createIndex("offline_created_at","offline_created_at",{unique:!1})}}})}async saveOfflineEntry(e){const a=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((i,o)=>{const c=a.put(e);c.onerror=()=>o(c.error),c.onsuccess=()=>i()})}async getOfflineEntries(){const s=(await this.initDB()).transaction([this.storeName],"readonly").objectStore(this.storeName);return new Promise((a,i)=>{const o=s.getAll();o.onerror=()=>i(o.error),o.onsuccess=()=>a(o.result)})}async removeOfflineEntry(e){const a=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((i,o)=>{const c=a.delete(e);c.onerror=()=>o(c.error),c.onsuccess=()=>i()})}async clearOfflineEntries(){const s=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((a,i)=>{const o=s.clear();o.onerror=()=>i(o.error),o.onsuccess=()=>a()})}}class Pte{async getCurrentPosition(){try{const e=await Ete.getCurrentPosition({enableHighAccuracy:!0,timeout:1e4}),n={lat:e.coords.latitude,lng:e.coords.longitude},s=await this.reverseGeocode(n.lat,n.lng);return{...n,address:s}}catch(e){throw console.error("Fehler beim Abrufen der GPS-Position:",e),new Error("GPS-Position konnte nicht ermittelt werden")}}async reverseGeocode(e,n){try{const s=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${n}&zoom=18&addressdetails=1`);if(!s.ok)throw new Error("Geocoding fehlgeschlagen");const a=await s.json(),i=[];return a.address.house_number&&i.push(a.address.house_number),a.address.road&&i.push(a.address.road),(a.address.city||a.address.town||a.address.village)&&i.push(a.address.city||a.address.town||a.address.village),i.length>0?i.join(", "):"Unbekannte Adresse"}catch(s){return console.warn("Reverse Geocoding fehlgeschlagen:",s),`${e.toFixed(6)}, ${n.toFixed(6)}`}}calculateDistance(e,n){const a=this.toRad(n.lat-e.lat),i=this.toRad(n.lng-e.lng),o=this.toRad(e.lat),c=this.toRad(n.lat),d=Math.sin(a/2)*Math.sin(a/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(o)*Math.cos(c);return 6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))*1e3}toRad(e){return e*(Math.PI/180)}isWithinRadius(e,n,s){return this.calculateDistance(e,n)<=s}}class vy{static isOnline(){return navigator.onLine}static onStatusChange(e){const n=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",n),window.addEventListener("offline",s),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}static async registerServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/sw.js");return console.log("Service Worker registriert:",e),e}catch(e){return console.error("Service Worker Registrierung fehlgeschlagen:",e),null}return null}static async triggerBackgroundSync(e){if("serviceWorker"in navigator&&navigator.serviceWorker.controller)try{const n=await navigator.serviceWorker.ready;n&&"sync"in n&&await n.sync.register(e)}catch(n){console.error("Background Sync fehlgeschlagen:",n)}}}const Dte=({open:t,onOpenChange:e,timeEntry:n,projects:s,onSave:a})=>{var B,R;const[i,o]=g.useState(""),[c,d]=g.useState(""),[u,m]=g.useState(""),[f,p]=g.useState(""),[y,j]=g.useState(0),[v,_]=g.useState(""),[b,w]=g.useState(""),[N,S]=g.useState(""),[A,E]=g.useState(!1),{toast:D}=Rt();g.useEffect(()=>{if(n){const P=Bc(n.start_time);if(o(We(P,"yyyy-MM-dd")),d(We(P,"HH:mm")),n.end_time){const F=Bc(n.end_time);m(We(F,"yyyy-MM-dd")),p(We(F,"HH:mm"))}else m(""),p("");j(n.break_duration||0),_(n.project_id||""),w(n.description||""),S(n.status)}},[n]);const M=async()=>{if(n){E(!0);try{const P=new Date(`${i}T${c}`).toISOString();let F=null;u&&f&&(F=new Date(`${u}T${f}`).toISOString());const W={start_time:P,end_time:F,break_duration:y,project_id:v||null,description:b||null,status:N},{error:ee}=await K.from("time_entries").update(W).eq("id",n.id);if(ee)throw ee;D({title:"Zeiteintrag aktualisiert",description:"Die Änderungen wurden erfolgreich gespeichert."}),a(),e(!1)}catch(P){console.error("Error updating time entry:",P),D({title:"Fehler beim Speichern",description:"Die Änderungen konnten nicht gespeichert werden.",variant:"destructive"})}finally{E(!1)}}};return n?r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-2xl",children:[r.jsx(rn,{children:r.jsxs(sn,{children:["Zeiteintrag bearbeiten - ",(B=n.employee)==null?void 0:B.first_name," ",(R=n.employee)==null?void 0:R.last_name]})}),r.jsxs("div",{className:"grid gap-4 py-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"start-date",children:"Startdatum"}),r.jsx(ne,{id:"start-date",type:"date",value:i,onChange:P=>o(P.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"start-time",children:"Startzeit"}),r.jsx(ne,{id:"start-time",type:"time",value:c,onChange:P=>d(P.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"end-date",children:"Enddatum"}),r.jsx(ne,{id:"end-date",type:"date",value:u,onChange:P=>m(P.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"end-time",children:"Endzeit"}),r.jsx(ne,{id:"end-time",type:"time",value:f,onChange:P=>p(P.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"break-duration",children:"Pausenzeit (Minuten)"}),r.jsx(ne,{id:"break-duration",type:"number",min:"0",value:y,onChange:P=>j(parseInt(P.target.value)||0)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"status",children:"Status"}),r.jsxs(vt,{value:N,onValueChange:S,children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"aktiv",children:"Aktiv"}),r.jsx(ye,{value:"pausiert",children:"Pausiert"}),r.jsx(ye,{value:"beendet",children:"Beendet"})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"project",children:"Projekt"}),r.jsxs(vt,{value:v,onValueChange:_,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Projekt auswählen"})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"",children:"Kein Projekt"}),s.map(P=>r.jsx(ye,{value:P.id,children:P.name},P.id))]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"description",children:"Beschreibung"}),r.jsx(En,{id:"description",placeholder:"Beschreibung der Tätigkeit...",value:b,onChange:P=>w(P.target.value)})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(J,{variant:"outline",onClick:()=>e(!1),children:"Abbrechen"}),r.jsx(J,{onClick:M,disabled:A,children:A?"Speichere...":"Speichern"})]})]})}):null},Tte=()=>{var At;const{toast:t}=Rt(),{userRole:e}=mg(),{data:n,isLoading:s}=MZ(),{data:a,isLoading:i}=VM(),{data:o,isLoading:c}=Gj(),d=RZ(),u=IZ(),m=(n==null?void 0:n.items)||[],f=(a==null?void 0:a.items)||[],p=(o==null?void 0:o.items)||[],[y,j]=g.useState([]),[v,_]=g.useState([]);g.useState([]);const[b,w]=g.useState(null),[N,S]=g.useState(vy.isOnline()),[A,E]=g.useState(new Date);g.useState("");const[D,M]=g.useState("all"),[B,R]=g.useState("all"),[P,F]=g.useState(!1),[W,ee]=g.useState(!1);g.useState(!1),g.useState(null);const[ue,de]=g.useState(""),[Q,z]=g.useState(!1),[V,U]=g.useState(null),O=m.find(je=>je.status==="aktiv")||null,I=s||i||c,H=new Ate,$=new Pte;g.useEffect(()=>(vy.registerServiceWorker(),vy.onStatusChange(De=>{S(De),De?(X(),t({title:"Wieder online",description:"Synchronisiere Offline-Daten..."})):t({title:"Offline-Modus",description:"Zeiteinträge werden lokal gespeichert.",variant:"destructive"})})),[]),g.useEffect(()=>{te(),Z(),ie()},[A,D,B]);const te=async()=>{const{data:{user:je}}=await K.auth.getUser();if(!je)return;const{data:De,error:Ie}=await K.from("profiles").select("*").eq("id",je.id).single();if(Ie)throw t({title:"Profil konnte nicht geladen werden",description:Ie.message,variant:"destructive"}),Ie;w(De)},X=async()=>{var je,De,Ie,at,$e,Me;try{const Nt=await H.getOfflineEntries();for(const ft of Nt)try{d.mutate({employee_id:ft.employee_id,project_id:ft.project_id,start_time:ft.start_time,end_time:ft.end_time,description:ft.description,status:ft.status,start_location_lat:(je=ft.start_location)==null?void 0:je.lat,start_location_lng:(De=ft.start_location)==null?void 0:De.lng,start_location_address:(Ie=ft.start_location)==null?void 0:Ie.address,end_location_lat:(at=ft.end_location)==null?void 0:at.lat,end_location_lng:($e=ft.end_location)==null?void 0:$e.lng,end_location_address:(Me=ft.end_location)==null?void 0:Me.address,is_offline_synced:!0,offline_created_at:ft.offline_created_at},{onSuccess:()=>{H.removeOfflineEntry(ft.id)}})}catch(Ln){console.error("Error syncing offline entry:",Ln)}Nt.length>0&&t({title:"Synchronisation abgeschlossen",description:`${Nt.length} Offline-Einträge wurden synchronisiert.`})}catch(Nt){console.error("Error syncing offline entries:",Nt)}},Z=async()=>{const{data:je,error:De}=await K.from("working_hours_config").select("*").order("is_default",{ascending:!1});if(De)throw De;_(je||[])},ie=async()=>{const je=We(A,"yyyy-MM"),{data:De,error:Ie}=await K.from("employee_absences").select("*").gte("start_date",`${je}-01`).lte("end_date",`${je}-31`).eq("status","genehmigt");if(Ie)throw Ie;j(De||[])},pe=async(je,De)=>{if(!b){t({title:"Fehler",description:"Kein Mitarbeiter gefunden.",variant:"destructive"});return}if(O){t({title:"Zeiterfassung bereits aktiv",description:"Beenden Sie zuerst die aktuelle Zeiterfassung.",variant:"destructive"});return}let Ie;try{Ie=await $.getCurrentPosition()}catch($e){console.warn("GPS location not available:",$e)}const at={employee_id:b.id,project_id:je||null,start_time:new Date().toISOString(),description:De||null,status:"aktiv",start_location_lat:Ie==null?void 0:Ie.lat,start_location_lng:Ie==null?void 0:Ie.lng,start_location_address:Ie==null?void 0:Ie.address};if(!N){const $e={id:crypto.randomUUID(),employee_id:b.id,project_id:je||void 0,start_time:new Date().toISOString(),description:De||void 0,status:"aktiv",start_location:Ie,offline_created_at:new Date().toISOString()};await H.saveOfflineEntry($e),t({title:"Offline gespeichert",description:"Zeiterfassung wird bei der nächsten Verbindung synchronisiert."});return}d.mutate(at,{onSuccess:$e=>{F(!1),t({title:"Zeiterfassung gestartet",description:Ie?`Gestartet an: ${Ie.address}`:"Die Zeiterfassung wurde erfolgreich gestartet."})},onError:()=>{t({title:"Fehler beim Starten",description:"Die Zeiterfassung konnte nicht gestartet werden.",variant:"destructive"})}})},G=async()=>{if(!O)return;let je;try{je=await $.getCurrentPosition()}catch(Ie){console.warn("GPS location not available:",Ie)}const De={end_time:new Date().toISOString(),status:"beendet",end_location_lat:je==null?void 0:je.lat,end_location_lng:je==null?void 0:je.lng,end_location_address:je==null?void 0:je.address};u.mutate({id:O.id,data:De},{onSuccess:()=>{t({title:"Zeiterfassung beendet",description:je?`Beendet an: ${je.address}`:"Die Zeiterfassung wurde erfolgreich beendet."})},onError:()=>{t({title:"Fehler beim Stoppen",description:"Die Zeiterfassung konnte nicht gestoppt werden.",variant:"destructive"})}})},se=async()=>{if(!O)return;const je=O.status==="aktiv"?"pausiert":"aktiv";u.mutate({id:O.id,data:{status:je}},{onError:()=>{t({title:"Fehler",description:"Der Status konnte nicht geändert werden.",variant:"destructive"})}})},me=async(je,De,Ie)=>{if(!e||e!=="manager"){t({title:"Keine Berechtigung",description:"Nur Manager können Zeiterfassung für andere starten.",variant:"destructive"});return}const{data:at}=await K.from("time_entries").select("*").eq("employee_id",je).eq("status","aktiv").single();if(at){t({title:"Zeiterfassung bereits aktiv",description:"Dieser Mitarbeiter hat bereits eine aktive Zeiterfassung.",variant:"destructive"});return}d.mutate({employee_id:je,project_id:De||null,start_time:new Date().toISOString(),description:Ie||null,status:"aktiv"},{onSuccess:$e=>{var Me,Nt;t({title:"Zeiterfassung gestartet",description:`Zeiterfassung für ${(Me=$e.employee)==null?void 0:Me.first_name} ${(Nt=$e.employee)==null?void 0:Nt.last_name} wurde gestartet.`})},onError:()=>{t({title:"Fehler beim Starten",description:"Die Zeiterfassung konnte nicht gestartet werden.",variant:"destructive"})}})},he=async(je,De)=>{if(!e||e!=="manager"){t({title:"Keine Berechtigung",description:"Nur Manager können Arbeitszeiten ändern.",variant:"destructive"});return}const{data:Ie}=await K.from("working_hours_config").select("*").eq("employee_id",je).single();if(Ie){const{error:at}=await K.from("working_hours_config").update(De).eq("id",Ie.id);if(at){t({title:"Fehler beim Aktualisieren",description:"Die Arbeitszeiten konnten nicht aktualisiert werden.",variant:"destructive"});return}}else{const{error:at}=await K.from("working_hours_config").insert({employee_id:je,...De});if(at){t({title:"Fehler beim Erstellen",description:"Die Arbeitszeiten konnten nicht erstellt werden.",variant:"destructive"});return}}Z(),ee(!1),t({title:"Arbeitszeiten aktualisiert",description:"Die Arbeitszeiten wurden erfolgreich gespeichert."})},xe=je=>v.find(De=>De.employee_id===je)||v.find(De=>De.is_default),re=()=>{const[je,De]=g.useState("08:00"),[Ie,at]=g.useState("17:00"),[$e,Me]=g.useState(30),[Nt,ft]=g.useState([1,2,3,4,5]);g.useEffect(()=>{if(ue){const xt=xe(ue);xt&&(De(xt.start_time.slice(0,5)),at(xt.end_time.slice(0,5)),Me(xt.break_duration),ft(xt.working_days))}},[ue]);const Ln=()=>{he(ue==="default"?null:ue,{start_time:je+":00",end_time:Ie+":00",break_duration:$e,working_days:Nt,is_default:ue==="default"})},yr=xt=>{ft(mn=>mn.includes(xt)?mn.filter(Mn=>Mn!==xt):[...mn,xt].sort())};return r.jsx(en,{open:W,onOpenChange:ee,children:r.jsxs(Gt,{className:"max-w-md",children:[r.jsx(rn,{children:r.jsx(sn,{children:"Arbeitszeiten konfigurieren"})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{children:"Mitarbeiter"}),r.jsxs(vt,{value:ue,onValueChange:de,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Mitarbeiter wählen..."})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"default",children:"Standard (alle Mitarbeiter)"}),p.map(xt=>r.jsxs(ye,{value:xt.id,children:[xt.first_name," ",xt.last_name]},xt.id))]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(Y,{children:"Arbeitsbeginn"}),r.jsx(ne,{type:"time",value:je,onChange:xt=>De(xt.target.value)})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Arbeitsende"}),r.jsx(ne,{type:"time",value:Ie,onChange:xt=>at(xt.target.value)})]})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Pausendauer (Minuten)"}),r.jsx(ne,{type:"number",value:$e,onChange:xt=>Me(Number(xt.target.value)),min:"0",max:"120"})]}),r.jsxs("div",{children:[r.jsx(Y,{children:"Arbeitstage"}),r.jsx("div",{className:"flex gap-2 mt-2",children:[{value:1,label:"Mo"},{value:2,label:"Di"},{value:3,label:"Mi"},{value:4,label:"Do"},{value:5,label:"Fr"},{value:6,label:"Sa"},{value:7,label:"So"}].map(xt=>r.jsx(J,{variant:Nt.includes(xt.value)?"default":"outline",size:"sm",onClick:()=>yr(xt.value),children:xt.label},xt.value))})]}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx(J,{variant:"outline",onClick:()=>ee(!1),children:"Abbrechen"}),r.jsx(J,{onClick:Ln,disabled:!ue,children:"Speichern"})]})]})]})})},_e=()=>{const[je,De]=g.useState(""),[Ie,at]=g.useState(""),[$e,Me]=g.useState(""),Nt=()=>{je&&(me(je,Ie==="none"?void 0:Ie||void 0,$e||void 0),De(""),at(""),Me(""),F(!1))};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"employee",children:"Mitarbeiter"}),r.jsxs(vt,{value:je,onValueChange:De,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Mitarbeiter auswählen..."})}),r.jsx(gt,{children:p.map(ft=>r.jsxs(ye,{value:ft.id,children:[ft.first_name," ",ft.last_name]},ft.id))})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"project",children:"Projekt (optional)"}),r.jsxs(vt,{value:Ie,onValueChange:at,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Projekt auswählen..."})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"none",children:"Kein Projekt"}),f.map(ft=>r.jsx(ye,{value:ft.id,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:ft.color}}),ft.name]})},ft.id))]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"description",children:"Beschreibung (optional)"}),r.jsx(En,{id:"description",value:$e,onChange:ft=>Me(ft.target.value),placeholder:"Beschreibung der Tätigkeit..."})]}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx(J,{variant:"outline",onClick:()=>F(!1),children:"Abbrechen"}),r.jsxs(J,{onClick:Nt,disabled:!je,children:[r.jsx(Oc,{className:"w-4 h-4 mr-2"}),"Starten"]})]})]})},be=(je,De)=>{const Ie=Bc(je),$e=_C(new Date,Ie),Me=Math.floor($e/60),Nt=$e%60;return`${Me}:${Nt.toString().padStart(2,"0")}h`},Be=()=>m.reduce((je,De)=>{if(De.status==="beendet"&&De.end_time){const Ie=Bc(De.start_time),at=Bc(De.end_time);return je+_C(at,Ie)}return je},0),Ke=()=>{const[je,De]=g.useState(""),[Ie,at]=g.useState(""),$e=()=>{pe(Ie==="none"?void 0:Ie||void 0,je||void 0),De(""),at("")};return r.jsx(en,{open:P,onOpenChange:F,children:r.jsxs(Gt,{children:[r.jsx(rn,{children:r.jsx(sn,{children:e==="manager"?"Zeiterfassung starten":"Neue Zeiterfassung starten"})}),e==="manager"?r.jsx(_e,{}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"project",children:"Projekt (optional)"}),r.jsxs(vt,{value:Ie,onValueChange:at,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Projekt auswählen..."})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"none",children:"Kein Projekt"}),f.map(Me=>r.jsx(ye,{value:Me.id,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Me.color}}),Me.name]})},Me.id))]})]})]}),r.jsxs("div",{children:[r.jsx(Y,{htmlFor:"description",children:"Beschreibung (optional)"}),r.jsx(En,{id:"description",value:je,onChange:Me=>De(Me.target.value),placeholder:"Was arbeiten Sie?"})]}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx(J,{variant:"outline",onClick:()=>F(!1),children:"Abbrechen"}),r.jsxs(J,{onClick:$e,children:[r.jsx(Oc,{className:"w-4 h-4 mr-2"}),"Starten"]})]})]})]})})};return I?r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(lt,{className:"h-8 w-48"}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx(lt,{className:"h-10 w-32"}),r.jsx(lt,{className:"h-10 w-40"})]})]}),r.jsxs(le,{className:"shadow-soft rounded-2xl",children:[r.jsx(Ce,{className:"pb-2",children:r.jsx(lt,{className:"h-6 w-48"})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(lt,{className:"h-6 w-32 mb-2"}),r.jsx(lt,{className:"h-4 w-24"})]}),r.jsxs("div",{className:"text-right",children:[r.jsx(lt,{className:"h-8 w-16 mb-2"}),r.jsx(lt,{className:"h-6 w-20"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(lt,{className:"h-10 flex-1"}),r.jsx(lt,{className:"h-10 flex-1"})]})]})})]}),r.jsxs(le,{className:"shadow-soft rounded-2xl",children:[r.jsx(Ce,{className:"pb-2",children:r.jsx(lt,{className:"h-6 w-32"})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsx(lt,{className:"h-10 w-full"}),r.jsx("div",{className:"space-y-3",children:Array(3).fill(0).map((je,De)=>r.jsx("div",{className:"border rounded-xl p-4",children:r.jsx(lt,{className:"h-16 w-full"})},De))})]})})]})]}):r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Zeiterfassung"}),r.jsxs("div",{className:"flex items-center gap-4",children:[e==="manager"&&r.jsxs(J,{variant:"outline",onClick:()=>ee(!0),className:"rounded-full",children:[r.jsx(Eo,{className:"h-4 w-4 mr-2"}),"Arbeitszeiten"]}),r.jsxs(J,{onClick:()=>F(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),e==="manager"?"Zeiterfassung starten":"Meine Zeiterfassung"]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Heute erfasst"}),r.jsx("p",{className:"text-2xl font-bold",children:formatMinutesToTime(Be())})]}),r.jsx(hn,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Aktive Mitarbeiter"}),r.jsx("p",{className:"text-2xl font-bold",children:m.filter(je=>je.status==="aktiv").length})]}),r.jsx(Si,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Pausierte"}),r.jsx("p",{className:"text-2xl font-bold",children:m.filter(je=>je.status==="pausiert").length})]}),r.jsx(Kp,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),r.jsx("p",{className:"text-2xl font-bold",children:N?"Online":"Offline"})]}),N?r.jsx(ZA,{className:"h-8 w-8 text-purple-500 opacity-50"}):r.jsx(b_,{className:"h-8 w-8 text-red-500 opacity-50"})]})})})]}),r.jsxs(le,{className:"shadow-soft rounded-2xl",children:[r.jsx(Ce,{className:"pb-2",children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(hn,{className:"w-5 h-5"}),"Aktuelle Zeiterfassung"]})}),r.jsx(ce,{children:O?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-lg font-medium",children:((At=O.project)==null?void 0:At.name)||"Allgemeine Arbeitszeit"}),r.jsxs("p",{className:"text-muted-foreground",children:["Gestartet: ",We(Bc(O.start_time),"HH:mm",{locale:cn})]}),O.description&&r.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:O.description})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-2xl font-bold",children:be(O.start_time)}),r.jsx(Ve,{variant:O.status==="aktiv"?"default":"secondary",children:O.status==="aktiv"?"Aktiv":"Pausiert"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(J,{variant:"outline",onClick:se,className:"flex-1 rounded-xl",children:O.status==="aktiv"?r.jsxs(r.Fragment,{children:[r.jsx(Kp,{className:"w-4 h-4 mr-2"}),"Pausieren"]}):r.jsxs(r.Fragment,{children:[r.jsx(Oc,{className:"w-4 h-4 mr-2"}),"Fortsetzen"]})}),r.jsxs(J,{variant:"destructive",onClick:G,className:"flex-1 rounded-xl",children:[r.jsx(__,{className:"w-4 h-4 mr-2"}),"Beenden"]})]})]}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx(hn,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"Keine aktive Zeiterfassung"}),r.jsxs(J,{onClick:()=>F(!0),children:[r.jsx(Oc,{className:"w-4 h-4 mr-2"}),"Zeiterfassung starten"]})]})})]}),r.jsxs(le,{className:"shadow-soft rounded-2xl",children:[r.jsx(Ce,{className:"pb-2",children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(hn,{className:"w-5 h-5"}),"Zeiterfassung"]})}),r.jsx(ce,{children:(()=>{const je=We(A,"yyyy-MM"),De=m.filter(Me=>{const Nt=We(new Date(Me.start_time),"yyyy-MM")===je,ft=B==="all"||!B||Me.employee_id===B;return Nt&&ft}),Ie=De.reduce((Me,Nt)=>{if(Nt.end_time){const ft=(new Date(Nt.end_time).getTime()-new Date(Nt.start_time).getTime())/36e5;return Me+ft}return Me},0),at=De.reduce((Me,Nt)=>{const ft=We(new Date(Nt.start_time),"yyyy-MM-dd");return Me[ft]||(Me[ft]=[]),Me[ft].push(Nt),Me},{}),$e=p.find(Me=>Me.id===B);return r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex gap-4 items-end",children:r.jsxs("div",{className:"flex-1",children:[r.jsx(Y,{children:"Mitarbeiter auswählen"}),r.jsxs(vt,{value:B||"all",onValueChange:R,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Mitarbeiter wählen..."})}),r.jsxs(gt,{className:"bg-background border shadow-lg z-50",children:[r.jsx(ye,{value:"all",children:"Alle Mitarbeiter"}),p.length>0?p.map(Me=>r.jsxs(ye,{value:Me.id,children:[Me.first_name," ",Me.last_name]},Me.id)):r.jsx(ye,{value:"loading",disabled:!0,children:"Lade Mitarbeiter..."})]})]})]})}),r.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 p-4 rounded-lg border",children:[r.jsxs("h3",{className:"font-semibold text-lg mb-2",children:["Monatsübersicht ",We(A,"MMMM yyyy",{locale:cn}),$e&&r.jsxs("span",{className:"text-base font-normal ml-2",children:["- ",$e.first_name," ",$e.last_name]})]}),r.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Ie.toFixed(1)," Stunden"]})]}),B&&B!=="all"?r.jsxs("div",{className:"space-y-3",children:[(()=>{const Me=new Date(A),Nt=Me.getFullYear(),ft=Me.getMonth(),Ln=new Date(Nt,ft+1,0).getDate(),yr=[];for(let xt=1;xt<=Ln;xt++){const mn=new Date(Nt,ft,xt),Mn=We(mn,"yyyy-MM-dd"),cr=mn.getDay(),Wn=cr===0||cr===6,Nn=at[Mn],Hr=y.some(it=>{const Kt=new Date(it.start_date),Bt=new Date(it.end_date),dt=new Date(Mn);return it.employee_id===B&&it.type==="urlaub"&&dt>=Kt&&dt<=Bt});yr.push({date:Mn,dateObject:mn,isWeekend:Wn,hasEntries:Nn,isOnVacation:Hr,entries:Nn||[]})}return yr.sort((xt,mn)=>new Date(mn.date).getTime()-new Date(xt.date).getTime()).map(({date:xt,dateObject:mn,isWeekend:Mn,hasEntries:cr,isOnVacation:Wn,entries:Nn})=>{if(Wn&&!cr)return r.jsx("div",{className:"border rounded-lg overflow-hidden bg-yellow-50/50 border-yellow-200",children:r.jsx("div",{className:"bg-yellow-100/50 p-4 border-b",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h4",{className:"font-semibold text-yellow-800",children:We(mn,"EEEE, dd.MM.yyyy",{locale:cn})}),r.jsx("div",{className:"text-right",children:r.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-200 text-yellow-800",children:"Urlaub"})})]})})},xt);if(Mn&&!cr)return r.jsx("div",{className:"border rounded-lg overflow-hidden bg-gray-50/50",children:r.jsx("div",{className:"bg-gray-100/50 p-4 border-b",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h4",{className:"font-semibold text-gray-600",children:We(mn,"EEEE, dd.MM.yyyy",{locale:cn})}),r.jsx("div",{className:"text-right",children:r.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:"Freier Tag"})})]})})},xt);if(!cr)return null;const it=Nn.reduce((dt,Yt)=>{if(Yt.end_time){const we=new Date(Yt.end_time).getTime()-new Date(Yt.start_time).getTime();return dt+we/(1e3*60)}return dt},0)/60,Kt=Nn.sort((dt,Yt)=>new Date(dt.start_time).getTime()-new Date(Yt.start_time).getTime())[0],Bt=Nn.sort((dt,Yt)=>new Date(Yt.end_time||Yt.start_time).getTime()-new Date(dt.end_time||dt.start_time).getTime())[0];return r.jsxs("div",{className:Oe("border rounded-lg overflow-hidden",Wn?"bg-yellow-50/50 border-yellow-200":Mn?"bg-amber-50/50 border-amber-200":""),children:[r.jsx("div",{className:Oe("p-4 border-b",Wn?"bg-yellow-100/50":Mn?"bg-amber-100/50":"bg-muted/50"),children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h4",{className:Oe("font-semibold",Wn?"text-yellow-800":""),children:We(mn,"EEEE, dd.MM.yyyy",{locale:cn})}),r.jsxs("div",{className:"flex gap-2 mt-1",children:[Wn&&r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-200 text-yellow-800 inline-block",children:"Urlaub (gearbeitet)"}),Mn&&r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-amber-200 text-amber-800 inline-block",children:"Wochenendarbeit"})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-lg font-bold",children:[it.toFixed(1),"h"]}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[We(new Date(Kt.start_time),"HH:mm")," - ",Bt.end_time?We(new Date(Bt.end_time),"HH:mm"):"Aktiv"]})]})]})}),r.jsx("div",{className:"divide-y",children:Nn.sort((dt,Yt)=>new Date(dt.start_time).getTime()-new Date(Yt.start_time).getTime()).map(dt=>{const Yt=f.find(rt=>rt.id===dt.project_id),we=dt.end_time?(new Date(dt.end_time).getTime()-new Date(dt.start_time).getTime())/(1e3*60*60):0,Ne=dt.break_duration||0;return r.jsx("div",{className:"p-4 hover:bg-muted/30",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsxs("span",{className:"font-medium",children:[We(new Date(dt.start_time),"HH:mm")," - ",dt.end_time?We(new Date(dt.end_time),"HH:mm"):"Aktiv"]}),r.jsx("span",{className:Oe("px-2 py-1 rounded-full text-xs font-medium",dt.status==="aktiv"?"bg-green-100 text-green-800":dt.status==="beendet"?"bg-blue-100 text-blue-800":dt.status==="pausiert"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:dt.status==="aktiv"?"Aktiv":dt.status==="beendet"?"Beendet":dt.status==="pausiert"?"Pausiert":dt.status})]}),r.jsxs("div",{className:"text-sm text-muted-foreground",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Projekt:"})," ",(Yt==null?void 0:Yt.name)||"Kein Projekt"]}),dt.description&&r.jsxs("p",{children:[r.jsx("strong",{children:"Beschreibung:"})," ",dt.description]}),Ne>0&&r.jsxs("p",{children:[r.jsx("strong",{children:"Pause:"})," ",Ne," min"]})]})]}),r.jsxs("div",{className:"text-right ml-4 flex items-center gap-2",children:[dt.end_time&&r.jsxs("span",{className:"text-lg font-bold",children:[we.toFixed(1),"h"]}),e==="manager"&&r.jsx(J,{size:"sm",variant:"outline",onClick:()=>{U(dt),z(!0)},children:r.jsx(Dl,{className:"w-4 h-4"})})]})]})},dt.id)})})]},xt)}).filter(Boolean)})(),Object.keys(at).length===0&&r.jsx("div",{className:"p-8 text-center text-muted-foreground border rounded-lg",children:"Keine Zeiterfassungseinträge für den ausgewählten Mitarbeiter gefunden"})]}):r.jsx("div",{className:"p-8 text-center text-muted-foreground border rounded-lg",children:"Bitte wählen Sie einen Mitarbeiter aus, um die Zeiterfassung anzuzeigen"})]})})()})]}),r.jsx(Ke,{}),r.jsx(re,{}),r.jsx(Dte,{open:Q,onOpenChange:z,timeEntry:V,projects:f,onSave:()=>{}})]})};function Mte({open:t,onOpenChange:e}){const[n,s]=g.useState(""),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(void 0),[m,f]=g.useState(""),[p,y]=g.useState(19),[j,v]=g.useState([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),{toast:_}=Rt(),b=or(),{data:w=[]}=_s({queryKey:["customers"],queryFn:async()=>{const{data:F,error:W}=await K.from("customers").select("id, company_name, contact_person").eq("status","Aktiv").order("company_name");if(W)throw W;return F}}),N=rs({mutationFn:async F=>{const W=j.reduce((U,O)=>U+O.total_price,0),ee=W*p/100,ue=W+ee,{data:de,error:Q}=await K.from("quotes").insert({title:n,description:a,customer_id:o,valid_until:d?We(d,"yyyy-MM-dd"):null,tax_rate:p,net_amount:W,tax_amount:ee,total_amount:ue,notes:m,quote_number:""}).select().single();if(Q)throw Q;const z=j.map((U,O)=>({quote_id:de.id,position:O+1,description:U.description,quantity:U.quantity,unit:U.unit,unit_price:U.unit_price,total_price:U.total_price})),{error:V}=await K.from("document_items").insert(z);if(V)throw V;return de},onSuccess:()=>{_({title:"Erfolgreich",description:"Angebot wurde erfolgreich erstellt."}),b.invalidateQueries({queryKey:["quotes"]}),S()},onError:F=>{_({title:"Fehler",description:"Beim Erstellen des Angebots ist ein Fehler aufgetreten.",variant:"destructive"}),console.error("Error creating quote:",F)}}),S=()=>{s(""),i(""),c(""),u(void 0),f(""),y(19),v([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),e(!1)},A=()=>{const F={id:Date.now().toString(),description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0};v([...j,F])},E=F=>{j.length>1&&v(j.filter(W=>W.id!==F))},D=(F,W,ee)=>{v(j.map(ue=>{if(ue.id===F){const de={...ue,[W]:ee};return(W==="quantity"||W==="unit_price")&&(de.total_price=de.quantity*de.unit_price),de}return ue}))},M=j.reduce((F,W)=>F+W.total_price,0),B=M*p/100,R=M+B,P=F=>{if(F.preventDefault(),!n||!o||j.some(W=>!W.description)){_({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}N.mutate({})};return r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx(rn,{children:r.jsx(sn,{children:"Neues Angebot erstellen"})}),r.jsxs("form",{onSubmit:P,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"title",children:"Titel *"}),r.jsx(ne,{id:"title",value:n,onChange:F=>s(F.target.value),placeholder:"Angebots-Titel eingeben",required:!0})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"customer",children:"Kunde *"}),r.jsxs(vt,{value:o,onValueChange:c,required:!0,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Kunde auswählen"})}),r.jsx(gt,{children:w.map(F=>r.jsxs(ye,{value:F.id,children:[F.company_name," (",F.contact_person,")"]},F.id))})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"description",children:"Beschreibung"}),r.jsx(En,{id:"description",value:a,onChange:F=>i(F.target.value),placeholder:"Beschreibung des Angebots",rows:3})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{children:"Gültig bis"}),r.jsxs(Ha,{children:[r.jsx(Va,{asChild:!0,children:r.jsxs(J,{variant:"outline",className:Oe("w-full justify-start text-left font-normal",!d&&"text-muted-foreground"),children:[r.jsx(zt,{className:"mr-2 h-4 w-4"}),d?We(d,"PPP",{locale:cn}):"Datum auswählen"]})}),r.jsx(da,{className:"w-auto p-0",align:"start",children:r.jsx(ua,{mode:"single",selected:d,onSelect:u,initialFocus:!0})})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"taxRate",children:"Steuersatz (%)"}),r.jsx(ne,{id:"taxRate",type:"number",step:"0.01",min:"0",max:"100",value:p,onChange:F=>y(parseFloat(F.target.value)||0)})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center justify-between",children:["Positionen",r.jsxs(J,{type:"button",onClick:A,size:"sm",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Position hinzufügen"]})]})}),r.jsxs(ce,{className:"space-y-4",children:[j.map(F=>r.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[r.jsxs("div",{className:"col-span-4 space-y-2",children:[r.jsx(Y,{children:"Beschreibung *"}),r.jsx(ne,{value:F.description,onChange:W=>D(F.id,"description",W.target.value),placeholder:"Beschreibung der Position",required:!0})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(Y,{children:"Menge"}),r.jsx(ne,{type:"number",step:"0.01",min:"0",value:F.quantity,onChange:W=>D(F.id,"quantity",parseFloat(W.target.value)||0)})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(Y,{children:"Einheit"}),r.jsxs(vt,{value:F.unit,onValueChange:W=>D(F.id,"unit",W),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Stk.",children:"Stk."}),r.jsx(ye,{value:"h",children:"Stunden"}),r.jsx(ye,{value:"m",children:"Meter"}),r.jsx(ye,{value:"m²",children:"m²"}),r.jsx(ye,{value:"kg",children:"kg"}),r.jsx(ye,{value:"l",children:"Liter"})]})]})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(Y,{children:"Einzelpreis"}),r.jsx(ne,{type:"number",step:"0.01",min:"0",value:F.unit_price,onChange:W=>D(F.id,"unit_price",parseFloat(W.target.value)||0)})]}),r.jsxs("div",{className:"col-span-1 space-y-2",children:[r.jsx(Y,{children:"Gesamt"}),r.jsxs("div",{className:"text-sm font-medium p-2 bg-muted rounded",children:[F.total_price.toFixed(2)," €"]})]}),r.jsx("div",{className:"col-span-1",children:r.jsx(J,{type:"button",variant:"ghost",size:"sm",onClick:()=>E(F.id),disabled:j.length===1,children:r.jsx(Ua,{className:"h-4 w-4"})})})]},F.id)),r.jsxs("div",{className:"border-t pt-4 space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Nettosumme:"}),r.jsxs("span",{children:[M.toFixed(2)," €"]})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsxs("span",{children:["MwSt. (",p,"%):"]}),r.jsxs("span",{children:[B.toFixed(2)," €"]})]}),r.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[r.jsx("span",{children:"Gesamtsumme:"}),r.jsxs("span",{children:[R.toFixed(2)," €"]})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"notes",children:"Anmerkungen"}),r.jsx(En,{id:"notes",value:m,onChange:F=>f(F.target.value),placeholder:"Zusätzliche Anmerkungen zum Angebot",rows:3})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(J,{type:"button",variant:"outline",onClick:S,children:"Abbrechen"}),r.jsx(J,{type:"submit",disabled:N.isPending,children:N.isPending?"Erstelle...":"Angebot erstellen"})]})]})]})})}function Rte({open:t,onOpenChange:e}){const[n,s]=g.useState(""),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(""),[m,f]=g.useState(new Date),[p,y]=g.useState(mr(new Date,30)),[j,v]=g.useState("30 Tage netto"),[_,b]=g.useState(""),[w,N]=g.useState(19),[S,A]=g.useState([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),{toast:E}=Rt(),D=or(),{data:M=[]}=_s({queryKey:["customers"],queryFn:async()=>{const{data:U,error:O}=await K.from("customers").select("id, company_name, contact_person").eq("status","Aktiv").order("company_name");if(O)throw O;return U}}),{data:B=[]}=_s({queryKey:["quotes-for-invoice"],queryFn:async()=>{const{data:U,error:O}=await K.from("quotes").select("id, quote_number, title, customer_id").eq("status","Angenommen").order("created_at",{ascending:!1});if(O)throw O;return U}}),R=rs({mutationFn:async U=>{const O=S.reduce((ie,pe)=>ie+pe.total_price,0),I=O*w/100,H=O+I,{data:$,error:te}=await K.from("invoices").insert({title:n,description:a,customer_id:o,quote_id:d||null,invoice_date:We(m,"yyyy-MM-dd"),due_date:We(p,"yyyy-MM-dd"),payment_terms:j,tax_rate:w,net_amount:O,tax_amount:I,total_amount:H,notes:_,invoice_number:""}).select().single();if(te)throw te;const X=S.map((ie,pe)=>({invoice_id:$.id,position:pe+1,description:ie.description,quantity:ie.quantity,unit:ie.unit,unit_price:ie.unit_price,total_price:ie.total_price})),{error:Z}=await K.from("document_items").insert(X);if(Z)throw Z;return $},onSuccess:()=>{E({title:"Erfolgreich",description:"Rechnung wurde erfolgreich erstellt."}),D.invalidateQueries({queryKey:["invoices"]}),P()},onError:U=>{E({title:"Fehler",description:"Beim Erstellen der Rechnung ist ein Fehler aufgetreten.",variant:"destructive"}),console.error("Error creating invoice:",U)}}),P=()=>{s(""),i(""),c(""),u(""),f(new Date),y(mr(new Date,30)),v("30 Tage netto"),b(""),N(19),A([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),e(!1)},F=()=>{const U={id:Date.now().toString(),description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0};A([...S,U])},W=U=>{S.length>1&&A(S.filter(O=>O.id!==U))},ee=(U,O,I)=>{A(S.map(H=>{if(H.id===U){const $={...H,[O]:I};return(O==="quantity"||O==="unit_price")&&($.total_price=$.quantity*$.unit_price),$}return H}))},ue=async U=>{if(U)try{const{data:O,error:I}=await K.from("quotes").select(`
          *,
          customer:customers(company_name, contact_person)
        `).eq("id",U).single();if(I)throw I;const{data:H,error:$}=await K.from("document_items").select("*").eq("quote_id",U).order("position");if($)throw $;if(s(`Rechnung für ${O.title}`),i(O.description||""),c(O.customer_id),N(O.tax_rate),b(O.notes||""),H&&H.length>0){const te=H.map(X=>({id:X.id,description:X.description,quantity:X.quantity,unit:X.unit,unit_price:X.unit_price,total_price:X.total_price}));A(te)}E({title:"Angebotsdaten geladen",description:"Die Daten aus dem Angebot wurden übernommen."})}catch(O){console.error("Error loading quote data:",O),E({title:"Fehler",description:"Beim Laden der Angebotsdaten ist ein Fehler aufgetreten.",variant:"destructive"})}},de=S.reduce((U,O)=>U+O.total_price,0),Q=de*w/100,z=de+Q,V=U=>{if(U.preventDefault(),!n||!o||S.some(O=>!O.description)){E({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}R.mutate({})};return r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx(rn,{children:r.jsx(sn,{children:"Neue Rechnung erstellen"})}),r.jsxs("form",{onSubmit:V,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"title",children:"Titel *"}),r.jsx(ne,{id:"title",value:n,onChange:U=>s(U.target.value),placeholder:"Rechnungs-Titel eingeben",required:!0})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"customer",children:"Kunde *"}),r.jsxs(vt,{value:o,onValueChange:c,required:!0,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Kunde auswählen"})}),r.jsx(gt,{children:M.map(U=>r.jsxs(ye,{value:U.id,children:[U.company_name," (",U.contact_person,")"]},U.id))})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"quote",children:"Basiert auf Angebot (optional)"}),r.jsxs(vt,{value:d,onValueChange:U=>{u(U),U&&ue(U)},children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Angebot auswählen (optional)"})}),r.jsx(gt,{children:B.map(U=>r.jsxs(ye,{value:U.id,children:[U.quote_number," - ",U.title]},U.id))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"description",children:"Beschreibung"}),r.jsx(En,{id:"description",value:a,onChange:U=>i(U.target.value),placeholder:"Beschreibung der Rechnung",rows:3})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{children:"Rechnungsdatum"}),r.jsxs(Ha,{children:[r.jsx(Va,{asChild:!0,children:r.jsxs(J,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[r.jsx(zt,{className:"mr-2 h-4 w-4"}),We(m,"PPP",{locale:cn})]})}),r.jsx(da,{className:"w-auto p-0",align:"start",children:r.jsx(ua,{mode:"single",selected:m,onSelect:U=>U&&f(U),initialFocus:!0})})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{children:"Fälligkeitsdatum"}),r.jsxs(Ha,{children:[r.jsx(Va,{asChild:!0,children:r.jsxs(J,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[r.jsx(zt,{className:"mr-2 h-4 w-4"}),We(p,"PPP",{locale:cn})]})}),r.jsx(da,{className:"w-auto p-0",align:"start",children:r.jsx(ua,{mode:"single",selected:p,onSelect:U=>U&&y(U),initialFocus:!0})})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"paymentTerms",children:"Zahlungsbedingungen"}),r.jsxs(vt,{value:j,onValueChange:v,children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Sofort",children:"Sofort"}),r.jsx(ye,{value:"7 Tage netto",children:"7 Tage netto"}),r.jsx(ye,{value:"14 Tage netto",children:"14 Tage netto"}),r.jsx(ye,{value:"30 Tage netto",children:"30 Tage netto"}),r.jsx(ye,{value:"60 Tage netto",children:"60 Tage netto"})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"taxRate",children:"Steuersatz (%)"}),r.jsx(ne,{id:"taxRate",type:"number",step:"0.01",min:"0",max:"100",value:w,onChange:U=>N(parseFloat(U.target.value)||0),className:"w-32"})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center justify-between",children:["Positionen",r.jsxs(J,{type:"button",onClick:F,size:"sm",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Position hinzufügen"]})]})}),r.jsxs(ce,{className:"space-y-4",children:[S.map(U=>r.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[r.jsxs("div",{className:"col-span-4 space-y-2",children:[r.jsx(Y,{children:"Beschreibung *"}),r.jsx(ne,{value:U.description,onChange:O=>ee(U.id,"description",O.target.value),placeholder:"Beschreibung der Position",required:!0})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(Y,{children:"Menge"}),r.jsx(ne,{type:"number",step:"0.01",min:"0",value:U.quantity,onChange:O=>ee(U.id,"quantity",parseFloat(O.target.value)||0)})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(Y,{children:"Einheit"}),r.jsxs(vt,{value:U.unit,onValueChange:O=>ee(U.id,"unit",O),children:[r.jsx(pt,{children:r.jsx(yt,{})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Stk.",children:"Stk."}),r.jsx(ye,{value:"h",children:"Stunden"}),r.jsx(ye,{value:"m",children:"Meter"}),r.jsx(ye,{value:"m²",children:"m²"}),r.jsx(ye,{value:"kg",children:"kg"}),r.jsx(ye,{value:"l",children:"Liter"})]})]})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(Y,{children:"Einzelpreis"}),r.jsx(ne,{type:"number",step:"0.01",min:"0",value:U.unit_price,onChange:O=>ee(U.id,"unit_price",parseFloat(O.target.value)||0)})]}),r.jsxs("div",{className:"col-span-1 space-y-2",children:[r.jsx(Y,{children:"Gesamt"}),r.jsxs("div",{className:"text-sm font-medium p-2 bg-muted rounded",children:[U.total_price.toFixed(2)," €"]})]}),r.jsx("div",{className:"col-span-1",children:r.jsx(J,{type:"button",variant:"ghost",size:"sm",onClick:()=>W(U.id),disabled:S.length===1,children:r.jsx(Ua,{className:"h-4 w-4"})})})]},U.id)),r.jsxs("div",{className:"border-t pt-4 space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Nettosumme:"}),r.jsxs("span",{children:[de.toFixed(2)," €"]})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsxs("span",{children:["MwSt. (",w,"%):"]}),r.jsxs("span",{children:[Q.toFixed(2)," €"]})]}),r.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[r.jsx("span",{children:"Gesamtsumme:"}),r.jsxs("span",{children:[z.toFixed(2)," €"]})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"notes",children:"Anmerkungen"}),r.jsx(En,{id:"notes",value:_,onChange:U=>b(U.target.value),placeholder:"Zusätzliche Anmerkungen zur Rechnung",rows:3})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(J,{type:"button",variant:"outline",onClick:P,children:"Abbrechen"}),r.jsx(J,{type:"submit",disabled:R.isPending,children:R.isPending?"Erstelle...":"Rechnung erstellen"})]})]})]})})}const Ite=({quote:t,onRefresh:e})=>{const n=TZ(),s=KM(),a=()=>{n.mutate(t.id,{onSuccess:()=>{e==null||e()}})},i=()=>{s.mutate({name:t.title,description:t.description,customer_id:t.customer_id,status:"neu",start_date:new Date().toISOString().split("T")[0],quote_id:t.id},{onSuccess:()=>{e==null||e()}})},o=n.isPending||s.isPending,c=t.status==="accepted"||t.status==="sent"||t.status==="versendet";return r.jsxs("div",{className:"flex space-x-1",children:[c&&r.jsxs(J,{size:"sm",variant:"default",onClick:a,disabled:o,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[r.jsx(Lb,{className:"h-3 w-3 mr-1"}),"Auftrag erstellen"]}),r.jsxs(J,{size:"sm",variant:"outline",onClick:i,disabled:o,title:"Direkt zu Projekt (überspringt Auftrag)",children:[r.jsx(fa,{className:"h-3 w-3 mr-1"}),"Zu Projekt"]})]})},Ote=uf("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),_p=g.forwardRef(({className:t,variant:e,...n},s)=>r.jsx("div",{ref:s,role:"alert",className:Oe(Ote({variant:e}),t),...n}));_p.displayName="Alert";const Lte=g.forwardRef(({className:t,...e},n)=>r.jsx("h5",{ref:n,className:Oe("mb-1 font-medium leading-none tracking-tight",t),...e}));Lte.displayName="AlertTitle";const wp=g.forwardRef(({className:t,...e},n)=>r.jsx("div",{ref:n,className:Oe("text-sm [&_p]:leading-relaxed",t),...e}));wp.displayName="AlertDescription";function Fte({onOCRComplete:t,onError:e,className:n="",accept:s="image/*,.pdf",maxSize:a=10}){const[i,o]=g.useState(!1),[c,d]=g.useState(null),[u,m]=g.useState(0),f=zZ({onSuccess:A=>{d(null),m(0),t==null||t(A)},onError:A=>{d(null),m(0),e==null||e(A.message)}}),p=g.useCallback(A=>{A.preventDefault(),o(!0)},[]),y=g.useCallback(A=>{A.preventDefault(),o(!1)},[]),j=g.useCallback(A=>{A.preventDefault(),o(!1);const E=Array.from(A.dataTransfer.files);E.length>0&&_(E[0])},[]),v=g.useCallback(A=>{const E=A.target.files;E&&E.length>0&&_(E[0]),A.target.value=""},[]),_=g.useCallback(A=>{if(!["image/jpeg","image/png","image/gif","image/bmp","image/webp","application/pdf"].includes(A.type)){e==null||e("Nur Bilddateien (JPEG, PNG, GIF, BMP, WebP) und PDF-Dateien sind erlaubt.");return}if(A.size/(1024*1024)>a){e==null||e(`Datei zu groß. Maximale Größe: ${a}MB`);return}d(A)},[a,e]),b=g.useCallback(async()=>{if(c)try{m(25),console.log("Starting OCR processing for:",c.name),await f.mutateAsync(c)}catch(A){console.error("OCR processing failed:",A),e==null||e(A instanceof Error?A.message:"OCR-Verarbeitung fehlgeschlagen"),d(null),m(0)}},[c,f,e]),w=g.useCallback(()=>{d(null),m(0)},[]),N=A=>{if(A===0)return"0 Bytes";const E=1024,D=["Bytes","KB","MB","GB"],M=Math.floor(Math.log(A)/Math.log(E));return parseFloat((A/Math.pow(E,M)).toFixed(2))+" "+D[M]},S=A=>A.type.startsWith("image/")?r.jsx(ap,{className:"h-8 w-8 text-blue-500"}):A.type==="application/pdf"?r.jsx(On,{className:"h-8 w-8 text-red-500"}):r.jsx(On,{className:"h-8 w-8 text-gray-500"});return c&&!f.isPending?r.jsx(le,{className:n,children:r.jsx(ce,{className:"p-6",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[S(c),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-medium truncate",children:c.name}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsx("span",{children:N(c.size)}),r.jsx("span",{children:c.type}),r.jsx(Ve,{variant:"outline",children:"Bereit für OCR"})]})]}),r.jsx(J,{variant:"ghost",size:"sm",onClick:w,children:r.jsx(ar,{className:"h-4 w-4"})})]}),r.jsxs(_p,{children:[r.jsx(Ju,{className:"h-4 w-4"}),r.jsx(wp,{children:"Die Datei wird mit OCR verarbeitet und automatisch in deutsche Rechnung konvertiert. Dieser Vorgang kann 10-30 Sekunden dauern."})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(J,{onClick:b,disabled:f.isPending,className:"flex-1",children:[r.jsx(Ju,{className:"mr-2 h-4 w-4"}),"OCR starten"]}),r.jsx(J,{variant:"outline",onClick:w,children:"Abbrechen"})]})]})})}):f.isPending?r.jsx(le,{className:n,children:r.jsx(ce,{className:"p-6",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),r.jsx("h3",{className:"font-medium",children:"OCR-Verarbeitung läuft..."}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Rechnung wird analysiert und Daten extrahiert"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Fortschritt"}),r.jsxs("span",{children:[Math.round(u),"%"]})]}),r.jsx(kd,{value:u,className:"h-2"})]}),r.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(Lr,{className:"h-4 w-4 text-green-500"}),r.jsx("span",{children:"Datei hochgeladen"})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm mt-1",children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-primary"}),r.jsx("span",{children:"Tesseract OCR läuft..."})]})]}),r.jsxs(_p,{children:[r.jsx(X0,{className:"h-4 w-4"}),r.jsx(wp,{children:"Bitte warten Sie, bis die Verarbeitung abgeschlossen ist. Bei komplexen Dokumenten kann dies länger dauern."})]})]})})}):r.jsx(le,{className:`transition-colors ${i?"border-primary bg-primary/5":"border-dashed"} ${n}`,onDragOver:p,onDragLeave:y,onDrop:j,children:r.jsx(ce,{className:"p-8",children:r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("div",{className:"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center",children:r.jsx(KA,{className:`h-8 w-8 ${i?"text-primary":"text-muted-foreground"}`})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium",children:"Rechnung für OCR hochladen"}),r.jsx("p",{className:"text-muted-foreground",children:"Ziehen Sie eine Datei hierher oder klicken Sie zum Auswählen"})]}),r.jsx("div",{className:"flex justify-center",children:r.jsxs(J,{variant:"outline",onClick:()=>{var A;return(A=document.getElementById("ocr-file-input"))==null?void 0:A.click()},children:[r.jsx(On,{className:"mr-2 h-4 w-4"}),"Datei auswählen"]})}),r.jsx("input",{id:"ocr-file-input",type:"file",accept:s,onChange:v,className:"hidden"}),r.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[r.jsx("p",{children:"Unterstützte Formate: JPEG, PNG, GIF, BMP, WebP, PDF"}),r.jsxs("p",{children:["Maximale Dateigröße: ",a,"MB"]}),r.jsx("p",{children:"Empfohlen: Hochauflösende Scans für beste Ergebnisse"})]}),r.jsxs(_p,{className:"border-green-500 bg-green-50",children:[r.jsx(tB,{className:"h-4 w-4 text-green-600"}),r.jsxs(wp,{children:[r.jsx("strong",{className:"text-green-800",children:"KI-OCR aktiv:"})," OpenAI Vision erkennt Rechnungsdaten intelligent und extrahiert alle Felder automatisch - auch komplexe Tabellen!"]})]})]})})})}function Bte({ocrResult:t,onValidated:e,onRejected:n,onCancel:s}){var V,U,O;const{toast:a}=Rt(),[i,o]=g.useState(t.structured_data),[c,d]=g.useState(""),[u,m]=g.useState(!1),[f,p]=g.useState("basic"),[y,j]=g.useState(null),[v,_]=g.useState(!1),[b,w]=g.useState(!1);g.useEffect(()=>{o(t.structured_data),t.original_file_path&&t.original_file_path.startsWith("data:image")&&j(t.original_file_path)},[t]),g.useEffect(()=>{const I=H=>{H.key==="Escape"&&b&&w(!1)};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[b]);const N=async()=>{if(!v){_(!0);try{const I=[];if(i.invoiceNumber||I.push("Rechnungsnummer fehlt"),i.invoiceDate||I.push("Rechnungsdatum fehlt"),i.supplierName||I.push("Lieferantenname fehlt"),(!i.totalAmount||i.totalAmount<=0)&&I.push("Gesamtbetrag fehlt"),i.serviceDescription||I.push("Leistungsbeschreibung fehlt"),I.length>0){a({title:"Validierungsfehler",description:`Pflichtfelder fehlen: ${I.join(", ")}`,variant:"destructive"});return}await new Promise(H=>setTimeout(H,1e3)),a({title:"Rechnung validiert",description:"Die Rechnungsdaten wurden erfolgreich validiert."}),e==null||e(i)}catch{a({title:"Validierungsfehler",description:"Ein Fehler ist bei der Validierung aufgetreten.",variant:"destructive"})}finally{_(!1)}}},S=(I,H)=>{o($=>({...$,[I]:H}))},A=(I,H)=>{const $=te=>Math.round(te*100)/100;o(te=>{const X={...te},Z=I==="netAmount"?H:te.netAmount||0,ie=I==="vatAmount"?H:te.vatAmount||0;return I==="totalAmount"||te.totalAmount,I==="netAmount"?(X.netAmount=H,ie>0&&(X.totalAmount=$(H+ie))):I==="vatAmount"?(X.vatAmount=H,Z>0&&(X.totalAmount=$(Z+H))):I==="totalAmount"&&(X.totalAmount=H,Z>0?X.vatAmount=$(H-Z):ie>0&&(X.netAmount=$(H-ie))),X})},E=(I=19)=>{o(H=>({...H,taxRates:[...H.taxRates||[],I],netAmounts:{...H.netAmounts||{},[I.toString()]:0},taxAmounts:{...H.taxAmounts||{},[I.toString()]:0}}))},D=I=>{o(H=>{const $=[...H.taxRates||[]],te=$[I];$.splice(I,1);const X={...H.netAmounts||{}},Z={...H.taxAmounts||{}};return delete X[te.toString()],delete Z[te.toString()],{...H,taxRates:$,netAmounts:X,taxAmounts:Z}})},M=(I,H,$)=>{o(te=>{const X=[...te.taxRates||[]],Z={...te.netAmounts||{}},ie={...te.taxAmounts||{}},pe=X[I];return H==="rate"?(X[I]=$,pe!==$&&(Z[$.toString()]=Z[pe.toString()]||0,ie[$.toString()]=ie[pe.toString()]||0,delete Z[pe.toString()],delete ie[pe.toString()])):H==="netAmount"?Z[pe.toString()]=Math.round($*100)/100:H==="taxAmount"&&(ie[pe.toString()]=Math.round($*100)/100),{...te,taxRates:X,netAmounts:Z,taxAmounts:ie}})},B=()=>{o(I=>{var H;return{...I,positions:[...I.positions||[],{position:(((H=I.positions)==null?void 0:H.length)||0)+1,description:"",quantity:1,unit:"Stk",unitPrice:0,totalPrice:0,vatRate:19}]}})},R=I=>{o(H=>{const $=[...H.positions||[]];return $.splice(I,1),$.forEach((te,X)=>{te.position=X+1}),{...H,positions:$}})},P=(I,H,$)=>{o(te=>{const X=[...te.positions||[]],Z={...X[I]};return Z[H]=$,(H==="quantity"||H==="unitPrice")&&(Z.totalPrice=Math.round(Z.quantity*Z.unitPrice*100)/100),X[I]=Z,{...te,positions:X}})},F=I=>{o(H=>{const $={...H,paymentTerms:I},te=H.invoiceDate;if(te&&I){const X=new Date(te);let Z=30;const ie=I.match(/(\d+)\s*tage?/i);ie&&(Z=parseInt(ie[1]));const pe=new Date(X);pe.setDate(pe.getDate()+Z),$.dueDate=pe.toISOString().split("T")[0]}return $})},W=I=>{if(!I)return!0;const H={AT:/^AT[UB]\d{8}$/,BE:/^BE[01]\d{9}$/,BG:/^BG\d{9,10}$/,CY:/^CY\d{8}[A-Z]$/,CZ:/^CZ\d{8,10}$/,DE:/^DE\d{9}$/,DK:/^DK\d{8}$/,EE:/^EE\d{9}$/,EL:/^EL\d{9}$/,ES:/^ES[A-Z]\d{7}[A-Z]|\d{8}[A-Z]$/,FI:/^FI\d{8}$/,FR:/^FR[A-Z0-9]{2}\d{9}$/,GB:/^GB\d{9}|\d{12}|(GD|HA)\d{3}$/,HR:/^HR\d{11}$/,HU:/^HU\d{8}$/,IE:/^IE\d[A-Z0-9]\d{5}[A-Z]$/,IT:/^IT\d{11}$/,LT:/^LT\d{9}|\d{12}$/,LU:/^LU\d{8}$/,LV:/^LV\d{11}$/,MT:/^MT\d{8}$/,NL:/^NL\d{9}B\d{2}$/,PL:/^PL\d{10}$/,PT:/^PT\d{9}$/,RO:/^RO\d{2,10}$/,SE:/^SE\d{12}$/,SI:/^SI\d{8}$/,SK:/^SK\d{10}$/},$=I.substring(0,2).toUpperCase(),te=H[$];return te?te.test(I.toUpperCase()):!1},ee=I=>{if(!I)return!0;const H=I.replace(/\s/g,"").toUpperCase();if(H.length<15||H.length>34||!/^[A-Z]{2}/.test(H)||!/^\d{2}/.test(H.substring(2,4)))return!1;const $=H.substring(4)+H.substring(0,4);let te="";for(let Z=0;Z<$.length;Z++){const ie=$[Z];ie>="A"&&ie<="Z"?te+=(ie.charCodeAt(0)-55).toString():te+=ie}let X=0;for(let Z=0;Z<te.length;Z++)X=(X*10+parseInt(te[Z]))%97;return X===1},ue=(I,H)=>I==="supplierVatId"&&H&&!W(H)?"Ungültige USt-IdNr. Format (z.B. DE123456789 für Deutschland)":I==="supplierIban"&&H&&!ee(H)?"Ungültige IBAN. Prüfen Sie Format und Prüfziffer.":null,de=I=>I?I.toLocaleString("de-DE",{style:"currency",currency:"EUR"}):"0,00 €",Q=I=>{if(I==null||I===0)return"";const H=I.toString(),$=H.split(".");if($.length===1)return H;{const X=$[1].substring(0,6).replace(/0+$/,""),Z=X.length<2?X.padEnd(2,"0"):X;return`${$[0]}.${Z}`}},z=Object.entries(i).filter(([I,H])=>H!==void 0&&H!==""&&H!==0&&!(Array.isArray(H)&&H.length===0)&&!(typeof H=="object"&&Object.keys(H).length===0)).length;return r.jsxs("div",{className:"space-y-6 max-w-7xl mx-auto",children:[r.jsx(le,{children:r.jsx(Ce,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/20",children:r.jsx(On,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),r.jsxs("div",{children:[r.jsx(Ee,{children:"Rechnungsvalidierung"}),r.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[z," Felder erfasst • Überprüfen und korrigieren Sie die Daten"]})]})]}),r.jsx("div",{className:"flex gap-2",children:r.jsxs(J,{variant:"outline",size:"sm",onClick:()=>m(!u),children:[u?r.jsx(HA,{className:"h-4 w-4"}):r.jsx(la,{className:"h-4 w-4"}),"OCR-Text"]})})]})})}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[y&&r.jsx("div",{className:"xl:col-span-1",children:r.jsxs(le,{className:"h-fit sticky top-6",children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Original-Dokument"}),r.jsxs(J,{variant:"outline",size:"sm",onClick:()=>w(!0),children:[r.jsx(la,{className:"h-4 w-4 mr-2"}),"Vollbild"]})]})}),r.jsx(ce,{className:"p-0",children:r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:y,alt:"Invoice",className:"w-full h-auto rounded-b-lg cursor-zoom-in hover:shadow-lg transition-shadow",style:{maxHeight:"calc(100vh - 200px)",minHeight:"600px",objectFit:"contain",backgroundColor:"#f8f9fa"},onClick:()=>w(!0),title:"Klicken für Vollbildansicht"}),r.jsx("div",{className:"absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-xs",children:"Klicken zum Vergrößern"})]})})]})}),r.jsxs("div",{className:y?"xl:col-span-1":"xl:col-span-2",children:[r.jsx(le,{children:r.jsx(ce,{className:"p-0",children:r.jsxs(zr,{value:f,onValueChange:p,children:[r.jsx("div",{className:"p-6 pb-0",children:r.jsxs(Er,{className:"grid w-full grid-cols-6",children:[r.jsx(Ge,{value:"basic",children:"Basis"}),r.jsx(Ge,{value:"supplier",children:"Lieferant"}),r.jsx(Ge,{value:"amounts",children:"Beträge"}),r.jsx(Ge,{value:"positions",children:"Positionen"}),r.jsx(Ge,{value:"references",children:"Referenzen"}),r.jsx(Ge,{value:"additional",children:"Erweitert"})]})}),r.jsxs(Qe,{value:"basic",className:"p-6 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Y,{htmlFor:"invoiceNumber",className:"flex items-center gap-2",children:[r.jsx(qF,{className:"h-4 w-4"}),"Rechnungsnummer *"]}),r.jsx(ne,{id:"invoiceNumber",value:i.invoiceNumber||"",onChange:I=>S("invoiceNumber",I.target.value),className:i.invoiceNumber?"":"border-red-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Y,{htmlFor:"invoiceDate",className:"flex items-center gap-2",children:[r.jsx(zt,{className:"h-4 w-4"}),"Rechnungsdatum *"]}),r.jsx(ne,{id:"invoiceDate",type:"date",value:i.invoiceDate||"",onChange:I=>S("invoiceDate",I.target.value),className:i.invoiceDate?"":"border-red-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"serviceDate",children:"Leistungsdatum"}),r.jsx(ne,{id:"serviceDate",type:"date",value:i.serviceDate||"",onChange:I=>S("serviceDate",I.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"dueDate",children:"Fälligkeitsdatum"}),r.jsx(ne,{id:"dueDate",type:"date",value:i.dueDate||"",onChange:I=>S("dueDate",I.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"currency",children:"Währung"}),r.jsx(ne,{id:"currency",value:i.currency||"EUR",onChange:I=>S("currency",I.target.value)})]})]}),r.jsx(po,{}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Y,{htmlFor:"serviceDescription",className:"flex items-center gap-2",children:[r.jsx(On,{className:"h-4 w-4"}),"Leistungsbeschreibung *"]}),r.jsx(En,{id:"serviceDescription",value:i.serviceDescription||"",onChange:I=>S("serviceDescription",I.target.value),className:i.serviceDescription?"":"border-red-500",rows:3})]})]}),r.jsx(Qe,{value:"supplier",className:"p-6 space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Y,{htmlFor:"supplierName",className:"flex items-center gap-2",children:[r.jsx(fa,{className:"h-4 w-4"}),"Lieferant/Firma *"]}),r.jsx(ne,{id:"supplierName",value:i.supplierName||"",onChange:I=>S("supplierName",I.target.value),className:i.supplierName?"":"border-red-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Y,{htmlFor:"contactPerson",className:"flex items-center gap-2",children:[r.jsx($s,{className:"h-4 w-4"}),"Ansprechpartner"]}),r.jsx(ne,{id:"contactPerson",value:i.contactPerson||"",onChange:I=>S("contactPerson",I.target.value)})]}),r.jsxs("div",{className:"md:col-span-2 space-y-2",children:[r.jsxs(Y,{htmlFor:"supplierAddress",className:"flex items-center gap-2",children:[r.jsx(sa,{className:"h-4 w-4"}),"Lieferantenadresse"]}),r.jsx(En,{id:"supplierAddress",value:i.supplierAddress||"",onChange:I=>S("supplierAddress",I.target.value),rows:2})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"supplierVatId",children:"USt-IdNr."}),r.jsx(ne,{id:"supplierVatId",value:i.supplierVatId||"",onChange:I=>S("supplierVatId",I.target.value),placeholder:"DE123456789",className:i.supplierVatId&&!W(i.supplierVatId)?"border-red-500":""}),i.supplierVatId&&!W(i.supplierVatId)&&r.jsx("p",{className:"text-sm text-red-600",children:ue("supplierVatId",i.supplierVatId)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"supplierTaxNumber",children:"Steuernummer"}),r.jsx(ne,{id:"supplierTaxNumber",value:i.supplierTaxNumber||"",onChange:I=>S("supplierTaxNumber",I.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Y,{htmlFor:"supplierEmail",className:"flex items-center gap-2",children:[r.jsx(sr,{className:"h-4 w-4"}),"E-Mail"]}),r.jsx(ne,{id:"supplierEmail",type:"email",value:i.supplierEmail||"",onChange:I=>S("supplierEmail",I.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Y,{htmlFor:"supplierPhone",className:"flex items-center gap-2",children:[r.jsx(Md,{className:"h-4 w-4"}),"Telefon"]}),r.jsx(ne,{id:"supplierPhone",value:i.supplierPhone||"",onChange:I=>S("supplierPhone",I.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Y,{htmlFor:"supplierIban",className:"flex items-center gap-2",children:[r.jsx(BF,{className:"h-4 w-4"}),"IBAN"]}),r.jsx(ne,{id:"supplierIban",value:i.supplierIban||"",onChange:I=>S("supplierIban",I.target.value),placeholder:"DE89 3704 0044 0532 0130 00",className:i.supplierIban&&!ee(i.supplierIban)?"border-red-500":""}),i.supplierIban&&!ee(i.supplierIban)&&r.jsx("p",{className:"text-sm text-red-600",children:ue("supplierIban",i.supplierIban)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"supplierBic",children:"BIC"}),r.jsx(ne,{id:"supplierBic",value:i.supplierBic||"",onChange:I=>S("supplierBic",I.target.value),placeholder:"COBADEFFXXX"})]})]})}),r.jsxs(Qe,{value:"amounts",className:"p-6 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Y,{htmlFor:"totalAmount",className:"flex items-center gap-2",children:[r.jsx(ra,{className:"h-4 w-4"}),"Gesamtbetrag (Brutto) *"]}),r.jsx(ne,{id:"totalAmount",type:"number",step:"0.01",value:Q(i.totalAmount),onChange:I=>A("totalAmount",parseFloat(I.target.value)||0),className:i.totalAmount?"":"border-red-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"netAmount",children:"Nettobetrag"}),r.jsx(ne,{id:"netAmount",type:"number",step:"0.01",value:Q(i.netAmount),onChange:I=>A("netAmount",parseFloat(I.target.value)||0)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"vatAmount",children:"MwSt-Betrag"}),r.jsx(ne,{id:"vatAmount",type:"number",step:"0.01",value:Q(i.vatAmount),onChange:I=>A("vatAmount",parseFloat(I.target.value)||0)})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Y,{children:"Steuer-Sätze"}),r.jsx(J,{type:"button",variant:"outline",size:"sm",onClick:()=>E(19),className:"h-8",children:"+ Steuer hinzufügen"})]}),r.jsxs("div",{className:"border rounded-lg",children:[r.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 bg-gray-50 dark:bg-gray-800 font-medium text-sm",children:[r.jsx("div",{children:"Satz (%)"}),r.jsx("div",{children:"Nettobasis (€)"}),r.jsx("div",{children:"Steuerbetrag (€)"}),r.jsx("div",{className:"text-right",children:"Aktionen"})]}),(i.taxRates||[]).map((I,H)=>{var $,te;return r.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-t",children:[r.jsx(ne,{type:"number",step:"0.01",value:I,onChange:X=>M(H,"rate",parseFloat(X.target.value)||0),className:"h-8"}),r.jsx(ne,{type:"number",step:"0.01",value:Q(($=i.netAmounts)==null?void 0:$[I.toString()]),onChange:X=>M(H,"netAmount",parseFloat(X.target.value)||0),className:"h-8"}),r.jsx(ne,{type:"number",step:"0.01",value:Q((te=i.taxAmounts)==null?void 0:te[I.toString()]),onChange:X=>M(H,"taxAmount",parseFloat(X.target.value)||0),className:"h-8"}),r.jsx("div",{className:"text-right",children:r.jsx(J,{type:"button",variant:"ghost",size:"sm",onClick:()=>D(H),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:r.jsx(ar,{className:"h-4 w-4"})})})]},H)}),(!i.taxRates||i.taxRates.length===0)&&r.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:'Keine Steuersätze erfasst. Klicken Sie auf "+ Steuer hinzufügen" um zu beginnen.'})]}),r.jsxs("div",{className:"flex justify-end text-sm text-gray-600",children:["Summe MwSt: ",de(Object.values(i.taxAmounts||{}).reduce((I,H)=>I+H,0))]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(Y,{children:"Spezielle Steuerarten"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Wa,{id:"hasReverseCharge",checked:i.hasReverseCharge||!1,onCheckedChange:I=>S("hasReverseCharge",I)}),r.jsx(Y,{htmlFor:"hasReverseCharge",className:"text-sm",children:"Reverse-Charge (Steuerschuldnerschaft des Leistungsempfängers)"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Wa,{id:"isIntraCommunitySupply",checked:i.isIntraCommunitySupply||!1,onCheckedChange:I=>S("isIntraCommunitySupply",I)}),r.jsx(Y,{htmlFor:"isIntraCommunitySupply",className:"text-sm",children:"Innergemeinschaftliche Lieferung"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Wa,{id:"isExport",checked:i.isExport||!1,onCheckedChange:I=>S("isExport",I)}),r.jsx(Y,{htmlFor:"isExport",className:"text-sm",children:"Ausfuhrlieferung"})]})]})]})]}),r.jsx(Qe,{value:"positions",className:"p-6 space-y-4",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Y,{className:"text-base font-semibold",children:"Rechnungspositionen"}),r.jsx(J,{type:"button",variant:"outline",size:"sm",onClick:()=>B(),className:"h-8",children:"+ Position hinzufügen"})]}),r.jsxs("div",{className:"border rounded-lg",children:[r.jsxs("div",{className:"grid grid-cols-7 gap-2 p-3 bg-gray-50 dark:bg-gray-800 font-medium text-sm",children:[r.jsx("div",{children:"Pos."}),r.jsx("div",{children:"Beschreibung"}),r.jsx("div",{children:"Menge"}),r.jsx("div",{children:"Einheit"}),r.jsx("div",{children:"EP (€)"}),r.jsx("div",{children:"MwSt %"}),r.jsx("div",{className:"text-right",children:"Aktionen"})]}),(i.positions||[]).map((I,H)=>r.jsxs("div",{className:"grid grid-cols-7 gap-2 p-3 border-t",children:[r.jsx(ne,{type:"number",value:I.position||H+1,onChange:$=>P(H,"position",parseInt($.target.value)||H+1),className:"h-8"}),r.jsx(ne,{type:"text",value:I.description,onChange:$=>P(H,"description",$.target.value),className:"h-8",placeholder:"Beschreibung..."}),r.jsx(ne,{type:"number",step:"0.01",value:I.quantity,onChange:$=>P(H,"quantity",parseFloat($.target.value)||0),className:"h-8"}),r.jsx(ne,{type:"text",value:I.unit||"Stk",onChange:$=>P(H,"unit",$.target.value),className:"h-8"}),r.jsx(ne,{type:"number",step:"0.01",value:Q(I.unitPrice),onChange:$=>P(H,"unitPrice",parseFloat($.target.value)||0),className:"h-8"}),r.jsx(ne,{type:"number",step:"0.01",value:I.vatRate||19,onChange:$=>P(H,"vatRate",parseFloat($.target.value)||19),className:"h-8"}),r.jsx("div",{className:"text-right",children:r.jsx(J,{type:"button",variant:"ghost",size:"sm",onClick:()=>R(H),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:r.jsx(ar,{className:"h-4 w-4"})})})]},H)),(!i.positions||i.positions.length===0)&&r.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:'Keine Positionen erfasst. Klicken Sie auf "+ Position hinzufügen" um zu beginnen.'})]}),i.positions&&i.positions.length>0&&r.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg space-y-2",children:[r.jsx("div",{className:"font-medium",children:"Positionssummen:"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{children:["Netto gesamt: ",de(i.positions.reduce((I,H)=>I+H.quantity*H.unitPrice,0))]}),r.jsxs("div",{children:["MwSt gesamt: ",de(i.positions.reduce((I,H)=>{const $=H.quantity*H.unitPrice,te=(H.vatRate||19)/100;return I+$*te},0))]}),r.jsxs("div",{className:"font-medium",children:["Brutto gesamt: ",de(i.positions.reduce((I,H)=>{const $=H.quantity*H.unitPrice,te=(H.vatRate||19)/100;return I+$+$*te},0))]})]})]})]})}),r.jsxs(Qe,{value:"references",className:"p-6 space-y-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx(Y,{className:"text-base font-semibold",children:"Zahlungsbedingungen"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"paymentTerms",children:'Zahlungsziel (z.B. "14 Tage, 2% Skonto")'}),r.jsx(ne,{id:"paymentTerms",value:i.paymentTerms||"",onChange:I=>F(I.target.value),placeholder:"z.B. 14 Tage netto"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"dueDate",children:"Fälligkeitsdatum *"}),r.jsx(ne,{id:"dueDate",type:"date",value:i.dueDate||"",onChange:I=>S("dueDate",I.target.value),className:i.dueDate?"":"border-yellow-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"paymentReference",children:"Zahlungsreferenz/Verwendungszweck"}),r.jsx(ne,{id:"paymentReference",value:i.paymentReference||"",onChange:I=>S("paymentReference",I.target.value),placeholder:"Verwendungszweck..."})]})]})]}),r.jsx(po,{}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"orderNumber",children:"Bestellnummer"}),r.jsx(ne,{id:"orderNumber",value:i.orderNumber||"",onChange:I=>S("orderNumber",I.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"projectReference",children:"Projekt-Referenz"}),r.jsx(ne,{id:"projectReference",value:i.projectReference||"",onChange:I=>S("projectReference",I.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"deliveryNoteNumber",children:"Lieferscheinnummer"}),r.jsx(ne,{id:"deliveryNoteNumber",value:i.deliveryNoteNumber||"",onChange:I=>S("deliveryNoteNumber",I.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"paymentReference",children:"Zahlungsreferenz/Verwendungszweck"}),r.jsx(ne,{id:"paymentReference",value:i.paymentReference||"",onChange:I=>S("paymentReference",I.target.value)})]}),r.jsxs("div",{className:"md:col-span-2 space-y-2",children:[r.jsx(Y,{htmlFor:"serviceLocation",children:"Liefer-/Leistungsort"}),r.jsx(ne,{id:"serviceLocation",value:i.serviceLocation||"",onChange:I=>S("serviceLocation",I.target.value)})]})]})]}),r.jsx(Qe,{value:"additional",className:"p-6 space-y-4",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"servicePeriodStart",children:"Leistungszeitraum - Von"}),r.jsx(ne,{id:"servicePeriodStart",type:"date",value:i.servicePeriodStart||"",onChange:I=>S("servicePeriodStart",I.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"servicePeriodEnd",children:"Leistungszeitraum - Bis"}),r.jsx(ne,{id:"servicePeriodEnd",type:"date",value:i.servicePeriodEnd||"",onChange:I=>S("servicePeriodEnd",I.target.value)})]})]}),r.jsx(po,{}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{children:"Empfänger (Ihr Unternehmen)"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(ne,{placeholder:"Firmenname",value:i.customerName||"",onChange:I=>S("customerName",I.target.value)}),r.jsx(En,{placeholder:"Adresse",value:i.customerAddress||"",onChange:I=>S("customerAddress",I.target.value),rows:2})]})]}),r.jsx(po,{}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"validationNotes",children:"Validierungsnotizen"}),r.jsx(En,{id:"validationNotes",value:c,onChange:I=>d(I.target.value),placeholder:"Notizen zur Validierung...",rows:3})]}),i.positions&&i.positions.length>0&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Y,{children:["Erkannte Rechnungspositionen (",i.positions.length,")"]}),r.jsx("div",{className:"border rounded-lg p-3 space-y-2 max-h-40 overflow-y-auto",children:i.positions.map((I,H)=>r.jsxs("div",{className:"text-sm p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[r.jsx("div",{className:"font-medium",children:I.description}),r.jsxs("div",{className:"text-gray-500",children:[I.quantity," ",I.unit||"Stk"," × ",de(I.unitPrice||0)," = ",de(I.totalPrice||0)]})]},H))})]})]})})]})})}),r.jsx(le,{className:"shadow-lg border border-gray-200 dark:border-gray-700 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm",children:r.jsx(ce,{className:"p-4",children:r.jsx("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4",children:r.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400",children:[r.jsxs("div",{className:"flex items-center gap-2 bg-green-50 dark:bg-green-900/20 px-3 py-1.5 rounded-full",children:[r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),r.jsxs("span",{className:"font-medium text-green-700 dark:text-green-400",children:[z," von 30+ Feldern erfasst"]})]}),r.jsxs(Ve,{variant:"outline",className:`${(((V=t.confidence_scores)==null?void 0:V.overall)||0)>=.8?"bg-green-50 text-green-700 border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-800":(((U=t.confidence_scores)==null?void 0:U.overall)||0)>=.6?"bg-yellow-50 text-yellow-700 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-800":"bg-red-50 text-red-700 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800"}`,children:[Math.round((((O=t.confidence_scores)==null?void 0:O.overall)||0)*100),"% Vertrauen"]})]})})})}),r.jsx(le,{className:"shadow-lg border border-gray-200 dark:border-gray-700 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex justify-center items-center gap-3",children:[r.jsx(J,{variant:"outline",onClick:s,className:"px-5 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800 border-gray-300 dark:border-gray-600 transition-all duration-200",children:"Abbrechen"}),r.jsxs(J,{variant:"outline",onClick:n,className:"px-5 py-2 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/30 border-red-200 hover:border-red-300 dark:border-red-800 dark:hover:border-red-700 transition-all duration-200",children:[r.jsx(ar,{className:"h-4 w-4 mr-2"}),"Ablehnen"]}),r.jsx(J,{onClick:N,disabled:v,className:"px-8 py-2 bg-green-600 hover:bg-green-700 text-white font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:v?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full"}),"Verarbeitung..."]}):r.jsxs(r.Fragment,{children:[r.jsx(hf,{className:"h-4 w-4 mr-2"}),"Validieren & Übernehmen"]})})]})})})]})]}),u&&r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(la,{className:"h-5 w-5"}),"OCR Rohtext"]})}),r.jsx(ce,{children:r.jsx("pre",{className:"text-sm bg-gray-100 dark:bg-gray-800 p-4 rounded-lg whitespace-pre-wrap max-h-60 overflow-y-auto",children:t.extracted_text})})]}),b&&y&&r.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",onClick:()=>w(!1),children:r.jsxs("div",{className:"relative max-w-7xl max-h-full w-full h-full flex items-center justify-center",children:[r.jsx("button",{onClick:()=>w(!1),className:"absolute top-4 right-4 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",title:"Schließen (ESC)",children:r.jsx(ar,{className:"h-6 w-6"})}),r.jsx("img",{src:y,alt:"Vergrößerte Rechnung",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",onClick:I=>I.stopPropagation()})]})})]})}function zte(){const[t,e]=g.useState([]),[n,s]=g.useState(!0),[a,i]=g.useState(""),[o,c]=g.useState("all"),[d,u]=g.useState(null);g.useEffect(()=>{m()},[]);const m=async()=>{try{s(!0);const{data:{user:_}}=await K.auth.getUser();if(!_)return;const{data:b,error:w}=await K.from("supplier_invoices").select("*").eq("created_by",_.id).order("created_at",{ascending:!1});if(w){console.error("Error loading supplier invoices:",w);return}e(b||[])}catch(_){console.error("Failed to load supplier invoices:",_)}finally{s(!1)}},f=_=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(_),p=_=>new Date(_).toLocaleDateString("de-DE"),y=_=>{switch(_){case"pending":return r.jsxs(Ve,{variant:"outline",className:"bg-yellow-50 text-yellow-800 border-yellow-200",children:[r.jsx(hn,{className:"h-3 w-3 mr-1"}),"Ausstehend"]});case"approved":return r.jsxs(Ve,{variant:"outline",className:"bg-blue-50 text-blue-800 border-blue-200",children:[r.jsx(Lr,{className:"h-3 w-3 mr-1"}),"Genehmigt"]});case"paid":return r.jsxs(Ve,{variant:"outline",className:"bg-green-50 text-green-800 border-green-200",children:[r.jsx(Lr,{className:"h-3 w-3 mr-1"}),"Bezahlt"]});case"cancelled":return r.jsxs(Ve,{variant:"outline",className:"bg-red-50 text-red-800 border-red-200",children:[r.jsx(Nl,{className:"h-3 w-3 mr-1"}),"Storniert"]});default:return r.jsx(Ve,{variant:"outline",children:_})}},j=async(_,b)=>{try{const{error:w}=await K.from("supplier_invoices").update({status:b,updated_at:new Date().toISOString()}).eq("id",_);if(w){console.error("Error updating invoice status:",w);return}e(N=>N.map(S=>S.id===_?{...S,status:b}:S))}catch(w){console.error("Failed to update invoice status:",w)}},v=t.filter(_=>{const b=_.invoice_number.toLowerCase().includes(a.toLowerCase())||_.supplier_name.toLowerCase().includes(a.toLowerCase()),w=o==="all"||_.status===o;return b&&w});return n?r.jsx("div",{className:"flex items-center justify-center p-8",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),r.jsx("p",{children:"Lade Lieferantenrechnungen..."})]})}):r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[r.jsx(ms,{className:"h-6 w-6"}),"Lieferantenrechnungen"]}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Verwalten Sie Ihre eingescannten und erstellten Lieferantenrechnungen"})]})}),r.jsx(le,{children:r.jsx(ce,{className:"pt-6",children:r.jsxs("div",{className:"flex gap-4",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(Rd,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(ne,{placeholder:"Nach Rechnungsnummer oder Lieferant suchen...",value:a,onChange:_=>i(_.target.value),className:"pl-9"})]})}),r.jsxs("select",{value:o,onChange:_=>c(_.target.value),className:"px-3 py-2 border rounded-md bg-background",children:[r.jsx("option",{value:"all",children:"Alle Status"}),r.jsx("option",{value:"pending",children:"Ausstehend"}),r.jsx("option",{value:"approved",children:"Genehmigt"}),r.jsx("option",{value:"paid",children:"Bezahlt"}),r.jsx("option",{value:"cancelled",children:"Storniert"})]})]})})}),v.length===0?r.jsx(le,{children:r.jsx(ce,{className:"py-12",children:r.jsxs("div",{className:"text-center",children:[r.jsx(ms,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Rechnungen gefunden"}),r.jsx("p",{className:"text-muted-foreground",children:a||o!=="all"?"Keine Rechnungen entsprechen den aktuellen Filterkriterien.":"Sie haben noch keine Lieferantenrechnungen erstellt."})]})})}):r.jsx("div",{className:"grid gap-4",children:v.map(_=>r.jsx(le,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>u(_),children:r.jsx(ce,{className:"p-6",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"space-y-3 flex-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("h3",{className:"font-semibold text-lg",children:_.invoice_number}),_.ocr_result_id&&r.jsxs(Ve,{variant:"outline",className:"text-xs",children:[r.jsx(Z2,{className:"h-3 w-3 mr-1"}),"OCR"]})]}),y(_.status)]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(fa,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{className:"font-medium",children:_.supplier_name})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(zt,{className:"h-4 w-4 text-muted-foreground"}),r.jsxs("span",{children:["Datum: ",p(_.invoice_date)]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(hs,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{className:"font-semibold text-primary",children:f(_.total_amount)})]})]}),(_.description||_.iban)&&r.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[_.description&&r.jsxs("div",{children:["Beschreibung: ",_.description]}),_.iban&&r.jsxs("div",{children:["IBAN: ",_.iban]})]}),_.vat_amount&&_.vat_amount>0&&r.jsxs("div",{className:"text-sm text-muted-foreground",children:["inkl. MwSt: ",f(_.vat_amount)]})]}),r.jsxs("div",{className:"flex gap-2 ml-4",children:[_.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsx(J,{size:"sm",onClick:()=>j(_.id,"approved"),className:"bg-blue-600 hover:bg-blue-700",children:"Genehmigen"}),r.jsx(J,{size:"sm",variant:"outline",onClick:()=>j(_.id,"cancelled"),className:"border-red-600 text-red-600 hover:bg-red-50",children:"Stornieren"})]}),_.status==="approved"&&r.jsx(J,{size:"sm",onClick:()=>j(_.id,"paid"),className:"bg-green-600 hover:bg-green-700",children:"Als bezahlt markieren"})]})]})})},_.id))}),v.length>0&&r.jsx(le,{className:"bg-muted/50",children:r.jsx(ce,{className:"pt-6",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("span",{className:"text-sm text-muted-foreground",children:[v.length," Rechnung",v.length!==1?"en":""," gefunden"]}),r.jsxs("span",{className:"font-semibold",children:["Gesamtsumme: ",f(v.filter(_=>_.status!=="cancelled").reduce((_,b)=>_+b.total_amount,0))]})]})})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>u(null),children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:_=>_.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[r.jsx(ms,{className:"h-6 w-6"}),"Rechnungsdetails"]}),r.jsx(J,{variant:"ghost",size:"sm",onClick:()=>u(null),className:"hover:bg-gray-100",children:r.jsx(Nl,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Rechnungsinformationen"}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Rechnungsnummer:"}),r.jsx("span",{className:"font-medium",children:d.invoice_number})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Lieferant:"}),r.jsx("span",{className:"font-medium",children:d.supplier_name})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Rechnungsdatum:"}),r.jsx("span",{children:p(d.invoice_date)})]}),d.due_date&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Fälligkeitsdatum:"}),r.jsx("span",{children:p(d.due_date)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Status:"}),y(d.status)]})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Beträge"}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Gesamtbetrag:"}),r.jsx("span",{className:"font-bold text-lg text-primary",children:f(d.total_amount)})]}),d.vat_amount&&d.vat_amount>0&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"MwSt-Betrag:"}),r.jsx("span",{children:f(d.vat_amount)})]})]})]})]}),d.description&&r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Beschreibung"}),r.jsx("p",{className:"text-sm text-muted-foreground bg-gray-50 p-3 rounded-lg",children:d.description})]}),d.iban&&r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Zahlungsinformationen"}),r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"IBAN: "}),r.jsx("span",{className:"font-mono bg-gray-50 px-2 py-1 rounded",children:d.iban})]})]}),d.ocr_result_id&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[r.jsx(Z2,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-medium",children:"Diese Rechnung wurde über OCR erfasst"})]})}),r.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[d.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsxs(J,{onClick:()=>{j(d.id,"approved"),u(null)},className:"bg-blue-600 hover:bg-blue-700",children:[r.jsx(Lr,{className:"h-4 w-4 mr-2"}),"Genehmigen"]}),r.jsxs(J,{variant:"outline",onClick:()=>{j(d.id,"cancelled"),u(null)},className:"border-red-600 text-red-600 hover:bg-red-50",children:[r.jsx(Nl,{className:"h-4 w-4 mr-2"}),"Stornieren"]})]}),d.status==="approved"&&r.jsxs(J,{onClick:()=>{j(d.id,"paid"),u(null)},className:"bg-green-600 hover:bg-green-700",children:[r.jsx(Lr,{className:"h-4 w-4 mr-2"}),"Als bezahlt markieren"]}),r.jsx(J,{variant:"outline",onClick:()=>u(null),children:"Schließen"})]})]})]})})]})}function $te(){const[t,e]=g.useState(""),[n,s]=g.useState(!1),[a,i]=g.useState(!1),[o,c]=g.useState(null),{toast:d}=Rt(),{data:u,isLoading:m}=AZ(),{data:f,isLoading:p}=ZM(),{data:y,isLoading:j}=FZ(),{data:v,isLoading:_}=UZ(),b=or();PZ(),GM(),DZ();const w=(u==null?void 0:u.items)||[],N=(f==null?void 0:f.items)||[];y!=null&&y.items;const S=m||p||j,A=async(P,F,W)=>{var ee;try{d({title:"E-Mail versendet",description:`${P==="quote"?"Angebot":"Rechnung"} wurde erfolgreich an ${((ee=W.customer)==null?void 0:ee.email)||"den Kunden"} versendet.`})}catch{d({title:"Fehler beim Versenden",description:"Die E-Mail konnte nicht versendet werden.",variant:"destructive"})}},E=P=>{switch(P){case"Entwurf":return"secondary";case"Versendet":return"default";case"Angenommen":case"Bezahlt":return"default";case"Abgelehnt":case"Storniert":return"destructive";case"Überfällig":return"destructive";case"Abgelaufen":return"secondary";default:return"default"}},D=(P,F="EUR")=>new Intl.NumberFormat("de-DE",{style:"currency",currency:F}).format(P),M=P=>new Date(P).toLocaleDateString("de-DE"),B=w.filter(P=>P.title.toLowerCase().includes(t.toLowerCase())||P.quote_number.toLowerCase().includes(t.toLowerCase())||P.customer.company_name.toLowerCase().includes(t.toLowerCase())),R=N.filter(P=>P.title.toLowerCase().includes(t.toLowerCase())||P.invoice_number.toLowerCase().includes(t.toLowerCase())||P.customer.company_name.toLowerCase().includes(t.toLowerCase()));return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dokumente"}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs(J,{onClick:()=>s(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),r.jsxs(J,{onClick:()=>i(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Rechnung erstellen"]})]})]}),r.jsx(le,{className:"shadow-soft rounded-2xl overflow-hidden",children:r.jsx(ce,{className:"p-4",children:r.jsx("div",{className:"flex items-center space-x-2",children:r.jsxs("div",{className:"relative flex-1 max-w-sm",children:[r.jsx(Rd,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),r.jsx(ne,{placeholder:"Dokumente suchen...",value:t,onChange:P=>e(P.target.value),className:"pl-8 rounded-xl"})]})})})}),r.jsxs(zr,{defaultValue:"quotes",className:"space-y-4",children:[r.jsxs(Er,{children:[r.jsxs(Ge,{value:"quotes",className:"flex items-center gap-2",children:[r.jsx(On,{className:"h-4 w-4"}),"Angebote (",w.length,")"]}),r.jsxs(Ge,{value:"invoices",className:"flex items-center gap-2",children:[r.jsx(ms,{className:"h-4 w-4"}),"Rechnungen (",N.length,")"]}),r.jsxs(Ge,{value:"ocr",className:"flex items-center gap-2",children:[r.jsx(Ju,{className:"h-4 w-4"}),"OCR-Import ",v&&v.length>0&&r.jsx(Ve,{variant:"destructive",className:"ml-1 px-1.5 py-0.5 text-xs",children:v.length})]}),r.jsxs(Ge,{value:"templates",className:"flex items-center gap-2",children:[r.jsx(On,{className:"h-4 w-4"}),"Vorlagen"]})]}),r.jsx(Qe,{value:"quotes",className:"space-y-4",children:S?r.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((P,F)=>r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(lt,{className:"h-5 w-32"}),r.jsx(lt,{className:"h-6 w-20"})]}),r.jsx(lt,{className:"h-4 w-48 mb-2"}),r.jsx(lt,{className:"h-4 w-24"})]}),r.jsxs("div",{className:"text-right",children:[r.jsx(lt,{className:"h-6 w-20 mb-2"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(lt,{className:"h-8 w-16"}),r.jsx(lt,{className:"h-8 w-16"})]})]})]})})},F))}):B.length===0?r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsxs(ce,{className:"py-8 text-center",children:[r.jsx(On,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Angebote gefunden"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:t?"Keine Angebote entsprechen Ihren Suchkriterien.":"Erstellen Sie Ihr erstes Angebot."}),r.jsxs(J,{onClick:()=>s(!0),children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]})]})}):r.jsx("div",{className:"grid gap-4",children:B.map(P=>r.jsx(le,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h3",{className:"font-semibold",children:P.quote_number}),r.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${P.status==="Entwurf"?"bg-gray-100 text-gray-800":P.status==="Versendet"?"bg-blue-100 text-blue-800":P.status==="Angenommen"?"bg-green-100 text-green-800":P.status==="Abgelehnt"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:P.status})]}),r.jsx("h4",{className:"text-lg font-medium mb-1",children:P.title}),r.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[P.customer.company_name," • ",P.customer.contact_person]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsxs("span",{children:["Erstellt: ",M(P.quote_date)]}),P.valid_until&&r.jsxs("span",{children:["Gültig bis: ",M(P.valid_until)]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-xl font-bold mb-2",children:D(P.total_amount,P.currency)}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx(J,{variant:"ghost",size:"sm",title:"Ansehen",className:"rounded-xl",children:r.jsx(la,{className:"h-4 w-4"})}),r.jsx(J,{variant:"ghost",size:"sm",title:"Bearbeiten",className:"rounded-xl",children:r.jsx(Dl,{className:"h-4 w-4"})}),r.jsx(J,{variant:"ghost",size:"sm",className:"rounded-xl",title:"Per E-Mail versenden",onClick:()=>A("quote",P.id,P),disabled:!1,children:r.jsx(sr,{className:"h-4 w-4"})}),r.jsx(J,{variant:"ghost",size:"sm",title:"Herunterladen",className:"rounded-xl",children:r.jsx(v_,{className:"h-4 w-4"})}),r.jsx(Ite,{quote:P,onRefresh:()=>b.invalidateQueries({queryKey:["quotes"]})})]})]})]})})},P.id))})}),r.jsx(Qe,{value:"invoices",className:"space-y-4",children:r.jsxs(zr,{defaultValue:"customer",className:"space-y-4",children:[r.jsxs(Er,{children:[r.jsxs(Ge,{value:"customer",children:["Kundenrechnungen (",N.length,")"]}),r.jsx(Ge,{value:"supplier",children:"Lieferantenrechnungen"})]}),r.jsx(Qe,{value:"customer",className:"space-y-4",children:S?r.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((P,F)=>r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(lt,{className:"h-5 w-32"}),r.jsx(lt,{className:"h-6 w-20"})]}),r.jsx(lt,{className:"h-4 w-48 mb-2"}),r.jsx(lt,{className:"h-4 w-24"})]}),r.jsxs("div",{className:"text-right",children:[r.jsx(lt,{className:"h-6 w-20 mb-2"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(lt,{className:"h-8 w-16"}),r.jsx(lt,{className:"h-8 w-16"})]})]})]})})},F))}):R.length===0?r.jsx(le,{children:r.jsxs(ce,{className:"py-8 text-center",children:[r.jsx(ms,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Kundenrechnungen gefunden"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:t?"Keine Kundenrechnungen entsprechen Ihren Suchkriterien.":"Erstellen Sie Ihre erste Kundenrechnung."}),r.jsxs(J,{onClick:()=>i(!0),children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Kundenrechnung erstellen"]})]})}):r.jsx("div",{className:"grid gap-4",children:R.map(P=>r.jsx(le,{className:"hover:shadow-lg transition-shadow",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h3",{className:"font-semibold",children:P.invoice_number}),r.jsx(Ve,{variant:E(P.status),children:P.status})]}),r.jsx("h4",{className:"text-lg font-medium mb-1",children:P.title}),r.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[P.customer.company_name," • ",P.customer.contact_person]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsxs("span",{children:["Erstellt: ",M(P.invoice_date)]}),r.jsxs("span",{children:["Fällig: ",M(P.due_date)]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-xl font-bold mb-2",children:D(P.total_amount,P.currency)}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx(J,{variant:"ghost",size:"sm",title:"Ansehen",children:r.jsx(la,{className:"h-4 w-4"})}),r.jsx(J,{variant:"ghost",size:"sm",title:"Bearbeiten",children:r.jsx(Dl,{className:"h-4 w-4"})}),r.jsx(J,{variant:"ghost",size:"sm",title:"Per E-Mail versenden",onClick:()=>A("invoice",P.id,P),disabled:!1,children:r.jsx(sr,{className:"h-4 w-4"})}),r.jsx(J,{variant:"ghost",size:"sm",title:"Herunterladen",children:r.jsx(v_,{className:"h-4 w-4"})})]})]})]})})},P.id))})}),r.jsx(Qe,{value:"supplier",className:"space-y-4",children:r.jsx(zte,{})})]})}),r.jsx(Qe,{value:"ocr",className:"space-y-4",children:o?r.jsx(Bte,{ocrResult:o,onValidated:P=>{c(null),d({title:"Rechnung validiert",description:"Die Rechnungsdaten wurden erfolgreich validiert und können übernommen werden."}),console.log("Validated invoice data:",P)},onRejected:()=>{c(null),d({title:"OCR-Ergebnis abgelehnt",description:"Das OCR-Ergebnis wurde abgelehnt."})},onCancel:()=>c(null)}):r.jsxs("div",{className:"space-y-6",children:[r.jsx(Fte,{onOCRComplete:P=>{c(P)},onError:P=>{d({title:"OCR-Fehler",description:P,variant:"destructive"})}}),v&&v.length>0&&r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(Ju,{className:"h-5 w-5"}),"Ausstehende Validierungen (",v.length,")"]})}),r.jsx(ce,{children:r.jsx("div",{className:"space-y-4",children:v.map(P=>r.jsx(le,{className:"border-orange-200 bg-orange-50",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h4",{className:"font-medium",children:P.structured_data.supplierName}),r.jsx(Ve,{variant:"outline",className:"bg-orange-100 text-orange-800",children:"Ausstehend"}),r.jsxs(Ve,{variant:"outline",children:[Math.round(P.confidence_scores.overall*100),"% Konfidenz"]})]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsxs("span",{children:["Rechnung: ",P.structured_data.invoiceNumber]}),r.jsxs("span",{children:["Betrag: ",P.structured_data.totalAmount.toLocaleString("de-DE",{style:"currency",currency:"EUR"})]}),r.jsxs("span",{children:["Datum: ",new Date(P.structured_data.date).toLocaleDateString("de-DE")]}),r.jsxs("span",{children:["Verarbeitet: ",new Date(P.created_at).toLocaleString("de-DE")]})]})]}),r.jsx(J,{onClick:()=>c(P),size:"sm",children:"Validieren"})]})})},P.id))})})]}),r.jsx(le,{className:"bg-blue-50 border-blue-200",children:r.jsx(ce,{className:"p-6",children:r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(Ju,{className:"h-6 w-6 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Automatische Rechnungserfassung mit OCR"}),r.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[r.jsx("li",{children:"• Laden Sie Bilder oder PDFs von Lieferantenrechnungen hoch"}),r.jsx("li",{children:"• OCR erkennt automatisch Rechnungsnummer, Betrag, Lieferant und Datum"}),r.jsx("li",{children:"• Validieren Sie die erkannten Daten vor der Übernahme"}),r.jsx("li",{children:"• Rechnungen werden automatisch in Ihrem System angelegt"})]})]})]})})})]})}),r.jsx(Qe,{value:"templates",className:"space-y-4",children:r.jsx(le,{children:r.jsxs(ce,{className:"py-8 text-center",children:[r.jsx(On,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Vorlagen-Manager"}),r.jsx("p",{className:"text-muted-foreground",children:"Die Vorlagen-Funktionalität wird bald verfügbar sein."})]})})})]}),r.jsx(Mte,{open:n,onOpenChange:s}),r.jsx(Rte,{open:a,onOpenChange:i})]})}function Ute(){const{user:t,userProfile:e}=Di(),{toast:n}=Rt(),[s,a]=g.useState([]),[i,o]=g.useState(null),[c,d]=g.useState(!1),[u,m]=g.useState(!0),[f,p]=g.useState(""),[y,j]=g.useState(!1);g.useEffect(()=>{v()},[t,e]);const v=async()=>{if(!(!t||!(e!=null&&e.company_id)))try{m(!0);const{data:S,error:A}=await K.rpc("get_pending_invoice_validations",{manager_company_id:e.company_id});if(A)throw A;a(S||[])}catch(S){console.error("Error loading pending invoices:",S),n({title:"Fehler beim Laden",description:"Ausstehende Validierungen konnten nicht geladen werden.",variant:"destructive"})}finally{m(!1)}},_=async(S,A)=>{if(t)try{const{data:E,error:D}=await K.rpc("validate_receipt",{receipt_id:S,manager_id:t.id,action:A,reason:A==="reject"?f:null,validated_data:A==="validate"?{validated_by_manager:!0}:null});if(D)throw D;await v(),o(null),d(!1),j(!1),p(""),n({title:A==="validate"?"Rechnung genehmigt":"Rechnung abgelehnt",description:A==="validate"?"Die Rechnung wurde erfolgreich validiert und genehmigt.":"Die Rechnung wurde abgelehnt und der Mitarbeiter wurde benachrichtigt.",variant:A==="validate"?"default":"destructive"})}catch(E){console.error(`Error ${A}ing invoice:`,E),n({title:"Fehler",description:`Rechnung konnte nicht ${A==="validate"?"genehmigt":"abgelehnt"} werden.`,variant:"destructive"})}},b=S=>{switch(S){case"submitted":return r.jsx(Ve,{variant:"outline",className:"bg-blue-50 text-blue-700",children:"Eingereicht"});case"pending":return r.jsx(Ve,{variant:"outline",className:"bg-yellow-50 text-yellow-700",children:"In Bearbeitung"});case"validated":return r.jsx(Ve,{variant:"outline",className:"bg-green-50 text-green-700",children:"Genehmigt"});case"rejected":return r.jsx(Ve,{variant:"outline",className:"bg-red-50 text-red-700",children:"Abgelehnt"});default:return r.jsx(Ve,{variant:"outline",children:S})}},w=S=>S?S.toLocaleString("de-DE",{style:"currency",currency:"EUR"}):"-",N=S=>S.startsWith("data:")?S:`${K.storage.from("project-media").getPublicUrl(S).data.publicUrl}`;return u?r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(ms,{className:"h-5 w-5"}),"Rechnungsvalidierung"]})}),r.jsx(ce,{children:r.jsx("div",{className:"flex items-center justify-center h-32",children:r.jsxs("div",{className:"text-center",children:[r.jsx(hn,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-gray-400"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Lade ausstehende Validierungen..."})]})})})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(ms,{className:"h-5 w-5"}),"Rechnungsvalidierung"]}),r.jsx(Sr,{children:"Überprüfen und genehmigen Sie von Mitarbeitern eingereichte Rechnungen"})]}),r.jsxs(ce,{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{className:"text-sm text-gray-600",children:[s.length," ausstehende Validierungen"]}),r.jsx(J,{onClick:v,variant:"outline",size:"sm",children:"Aktualisieren"})]}),s.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(ms,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Keine ausstehenden Validierungen"}),r.jsx("p",{className:"text-gray-500",children:"Alle eingereichten Rechnungen wurden bereits bearbeitet."})]}):r.jsx("div",{className:"space-y-4",children:s.map(S=>r.jsx(le,{className:"border-l-4 border-l-blue-500",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h4",{className:"font-semibold",children:S.project_name}),b(S.validation_status)]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-3",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx($s,{className:"h-4 w-4"}),S.employee_name]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(zt,{className:"h-4 w-4"}),new Date(S.created_at).toLocaleDateString("de-DE")]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(hs,{className:"h-4 w-4"}),w(S.amount)]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(On,{className:"h-4 w-4"}),S.document_name]})]}),S.description&&r.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded mb-3",children:S.description})]}),r.jsx("div",{className:"flex flex-col gap-2 ml-4",children:r.jsxs(en,{children:[r.jsx(KG,{asChild:!0,children:r.jsxs(J,{variant:"outline",size:"sm",onClick:()=>o(S),children:[r.jsx(la,{className:"h-4 w-4 mr-2"}),"Prüfen"]})}),r.jsxs(Gt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx(rn,{children:r.jsxs(sn,{children:["Rechnungsvalidierung - ",S.project_name]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Original-Dokument"}),r.jsx("img",{src:N(S.file_url),alt:"Receipt",className:"w-full rounded border",style:{maxHeight:"400px",objectFit:"contain"}})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Details"}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Mitarbeiter:"}),r.jsx("span",{className:"font-medium",children:S.employee_name})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Projekt:"}),r.jsx("span",{className:"font-medium",children:S.project_name})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Betrag:"}),r.jsx("span",{className:"font-medium",children:w(S.amount)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Eingereicht:"}),r.jsx("span",{className:"font-medium",children:new Date(S.created_at).toLocaleString("de-DE")})]})]})]}),S.description&&r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Beschreibung"}),r.jsx("p",{className:"text-sm bg-gray-50 p-3 rounded",children:S.description})]}),S.ocr_result&&r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"OCR-Ergebnis"}),r.jsxs("div",{className:"text-sm bg-blue-50 p-3 rounded",children:[r.jsxs("div",{className:"flex justify-between mb-2",children:[r.jsx("span",{children:"Status:"}),r.jsx("span",{className:"font-medium",children:S.ocr_result.status})]}),S.ocr_result.confidence&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Vertrauen:"}),r.jsxs("span",{className:"font-medium",children:[Math.round(S.ocr_result.confidence*100),"%"]})]})]})]}),r.jsx(po,{}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(J,{onClick:()=>_(S.id,"validate"),className:"flex-1",children:[r.jsx(hf,{className:"h-4 w-4 mr-2"}),"Genehmigen"]}),r.jsxs(J,{variant:"outline",onClick:()=>{o(S),j(!0)},className:"flex-1 text-red-600 border-red-200 hover:bg-red-50",children:[r.jsx(ar,{className:"h-4 w-4 mr-2"}),"Ablehnen"]})]})]})]})]})]})})]})})},S.id))})]})]}),r.jsx(en,{open:y,onOpenChange:j,children:r.jsxs(Gt,{children:[r.jsx(rn,{children:r.jsxs(sn,{className:"flex items-center gap-2 text-red-600",children:[r.jsx(ar,{className:"h-5 w-5"}),"Rechnung ablehnen"]})}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Bitte geben Sie einen Grund für die Ablehnung an. Der Mitarbeiter wird über die Ablehnung und den Grund informiert."}),r.jsx(En,{placeholder:"Grund für die Ablehnung...",value:f,onChange:S=>p(S.target.value),rows:3}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx(J,{variant:"outline",onClick:()=>{j(!1),p("")},children:"Abbrechen"}),r.jsxs(J,{variant:"destructive",onClick:()=>i&&_(i.id,"reject"),disabled:!f.trim(),children:[r.jsx(ar,{className:"h-4 w-4 mr-2"}),"Ablehnen"]})]})]})]})})]})}function qte(){const{toast:t}=Rt(),[e,n]=g.useState(null),[s,a]=g.useState(!0),[i,o]=g.useState(!1),c=async()=>{try{console.log("Creating default settings...");const{data:{user:f}}=await K.auth.getUser();if(!f)throw new Error("Nicht angemeldet");const p={company_name:"Meine Firma",address:"",postal_code:"",city:"",country:"Deutschland",phone:"",email:"",website:"",tax_id:"",default_working_hours_start:"08:00",default_working_hours_end:"17:00",default_break_duration:60,default_hourly_rate:50,default_overtime_rate:62.5,default_currency:"EUR",default_tax_rate:19,default_vacation_days:25,invoice_prefix:"RE",quote_prefix:"AN",project_prefix:"PR",is_active:!0};console.log("Inserting default settings:",p);const{data:y,error:j}=await K.from("company_settings").insert(p).select().single();if(console.log("Insert result:",{data:y,error:j}),j)throw j;n(y),t({title:"Erfolg",description:"Standard-Einstellungen wurden erstellt."})}catch(f){const p=f instanceof Error?f.message:String(f);console.error("Error creating default settings:",f),t({title:"Fehler",description:`Standard-Einstellungen konnten nicht erstellt werden: ${p}`,variant:"destructive"})}},d=async()=>{try{console.log("Loading company settings...");const{data:{user:f},error:p}=await K.auth.getUser();if(console.log("Current user:",f),console.log("Auth error:",p),p||!f)throw new Error("Nicht angemeldet");const{data:y,error:j}=await K.from("company_settings").select("*").limit(1).maybeSingle();if(console.log("Load result:",{data:y,error:j}),j)throw console.error("Supabase error details:",j),j;y?n(y):(console.log("No settings found, creating default..."),await c())}catch(f){const p=f instanceof Error?f.message:String(f);console.error("Error loading settings:",f),t({title:"Fehler beim Laden",description:`Einstellungen konnten nicht geladen werden: ${p}`,variant:"destructive"})}finally{a(!1)}};g.useEffect(()=>{d()},[]);const u=async()=>{if(!(e!=null&&e.id)){t({title:"Fehler",description:"Keine gültige Einstellungs-ID gefunden.",variant:"destructive"});return}o(!0);try{console.log("Saving settings:",e);const{data:{user:f}}=await K.auth.getUser();if(!f)throw new Error("Nicht angemeldet");const p={company_name:e.company_name,company_address:e.company_address,company_city:e.company_city,company_postal_code:e.company_postal_code,company_country:e.company_country,company_phone:e.company_phone,company_email:e.company_email,tax_number:e.tax_number,vat_id:e.vat_id,website:e.website,default_working_hours_start:e.default_working_hours_start,default_working_hours_end:e.default_working_hours_end,default_break_duration:e.default_break_duration,default_hourly_rate:e.default_hourly_rate,default_overtime_rate:e.default_overtime_rate,default_currency:e.default_currency,default_tax_rate:e.default_tax_rate,default_vacation_days:e.default_vacation_days,invoice_prefix:e.invoice_prefix,quote_prefix:e.quote_prefix,project_prefix:e.project_prefix};console.log("Update data:",p),console.log("Settings ID:",e.id);const{data:y,error:j}=await K.from("company_settings").update(p).eq("id",e.id).select();if(console.log("Save result:",{data:y,error:j}),j)throw j;t({title:"Erfolgreich gespeichert",description:"Die Firmeneinstellungen wurden aktualisiert."})}catch(f){const p=f instanceof Error?f.message:String(f);console.error("Error saving settings:",f),t({title:"Fehler beim Speichern",description:`Einstellungen konnten nicht gespeichert werden: ${p}`,variant:"destructive"})}finally{o(!1)}},m=(f,p)=>{e&&n({...e,[f]:p})};return s?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-muted-foreground",children:"Lade Einstellungen..."})}):e?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-gray-600 bg-clip-text text-transparent flex items-center gap-3",children:[r.jsx(Eo,{className:"h-8 w-8 text-gray-600"}),"Firmeneinstellungen"]}),r.jsx("p",{className:"text-muted-foreground",children:"Verwalten Sie alle wichtigen Firmeninformationen"})]}),r.jsx(J,{onClick:u,disabled:i,children:i?"Speichere...":"Einstellungen speichern"})]}),r.jsxs("div",{className:"grid gap-6",children:[r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(fa,{className:"h-5 w-5"}),"Firmeninformationen"]}),r.jsx(Sr,{children:"Grundlegende Informationen über Ihr Unternehmen"})]}),r.jsxs(ce,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"company_name",children:"Firmenname"}),r.jsx(ne,{id:"company_name",value:e.company_name||"",onChange:f=>m("company_name",f.target.value),placeholder:"Ihr Firmenname"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"website",children:"Website"}),r.jsx(ne,{id:"website",value:e.website||"",onChange:f=>m("website",f.target.value),placeholder:"https://www.ihre-website.de"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"company_address",children:"Adresse"}),r.jsx(En,{id:"company_address",value:e.company_address||"",onChange:f=>m("company_address",f.target.value),placeholder:"Straße und Hausnummer",rows:2})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"company_postal_code",children:"Postleitzahl"}),r.jsx(ne,{id:"company_postal_code",value:e.company_postal_code||"",onChange:f=>m("company_postal_code",f.target.value),placeholder:"12345"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"company_city",children:"Stadt"}),r.jsx(ne,{id:"company_city",value:e.company_city||"",onChange:f=>m("company_city",f.target.value),placeholder:"Ihre Stadt"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"company_country",children:"Land"}),r.jsx(ne,{id:"company_country",value:e.company_country||"",onChange:f=>m("company_country",f.target.value),placeholder:"Deutschland"})]})]})]})]}),r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(sr,{className:"h-5 w-5"}),"Kontaktinformationen"]}),r.jsx(Sr,{children:"Wie Kunden Sie erreichen können"})]}),r.jsxs(ce,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"company_phone",children:"Telefon"}),r.jsx(ne,{id:"company_phone",value:e.company_phone||"",onChange:f=>m("company_phone",f.target.value),placeholder:"+49 123 456789"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"company_email",children:"E-Mail"}),r.jsx(ne,{id:"company_email",type:"email",value:e.company_email||"",onChange:f=>m("company_email",f.target.value),placeholder:"info@ihre-firma.de"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"tax_number",children:"Steuernummer"}),r.jsx(ne,{id:"tax_number",value:e.tax_number||"",onChange:f=>m("tax_number",f.target.value),placeholder:"123/456/78901"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"vat_id",children:"USt-IdNr."}),r.jsx(ne,{id:"vat_id",value:e.vat_id||"",onChange:f=>m("vat_id",f.target.value),placeholder:"DE123456789"})]})]})]})]}),r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(hn,{className:"h-5 w-5"}),"Arbeitszeiten"]}),r.jsx(Sr,{children:"Standard-Arbeitszeiten für Berechnungen und Zeiterfassung"})]}),r.jsx(ce,{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"default_working_hours_start",children:"Arbeitsbeginn"}),r.jsx(ne,{id:"default_working_hours_start",type:"time",value:e.default_working_hours_start||"08:00",onChange:f=>m("default_working_hours_start",f.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"default_working_hours_end",children:"Arbeitsende"}),r.jsx(ne,{id:"default_working_hours_end",type:"time",value:e.default_working_hours_end||"17:00",onChange:f=>m("default_working_hours_end",f.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"default_break_duration",children:"Pausendauer (Min.)"}),r.jsx(ne,{id:"default_break_duration",type:"number",value:e.default_break_duration||60,onChange:f=>m("default_break_duration",Number(f.target.value)),placeholder:"60"})]})]})})]}),r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(Fb,{className:"h-5 w-5"}),"Finanzeinstellungen"]}),r.jsx(Sr,{children:"Standard-Werte für Preise und Steuern"})]}),r.jsxs(ce,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"default_hourly_rate",children:"Standard-Stundensatz (€)"}),r.jsx(ne,{id:"default_hourly_rate",type:"number",step:"0.50",value:e.default_hourly_rate||"",onChange:f=>m("default_hourly_rate",Number(f.target.value)),placeholder:"50.00"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"default_overtime_rate",children:"Überstunden-Satz (€)"}),r.jsx(ne,{id:"default_overtime_rate",type:"number",step:"0.50",value:e.default_overtime_rate||"",onChange:f=>m("default_overtime_rate",Number(f.target.value)),placeholder:"62.50"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"default_currency",children:"Währung"}),r.jsx(ne,{id:"default_currency",value:e.default_currency||"EUR",onChange:f=>m("default_currency",f.target.value),placeholder:"EUR"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"default_tax_rate",children:"Steuersatz (%)"}),r.jsx(ne,{id:"default_tax_rate",type:"number",step:"0.1",value:e.default_tax_rate||"",onChange:f=>m("default_tax_rate",Number(f.target.value)),placeholder:"19.0"})]})]})]})]}),r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(zt,{className:"h-5 w-5"}),"Urlaubseinstellungen"]}),r.jsx(Sr,{children:"Standard-Urlaubstage für neue Mitarbeiter"})]}),r.jsx(ce,{className:"space-y-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"default_vacation_days",children:"Standard Urlaubstage pro Jahr"}),r.jsx(ne,{id:"default_vacation_days",type:"number",min:"0",max:"50",value:e.default_vacation_days||25,onChange:f=>m("default_vacation_days",Number(f.target.value)),placeholder:"25"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Diese Anzahl wird automatisch jedem neuen Mitarbeiter bei der Erstellung zugewiesen"})]})})]}),r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(On,{className:"h-5 w-5"}),"Dokumenteinstellungen"]}),r.jsx(Sr,{children:"Präfixe für automatische Nummerierung"})]}),r.jsx(ce,{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"invoice_prefix",children:"Rechnungs-Präfix"}),r.jsx(ne,{id:"invoice_prefix",value:e.invoice_prefix||"",onChange:f=>m("invoice_prefix",f.target.value),placeholder:"RE"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"quote_prefix",children:"Angebots-Präfix"}),r.jsx(ne,{id:"quote_prefix",value:e.quote_prefix||"",onChange:f=>m("quote_prefix",f.target.value),placeholder:"AN"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"project_prefix",children:"Projekt-Präfix"}),r.jsx(ne,{id:"project_prefix",value:e.project_prefix||"",onChange:f=>m("project_prefix",f.target.value),placeholder:"PR"})]})]})})]})]})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[r.jsx("div",{className:"text-muted-foreground",children:"Keine Einstellungen gefunden"}),r.jsx(J,{onClick:c,children:"Standard-Einstellungen erstellen"})]})}function Wte(t,e){return g.useReducer((n,s)=>e[n][s]??n,t)}var v1="ScrollArea",[pI,xae]=Ss(v1),[Hte,Us]=pI(v1),gI=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:s="hover",dir:a,scrollHideDelay:i=600,...o}=t,[c,d]=g.useState(null),[u,m]=g.useState(null),[f,p]=g.useState(null),[y,j]=g.useState(null),[v,_]=g.useState(null),[b,w]=g.useState(0),[N,S]=g.useState(0),[A,E]=g.useState(!1),[D,M]=g.useState(!1),B=Mt(e,P=>d(P)),R=Wd(a);return r.jsx(Hte,{scope:n,type:s,dir:R,scrollHideDelay:i,scrollArea:c,viewport:u,onViewportChange:m,content:f,onContentChange:p,scrollbarX:y,onScrollbarXChange:j,scrollbarXEnabled:A,onScrollbarXEnabledChange:E,scrollbarY:v,onScrollbarYChange:_,scrollbarYEnabled:D,onScrollbarYEnabledChange:M,onCornerWidthChange:w,onCornerHeightChange:S,children:r.jsx(Xe.div,{dir:R,...o,ref:B,style:{position:"relative","--radix-scroll-area-corner-width":b+"px","--radix-scroll-area-corner-height":N+"px",...t.style}})})});gI.displayName=v1;var xI="ScrollAreaViewport",vI=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:s,asChild:a,nonce:i,...o}=t,c=Us(xI,n),d=g.useRef(null),u=Mt(e,d,c.onViewportChange);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:i}),r.jsx(Xe.div,{"data-radix-scroll-area-viewport":"",...o,asChild:a,ref:u,style:{overflowX:c.scrollbarXEnabled?"scroll":"hidden",overflowY:c.scrollbarYEnabled?"scroll":"hidden",...t.style},children:tne({asChild:a,children:s},m=>r.jsx("div",{"data-radix-scroll-area-content":"",ref:c.onContentChange,style:{minWidth:c.scrollbarXEnabled?"fit-content":void 0},children:m}))})]})});vI.displayName=xI;var Xa="ScrollAreaScrollbar",y1=g.forwardRef((t,e)=>{const{forceMount:n,...s}=t,a=Us(Xa,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,c=t.orientation==="horizontal";return g.useEffect(()=>(c?i(!0):o(!0),()=>{c?i(!1):o(!1)}),[c,i,o]),a.type==="hover"?r.jsx(Vte,{...s,ref:e,forceMount:n}):a.type==="scroll"?r.jsx(Kte,{...s,ref:e,forceMount:n}):a.type==="auto"?r.jsx(yI,{...s,ref:e,forceMount:n}):a.type==="always"?r.jsx(_1,{...s,ref:e}):null});y1.displayName=Xa;var Vte=g.forwardRef((t,e)=>{const{forceMount:n,...s}=t,a=Us(Xa,t.__scopeScrollArea),[i,o]=g.useState(!1);return g.useEffect(()=>{const c=a.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),o(!0)},m=()=>{d=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",m),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",m)}}},[a.scrollArea,a.scrollHideDelay]),r.jsx(Jn,{present:n||i,children:r.jsx(yI,{"data-state":i?"visible":"hidden",...s,ref:e})})}),Kte=g.forwardRef((t,e)=>{const{forceMount:n,...s}=t,a=Us(Xa,t.__scopeScrollArea),i=t.orientation==="horizontal",o=zg(()=>d("SCROLL_END"),100),[c,d]=Wte("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return g.useEffect(()=>{if(c==="idle"){const u=window.setTimeout(()=>d("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(u)}},[c,a.scrollHideDelay,d]),g.useEffect(()=>{const u=a.viewport,m=i?"scrollLeft":"scrollTop";if(u){let f=u[m];const p=()=>{const y=u[m];f!==y&&(d("SCROLL"),o()),f=y};return u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)}},[a.viewport,i,d,o]),r.jsx(Jn,{present:n||c!=="hidden",children:r.jsx(_1,{"data-state":c==="hidden"?"hidden":"visible",...s,ref:e,onPointerEnter:Te(t.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Te(t.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),yI=g.forwardRef((t,e)=>{const n=Us(Xa,t.__scopeScrollArea),{forceMount:s,...a}=t,[i,o]=g.useState(!1),c=t.orientation==="horizontal",d=zg(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,m=n.viewport.offsetHeight<n.viewport.scrollHeight;o(c?u:m)}},10);return Ed(n.viewport,d),Ed(n.content,d),r.jsx(Jn,{present:s||i,children:r.jsx(_1,{"data-state":i?"visible":"hidden",...a,ref:e})})}),_1=g.forwardRef((t,e)=>{const{orientation:n="vertical",...s}=t,a=Us(Xa,t.__scopeScrollArea),i=g.useRef(null),o=g.useRef(0),[c,d]=g.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=NI(c.viewport,c.content),m={...s,sizes:c,onSizesChange:d,hasThumb:u>0&&u<1,onThumbChange:p=>i.current=p,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:p=>o.current=p};function f(p,y){return Jte(p,o.current,c,y)}return n==="horizontal"?r.jsx(Zte,{...m,ref:e,onThumbPositionChange:()=>{if(a.viewport&&i.current){const p=a.viewport.scrollLeft,y=zC(p,c,a.dir);i.current.style.transform=`translate3d(${y}px, 0, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollLeft=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollLeft=f(p,a.dir))}}):n==="vertical"?r.jsx(Gte,{...m,ref:e,onThumbPositionChange:()=>{if(a.viewport&&i.current){const p=a.viewport.scrollTop,y=zC(p,c);i.current.style.transform=`translate3d(0, ${y}px, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollTop=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollTop=f(p))}}):null}),Zte=g.forwardRef((t,e)=>{const{sizes:n,onSizesChange:s,...a}=t,i=Us(Xa,t.__scopeScrollArea),[o,c]=g.useState(),d=g.useRef(null),u=Mt(e,d,i.onScrollbarXChange);return g.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),r.jsx(wI,{"data-orientation":"horizontal",...a,ref:u,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Bg(n)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.x),onDragScroll:m=>t.onDragScroll(m.x),onWheelScroll:(m,f)=>{if(i.viewport){const p=i.viewport.scrollLeft+m.deltaX;t.onWheelScroll(p),kI(p,f)&&m.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&s({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:E0(o.paddingLeft),paddingEnd:E0(o.paddingRight)}})}})}),Gte=g.forwardRef((t,e)=>{const{sizes:n,onSizesChange:s,...a}=t,i=Us(Xa,t.__scopeScrollArea),[o,c]=g.useState(),d=g.useRef(null),u=Mt(e,d,i.onScrollbarYChange);return g.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),r.jsx(wI,{"data-orientation":"vertical",...a,ref:u,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Bg(n)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.y),onDragScroll:m=>t.onDragScroll(m.y),onWheelScroll:(m,f)=>{if(i.viewport){const p=i.viewport.scrollTop+m.deltaY;t.onWheelScroll(p),kI(p,f)&&m.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&s({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:E0(o.paddingTop),paddingEnd:E0(o.paddingBottom)}})}})}),[Qte,_I]=pI(Xa),wI=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:s,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:m,onResize:f,...p}=t,y=Us(Xa,n),[j,v]=g.useState(null),_=Mt(e,B=>v(B)),b=g.useRef(null),w=g.useRef(""),N=y.viewport,S=s.content-s.viewport,A=jn(m),E=jn(d),D=zg(f,10);function M(B){if(b.current){const R=B.clientX-b.current.left,P=B.clientY-b.current.top;u({x:R,y:P})}}return g.useEffect(()=>{const B=R=>{const P=R.target;(j==null?void 0:j.contains(P))&&A(R,S)};return document.addEventListener("wheel",B,{passive:!1}),()=>document.removeEventListener("wheel",B,{passive:!1})},[N,j,S,A]),g.useEffect(E,[s,E]),Ed(j,D),Ed(y.content,D),r.jsx(Qte,{scope:n,scrollbar:j,hasThumb:a,onThumbChange:jn(i),onThumbPointerUp:jn(o),onThumbPositionChange:E,onThumbPointerDown:jn(c),children:r.jsx(Xe.div,{...p,ref:_,style:{position:"absolute",...p.style},onPointerDown:Te(t.onPointerDown,B=>{B.button===0&&(B.target.setPointerCapture(B.pointerId),b.current=j.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",y.viewport&&(y.viewport.style.scrollBehavior="auto"),M(B))}),onPointerMove:Te(t.onPointerMove,M),onPointerUp:Te(t.onPointerUp,B=>{const R=B.target;R.hasPointerCapture(B.pointerId)&&R.releasePointerCapture(B.pointerId),document.body.style.webkitUserSelect=w.current,y.viewport&&(y.viewport.style.scrollBehavior=""),b.current=null})})})}),C0="ScrollAreaThumb",bI=g.forwardRef((t,e)=>{const{forceMount:n,...s}=t,a=_I(C0,t.__scopeScrollArea);return r.jsx(Jn,{present:n||a.hasThumb,children:r.jsx(Yte,{ref:e,...s})})}),Yte=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:s,...a}=t,i=Us(C0,n),o=_I(C0,n),{onThumbPositionChange:c}=o,d=Mt(e,f=>o.onThumbChange(f)),u=g.useRef(),m=zg(()=>{u.current&&(u.current(),u.current=void 0)},100);return g.useEffect(()=>{const f=i.viewport;if(f){const p=()=>{if(m(),!u.current){const y=ene(f,c);u.current=y,c()}};return c(),f.addEventListener("scroll",p),()=>f.removeEventListener("scroll",p)}},[i.viewport,m,c]),r.jsx(Xe.div,{"data-state":o.hasThumb?"visible":"hidden",...a,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:Te(t.onPointerDownCapture,f=>{const y=f.target.getBoundingClientRect(),j=f.clientX-y.left,v=f.clientY-y.top;o.onThumbPointerDown({x:j,y:v})}),onPointerUp:Te(t.onPointerUp,o.onThumbPointerUp)})});bI.displayName=C0;var w1="ScrollAreaCorner",jI=g.forwardRef((t,e)=>{const n=Us(w1,t.__scopeScrollArea),s=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&s?r.jsx(Xte,{...t,ref:e}):null});jI.displayName=w1;var Xte=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,...s}=t,a=Us(w1,n),[i,o]=g.useState(0),[c,d]=g.useState(0),u=!!(i&&c);return Ed(a.scrollbarX,()=>{var f;const m=((f=a.scrollbarX)==null?void 0:f.offsetHeight)||0;a.onCornerHeightChange(m),d(m)}),Ed(a.scrollbarY,()=>{var f;const m=((f=a.scrollbarY)==null?void 0:f.offsetWidth)||0;a.onCornerWidthChange(m),o(m)}),u?r.jsx(Xe.div,{...s,ref:e,style:{width:i,height:c,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function E0(t){return t?parseInt(t,10):0}function NI(t,e){const n=t/e;return isNaN(n)?0:n}function Bg(t){const e=NI(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=(t.scrollbar.size-n)*e;return Math.max(s,18)}function Jte(t,e,n,s="ltr"){const a=Bg(n),i=a/2,o=e||i,c=a-o,d=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-c,m=n.content-n.viewport,f=s==="ltr"?[0,m]:[m*-1,0];return SI([d,u],f)(t)}function zC(t,e,n="ltr"){const s=Bg(e),a=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-a,o=e.content-e.viewport,c=i-s,d=n==="ltr"?[0,o]:[o*-1,0],u=bw(t,d);return SI([0,o],[0,c])(u)}function SI(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const s=(e[1]-e[0])/(t[1]-t[0]);return e[0]+s*(n-t[0])}}function kI(t,e){return t>0&&t<e}var ene=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},s=0;return function a(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,c=n.top!==i.top;(o||c)&&e(),n=i,s=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(s)};function zg(t,e){const n=jn(t),s=g.useRef(0);return g.useEffect(()=>()=>window.clearTimeout(s.current),[]),g.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(n,e)},[n,e])}function Ed(t,e){const n=jn(e);Un(()=>{let s=0;if(t){const a=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(n)});return a.observe(t),()=>{window.cancelAnimationFrame(s),a.unobserve(t)}}},[t,n])}function tne(t,e){const{asChild:n,children:s}=t;if(!n)return typeof e=="function"?e(s):e;const a=g.Children.only(s);return g.cloneElement(a,{children:typeof e=="function"?e(a.props.children):e})}var CI=gI,nne=vI,rne=jI;const Tw=g.forwardRef(({className:t,children:e,...n},s)=>r.jsxs(CI,{ref:s,className:Oe("relative overflow-hidden",t),...n,children:[r.jsx(nne,{className:"h-full w-full rounded-[inherit]",children:e}),r.jsx(EI,{}),r.jsx(rne,{})]}));Tw.displayName=CI.displayName;const EI=g.forwardRef(({className:t,orientation:e="vertical",...n},s)=>r.jsx(y1,{ref:s,orientation:e,className:Oe("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:r.jsx(bI,{className:"relative flex-1 rounded-full bg-border"})}));EI.displayName=y1.displayName;const sne=()=>{var ie,pe;const{toast:t}=Rt(),[e,n]=g.useState([]),[s,a]=g.useState([]),[i,o]=g.useState(null),[c,d]=g.useState([]),[u,m]=g.useState("inbox"),[f,p]=g.useState(""),[y,j]=g.useState(!1),[v,_]=g.useState(""),[b,w]=g.useState(!1),[N,S]=g.useState(!1),[A,E]=g.useState(!1),D=G=>{try{return new Date(G).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}catch{return"00:00"}},M=G=>{try{return new Date(G).toLocaleDateString("de-DE")}catch{return"01.01.2024"}},B=G=>{try{const se=new Date(G);return se.toLocaleDateString("de-DE")+" "+se.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}catch{return"01.01.2024 00:00"}},R={mail:sr,"shopping-cart":JF,"message-square":Bb,receipt:ms,"help-circle":OF,newspaper:ZF};g.useEffect(()=>{F(),W(),P()},[]),g.useEffect(()=>{if(v)return ee(),ue()},[v]);const P=async()=>{try{const{data:{user:G}}=await K.auth.getUser();if(!G){E(!1);return}console.log("Checking Gmail connection for user:",G.id);const{data:se,error:me}=await K.from("user_email_connections").select("*").eq("user_id",G.id).eq("provider","gmail").eq("is_active",!0);console.log("Gmail connections query result:",{connections:se,error:me}),!me&&se&&se.length>0?(E(!0),console.log("Gmail connection found:",se[0])):(console.log("No active Gmail connection found, but enabling sync for testing"),E(!0))}catch(G){console.error("Error checking Gmail connection:",G),E(!0)}},F=async()=>{try{const{data:{user:G}}=await K.auth.getUser();if(!G)return;const{data:se}=await K.from("profiles").select("company_email").eq("id",G.id).single();se!=null&&se.company_email&&_(se.company_email)}catch(G){console.error("Error fetching company email:",G)}},W=async()=>{try{const{data:G,error:se}=await K.from("email_categories").select("*").order("name");a(!se&&G?G:[{id:"orders",name:"Bestellungen",color:"#10b981",icon:"shopping-cart"},{id:"inquiries",name:"Anfragen",color:"#3b82f6",icon:"message-square"},{id:"invoices",name:"Rechnungen",color:"#f59e0b",icon:"receipt"},{id:"support",name:"Support",color:"#ef4444",icon:"help-circle"},{id:"newsletter",name:"Newsletter",color:"#8b5cf6",icon:"newspaper"}])}catch(G){console.error("Error fetching categories:",G)}},ee=g.useCallback(async()=>{try{const{data:{user:G}}=await K.auth.getUser();if(G){const{data:se}=await K.from("profiles").select("company_id").eq("id",G.id).single();if(se!=null&&se.company_id){const{data:me,error:he}=await K.from("emails").select(`
              *,
              email_categories (name, color, icon),
              customers (company_name, contact_person, phone, website)
            `).eq("company_id",se.company_id).order("received_at",{ascending:!1}).limit(50);if(!he&&me){console.log(`Loaded ${me.length} real emails from database`);const xe=me.map(re=>({...re,reply_count:me.filter(_e=>_e.thread_id===re.thread_id).length-1}));n(xe);return}else console.error("Error loading emails from database:",he)}}}catch(G){console.error("Error fetching emails:",G)}console.log("No emails in database - user needs to sync Gmail first"),n([])},[]),ue=g.useCallback(()=>{const G=K.channel("emails-modern").on("postgres_changes",{event:"INSERT",schema:"public",table:"emails",filter:`recipient_email=eq.${v}`},se=>{const me=se.new;n(he=>[me,...he]),t({title:"📧 Neue E-Mail",description:`Von: ${me.sender_name||me.sender_email}`,action:r.jsx(J,{size:"sm",onClick:()=>o(me),children:"Anzeigen"})})}).subscribe();return()=>K.removeChannel(G)},[v,t]),de=G=>{o(G),G.is_read||Q([G.id],!0)},Q=async(G,se)=>{const{error:me}=await K.from("emails").update({is_read:se}).in("id",G);me||n(he=>he.map(xe=>G.includes(xe.id)?{...xe,is_read:se}:xe))},z=async G=>{const se=e.find(he=>he.id===G);if(!se)return;const{error:me}=await K.from("emails").update({is_starred:!se.is_starred}).eq("id",G);me||n(he=>he.map(xe=>xe.id===G?{...xe,is_starred:!se.is_starred}:xe))},V=async G=>{const{error:se}=await K.from("emails").update({is_archived:!0}).in("id",G);se||(n(me=>me.filter(he=>!G.includes(he.id))),d([]),t({title:"E-Mails archiviert",description:`${G.length} E-Mail(s) wurden archiviert.`}))},U=G=>{switch(G){case"mark-read":Q(c,!0);break;case"mark-unread":Q(c,!1);break;case"archive":V(c);break;case"star":c.forEach(se=>z(se));break}},O=async G=>{try{const{data:{user:se}}=await K.auth.getUser();if(!se)return;const{data:me}=await K.from("profiles").select("company_id").eq("id",se.id).single();if(!(me!=null&&me.company_id))return;let he=null;if(G.customers){const{data:xe}=await K.from("customers").select("id").eq("email",G.sender_email).eq("company_id",me.company_id).single();if(xe)he=xe.id;else{const{data:re}=await K.from("customers").insert({company_id:me.company_id,email:G.sender_email,company_name:G.customers.company_name,contact_person:G.customers.contact_person}).select().single();re&&(he=re.id)}}if(he){const{data:xe,error:re}=await K.from("quotes").insert({quote_number:`AG-${Date.now().toString().slice(-6)}`,company_id:me.company_id,customer_id:he,title:`Angebot bezüglich: ${G.subject}`,description:`Automatisch erstellt aus E-Mail vom ${M(G.received_at)}`,quote_date:new Date().toISOString().split("T")[0],valid_until:new Date(Date.now()+2592e6).toISOString().split("T")[0],status:"entwurf",total_amount:0,currency:"EUR"}).select().single();xe&&t({title:"Angebot erstellt",description:`Angebot ${xe.quote_number} wurde aus E-Mail erstellt.`})}}catch{t({title:"Fehler beim Erstellen",description:"Angebot konnte nicht erstellt werden.",variant:"destructive"})}},I=async G=>{try{const{data:{user:se}}=await K.auth.getUser();if(!se)return;const{data:me}=await K.from("profiles").select("company_id").eq("id",se.id).single();if(!(me!=null&&me.company_id))return;let he=null;if(G.customers){const{data:xe}=await K.from("customers").select("id").eq("email",G.sender_email).eq("company_id",me.company_id).single();xe&&(he=xe.id)}if(he){const{data:xe,error:re}=await K.from("projects").insert({name:G.subject||"Projekt aus E-Mail",customer_id:he,company_id:me.company_id,status:"anfrage",start_date:new Date().toISOString().split("T")[0],description:`Automatisch erstellt aus E-Mail vom ${B(G.received_at)}.

Inhalt der E-Mail:
${G.content.replace(/<[^>]*>/g,"")}`,budget:0}).select().single();xe&&t({title:"Projekt erstellt",description:`Projekt "${xe.name}" wurde aus E-Mail erstellt.`})}}catch{t({title:"Fehler beim Erstellen",description:"Projekt konnte nicht erstellt werden.",variant:"destructive"})}},H=e.filter(G=>{var he,xe;const se=u==="inbox"?!G.is_archived:u==="starred"?G.is_starred:u==="unread"?!G.is_read:((he=G.email_categories)==null?void 0:he.name)===u,me=!f||G.subject.toLowerCase().includes(f.toLowerCase())||((xe=G.sender_name)==null?void 0:xe.toLowerCase().includes(f.toLowerCase()))||G.sender_email.toLowerCase().includes(f.toLowerCase())||G.content.toLowerCase().includes(f.toLowerCase());return se&&me}),$=G=>{switch(G){case"urgent":return r.jsx(X0,{className:"h-3 w-3 text-red-500"});case"high":return r.jsx(Lb,{className:"h-3 w-3 text-orange-500"});default:return null}},te=async()=>{try{const{data:{user:G}}=await K.auth.getUser();if(!G){t({title:"Fehler",description:"Sie müssen angemeldet sein, um Gmail zu verbinden.",variant:"destructive"});return}const{data:se,error:me}=await K.functions.invoke("initiate-gmail-oauth",{body:{user_id:G.id}});if(se!=null&&se.authUrl){window.open(se.authUrl,"_blank","width=500,height=600"),t({title:"Gmail-Verbindung",description:"Ein neues Fenster wurde geöffnet. Bitte autorisieren Sie den Zugriff auf Gmail."});let he=0;const xe=setInterval(async()=>{he++,await P(),(A||he>=15)&&(clearInterval(xe),A&&t({title:"Gmail verbunden!",description:"Sie können jetzt E-Mails synchronisieren."}))},2e3)}else t({title:"Fehler",description:(me==null?void 0:me.message)||"Gmail-Verbindung konnte nicht gestartet werden.",variant:"destructive"})}catch(G){console.error("Gmail OAuth error:",G),t({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten.",variant:"destructive"})}},X=async()=>{var G,se;try{console.log("Starting AI analysis for emails...");const me=e.filter(he=>!he.ai_category&&!he.ai_summary);if(me.length===0){console.log("No emails need AI analysis");return}console.log(`Analyzing ${me.length} emails with AI...`);for(const he of me.slice(0,5))try{const{data:xe,error:re}=await K.functions.invoke("classify-email",{body:JSON.stringify({emailId:he.id,subject:he.subject,content:he.content,senderEmail:he.sender_email,senderName:he.sender_name})});if(xe&&!re){console.log(`AI analysis result for email ${he.id}:`,xe);const _e={...he,ai_category:xe.category,ai_summary:xe.summary,ai_confidence:xe.confidence,priority:((G=xe.extractedData)==null?void 0:G.priority)||"normal"};n(be=>be.map(Be=>Be.id===he.id?_e:Be)),await K.from("emails").update({ai_category:xe.category,ai_summary:xe.summary,ai_confidence:xe.confidence,priority:((se=xe.extractedData)==null?void 0:se.priority)||"normal",processing_status:"completed"}).eq("id",he.id)}}catch(xe){console.error(`AI analysis failed for email ${he.id}:`,xe)}t({title:"KI-Analyse abgeschlossen",description:`${me.length} E-Mails wurden analysiert.`}),await ee()}catch(me){console.error("AI analysis error:",me),t({title:"KI-Analyse Fehler",description:"Die KI-Analyse konnte nicht durchgeführt werden.",variant:"destructive"})}},Z=async()=>{try{j(!0);const{data:{user:G}}=await K.auth.getUser();if(!G){t({title:"Fehler",description:"Sie müssen angemeldet sein, um E-Mails zu synchronisieren.",variant:"destructive"}),j(!1);return}console.log("Starting Gmail sync for user:",G.id);const se=new Promise((_e,be)=>setTimeout(()=>be(new Error("Sync timeout after 30 seconds")),3e4)),me=K.functions.invoke("sync-gmail-emails",{body:JSON.stringify({manual:!0,forceFullSync:!1}),headers:{"Content-Type":"application/json"}}),he=await Promise.race([me,se]),{data:xe,error:re}=he;console.log("Gmail sync response:",{data:xe,error:re}),xe!=null&&xe.success?(await ee(),t({title:"Synchronisation erfolgreich",description:`${xe.synced_count||xe.totalSynced||0} neue E-Mails synchronisiert.`}),await X()):(console.error("Gmail sync failed:",re),t({title:"Synchronisationsfehler",description:(re==null?void 0:re.message)||(xe==null?void 0:xe.error)||"E-Mails konnten nicht synchronisiert werden.",variant:"destructive"}))}catch(G){console.error("Gmail sync error:",G),t({title:"Fehler",description:`Synchronisation fehlgeschlagen: ${G.message}`,variant:"destructive"})}finally{j(!1)}};return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"E-Mail Verwaltung"}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs(J,{variant:A?"default":"outline",onClick:te,className:"rounded-full",children:[r.jsx(sr,{className:"h-4 w-4 mr-2"}),A?"Gmail verbunden":"Gmail verbinden"]}),r.jsxs(J,{variant:"outline",onClick:Z,disabled:y||!A,className:"rounded-full",children:[r.jsx(VA,{className:`h-4 w-4 mr-2 ${y?"animate-spin":""}`}),"Synchronisieren"]}),r.jsxs(J,{onClick:()=>S(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Neue E-Mail"]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Ungelesen"}),r.jsx("p",{className:"text-2xl font-bold",children:e.filter(G=>!G.is_read).length})]}),r.jsx(sr,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Markiert"}),r.jsx("p",{className:"text-2xl font-bold",children:e.filter(G=>G.is_starred).length})]}),r.jsx(pu,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Heute"}),r.jsx("p",{className:"text-2xl font-bold",children:e.filter(G=>{try{return new Date(G.received_at).toDateString()===new Date().toDateString()}catch{return!1}}).length})]}),r.jsx(zt,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),r.jsx(le,{className:"shadow-soft rounded-2xl",children:r.jsx(ce,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"KI-Kategorien"}),r.jsx("p",{className:"text-2xl font-bold",children:e.filter(G=>G.ai_category).length})]}),r.jsx(ym,{className:"h-8 w-8 text-purple-500 opacity-50"})]})})})]}),r.jsx(le,{className:"shadow-soft rounded-2xl flex-1",style:{minHeight:"calc(100vh - 280px)"},children:r.jsx(ce,{className:"p-0",children:r.jsxs("div",{className:"flex",style:{height:"calc(100vh - 280px)"},children:[r.jsxs("div",{className:`${b?"w-16":"w-64"} border-r bg-muted/30 transition-all duration-200`,children:[r.jsxs("div",{className:"p-4 border-b",children:[r.jsx(J,{size:"sm",variant:"ghost",onClick:()=>w(!b),className:"mb-4",children:b?r.jsx(jl,{className:"h-4 w-4"}):r.jsx(Xu,{className:"h-4 w-4"})}),!b&&r.jsxs("div",{className:"relative",children:[r.jsx(Rd,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(ne,{placeholder:"E-Mails suchen...",value:f,onChange:G=>p(G.target.value),className:"pl-9 rounded-xl"})]})]}),r.jsxs("nav",{className:"flex-1 px-4 space-y-1",children:[r.jsxs(J,{variant:u==="inbox"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m("inbox"),children:[r.jsx(sr,{className:"h-4 w-4 mr-2"}),!b&&r.jsxs(r.Fragment,{children:["Posteingang",r.jsx(Ve,{variant:"secondary",className:"ml-auto",children:e.filter(G=>!G.is_archived).length})]})]}),r.jsxs(J,{variant:u==="starred"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m("starred"),children:[r.jsx(pu,{className:"h-4 w-4 mr-2"}),!b&&r.jsxs(r.Fragment,{children:["Markiert",r.jsx(Ve,{variant:"secondary",className:"ml-auto",children:e.filter(G=>G.is_starred).length})]})]}),r.jsxs(J,{variant:u==="unread"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m("unread"),children:[r.jsx(la,{className:"h-4 w-4 mr-2"}),!b&&r.jsxs(r.Fragment,{children:["Ungelesen",r.jsx(Ve,{variant:"secondary",className:"ml-auto",children:e.filter(G=>!G.is_read).length})]})]}),!b&&r.jsx(po,{className:"my-4"}),s.map(G=>{const se=R[G.icon]||sr,me=e.filter(he=>{var xe;return((xe=he.email_categories)==null?void 0:xe.name)===G.name}).length;return r.jsxs(J,{variant:u===G.name?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m(G.name),children:[r.jsx(se,{className:"h-4 w-4 mr-2",style:{color:G.color}}),!b&&r.jsxs(r.Fragment,{children:[G.name,r.jsx(Ve,{variant:"secondary",className:"ml-auto",children:me})]})]},G.id)})]}),!b&&r.jsx("div",{className:"p-4 border-t",children:r.jsxs(J,{variant:"outline",className:"w-full rounded-xl",onClick:X,children:[r.jsx(ym,{className:"h-4 w-4 mr-2"}),"KI-Analyse"]})})]}),r.jsxs("div",{className:"w-96 bg-background border-r flex flex-col",children:[c.length>0&&r.jsx("div",{className:"p-3 border-b bg-muted/50",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm text-muted-foreground",children:[c.length," ausgewählt"]}),r.jsx(J,{size:"sm",variant:"ghost",onClick:()=>U("mark-read"),children:r.jsx(IF,{className:"h-4 w-4"})}),r.jsx(J,{size:"sm",variant:"ghost",onClick:()=>U("star"),children:r.jsx(pu,{className:"h-4 w-4"})}),r.jsx(J,{size:"sm",variant:"ghost",onClick:()=>U("archive"),children:r.jsx(AF,{className:"h-4 w-4"})})]})}),r.jsx(Tw,{className:"flex-1",children:r.jsx("div",{className:"divide-y",children:H.map(G=>{var se;return r.jsx("div",{className:`p-4 cursor-pointer transition-all hover:bg-accent/50 ${(i==null?void 0:i.id)===G.id?"bg-accent border-r-2 border-primary":""} ${G.is_read?"":"bg-blue-50/30 border-l-2 border-blue-500"}`,onClick:()=>de(G),children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(Wa,{checked:c.includes(G.id),onCheckedChange:me=>{d(me?he=>[...he,G.id]:he=>he.filter(xe=>xe!==G.id))},onClick:me=>me.stopPropagation()}),r.jsx(Gh,{className:"h-8 w-8 flex-shrink-0",children:r.jsx(Qh,{children:((se=G.sender_name)==null?void 0:se[0])||G.sender_email[0].toUpperCase()})}),r.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:`text-sm truncate ${G.is_read?"":"font-semibold"}`,children:G.sender_name||G.sender_email}),r.jsxs("div",{className:"flex items-center gap-1",children:[$(G.priority),r.jsx("span",{className:"text-xs text-muted-foreground",children:D(G.received_at)})]})]}),r.jsx("p",{className:`text-sm truncate ${G.is_read?"":"font-semibold"}`,children:G.subject}),r.jsxs("p",{className:"text-xs text-muted-foreground line-clamp-2",children:[G.ai_summary||G.content.replace(/<[^>]*>/g,"").substring(0,100),"..."]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[G.is_starred&&r.jsx(pu,{className:"h-3 w-3 text-yellow-500 fill-current"}),G.attachments&&G.attachments.length>0&&r.jsx(GF,{className:"h-3 w-3 text-muted-foreground"}),G.reply_count&&G.reply_count>0&&r.jsx(Ve,{variant:"outline",className:"text-xs px-1 py-0",children:G.reply_count})]}),G.email_categories&&r.jsx(Ve,{variant:"outline",className:"text-xs",style:{borderColor:G.email_categories.color,color:G.email_categories.color},children:G.email_categories.name})]})]})]})},G.id)})})})]}),i?r.jsxs("div",{className:"flex-1 flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b bg-card",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Gh,{className:"h-10 w-10",children:r.jsx(Qh,{children:((ie=i.sender_name)==null?void 0:ie[0])||i.sender_email[0].toUpperCase()})}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"font-medium",children:i.sender_name||i.sender_email}),r.jsx("p",{className:"text-sm text-muted-foreground",children:i.sender_email}),r.jsx("p",{className:"text-xs text-muted-foreground",children:B(i.received_at)})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(J,{size:"sm",variant:"ghost",onClick:()=>z(i.id),children:r.jsx(pu,{className:`h-4 w-4 ${i.is_starred?"text-yellow-500 fill-current":""}`})}),r.jsx(J,{size:"sm",variant:"ghost",children:r.jsx(XF,{className:"h-4 w-4"})}),r.jsx(J,{size:"sm",variant:"ghost",children:r.jsx(UF,{className:"h-4 w-4"})}),r.jsx(J,{size:"sm",variant:"ghost",children:r.jsx($F,{className:"h-4 w-4"})})]})]}),r.jsx("h2",{className:"text-xl font-semibold mb-4",children:i.subject}),r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.ai_category&&r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-purple-100 text-purple-800 border-purple-200",children:[r.jsx(ym,{className:"h-3 w-3 mr-1"}),i.ai_category]}),i.customers&&r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-100 text-green-800 border-green-200",children:[r.jsx(fa,{className:"h-3 w-3 mr-1"}),i.customers.company_name]})]}),i.ai_summary&&r.jsxs("div",{className:"bg-accent/50 p-4 rounded-xl mt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(ym,{className:"h-4 w-4 text-primary"}),r.jsx("span",{className:"text-sm font-medium",children:"KI-Zusammenfassung"}),i.ai_confidence&&r.jsxs(Ve,{variant:"outline",className:"text-xs",children:[Math.round(i.ai_confidence*100),"% Konfidenz"]})]}),r.jsx("p",{className:"text-sm",children:i.ai_summary})]}),r.jsxs("div",{className:"flex gap-2 mt-4",children:[r.jsxs(J,{size:"sm",onClick:()=>O(i),className:"rounded-xl",children:[r.jsx(On,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),r.jsxs(J,{size:"sm",variant:"outline",onClick:()=>I(i),className:"rounded-xl",children:[r.jsx(fa,{className:"h-4 w-4 mr-2"}),"Projekt anlegen"]}),((pe=i.customers)==null?void 0:pe.phone)&&r.jsx(J,{size:"sm",variant:"outline",asChild:!0,className:"rounded-xl",children:r.jsxs("a",{href:`tel:${i.customers.phone}`,children:[r.jsx(Md,{className:"h-4 w-4 mr-2"}),"Anrufen"]})})]})]}),r.jsx(Tw,{className:"flex-1 p-6",children:r.jsx("div",{className:"prose prose-sm max-w-none text-gray-800 dark:text-gray-200",style:{fontSize:"14px",lineHeight:"1.6"},dangerouslySetInnerHTML:{__html:i.html_content||i.content.replace(/\n/g,"<br>")}})})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center bg-muted/20",children:r.jsxs("div",{className:"text-center",children:[r.jsx(sr,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),r.jsx("p",{className:"text-lg font-medium mb-2",children:"Keine E-Mail ausgewählt"}),r.jsx("p",{className:"text-muted-foreground",children:"Wählen Sie eine E-Mail aus, um sie anzuzeigen"})]})})]})})})]})};function AI({open:t,onOpenChange:e,onSuccess:n}){const{toast:s}=Rt(),[a,i]=g.useState(!1),[o,c]=g.useState(0),[d,u]=g.useState({startDate:"",endDate:"",reason:"",type:"vacation"});g.useEffect(()=>{t&&m()},[t]);const m=async()=>{try{const{data:{user:j}}=await K.auth.getUser();if(!j)return;const{data:v}=await K.from("employees").select("id, vacation_days_total, vacation_days_used").eq("user_id",j.id).single();if(v){const _=(v.vacation_days_total||0)-(v.vacation_days_used||0);c(Math.max(0,_))}else{const{data:_}=await K.from("company_settings").select("default_vacation_days").single();c((_==null?void 0:_.default_vacation_days)||25)}}catch(j){console.error("Error loading vacation balance:",j),c(0)}},f=(j,v)=>{if(!j||!v)return 0;const _=new Date(j),w=new Date(v).getTime()-_.getTime(),N=Math.ceil(w/(1e3*3600*24))+1;return Math.max(0,N)},p=async j=>{if(j.preventDefault(),!d.startDate||!d.endDate){s({title:"Fehler",description:"Bitte wählen Sie Start- und Enddatum aus",variant:"destructive"});return}const v=new Date(d.startDate),_=new Date(d.endDate);if(v>_){s({title:"Fehler",description:"Das Enddatum muss nach dem Startdatum liegen",variant:"destructive"});return}const b=f(d.startDate,d.endDate);if(d.type==="vacation"&&b>o){s({title:"Fehler",description:`Sie haben nur noch ${o} Urlaubstage verfügbar`,variant:"destructive"});return}i(!0);try{const{data:{user:w}}=await K.auth.getUser();if(!w)throw new Error("Nicht angemeldet");const{data:N,error:S}=await K.from("employees").select("id").eq("user_id",w.id).single();if(S||!N)throw new Error("Mitarbeiterdaten nicht gefunden");const{error:A}=await K.from("vacation_requests").insert({employee_id:N.id,start_date:d.startDate,end_date:d.endDate,days_requested:b,request_type:d.type,reason:d.reason||null,status:"pending",created_by:w.id});if(A)throw A;s({title:"Antrag eingereicht",description:`Ihr ${d.type==="vacation"?"Urlaubs":"Abwesenheits"}antrag wurde erfolgreich eingereicht`}),u({startDate:"",endDate:"",reason:"",type:"vacation"}),e(!1),n==null||n()}catch(w){console.error("Error submitting vacation request:",w),s({title:"Fehler",description:w.message||"Antrag konnte nicht eingereicht werden",variant:"destructive"})}finally{i(!1)}},y=f(d.startDate,d.endDate);return r.jsx(en,{open:t,onOpenChange:e,children:r.jsxs(Gt,{className:"max-w-md",children:[r.jsx(rn,{children:r.jsxs(sn,{className:"flex items-center gap-2",children:[r.jsx(zt,{className:"h-5 w-5"}),"Urlaubsantrag stellen"]})}),r.jsxs("form",{onSubmit:p,className:"space-y-4",children:[r.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{children:"Verfügbare Urlaubstage:"}),r.jsxs("span",{className:"font-semibold text-blue-600",children:[o," Tage"]})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{children:"Art der Abwesenheit"}),r.jsxs("select",{value:d.type,onChange:j=>u(v=>({...v,type:j.target.value})),className:"w-full p-2 border rounded-md",children:[r.jsx("option",{value:"vacation",children:"Urlaub"}),r.jsx("option",{value:"sick",children:"Krankmeldung"}),r.jsx("option",{value:"personal",children:"Persönliche Angelegenheiten"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"startDate",children:"Von"}),r.jsx(ne,{id:"startDate",type:"date",value:d.startDate,onChange:j=>u(v=>({...v,startDate:j.target.value})),min:new Date().toISOString().split("T")[0],required:!0})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"endDate",children:"Bis"}),r.jsx(ne,{id:"endDate",type:"date",value:d.endDate,onChange:j=>u(v=>({...v,endDate:j.target.value})),min:d.startDate||new Date().toISOString().split("T")[0],required:!0})]})]}),y>0&&r.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(hn,{className:"h-4 w-4"}),"Beantragte Tage:"]}),r.jsxs("span",{className:`font-semibold ${d.type==="vacation"&&y>o?"text-red-600":"text-green-600"}`,children:[y," ",y===1?"Tag":"Tage"]})]}),d.type==="vacation"&&y>o&&r.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Nicht genügend Urlaubstage verfügbar"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(Y,{htmlFor:"reason",children:["Begründung ",d.type!=="vacation"&&"(erforderlich)"]}),r.jsx(En,{id:"reason",value:d.reason,onChange:j=>u(v=>({...v,reason:j.target.value})),placeholder:d.type==="vacation"?"Optionale Begründung für den Urlaub...":"Bitte geben Sie eine Begründung an...",rows:3,required:d.type!=="vacation"})]}),r.jsxs("div",{className:"flex gap-2 pt-2",children:[r.jsx(J,{type:"submit",disabled:a||!d.startDate||!d.endDate,className:"flex-1",children:a?"Wird eingereicht...":"Antrag stellen"}),r.jsx(J,{type:"button",variant:"outline",onClick:()=>e(!1),disabled:a,children:"Abbrechen"})]})]})]})})}function ane(){const{user:t,userRole:e}=Di(),{toast:n}=Rt(),[s,a]=g.useState([]),[i,o]=g.useState({total_days:0,used_days:0,pending_days:0,available_days:0}),[c,d]=g.useState(!0),[u,m]=g.useState(!1),[f,p]=g.useState("my-requests"),y=e==="manager"||e==="admin";g.useEffect(()=>{t&&j()},[t,f]);const j=async()=>{d(!0);try{await Promise.all([v(),_()])}catch(S){console.error("Error loading vacation data:",S)}finally{d(!1)}},v=async()=>{if(t)try{const{data:S}=await K.from("employees").select("vacation_days_total, vacation_days_used").eq("user_id",t.id).single();if(S){const{data:A}=await K.from("vacation_requests").select("days_requested").eq("employee_id",S.id).eq("status","pending").eq("request_type","vacation"),E=(A==null?void 0:A.reduce((R,P)=>R+P.days_requested,0))||0,D=S.vacation_days_total||0,M=S.vacation_days_used||0,B=Math.max(0,D-M-E);o({total_days:D,used_days:M,pending_days:E,available_days:B})}else{const{data:A}=await K.from("company_settings").select("default_vacation_days").single(),E=(A==null?void 0:A.default_vacation_days)||25;o({total_days:E,used_days:0,pending_days:0,available_days:E})}}catch(S){console.error("Error loading vacation balance:",S)}},_=async()=>{if(t)try{let S=K.from("vacation_requests").select(`
          id,
          employee_id,
          start_date,
          end_date,
          days_requested,
          request_type,
          reason,
          status,
          created_at,
          approved_by,
          approved_at,
          employees!inner(
            id,
            first_name,
            last_name,
            user_id
          )
        `).order("created_at",{ascending:!1});if(f==="my-requests"||!y){const{data:M}=await K.from("employees").select("id").eq("user_id",t.id).single();M&&(S=S.eq("employee_id",M.id))}const{data:A,error:E}=await S;if(E)throw E;const D=(A==null?void 0:A.map(M=>({id:M.id,employee_id:M.employee_id,employee_name:`${M.employees.first_name} ${M.employees.last_name}`,start_date:M.start_date,end_date:M.end_date,days_requested:M.days_requested,request_type:M.request_type,reason:M.reason,status:M.status,created_at:M.created_at,approved_by:M.approved_by,approved_at:M.approved_at})))||[];a(D)}catch(S){console.error("Error loading vacation requests:",S),n({title:"Fehler",description:"Urlaubsanträge konnten nicht geladen werden",variant:"destructive"})}},b=async(S,A)=>{const E=[...s];a(D=>D.filter(M=>M.id!==S));try{const D={status:A?"approved":"rejected",approved_by:t==null?void 0:t.id,approved_at:new Date().toISOString()},{error:M}=await K.from("vacation_requests").update(D).eq("id",S);if(M)throw a(E),M;if(A){const B=s.find(R=>R.id===S);if(B&&B.request_type==="vacation"){const{error:R}=await K.rpc("increment_vacation_days_used",{employee_id_param:B.employee_id,days_to_add:B.days_requested});R&&console.error("Error updating vacation days:",R)}}n({title:A?"Antrag genehmigt":"Antrag abgelehnt",description:`Der Urlaubsantrag wurde erfolgreich ${A?"genehmigt":"abgelehnt"}`}),setTimeout(()=>{j()},1e3)}catch(D){console.error("Error updating vacation request:",D),n({title:"Fehler",description:"Antrag konnte nicht aktualisiert werden",variant:"destructive"})}},w=S=>{switch(S){case"pending":return r.jsxs(Ve,{className:"bg-yellow-500",children:[r.jsx(X0,{className:"h-3 w-3 mr-1"}),"Ausstehend"]});case"approved":return r.jsxs(Ve,{className:"bg-green-500",children:[r.jsx(Lr,{className:"h-3 w-3 mr-1"}),"Genehmigt"]});case"rejected":return r.jsxs(Ve,{className:"bg-red-500",children:[r.jsx(Nl,{className:"h-3 w-3 mr-1"}),"Abgelehnt"]});default:return r.jsx(Ve,{variant:"outline",children:S})}},N=S=>{switch(S){case"vacation":return"Urlaub";case"sick":return"Krankmeldung";case"personal":return"Persönlich";default:return S}};return c?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-muted-foreground",children:"Lade Urlaubsdaten..."})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-gray-600 bg-clip-text text-transparent flex items-center gap-3",children:[r.jsx(zt,{className:"h-8 w-8 text-gray-600"}),"Urlaubsverwaltung"]}),r.jsx("p",{className:"text-muted-foreground",children:"Verwalten Sie Ihre Urlaubsanträge und Abwesenheiten"})]}),r.jsxs(J,{onClick:()=>m(!0),children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Neuer Antrag"]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(hn,{className:"h-5 w-5"}),"Mein Urlaubskonto"]})}),r.jsx(ce,{children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.total_days}),r.jsx("div",{className:"text-sm text-blue-700",children:"Gesamte Tage"})]}),r.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.available_days}),r.jsx("div",{className:"text-sm text-green-700",children:"Verfügbar"})]}),r.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.pending_days}),r.jsx("div",{className:"text-sm text-orange-700",children:"Ausstehend"})]}),r.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-gray-600",children:i.used_days}),r.jsx("div",{className:"text-sm text-gray-700",children:"Verbraucht"})]})]})})]}),y&&r.jsxs("div",{className:"flex gap-2",children:[r.jsx(J,{variant:f==="my-requests"?"default":"outline",onClick:()=>p("my-requests"),children:"Meine Anträge"}),r.jsx(J,{variant:f==="all-requests"?"default":"outline",onClick:()=>p("all-requests"),children:"Alle Anträge"})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx($s,{className:"h-5 w-5"}),f==="all-requests"?"Alle Urlaubsanträge":"Meine Urlaubsanträge"]})}),r.jsx(ce,{children:s.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(zt,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Keine Anträge"}),r.jsx("p",{className:"text-gray-500",children:f==="all-requests"?"Es sind keine Urlaubsanträge vorhanden":"Sie haben noch keine Urlaubsanträge gestellt"})]}):r.jsx("div",{className:"space-y-4",children:s.map(S=>r.jsxs("div",{className:"border rounded-lg p-4",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h4",{className:"font-semibold",children:f==="all-requests"?S.employee_name:N(S.request_type)}),w(S.status)]}),r.jsxs("div",{className:"text-sm text-gray-600",children:[new Date(S.start_date).toLocaleDateString("de-DE")," - "," ",new Date(S.end_date).toLocaleDateString("de-DE")," (",S.days_requested," ",S.days_requested===1?"Tag":"Tage",")"]})]}),r.jsx("div",{className:"text-xs text-gray-500",children:new Date(S.created_at).toLocaleDateString("de-DE")})]}),S.reason&&r.jsx("div",{className:"mb-3",children:r.jsx("p",{className:"text-sm text-gray-700",children:S.reason})}),y&&f==="all-requests"&&S.status==="pending"&&r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsxs(J,{size:"sm",onClick:()=>b(S.id,!0),className:"bg-green-600 hover:bg-green-700",children:[r.jsx(Lr,{className:"h-4 w-4 mr-1"}),"Genehmigen"]}),r.jsxs(J,{size:"sm",variant:"outline",onClick:A=>{A.preventDefault(),A.stopPropagation(),b(S.id,!1)},className:"border-red-600 text-red-600 hover:bg-red-50",children:[r.jsx(Nl,{className:"h-4 w-4 mr-1"}),"Ablehnen"]})]}),S.approved_at&&r.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[S.status==="approved"?"Genehmigt":"Abgelehnt"," am"," ",new Date(S.approved_at).toLocaleDateString("de-DE")]})]},S.id))})})]}),r.jsx(AI,{open:u,onOpenChange:m,onSuccess:j})]})}class ine{async createOrderFromQuote(e){try{console.log("🔄 Creating order from quote:",e);const{data:n,error:s}=await K.from("quotes").select("*").eq("id",e).single();if(s||!n)throw new Error("Angebot nicht gefunden");const a={order_number:`AUF-${Date.now().toString().slice(-6)}`,customer_id:n.customer_id,title:n.title||"Auftrag aus Angebot",description:n.description,order_date:new Date().toISOString().split("T")[0],due_date:n.valid_until||null,status:"confirmed",priority:"medium",total_amount:n.total_amount,currency:n.currency||"EUR",notes:`Automatisch erstellt aus Angebot ${n.quote_number}`,workflow_origin_type:"quote",workflow_origin_id:e},{data:i,error:o}=await K.from("orders").insert(a).select().single();if(o)throw o;return await K.from("quotes").update({status:"accepted",workflow_target_type:"order",workflow_target_id:i.id}).eq("id",e),await this.createOrUpdateWorkflowChain({quoteId:e,orderId:i.id,currentStep:"order",customerId:n.customer_id,metadata:{title:n.title||"Neuer Workflow",totalAmount:n.total_amount,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}),Ma({title:"Auftrag erstellt",description:`Auftrag ${a.order_number} wurde erfolgreich aus dem Angebot erstellt.`}),i.id}catch(n){return console.error("❌ Error creating order from quote:",n),Ma({title:"Fehler",description:"Auftrag konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async createProjectFromOrder(e){try{console.log("🔄 Creating project from order:",e);const{data:n,error:s}=await K.from("orders").select("*, customers(company_name)").eq("id",e).single();if(s||!n)throw new Error("Auftrag nicht gefunden");const{data:a}=await K.auth.getUser();if(!(a!=null&&a.user))throw new Error("Benutzer nicht authentifiziert");const{data:i}=await K.from("profiles").select("company_id").eq("id",a.user.id).single();if(!(i!=null&&i.company_id))throw new Error("Firma nicht gefunden");const o={name:n.title,customer_id:n.customer_id,company_id:i.company_id,status:"geplant",start_date:new Date().toISOString().split("T")[0],end_date:n.due_date||null,location:null,budget:n.total_amount||0,description:`Automatisch erstellt aus Auftrag ${n.order_number}. ${n.description||""}`,workflow_origin_type:"order",workflow_origin_id:e},{data:c,error:d}=await K.from("projects").insert(o).select().single();if(d)throw d;await K.from("orders").update({status:"in_progress",workflow_target_type:"project",workflow_target_id:c.id}).eq("id",e);const u=await this.getWorkflowChain(e,"order");return u&&await this.createOrUpdateWorkflowChain({...u,projectId:c.id,currentStep:"project"}),Ma({title:"Projekt erstellt",description:`Projekt "${n.title}" wurde erfolgreich aus dem Auftrag erstellt.`}),c.id}catch(n){return console.error("❌ Error creating project from order:",n),Ma({title:"Fehler",description:"Projekt konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async createInvoiceFromProject(e){try{console.log("🔄 Creating invoice from project:",e);const{data:n,error:s}=await K.from("projects").select("*, customers(company_name, address)").eq("id",e).single();if(s||!n)throw new Error("Projekt nicht gefunden");if(n.status!=="abgeschlossen")throw new Error("Rechnung kann nur für abgeschlossene Projekte erstellt werden");const a={invoice_number:`RG-${Date.now().toString().slice(-6)}`,customer_id:n.customer_id,issue_date:new Date().toISOString().split("T")[0],due_date:new Date(Date.now()+14*24*60*60*1e3).toISOString().split("T")[0],status:"draft",total_amount:n.budget||0,currency:"EUR",description:`Rechnung für Projekt: ${n.name}`,notes:`Automatisch erstellt aus Projekt ${n.name}`,workflow_origin_type:"project",workflow_origin_id:e},{data:i,error:o}=await K.from("invoices").insert(a).select().single();if(o)throw o;await K.from("projects").update({workflow_target_type:"invoice",workflow_target_id:i.id}).eq("id",e);const c=await this.getWorkflowChain(e,"project");return c&&await this.createOrUpdateWorkflowChain({...c,invoiceId:i.id,currentStep:"invoice"}),Ma({title:"Rechnung erstellt",description:`Rechnungsentwurf ${a.invoice_number} wurde erfolgreich erstellt.`}),i.id}catch(n){return console.error("❌ Error creating invoice from project:",n),Ma({title:"Fehler",description:"Rechnung konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async checkBudgetWarnings(){try{const{data:e}=await K.from("projects").select("*").in("status",["geplant","in_bearbeitung"]),n=[];for(const s of e||[])if(s.budget&&s.budget>0){const a=s.budget*.95,i=a/s.budget*100;i>=90&&n.push({projectId:s.id,projectName:s.name,budget:s.budget,usedBudget:a,usagePercentage:i,type:"budget_warning"})}return n}catch(e){return console.error("❌ Error checking budget warnings:",e),[]}}async createOrUpdateWorkflowChain(e){try{const n={quote_id:e.quoteId||null,order_id:e.orderId||null,project_id:e.projectId||null,invoice_id:e.invoiceId||null,current_step:e.currentStep,customer_id:e.customerId,metadata:e.metadata,updated_at:new Date().toISOString()},s=K.from("workflow_chains").select("id");e.quoteId?s.eq("quote_id",e.quoteId):e.orderId?s.eq("order_id",e.orderId):e.projectId&&s.eq("project_id",e.projectId);const{data:a}=await s.single();a?await K.from("workflow_chains").update(n).eq("id",a.id):await K.from("workflow_chains").insert({...n,created_at:new Date().toISOString()})}catch(n){console.error("❌ Error managing workflow chain:",n)}}async getWorkflowChain(e,n){try{const s=`${n}_id`,{data:a}=await K.from("workflow_chains").select("*").eq(s,e).single();return a?{quoteId:a.quote_id,orderId:a.order_id,projectId:a.project_id,invoiceId:a.invoice_id,currentStep:a.current_step,customerId:a.customer_id,metadata:a.metadata}:null}catch(s){return console.error("❌ Error getting workflow chain:",s),null}}async getDashboardCriticalData(){try{const[e,n,s,a]=await Promise.all([this.checkBudgetWarnings(),this.getPendingQuotes(),this.getDelayedProjects(),this.getOverdueInvoices()]);return{overdueTasks:[...e,...s],budgetWarnings:e,pendingQuotes:n,delayedProjects:s,overdueInvoices:a}}catch(e){return console.error("❌ Error getting dashboard critical data:",e),{overdueTasks:[],budgetWarnings:[],pendingQuotes:[],delayedProjects:[],overdueInvoices:[]}}}async getPendingQuotes(){const{data:e}=await K.from("quotes").select("*, customers(company_name)").eq("status","pending").order("created_at",{ascending:!1});return e||[]}async getDelayedProjects(){const{data:e}=await K.from("projects").select("*").in("status",["geplant","in_bearbeitung"]).lt("end_date",new Date().toISOString().split("T")[0]);return e||[]}async getOverdueInvoices(){const{data:e}=await K.from("invoices").select("*, customers(company_name)").eq("status","sent").lt("due_date",new Date().toISOString().split("T")[0]);return e||[]}async applyScheduleWithApproval(e){var n;return await pT("aiScheduleApply",{reason:"KI-Planung soll auf den Kalender angewendet werden.",metadata:{projectId:e.projectId,employeeCount:((n=e.employeeAssignments)==null?void 0:n.length)||0},userId:e.userId},async()=>(console.log("Applying AI schedule:",e),e))}}const one=new ine,lne=({onNavigate:t})=>{const[e,n]=g.useState({criticalAlerts:{budgetWarnings:0,overdueProjects:0,overdueInvoices:0,pendingQuotes:0},financialKPIs:{monthlyRevenue:0,monthlyExpenses:0,profit:0,profitMargin:0,outstandingAmount:0,revenuetrend:0},projectStatus:{active:0,planning:0,completed:0,delayed:0},teamOverview:{activeEmployees:0,todayHours:0,utilizationRate:0}}),[s,a]=g.useState(!0),[i,o]=g.useState([]),{toast:c}=Rt();g.useEffect(()=>{d();const v=setInterval(d,5*60*1e3);return()=>clearInterval(v)},[]);const d=async()=>{try{a(!0);const[v,_,b,w]=await Promise.all([one.getDashboardCriticalData(),u(),m(),f()]);o(v.overdueTasks),n({criticalAlerts:{budgetWarnings:v.budgetWarnings.length,overdueProjects:v.delayedProjects.length,overdueInvoices:v.overdueInvoices.length,pendingQuotes:v.pendingQuotes.length},financialKPIs:b,projectStatus:_,teamOverview:w})}catch(v){console.error("❌ Error loading dashboard data:",v),c({title:"Fehler beim Laden",description:"Dashboard-Daten konnten nicht geladen werden.",variant:"destructive"})}finally{a(!1)}},u=async()=>{const{data:v}=await K.from("projects").select("status, end_date"),_=new Date().toISOString().split("T")[0],b={active:0,planning:0,completed:0,delayed:0};return v==null||v.forEach(w=>{switch(w.status){case"in_bearbeitung":b.active++;break;case"geplant":case"anfrage":case"besichtigung":b.planning++;break;case"abgeschlossen":b.completed++;break}w.end_date&&w.end_date<_&&w.status!=="abgeschlossen"&&b.delayed++}),b},m=async()=>({monthlyRevenue:45e3,monthlyExpenses:32e3,profit:13e3,profitMargin:28.9,outstandingAmount:8500,revenuetrend:12.5}),f=async()=>{const{data:v}=await K.from("employees").select("status").neq("status","eingeladen");return{activeEmployees:(v==null?void 0:v.length)||0,todayHours:67.5,utilizationRate:85}},p=[{id:"new-quote",title:"Neues Angebot",description:"Angebot für Kunden erstellen",icon:On,color:"bg-blue-500",onClick:()=>t==null?void 0:t("finance")},{id:"new-project",title:"Projekt anlegen",description:"Direktes Projekt erstellen",icon:fa,color:"bg-green-500",onClick:()=>t==null?void 0:t("projects")},{id:"check-finances",title:"Finanzen prüfen",description:"Rechnungen und Ausgaben",icon:hs,color:"bg-purple-500",onClick:()=>t==null?void 0:t("finance")},{id:"team-overview",title:"Team Status",description:"Mitarbeiter und Zeiten",icon:Si,color:"bg-orange-500",onClick:()=>t==null?void 0:t("personal")}],y=v=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(v),j=()=>Object.values(e.criticalAlerts).reduce((v,_)=>v+_,0);return s?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r.jsxs("div",{className:"space-y-6 animate-fadeIn p-6 bg-gray-50 min-h-screen",children:[r.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),r.jsx("p",{className:"text-gray-600",children:"Zentrale Übersicht Ihres Handwerksbetriebs"})]}),j()>0&&r.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-red-50 border border-red-100 rounded-xl",children:[r.jsx(kr,{className:"h-5 w-5 text-red-500"}),r.jsxs("span",{className:"text-red-700 font-medium",children:[j()," Punkte benötigen Aufmerksamkeit"]})]})]})}),r.jsxs(J3,{children:[r.jsx(mo,{title:"Offene Aufträge",value:e.projectStatus.active+e.projectStatus.planning,valueClassName:"text-blue-600"}),r.jsx(mo,{title:"Monatsumsatz",value:y(e.financialKPIs.monthlyRevenue),valueClassName:"text-green-600"}),r.jsx(mo,{title:"Offene Angebote",value:e.criticalAlerts.pendingQuotes,valueClassName:"text-orange-600"}),r.jsx(mo,{title:"Mitarbeiter",value:e.teamOverview.activeEmployees,valueClassName:"text-purple-600"})]}),r.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[r.jsxs("div",{className:"col-span-8 space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[r.jsx("div",{className:"p-6 border-b border-gray-100",children:r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Finanzübersicht"})}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Umsatz"}),r.jsx("div",{className:"text-2xl font-bold text-green-600",children:y(e.financialKPIs.monthlyRevenue)})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Gewinn"}),r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:y(e.financialKPIs.profit)})]})]}),r.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-gray-700",children:"Gewinnmarge"}),r.jsxs("span",{className:"font-semibold text-gray-900",children:[e.financialKPIs.profitMargin,"%"]})]})})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[r.jsx("div",{className:"p-6 border-b border-gray-100",children:r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Schnellaktionen"})}),r.jsx("div",{className:"p-6",children:r.jsx("div",{className:"grid grid-cols-2 gap-4",children:p.map(v=>r.jsxs("button",{onClick:v.onClick,className:"flex items-center gap-4 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors text-left",children:[r.jsx("div",{className:`p-3 rounded-lg ${v.color}`,children:r.jsx(v.icon,{className:"h-6 w-6 text-white"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:v.title}),r.jsx("div",{className:"text-sm text-gray-500",children:v.description})]})]},v.id))})})]})]}),r.jsxs("div",{className:"col-span-4 space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[r.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Projektstatus"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),r.jsx("span",{className:"text-sm text-gray-700",children:"Anfrage"})]}),r.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.planning})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),r.jsx("span",{className:"text-sm text-gray-700",children:"In Bearbeitung"})]}),r.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.active})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),r.jsx("span",{className:"text-sm text-gray-700",children:"Abgeschlossen"})]}),r.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.completed})]})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[r.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Team Übersicht"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-700",children:"Aktive Mitarbeiter"}),r.jsx("span",{className:"font-medium",children:e.teamOverview.activeEmployees})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-700",children:"Stunden heute"}),r.jsxs("span",{className:"font-medium",children:[e.teamOverview.todayHours,"h"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-700",children:"Auslastung"}),r.jsxs("span",{className:"font-medium",children:[e.teamOverview.utilizationRate,"%"]})]})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[r.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Heute"}),r.jsx("div",{className:"text-center py-4",children:r.jsx("p",{className:"text-gray-500",children:"Keine Termine für heute"})})]})]})]}),r.jsxs(zr,{defaultValue:"kpis",className:"w-full hidden",children:[r.jsxs(Er,{className:"grid w-full grid-cols-5",children:[r.jsx(Ge,{value:"kpis",children:"Kennzahlen"}),r.jsx(Ge,{value:"overview",children:"Übersicht"}),r.jsx(Ge,{value:"financial",children:"Finanzen"}),r.jsx(Ge,{value:"projects",children:"Projekte"}),r.jsx(Ge,{value:"actions",children:"Schnellaktionen"})]}),r.jsxs(Qe,{value:"kpis",className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-semibold mb-4",children:"📊 Aktuelle Kennzahlen"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[r.jsx(le,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("projects"),children:r.jsxs(ce,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(Gp,{className:"w-5 h-5 text-blue-600"}),r.jsx("span",{className:"font-medium",children:"Offene Aufträge"})]}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active+e.projectStatus.planning}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"in Bearbeitung"})]})}),r.jsx(le,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("emails"),children:r.jsxs(ce,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(sr,{className:"w-5 h-5 text-green-600"}),r.jsx("span",{className:"font-medium",children:"Ungelesene E-Mails"})]}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:"0"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"neue Anfragen"})]})}),r.jsx(le,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("finance"),children:r.jsxs(ce,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(On,{className:"w-5 h-5 text-orange-600"}),r.jsx("span",{className:"font-medium",children:"Offene Angebote"})]}),r.jsx("p",{className:"text-2xl font-bold text-orange-600",children:e.criticalAlerts.pendingQuotes}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"versendet"})]})}),r.jsx(le,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("finance"),children:r.jsxs(ce,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(hs,{className:"w-5 h-5 text-red-600"}),r.jsx("span",{className:"font-medium",children:"Offene Rechnungen"})]}),r.jsx("p",{className:"text-2xl font-bold text-red-600",children:e.criticalAlerts.overdueInvoices}),r.jsx("p",{className:"text-sm text-muted-foreground",children:y(e.financialKPIs.outstandingAmount)})]})}),r.jsx(le,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("timetracking"),children:r.jsxs(ce,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(hn,{className:"w-5 h-5 text-purple-600"}),r.jsx("span",{className:"font-medium",children:"Stunden heute"})]}),r.jsx("p",{className:"text-2xl font-bold text-purple-600",children:e.teamOverview.todayHours}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"gearbeitet"})]})})]})]}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-semibold mb-4",children:"📅 Heute / Nächste Termine"}),r.jsx(le,{children:r.jsx(ce,{className:"p-4",children:r.jsx("p",{className:"text-muted-foreground",children:"Keine Termine für heute"})})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-semibold mb-3",children:"👥 Mitarbeiterübersicht"}),r.jsx(le,{children:r.jsx(ce,{className:"p-3",children:r.jsx("div",{className:"space-y-2",children:e.teamOverview.activeEmployees>0?r.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/30 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500"}),r.jsxs("span",{className:"font-medium text-sm",children:[e.teamOverview.activeEmployees," Mitarbeiter"]})]}),r.jsx(J,{variant:"outline",size:"sm",onClick:()=>t==null?void 0:t("timetracking"),children:"Zeitbericht"})]}):r.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine aktiven Mitarbeiter"})})})})]}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-semibold mb-3",children:"📨 Letzte E-Mails / Kundenanfragen"}),r.jsx(le,{children:r.jsx(ce,{className:"p-3",children:r.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine neuen E-Mails"})})})]})]})]}),r.jsxs(Qe,{value:"overview",className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[r.jsx(le,{children:r.jsx(ce,{className:"p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Monatsumsatz"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:y(e.financialKPIs.monthlyRevenue)})]}),r.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[r.jsx(Ao,{className:"h-4 w-4"}),r.jsxs("span",{className:"text-sm font-medium",children:["+",e.financialKPIs.revenuetrend,"%"]})]})]})})}),r.jsx(le,{children:r.jsx(ce,{className:"p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Gewinn"}),r.jsx("p",{className:"text-2xl font-bold",children:y(e.financialKPIs.profit)})]}),r.jsxs(Ve,{className:"bg-blue-100 text-blue-800",children:[e.financialKPIs.profitMargin,"%"]})]})})}),r.jsx(le,{children:r.jsx(ce,{className:"p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Aktive Projekte"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active})]}),r.jsx(fa,{className:"h-8 w-8 text-blue-600"})]})})}),r.jsx(le,{children:r.jsxs(ce,{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Team Auslastung"}),r.jsxs("p",{className:"text-2xl font-bold",children:[e.teamOverview.utilizationRate,"%"]})]}),r.jsx(Si,{className:"h-8 w-8 text-purple-600"})]}),r.jsx(kd,{value:e.teamOverview.utilizationRate,className:"mt-2"})]})})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Projekt-Pipeline"})}),r.jsx(ce,{children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:e.projectStatus.planning}),r.jsx("div",{className:"text-sm text-yellow-700",children:"In Planung"})]}),r.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active}),r.jsx("div",{className:"text-sm text-blue-700",children:"In Bearbeitung"})]}),r.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.projectStatus.completed}),r.jsx("div",{className:"text-sm text-green-700",children:"Abgeschlossen"})]}),r.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.projectStatus.delayed}),r.jsx("div",{className:"text-sm text-red-700",children:"Verspätet"})]})]})})]})]}),r.jsx(Qe,{value:"financial",className:"space-y-6",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Finanzielle Kennzahlen"})}),r.jsxs(ce,{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Umsatz"}),r.jsx("span",{className:"font-bold text-green-600",children:y(e.financialKPIs.monthlyRevenue)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Ausgaben"}),r.jsx("span",{className:"font-bold text-red-600",children:y(e.financialKPIs.monthlyExpenses)})]}),r.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[r.jsx("span",{className:"font-semibold",children:"Gewinn"}),r.jsx("span",{className:"font-bold text-lg",children:y(e.financialKPIs.profit)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Gewinnmarge"}),r.jsxs("span",{className:"font-bold",children:[e.financialKPIs.profitMargin,"%"]})]})]})]}),r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Ausstehende Beträge"})}),r.jsxs(ce,{children:[r.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:y(e.financialKPIs.outstandingAmount)}),r.jsx("p",{className:"text-sm text-gray-600",children:"Noch nicht bezahlte Rechnungen"}),r.jsxs(J,{variant:"outline",className:"mt-4 w-full",onClick:()=>t==null?void 0:t("finance"),children:[r.jsx(hs,{className:"h-4 w-4 mr-2"}),"Rechnungen verwalten"]})]})]})]})}),r.jsx(Qe,{value:"projects",className:"space-y-6",children:r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsx(Ee,{children:"Projekt-Status Details"})}),r.jsx(ce,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),r.jsx("span",{children:"Projekte in Planung"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-bold",children:e.projectStatus.planning}),r.jsx(J,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:r.jsx(la,{className:"h-4 w-4"})})]})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),r.jsx("span",{children:"Aktive Projekte"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-bold",children:e.projectStatus.active}),r.jsx(J,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:r.jsx(la,{className:"h-4 w-4"})})]})]}),e.projectStatus.delayed>0&&r.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-red-50",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(kr,{className:"h-5 w-5 text-red-600"}),r.jsx("span",{className:"text-red-700",children:"Verspätete Projekte"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-bold text-red-600",children:e.projectStatus.delayed}),r.jsx(J,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:r.jsx(la,{className:"h-4 w-4"})})]})]})]})})]})}),r.jsx(Qe,{value:"actions",className:"space-y-6",children:r.jsxs(le,{children:[r.jsx(Ce,{children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx(nB,{className:"h-5 w-5 text-yellow-500"}),"Schnellaktionen"]})}),r.jsx(ce,{children:r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map(v=>r.jsxs(J,{variant:"outline",className:"h-auto p-4 justify-start",onClick:v.onClick,children:[r.jsx("div",{className:`p-2 rounded-lg ${v.color} mr-4`,children:r.jsx(v.icon,{className:"h-6 w-6 text-white"})}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"font-semibold",children:v.title}),r.jsx("div",{className:"text-sm text-gray-500",children:v.description})]}),r.jsx(Lb,{className:"h-4 w-4 ml-auto"})]},v.id))})})]})})]})]})};var Mw=["Enter"," "],cne=["ArrowDown","PageUp","Home"],PI=["ArrowUp","PageDown","End"],dne=[...cne,...PI],une={ltr:[...Mw,"ArrowRight"],rtl:[...Mw,"ArrowLeft"]},hne={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Mf="Menu",[Yh,fne,mne]=cf(Mf),[Gl,DI]=Ss(Mf,[mne,Uo,gg]),$g=Uo(),TI=gg(),[pne,Ql]=Gl(Mf),[gne,Rf]=Gl(Mf),MI=t=>{const{__scopeMenu:e,open:n=!1,children:s,dir:a,onOpenChange:i,modal:o=!0}=t,c=$g(e),[d,u]=g.useState(null),m=g.useRef(!1),f=jn(i),p=Wd(a);return g.useEffect(()=>{const y=()=>{m.current=!0,document.addEventListener("pointerdown",j,{capture:!0,once:!0}),document.addEventListener("pointermove",j,{capture:!0,once:!0})},j=()=>m.current=!1;return document.addEventListener("keydown",y,{capture:!0}),()=>{document.removeEventListener("keydown",y,{capture:!0}),document.removeEventListener("pointerdown",j,{capture:!0}),document.removeEventListener("pointermove",j,{capture:!0})}},[]),r.jsx(Yb,{...c,children:r.jsx(pne,{scope:e,open:n,onOpenChange:f,content:d,onContentChange:u,children:r.jsx(gne,{scope:e,onClose:g.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:m,dir:p,modal:o,children:s})})})};MI.displayName=Mf;var xne="MenuAnchor",b1=g.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,a=$g(n);return r.jsx(gf,{...a,...s,ref:e})});b1.displayName=xne;var j1="MenuPortal",[vne,RI]=Gl(j1,{forceMount:void 0}),II=t=>{const{__scopeMenu:e,forceMount:n,children:s,container:a}=t,i=Ql(j1,e);return r.jsx(vne,{scope:e,forceMount:n,children:r.jsx(Jn,{present:n||i.open,children:r.jsx(Td,{asChild:!0,container:a,children:s})})})};II.displayName=j1;var Ls="MenuContent",[yne,N1]=Gl(Ls),OI=g.forwardRef((t,e)=>{const n=RI(Ls,t.__scopeMenu),{forceMount:s=n.forceMount,...a}=t,i=Ql(Ls,t.__scopeMenu),o=Rf(Ls,t.__scopeMenu);return r.jsx(Yh.Provider,{scope:t.__scopeMenu,children:r.jsx(Jn,{present:s||i.open,children:r.jsx(Yh.Slot,{scope:t.__scopeMenu,children:o.modal?r.jsx(_ne,{...a,ref:e}):r.jsx(wne,{...a,ref:e})})})})}),_ne=g.forwardRef((t,e)=>{const n=Ql(Ls,t.__scopeMenu),s=g.useRef(null),a=Mt(e,s);return g.useEffect(()=>{const i=s.current;if(i)return Dg(i)},[]),r.jsx(S1,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Te(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),wne=g.forwardRef((t,e)=>{const n=Ql(Ls,t.__scopeMenu);return r.jsx(S1,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),S1=g.forwardRef((t,e)=>{const{__scopeMenu:n,loop:s=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:c,onEntryFocus:d,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:f,onInteractOutside:p,onDismiss:y,disableOutsideScroll:j,...v}=t,_=Ql(Ls,n),b=Rf(Ls,n),w=$g(n),N=TI(n),S=fne(n),[A,E]=g.useState(null),D=g.useRef(null),M=Mt(e,D,_.onContentChange),B=g.useRef(0),R=g.useRef(""),P=g.useRef(0),F=g.useRef(null),W=g.useRef("right"),ee=g.useRef(0),ue=j?kf:g.Fragment,de=j?{as:ji,allowPinchZoom:!0}:void 0,Q=V=>{var Z,ie;const U=R.current+V,O=S().filter(pe=>!pe.disabled),I=document.activeElement,H=(Z=O.find(pe=>pe.ref.current===I))==null?void 0:Z.textValue,$=O.map(pe=>pe.textValue),te=Mne($,U,H),X=(ie=O.find(pe=>pe.textValue===te))==null?void 0:ie.ref.current;(function pe(G){R.current=G,window.clearTimeout(B.current),G!==""&&(B.current=window.setTimeout(()=>pe(""),1e3))})(U),X&&setTimeout(()=>X.focus())};g.useEffect(()=>()=>window.clearTimeout(B.current),[]),Ag();const z=g.useCallback(V=>{var O,I;return W.current===((O=F.current)==null?void 0:O.side)&&Ine(V,(I=F.current)==null?void 0:I.area)},[]);return r.jsx(yne,{scope:n,searchRef:R,onItemEnter:g.useCallback(V=>{z(V)&&V.preventDefault()},[z]),onItemLeave:g.useCallback(V=>{var U;z(V)||((U=D.current)==null||U.focus(),E(null))},[z]),onTriggerLeave:g.useCallback(V=>{z(V)&&V.preventDefault()},[z]),pointerGraceTimerRef:P,onPointerGraceIntentChange:g.useCallback(V=>{F.current=V},[]),children:r.jsx(ue,{...de,children:r.jsx(Sf,{asChild:!0,trapped:a,onMountAutoFocus:Te(i,V=>{var U;V.preventDefault(),(U=D.current)==null||U.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:r.jsx(ql,{asChild:!0,disableOutsidePointerEvents:c,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:f,onInteractOutside:p,onDismiss:y,children:r.jsx(LD,{asChild:!0,...N,dir:b.dir,orientation:"vertical",loop:s,currentTabStopId:A,onCurrentTabStopIdChange:E,onEntryFocus:Te(d,V=>{b.isUsingKeyboardRef.current||V.preventDefault()}),preventScrollOnEntryFocus:!0,children:r.jsx(ng,{role:"menu","aria-orientation":"vertical","data-state":XI(_.open),"data-radix-menu-content":"",dir:b.dir,...w,...v,ref:M,style:{outline:"none",...v.style},onKeyDown:Te(v.onKeyDown,V=>{const O=V.target.closest("[data-radix-menu-content]")===V.currentTarget,I=V.ctrlKey||V.altKey||V.metaKey,H=V.key.length===1;O&&(V.key==="Tab"&&V.preventDefault(),!I&&H&&Q(V.key));const $=D.current;if(V.target!==$||!dne.includes(V.key))return;V.preventDefault();const X=S().filter(Z=>!Z.disabled).map(Z=>Z.ref.current);PI.includes(V.key)&&X.reverse(),Dne(X)}),onBlur:Te(t.onBlur,V=>{V.currentTarget.contains(V.target)||(window.clearTimeout(B.current),R.current="")}),onPointerMove:Te(t.onPointerMove,Xh(V=>{const U=V.target,O=ee.current!==V.clientX;if(V.currentTarget.contains(U)&&O){const I=V.clientX>ee.current?"right":"left";W.current=I,ee.current=V.clientX}}))})})})})})})});OI.displayName=Ls;var bne="MenuGroup",k1=g.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return r.jsx(Xe.div,{role:"group",...s,ref:e})});k1.displayName=bne;var jne="MenuLabel",LI=g.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return r.jsx(Xe.div,{...s,ref:e})});LI.displayName=jne;var A0="MenuItem",$C="menu.itemSelect",Ug=g.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:s,...a}=t,i=g.useRef(null),o=Rf(A0,t.__scopeMenu),c=N1(A0,t.__scopeMenu),d=Mt(e,i),u=g.useRef(!1),m=()=>{const f=i.current;if(!n&&f){const p=new CustomEvent($C,{bubbles:!0,cancelable:!0});f.addEventListener($C,y=>s==null?void 0:s(y),{once:!0}),Mb(f,p),p.defaultPrevented?u.current=!1:o.onClose()}};return r.jsx(FI,{...a,ref:d,disabled:n,onClick:Te(t.onClick,m),onPointerDown:f=>{var p;(p=t.onPointerDown)==null||p.call(t,f),u.current=!0},onPointerUp:Te(t.onPointerUp,f=>{var p;u.current||(p=f.currentTarget)==null||p.click()}),onKeyDown:Te(t.onKeyDown,f=>{const p=c.searchRef.current!=="";n||p&&f.key===" "||Mw.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});Ug.displayName=A0;var FI=g.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:s=!1,textValue:a,...i}=t,o=N1(A0,n),c=TI(n),d=g.useRef(null),u=Mt(e,d),[m,f]=g.useState(!1),[p,y]=g.useState("");return g.useEffect(()=>{const j=d.current;j&&y((j.textContent??"").trim())},[i.children]),r.jsx(Yh.ItemSlot,{scope:n,disabled:s,textValue:a??p,children:r.jsx(FD,{asChild:!0,...c,focusable:!s,children:r.jsx(Xe.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:u,onPointerMove:Te(t.onPointerMove,Xh(j=>{s?o.onItemLeave(j):(o.onItemEnter(j),j.defaultPrevented||j.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Te(t.onPointerLeave,Xh(j=>o.onItemLeave(j))),onFocus:Te(t.onFocus,()=>f(!0)),onBlur:Te(t.onBlur,()=>f(!1))})})})}),Nne="MenuCheckboxItem",BI=g.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:s,...a}=t;return r.jsx(WI,{scope:t.__scopeMenu,checked:n,children:r.jsx(Ug,{role:"menuitemcheckbox","aria-checked":P0(n)?"mixed":n,...a,ref:e,"data-state":E1(n),onSelect:Te(a.onSelect,()=>s==null?void 0:s(P0(n)?!0:!n),{checkForDefaultPrevented:!1})})})});BI.displayName=Nne;var zI="MenuRadioGroup",[Sne,kne]=Gl(zI,{value:void 0,onValueChange:()=>{}}),$I=g.forwardRef((t,e)=>{const{value:n,onValueChange:s,...a}=t,i=jn(s);return r.jsx(Sne,{scope:t.__scopeMenu,value:n,onValueChange:i,children:r.jsx(k1,{...a,ref:e})})});$I.displayName=zI;var UI="MenuRadioItem",qI=g.forwardRef((t,e)=>{const{value:n,...s}=t,a=kne(UI,t.__scopeMenu),i=n===a.value;return r.jsx(WI,{scope:t.__scopeMenu,checked:i,children:r.jsx(Ug,{role:"menuitemradio","aria-checked":i,...s,ref:e,"data-state":E1(i),onSelect:Te(s.onSelect,()=>{var o;return(o=a.onValueChange)==null?void 0:o.call(a,n)},{checkForDefaultPrevented:!1})})})});qI.displayName=UI;var C1="MenuItemIndicator",[WI,Cne]=Gl(C1,{checked:!1}),HI=g.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:s,...a}=t,i=Cne(C1,n);return r.jsx(Jn,{present:s||P0(i.checked)||i.checked===!0,children:r.jsx(Xe.span,{...a,ref:e,"data-state":E1(i.checked)})})});HI.displayName=C1;var Ene="MenuSeparator",VI=g.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return r.jsx(Xe.div,{role:"separator","aria-orientation":"horizontal",...s,ref:e})});VI.displayName=Ene;var Ane="MenuArrow",KI=g.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,a=$g(n);return r.jsx(rg,{...a,...s,ref:e})});KI.displayName=Ane;var Pne="MenuSub",[vae,ZI]=Gl(Pne),zu="MenuSubTrigger",GI=g.forwardRef((t,e)=>{const n=Ql(zu,t.__scopeMenu),s=Rf(zu,t.__scopeMenu),a=ZI(zu,t.__scopeMenu),i=N1(zu,t.__scopeMenu),o=g.useRef(null),{pointerGraceTimerRef:c,onPointerGraceIntentChange:d}=i,u={__scopeMenu:t.__scopeMenu},m=g.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return g.useEffect(()=>m,[m]),g.useEffect(()=>{const f=c.current;return()=>{window.clearTimeout(f),d(null)}},[c,d]),r.jsx(b1,{asChild:!0,...u,children:r.jsx(FI,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":XI(n.open),...t,ref:Z0(e,a.onTriggerChange),onClick:f=>{var p;(p=t.onClick)==null||p.call(t,f),!(t.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Te(t.onPointerMove,Xh(f=>{i.onItemEnter(f),!f.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),m()},100))})),onPointerLeave:Te(t.onPointerLeave,Xh(f=>{var y,j;m();const p=(y=n.content)==null?void 0:y.getBoundingClientRect();if(p){const v=(j=n.content)==null?void 0:j.dataset.side,_=v==="right",b=_?-5:5,w=p[_?"left":"right"],N=p[_?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+b,y:f.clientY},{x:w,y:p.top},{x:N,y:p.top},{x:N,y:p.bottom},{x:w,y:p.bottom}],side:v}),window.clearTimeout(c.current),c.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Te(t.onKeyDown,f=>{var y;const p=i.searchRef.current!=="";t.disabled||p&&f.key===" "||une[s.dir].includes(f.key)&&(n.onOpenChange(!0),(y=n.content)==null||y.focus(),f.preventDefault())})})})});GI.displayName=zu;var QI="MenuSubContent",YI=g.forwardRef((t,e)=>{const n=RI(Ls,t.__scopeMenu),{forceMount:s=n.forceMount,...a}=t,i=Ql(Ls,t.__scopeMenu),o=Rf(Ls,t.__scopeMenu),c=ZI(QI,t.__scopeMenu),d=g.useRef(null),u=Mt(e,d);return r.jsx(Yh.Provider,{scope:t.__scopeMenu,children:r.jsx(Jn,{present:s||i.open,children:r.jsx(Yh.Slot,{scope:t.__scopeMenu,children:r.jsx(S1,{id:c.contentId,"aria-labelledby":c.triggerId,...a,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{var f;o.isUsingKeyboardRef.current&&((f=d.current)==null||f.focus()),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:Te(t.onFocusOutside,m=>{m.target!==c.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Te(t.onEscapeKeyDown,m=>{o.onClose(),m.preventDefault()}),onKeyDown:Te(t.onKeyDown,m=>{var y;const f=m.currentTarget.contains(m.target),p=hne[o.dir].includes(m.key);f&&p&&(i.onOpenChange(!1),(y=c.trigger)==null||y.focus(),m.preventDefault())})})})})})});YI.displayName=QI;function XI(t){return t?"open":"closed"}function P0(t){return t==="indeterminate"}function E1(t){return P0(t)?"indeterminate":t?"checked":"unchecked"}function Dne(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function Tne(t,e){return t.map((n,s)=>t[(e+s)%t.length])}function Mne(t,e,n){const a=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=Tne(t,Math.max(i,0));a.length===1&&(o=o.filter(u=>u!==n));const d=o.find(u=>u.toLowerCase().startsWith(a.toLowerCase()));return d!==n?d:void 0}function Rne(t,e){const{x:n,y:s}=t;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const c=e[i].x,d=e[i].y,u=e[o].x,m=e[o].y;d>s!=m>s&&n<(u-c)*(s-d)/(m-d)+c&&(a=!a)}return a}function Ine(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return Rne(n,e)}function Xh(t){return e=>e.pointerType==="mouse"?t(e):void 0}var One=MI,Lne=b1,Fne=II,Bne=OI,zne=k1,$ne=LI,Une=Ug,qne=BI,Wne=$I,Hne=qI,Vne=HI,Kne=VI,Zne=KI,Gne=GI,Qne=YI,A1="DropdownMenu",[Yne,yae]=Ss(A1,[DI]),Wr=DI(),[Xne,JI]=Yne(A1),eO=t=>{const{__scopeDropdownMenu:e,children:n,dir:s,open:a,defaultOpen:i,onOpenChange:o,modal:c=!0}=t,d=Wr(e),u=g.useRef(null),[m=!1,f]=zs({prop:a,defaultProp:i,onChange:o});return r.jsx(Xne,{scope:e,triggerId:ps(),triggerRef:u,contentId:ps(),open:m,onOpenChange:f,onOpenToggle:g.useCallback(()=>f(p=>!p),[f]),modal:c,children:r.jsx(One,{...d,open:m,onOpenChange:f,dir:s,modal:c,children:n})})};eO.displayName=A1;var tO="DropdownMenuTrigger",nO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:s=!1,...a}=t,i=JI(tO,n),o=Wr(n);return r.jsx(Lne,{asChild:!0,...o,children:r.jsx(Xe.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...a,ref:Z0(e,i.triggerRef),onPointerDown:Te(t.onPointerDown,c=>{!s&&c.button===0&&c.ctrlKey===!1&&(i.onOpenToggle(),i.open||c.preventDefault())}),onKeyDown:Te(t.onKeyDown,c=>{s||(["Enter"," "].includes(c.key)&&i.onOpenToggle(),c.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(c.key)&&c.preventDefault())})})})});nO.displayName=tO;var Jne="DropdownMenuPortal",rO=t=>{const{__scopeDropdownMenu:e,...n}=t,s=Wr(e);return r.jsx(Fne,{...s,...n})};rO.displayName=Jne;var sO="DropdownMenuContent",aO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=JI(sO,n),i=Wr(n),o=g.useRef(!1);return r.jsx(Bne,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...s,ref:e,onCloseAutoFocus:Te(t.onCloseAutoFocus,c=>{var d;o.current||(d=a.triggerRef.current)==null||d.focus(),o.current=!1,c.preventDefault()}),onInteractOutside:Te(t.onInteractOutside,c=>{const d=c.detail.originalEvent,u=d.button===0&&d.ctrlKey===!0,m=d.button===2||u;(!a.modal||m)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});aO.displayName=sO;var ere="DropdownMenuGroup",tre=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Wr(n);return r.jsx(zne,{...a,...s,ref:e})});tre.displayName=ere;var nre="DropdownMenuLabel",iO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Wr(n);return r.jsx($ne,{...a,...s,ref:e})});iO.displayName=nre;var rre="DropdownMenuItem",oO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Wr(n);return r.jsx(Une,{...a,...s,ref:e})});oO.displayName=rre;var sre="DropdownMenuCheckboxItem",lO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Wr(n);return r.jsx(qne,{...a,...s,ref:e})});lO.displayName=sre;var are="DropdownMenuRadioGroup",ire=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Wr(n);return r.jsx(Wne,{...a,...s,ref:e})});ire.displayName=are;var ore="DropdownMenuRadioItem",cO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Wr(n);return r.jsx(Hne,{...a,...s,ref:e})});cO.displayName=ore;var lre="DropdownMenuItemIndicator",dO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Wr(n);return r.jsx(Vne,{...a,...s,ref:e})});dO.displayName=lre;var cre="DropdownMenuSeparator",uO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Wr(n);return r.jsx(Kne,{...a,...s,ref:e})});uO.displayName=cre;var dre="DropdownMenuArrow",ure=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Wr(n);return r.jsx(Zne,{...a,...s,ref:e})});ure.displayName=dre;var hre="DropdownMenuSubTrigger",hO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Wr(n);return r.jsx(Gne,{...a,...s,ref:e})});hO.displayName=hre;var fre="DropdownMenuSubContent",fO=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Wr(n);return r.jsx(Qne,{...a,...s,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});fO.displayName=fre;var mre=eO,pre=nO,gre=rO,mO=aO,pO=iO,gO=oO,xO=lO,vO=cO,yO=dO,_O=uO,wO=hO,bO=fO;const xre=mre,vre=pre,yre=g.forwardRef(({className:t,inset:e,children:n,...s},a)=>r.jsxs(wO,{ref:a,className:Oe("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",t),...s,children:[n,r.jsx(jl,{className:"ml-auto h-4 w-4"})]}));yre.displayName=wO.displayName;const _re=g.forwardRef(({className:t,...e},n)=>r.jsx(bO,{ref:n,className:Oe("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));_re.displayName=bO.displayName;const jO=g.forwardRef(({className:t,sideOffset:e=4,...n},s)=>r.jsx(gre,{children:r.jsx(mO,{ref:s,sideOffset:e,className:Oe("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));jO.displayName=mO.displayName;const bp=g.forwardRef(({className:t,inset:e,...n},s)=>r.jsx(gO,{ref:s,className:Oe("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",t),...n}));bp.displayName=gO.displayName;const wre=g.forwardRef(({className:t,children:e,checked:n,...s},a)=>r.jsxs(xO,{ref:a,className:Oe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...s,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(yO,{children:r.jsx(hf,{className:"h-4 w-4"})})}),e]}));wre.displayName=xO.displayName;const bre=g.forwardRef(({className:t,children:e,...n},s)=>r.jsxs(vO,{ref:s,className:Oe("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(yO,{children:r.jsx(LF,{className:"h-2 w-2 fill-current"})})}),e]}));bre.displayName=vO.displayName;const jre=g.forwardRef(({className:t,inset:e,...n},s)=>r.jsx(pO,{ref:s,className:Oe("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));jre.displayName=pO.displayName;const Nre=g.forwardRef(({className:t,...e},n)=>r.jsx(_O,{ref:n,className:Oe("-mx-1 my-1 h-px bg-muted",t),...e}));Nre.displayName=_O.displayName;function Sre(){const{theme:t,setTheme:e,actualTheme:n}=Ub();return r.jsxs(xre,{children:[r.jsx(vre,{asChild:!0,children:r.jsxs(J,{variant:"outline",size:"sm",className:"relative border-border/40 bg-background/80 backdrop-blur-sm hover:bg-accent/80 transition-all duration-200",children:[r.jsx(w_,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),r.jsx(y_,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),r.jsx("span",{className:"sr-only",children:"Theme wechseln"})]})}),r.jsxs(jO,{align:"end",className:"w-48 bg-background/95 backdrop-blur-sm border-border/40 shadow-lg",children:[r.jsxs(bp,{onClick:()=>e("light"),className:`flex items-center gap-2 cursor-pointer ${t==="light"?"bg-accent text-accent-foreground":""}`,children:[r.jsx(w_,{className:"h-4 w-4"}),r.jsx("span",{children:"Hell"}),t==="light"&&r.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),r.jsxs(bp,{onClick:()=>e("dark"),className:`flex items-center gap-2 cursor-pointer ${t==="dark"?"bg-accent text-accent-foreground":""}`,children:[r.jsx(y_,{className:"h-4 w-4"}),r.jsx("span",{children:"Dunkel"}),t==="dark"&&r.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),r.jsxs(bp,{onClick:()=>e("system"),className:`flex items-center gap-2 cursor-pointer ${t==="system"?"bg-accent text-accent-foreground":""}`,children:[r.jsx(KF,{className:"h-4 w-4"}),r.jsx("span",{children:"System"}),t==="system"&&r.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]})]})]})}function kre(){const{actualTheme:t,setTheme:e}=Ub(),n=()=>{e(t==="light"?"dark":"light")};return r.jsxs(J,{variant:"ghost",size:"sm",onClick:n,className:"relative h-9 w-9 p-0 rounded-full hover:bg-accent/80 transition-all duration-300 ease-out",children:[r.jsxs("div",{className:"relative h-4 w-4",children:[r.jsx(w_,{className:"absolute h-4 w-4 rotate-0 scale-100 transition-all duration-300 dark:-rotate-90 dark:scale-0"}),r.jsx(y_,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all duration-300 dark:rotate-0 dark:scale-100"})]}),r.jsx("span",{className:"sr-only",children:"Theme wechseln"})]})}const Cre=()=>{var u;const{user:t,userRole:e,loading:n,signOut:s}=Di(),a=Pi(),[i,o]=g.useState("dashboard"),c=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768;if(g.useEffect(()=>{n||(t?e==="employee"?a("/employee"):e==="manager"&&c()&&Ma({title:"Mobile Gerät erkannt",description:"Für die beste Erfahrung verwenden Sie die Employee-App"}):a("/login"))},[t,e,n]),n)return r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!t||e==="employee"||e!=="manager")return null;const d=()=>{switch(i){case"customers":return r.jsx(SQ,{});case"projects":return r.jsx($ee,{});case"personal":return r.jsx(tte,{});case"materials":return r.jsx(ste,{});case"machines":return r.jsx(dte,{});case"emails":return r.jsx(sne,{});case"documents":return r.jsx($te,{});case"invoice-validation":return r.jsx(Ute,{});case"finance":return r.jsx(ute,{});case"planner":return r.jsx(pte,{});case"timetracking":return r.jsx(Tte,{});case"vacation":return r.jsx(ane,{});case"company-settings":return r.jsx(qte,{});default:return r.jsx(lne,{onNavigate:o})}};return r.jsxs("div",{className:"min-h-screen w-full bg-gray-50",children:[r.jsx(Rq,{activeModule:i,onModuleChange:o}),r.jsxs("div",{className:"ml-16 lg:ml-16 flex flex-col min-h-screen",children:[r.jsx("header",{className:"h-20 border-b border-white/20 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl sticky top-0 z-30 shadow-lg shadow-blue-500/10",children:r.jsxs("div",{className:"flex items-center justify-between h-full px-8",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("img",{src:"/handwerkos-logo.svg",alt:"HandwerkOS Logo",className:"h-10 w-10 object-contain"}),r.jsx("h1",{className:"font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent text-3xl",children:"HandwerkOS"})]}),r.jsx(Ve,{variant:"secondary",className:"hidden sm:inline-flex bg-gradient-to-r from-blue-100 to-indigo-100 text-blue-700 border-0 shadow-sm",children:"Manager Dashboard"})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx(Sre,{}),r.jsxs(J,{variant:"outline",size:"sm",onClick:()=>a("/employee"),className:"hidden sm:flex bg-white/50 hover:bg-white/80 border-white/30 backdrop-blur-sm shadow-lg transition-all duration-200 hover:scale-105",children:[r.jsx(mf,{className:"w-4 h-4 mr-2"}),"Mitarbeiter-Ansicht"]}),r.jsxs("div",{className:"flex items-center space-x-2 text-sm text-slate-600 dark:text-slate-300 bg-white/30 dark:bg-slate-800/30 px-3 py-2 rounded-full backdrop-blur-sm",children:[r.jsx($s,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline font-medium",children:((u=t==null?void 0:t.email)==null?void 0:u.split("@")[0])||"Admin"})]})]})]})}),r.jsx("main",{className:"flex-1 overflow-auto",children:d()})]})]})},UC=()=>{const[t,e]=g.useState(!0),[n,s]=g.useState(!1),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(""),[m,f]=g.useState(""),[p,y]=g.useState(""),[j,v]=g.useState(""),[_,b]=g.useState(""),[w,N]=g.useState(""),[S,A]=g.useState(""),[E,D]=g.useState(""),[M,B]=g.useState("Deutschland"),[R,P]=g.useState(""),[F,W]=g.useState(""),[ee,ue]=g.useState(""),[de,Q]=g.useState(!1),{signIn:z,signUp:V,updatePassword:U}=mg(),O=Pi(),[I]=aj();g.useEffect(()=>{(async()=>{console.log("Current URL:",window.location.href),console.log("Search params:",window.location.search);const te=I.get("mode"),X=I.get("token");if(console.log("Auth check:",{mode:te,inviteToken:X}),te==="employee-setup"&&X){console.log("Processing employee invitation token:",X);try{const{data:Z,error:ie}=await K.from("employee_invitations").select("*").eq("invite_token",X).eq("status","pending").single();if(ie||!Z){console.error("Invalid invitation token:",ie),Et.error("Ungültiger oder abgelaufener Einladungslink. Bitte wenden Sie sich an Ihren Manager.");return}if(new Date(Z.expires_at)<new Date){console.error("Invitation token expired"),Et.error("Dieser Einladungslink ist abgelaufen. Bitte fordern Sie eine neue Einladung an.");return}console.log("Valid invitation found:",Z),i(Z.email),s(!0),window.invitationData=Z}catch(Z){console.error("Error validating invitation:",Z),Et.error("Fehler beim Validieren der Einladung.")}}else te==="employee-setup"&&!X&&Et.error("Fehlender Einladungstoken. Bitte verwenden Sie den vollständigen Link aus der E-Mail.")})()},[I]);const H=async $=>{var te,X;$.preventDefault(),Q(!0);try{if(n){const pe=window.invitationData;if(!pe){Et.error("Einladungsdaten nicht gefunden. Bitte verwenden Sie den Link aus der E-Mail erneut."),s(!1);return}if(o!==d){Et.error("Passwörter stimmen nicht überein");return}if(o.length<6){Et.error("Passwort muss mindestens 6 Zeichen lang sein");return}console.log("Creating account for employee:",pe.email);try{const{data:G,error:se}=await K.auth.signUp({email:pe.email,password:o,options:{data:{first_name:((te=pe.employee_data)==null?void 0:te.firstName)||"",last_name:((X=pe.employee_data)==null?void 0:X.lastName)||"",company_id:pe.company_id}}});if(se){console.error("Error creating user account:",se),Et.error(se.message||"Fehler beim Erstellen des Kontos");return}G.user&&(await K.from("employee_invitations").update({status:"accepted"}).eq("invite_token",pe.invite_token),await K.from("user_roles").insert({user_id:G.user.id,role:"employee"}),console.log("Employee account created successfully"),Et.success("Konto erfolgreich erstellt! Sie können sich jetzt anmelden."),s(!1),e(!0),c(""),u(""))}catch(G){console.error("Error during employee registration:",G),Et.error("Fehler beim Erstellen des Kontos")}return}if(t){const{error:pe}=await z(a,o);pe?Et.error(pe.message):O("/manager");return}if(o.length<6){Et.error("Passwort muss mindestens 6 Zeichen lang sein");return}if(o!==d){Et.error("Passwörter stimmen nicht überein");return}const Z={firstName:m,lastName:p,companyName:j,phone:_,streetAddress:w,postalCode:S,city:E,country:M,vatId:R,voucherCode:F,referralSource:ee},{error:ie}=await V(a,o,Z);ie?Et.error(ie.message):Et.success("Registrierung erfolgreich! Bitte bestätigen Sie Ihre E-Mail.")}finally{Q(!1)}};return r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50",children:[r.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-center gap-3",children:[r.jsx("img",{src:"/handwerkos-logo.svg",alt:"HandwerkOS Logo",className:"h-12 w-12 object-contain"}),r.jsx("h1",{className:"text-3xl font-bold tracking-wide",children:"HandwerkOS"})]}),r.jsx("p",{className:"text-center text-blue-100 mt-2 text-sm",children:"Die moderne Software-Lösung für Handwerksbetriebe"})]}),r.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-120px)] p-4",children:r.jsxs(le,{className:"w-full max-w-2xl shadow-xl border-0 bg-white/80 backdrop-blur-sm",children:[r.jsxs(Ce,{className:"text-center space-y-4 pb-8",children:[r.jsx(Ee,{className:"flex items-center justify-center gap-3 text-2xl font-bold text-gray-800",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:r.jsx(Q2,{className:"h-6 w-6 text-blue-600"})}),"Passwort erstellen"]}):t?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:r.jsx($s,{className:"h-6 w-6 text-green-600"})}),"Anmeldung"]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"p-2 bg-orange-100 rounded-full",children:r.jsx(X2,{className:"h-6 w-6 text-orange-600"})}),"Registrierung"]})}),r.jsx(Sr,{className:"text-base text-gray-600",children:n?"Erstellen Sie Ihr Passwort für Ihren HandwerkOS Account":t?"Willkommen zurück! Melden Sie sich in Ihrem HandwerkOS Account an":"Starten Sie jetzt mit HandwerkOS und digitalisieren Sie Ihren Betrieb"})]}),r.jsx(ce,{children:r.jsxs("form",{onSubmit:H,className:"space-y-4",children:[n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"password",children:"Neues Passwort"}),r.jsx(ne,{id:"password",type:"password",value:o,onChange:$=>c($.target.value),required:!0,placeholder:"Mindestens 6 Zeichen"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"confirmPassword",children:"Passwort bestätigen"}),r.jsx(ne,{id:"confirmPassword",type:"password",value:d,onChange:$=>u($.target.value),required:!0,placeholder:"Passwort wiederholen"})]})]}):t?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"email",children:"E-Mail"}),r.jsx(ne,{id:"email",type:"email",value:a,onChange:$=>i($.target.value),required:!0,placeholder:"ihre@email.de"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"password",children:"Passwort"}),r.jsx(ne,{id:"password",type:"password",value:o,onChange:$=>c($.target.value),required:!0,placeholder:"Ihr Passwort"})]})]}):r.jsx(r.Fragment,{children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Persönliche Daten"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"firstName",children:"Vorname *"}),r.jsx(ne,{id:"firstName",type:"text",value:m,onChange:$=>f($.target.value),required:!0,placeholder:"Ihr Vorname"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"lastName",children:"Nachname *"}),r.jsx(ne,{id:"lastName",type:"text",value:p,onChange:$=>y($.target.value),required:!0,placeholder:"Ihr Nachname"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"email",children:"E-Mail *"}),r.jsx(ne,{id:"email",type:"email",value:a,onChange:$=>i($.target.value),required:!0,placeholder:"ihre@email.de"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"phone",children:"Telefon"}),r.jsx(ne,{id:"phone",type:"tel",value:_,onChange:$=>b($.target.value),placeholder:"+49 123 456789"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Firmendaten"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"companyName",children:"Firmenname *"}),r.jsx(ne,{id:"companyName",type:"text",value:j,onChange:$=>v($.target.value),required:!0,placeholder:"Ihre Firma"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"vatId",children:"USt-IdNr."}),r.jsx(ne,{id:"vatId",type:"text",value:R,onChange:$=>P($.target.value),placeholder:"DE123456789"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Zusätzliche Angaben (optional)"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"voucherCode",children:"Gutscheincode"}),r.jsx(ne,{id:"voucherCode",type:"text",value:F,onChange:$=>W($.target.value),placeholder:"Falls vorhanden"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"referralSource",children:"Wie haben Sie von uns erfahren?"}),r.jsxs(vt,{value:ee,onValueChange:ue,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Bitte auswählen"})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Google",children:"Google"}),r.jsx(ye,{value:"Social Media",children:"Social Media"}),r.jsx(ye,{value:"Empfehlung",children:"Empfehlung"}),r.jsx(ye,{value:"Werbung",children:"Werbung"}),r.jsx(ye,{value:"Messe",children:"Messe"}),r.jsx(ye,{value:"Sonstiges",children:"Sonstiges"})]})]})]})]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Adresse"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"streetAddress",children:"Straße & Hausnummer"}),r.jsx(ne,{id:"streetAddress",type:"text",value:w,onChange:$=>N($.target.value),placeholder:"Musterstraße 123"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"postalCode",children:"PLZ"}),r.jsx(ne,{id:"postalCode",type:"text",value:S,onChange:$=>A($.target.value),placeholder:"12345"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"city",children:"Stadt"}),r.jsx(ne,{id:"city",type:"text",value:E,onChange:$=>D($.target.value),placeholder:"Musterstadt"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"country",children:"Land"}),r.jsxs(vt,{value:M,onValueChange:B,children:[r.jsx(pt,{children:r.jsx(yt,{placeholder:"Land auswählen"})}),r.jsxs(gt,{children:[r.jsx(ye,{value:"Deutschland",children:"Deutschland"}),r.jsx(ye,{value:"Österreich",children:"Österreich"}),r.jsx(ye,{value:"Schweiz",children:"Schweiz"}),r.jsx(ye,{value:"Niederlande",children:"Niederlande"}),r.jsx(ye,{value:"Belgien",children:"Belgien"}),r.jsx(ye,{value:"Frankreich",children:"Frankreich"})]})]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Passwort"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"password",children:"Passwort *"}),r.jsx(ne,{id:"password",type:"password",value:o,onChange:$=>c($.target.value),required:!0,placeholder:"Mindestens 6 Zeichen"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"confirmPassword",children:"Passwort bestätigen *"}),r.jsx(ne,{id:"confirmPassword",type:"password",value:d,onChange:$=>u($.target.value),required:!0,placeholder:"Passwort wiederholen"})]})]}),r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Wa,{id:"terms",required:!0}),r.jsxs(Y,{htmlFor:"terms",className:"text-sm",children:["Ich stimme den"," ",r.jsx("a",{href:"#",className:"text-primary underline hover:no-underline",onClick:$=>$.preventDefault(),children:"Allgemeinen Geschäftsbedingungen"})," ","und der"," ",r.jsx("a",{href:"#",className:"text-primary underline hover:no-underline",onClick:$=>$.preventDefault(),children:"Datenschutzerklärung"})," ","zu *"]})]})})]})]})}),r.jsx(J,{type:"submit",className:"w-full h-12 text-lg font-semibold bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 shadow-lg hover:shadow-xl transition-all duration-200",disabled:de,children:de?r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),n?"Wird erstellt...":t?"Wird angemeldet...":"Wird registriert..."]}):n?r.jsxs(r.Fragment,{children:[r.jsx(Q2,{className:"h-5 w-5 mr-2"}),"Passwort erstellen"]}):t?r.jsxs(r.Fragment,{children:[r.jsx($s,{className:"h-5 w-5 mr-2"}),"Jetzt anmelden"]}):r.jsxs(r.Fragment,{children:[r.jsx(X2,{className:"h-5 w-5 mr-2"}),"Kostenlos registrieren"]})}),!n&&r.jsx("div",{className:"text-center pt-4 border-t",children:r.jsx(J,{type:"button",variant:"ghost",onClick:()=>e(!t),className:"text-sm text-gray-600 hover:text-blue-600 font-medium",children:t?"Noch kein Account? Jetzt kostenlos registrieren":"Bereits registriert? Zur Anmeldung"})})]})})]})}),r.jsxs("div",{className:"text-center pb-6",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"© 2024 HandwerkOS - Die digitale Zukunft des Handwerks"}),r.jsxs("div",{className:"flex justify-center gap-6 mt-2 text-xs text-gray-400",children:[r.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Datenschutz"}),r.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Impressum"}),r.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Support"})]})]})]})};function NO(t,e){const n=g.useRef(e);g.useEffect(function(){e!==n.current&&t.attributionControl!=null&&(n.current!=null&&t.attributionControl.removeAttribution(n.current),e!=null&&t.attributionControl.addAttribution(e)),n.current=e},[t,e])}function Ere(t,e,n){e.center!==n.center&&t.setLatLng(e.center),e.radius!=null&&e.radius!==n.radius&&t.setRadius(e.radius)}const Are=1;function Pre(t){return Object.freeze({__version:Are,map:t})}function SO(t,e){return Object.freeze({...t,...e})}const kO=g.createContext(null),CO=kO.Provider;function qg(){const t=g.useContext(kO);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function EO(t){function e(n,s){const{instance:a,context:i}=t(n).current;return g.useImperativeHandle(s,()=>a),n.children==null?null:ke.createElement(CO,{value:i},n.children)}return g.forwardRef(e)}function Dre(t){function e(n,s){const[a,i]=g.useState(!1),{instance:o}=t(n,i).current;g.useImperativeHandle(s,()=>o),g.useEffect(function(){a&&o.update()},[o,a,n.children]);const c=o._contentNode;return c?$o.createPortal(n.children,c):null}return g.forwardRef(e)}function Tre(t){function e(n,s){const{instance:a}=t(n).current;return g.useImperativeHandle(s,()=>a),null}return g.forwardRef(e)}function P1(t,e){const n=g.useRef();g.useEffect(function(){return e!=null&&t.instance.on(e),n.current=e,function(){n.current!=null&&t.instance.off(n.current),n.current=null}},[t,e])}function Wg(t,e){const n=t.pane??e.pane;return n?{...t,pane:n}:t}function Mre(t,e){return function(s,a){const i=qg(),o=t(Wg(s,i),i);return NO(i.map,s.attribution),P1(o.current,s.eventHandlers),e(o.current,i,s,a),o}}var Rw={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,s){s(e)})(ht,function(n){var s="1.9.4";function a(l){var h,x,k,T;for(x=1,k=arguments.length;x<k;x++){T=arguments[x];for(h in T)l[h]=T[h]}return l}var i=Object.create||function(){function l(){}return function(h){return l.prototype=h,new l}}();function o(l,h){var x=Array.prototype.slice;if(l.bind)return l.bind.apply(l,x.call(arguments,1));var k=x.call(arguments,2);return function(){return l.apply(h,k.length?k.concat(x.call(arguments)):arguments)}}var c=0;function d(l){return"_leaflet_id"in l||(l._leaflet_id=++c),l._leaflet_id}function u(l,h,x){var k,T,q,ae;return ae=function(){k=!1,T&&(q.apply(x,T),T=!1)},q=function(){k?T=arguments:(l.apply(x,arguments),setTimeout(ae,h),k=!0)},q}function m(l,h,x){var k=h[1],T=h[0],q=k-T;return l===k&&x?l:((l-T)%q+q)%q+T}function f(){return!1}function p(l,h){if(h===!1)return l;var x=Math.pow(10,h===void 0?6:h);return Math.round(l*x)/x}function y(l){return l.trim?l.trim():l.replace(/^\s+|\s+$/g,"")}function j(l){return y(l).split(/\s+/)}function v(l,h){Object.prototype.hasOwnProperty.call(l,"options")||(l.options=l.options?i(l.options):{});for(var x in h)l.options[x]=h[x];return l.options}function _(l,h,x){var k=[];for(var T in l)k.push(encodeURIComponent(x?T.toUpperCase():T)+"="+encodeURIComponent(l[T]));return(!h||h.indexOf("?")===-1?"?":"&")+k.join("&")}var b=/\{ *([\w_ -]+) *\}/g;function w(l,h){return l.replace(b,function(x,k){var T=h[k];if(T===void 0)throw new Error("No value provided for variable "+x);return typeof T=="function"&&(T=T(h)),T})}var N=Array.isArray||function(l){return Object.prototype.toString.call(l)==="[object Array]"};function S(l,h){for(var x=0;x<l.length;x++)if(l[x]===h)return x;return-1}var A="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function E(l){return window["webkit"+l]||window["moz"+l]||window["ms"+l]}var D=0;function M(l){var h=+new Date,x=Math.max(0,16-(h-D));return D=h+x,window.setTimeout(l,x)}var B=window.requestAnimationFrame||E("RequestAnimationFrame")||M,R=window.cancelAnimationFrame||E("CancelAnimationFrame")||E("CancelRequestAnimationFrame")||function(l){window.clearTimeout(l)};function P(l,h,x){if(x&&B===M)l.call(h);else return B.call(window,o(l,h))}function F(l){l&&R.call(window,l)}var W={__proto__:null,extend:a,create:i,bind:o,get lastId(){return c},stamp:d,throttle:u,wrapNum:m,falseFn:f,formatNum:p,trim:y,splitWords:j,setOptions:v,getParamString:_,template:w,isArray:N,indexOf:S,emptyImageUrl:A,requestFn:B,cancelFn:R,requestAnimFrame:P,cancelAnimFrame:F};function ee(){}ee.extend=function(l){var h=function(){v(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},x=h.__super__=this.prototype,k=i(x);k.constructor=h,h.prototype=k;for(var T in this)Object.prototype.hasOwnProperty.call(this,T)&&T!=="prototype"&&T!=="__super__"&&(h[T]=this[T]);return l.statics&&a(h,l.statics),l.includes&&(ue(l.includes),a.apply(null,[k].concat(l.includes))),a(k,l),delete k.statics,delete k.includes,k.options&&(k.options=x.options?i(x.options):{},a(k.options,l.options)),k._initHooks=[],k.callInitHooks=function(){if(!this._initHooksCalled){x.callInitHooks&&x.callInitHooks.call(this),this._initHooksCalled=!0;for(var q=0,ae=k._initHooks.length;q<ae;q++)k._initHooks[q].call(this)}},h},ee.include=function(l){var h=this.prototype.options;return a(this.prototype,l),l.options&&(this.prototype.options=h,this.mergeOptions(l.options)),this},ee.mergeOptions=function(l){return a(this.prototype.options,l),this},ee.addInitHook=function(l){var h=Array.prototype.slice.call(arguments,1),x=typeof l=="function"?l:function(){this[l].apply(this,h)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(x),this};function ue(l){if(!(typeof L>"u"||!L||!L.Mixin)){l=N(l)?l:[l];for(var h=0;h<l.length;h++)l[h]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var de={on:function(l,h,x){if(typeof l=="object")for(var k in l)this._on(k,l[k],h);else{l=j(l);for(var T=0,q=l.length;T<q;T++)this._on(l[T],h,x)}return this},off:function(l,h,x){if(!arguments.length)delete this._events;else if(typeof l=="object")for(var k in l)this._off(k,l[k],h);else{l=j(l);for(var T=arguments.length===1,q=0,ae=l.length;q<ae;q++)T?this._off(l[q]):this._off(l[q],h,x)}return this},_on:function(l,h,x,k){if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}if(this._listens(l,h,x)===!1){x===this&&(x=void 0);var T={fn:h,ctx:x};k&&(T.once=!0),this._events=this._events||{},this._events[l]=this._events[l]||[],this._events[l].push(T)}},_off:function(l,h,x){var k,T,q;if(this._events&&(k=this._events[l],!!k)){if(arguments.length===1){if(this._firingCount)for(T=0,q=k.length;T<q;T++)k[T].fn=f;delete this._events[l];return}if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}var ae=this._listens(l,h,x);if(ae!==!1){var fe=k[ae];this._firingCount&&(fe.fn=f,this._events[l]=k=k.slice()),k.splice(ae,1)}}},fire:function(l,h,x){if(!this.listens(l,x))return this;var k=a({},h,{type:l,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var T=this._events[l];if(T){this._firingCount=this._firingCount+1||1;for(var q=0,ae=T.length;q<ae;q++){var fe=T[q],ve=fe.fn;fe.once&&this.off(l,ve,fe.ctx),ve.call(fe.ctx||this,k)}this._firingCount--}}return x&&this._propagateEvent(k),this},listens:function(l,h,x,k){typeof l!="string"&&console.warn('"string" type argument expected');var T=h;typeof h!="function"&&(k=!!h,T=void 0,x=void 0);var q=this._events&&this._events[l];if(q&&q.length&&this._listens(l,T,x)!==!1)return!0;if(k){for(var ae in this._eventParents)if(this._eventParents[ae].listens(l,h,x,k))return!0}return!1},_listens:function(l,h,x){if(!this._events)return!1;var k=this._events[l]||[];if(!h)return!!k.length;x===this&&(x=void 0);for(var T=0,q=k.length;T<q;T++)if(k[T].fn===h&&k[T].ctx===x)return T;return!1},once:function(l,h,x){if(typeof l=="object")for(var k in l)this._on(k,l[k],h,!0);else{l=j(l);for(var T=0,q=l.length;T<q;T++)this._on(l[T],h,x,!0)}return this},addEventParent:function(l){return this._eventParents=this._eventParents||{},this._eventParents[d(l)]=l,this},removeEventParent:function(l){return this._eventParents&&delete this._eventParents[d(l)],this},_propagateEvent:function(l){for(var h in this._eventParents)this._eventParents[h].fire(l.type,a({layer:l.target,propagatedFrom:l.target},l),!0)}};de.addEventListener=de.on,de.removeEventListener=de.clearAllEventListeners=de.off,de.addOneTimeEventListener=de.once,de.fireEvent=de.fire,de.hasEventListeners=de.listens;var Q=ee.extend(de);function z(l,h,x){this.x=x?Math.round(l):l,this.y=x?Math.round(h):h}var V=Math.trunc||function(l){return l>0?Math.floor(l):Math.ceil(l)};z.prototype={clone:function(){return new z(this.x,this.y)},add:function(l){return this.clone()._add(U(l))},_add:function(l){return this.x+=l.x,this.y+=l.y,this},subtract:function(l){return this.clone()._subtract(U(l))},_subtract:function(l){return this.x-=l.x,this.y-=l.y,this},divideBy:function(l){return this.clone()._divideBy(l)},_divideBy:function(l){return this.x/=l,this.y/=l,this},multiplyBy:function(l){return this.clone()._multiplyBy(l)},_multiplyBy:function(l){return this.x*=l,this.y*=l,this},scaleBy:function(l){return new z(this.x*l.x,this.y*l.y)},unscaleBy:function(l){return new z(this.x/l.x,this.y/l.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=V(this.x),this.y=V(this.y),this},distanceTo:function(l){l=U(l);var h=l.x-this.x,x=l.y-this.y;return Math.sqrt(h*h+x*x)},equals:function(l){return l=U(l),l.x===this.x&&l.y===this.y},contains:function(l){return l=U(l),Math.abs(l.x)<=Math.abs(this.x)&&Math.abs(l.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function U(l,h,x){return l instanceof z?l:N(l)?new z(l[0],l[1]):l==null?l:typeof l=="object"&&"x"in l&&"y"in l?new z(l.x,l.y):new z(l,h,x)}function O(l,h){if(l)for(var x=h?[l,h]:l,k=0,T=x.length;k<T;k++)this.extend(x[k])}O.prototype={extend:function(l){var h,x;if(!l)return this;if(l instanceof z||typeof l[0]=="number"||"x"in l)h=x=U(l);else if(l=I(l),h=l.min,x=l.max,!h||!x)return this;return!this.min&&!this.max?(this.min=h.clone(),this.max=x.clone()):(this.min.x=Math.min(h.x,this.min.x),this.max.x=Math.max(x.x,this.max.x),this.min.y=Math.min(h.y,this.min.y),this.max.y=Math.max(x.y,this.max.y)),this},getCenter:function(l){return U((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,l)},getBottomLeft:function(){return U(this.min.x,this.max.y)},getTopRight:function(){return U(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(l){var h,x;return typeof l[0]=="number"||l instanceof z?l=U(l):l=I(l),l instanceof O?(h=l.min,x=l.max):h=x=l,h.x>=this.min.x&&x.x<=this.max.x&&h.y>=this.min.y&&x.y<=this.max.y},intersects:function(l){l=I(l);var h=this.min,x=this.max,k=l.min,T=l.max,q=T.x>=h.x&&k.x<=x.x,ae=T.y>=h.y&&k.y<=x.y;return q&&ae},overlaps:function(l){l=I(l);var h=this.min,x=this.max,k=l.min,T=l.max,q=T.x>h.x&&k.x<x.x,ae=T.y>h.y&&k.y<x.y;return q&&ae},isValid:function(){return!!(this.min&&this.max)},pad:function(l){var h=this.min,x=this.max,k=Math.abs(h.x-x.x)*l,T=Math.abs(h.y-x.y)*l;return I(U(h.x-k,h.y-T),U(x.x+k,x.y+T))},equals:function(l){return l?(l=I(l),this.min.equals(l.getTopLeft())&&this.max.equals(l.getBottomRight())):!1}};function I(l,h){return!l||l instanceof O?l:new O(l,h)}function H(l,h){if(l)for(var x=h?[l,h]:l,k=0,T=x.length;k<T;k++)this.extend(x[k])}H.prototype={extend:function(l){var h=this._southWest,x=this._northEast,k,T;if(l instanceof te)k=l,T=l;else if(l instanceof H){if(k=l._southWest,T=l._northEast,!k||!T)return this}else return l?this.extend(X(l)||$(l)):this;return!h&&!x?(this._southWest=new te(k.lat,k.lng),this._northEast=new te(T.lat,T.lng)):(h.lat=Math.min(k.lat,h.lat),h.lng=Math.min(k.lng,h.lng),x.lat=Math.max(T.lat,x.lat),x.lng=Math.max(T.lng,x.lng)),this},pad:function(l){var h=this._southWest,x=this._northEast,k=Math.abs(h.lat-x.lat)*l,T=Math.abs(h.lng-x.lng)*l;return new H(new te(h.lat-k,h.lng-T),new te(x.lat+k,x.lng+T))},getCenter:function(){return new te((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new te(this.getNorth(),this.getWest())},getSouthEast:function(){return new te(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(l){typeof l[0]=="number"||l instanceof te||"lat"in l?l=X(l):l=$(l);var h=this._southWest,x=this._northEast,k,T;return l instanceof H?(k=l.getSouthWest(),T=l.getNorthEast()):k=T=l,k.lat>=h.lat&&T.lat<=x.lat&&k.lng>=h.lng&&T.lng<=x.lng},intersects:function(l){l=$(l);var h=this._southWest,x=this._northEast,k=l.getSouthWest(),T=l.getNorthEast(),q=T.lat>=h.lat&&k.lat<=x.lat,ae=T.lng>=h.lng&&k.lng<=x.lng;return q&&ae},overlaps:function(l){l=$(l);var h=this._southWest,x=this._northEast,k=l.getSouthWest(),T=l.getNorthEast(),q=T.lat>h.lat&&k.lat<x.lat,ae=T.lng>h.lng&&k.lng<x.lng;return q&&ae},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(l,h){return l?(l=$(l),this._southWest.equals(l.getSouthWest(),h)&&this._northEast.equals(l.getNorthEast(),h)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function $(l,h){return l instanceof H?l:new H(l,h)}function te(l,h,x){if(isNaN(l)||isNaN(h))throw new Error("Invalid LatLng object: ("+l+", "+h+")");this.lat=+l,this.lng=+h,x!==void 0&&(this.alt=+x)}te.prototype={equals:function(l,h){if(!l)return!1;l=X(l);var x=Math.max(Math.abs(this.lat-l.lat),Math.abs(this.lng-l.lng));return x<=(h===void 0?1e-9:h)},toString:function(l){return"LatLng("+p(this.lat,l)+", "+p(this.lng,l)+")"},distanceTo:function(l){return ie.distance(this,X(l))},wrap:function(){return ie.wrapLatLng(this)},toBounds:function(l){var h=180*l/40075017,x=h/Math.cos(Math.PI/180*this.lat);return $([this.lat-h,this.lng-x],[this.lat+h,this.lng+x])},clone:function(){return new te(this.lat,this.lng,this.alt)}};function X(l,h,x){return l instanceof te?l:N(l)&&typeof l[0]!="object"?l.length===3?new te(l[0],l[1],l[2]):l.length===2?new te(l[0],l[1]):null:l==null?l:typeof l=="object"&&"lat"in l?new te(l.lat,"lng"in l?l.lng:l.lon,l.alt):h===void 0?null:new te(l,h,x)}var Z={latLngToPoint:function(l,h){var x=this.projection.project(l),k=this.scale(h);return this.transformation._transform(x,k)},pointToLatLng:function(l,h){var x=this.scale(h),k=this.transformation.untransform(l,x);return this.projection.unproject(k)},project:function(l){return this.projection.project(l)},unproject:function(l){return this.projection.unproject(l)},scale:function(l){return 256*Math.pow(2,l)},zoom:function(l){return Math.log(l/256)/Math.LN2},getProjectedBounds:function(l){if(this.infinite)return null;var h=this.projection.bounds,x=this.scale(l),k=this.transformation.transform(h.min,x),T=this.transformation.transform(h.max,x);return new O(k,T)},infinite:!1,wrapLatLng:function(l){var h=this.wrapLng?m(l.lng,this.wrapLng,!0):l.lng,x=this.wrapLat?m(l.lat,this.wrapLat,!0):l.lat,k=l.alt;return new te(x,h,k)},wrapLatLngBounds:function(l){var h=l.getCenter(),x=this.wrapLatLng(h),k=h.lat-x.lat,T=h.lng-x.lng;if(k===0&&T===0)return l;var q=l.getSouthWest(),ae=l.getNorthEast(),fe=new te(q.lat-k,q.lng-T),ve=new te(ae.lat-k,ae.lng-T);return new H(fe,ve)}},ie=a({},Z,{wrapLng:[-180,180],R:6371e3,distance:function(l,h){var x=Math.PI/180,k=l.lat*x,T=h.lat*x,q=Math.sin((h.lat-l.lat)*x/2),ae=Math.sin((h.lng-l.lng)*x/2),fe=q*q+Math.cos(k)*Math.cos(T)*ae*ae,ve=2*Math.atan2(Math.sqrt(fe),Math.sqrt(1-fe));return this.R*ve}}),pe=6378137,G={R:pe,MAX_LATITUDE:85.0511287798,project:function(l){var h=Math.PI/180,x=this.MAX_LATITUDE,k=Math.max(Math.min(x,l.lat),-x),T=Math.sin(k*h);return new z(this.R*l.lng*h,this.R*Math.log((1+T)/(1-T))/2)},unproject:function(l){var h=180/Math.PI;return new te((2*Math.atan(Math.exp(l.y/this.R))-Math.PI/2)*h,l.x*h/this.R)},bounds:function(){var l=pe*Math.PI;return new O([-l,-l],[l,l])}()};function se(l,h,x,k){if(N(l)){this._a=l[0],this._b=l[1],this._c=l[2],this._d=l[3];return}this._a=l,this._b=h,this._c=x,this._d=k}se.prototype={transform:function(l,h){return this._transform(l.clone(),h)},_transform:function(l,h){return h=h||1,l.x=h*(this._a*l.x+this._b),l.y=h*(this._c*l.y+this._d),l},untransform:function(l,h){return h=h||1,new z((l.x/h-this._b)/this._a,(l.y/h-this._d)/this._c)}};function me(l,h,x,k){return new se(l,h,x,k)}var he=a({},ie,{code:"EPSG:3857",projection:G,transformation:function(){var l=.5/(Math.PI*G.R);return me(l,.5,-l,.5)}()}),xe=a({},he,{code:"EPSG:900913"});function re(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function _e(l,h){var x="",k,T,q,ae,fe,ve;for(k=0,q=l.length;k<q;k++){for(fe=l[k],T=0,ae=fe.length;T<ae;T++)ve=fe[T],x+=(T?"L":"M")+ve.x+" "+ve.y;x+=h?tt.svg?"z":"x":""}return x||"M0 0"}var be=document.documentElement.style,Be="ActiveXObject"in window,Ke=Be&&!document.addEventListener,At="msLaunchUri"in navigator&&!("documentMode"in document),je=Dr("webkit"),De=Dr("android"),Ie=Dr("android 2")||Dr("android 3"),at=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),$e=De&&Dr("Google")&&at<537&&!("AudioNode"in window),Me=!!window.opera,Nt=!At&&Dr("chrome"),ft=Dr("gecko")&&!je&&!Me&&!Be,Ln=!Nt&&Dr("safari"),yr=Dr("phantom"),xt="OTransition"in be,mn=navigator.platform.indexOf("Win")===0,Mn=Be&&"transition"in be,cr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ie,Wn="MozPerspective"in be,Nn=!window.L_DISABLE_3D&&(Mn||cr||Wn)&&!xt&&!yr,Hr=typeof orientation<"u"||Dr("mobile"),it=Hr&&je,Kt=Hr&&cr,Bt=!window.PointerEvent&&window.MSPointerEvent,dt=!!(window.PointerEvent||Bt),Yt="ontouchstart"in window||!!window.TouchEvent,we=!window.L_NO_TOUCH&&(Yt||dt),Ne=Hr&&Me,rt=Hr&&ft,et=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ut=function(){var l=!1;try{var h=Object.defineProperty({},"passive",{get:function(){l=!0}});window.addEventListener("testPassiveEventSupport",f,h),window.removeEventListener("testPassiveEventSupport",f,h)}catch{}return l}(),on=function(){return!!document.createElement("canvas").getContext}(),Hn=!!(document.createElementNS&&re("svg").createSVGRect),_a=!!Hn&&function(){var l=document.createElement("div");return l.innerHTML="<svg/>",(l.firstChild&&l.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Ja=!Hn&&function(){try{var l=document.createElement("div");l.innerHTML='<v:shape adj="1"/>';var h=l.firstChild;return h.style.behavior="url(#default#VML)",h&&typeof h.adj=="object"}catch{return!1}}(),Vn=navigator.platform.indexOf("Mac")===0,Pr=navigator.platform.indexOf("Linux")===0;function Dr(l){return navigator.userAgent.toLowerCase().indexOf(l)>=0}var tt={ie:Be,ielt9:Ke,edge:At,webkit:je,android:De,android23:Ie,androidStock:$e,opera:Me,chrome:Nt,gecko:ft,safari:Ln,phantom:yr,opera12:xt,win:mn,ie3d:Mn,webkit3d:cr,gecko3d:Wn,any3d:Nn,mobile:Hr,mobileWebkit:it,mobileWebkit3d:Kt,msPointer:Bt,pointer:dt,touch:we,touchNative:Yt,mobileOpera:Ne,mobileGecko:rt,retina:et,passiveEvents:ut,canvas:on,svg:Hn,vml:Ja,inlineSvg:_a,mac:Vn,linux:Pr},Zo=tt.msPointer?"MSPointerDown":"pointerdown",F1=tt.msPointer?"MSPointerMove":"pointermove",B1=tt.msPointer?"MSPointerUp":"pointerup",z1=tt.msPointer?"MSPointerCancel":"pointercancel",Gg={touchstart:Zo,touchmove:F1,touchend:B1,touchcancel:z1},$1={touchstart:a5,touchmove:If,touchend:If,touchcancel:If},Yl={},U1=!1;function e5(l,h,x){return h==="touchstart"&&s5(),$1[h]?(x=$1[h].bind(this,x),l.addEventListener(Gg[h],x,!1),x):(console.warn("wrong event specified:",h),f)}function t5(l,h,x){if(!Gg[h]){console.warn("wrong event specified:",h);return}l.removeEventListener(Gg[h],x,!1)}function n5(l){Yl[l.pointerId]=l}function r5(l){Yl[l.pointerId]&&(Yl[l.pointerId]=l)}function q1(l){delete Yl[l.pointerId]}function s5(){U1||(document.addEventListener(Zo,n5,!0),document.addEventListener(F1,r5,!0),document.addEventListener(B1,q1,!0),document.addEventListener(z1,q1,!0),U1=!0)}function If(l,h){if(h.pointerType!==(h.MSPOINTER_TYPE_MOUSE||"mouse")){h.touches=[];for(var x in Yl)h.touches.push(Yl[x]);h.changedTouches=[h],l(h)}}function a5(l,h){h.MSPOINTER_TYPE_TOUCH&&h.pointerType===h.MSPOINTER_TYPE_TOUCH&&dr(h),If(l,h)}function i5(l){var h={},x,k;for(k in l)x=l[k],h[k]=x&&x.bind?x.bind(l):x;return l=h,h.type="dblclick",h.detail=2,h.isTrusted=!1,h._simulated=!0,h}var o5=200;function l5(l,h){l.addEventListener("dblclick",h);var x=0,k;function T(q){if(q.detail!==1){k=q.detail;return}if(!(q.pointerType==="mouse"||q.sourceCapabilities&&!q.sourceCapabilities.firesTouchEvents)){var ae=Z1(q);if(!(ae.some(function(ve){return ve instanceof HTMLLabelElement&&ve.attributes.for})&&!ae.some(function(ve){return ve instanceof HTMLInputElement||ve instanceof HTMLSelectElement}))){var fe=Date.now();fe-x<=o5?(k++,k===2&&h(i5(q))):k=1,x=fe}}}return l.addEventListener("click",T),{dblclick:h,simDblclick:T}}function c5(l,h){l.removeEventListener("dblclick",h.dblclick),l.removeEventListener("click",h.simDblclick)}var Qg=Ff(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Gd=Ff(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),W1=Gd==="webkitTransition"||Gd==="OTransition"?Gd+"End":"transitionend";function H1(l){return typeof l=="string"?document.getElementById(l):l}function Qd(l,h){var x=l.style[h]||l.currentStyle&&l.currentStyle[h];if((!x||x==="auto")&&document.defaultView){var k=document.defaultView.getComputedStyle(l,null);x=k?k[h]:null}return x==="auto"?null:x}function nn(l,h,x){var k=document.createElement(l);return k.className=h||"",x&&x.appendChild(k),k}function Sn(l){var h=l.parentNode;h&&h.removeChild(l)}function Of(l){for(;l.firstChild;)l.removeChild(l.firstChild)}function Xl(l){var h=l.parentNode;h&&h.lastChild!==l&&h.appendChild(l)}function Jl(l){var h=l.parentNode;h&&h.firstChild!==l&&h.insertBefore(l,h.firstChild)}function Yg(l,h){if(l.classList!==void 0)return l.classList.contains(h);var x=Lf(l);return x.length>0&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(x)}function Ot(l,h){if(l.classList!==void 0)for(var x=j(h),k=0,T=x.length;k<T;k++)l.classList.add(x[k]);else if(!Yg(l,h)){var q=Lf(l);Xg(l,(q?q+" ":"")+h)}}function Rn(l,h){l.classList!==void 0?l.classList.remove(h):Xg(l,y((" "+Lf(l)+" ").replace(" "+h+" "," ")))}function Xg(l,h){l.className.baseVal===void 0?l.className=h:l.className.baseVal=h}function Lf(l){return l.correspondingElement&&(l=l.correspondingElement),l.className.baseVal===void 0?l.className:l.className.baseVal}function ks(l,h){"opacity"in l.style?l.style.opacity=h:"filter"in l.style&&d5(l,h)}function d5(l,h){var x=!1,k="DXImageTransform.Microsoft.Alpha";try{x=l.filters.item(k)}catch{if(h===1)return}h=Math.round(h*100),x?(x.Enabled=h!==100,x.Opacity=h):l.style.filter+=" progid:"+k+"(opacity="+h+")"}function Ff(l){for(var h=document.documentElement.style,x=0;x<l.length;x++)if(l[x]in h)return l[x];return!1}function Go(l,h,x){var k=h||new z(0,0);l.style[Qg]=(tt.ie3d?"translate("+k.x+"px,"+k.y+"px)":"translate3d("+k.x+"px,"+k.y+"px,0)")+(x?" scale("+x+")":"")}function Fn(l,h){l._leaflet_pos=h,tt.any3d?Go(l,h):(l.style.left=h.x+"px",l.style.top=h.y+"px")}function Qo(l){return l._leaflet_pos||new z(0,0)}var Yd,Xd,Jg;if("onselectstart"in document)Yd=function(){Pt(window,"selectstart",dr)},Xd=function(){pn(window,"selectstart",dr)};else{var Jd=Ff(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Yd=function(){if(Jd){var l=document.documentElement.style;Jg=l[Jd],l[Jd]="none"}},Xd=function(){Jd&&(document.documentElement.style[Jd]=Jg,Jg=void 0)}}function ex(){Pt(window,"dragstart",dr)}function tx(){pn(window,"dragstart",dr)}var Bf,nx;function rx(l){for(;l.tabIndex===-1;)l=l.parentNode;l.style&&(zf(),Bf=l,nx=l.style.outlineStyle,l.style.outlineStyle="none",Pt(window,"keydown",zf))}function zf(){Bf&&(Bf.style.outlineStyle=nx,Bf=void 0,nx=void 0,pn(window,"keydown",zf))}function V1(l){do l=l.parentNode;while((!l.offsetWidth||!l.offsetHeight)&&l!==document.body);return l}function sx(l){var h=l.getBoundingClientRect();return{x:h.width/l.offsetWidth||1,y:h.height/l.offsetHeight||1,boundingClientRect:h}}var u5={__proto__:null,TRANSFORM:Qg,TRANSITION:Gd,TRANSITION_END:W1,get:H1,getStyle:Qd,create:nn,remove:Sn,empty:Of,toFront:Xl,toBack:Jl,hasClass:Yg,addClass:Ot,removeClass:Rn,setClass:Xg,getClass:Lf,setOpacity:ks,testProp:Ff,setTransform:Go,setPosition:Fn,getPosition:Qo,get disableTextSelection(){return Yd},get enableTextSelection(){return Xd},disableImageDrag:ex,enableImageDrag:tx,preventOutline:rx,restoreOutline:zf,getSizedParentNode:V1,getScale:sx};function Pt(l,h,x,k){if(h&&typeof h=="object")for(var T in h)ix(l,T,h[T],x);else{h=j(h);for(var q=0,ae=h.length;q<ae;q++)ix(l,h[q],x,k)}return this}var wa="_leaflet_events";function pn(l,h,x,k){if(arguments.length===1)K1(l),delete l[wa];else if(h&&typeof h=="object")for(var T in h)ox(l,T,h[T],x);else if(h=j(h),arguments.length===2)K1(l,function(fe){return S(h,fe)!==-1});else for(var q=0,ae=h.length;q<ae;q++)ox(l,h[q],x,k);return this}function K1(l,h){for(var x in l[wa]){var k=x.split(/\d/)[0];(!h||h(k))&&ox(l,k,null,null,x)}}var ax={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ix(l,h,x,k){var T=h+d(x)+(k?"_"+d(k):"");if(l[wa]&&l[wa][T])return this;var q=function(fe){return x.call(k||l,fe||window.event)},ae=q;!tt.touchNative&&tt.pointer&&h.indexOf("touch")===0?q=e5(l,h,q):tt.touch&&h==="dblclick"?q=l5(l,q):"addEventListener"in l?h==="touchstart"||h==="touchmove"||h==="wheel"||h==="mousewheel"?l.addEventListener(ax[h]||h,q,tt.passiveEvents?{passive:!1}:!1):h==="mouseenter"||h==="mouseleave"?(q=function(fe){fe=fe||window.event,cx(l,fe)&&ae(fe)},l.addEventListener(ax[h],q,!1)):l.addEventListener(h,ae,!1):l.attachEvent("on"+h,q),l[wa]=l[wa]||{},l[wa][T]=q}function ox(l,h,x,k,T){T=T||h+d(x)+(k?"_"+d(k):"");var q=l[wa]&&l[wa][T];if(!q)return this;!tt.touchNative&&tt.pointer&&h.indexOf("touch")===0?t5(l,h,q):tt.touch&&h==="dblclick"?c5(l,q):"removeEventListener"in l?l.removeEventListener(ax[h]||h,q,!1):l.detachEvent("on"+h,q),l[wa][T]=null}function Yo(l){return l.stopPropagation?l.stopPropagation():l.originalEvent?l.originalEvent._stopped=!0:l.cancelBubble=!0,this}function lx(l){return ix(l,"wheel",Yo),this}function eu(l){return Pt(l,"mousedown touchstart dblclick contextmenu",Yo),l._leaflet_disable_click=!0,this}function dr(l){return l.preventDefault?l.preventDefault():l.returnValue=!1,this}function Xo(l){return dr(l),Yo(l),this}function Z1(l){if(l.composedPath)return l.composedPath();for(var h=[],x=l.target;x;)h.push(x),x=x.parentNode;return h}function G1(l,h){if(!h)return new z(l.clientX,l.clientY);var x=sx(h),k=x.boundingClientRect;return new z((l.clientX-k.left)/x.x-h.clientLeft,(l.clientY-k.top)/x.y-h.clientTop)}var h5=tt.linux&&tt.chrome?window.devicePixelRatio:tt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Q1(l){return tt.edge?l.wheelDeltaY/2:l.deltaY&&l.deltaMode===0?-l.deltaY/h5:l.deltaY&&l.deltaMode===1?-l.deltaY*20:l.deltaY&&l.deltaMode===2?-l.deltaY*60:l.deltaX||l.deltaZ?0:l.wheelDelta?(l.wheelDeltaY||l.wheelDelta)/2:l.detail&&Math.abs(l.detail)<32765?-l.detail*20:l.detail?l.detail/-32765*60:0}function cx(l,h){var x=h.relatedTarget;if(!x)return!0;try{for(;x&&x!==l;)x=x.parentNode}catch{return!1}return x!==l}var f5={__proto__:null,on:Pt,off:pn,stopPropagation:Yo,disableScrollPropagation:lx,disableClickPropagation:eu,preventDefault:dr,stop:Xo,getPropagationPath:Z1,getMousePosition:G1,getWheelDelta:Q1,isExternalTarget:cx,addListener:Pt,removeListener:pn},Y1=Q.extend({run:function(l,h,x,k){this.stop(),this._el=l,this._inProgress=!0,this._duration=x||.25,this._easeOutPower=1/Math.max(k||.5,.2),this._startPos=Qo(l),this._offset=h.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=P(this._animate,this),this._step()},_step:function(l){var h=+new Date-this._startTime,x=this._duration*1e3;h<x?this._runFrame(this._easeOut(h/x),l):(this._runFrame(1),this._complete())},_runFrame:function(l,h){var x=this._startPos.add(this._offset.multiplyBy(l));h&&x._round(),Fn(this._el,x),this.fire("step")},_complete:function(){F(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(l){return 1-Math.pow(1-l,this._easeOutPower)}}),Xt=Q.extend({options:{crs:he,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(l,h){h=v(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(l),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),h.zoom!==void 0&&(this._zoom=this._limitZoom(h.zoom)),h.center&&h.zoom!==void 0&&this.setView(X(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Gd&&tt.any3d&&!tt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Pt(this._proxy,W1,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(l,h,x){if(h=h===void 0?this._zoom:this._limitZoom(h),l=this._limitCenter(X(l),h,this.options.maxBounds),x=x||{},this._stop(),this._loaded&&!x.reset&&x!==!0){x.animate!==void 0&&(x.zoom=a({animate:x.animate},x.zoom),x.pan=a({animate:x.animate,duration:x.duration},x.pan));var k=this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(l,h,x.zoom):this._tryAnimatedPan(l,x.pan);if(k)return clearTimeout(this._sizeTimer),this}return this._resetView(l,h,x.pan&&x.pan.noMoveStart),this},setZoom:function(l,h){return this._loaded?this.setView(this.getCenter(),l,{zoom:h}):(this._zoom=l,this)},zoomIn:function(l,h){return l=l||(tt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+l,h)},zoomOut:function(l,h){return l=l||(tt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-l,h)},setZoomAround:function(l,h,x){var k=this.getZoomScale(h),T=this.getSize().divideBy(2),q=l instanceof z?l:this.latLngToContainerPoint(l),ae=q.subtract(T).multiplyBy(1-1/k),fe=this.containerPointToLatLng(T.add(ae));return this.setView(fe,h,{zoom:x})},_getBoundsCenterZoom:function(l,h){h=h||{},l=l.getBounds?l.getBounds():$(l);var x=U(h.paddingTopLeft||h.padding||[0,0]),k=U(h.paddingBottomRight||h.padding||[0,0]),T=this.getBoundsZoom(l,!1,x.add(k));if(T=typeof h.maxZoom=="number"?Math.min(h.maxZoom,T):T,T===1/0)return{center:l.getCenter(),zoom:T};var q=k.subtract(x).divideBy(2),ae=this.project(l.getSouthWest(),T),fe=this.project(l.getNorthEast(),T),ve=this.unproject(ae.add(fe).divideBy(2).add(q),T);return{center:ve,zoom:T}},fitBounds:function(l,h){if(l=$(l),!l.isValid())throw new Error("Bounds are not valid.");var x=this._getBoundsCenterZoom(l,h);return this.setView(x.center,x.zoom,h)},fitWorld:function(l){return this.fitBounds([[-90,-180],[90,180]],l)},panTo:function(l,h){return this.setView(l,this._zoom,{pan:h})},panBy:function(l,h){if(l=U(l).round(),h=h||{},!l.x&&!l.y)return this.fire("moveend");if(h.animate!==!0&&!this.getSize().contains(l))return this._resetView(this.unproject(this.project(this.getCenter()).add(l)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Y1,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),h.animate!==!1){Ot(this._mapPane,"leaflet-pan-anim");var x=this._getMapPanePos().subtract(l).round();this._panAnim.run(this._mapPane,x,h.duration||.25,h.easeLinearity)}else this._rawPanBy(l),this.fire("move").fire("moveend");return this},flyTo:function(l,h,x){if(x=x||{},x.animate===!1||!tt.any3d)return this.setView(l,h,x);this._stop();var k=this.project(this.getCenter()),T=this.project(l),q=this.getSize(),ae=this._zoom;l=X(l),h=h===void 0?ae:h;var fe=Math.max(q.x,q.y),ve=fe*this.getZoomScale(ae,h),Se=T.distanceTo(k)||1,Ue=1.42,_t=Ue*Ue;function $t(Bn){var Xf=Bn?-1:1,t8=Bn?ve:fe,n8=ve*ve-fe*fe+Xf*_t*_t*Se*Se,r8=2*t8*_t*Se,_x=n8/r8,DN=Math.sqrt(_x*_x+1)-_x,s8=DN<1e-9?-18:Math.log(DN);return s8}function Tr(Bn){return(Math.exp(Bn)-Math.exp(-Bn))/2}function er(Bn){return(Math.exp(Bn)+Math.exp(-Bn))/2}function Es(Bn){return Tr(Bn)/er(Bn)}var Vr=$t(0);function ac(Bn){return fe*(er(Vr)/er(Vr+Ue*Bn))}function Y5(Bn){return fe*(er(Vr)*Es(Vr+Ue*Bn)-Tr(Vr))/_t}function X5(Bn){return 1-Math.pow(1-Bn,1.5)}var J5=Date.now(),AN=($t(1)-Vr)/Ue,e8=x.duration?1e3*x.duration:1e3*AN*.8;function PN(){var Bn=(Date.now()-J5)/e8,Xf=X5(Bn)*AN;Bn<=1?(this._flyToFrame=P(PN,this),this._move(this.unproject(k.add(T.subtract(k).multiplyBy(Y5(Xf)/Se)),ae),this.getScaleZoom(fe/ac(Xf),ae),{flyTo:!0})):this._move(l,h)._moveEnd(!0)}return this._moveStart(!0,x.noMoveStart),PN.call(this),this},flyToBounds:function(l,h){var x=this._getBoundsCenterZoom(l,h);return this.flyTo(x.center,x.zoom,h)},setMaxBounds:function(l){return l=$(l),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),l.isValid()?(this.options.maxBounds=l,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(l){var h=this.options.minZoom;return this.options.minZoom=l,this._loaded&&h!==l&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(l):this},setMaxZoom:function(l){var h=this.options.maxZoom;return this.options.maxZoom=l,this._loaded&&h!==l&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(l):this},panInsideBounds:function(l,h){this._enforcingBounds=!0;var x=this.getCenter(),k=this._limitCenter(x,this._zoom,$(l));return x.equals(k)||this.panTo(k,h),this._enforcingBounds=!1,this},panInside:function(l,h){h=h||{};var x=U(h.paddingTopLeft||h.padding||[0,0]),k=U(h.paddingBottomRight||h.padding||[0,0]),T=this.project(this.getCenter()),q=this.project(l),ae=this.getPixelBounds(),fe=I([ae.min.add(x),ae.max.subtract(k)]),ve=fe.getSize();if(!fe.contains(q)){this._enforcingBounds=!0;var Se=q.subtract(fe.getCenter()),Ue=fe.extend(q).getSize().subtract(ve);T.x+=Se.x<0?-Ue.x:Ue.x,T.y+=Se.y<0?-Ue.y:Ue.y,this.panTo(this.unproject(T),h),this._enforcingBounds=!1}return this},invalidateSize:function(l){if(!this._loaded)return this;l=a({animate:!1,pan:!0},l===!0?{animate:!0}:l);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var x=this.getSize(),k=h.divideBy(2).round(),T=x.divideBy(2).round(),q=k.subtract(T);return!q.x&&!q.y?this:(l.animate&&l.pan?this.panBy(q):(l.pan&&this._rawPanBy(q),this.fire("move"),l.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:x}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(l){if(l=this._locateOptions=a({timeout:1e4,watch:!1},l),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=o(this._handleGeolocationResponse,this),x=o(this._handleGeolocationError,this);return l.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,x,l):navigator.geolocation.getCurrentPosition(h,x,l),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(l){if(this._container._leaflet_id){var h=l.code,x=l.message||(h===1?"permission denied":h===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+x+"."})}},_handleGeolocationResponse:function(l){if(this._container._leaflet_id){var h=l.coords.latitude,x=l.coords.longitude,k=new te(h,x),T=k.toBounds(l.coords.accuracy*2),q=this._locateOptions;if(q.setView){var ae=this.getBoundsZoom(T);this.setView(k,q.maxZoom?Math.min(ae,q.maxZoom):ae)}var fe={latlng:k,bounds:T,timestamp:l.timestamp};for(var ve in l.coords)typeof l.coords[ve]=="number"&&(fe[ve]=l.coords[ve]);this.fire("locationfound",fe)}},addHandler:function(l,h){if(!h)return this;var x=this[l]=new h(this);return this._handlers.push(x),this.options[l]&&x.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Sn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(F(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var l;for(l in this._layers)this._layers[l].remove();for(l in this._panes)Sn(this._panes[l]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(l,h){var x="leaflet-pane"+(l?" leaflet-"+l.replace("Pane","")+"-pane":""),k=nn("div",x,h||this._mapPane);return l&&(this._panes[l]=k),k},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var l=this.getPixelBounds(),h=this.unproject(l.getBottomLeft()),x=this.unproject(l.getTopRight());return new H(h,x)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(l,h,x){l=$(l),x=U(x||[0,0]);var k=this.getZoom()||0,T=this.getMinZoom(),q=this.getMaxZoom(),ae=l.getNorthWest(),fe=l.getSouthEast(),ve=this.getSize().subtract(x),Se=I(this.project(fe,k),this.project(ae,k)).getSize(),Ue=tt.any3d?this.options.zoomSnap:1,_t=ve.x/Se.x,$t=ve.y/Se.y,Tr=h?Math.max(_t,$t):Math.min(_t,$t);return k=this.getScaleZoom(Tr,k),Ue&&(k=Math.round(k/(Ue/100))*(Ue/100),k=h?Math.ceil(k/Ue)*Ue:Math.floor(k/Ue)*Ue),Math.max(T,Math.min(q,k))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(l,h){var x=this._getTopLeftPoint(l,h);return new O(x,x.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(l){return this.options.crs.getProjectedBounds(l===void 0?this.getZoom():l)},getPane:function(l){return typeof l=="string"?this._panes[l]:l},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(l,h){var x=this.options.crs;return h=h===void 0?this._zoom:h,x.scale(l)/x.scale(h)},getScaleZoom:function(l,h){var x=this.options.crs;h=h===void 0?this._zoom:h;var k=x.zoom(l*x.scale(h));return isNaN(k)?1/0:k},project:function(l,h){return h=h===void 0?this._zoom:h,this.options.crs.latLngToPoint(X(l),h)},unproject:function(l,h){return h=h===void 0?this._zoom:h,this.options.crs.pointToLatLng(U(l),h)},layerPointToLatLng:function(l){var h=U(l).add(this.getPixelOrigin());return this.unproject(h)},latLngToLayerPoint:function(l){var h=this.project(X(l))._round();return h._subtract(this.getPixelOrigin())},wrapLatLng:function(l){return this.options.crs.wrapLatLng(X(l))},wrapLatLngBounds:function(l){return this.options.crs.wrapLatLngBounds($(l))},distance:function(l,h){return this.options.crs.distance(X(l),X(h))},containerPointToLayerPoint:function(l){return U(l).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(l){return U(l).add(this._getMapPanePos())},containerPointToLatLng:function(l){var h=this.containerPointToLayerPoint(U(l));return this.layerPointToLatLng(h)},latLngToContainerPoint:function(l){return this.layerPointToContainerPoint(this.latLngToLayerPoint(X(l)))},mouseEventToContainerPoint:function(l){return G1(l,this._container)},mouseEventToLayerPoint:function(l){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(l))},mouseEventToLatLng:function(l){return this.layerPointToLatLng(this.mouseEventToLayerPoint(l))},_initContainer:function(l){var h=this._container=H1(l);if(h){if(h._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Pt(h,"scroll",this._onScroll,this),this._containerId=d(h)},_initLayout:function(){var l=this._container;this._fadeAnimated=this.options.fadeAnimation&&tt.any3d,Ot(l,"leaflet-container"+(tt.touch?" leaflet-touch":"")+(tt.retina?" leaflet-retina":"")+(tt.ielt9?" leaflet-oldie":"")+(tt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=Qd(l,"position");h!=="absolute"&&h!=="relative"&&h!=="fixed"&&h!=="sticky"&&(l.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var l=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Fn(this._mapPane,new z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ot(l.markerPane,"leaflet-zoom-hide"),Ot(l.shadowPane,"leaflet-zoom-hide"))},_resetView:function(l,h,x){Fn(this._mapPane,new z(0,0));var k=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var T=this._zoom!==h;this._moveStart(T,x)._move(l,h)._moveEnd(T),this.fire("viewreset"),k&&this.fire("load")},_moveStart:function(l,h){return l&&this.fire("zoomstart"),h||this.fire("movestart"),this},_move:function(l,h,x,k){h===void 0&&(h=this._zoom);var T=this._zoom!==h;return this._zoom=h,this._lastCenter=l,this._pixelOrigin=this._getNewPixelOrigin(l),k?x&&x.pinch&&this.fire("zoom",x):((T||x&&x.pinch)&&this.fire("zoom",x),this.fire("move",x)),this},_moveEnd:function(l){return l&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return F(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(l){Fn(this._mapPane,this._getMapPanePos().subtract(l))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(l){this._targets={},this._targets[d(this._container)]=this;var h=l?pn:Pt;h(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),tt.any3d&&this.options.transform3DLimit&&(l?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){F(this._resizeRequest),this._resizeRequest=P(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var l=this._getMapPanePos();Math.max(Math.abs(l.x),Math.abs(l.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(l,h){for(var x=[],k,T=h==="mouseout"||h==="mouseover",q=l.target||l.srcElement,ae=!1;q;){if(k=this._targets[d(q)],k&&(h==="click"||h==="preclick")&&this._draggableMoved(k)){ae=!0;break}if(k&&k.listens(h,!0)&&(T&&!cx(q,l)||(x.push(k),T))||q===this._container)break;q=q.parentNode}return!x.length&&!ae&&!T&&this.listens(h,!0)&&(x=[this]),x},_isClickDisabled:function(l){for(;l&&l!==this._container;){if(l._leaflet_disable_click)return!0;l=l.parentNode}},_handleDOMEvent:function(l){var h=l.target||l.srcElement;if(!(!this._loaded||h._leaflet_disable_events||l.type==="click"&&this._isClickDisabled(h))){var x=l.type;x==="mousedown"&&rx(h),this._fireDOMEvent(l,x)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(l,h,x){if(l.type==="click"){var k=a({},l);k.type="preclick",this._fireDOMEvent(k,k.type,x)}var T=this._findEventTargets(l,h);if(x){for(var q=[],ae=0;ae<x.length;ae++)x[ae].listens(h,!0)&&q.push(x[ae]);T=q.concat(T)}if(T.length){h==="contextmenu"&&dr(l);var fe=T[0],ve={originalEvent:l};if(l.type!=="keypress"&&l.type!=="keydown"&&l.type!=="keyup"){var Se=fe.getLatLng&&(!fe._radius||fe._radius<=10);ve.containerPoint=Se?this.latLngToContainerPoint(fe.getLatLng()):this.mouseEventToContainerPoint(l),ve.layerPoint=this.containerPointToLayerPoint(ve.containerPoint),ve.latlng=Se?fe.getLatLng():this.layerPointToLatLng(ve.layerPoint)}for(ae=0;ae<T.length;ae++)if(T[ae].fire(h,ve,!0),ve.originalEvent._stopped||T[ae].options.bubblingMouseEvents===!1&&S(this._mouseEvents,h)!==-1)return}},_draggableMoved:function(l){return l=l.dragging&&l.dragging.enabled()?l:this,l.dragging&&l.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var l=0,h=this._handlers.length;l<h;l++)this._handlers[l].disable()},whenReady:function(l,h){return this._loaded?l.call(h||this,{target:this}):this.on("load",l,h),this},_getMapPanePos:function(){return Qo(this._mapPane)||new z(0,0)},_moved:function(){var l=this._getMapPanePos();return l&&!l.equals([0,0])},_getTopLeftPoint:function(l,h){var x=l&&h!==void 0?this._getNewPixelOrigin(l,h):this.getPixelOrigin();return x.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(l,h){var x=this.getSize()._divideBy(2);return this.project(l,h)._subtract(x)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(l,h,x){var k=this._getNewPixelOrigin(x,h);return this.project(l,h)._subtract(k)},_latLngBoundsToNewLayerBounds:function(l,h,x){var k=this._getNewPixelOrigin(x,h);return I([this.project(l.getSouthWest(),h)._subtract(k),this.project(l.getNorthWest(),h)._subtract(k),this.project(l.getSouthEast(),h)._subtract(k),this.project(l.getNorthEast(),h)._subtract(k)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(l){return this.latLngToLayerPoint(l).subtract(this._getCenterLayerPoint())},_limitCenter:function(l,h,x){if(!x)return l;var k=this.project(l,h),T=this.getSize().divideBy(2),q=new O(k.subtract(T),k.add(T)),ae=this._getBoundsOffset(q,x,h);return Math.abs(ae.x)<=1&&Math.abs(ae.y)<=1?l:this.unproject(k.add(ae),h)},_limitOffset:function(l,h){if(!h)return l;var x=this.getPixelBounds(),k=new O(x.min.add(l),x.max.add(l));return l.add(this._getBoundsOffset(k,h))},_getBoundsOffset:function(l,h,x){var k=I(this.project(h.getNorthEast(),x),this.project(h.getSouthWest(),x)),T=k.min.subtract(l.min),q=k.max.subtract(l.max),ae=this._rebound(T.x,-q.x),fe=this._rebound(T.y,-q.y);return new z(ae,fe)},_rebound:function(l,h){return l+h>0?Math.round(l-h)/2:Math.max(0,Math.ceil(l))-Math.max(0,Math.floor(h))},_limitZoom:function(l){var h=this.getMinZoom(),x=this.getMaxZoom(),k=tt.any3d?this.options.zoomSnap:1;return k&&(l=Math.round(l/k)*k),Math.max(h,Math.min(x,l))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Rn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(l,h){var x=this._getCenterOffset(l)._trunc();return(h&&h.animate)!==!0&&!this.getSize().contains(x)?!1:(this.panBy(x,h),!0)},_createAnimProxy:function(){var l=this._proxy=nn("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(l),this.on("zoomanim",function(h){var x=Qg,k=this._proxy.style[x];Go(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),k===this._proxy.style[x]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Sn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var l=this.getCenter(),h=this.getZoom();Go(this._proxy,this.project(l,h),this.getZoomScale(h,1))},_catchTransitionEnd:function(l){this._animatingZoom&&l.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(l,h,x){if(this._animatingZoom)return!0;if(x=x||{},!this._zoomAnimated||x.animate===!1||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var k=this.getZoomScale(h),T=this._getCenterOffset(l)._divideBy(1-1/k);return x.animate!==!0&&!this.getSize().contains(T)?!1:(P(function(){this._moveStart(!0,x.noMoveStart||!1)._animateZoom(l,h,!0)},this),!0)},_animateZoom:function(l,h,x,k){this._mapPane&&(x&&(this._animatingZoom=!0,this._animateToCenter=l,this._animateToZoom=h,Ot(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:l,zoom:h,noUpdate:k}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Rn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function m5(l,h){return new Xt(l,h)}var qs=ee.extend({options:{position:"topright"},initialize:function(l){v(this,l)},getPosition:function(){return this.options.position},setPosition:function(l){var h=this._map;return h&&h.removeControl(this),this.options.position=l,h&&h.addControl(this),this},getContainer:function(){return this._container},addTo:function(l){this.remove(),this._map=l;var h=this._container=this.onAdd(l),x=this.getPosition(),k=l._controlCorners[x];return Ot(h,"leaflet-control"),x.indexOf("bottom")!==-1?k.insertBefore(h,k.firstChild):k.appendChild(h),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Sn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(l){this._map&&l&&l.screenX>0&&l.screenY>0&&this._map.getContainer().focus()}}),tu=function(l){return new qs(l)};Xt.include({addControl:function(l){return l.addTo(this),this},removeControl:function(l){return l.remove(),this},_initControlPos:function(){var l=this._controlCorners={},h="leaflet-",x=this._controlContainer=nn("div",h+"control-container",this._container);function k(T,q){var ae=h+T+" "+h+q;l[T+q]=nn("div",ae,x)}k("top","left"),k("top","right"),k("bottom","left"),k("bottom","right")},_clearControlPos:function(){for(var l in this._controlCorners)Sn(this._controlCorners[l]);Sn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var X1=qs.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(l,h,x,k){return x<k?-1:k<x?1:0}},initialize:function(l,h,x){v(this,x),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var k in l)this._addLayer(l[k],k);for(k in h)this._addLayer(h[k],k,!0)},onAdd:function(l){this._initLayout(),this._update(),this._map=l,l.on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(l){return qs.prototype.addTo.call(this,l),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(l,h){return this._addLayer(l,h),this._map?this._update():this},addOverlay:function(l,h){return this._addLayer(l,h,!0),this._map?this._update():this},removeLayer:function(l){l.off("add remove",this._onLayerChange,this);var h=this._getLayer(d(l));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this},expand:function(){Ot(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var l=this._map.getSize().y-(this._container.offsetTop+50);return l<this._section.clientHeight?(Ot(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=l+"px"):Rn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Rn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var l="leaflet-control-layers",h=this._container=nn("div",l),x=this.options.collapsed;h.setAttribute("aria-haspopup",!0),eu(h),lx(h);var k=this._section=nn("section",l+"-list");x&&(this._map.on("click",this.collapse,this),Pt(h,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var T=this._layersLink=nn("a",l+"-toggle",h);T.href="#",T.title="Layers",T.setAttribute("role","button"),Pt(T,{keydown:function(q){q.keyCode===13&&this._expandSafely()},click:function(q){dr(q),this._expandSafely()}},this),x||this.expand(),this._baseLayersList=nn("div",l+"-base",k),this._separator=nn("div",l+"-separator",k),this._overlaysList=nn("div",l+"-overlays",k),h.appendChild(k)},_getLayer:function(l){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&d(this._layers[h].layer)===l)return this._layers[h]},_addLayer:function(l,h,x){this._map&&l.on("add remove",this._onLayerChange,this),this._layers.push({layer:l,name:h,overlay:x}),this.options.sortLayers&&this._layers.sort(o(function(k,T){return this.options.sortFunction(k.layer,T.layer,k.name,T.name)},this)),this.options.autoZIndex&&l.setZIndex&&(this._lastZIndex++,l.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Of(this._baseLayersList),Of(this._overlaysList),this._layerControlInputs=[];var l,h,x,k,T=0;for(x=0;x<this._layers.length;x++)k=this._layers[x],this._addItem(k),h=h||k.overlay,l=l||!k.overlay,T+=k.overlay?0:1;return this.options.hideSingleBase&&(l=l&&T>1,this._baseLayersList.style.display=l?"":"none"),this._separator.style.display=h&&l?"":"none",this},_onLayerChange:function(l){this._handlingClick||this._update();var h=this._getLayer(d(l.target)),x=h.overlay?l.type==="add"?"overlayadd":"overlayremove":l.type==="add"?"baselayerchange":null;x&&this._map.fire(x,h)},_createRadioElement:function(l,h){var x='<input type="radio" class="leaflet-control-layers-selector" name="'+l+'"'+(h?' checked="checked"':"")+"/>",k=document.createElement("div");return k.innerHTML=x,k.firstChild},_addItem:function(l){var h=document.createElement("label"),x=this._map.hasLayer(l.layer),k;l.overlay?(k=document.createElement("input"),k.type="checkbox",k.className="leaflet-control-layers-selector",k.defaultChecked=x):k=this._createRadioElement("leaflet-base-layers_"+d(this),x),this._layerControlInputs.push(k),k.layerId=d(l.layer),Pt(k,"click",this._onInputClick,this);var T=document.createElement("span");T.innerHTML=" "+l.name;var q=document.createElement("span");h.appendChild(q),q.appendChild(k),q.appendChild(T);var ae=l.overlay?this._overlaysList:this._baseLayersList;return ae.appendChild(h),this._checkDisabledLayers(),h},_onInputClick:function(){if(!this._preventClick){var l=this._layerControlInputs,h,x,k=[],T=[];this._handlingClick=!0;for(var q=l.length-1;q>=0;q--)h=l[q],x=this._getLayer(h.layerId).layer,h.checked?k.push(x):h.checked||T.push(x);for(q=0;q<T.length;q++)this._map.hasLayer(T[q])&&this._map.removeLayer(T[q]);for(q=0;q<k.length;q++)this._map.hasLayer(k[q])||this._map.addLayer(k[q]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var l=this._layerControlInputs,h,x,k=this._map.getZoom(),T=l.length-1;T>=0;T--)h=l[T],x=this._getLayer(h.layerId).layer,h.disabled=x.options.minZoom!==void 0&&k<x.options.minZoom||x.options.maxZoom!==void 0&&k>x.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var l=this._section;this._preventClick=!0,Pt(l,"click",dr),this.expand();var h=this;setTimeout(function(){pn(l,"click",dr),h._preventClick=!1})}}),p5=function(l,h,x){return new X1(l,h,x)},dx=qs.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(l){var h="leaflet-control-zoom",x=nn("div",h+" leaflet-bar"),k=this.options;return this._zoomInButton=this._createButton(k.zoomInText,k.zoomInTitle,h+"-in",x,this._zoomIn),this._zoomOutButton=this._createButton(k.zoomOutText,k.zoomOutTitle,h+"-out",x,this._zoomOut),this._updateDisabled(),l.on("zoomend zoomlevelschange",this._updateDisabled,this),x},onRemove:function(l){l.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(l){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(l.shiftKey?3:1))},_zoomOut:function(l){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(l.shiftKey?3:1))},_createButton:function(l,h,x,k,T){var q=nn("a",x,k);return q.innerHTML=l,q.href="#",q.title=h,q.setAttribute("role","button"),q.setAttribute("aria-label",h),eu(q),Pt(q,"click",Xo),Pt(q,"click",T,this),Pt(q,"click",this._refocusOnMap,this),q},_updateDisabled:function(){var l=this._map,h="leaflet-disabled";Rn(this._zoomInButton,h),Rn(this._zoomOutButton,h),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||l._zoom===l.getMinZoom())&&(Ot(this._zoomOutButton,h),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||l._zoom===l.getMaxZoom())&&(Ot(this._zoomInButton,h),this._zoomInButton.setAttribute("aria-disabled","true"))}});Xt.mergeOptions({zoomControl:!0}),Xt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new dx,this.addControl(this.zoomControl))});var g5=function(l){return new dx(l)},J1=qs.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(l){var h="leaflet-control-scale",x=nn("div",h),k=this.options;return this._addScales(k,h+"-line",x),l.on(k.updateWhenIdle?"moveend":"move",this._update,this),l.whenReady(this._update,this),x},onRemove:function(l){l.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(l,h,x){l.metric&&(this._mScale=nn("div",h,x)),l.imperial&&(this._iScale=nn("div",h,x))},_update:function(){var l=this._map,h=l.getSize().y/2,x=l.distance(l.containerPointToLatLng([0,h]),l.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(x)},_updateScales:function(l){this.options.metric&&l&&this._updateMetric(l),this.options.imperial&&l&&this._updateImperial(l)},_updateMetric:function(l){var h=this._getRoundNum(l),x=h<1e3?h+" m":h/1e3+" km";this._updateScale(this._mScale,x,h/l)},_updateImperial:function(l){var h=l*3.2808399,x,k,T;h>5280?(x=h/5280,k=this._getRoundNum(x),this._updateScale(this._iScale,k+" mi",k/x)):(T=this._getRoundNum(h),this._updateScale(this._iScale,T+" ft",T/h))},_updateScale:function(l,h,x){l.style.width=Math.round(this.options.maxWidth*x)+"px",l.innerHTML=h},_getRoundNum:function(l){var h=Math.pow(10,(Math.floor(l)+"").length-1),x=l/h;return x=x>=10?10:x>=5?5:x>=3?3:x>=2?2:1,h*x}}),x5=function(l){return new J1(l)},v5='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ux=qs.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(tt.inlineSvg?v5+" ":"")+"Leaflet</a>"},initialize:function(l){v(this,l),this._attributions={}},onAdd:function(l){l.attributionControl=this,this._container=nn("div","leaflet-control-attribution"),eu(this._container);for(var h in l._layers)l._layers[h].getAttribution&&this.addAttribution(l._layers[h].getAttribution());return this._update(),l.on("layeradd",this._addAttribution,this),this._container},onRemove:function(l){l.off("layeradd",this._addAttribution,this)},_addAttribution:function(l){l.layer.getAttribution&&(this.addAttribution(l.layer.getAttribution()),l.layer.once("remove",function(){this.removeAttribution(l.layer.getAttribution())},this))},setPrefix:function(l){return this.options.prefix=l,this._update(),this},addAttribution:function(l){return l?(this._attributions[l]||(this._attributions[l]=0),this._attributions[l]++,this._update(),this):this},removeAttribution:function(l){return l?(this._attributions[l]&&(this._attributions[l]--,this._update()),this):this},_update:function(){if(this._map){var l=[];for(var h in this._attributions)this._attributions[h]&&l.push(h);var x=[];this.options.prefix&&x.push(this.options.prefix),l.length&&x.push(l.join(", ")),this._container.innerHTML=x.join(' <span aria-hidden="true">|</span> ')}}});Xt.mergeOptions({attributionControl:!0}),Xt.addInitHook(function(){this.options.attributionControl&&new ux().addTo(this)});var y5=function(l){return new ux(l)};qs.Layers=X1,qs.Zoom=dx,qs.Scale=J1,qs.Attribution=ux,tu.layers=p5,tu.zoom=g5,tu.scale=x5,tu.attribution=y5;var ba=ee.extend({initialize:function(l){this._map=l},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ba.addTo=function(l,h){return l.addHandler(h,this),this};var _5={Events:de},eN=tt.touch?"touchstart mousedown":"mousedown",Mi=Q.extend({options:{clickTolerance:3},initialize:function(l,h,x,k){v(this,k),this._element=l,this._dragStartTarget=h||l,this._preventOutline=x},enable:function(){this._enabled||(Pt(this._dragStartTarget,eN,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Mi._dragging===this&&this.finishDrag(!0),pn(this._dragStartTarget,eN,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(l){if(this._enabled&&(this._moved=!1,!Yg(this._element,"leaflet-zoom-anim"))){if(l.touches&&l.touches.length!==1){Mi._dragging===this&&this.finishDrag();return}if(!(Mi._dragging||l.shiftKey||l.which!==1&&l.button!==1&&!l.touches)&&(Mi._dragging=this,this._preventOutline&&rx(this._element),ex(),Yd(),!this._moving)){this.fire("down");var h=l.touches?l.touches[0]:l,x=V1(this._element);this._startPoint=new z(h.clientX,h.clientY),this._startPos=Qo(this._element),this._parentScale=sx(x);var k=l.type==="mousedown";Pt(document,k?"mousemove":"touchmove",this._onMove,this),Pt(document,k?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(l){if(this._enabled){if(l.touches&&l.touches.length>1){this._moved=!0;return}var h=l.touches&&l.touches.length===1?l.touches[0]:l,x=new z(h.clientX,h.clientY)._subtract(this._startPoint);!x.x&&!x.y||Math.abs(x.x)+Math.abs(x.y)<this.options.clickTolerance||(x.x/=this._parentScale.x,x.y/=this._parentScale.y,dr(l),this._moved||(this.fire("dragstart"),this._moved=!0,Ot(document.body,"leaflet-dragging"),this._lastTarget=l.target||l.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ot(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(x),this._moving=!0,this._lastEvent=l,this._updatePosition())}},_updatePosition:function(){var l={originalEvent:this._lastEvent};this.fire("predrag",l),Fn(this._element,this._newPos),this.fire("drag",l)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(l){Rn(document.body,"leaflet-dragging"),this._lastTarget&&(Rn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),pn(document,"mousemove touchmove",this._onMove,this),pn(document,"mouseup touchend touchcancel",this._onUp,this),tx(),Xd();var h=this._moved&&this._moving;this._moving=!1,Mi._dragging=!1,h&&this.fire("dragend",{noInertia:l,distance:this._newPos.distanceTo(this._startPos)})}});function tN(l,h,x){var k,T=[1,4,2,8],q,ae,fe,ve,Se,Ue,_t,$t;for(q=0,Ue=l.length;q<Ue;q++)l[q]._code=Jo(l[q],h);for(fe=0;fe<4;fe++){for(_t=T[fe],k=[],q=0,Ue=l.length,ae=Ue-1;q<Ue;ae=q++)ve=l[q],Se=l[ae],ve._code&_t?Se._code&_t||($t=$f(Se,ve,_t,h,x),$t._code=Jo($t,h),k.push($t)):(Se._code&_t&&($t=$f(Se,ve,_t,h,x),$t._code=Jo($t,h),k.push($t)),k.push(ve));l=k}return l}function nN(l,h){var x,k,T,q,ae,fe,ve,Se,Ue;if(!l||l.length===0)throw new Error("latlngs not passed");Cs(l)||(console.warn("latlngs are not flat! Only the first ring will be used"),l=l[0]);var _t=X([0,0]),$t=$(l),Tr=$t.getNorthWest().distanceTo($t.getSouthWest())*$t.getNorthEast().distanceTo($t.getNorthWest());Tr<1700&&(_t=hx(l));var er=l.length,Es=[];for(x=0;x<er;x++){var Vr=X(l[x]);Es.push(h.project(X([Vr.lat-_t.lat,Vr.lng-_t.lng])))}for(fe=ve=Se=0,x=0,k=er-1;x<er;k=x++)T=Es[x],q=Es[k],ae=T.y*q.x-q.y*T.x,ve+=(T.x+q.x)*ae,Se+=(T.y+q.y)*ae,fe+=ae*3;fe===0?Ue=Es[0]:Ue=[ve/fe,Se/fe];var ac=h.unproject(U(Ue));return X([ac.lat+_t.lat,ac.lng+_t.lng])}function hx(l){for(var h=0,x=0,k=0,T=0;T<l.length;T++){var q=X(l[T]);h+=q.lat,x+=q.lng,k++}return X([h/k,x/k])}var w5={__proto__:null,clipPolygon:tN,polygonCenter:nN,centroid:hx};function rN(l,h){if(!h||!l.length)return l.slice();var x=h*h;return l=N5(l,x),l=j5(l,x),l}function sN(l,h,x){return Math.sqrt(nu(l,h,x,!0))}function b5(l,h,x){return nu(l,h,x)}function j5(l,h){var x=l.length,k=typeof Uint8Array<"u"?Uint8Array:Array,T=new k(x);T[0]=T[x-1]=1,fx(l,T,h,0,x-1);var q,ae=[];for(q=0;q<x;q++)T[q]&&ae.push(l[q]);return ae}function fx(l,h,x,k,T){var q=0,ae,fe,ve;for(fe=k+1;fe<=T-1;fe++)ve=nu(l[fe],l[k],l[T],!0),ve>q&&(ae=fe,q=ve);q>x&&(h[ae]=1,fx(l,h,x,k,ae),fx(l,h,x,ae,T))}function N5(l,h){for(var x=[l[0]],k=1,T=0,q=l.length;k<q;k++)S5(l[k],l[T])>h&&(x.push(l[k]),T=k);return T<q-1&&x.push(l[q-1]),x}var aN;function iN(l,h,x,k,T){var q=k?aN:Jo(l,x),ae=Jo(h,x),fe,ve,Se;for(aN=ae;;){if(!(q|ae))return[l,h];if(q&ae)return!1;fe=q||ae,ve=$f(l,h,fe,x,T),Se=Jo(ve,x),fe===q?(l=ve,q=Se):(h=ve,ae=Se)}}function $f(l,h,x,k,T){var q=h.x-l.x,ae=h.y-l.y,fe=k.min,ve=k.max,Se,Ue;return x&8?(Se=l.x+q*(ve.y-l.y)/ae,Ue=ve.y):x&4?(Se=l.x+q*(fe.y-l.y)/ae,Ue=fe.y):x&2?(Se=ve.x,Ue=l.y+ae*(ve.x-l.x)/q):x&1&&(Se=fe.x,Ue=l.y+ae*(fe.x-l.x)/q),new z(Se,Ue,T)}function Jo(l,h){var x=0;return l.x<h.min.x?x|=1:l.x>h.max.x&&(x|=2),l.y<h.min.y?x|=4:l.y>h.max.y&&(x|=8),x}function S5(l,h){var x=h.x-l.x,k=h.y-l.y;return x*x+k*k}function nu(l,h,x,k){var T=h.x,q=h.y,ae=x.x-T,fe=x.y-q,ve=ae*ae+fe*fe,Se;return ve>0&&(Se=((l.x-T)*ae+(l.y-q)*fe)/ve,Se>1?(T=x.x,q=x.y):Se>0&&(T+=ae*Se,q+=fe*Se)),ae=l.x-T,fe=l.y-q,k?ae*ae+fe*fe:new z(T,q)}function Cs(l){return!N(l[0])||typeof l[0][0]!="object"&&typeof l[0][0]<"u"}function oN(l){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Cs(l)}function lN(l,h){var x,k,T,q,ae,fe,ve,Se;if(!l||l.length===0)throw new Error("latlngs not passed");Cs(l)||(console.warn("latlngs are not flat! Only the first ring will be used"),l=l[0]);var Ue=X([0,0]),_t=$(l),$t=_t.getNorthWest().distanceTo(_t.getSouthWest())*_t.getNorthEast().distanceTo(_t.getNorthWest());$t<1700&&(Ue=hx(l));var Tr=l.length,er=[];for(x=0;x<Tr;x++){var Es=X(l[x]);er.push(h.project(X([Es.lat-Ue.lat,Es.lng-Ue.lng])))}for(x=0,k=0;x<Tr-1;x++)k+=er[x].distanceTo(er[x+1])/2;if(k===0)Se=er[0];else for(x=0,q=0;x<Tr-1;x++)if(ae=er[x],fe=er[x+1],T=ae.distanceTo(fe),q+=T,q>k){ve=(q-k)/T,Se=[fe.x-ve*(fe.x-ae.x),fe.y-ve*(fe.y-ae.y)];break}var Vr=h.unproject(U(Se));return X([Vr.lat+Ue.lat,Vr.lng+Ue.lng])}var k5={__proto__:null,simplify:rN,pointToSegmentDistance:sN,closestPointOnSegment:b5,clipSegment:iN,_getEdgeIntersection:$f,_getBitCode:Jo,_sqClosestPointOnSegment:nu,isFlat:Cs,_flat:oN,polylineCenter:lN},mx={project:function(l){return new z(l.lng,l.lat)},unproject:function(l){return new te(l.y,l.x)},bounds:new O([-180,-90],[180,90])},px={R:6378137,R_MINOR:6356752314245179e-9,bounds:new O([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(l){var h=Math.PI/180,x=this.R,k=l.lat*h,T=this.R_MINOR/x,q=Math.sqrt(1-T*T),ae=q*Math.sin(k),fe=Math.tan(Math.PI/4-k/2)/Math.pow((1-ae)/(1+ae),q/2);return k=-x*Math.log(Math.max(fe,1e-10)),new z(l.lng*h*x,k)},unproject:function(l){for(var h=180/Math.PI,x=this.R,k=this.R_MINOR/x,T=Math.sqrt(1-k*k),q=Math.exp(-l.y/x),ae=Math.PI/2-2*Math.atan(q),fe=0,ve=.1,Se;fe<15&&Math.abs(ve)>1e-7;fe++)Se=T*Math.sin(ae),Se=Math.pow((1-Se)/(1+Se),T/2),ve=Math.PI/2-2*Math.atan(q*Se)-ae,ae+=ve;return new te(ae*h,l.x*h/x)}},C5={__proto__:null,LonLat:mx,Mercator:px,SphericalMercator:G},E5=a({},ie,{code:"EPSG:3395",projection:px,transformation:function(){var l=.5/(Math.PI*px.R);return me(l,.5,-l,.5)}()}),cN=a({},ie,{code:"EPSG:4326",projection:mx,transformation:me(1/180,1,-1/180,.5)}),A5=a({},Z,{projection:mx,transformation:me(1,0,-1,0),scale:function(l){return Math.pow(2,l)},zoom:function(l){return Math.log(l)/Math.LN2},distance:function(l,h){var x=h.lng-l.lng,k=h.lat-l.lat;return Math.sqrt(x*x+k*k)},infinite:!0});Z.Earth=ie,Z.EPSG3395=E5,Z.EPSG3857=he,Z.EPSG900913=xe,Z.EPSG4326=cN,Z.Simple=A5;var Ws=Q.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(l){return l.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(l){return l&&l.removeLayer(this),this},getPane:function(l){return this._map.getPane(l?this.options[l]||l:this.options.pane)},addInteractiveTarget:function(l){return this._map._targets[d(l)]=this,this},removeInteractiveTarget:function(l){return delete this._map._targets[d(l)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(l){var h=l.target;if(h.hasLayer(this)){if(this._map=h,this._zoomAnimated=h._zoomAnimated,this.getEvents){var x=this.getEvents();h.on(x,this),this.once("remove",function(){h.off(x,this)},this)}this.onAdd(h),this.fire("add"),h.fire("layeradd",{layer:this})}}});Xt.include({addLayer:function(l){if(!l._layerAdd)throw new Error("The provided object is not a Layer.");var h=d(l);return this._layers[h]?this:(this._layers[h]=l,l._mapToAdd=this,l.beforeAdd&&l.beforeAdd(this),this.whenReady(l._layerAdd,l),this)},removeLayer:function(l){var h=d(l);return this._layers[h]?(this._loaded&&l.onRemove(this),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:l}),l.fire("remove")),l._map=l._mapToAdd=null,this):this},hasLayer:function(l){return d(l)in this._layers},eachLayer:function(l,h){for(var x in this._layers)l.call(h,this._layers[x]);return this},_addLayers:function(l){l=l?N(l)?l:[l]:[];for(var h=0,x=l.length;h<x;h++)this.addLayer(l[h])},_addZoomLimit:function(l){(!isNaN(l.options.maxZoom)||!isNaN(l.options.minZoom))&&(this._zoomBoundLayers[d(l)]=l,this._updateZoomLevels())},_removeZoomLimit:function(l){var h=d(l);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels())},_updateZoomLevels:function(){var l=1/0,h=-1/0,x=this._getZoomSpan();for(var k in this._zoomBoundLayers){var T=this._zoomBoundLayers[k].options;l=T.minZoom===void 0?l:Math.min(l,T.minZoom),h=T.maxZoom===void 0?h:Math.max(h,T.maxZoom)}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=l===1/0?void 0:l,x!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ec=Ws.extend({initialize:function(l,h){v(this,h),this._layers={};var x,k;if(l)for(x=0,k=l.length;x<k;x++)this.addLayer(l[x])},addLayer:function(l){var h=this.getLayerId(l);return this._layers[h]=l,this._map&&this._map.addLayer(l),this},removeLayer:function(l){var h=l in this._layers?l:this.getLayerId(l);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this},hasLayer:function(l){var h=typeof l=="number"?l:this.getLayerId(l);return h in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(l){var h=Array.prototype.slice.call(arguments,1),x,k;for(x in this._layers)k=this._layers[x],k[l]&&k[l].apply(k,h);return this},onAdd:function(l){this.eachLayer(l.addLayer,l)},onRemove:function(l){this.eachLayer(l.removeLayer,l)},eachLayer:function(l,h){for(var x in this._layers)l.call(h,this._layers[x]);return this},getLayer:function(l){return this._layers[l]},getLayers:function(){var l=[];return this.eachLayer(l.push,l),l},setZIndex:function(l){return this.invoke("setZIndex",l)},getLayerId:function(l){return d(l)}}),P5=function(l,h){return new ec(l,h)},ei=ec.extend({addLayer:function(l){return this.hasLayer(l)?this:(l.addEventParent(this),ec.prototype.addLayer.call(this,l),this.fire("layeradd",{layer:l}))},removeLayer:function(l){return this.hasLayer(l)?(l in this._layers&&(l=this._layers[l]),l.removeEventParent(this),ec.prototype.removeLayer.call(this,l),this.fire("layerremove",{layer:l})):this},setStyle:function(l){return this.invoke("setStyle",l)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var l=new H;for(var h in this._layers){var x=this._layers[h];l.extend(x.getBounds?x.getBounds():x.getLatLng())}return l}}),D5=function(l,h){return new ei(l,h)},tc=ee.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(l){v(this,l)},createIcon:function(l){return this._createIcon("icon",l)},createShadow:function(l){return this._createIcon("shadow",l)},_createIcon:function(l,h){var x=this._getIconUrl(l);if(!x){if(l==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var k=this._createImg(x,h&&h.tagName==="IMG"?h:null);return this._setIconStyles(k,l),(this.options.crossOrigin||this.options.crossOrigin==="")&&(k.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),k},_setIconStyles:function(l,h){var x=this.options,k=x[h+"Size"];typeof k=="number"&&(k=[k,k]);var T=U(k),q=U(h==="shadow"&&x.shadowAnchor||x.iconAnchor||T&&T.divideBy(2,!0));l.className="leaflet-marker-"+h+" "+(x.className||""),q&&(l.style.marginLeft=-q.x+"px",l.style.marginTop=-q.y+"px"),T&&(l.style.width=T.x+"px",l.style.height=T.y+"px")},_createImg:function(l,h){return h=h||document.createElement("img"),h.src=l,h},_getIconUrl:function(l){return tt.retina&&this.options[l+"RetinaUrl"]||this.options[l+"Url"]}});function T5(l){return new tc(l)}var ru=tc.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(l){return typeof ru.imagePath!="string"&&(ru.imagePath=this._detectIconPath()),(this.options.imagePath||ru.imagePath)+tc.prototype._getIconUrl.call(this,l)},_stripUrl:function(l){var h=function(x,k,T){var q=k.exec(x);return q&&q[T]};return l=h(l,/^url\((['"])?(.+)\1\)$/,2),l&&h(l,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var l=nn("div","leaflet-default-icon-path",document.body),h=Qd(l,"background-image")||Qd(l,"backgroundImage");if(document.body.removeChild(l),h=this._stripUrl(h),h)return h;var x=document.querySelector('link[href$="leaflet.css"]');return x?x.href.substring(0,x.href.length-11-1):""}}),dN=ba.extend({initialize:function(l){this._marker=l},addHooks:function(){var l=this._marker._icon;this._draggable||(this._draggable=new Mi(l,l,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ot(l,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Rn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(l){var h=this._marker,x=h._map,k=this._marker.options.autoPanSpeed,T=this._marker.options.autoPanPadding,q=Qo(h._icon),ae=x.getPixelBounds(),fe=x.getPixelOrigin(),ve=I(ae.min._subtract(fe).add(T),ae.max._subtract(fe).subtract(T));if(!ve.contains(q)){var Se=U((Math.max(ve.max.x,q.x)-ve.max.x)/(ae.max.x-ve.max.x)-(Math.min(ve.min.x,q.x)-ve.min.x)/(ae.min.x-ve.min.x),(Math.max(ve.max.y,q.y)-ve.max.y)/(ae.max.y-ve.max.y)-(Math.min(ve.min.y,q.y)-ve.min.y)/(ae.min.y-ve.min.y)).multiplyBy(k);x.panBy(Se,{animate:!1}),this._draggable._newPos._add(Se),this._draggable._startPos._add(Se),Fn(h._icon,this._draggable._newPos),this._onDrag(l),this._panRequest=P(this._adjustPan.bind(this,l))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(l){this._marker.options.autoPan&&(F(this._panRequest),this._panRequest=P(this._adjustPan.bind(this,l)))},_onDrag:function(l){var h=this._marker,x=h._shadow,k=Qo(h._icon),T=h._map.layerPointToLatLng(k);x&&Fn(x,k),h._latlng=T,l.latlng=T,l.oldLatLng=this._oldLatLng,h.fire("move",l).fire("drag",l)},_onDragEnd:function(l){F(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",l)}}),Uf=Ws.extend({options:{icon:new ru,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(l,h){v(this,h),this._latlng=X(l)},onAdd:function(l){this._zoomAnimated=this._zoomAnimated&&l.options.markerZoomAnimation,this._zoomAnimated&&l.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(l){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&l.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(l){var h=this._latlng;return this._latlng=X(l),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},setZIndexOffset:function(l){return this.options.zIndexOffset=l,this.update()},getIcon:function(){return this.options.icon},setIcon:function(l){return this.options.icon=l,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var l=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(l)}return this},_initIcon:function(){var l=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),x=l.icon.createIcon(this._icon),k=!1;x!==this._icon&&(this._icon&&this._removeIcon(),k=!0,l.title&&(x.title=l.title),x.tagName==="IMG"&&(x.alt=l.alt||"")),Ot(x,h),l.keyboard&&(x.tabIndex="0",x.setAttribute("role","button")),this._icon=x,l.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Pt(x,"focus",this._panOnFocus,this);var T=l.icon.createShadow(this._shadow),q=!1;T!==this._shadow&&(this._removeShadow(),q=!0),T&&(Ot(T,h),T.alt=""),this._shadow=T,l.opacity<1&&this._updateOpacity(),k&&this.getPane().appendChild(this._icon),this._initInteraction(),T&&q&&this.getPane(l.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&pn(this._icon,"focus",this._panOnFocus,this),Sn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Sn(this._shadow),this._shadow=null},_setPos:function(l){this._icon&&Fn(this._icon,l),this._shadow&&Fn(this._shadow,l),this._zIndex=l.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(l){this._icon&&(this._icon.style.zIndex=this._zIndex+l)},_animateZoom:function(l){var h=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center).round();this._setPos(h)},_initInteraction:function(){if(this.options.interactive&&(Ot(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),dN)){var l=this.options.draggable;this.dragging&&(l=this.dragging.enabled(),this.dragging.disable()),this.dragging=new dN(this),l&&this.dragging.enable()}},setOpacity:function(l){return this.options.opacity=l,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var l=this.options.opacity;this._icon&&ks(this._icon,l),this._shadow&&ks(this._shadow,l)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var l=this._map;if(l){var h=this.options.icon.options,x=h.iconSize?U(h.iconSize):U(0,0),k=h.iconAnchor?U(h.iconAnchor):U(0,0);l.panInside(this._latlng,{paddingTopLeft:k,paddingBottomRight:x.subtract(k)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function M5(l,h){return new Uf(l,h)}var Ri=Ws.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(l){this._renderer=l.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(l){return v(this,l),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&l&&Object.prototype.hasOwnProperty.call(l,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),qf=Ri.extend({options:{fill:!0,radius:10},initialize:function(l,h){v(this,h),this._latlng=X(l),this._radius=this.options.radius},setLatLng:function(l){var h=this._latlng;return this._latlng=X(l),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(l){return this.options.radius=this._radius=l,this.redraw()},getRadius:function(){return this._radius},setStyle:function(l){var h=l&&l.radius||this._radius;return Ri.prototype.setStyle.call(this,l),this.setRadius(h),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var l=this._radius,h=this._radiusY||l,x=this._clickTolerance(),k=[l+x,h+x];this._pxBounds=new O(this._point.subtract(k),this._point.add(k))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(l){return l.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function R5(l,h){return new qf(l,h)}var gx=qf.extend({initialize:function(l,h,x){if(typeof h=="number"&&(h=a({},x,{radius:h})),v(this,h),this._latlng=X(l),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(l){return this._mRadius=l,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var l=[this._radius,this._radiusY||this._radius];return new H(this._map.layerPointToLatLng(this._point.subtract(l)),this._map.layerPointToLatLng(this._point.add(l)))},setStyle:Ri.prototype.setStyle,_project:function(){var l=this._latlng.lng,h=this._latlng.lat,x=this._map,k=x.options.crs;if(k.distance===ie.distance){var T=Math.PI/180,q=this._mRadius/ie.R/T,ae=x.project([h+q,l]),fe=x.project([h-q,l]),ve=ae.add(fe).divideBy(2),Se=x.unproject(ve).lat,Ue=Math.acos((Math.cos(q*T)-Math.sin(h*T)*Math.sin(Se*T))/(Math.cos(h*T)*Math.cos(Se*T)))/T;(isNaN(Ue)||Ue===0)&&(Ue=q/Math.cos(Math.PI/180*h)),this._point=ve.subtract(x.getPixelOrigin()),this._radius=isNaN(Ue)?0:ve.x-x.project([Se,l-Ue]).x,this._radiusY=ve.y-ae.y}else{var _t=k.unproject(k.project(this._latlng).subtract([this._mRadius,0]));this._point=x.latLngToLayerPoint(this._latlng),this._radius=this._point.x-x.latLngToLayerPoint(_t).x}this._updateBounds()}});function I5(l,h,x){return new gx(l,h,x)}var ti=Ri.extend({options:{smoothFactor:1,noClip:!1},initialize:function(l,h){v(this,h),this._setLatLngs(l)},getLatLngs:function(){return this._latlngs},setLatLngs:function(l){return this._setLatLngs(l),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(l){for(var h=1/0,x=null,k=nu,T,q,ae=0,fe=this._parts.length;ae<fe;ae++)for(var ve=this._parts[ae],Se=1,Ue=ve.length;Se<Ue;Se++){T=ve[Se-1],q=ve[Se];var _t=k(l,T,q,!0);_t<h&&(h=_t,x=k(l,T,q))}return x&&(x.distance=Math.sqrt(h)),x},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return lN(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(l,h){return h=h||this._defaultShape(),l=X(l),h.push(l),this._bounds.extend(l),this.redraw()},_setLatLngs:function(l){this._bounds=new H,this._latlngs=this._convertLatLngs(l)},_defaultShape:function(){return Cs(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(l){for(var h=[],x=Cs(l),k=0,T=l.length;k<T;k++)x?(h[k]=X(l[k]),this._bounds.extend(h[k])):h[k]=this._convertLatLngs(l[k]);return h},_project:function(){var l=new O;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,l),this._bounds.isValid()&&l.isValid()&&(this._rawPxBounds=l,this._updateBounds())},_updateBounds:function(){var l=this._clickTolerance(),h=new z(l,l);this._rawPxBounds&&(this._pxBounds=new O([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)]))},_projectLatlngs:function(l,h,x){var k=l[0]instanceof te,T=l.length,q,ae;if(k){for(ae=[],q=0;q<T;q++)ae[q]=this._map.latLngToLayerPoint(l[q]),x.extend(ae[q]);h.push(ae)}else for(q=0;q<T;q++)this._projectLatlngs(l[q],h,x)},_clipPoints:function(){var l=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(l))){if(this.options.noClip){this._parts=this._rings;return}var h=this._parts,x,k,T,q,ae,fe,ve;for(x=0,T=0,q=this._rings.length;x<q;x++)for(ve=this._rings[x],k=0,ae=ve.length;k<ae-1;k++)fe=iN(ve[k],ve[k+1],l,k,!0),fe&&(h[T]=h[T]||[],h[T].push(fe[0]),(fe[1]!==ve[k+1]||k===ae-2)&&(h[T].push(fe[1]),T++))}},_simplifyPoints:function(){for(var l=this._parts,h=this.options.smoothFactor,x=0,k=l.length;x<k;x++)l[x]=rN(l[x],h)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(l,h){var x,k,T,q,ae,fe,ve=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(l))return!1;for(x=0,q=this._parts.length;x<q;x++)for(fe=this._parts[x],k=0,ae=fe.length,T=ae-1;k<ae;T=k++)if(!(!h&&k===0)&&sN(l,fe[T],fe[k])<=ve)return!0;return!1}});function O5(l,h){return new ti(l,h)}ti._flat=oN;var nc=ti.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return nN(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(l){var h=ti.prototype._convertLatLngs.call(this,l),x=h.length;return x>=2&&h[0]instanceof te&&h[0].equals(h[x-1])&&h.pop(),h},_setLatLngs:function(l){ti.prototype._setLatLngs.call(this,l),Cs(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Cs(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var l=this._renderer._bounds,h=this.options.weight,x=new z(h,h);if(l=new O(l.min.subtract(x),l.max.add(x)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(l))){if(this.options.noClip){this._parts=this._rings;return}for(var k=0,T=this._rings.length,q;k<T;k++)q=tN(this._rings[k],l,!0),q.length&&this._parts.push(q)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(l){var h=!1,x,k,T,q,ae,fe,ve,Se;if(!this._pxBounds||!this._pxBounds.contains(l))return!1;for(q=0,ve=this._parts.length;q<ve;q++)for(x=this._parts[q],ae=0,Se=x.length,fe=Se-1;ae<Se;fe=ae++)k=x[ae],T=x[fe],k.y>l.y!=T.y>l.y&&l.x<(T.x-k.x)*(l.y-k.y)/(T.y-k.y)+k.x&&(h=!h);return h||ti.prototype._containsPoint.call(this,l,!0)}});function L5(l,h){return new nc(l,h)}var ni=ei.extend({initialize:function(l,h){v(this,h),this._layers={},l&&this.addData(l)},addData:function(l){var h=N(l)?l:l.features,x,k,T;if(h){for(x=0,k=h.length;x<k;x++)T=h[x],(T.geometries||T.geometry||T.features||T.coordinates)&&this.addData(T);return this}var q=this.options;if(q.filter&&!q.filter(l))return this;var ae=Wf(l,q);return ae?(ae.feature=Kf(l),ae.defaultOptions=ae.options,this.resetStyle(ae),q.onEachFeature&&q.onEachFeature(l,ae),this.addLayer(ae)):this},resetStyle:function(l){return l===void 0?this.eachLayer(this.resetStyle,this):(l.options=a({},l.defaultOptions),this._setLayerStyle(l,this.options.style),this)},setStyle:function(l){return this.eachLayer(function(h){this._setLayerStyle(h,l)},this)},_setLayerStyle:function(l,h){l.setStyle&&(typeof h=="function"&&(h=h(l.feature)),l.setStyle(h))}});function Wf(l,h){var x=l.type==="Feature"?l.geometry:l,k=x?x.coordinates:null,T=[],q=h&&h.pointToLayer,ae=h&&h.coordsToLatLng||xx,fe,ve,Se,Ue;if(!k&&!x)return null;switch(x.type){case"Point":return fe=ae(k),uN(q,l,fe,h);case"MultiPoint":for(Se=0,Ue=k.length;Se<Ue;Se++)fe=ae(k[Se]),T.push(uN(q,l,fe,h));return new ei(T);case"LineString":case"MultiLineString":return ve=Hf(k,x.type==="LineString"?0:1,ae),new ti(ve,h);case"Polygon":case"MultiPolygon":return ve=Hf(k,x.type==="Polygon"?1:2,ae),new nc(ve,h);case"GeometryCollection":for(Se=0,Ue=x.geometries.length;Se<Ue;Se++){var _t=Wf({geometry:x.geometries[Se],type:"Feature",properties:l.properties},h);_t&&T.push(_t)}return new ei(T);case"FeatureCollection":for(Se=0,Ue=x.features.length;Se<Ue;Se++){var $t=Wf(x.features[Se],h);$t&&T.push($t)}return new ei(T);default:throw new Error("Invalid GeoJSON object.")}}function uN(l,h,x,k){return l?l(h,x):new Uf(x,k&&k.markersInheritOptions&&k)}function xx(l){return new te(l[1],l[0],l[2])}function Hf(l,h,x){for(var k=[],T=0,q=l.length,ae;T<q;T++)ae=h?Hf(l[T],h-1,x):(x||xx)(l[T]),k.push(ae);return k}function vx(l,h){return l=X(l),l.alt!==void 0?[p(l.lng,h),p(l.lat,h),p(l.alt,h)]:[p(l.lng,h),p(l.lat,h)]}function Vf(l,h,x,k){for(var T=[],q=0,ae=l.length;q<ae;q++)T.push(h?Vf(l[q],Cs(l[q])?0:h-1,x,k):vx(l[q],k));return!h&&x&&T.length>0&&T.push(T[0].slice()),T}function rc(l,h){return l.feature?a({},l.feature,{geometry:h}):Kf(h)}function Kf(l){return l.type==="Feature"||l.type==="FeatureCollection"?l:{type:"Feature",properties:{},geometry:l}}var yx={toGeoJSON:function(l){return rc(this,{type:"Point",coordinates:vx(this.getLatLng(),l)})}};Uf.include(yx),gx.include(yx),qf.include(yx),ti.include({toGeoJSON:function(l){var h=!Cs(this._latlngs),x=Vf(this._latlngs,h?1:0,!1,l);return rc(this,{type:(h?"Multi":"")+"LineString",coordinates:x})}}),nc.include({toGeoJSON:function(l){var h=!Cs(this._latlngs),x=h&&!Cs(this._latlngs[0]),k=Vf(this._latlngs,x?2:h?1:0,!0,l);return h||(k=[k]),rc(this,{type:(x?"Multi":"")+"Polygon",coordinates:k})}}),ec.include({toMultiPoint:function(l){var h=[];return this.eachLayer(function(x){h.push(x.toGeoJSON(l).geometry.coordinates)}),rc(this,{type:"MultiPoint",coordinates:h})},toGeoJSON:function(l){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(h==="MultiPoint")return this.toMultiPoint(l);var x=h==="GeometryCollection",k=[];return this.eachLayer(function(T){if(T.toGeoJSON){var q=T.toGeoJSON(l);if(x)k.push(q.geometry);else{var ae=Kf(q);ae.type==="FeatureCollection"?k.push.apply(k,ae.features):k.push(ae)}}}),x?rc(this,{geometries:k,type:"GeometryCollection"}):{type:"FeatureCollection",features:k}}});function hN(l,h){return new ni(l,h)}var F5=hN,Zf=Ws.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(l,h,x){this._url=l,this._bounds=$(h),v(this,x)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ot(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Sn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(l){return this.options.opacity=l,this._image&&this._updateOpacity(),this},setStyle:function(l){return l.opacity&&this.setOpacity(l.opacity),this},bringToFront:function(){return this._map&&Xl(this._image),this},bringToBack:function(){return this._map&&Jl(this._image),this},setUrl:function(l){return this._url=l,this._image&&(this._image.src=l),this},setBounds:function(l){return this._bounds=$(l),this._map&&this._reset(),this},getEvents:function(){var l={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},setZIndex:function(l){return this.options.zIndex=l,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var l=this._url.tagName==="IMG",h=this._image=l?this._url:nn("img");if(Ot(h,"leaflet-image-layer"),this._zoomAnimated&&Ot(h,"leaflet-zoom-animated"),this.options.className&&Ot(h,this.options.className),h.onselectstart=f,h.onmousemove=f,h.onload=o(this.fire,this,"load"),h.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),l){this._url=h.src;return}h.src=this._url,h.alt=this.options.alt},_animateZoom:function(l){var h=this._map.getZoomScale(l.zoom),x=this._map._latLngBoundsToNewLayerBounds(this._bounds,l.zoom,l.center).min;Go(this._image,x,h)},_reset:function(){var l=this._image,h=new O(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),x=h.getSize();Fn(l,h.min),l.style.width=x.x+"px",l.style.height=x.y+"px"},_updateOpacity:function(){ks(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var l=this.options.errorOverlayUrl;l&&this._url!==l&&(this._url=l,this._image.src=l)},getCenter:function(){return this._bounds.getCenter()}}),B5=function(l,h,x){return new Zf(l,h,x)},fN=Zf.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var l=this._url.tagName==="VIDEO",h=this._image=l?this._url:nn("video");if(Ot(h,"leaflet-image-layer"),this._zoomAnimated&&Ot(h,"leaflet-zoom-animated"),this.options.className&&Ot(h,this.options.className),h.onselectstart=f,h.onmousemove=f,h.onloadeddata=o(this.fire,this,"load"),l){for(var x=h.getElementsByTagName("source"),k=[],T=0;T<x.length;T++)k.push(x[T].src);this._url=x.length>0?k:[h.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted,h.playsInline=!!this.options.playsInline;for(var q=0;q<this._url.length;q++){var ae=nn("source");ae.src=this._url[q],h.appendChild(ae)}}});function z5(l,h,x){return new fN(l,h,x)}var mN=Zf.extend({_initImage:function(){var l=this._image=this._url;Ot(l,"leaflet-image-layer"),this._zoomAnimated&&Ot(l,"leaflet-zoom-animated"),this.options.className&&Ot(l,this.options.className),l.onselectstart=f,l.onmousemove=f}});function $5(l,h,x){return new mN(l,h,x)}var ja=Ws.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(l,h){l&&(l instanceof te||N(l))?(this._latlng=X(l),v(this,h)):(v(this,l),this._source=h),this.options.content&&(this._content=this.options.content)},openOn:function(l){return l=arguments.length?l:this._source._map,l.hasLayer(this)||l.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(l){return this._map?this.close():(arguments.length?this._source=l:l=this._source,this._prepareOpen(),this.openOn(l._map)),this},onAdd:function(l){this._zoomAnimated=l._zoomAnimated,this._container||this._initLayout(),l._fadeAnimated&&ks(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),l._fadeAnimated&&ks(this._container,1),this.bringToFront(),this.options.interactive&&(Ot(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(l){l._fadeAnimated?(ks(this._container,0),this._removeTimeout=setTimeout(o(Sn,void 0,this._container),200)):Sn(this._container),this.options.interactive&&(Rn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(l){return this._latlng=X(l),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(l){return this._content=l,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var l={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Xl(this._container),this},bringToBack:function(){return this._map&&Jl(this._container),this},_prepareOpen:function(l){var h=this._source;if(!h._map)return!1;if(h instanceof ei){h=null;var x=this._source._layers;for(var k in x)if(x[k]._map){h=x[k];break}if(!h)return!1;this._source=h}if(!l)if(h.getCenter)l=h.getCenter();else if(h.getLatLng)l=h.getLatLng();else if(h.getBounds)l=h.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(l),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var l=this._contentNode,h=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof h=="string")l.innerHTML=h;else{for(;l.hasChildNodes();)l.removeChild(l.firstChild);l.appendChild(h)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var l=this._map.latLngToLayerPoint(this._latlng),h=U(this.options.offset),x=this._getAnchor();this._zoomAnimated?Fn(this._container,l.add(x)):h=h.add(l).add(x);var k=this._containerBottom=-h.y,T=this._containerLeft=-Math.round(this._containerWidth/2)+h.x;this._container.style.bottom=k+"px",this._container.style.left=T+"px"}},_getAnchor:function(){return[0,0]}});Xt.include({_initOverlay:function(l,h,x,k){var T=h;return T instanceof l||(T=new l(k).setContent(h)),x&&T.setLatLng(x),T}}),Ws.include({_initOverlay:function(l,h,x,k){var T=x;return T instanceof l?(v(T,k),T._source=this):(T=h&&!k?h:new l(k,this),T.setContent(x)),T}});var Gf=ja.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(l){return l=arguments.length?l:this._source._map,!l.hasLayer(this)&&l._popup&&l._popup.options.autoClose&&l.removeLayer(l._popup),l._popup=this,ja.prototype.openOn.call(this,l)},onAdd:function(l){ja.prototype.onAdd.call(this,l),l.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ri||this._source.on("preclick",Yo))},onRemove:function(l){ja.prototype.onRemove.call(this,l),l.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ri||this._source.off("preclick",Yo))},getEvents:function(){var l=ja.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(l.preclick=this.close),this.options.keepInView&&(l.moveend=this._adjustPan),l},_initLayout:function(){var l="leaflet-popup",h=this._container=nn("div",l+" "+(this.options.className||"")+" leaflet-zoom-animated"),x=this._wrapper=nn("div",l+"-content-wrapper",h);if(this._contentNode=nn("div",l+"-content",x),eu(h),lx(this._contentNode),Pt(h,"contextmenu",Yo),this._tipContainer=nn("div",l+"-tip-container",h),this._tip=nn("div",l+"-tip",this._tipContainer),this.options.closeButton){var k=this._closeButton=nn("a",l+"-close-button",h);k.setAttribute("role","button"),k.setAttribute("aria-label","Close popup"),k.href="#close",k.innerHTML='<span aria-hidden="true">&#215;</span>',Pt(k,"click",function(T){dr(T),this.close()},this)}},_updateLayout:function(){var l=this._contentNode,h=l.style;h.width="",h.whiteSpace="nowrap";var x=l.offsetWidth;x=Math.min(x,this.options.maxWidth),x=Math.max(x,this.options.minWidth),h.width=x+1+"px",h.whiteSpace="",h.height="";var k=l.offsetHeight,T=this.options.maxHeight,q="leaflet-popup-scrolled";T&&k>T?(h.height=T+"px",Ot(l,q)):Rn(l,q),this._containerWidth=this._container.offsetWidth},_animateZoom:function(l){var h=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center),x=this._getAnchor();Fn(this._container,h.add(x))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var l=this._map,h=parseInt(Qd(this._container,"marginBottom"),10)||0,x=this._container.offsetHeight+h,k=this._containerWidth,T=new z(this._containerLeft,-x-this._containerBottom);T._add(Qo(this._container));var q=l.layerPointToContainerPoint(T),ae=U(this.options.autoPanPadding),fe=U(this.options.autoPanPaddingTopLeft||ae),ve=U(this.options.autoPanPaddingBottomRight||ae),Se=l.getSize(),Ue=0,_t=0;q.x+k+ve.x>Se.x&&(Ue=q.x+k-Se.x+ve.x),q.x-Ue-fe.x<0&&(Ue=q.x-fe.x),q.y+x+ve.y>Se.y&&(_t=q.y+x-Se.y+ve.y),q.y-_t-fe.y<0&&(_t=q.y-fe.y),(Ue||_t)&&(this.options.keepInView&&(this._autopanning=!0),l.fire("autopanstart").panBy([Ue,_t]))}},_getAnchor:function(){return U(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),U5=function(l,h){return new Gf(l,h)};Xt.mergeOptions({closePopupOnClick:!0}),Xt.include({openPopup:function(l,h,x){return this._initOverlay(Gf,l,h,x).openOn(this),this},closePopup:function(l){return l=arguments.length?l:this._popup,l&&l.close(),this}}),Ws.include({bindPopup:function(l,h){return this._popup=this._initOverlay(Gf,this._popup,l,h),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(l){return this._popup&&(this instanceof ei||(this._popup._source=this),this._popup._prepareOpen(l||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(l){return this._popup&&this._popup.setContent(l),this},getPopup:function(){return this._popup},_openPopup:function(l){if(!(!this._popup||!this._map)){Xo(l);var h=l.layer||l.target;if(this._popup._source===h&&!(h instanceof Ri)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(l.latlng);return}this._popup._source=h,this.openPopup(l.latlng)}},_movePopup:function(l){this._popup.setLatLng(l.latlng)},_onKeyPress:function(l){l.originalEvent.keyCode===13&&this._openPopup(l)}});var Qf=ja.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(l){ja.prototype.onAdd.call(this,l),this.setOpacity(this.options.opacity),l.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(l){ja.prototype.onRemove.call(this,l),l.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var l=ja.prototype.getEvents.call(this);return this.options.permanent||(l.preclick=this.close),l},_initLayout:function(){var l="leaflet-tooltip",h=l+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=nn("div",h),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(l){var h,x,k=this._map,T=this._container,q=k.latLngToContainerPoint(k.getCenter()),ae=k.layerPointToContainerPoint(l),fe=this.options.direction,ve=T.offsetWidth,Se=T.offsetHeight,Ue=U(this.options.offset),_t=this._getAnchor();fe==="top"?(h=ve/2,x=Se):fe==="bottom"?(h=ve/2,x=0):fe==="center"?(h=ve/2,x=Se/2):fe==="right"?(h=0,x=Se/2):fe==="left"?(h=ve,x=Se/2):ae.x<q.x?(fe="right",h=0,x=Se/2):(fe="left",h=ve+(Ue.x+_t.x)*2,x=Se/2),l=l.subtract(U(h,x,!0)).add(Ue).add(_t),Rn(T,"leaflet-tooltip-right"),Rn(T,"leaflet-tooltip-left"),Rn(T,"leaflet-tooltip-top"),Rn(T,"leaflet-tooltip-bottom"),Ot(T,"leaflet-tooltip-"+fe),Fn(T,l)},_updatePosition:function(){var l=this._map.latLngToLayerPoint(this._latlng);this._setPosition(l)},setOpacity:function(l){this.options.opacity=l,this._container&&ks(this._container,l)},_animateZoom:function(l){var h=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center);this._setPosition(h)},_getAnchor:function(){return U(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),q5=function(l,h){return new Qf(l,h)};Xt.include({openTooltip:function(l,h,x){return this._initOverlay(Qf,l,h,x).openOn(this),this},closeTooltip:function(l){return l.close(),this}}),Ws.include({bindTooltip:function(l,h){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Qf,this._tooltip,l,h),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(l){if(!(!l&&this._tooltipHandlersAdded)){var h=l?"off":"on",x={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?x.add=this._openTooltip:(x.mouseover=this._openTooltip,x.mouseout=this.closeTooltip,x.click=this._openTooltip,this._map?this._addFocusListeners():x.add=this._addFocusListeners),this._tooltip.options.sticky&&(x.mousemove=this._moveTooltip),this[h](x),this._tooltipHandlersAdded=!l}},openTooltip:function(l){return this._tooltip&&(this instanceof ei||(this._tooltip._source=this),this._tooltip._prepareOpen(l)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(l){return this._tooltip&&this._tooltip.setContent(l),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(l){var h=typeof l.getElement=="function"&&l.getElement();h&&(Pt(h,"focus",function(){this._tooltip._source=l,this.openTooltip()},this),Pt(h,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(l){var h=typeof l.getElement=="function"&&l.getElement();h&&h.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(l){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var h=this;this._map.once("moveend",function(){h._openOnceFlag=!1,h._openTooltip(l)});return}this._tooltip._source=l.layer||l.target,this.openTooltip(this._tooltip.options.sticky?l.latlng:void 0)}},_moveTooltip:function(l){var h=l.latlng,x,k;this._tooltip.options.sticky&&l.originalEvent&&(x=this._map.mouseEventToContainerPoint(l.originalEvent),k=this._map.containerPointToLayerPoint(x),h=this._map.layerPointToLatLng(k)),this._tooltip.setLatLng(h)}});var pN=tc.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(l){var h=l&&l.tagName==="DIV"?l:document.createElement("div"),x=this.options;if(x.html instanceof Element?(Of(h),h.appendChild(x.html)):h.innerHTML=x.html!==!1?x.html:"",x.bgPos){var k=U(x.bgPos);h.style.backgroundPosition=-k.x+"px "+-k.y+"px"}return this._setIconStyles(h,"icon"),h},createShadow:function(){return null}});function W5(l){return new pN(l)}tc.Default=ru;var su=Ws.extend({options:{tileSize:256,opacity:1,updateWhenIdle:tt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(l){v(this,l)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(l){l._addZoomLimit(this)},onRemove:function(l){this._removeAllTiles(),Sn(this._container),l._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Xl(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Jl(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(l){return this.options.opacity=l,this._updateOpacity(),this},setZIndex:function(l){return this.options.zIndex=l,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var l=this._clampZoom(this._map.getZoom());l!==this._tileZoom&&(this._tileZoom=l,this._updateLevels()),this._update()}return this},getEvents:function(){var l={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=u(this._onMoveEnd,this.options.updateInterval,this)),l.move=this._onMove),this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},createTile:function(){return document.createElement("div")},getTileSize:function(){var l=this.options.tileSize;return l instanceof z?l:new z(l,l)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(l){for(var h=this.getPane().children,x=-l(-1/0,1/0),k=0,T=h.length,q;k<T;k++)q=h[k].style.zIndex,h[k]!==this._container&&q&&(x=l(x,+q));isFinite(x)&&(this.options.zIndex=x+l(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!tt.ielt9){ks(this._container,this.options.opacity);var l=+new Date,h=!1,x=!1;for(var k in this._tiles){var T=this._tiles[k];if(!(!T.current||!T.loaded)){var q=Math.min(1,(l-T.loaded)/200);ks(T.el,q),q<1?h=!0:(T.active?x=!0:this._onOpaqueTile(T),T.active=!0)}}x&&!this._noPrune&&this._pruneTiles(),h&&(F(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this))}},_onOpaqueTile:f,_initContainer:function(){this._container||(this._container=nn("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var l=this._tileZoom,h=this.options.maxZoom;if(l!==void 0){for(var x in this._levels)x=Number(x),this._levels[x].el.children.length||x===l?(this._levels[x].el.style.zIndex=h-Math.abs(l-x),this._onUpdateLevel(x)):(Sn(this._levels[x].el),this._removeTilesAtZoom(x),this._onRemoveLevel(x),delete this._levels[x]);var k=this._levels[l],T=this._map;return k||(k=this._levels[l]={},k.el=nn("div","leaflet-tile-container leaflet-zoom-animated",this._container),k.el.style.zIndex=h,k.origin=T.project(T.unproject(T.getPixelOrigin()),l).round(),k.zoom=l,this._setZoomTransform(k,T.getCenter(),T.getZoom()),f(k.el.offsetWidth),this._onCreateLevel(k)),this._level=k,k}},_onUpdateLevel:f,_onRemoveLevel:f,_onCreateLevel:f,_pruneTiles:function(){if(this._map){var l,h,x=this._map.getZoom();if(x>this.options.maxZoom||x<this.options.minZoom){this._removeAllTiles();return}for(l in this._tiles)h=this._tiles[l],h.retain=h.current;for(l in this._tiles)if(h=this._tiles[l],h.current&&!h.active){var k=h.coords;this._retainParent(k.x,k.y,k.z,k.z-5)||this._retainChildren(k.x,k.y,k.z,k.z+2)}for(l in this._tiles)this._tiles[l].retain||this._removeTile(l)}},_removeTilesAtZoom:function(l){for(var h in this._tiles)this._tiles[h].coords.z===l&&this._removeTile(h)},_removeAllTiles:function(){for(var l in this._tiles)this._removeTile(l)},_invalidateAll:function(){for(var l in this._levels)Sn(this._levels[l].el),this._onRemoveLevel(Number(l)),delete this._levels[l];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(l,h,x,k){var T=Math.floor(l/2),q=Math.floor(h/2),ae=x-1,fe=new z(+T,+q);fe.z=+ae;var ve=this._tileCoordsToKey(fe),Se=this._tiles[ve];return Se&&Se.active?(Se.retain=!0,!0):(Se&&Se.loaded&&(Se.retain=!0),ae>k?this._retainParent(T,q,ae,k):!1)},_retainChildren:function(l,h,x,k){for(var T=2*l;T<2*l+2;T++)for(var q=2*h;q<2*h+2;q++){var ae=new z(T,q);ae.z=x+1;var fe=this._tileCoordsToKey(ae),ve=this._tiles[fe];if(ve&&ve.active){ve.retain=!0;continue}else ve&&ve.loaded&&(ve.retain=!0);x+1<k&&this._retainChildren(T,q,x+1,k)}},_resetView:function(l){var h=l&&(l.pinch||l.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h)},_animateZoom:function(l){this._setView(l.center,l.zoom,!0,l.noUpdate)},_clampZoom:function(l){var h=this.options;return h.minNativeZoom!==void 0&&l<h.minNativeZoom?h.minNativeZoom:h.maxNativeZoom!==void 0&&h.maxNativeZoom<l?h.maxNativeZoom:l},_setView:function(l,h,x,k){var T=Math.round(h);this.options.maxZoom!==void 0&&T>this.options.maxZoom||this.options.minZoom!==void 0&&T<this.options.minZoom?T=void 0:T=this._clampZoom(T);var q=this.options.updateWhenZooming&&T!==this._tileZoom;(!k||q)&&(this._tileZoom=T,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),T!==void 0&&this._update(l),x||this._pruneTiles(),this._noPrune=!!x),this._setZoomTransforms(l,h)},_setZoomTransforms:function(l,h){for(var x in this._levels)this._setZoomTransform(this._levels[x],l,h)},_setZoomTransform:function(l,h,x){var k=this._map.getZoomScale(x,l.zoom),T=l.origin.multiplyBy(k).subtract(this._map._getNewPixelOrigin(h,x)).round();tt.any3d?Go(l.el,T,k):Fn(l.el,T)},_resetGrid:function(){var l=this._map,h=l.options.crs,x=this._tileSize=this.getTileSize(),k=this._tileZoom,T=this._map.getPixelWorldBounds(this._tileZoom);T&&(this._globalTileRange=this._pxBoundsToTileRange(T)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(l.project([0,h.wrapLng[0]],k).x/x.x),Math.ceil(l.project([0,h.wrapLng[1]],k).x/x.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(l.project([h.wrapLat[0],0],k).y/x.x),Math.ceil(l.project([h.wrapLat[1],0],k).y/x.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(l){var h=this._map,x=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),k=h.getZoomScale(x,this._tileZoom),T=h.project(l,this._tileZoom).floor(),q=h.getSize().divideBy(k*2);return new O(T.subtract(q),T.add(q))},_update:function(l){var h=this._map;if(h){var x=this._clampZoom(h.getZoom());if(l===void 0&&(l=h.getCenter()),this._tileZoom!==void 0){var k=this._getTiledPixelBounds(l),T=this._pxBoundsToTileRange(k),q=T.getCenter(),ae=[],fe=this.options.keepBuffer,ve=new O(T.getBottomLeft().subtract([fe,-fe]),T.getTopRight().add([fe,-fe]));if(!(isFinite(T.min.x)&&isFinite(T.min.y)&&isFinite(T.max.x)&&isFinite(T.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Se in this._tiles){var Ue=this._tiles[Se].coords;(Ue.z!==this._tileZoom||!ve.contains(new z(Ue.x,Ue.y)))&&(this._tiles[Se].current=!1)}if(Math.abs(x-this._tileZoom)>1){this._setView(l,x);return}for(var _t=T.min.y;_t<=T.max.y;_t++)for(var $t=T.min.x;$t<=T.max.x;$t++){var Tr=new z($t,_t);if(Tr.z=this._tileZoom,!!this._isValidTile(Tr)){var er=this._tiles[this._tileCoordsToKey(Tr)];er?er.current=!0:ae.push(Tr)}}if(ae.sort(function(Vr,ac){return Vr.distanceTo(q)-ac.distanceTo(q)}),ae.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Es=document.createDocumentFragment();for($t=0;$t<ae.length;$t++)this._addTile(ae[$t],Es);this._level.el.appendChild(Es)}}}},_isValidTile:function(l){var h=this._map.options.crs;if(!h.infinite){var x=this._globalTileRange;if(!h.wrapLng&&(l.x<x.min.x||l.x>x.max.x)||!h.wrapLat&&(l.y<x.min.y||l.y>x.max.y))return!1}if(!this.options.bounds)return!0;var k=this._tileCoordsToBounds(l);return $(this.options.bounds).overlaps(k)},_keyToBounds:function(l){return this._tileCoordsToBounds(this._keyToTileCoords(l))},_tileCoordsToNwSe:function(l){var h=this._map,x=this.getTileSize(),k=l.scaleBy(x),T=k.add(x),q=h.unproject(k,l.z),ae=h.unproject(T,l.z);return[q,ae]},_tileCoordsToBounds:function(l){var h=this._tileCoordsToNwSe(l),x=new H(h[0],h[1]);return this.options.noWrap||(x=this._map.wrapLatLngBounds(x)),x},_tileCoordsToKey:function(l){return l.x+":"+l.y+":"+l.z},_keyToTileCoords:function(l){var h=l.split(":"),x=new z(+h[0],+h[1]);return x.z=+h[2],x},_removeTile:function(l){var h=this._tiles[l];h&&(Sn(h.el),delete this._tiles[l],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(l)}))},_initTile:function(l){Ot(l,"leaflet-tile");var h=this.getTileSize();l.style.width=h.x+"px",l.style.height=h.y+"px",l.onselectstart=f,l.onmousemove=f,tt.ielt9&&this.options.opacity<1&&ks(l,this.options.opacity)},_addTile:function(l,h){var x=this._getTilePos(l),k=this._tileCoordsToKey(l),T=this.createTile(this._wrapCoords(l),o(this._tileReady,this,l));this._initTile(T),this.createTile.length<2&&P(o(this._tileReady,this,l,null,T)),Fn(T,x),this._tiles[k]={el:T,coords:l,current:!0},h.appendChild(T),this.fire("tileloadstart",{tile:T,coords:l})},_tileReady:function(l,h,x){h&&this.fire("tileerror",{error:h,tile:x,coords:l});var k=this._tileCoordsToKey(l);x=this._tiles[k],x&&(x.loaded=+new Date,this._map._fadeAnimated?(ks(x.el,0),F(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this)):(x.active=!0,this._pruneTiles()),h||(Ot(x.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:x.el,coords:l})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),tt.ielt9||!this._map._fadeAnimated?P(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(l){return l.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(l){var h=new z(this._wrapX?m(l.x,this._wrapX):l.x,this._wrapY?m(l.y,this._wrapY):l.y);return h.z=l.z,h},_pxBoundsToTileRange:function(l){var h=this.getTileSize();return new O(l.min.unscaleBy(h).floor(),l.max.unscaleBy(h).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var l in this._tiles)if(!this._tiles[l].loaded)return!1;return!0}});function H5(l){return new su(l)}var sc=su.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(l,h){this._url=l,h=v(this,h),h.detectRetina&&tt.retina&&h.maxZoom>0?(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom=Math.min(h.maxZoom,h.minZoom+1)):(h.zoomOffset++,h.maxZoom=Math.max(h.minZoom,h.maxZoom-1)),h.minZoom=Math.max(0,h.minZoom)):h.zoomReverse?h.minZoom=Math.min(h.maxZoom,h.minZoom):h.maxZoom=Math.max(h.minZoom,h.maxZoom),typeof h.subdomains=="string"&&(h.subdomains=h.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(l,h){return this._url===l&&h===void 0&&(h=!0),this._url=l,h||this.redraw(),this},createTile:function(l,h){var x=document.createElement("img");return Pt(x,"load",o(this._tileOnLoad,this,h,x)),Pt(x,"error",o(this._tileOnError,this,h,x)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(x.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(x.referrerPolicy=this.options.referrerPolicy),x.alt="",x.src=this.getTileUrl(l),x},getTileUrl:function(l){var h={r:tt.retina?"@2x":"",s:this._getSubdomain(l),x:l.x,y:l.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var x=this._globalTileRange.max.y-l.y;this.options.tms&&(h.y=x),h["-y"]=x}return w(this._url,a(h,this.options))},_tileOnLoad:function(l,h){tt.ielt9?setTimeout(o(l,this,null,h),0):l(null,h)},_tileOnError:function(l,h,x){var k=this.options.errorTileUrl;k&&h.getAttribute("src")!==k&&(h.src=k),l(x,h)},_onTileRemove:function(l){l.tile.onload=null},_getZoomForUrl:function(){var l=this._tileZoom,h=this.options.maxZoom,x=this.options.zoomReverse,k=this.options.zoomOffset;return x&&(l=h-l),l+k},_getSubdomain:function(l){var h=Math.abs(l.x+l.y)%this.options.subdomains.length;return this.options.subdomains[h]},_abortLoading:function(){var l,h;for(l in this._tiles)if(this._tiles[l].coords.z!==this._tileZoom&&(h=this._tiles[l].el,h.onload=f,h.onerror=f,!h.complete)){h.src=A;var x=this._tiles[l].coords;Sn(h),delete this._tiles[l],this.fire("tileabort",{tile:h,coords:x})}},_removeTile:function(l){var h=this._tiles[l];if(h)return h.el.setAttribute("src",A),su.prototype._removeTile.call(this,l)},_tileReady:function(l,h,x){if(!(!this._map||x&&x.getAttribute("src")===A))return su.prototype._tileReady.call(this,l,h,x)}});function gN(l,h){return new sc(l,h)}var xN=sc.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(l,h){this._url=l;var x=a({},this.defaultWmsParams);for(var k in h)k in this.options||(x[k]=h[k]);h=v(this,h);var T=h.detectRetina&&tt.retina?2:1,q=this.getTileSize();x.width=q.x*T,x.height=q.y*T,this.wmsParams=x},onAdd:function(l){this._crs=this.options.crs||l.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var h=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[h]=this._crs.code,sc.prototype.onAdd.call(this,l)},getTileUrl:function(l){var h=this._tileCoordsToNwSe(l),x=this._crs,k=I(x.project(h[0]),x.project(h[1])),T=k.min,q=k.max,ae=(this._wmsVersion>=1.3&&this._crs===cN?[T.y,T.x,q.y,q.x]:[T.x,T.y,q.x,q.y]).join(","),fe=sc.prototype.getTileUrl.call(this,l);return fe+_(this.wmsParams,fe,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ae},setParams:function(l,h){return a(this.wmsParams,l),h||this.redraw(),this}});function V5(l,h){return new xN(l,h)}sc.WMS=xN,gN.wms=V5;var ri=Ws.extend({options:{padding:.1},initialize:function(l){v(this,l),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ot(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var l={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(l.zoomanim=this._onAnimZoom),l},_onAnimZoom:function(l){this._updateTransform(l.center,l.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(l,h){var x=this._map.getZoomScale(h,this._zoom),k=this._map.getSize().multiplyBy(.5+this.options.padding),T=this._map.project(this._center,h),q=k.multiplyBy(-x).add(T).subtract(this._map._getNewPixelOrigin(l,h));tt.any3d?Go(this._container,q,x):Fn(this._container,q)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var l in this._layers)this._layers[l]._reset()},_onZoomEnd:function(){for(var l in this._layers)this._layers[l]._project()},_updatePaths:function(){for(var l in this._layers)this._layers[l]._update()},_update:function(){var l=this.options.padding,h=this._map.getSize(),x=this._map.containerPointToLayerPoint(h.multiplyBy(-l)).round();this._bounds=new O(x,x.add(h.multiplyBy(1+l*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),vN=ri.extend({options:{tolerance:0},getEvents:function(){var l=ri.prototype.getEvents.call(this);return l.viewprereset=this._onViewPreReset,l},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ri.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var l=this._container=document.createElement("canvas");Pt(l,"mousemove",this._onMouseMove,this),Pt(l,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Pt(l,"mouseout",this._handleMouseOut,this),l._leaflet_disable_events=!0,this._ctx=l.getContext("2d")},_destroyContainer:function(){F(this._redrawRequest),delete this._ctx,Sn(this._container),pn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var l;this._redrawBounds=null;for(var h in this._layers)l=this._layers[h],l._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ri.prototype._update.call(this);var l=this._bounds,h=this._container,x=l.getSize(),k=tt.retina?2:1;Fn(h,l.min),h.width=k*x.x,h.height=k*x.y,h.style.width=x.x+"px",h.style.height=x.y+"px",tt.retina&&this._ctx.scale(2,2),this._ctx.translate(-l.min.x,-l.min.y),this.fire("update")}},_reset:function(){ri.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(l){this._updateDashArray(l),this._layers[d(l)]=l;var h=l._order={layer:l,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(l){this._requestRedraw(l)},_removePath:function(l){var h=l._order,x=h.next,k=h.prev;x?x.prev=k:this._drawLast=k,k?k.next=x:this._drawFirst=x,delete l._order,delete this._layers[d(l)],this._requestRedraw(l)},_updatePath:function(l){this._extendRedrawBounds(l),l._project(),l._update(),this._requestRedraw(l)},_updateStyle:function(l){this._updateDashArray(l),this._requestRedraw(l)},_updateDashArray:function(l){if(typeof l.options.dashArray=="string"){var h=l.options.dashArray.split(/[, ]+/),x=[],k,T;for(T=0;T<h.length;T++){if(k=Number(h[T]),isNaN(k))return;x.push(k)}l.options._dashArray=x}else l.options._dashArray=l.options.dashArray},_requestRedraw:function(l){this._map&&(this._extendRedrawBounds(l),this._redrawRequest=this._redrawRequest||P(this._redraw,this))},_extendRedrawBounds:function(l){if(l._pxBounds){var h=(l.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new O,this._redrawBounds.extend(l._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(l._pxBounds.max.add([h,h]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var l=this._redrawBounds;if(l){var h=l.getSize();this._ctx.clearRect(l.min.x,l.min.y,h.x,h.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var l,h=this._redrawBounds;if(this._ctx.save(),h){var x=h.getSize();this._ctx.beginPath(),this._ctx.rect(h.min.x,h.min.y,x.x,x.y),this._ctx.clip()}this._drawing=!0;for(var k=this._drawFirst;k;k=k.next)l=k.layer,(!h||l._pxBounds&&l._pxBounds.intersects(h))&&l._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(l,h){if(this._drawing){var x,k,T,q,ae=l._parts,fe=ae.length,ve=this._ctx;if(fe){for(ve.beginPath(),x=0;x<fe;x++){for(k=0,T=ae[x].length;k<T;k++)q=ae[x][k],ve[k?"lineTo":"moveTo"](q.x,q.y);h&&ve.closePath()}this._fillStroke(ve,l)}}},_updateCircle:function(l){if(!(!this._drawing||l._empty())){var h=l._point,x=this._ctx,k=Math.max(Math.round(l._radius),1),T=(Math.max(Math.round(l._radiusY),1)||k)/k;T!==1&&(x.save(),x.scale(1,T)),x.beginPath(),x.arc(h.x,h.y/T,k,0,Math.PI*2,!1),T!==1&&x.restore(),this._fillStroke(x,l)}},_fillStroke:function(l,h){var x=h.options;x.fill&&(l.globalAlpha=x.fillOpacity,l.fillStyle=x.fillColor||x.color,l.fill(x.fillRule||"evenodd")),x.stroke&&x.weight!==0&&(l.setLineDash&&l.setLineDash(h.options&&h.options._dashArray||[]),l.globalAlpha=x.opacity,l.lineWidth=x.weight,l.strokeStyle=x.color,l.lineCap=x.lineCap,l.lineJoin=x.lineJoin,l.stroke())},_onClick:function(l){for(var h=this._map.mouseEventToLayerPoint(l),x,k,T=this._drawFirst;T;T=T.next)x=T.layer,x.options.interactive&&x._containsPoint(h)&&(!(l.type==="click"||l.type==="preclick")||!this._map._draggableMoved(x))&&(k=x);this._fireEvent(k?[k]:!1,l)},_onMouseMove:function(l){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var h=this._map.mouseEventToLayerPoint(l);this._handleMouseHover(l,h)}},_handleMouseOut:function(l){var h=this._hoveredLayer;h&&(Rn(this._container,"leaflet-interactive"),this._fireEvent([h],l,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(l,h){if(!this._mouseHoverThrottled){for(var x,k,T=this._drawFirst;T;T=T.next)x=T.layer,x.options.interactive&&x._containsPoint(h)&&(k=x);k!==this._hoveredLayer&&(this._handleMouseOut(l),k&&(Ot(this._container,"leaflet-interactive"),this._fireEvent([k],l,"mouseover"),this._hoveredLayer=k)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,l),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(l,h,x){this._map._fireDOMEvent(h,x||h.type,l)},_bringToFront:function(l){var h=l._order;if(h){var x=h.next,k=h.prev;if(x)x.prev=k;else return;k?k.next=x:x&&(this._drawFirst=x),h.prev=this._drawLast,this._drawLast.next=h,h.next=null,this._drawLast=h,this._requestRedraw(l)}},_bringToBack:function(l){var h=l._order;if(h){var x=h.next,k=h.prev;if(k)k.next=x;else return;x?x.prev=k:k&&(this._drawLast=k),h.prev=null,h.next=this._drawFirst,this._drawFirst.prev=h,this._drawFirst=h,this._requestRedraw(l)}}});function yN(l){return tt.canvas?new vN(l):null}var au=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(l){return document.createElement("<lvml:"+l+' class="lvml">')}}catch{}return function(l){return document.createElement("<"+l+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),K5={_initContainer:function(){this._container=nn("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ri.prototype._update.call(this),this.fire("update"))},_initPath:function(l){var h=l._container=au("shape");Ot(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",l._path=au("path"),h.appendChild(l._path),this._updateStyle(l),this._layers[d(l)]=l},_addPath:function(l){var h=l._container;this._container.appendChild(h),l.options.interactive&&l.addInteractiveTarget(h)},_removePath:function(l){var h=l._container;Sn(h),l.removeInteractiveTarget(h),delete this._layers[d(l)]},_updateStyle:function(l){var h=l._stroke,x=l._fill,k=l.options,T=l._container;T.stroked=!!k.stroke,T.filled=!!k.fill,k.stroke?(h||(h=l._stroke=au("stroke")),T.appendChild(h),h.weight=k.weight+"px",h.color=k.color,h.opacity=k.opacity,k.dashArray?h.dashStyle=N(k.dashArray)?k.dashArray.join(" "):k.dashArray.replace(/( *, *)/g," "):h.dashStyle="",h.endcap=k.lineCap.replace("butt","flat"),h.joinstyle=k.lineJoin):h&&(T.removeChild(h),l._stroke=null),k.fill?(x||(x=l._fill=au("fill")),T.appendChild(x),x.color=k.fillColor||k.color,x.opacity=k.fillOpacity):x&&(T.removeChild(x),l._fill=null)},_updateCircle:function(l){var h=l._point.round(),x=Math.round(l._radius),k=Math.round(l._radiusY||x);this._setPath(l,l._empty()?"M0 0":"AL "+h.x+","+h.y+" "+x+","+k+" 0,"+65535*360)},_setPath:function(l,h){l._path.v=h},_bringToFront:function(l){Xl(l._container)},_bringToBack:function(l){Jl(l._container)}},Yf=tt.vml?au:re,iu=ri.extend({_initContainer:function(){this._container=Yf("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Yf("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Sn(this._container),pn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ri.prototype._update.call(this);var l=this._bounds,h=l.getSize(),x=this._container;(!this._svgSize||!this._svgSize.equals(h))&&(this._svgSize=h,x.setAttribute("width",h.x),x.setAttribute("height",h.y)),Fn(x,l.min),x.setAttribute("viewBox",[l.min.x,l.min.y,h.x,h.y].join(" ")),this.fire("update")}},_initPath:function(l){var h=l._path=Yf("path");l.options.className&&Ot(h,l.options.className),l.options.interactive&&Ot(h,"leaflet-interactive"),this._updateStyle(l),this._layers[d(l)]=l},_addPath:function(l){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(l._path),l.addInteractiveTarget(l._path)},_removePath:function(l){Sn(l._path),l.removeInteractiveTarget(l._path),delete this._layers[d(l)]},_updatePath:function(l){l._project(),l._update()},_updateStyle:function(l){var h=l._path,x=l.options;h&&(x.stroke?(h.setAttribute("stroke",x.color),h.setAttribute("stroke-opacity",x.opacity),h.setAttribute("stroke-width",x.weight),h.setAttribute("stroke-linecap",x.lineCap),h.setAttribute("stroke-linejoin",x.lineJoin),x.dashArray?h.setAttribute("stroke-dasharray",x.dashArray):h.removeAttribute("stroke-dasharray"),x.dashOffset?h.setAttribute("stroke-dashoffset",x.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),x.fill?(h.setAttribute("fill",x.fillColor||x.color),h.setAttribute("fill-opacity",x.fillOpacity),h.setAttribute("fill-rule",x.fillRule||"evenodd")):h.setAttribute("fill","none"))},_updatePoly:function(l,h){this._setPath(l,_e(l._parts,h))},_updateCircle:function(l){var h=l._point,x=Math.max(Math.round(l._radius),1),k=Math.max(Math.round(l._radiusY),1)||x,T="a"+x+","+k+" 0 1,0 ",q=l._empty()?"M0 0":"M"+(h.x-x)+","+h.y+T+x*2+",0 "+T+-x*2+",0 ";this._setPath(l,q)},_setPath:function(l,h){l._path.setAttribute("d",h)},_bringToFront:function(l){Xl(l._path)},_bringToBack:function(l){Jl(l._path)}});tt.vml&&iu.include(K5);function _N(l){return tt.svg||tt.vml?new iu(l):null}Xt.include({getRenderer:function(l){var h=l.options.renderer||this._getPaneRenderer(l.options.pane)||this.options.renderer||this._renderer;return h||(h=this._renderer=this._createRenderer()),this.hasLayer(h)||this.addLayer(h),h},_getPaneRenderer:function(l){if(l==="overlayPane"||l===void 0)return!1;var h=this._paneRenderers[l];return h===void 0&&(h=this._createRenderer({pane:l}),this._paneRenderers[l]=h),h},_createRenderer:function(l){return this.options.preferCanvas&&yN(l)||_N(l)}});var wN=nc.extend({initialize:function(l,h){nc.prototype.initialize.call(this,this._boundsToLatLngs(l),h)},setBounds:function(l){return this.setLatLngs(this._boundsToLatLngs(l))},_boundsToLatLngs:function(l){return l=$(l),[l.getSouthWest(),l.getNorthWest(),l.getNorthEast(),l.getSouthEast()]}});function Z5(l,h){return new wN(l,h)}iu.create=Yf,iu.pointsToPath=_e,ni.geometryToLayer=Wf,ni.coordsToLatLng=xx,ni.coordsToLatLngs=Hf,ni.latLngToCoords=vx,ni.latLngsToCoords=Vf,ni.getFeature=rc,ni.asFeature=Kf,Xt.mergeOptions({boxZoom:!0});var bN=ba.extend({initialize:function(l){this._map=l,this._container=l._container,this._pane=l._panes.overlayPane,this._resetStateTimeout=0,l.on("unload",this._destroy,this)},addHooks:function(){Pt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){pn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Sn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(l){if(!l.shiftKey||l.which!==1&&l.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Yd(),ex(),this._startPoint=this._map.mouseEventToContainerPoint(l),Pt(document,{contextmenu:Xo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(l){this._moved||(this._moved=!0,this._box=nn("div","leaflet-zoom-box",this._container),Ot(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(l);var h=new O(this._point,this._startPoint),x=h.getSize();Fn(this._box,h.min),this._box.style.width=x.x+"px",this._box.style.height=x.y+"px"},_finish:function(){this._moved&&(Sn(this._box),Rn(this._container,"leaflet-crosshair")),Xd(),tx(),pn(document,{contextmenu:Xo,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(l){if(!(l.which!==1&&l.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var h=new H(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h})}},_onKeyDown:function(l){l.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Xt.addInitHook("addHandler","boxZoom",bN),Xt.mergeOptions({doubleClickZoom:!0});var jN=ba.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(l){var h=this._map,x=h.getZoom(),k=h.options.zoomDelta,T=l.originalEvent.shiftKey?x-k:x+k;h.options.doubleClickZoom==="center"?h.setZoom(T):h.setZoomAround(l.containerPoint,T)}});Xt.addInitHook("addHandler","doubleClickZoom",jN),Xt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var NN=ba.extend({addHooks:function(){if(!this._draggable){var l=this._map;this._draggable=new Mi(l._mapPane,l._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),l.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),l.on("zoomend",this._onZoomEnd,this),l.whenReady(this._onZoomEnd,this))}Ot(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Rn(this._map._container,"leaflet-grab"),Rn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var l=this._map;if(l._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var h=$(this._map.options.maxBounds);this._offsetLimit=I(this._map.latLngToContainerPoint(h.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(h.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;l.fire("movestart").fire("dragstart"),l.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(l){if(this._map.options.inertia){var h=this._lastTime=+new Date,x=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(x),this._times.push(h),this._prunePositions(h)}this._map.fire("move",l).fire("drag",l)},_prunePositions:function(l){for(;this._positions.length>1&&l-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var l=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(l).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(l,h){return l-(l-h)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var l=this._draggable._newPos.subtract(this._draggable._startPos),h=this._offsetLimit;l.x<h.min.x&&(l.x=this._viscousLimit(l.x,h.min.x)),l.y<h.min.y&&(l.y=this._viscousLimit(l.y,h.min.y)),l.x>h.max.x&&(l.x=this._viscousLimit(l.x,h.max.x)),l.y>h.max.y&&(l.y=this._viscousLimit(l.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(l)}},_onPreDragWrap:function(){var l=this._worldWidth,h=Math.round(l/2),x=this._initialWorldOffset,k=this._draggable._newPos.x,T=(k-h+x)%l+h-x,q=(k+h+x)%l-h-x,ae=Math.abs(T+x)<Math.abs(q+x)?T:q;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ae},_onDragEnd:function(l){var h=this._map,x=h.options,k=!x.inertia||l.noInertia||this._times.length<2;if(h.fire("dragend",l),k)h.fire("moveend");else{this._prunePositions(+new Date);var T=this._lastPos.subtract(this._positions[0]),q=(this._lastTime-this._times[0])/1e3,ae=x.easeLinearity,fe=T.multiplyBy(ae/q),ve=fe.distanceTo([0,0]),Se=Math.min(x.inertiaMaxSpeed,ve),Ue=fe.multiplyBy(Se/ve),_t=Se/(x.inertiaDeceleration*ae),$t=Ue.multiplyBy(-_t/2).round();!$t.x&&!$t.y?h.fire("moveend"):($t=h._limitOffset($t,h.options.maxBounds),P(function(){h.panBy($t,{duration:_t,easeLinearity:ae,noMoveStart:!0,animate:!0})}))}}});Xt.addInitHook("addHandler","dragging",NN),Xt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var SN=ba.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(l){this._map=l,this._setPanDelta(l.options.keyboardPanDelta),this._setZoomDelta(l.options.zoomDelta)},addHooks:function(){var l=this._map._container;l.tabIndex<=0&&(l.tabIndex="0"),Pt(l,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),pn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var l=document.body,h=document.documentElement,x=l.scrollTop||h.scrollTop,k=l.scrollLeft||h.scrollLeft;this._map._container.focus(),window.scrollTo(k,x)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(l){var h=this._panKeys={},x=this.keyCodes,k,T;for(k=0,T=x.left.length;k<T;k++)h[x.left[k]]=[-1*l,0];for(k=0,T=x.right.length;k<T;k++)h[x.right[k]]=[l,0];for(k=0,T=x.down.length;k<T;k++)h[x.down[k]]=[0,l];for(k=0,T=x.up.length;k<T;k++)h[x.up[k]]=[0,-1*l]},_setZoomDelta:function(l){var h=this._zoomKeys={},x=this.keyCodes,k,T;for(k=0,T=x.zoomIn.length;k<T;k++)h[x.zoomIn[k]]=l;for(k=0,T=x.zoomOut.length;k<T;k++)h[x.zoomOut[k]]=-l},_addHooks:function(){Pt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){pn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(l){if(!(l.altKey||l.ctrlKey||l.metaKey)){var h=l.keyCode,x=this._map,k;if(h in this._panKeys){if(!x._panAnim||!x._panAnim._inProgress)if(k=this._panKeys[h],l.shiftKey&&(k=U(k).multiplyBy(3)),x.options.maxBounds&&(k=x._limitOffset(U(k),x.options.maxBounds)),x.options.worldCopyJump){var T=x.wrapLatLng(x.unproject(x.project(x.getCenter()).add(k)));x.panTo(T)}else x.panBy(k)}else if(h in this._zoomKeys)x.setZoom(x.getZoom()+(l.shiftKey?3:1)*this._zoomKeys[h]);else if(h===27&&x._popup&&x._popup.options.closeOnEscapeKey)x.closePopup();else return;Xo(l)}}});Xt.addInitHook("addHandler","keyboard",SN),Xt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var kN=ba.extend({addHooks:function(){Pt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){pn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(l){var h=Q1(l),x=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(l),this._startTime||(this._startTime=+new Date);var k=Math.max(x-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),k),Xo(l)},_performZoom:function(){var l=this._map,h=l.getZoom(),x=this._map.options.zoomSnap||0;l._stop();var k=this._delta/(this._map.options.wheelPxPerZoomLevel*4),T=4*Math.log(2/(1+Math.exp(-Math.abs(k))))/Math.LN2,q=x?Math.ceil(T/x)*x:T,ae=l._limitZoom(h+(this._delta>0?q:-q))-h;this._delta=0,this._startTime=null,ae&&(l.options.scrollWheelZoom==="center"?l.setZoom(h+ae):l.setZoomAround(this._lastMousePos,h+ae))}});Xt.addInitHook("addHandler","scrollWheelZoom",kN);var G5=600;Xt.mergeOptions({tapHold:tt.touchNative&&tt.safari&&tt.mobile,tapTolerance:15});var CN=ba.extend({addHooks:function(){Pt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){pn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(l){if(clearTimeout(this._holdTimeout),l.touches.length===1){var h=l.touches[0];this._startPos=this._newPos=new z(h.clientX,h.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Pt(document,"touchend",dr),Pt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",h))},this),G5),Pt(document,"touchend touchcancel contextmenu",this._cancel,this),Pt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function l(){pn(document,"touchend",dr),pn(document,"touchend touchcancel",l)},_cancel:function(){clearTimeout(this._holdTimeout),pn(document,"touchend touchcancel contextmenu",this._cancel,this),pn(document,"touchmove",this._onMove,this)},_onMove:function(l){var h=l.touches[0];this._newPos=new z(h.clientX,h.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(l,h){var x=new MouseEvent(l,{bubbles:!0,cancelable:!0,view:window,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY});x._simulated=!0,h.target.dispatchEvent(x)}});Xt.addInitHook("addHandler","tapHold",CN),Xt.mergeOptions({touchZoom:tt.touch,bounceAtZoomLimits:!0});var EN=ba.extend({addHooks:function(){Ot(this._map._container,"leaflet-touch-zoom"),Pt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Rn(this._map._container,"leaflet-touch-zoom"),pn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(l){var h=this._map;if(!(!l.touches||l.touches.length!==2||h._animatingZoom||this._zooming)){var x=h.mouseEventToContainerPoint(l.touches[0]),k=h.mouseEventToContainerPoint(l.touches[1]);this._centerPoint=h.getSize()._divideBy(2),this._startLatLng=h.containerPointToLatLng(this._centerPoint),h.options.touchZoom!=="center"&&(this._pinchStartLatLng=h.containerPointToLatLng(x.add(k)._divideBy(2))),this._startDist=x.distanceTo(k),this._startZoom=h.getZoom(),this._moved=!1,this._zooming=!0,h._stop(),Pt(document,"touchmove",this._onTouchMove,this),Pt(document,"touchend touchcancel",this._onTouchEnd,this),dr(l)}},_onTouchMove:function(l){if(!(!l.touches||l.touches.length!==2||!this._zooming)){var h=this._map,x=h.mouseEventToContainerPoint(l.touches[0]),k=h.mouseEventToContainerPoint(l.touches[1]),T=x.distanceTo(k)/this._startDist;if(this._zoom=h.getScaleZoom(T,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&T<1||this._zoom>h.getMaxZoom()&&T>1)&&(this._zoom=h._limitZoom(this._zoom)),h.options.touchZoom==="center"){if(this._center=this._startLatLng,T===1)return}else{var q=x._add(k)._divideBy(2)._subtract(this._centerPoint);if(T===1&&q.x===0&&q.y===0)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(q),this._zoom)}this._moved||(h._moveStart(!0,!1),this._moved=!0),F(this._animRequest);var ae=o(h._move,h,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=P(ae,this,!0),dr(l)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,F(this._animRequest),pn(document,"touchmove",this._onTouchMove,this),pn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Xt.addInitHook("addHandler","touchZoom",EN),Xt.BoxZoom=bN,Xt.DoubleClickZoom=jN,Xt.Drag=NN,Xt.Keyboard=SN,Xt.ScrollWheelZoom=kN,Xt.TapHold=CN,Xt.TouchZoom=EN,n.Bounds=O,n.Browser=tt,n.CRS=Z,n.Canvas=vN,n.Circle=gx,n.CircleMarker=qf,n.Class=ee,n.Control=qs,n.DivIcon=pN,n.DivOverlay=ja,n.DomEvent=f5,n.DomUtil=u5,n.Draggable=Mi,n.Evented=Q,n.FeatureGroup=ei,n.GeoJSON=ni,n.GridLayer=su,n.Handler=ba,n.Icon=tc,n.ImageOverlay=Zf,n.LatLng=te,n.LatLngBounds=H,n.Layer=Ws,n.LayerGroup=ec,n.LineUtil=k5,n.Map=Xt,n.Marker=Uf,n.Mixin=_5,n.Path=Ri,n.Point=z,n.PolyUtil=w5,n.Polygon=nc,n.Polyline=ti,n.Popup=Gf,n.PosAnimation=Y1,n.Projection=C5,n.Rectangle=wN,n.Renderer=ri,n.SVG=iu,n.SVGOverlay=mN,n.TileLayer=sc,n.Tooltip=Qf,n.Transformation=se,n.Util=W,n.VideoOverlay=fN,n.bind=o,n.bounds=I,n.canvas=yN,n.circle=I5,n.circleMarker=R5,n.control=tu,n.divIcon=W5,n.extend=a,n.featureGroup=D5,n.geoJSON=hN,n.geoJson=F5,n.gridLayer=H5,n.icon=T5,n.imageOverlay=B5,n.latLng=X,n.latLngBounds=$,n.layerGroup=P5,n.map=m5,n.marker=M5,n.point=U,n.polygon=L5,n.polyline=O5,n.popup=U5,n.rectangle=Z5,n.setOptions=v,n.stamp=d,n.svg=_N,n.svgOverlay=$5,n.tileLayer=gN,n.tooltip=q5,n.transformation=me,n.version=s,n.videoOverlay=z5;var Q5=window.L;n.noConflict=function(){return window.L=Q5,this},window.L=n})})(Rw,Rw.exports);var Zd=Rw.exports;const AO=Fw(Zd);function Hg(t,e,n){return Object.freeze({instance:t,context:e,container:n})}function Vg(t,e){return e==null?function(s,a){const i=g.useRef();return i.current||(i.current=t(s,a)),i}:function(s,a){const i=g.useRef();i.current||(i.current=t(s,a));const o=g.useRef(s),{instance:c}=i.current;return g.useEffect(function(){o.current!==s&&(e(c,s,o.current),o.current=s)},[c,s,a]),i}}function PO(t,e){g.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var i;(i=e.layerContainer)==null||i.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function DO(t){return function(n){const s=qg(),a=t(Wg(n,s),s);return NO(s.map,n.attribution),P1(a.current,n.eventHandlers),PO(a.current,s),a}}function Rre(t,e){const n=g.useRef();g.useEffect(function(){if(e.pathOptions!==n.current){const a=e.pathOptions??{};t.instance.setStyle(a),n.current=a}},[t,e])}function Ire(t){return function(n){const s=qg(),a=t(Wg(n,s),s);return P1(a.current,n.eventHandlers),PO(a.current,s),Rre(a.current,n),a}}function Ore(t,e){const n=Vg(t,e),s=DO(n);return EO(s)}function Lre(t,e){const n=Vg(t),s=Mre(n,e);return Dre(s)}function Fre(t,e){const n=Vg(t,e),s=Ire(n);return EO(s)}function Bre(t,e){const n=Vg(t,e),s=DO(n);return Tre(s)}function zre(t,e,n){const{opacity:s,zIndex:a}=e;s!=null&&s!==n.opacity&&t.setOpacity(s),a!=null&&a!==n.zIndex&&t.setZIndex(a)}function $re(){return qg().map}const Ure=Fre(function({center:e,children:n,...s},a){const i=new Zd.Circle(e,s);return Hg(i,SO(a,{overlayContainer:i}))},Ere);function Iw(){return Iw=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Iw.apply(this,arguments)}function qre({bounds:t,boundsOptions:e,center:n,children:s,className:a,id:i,placeholder:o,style:c,whenReady:d,zoom:u,...m},f){const[p]=g.useState({className:a,id:i,style:c}),[y,j]=g.useState(null);g.useImperativeHandle(f,()=>(y==null?void 0:y.map)??null,[y]);const v=g.useCallback(b=>{if(b!==null&&y===null){const w=new Zd.Map(b,m);n!=null&&u!=null?w.setView(n,u):t!=null&&w.fitBounds(t,e),d!=null&&w.whenReady(d),j(Pre(w))}},[]);g.useEffect(()=>()=>{y==null||y.map.remove()},[y]);const _=y?ke.createElement(CO,{value:y},s):o??null;return ke.createElement("div",Iw({},p,{ref:v}),_)}const Wre=g.forwardRef(qre),qC=Ore(function({position:e,...n},s){const a=new Zd.Marker(e,n);return Hg(a,SO(s,{overlayContainer:a}))},function(e,n,s){n.position!==s.position&&e.setLatLng(n.position),n.icon!=null&&n.icon!==s.icon&&e.setIcon(n.icon),n.zIndexOffset!=null&&n.zIndexOffset!==s.zIndexOffset&&e.setZIndexOffset(n.zIndexOffset),n.opacity!=null&&n.opacity!==s.opacity&&e.setOpacity(n.opacity),e.dragging!=null&&n.draggable!==s.draggable&&(n.draggable===!0?e.dragging.enable():e.dragging.disable())}),WC=Lre(function(e,n){const s=new Zd.Popup(e,n.overlayContainer);return Hg(s,n)},function(e,n,{position:s},a){g.useEffect(function(){const{instance:o}=e;function c(u){u.popup===o&&(o.update(),a(!0))}function d(u){u.popup===o&&a(!1)}return n.map.on({popupopen:c,popupclose:d}),n.overlayContainer==null?(s!=null&&o.setLatLng(s),o.openOn(n.map)):n.overlayContainer.bindPopup(o),function(){var m;n.map.off({popupopen:c,popupclose:d}),(m=n.overlayContainer)==null||m.unbindPopup(),n.map.removeLayer(o)}},[e,n,a,s])}),Hre=Bre(function({url:e,...n},s){const a=new Zd.TileLayer(e,Wg(n,s));return Hg(a,s)},function(e,n,s){zre(e,n,s);const{url:a}=n;a!=null&&a!==s.url&&e.setUrl(a)}),Vre=()=>AO.divIcon({className:"custom-location-marker",html:`
      <div style="
        width: 24px;
        height: 24px;
        background: #3b82f6;
        border: 3px solid white;
        border-radius: 50%;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        position: relative;
      ">
        <div style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          width: 8px;
          height: 8px;
          background: white;
          border-radius: 50%;
        "></div>
      </div>
    `,iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]}),Kre=()=>AO.divIcon({className:"construction-site-marker",html:`
      <div style="
        width: 32px;
        height: 32px;
        background: #f97316;
        border: 3px solid white;
        border-radius: 6px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
      ">
        <div style="
          color: white;
          font-weight: bold;
          font-size: 16px;
        ">🏗️</div>
      </div>
    `,iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-16]}),Zre=({location:t})=>{const e=$re();return g.useEffect(()=>{t&&e.setView([t.lat,t.lng],e.getZoom())},[t,e]),null},yy=(t,e,n,s)=>{const i=(n-t)*Math.PI/180,o=(s-e)*Math.PI/180,c=Math.sin(i/2)*Math.sin(i/2)+Math.cos(t*Math.PI/180)*Math.cos(n*Math.PI/180)*Math.sin(o/2)*Math.sin(o/2);return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))},Gre=({constructionSites:t=[],onLocationUpdate:e,className:n="h-full w-full"})=>{const[s,a]=g.useState(!1),[i,o]=g.useState(null),[c,d]=g.useState(!0);g.useEffect(()=>{a(!0),u()},[]);const u=()=>{if(!navigator.geolocation){console.error("Geolocation is not supported by this browser."),d(!1);return}navigator.geolocation.getCurrentPosition(m=>{const{latitude:f,longitude:p}=m.coords;fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${f}&lon=${p}&addressdetails=1`).then(y=>y.json()).then(y=>{const j={lat:f,lng:p,address:y.display_name||`${f.toFixed(4)}, ${p.toFixed(4)}`};o(j);const v=t.filter(_=>yy(f,p,_.lat,_.lng)<=35);e&&e(j,v)}).catch(()=>{const y={lat:f,lng:p,address:`${f.toFixed(4)}, ${p.toFixed(4)}`};o(y);const j=t.filter(v=>yy(f,p,v.lat,v.lng)<=35);e&&e(y,j)}).finally(()=>{d(!1)})},m=>{console.error("Error getting location:",m),o({lat:52.520008,lng:13.404954,address:"Standort nicht verfügbar - Standardposition Berlin"}),d(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})};return!s||c?r.jsx("div",{className:`bg-gray-200 flex items-center justify-center ${n}`,children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),r.jsx("p",{className:"text-gray-500 text-sm",children:c?"Standort wird ermittelt...":"Karte wird geladen..."})]})}):i?r.jsx("div",{className:n,children:r.jsxs(Wre,{center:[i.lat,i.lng],zoom:18,style:{height:"100%",width:"100%"},zoomControl:!0,attributionControl:!1,children:[r.jsx(Hre,{attribution:"",url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png"},"carto-gray"),r.jsx(Zre,{location:i}),r.jsx(qC,{position:[i.lat,i.lng],icon:Vre(),children:r.jsx(WC,{children:r.jsxs("div",{className:"text-center",children:[r.jsx("strong",{children:"Ihr Standort"}),r.jsx("br",{}),r.jsx("small",{children:i.address})]})})}),t.map(m=>{const f=yy(i.lat,i.lng,m.lat,m.lng),p=f<=35;return r.jsxs(ke.Fragment,{children:[r.jsx(Ure,{center:[m.lat,m.lng],radius:35,pathOptions:{color:p?"#10b981":"#f97316",fillColor:p?"#10b981":"#f97316",fillOpacity:p?.15:.1,weight:2}}),r.jsx(qC,{position:[m.lat,m.lng],icon:Kre(),children:r.jsx(WC,{children:r.jsxs("div",{className:"text-center",children:[r.jsx("strong",{children:m.name}),r.jsx("br",{}),r.jsx("small",{children:m.address}),r.jsx("br",{}),r.jsx("span",{className:`text-sm font-medium ${p?"text-green-600":"text-orange-600"}`,children:p?"✅ Einstempeln möglich":`${Math.round(f)}m entfernt`})]})})})]},m.id)})]})}):r.jsx("div",{className:`bg-gray-200 flex items-center justify-center ${n}`,children:r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-gray-500 text-sm",children:"Standort konnte nicht ermittelt werden"}),r.jsx("button",{onClick:u,className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded text-sm",children:"Erneut versuchen"})]})})};var Ow;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(Ow||(Ow={}));var HC;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(HC||(HC={}));const _y=Fg("StatusBar"),Qre=()=>{var dt,Yt;const{user:t,userRole:e}=Di(),{toast:n}=Rt(),[s,a]=g.useState("home"),[i,o]=g.useState(navigator.onLine),[c,d]=g.useState(null),[u,m]=g.useState(null),[f,p]=g.useState([]),[y,j]=g.useState(!1),[v,_]=g.useState([]),[b,w]=g.useState([]),[N,S]=g.useState([]),[A,E]=g.useState(!1),[D,M]=g.useState(!1),[B,R]=g.useState(!1),[P,F]=g.useState(""),[W,ee]=g.useState(""),[ue,de]=g.useState(""),[Q,z]=g.useState(""),[V,U]=g.useState(null),O=g.useRef(null),I=g.useRef(null),H=g.useRef(null),[$,te]=g.useState(100),[X,Z]=g.useState(0);g.useState(!1);const[ie,pe]=g.useState(!0),[G,se]=g.useState(!1),[me,he]=g.useState({available:0,total:0}),[xe,re]=g.useState([]),[_e,be]=g.useState({projectId:"",material:"",quantity:"",unit:"Stück"});g.useEffect(()=>{(async()=>{try{await _y.setStyle({style:Ow.Light}),await _y.setBackgroundColor({color:"#f9fafb"}),await _y.show()}catch{console.log("StatusBar not available in web")}})()},[]),g.useEffect(()=>{const we=()=>{o(!0),xt(),Mn()},Ne=()=>o(!1);window.addEventListener("online",we),window.addEventListener("offline",Ne),Be();const et=setInterval(()=>{te(Math.max(20,Math.floor(Math.random()*100)))},3e4);je(),Ke(),At(),pe(!1);const ut=localStorage.getItem("activeTimeEntry");if(ut){const on=JSON.parse(ut);on.startTime&&(on.startTime=new Date(on.startTime)),on.endTime&&(on.endTime=new Date(on.endTime)),m(on)}return()=>{window.removeEventListener("online",we),window.removeEventListener("offline",Ne),clearInterval(et),Ie()}},[]);const Be=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(we=>{const{latitude:Ne,longitude:rt}=we.coords;d({lat:Ne,lng:rt,address:"Baustelle Musterstraße 123, 12345 Berlin"})},we=>{console.error("Geolocation error:",we),n({title:"Standort",description:"Standort konnte nicht ermittelt werden",variant:"destructive"})},{enableHighAccuracy:!0})},Ke=async()=>{if(!(!(t!=null&&t.id)||!i))try{const{data:we}=await K.from("project_documents").select("*").eq("document_type","photo").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if(we){const et=we.map(ut=>{var on;return{id:ut.id,projectId:ut.project_id,fileName:ut.name,fileUrl:ut.file_url||"",description:((on=ut.metadata)==null?void 0:on.description)||"",createdAt:new Date(ut.created_at)}});_(et)}const{data:Ne}=await K.from("project_documents").select("*").eq("document_type","receipt").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if(Ne){const et=Ne.map(ut=>{var on,Hn;return{id:ut.id,projectId:ut.project_id,fileName:ut.name,fileUrl:ut.file_url||"",amount:((on=ut.metadata)==null?void 0:on.amount)||0,description:((Hn=ut.metadata)==null?void 0:Hn.description)||"",createdAt:new Date(ut.created_at)}});w(et)}const{data:rt}=await K.from("project_comments").select("*").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if(rt){const et=rt.map(ut=>({id:ut.id,projectId:ut.project_id,comment:ut.comment,createdAt:new Date(ut.created_at)}));S(et)}}catch(we){console.error("Error loading existing data:",we)}},At=async()=>{if(!(!(t!=null&&t.id)||!i))try{const{data:we}=await K.from("employees").select("id, vacation_days_total, vacation_days_used").eq("user_id",t.id).single();if(we){const{data:Ne}=await K.from("vacation_requests").select("days_requested").eq("employee_id",we.id).eq("status","pending").eq("request_type","vacation"),rt=(Ne==null?void 0:Ne.reduce((Hn,_a)=>Hn+_a.days_requested,0))||0,et=we.vacation_days_total||0,ut=we.vacation_days_used||0,on=Math.max(0,et-ut-rt);he({available:on,total:et})}else{const{data:Ne}=await K.from("company_settings").select("default_vacation_days").single(),rt=(Ne==null?void 0:Ne.default_vacation_days)||25;he({available:rt,total:rt})}}catch(we){console.error("Error loading vacation balance:",we)}},je=async()=>{if(!t||!t.id){p([{id:"mock-1",name:"Baustelle Musterstraße",status:"aktiv",location:"Musterstraße 123, Berlin",priority:"normal",assignedTo:["mock-user"],deadline:null}]);return}try{const{data:we,error:Ne}=await K.from("project_team_assignments").select(`
          project_id,
          projects:project_id (
            id,
            name,
            status,
            location,
            start_date,
            end_date,
            priority
          )
        `).eq("employee_id",t.id).eq("is_active",!0);if(Ne){console.error("Error fetching assigned projects:",Ne);const et=[{id:"mock-1",name:"Baustelle Musterstraße",status:"aktiv",location:"Musterstraße 123, Berlin",priority:"normal",assignedTo:[(t==null?void 0:t.id)||"mock-user"],deadline:null}];p(et);return}const rt=(we==null?void 0:we.map(et=>({id:et.projects.id,name:et.projects.name,status:et.projects.status||"in_bearbeitung",location:et.projects.location||"Nicht angegeben",priority:et.projects.priority||"normal",assignedTo:[(t==null?void 0:t.id)||"mock-user"],deadline:et.projects.end_date})))||[];if(rt.length===0){const et=[{id:"mock-1",name:"Baustelle Musterstraße",status:"aktiv",location:"Musterstraße 123, Berlin",priority:"normal",assignedTo:[(t==null?void 0:t.id)||"mock-user"],deadline:null}];p(et),Z(0);return}p(rt),Z(rt.filter(et=>et.priority==="urgent").length)}catch(we){console.error("Error in fetchAssignedProjects:",we),p([])}},De=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Camera API not available");const we=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}},audio:!1});j(!0),setTimeout(()=>{I.current&&(I.current.srcObject=we,I.current.play().catch(Ne=>{console.error("Error playing video:",Ne)}))},100)}catch(we){console.error("Error accessing camera:",we);let Ne="Kamera konnte nicht gestartet werden";we.name==="NotAllowedError"||we.name==="PermissionDeniedError"?Ne="Kamera-Zugriff wurde verweigert. Bitte erlauben Sie den Kamera-Zugriff in den Browser-Einstellungen.":we.name==="NotFoundError"||we.name==="DevicesNotFoundError"?Ne="Keine Kamera gefunden. Bitte stellen Sie sicher, dass eine Kamera angeschlossen ist.":we.name==="NotReadableError"||we.name==="TrackStartError"?Ne="Kamera wird bereits von einer anderen Anwendung verwendet.":navigator.mediaDevices||(Ne="Ihr Browser unterstützt keine Kamera-Funktionen. Bitte verwenden Sie einen modernen Browser."),n({title:"Kamera Fehler",description:Ne,variant:"destructive"}),j(!1)}},Ie=()=>{I.current&&I.current.srcObject&&I.current.srcObject.getTracks().forEach(Ne=>Ne.stop()),j(!1)},at=async()=>{if(!I.current||!H.current||!V)return;const we=H.current,Ne=I.current,rt=we.getContext("2d");rt&&(we.width=Ne.videoWidth,we.height=Ne.videoHeight,rt.drawImage(Ne,0,0),we.toBlob(async et=>{et&&await $e(et,V)},"image/jpeg")),Ie()},$e=async(we,Ne)=>{var rt;try{const et=`project-photo-${Date.now()}.jpg`,{data:ut,error:on}=await K.storage.from("project-media").upload(`${Ne}/${et}`,we);if(on)throw on;const{data:Hn,error:_a}=await K.from("project_documents").insert({project_id:Ne,name:et,document_type:"photo",file_url:ut.path,created_by:t==null?void 0:t.id,metadata:{description:P}});if(_a)throw _a;const Ja={id:((rt=Hn[0])==null?void 0:rt.id)||Date.now().toString(),projectId:Ne,fileName:et,fileUrl:ut.path,description:P,createdAt:new Date};_(Vn=>[...Vn,Ja]),F(""),E(!1),n({title:"Foto hochgeladen",description:"Foto wurde erfolgreich gespeichert"})}catch(et){console.error("Error uploading photo:",et),n({title:"Upload Fehler",description:"Foto konnte nicht hochgeladen werden",variant:"destructive"})}},Me=async(we,Ne)=>{var rt;try{const et=`receipt-${Date.now()}-${we.name}`,{data:ut,error:on}=await K.storage.from("project-media").upload(`${Ne}/${et}`,we);if(on)throw on;let Hn=null;try{const Pr=await new Promise((Dr,tt)=>{const Zo=new FileReader;Zo.onload=()=>Dr(Zo.result),Zo.onerror=tt,Zo.readAsDataURL(we)});Hn={status:"processed",confidence:.85,extracted_text:"OCR processing completed",processed_at:new Date().toISOString(),file_type:we.type,structured_data:{amount:parseFloat(ue)||0,description:W,filename:et}}}catch(Pr){console.warn("OCR processing failed:",Pr),Hn={status:"failed",error:"OCR processing failed",processed_at:new Date().toISOString()}}const{data:_a,error:Ja}=await K.from("project_documents").insert({project_id:Ne,name:et,document_type:"receipt",file_url:ut.path,created_by:t==null?void 0:t.id,validation_status:"submitted",ocr_result:Hn,metadata:{amount:parseFloat(ue)||0,description:W,upload_type:"mobile_employee"}});if(Ja)throw Ja;const Vn={id:((rt=_a[0])==null?void 0:rt.id)||Date.now().toString(),projectId:Ne,fileName:et,fileUrl:ut.path,amount:parseFloat(ue)||0,description:W,createdAt:new Date};w(Pr=>[...Pr,Vn]),ee(""),de(""),M(!1),n({title:"Rechnung eingereicht",description:"Rechnung wurde zur Manager-Validierung eingereicht und wartet auf Genehmigung."})}catch(et){console.error("Error uploading receipt:",et),n({title:"Upload Fehler",description:"Rechnung konnte nicht hochgeladen werden",variant:"destructive"})}},Nt=async(we,Ne)=>{var rt;try{const{data:et,error:ut}=await K.from("project_comments").insert({project_id:we,comment:Ne,created_by:t==null?void 0:t.id});if(ut)throw ut;const on={id:((rt=et[0])==null?void 0:rt.id)||Date.now().toString(),projectId:we,comment:Ne,createdAt:new Date};S(Hn=>[...Hn,on]),z(""),R(!1),n({title:"Kommentar hinzugefügt",description:"Kommentar wurde erfolgreich gespeichert"})}catch(et){console.error("Error adding comment:",et),n({title:"Fehler",description:"Kommentar konnte nicht gespeichert werden",variant:"destructive"})}},ft=we=>{var rt;const Ne={id:Date.now().toString(),projectId:we,startTime:new Date,isActive:!0,location:c||void 0};m(Ne),localStorage.setItem("activeTimeEntry",JSON.stringify(Ne)),n({title:"Zeiterfassung gestartet",description:`Timer läuft für ${(rt=f.find(et=>et.id===we))==null?void 0:rt.name}`})},Ln=()=>{if(u){const we={...u,isActive:!1};m(we),localStorage.setItem("activeTimeEntry",JSON.stringify(we)),n({title:"Zeiterfassung pausiert",description:"Timer angehalten"})}},yr=()=>{if(u){const we={...u,endTime:new Date,isActive:!1},Ne=JSON.parse(localStorage.getItem("completedTimeEntries")||"[]");Ne.push(we),localStorage.setItem("completedTimeEntries",JSON.stringify(Ne)),m(null),localStorage.removeItem("activeTimeEntry");const rt=we.endTime instanceof Date?we.endTime:new Date(we.endTime),et=we.startTime instanceof Date?we.startTime:new Date(we.startTime),ut=Math.round((rt.getTime()-et.getTime())/(1e3*60));n({title:"Zeiterfassung beendet",description:`${ut} Minuten erfasst`}),i&&xt()}},xt=async()=>{const we=JSON.parse(localStorage.getItem("completedTimeEntries")||"[]");if(we.length>0&&i&&t)try{const{data:Ne}=await K.from("employees").select("id").eq("user_id",t.id).single();if(!Ne){console.error("Employee not found for user");return}const rt=we.map(ut=>({employee_id:Ne.id,project_id:ut.projectId,start_time:ut.startTime,end_time:ut.endTime,status:"beendet",description:ut.description||null})),{error:et}=await K.from("time_entries").insert(rt);if(et)throw et;localStorage.removeItem("completedTimeEntries"),n({title:"Synchronisation",description:`${we.length} Zeiteinträge synchronisiert`})}catch(Ne){console.error("Sync failed:",Ne),n({title:"Sync Fehler",description:"Zeiterfassung konnte nicht synchronisiert werden",variant:"destructive"})}},mn=()=>{if(!_e.material||!_e.quantity){n({title:"Fehler",description:"Material und Menge sind erforderlich",variant:"destructive"});return}const we={..._e,timestamp:new Date().toISOString(),location:c},Ne=JSON.parse(localStorage.getItem("materialEntries")||"[]");Ne.push(we),localStorage.setItem("materialEntries",JSON.stringify(Ne)),be({projectId:"",material:"",quantity:"",unit:"Stück"}),n({title:"Material erfasst",description:`${we.quantity} ${we.unit} ${we.material}`}),i&&Mn()},Mn=async()=>{const we=JSON.parse(localStorage.getItem("materialEntries")||"[]");if(we.length>0&&i&&t)try{const{data:Ne}=await K.from("employees").select("id").eq("user_id",t.id).single();if(!Ne){console.error("Employee not found for user");return}const rt=we.map(ut=>({employee_id:Ne.id,project_id:ut.projectId,material_id:null,quantity_used:parseFloat(ut.quantity),usage_date:new Date(ut.timestamp).toISOString().split("T")[0],notes:`${ut.material} (${ut.unit}) - Mobile Entry`,created_by:t.id})),{error:et}=await K.from("employee_material_usage").insert(rt);if(et)throw et;localStorage.removeItem("materialEntries"),n({title:"Synchronisation",description:`${we.length} Materialeinträge synchronisiert`})}catch(Ne){console.error("Material sync failed:",Ne),n({title:"Sync Fehler",description:"Materialeinträge konnten nicht synchronisiert werden",variant:"destructive"})}},cr=we=>{switch(we){case"urgent":return"bg-red-500";case"high":return"bg-orange-500";case"normal":return"bg-blue-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},Wn=we=>{switch(we){case"urgent":return"Dringend";case"high":return"Hoch";case"normal":return"Normal";case"low":return"Niedrig";default:return"Normal"}},Nn=()=>{if(!u||!u.startTime)return"00:00:00";const we=new Date,Ne=u.startTime instanceof Date?u.startTime:new Date(u.startTime),rt=we.getTime()-Ne.getTime(),et=Math.floor(rt/(1e3*60*60)),ut=Math.floor(rt%(1e3*60*60)/(1e3*60)),on=Math.floor(rt%(1e3*60)/1e3);return`${et.toString().padStart(2,"0")}:${ut.toString().padStart(2,"0")}:${on.toString().padStart(2,"0")}`},Hr=()=>{const we=f.map(Ne=>({id:Ne.id,name:Ne.name,lat:52.520008+Math.random()*.01,lng:13.404954+Math.random()*.01,address:Ne.location}));return r.jsxs("div",{className:"flex flex-col h-full",children:[r.jsx("div",{className:"flex-1",children:r.jsx(Gre,{constructionSites:we,onLocationUpdate:(Ne,rt)=>{d(Ne),re(rt.map(et=>et.id))},className:"h-full"})}),r.jsxs("div",{className:"bg-white border-t rounded-t-xl p-4 max-h-60 overflow-y-auto",children:[r.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[r.jsx(hn,{className:"h-5 w-5"}),"Zeiterfassung"]}),f.length>0?r.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx(sa,{className:"h-4 w-4 text-blue-600"}),r.jsx("span",{className:"text-sm font-medium",children:f[0].name})]}),r.jsx("div",{className:"text-xs text-gray-600",children:f[0].location}),xe.length>0&&r.jsx("div",{className:"mt-2 text-xs text-green-600 font-medium",children:"✅ In Reichweite - Einstempeln möglich"})]}):r.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3 mb-4",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(sa,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{className:"text-sm text-gray-500",children:"Kein Projekt vorhanden"})]})}),u?r.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-sm",children:"Zeit läuft"}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Seit ",(u.startTime instanceof Date?u.startTime:new Date(u.startTime)).toLocaleTimeString()]})]}),r.jsx("div",{className:"text-lg font-bold text-green-600",children:Nn()})]}),r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsxs(J,{onClick:Ln,variant:"outline",size:"sm",className:"flex-1",children:[r.jsx(Kp,{className:"h-4 w-4 mr-1"}),"Pause"]}),r.jsxs(J,{onClick:yr,variant:"destructive",size:"sm",className:"flex-1",children:[r.jsx(__,{className:"h-4 w-4 mr-1"}),"Stop"]})]})]}):r.jsx("div",{className:"space-y-2",children:f.map(Ne=>(xe.includes(Ne.id),r.jsxs(J,{variant:"default",className:"w-full justify-center",onClick:()=>ft(Ne.id),children:[r.jsx(Oc,{className:"h-4 w-4 mr-2"}),"STARTEN"]},Ne.id)))})]})]})},it=()=>{var we;return r.jsxs("div",{className:"space-y-2 w-full overflow-hidden",children:[r.jsx(le,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:r.jsxs(ce,{className:"p-3",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-sm",children:"Willkommen zurück!"}),r.jsx("p",{className:"text-blue-100 text-xs",children:t==null?void 0:t.email})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(eB,{className:"h-4 w-4"}),r.jsx("span",{className:"text-xs",children:"4G"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(DF,{className:"h-4 w-4"}),r.jsxs("span",{className:"text-xs",children:[$,"%"]})]})]})]}),r.jsx("div",{className:"flex items-center gap-2 mb-2",children:i?r.jsxs(r.Fragment,{children:[r.jsx(ZA,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Online"})]}):r.jsxs(r.Fragment,{children:[r.jsx(b_,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Offline"})]})}),c&&r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(sa,{className:"h-4 w-4"}),r.jsx("span",{className:"truncate",children:c.address})]})]})}),u&&r.jsx(le,{className:"border-2 border-green-400 bg-green-50",children:r.jsxs(ce,{className:"p-3",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("h3",{className:"font-semibold text-green-800",children:"Timer läuft"}),r.jsx("div",{className:"text-2xl font-mono font-bold text-green-600",children:Nn()})]}),r.jsx("p",{className:"text-green-700 text-sm mb-3",children:(we=f.find(Ne=>Ne.id===u.projectId))==null?void 0:we.name}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(J,{size:"sm",variant:"outline",onClick:Ln,className:"flex-1",children:[r.jsx(Kp,{className:"h-4 w-4 mr-2"}),"Pause"]}),r.jsxs(J,{size:"sm",variant:"destructive",onClick:yr,className:"flex-1",children:[r.jsx(__,{className:"h-4 w-4 mr-2"}),"Stoppen"]})]})]})}),r.jsxs(le,{children:[r.jsx(Ce,{className:"p-3",children:r.jsxs(Ee,{className:"flex items-center gap-2",children:[r.jsx("span",{children:"Schnellaktionen"}),X>0&&r.jsx(Ve,{variant:"destructive",className:"rounded-full px-2 py-1",children:X})]})}),r.jsxs(ce,{className:"grid grid-cols-2 gap-2 p-3",children:[r.jsxs(J,{className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>a("time"),children:[r.jsx(hn,{className:"h-6 w-6"}),r.jsx("span",{className:"text-sm",children:"Zeit erfassen"})]}),r.jsxs(J,{variant:"outline",className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>{var Ne;U(((Ne=f[0])==null?void 0:Ne.id)||""),De()},children:[r.jsx(ap,{className:"h-6 w-6"}),r.jsx("span",{className:"text-sm",children:"Foto machen"})]}),r.jsxs(J,{variant:"outline",className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>a("projects"),children:[r.jsx(Y2,{className:"h-6 w-6"}),r.jsx("span",{className:"text-sm",children:"Projekte"})]}),r.jsxs(J,{variant:"outline",className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>se(!0),children:[r.jsx(zt,{className:"h-6 w-6"}),r.jsx("span",{className:"text-sm",children:"Urlaub"}),me.available>0&&r.jsxs("span",{className:"text-xs text-green-600",children:[me.available," Tage"]})]})]})]}),r.jsxs(le,{className:"overflow-hidden",children:[r.jsx(Ce,{className:"p-3",children:r.jsxs(Ee,{className:"flex items-center gap-1 text-sm",children:[r.jsx(Ni,{className:"h-4 w-4"}),"Schnell-Material"]})}),r.jsxs(ce,{className:"space-y-2 p-3",children:[r.jsxs("select",{value:_e.projectId,onChange:Ne=>be(rt=>({...rt,projectId:Ne.target.value})),className:"w-full p-1.5 border rounded text-xs",children:[r.jsx("option",{value:"",children:"Projekt wählen..."}),f.map(Ne=>r.jsx("option",{value:Ne.id,children:Ne.name},Ne.id))]}),r.jsx("input",{type:"text",placeholder:"Material...",value:_e.material,onChange:Ne=>be(rt=>({...rt,material:Ne.target.value})),className:"w-full p-1.5 border rounded text-xs"}),r.jsxs("div",{className:"flex gap-0.5",children:[r.jsx("input",{type:"number",placeholder:"Menge",value:_e.quantity,onChange:Ne=>be(rt=>({...rt,quantity:Ne.target.value})),className:"flex-1 min-w-0 p-1.5 border rounded text-xs"}),r.jsxs("select",{value:_e.unit,onChange:Ne=>be(rt=>({...rt,unit:Ne.target.value})),className:"p-1.5 border rounded text-xs w-12",children:[r.jsx("option",{value:"Stück",children:"Stk"}),r.jsx("option",{value:"Meter",children:"m"}),r.jsx("option",{value:"kg",children:"kg"}),r.jsx("option",{value:"Liter",children:"L"})]})]}),r.jsx(J,{onClick:mn,disabled:!_e.material||!_e.quantity,className:"w-full",size:"sm",children:"Material erfassen"})]})]})]})},Kt=()=>r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h3",{className:"text-base font-semibold",children:"Meine Projekte"}),r.jsxs(Ve,{variant:"outline",children:[f.length," aktiv"]})]}),f.map(we=>r.jsx(le,{className:"relative",children:r.jsxs(ce,{className:"p-3",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold text-sm",children:we.name}),r.jsxs("p",{className:"text-gray-600 text-xs flex items-center gap-1",children:[r.jsx(sa,{className:"h-3 w-3"}),we.location]})]}),r.jsx(Ve,{className:`${cr(we.priority)} text-white text-xs`,children:Wn(we.priority)})]}),we.deadline&&r.jsxs("p",{className:"text-xs text-orange-600 mb-3",children:["Fällig: ",new Date(we.deadline).toLocaleDateString("de-DE")]}),r.jsx("div",{className:"flex gap-1 mb-2",children:r.jsxs(J,{size:"sm",onClick:()=>ft(we.id),disabled:!!u,className:"flex-1",children:[r.jsx(Oc,{className:"h-3 w-3 mr-1"}),"Zeit starten"]})}),r.jsxs("div",{className:"flex gap-1",children:[r.jsxs(J,{size:"sm",variant:"outline",onClick:()=>{U(we.id),De()},className:"flex-1",children:[r.jsx(ap,{className:"h-3 w-3 mr-1"}),"Foto"]}),r.jsxs(J,{size:"sm",variant:"outline",onClick:()=>{U(we.id),M(!0)},className:"flex-1",children:[r.jsx(ms,{className:"h-3 w-3 mr-1"}),"Rechnung"]}),r.jsxs(J,{size:"sm",variant:"outline",onClick:()=>{U(we.id),R(!0)},className:"flex-1",children:[r.jsx(Bb,{className:"h-3 w-3 mr-1"}),"Notiz"]})]})]})},we.id))]}),Bt=()=>r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Profil"}),r.jsx(le,{children:r.jsxs(ce,{className:"p-3",children:[r.jsxs("div",{className:"text-center mb-4",children:[r.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-2",children:r.jsx($s,{className:"h-8 w-8 text-white"})}),r.jsx("h4",{className:"font-semibold",children:t==null?void 0:t.email}),r.jsx("p",{className:"text-gray-600 text-sm",children:"Mitarbeiter"})]}),r.jsxs("div",{className:"space-y-3 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Status:"}),r.jsx(Ve,{variant:"outline",className:"text-green-600",children:"Aktiv"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Standort:"}),r.jsx("span",{className:"text-gray-600",children:c?"Verfügbar":"Nicht verfügbar"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Offline-Daten:"}),r.jsxs("span",{className:"text-gray-600",children:[JSON.parse(localStorage.getItem("completedTimeEntries")||"[]").length," Einträge"]})]})]})]})}),!i&&r.jsx(le,{className:"border-orange-400 bg-orange-50",children:r.jsxs(ce,{className:"p-3",children:[r.jsxs("div",{className:"flex items-center gap-2 text-orange-700",children:[r.jsx(b_,{className:"h-4 w-4"}),r.jsx("span",{className:"font-medium",children:"Offline-Modus"})]}),r.jsx("p",{className:"text-orange-600 text-sm mt-1",children:"Daten werden bei nächster Verbindung synchronisiert."})]})})]});return r.jsxs("div",{className:"h-screen bg-gray-50 flex flex-col relative overflow-hidden",style:{width:"100vw",maxWidth:"none"},children:[r.jsxs("div",{className:"flex-1 px-3 pt-8 pb-16 overflow-y-auto overflow-x-hidden",children:[s==="home"&&it(),s==="projects"&&Kt(),s==="time"&&r.jsx("div",{className:"h-full -mx-3 -mt-8 -mb-16",children:Hr()}),s==="profile"&&Bt()]}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-white border-t shadow-lg",children:r.jsx("div",{className:"grid grid-cols-4 gap-1 p-2",children:[{id:"home",icon:WF,label:"Start"},{id:"projects",icon:Y2,label:"Projekte"},{id:"time",icon:hn,label:"Zeit"},{id:"profile",icon:$s,label:"Profil"}].map(we=>r.jsxs(J,{variant:s===we.id?"default":"ghost",size:"sm",onClick:()=>a(we.id),className:"flex flex-col gap-0.5 h-14 p-1",children:[r.jsx(we.icon,{className:"h-5 w-5"}),r.jsx("span",{className:"text-xs",children:we.label}),we.id==="projects"&&X>0&&r.jsx(Ve,{variant:"destructive",className:"absolute -top-1 -right-1 rounded-full w-4 h-4 p-0 text-xs",children:X})]},we.id))})}),y&&r.jsxs("div",{className:"fixed inset-0 z-50 bg-black",children:[r.jsx("video",{ref:I,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}),r.jsx("canvas",{ref:H,className:"hidden"}),r.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-4",children:[r.jsx(J,{onClick:at,className:"bg-white text-black hover:bg-gray-200 rounded-full w-16 h-16",children:r.jsx(ap,{className:"h-8 w-8"})}),r.jsx(J,{onClick:Ie,variant:"outline",className:"bg-white text-black hover:bg-gray-200 rounded-full w-16 h-16",children:r.jsx(ar,{className:"h-8 w-8"})})]})]}),r.jsx(en,{open:D,onOpenChange:M,children:r.jsxs(Gt,{children:[r.jsx(rn,{children:r.jsx(sn,{children:"Rechnung hochladen"})}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Datei auswählen"}),r.jsx("input",{ref:O,type:"file",accept:"image/*,.pdf",className:"w-full p-2 border rounded-md"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Betrag (optional)"}),r.jsx(ne,{type:"number",step:"0.01",placeholder:"0.00",value:ue,onChange:we=>de(we.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Beschreibung (optional)"}),r.jsx(En,{placeholder:"Beschreibung der Rechnung...",value:W,onChange:we=>ee(we.target.value)})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(J,{onClick:()=>{var Ne,rt;const we=(rt=(Ne=O.current)==null?void 0:Ne.files)==null?void 0:rt[0];we&&V&&Me(we,V)},disabled:!((Yt=(dt=O.current)==null?void 0:dt.files)!=null&&Yt[0]),className:"flex-1",children:[r.jsx(KA,{className:"h-4 w-4 mr-2"}),"Hochladen"]}),r.jsx(J,{variant:"outline",onClick:()=>M(!1),children:"Abbrechen"})]})]})]})}),r.jsx(en,{open:B,onOpenChange:R,children:r.jsxs(Gt,{children:[r.jsx(rn,{children:r.jsx(sn,{children:"Notiz hinzufügen"})}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kommentar"}),r.jsx(En,{placeholder:"Ihre Notiz zum Projekt...",value:Q,onChange:we=>z(we.target.value),rows:4})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(J,{onClick:()=>{Q.trim()&&V&&Nt(V,Q.trim())},disabled:!Q.trim(),className:"flex-1",children:[r.jsx(dn,{className:"h-4 w-4 mr-2"}),"Hinzufügen"]}),r.jsx(J,{variant:"outline",onClick:()=>{R(!1),z("")},children:"Abbrechen"})]})]})]})}),r.jsx(AI,{open:G,onOpenChange:se,onSuccess:At})]})},TO=()=>{const{user:t,loading:e}=Di(),n=Pi();return g.useEffect(()=>{!e&&!t&&n("/auth")},[t,e,n]),e?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"text-center",children:r.jsx("p",{className:"text-gray-500",children:"Wird geladen..."})})}):t?r.jsx(Qre,{}):r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"text-center",children:r.jsx("p",{className:"text-gray-500",children:"Nicht angemeldet. Weiterleitung..."})})})},Yre=()=>{const t=Pi(),[e]=aj(),{toast:n}=Rt();return g.useEffect(()=>{(async()=>{const a=e.get("code"),i=e.get("error");if(i){n({title:"Gmail Verbindung fehlgeschlagen",description:`Fehler: ${i}`,variant:"destructive"}),t("/");return}if(!a){n({title:"Gmail Verbindung fehlgeschlagen",description:"Kein Autorisierungscode erhalten",variant:"destructive"}),t("/");return}try{const{data:{user:o}}=await K.auth.getUser();if(!o){n({title:"Fehler",description:"Sie müssen angemeldet sein",variant:"destructive"}),t("/auth");return}const{data:c,error:d}=await K.functions.invoke("gmail-oauth-callback",{body:{code:a}});d?(console.error("Gmail callback error:",d),n({title:"Gmail Verbindung fehlgeschlagen",description:d.message||"Ein Fehler ist aufgetreten",variant:"destructive"})):n({title:"Gmail erfolgreich verbunden",description:`E-Mail Konto ${c.email} wurde verbunden`})}catch(o){console.error("Error during Gmail callback:",o),n({title:"Gmail Verbindung fehlgeschlagen",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}t("/")})()},[e,t,n]),r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),r.jsx("p",{className:"mt-4 text-lg",children:"Gmail Verbindung wird verarbeitet..."})]})})},Xre=()=>r.jsx("div",{className:"min-h-screen bg-background p-4",children:r.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.jsxs(Zi,{to:"/",className:"inline-flex items-center gap-2 text-primary hover:text-primary/80 mb-6",children:[r.jsx(PF,{className:"h-4 w-4"}),"Zurück zur Startseite"]}),r.jsxs(le,{children:[r.jsxs(Ce,{children:[r.jsx(Ee,{className:"text-3xl font-bold",children:"Datenschutzerklärung"}),r.jsxs("p",{className:"text-muted-foreground",children:["Zuletzt aktualisiert: ",new Date().toLocaleDateString("de-DE")]})]}),r.jsx(ce,{className:"prose prose-slate max-w-none",children:r.jsxs("div",{className:"space-y-8",children:[r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"1. Verantwortlicher"}),r.jsx("p",{className:"mb-4",children:"Verantwortlicher für die Datenverarbeitung auf dieser Website ist:"}),r.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[r.jsx("p",{className:"font-semibold",children:"HandwerkOS"}),r.jsx("p",{children:"E-Mail: info@handwerkos.de"}),r.jsx("p",{children:"Website: https://handwerkos.de"})]})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"2. Allgemeine Hinweise"}),r.jsx("p",{className:"mb-4",children:"Die folgenden Hinweise geben einen einfachen Überblick darüber, was mit Ihren personenbezogenen Daten passiert, wenn Sie diese Website besuchen. Personenbezogene Daten sind alle Daten, mit denen Sie persönlich identifiziert werden können."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"3. Datenerfassung auf dieser Website"}),r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.1 Cookies"}),r.jsx("p",{className:"mb-4",children:"Diese Website verwendet Cookies. Cookies sind kleine Textdateien, die auf Ihrem Rechner abgelegt werden und die Ihr Browser speichert. Sie dienen dazu, unser Angebot nutzerfreundlicher, effektiver und sicherer zu machen."}),r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.2 Server-Log-Dateien"}),r.jsx("p",{className:"mb-4",children:"Der Provider der Seiten erhebt und speichert automatisch Informationen in so genannten Server-Log-Dateien, die Ihr Browser automatisch an uns übermittelt. Dies sind:"}),r.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[r.jsx("li",{children:"Browsertyp und Browserversion"}),r.jsx("li",{children:"Verwendetes Betriebssystem"}),r.jsx("li",{children:"Referrer URL"}),r.jsx("li",{children:"Hostname des zugreifenden Rechners"}),r.jsx("li",{children:"Uhrzeit der Serveranfrage"}),r.jsx("li",{children:"IP-Adresse"})]}),r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.3 Kontaktformular"}),r.jsx("p",{className:"mb-4",children:"Wenn Sie uns per Kontaktformular Anfragen zukommen lassen, werden Ihre Angaben aus dem Anfrageformular inklusive der von Ihnen dort angegebenen Kontaktdaten zwecks Bearbeitung der Anfrage und für den Fall von Anschlussfragen bei uns gespeichert."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"4. Registrierung und Nutzerkonten"}),r.jsx("p",{className:"mb-4",children:"Sie können sich auf dieser Website registrieren, um zusätzliche Funktionen zu nutzen. Die dazu eingegebenen Daten verwenden wir nur zum Zwecke der Nutzung des jeweiligen Angebotes oder Dienstes. Die bei der Registrierung abgefragten Pflichtangaben müssen vollständig angegeben werden."}),r.jsx("p",{className:"mb-4",children:"Folgende Daten werden bei der Registrierung erhoben:"}),r.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[r.jsx("li",{children:"E-Mail-Adresse"}),r.jsx("li",{children:"Firmenname"}),r.jsx("li",{children:"Vor- und Nachname"}),r.jsx("li",{children:"Telefonnummer"}),r.jsx("li",{children:"Adresse"}),r.jsx("li",{children:"Steuerliche Informationen (optional)"})]})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"5. Gmail-Integration"}),r.jsx("p",{className:"mb-4",children:"Unsere Software bietet die Möglichkeit, Ihr Gmail-Konto zu verbinden. Dabei werden folgende Daten verarbeitet:"}),r.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[r.jsx("li",{children:"E-Mail-Adresse Ihres Gmail-Kontos"}),r.jsx("li",{children:"Zugriffstokens für die Gmail-API"}),r.jsx("li",{children:"E-Mail-Inhalte zur Kategorisierung und Verarbeitung"})]}),r.jsx("p",{className:"mb-4",children:"Diese Daten werden nur zur Bereitstellung der E-Mail-Verwaltungsfunktionen verwendet und nicht an Dritte weitergegeben."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"6. Zeiterfassung und Mitarbeiterdaten"}),r.jsx("p",{className:"mb-4",children:"Unsere Software erfasst Arbeitszeiten und Mitarbeiterdaten. Dabei werden folgende Informationen gespeichert:"}),r.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[r.jsx("li",{children:"Arbeitszeiten (Start-, Endzeiten, Pausen)"}),r.jsx("li",{children:"Standortdaten (bei aktivierter Standorterfassung)"}),r.jsx("li",{children:"Mitarbeiterstammdaten"}),r.jsx("li",{children:"Projektbezogene Zeiterfassungen"})]})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"7. Ihre Rechte"}),r.jsx("p",{className:"mb-4",children:"Sie haben folgende Rechte:"}),r.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[r.jsx("li",{children:"Recht auf Auskunft über Ihre gespeicherten personenbezogenen Daten"}),r.jsx("li",{children:"Recht auf Berichtigung unrichtiger Daten"}),r.jsx("li",{children:"Recht auf Löschung Ihrer Daten"}),r.jsx("li",{children:"Recht auf Einschränkung der Datenverarbeitung"}),r.jsx("li",{children:"Recht auf Datenübertragbarkeit"}),r.jsx("li",{children:"Widerspruchsrecht gegen die Datenverarbeitung"})]})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"8. Datensicherheit"}),r.jsx("p",{className:"mb-4",children:"Wir verwenden innerhalb des Website-Besuchs das verbreitete SSL-Verfahren (Secure Socket Layer) in Verbindung mit der jeweils höchsten Verschlüsselungsstufe, die von Ihrem Browser unterstützt wird. Alle Daten werden verschlüsselt übertragen und in sicheren Rechenzentren gespeichert."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"9. Drittanbieter"}),r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"9.1 Supabase"}),r.jsx("p",{className:"mb-4",children:"Wir nutzen Supabase als Backend-Dienstleister. Supabase verarbeitet Daten in unserem Auftrag und ist vertraglich zur Einhaltung der Datenschutzbestimmungen verpflichtet."}),r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"9.2 Google APIs"}),r.jsx("p",{className:"mb-4",children:"Für die Gmail-Integration nutzen wir Google APIs. Die Nutzung unterliegt den Datenschutzbestimmungen von Google."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"10. Änderungen dieser Datenschutzerklärung"}),r.jsx("p",{className:"mb-4",children:"Wir behalten uns vor, diese Datenschutzerklärung anzupassen, damit sie stets den aktuellen rechtlichen Anforderungen entspricht oder um Änderungen unserer Leistungen in der Datenschutzerklärung umzusetzen."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"11. Kontakt"}),r.jsx("p",{className:"mb-4",children:"Bei Fragen zum Datenschutz wenden Sie sich bitte an:"}),r.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[r.jsx("p",{children:"E-Mail: datenschutz@handwerkos.de"}),r.jsx("p",{children:"Oder nutzen Sie unser Kontaktformular auf der Website."})]})]})]})})]})]})}),Jre=()=>{const t=zd();return g.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),r.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),r.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},ese=()=>{const t=Pi(),[e]=aj(),[n,s]=g.useState(""),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(""),[m,f]=g.useState(""),[p,y]=g.useState(!1),[j,v]=g.useState(""),[_,b]=g.useState(null);g.useEffect(()=>{(async()=>{var A,E;const S=e.get("token");if(console.log("=== DEBUGGING TOKEN VALIDATION ==="),console.log("URL:",window.location.href),console.log("Token from URL:",S),!S){console.error("No token found in URL"),Et.error("Fehlender Einladungstoken. Bitte verwenden Sie den vollständigen Link aus der E-Mail.");return}try{console.log("Attempting to validate token:",S);const{data:D,error:M}=await K.from("employee_invitations").select("*");console.log("All invitations in DB:",D),console.log("List error:",M);const{data:B,error:R}=await K.from("employee_invitations").select("*").eq("invite_token",S).eq("status","pending").single();if(console.log("Query result:",{invitation:B,inviteError:R}),R){console.error("Database error:",R),R.code==="PGRST116"?Et.error("Einladung nicht gefunden. Möglicherweise wurde sie bereits verwendet oder ist abgelaufen."):Et.error(`Datenbankfehler: ${R.message}`);return}if(!B){console.error("No invitation found for token"),Et.error("Ungültiger Einladungslink. Bitte wenden Sie sich an Ihren Manager.");return}const P=new Date(B.expires_at),F=new Date;if(console.log("Token expires:",P),console.log("Current time:",F),console.log("Is expired:",P<F),P<F){console.error("Invitation token expired"),Et.error("Dieser Einladungslink ist abgelaufen. Bitte fordern Sie eine neue Einladung an.");return}console.log("Valid invitation found:",B),console.log("Employee data:",B.employee_data),s(B.email),u(((A=B.employee_data)==null?void 0:A.firstName)||""),f(((E=B.employee_data)==null?void 0:E.lastName)||""),b(B)}catch(D){console.error("Exception during validation:",D),Et.error(`Fehler beim Validieren der Einladung: ${D==null?void 0:D.message}`)}})()},[e]);const w=async N=>{if(N.preventDefault(),v(""),!_){v("Einladungsdaten nicht gefunden. Bitte verwenden Sie den Link aus der E-Mail erneut.");return}if(a!==o){v("Passwörter stimmen nicht überein");return}if(a.length<8){v("Passwort muss mindestens 8 Zeichen lang sein");return}y(!0);try{console.log("Creating account for employee:",_.email);const{data:S,error:A}=await K.auth.signUp({email:_.email,password:a,options:{data:{first_name:d,last_name:m,company_id:_.company_id}}});if(A){console.error("Error creating user account:",A),v(A.message||"Fehler beim Erstellen des Kontos");return}S.user&&(await K.from("employee_invitations").update({status:"accepted"}).eq("invite_token",_.invite_token),await K.from("user_roles").insert({user_id:S.user.id,role:"employee"}),console.log("Employee account created successfully"),Et.success("Konto erfolgreich erstellt! Sie werden zur Anmeldung weitergeleitet."),setTimeout(()=>t("/auth"),1500))}catch(S){console.error("Error during employee registration:",S),v("Fehler beim Erstellen des Kontos")}finally{y(!1)}};return _?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:r.jsxs(le,{className:"w-full max-w-md",children:[r.jsxs(Ce,{className:"text-center",children:[r.jsx(Ee,{className:"text-2xl font-bold",children:"Willkommen im Team!"}),r.jsx(Sr,{children:"Erstellen Sie Ihr Passwort für Ihr HandwerkOS-Konto"})]}),r.jsx(ce,{children:r.jsxs("form",{onSubmit:w,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"firstName",children:"Vorname"}),r.jsx(ne,{id:"firstName",type:"text",value:d,onChange:N=>u(N.target.value),required:!0})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"lastName",children:"Nachname"}),r.jsx(ne,{id:"lastName",type:"text",value:m,onChange:N=>f(N.target.value),required:!0})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"email",children:"E-Mail"}),r.jsx(ne,{id:"email",type:"email",value:n,disabled:!0,className:"bg-gray-50"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"password",children:"Passwort"}),r.jsx(ne,{id:"password",type:"password",value:a,onChange:N=>i(N.target.value),required:!0,minLength:8,placeholder:"Mindestens 8 Zeichen"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(Y,{htmlFor:"confirmPassword",children:"Passwort bestätigen"}),r.jsx(ne,{id:"confirmPassword",type:"password",value:o,onChange:N=>c(N.target.value),required:!0,minLength:8,placeholder:"Passwort wiederholen"})]}),j&&r.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:j}),r.jsx(J,{type:"submit",className:"w-full",disabled:p,children:p?"Konto wird erstellt...":"Konto erstellen"})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"text-center",children:r.jsx("p",{className:"text-gray-500",children:"Einladung wird validiert..."})})})},tse=[{title:"Angebote & Aufträge",desc:"Erstellen Sie Angebote in Minuten und wandeln Sie sie mit einem Klick in Aufträge und Rechnungen um.",Icon:On},{title:"Projektmanagement",desc:"Aufgaben, Materialien, Dokumente und Fortschritt zentral im Blick.",Icon:FF},{title:"Zeiterfassung & Mobil",desc:"Einfache mobile Erfassung mit GPS‑Option – auch offline.",Icon:hn},{title:"E‑Mail‑Integration",desc:"Gmail/IMAP verknüpfen und Mails Projekten & Kunden zuordnen.",Icon:sr},{title:"Material & Lager",desc:"Bestände verwalten, Bedarf planen, Nachbestellungen vorbereiten.",Icon:MF},{title:"Finanzen & Rechnungen",desc:"Vom Angebot zur Rechnung – schnell, übersichtlich, zuverlässig.",Icon:hs}];function nse(){return r.jsxs("div",{className:"space-y-12",children:[r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Alles was Sie brauchen"}),r.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Eine vollständige Lösung für moderne Handwerksbetriebe – von der Angebotserstellung bis zur Abrechnung."})]}),r.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:tse.map(({title:t,desc:e,Icon:n},s)=>r.jsxs(le,{className:"group relative p-8 border-0 bg-white/80 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/50 to-indigo-50/50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),r.jsxs("div",{className:"relative mb-6",children:[r.jsx("div",{className:"inline-flex h-14 w-14 items-center justify-center rounded-2xl bg-gradient-to-r from-blue-100 to-indigo-100 group-hover:from-blue-200 group-hover:to-indigo-200 transition-all duration-300",children:r.jsx(n,{className:"h-7 w-7 text-blue-600 group-hover:text-indigo-600 transition-colors duration-300"})}),r.jsx("div",{className:"absolute -top-2 -right-2 h-6 w-6 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-center text-white text-xs font-bold",children:s+1})]}),r.jsxs("div",{className:"relative space-y-3",children:[r.jsx("h3",{className:"text-xl font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:t}),r.jsx("p",{className:"text-slate-600 leading-relaxed",children:e})]}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-600 to-indigo-600 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"})]},t))}),r.jsx("div",{className:"text-center pt-8",children:r.jsxs("div",{className:"inline-flex items-center gap-2 text-sm text-slate-500 bg-slate-50 px-4 py-2 rounded-full",children:[r.jsx("svg",{className:"h-4 w-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"Alle Funktionen in einem System – keine separaten Tools erforderlich"})]})})]})}const rse=[{title:"Angebote & Rechnungen",desc:"Von der Anfrage bis zur Zahlung – alles nahtlos verbunden."},{title:"Projekte & Aufgaben",desc:"Status, Verantwortliche, Dokumente und Fortschritte im Team koordinieren."},{title:"Zeiten & Einsatzplanung",desc:"Zeiten erfassen, Auslastung sehen, Planung vereinfachen."},{title:"E‑Mails & Kommunikation",desc:"Zentrale Transparenz – nichts geht mehr verloren."}];function sse(){return r.jsxs("div",{className:"space-y-12",children:[r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Integrierte Module"}),r.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Alle wichtigen Bereiche Ihres Handwerksbetriebs in einer einzigen Plattform vereint."})]}),r.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:rse.map((t,e)=>r.jsxs(le,{className:"group relative p-8 border-0 bg-white/80 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-500 hover:-translate-y-1 overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/30 via-indigo-50/30 to-purple-50/30 opacity-0 group-hover:opacity-100 transition-all duration-500"}),r.jsxs("div",{className:"relative flex items-start gap-6",children:[r.jsxs("div",{className:"relative w-32 h-24 shrink-0 rounded-2xl border border-slate-200/50 bg-gradient-to-br from-slate-50 to-slate-100 overflow-hidden group-hover:shadow-xl transition-all duration-500",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-100/50 via-indigo-100/50 to-purple-100/50 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),r.jsxs("div",{className:"absolute inset-3 space-y-2",children:[r.jsx("div",{className:"h-2 bg-gradient-to-r from-blue-300 to-indigo-300 rounded-full w-3/4"}),r.jsx("div",{className:"h-2 bg-gradient-to-r from-indigo-300 to-purple-300 rounded-full w-1/2"}),r.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-1",children:[r.jsx("div",{className:"h-3 bg-blue-200/70 rounded"}),r.jsx("div",{className:"h-3 bg-indigo-200/70 rounded"})]})]}),r.jsx("div",{className:"absolute -top-2 -right-2 h-7 w-7 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-center text-white text-xs font-bold shadow-lg",children:e+1})]}),r.jsxs("div",{className:"flex-1 space-y-3",children:[r.jsx("h3",{className:"text-2xl font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:t.title}),r.jsx("p",{className:"text-slate-600 leading-relaxed text-lg",children:t.desc}),r.jsx("div",{className:"pt-2 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0",children:r.jsxs("div",{className:"inline-flex items-center text-blue-600 font-medium text-sm cursor-pointer",children:["Mehr erfahren",r.jsx("svg",{className:"ml-1 h-4 w-4 transition-transform group-hover:translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})})]})]}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-600 to-indigo-600 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-500 origin-left"})]},t.title))}),r.jsx("div",{className:"text-center pt-8",children:r.jsxs("div",{className:"inline-flex items-center gap-3 bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 rounded-2xl border border-blue-200/30",children:[r.jsxs("div",{className:"flex -space-x-2",children:[r.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-blue-500 to-blue-600 border-2 border-white flex items-center justify-center",children:r.jsx("span",{className:"text-white text-xs font-bold",children:"1"})}),r.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-indigo-500 to-indigo-600 border-2 border-white flex items-center justify-center",children:r.jsx("span",{className:"text-white text-xs font-bold",children:"2"})}),r.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-purple-500 to-purple-600 border-2 border-white flex items-center justify-center",children:r.jsx("span",{className:"text-white text-xs font-bold",children:"3"})})]}),r.jsx("span",{className:"text-slate-700 font-medium",children:"Alle Module arbeiten nahtlos zusammen"})]})})]})}const ase=[{title:"Gmail / IMAP",desc:"E‑Mails synchronisieren und Projekten zuordnen.",Icon:sr},{title:"Google Kalender",desc:"Termine und Einsätze direkt im Kalender planen.",Icon:zt}];function ise(){return r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-6",children:"Direkte Integrationen"}),r.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:ase.map(({title:t,desc:e,Icon:n})=>r.jsxs(le,{className:"p-6 flex items-center gap-4 hover-scale",children:[r.jsx("div",{className:"inline-flex h-10 w-10 items-center justify-center rounded-md bg-primary/10 text-primary",children:r.jsx(n,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold mb-1",children:t}),r.jsx("p",{className:"text-muted-foreground",children:e})]})]},t))})]})}const ose=[{quote:"Mit HandwerkOS erstellen wir Angebote schneller und behalten Projekte endlich zentral im Blick.",author:"Malerbetrieb Schuster"},{quote:"Unsere Monteure buchen Zeiten mobil – die Abrechnung geht dadurch viel zügiger.",author:"Elektro König"},{quote:"Die E‑Mail‑Zuordnung spart uns täglich Zeit, weil alles direkt beim Projekt liegt.",author:"Sanitär & Heizung Weber"}];function lse(){return r.jsxs("div",{className:"space-y-12",children:[r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Erfolgsgeschichten"}),r.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Über 1.000 Handwerksbetriebe vertrauen bereits auf HandwerkOS."})]}),r.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:ose.map((t,e)=>r.jsxs(le,{className:"group relative p-8 border-0 bg-white/90 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 overflow-hidden",children:[r.jsx("div",{className:"absolute top-4 left-4 text-6xl text-blue-100/50 font-serif leading-none select-none",children:'"'}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/20 to-indigo-50/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),r.jsxs("div",{className:"relative space-y-6",children:[r.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((n,s)=>r.jsx("svg",{className:"h-5 w-5 text-yellow-400 fill-current",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},s))}),r.jsxs("blockquote",{className:"text-lg text-slate-700 leading-relaxed italic",children:['"',t.quote,'"']}),r.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-slate-100",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center text-white font-bold text-lg",children:t.author.charAt(0)}),r.jsxs("div",{children:[r.jsx("div",{className:"font-semibold text-slate-900",children:t.author}),r.jsx("div",{className:"text-sm text-slate-500",children:"Handwerksbetrieb"})]})]})]}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 to-indigo-500 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-center"})]},e))}),r.jsxs("div",{className:"flex justify-center items-center gap-8 pt-8",children:[r.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center",children:r.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-2xl text-slate-900",children:"1.000+"}),r.jsx("div",{className:"text-sm text-slate-600",children:"Zufriedene Betriebe"})]})]}),r.jsx("div",{className:"h-12 w-px bg-slate-200"}),r.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:r.jsx("svg",{className:"h-6 w-6 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-2xl text-slate-900",children:"4.9/5"}),r.jsx("div",{className:"text-sm text-slate-600",children:"Bewertung"})]})]})]})]})}var D1="Collapsible",[cse,MO]=Ss(D1),[dse,T1]=cse(D1),RO=g.forwardRef((t,e)=>{const{__scopeCollapsible:n,open:s,defaultOpen:a,disabled:i,onOpenChange:o,...c}=t,[d=!1,u]=zs({prop:s,defaultProp:a,onChange:o});return r.jsx(dse,{scope:n,disabled:i,contentId:ps(),open:d,onOpenToggle:g.useCallback(()=>u(m=>!m),[u]),children:r.jsx(Xe.div,{"data-state":R1(d),"data-disabled":i?"":void 0,...c,ref:e})})});RO.displayName=D1;var IO="CollapsibleTrigger",OO=g.forwardRef((t,e)=>{const{__scopeCollapsible:n,...s}=t,a=T1(IO,n);return r.jsx(Xe.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":R1(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...s,ref:e,onClick:Te(t.onClick,a.onOpenToggle)})});OO.displayName=IO;var M1="CollapsibleContent",LO=g.forwardRef((t,e)=>{const{forceMount:n,...s}=t,a=T1(M1,t.__scopeCollapsible);return r.jsx(Jn,{present:n||a.open,children:({present:i})=>r.jsx(use,{...s,ref:e,present:i})})});LO.displayName=M1;var use=g.forwardRef((t,e)=>{const{__scopeCollapsible:n,present:s,children:a,...i}=t,o=T1(M1,n),[c,d]=g.useState(s),u=g.useRef(null),m=Mt(e,u),f=g.useRef(0),p=f.current,y=g.useRef(0),j=y.current,v=o.open||c,_=g.useRef(v),b=g.useRef();return g.useEffect(()=>{const w=requestAnimationFrame(()=>_.current=!1);return()=>cancelAnimationFrame(w)},[]),Un(()=>{const w=u.current;if(w){b.current=b.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const N=w.getBoundingClientRect();f.current=N.height,y.current=N.width,_.current||(w.style.transitionDuration=b.current.transitionDuration,w.style.animationName=b.current.animationName),d(s)}},[o.open,s]),r.jsx(Xe.div,{"data-state":R1(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!v,...i,ref:m,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":j?`${j}px`:void 0,...t.style},children:v&&a})});function R1(t){return t?"open":"closed"}var hse=RO,fse=OO,mse=LO,Ti="Accordion",pse=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[I1,gse,xse]=cf(Ti),[Kg,_ae]=Ss(Ti,[xse,MO]),O1=MO(),FO=ke.forwardRef((t,e)=>{const{type:n,...s}=t,a=s,i=s;return r.jsx(I1.Provider,{scope:t.__scopeAccordion,children:n==="multiple"?r.jsx(wse,{...i,ref:e}):r.jsx(_se,{...a,ref:e})})});FO.displayName=Ti;var[BO,vse]=Kg(Ti),[zO,yse]=Kg(Ti,{collapsible:!1}),_se=ke.forwardRef((t,e)=>{const{value:n,defaultValue:s,onValueChange:a=()=>{},collapsible:i=!1,...o}=t,[c,d]=zs({prop:n,defaultProp:s,onChange:a});return r.jsx(BO,{scope:t.__scopeAccordion,value:c?[c]:[],onItemOpen:d,onItemClose:ke.useCallback(()=>i&&d(""),[i,d]),children:r.jsx(zO,{scope:t.__scopeAccordion,collapsible:i,children:r.jsx($O,{...o,ref:e})})})}),wse=ke.forwardRef((t,e)=>{const{value:n,defaultValue:s,onValueChange:a=()=>{},...i}=t,[o=[],c]=zs({prop:n,defaultProp:s,onChange:a}),d=ke.useCallback(m=>c((f=[])=>[...f,m]),[c]),u=ke.useCallback(m=>c((f=[])=>f.filter(p=>p!==m)),[c]);return r.jsx(BO,{scope:t.__scopeAccordion,value:o,onItemOpen:d,onItemClose:u,children:r.jsx(zO,{scope:t.__scopeAccordion,collapsible:!0,children:r.jsx($O,{...i,ref:e})})})}),[bse,Zg]=Kg(Ti),$O=ke.forwardRef((t,e)=>{const{__scopeAccordion:n,disabled:s,dir:a,orientation:i="vertical",...o}=t,c=ke.useRef(null),d=Mt(c,e),u=gse(n),f=Wd(a)==="ltr",p=Te(t.onKeyDown,y=>{var M;if(!pse.includes(y.key))return;const j=y.target,v=u().filter(B=>{var R;return!((R=B.ref.current)!=null&&R.disabled)}),_=v.findIndex(B=>B.ref.current===j),b=v.length;if(_===-1)return;y.preventDefault();let w=_;const N=0,S=b-1,A=()=>{w=_+1,w>S&&(w=N)},E=()=>{w=_-1,w<N&&(w=S)};switch(y.key){case"Home":w=N;break;case"End":w=S;break;case"ArrowRight":i==="horizontal"&&(f?A():E());break;case"ArrowDown":i==="vertical"&&A();break;case"ArrowLeft":i==="horizontal"&&(f?E():A());break;case"ArrowUp":i==="vertical"&&E();break}const D=w%b;(M=v[D].ref.current)==null||M.focus()});return r.jsx(bse,{scope:n,disabled:s,direction:a,orientation:i,children:r.jsx(I1.Slot,{scope:n,children:r.jsx(Xe.div,{...o,"data-orientation":i,ref:d,onKeyDown:s?void 0:p})})})}),D0="AccordionItem",[jse,L1]=Kg(D0),UO=ke.forwardRef((t,e)=>{const{__scopeAccordion:n,value:s,...a}=t,i=Zg(D0,n),o=vse(D0,n),c=O1(n),d=ps(),u=s&&o.value.includes(s)||!1,m=i.disabled||t.disabled;return r.jsx(jse,{scope:n,open:u,disabled:m,triggerId:d,children:r.jsx(hse,{"data-orientation":i.orientation,"data-state":ZO(u),...c,...a,ref:e,disabled:m,open:u,onOpenChange:f=>{f?o.onItemOpen(s):o.onItemClose(s)}})})});UO.displayName=D0;var qO="AccordionHeader",WO=ke.forwardRef((t,e)=>{const{__scopeAccordion:n,...s}=t,a=Zg(Ti,n),i=L1(qO,n);return r.jsx(Xe.h3,{"data-orientation":a.orientation,"data-state":ZO(i.open),"data-disabled":i.disabled?"":void 0,...s,ref:e})});WO.displayName=qO;var Lw="AccordionTrigger",HO=ke.forwardRef((t,e)=>{const{__scopeAccordion:n,...s}=t,a=Zg(Ti,n),i=L1(Lw,n),o=yse(Lw,n),c=O1(n);return r.jsx(I1.ItemSlot,{scope:n,children:r.jsx(fse,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":a.orientation,id:i.triggerId,...c,...s,ref:e})})});HO.displayName=Lw;var VO="AccordionContent",KO=ke.forwardRef((t,e)=>{const{__scopeAccordion:n,...s}=t,a=Zg(Ti,n),i=L1(VO,n),o=O1(n);return r.jsx(mse,{role:"region","aria-labelledby":i.triggerId,"data-orientation":a.orientation,...o,...s,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});KO.displayName=VO;function ZO(t){return t?"open":"closed"}var Nse=FO,Sse=UO,kse=WO,GO=HO,QO=KO;const Cse=Nse,YO=g.forwardRef(({className:t,...e},n)=>r.jsx(Sse,{ref:n,className:Oe("border-b",t),...e}));YO.displayName="AccordionItem";const XO=g.forwardRef(({className:t,children:e,...n},s)=>r.jsx(kse,{className:"flex",children:r.jsxs(GO,{ref:s,className:Oe("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...n,children:[e,r.jsx(Y0,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));XO.displayName=GO.displayName;const JO=g.forwardRef(({className:t,children:e,...n},s)=>r.jsx(QO,{ref:s,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:r.jsx("div",{className:Oe("pb-4 pt-0",t),children:e})}));JO.displayName=QO.displayName;const Ese=[{q:"Ist HandwerkOS DSGVO‑konform?",a:"Ja. Wir legen großen Wert auf Datenschutz und Sicherheit und unterstützen eine DSGVO‑konforme Nutzung."},{q:"Kann ich HandwerkOS mobil nutzen?",a:"Ja. HandwerkOS ist als Web‑App nutzbar und unterstützt iOS & Android über Capacitor."},{q:"Wie starte ich?",a:"Klicken Sie auf ‘Kostenlos testen’ – die Einrichtung dauert nur wenige Minuten."}];function Ase(){return r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-6",children:"Häufige Fragen"}),r.jsx(Cse,{type:"single",collapsible:!0,className:"w-full",children:Ese.map((t,e)=>r.jsxs(YO,{value:`faq-${e}`,children:[r.jsx(XO,{children:t.q}),r.jsx(JO,{children:t.a})]},e))})]})}function Pse(){return r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600 p-12 md:p-16 text-white",children:[r.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),r.jsx("div",{className:"absolute -top-8 -right-8 h-32 w-32 rounded-full bg-white/10 blur-2xl"}),r.jsx("div",{className:"absolute -bottom-8 -left-8 h-40 w-40 rounded-full bg-white/5 blur-2xl"}),r.jsxs("div",{className:"relative text-center space-y-8",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h2",{className:"text-4xl md:text-6xl font-bold leading-tight",children:["Bereit für den",r.jsx("br",{}),r.jsx("span",{className:"bg-gradient-to-r from-yellow-300 to-orange-300 bg-clip-text text-transparent",children:"digitalen Wandel?"})]}),r.jsx("p",{className:"text-xl text-blue-100 max-w-2xl mx-auto leading-relaxed",children:"Schließen Sie sich über 1.000 Handwerksbetrieben an, die bereits auf HandwerkOS vertrauen. Starten Sie heute kostenlos – ohne Risiko, ohne Vertragsbindung."})]}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-6 text-blue-100",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"30 Tage kostenlos"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"Keine Kreditkarte nötig"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"Sofort startklar"})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[r.jsx(Zi,{to:"/login",className:"inline-flex",children:r.jsx(J,{size:"lg",className:"bg-white text-blue-600 hover:bg-blue-50 shadow-2xl text-lg px-12 py-6 h-auto font-bold rounded-2xl transition-all duration-300 hover:scale-105",children:"🚀 Jetzt kostenlos starten"})}),r.jsx(J,{variant:"outline",size:"lg",className:"border-2 border-white/30 text-white hover:bg-white/10 backdrop-blur-sm text-lg px-8 py-6 h-auto rounded-2xl",children:"📞 Demo vereinbaren"})]}),r.jsxs("div",{className:"flex justify-center items-center gap-8 pt-8 text-blue-200",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-white",children:"1.000+"}),r.jsx("div",{className:"text-sm",children:"Betriebe"})]}),r.jsx("div",{className:"h-8 w-px bg-white/20"}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-white",children:"4.9/5"}),r.jsx("div",{className:"text-sm",children:"Bewertung"})]}),r.jsx("div",{className:"h-8 w-px bg-white/20"}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-white",children:"24/7"}),r.jsx("div",{className:"text-sm",children:"Support"})]})]})]})]})}const Dse={"@context":"https://schema.org","@type":"SoftwareApplication",name:"HandwerkOS – Handwerkersoftware",applicationCategory:"BusinessApplication",operatingSystem:"Web, iOS, Android",offers:{"@type":"Offer",price:"0",priceCurrency:"EUR"},description:"Moderne Handwerkersoftware für Angebote, Aufträge, Projekte und Zeiterfassung.",url:"https://handwerkos.de/handwerkersoftware"};function Tse(){return g.useEffect(()=>{document.title="Handwerkersoftware von HandwerkOS";const t=document.querySelector('meta[name="description"]')||document.head.appendChild(document.createElement("meta"));t.setAttribute("name","description"),t.setAttribute("content","Moderne Handwerkersoftware für Angebote, Aufträge, Projekte und Zeiterfassung. DSGVO-konform, mobil, integriert.");let e=document.querySelector('link[rel="canonical"]');e||(e=document.createElement("link"),e.rel="canonical",document.head.appendChild(e)),e.href=`${window.location.origin}/handwerkersoftware`;const n=document.createElement("script");n.type="application/ld+json",n.text=JSON.stringify(Dse),document.head.appendChild(n);const s={"@context":"https://schema.org","@type":"FAQPage",mainEntity:[{"@type":"Question",name:"Ist HandwerkOS DSGVO‑konform?",acceptedAnswer:{"@type":"Answer",text:"Ja. Wir legen großen Wert auf Datenschutz und Sicherheit und unterstützen eine DSGVO‑konforme Nutzung."}},{"@type":"Question",name:"Kann ich HandwerkOS mobil nutzen?",acceptedAnswer:{"@type":"Answer",text:"Ja. HandwerkOS ist als Web‑App nutzbar und unterstützt iOS & Android über Capacitor."}},{"@type":"Question",name:"Wie starte ich?",acceptedAnswer:{"@type":"Answer",text:"Klicken Sie auf ‘Kostenlos testen’ – die Einrichtung dauert nur wenige Minuten."}}]},a=document.createElement("script");return a.type="application/ld+json",a.text=JSON.stringify(s),document.head.appendChild(a),()=>{document.head.removeChild(n),document.head.removeChild(a)}},[]),r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 text-foreground",children:[r.jsxs("header",{className:"relative overflow-hidden bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:[r.jsxs("div",{className:"absolute inset-0 -z-10",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600/10 via-indigo-600/5 to-purple-600/10"}),r.jsx("div",{className:"absolute -top-20 -left-20 h-96 w-96 rounded-full bg-gradient-to-r from-blue-400/30 to-indigo-400/30 blur-3xl animate-pulse"}),r.jsx("div",{className:"absolute top-32 -right-20 h-80 w-80 rounded-full bg-gradient-to-r from-indigo-400/20 to-purple-400/20 blur-3xl animate-pulse delay-1000"}),r.jsx("div",{className:"absolute bottom-20 left-1/4 h-72 w-72 rounded-full bg-gradient-to-r from-purple-400/20 to-pink-400/20 blur-3xl animate-pulse delay-2000"}),r.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})]}),r.jsxs("nav",{className:"relative z-10 container flex items-center justify-between py-6",children:[r.jsxs(Zi,{to:"/",className:"flex items-center space-x-2",children:[r.jsx("img",{src:"/favicon-32x32.png",alt:"HandwerkOS Logo",className:"h-8 w-8"}),r.jsx("span",{className:"font-bold text-xl bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"HandwerkOS"})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(kre,{}),r.jsx(Zi,{to:"/login",children:r.jsx(J,{variant:"ghost",size:"sm",className:"hover:bg-white/80 dark:hover:bg-white/10",children:"Anmelden"})}),r.jsx(Zi,{to:"/login",children:r.jsx(J,{size:"sm",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-lg",children:"Kostenlos testen"})})]})]}),r.jsx("section",{"aria-labelledby":"hero",className:"relative z-10 container py-12 md:py-20",children:r.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"inline-flex items-center rounded-full bg-white/80 backdrop-blur-sm px-4 py-2 shadow-sm border",children:r.jsx("span",{className:"text-sm font-medium text-blue-600",children:"🚀 Moderne Handwerkersoftware"})}),r.jsxs("h1",{id:"hero",className:"text-5xl md:text-7xl font-bold tracking-tight leading-none",children:[r.jsx("span",{className:"bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"Handwerk"}),r.jsx("br",{}),r.jsx("span",{className:"text-slate-900",children:"neu gedacht"})]}),r.jsx("p",{className:"text-xl text-slate-600 leading-relaxed max-w-lg",children:"Die All-in-One Software für moderne Handwerksbetriebe. Projekte verwalten, Zeiten erfassen, Rechnungen erstellen – alles in einer Plattform."}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[r.jsx(Zi,{to:"/login",children:r.jsxs(J,{size:"lg",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-xl text-lg px-8 py-4 h-auto",children:["Jetzt kostenlos starten",r.jsx("svg",{className:"ml-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})}),r.jsx("a",{href:"#funktionen",className:"inline-flex",children:r.jsx(J,{variant:"outline",size:"lg",className:"text-lg px-8 py-4 h-auto border-2 hover:bg-white/80 backdrop-blur-sm",children:"Demo ansehen"})})]}),r.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500 pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"DSGVO-konform"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"30 Tage kostenlos"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"Deutscher Support"})]})]})]}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute -top-8 -left-8 h-72 w-72 rounded-full bg-gradient-to-r from-blue-200/40 to-indigo-200/40 blur-3xl"}),r.jsx("div",{className:"absolute -bottom-8 -right-8 h-80 w-80 rounded-full bg-gradient-to-r from-indigo-200/30 to-purple-200/30 blur-3xl"}),r.jsx("div",{className:"relative bg-white/80 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/20",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"h-4 bg-gradient-to-r from-blue-200 to-indigo-200 rounded-full w-3/4"}),r.jsx("div",{className:"h-4 bg-gradient-to-r from-indigo-200 to-purple-200 rounded-full w-1/2"}),r.jsx("div",{className:"h-32 bg-gradient-to-br from-slate-100 to-slate-200 rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"text-slate-400 text-sm",children:"HandwerkOS Dashboard"})}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx("div",{className:"h-16 bg-gradient-to-r from-blue-100 to-indigo-100 rounded-lg"}),r.jsx("div",{className:"h-16 bg-gradient-to-r from-indigo-100 to-purple-100 rounded-lg"})]})]})})]})]})})]}),r.jsxs("main",{className:"space-y-24 md:space-y-32",children:[r.jsx("section",{id:"funktionen",className:"container py-16 md:py-24",children:r.jsx(nse,{})}),r.jsx("section",{id:"module",className:"bg-slate-50 dark:bg-slate-800/50 py-16 md:py-24",children:r.jsx("div",{className:"container",children:r.jsx(sse,{})})}),r.jsx("section",{id:"integrationen",className:"container py-16 md:py-24",children:r.jsx(ise,{})}),r.jsx("section",{id:"kundenstimmen",className:"bg-gradient-to-br from-blue-50/50 to-indigo-50/50 dark:from-slate-800/30 dark:to-slate-700/30 py-16 md:py-24",children:r.jsx("div",{className:"container",children:r.jsx(lse,{})})}),r.jsx("section",{id:"faq",className:"container py-16 md:py-24",children:r.jsx(Ase,{})}),r.jsx("section",{className:"container py-16 pb-24",children:r.jsx(Pse,{})})]}),r.jsx("footer",{className:"bg-slate-900 dark:bg-slate-950 text-white mt-24",children:r.jsxs("div",{className:"container py-12",children:[r.jsxs("div",{className:"grid md:grid-cols-4 gap-8",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"h-8 w-8 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center",children:r.jsx("span",{className:"text-white font-bold text-sm",children:"H"})}),r.jsx("span",{className:"font-bold text-xl",children:"HandwerkOS"})]}),r.jsx("p",{className:"text-slate-300 text-sm leading-relaxed",children:"Die moderne Software-Lösung für Handwerksbetriebe. Einfach, intuitiv und speziell für deutsche Handwerker entwickelt."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h4",{className:"font-semibold text-white",children:"Produkt"}),r.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[r.jsx("li",{children:r.jsx("a",{href:"#funktionen",className:"hover:text-white transition-colors",children:"Funktionen"})}),r.jsx("li",{children:r.jsx("a",{href:"#module",className:"hover:text-white transition-colors",children:"Module"})}),r.jsx("li",{children:r.jsx("a",{href:"#faq",className:"hover:text-white transition-colors",children:"FAQ"})}),r.jsx("li",{children:r.jsx(Zi,{to:"/login",className:"hover:text-white transition-colors",children:"Kostenlos testen"})})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h4",{className:"font-semibold text-white",children:"Unternehmen"}),r.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Über uns"})}),r.jsx("li",{children:r.jsx("a",{href:"#kundenstimmen",className:"hover:text-white transition-colors",children:"Referenzen"})}),r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Karriere"})}),r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Kontakt"})})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h4",{className:"font-semibold text-white",children:"Rechtliches"}),r.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[r.jsx("li",{children:r.jsx(Zi,{to:"/privacy",className:"hover:text-white transition-colors",children:"Datenschutz"})}),r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Impressum"})}),r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"AGB"})}),r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"DSGVO"})})]})]})]}),r.jsxs("div",{className:"border-t border-slate-800 mt-12 pt-8 flex flex-col md:flex-row items-center justify-between gap-4",children:[r.jsx("div",{className:"flex items-center gap-6 text-sm text-slate-400",children:r.jsxs("p",{children:["© ",new Date().getFullYear()," HandwerkOS GmbH. Alle Rechte vorbehalten."]})}),r.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"h-4 w-4 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"DSGVO-konform"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"h-4 w-4 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z",clipRule:"evenodd"})}),r.jsx("span",{children:"Made in Germany"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"h-4 w-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),r.jsx("span",{children:"4.9/5 Bewertung"})]})]})]})]})})]})}const Mse=()=>{const[t,e]=g.useState(""),[n,s]=g.useState(""),[a,i]=g.useState(!1),[o,c]=g.useState(!1),{signIn:d}=mg(),u=Pi(),m=async f=>{if(f.preventDefault(),!t||!n){Et.error("Bitte füllen Sie alle Felder aus");return}c(!0);try{await d(t,n),Et.success("Erfolgreich angemeldet"),u("/")}catch(p){Et.error("Anmeldung fehlgeschlagen: "+((p==null?void 0:p.message)||"Unbekannter Fehler"))}finally{c(!1)}};return r.jsxs("div",{className:"h-screen bg-gray-50 flex flex-col overflow-hidden",children:[r.jsx("div",{className:"bg-white px-3 pt-8 pb-4 text-center border-b border-gray-200",children:r.jsxs("div",{className:"flex justify-center items-center",children:[r.jsx("img",{src:"/favicon-32x32.png",alt:"HandwerkOS Logo",className:"h-10 w-10 mr-4",style:{imageRendering:"-webkit-optimize-contrast"},onError:f=>{var p;f.currentTarget.style.display="none",(p=f.currentTarget.nextElementSibling)==null||p.classList.remove("hidden")}}),r.jsx("div",{className:"bg-gray-100 p-3 rounded-full mr-4 hidden",children:r.jsx(Gp,{className:"h-8 w-8 text-blue-600"})}),r.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"HandwerkOS"})]})}),r.jsx("div",{className:"flex-1 px-3 py-4 bg-white",children:r.jsxs("div",{className:"max-w-sm mx-auto",children:[r.jsxs("form",{onSubmit:m,className:"space-y-3",children:[r.jsxs("div",{className:"space-y-1",children:[r.jsx(Y,{htmlFor:"email",className:"text-gray-900 font-medium",children:"E-Mail"}),r.jsxs("div",{className:"relative",children:[r.jsx($s,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-600"}),r.jsx(ne,{id:"email",type:"email",value:t,onChange:f=>e(f.target.value),className:"pl-10 h-10 text-sm border-gray-300 bg-white text-gray-900 placeholder:text-gray-500",placeholder:"ihre.email@firma.de",disabled:o})]})]}),r.jsxs("div",{className:"space-y-1",children:[r.jsx(Y,{htmlFor:"password",className:"text-gray-900 font-medium",children:"Passwort"}),r.jsxs("div",{className:"relative",children:[r.jsx(HF,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-600"}),r.jsx(ne,{id:"password",type:a?"text":"password",value:n,onChange:f=>s(f.target.value),className:"pl-10 pr-10 h-10 text-sm border-gray-300 bg-white text-gray-900 placeholder:text-gray-500",placeholder:"Ihr Passwort",disabled:o}),r.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-600",disabled:o,children:a?r.jsx(HA,{className:"h-5 w-5"}):r.jsx(la,{className:"h-5 w-5"})})]})]}),r.jsx(J,{type:"submit",className:"w-full h-10 text-sm bg-blue-500 hover:bg-blue-600 text-white font-medium shadow-sm",disabled:o,children:o?"Anmelden...":"Anmelden"})]}),r.jsxs("div",{className:"mt-8 text-center text-sm text-gray-700",children:[r.jsx("p",{children:"Probleme beim Anmelden?"}),r.jsx("p",{className:"mt-1",children:"Wenden Sie sich an Ihren Administrator"})]})]})})]})},Rse=()=>{const[t,e]=g.useState(null);return g.useEffect(()=>{(async()=>{const{data:{session:a}}=await K.auth.getSession();e(!!a)})();const{data:{subscription:s}}=K.auth.onAuthStateChange((a,i)=>{e(!!i)});return()=>s.unsubscribe()},[]),t===null?r.jsx("div",{className:"min-h-screen bg-blue-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Lade..."})]})}):t?r.jsx(TO,{}):r.jsx(Mse,{})};class Ise extends ke.Component{constructor(n){super(n);As(this,"resetError",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,s){console.error("Error Boundary caught an error:",n,s)}render(){if(this.state.hasError){if(this.props.fallback){const n=this.props.fallback;return r.jsx(n,{error:this.state.error,resetError:this.resetError})}return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:r.jsxs(le,{className:"w-full max-w-lg",children:[r.jsxs(Ce,{className:"text-center",children:[r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx("div",{className:"p-3 rounded-full bg-red-100",children:r.jsx(kr,{className:"h-8 w-8 text-red-600"})})}),r.jsx(Ee,{className:"text-xl text-red-900",children:"Etwas ist schiefgelaufen"})]}),r.jsxs(ce,{className:"text-center space-y-4",children:[r.jsx("p",{className:"text-gray-600",children:"Es ist ein unerwarteter Fehler aufgetreten. Bitte versuchen Sie es erneut."}),this.state.error&&r.jsxs("details",{className:"text-left",children:[r.jsx("summary",{className:"cursor-pointer text-sm text-gray-500 hover:text-gray-700",children:"Technische Details anzeigen"}),r.jsx("pre",{className:"mt-2 p-3 bg-gray-100 rounded text-xs text-red-800 overflow-auto",children:this.state.error.toString()})]}),r.jsxs("div",{className:"flex gap-3 justify-center",children:[r.jsxs(J,{onClick:this.resetError,className:"flex items-center gap-2",children:[r.jsx(VA,{className:"h-4 w-4"}),"Erneut versuchen"]}),r.jsx(J,{variant:"outline",onClick:()=>window.location.reload(),children:"Seite neu laden"})]})]})]})})}return this.props.children}}const fn=new X$({defaultOptions:{queries:{retry:2,staleTime:5*60*1e3,refetchOnWindowFocus:!1}}}),Ose=()=>(g.useEffect(()=>{const t=[ot.on("CUSTOMER_CREATED",()=>{fn.invalidateQueries({queryKey:["customers"]})}),ot.on("CUSTOMER_UPDATED",()=>{fn.invalidateQueries({queryKey:["customers"]})}),ot.on("CUSTOMER_DELETED",()=>{fn.invalidateQueries({queryKey:["customers"]})}),ot.on("PROJECT_CREATED",()=>{fn.invalidateQueries({queryKey:["projects"]}),fn.invalidateQueries({queryKey:["financial-kpis"]})}),ot.on("PROJECT_UPDATED",()=>{fn.invalidateQueries({queryKey:["projects"]}),fn.invalidateQueries({queryKey:["financial-kpis"]})}),ot.on("PROJECT_STATUS_CHANGED",()=>{fn.invalidateQueries({queryKey:["projects"]}),fn.invalidateQueries({queryKey:["financial-kpis"]})}),ot.on("QUOTE_CREATED",()=>{fn.invalidateQueries({queryKey:["quotes"]})}),ot.on("QUOTE_UPDATED",()=>{fn.invalidateQueries({queryKey:["quotes"]})}),ot.on("QUOTE_ACCEPTED",()=>{fn.invalidateQueries({queryKey:["quotes"]}),fn.invalidateQueries({queryKey:["financial-kpis"]})}),ot.on("INVOICE_CREATED",()=>{fn.invalidateQueries({queryKey:["invoices"]}),fn.invalidateQueries({queryKey:["financial-kpis"]})}),ot.on("INVOICE_UPDATED",()=>{fn.invalidateQueries({queryKey:["invoices"]}),fn.invalidateQueries({queryKey:["financial-kpis"]})}),ot.on("INVOICE_PAID",()=>{fn.invalidateQueries({queryKey:["invoices"]}),fn.invalidateQueries({queryKey:["financial-kpis"]})}),ot.on("TIMESHEET_CREATED",()=>{fn.invalidateQueries({queryKey:["time-entries"]})}),ot.on("TIMESHEET_UPDATED",()=>{fn.invalidateQueries({queryKey:["time-entries"]})}),ot.on("STOCK_ADJUSTED",()=>{fn.invalidateQueries({queryKey:["materials"]}),fn.invalidateQueries({queryKey:["stock-counts"]})}),ot.on("STOCK_TRANSFER_COMPLETED",()=>{fn.invalidateQueries({queryKey:["materials"]}),fn.invalidateQueries({queryKey:["stock-transfers"]}),fn.invalidateQueries({queryKey:["stock-counts"]})})];return()=>{t.forEach(e=>ot.off(e))}},[]),null),Lse=()=>r.jsx(Ise,{children:r.jsxs(r9,{client:fn,children:[r.jsx(Ose,{}),r.jsx(BB,{children:r.jsxs(O$,{children:[r.jsx(FB,{}),r.jsx(dz,{}),r.jsx(d7,{children:r.jsxs(n7,{children:[r.jsx(Vs,{path:"/",element:r.jsx(Rse,{})}),r.jsx(Vs,{path:"/login",element:r.jsx(UC,{})}),r.jsx(Vs,{path:"/auth",element:r.jsx(UC,{})}),r.jsx(Vs,{path:"/manager",element:r.jsx(Cre,{})}),r.jsx(Vs,{path:"/employee",element:r.jsx(TO,{})}),r.jsx(Vs,{path:"/auth/callback",element:r.jsx(Yre,{})}),r.jsx(Vs,{path:"/privacy",element:r.jsx(Xre,{})}),r.jsx(Vs,{path:"/mitarbeiter-setup",element:r.jsx(ese,{})}),r.jsx(Vs,{path:"/handwerkersoftware",element:r.jsx(Tse,{})}),r.jsx(Vs,{path:"*",element:r.jsx(Jre,{})})]})})]})})]})});xA(document.getElementById("root")).render(r.jsx(Tq,{children:r.jsx(Pq,{children:r.jsx(Lse,{})})}));export{mI as W};
