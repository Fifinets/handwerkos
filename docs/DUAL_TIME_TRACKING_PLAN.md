# Dual Time Tracking Migration Plan

## IST-Analyse (Current State)

### Bestehende Tabellen
1. **`time_entries`** - Einfache Projektzeit-Erfassung
   - Felder: employee_id, project_id, start_time, end_time, break_duration, status
   - Status: 'aktiv', 'beendet', 'pausiert'

2. **`time_segments`** - Erweiterte Zeitsegmente
   - Felder: segment_type ('work', 'break', 'drive'), duration_minutes_computed
   - Features: Ãœberlappungsschutz per Trigger

3. **`timesheets`** - FÃ¼r Approval und Billing
   - Felder: date, start_time, end_time, hours, is_billable, approved_by
   - Verwendet fÃ¼r Manager Dashboard

4. **`time_rules`** - Rundungs- und Pausenregeln
   - Felder: round_to_minutes, auto_break_after_minutes

### Bestehender Flow
- **Frontend**: `useTimeTracking` Hook speichert aktive Zeit in localStorage (!)
- **Speicherung**: Erst beim Stopp wird in `timesheets` geschrieben
- **Pausen**: Manuell + automatische Mittagspause
- **Projektwechsel**: Stoppt alte Session, startet neue

### Was FEHLT fÃ¼r duales System
âŒ Kein Attendance-Konzept (Arbeitszeit unabhÃ¤ngig von Projekten)
âŒ Keine Kostenstellen (nur Projekte)
âŒ Keine Reconciliation (Abgleich Arbeitszeit vs. Projektzeiten)
âŒ Keine Wochensperren fÃ¼r Arbeitszeiten
âŒ Keine Export-Funktionen fÃ¼r Lohn vs. Projekt
âŒ Keine Deckungsgrad-Ampel

---

## SOLL-Zustand (Target State)

### Zweigleisiges Modell

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ARBEITSZEIT (Lohn)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ 08:00  â”‚â”€â”€â”€â”€â”‚  12:00  â”‚â”€â”€â”€â”€â”‚ 17:00  â”‚                â”‚
â”‚  â”‚Schicht â”‚    â”‚  Pause  â”‚    â”‚Schicht â”‚                â”‚
â”‚  â”‚ Start  â”‚    â”‚ 30 Min  â”‚    â”‚  Ende  â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PROJEKTZEITEN (Abrechnung)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚Projekt â”‚  â”‚ Fahrt  â”‚  â”‚Projekt â”‚  â”‚Werkst. â”‚        â”‚
â”‚  â”‚  A     â”‚  â”‚ 30 Min â”‚  â”‚   B    â”‚  â”‚ 60 Min â”‚        â”‚
â”‚  â”‚2,5h    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  3h    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                      â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  RECONCILIATION  â”‚
            â”‚   Deckungsgrad   â”‚
            â”‚   ğŸŸ¢ 95-105%     â”‚
            â”‚   ğŸŸ¡ 90-95%      â”‚
            â”‚   ğŸ”´ < 90%       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Migrations-Strategie

### 1. Feature Flag System

```sql
CREATE TABLE IF NOT EXISTS feature_flags (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  flag_name TEXT UNIQUE NOT NULL,
  enabled BOOLEAN DEFAULT false,
  company_id UUID REFERENCES companies(id),
  created_at TIMESTAMPTZ DEFAULT NOW()
);

INSERT INTO feature_flags (flag_name, enabled)
VALUES ('ff_dual_time_tracking', false)
ON CONFLICT (flag_name) DO NOTHING;
```

### 2. Neue Tabellen (ADDITIVE - keine Ã„nderungen an Bestehendem)

#### 2.1 Attendance (Arbeitszeit/Anwesenheit)
```sql
CREATE TABLE IF NOT EXISTS attendance (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  employee_id UUID NOT NULL REFERENCES employees(id) ON DELETE CASCADE,
  company_id UUID REFERENCES companies(id),

  -- Zeiten
  date DATE NOT NULL,
  clock_in TIMESTAMPTZ NOT NULL,
  clock_out TIMESTAMPTZ,

  -- Pausen (aggregiert)
  break_minutes INTEGER DEFAULT 0,

  -- Status
  status TEXT NOT NULL DEFAULT 'open' CHECK (status IN ('open', 'submitted', 'approved', 'locked')),

  -- GPS (optional)
  clock_in_location JSONB,
  clock_out_location JSONB,

  -- Metadaten
  note TEXT,
  autogenerated BOOLEAN DEFAULT false, -- FÃ¼r Migration alter Daten
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),

  CONSTRAINT unique_attendance_per_employee_date UNIQUE (employee_id, date)
);

CREATE INDEX idx_attendance_employee_date ON attendance(employee_id, date DESC);
CREATE INDEX idx_attendance_status ON attendance(status) WHERE status = 'open';
```

#### 2.2 Cost Centers (Kostenstellen)
```sql
CREATE TABLE IF NOT EXISTS cost_centers (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  company_id UUID REFERENCES companies(id),

  code TEXT NOT NULL, -- z.B. "FAHRT", "WERK", "SCHUL"
  name TEXT NOT NULL, -- z.B. "Fahrtzeit", "Werkstatt"
  description TEXT,

  -- Abrechnungs-Flags
  billable BOOLEAN DEFAULT false, -- Wird dem Kunden berechnet?
  payroll BOOLEAN DEFAULT true,   -- Wird als Arbeitszeit gezÃ¤hlt?

  -- Farbe fÃ¼r UI
  color TEXT DEFAULT '#gray',

  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW(),

  CONSTRAINT unique_cost_center_code UNIQUE (company_id, code)
);

-- Seed Standard-Kostenstellen
INSERT INTO cost_centers (code, name, billable, payroll, color) VALUES
  ('FAHRT', 'Fahrtzeit', true, true, '#blue'),
  ('WERKSTATT', 'Werkstatt', false, true, '#gray'),
  ('SCHULUNG', 'Schulung', false, true, '#green'),
  ('URLAUB', 'Urlaub', false, true, '#orange'),
  ('KRANK', 'Krankheit', false, false, '#red')
ON CONFLICT (company_id, code) DO NOTHING;
```

#### 2.3 Erweitere time_entries (ADDITIVE)
```sql
-- WICHTIG: Nur ADD COLUMN, keine Ã„nderungen!
ALTER TABLE time_entries
  ADD COLUMN IF NOT EXISTS type TEXT DEFAULT 'project' CHECK (type IN ('project', 'cost_center'));

ALTER TABLE time_entries
  ADD COLUMN IF NOT EXISTS cost_center_id UUID REFERENCES cost_centers(id);

ALTER TABLE time_entries
  ADD COLUMN IF NOT EXISTS billable BOOLEAN DEFAULT true;

ALTER TABLE time_entries
  ADD COLUMN IF NOT EXISTS gps_location JSONB;

ALTER TABLE time_entries
  ADD COLUMN IF NOT EXISTS status_new TEXT DEFAULT 'draft' CHECK (status_new IN ('draft', 'submitted', 'approved'));

-- Alte Daten migrieren: Leere Werte mit Defaults fÃ¼llen
UPDATE time_entries SET type = 'project' WHERE type IS NULL;
UPDATE time_entries SET billable = true WHERE billable IS NULL;
```

#### 2.4 Timesheet Locks (Wochensperren)
```sql
CREATE TABLE IF NOT EXISTS timesheet_locks (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  employee_id UUID NOT NULL REFERENCES employees(id),
  company_id UUID REFERENCES companies(id),

  week_start_date DATE NOT NULL, -- Montag der Woche
  locked_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  locked_by UUID REFERENCES employees(id),

  reason TEXT,

  CONSTRAINT unique_lock_per_employee_week UNIQUE (employee_id, week_start_date)
);
```

#### 2.5 Audit Log
```sql
CREATE TABLE IF NOT EXISTS time_audit_log (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,

  entity_type TEXT NOT NULL, -- 'attendance', 'time_entry', etc.
  entity_id UUID NOT NULL,

  action TEXT NOT NULL, -- 'created', 'updated', 'deleted', 'approved'
  old_values JSONB,
  new_values JSONB,

  changed_by UUID REFERENCES auth.users(id),
  changed_at TIMESTAMPTZ DEFAULT NOW(),
  ip_address INET,

  reason TEXT
);

CREATE INDEX idx_audit_entity ON time_audit_log(entity_type, entity_id);
CREATE INDEX idx_audit_changed_at ON time_audit_log(changed_at DESC);
```

#### 2.6 Schema Versioning
```sql
CREATE TABLE IF NOT EXISTS app_schema_version (
  version TEXT PRIMARY KEY,
  applied_at TIMESTAMPTZ DEFAULT NOW(),
  description TEXT
);

INSERT INTO app_schema_version (version, description) VALUES
  ('1.0.0-dual-time-tracking', 'Initial dual time tracking schema')
ON CONFLICT (version) DO NOTHING;
```

### 3. Reconciliation Rules
```sql
ALTER TABLE time_rules
  ADD COLUMN IF NOT EXISTS reconciliation_tolerance_percent DECIMAL(5,2) DEFAULT 5.00;

ALTER TABLE time_rules
  ADD COLUMN IF NOT EXISTS require_reconciliation BOOLEAN DEFAULT true;

ALTER TABLE time_rules
  ADD COLUMN IF NOT EXISTS min_breaks_minutes INTEGER DEFAULT 30;

ALTER TABLE time_rules
  ADD COLUMN IF NOT EXISTS overtime_daily_minutes INTEGER DEFAULT 600; -- 10h

ALTER TABLE time_rules
  ADD COLUMN IF NOT EXISTS overtime_weekly_minutes INTEGER DEFAULT 2880; -- 48h
```

---

## Backend Services (Neue Dateien)

### 1. AttendanceService
```typescript
// src/services/attendanceService.ts
export class AttendanceService {
  async clockIn(employeeId, location)
  async clockOut(employeeId, location)
  async submitWeek(employeeId, weekStart)
  async getWeekAttendance(employeeId, weekStart)
}
```

### 2. RulesEngine
```typescript
// src/services/rulesEngine.ts
export class RulesEngine {
  async validateOverlap(employeeId, start, end)
  async applyRounding(minutes, rules)
  async calculateAutoBreak(clockIn, clockOut, rules)
  async checkOvertimeLimits(employeeId, date)
}
```

### 3. ReconciliationService
```typescript
// src/services/reconciliationService.ts
export class ReconciliationService {
  async calculateCoverage(employeeId, date): Promise<{
    attendanceMinutes: number,
    projectMinutes: number,
    costCenterMinutes: number,
    breakMinutes: number,
    coveragePercent: number,
    status: 'green' | 'yellow' | 'red'
  }>

  async suggestGaps(employeeId, date)
}
```

---

## API Endpoints (BACKWARD COMPATIBLE)

### Neue Endpoints (nur bei Feature-Flag aktiv)
```
POST   /api/attendance/clock-in
POST   /api/attendance/clock-out
POST   /api/attendance/submit-week
GET    /api/attendance/week/:weekStart
POST   /api/timesheets/lock-week

GET    /api/reports/reconciliation/:employeeId/:date
GET    /api/reports/coverage/:employeeId/:week

GET    /api/export/payroll?from=X&to=Y&format=csv|datev
GET    /api/export/projects?from=X&to=Y&format=csv
```

### Alte Endpoints (bleiben unverÃ¤ndert)
```
POST   /api/time-entries       â† Weiter unterstÃ¼tzt
GET    /api/time-entries       â† Weiter unterstÃ¼tzt
PUT    /api/time-entries/:id   â† Weiter unterstÃ¼tzt
```

**KompatibilitÃ¤ts-Schicht:**
```typescript
// Wenn ff_dual_time_tracking = false
POST /api/time-entries â†’ Direkt in time_entries schreiben (alt)

// Wenn ff_dual_time_tracking = true
POST /api/time-entries â†’ Schreibe in time_entries UND prÃ¼fe Attendance
```

---

## UI Erweiterungen (ADDITIVE)

### Mobile App
1. **Neue Buttons** (nur wenn Feature-Flag aktiv):
   ```
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  [ğŸ”µ Schicht starten]               â”‚  â† NEU
   â”‚  [ğŸ”´ Schicht beenden]               â”‚  â† NEU
   â”‚                                     â”‚
   â”‚  [â–¶ï¸ Projekt buchen]   [â¸ï¸ Pause]   â”‚  â† BESTEHEND
   â”‚                                     â”‚
   â”‚  Schnellzugriff:                    â”‚
   â”‚  [ğŸš— Fahrt] [ğŸ”§ Werkstatt]          â”‚  â† NEU
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   ```

2. **Tagesbalken** (Layer-Visualisierung):
   ```
   Anwesenheit:  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ]  9h
   Pausen:       [â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]  30min
   Projekt A:    [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]  3.5h
   Fahrt:        [â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]  30min
   Werkstatt:    [â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]  2h
                 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Deckung:      ğŸŸ¡ 95% (OK)
   ```

3. **Vorlagen** (1-Tap):
   - Letztes Projekt fortsetzen
   - Fahrt zum Projekt X
   - Werkstatt-Zeit buchen

---

## Migration Alter Daten

### Skript: Backfill Attendance aus time_entries

```sql
-- Idempotent: LÃ¤uft mehrfach ohne Schaden
INSERT INTO attendance (
  employee_id,
  company_id,
  date,
  clock_in,
  clock_out,
  break_minutes,
  status,
  autogenerated,
  note
)
SELECT
  te.employee_id,
  e.company_id,
  te.start_time::date AS date,
  MIN(te.start_time) AS clock_in,
  MAX(te.end_time) AS clock_out,
  COALESCE(SUM(te.break_duration), 0) AS break_minutes,
  'submitted' AS status,
  true AS autogenerated,
  'Migrated from time_entries' AS note
FROM time_entries te
JOIN employees e ON e.id = te.employee_id
WHERE te.end_time IS NOT NULL
GROUP BY te.employee_id, e.company_id, te.start_time::date
ON CONFLICT (employee_id, date) DO NOTHING;

-- Logging
INSERT INTO time_audit_log (entity_type, action, new_values, reason)
VALUES ('attendance', 'migration',
  jsonb_build_object('records_created', (SELECT COUNT(*) FROM attendance WHERE autogenerated = true)),
  'Automatic migration from time_entries');
```

### Gap Detection
```sql
-- Finde Tage mit Attendance aber fehlenden Projektzeiten
SELECT
  a.employee_id,
  a.date,
  (EXTRACT(EPOCH FROM (a.clock_out - a.clock_in)) / 60)::int - a.break_minutes AS work_minutes,
  COALESCE(SUM(EXTRACT(EPOCH FROM (te.end_time - te.start_time)) / 60), 0)::int AS project_minutes,
  (EXTRACT(EPOCH FROM (a.clock_out - a.clock_in)) / 60)::int -
    a.break_minutes -
    COALESCE(SUM(EXTRACT(EPOCH FROM (te.end_time - te.start_time)) / 60), 0)::int AS gap_minutes
FROM attendance a
LEFT JOIN time_entries te ON te.employee_id = a.employee_id
  AND te.start_time::date = a.date
  AND te.end_time IS NOT NULL
WHERE a.clock_out IS NOT NULL
GROUP BY a.id, a.employee_id, a.date, a.clock_in, a.clock_out, a.break_minutes
HAVING (EXTRACT(EPOCH FROM (a.clock_out - a.clock_in)) / 60)::int -
         a.break_minutes -
         COALESCE(SUM(EXTRACT(EPOCH FROM (te.end_time - te.start_time)) / 60), 0)::int > 30
ORDER BY a.date DESC, gap_minutes DESC;
```

---

## Rollout-Plan

### Phase 1: Schema Migration (Woche 1)
- [ ] Feature-Flag Tabelle erstellen
- [ ] Neue Tabellen erstellen (attendance, cost_centers, etc.)
- [ ] time_entries erweitern (ADD COLUMN)
- [ ] Seed-Daten fÃ¼r cost_centers
- [ ] Schema-Version setzen

### Phase 2: Backend Services (Woche 2)
- [ ] AttendanceService implementieren
- [ ] RulesEngine implementieren
- [ ] ReconciliationService implementieren
- [ ] KompatibilitÃ¤ts-Schicht fÃ¼r alte API

### Phase 3: UI Extension (Woche 3)
- [ ] Feature-Flag Check in Frontend
- [ ] Neue Buttons (Schicht start/stop)
- [ ] Tagesbalken-Visualisierung
- [ ] 1-Tap Vorlagen
- [ ] Offline-Queue erweitern

### Phase 4: Migration & Testing (Woche 4)
- [ ] Backfill-Skript testen (Dry-Run)
- [ ] Backfill-Skript ausfÃ¼hren
- [ ] Reconciliation testen
- [ ] E2E Tests
- [ ] Feature-Flag aktivieren (opt-in fÃ¼r Beta-User)

---

## Tests

### Unit Tests
```typescript
// src/services/__tests__/rulesEngine.test.ts
test('should prevent overlapping time entries', async () => {
  // ...
})

test('should calculate auto-break correctly', async () => {
  // ...
})

test('should apply rounding rules', async () => {
  // ...
})
```

### API Tests
```typescript
// Old client without 'type' field
POST /api/time-entries { project_id: 'X', start_time: '...' }
â†’ Should implicitly set type='project'

// New client with 'type' field
POST /api/time-entries { type: 'cost_center', cost_center_id: 'Y', ... }
â†’ Should work correctly
```

### E2E Tests
```typescript
test('Offline â†’ Sync with locked week should handle conflict', async () => {
  // ...
})

test('Double-tap Start should not create duplicate entries', async () => {
  // ...
})
```

---

## Abnahmekriterien

âœ… **BC-1**: Alte Projektzeit-Erfassung funktioniert unverÃ¤ndert (ff_dual_time_tracking=false)
âœ… **BC-2**: Keine Breaking Changes an bestehenden API-Endpoints
âœ… **BC-3**: Bestehende time_entries Daten bleiben intakt

âœ… **FT-1**: Mitarbeiter kann in â‰¤3 Taps: Schicht starten â†’ Projekt buchen â†’ wechseln
âœ… **FT-2**: Deckungsgrad-Ampel zeigt korrekte Werte (grÃ¼n/gelb/rot)
âœ… **FT-3**: Keine ZeitÃ¼berlappungen mÃ¶glich
âœ… **FT-4**: Lohn- und Projekt-Exporte liefern konsistente Summen
âœ… **FT-5**: Gesperrte Wochen sind unverÃ¤nderlich

âœ… **MIG-1**: Backfill-Skript ist idempotent
âœ… **MIG-2**: Vorher/Nachher Summen-PrÃ¼fung erfolgreich
âœ… **MIG-3**: Rollback mÃ¶glich ohne Datenverlust

---

## Dokumentation

### README_zeiterfassung.md
- Flows (Schicht vs. Projekt)
- Endpunkte
- Feature-Flag Aktivierung

### UPGRADE.md
- Migrationsschritte
- Rollback-Prozedur
- Feature-Flag Toggle

### DEPRECATIONS.md
- Alte Endpunkte + Sunset-Datum (falls geplant)
- Breaking Changes (keine geplant!)

### samples/
- sample_payroll_export.csv
- sample_project_export.csv
- sample_datev_export.csv

---

## Changelog

### v1.0.0-dual-time-tracking (YYYY-MM-DD)
**Added**
- âœ¨ Dual time tracking system (Arbeitszeit + Projektzeiten)
- âœ¨ Attendance table for clock-in/out tracking
- âœ¨ Cost centers for non-project time
- âœ¨ Reconciliation engine with coverage calculation
- âœ¨ Week-level timesheet locks
- âœ¨ Audit log for all time changes
- âœ¨ Payroll vs. Project export functions

**Changed**
- ğŸ”§ Extended `time_entries` with `type`, `cost_center_id`, `billable` (backward compatible)
- ğŸ”§ Mobile UI: Added attendance controls (only visible with feature flag)

**Fixed**
- ğŸ› Auto-break calculation now considers manual breaks

**Deprecated**
- (None - full backward compatibility maintained)
