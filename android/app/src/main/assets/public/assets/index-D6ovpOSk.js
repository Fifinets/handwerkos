var WR=Object.defineProperty;var Aj=t=>{throw TypeError(t)};var HR=(t,e,n)=>e in t?WR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var En=(t,e,n)=>HR(t,typeof e!="symbol"?e+"":e,n),vp=(t,e,n)=>e.has(t)||Aj("Cannot "+n);var ee=(t,e,n)=>(vp(t,e,"read from private field"),n?n.call(t):e.get(t)),Ye=(t,e,n)=>e.has(t)?Aj("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),De=(t,e,n,s)=>(vp(t,e,"write to private field"),s?s.call(t,n):e.set(t,n),n),jt=(t,e,n)=>(vp(t,e,"access private method"),n);var Nh=(t,e,n,s)=>({set _(a){De(t,e,a,n)},get _(){return ee(t,e,s)}});function VR(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in t)){const i=Object.getOwnPropertyDescriptor(s,a);i&&Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Y2(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function J2(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var a=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:function(){return t[s]}})}),n}var X2={exports:{}},a0={},eS={exports:{}},Ct={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hu=Symbol.for("react.element"),KR=Symbol.for("react.portal"),GR=Symbol.for("react.fragment"),ZR=Symbol.for("react.strict_mode"),QR=Symbol.for("react.profiler"),YR=Symbol.for("react.provider"),JR=Symbol.for("react.context"),XR=Symbol.for("react.forward_ref"),e5=Symbol.for("react.suspense"),t5=Symbol.for("react.memo"),n5=Symbol.for("react.lazy"),Dj=Symbol.iterator;function r5(t){return t===null||typeof t!="object"?null:(t=Dj&&t[Dj]||t["@@iterator"],typeof t=="function"?t:null)}var tS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nS=Object.assign,rS={};function Ac(t,e,n){this.props=t,this.context=e,this.refs=rS,this.updater=n||tS}Ac.prototype.isReactComponent={};Ac.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ac.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function sS(){}sS.prototype=Ac.prototype;function Ty(t,e,n){this.props=t,this.context=e,this.refs=rS,this.updater=n||tS}var Ry=Ty.prototype=new sS;Ry.constructor=Ty;nS(Ry,Ac.prototype);Ry.isPureReactComponent=!0;var Pj=Array.isArray,aS=Object.prototype.hasOwnProperty,My={current:null},iS={key:!0,ref:!0,__self:!0,__source:!0};function oS(t,e,n){var s,a={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)aS.call(e,s)&&!iS.hasOwnProperty(s)&&(a[s]=e[s]);var l=arguments.length-2;if(l===1)a.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(t&&t.defaultProps)for(s in l=t.defaultProps,l)a[s]===void 0&&(a[s]=l[s]);return{$$typeof:Hu,type:t,key:i,ref:o,props:a,_owner:My.current}}function s5(t,e){return{$$typeof:Hu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Iy(t){return typeof t=="object"&&t!==null&&t.$$typeof===Hu}function a5(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Tj=/\/+/g;function yp(t,e){return typeof t=="object"&&t!==null&&t.key!=null?a5(""+t.key):e.toString(36)}function xm(t,e,n,s,a){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Hu:case KR:o=!0}}if(o)return o=t,a=a(o),t=s===""?"."+yp(o,0):s,Pj(a)?(n="",t!=null&&(n=t.replace(Tj,"$&/")+"/"),xm(a,e,n,"",function(d){return d})):a!=null&&(Iy(a)&&(a=s5(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(Tj,"$&/")+"/")+t)),e.push(a)),1;if(o=0,s=s===""?".":s+":",Pj(t))for(var l=0;l<t.length;l++){i=t[l];var c=s+yp(i,l);o+=xm(i,e,n,c,a)}else if(c=r5(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=s+yp(i,l++),o+=xm(i,e,n,c,a);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Sh(t,e,n){if(t==null)return t;var s=[],a=0;return xm(t,s,"","",function(i){return e.call(n,i,a++)}),s}function i5(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ur={current:null},gm={transition:null},o5={ReactCurrentDispatcher:ur,ReactCurrentBatchConfig:gm,ReactCurrentOwner:My};function lS(){throw Error("act(...) is not supported in production builds of React.")}Ct.Children={map:Sh,forEach:function(t,e,n){Sh(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Sh(t,function(){e++}),e},toArray:function(t){return Sh(t,function(e){return e})||[]},only:function(t){if(!Iy(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ct.Component=Ac;Ct.Fragment=GR;Ct.Profiler=QR;Ct.PureComponent=Ty;Ct.StrictMode=ZR;Ct.Suspense=e5;Ct.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o5;Ct.act=lS;Ct.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=nS({},t.props),a=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=My.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)aS.call(e,c)&&!iS.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:Hu,type:t.type,key:a,ref:i,props:s,_owner:o}};Ct.createContext=function(t){return t={$$typeof:JR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:YR,_context:t},t.Consumer=t};Ct.createElement=oS;Ct.createFactory=function(t){var e=oS.bind(null,t);return e.type=t,e};Ct.createRef=function(){return{current:null}};Ct.forwardRef=function(t){return{$$typeof:XR,render:t}};Ct.isValidElement=Iy;Ct.lazy=function(t){return{$$typeof:n5,_payload:{_status:-1,_result:t},_init:i5}};Ct.memo=function(t,e){return{$$typeof:t5,type:t,compare:e===void 0?null:e}};Ct.startTransition=function(t){var e=gm.transition;gm.transition={};try{t()}finally{gm.transition=e}};Ct.unstable_act=lS;Ct.useCallback=function(t,e){return ur.current.useCallback(t,e)};Ct.useContext=function(t){return ur.current.useContext(t)};Ct.useDebugValue=function(){};Ct.useDeferredValue=function(t){return ur.current.useDeferredValue(t)};Ct.useEffect=function(t,e){return ur.current.useEffect(t,e)};Ct.useId=function(){return ur.current.useId()};Ct.useImperativeHandle=function(t,e,n){return ur.current.useImperativeHandle(t,e,n)};Ct.useInsertionEffect=function(t,e){return ur.current.useInsertionEffect(t,e)};Ct.useLayoutEffect=function(t,e){return ur.current.useLayoutEffect(t,e)};Ct.useMemo=function(t,e){return ur.current.useMemo(t,e)};Ct.useReducer=function(t,e,n){return ur.current.useReducer(t,e,n)};Ct.useRef=function(t){return ur.current.useRef(t)};Ct.useState=function(t){return ur.current.useState(t)};Ct.useSyncExternalStore=function(t,e,n){return ur.current.useSyncExternalStore(t,e,n)};Ct.useTransition=function(){return ur.current.useTransition()};Ct.version="18.3.1";eS.exports=Ct;var f=eS.exports;const ge=Y2(f),cS=VR({__proto__:null,default:ge},[f]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l5=f,c5=Symbol.for("react.element"),d5=Symbol.for("react.fragment"),u5=Object.prototype.hasOwnProperty,h5=l5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m5={key:!0,ref:!0,__self:!0,__source:!0};function dS(t,e,n){var s,a={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)u5.call(e,s)&&!m5.hasOwnProperty(s)&&(a[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)a[s]===void 0&&(a[s]=e[s]);return{$$typeof:c5,type:t,key:i,ref:o,props:a,_owner:h5.current}}a0.Fragment=d5;a0.jsx=dS;a0.jsxs=dS;X2.exports=a0;var r=X2.exports,uS={exports:{}},Kr={},hS={exports:{}},mS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,F){var B=O.length;O.push(F);e:for(;0<B;){var R=B-1>>>1,D=O[R];if(0<a(D,F))O[R]=F,O[B]=D,B=R;else break e}}function n(O){return O.length===0?null:O[0]}function s(O){if(O.length===0)return null;var F=O[0],B=O.pop();if(B!==F){O[0]=B;e:for(var R=0,D=O.length,L=D>>>1;R<L;){var M=2*(R+1)-1,X=O[M],K=M+1,z=O[K];if(0>a(X,B))K<D&&0>a(z,X)?(O[R]=z,O[K]=B,R=K):(O[R]=X,O[M]=B,R=M);else if(K<D&&0>a(z,B))O[R]=z,O[K]=B,R=K;else break e}}return F}function a(O,F){var B=O.sortIndex-F.sortIndex;return B!==0?B:O.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,m=3,p=!1,b=!1,x=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(O){for(var F=n(d);F!==null;){if(F.callback===null)s(d);else if(F.startTime<=O)s(d),F.sortIndex=F.expirationTime,e(c,F);else break;F=n(d)}}function j(O){if(x=!1,w(O),!b)if(n(c)!==null)b=!0,se(S);else{var F=n(d);F!==null&&q(j,F.startTime-O)}}function S(O,F){b=!1,x&&(x=!1,y(E),E=-1),p=!0;var B=m;try{for(w(F),h=n(c);h!==null&&(!(h.expirationTime>F)||O&&!C());){var R=h.callback;if(typeof R=="function"){h.callback=null,m=h.priorityLevel;var D=R(h.expirationTime<=F);F=t.unstable_now(),typeof D=="function"?h.callback=D:h===n(c)&&s(c),w(F)}else s(c);h=n(c)}if(h!==null)var L=!0;else{var M=n(d);M!==null&&q(j,M.startTime-F),L=!1}return L}finally{h=null,m=B,p=!1}}var N=!1,k=null,E=-1,P=5,A=-1;function C(){return!(t.unstable_now()-A<P)}function T(){if(k!==null){var O=t.unstable_now();A=O;var F=!0;try{F=k(!0,O)}finally{F?I():(N=!1,k=null)}}else N=!1}var I;if(typeof v=="function")I=function(){v(T)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,ne=V.port2;V.port1.onmessage=T,I=function(){ne.postMessage(null)}}else I=function(){g(T,0)};function se(O){k=O,N||(N=!0,I())}function q(O,F){E=g(function(){O(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){b||p||(b=!0,se(S))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(O){switch(m){case 1:case 2:case 3:var F=3;break;default:F=m}var B=m;m=F;try{return O()}finally{m=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,F){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var B=m;m=O;try{return F()}finally{m=B}},t.unstable_scheduleCallback=function(O,F,B){var R=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?R+B:R):B=R,O){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=B+D,O={id:u++,callback:F,priorityLevel:O,startTime:B,expirationTime:D,sortIndex:-1},B>R?(O.sortIndex=B,e(d,O),n(c)===null&&O===n(d)&&(x?(y(E),E=-1):x=!0,q(j,B-R))):(O.sortIndex=D,e(c,O),b||p||(b=!0,se(S))),O},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(O){var F=m;return function(){var B=m;m=F;try{return O.apply(this,arguments)}finally{m=B}}}})(mS);hS.exports=mS;var f5=hS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p5=f,qr=f5;function ve(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fS=new Set,Yd={};function Ho(t,e){uc(t,e),uc(t+"Capture",e)}function uc(t,e){for(Yd[t]=e,t=0;t<e.length;t++)fS.add(e[t])}var Pa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vg=Object.prototype.hasOwnProperty,x5=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Rj={},Mj={};function g5(t){return vg.call(Mj,t)?!0:vg.call(Rj,t)?!1:x5.test(t)?Mj[t]=!0:(Rj[t]=!0,!1)}function v5(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function y5(t,e,n,s){if(e===null||typeof e>"u"||v5(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function hr(t,e,n,s,a,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Wn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Wn[t]=new hr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Wn[e]=new hr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Wn[t]=new hr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Wn[t]=new hr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Wn[t]=new hr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Wn[t]=new hr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Wn[t]=new hr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Wn[t]=new hr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Wn[t]=new hr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Oy=/[\-:]([a-z])/g;function Fy(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Oy,Fy);Wn[e]=new hr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Oy,Fy);Wn[e]=new hr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Oy,Fy);Wn[e]=new hr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Wn[t]=new hr(t,1,!1,t.toLowerCase(),null,!1,!1)});Wn.xlinkHref=new hr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Wn[t]=new hr(t,1,!1,t.toLowerCase(),null,!0,!0)});function By(t,e,n,s){var a=Wn.hasOwnProperty(e)?Wn[e]:null;(a!==null?a.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(y5(e,n,a,s)&&(n=null),s||a===null?g5(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,s=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var $a=p5.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,kh=Symbol.for("react.element"),_l=Symbol.for("react.portal"),Nl=Symbol.for("react.fragment"),Ly=Symbol.for("react.strict_mode"),yg=Symbol.for("react.profiler"),pS=Symbol.for("react.provider"),xS=Symbol.for("react.context"),$y=Symbol.for("react.forward_ref"),bg=Symbol.for("react.suspense"),wg=Symbol.for("react.suspense_list"),zy=Symbol.for("react.memo"),ni=Symbol.for("react.lazy"),gS=Symbol.for("react.offscreen"),Ij=Symbol.iterator;function Zc(t){return t===null||typeof t!="object"?null:(t=Ij&&t[Ij]||t["@@iterator"],typeof t=="function"?t:null)}var ln=Object.assign,bp;function cd(t){if(bp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);bp=e&&e[1]||""}return`
`+bp+t}var wp=!1;function jp(t,e){if(!t||wp)return"";wp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){s=d}t.call(e.prototype)}else{try{throw Error()}catch(d){s=d}t()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),i=s.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var c=`
`+a[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{wp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?cd(t):""}function b5(t){switch(t.tag){case 5:return cd(t.type);case 16:return cd("Lazy");case 13:return cd("Suspense");case 19:return cd("SuspenseList");case 0:case 2:case 15:return t=jp(t.type,!1),t;case 11:return t=jp(t.type.render,!1),t;case 1:return t=jp(t.type,!0),t;default:return""}}function jg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Nl:return"Fragment";case _l:return"Portal";case yg:return"Profiler";case Ly:return"StrictMode";case bg:return"Suspense";case wg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case xS:return(t.displayName||"Context")+".Consumer";case pS:return(t._context.displayName||"Context")+".Provider";case $y:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case zy:return e=t.displayName||null,e!==null?e:jg(t.type)||"Memo";case ni:e=t._payload,t=t._init;try{return jg(t(e))}catch{}}return null}function w5(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return jg(e);case 8:return e===Ly?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ii(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function vS(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function j5(t){var e=vS(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ch(t){t._valueTracker||(t._valueTracker=j5(t))}function yS(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=vS(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Km(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function _g(t,e){var n=e.checked;return ln({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Oj(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Ii(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function bS(t,e){e=e.checked,e!=null&&By(t,"checked",e,!1)}function Ng(t,e){bS(t,e);var n=Ii(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Sg(t,e.type,n):e.hasOwnProperty("defaultValue")&&Sg(t,e.type,Ii(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Fj(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Sg(t,e,n){(e!=="number"||Km(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var dd=Array.isArray;function Ll(t,e,n,s){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Ii(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,s&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function kg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ve(91));return ln({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Bj(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ve(92));if(dd(n)){if(1<n.length)throw Error(ve(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ii(n)}}function wS(t,e){var n=Ii(e.value),s=Ii(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function Lj(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function jS(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?jS(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Eh,_S=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Eh=Eh||document.createElement("div"),Eh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Eh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Jd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ad={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_5=["Webkit","ms","Moz","O"];Object.keys(Ad).forEach(function(t){_5.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ad[e]=Ad[t]})});function NS(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ad.hasOwnProperty(t)&&Ad[t]?(""+e).trim():e+"px"}function SS(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,a=NS(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,a):t[n]=a}}var N5=ln({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Eg(t,e){if(e){if(N5[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ve(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ve(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ve(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ve(62))}}function Ag(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dg=null;function Uy(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Pg=null,$l=null,zl=null;function $j(t){if(t=Gu(t)){if(typeof Pg!="function")throw Error(ve(280));var e=t.stateNode;e&&(e=d0(e),Pg(t.stateNode,t.type,e))}}function kS(t){$l?zl?zl.push(t):zl=[t]:$l=t}function CS(){if($l){var t=$l,e=zl;if(zl=$l=null,$j(t),e)for(t=0;t<e.length;t++)$j(e[t])}}function ES(t,e){return t(e)}function AS(){}var _p=!1;function DS(t,e,n){if(_p)return t(e,n);_p=!0;try{return ES(t,e,n)}finally{_p=!1,($l!==null||zl!==null)&&(AS(),CS())}}function Xd(t,e){var n=t.stateNode;if(n===null)return null;var s=d0(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ve(231,e,typeof n));return n}var Tg=!1;if(Pa)try{var Qc={};Object.defineProperty(Qc,"passive",{get:function(){Tg=!0}}),window.addEventListener("test",Qc,Qc),window.removeEventListener("test",Qc,Qc)}catch{Tg=!1}function S5(t,e,n,s,a,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(u){this.onError(u)}}var Dd=!1,Gm=null,Zm=!1,Rg=null,k5={onError:function(t){Dd=!0,Gm=t}};function C5(t,e,n,s,a,i,o,l,c){Dd=!1,Gm=null,S5.apply(k5,arguments)}function E5(t,e,n,s,a,i,o,l,c){if(C5.apply(this,arguments),Dd){if(Dd){var d=Gm;Dd=!1,Gm=null}else throw Error(ve(198));Zm||(Zm=!0,Rg=d)}}function Vo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function PS(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function zj(t){if(Vo(t)!==t)throw Error(ve(188))}function A5(t){var e=t.alternate;if(!e){if(e=Vo(t),e===null)throw Error(ve(188));return e!==t?null:t}for(var n=t,s=e;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(s=a.return,s!==null){n=s;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return zj(a),t;if(i===s)return zj(a),e;i=i.sibling}throw Error(ve(188))}if(n.return!==s.return)n=a,s=i;else{for(var o=!1,l=a.child;l;){if(l===n){o=!0,n=a,s=i;break}if(l===s){o=!0,s=a,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,s=a;break}if(l===s){o=!0,s=i,n=a;break}l=l.sibling}if(!o)throw Error(ve(189))}}if(n.alternate!==s)throw Error(ve(190))}if(n.tag!==3)throw Error(ve(188));return n.stateNode.current===n?t:e}function TS(t){return t=A5(t),t!==null?RS(t):null}function RS(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=RS(t);if(e!==null)return e;t=t.sibling}return null}var MS=qr.unstable_scheduleCallback,Uj=qr.unstable_cancelCallback,D5=qr.unstable_shouldYield,P5=qr.unstable_requestPaint,hn=qr.unstable_now,T5=qr.unstable_getCurrentPriorityLevel,qy=qr.unstable_ImmediatePriority,IS=qr.unstable_UserBlockingPriority,Qm=qr.unstable_NormalPriority,R5=qr.unstable_LowPriority,OS=qr.unstable_IdlePriority,i0=null,ea=null;function M5(t){if(ea&&typeof ea.onCommitFiberRoot=="function")try{ea.onCommitFiberRoot(i0,t,void 0,(t.current.flags&128)===128)}catch{}}var _s=Math.clz32?Math.clz32:F5,I5=Math.log,O5=Math.LN2;function F5(t){return t>>>=0,t===0?32:31-(I5(t)/O5|0)|0}var Ah=64,Dh=4194304;function ud(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ym(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,a=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~a;l!==0?s=ud(l):(i&=o,i!==0&&(s=ud(i)))}else o=n&~a,o!==0?s=ud(o):i!==0&&(s=ud(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&a)&&(a=s&-s,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-_s(e),a=1<<n,s|=t[n],e&=~a;return s}function B5(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function L5(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-_s(i),l=1<<o,c=a[o];c===-1?(!(l&n)||l&s)&&(a[o]=B5(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function Mg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function FS(){var t=Ah;return Ah<<=1,!(Ah&4194240)&&(Ah=64),t}function Np(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-_s(e),t[e]=n}function $5(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-_s(n),i=1<<a;e[a]=0,s[a]=-1,t[a]=-1,n&=~i}}function Wy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-_s(n),a=1<<s;a&e|t[s]&e&&(t[s]|=e),n&=~a}}var Vt=0;function BS(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var LS,Hy,$S,zS,US,Ig=!1,Ph=[],Si=null,ki=null,Ci=null,eu=new Map,tu=new Map,ii=[],z5="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qj(t,e){switch(t){case"focusin":case"focusout":Si=null;break;case"dragenter":case"dragleave":ki=null;break;case"mouseover":case"mouseout":Ci=null;break;case"pointerover":case"pointerout":eu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":tu.delete(e.pointerId)}}function Yc(t,e,n,s,a,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[a]},e!==null&&(e=Gu(e),e!==null&&Hy(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function U5(t,e,n,s,a){switch(e){case"focusin":return Si=Yc(Si,t,e,n,s,a),!0;case"dragenter":return ki=Yc(ki,t,e,n,s,a),!0;case"mouseover":return Ci=Yc(Ci,t,e,n,s,a),!0;case"pointerover":var i=a.pointerId;return eu.set(i,Yc(eu.get(i)||null,t,e,n,s,a)),!0;case"gotpointercapture":return i=a.pointerId,tu.set(i,Yc(tu.get(i)||null,t,e,n,s,a)),!0}return!1}function qS(t){var e=mo(t.target);if(e!==null){var n=Vo(e);if(n!==null){if(e=n.tag,e===13){if(e=PS(n),e!==null){t.blockedOn=e,US(t.priority,function(){$S(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function vm(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Og(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Dg=s,n.target.dispatchEvent(s),Dg=null}else return e=Gu(n),e!==null&&Hy(e),t.blockedOn=n,!1;e.shift()}return!0}function Wj(t,e,n){vm(t)&&n.delete(e)}function q5(){Ig=!1,Si!==null&&vm(Si)&&(Si=null),ki!==null&&vm(ki)&&(ki=null),Ci!==null&&vm(Ci)&&(Ci=null),eu.forEach(Wj),tu.forEach(Wj)}function Jc(t,e){t.blockedOn===e&&(t.blockedOn=null,Ig||(Ig=!0,qr.unstable_scheduleCallback(qr.unstable_NormalPriority,q5)))}function nu(t){function e(a){return Jc(a,t)}if(0<Ph.length){Jc(Ph[0],t);for(var n=1;n<Ph.length;n++){var s=Ph[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Si!==null&&Jc(Si,t),ki!==null&&Jc(ki,t),Ci!==null&&Jc(Ci,t),eu.forEach(e),tu.forEach(e),n=0;n<ii.length;n++)s=ii[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<ii.length&&(n=ii[0],n.blockedOn===null);)qS(n),n.blockedOn===null&&ii.shift()}var Ul=$a.ReactCurrentBatchConfig,Jm=!0;function W5(t,e,n,s){var a=Vt,i=Ul.transition;Ul.transition=null;try{Vt=1,Vy(t,e,n,s)}finally{Vt=a,Ul.transition=i}}function H5(t,e,n,s){var a=Vt,i=Ul.transition;Ul.transition=null;try{Vt=4,Vy(t,e,n,s)}finally{Vt=a,Ul.transition=i}}function Vy(t,e,n,s){if(Jm){var a=Og(t,e,n,s);if(a===null)Mp(t,e,s,Xm,n),qj(t,s);else if(U5(a,t,e,n,s))s.stopPropagation();else if(qj(t,s),e&4&&-1<z5.indexOf(t)){for(;a!==null;){var i=Gu(a);if(i!==null&&LS(i),i=Og(t,e,n,s),i===null&&Mp(t,e,s,Xm,n),i===a)break;a=i}a!==null&&s.stopPropagation()}else Mp(t,e,s,null,n)}}var Xm=null;function Og(t,e,n,s){if(Xm=null,t=Uy(s),t=mo(t),t!==null)if(e=Vo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=PS(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Xm=t,null}function WS(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(T5()){case qy:return 1;case IS:return 4;case Qm:case R5:return 16;case OS:return 536870912;default:return 16}default:return 16}}var yi=null,Ky=null,ym=null;function HS(){if(ym)return ym;var t,e=Ky,n=e.length,s,a="value"in yi?yi.value:yi.textContent,i=a.length;for(t=0;t<n&&e[t]===a[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===a[i-s];s++);return ym=a.slice(t,1<s?1-s:void 0)}function bm(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Th(){return!0}function Hj(){return!1}function Gr(t){function e(n,s,a,i,o){this._reactName=n,this._targetInst=a,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Th:Hj,this.isPropagationStopped=Hj,this}return ln(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Th)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Th)},persist:function(){},isPersistent:Th}),e}var Dc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gy=Gr(Dc),Ku=ln({},Dc,{view:0,detail:0}),V5=Gr(Ku),Sp,kp,Xc,o0=ln({},Ku,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zy,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Xc&&(Xc&&t.type==="mousemove"?(Sp=t.screenX-Xc.screenX,kp=t.screenY-Xc.screenY):kp=Sp=0,Xc=t),Sp)},movementY:function(t){return"movementY"in t?t.movementY:kp}}),Vj=Gr(o0),K5=ln({},o0,{dataTransfer:0}),G5=Gr(K5),Z5=ln({},Ku,{relatedTarget:0}),Cp=Gr(Z5),Q5=ln({},Dc,{animationName:0,elapsedTime:0,pseudoElement:0}),Y5=Gr(Q5),J5=ln({},Dc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),X5=Gr(J5),e6=ln({},Dc,{data:0}),Kj=Gr(e6),t6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},n6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},r6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function s6(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=r6[t])?!!e[t]:!1}function Zy(){return s6}var a6=ln({},Ku,{key:function(t){if(t.key){var e=t6[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=bm(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?n6[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zy,charCode:function(t){return t.type==="keypress"?bm(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?bm(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),i6=Gr(a6),o6=ln({},o0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gj=Gr(o6),l6=ln({},Ku,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zy}),c6=Gr(l6),d6=ln({},Dc,{propertyName:0,elapsedTime:0,pseudoElement:0}),u6=Gr(d6),h6=ln({},o0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),m6=Gr(h6),f6=[9,13,27,32],Qy=Pa&&"CompositionEvent"in window,Pd=null;Pa&&"documentMode"in document&&(Pd=document.documentMode);var p6=Pa&&"TextEvent"in window&&!Pd,VS=Pa&&(!Qy||Pd&&8<Pd&&11>=Pd),Zj=" ",Qj=!1;function KS(t,e){switch(t){case"keyup":return f6.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function GS(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Sl=!1;function x6(t,e){switch(t){case"compositionend":return GS(e);case"keypress":return e.which!==32?null:(Qj=!0,Zj);case"textInput":return t=e.data,t===Zj&&Qj?null:t;default:return null}}function g6(t,e){if(Sl)return t==="compositionend"||!Qy&&KS(t,e)?(t=HS(),ym=Ky=yi=null,Sl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return VS&&e.locale!=="ko"?null:e.data;default:return null}}var v6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yj(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!v6[t.type]:e==="textarea"}function ZS(t,e,n,s){kS(s),e=ef(e,"onChange"),0<e.length&&(n=new Gy("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Td=null,ru=null;function y6(t){ik(t,0)}function l0(t){var e=El(t);if(yS(e))return t}function b6(t,e){if(t==="change")return e}var QS=!1;if(Pa){var Ep;if(Pa){var Ap="oninput"in document;if(!Ap){var Jj=document.createElement("div");Jj.setAttribute("oninput","return;"),Ap=typeof Jj.oninput=="function"}Ep=Ap}else Ep=!1;QS=Ep&&(!document.documentMode||9<document.documentMode)}function Xj(){Td&&(Td.detachEvent("onpropertychange",YS),ru=Td=null)}function YS(t){if(t.propertyName==="value"&&l0(ru)){var e=[];ZS(e,ru,t,Uy(t)),DS(y6,e)}}function w6(t,e,n){t==="focusin"?(Xj(),Td=e,ru=n,Td.attachEvent("onpropertychange",YS)):t==="focusout"&&Xj()}function j6(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return l0(ru)}function _6(t,e){if(t==="click")return l0(e)}function N6(t,e){if(t==="input"||t==="change")return l0(e)}function S6(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Es=typeof Object.is=="function"?Object.is:S6;function su(t,e){if(Es(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var a=n[s];if(!vg.call(e,a)||!Es(t[a],e[a]))return!1}return!0}function e_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function t_(t,e){var n=e_(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=e_(n)}}function JS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?JS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function XS(){for(var t=window,e=Km();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Km(t.document)}return e}function Yy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function k6(t){var e=XS(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&JS(n.ownerDocument.documentElement,n)){if(s!==null&&Yy(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,i=Math.min(s.start,a);s=s.end===void 0?i:Math.min(s.end,a),!t.extend&&i>s&&(a=s,s=i,i=a),a=t_(n,i);var o=t_(n,s);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var C6=Pa&&"documentMode"in document&&11>=document.documentMode,kl=null,Fg=null,Rd=null,Bg=!1;function n_(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Bg||kl==null||kl!==Km(s)||(s=kl,"selectionStart"in s&&Yy(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Rd&&su(Rd,s)||(Rd=s,s=ef(Fg,"onSelect"),0<s.length&&(e=new Gy("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=kl)))}function Rh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Cl={animationend:Rh("Animation","AnimationEnd"),animationiteration:Rh("Animation","AnimationIteration"),animationstart:Rh("Animation","AnimationStart"),transitionend:Rh("Transition","TransitionEnd")},Dp={},ek={};Pa&&(ek=document.createElement("div").style,"AnimationEvent"in window||(delete Cl.animationend.animation,delete Cl.animationiteration.animation,delete Cl.animationstart.animation),"TransitionEvent"in window||delete Cl.transitionend.transition);function c0(t){if(Dp[t])return Dp[t];if(!Cl[t])return t;var e=Cl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in ek)return Dp[t]=e[n];return t}var tk=c0("animationend"),nk=c0("animationiteration"),rk=c0("animationstart"),sk=c0("transitionend"),ak=new Map,r_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ki(t,e){ak.set(t,e),Ho(e,[t])}for(var Pp=0;Pp<r_.length;Pp++){var Tp=r_[Pp],E6=Tp.toLowerCase(),A6=Tp[0].toUpperCase()+Tp.slice(1);Ki(E6,"on"+A6)}Ki(tk,"onAnimationEnd");Ki(nk,"onAnimationIteration");Ki(rk,"onAnimationStart");Ki("dblclick","onDoubleClick");Ki("focusin","onFocus");Ki("focusout","onBlur");Ki(sk,"onTransitionEnd");uc("onMouseEnter",["mouseout","mouseover"]);uc("onMouseLeave",["mouseout","mouseover"]);uc("onPointerEnter",["pointerout","pointerover"]);uc("onPointerLeave",["pointerout","pointerover"]);Ho("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ho("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ho("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ho("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ho("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ho("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D6=new Set("cancel close invalid load scroll toggle".split(" ").concat(hd));function s_(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,E5(s,e,void 0,t),t.currentTarget=null}function ik(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],a=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var l=s[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&a.isPropagationStopped())break e;s_(a,l,d),i=c}else for(o=0;o<s.length;o++){if(l=s[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&a.isPropagationStopped())break e;s_(a,l,d),i=c}}}if(Zm)throw t=Rg,Zm=!1,Rg=null,t}function Jt(t,e){var n=e[qg];n===void 0&&(n=e[qg]=new Set);var s=t+"__bubble";n.has(s)||(ok(e,t,2,!1),n.add(s))}function Rp(t,e,n){var s=0;e&&(s|=4),ok(n,t,s,e)}var Mh="_reactListening"+Math.random().toString(36).slice(2);function au(t){if(!t[Mh]){t[Mh]=!0,fS.forEach(function(n){n!=="selectionchange"&&(D6.has(n)||Rp(n,!1,t),Rp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Mh]||(e[Mh]=!0,Rp("selectionchange",!1,e))}}function ok(t,e,n,s){switch(WS(e)){case 1:var a=W5;break;case 4:a=H5;break;default:a=Vy}n=a.bind(null,e,n,t),a=void 0,!Tg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),s?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function Mp(t,e,n,s,a){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var l=s.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=mo(l),o===null)return;if(c=o.tag,c===5||c===6){s=i=o;continue e}l=l.parentNode}}s=s.return}DS(function(){var d=i,u=Uy(n),h=[];e:{var m=ak.get(t);if(m!==void 0){var p=Gy,b=t;switch(t){case"keypress":if(bm(n)===0)break e;case"keydown":case"keyup":p=i6;break;case"focusin":b="focus",p=Cp;break;case"focusout":b="blur",p=Cp;break;case"beforeblur":case"afterblur":p=Cp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Vj;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=G5;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=c6;break;case tk:case nk:case rk:p=Y5;break;case sk:p=u6;break;case"scroll":p=V5;break;case"wheel":p=m6;break;case"copy":case"cut":case"paste":p=X5;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Gj}var x=(e&4)!==0,g=!x&&t==="scroll",y=x?m!==null?m+"Capture":null:m;x=[];for(var v=d,w;v!==null;){w=v;var j=w.stateNode;if(w.tag===5&&j!==null&&(w=j,y!==null&&(j=Xd(v,y),j!=null&&x.push(iu(v,j,w)))),g)break;v=v.return}0<x.length&&(m=new p(m,b,null,n,u),h.push({event:m,listeners:x}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",m&&n!==Dg&&(b=n.relatedTarget||n.fromElement)&&(mo(b)||b[Ta]))break e;if((p||m)&&(m=u.window===u?u:(m=u.ownerDocument)?m.defaultView||m.parentWindow:window,p?(b=n.relatedTarget||n.toElement,p=d,b=b?mo(b):null,b!==null&&(g=Vo(b),b!==g||b.tag!==5&&b.tag!==6)&&(b=null)):(p=null,b=d),p!==b)){if(x=Vj,j="onMouseLeave",y="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(x=Gj,j="onPointerLeave",y="onPointerEnter",v="pointer"),g=p==null?m:El(p),w=b==null?m:El(b),m=new x(j,v+"leave",p,n,u),m.target=g,m.relatedTarget=w,j=null,mo(u)===d&&(x=new x(y,v+"enter",b,n,u),x.target=w,x.relatedTarget=g,j=x),g=j,p&&b)t:{for(x=p,y=b,v=0,w=x;w;w=sl(w))v++;for(w=0,j=y;j;j=sl(j))w++;for(;0<v-w;)x=sl(x),v--;for(;0<w-v;)y=sl(y),w--;for(;v--;){if(x===y||y!==null&&x===y.alternate)break t;x=sl(x),y=sl(y)}x=null}else x=null;p!==null&&a_(h,m,p,x,!1),b!==null&&g!==null&&a_(h,g,b,x,!0)}}e:{if(m=d?El(d):window,p=m.nodeName&&m.nodeName.toLowerCase(),p==="select"||p==="input"&&m.type==="file")var S=b6;else if(Yj(m))if(QS)S=N6;else{S=j6;var N=w6}else(p=m.nodeName)&&p.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(S=_6);if(S&&(S=S(t,d))){ZS(h,S,n,u);break e}N&&N(t,m,d),t==="focusout"&&(N=m._wrapperState)&&N.controlled&&m.type==="number"&&Sg(m,"number",m.value)}switch(N=d?El(d):window,t){case"focusin":(Yj(N)||N.contentEditable==="true")&&(kl=N,Fg=d,Rd=null);break;case"focusout":Rd=Fg=kl=null;break;case"mousedown":Bg=!0;break;case"contextmenu":case"mouseup":case"dragend":Bg=!1,n_(h,n,u);break;case"selectionchange":if(C6)break;case"keydown":case"keyup":n_(h,n,u)}var k;if(Qy)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Sl?KS(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(VS&&n.locale!=="ko"&&(Sl||E!=="onCompositionStart"?E==="onCompositionEnd"&&Sl&&(k=HS()):(yi=u,Ky="value"in yi?yi.value:yi.textContent,Sl=!0)),N=ef(d,E),0<N.length&&(E=new Kj(E,t,null,n,u),h.push({event:E,listeners:N}),k?E.data=k:(k=GS(n),k!==null&&(E.data=k)))),(k=p6?x6(t,n):g6(t,n))&&(d=ef(d,"onBeforeInput"),0<d.length&&(u=new Kj("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:d}),u.data=k))}ik(h,e)})}function iu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ef(t,e){for(var n=e+"Capture",s=[];t!==null;){var a=t,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Xd(t,n),i!=null&&s.unshift(iu(t,i,a)),i=Xd(t,e),i!=null&&s.push(iu(t,i,a))),t=t.return}return s}function sl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function a_(t,e,n,s,a){for(var i=e._reactName,o=[];n!==null&&n!==s;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&d!==null&&(l=d,a?(c=Xd(n,i),c!=null&&o.unshift(iu(n,c,l))):a||(c=Xd(n,i),c!=null&&o.push(iu(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var P6=/\r\n?/g,T6=/\u0000|\uFFFD/g;function i_(t){return(typeof t=="string"?t:""+t).replace(P6,`
`).replace(T6,"")}function Ih(t,e,n){if(e=i_(e),i_(t)!==e&&n)throw Error(ve(425))}function tf(){}var Lg=null,$g=null;function zg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ug=typeof setTimeout=="function"?setTimeout:void 0,R6=typeof clearTimeout=="function"?clearTimeout:void 0,o_=typeof Promise=="function"?Promise:void 0,M6=typeof queueMicrotask=="function"?queueMicrotask:typeof o_<"u"?function(t){return o_.resolve(null).then(t).catch(I6)}:Ug;function I6(t){setTimeout(function(){throw t})}function Ip(t,e){var n=e,s=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(s===0){t.removeChild(a),nu(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=a}while(n);nu(e)}function Ei(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function l_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Pc=Math.random().toString(36).slice(2),Gs="__reactFiber$"+Pc,ou="__reactProps$"+Pc,Ta="__reactContainer$"+Pc,qg="__reactEvents$"+Pc,O6="__reactListeners$"+Pc,F6="__reactHandles$"+Pc;function mo(t){var e=t[Gs];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ta]||n[Gs]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=l_(t);t!==null;){if(n=t[Gs])return n;t=l_(t)}return e}t=n,n=t.parentNode}return null}function Gu(t){return t=t[Gs]||t[Ta],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function El(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ve(33))}function d0(t){return t[ou]||null}var Wg=[],Al=-1;function Gi(t){return{current:t}}function Xt(t){0>Al||(t.current=Wg[Al],Wg[Al]=null,Al--)}function Zt(t,e){Al++,Wg[Al]=t.current,t.current=e}var Oi={},er=Gi(Oi),jr=Gi(!1),Do=Oi;function hc(t,e){var n=t.type.contextTypes;if(!n)return Oi;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function _r(t){return t=t.childContextTypes,t!=null}function nf(){Xt(jr),Xt(er)}function c_(t,e,n){if(er.current!==Oi)throw Error(ve(168));Zt(er,e),Zt(jr,n)}function lk(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var a in s)if(!(a in e))throw Error(ve(108,w5(t)||"Unknown",a));return ln({},n,s)}function rf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Oi,Do=er.current,Zt(er,t),Zt(jr,jr.current),!0}function d_(t,e,n){var s=t.stateNode;if(!s)throw Error(ve(169));n?(t=lk(t,e,Do),s.__reactInternalMemoizedMergedChildContext=t,Xt(jr),Xt(er),Zt(er,t)):Xt(jr),Zt(jr,n)}var Sa=null,u0=!1,Op=!1;function ck(t){Sa===null?Sa=[t]:Sa.push(t)}function B6(t){u0=!0,ck(t)}function Zi(){if(!Op&&Sa!==null){Op=!0;var t=0,e=Vt;try{var n=Sa;for(Vt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Sa=null,u0=!1}catch(a){throw Sa!==null&&(Sa=Sa.slice(t+1)),MS(qy,Zi),a}finally{Vt=e,Op=!1}}return null}var Dl=[],Pl=0,sf=null,af=0,Xr=[],es=0,Po=null,Ca=1,Ea="";function ao(t,e){Dl[Pl++]=af,Dl[Pl++]=sf,sf=t,af=e}function dk(t,e,n){Xr[es++]=Ca,Xr[es++]=Ea,Xr[es++]=Po,Po=t;var s=Ca;t=Ea;var a=32-_s(s)-1;s&=~(1<<a),n+=1;var i=32-_s(e)+a;if(30<i){var o=a-a%5;i=(s&(1<<o)-1).toString(32),s>>=o,a-=o,Ca=1<<32-_s(e)+a|n<<a|s,Ea=i+t}else Ca=1<<i|n<<a|s,Ea=t}function Jy(t){t.return!==null&&(ao(t,1),dk(t,1,0))}function Xy(t){for(;t===sf;)sf=Dl[--Pl],Dl[Pl]=null,af=Dl[--Pl],Dl[Pl]=null;for(;t===Po;)Po=Xr[--es],Xr[es]=null,Ea=Xr[--es],Xr[es]=null,Ca=Xr[--es],Xr[es]=null}var Br=null,Or=null,tn=!1,vs=null;function uk(t,e){var n=ts(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function u_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Br=t,Or=Ei(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Br=t,Or=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Po!==null?{id:Ca,overflow:Ea}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ts(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Br=t,Or=null,!0):!1;default:return!1}}function Hg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Vg(t){if(tn){var e=Or;if(e){var n=e;if(!u_(t,e)){if(Hg(t))throw Error(ve(418));e=Ei(n.nextSibling);var s=Br;e&&u_(t,e)?uk(s,n):(t.flags=t.flags&-4097|2,tn=!1,Br=t)}}else{if(Hg(t))throw Error(ve(418));t.flags=t.flags&-4097|2,tn=!1,Br=t}}}function h_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Br=t}function Oh(t){if(t!==Br)return!1;if(!tn)return h_(t),tn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!zg(t.type,t.memoizedProps)),e&&(e=Or)){if(Hg(t))throw hk(),Error(ve(418));for(;e;)uk(t,e),e=Ei(e.nextSibling)}if(h_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ve(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Or=Ei(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Or=null}}else Or=Br?Ei(t.stateNode.nextSibling):null;return!0}function hk(){for(var t=Or;t;)t=Ei(t.nextSibling)}function mc(){Or=Br=null,tn=!1}function eb(t){vs===null?vs=[t]:vs.push(t)}var L6=$a.ReactCurrentBatchConfig;function ed(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ve(309));var s=n.stateNode}if(!s)throw Error(ve(147,t));var a=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(ve(284));if(!n._owner)throw Error(ve(290,t))}return t}function Fh(t,e){throw t=Object.prototype.toString.call(e),Error(ve(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function m_(t){var e=t._init;return e(t._payload)}function mk(t){function e(y,v){if(t){var w=y.deletions;w===null?(y.deletions=[v],y.flags|=16):w.push(v)}}function n(y,v){if(!t)return null;for(;v!==null;)e(y,v),v=v.sibling;return null}function s(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function a(y,v){return y=Ti(y,v),y.index=0,y.sibling=null,y}function i(y,v,w){return y.index=w,t?(w=y.alternate,w!==null?(w=w.index,w<v?(y.flags|=2,v):w):(y.flags|=2,v)):(y.flags|=1048576,v)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,v,w,j){return v===null||v.tag!==6?(v=qp(w,y.mode,j),v.return=y,v):(v=a(v,w),v.return=y,v)}function c(y,v,w,j){var S=w.type;return S===Nl?u(y,v,w.props.children,j,w.key):v!==null&&(v.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ni&&m_(S)===v.type)?(j=a(v,w.props),j.ref=ed(y,v,w),j.return=y,j):(j=Cm(w.type,w.key,w.props,null,y.mode,j),j.ref=ed(y,v,w),j.return=y,j)}function d(y,v,w,j){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=Wp(w,y.mode,j),v.return=y,v):(v=a(v,w.children||[]),v.return=y,v)}function u(y,v,w,j,S){return v===null||v.tag!==7?(v=ko(w,y.mode,j,S),v.return=y,v):(v=a(v,w),v.return=y,v)}function h(y,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=qp(""+v,y.mode,w),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case kh:return w=Cm(v.type,v.key,v.props,null,y.mode,w),w.ref=ed(y,null,v),w.return=y,w;case _l:return v=Wp(v,y.mode,w),v.return=y,v;case ni:var j=v._init;return h(y,j(v._payload),w)}if(dd(v)||Zc(v))return v=ko(v,y.mode,w,null),v.return=y,v;Fh(y,v)}return null}function m(y,v,w,j){var S=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return S!==null?null:l(y,v,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case kh:return w.key===S?c(y,v,w,j):null;case _l:return w.key===S?d(y,v,w,j):null;case ni:return S=w._init,m(y,v,S(w._payload),j)}if(dd(w)||Zc(w))return S!==null?null:u(y,v,w,j,null);Fh(y,w)}return null}function p(y,v,w,j,S){if(typeof j=="string"&&j!==""||typeof j=="number")return y=y.get(w)||null,l(v,y,""+j,S);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case kh:return y=y.get(j.key===null?w:j.key)||null,c(v,y,j,S);case _l:return y=y.get(j.key===null?w:j.key)||null,d(v,y,j,S);case ni:var N=j._init;return p(y,v,w,N(j._payload),S)}if(dd(j)||Zc(j))return y=y.get(w)||null,u(v,y,j,S,null);Fh(v,j)}return null}function b(y,v,w,j){for(var S=null,N=null,k=v,E=v=0,P=null;k!==null&&E<w.length;E++){k.index>E?(P=k,k=null):P=k.sibling;var A=m(y,k,w[E],j);if(A===null){k===null&&(k=P);break}t&&k&&A.alternate===null&&e(y,k),v=i(A,v,E),N===null?S=A:N.sibling=A,N=A,k=P}if(E===w.length)return n(y,k),tn&&ao(y,E),S;if(k===null){for(;E<w.length;E++)k=h(y,w[E],j),k!==null&&(v=i(k,v,E),N===null?S=k:N.sibling=k,N=k);return tn&&ao(y,E),S}for(k=s(y,k);E<w.length;E++)P=p(k,y,E,w[E],j),P!==null&&(t&&P.alternate!==null&&k.delete(P.key===null?E:P.key),v=i(P,v,E),N===null?S=P:N.sibling=P,N=P);return t&&k.forEach(function(C){return e(y,C)}),tn&&ao(y,E),S}function x(y,v,w,j){var S=Zc(w);if(typeof S!="function")throw Error(ve(150));if(w=S.call(w),w==null)throw Error(ve(151));for(var N=S=null,k=v,E=v=0,P=null,A=w.next();k!==null&&!A.done;E++,A=w.next()){k.index>E?(P=k,k=null):P=k.sibling;var C=m(y,k,A.value,j);if(C===null){k===null&&(k=P);break}t&&k&&C.alternate===null&&e(y,k),v=i(C,v,E),N===null?S=C:N.sibling=C,N=C,k=P}if(A.done)return n(y,k),tn&&ao(y,E),S;if(k===null){for(;!A.done;E++,A=w.next())A=h(y,A.value,j),A!==null&&(v=i(A,v,E),N===null?S=A:N.sibling=A,N=A);return tn&&ao(y,E),S}for(k=s(y,k);!A.done;E++,A=w.next())A=p(k,y,E,A.value,j),A!==null&&(t&&A.alternate!==null&&k.delete(A.key===null?E:A.key),v=i(A,v,E),N===null?S=A:N.sibling=A,N=A);return t&&k.forEach(function(T){return e(y,T)}),tn&&ao(y,E),S}function g(y,v,w,j){if(typeof w=="object"&&w!==null&&w.type===Nl&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case kh:e:{for(var S=w.key,N=v;N!==null;){if(N.key===S){if(S=w.type,S===Nl){if(N.tag===7){n(y,N.sibling),v=a(N,w.props.children),v.return=y,y=v;break e}}else if(N.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===ni&&m_(S)===N.type){n(y,N.sibling),v=a(N,w.props),v.ref=ed(y,N,w),v.return=y,y=v;break e}n(y,N);break}else e(y,N);N=N.sibling}w.type===Nl?(v=ko(w.props.children,y.mode,j,w.key),v.return=y,y=v):(j=Cm(w.type,w.key,w.props,null,y.mode,j),j.ref=ed(y,v,w),j.return=y,y=j)}return o(y);case _l:e:{for(N=w.key;v!==null;){if(v.key===N)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(y,v.sibling),v=a(v,w.children||[]),v.return=y,y=v;break e}else{n(y,v);break}else e(y,v);v=v.sibling}v=Wp(w,y.mode,j),v.return=y,y=v}return o(y);case ni:return N=w._init,g(y,v,N(w._payload),j)}if(dd(w))return b(y,v,w,j);if(Zc(w))return x(y,v,w,j);Fh(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(y,v.sibling),v=a(v,w),v.return=y,y=v):(n(y,v),v=qp(w,y.mode,j),v.return=y,y=v),o(y)):n(y,v)}return g}var fc=mk(!0),fk=mk(!1),of=Gi(null),lf=null,Tl=null,tb=null;function nb(){tb=Tl=lf=null}function rb(t){var e=of.current;Xt(of),t._currentValue=e}function Kg(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function ql(t,e){lf=t,tb=Tl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wr=!0),t.firstContext=null)}function as(t){var e=t._currentValue;if(tb!==t)if(t={context:t,memoizedValue:e,next:null},Tl===null){if(lf===null)throw Error(ve(308));Tl=t,lf.dependencies={lanes:0,firstContext:t}}else Tl=Tl.next=t;return e}var fo=null;function sb(t){fo===null?fo=[t]:fo.push(t)}function pk(t,e,n,s){var a=e.interleaved;return a===null?(n.next=n,sb(e)):(n.next=a.next,a.next=n),e.interleaved=n,Ra(t,s)}function Ra(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ri=!1;function ab(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xk(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Aa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ai(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Ot&2){var a=s.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),s.pending=e,Ra(t,n)}return a=s.interleaved,a===null?(e.next=e,sb(s)):(e.next=a.next,a.next=e),s.interleaved=e,Ra(t,n)}function wm(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Wy(t,n)}}function f_(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?a=i=e:i=i.next=e}else a=i=e;n={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function cf(t,e,n,s){var a=t.updateQueue;ri=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(i!==null){var h=a.baseState;o=0,u=d=c=null,l=i;do{var m=l.lane,p=l.eventTime;if((s&m)===m){u!==null&&(u=u.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=t,x=l;switch(m=e,p=n,x.tag){case 1:if(b=x.payload,typeof b=="function"){h=b.call(p,h,m);break e}h=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=x.payload,m=typeof b=="function"?b.call(p,h,m):b,m==null)break e;h=ln({},h,m);break e;case 2:ri=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=a.effects,m===null?a.effects=[l]:m.push(l))}else p={eventTime:p,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=p,c=h):u=u.next=p,o|=m;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;m=l,l=m.next,m.next=null,a.lastBaseUpdate=m,a.shared.pending=null}}while(!0);if(u===null&&(c=h),a.baseState=c,a.firstBaseUpdate=d,a.lastBaseUpdate=u,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);Ro|=o,t.lanes=o,t.memoizedState=h}}function p_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],a=s.callback;if(a!==null){if(s.callback=null,s=n,typeof a!="function")throw Error(ve(191,a));a.call(s)}}}var Zu={},ta=Gi(Zu),lu=Gi(Zu),cu=Gi(Zu);function po(t){if(t===Zu)throw Error(ve(174));return t}function ib(t,e){switch(Zt(cu,e),Zt(lu,t),Zt(ta,Zu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Cg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Cg(e,t)}Xt(ta),Zt(ta,e)}function pc(){Xt(ta),Xt(lu),Xt(cu)}function gk(t){po(cu.current);var e=po(ta.current),n=Cg(e,t.type);e!==n&&(Zt(lu,t),Zt(ta,n))}function ob(t){lu.current===t&&(Xt(ta),Xt(lu))}var sn=Gi(0);function df(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Fp=[];function lb(){for(var t=0;t<Fp.length;t++)Fp[t]._workInProgressVersionPrimary=null;Fp.length=0}var jm=$a.ReactCurrentDispatcher,Bp=$a.ReactCurrentBatchConfig,To=0,on=null,wn=null,Pn=null,uf=!1,Md=!1,du=0,$6=0;function Kn(){throw Error(ve(321))}function cb(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Es(t[n],e[n]))return!1;return!0}function db(t,e,n,s,a,i){if(To=i,on=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,jm.current=t===null||t.memoizedState===null?W6:H6,t=n(s,a),Md){i=0;do{if(Md=!1,du=0,25<=i)throw Error(ve(301));i+=1,Pn=wn=null,e.updateQueue=null,jm.current=V6,t=n(s,a)}while(Md)}if(jm.current=hf,e=wn!==null&&wn.next!==null,To=0,Pn=wn=on=null,uf=!1,e)throw Error(ve(300));return t}function ub(){var t=du!==0;return du=0,t}function zs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pn===null?on.memoizedState=Pn=t:Pn=Pn.next=t,Pn}function is(){if(wn===null){var t=on.alternate;t=t!==null?t.memoizedState:null}else t=wn.next;var e=Pn===null?on.memoizedState:Pn.next;if(e!==null)Pn=e,wn=t;else{if(t===null)throw Error(ve(310));wn=t,t={memoizedState:wn.memoizedState,baseState:wn.baseState,baseQueue:wn.baseQueue,queue:wn.queue,next:null},Pn===null?on.memoizedState=Pn=t:Pn=Pn.next=t}return Pn}function uu(t,e){return typeof e=="function"?e(t):e}function Lp(t){var e=is(),n=e.queue;if(n===null)throw Error(ve(311));n.lastRenderedReducer=t;var s=wn,a=s.baseQueue,i=n.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}s.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,s=s.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((To&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:t(s,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=h,o=s):c=c.next=h,on.lanes|=u,Ro|=u}d=d.next}while(d!==null&&d!==i);c===null?o=s:c.next=l,Es(s,e.memoizedState)||(wr=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,n.lastRenderedState=s}if(t=n.interleaved,t!==null){a=t;do i=a.lane,on.lanes|=i,Ro|=i,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function $p(t){var e=is(),n=e.queue;if(n===null)throw Error(ve(311));n.lastRenderedReducer=t;var s=n.dispatch,a=n.pending,i=e.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do i=t(i,o.action),o=o.next;while(o!==a);Es(i,e.memoizedState)||(wr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function vk(){}function yk(t,e){var n=on,s=is(),a=e(),i=!Es(s.memoizedState,a);if(i&&(s.memoizedState=a,wr=!0),s=s.queue,hb(jk.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||Pn!==null&&Pn.memoizedState.tag&1){if(n.flags|=2048,hu(9,wk.bind(null,n,s,a,e),void 0,null),In===null)throw Error(ve(349));To&30||bk(n,e,a)}return a}function bk(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=on.updateQueue,e===null?(e={lastEffect:null,stores:null},on.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function wk(t,e,n,s){e.value=n,e.getSnapshot=s,_k(e)&&Nk(t)}function jk(t,e,n){return n(function(){_k(e)&&Nk(t)})}function _k(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Es(t,n)}catch{return!0}}function Nk(t){var e=Ra(t,1);e!==null&&Ns(e,t,1,-1)}function x_(t){var e=zs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:uu,lastRenderedState:t},e.queue=t,t=t.dispatch=q6.bind(null,on,t),[e.memoizedState,t]}function hu(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=on.updateQueue,e===null?(e={lastEffect:null,stores:null},on.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function Sk(){return is().memoizedState}function _m(t,e,n,s){var a=zs();on.flags|=t,a.memoizedState=hu(1|e,n,void 0,s===void 0?null:s)}function h0(t,e,n,s){var a=is();s=s===void 0?null:s;var i=void 0;if(wn!==null){var o=wn.memoizedState;if(i=o.destroy,s!==null&&cb(s,o.deps)){a.memoizedState=hu(e,n,i,s);return}}on.flags|=t,a.memoizedState=hu(1|e,n,i,s)}function g_(t,e){return _m(8390656,8,t,e)}function hb(t,e){return h0(2048,8,t,e)}function kk(t,e){return h0(4,2,t,e)}function Ck(t,e){return h0(4,4,t,e)}function Ek(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Ak(t,e,n){return n=n!=null?n.concat([t]):null,h0(4,4,Ek.bind(null,e,t),n)}function mb(){}function Dk(t,e){var n=is();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&cb(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function Pk(t,e){var n=is();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&cb(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function Tk(t,e,n){return To&21?(Es(n,e)||(n=FS(),on.lanes|=n,Ro|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wr=!0),t.memoizedState=n)}function z6(t,e){var n=Vt;Vt=n!==0&&4>n?n:4,t(!0);var s=Bp.transition;Bp.transition={};try{t(!1),e()}finally{Vt=n,Bp.transition=s}}function Rk(){return is().memoizedState}function U6(t,e,n){var s=Pi(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Mk(t))Ik(e,n);else if(n=pk(t,e,n,s),n!==null){var a=or();Ns(n,t,s,a),Ok(n,e,s)}}function q6(t,e,n){var s=Pi(t),a={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Mk(t))Ik(e,a);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(a.hasEagerState=!0,a.eagerState=l,Es(l,o)){var c=e.interleaved;c===null?(a.next=a,sb(e)):(a.next=c.next,c.next=a),e.interleaved=a;return}}catch{}finally{}n=pk(t,e,a,s),n!==null&&(a=or(),Ns(n,t,s,a),Ok(n,e,s))}}function Mk(t){var e=t.alternate;return t===on||e!==null&&e===on}function Ik(t,e){Md=uf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Ok(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Wy(t,n)}}var hf={readContext:as,useCallback:Kn,useContext:Kn,useEffect:Kn,useImperativeHandle:Kn,useInsertionEffect:Kn,useLayoutEffect:Kn,useMemo:Kn,useReducer:Kn,useRef:Kn,useState:Kn,useDebugValue:Kn,useDeferredValue:Kn,useTransition:Kn,useMutableSource:Kn,useSyncExternalStore:Kn,useId:Kn,unstable_isNewReconciler:!1},W6={readContext:as,useCallback:function(t,e){return zs().memoizedState=[t,e===void 0?null:e],t},useContext:as,useEffect:g_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,_m(4194308,4,Ek.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _m(4194308,4,t,e)},useInsertionEffect:function(t,e){return _m(4,2,t,e)},useMemo:function(t,e){var n=zs();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=zs();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=U6.bind(null,on,t),[s.memoizedState,t]},useRef:function(t){var e=zs();return t={current:t},e.memoizedState=t},useState:x_,useDebugValue:mb,useDeferredValue:function(t){return zs().memoizedState=t},useTransition:function(){var t=x_(!1),e=t[0];return t=z6.bind(null,t[1]),zs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=on,a=zs();if(tn){if(n===void 0)throw Error(ve(407));n=n()}else{if(n=e(),In===null)throw Error(ve(349));To&30||bk(s,e,n)}a.memoizedState=n;var i={value:n,getSnapshot:e};return a.queue=i,g_(jk.bind(null,s,i,t),[t]),s.flags|=2048,hu(9,wk.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=zs(),e=In.identifierPrefix;if(tn){var n=Ea,s=Ca;n=(s&~(1<<32-_s(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=du++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=$6++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},H6={readContext:as,useCallback:Dk,useContext:as,useEffect:hb,useImperativeHandle:Ak,useInsertionEffect:kk,useLayoutEffect:Ck,useMemo:Pk,useReducer:Lp,useRef:Sk,useState:function(){return Lp(uu)},useDebugValue:mb,useDeferredValue:function(t){var e=is();return Tk(e,wn.memoizedState,t)},useTransition:function(){var t=Lp(uu)[0],e=is().memoizedState;return[t,e]},useMutableSource:vk,useSyncExternalStore:yk,useId:Rk,unstable_isNewReconciler:!1},V6={readContext:as,useCallback:Dk,useContext:as,useEffect:hb,useImperativeHandle:Ak,useInsertionEffect:kk,useLayoutEffect:Ck,useMemo:Pk,useReducer:$p,useRef:Sk,useState:function(){return $p(uu)},useDebugValue:mb,useDeferredValue:function(t){var e=is();return wn===null?e.memoizedState=t:Tk(e,wn.memoizedState,t)},useTransition:function(){var t=$p(uu)[0],e=is().memoizedState;return[t,e]},useMutableSource:vk,useSyncExternalStore:yk,useId:Rk,unstable_isNewReconciler:!1};function ms(t,e){if(t&&t.defaultProps){e=ln({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Gg(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:ln({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var m0={isMounted:function(t){return(t=t._reactInternals)?Vo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=or(),a=Pi(t),i=Aa(s,a);i.payload=e,n!=null&&(i.callback=n),e=Ai(t,i,a),e!==null&&(Ns(e,t,a,s),wm(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=or(),a=Pi(t),i=Aa(s,a);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ai(t,i,a),e!==null&&(Ns(e,t,a,s),wm(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=or(),s=Pi(t),a=Aa(n,s);a.tag=2,e!=null&&(a.callback=e),e=Ai(t,a,s),e!==null&&(Ns(e,t,s,n),wm(e,t,s))}};function v_(t,e,n,s,a,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!su(n,s)||!su(a,i):!0}function Fk(t,e,n){var s=!1,a=Oi,i=e.contextType;return typeof i=="object"&&i!==null?i=as(i):(a=_r(e)?Do:er.current,s=e.contextTypes,i=(s=s!=null)?hc(t,a):Oi),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=m0,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function y_(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&m0.enqueueReplaceState(e,e.state,null)}function Zg(t,e,n,s){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},ab(t);var i=e.contextType;typeof i=="object"&&i!==null?a.context=as(i):(i=_r(e)?Do:er.current,a.context=hc(t,i)),a.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Gg(t,e,i,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&m0.enqueueReplaceState(a,a.state,null),cf(t,n,a,s),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function xc(t,e){try{var n="",s=e;do n+=b5(s),s=s.return;while(s);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:a,digest:null}}function zp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Qg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var K6=typeof WeakMap=="function"?WeakMap:Map;function Bk(t,e,n){n=Aa(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){ff||(ff=!0,iv=s),Qg(t,e)},n}function Lk(t,e,n){n=Aa(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var a=e.value;n.payload=function(){return s(a)},n.callback=function(){Qg(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Qg(t,e),typeof s!="function"&&(Di===null?Di=new Set([this]):Di.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function b_(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new K6;var a=new Set;s.set(e,a)}else a=s.get(e),a===void 0&&(a=new Set,s.set(e,a));a.has(n)||(a.add(n),t=oM.bind(null,t,e,n),e.then(t,t))}function w_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function j_(t,e,n,s,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Aa(-1,1),e.tag=2,Ai(n,e,1))),n.lanes|=1),t)}var G6=$a.ReactCurrentOwner,wr=!1;function ir(t,e,n,s){e.child=t===null?fk(e,null,n,s):fc(e,t.child,n,s)}function __(t,e,n,s,a){n=n.render;var i=e.ref;return ql(e,a),s=db(t,e,n,s,i,a),n=ub(),t!==null&&!wr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Ma(t,e,a)):(tn&&n&&Jy(e),e.flags|=1,ir(t,e,s,a),e.child)}function N_(t,e,n,s,a){if(t===null){var i=n.type;return typeof i=="function"&&!wb(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,$k(t,e,i,s,a)):(t=Cm(n.type,null,s,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&a)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:su,n(o,s)&&t.ref===e.ref)return Ma(t,e,a)}return e.flags|=1,t=Ti(i,s),t.ref=e.ref,t.return=e,e.child=t}function $k(t,e,n,s,a){if(t!==null){var i=t.memoizedProps;if(su(i,s)&&t.ref===e.ref)if(wr=!1,e.pendingProps=s=i,(t.lanes&a)!==0)t.flags&131072&&(wr=!0);else return e.lanes=t.lanes,Ma(t,e,a)}return Yg(t,e,n,s,a)}function zk(t,e,n){var s=e.pendingProps,a=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Zt(Ml,Mr),Mr|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Zt(Ml,Mr),Mr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,Zt(Ml,Mr),Mr|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,Zt(Ml,Mr),Mr|=s;return ir(t,e,a,n),e.child}function Uk(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Yg(t,e,n,s,a){var i=_r(n)?Do:er.current;return i=hc(e,i),ql(e,a),n=db(t,e,n,s,i,a),s=ub(),t!==null&&!wr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,Ma(t,e,a)):(tn&&s&&Jy(e),e.flags|=1,ir(t,e,n,a),e.child)}function S_(t,e,n,s,a){if(_r(n)){var i=!0;rf(e)}else i=!1;if(ql(e,a),e.stateNode===null)Nm(t,e),Fk(e,n,s),Zg(e,n,s,a),s=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=as(d):(d=_r(n)?Do:er.current,d=hc(e,d));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==s||c!==d)&&y_(e,o,s,d),ri=!1;var m=e.memoizedState;o.state=m,cf(e,s,o,a),c=e.memoizedState,l!==s||m!==c||jr.current||ri?(typeof u=="function"&&(Gg(e,n,u,s),c=e.memoizedState),(l=ri||v_(e,n,l,s,m,c,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=d,s=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,xk(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:ms(e.type,l),o.props=d,h=e.pendingProps,m=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=as(c):(c=_r(n)?Do:er.current,c=hc(e,c));var p=n.getDerivedStateFromProps;(u=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||m!==c)&&y_(e,o,s,c),ri=!1,m=e.memoizedState,o.state=m,cf(e,s,o,a);var b=e.memoizedState;l!==h||m!==b||jr.current||ri?(typeof p=="function"&&(Gg(e,n,p,s),b=e.memoizedState),(d=ri||v_(e,n,d,s,m,b,c)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,b,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,b,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=b),o.props=s,o.state=b,o.context=c,s=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),s=!1)}return Jg(t,e,n,s,i,a)}function Jg(t,e,n,s,a,i){Uk(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return a&&d_(e,n,!1),Ma(t,e,i);s=e.stateNode,G6.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=fc(e,t.child,null,i),e.child=fc(e,null,l,i)):ir(t,e,l,i),e.memoizedState=s.state,a&&d_(e,n,!0),e.child}function qk(t){var e=t.stateNode;e.pendingContext?c_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&c_(t,e.context,!1),ib(t,e.containerInfo)}function k_(t,e,n,s,a){return mc(),eb(a),e.flags|=256,ir(t,e,n,s),e.child}var Xg={dehydrated:null,treeContext:null,retryLane:0};function ev(t){return{baseLanes:t,cachePool:null,transitions:null}}function Wk(t,e,n){var s=e.pendingProps,a=sn.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(a&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),Zt(sn,a&1),t===null)return Vg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=x0(o,s,0,null),t=ko(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=ev(n),e.memoizedState=Xg,t):fb(e,o));if(a=t.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return Z6(t,e,o,s,l,a,n);if(i){i=s.fallback,o=e.mode,a=t.child,l=a.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==a?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Ti(a,c),s.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=Ti(l,i):(i=ko(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?ev(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Xg,s}return i=t.child,t=i.sibling,s=Ti(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function fb(t,e){return e=x0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Bh(t,e,n,s){return s!==null&&eb(s),fc(e,t.child,null,n),t=fb(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Z6(t,e,n,s,a,i,o){if(n)return e.flags&256?(e.flags&=-257,s=zp(Error(ve(422))),Bh(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,a=e.mode,s=x0({mode:"visible",children:s.children},a,0,null),i=ko(i,a,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&fc(e,t.child,null,o),e.child.memoizedState=ev(o),e.memoizedState=Xg,i);if(!(e.mode&1))return Bh(t,e,o,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var l=s.dgst;return s=l,i=Error(ve(419)),s=zp(i,s,void 0),Bh(t,e,o,s)}if(l=(o&t.childLanes)!==0,wr||l){if(s=In,s!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Ra(t,a),Ns(s,t,a,-1))}return bb(),s=zp(Error(ve(421))),Bh(t,e,o,s)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=lM.bind(null,t),a._reactRetry=e,null):(t=i.treeContext,Or=Ei(a.nextSibling),Br=e,tn=!0,vs=null,t!==null&&(Xr[es++]=Ca,Xr[es++]=Ea,Xr[es++]=Po,Ca=t.id,Ea=t.overflow,Po=e),e=fb(e,s.children),e.flags|=4096,e)}function C_(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),Kg(t.return,e,n)}function Up(t,e,n,s,a){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=a)}function Hk(t,e,n){var s=e.pendingProps,a=s.revealOrder,i=s.tail;if(ir(t,e,s.children,n),s=sn.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&C_(t,n,e);else if(t.tag===19)C_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(Zt(sn,s),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&df(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),Up(e,!1,a,n,i);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&df(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}Up(e,!0,n,null,i);break;case"together":Up(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Nm(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ma(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ro|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ve(153));if(e.child!==null){for(t=e.child,n=Ti(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ti(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Q6(t,e,n){switch(e.tag){case 3:qk(e),mc();break;case 5:gk(e);break;case 1:_r(e.type)&&rf(e);break;case 4:ib(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,a=e.memoizedProps.value;Zt(of,s._currentValue),s._currentValue=a;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Zt(sn,sn.current&1),e.flags|=128,null):n&e.child.childLanes?Wk(t,e,n):(Zt(sn,sn.current&1),t=Ma(t,e,n),t!==null?t.sibling:null);Zt(sn,sn.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return Hk(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Zt(sn,sn.current),s)break;return null;case 22:case 23:return e.lanes=0,zk(t,e,n)}return Ma(t,e,n)}var Vk,tv,Kk,Gk;Vk=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};tv=function(){};Kk=function(t,e,n,s){var a=t.memoizedProps;if(a!==s){t=e.stateNode,po(ta.current);var i=null;switch(n){case"input":a=_g(t,a),s=_g(t,s),i=[];break;case"select":a=ln({},a,{value:void 0}),s=ln({},s,{value:void 0}),i=[];break;case"textarea":a=kg(t,a),s=kg(t,s),i=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=tf)}Eg(n,s);var o;n=null;for(d in a)if(!s.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var l=a[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Yd.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in s){var c=s[d];if(l=a!=null?a[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Yd.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Jt("scroll",t),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Gk=function(t,e,n,s){n!==s&&(e.flags|=4)};function td(t,e){if(!tn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function Gn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function Y6(t,e,n){var s=e.pendingProps;switch(Xy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gn(e),null;case 1:return _r(e.type)&&nf(),Gn(e),null;case 3:return s=e.stateNode,pc(),Xt(jr),Xt(er),lb(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Oh(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,vs!==null&&(cv(vs),vs=null))),tv(t,e),Gn(e),null;case 5:ob(e);var a=po(cu.current);if(n=e.type,t!==null&&e.stateNode!=null)Kk(t,e,n,s,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(ve(166));return Gn(e),null}if(t=po(ta.current),Oh(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[Gs]=e,s[ou]=i,t=(e.mode&1)!==0,n){case"dialog":Jt("cancel",s),Jt("close",s);break;case"iframe":case"object":case"embed":Jt("load",s);break;case"video":case"audio":for(a=0;a<hd.length;a++)Jt(hd[a],s);break;case"source":Jt("error",s);break;case"img":case"image":case"link":Jt("error",s),Jt("load",s);break;case"details":Jt("toggle",s);break;case"input":Oj(s,i),Jt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Jt("invalid",s);break;case"textarea":Bj(s,i),Jt("invalid",s)}Eg(n,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?s.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ih(s.textContent,l,t),a=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ih(s.textContent,l,t),a=["children",""+l]):Yd.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Jt("scroll",s)}switch(n){case"input":Ch(s),Fj(s,i,!0);break;case"textarea":Ch(s),Lj(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=tf)}s=a,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=jS(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[Gs]=e,t[ou]=s,Vk(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ag(n,s),n){case"dialog":Jt("cancel",t),Jt("close",t),a=s;break;case"iframe":case"object":case"embed":Jt("load",t),a=s;break;case"video":case"audio":for(a=0;a<hd.length;a++)Jt(hd[a],t);a=s;break;case"source":Jt("error",t),a=s;break;case"img":case"image":case"link":Jt("error",t),Jt("load",t),a=s;break;case"details":Jt("toggle",t),a=s;break;case"input":Oj(t,s),a=_g(t,s),Jt("invalid",t);break;case"option":a=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},a=ln({},s,{value:void 0}),Jt("invalid",t);break;case"textarea":Bj(t,s),a=kg(t,s),Jt("invalid",t);break;default:a=s}Eg(n,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?SS(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&_S(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Jd(t,c):typeof c=="number"&&Jd(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Yd.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Jt("scroll",t):c!=null&&By(t,i,c,o))}switch(n){case"input":Ch(t),Fj(t,s,!1);break;case"textarea":Ch(t),Lj(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Ii(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?Ll(t,!!s.multiple,i,!1):s.defaultValue!=null&&Ll(t,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=tf)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Gn(e),null;case 6:if(t&&e.stateNode!=null)Gk(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(ve(166));if(n=po(cu.current),po(ta.current),Oh(e)){if(s=e.stateNode,n=e.memoizedProps,s[Gs]=e,(i=s.nodeValue!==n)&&(t=Br,t!==null))switch(t.tag){case 3:Ih(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ih(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Gs]=e,e.stateNode=s}return Gn(e),null;case 13:if(Xt(sn),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(tn&&Or!==null&&e.mode&1&&!(e.flags&128))hk(),mc(),e.flags|=98560,i=!1;else if(i=Oh(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(ve(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ve(317));i[Gs]=e}else mc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Gn(e),i=!1}else vs!==null&&(cv(vs),vs=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||sn.current&1?_n===0&&(_n=3):bb())),e.updateQueue!==null&&(e.flags|=4),Gn(e),null);case 4:return pc(),tv(t,e),t===null&&au(e.stateNode.containerInfo),Gn(e),null;case 10:return rb(e.type._context),Gn(e),null;case 17:return _r(e.type)&&nf(),Gn(e),null;case 19:if(Xt(sn),i=e.memoizedState,i===null)return Gn(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)td(i,!1);else{if(_n!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=df(t),o!==null){for(e.flags|=128,td(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Zt(sn,sn.current&1|2),e.child}t=t.sibling}i.tail!==null&&hn()>gc&&(e.flags|=128,s=!0,td(i,!1),e.lanes=4194304)}else{if(!s)if(t=df(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),td(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!tn)return Gn(e),null}else 2*hn()-i.renderingStartTime>gc&&n!==1073741824&&(e.flags|=128,s=!0,td(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=hn(),e.sibling=null,n=sn.current,Zt(sn,s?n&1|2:n&1),e):(Gn(e),null);case 22:case 23:return yb(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Mr&1073741824&&(Gn(e),e.subtreeFlags&6&&(e.flags|=8192)):Gn(e),null;case 24:return null;case 25:return null}throw Error(ve(156,e.tag))}function J6(t,e){switch(Xy(e),e.tag){case 1:return _r(e.type)&&nf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return pc(),Xt(jr),Xt(er),lb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ob(e),null;case 13:if(Xt(sn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ve(340));mc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Xt(sn),null;case 4:return pc(),null;case 10:return rb(e.type._context),null;case 22:case 23:return yb(),null;case 24:return null;default:return null}}var Lh=!1,Yn=!1,X6=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function Rl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){dn(t,e,s)}else n.current=null}function nv(t,e,n){try{n()}catch(s){dn(t,e,s)}}var E_=!1;function eM(t,e){if(Lg=Jm,t=XS(),Yy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var a=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=t,m=null;t:for(;;){for(var p;h!==n||a!==0&&h.nodeType!==3||(l=o+a),h!==i||s!==0&&h.nodeType!==3||(c=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(p=h.firstChild)!==null;)m=h,h=p;for(;;){if(h===t)break t;if(m===n&&++d===a&&(l=o),m===i&&++u===s&&(c=o),(p=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=p}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for($g={focusedElem:t,selectionRange:n},Jm=!1,Ie=e;Ie!==null;)if(e=Ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ie=t;else for(;Ie!==null;){e=Ie;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var x=b.memoizedProps,g=b.memoizedState,y=e.stateNode,v=y.getSnapshotBeforeUpdate(e.elementType===e.type?x:ms(e.type,x),g);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ve(163))}}catch(j){dn(e,e.return,j)}if(t=e.sibling,t!==null){t.return=e.return,Ie=t;break}Ie=e.return}return b=E_,E_=!1,b}function Id(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,i!==void 0&&nv(e,n,i)}a=a.next}while(a!==s)}}function f0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function rv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Zk(t){var e=t.alternate;e!==null&&(t.alternate=null,Zk(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Gs],delete e[ou],delete e[qg],delete e[O6],delete e[F6])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Qk(t){return t.tag===5||t.tag===3||t.tag===4}function A_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Qk(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function sv(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=tf));else if(s!==4&&(t=t.child,t!==null))for(sv(t,e,n),t=t.sibling;t!==null;)sv(t,e,n),t=t.sibling}function av(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(av(t,e,n),t=t.sibling;t!==null;)av(t,e,n),t=t.sibling}var Bn=null,xs=!1;function Ha(t,e,n){for(n=n.child;n!==null;)Yk(t,e,n),n=n.sibling}function Yk(t,e,n){if(ea&&typeof ea.onCommitFiberUnmount=="function")try{ea.onCommitFiberUnmount(i0,n)}catch{}switch(n.tag){case 5:Yn||Rl(n,e);case 6:var s=Bn,a=xs;Bn=null,Ha(t,e,n),Bn=s,xs=a,Bn!==null&&(xs?(t=Bn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Bn.removeChild(n.stateNode));break;case 18:Bn!==null&&(xs?(t=Bn,n=n.stateNode,t.nodeType===8?Ip(t.parentNode,n):t.nodeType===1&&Ip(t,n),nu(t)):Ip(Bn,n.stateNode));break;case 4:s=Bn,a=xs,Bn=n.stateNode.containerInfo,xs=!0,Ha(t,e,n),Bn=s,xs=a;break;case 0:case 11:case 14:case 15:if(!Yn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&nv(n,e,o),a=a.next}while(a!==s)}Ha(t,e,n);break;case 1:if(!Yn&&(Rl(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(l){dn(n,e,l)}Ha(t,e,n);break;case 21:Ha(t,e,n);break;case 22:n.mode&1?(Yn=(s=Yn)||n.memoizedState!==null,Ha(t,e,n),Yn=s):Ha(t,e,n);break;default:Ha(t,e,n)}}function D_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new X6),e.forEach(function(s){var a=cM.bind(null,t,s);n.has(s)||(n.add(s),s.then(a,a))})}}function cs(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var a=n[s];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Bn=l.stateNode,xs=!1;break e;case 3:Bn=l.stateNode.containerInfo,xs=!0;break e;case 4:Bn=l.stateNode.containerInfo,xs=!0;break e}l=l.return}if(Bn===null)throw Error(ve(160));Yk(i,o,a),Bn=null,xs=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(d){dn(a,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Jk(e,t),e=e.sibling}function Jk(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(cs(e,t),Bs(t),s&4){try{Id(3,t,t.return),f0(3,t)}catch(x){dn(t,t.return,x)}try{Id(5,t,t.return)}catch(x){dn(t,t.return,x)}}break;case 1:cs(e,t),Bs(t),s&512&&n!==null&&Rl(n,n.return);break;case 5:if(cs(e,t),Bs(t),s&512&&n!==null&&Rl(n,n.return),t.flags&32){var a=t.stateNode;try{Jd(a,"")}catch(x){dn(t,t.return,x)}}if(s&4&&(a=t.stateNode,a!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&bS(a,i),Ag(l,o);var d=Ag(l,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];u==="style"?SS(a,h):u==="dangerouslySetInnerHTML"?_S(a,h):u==="children"?Jd(a,h):By(a,u,h,d)}switch(l){case"input":Ng(a,i);break;case"textarea":wS(a,i);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var p=i.value;p!=null?Ll(a,!!i.multiple,p,!1):m!==!!i.multiple&&(i.defaultValue!=null?Ll(a,!!i.multiple,i.defaultValue,!0):Ll(a,!!i.multiple,i.multiple?[]:"",!1))}a[ou]=i}catch(x){dn(t,t.return,x)}}break;case 6:if(cs(e,t),Bs(t),s&4){if(t.stateNode===null)throw Error(ve(162));a=t.stateNode,i=t.memoizedProps;try{a.nodeValue=i}catch(x){dn(t,t.return,x)}}break;case 3:if(cs(e,t),Bs(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{nu(e.containerInfo)}catch(x){dn(t,t.return,x)}break;case 4:cs(e,t),Bs(t);break;case 13:cs(e,t),Bs(t),a=t.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(gb=hn())),s&4&&D_(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(Yn=(d=Yn)||u,cs(e,t),Yn=d):cs(e,t),Bs(t),s&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(Ie=t,u=t.child;u!==null;){for(h=Ie=u;Ie!==null;){switch(m=Ie,p=m.child,m.tag){case 0:case 11:case 14:case 15:Id(4,m,m.return);break;case 1:Rl(m,m.return);var b=m.stateNode;if(typeof b.componentWillUnmount=="function"){s=m,n=m.return;try{e=s,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(x){dn(s,n,x)}}break;case 5:Rl(m,m.return);break;case 22:if(m.memoizedState!==null){T_(h);continue}}p!==null?(p.return=m,Ie=p):T_(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{a=h.stateNode,d?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=NS("display",o))}catch(x){dn(t,t.return,x)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(x){dn(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:cs(e,t),Bs(t),s&4&&D_(t);break;case 21:break;default:cs(e,t),Bs(t)}}function Bs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Qk(n)){var s=n;break e}n=n.return}throw Error(ve(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(Jd(a,""),s.flags&=-33);var i=A_(t);av(t,i,a);break;case 3:case 4:var o=s.stateNode.containerInfo,l=A_(t);sv(t,l,o);break;default:throw Error(ve(161))}}catch(c){dn(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tM(t,e,n){Ie=t,Xk(t)}function Xk(t,e,n){for(var s=(t.mode&1)!==0;Ie!==null;){var a=Ie,i=a.child;if(a.tag===22&&s){var o=a.memoizedState!==null||Lh;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||Yn;l=Lh;var d=Yn;if(Lh=o,(Yn=c)&&!d)for(Ie=a;Ie!==null;)o=Ie,c=o.child,o.tag===22&&o.memoizedState!==null?R_(a):c!==null?(c.return=o,Ie=c):R_(a);for(;i!==null;)Ie=i,Xk(i),i=i.sibling;Ie=a,Lh=l,Yn=d}P_(t)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Ie=i):P_(t)}}function P_(t){for(;Ie!==null;){var e=Ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Yn||f0(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Yn)if(n===null)s.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:ms(e.type,n.memoizedProps);s.componentDidUpdate(a,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&p_(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}p_(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&nu(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ve(163))}Yn||e.flags&512&&rv(e)}catch(m){dn(e,e.return,m)}}if(e===t){Ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,Ie=n;break}Ie=e.return}}function T_(t){for(;Ie!==null;){var e=Ie;if(e===t){Ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Ie=n;break}Ie=e.return}}function R_(t){for(;Ie!==null;){var e=Ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{f0(4,e)}catch(c){dn(e,n,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var a=e.return;try{s.componentDidMount()}catch(c){dn(e,a,c)}}var i=e.return;try{rv(e)}catch(c){dn(e,i,c)}break;case 5:var o=e.return;try{rv(e)}catch(c){dn(e,o,c)}}}catch(c){dn(e,e.return,c)}if(e===t){Ie=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Ie=l;break}Ie=e.return}}var nM=Math.ceil,mf=$a.ReactCurrentDispatcher,pb=$a.ReactCurrentOwner,rs=$a.ReactCurrentBatchConfig,Ot=0,In=null,pn=null,qn=0,Mr=0,Ml=Gi(0),_n=0,mu=null,Ro=0,p0=0,xb=0,Od=null,yr=null,gb=0,gc=1/0,_a=null,ff=!1,iv=null,Di=null,$h=!1,bi=null,pf=0,Fd=0,ov=null,Sm=-1,km=0;function or(){return Ot&6?hn():Sm!==-1?Sm:Sm=hn()}function Pi(t){return t.mode&1?Ot&2&&qn!==0?qn&-qn:L6.transition!==null?(km===0&&(km=FS()),km):(t=Vt,t!==0||(t=window.event,t=t===void 0?16:WS(t.type)),t):1}function Ns(t,e,n,s){if(50<Fd)throw Fd=0,ov=null,Error(ve(185));Vu(t,n,s),(!(Ot&2)||t!==In)&&(t===In&&(!(Ot&2)&&(p0|=n),_n===4&&oi(t,qn)),Nr(t,s),n===1&&Ot===0&&!(e.mode&1)&&(gc=hn()+500,u0&&Zi()))}function Nr(t,e){var n=t.callbackNode;L5(t,e);var s=Ym(t,t===In?qn:0);if(s===0)n!==null&&Uj(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&Uj(n),e===1)t.tag===0?B6(M_.bind(null,t)):ck(M_.bind(null,t)),M6(function(){!(Ot&6)&&Zi()}),n=null;else{switch(BS(s)){case 1:n=qy;break;case 4:n=IS;break;case 16:n=Qm;break;case 536870912:n=OS;break;default:n=Qm}n=oC(n,eC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function eC(t,e){if(Sm=-1,km=0,Ot&6)throw Error(ve(327));var n=t.callbackNode;if(Wl()&&t.callbackNode!==n)return null;var s=Ym(t,t===In?qn:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=xf(t,s);else{e=s;var a=Ot;Ot|=2;var i=nC();(In!==t||qn!==e)&&(_a=null,gc=hn()+500,So(t,e));do try{aM();break}catch(l){tC(t,l)}while(!0);nb(),mf.current=i,Ot=a,pn!==null?e=0:(In=null,qn=0,e=_n)}if(e!==0){if(e===2&&(a=Mg(t),a!==0&&(s=a,e=lv(t,a))),e===1)throw n=mu,So(t,0),oi(t,s),Nr(t,hn()),n;if(e===6)oi(t,s);else{if(a=t.current.alternate,!(s&30)&&!rM(a)&&(e=xf(t,s),e===2&&(i=Mg(t),i!==0&&(s=i,e=lv(t,i))),e===1))throw n=mu,So(t,0),oi(t,s),Nr(t,hn()),n;switch(t.finishedWork=a,t.finishedLanes=s,e){case 0:case 1:throw Error(ve(345));case 2:io(t,yr,_a);break;case 3:if(oi(t,s),(s&130023424)===s&&(e=gb+500-hn(),10<e)){if(Ym(t,0)!==0)break;if(a=t.suspendedLanes,(a&s)!==s){or(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=Ug(io.bind(null,t,yr,_a),e);break}io(t,yr,_a);break;case 4:if(oi(t,s),(s&4194240)===s)break;for(e=t.eventTimes,a=-1;0<s;){var o=31-_s(s);i=1<<o,o=e[o],o>a&&(a=o),s&=~i}if(s=a,s=hn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*nM(s/1960))-s,10<s){t.timeoutHandle=Ug(io.bind(null,t,yr,_a),s);break}io(t,yr,_a);break;case 5:io(t,yr,_a);break;default:throw Error(ve(329))}}}return Nr(t,hn()),t.callbackNode===n?eC.bind(null,t):null}function lv(t,e){var n=Od;return t.current.memoizedState.isDehydrated&&(So(t,e).flags|=256),t=xf(t,e),t!==2&&(e=yr,yr=n,e!==null&&cv(e)),t}function cv(t){yr===null?yr=t:yr.push.apply(yr,t)}function rM(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var a=n[s],i=a.getSnapshot;a=a.value;try{if(!Es(i(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function oi(t,e){for(e&=~xb,e&=~p0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-_s(e),s=1<<n;t[n]=-1,e&=~s}}function M_(t){if(Ot&6)throw Error(ve(327));Wl();var e=Ym(t,0);if(!(e&1))return Nr(t,hn()),null;var n=xf(t,e);if(t.tag!==0&&n===2){var s=Mg(t);s!==0&&(e=s,n=lv(t,s))}if(n===1)throw n=mu,So(t,0),oi(t,e),Nr(t,hn()),n;if(n===6)throw Error(ve(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,io(t,yr,_a),Nr(t,hn()),null}function vb(t,e){var n=Ot;Ot|=1;try{return t(e)}finally{Ot=n,Ot===0&&(gc=hn()+500,u0&&Zi())}}function Mo(t){bi!==null&&bi.tag===0&&!(Ot&6)&&Wl();var e=Ot;Ot|=1;var n=rs.transition,s=Vt;try{if(rs.transition=null,Vt=1,t)return t()}finally{Vt=s,rs.transition=n,Ot=e,!(Ot&6)&&Zi()}}function yb(){Mr=Ml.current,Xt(Ml)}function So(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,R6(n)),pn!==null)for(n=pn.return;n!==null;){var s=n;switch(Xy(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&nf();break;case 3:pc(),Xt(jr),Xt(er),lb();break;case 5:ob(s);break;case 4:pc();break;case 13:Xt(sn);break;case 19:Xt(sn);break;case 10:rb(s.type._context);break;case 22:case 23:yb()}n=n.return}if(In=t,pn=t=Ti(t.current,null),qn=Mr=e,_n=0,mu=null,xb=p0=Ro=0,yr=Od=null,fo!==null){for(e=0;e<fo.length;e++)if(n=fo[e],s=n.interleaved,s!==null){n.interleaved=null;var a=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=a,s.next=o}n.pending=s}fo=null}return t}function tC(t,e){do{var n=pn;try{if(nb(),jm.current=hf,uf){for(var s=on.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}uf=!1}if(To=0,Pn=wn=on=null,Md=!1,du=0,pb.current=null,n===null||n.return===null){_n=1,mu=e,pn=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=qn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=w_(o);if(p!==null){p.flags&=-257,j_(p,o,l,i,e),p.mode&1&&b_(i,d,e),e=p,c=d;var b=e.updateQueue;if(b===null){var x=new Set;x.add(c),e.updateQueue=x}else b.add(c);break e}else{if(!(e&1)){b_(i,d,e),bb();break e}c=Error(ve(426))}}else if(tn&&l.mode&1){var g=w_(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),j_(g,o,l,i,e),eb(xc(c,l));break e}}i=c=xc(c,l),_n!==4&&(_n=2),Od===null?Od=[i]:Od.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=Bk(i,c,e);f_(i,y);break e;case 1:l=c;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Di===null||!Di.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var j=Lk(i,l,e);f_(i,j);break e}}i=i.return}while(i!==null)}sC(n)}catch(S){e=S,pn===n&&n!==null&&(pn=n=n.return);continue}break}while(!0)}function nC(){var t=mf.current;return mf.current=hf,t===null?hf:t}function bb(){(_n===0||_n===3||_n===2)&&(_n=4),In===null||!(Ro&268435455)&&!(p0&268435455)||oi(In,qn)}function xf(t,e){var n=Ot;Ot|=2;var s=nC();(In!==t||qn!==e)&&(_a=null,So(t,e));do try{sM();break}catch(a){tC(t,a)}while(!0);if(nb(),Ot=n,mf.current=s,pn!==null)throw Error(ve(261));return In=null,qn=0,_n}function sM(){for(;pn!==null;)rC(pn)}function aM(){for(;pn!==null&&!D5();)rC(pn)}function rC(t){var e=iC(t.alternate,t,Mr);t.memoizedProps=t.pendingProps,e===null?sC(t):pn=e,pb.current=null}function sC(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=J6(n,e),n!==null){n.flags&=32767,pn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{_n=6,pn=null;return}}else if(n=Y6(n,e,Mr),n!==null){pn=n;return}if(e=e.sibling,e!==null){pn=e;return}pn=e=t}while(e!==null);_n===0&&(_n=5)}function io(t,e,n){var s=Vt,a=rs.transition;try{rs.transition=null,Vt=1,iM(t,e,n,s)}finally{rs.transition=a,Vt=s}return null}function iM(t,e,n,s){do Wl();while(bi!==null);if(Ot&6)throw Error(ve(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ve(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if($5(t,i),t===In&&(pn=In=null,qn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||$h||($h=!0,oC(Qm,function(){return Wl(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=rs.transition,rs.transition=null;var o=Vt;Vt=1;var l=Ot;Ot|=4,pb.current=null,eM(t,n),Jk(n,t),k6($g),Jm=!!Lg,$g=Lg=null,t.current=n,tM(n),P5(),Ot=l,Vt=o,rs.transition=i}else t.current=n;if($h&&($h=!1,bi=t,pf=a),i=t.pendingLanes,i===0&&(Di=null),M5(n.stateNode),Nr(t,hn()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],s(a.value,{componentStack:a.stack,digest:a.digest});if(ff)throw ff=!1,t=iv,iv=null,t;return pf&1&&t.tag!==0&&Wl(),i=t.pendingLanes,i&1?t===ov?Fd++:(Fd=0,ov=t):Fd=0,Zi(),null}function Wl(){if(bi!==null){var t=BS(pf),e=rs.transition,n=Vt;try{if(rs.transition=null,Vt=16>t?16:t,bi===null)var s=!1;else{if(t=bi,bi=null,pf=0,Ot&6)throw Error(ve(331));var a=Ot;for(Ot|=4,Ie=t.current;Ie!==null;){var i=Ie,o=i.child;if(Ie.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(Ie=d;Ie!==null;){var u=Ie;switch(u.tag){case 0:case 11:case 15:Id(8,u,i)}var h=u.child;if(h!==null)h.return=u,Ie=h;else for(;Ie!==null;){u=Ie;var m=u.sibling,p=u.return;if(Zk(u),u===d){Ie=null;break}if(m!==null){m.return=p,Ie=m;break}Ie=p}}}var b=i.alternate;if(b!==null){var x=b.child;if(x!==null){b.child=null;do{var g=x.sibling;x.sibling=null,x=g}while(x!==null)}}Ie=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Ie=o;else e:for(;Ie!==null;){if(i=Ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Id(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,Ie=y;break e}Ie=i.return}}var v=t.current;for(Ie=v;Ie!==null;){o=Ie;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Ie=w;else e:for(o=v;Ie!==null;){if(l=Ie,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:f0(9,l)}}catch(S){dn(l,l.return,S)}if(l===o){Ie=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,Ie=j;break e}Ie=l.return}}if(Ot=a,Zi(),ea&&typeof ea.onPostCommitFiberRoot=="function")try{ea.onPostCommitFiberRoot(i0,t)}catch{}s=!0}return s}finally{Vt=n,rs.transition=e}}return!1}function I_(t,e,n){e=xc(n,e),e=Bk(t,e,1),t=Ai(t,e,1),e=or(),t!==null&&(Vu(t,1,e),Nr(t,e))}function dn(t,e,n){if(t.tag===3)I_(t,t,n);else for(;e!==null;){if(e.tag===3){I_(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Di===null||!Di.has(s))){t=xc(n,t),t=Lk(e,t,1),e=Ai(e,t,1),t=or(),e!==null&&(Vu(e,1,t),Nr(e,t));break}}e=e.return}}function oM(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=or(),t.pingedLanes|=t.suspendedLanes&n,In===t&&(qn&n)===n&&(_n===4||_n===3&&(qn&130023424)===qn&&500>hn()-gb?So(t,0):xb|=n),Nr(t,e)}function aC(t,e){e===0&&(t.mode&1?(e=Dh,Dh<<=1,!(Dh&130023424)&&(Dh=4194304)):e=1);var n=or();t=Ra(t,e),t!==null&&(Vu(t,e,n),Nr(t,n))}function lM(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),aC(t,n)}function cM(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(ve(314))}s!==null&&s.delete(e),aC(t,n)}var iC;iC=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||jr.current)wr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return wr=!1,Q6(t,e,n);wr=!!(t.flags&131072)}else wr=!1,tn&&e.flags&1048576&&dk(e,af,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Nm(t,e),t=e.pendingProps;var a=hc(e,er.current);ql(e,n),a=db(null,e,s,t,a,n);var i=ub();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_r(s)?(i=!0,rf(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,ab(e),a.updater=m0,e.stateNode=a,a._reactInternals=e,Zg(e,s,t,n),e=Jg(null,e,s,!0,i,n)):(e.tag=0,tn&&i&&Jy(e),ir(null,e,a,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Nm(t,e),t=e.pendingProps,a=s._init,s=a(s._payload),e.type=s,a=e.tag=uM(s),t=ms(s,t),a){case 0:e=Yg(null,e,s,t,n);break e;case 1:e=S_(null,e,s,t,n);break e;case 11:e=__(null,e,s,t,n);break e;case 14:e=N_(null,e,s,ms(s.type,t),n);break e}throw Error(ve(306,s,""))}return e;case 0:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:ms(s,a),Yg(t,e,s,a,n);case 1:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:ms(s,a),S_(t,e,s,a,n);case 3:e:{if(qk(e),t===null)throw Error(ve(387));s=e.pendingProps,i=e.memoizedState,a=i.element,xk(t,e),cf(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=xc(Error(ve(423)),e),e=k_(t,e,s,n,a);break e}else if(s!==a){a=xc(Error(ve(424)),e),e=k_(t,e,s,n,a);break e}else for(Or=Ei(e.stateNode.containerInfo.firstChild),Br=e,tn=!0,vs=null,n=fk(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(mc(),s===a){e=Ma(t,e,n);break e}ir(t,e,s,n)}e=e.child}return e;case 5:return gk(e),t===null&&Vg(e),s=e.type,a=e.pendingProps,i=t!==null?t.memoizedProps:null,o=a.children,zg(s,a)?o=null:i!==null&&zg(s,i)&&(e.flags|=32),Uk(t,e),ir(t,e,o,n),e.child;case 6:return t===null&&Vg(e),null;case 13:return Wk(t,e,n);case 4:return ib(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=fc(e,null,s,n):ir(t,e,s,n),e.child;case 11:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:ms(s,a),__(t,e,s,a,n);case 7:return ir(t,e,e.pendingProps,n),e.child;case 8:return ir(t,e,e.pendingProps.children,n),e.child;case 12:return ir(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,a=e.pendingProps,i=e.memoizedProps,o=a.value,Zt(of,s._currentValue),s._currentValue=o,i!==null)if(Es(i.value,o)){if(i.children===a.children&&!jr.current){e=Ma(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=Aa(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Kg(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(ve(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Kg(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ir(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,s=e.pendingProps.children,ql(e,n),a=as(a),s=s(a),e.flags|=1,ir(t,e,s,n),e.child;case 14:return s=e.type,a=ms(s,e.pendingProps),a=ms(s.type,a),N_(t,e,s,a,n);case 15:return $k(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,a=e.pendingProps,a=e.elementType===s?a:ms(s,a),Nm(t,e),e.tag=1,_r(s)?(t=!0,rf(e)):t=!1,ql(e,n),Fk(e,s,a),Zg(e,s,a,n),Jg(null,e,s,!0,t,n);case 19:return Hk(t,e,n);case 22:return zk(t,e,n)}throw Error(ve(156,e.tag))};function oC(t,e){return MS(t,e)}function dM(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ts(t,e,n,s){return new dM(t,e,n,s)}function wb(t){return t=t.prototype,!(!t||!t.isReactComponent)}function uM(t){if(typeof t=="function")return wb(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$y)return 11;if(t===zy)return 14}return 2}function Ti(t,e){var n=t.alternate;return n===null?(n=ts(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Cm(t,e,n,s,a,i){var o=2;if(s=t,typeof t=="function")wb(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Nl:return ko(n.children,a,i,e);case Ly:o=8,a|=8;break;case yg:return t=ts(12,n,e,a|2),t.elementType=yg,t.lanes=i,t;case bg:return t=ts(13,n,e,a),t.elementType=bg,t.lanes=i,t;case wg:return t=ts(19,n,e,a),t.elementType=wg,t.lanes=i,t;case gS:return x0(n,a,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case pS:o=10;break e;case xS:o=9;break e;case $y:o=11;break e;case zy:o=14;break e;case ni:o=16,s=null;break e}throw Error(ve(130,t==null?t:typeof t,""))}return e=ts(o,n,e,a),e.elementType=t,e.type=s,e.lanes=i,e}function ko(t,e,n,s){return t=ts(7,t,s,e),t.lanes=n,t}function x0(t,e,n,s){return t=ts(22,t,s,e),t.elementType=gS,t.lanes=n,t.stateNode={isHidden:!1},t}function qp(t,e,n){return t=ts(6,t,null,e),t.lanes=n,t}function Wp(t,e,n){return e=ts(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function hM(t,e,n,s,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Np(0),this.expirationTimes=Np(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Np(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function jb(t,e,n,s,a,i,o,l,c){return t=new hM(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ts(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ab(i),t}function mM(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_l,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function lC(t){if(!t)return Oi;t=t._reactInternals;e:{if(Vo(t)!==t||t.tag!==1)throw Error(ve(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_r(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ve(171))}if(t.tag===1){var n=t.type;if(_r(n))return lk(t,n,e)}return e}function cC(t,e,n,s,a,i,o,l,c){return t=jb(n,s,!0,t,a,i,o,l,c),t.context=lC(null),n=t.current,s=or(),a=Pi(n),i=Aa(s,a),i.callback=e??null,Ai(n,i,a),t.current.lanes=a,Vu(t,a,s),Nr(t,s),t}function g0(t,e,n,s){var a=e.current,i=or(),o=Pi(a);return n=lC(n),e.context===null?e.context=n:e.pendingContext=n,e=Aa(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Ai(a,e,o),t!==null&&(Ns(t,a,o,i),wm(t,a,o)),o}function gf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function O_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function _b(t,e){O_(t,e),(t=t.alternate)&&O_(t,e)}function fM(){return null}var dC=typeof reportError=="function"?reportError:function(t){console.error(t)};function Nb(t){this._internalRoot=t}v0.prototype.render=Nb.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ve(409));g0(t,e,null,null)};v0.prototype.unmount=Nb.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Mo(function(){g0(null,t,null,null)}),e[Ta]=null}};function v0(t){this._internalRoot=t}v0.prototype.unstable_scheduleHydration=function(t){if(t){var e=zS();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ii.length&&e!==0&&e<ii[n].priority;n++);ii.splice(n,0,t),n===0&&qS(t)}};function Sb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function y0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function F_(){}function pM(t,e,n,s,a){if(a){if(typeof s=="function"){var i=s;s=function(){var d=gf(o);i.call(d)}}var o=cC(e,s,t,0,null,!1,!1,"",F_);return t._reactRootContainer=o,t[Ta]=o.current,au(t.nodeType===8?t.parentNode:t),Mo(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof s=="function"){var l=s;s=function(){var d=gf(c);l.call(d)}}var c=jb(t,0,!1,null,null,!1,!1,"",F_);return t._reactRootContainer=c,t[Ta]=c.current,au(t.nodeType===8?t.parentNode:t),Mo(function(){g0(e,c,n,s)}),c}function b0(t,e,n,s,a){var i=n._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var c=gf(o);l.call(c)}}g0(e,o,t,a)}else o=pM(n,e,t,a,s);return gf(o)}LS=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ud(e.pendingLanes);n!==0&&(Wy(e,n|1),Nr(e,hn()),!(Ot&6)&&(gc=hn()+500,Zi()))}break;case 13:Mo(function(){var s=Ra(t,1);if(s!==null){var a=or();Ns(s,t,1,a)}}),_b(t,1)}};Hy=function(t){if(t.tag===13){var e=Ra(t,134217728);if(e!==null){var n=or();Ns(e,t,134217728,n)}_b(t,134217728)}};$S=function(t){if(t.tag===13){var e=Pi(t),n=Ra(t,e);if(n!==null){var s=or();Ns(n,t,e,s)}_b(t,e)}};zS=function(){return Vt};US=function(t,e){var n=Vt;try{return Vt=t,e()}finally{Vt=n}};Pg=function(t,e,n){switch(e){case"input":if(Ng(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var a=d0(s);if(!a)throw Error(ve(90));yS(s),Ng(s,a)}}}break;case"textarea":wS(t,n);break;case"select":e=n.value,e!=null&&Ll(t,!!n.multiple,e,!1)}};ES=vb;AS=Mo;var xM={usingClientEntryPoint:!1,Events:[Gu,El,d0,kS,CS,vb]},nd={findFiberByHostInstance:mo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gM={bundleType:nd.bundleType,version:nd.version,rendererPackageName:nd.rendererPackageName,rendererConfig:nd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$a.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=TS(t),t===null?null:t.stateNode},findFiberByHostInstance:nd.findFiberByHostInstance||fM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zh.isDisabled&&zh.supportsFiber)try{i0=zh.inject(gM),ea=zh}catch{}}Kr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xM;Kr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sb(e))throw Error(ve(200));return mM(t,e,null,n)};Kr.createRoot=function(t,e){if(!Sb(t))throw Error(ve(299));var n=!1,s="",a=dC;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=jb(t,1,!1,null,null,n,!1,s,a),t[Ta]=e.current,au(t.nodeType===8?t.parentNode:t),new Nb(e)};Kr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ve(188)):(t=Object.keys(t).join(","),Error(ve(268,t)));return t=TS(e),t=t===null?null:t.stateNode,t};Kr.flushSync=function(t){return Mo(t)};Kr.hydrate=function(t,e,n){if(!y0(e))throw Error(ve(200));return b0(null,t,e,!0,n)};Kr.hydrateRoot=function(t,e,n){if(!Sb(t))throw Error(ve(405));var s=n!=null&&n.hydratedSources||null,a=!1,i="",o=dC;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=cC(e,null,t,1,n??null,a,!1,i,o),t[Ta]=e.current,au(t),s)for(t=0;t<s.length;t++)n=s[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new v0(e)};Kr.render=function(t,e,n){if(!y0(e))throw Error(ve(200));return b0(null,t,e,!1,n)};Kr.unmountComponentAtNode=function(t){if(!y0(t))throw Error(ve(40));return t._reactRootContainer?(Mo(function(){b0(null,null,t,!1,function(){t._reactRootContainer=null,t[Ta]=null})}),!0):!1};Kr.unstable_batchedUpdates=vb;Kr.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!y0(n))throw Error(ve(200));if(t==null||t._reactInternals===void 0)throw Error(ve(38));return b0(t,e,n,!1,s)};Kr.version="18.3.1-next-f1338f8080-20240426";function uC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uC)}catch(t){console.error(t)}}uC(),uS.exports=Kr;var Ko=uS.exports;const hC=Y2(Ko);var mC,B_=Ko;mC=B_.createRoot,B_.hydrateRoot;const vM=1,yM=1e6;let Hp=0;function bM(){return Hp=(Hp+1)%Number.MAX_SAFE_INTEGER,Hp.toString()}const Vp=new Map,L_=t=>{if(Vp.has(t))return;const e=setTimeout(()=>{Vp.delete(t),Bd({type:"REMOVE_TOAST",toastId:t})},yM);Vp.set(t,e)},wM=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,vM)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?L_(n):t.toasts.forEach(s=>{L_(s.id)}),{...t,toasts:t.toasts.map(s=>s.id===n||n===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},Em=[];let Am={toasts:[]};function Bd(t){Am=wM(Am,t),Em.forEach(e=>{e(Am)})}function Ks({...t}){const e=bM(),n=a=>Bd({type:"UPDATE_TOAST",toast:{...a,id:e}}),s=()=>Bd({type:"DISMISS_TOAST",toastId:e});return Bd({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:a=>{a||s()}}}),{id:e,dismiss:s,update:n}}function pt(){const[t,e]=f.useState(Am);return f.useEffect(()=>(Em.push(e),()=>{const n=Em.indexOf(e);n>-1&&Em.splice(n,1)}),[t]),{...t,toast:Ks,dismiss:n=>Bd({type:"DISMISS_TOAST",toastId:n})}}function be(t,e,{checkForDefaultPrevented:n=!0}={}){return function(a){if(t==null||t(a),n===!1||!a.defaultPrevented)return e==null?void 0:e(a)}}function jM(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function w0(...t){return e=>t.forEach(n=>jM(n,e))}function yt(...t){return f.useCallback(w0(...t),t)}function _M(t,e=[]){let n=[];function s(i,o){const l=f.createContext(o),c=n.length;n=[...n,o];function d(h){const{scope:m,children:p,...b}=h,x=(m==null?void 0:m[t][c])||l,g=f.useMemo(()=>b,Object.values(b));return r.jsx(x.Provider,{value:g,children:p})}function u(h,m){const p=(m==null?void 0:m[t][c])||l,b=f.useContext(p);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return d.displayName=i+"Provider",[d,u]}const a=()=>{const i=n.map(o=>f.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return f.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return a.scopeName=t,[s,NM(a,...e)]}function NM(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return f.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var Ia=f.forwardRef((t,e)=>{const{children:n,...s}=t,a=f.Children.toArray(n),i=a.find(SM);if(i){const o=i.props.children,l=a.map(c=>c===i?f.Children.count(o)>1?f.Children.only(null):f.isValidElement(o)?o.props.children:null:c);return r.jsx(dv,{...s,ref:e,children:f.isValidElement(o)?f.cloneElement(o,void 0,l):null})}return r.jsx(dv,{...s,ref:e,children:n})});Ia.displayName="Slot";var dv=f.forwardRef((t,e)=>{const{children:n,...s}=t;if(f.isValidElement(n)){const a=CM(n);return f.cloneElement(n,{...kM(s,n.props),ref:e?w0(e,a):a})}return f.Children.count(n)>1?f.Children.only(null):null});dv.displayName="SlotClone";var fC=({children:t})=>r.jsx(r.Fragment,{children:t});function SM(t){return f.isValidElement(t)&&t.type===fC}function kM(t,e){const n={...e};for(const s in e){const a=t[s],i=e[s];/^on[A-Z]/.test(s)?a&&i?n[s]=(...l)=>{i(...l),a(...l)}:a&&(n[s]=a):s==="style"?n[s]={...a,...i}:s==="className"&&(n[s]=[a,i].filter(Boolean).join(" "))}return{...t,...n}}function CM(t){var s,a;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Qu(t){const e=t+"CollectionProvider",[n,s]=_M(e),[a,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=p=>{const{scope:b,children:x}=p,g=ge.useRef(null),y=ge.useRef(new Map).current;return r.jsx(a,{scope:b,itemMap:y,collectionRef:g,children:x})};o.displayName=e;const l=t+"CollectionSlot",c=ge.forwardRef((p,b)=>{const{scope:x,children:g}=p,y=i(l,x),v=yt(b,y.collectionRef);return r.jsx(Ia,{ref:v,children:g})});c.displayName=l;const d=t+"CollectionItemSlot",u="data-radix-collection-item",h=ge.forwardRef((p,b)=>{const{scope:x,children:g,...y}=p,v=ge.useRef(null),w=yt(b,v),j=i(d,x);return ge.useEffect(()=>(j.itemMap.set(v,{ref:v,...y}),()=>void j.itemMap.delete(v))),r.jsx(Ia,{[u]:"",ref:w,children:g})});h.displayName=d;function m(p){const b=i(t+"CollectionConsumer",p);return ge.useCallback(()=>{const g=b.collectionRef.current;if(!g)return[];const y=Array.from(g.querySelectorAll(`[${u}]`));return Array.from(b.itemMap.values()).sort((j,S)=>y.indexOf(j.ref.current)-y.indexOf(S.ref.current))},[b.collectionRef,b.itemMap])}return[{Provider:o,Slot:c,ItemSlot:h},m,s]}function EM(t,e){const n=f.createContext(e),s=i=>{const{children:o,...l}=i,c=f.useMemo(()=>l,Object.values(l));return r.jsx(n.Provider,{value:c,children:o})};s.displayName=t+"Provider";function a(i){const o=f.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[s,a]}function Zr(t,e=[]){let n=[];function s(i,o){const l=f.createContext(o),c=n.length;n=[...n,o];const d=h=>{var y;const{scope:m,children:p,...b}=h,x=((y=m==null?void 0:m[t])==null?void 0:y[c])||l,g=f.useMemo(()=>b,Object.values(b));return r.jsx(x.Provider,{value:g,children:p})};d.displayName=i+"Provider";function u(h,m){var x;const p=((x=m==null?void 0:m[t])==null?void 0:x[c])||l,b=f.useContext(p);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=n.map(o=>f.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return f.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return a.scopeName=t,[s,AM(a,...e)]}function AM(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return f.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var DM=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Le=DM.reduce((t,e)=>{const n=f.forwardRef((s,a)=>{const{asChild:i,...o}=s,l=i?Ia:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),r.jsx(l,{...o,ref:a})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function kb(t,e){t&&Ko.flushSync(()=>t.dispatchEvent(e))}function nn(t){const e=f.useRef(t);return f.useEffect(()=>{e.current=t}),f.useMemo(()=>(...n)=>{var s;return(s=e.current)==null?void 0:s.call(e,...n)},[])}function PM(t,e=globalThis==null?void 0:globalThis.document){const n=nn(t);f.useEffect(()=>{const s=a=>{a.key==="Escape"&&n(a)};return e.addEventListener("keydown",s,{capture:!0}),()=>e.removeEventListener("keydown",s,{capture:!0})},[n,e])}var TM="DismissableLayer",uv="dismissableLayer.update",RM="dismissableLayer.pointerDownOutside",MM="dismissableLayer.focusOutside",$_,pC=f.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Go=f.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=t,d=f.useContext(pC),[u,h]=f.useState(null),m=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=f.useState({}),b=yt(e,k=>h(k)),x=Array.from(d.layers),[g]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),y=x.indexOf(g),v=u?x.indexOf(u):-1,w=d.layersWithOutsidePointerEventsDisabled.size>0,j=v>=y,S=OM(k=>{const E=k.target,P=[...d.branches].some(A=>A.contains(E));!j||P||(a==null||a(k),o==null||o(k),k.defaultPrevented||l==null||l())},m),N=FM(k=>{const E=k.target;[...d.branches].some(A=>A.contains(E))||(i==null||i(k),o==null||o(k),k.defaultPrevented||l==null||l())},m);return PM(k=>{v===d.layers.size-1&&(s==null||s(k),!k.defaultPrevented&&l&&(k.preventDefault(),l()))},m),f.useEffect(()=>{if(u)return n&&(d.layersWithOutsidePointerEventsDisabled.size===0&&($_=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),z_(),()=>{n&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=$_)}},[u,m,n,d]),f.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),z_())},[u,d]),f.useEffect(()=>{const k=()=>p({});return document.addEventListener(uv,k),()=>document.removeEventListener(uv,k)},[]),r.jsx(Le.div,{...c,ref:b,style:{pointerEvents:w?j?"auto":"none":void 0,...t.style},onFocusCapture:be(t.onFocusCapture,N.onFocusCapture),onBlurCapture:be(t.onBlurCapture,N.onBlurCapture),onPointerDownCapture:be(t.onPointerDownCapture,S.onPointerDownCapture)})});Go.displayName=TM;var IM="DismissableLayerBranch",xC=f.forwardRef((t,e)=>{const n=f.useContext(pC),s=f.useRef(null),a=yt(e,s);return f.useEffect(()=>{const i=s.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),r.jsx(Le.div,{...t,ref:a})});xC.displayName=IM;function OM(t,e=globalThis==null?void 0:globalThis.document){const n=nn(t),s=f.useRef(!1),a=f.useRef(()=>{});return f.useEffect(()=>{const i=l=>{if(l.target&&!s.current){let c=function(){gC(RM,n,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",a.current),a.current=c,e.addEventListener("click",a.current,{once:!0})):c()}else e.removeEventListener("click",a.current);s.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",a.current)}},[e,n]),{onPointerDownCapture:()=>s.current=!0}}function FM(t,e=globalThis==null?void 0:globalThis.document){const n=nn(t),s=f.useRef(!1);return f.useEffect(()=>{const a=i=>{i.target&&!s.current&&gC(MM,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",a),()=>e.removeEventListener("focusin",a)},[e,n]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function z_(){const t=new CustomEvent(uv);document.dispatchEvent(t)}function gC(t,e,n,{discrete:s}){const a=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&a.addEventListener(t,e,{once:!0}),s?kb(a,i):a.dispatchEvent(i)}var BM=Go,LM=xC,gn=globalThis!=null&&globalThis.document?f.useLayoutEffect:()=>{},$M="Portal",Tc=f.forwardRef((t,e)=>{var l;const{container:n,...s}=t,[a,i]=f.useState(!1);gn(()=>i(!0),[]);const o=n||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?hC.createPortal(r.jsx(Le.div,{...s,ref:e}),o):null});Tc.displayName=$M;function zM(t,e){return f.useReducer((n,s)=>e[n][s]??n,t)}var Sn=t=>{const{present:e,children:n}=t,s=UM(e),a=typeof n=="function"?n({present:s.isPresent}):f.Children.only(n),i=yt(s.ref,qM(a));return typeof n=="function"||s.isPresent?f.cloneElement(a,{ref:i}):null};Sn.displayName="Presence";function UM(t){const[e,n]=f.useState(),s=f.useRef({}),a=f.useRef(t),i=f.useRef("none"),o=t?"mounted":"unmounted",[l,c]=zM(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return f.useEffect(()=>{const d=Uh(s.current);i.current=l==="mounted"?d:"none"},[l]),gn(()=>{const d=s.current,u=a.current;if(u!==t){const m=i.current,p=Uh(d);t?c("MOUNT"):p==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(u&&m!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,c]),gn(()=>{if(e){let d;const u=e.ownerDocument.defaultView??window,h=p=>{const x=Uh(s.current).includes(p.animationName);if(p.target===e&&x&&(c("ANIMATION_END"),!a.current)){const g=e.style.animationFillMode;e.style.animationFillMode="forwards",d=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=g)})}},m=p=>{p.target===e&&(i.current=Uh(s.current))};return e.addEventListener("animationstart",m),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(d),e.removeEventListener("animationstart",m),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:f.useCallback(d=>{d&&(s.current=getComputedStyle(d)),n(d)},[])}}function Uh(t){return(t==null?void 0:t.animationName)||"none"}function qM(t){var s,a;let e=(s=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function os({prop:t,defaultProp:e,onChange:n=()=>{}}){const[s,a]=WM({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:s,l=nn(n),c=f.useCallback(d=>{if(i){const h=typeof d=="function"?d(t):d;h!==t&&l(h)}else a(d)},[i,t,a,l]);return[o,c]}function WM({defaultProp:t,onChange:e}){const n=f.useState(t),[s]=n,a=f.useRef(s),i=nn(e);return f.useEffect(()=>{a.current!==s&&(i(s),a.current=s)},[s,a,i]),n}var HM="VisuallyHidden",Yu=f.forwardRef((t,e)=>r.jsx(Le.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));Yu.displayName=HM;var VM=Yu,Cb="ToastProvider",[Eb,KM,GM]=Qu("Toast"),[vC,lee]=Zr("Toast",[GM]),[ZM,j0]=vC(Cb),yC=t=>{const{__scopeToast:e,label:n="Notification",duration:s=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:o}=t,[l,c]=f.useState(null),[d,u]=f.useState(0),h=f.useRef(!1),m=f.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Cb}\`. Expected non-empty \`string\`.`),r.jsx(Eb.Provider,{scope:e,children:r.jsx(ZM,{scope:e,label:n,duration:s,swipeDirection:a,swipeThreshold:i,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:f.useCallback(()=>u(p=>p+1),[]),onToastRemove:f.useCallback(()=>u(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:m,children:o})})};yC.displayName=Cb;var bC="ToastViewport",QM=["F8"],hv="toast.viewportPause",mv="toast.viewportResume",wC=f.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:s=QM,label:a="Notifications ({hotkey})",...i}=t,o=j0(bC,n),l=KM(n),c=f.useRef(null),d=f.useRef(null),u=f.useRef(null),h=f.useRef(null),m=yt(e,h,o.onViewportChange),p=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),b=o.toastCount>0;f.useEffect(()=>{const g=y=>{var w;s.length!==0&&s.every(j=>y[j]||y.code===j)&&((w=h.current)==null||w.focus())};return document.addEventListener("keydown",g),()=>document.removeEventListener("keydown",g)},[s]),f.useEffect(()=>{const g=c.current,y=h.current;if(b&&g&&y){const v=()=>{if(!o.isClosePausedRef.current){const N=new CustomEvent(hv);y.dispatchEvent(N),o.isClosePausedRef.current=!0}},w=()=>{if(o.isClosePausedRef.current){const N=new CustomEvent(mv);y.dispatchEvent(N),o.isClosePausedRef.current=!1}},j=N=>{!g.contains(N.relatedTarget)&&w()},S=()=>{g.contains(document.activeElement)||w()};return g.addEventListener("focusin",v),g.addEventListener("focusout",j),g.addEventListener("pointermove",v),g.addEventListener("pointerleave",S),window.addEventListener("blur",v),window.addEventListener("focus",w),()=>{g.removeEventListener("focusin",v),g.removeEventListener("focusout",j),g.removeEventListener("pointermove",v),g.removeEventListener("pointerleave",S),window.removeEventListener("blur",v),window.removeEventListener("focus",w)}}},[b,o.isClosePausedRef]);const x=f.useCallback(({tabbingDirection:g})=>{const v=l().map(w=>{const j=w.ref.current,S=[j,...c8(j)];return g==="forwards"?S:S.reverse()});return(g==="forwards"?v.reverse():v).flat()},[l]);return f.useEffect(()=>{const g=h.current;if(g){const y=v=>{var S,N,k;const w=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!w){const E=document.activeElement,P=v.shiftKey;if(v.target===g&&P){(S=d.current)==null||S.focus();return}const T=x({tabbingDirection:P?"backwards":"forwards"}),I=T.findIndex(V=>V===E);Kp(T.slice(I+1))?v.preventDefault():P?(N=d.current)==null||N.focus():(k=u.current)==null||k.focus()}};return g.addEventListener("keydown",y),()=>g.removeEventListener("keydown",y)}},[l,x]),r.jsxs(LM,{ref:c,role:"region","aria-label":a.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:b?void 0:"none"},children:[b&&r.jsx(fv,{ref:d,onFocusFromOutsideViewport:()=>{const g=x({tabbingDirection:"forwards"});Kp(g)}}),r.jsx(Eb.Slot,{scope:n,children:r.jsx(Le.ol,{tabIndex:-1,...i,ref:m})}),b&&r.jsx(fv,{ref:u,onFocusFromOutsideViewport:()=>{const g=x({tabbingDirection:"backwards"});Kp(g)}})]})});wC.displayName=bC;var jC="ToastFocusProxy",fv=f.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:s,...a}=t,i=j0(jC,n);return r.jsx(Yu,{"aria-hidden":!0,tabIndex:0,...a,ref:e,style:{position:"fixed"},onFocus:o=>{var d;const l=o.relatedTarget;!((d=i.viewport)!=null&&d.contains(l))&&s()}})});fv.displayName=jC;var _0="Toast",YM="toast.swipeStart",JM="toast.swipeMove",XM="toast.swipeCancel",e8="toast.swipeEnd",_C=f.forwardRef((t,e)=>{const{forceMount:n,open:s,defaultOpen:a,onOpenChange:i,...o}=t,[l=!0,c]=os({prop:s,defaultProp:a,onChange:i});return r.jsx(Sn,{present:n||l,children:r.jsx(r8,{open:l,...o,ref:e,onClose:()=>c(!1),onPause:nn(t.onPause),onResume:nn(t.onResume),onSwipeStart:be(t.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:be(t.onSwipeMove,d=>{const{x:u,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:be(t.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:be(t.onSwipeEnd,d=>{const{x:u,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});_C.displayName=_0;var[t8,n8]=vC(_0,{onClose(){}}),r8=f.forwardRef((t,e)=>{const{__scopeToast:n,type:s="foreground",duration:a,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:m,onSwipeEnd:p,...b}=t,x=j0(_0,n),[g,y]=f.useState(null),v=yt(e,V=>y(V)),w=f.useRef(null),j=f.useRef(null),S=a||x.duration,N=f.useRef(0),k=f.useRef(S),E=f.useRef(0),{onToastAdd:P,onToastRemove:A}=x,C=nn(()=>{var ne;(g==null?void 0:g.contains(document.activeElement))&&((ne=x.viewport)==null||ne.focus()),o()}),T=f.useCallback(V=>{!V||V===1/0||(window.clearTimeout(E.current),N.current=new Date().getTime(),E.current=window.setTimeout(C,V))},[C]);f.useEffect(()=>{const V=x.viewport;if(V){const ne=()=>{T(k.current),d==null||d()},se=()=>{const q=new Date().getTime()-N.current;k.current=k.current-q,window.clearTimeout(E.current),c==null||c()};return V.addEventListener(hv,se),V.addEventListener(mv,ne),()=>{V.removeEventListener(hv,se),V.removeEventListener(mv,ne)}}},[x.viewport,S,c,d,T]),f.useEffect(()=>{i&&!x.isClosePausedRef.current&&T(S)},[i,S,x.isClosePausedRef,T]),f.useEffect(()=>(P(),()=>A()),[P,A]);const I=f.useMemo(()=>g?DC(g):null,[g]);return x.viewport?r.jsxs(r.Fragment,{children:[I&&r.jsx(s8,{__scopeToast:n,role:"status","aria-live":s==="foreground"?"assertive":"polite","aria-atomic":!0,children:I}),r.jsx(t8,{scope:n,onClose:C,children:Ko.createPortal(r.jsx(Eb.ItemSlot,{scope:n,children:r.jsx(BM,{asChild:!0,onEscapeKeyDown:be(l,()=>{x.isFocusedToastEscapeKeyDownRef.current||C(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:r.jsx(Le.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":x.swipeDirection,...b,ref:v,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:be(t.onKeyDown,V=>{V.key==="Escape"&&(l==null||l(V.nativeEvent),V.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,C()))}),onPointerDown:be(t.onPointerDown,V=>{V.button===0&&(w.current={x:V.clientX,y:V.clientY})}),onPointerMove:be(t.onPointerMove,V=>{if(!w.current)return;const ne=V.clientX-w.current.x,se=V.clientY-w.current.y,q=!!j.current,O=["left","right"].includes(x.swipeDirection),F=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,B=O?F(0,ne):0,R=O?0:F(0,se),D=V.pointerType==="touch"?10:2,L={x:B,y:R},M={originalEvent:V,delta:L};q?(j.current=L,qh(JM,h,M,{discrete:!1})):U_(L,x.swipeDirection,D)?(j.current=L,qh(YM,u,M,{discrete:!1}),V.target.setPointerCapture(V.pointerId)):(Math.abs(ne)>D||Math.abs(se)>D)&&(w.current=null)}),onPointerUp:be(t.onPointerUp,V=>{const ne=j.current,se=V.target;if(se.hasPointerCapture(V.pointerId)&&se.releasePointerCapture(V.pointerId),j.current=null,w.current=null,ne){const q=V.currentTarget,O={originalEvent:V,delta:ne};U_(ne,x.swipeDirection,x.swipeThreshold)?qh(e8,p,O,{discrete:!0}):qh(XM,m,O,{discrete:!0}),q.addEventListener("click",F=>F.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),s8=t=>{const{__scopeToast:e,children:n,...s}=t,a=j0(_0,e),[i,o]=f.useState(!1),[l,c]=f.useState(!1);return o8(()=>o(!0)),f.useEffect(()=>{const d=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(d)},[]),l?null:r.jsx(Tc,{asChild:!0,children:r.jsx(Yu,{...s,children:i&&r.jsxs(r.Fragment,{children:[a.label," ",n]})})})},a8="ToastTitle",NC=f.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t;return r.jsx(Le.div,{...s,ref:e})});NC.displayName=a8;var i8="ToastDescription",SC=f.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t;return r.jsx(Le.div,{...s,ref:e})});SC.displayName=i8;var kC="ToastAction",CC=f.forwardRef((t,e)=>{const{altText:n,...s}=t;return n.trim()?r.jsx(AC,{altText:n,asChild:!0,children:r.jsx(Ab,{...s,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${kC}\`. Expected non-empty \`string\`.`),null)});CC.displayName=kC;var EC="ToastClose",Ab=f.forwardRef((t,e)=>{const{__scopeToast:n,...s}=t,a=n8(EC,n);return r.jsx(AC,{asChild:!0,children:r.jsx(Le.button,{type:"button",...s,ref:e,onClick:be(t.onClick,a.onClose)})})});Ab.displayName=EC;var AC=f.forwardRef((t,e)=>{const{__scopeToast:n,altText:s,...a}=t;return r.jsx(Le.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...a,ref:e})});function DC(t){const e=[];return Array.from(t.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&e.push(s.textContent),l8(s)){const a=s.ariaHidden||s.hidden||s.style.display==="none",i=s.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const o=s.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...DC(s))}}),e}function qh(t,e,n,{discrete:s}){const a=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&a.addEventListener(t,e,{once:!0}),s?kb(a,i):a.dispatchEvent(i)}var U_=(t,e,n=0)=>{const s=Math.abs(t.x),a=Math.abs(t.y),i=s>a;return e==="left"||e==="right"?i&&s>n:!i&&a>n};function o8(t=()=>{}){const e=nn(t);gn(()=>{let n=0,s=0;return n=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(s)}},[e])}function l8(t){return t.nodeType===t.ELEMENT_NODE}function c8(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Kp(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var d8=yC,PC=wC,TC=_C,RC=NC,MC=SC,IC=CC,OC=Ab;function FC(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(n=FC(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function BC(){for(var t,e,n=0,s="",a=arguments.length;n<a;n++)(t=arguments[n])&&(e=FC(t))&&(s&&(s+=" "),s+=e);return s}const q_=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,W_=BC,Ju=(t,e)=>n=>{var s;if((e==null?void 0:e.variants)==null)return W_(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:i}=e,o=Object.keys(a).map(d=>{const u=n==null?void 0:n[d],h=i==null?void 0:i[d];if(u===null)return null;const m=q_(u)||q_(h);return a[d][m]}),l=n&&Object.entries(n).reduce((d,u)=>{let[h,m]=u;return m===void 0||(d[h]=m),d},{}),c=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((d,u)=>{let{class:h,className:m,...p}=u;return Object.entries(p).every(b=>{let[x,g]=b;return Array.isArray(g)?g.includes({...i,...l}[x]):{...i,...l}[x]===g})?[...d,h,m]:d},[]);return W_(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u8=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),LC=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var h8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m8=f.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:a="",children:i,iconNode:o,...l},c)=>f.createElement("svg",{ref:c,...h8,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:LC("lucide",a),...l},[...o.map(([d,u])=>f.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=(t,e)=>{const n=f.forwardRef(({className:s,...a},i)=>f.createElement(m8,{ref:i,iconNode:e,className:LC(`lucide-${u8(t)}`,s),...a}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f8=we("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $C=we("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N0=we("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p8=we("Battery",[["rect",{width:"16",height:"10",x:"2",y:"7",rx:"2",ry:"2",key:"1w10f2"}],["line",{x1:"22",x2:"22",y1:"11",y2:"13",key:"4dh1rd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x8=we("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g8=we("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v8=we("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wh=we("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xl=we("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=we("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=we("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=we("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hl=we("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zC=we("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ld=we("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=we("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S0=we("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=we("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Co=we("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y8=we("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=we("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=we("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b8=we("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w8=we("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=we("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j8=we("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _8=we("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=we("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N8=we("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S8=we("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Db=we("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=we("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k8=we("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=we("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C8=we("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=we("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=we("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hh=we("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=we("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E8=we("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=we("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A8=we("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UC=we("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D8=we("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K_=we("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gp=we("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P8=we("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tn=we("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=we("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=we("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T8=we("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pv=we("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R8=we("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=we("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M8=we("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=we("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I8=we("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rc=we("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O8=we("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=we("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=we("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=we("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=we("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F8=we("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=we("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zd=we("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mc=we("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=we("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=we("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B8=we("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L8=we("Signal",[["path",{d:"M2 20h.01",key:"4haj6o"}],["path",{d:"M7 20v-4",key:"j294jx"}],["path",{d:"M12 20v-8",key:"i3yub9"}],["path",{d:"M17 20V8",key:"1tkaf5"}],["path",{d:"M22 4v16",key:"sih9yq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $8=we("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=we("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xv=we("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rd=we("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gv=we("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=we("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=we("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=we("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=we("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WC=we("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const th=we("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=we("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=we("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=we("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vv=we("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=we("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yv=we("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mn=we("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=we("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Tb="-",U8=t=>{const e=W8(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:s}=t;return{getClassGroupId:o=>{const l=o.split(Tb);return l[0]===""&&l.length!==1&&l.shift(),HC(l,e)||q8(o)},getConflictingClassGroupIds:(o,l)=>{const c=n[o]||[];return l&&s[o]?[...c,...s[o]]:c}}},HC=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],s=e.nextPart.get(n),a=s?HC(t.slice(1),s):void 0;if(a)return a;if(e.validators.length===0)return;const i=t.join(Tb);return(o=e.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},Z_=/^\[(.+)\]$/,q8=t=>{if(Z_.test(t)){const e=Z_.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},W8=t=>{const{theme:e,prefix:n}=t,s={nextPart:new Map,validators:[]};return V8(Object.entries(t.classGroups),n).forEach(([i,o])=>{bv(o,s,i,e)}),s},bv=(t,e,n,s)=>{t.forEach(a=>{if(typeof a=="string"){const i=a===""?e:Q_(e,a);i.classGroupId=n;return}if(typeof a=="function"){if(H8(a)){bv(a(s),e,n,s);return}e.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([i,o])=>{bv(o,Q_(e,i),n,s)})})},Q_=(t,e)=>{let n=t;return e.split(Tb).forEach(s=>{n.nextPart.has(s)||n.nextPart.set(s,{nextPart:new Map,validators:[]}),n=n.nextPart.get(s)}),n},H8=t=>t.isThemeGetter,V8=(t,e)=>e?t.map(([n,s])=>{const a=s.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[e+o,l])):i);return[n,a]}):t,K8=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,s=new Map;const a=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,s=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return a(i,o),o},set(i,o){n.has(i)?n.set(i,o):a(i,o)}}},VC="!",G8=t=>{const{separator:e,experimentalParseClassName:n}=t,s=e.length===1,a=e[0],i=e.length,o=l=>{const c=[];let d=0,u=0,h;for(let g=0;g<l.length;g++){let y=l[g];if(d===0){if(y===a&&(s||l.slice(g,g+i)===e)){c.push(l.slice(u,g)),u=g+i;continue}if(y==="/"){h=g;continue}}y==="["?d++:y==="]"&&d--}const m=c.length===0?l:l.substring(u),p=m.startsWith(VC),b=p?m.substring(1):m,x=h&&h>u?h-u:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:b,maybePostfixModifierPosition:x}};return n?l=>n({className:l,parseClassName:o}):o},Z8=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(s=>{s[0]==="["?(e.push(...n.sort(),s),n=[]):n.push(s)}),e.push(...n.sort()),e},Q8=t=>({cache:K8(t.cacheSize),parseClassName:G8(t),...U8(t)}),Y8=/\s+/,J8=(t,e)=>{const{parseClassName:n,getClassGroupId:s,getConflictingClassGroupIds:a}=e,i=[],o=t.trim().split(Y8);let l="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:u,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:p}=n(d);let b=!!p,x=s(b?m.substring(0,p):m);if(!x){if(!b){l=d+(l.length>0?" "+l:l);continue}if(x=s(m),!x){l=d+(l.length>0?" "+l:l);continue}b=!1}const g=Z8(u).join(":"),y=h?g+VC:g,v=y+x;if(i.includes(v))continue;i.push(v);const w=a(x,b);for(let j=0;j<w.length;++j){const S=w[j];i.push(y+S)}l=d+(l.length>0?" "+l:l)}return l};function X8(){let t=0,e,n,s="";for(;t<arguments.length;)(e=arguments[t++])&&(n=KC(e))&&(s&&(s+=" "),s+=n);return s}const KC=t=>{if(typeof t=="string")return t;let e,n="";for(let s=0;s<t.length;s++)t[s]&&(e=KC(t[s]))&&(n&&(n+=" "),n+=e);return n};function eI(t,...e){let n,s,a,i=o;function o(c){const d=e.reduce((u,h)=>h(u),t());return n=Q8(d),s=n.cache.get,a=n.cache.set,i=l,l(c)}function l(c){const d=s(c);if(d)return d;const u=J8(c,n);return a(c,u),u}return function(){return i(X8.apply(null,arguments))}}const Yt=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},GC=/^\[(?:([a-z-]+):)?(.+)\]$/i,tI=/^\d+\/\d+$/,nI=new Set(["px","full","screen"]),rI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,aI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,iI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,oI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,xa=t=>Vl(t)||nI.has(t)||tI.test(t),Va=t=>Ic(t,"length",pI),Vl=t=>!!t&&!Number.isNaN(Number(t)),Zp=t=>Ic(t,"number",Vl),sd=t=>!!t&&Number.isInteger(Number(t)),lI=t=>t.endsWith("%")&&Vl(t.slice(0,-1)),bt=t=>GC.test(t),Ka=t=>rI.test(t),cI=new Set(["length","size","percentage"]),dI=t=>Ic(t,cI,ZC),uI=t=>Ic(t,"position",ZC),hI=new Set(["image","url"]),mI=t=>Ic(t,hI,gI),fI=t=>Ic(t,"",xI),ad=()=>!0,Ic=(t,e,n)=>{const s=GC.exec(t);return s?s[1]?typeof e=="string"?s[1]===e:e.has(s[1]):n(s[2]):!1},pI=t=>sI.test(t)&&!aI.test(t),ZC=()=>!1,xI=t=>iI.test(t),gI=t=>oI.test(t),vI=()=>{const t=Yt("colors"),e=Yt("spacing"),n=Yt("blur"),s=Yt("brightness"),a=Yt("borderColor"),i=Yt("borderRadius"),o=Yt("borderSpacing"),l=Yt("borderWidth"),c=Yt("contrast"),d=Yt("grayscale"),u=Yt("hueRotate"),h=Yt("invert"),m=Yt("gap"),p=Yt("gradientColorStops"),b=Yt("gradientColorStopPositions"),x=Yt("inset"),g=Yt("margin"),y=Yt("opacity"),v=Yt("padding"),w=Yt("saturate"),j=Yt("scale"),S=Yt("sepia"),N=Yt("skew"),k=Yt("space"),E=Yt("translate"),P=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],C=()=>["auto",bt,e],T=()=>[bt,e],I=()=>["",xa,Va],V=()=>["auto",Vl,bt],ne=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],se=()=>["solid","dashed","dotted","double","none"],q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],O=()=>["start","end","center","between","around","evenly","stretch"],F=()=>["","0",bt],B=()=>["auto","avoid","all","avoid-page","page","left","right","column"],R=()=>[Vl,bt];return{cacheSize:500,separator:":",theme:{colors:[ad],spacing:[xa,Va],blur:["none","",Ka,bt],brightness:R(),borderColor:[t],borderRadius:["none","","full",Ka,bt],borderSpacing:T(),borderWidth:I(),contrast:R(),grayscale:F(),hueRotate:R(),invert:F(),gap:T(),gradientColorStops:[t],gradientColorStopPositions:[lI,Va],inset:C(),margin:C(),opacity:R(),padding:T(),saturate:R(),scale:R(),sepia:F(),skew:R(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",bt]}],container:["container"],columns:[{columns:[Ka]}],"break-after":[{"break-after":B()}],"break-before":[{"break-before":B()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ne(),bt]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",sd,bt]}],basis:[{basis:C()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",bt]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",sd,bt]}],"grid-cols":[{"grid-cols":[ad]}],"col-start-end":[{col:["auto",{span:["full",sd,bt]},bt]}],"col-start":[{"col-start":V()}],"col-end":[{"col-end":V()}],"grid-rows":[{"grid-rows":[ad]}],"row-start-end":[{row:["auto",{span:[sd,bt]},bt]}],"row-start":[{"row-start":V()}],"row-end":[{"row-end":V()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",bt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",bt]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...O()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...O(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...O(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",bt,e]}],"min-w":[{"min-w":[bt,e,"min","max","fit"]}],"max-w":[{"max-w":[bt,e,"none","full","min","max","fit","prose",{screen:[Ka]},Ka]}],h:[{h:[bt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[bt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[bt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[bt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ka,Va]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Zp]}],"font-family":[{font:[ad]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",bt]}],"line-clamp":[{"line-clamp":["none",Vl,Zp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",xa,bt]}],"list-image":[{"list-image":["none",bt]}],"list-style-type":[{list:["none","disc","decimal",bt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...se(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",xa,Va]}],"underline-offset":[{"underline-offset":["auto",xa,bt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",bt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",bt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ne(),uI]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",dI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},mI]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...se(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:se()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...se()]}],"outline-offset":[{"outline-offset":[xa,bt]}],"outline-w":[{outline:[xa,Va]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:I()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[xa,Va]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ka,fI]}],"shadow-color":[{shadow:[ad]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":q()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[s]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Ka,bt]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[w]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",bt]}],duration:[{duration:R()}],ease:[{ease:["linear","in","out","in-out",bt]}],delay:[{delay:R()}],animate:[{animate:["none","spin","ping","pulse","bounce",bt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[sd,bt]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",bt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",bt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",bt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[xa,Va,Zp]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},yI=eI(vI);function _e(...t){return yI(BC(t))}const bI=d8,QC=f.forwardRef(({className:t,...e},n)=>r.jsx(PC,{ref:n,className:_e("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));QC.displayName=PC.displayName;const wI=Ju("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),YC=f.forwardRef(({className:t,variant:e,...n},s)=>r.jsx(TC,{ref:s,className:_e(wI({variant:e}),t),...n}));YC.displayName=TC.displayName;const jI=f.forwardRef(({className:t,...e},n)=>r.jsx(IC,{ref:n,className:_e("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));jI.displayName=IC.displayName;const JC=f.forwardRef(({className:t,...e},n)=>r.jsx(OC,{ref:n,className:_e("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:r.jsx(Mn,{className:"h-4 w-4"})}));JC.displayName=OC.displayName;const XC=f.forwardRef(({className:t,...e},n)=>r.jsx(RC,{ref:n,className:_e("text-sm font-semibold",t),...e}));XC.displayName=RC.displayName;const eE=f.forwardRef(({className:t,...e},n)=>r.jsx(MC,{ref:n,className:_e("text-sm opacity-90",t),...e}));eE.displayName=MC.displayName;function _I(){const{toasts:t}=pt();return r.jsxs(bI,{children:[t.map(function({id:e,title:n,description:s,action:a,...i}){return r.jsxs(YC,{...i,children:[r.jsxs("div",{className:"grid gap-1",children:[n&&r.jsx(XC,{children:n}),s&&r.jsx(eE,{children:s})]}),a,r.jsx(JC,{})]},e)}),r.jsx(QC,{})]})}var Y_=["light","dark"],NI="(prefers-color-scheme: dark)",SI=f.createContext(void 0),kI={setTheme:t=>{},themes:[]},CI=()=>{var t;return(t=f.useContext(SI))!=null?t:kI};f.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:s,enableColorScheme:a,defaultTheme:i,value:o,attrs:l,nonce:c})=>{let d=i==="system",u=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(b=>`'${b}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,h=a?Y_.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",m=(b,x=!1,g=!0)=>{let y=o?o[b]:b,v=x?b+"|| ''":`'${y}'`,w="";return a&&g&&!x&&Y_.includes(b)&&(w+=`d.style.colorScheme = '${b}';`),n==="class"?x||y?w+=`c.add(${v})`:w+="null":y&&(w+=`d[s](n,${v})`),w},p=t?`!function(){${u}${m(t)}}()`:s?`!function(){try{${u}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${d})){var t='${NI}',m=window.matchMedia(t);if(m.media!==t||m.matches){${m("dark")}}else{${m("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${m(o?"x[e]":"e",!0)}}${d?"":"else{"+m(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${m(o?"x[e]":"e",!0)}}else{${m(i,!1,!1)};}${h}}catch(t){}}();`;return f.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:p}})});var EI=t=>{switch(t){case"success":return PI;case"info":return RI;case"warning":return TI;case"error":return MI;default:return null}},AI=Array(12).fill(0),DI=({visible:t})=>ge.createElement("div",{className:"sonner-loading-wrapper","data-visible":t},ge.createElement("div",{className:"sonner-spinner"},AI.map((e,n)=>ge.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),PI=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),TI=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),RI=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),MI=ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},ge.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),II=()=>{let[t,e]=ge.useState(document.hidden);return ge.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},wv=1,OI=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:n,...s}=t,a=typeof(t==null?void 0:t.id)=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:wv++,i=this.toasts.find(l=>l.id===a),o=t.dismissible===void 0?!0:t.dismissible;return i?this.toasts=this.toasts.map(l=>l.id===a?(this.publish({...l,...t,id:a,title:n}),{...l,...t,id:a,dismissible:o,title:n}):l):this.addToast({title:n,...s,dismissible:o,id:a}),a},this.dismiss=t=>(t||this.toasts.forEach(e=>{this.subscribers.forEach(n=>n({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let n;e.loading!==void 0&&(n=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let s=t instanceof Promise?t:t(),a=n!==void 0;return s.then(async i=>{if(BI(i)&&!i.ok){a=!1;let o=typeof e.error=="function"?await e.error(`HTTP error! status: ${i.status}`):e.error,l=typeof e.description=="function"?await e.description(`HTTP error! status: ${i.status}`):e.description;this.create({id:n,type:"error",message:o,description:l})}else if(e.success!==void 0){a=!1;let o=typeof e.success=="function"?await e.success(i):e.success,l=typeof e.description=="function"?await e.description(i):e.description;this.create({id:n,type:"success",message:o,description:l})}}).catch(async i=>{if(e.error!==void 0){a=!1;let o=typeof e.error=="function"?await e.error(i):e.error,l=typeof e.description=="function"?await e.description(i):e.description;this.create({id:n,type:"error",message:o,description:l})}}).finally(()=>{var i;a&&(this.dismiss(n),n=void 0),(i=e.finally)==null||i.call(e)}),n},this.custom=(t,e)=>{let n=(e==null?void 0:e.id)||wv++;return this.create({jsx:t(n),id:n,...e}),n},this.subscribers=[],this.toasts=[]}},Rr=new OI,FI=(t,e)=>{let n=(e==null?void 0:e.id)||wv++;return Rr.addToast({title:t,...e,id:n}),n},BI=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",LI=FI,$I=()=>Rr.toasts,ft=Object.assign(LI,{success:Rr.success,info:Rr.info,warning:Rr.warning,error:Rr.error,custom:Rr.custom,message:Rr.message,promise:Rr.promise,dismiss:Rr.dismiss,loading:Rr.loading},{getHistory:$I});function zI(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",e==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}zI(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Vh(t){return t.label!==void 0}var UI=3,qI="32px",WI=4e3,HI=356,VI=14,KI=20,GI=200;function ZI(...t){return t.filter(Boolean).join(" ")}var QI=t=>{var e,n,s,a,i,o,l,c,d,u;let{invert:h,toast:m,unstyled:p,interacting:b,setHeights:x,visibleToasts:g,heights:y,index:v,toasts:w,expanded:j,removeToast:S,defaultRichColors:N,closeButton:k,style:E,cancelButtonStyle:P,actionButtonStyle:A,className:C="",descriptionClassName:T="",duration:I,position:V,gap:ne,loadingIcon:se,expandByDefault:q,classNames:O,icons:F,closeButtonAriaLabel:B="Close toast",pauseWhenPageIsHidden:R,cn:D}=t,[L,M]=ge.useState(!1),[X,K]=ge.useState(!1),[z,Y]=ge.useState(!1),[ae,U]=ge.useState(!1),[Q,oe]=ge.useState(0),[re,le]=ge.useState(0),Z=ge.useRef(null),de=ge.useRef(null),he=v===0,Re=v+1<=g,$e=m.type,wt=m.dismissible!==!1,me=m.className||"",je=m.descriptionClassName||"",Se=ge.useMemo(()=>y.findIndex(He=>He.toastId===m.id)||0,[y,m.id]),Ze=ge.useMemo(()=>{var He;return(He=m.closeButton)!=null?He:k},[m.closeButton,k]),Me=ge.useMemo(()=>m.duration||I||WI,[m.duration,I]),Ne=ge.useRef(0),mt=ge.useRef(0),it=ge.useRef(0),kn=ge.useRef(null),[Cr,ut]=V.split("-"),en=ge.useMemo(()=>y.reduce((He,It,Et)=>Et>=Se?He:He+It.height,0),[y,Se]),Cn=II(),Er=m.invert||h,Vn=$e==="loading";mt.current=ge.useMemo(()=>Se*ne+en,[Se,en]),ge.useEffect(()=>{M(!0)},[]),ge.useLayoutEffect(()=>{if(!L)return;let He=de.current,It=He.style.height;He.style.height="auto";let Et=He.getBoundingClientRect().height;He.style.height=It,le(Et),x(ot=>ot.find($t=>$t.toastId===m.id)?ot.map($t=>$t.toastId===m.id?{...$t,height:Et}:$t):[{toastId:m.id,height:Et,position:m.position},...ot])},[L,m.title,m.description,x,m.id]);let fn=ge.useCallback(()=>{K(!0),oe(mt.current),x(He=>He.filter(It=>It.toastId!==m.id)),setTimeout(()=>{S(m)},GI)},[m,S,x,mt]);ge.useEffect(()=>{if(m.promise&&$e==="loading"||m.duration===1/0||m.type==="loading")return;let He,It=Me;return j||b||R&&Cn?(()=>{if(it.current<Ne.current){let Et=new Date().getTime()-Ne.current;It=It-Et}it.current=new Date().getTime()})():It!==1/0&&(Ne.current=new Date().getTime(),He=setTimeout(()=>{var Et;(Et=m.onAutoClose)==null||Et.call(m,m),fn()},It)),()=>clearTimeout(He)},[j,b,q,m,Me,fn,m.promise,$e,R,Cn]),ge.useEffect(()=>{let He=de.current;if(He){let It=He.getBoundingClientRect().height;return le(It),x(Et=>[{toastId:m.id,height:It,position:m.position},...Et]),()=>x(Et=>Et.filter(ot=>ot.toastId!==m.id))}},[x,m.id]),ge.useEffect(()=>{m.delete&&fn()},[fn,m.delete]);function qa(){return F!=null&&F.loading?ge.createElement("div",{className:"sonner-loader","data-visible":$e==="loading"},F.loading):se?ge.createElement("div",{className:"sonner-loader","data-visible":$e==="loading"},se):ge.createElement(DI,{visible:$e==="loading"})}return ge.createElement("li",{"aria-live":m.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:de,className:D(C,me,O==null?void 0:O.toast,(e=m==null?void 0:m.classNames)==null?void 0:e.toast,O==null?void 0:O.default,O==null?void 0:O[$e],(n=m==null?void 0:m.classNames)==null?void 0:n[$e]),"data-sonner-toast":"","data-rich-colors":(s=m.richColors)!=null?s:N,"data-styled":!(m.jsx||m.unstyled||p),"data-mounted":L,"data-promise":!!m.promise,"data-removed":X,"data-visible":Re,"data-y-position":Cr,"data-x-position":ut,"data-index":v,"data-front":he,"data-swiping":z,"data-dismissible":wt,"data-type":$e,"data-invert":Er,"data-swipe-out":ae,"data-expanded":!!(j||q&&L),style:{"--index":v,"--toasts-before":v,"--z-index":w.length-v,"--offset":`${X?Q:mt.current}px`,"--initial-height":q?"auto":`${re}px`,...E,...m.style},onPointerDown:He=>{Vn||!wt||(Z.current=new Date,oe(mt.current),He.target.setPointerCapture(He.pointerId),He.target.tagName!=="BUTTON"&&(Y(!0),kn.current={x:He.clientX,y:He.clientY}))},onPointerUp:()=>{var He,It,Et,ot;if(ae||!wt)return;kn.current=null;let $t=Number(((He=de.current)==null?void 0:He.style.getPropertyValue("--swipe-amount").replace("px",""))||0),Qr=new Date().getTime()-((It=Z.current)==null?void 0:It.getTime()),Wa=Math.abs($t)/Qr;if(Math.abs($t)>=KI||Wa>.11){oe(mt.current),(Et=m.onDismiss)==null||Et.call(m,m),fn(),U(!0);return}(ot=de.current)==null||ot.style.setProperty("--swipe-amount","0px"),Y(!1)},onPointerMove:He=>{var It;if(!kn.current||!wt)return;let Et=He.clientY-kn.current.y,ot=He.clientX-kn.current.x,$t=(Cr==="top"?Math.min:Math.max)(0,Et),Qr=He.pointerType==="touch"?10:2;Math.abs($t)>Qr?(It=de.current)==null||It.style.setProperty("--swipe-amount",`${Et}px`):Math.abs(ot)>Qr&&(kn.current=null)}},Ze&&!m.jsx?ge.createElement("button",{"aria-label":B,"data-disabled":Vn,"data-close-button":!0,onClick:Vn||!wt?()=>{}:()=>{var He;fn(),(He=m.onDismiss)==null||He.call(m,m)},className:D(O==null?void 0:O.closeButton,(a=m==null?void 0:m.classNames)==null?void 0:a.closeButton)},ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},ge.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),ge.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,m.jsx||ge.isValidElement(m.title)?m.jsx||m.title:ge.createElement(ge.Fragment,null,$e||m.icon||m.promise?ge.createElement("div",{"data-icon":"",className:D(O==null?void 0:O.icon,(i=m==null?void 0:m.classNames)==null?void 0:i.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||qa():null,m.type!=="loading"?m.icon||(F==null?void 0:F[$e])||EI($e):null):null,ge.createElement("div",{"data-content":"",className:D(O==null?void 0:O.content,(o=m==null?void 0:m.classNames)==null?void 0:o.content)},ge.createElement("div",{"data-title":"",className:D(O==null?void 0:O.title,(l=m==null?void 0:m.classNames)==null?void 0:l.title)},m.title),m.description?ge.createElement("div",{"data-description":"",className:D(T,je,O==null?void 0:O.description,(c=m==null?void 0:m.classNames)==null?void 0:c.description)},m.description):null),ge.isValidElement(m.cancel)?m.cancel:m.cancel&&Vh(m.cancel)?ge.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||P,onClick:He=>{var It,Et;Vh(m.cancel)&&wt&&((Et=(It=m.cancel).onClick)==null||Et.call(It,He),fn())},className:D(O==null?void 0:O.cancelButton,(d=m==null?void 0:m.classNames)==null?void 0:d.cancelButton)},m.cancel.label):null,ge.isValidElement(m.action)?m.action:m.action&&Vh(m.action)?ge.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||A,onClick:He=>{var It,Et;Vh(m.action)&&(He.defaultPrevented||((Et=(It=m.action).onClick)==null||Et.call(It,He),fn()))},className:D(O==null?void 0:O.actionButton,(u=m==null?void 0:m.classNames)==null?void 0:u.actionButton)},m.action.label):null))};function J_(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}var YI=t=>{let{invert:e,position:n="bottom-right",hotkey:s=["altKey","KeyT"],expand:a,closeButton:i,className:o,offset:l,theme:c="light",richColors:d,duration:u,style:h,visibleToasts:m=UI,toastOptions:p,dir:b=J_(),gap:x=VI,loadingIcon:g,icons:y,containerAriaLabel:v="Notifications",pauseWhenPageIsHidden:w,cn:j=ZI}=t,[S,N]=ge.useState([]),k=ge.useMemo(()=>Array.from(new Set([n].concat(S.filter(R=>R.position).map(R=>R.position)))),[S,n]),[E,P]=ge.useState([]),[A,C]=ge.useState(!1),[T,I]=ge.useState(!1),[V,ne]=ge.useState(c!=="system"?c:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),se=ge.useRef(null),q=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),O=ge.useRef(null),F=ge.useRef(!1),B=ge.useCallback(R=>{var D;(D=S.find(L=>L.id===R.id))!=null&&D.delete||Rr.dismiss(R.id),N(L=>L.filter(({id:M})=>M!==R.id))},[S]);return ge.useEffect(()=>Rr.subscribe(R=>{if(R.dismiss){N(D=>D.map(L=>L.id===R.id?{...L,delete:!0}:L));return}setTimeout(()=>{hC.flushSync(()=>{N(D=>{let L=D.findIndex(M=>M.id===R.id);return L!==-1?[...D.slice(0,L),{...D[L],...R},...D.slice(L+1)]:[R,...D]})})})}),[]),ge.useEffect(()=>{if(c!=="system"){ne(c);return}c==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ne("dark"):ne("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:R})=>{ne(R?"dark":"light")})},[c]),ge.useEffect(()=>{S.length<=1&&C(!1)},[S]),ge.useEffect(()=>{let R=D=>{var L,M;s.every(X=>D[X]||D.code===X)&&(C(!0),(L=se.current)==null||L.focus()),D.code==="Escape"&&(document.activeElement===se.current||(M=se.current)!=null&&M.contains(document.activeElement))&&C(!1)};return document.addEventListener("keydown",R),()=>document.removeEventListener("keydown",R)},[s]),ge.useEffect(()=>{if(se.current)return()=>{O.current&&(O.current.focus({preventScroll:!0}),O.current=null,F.current=!1)}},[se.current]),S.length?ge.createElement("section",{"aria-label":`${v} ${q}`,tabIndex:-1},k.map((R,D)=>{var L;let[M,X]=R.split("-");return ge.createElement("ol",{key:R,dir:b==="auto"?J_():b,tabIndex:-1,ref:se,className:o,"data-sonner-toaster":!0,"data-theme":V,"data-y-position":M,"data-x-position":X,style:{"--front-toast-height":`${((L=E[0])==null?void 0:L.height)||0}px`,"--offset":typeof l=="number"?`${l}px`:l||qI,"--width":`${HI}px`,"--gap":`${x}px`,...h},onBlur:K=>{F.current&&!K.currentTarget.contains(K.relatedTarget)&&(F.current=!1,O.current&&(O.current.focus({preventScroll:!0}),O.current=null))},onFocus:K=>{K.target instanceof HTMLElement&&K.target.dataset.dismissible==="false"||F.current||(F.current=!0,O.current=K.relatedTarget)},onMouseEnter:()=>C(!0),onMouseMove:()=>C(!0),onMouseLeave:()=>{T||C(!1)},onPointerDown:K=>{K.target instanceof HTMLElement&&K.target.dataset.dismissible==="false"||I(!0)},onPointerUp:()=>I(!1)},S.filter(K=>!K.position&&D===0||K.position===R).map((K,z)=>{var Y,ae;return ge.createElement(QI,{key:K.id,icons:y,index:z,toast:K,defaultRichColors:d,duration:(Y=p==null?void 0:p.duration)!=null?Y:u,className:p==null?void 0:p.className,descriptionClassName:p==null?void 0:p.descriptionClassName,invert:e,visibleToasts:m,closeButton:(ae=p==null?void 0:p.closeButton)!=null?ae:i,interacting:T,position:R,style:p==null?void 0:p.style,unstyled:p==null?void 0:p.unstyled,classNames:p==null?void 0:p.classNames,cancelButtonStyle:p==null?void 0:p.cancelButtonStyle,actionButtonStyle:p==null?void 0:p.actionButtonStyle,removeToast:B,toasts:S.filter(U=>U.position==K.position),heights:E.filter(U=>U.position==K.position),setHeights:P,expandByDefault:a,gap:x,loadingIcon:g,expanded:A,pauseWhenPageIsHidden:w,cn:j})}))})):null};const JI=({...t})=>{const{theme:e="system"}=CI();return r.jsx(YI,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var XI=cS.useId||(()=>{}),eO=0;function Lr(t){const[e,n]=f.useState(XI());return gn(()=>{t||n(s=>s??String(eO++))},[t]),t||(e?`radix-${e}`:"")}const tO=["top","right","bottom","left"],Li=Math.min,Ir=Math.max,_f=Math.round,Kh=Math.floor,$i=t=>({x:t,y:t}),nO={left:"right",right:"left",bottom:"top",top:"bottom"},rO={start:"end",end:"start"};function jv(t,e,n){return Ir(t,Li(e,n))}function Fa(t,e){return typeof t=="function"?t(e):t}function Ba(t){return t.split("-")[0]}function Oc(t){return t.split("-")[1]}function Rb(t){return t==="x"?"y":"x"}function Mb(t){return t==="y"?"height":"width"}function zi(t){return["top","bottom"].includes(Ba(t))?"y":"x"}function Ib(t){return Rb(zi(t))}function sO(t,e,n){n===void 0&&(n=!1);const s=Oc(t),a=Ib(t),i=Mb(a);let o=a==="x"?s===(n?"end":"start")?"right":"left":s==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Nf(o)),[o,Nf(o)]}function aO(t){const e=Nf(t);return[_v(t),e,_v(e)]}function _v(t){return t.replace(/start|end/g,e=>rO[e])}function iO(t,e,n){const s=["left","right"],a=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?a:s:e?s:a;case"left":case"right":return e?i:o;default:return[]}}function oO(t,e,n,s){const a=Oc(t);let i=iO(Ba(t),n==="start",s);return a&&(i=i.map(o=>o+"-"+a),e&&(i=i.concat(i.map(_v)))),i}function Nf(t){return t.replace(/left|right|bottom|top/g,e=>nO[e])}function lO(t){return{top:0,right:0,bottom:0,left:0,...t}}function tE(t){return typeof t!="number"?lO(t):{top:t,right:t,bottom:t,left:t}}function Sf(t){const{x:e,y:n,width:s,height:a}=t;return{width:s,height:a,top:n,left:e,right:e+s,bottom:n+a,x:e,y:n}}function X_(t,e,n){let{reference:s,floating:a}=t;const i=zi(e),o=Ib(e),l=Mb(o),c=Ba(e),d=i==="y",u=s.x+s.width/2-a.width/2,h=s.y+s.height/2-a.height/2,m=s[l]/2-a[l]/2;let p;switch(c){case"top":p={x:u,y:s.y-a.height};break;case"bottom":p={x:u,y:s.y+s.height};break;case"right":p={x:s.x+s.width,y:h};break;case"left":p={x:s.x-a.width,y:h};break;default:p={x:s.x,y:s.y}}switch(Oc(e)){case"start":p[o]-=m*(n&&d?-1:1);break;case"end":p[o]+=m*(n&&d?-1:1);break}return p}const cO=async(t,e,n)=>{const{placement:s="bottom",strategy:a="absolute",middleware:i=[],platform:o}=n,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let d=await o.getElementRects({reference:t,floating:e,strategy:a}),{x:u,y:h}=X_(d,s,c),m=s,p={},b=0;for(let x=0;x<l.length;x++){const{name:g,fn:y}=l[x],{x:v,y:w,data:j,reset:S}=await y({x:u,y:h,initialPlacement:s,placement:m,strategy:a,middlewareData:p,rects:d,platform:o,elements:{reference:t,floating:e}});u=v??u,h=w??h,p={...p,[g]:{...p[g],...j}},S&&b<=50&&(b++,typeof S=="object"&&(S.placement&&(m=S.placement),S.rects&&(d=S.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:a}):S.rects),{x:u,y:h}=X_(d,m,c)),x=-1)}return{x:u,y:h,placement:m,strategy:a,middlewareData:p}};async function fu(t,e){var n;e===void 0&&(e={});const{x:s,y:a,platform:i,rects:o,elements:l,strategy:c}=t,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:m=!1,padding:p=0}=Fa(e,t),b=tE(p),g=l[m?h==="floating"?"reference":"floating":h],y=Sf(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(g)))==null||n?g:g.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:c})),v=h==="floating"?{x:s,y:a,width:o.floating.width,height:o.floating.height}:o.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),j=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},S=Sf(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:v,offsetParent:w,strategy:c}):v);return{top:(y.top-S.top+b.top)/j.y,bottom:(S.bottom-y.bottom+b.bottom)/j.y,left:(y.left-S.left+b.left)/j.x,right:(S.right-y.right+b.right)/j.x}}const dO=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:s,placement:a,rects:i,platform:o,elements:l,middlewareData:c}=e,{element:d,padding:u=0}=Fa(t,e)||{};if(d==null)return{};const h=tE(u),m={x:n,y:s},p=Ib(a),b=Mb(p),x=await o.getDimensions(d),g=p==="y",y=g?"top":"left",v=g?"bottom":"right",w=g?"clientHeight":"clientWidth",j=i.reference[b]+i.reference[p]-m[p]-i.floating[b],S=m[p]-i.reference[p],N=await(o.getOffsetParent==null?void 0:o.getOffsetParent(d));let k=N?N[w]:0;(!k||!await(o.isElement==null?void 0:o.isElement(N)))&&(k=l.floating[w]||i.floating[b]);const E=j/2-S/2,P=k/2-x[b]/2-1,A=Li(h[y],P),C=Li(h[v],P),T=A,I=k-x[b]-C,V=k/2-x[b]/2+E,ne=jv(T,V,I),se=!c.arrow&&Oc(a)!=null&&V!==ne&&i.reference[b]/2-(V<T?A:C)-x[b]/2<0,q=se?V<T?V-T:V-I:0;return{[p]:m[p]+q,data:{[p]:ne,centerOffset:V-ne-q,...se&&{alignmentOffset:q}},reset:se}}}),uO=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,s;const{placement:a,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:d}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:m,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:x=!0,...g}=Fa(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const y=Ba(a),v=zi(l),w=Ba(l)===l,j=await(c.isRTL==null?void 0:c.isRTL(d.floating)),S=m||(w||!x?[Nf(l)]:aO(l)),N=b!=="none";!m&&N&&S.push(...oO(l,x,b,j));const k=[l,...S],E=await fu(e,g),P=[];let A=((s=i.flip)==null?void 0:s.overflows)||[];if(u&&P.push(E[y]),h){const V=sO(a,o,j);P.push(E[V[0]],E[V[1]])}if(A=[...A,{placement:a,overflows:P}],!P.every(V=>V<=0)){var C,T;const V=(((C=i.flip)==null?void 0:C.index)||0)+1,ne=k[V];if(ne)return{data:{index:V,overflows:A},reset:{placement:ne}};let se=(T=A.filter(q=>q.overflows[0]<=0).sort((q,O)=>q.overflows[1]-O.overflows[1])[0])==null?void 0:T.placement;if(!se)switch(p){case"bestFit":{var I;const q=(I=A.filter(O=>{if(N){const F=zi(O.placement);return F===v||F==="y"}return!0}).map(O=>[O.placement,O.overflows.filter(F=>F>0).reduce((F,B)=>F+B,0)]).sort((O,F)=>O[1]-F[1])[0])==null?void 0:I[0];q&&(se=q);break}case"initialPlacement":se=l;break}if(a!==se)return{reset:{placement:se}}}return{}}}};function e1(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function t1(t){return tO.some(e=>t[e]>=0)}const hO=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:s="referenceHidden",...a}=Fa(t,e);switch(s){case"referenceHidden":{const i=await fu(e,{...a,elementContext:"reference"}),o=e1(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:t1(o)}}}case"escaped":{const i=await fu(e,{...a,altBoundary:!0}),o=e1(i,n.floating);return{data:{escapedOffsets:o,escaped:t1(o)}}}default:return{}}}}};async function mO(t,e){const{placement:n,platform:s,elements:a}=t,i=await(s.isRTL==null?void 0:s.isRTL(a.floating)),o=Ba(n),l=Oc(n),c=zi(n)==="y",d=["left","top"].includes(o)?-1:1,u=i&&c?-1:1,h=Fa(e,t);let{mainAxis:m,crossAxis:p,alignmentAxis:b}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof b=="number"&&(p=l==="end"?b*-1:b),c?{x:p*u,y:m*d}:{x:m*d,y:p*u}}const fO=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,s;const{x:a,y:i,placement:o,middlewareData:l}=e,c=await mO(e,t);return o===((n=l.offset)==null?void 0:n.placement)&&(s=l.arrow)!=null&&s.alignmentOffset?{}:{x:a+c.x,y:i+c.y,data:{...c,placement:o}}}}},pO=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:s,placement:a}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:g=>{let{x:y,y:v}=g;return{x:y,y:v}}},...c}=Fa(t,e),d={x:n,y:s},u=await fu(e,c),h=zi(Ba(a)),m=Rb(h);let p=d[m],b=d[h];if(i){const g=m==="y"?"top":"left",y=m==="y"?"bottom":"right",v=p+u[g],w=p-u[y];p=jv(v,p,w)}if(o){const g=h==="y"?"top":"left",y=h==="y"?"bottom":"right",v=b+u[g],w=b-u[y];b=jv(v,b,w)}const x=l.fn({...e,[m]:p,[h]:b});return{...x,data:{x:x.x-n,y:x.y-s,enabled:{[m]:i,[h]:o}}}}}},xO=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:s,placement:a,rects:i,middlewareData:o}=e,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=Fa(t,e),u={x:n,y:s},h=zi(a),m=Rb(h);let p=u[m],b=u[h];const x=Fa(l,e),g=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(c){const w=m==="y"?"height":"width",j=i.reference[m]-i.floating[w]+g.mainAxis,S=i.reference[m]+i.reference[w]-g.mainAxis;p<j?p=j:p>S&&(p=S)}if(d){var y,v;const w=m==="y"?"width":"height",j=["top","left"].includes(Ba(a)),S=i.reference[h]-i.floating[w]+(j&&((y=o.offset)==null?void 0:y[h])||0)+(j?0:g.crossAxis),N=i.reference[h]+i.reference[w]+(j?0:((v=o.offset)==null?void 0:v[h])||0)-(j?g.crossAxis:0);b<S?b=S:b>N&&(b=N)}return{[m]:p,[h]:b}}}},gO=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,s;const{placement:a,rects:i,platform:o,elements:l}=e,{apply:c=()=>{},...d}=Fa(t,e),u=await fu(e,d),h=Ba(a),m=Oc(a),p=zi(a)==="y",{width:b,height:x}=i.floating;let g,y;h==="top"||h==="bottom"?(g=h,y=m===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(y=h,g=m==="end"?"top":"bottom");const v=x-u.top-u.bottom,w=b-u.left-u.right,j=Li(x-u[g],v),S=Li(b-u[y],w),N=!e.middlewareData.shift;let k=j,E=S;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(E=w),(s=e.middlewareData.shift)!=null&&s.enabled.y&&(k=v),N&&!m){const A=Ir(u.left,0),C=Ir(u.right,0),T=Ir(u.top,0),I=Ir(u.bottom,0);p?E=b-2*(A!==0||C!==0?A+C:Ir(u.left,u.right)):k=x-2*(T!==0||I!==0?T+I:Ir(u.top,u.bottom))}await c({...e,availableWidth:E,availableHeight:k});const P=await o.getDimensions(l.floating);return b!==P.width||x!==P.height?{reset:{rects:!0}}:{}}}};function C0(){return typeof window<"u"}function Fc(t){return nE(t)?(t.nodeName||"").toLowerCase():"#document"}function $r(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function ha(t){var e;return(e=(nE(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function nE(t){return C0()?t instanceof Node||t instanceof $r(t).Node:!1}function Ts(t){return C0()?t instanceof Element||t instanceof $r(t).Element:!1}function ca(t){return C0()?t instanceof HTMLElement||t instanceof $r(t).HTMLElement:!1}function n1(t){return!C0()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof $r(t).ShadowRoot}function nh(t){const{overflow:e,overflowX:n,overflowY:s,display:a}=Rs(t);return/auto|scroll|overlay|hidden|clip/.test(e+s+n)&&!["inline","contents"].includes(a)}function vO(t){return["table","td","th"].includes(Fc(t))}function E0(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function Ob(t){const e=Fb(),n=Ts(t)?Rs(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(s=>(n.willChange||"").includes(s))||["paint","layout","strict","content"].some(s=>(n.contain||"").includes(s))}function yO(t){let e=Ui(t);for(;ca(e)&&!vc(e);){if(Ob(e))return e;if(E0(e))return null;e=Ui(e)}return null}function Fb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function vc(t){return["html","body","#document"].includes(Fc(t))}function Rs(t){return $r(t).getComputedStyle(t)}function A0(t){return Ts(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ui(t){if(Fc(t)==="html")return t;const e=t.assignedSlot||t.parentNode||n1(t)&&t.host||ha(t);return n1(e)?e.host:e}function rE(t){const e=Ui(t);return vc(e)?t.ownerDocument?t.ownerDocument.body:t.body:ca(e)&&nh(e)?e:rE(e)}function pu(t,e,n){var s;e===void 0&&(e=[]),n===void 0&&(n=!0);const a=rE(t),i=a===((s=t.ownerDocument)==null?void 0:s.body),o=$r(a);if(i){const l=Nv(o);return e.concat(o,o.visualViewport||[],nh(a)?a:[],l&&n?pu(l):[])}return e.concat(a,pu(a,[],n))}function Nv(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function sE(t){const e=Rs(t);let n=parseFloat(e.width)||0,s=parseFloat(e.height)||0;const a=ca(t),i=a?t.offsetWidth:n,o=a?t.offsetHeight:s,l=_f(n)!==i||_f(s)!==o;return l&&(n=i,s=o),{width:n,height:s,$:l}}function Bb(t){return Ts(t)?t:t.contextElement}function Kl(t){const e=Bb(t);if(!ca(e))return $i(1);const n=e.getBoundingClientRect(),{width:s,height:a,$:i}=sE(e);let o=(i?_f(n.width):n.width)/s,l=(i?_f(n.height):n.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const bO=$i(0);function aE(t){const e=$r(t);return!Fb()||!e.visualViewport?bO:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function wO(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==$r(t)?!1:e}function Oo(t,e,n,s){e===void 0&&(e=!1),n===void 0&&(n=!1);const a=t.getBoundingClientRect(),i=Bb(t);let o=$i(1);e&&(s?Ts(s)&&(o=Kl(s)):o=Kl(t));const l=wO(i,n,s)?aE(i):$i(0);let c=(a.left+l.x)/o.x,d=(a.top+l.y)/o.y,u=a.width/o.x,h=a.height/o.y;if(i){const m=$r(i),p=s&&Ts(s)?$r(s):s;let b=m,x=Nv(b);for(;x&&s&&p!==b;){const g=Kl(x),y=x.getBoundingClientRect(),v=Rs(x),w=y.left+(x.clientLeft+parseFloat(v.paddingLeft))*g.x,j=y.top+(x.clientTop+parseFloat(v.paddingTop))*g.y;c*=g.x,d*=g.y,u*=g.x,h*=g.y,c+=w,d+=j,b=$r(x),x=Nv(b)}}return Sf({width:u,height:h,x:c,y:d})}function jO(t){let{elements:e,rect:n,offsetParent:s,strategy:a}=t;const i=a==="fixed",o=ha(s),l=e?E0(e.floating):!1;if(s===o||l&&i)return n;let c={scrollLeft:0,scrollTop:0},d=$i(1);const u=$i(0),h=ca(s);if((h||!h&&!i)&&((Fc(s)!=="body"||nh(o))&&(c=A0(s)),ca(s))){const m=Oo(s);d=Kl(s),u.x=m.x+s.clientLeft,u.y=m.y+s.clientTop}return{width:n.width*d.x,height:n.height*d.y,x:n.x*d.x-c.scrollLeft*d.x+u.x,y:n.y*d.y-c.scrollTop*d.y+u.y}}function _O(t){return Array.from(t.getClientRects())}function Sv(t,e){const n=A0(t).scrollLeft;return e?e.left+n:Oo(ha(t)).left+n}function NO(t){const e=ha(t),n=A0(t),s=t.ownerDocument.body,a=Ir(e.scrollWidth,e.clientWidth,s.scrollWidth,s.clientWidth),i=Ir(e.scrollHeight,e.clientHeight,s.scrollHeight,s.clientHeight);let o=-n.scrollLeft+Sv(t);const l=-n.scrollTop;return Rs(s).direction==="rtl"&&(o+=Ir(e.clientWidth,s.clientWidth)-a),{width:a,height:i,x:o,y:l}}function SO(t,e){const n=$r(t),s=ha(t),a=n.visualViewport;let i=s.clientWidth,o=s.clientHeight,l=0,c=0;if(a){i=a.width,o=a.height;const d=Fb();(!d||d&&e==="fixed")&&(l=a.offsetLeft,c=a.offsetTop)}return{width:i,height:o,x:l,y:c}}function kO(t,e){const n=Oo(t,!0,e==="fixed"),s=n.top+t.clientTop,a=n.left+t.clientLeft,i=ca(t)?Kl(t):$i(1),o=t.clientWidth*i.x,l=t.clientHeight*i.y,c=a*i.x,d=s*i.y;return{width:o,height:l,x:c,y:d}}function r1(t,e,n){let s;if(e==="viewport")s=SO(t,n);else if(e==="document")s=NO(ha(t));else if(Ts(e))s=kO(e,n);else{const a=aE(t);s={...e,x:e.x-a.x,y:e.y-a.y}}return Sf(s)}function iE(t,e){const n=Ui(t);return n===e||!Ts(n)||vc(n)?!1:Rs(n).position==="fixed"||iE(n,e)}function CO(t,e){const n=e.get(t);if(n)return n;let s=pu(t,[],!1).filter(l=>Ts(l)&&Fc(l)!=="body"),a=null;const i=Rs(t).position==="fixed";let o=i?Ui(t):t;for(;Ts(o)&&!vc(o);){const l=Rs(o),c=Ob(o);!c&&l.position==="fixed"&&(a=null),(i?!c&&!a:!c&&l.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||nh(o)&&!c&&iE(t,o))?s=s.filter(u=>u!==o):a=l,o=Ui(o)}return e.set(t,s),s}function EO(t){let{element:e,boundary:n,rootBoundary:s,strategy:a}=t;const o=[...n==="clippingAncestors"?E0(e)?[]:CO(e,this._c):[].concat(n),s],l=o[0],c=o.reduce((d,u)=>{const h=r1(e,u,a);return d.top=Ir(h.top,d.top),d.right=Li(h.right,d.right),d.bottom=Li(h.bottom,d.bottom),d.left=Ir(h.left,d.left),d},r1(e,l,a));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function AO(t){const{width:e,height:n}=sE(t);return{width:e,height:n}}function DO(t,e,n){const s=ca(e),a=ha(e),i=n==="fixed",o=Oo(t,!0,i,e);let l={scrollLeft:0,scrollTop:0};const c=$i(0);if(s||!s&&!i)if((Fc(e)!=="body"||nh(a))&&(l=A0(e)),s){const p=Oo(e,!0,i,e);c.x=p.x+e.clientLeft,c.y=p.y+e.clientTop}else a&&(c.x=Sv(a));let d=0,u=0;if(a&&!s&&!i){const p=a.getBoundingClientRect();u=p.top+l.scrollTop,d=p.left+l.scrollLeft-Sv(a,p)}const h=o.left+l.scrollLeft-c.x-d,m=o.top+l.scrollTop-c.y-u;return{x:h,y:m,width:o.width,height:o.height}}function Qp(t){return Rs(t).position==="static"}function s1(t,e){if(!ca(t)||Rs(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return ha(t)===n&&(n=n.ownerDocument.body),n}function oE(t,e){const n=$r(t);if(E0(t))return n;if(!ca(t)){let a=Ui(t);for(;a&&!vc(a);){if(Ts(a)&&!Qp(a))return a;a=Ui(a)}return n}let s=s1(t,e);for(;s&&vO(s)&&Qp(s);)s=s1(s,e);return s&&vc(s)&&Qp(s)&&!Ob(s)?n:s||yO(t)||n}const PO=async function(t){const e=this.getOffsetParent||oE,n=this.getDimensions,s=await n(t.floating);return{reference:DO(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function TO(t){return Rs(t).direction==="rtl"}const RO={convertOffsetParentRelativeRectToViewportRelativeRect:jO,getDocumentElement:ha,getClippingRect:EO,getOffsetParent:oE,getElementRects:PO,getClientRects:_O,getDimensions:AO,getScale:Kl,isElement:Ts,isRTL:TO};function MO(t,e){let n=null,s;const a=ha(t);function i(){var l;clearTimeout(s),(l=n)==null||l.disconnect(),n=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const{left:d,top:u,width:h,height:m}=t.getBoundingClientRect();if(l||e(),!h||!m)return;const p=Kh(u),b=Kh(a.clientWidth-(d+h)),x=Kh(a.clientHeight-(u+m)),g=Kh(d),v={rootMargin:-p+"px "+-b+"px "+-x+"px "+-g+"px",threshold:Ir(0,Li(1,c))||1};let w=!0;function j(S){const N=S[0].intersectionRatio;if(N!==c){if(!w)return o();N?o(!1,N):s=setTimeout(()=>{o(!1,1e-7)},1e3)}w=!1}try{n=new IntersectionObserver(j,{...v,root:a.ownerDocument})}catch{n=new IntersectionObserver(j,v)}n.observe(t)}return o(!0),i}function IO(t,e,n,s){s===void 0&&(s={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=s,d=Bb(t),u=a||i?[...d?pu(d):[],...pu(e)]:[];u.forEach(y=>{a&&y.addEventListener("scroll",n,{passive:!0}),i&&y.addEventListener("resize",n)});const h=d&&l?MO(d,n):null;let m=-1,p=null;o&&(p=new ResizeObserver(y=>{let[v]=y;v&&v.target===d&&p&&(p.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var w;(w=p)==null||w.observe(e)})),n()}),d&&!c&&p.observe(d),p.observe(e));let b,x=c?Oo(t):null;c&&g();function g(){const y=Oo(t);x&&(y.x!==x.x||y.y!==x.y||y.width!==x.width||y.height!==x.height)&&n(),x=y,b=requestAnimationFrame(g)}return n(),()=>{var y;u.forEach(v=>{a&&v.removeEventListener("scroll",n),i&&v.removeEventListener("resize",n)}),h==null||h(),(y=p)==null||y.disconnect(),p=null,c&&cancelAnimationFrame(b)}}const OO=fO,FO=pO,BO=uO,LO=gO,$O=hO,a1=dO,zO=xO,UO=(t,e,n)=>{const s=new Map,a={platform:RO,...n},i={...a.platform,_c:s};return cO(t,e,{...a,platform:i})};var Dm=typeof document<"u"?f.useLayoutEffect:f.useEffect;function kf(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,s,a;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(s=n;s--!==0;)if(!kf(t[s],e[s]))return!1;return!0}if(a=Object.keys(t),n=a.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!{}.hasOwnProperty.call(e,a[s]))return!1;for(s=n;s--!==0;){const i=a[s];if(!(i==="_owner"&&t.$$typeof)&&!kf(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function lE(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function i1(t,e){const n=lE(t);return Math.round(e*n)/n}function Yp(t){const e=f.useRef(t);return Dm(()=>{e.current=t}),e}function qO(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:s=[],platform:a,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:d}=t,[u,h]=f.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[m,p]=f.useState(s);kf(m,s)||p(s);const[b,x]=f.useState(null),[g,y]=f.useState(null),v=f.useCallback(O=>{O!==N.current&&(N.current=O,x(O))},[]),w=f.useCallback(O=>{O!==k.current&&(k.current=O,y(O))},[]),j=i||b,S=o||g,N=f.useRef(null),k=f.useRef(null),E=f.useRef(u),P=c!=null,A=Yp(c),C=Yp(a),T=Yp(d),I=f.useCallback(()=>{if(!N.current||!k.current)return;const O={placement:e,strategy:n,middleware:m};C.current&&(O.platform=C.current),UO(N.current,k.current,O).then(F=>{const B={...F,isPositioned:T.current!==!1};V.current&&!kf(E.current,B)&&(E.current=B,Ko.flushSync(()=>{h(B)}))})},[m,e,n,C,T]);Dm(()=>{d===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,h(O=>({...O,isPositioned:!1})))},[d]);const V=f.useRef(!1);Dm(()=>(V.current=!0,()=>{V.current=!1}),[]),Dm(()=>{if(j&&(N.current=j),S&&(k.current=S),j&&S){if(A.current)return A.current(j,S,I);I()}},[j,S,I,A,P]);const ne=f.useMemo(()=>({reference:N,floating:k,setReference:v,setFloating:w}),[v,w]),se=f.useMemo(()=>({reference:j,floating:S}),[j,S]),q=f.useMemo(()=>{const O={position:n,left:0,top:0};if(!se.floating)return O;const F=i1(se.floating,u.x),B=i1(se.floating,u.y);return l?{...O,transform:"translate("+F+"px, "+B+"px)",...lE(se.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:F,top:B}},[n,l,se.floating,u.x,u.y]);return f.useMemo(()=>({...u,update:I,refs:ne,elements:se,floatingStyles:q}),[u,I,ne,se,q])}const WO=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:s,padding:a}=typeof t=="function"?t(n):t;return s&&e(s)?s.current!=null?a1({element:s.current,padding:a}).fn(n):{}:s?a1({element:s,padding:a}).fn(n):{}}}},HO=(t,e)=>({...OO(t),options:[t,e]}),VO=(t,e)=>({...FO(t),options:[t,e]}),KO=(t,e)=>({...zO(t),options:[t,e]}),GO=(t,e)=>({...BO(t),options:[t,e]}),ZO=(t,e)=>({...LO(t),options:[t,e]}),QO=(t,e)=>({...$O(t),options:[t,e]}),YO=(t,e)=>({...WO(t),options:[t,e]});var JO="Arrow",cE=f.forwardRef((t,e)=>{const{children:n,width:s=10,height:a=5,...i}=t;return r.jsx(Le.svg,{...i,ref:e,width:s,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:r.jsx("polygon",{points:"0,0 30,0 15,10"})})});cE.displayName=JO;var XO=cE;function eF(t,e=[]){let n=[];function s(i,o){const l=f.createContext(o),c=n.length;n=[...n,o];function d(h){const{scope:m,children:p,...b}=h,x=(m==null?void 0:m[t][c])||l,g=f.useMemo(()=>b,Object.values(b));return r.jsx(x.Provider,{value:g,children:p})}function u(h,m){const p=(m==null?void 0:m[t][c])||l,b=f.useContext(p);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return d.displayName=i+"Provider",[d,u]}const a=()=>{const i=n.map(o=>f.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return f.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return a.scopeName=t,[s,tF(a,...e)]}function tF(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return f.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function dE(t){const[e,n]=f.useState(void 0);return gn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const s=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,d=Array.isArray(c)?c[0]:c;o=d.inlineSize,l=d.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return s.observe(t,{box:"border-box"}),()=>s.unobserve(t)}else n(void 0)},[t]),e}var Lb="Popper",[uE,Qi]=eF(Lb),[nF,hE]=uE(Lb),mE=t=>{const{__scopePopper:e,children:n}=t,[s,a]=f.useState(null);return r.jsx(nF,{scope:e,anchor:s,onAnchorChange:a,children:n})};mE.displayName=Lb;var fE="PopperAnchor",pE=f.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:s,...a}=t,i=hE(fE,n),o=f.useRef(null),l=yt(e,o);return f.useEffect(()=>{i.onAnchorChange((s==null?void 0:s.current)||o.current)}),s?null:r.jsx(Le.div,{...a,ref:l})});pE.displayName=fE;var $b="PopperContent",[rF,sF]=uE($b),xE=f.forwardRef((t,e)=>{var z,Y,ae,U,Q,oe;const{__scopePopper:n,side:s="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:m=!1,updatePositionStrategy:p="optimized",onPlaced:b,...x}=t,g=hE($b,n),[y,v]=f.useState(null),w=yt(e,re=>v(re)),[j,S]=f.useState(null),N=dE(j),k=(N==null?void 0:N.width)??0,E=(N==null?void 0:N.height)??0,P=s+(i!=="center"?"-"+i:""),A=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},C=Array.isArray(d)?d:[d],T=C.length>0,I={padding:A,boundary:C.filter(iF),altBoundary:T},{refs:V,floatingStyles:ne,placement:se,isPositioned:q,middlewareData:O}=qO({strategy:"fixed",placement:P,whileElementsMounted:(...re)=>IO(...re,{animationFrame:p==="always"}),elements:{reference:g.anchor},middleware:[HO({mainAxis:a+E,alignmentAxis:o}),c&&VO({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?KO():void 0,...I}),c&&GO({...I}),ZO({...I,apply:({elements:re,rects:le,availableWidth:Z,availableHeight:de})=>{const{width:he,height:Re}=le.reference,$e=re.floating.style;$e.setProperty("--radix-popper-available-width",`${Z}px`),$e.setProperty("--radix-popper-available-height",`${de}px`),$e.setProperty("--radix-popper-anchor-width",`${he}px`),$e.setProperty("--radix-popper-anchor-height",`${Re}px`)}}),j&&YO({element:j,padding:l}),oF({arrowWidth:k,arrowHeight:E}),m&&QO({strategy:"referenceHidden",...I})]}),[F,B]=yE(se),R=nn(b);gn(()=>{q&&(R==null||R())},[q,R]);const D=(z=O.arrow)==null?void 0:z.x,L=(Y=O.arrow)==null?void 0:Y.y,M=((ae=O.arrow)==null?void 0:ae.centerOffset)!==0,[X,K]=f.useState();return gn(()=>{y&&K(window.getComputedStyle(y).zIndex)},[y]),r.jsx("div",{ref:V.setFloating,"data-radix-popper-content-wrapper":"",style:{...ne,transform:q?ne.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:X,"--radix-popper-transform-origin":[(U=O.transformOrigin)==null?void 0:U.x,(Q=O.transformOrigin)==null?void 0:Q.y].join(" "),...((oe=O.hide)==null?void 0:oe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:r.jsx(rF,{scope:n,placedSide:F,onArrowChange:S,arrowX:D,arrowY:L,shouldHideArrow:M,children:r.jsx(Le.div,{"data-side":F,"data-align":B,...x,ref:w,style:{...x.style,animation:q?void 0:"none"}})})})});xE.displayName=$b;var gE="PopperArrow",aF={top:"bottom",right:"left",bottom:"top",left:"right"},vE=f.forwardRef(function(e,n){const{__scopePopper:s,...a}=e,i=sF(gE,s),o=aF[i.placedSide];return r.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:r.jsx(XO,{...a,ref:n,style:{...a.style,display:"block"}})})});vE.displayName=gE;function iF(t){return t!==null}var oF=t=>({name:"transformOrigin",options:t,fn(e){var g,y,v;const{placement:n,rects:s,middlewareData:a}=e,o=((g=a.arrow)==null?void 0:g.centerOffset)!==0,l=o?0:t.arrowWidth,c=o?0:t.arrowHeight,[d,u]=yE(n),h={start:"0%",center:"50%",end:"100%"}[u],m=(((y=a.arrow)==null?void 0:y.x)??0)+l/2,p=(((v=a.arrow)==null?void 0:v.y)??0)+c/2;let b="",x="";return d==="bottom"?(b=o?h:`${m}px`,x=`${-c}px`):d==="top"?(b=o?h:`${m}px`,x=`${s.floating.height+c}px`):d==="right"?(b=`${-c}px`,x=o?h:`${p}px`):d==="left"&&(b=`${s.floating.width+c}px`,x=o?h:`${p}px`),{data:{x:b,y:x}}}});function yE(t){const[e,n="center"]=t.split("-");return[e,n]}var zb=mE,rh=pE,D0=xE,P0=vE,[T0,cee]=Zr("Tooltip",[Qi]),Ub=Qi(),bE="TooltipProvider",lF=700,o1="tooltip.open",[cF,wE]=T0(bE),jE=t=>{const{__scopeTooltip:e,delayDuration:n=lF,skipDelayDuration:s=300,disableHoverableContent:a=!1,children:i}=t,[o,l]=f.useState(!0),c=f.useRef(!1),d=f.useRef(0);return f.useEffect(()=>{const u=d.current;return()=>window.clearTimeout(u)},[]),r.jsx(cF,{scope:e,isOpenDelayed:o,delayDuration:n,onOpen:f.useCallback(()=>{window.clearTimeout(d.current),l(!1)},[]),onClose:f.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>l(!0),s)},[s]),isPointerInTransitRef:c,onPointerInTransitChange:f.useCallback(u=>{c.current=u},[]),disableHoverableContent:a,children:i})};jE.displayName=bE;var _E="Tooltip",[dee,R0]=T0(_E),kv="TooltipTrigger",dF=f.forwardRef((t,e)=>{const{__scopeTooltip:n,...s}=t,a=R0(kv,n),i=wE(kv,n),o=Ub(n),l=f.useRef(null),c=yt(e,l,a.onTriggerChange),d=f.useRef(!1),u=f.useRef(!1),h=f.useCallback(()=>d.current=!1,[]);return f.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),r.jsx(rh,{asChild:!0,...o,children:r.jsx(Le.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...s,ref:c,onPointerMove:be(t.onPointerMove,m=>{m.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:be(t.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:be(t.onPointerDown,()=>{d.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:be(t.onFocus,()=>{d.current||a.onOpen()}),onBlur:be(t.onBlur,a.onClose),onClick:be(t.onClick,a.onClose)})})});dF.displayName=kv;var uF="TooltipPortal",[uee,hF]=T0(uF,{forceMount:void 0}),yc="TooltipContent",NE=f.forwardRef((t,e)=>{const n=hF(yc,t.__scopeTooltip),{forceMount:s=n.forceMount,side:a="top",...i}=t,o=R0(yc,t.__scopeTooltip);return r.jsx(Sn,{present:s||o.open,children:o.disableHoverableContent?r.jsx(SE,{side:a,...i,ref:e}):r.jsx(mF,{side:a,...i,ref:e})})}),mF=f.forwardRef((t,e)=>{const n=R0(yc,t.__scopeTooltip),s=wE(yc,t.__scopeTooltip),a=f.useRef(null),i=yt(e,a),[o,l]=f.useState(null),{trigger:c,onClose:d}=n,u=a.current,{onPointerInTransitChange:h}=s,m=f.useCallback(()=>{l(null),h(!1)},[h]),p=f.useCallback((b,x)=>{const g=b.currentTarget,y={x:b.clientX,y:b.clientY},v=gF(y,g.getBoundingClientRect()),w=vF(y,v),j=yF(x.getBoundingClientRect()),S=wF([...w,...j]);l(S),h(!0)},[h]);return f.useEffect(()=>()=>m(),[m]),f.useEffect(()=>{if(c&&u){const b=g=>p(g,u),x=g=>p(g,c);return c.addEventListener("pointerleave",b),u.addEventListener("pointerleave",x),()=>{c.removeEventListener("pointerleave",b),u.removeEventListener("pointerleave",x)}}},[c,u,p,m]),f.useEffect(()=>{if(o){const b=x=>{const g=x.target,y={x:x.clientX,y:x.clientY},v=(c==null?void 0:c.contains(g))||(u==null?void 0:u.contains(g)),w=!bF(y,o);v?m():w&&(m(),d())};return document.addEventListener("pointermove",b),()=>document.removeEventListener("pointermove",b)}},[c,u,o,d,m]),r.jsx(SE,{...t,ref:i})}),[fF,pF]=T0(_E,{isInside:!1}),SE=f.forwardRef((t,e)=>{const{__scopeTooltip:n,children:s,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=t,c=R0(yc,n),d=Ub(n),{onClose:u}=c;return f.useEffect(()=>(document.addEventListener(o1,u),()=>document.removeEventListener(o1,u)),[u]),f.useEffect(()=>{if(c.trigger){const h=m=>{const p=m.target;p!=null&&p.contains(c.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[c.trigger,u]),r.jsx(Go,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:r.jsxs(D0,{"data-state":c.stateAttribute,...d,...l,ref:e,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[r.jsx(fC,{children:s}),r.jsx(fF,{scope:n,isInside:!0,children:r.jsx(VM,{id:c.contentId,role:"tooltip",children:a||s})})]})})});NE.displayName=yc;var kE="TooltipArrow",xF=f.forwardRef((t,e)=>{const{__scopeTooltip:n,...s}=t,a=Ub(n);return pF(kE,n).isInside?null:r.jsx(P0,{...a,...s,ref:e})});xF.displayName=kE;function gF(t,e){const n=Math.abs(e.top-t.y),s=Math.abs(e.bottom-t.y),a=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,s,a,i)){case i:return"left";case a:return"right";case n:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function vF(t,e,n=5){const s=[];switch(e){case"top":s.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":s.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":s.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":s.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return s}function yF(t){const{top:e,right:n,bottom:s,left:a}=t;return[{x:a,y:e},{x:n,y:e},{x:n,y:s},{x:a,y:s}]}function bF(t,e){const{x:n,y:s}=t;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const l=e[i].x,c=e[i].y,d=e[o].x,u=e[o].y;c>s!=u>s&&n<(d-l)*(s-c)/(u-c)+l&&(a=!a)}return a}function wF(t){const e=t.slice();return e.sort((n,s)=>n.x<s.x?-1:n.x>s.x?1:n.y<s.y?-1:n.y>s.y?1:0),jF(e)}function jF(t){if(t.length<=1)return t.slice();const e=[];for(let s=0;s<t.length;s++){const a=t[s];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))e.pop();else break}e.push(a)}e.pop();const n=[];for(let s=t.length-1;s>=0;s--){const a=t[s];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))n.pop();else break}n.push(a)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var _F=jE,CE=NE;const NF=_F,SF=f.forwardRef(({className:t,sideOffset:e=4,...n},s)=>r.jsx(CE,{ref:s,sideOffset:e,className:_e("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));SF.displayName=CE.displayName;var Bc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Fo=typeof window>"u"||"Deno"in globalThis;function Jr(){}function kF(t,e){return typeof t=="function"?t(e):t}function Cv(t){return typeof t=="number"&&t>=0&&t!==1/0}function EE(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Gl(t,e){return typeof t=="function"?t(e):t}function ys(t,e){return typeof t=="function"?t(e):t}function l1(t,e){const{type:n="all",exact:s,fetchStatus:a,predicate:i,queryKey:o,stale:l}=t;if(o){if(s){if(e.queryHash!==qb(o,e.options))return!1}else if(!xu(e.queryKey,o))return!1}if(n!=="all"){const c=e.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||a&&a!==e.state.fetchStatus||i&&!i(e))}function c1(t,e){const{exact:n,status:s,predicate:a,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(Bo(e.options.mutationKey)!==Bo(i))return!1}else if(!xu(e.options.mutationKey,i))return!1}return!(s&&e.state.status!==s||a&&!a(e))}function qb(t,e){return((e==null?void 0:e.queryKeyHashFn)||Bo)(t)}function Bo(t){return JSON.stringify(t,(e,n)=>Ev(n)?Object.keys(n).sort().reduce((s,a)=>(s[a]=n[a],s),{}):n)}function xu(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(n=>!xu(t[n],e[n])):!1}function AE(t,e){if(t===e)return t;const n=d1(t)&&d1(e);if(n||Ev(t)&&Ev(e)){const s=n?t:Object.keys(t),a=s.length,i=n?e:Object.keys(e),o=i.length,l=n?[]:{};let c=0;for(let d=0;d<o;d++){const u=n?d:i[d];(!n&&s.includes(u)||n)&&t[u]===void 0&&e[u]===void 0?(l[u]=void 0,c++):(l[u]=AE(t[u],e[u]),l[u]===t[u]&&t[u]!==void 0&&c++)}return a===o&&c===a?t:l}return e}function Cf(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function d1(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Ev(t){if(!u1(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!u1(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function u1(t){return Object.prototype.toString.call(t)==="[object Object]"}function CF(t){return new Promise(e=>{setTimeout(e,t)})}function Av(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?AE(t,e):e}function EF(t,e,n=0){const s=[...t,e];return n&&s.length>n?s.slice(1):s}function AF(t,e,n=0){const s=[e,...t];return n&&s.length>n?s.slice(0,-1):s}var Wb=Symbol();function DE(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Wb?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var vo,di,Jl,z2,DF=(z2=class extends Bc{constructor(){super();Ye(this,vo);Ye(this,di);Ye(this,Jl);De(this,Jl,e=>{if(!Fo&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){ee(this,di)||this.setEventListener(ee(this,Jl))}onUnsubscribe(){var e;this.hasListeners()||((e=ee(this,di))==null||e.call(this),De(this,di,void 0))}setEventListener(e){var n;De(this,Jl,e),(n=ee(this,di))==null||n.call(this),De(this,di,e(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(e){ee(this,vo)!==e&&(De(this,vo,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof ee(this,vo)=="boolean"?ee(this,vo):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},vo=new WeakMap,di=new WeakMap,Jl=new WeakMap,z2),Hb=new DF,Xl,ui,ec,U2,PF=(U2=class extends Bc{constructor(){super();Ye(this,Xl,!0);Ye(this,ui);Ye(this,ec);De(this,ec,e=>{if(!Fo&&window.addEventListener){const n=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){ee(this,ui)||this.setEventListener(ee(this,ec))}onUnsubscribe(){var e;this.hasListeners()||((e=ee(this,ui))==null||e.call(this),De(this,ui,void 0))}setEventListener(e){var n;De(this,ec,e),(n=ee(this,ui))==null||n.call(this),De(this,ui,e(this.setOnline.bind(this)))}setOnline(e){ee(this,Xl)!==e&&(De(this,Xl,e),this.listeners.forEach(s=>{s(e)}))}isOnline(){return ee(this,Xl)}},Xl=new WeakMap,ui=new WeakMap,ec=new WeakMap,U2),Ef=new PF;function Dv(){let t,e;const n=new Promise((a,i)=>{t=a,e=i});n.status="pending",n.catch(()=>{});function s(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{s({status:"fulfilled",value:a}),t(a)},n.reject=a=>{s({status:"rejected",reason:a}),e(a)},n}function TF(t){return Math.min(1e3*2**t,3e4)}function PE(t){return(t??"online")==="online"?Ef.isOnline():!0}var TE=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function Jp(t){return t instanceof TE}function RE(t){let e=!1,n=0,s=!1,a;const i=Dv(),o=x=>{var g;s||(m(new TE(x)),(g=t.abort)==null||g.call(t))},l=()=>{e=!0},c=()=>{e=!1},d=()=>Hb.isFocused()&&(t.networkMode==="always"||Ef.isOnline())&&t.canRun(),u=()=>PE(t.networkMode)&&t.canRun(),h=x=>{var g;s||(s=!0,(g=t.onSuccess)==null||g.call(t,x),a==null||a(),i.resolve(x))},m=x=>{var g;s||(s=!0,(g=t.onError)==null||g.call(t,x),a==null||a(),i.reject(x))},p=()=>new Promise(x=>{var g;a=y=>{(s||d())&&x(y)},(g=t.onPause)==null||g.call(t)}).then(()=>{var x;a=void 0,s||(x=t.onContinue)==null||x.call(t)}),b=()=>{if(s)return;let x;const g=n===0?t.initialPromise:void 0;try{x=g??t.fn()}catch(y){x=Promise.reject(y)}Promise.resolve(x).then(h).catch(y=>{var N;if(s)return;const v=t.retry??(Fo?0:3),w=t.retryDelay??TF,j=typeof w=="function"?w(n,y):w,S=v===!0||typeof v=="number"&&n<v||typeof v=="function"&&v(n,y);if(e||!S){m(y);return}n++,(N=t.onFail)==null||N.call(t,n,y),CF(j).then(()=>d()?void 0:p()).then(()=>{e?m(y):b()})})};return{promise:i,cancel:o,continue:()=>(a==null||a(),i),cancelRetry:l,continueRetry:c,canStart:u,start:()=>(u()?b():p().then(b),i)}}function RF(){let t=[],e=0,n=l=>{l()},s=l=>{l()},a=l=>setTimeout(l,0);const i=l=>{e?t.push(l):a(()=>{n(l)})},o=()=>{const l=t;t=[],l.length&&a(()=>{s(()=>{l.forEach(c=>{n(c)})})})};return{batch:l=>{let c;e++;try{c=l()}finally{e--,e||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{s=l},setScheduler:l=>{a=l}}}var jn=RF(),yo,q2,ME=(q2=class{constructor(){Ye(this,yo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Cv(this.gcTime)&&De(this,yo,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Fo?1/0:5*60*1e3))}clearGcTimeout(){ee(this,yo)&&(clearTimeout(ee(this,yo)),De(this,yo,void 0))}},yo=new WeakMap,q2),tc,nc,Yr,Qn,zu,bo,ps,ya,W2,MF=(W2=class extends ME{constructor(e){super();Ye(this,ps);Ye(this,tc);Ye(this,nc);Ye(this,Yr);Ye(this,Qn);Ye(this,zu);Ye(this,bo);De(this,bo,!1),De(this,zu,e.defaultOptions),this.setOptions(e.options),this.observers=[],De(this,Yr,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,De(this,tc,IF(this.options)),this.state=e.state??ee(this,tc),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=ee(this,Qn))==null?void 0:e.promise}setOptions(e){this.options={...ee(this,zu),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ee(this,Yr).remove(this)}setData(e,n){const s=Av(this.state.data,e,this.options);return jt(this,ps,ya).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(e,n){jt(this,ps,ya).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var s,a;const n=(s=ee(this,Qn))==null?void 0:s.promise;return(a=ee(this,Qn))==null||a.cancel(e),n?n.then(Jr).catch(Jr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ee(this,tc))}isActive(){return this.observers.some(e=>ys(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Wb||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!EE(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(s=>s.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=ee(this,Qn))==null||n.continue()}onOnline(){var n;const e=this.observers.find(s=>s.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=ee(this,Qn))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),ee(this,Yr).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(ee(this,Qn)&&(ee(this,bo)?ee(this,Qn).cancel({revert:!0}):ee(this,Qn).cancelRetry()),this.scheduleGc()),ee(this,Yr).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||jt(this,ps,ya).call(this,{type:"invalidate"})}fetch(e,n){var c,d,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(ee(this,Qn))return ee(this,Qn).continueRetry(),ee(this,Qn).promise}if(e&&this.setOptions(e),!this.options.queryFn){const h=this.observers.find(m=>m.options.queryFn);h&&this.setOptions(h.options)}const s=new AbortController,a=h=>{Object.defineProperty(h,"signal",{enumerable:!0,get:()=>(De(this,bo,!0),s.signal)})},i=()=>{const h=DE(this.options,n),m={queryKey:this.queryKey,meta:this.meta};return a(m),De(this,bo,!1),this.options.persister?this.options.persister(h,m,this):h(m)},o={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};a(o),(c=this.options.behavior)==null||c.onFetch(o,this),De(this,nc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=o.fetchOptions)==null?void 0:d.meta))&&jt(this,ps,ya).call(this,{type:"fetch",meta:(u=o.fetchOptions)==null?void 0:u.meta});const l=h=>{var m,p,b,x;Jp(h)&&h.silent||jt(this,ps,ya).call(this,{type:"error",error:h}),Jp(h)||((p=(m=ee(this,Yr).config).onError)==null||p.call(m,h,this),(x=(b=ee(this,Yr).config).onSettled)==null||x.call(b,this.state.data,h,this)),this.scheduleGc()};return De(this,Qn,RE({initialPromise:n==null?void 0:n.initialPromise,fn:o.fetchFn,abort:s.abort.bind(s),onSuccess:h=>{var m,p,b,x;if(h===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(h)}catch(g){l(g);return}(p=(m=ee(this,Yr).config).onSuccess)==null||p.call(m,h,this),(x=(b=ee(this,Yr).config).onSettled)==null||x.call(b,h,this.state.error,this),this.scheduleGc()},onError:l,onFail:(h,m)=>{jt(this,ps,ya).call(this,{type:"failed",failureCount:h,error:m})},onPause:()=>{jt(this,ps,ya).call(this,{type:"pause"})},onContinue:()=>{jt(this,ps,ya).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),ee(this,Qn).start()}},tc=new WeakMap,nc=new WeakMap,Yr=new WeakMap,Qn=new WeakMap,zu=new WeakMap,bo=new WeakMap,ps=new WeakSet,ya=function(e){const n=s=>{switch(e.type){case"failed":return{...s,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...IE(s.data,this.options),fetchMeta:e.meta??null};case"success":return{...s,data:e.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=e.error;return Jp(a)&&a.revert&&ee(this,nc)?{...ee(this,nc),fetchStatus:"idle"}:{...s,error:a,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...e.state}}};this.state=n(this.state),jn.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),ee(this,Yr).notify({query:this,type:"updated",action:e})})},W2);function IE(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:PE(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function IF(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,s=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var qs,H2,OF=(H2=class extends Bc{constructor(e={}){super();Ye(this,qs);this.config=e,De(this,qs,new Map)}build(e,n,s){const a=n.queryKey,i=n.queryHash??qb(a,n);let o=this.get(i);return o||(o=new MF({cache:this,queryKey:a,queryHash:i,options:e.defaultQueryOptions(n),state:s,defaultOptions:e.getQueryDefaults(a)}),this.add(o)),o}add(e){ee(this,qs).has(e.queryHash)||(ee(this,qs).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=ee(this,qs).get(e.queryHash);n&&(e.destroy(),n===e&&ee(this,qs).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){jn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return ee(this,qs).get(e)}getAll(){return[...ee(this,qs).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(s=>l1(n,s))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(s=>l1(e,s)):n}notify(e){jn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){jn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){jn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},qs=new WeakMap,H2),Ws,sr,wo,Hs,Ya,V2,FF=(V2=class extends ME{constructor(e){super();Ye(this,Hs);Ye(this,Ws);Ye(this,sr);Ye(this,wo);this.mutationId=e.mutationId,De(this,sr,e.mutationCache),De(this,Ws,[]),this.state=e.state||OE(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){ee(this,Ws).includes(e)||(ee(this,Ws).push(e),this.clearGcTimeout(),ee(this,sr).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){De(this,Ws,ee(this,Ws).filter(n=>n!==e)),this.scheduleGc(),ee(this,sr).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){ee(this,Ws).length||(this.state.status==="pending"?this.scheduleGc():ee(this,sr).remove(this))}continue(){var e;return((e=ee(this,wo))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var a,i,o,l,c,d,u,h,m,p,b,x,g,y,v,w,j,S,N,k;De(this,wo,RE({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(E,P)=>{jt(this,Hs,Ya).call(this,{type:"failed",failureCount:E,error:P})},onPause:()=>{jt(this,Hs,Ya).call(this,{type:"pause"})},onContinue:()=>{jt(this,Hs,Ya).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ee(this,sr).canRun(this)}));const n=this.state.status==="pending",s=!ee(this,wo).canStart();try{if(!n){jt(this,Hs,Ya).call(this,{type:"pending",variables:e,isPaused:s}),await((i=(a=ee(this,sr).config).onMutate)==null?void 0:i.call(a,e,this));const P=await((l=(o=this.options).onMutate)==null?void 0:l.call(o,e));P!==this.state.context&&jt(this,Hs,Ya).call(this,{type:"pending",context:P,variables:e,isPaused:s})}const E=await ee(this,wo).start();return await((d=(c=ee(this,sr).config).onSuccess)==null?void 0:d.call(c,E,e,this.state.context,this)),await((h=(u=this.options).onSuccess)==null?void 0:h.call(u,E,e,this.state.context)),await((p=(m=ee(this,sr).config).onSettled)==null?void 0:p.call(m,E,null,this.state.variables,this.state.context,this)),await((x=(b=this.options).onSettled)==null?void 0:x.call(b,E,null,e,this.state.context)),jt(this,Hs,Ya).call(this,{type:"success",data:E}),E}catch(E){try{throw await((y=(g=ee(this,sr).config).onError)==null?void 0:y.call(g,E,e,this.state.context,this)),await((w=(v=this.options).onError)==null?void 0:w.call(v,E,e,this.state.context)),await((S=(j=ee(this,sr).config).onSettled)==null?void 0:S.call(j,void 0,E,this.state.variables,this.state.context,this)),await((k=(N=this.options).onSettled)==null?void 0:k.call(N,void 0,E,e,this.state.context)),E}finally{jt(this,Hs,Ya).call(this,{type:"error",error:E})}}finally{ee(this,sr).runNext(this)}}},Ws=new WeakMap,sr=new WeakMap,wo=new WeakMap,Hs=new WeakSet,Ya=function(e){const n=s=>{switch(e.type){case"failed":return{...s,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...s,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:e.error,failureCount:s.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),jn.batch(()=>{ee(this,Ws).forEach(s=>{s.onMutationUpdate(e)}),ee(this,sr).notify({mutation:this,type:"updated",action:e})})},V2);function OE(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Tr,Uu,K2,BF=(K2=class extends Bc{constructor(e={}){super();Ye(this,Tr);Ye(this,Uu);this.config=e,De(this,Tr,new Map),De(this,Uu,Date.now())}build(e,n,s){const a=new FF({mutationCache:this,mutationId:++Nh(this,Uu)._,options:e.defaultMutationOptions(n),state:s});return this.add(a),a}add(e){const n=Gh(e),s=ee(this,Tr).get(n)??[];s.push(e),ee(this,Tr).set(n,s),this.notify({type:"added",mutation:e})}remove(e){var s;const n=Gh(e);if(ee(this,Tr).has(n)){const a=(s=ee(this,Tr).get(n))==null?void 0:s.filter(i=>i!==e);a&&(a.length===0?ee(this,Tr).delete(n):ee(this,Tr).set(n,a))}this.notify({type:"removed",mutation:e})}canRun(e){var s;const n=(s=ee(this,Tr).get(Gh(e)))==null?void 0:s.find(a=>a.state.status==="pending");return!n||n===e}runNext(e){var s;const n=(s=ee(this,Tr).get(Gh(e)))==null?void 0:s.find(a=>a!==e&&a.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){jn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...ee(this,Tr).values()].flat()}find(e){const n={exact:!0,...e};return this.getAll().find(s=>c1(n,s))}findAll(e={}){return this.getAll().filter(n=>c1(e,n))}notify(e){jn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return jn.batch(()=>Promise.all(e.map(n=>n.continue().catch(Jr))))}},Tr=new WeakMap,Uu=new WeakMap,K2);function Gh(t){var e;return((e=t.options.scope)==null?void 0:e.id)??String(t.mutationId)}function h1(t){return{onFetch:(e,n)=>{var u,h,m,p,b;const s=e.options,a=(m=(h=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:m.direction,i=((p=e.state.data)==null?void 0:p.pages)||[],o=((b=e.state.data)==null?void 0:b.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let x=!1;const g=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(e.signal.aborted?x=!0:e.signal.addEventListener("abort",()=>{x=!0}),e.signal)})},y=DE(e.options,e.fetchOptions),v=async(w,j,S)=>{if(x)return Promise.reject();if(j==null&&w.pages.length)return Promise.resolve(w);const N={queryKey:e.queryKey,pageParam:j,direction:S?"backward":"forward",meta:e.options.meta};g(N);const k=await y(N),{maxPages:E}=e.options,P=S?AF:EF;return{pages:P(w.pages,k,E),pageParams:P(w.pageParams,j,E)}};if(a&&i.length){const w=a==="backward",j=w?LF:m1,S={pages:i,pageParams:o},N=j(s,S);l=await v(S,N,w)}else{const w=t??i.length;do{const j=c===0?o[0]??s.initialPageParam:m1(s,l);if(c>0&&j==null)break;l=await v(l,j),c++}while(c<w)}return l};e.options.persister?e.fetchFn=()=>{var x,g;return(g=(x=e.options).persister)==null?void 0:g.call(x,d,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=d}}}function m1(t,{pages:e,pageParams:n}){const s=e.length-1;return e.length>0?t.getNextPageParam(e[s],e,n[s],n):void 0}function LF(t,{pages:e,pageParams:n}){var s;return e.length>0?(s=t.getPreviousPageParam)==null?void 0:s.call(t,e[0],e,n[0],n):void 0}var cn,hi,mi,rc,sc,fi,ac,ic,G2,$F=(G2=class{constructor(t={}){Ye(this,cn);Ye(this,hi);Ye(this,mi);Ye(this,rc);Ye(this,sc);Ye(this,fi);Ye(this,ac);Ye(this,ic);De(this,cn,t.queryCache||new OF),De(this,hi,t.mutationCache||new BF),De(this,mi,t.defaultOptions||{}),De(this,rc,new Map),De(this,sc,new Map),De(this,fi,0)}mount(){Nh(this,fi)._++,ee(this,fi)===1&&(De(this,ac,Hb.subscribe(async t=>{t&&(await this.resumePausedMutations(),ee(this,cn).onFocus())})),De(this,ic,Ef.subscribe(async t=>{t&&(await this.resumePausedMutations(),ee(this,cn).onOnline())})))}unmount(){var t,e;Nh(this,fi)._--,ee(this,fi)===0&&((t=ee(this,ac))==null||t.call(this),De(this,ac,void 0),(e=ee(this,ic))==null||e.call(this),De(this,ic,void 0))}isFetching(t){return ee(this,cn).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return ee(this,hi).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=ee(this,cn).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);if(e===void 0)return this.fetchQuery(t);{const n=this.defaultQueryOptions(t),s=ee(this,cn).build(this,n);return t.revalidateIfStale&&s.isStaleByTime(Gl(n.staleTime,s))&&this.prefetchQuery(n),Promise.resolve(e)}}getQueriesData(t){return ee(this,cn).findAll(t).map(({queryKey:e,state:n})=>{const s=n.data;return[e,s]})}setQueryData(t,e,n){const s=this.defaultQueryOptions({queryKey:t}),a=ee(this,cn).get(s.queryHash),i=a==null?void 0:a.state.data,o=kF(e,i);if(o!==void 0)return ee(this,cn).build(this,s).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return jn.batch(()=>ee(this,cn).findAll(t).map(({queryKey:s})=>[s,this.setQueryData(s,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=ee(this,cn).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=ee(this,cn);jn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=ee(this,cn),s={type:"active",...t};return jn.batch(()=>(n.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(s,e)))}cancelQueries(t={},e={}){const n={revert:!0,...e},s=jn.batch(()=>ee(this,cn).findAll(t).map(a=>a.cancel(n)));return Promise.all(s).then(Jr).catch(Jr)}invalidateQueries(t={},e={}){return jn.batch(()=>{if(ee(this,cn).findAll(t).forEach(s=>{s.invalidate()}),t.refetchType==="none")return Promise.resolve();const n={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(n,e)})}refetchQueries(t={},e){const n={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},s=jn.batch(()=>ee(this,cn).findAll(t).filter(a=>!a.isDisabled()).map(a=>{let i=a.fetch(void 0,n);return n.throwOnError||(i=i.catch(Jr)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(Jr)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=ee(this,cn).build(this,e);return n.isStaleByTime(Gl(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Jr).catch(Jr)}fetchInfiniteQuery(t){return t.behavior=h1(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Jr).catch(Jr)}ensureInfiniteQueryData(t){return t.behavior=h1(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Ef.isOnline()?ee(this,hi).resumePausedMutations():Promise.resolve()}getQueryCache(){return ee(this,cn)}getMutationCache(){return ee(this,hi)}getDefaultOptions(){return ee(this,mi)}setDefaultOptions(t){De(this,mi,t)}setQueryDefaults(t,e){ee(this,rc).set(Bo(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...ee(this,rc).values()];let n={};return e.forEach(s=>{xu(t,s.queryKey)&&(n={...n,...s.defaultOptions})}),n}setMutationDefaults(t,e){ee(this,sc).set(Bo(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...ee(this,sc).values()];let n={};return e.forEach(s=>{xu(t,s.mutationKey)&&(n={...n,...s.defaultOptions})}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...ee(this,mi).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=qb(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===Wb&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...ee(this,mi).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){ee(this,cn).clear(),ee(this,hi).clear()}},cn=new WeakMap,hi=new WeakMap,mi=new WeakMap,rc=new WeakMap,sc=new WeakMap,fi=new WeakMap,ac=new WeakMap,ic=new WeakMap,G2),xr,Dt,qu,ar,jo,oc,pi,Vs,Wu,lc,cc,_o,No,xi,dc,Ut,md,Pv,Tv,Rv,Mv,Iv,Ov,Fv,FE,Z2,zF=(Z2=class extends Bc{constructor(e,n){super();Ye(this,Ut);Ye(this,xr);Ye(this,Dt);Ye(this,qu);Ye(this,ar);Ye(this,jo);Ye(this,oc);Ye(this,pi);Ye(this,Vs);Ye(this,Wu);Ye(this,lc);Ye(this,cc);Ye(this,_o);Ye(this,No);Ye(this,xi);Ye(this,dc,new Set);this.options=n,De(this,xr,e),De(this,Vs,null),De(this,pi,Dv()),this.options.experimental_prefetchInRender||ee(this,pi).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ee(this,Dt).addObserver(this),f1(ee(this,Dt),this.options)?jt(this,Ut,md).call(this):this.updateResult(),jt(this,Ut,Mv).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Bv(ee(this,Dt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Bv(ee(this,Dt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,jt(this,Ut,Iv).call(this),jt(this,Ut,Ov).call(this),ee(this,Dt).removeObserver(this)}setOptions(e,n){const s=this.options,a=ee(this,Dt);if(this.options=ee(this,xr).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ys(this.options.enabled,ee(this,Dt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");jt(this,Ut,Fv).call(this),ee(this,Dt).setOptions(this.options),s._defaulted&&!Cf(this.options,s)&&ee(this,xr).getQueryCache().notify({type:"observerOptionsUpdated",query:ee(this,Dt),observer:this});const i=this.hasListeners();i&&p1(ee(this,Dt),a,this.options,s)&&jt(this,Ut,md).call(this),this.updateResult(n),i&&(ee(this,Dt)!==a||ys(this.options.enabled,ee(this,Dt))!==ys(s.enabled,ee(this,Dt))||Gl(this.options.staleTime,ee(this,Dt))!==Gl(s.staleTime,ee(this,Dt)))&&jt(this,Ut,Pv).call(this);const o=jt(this,Ut,Tv).call(this);i&&(ee(this,Dt)!==a||ys(this.options.enabled,ee(this,Dt))!==ys(s.enabled,ee(this,Dt))||o!==ee(this,xi))&&jt(this,Ut,Rv).call(this,o)}getOptimisticResult(e){const n=ee(this,xr).getQueryCache().build(ee(this,xr),e),s=this.createResult(n,e);return qF(this,s)&&(De(this,ar,s),De(this,oc,this.options),De(this,jo,ee(this,Dt).state)),s}getCurrentResult(){return ee(this,ar)}trackResult(e,n){const s={};return Object.keys(e).forEach(a=>{Object.defineProperty(s,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),n==null||n(a),e[a])})}),s}trackProp(e){ee(this,dc).add(e)}getCurrentQuery(){return ee(this,Dt)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=ee(this,xr).defaultQueryOptions(e),s=ee(this,xr).getQueryCache().build(ee(this,xr),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(e){return jt(this,Ut,md).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),ee(this,ar)))}createResult(e,n){var E;const s=ee(this,Dt),a=this.options,i=ee(this,ar),o=ee(this,jo),l=ee(this,oc),d=e!==s?e.state:ee(this,qu),{state:u}=e;let h={...u},m=!1,p;if(n._optimisticResults){const P=this.hasListeners(),A=!P&&f1(e,n),C=P&&p1(e,s,n,a);(A||C)&&(h={...h,...IE(u.data,e.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:b,errorUpdatedAt:x,status:g}=h;if(n.select&&h.data!==void 0)if(i&&h.data===(o==null?void 0:o.data)&&n.select===ee(this,Wu))p=ee(this,lc);else try{De(this,Wu,n.select),p=n.select(h.data),p=Av(i==null?void 0:i.data,p,n),De(this,lc,p),De(this,Vs,null)}catch(P){De(this,Vs,P)}else p=h.data;if(n.placeholderData!==void 0&&p===void 0&&g==="pending"){let P;if(i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData))P=i.data;else if(P=typeof n.placeholderData=="function"?n.placeholderData((E=ee(this,cc))==null?void 0:E.state.data,ee(this,cc)):n.placeholderData,n.select&&P!==void 0)try{P=n.select(P),De(this,Vs,null)}catch(A){De(this,Vs,A)}P!==void 0&&(g="success",p=Av(i==null?void 0:i.data,P,n),m=!0)}ee(this,Vs)&&(b=ee(this,Vs),p=ee(this,lc),x=Date.now(),g="error");const y=h.fetchStatus==="fetching",v=g==="pending",w=g==="error",j=v&&y,S=p!==void 0,k={status:g,fetchStatus:h.fetchStatus,isPending:v,isSuccess:g==="success",isError:w,isInitialLoading:j,isLoading:j,data:p,dataUpdatedAt:h.dataUpdatedAt,error:b,errorUpdatedAt:x,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:y,isRefetching:y&&!v,isLoadingError:w&&!S,isPaused:h.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:w&&S,isStale:Vb(e,n),refetch:this.refetch,promise:ee(this,pi)};if(this.options.experimental_prefetchInRender){const P=T=>{k.status==="error"?T.reject(k.error):k.data!==void 0&&T.resolve(k.data)},A=()=>{const T=De(this,pi,k.promise=Dv());P(T)},C=ee(this,pi);switch(C.status){case"pending":e.queryHash===s.queryHash&&P(C);break;case"fulfilled":(k.status==="error"||k.data!==C.value)&&A();break;case"rejected":(k.status!=="error"||k.error!==C.reason)&&A();break}}return k}updateResult(e){const n=ee(this,ar),s=this.createResult(ee(this,Dt),this.options);if(De(this,jo,ee(this,Dt).state),De(this,oc,this.options),ee(this,jo).data!==void 0&&De(this,cc,ee(this,Dt)),Cf(s,n))return;De(this,ar,s);const a={},i=()=>{if(!n)return!0;const{notifyOnChangeProps:o}=this.options,l=typeof o=="function"?o():o;if(l==="all"||!l&&!ee(this,dc).size)return!0;const c=new Set(l??ee(this,dc));return this.options.throwOnError&&c.add("error"),Object.keys(ee(this,ar)).some(d=>{const u=d;return ee(this,ar)[u]!==n[u]&&c.has(u)})};(e==null?void 0:e.listeners)!==!1&&i()&&(a.listeners=!0),jt(this,Ut,FE).call(this,{...a,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&jt(this,Ut,Mv).call(this)}},xr=new WeakMap,Dt=new WeakMap,qu=new WeakMap,ar=new WeakMap,jo=new WeakMap,oc=new WeakMap,pi=new WeakMap,Vs=new WeakMap,Wu=new WeakMap,lc=new WeakMap,cc=new WeakMap,_o=new WeakMap,No=new WeakMap,xi=new WeakMap,dc=new WeakMap,Ut=new WeakSet,md=function(e){jt(this,Ut,Fv).call(this);let n=ee(this,Dt).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Jr)),n},Pv=function(){jt(this,Ut,Iv).call(this);const e=Gl(this.options.staleTime,ee(this,Dt));if(Fo||ee(this,ar).isStale||!Cv(e))return;const s=EE(ee(this,ar).dataUpdatedAt,e)+1;De(this,_o,setTimeout(()=>{ee(this,ar).isStale||this.updateResult()},s))},Tv=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ee(this,Dt)):this.options.refetchInterval)??!1},Rv=function(e){jt(this,Ut,Ov).call(this),De(this,xi,e),!(Fo||ys(this.options.enabled,ee(this,Dt))===!1||!Cv(ee(this,xi))||ee(this,xi)===0)&&De(this,No,setInterval(()=>{(this.options.refetchIntervalInBackground||Hb.isFocused())&&jt(this,Ut,md).call(this)},ee(this,xi)))},Mv=function(){jt(this,Ut,Pv).call(this),jt(this,Ut,Rv).call(this,jt(this,Ut,Tv).call(this))},Iv=function(){ee(this,_o)&&(clearTimeout(ee(this,_o)),De(this,_o,void 0))},Ov=function(){ee(this,No)&&(clearInterval(ee(this,No)),De(this,No,void 0))},Fv=function(){const e=ee(this,xr).getQueryCache().build(ee(this,xr),this.options);if(e===ee(this,Dt))return;const n=ee(this,Dt);De(this,Dt,e),De(this,qu,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},FE=function(e){jn.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(ee(this,ar))}),ee(this,xr).getQueryCache().notify({query:ee(this,Dt),type:"observerResultsUpdated"})})},Z2);function UF(t,e){return ys(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function f1(t,e){return UF(t,e)||t.state.data!==void 0&&Bv(t,e,e.refetchOnMount)}function Bv(t,e,n){if(ys(e.enabled,t)!==!1){const s=typeof n=="function"?n(t):n;return s==="always"||s!==!1&&Vb(t,e)}return!1}function p1(t,e,n,s){return(t!==e||ys(s.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Vb(t,n)}function Vb(t,e){return ys(e.enabled,t)!==!1&&t.isStaleByTime(Gl(e.staleTime,t))}function qF(t,e){return!Cf(t.getCurrentResult(),e)}var gi,vi,gr,ka,Da,Pm,Lv,Q2,WF=(Q2=class extends Bc{constructor(n,s){super();Ye(this,Da);Ye(this,gi);Ye(this,vi);Ye(this,gr);Ye(this,ka);De(this,gi,n),this.setOptions(s),this.bindMethods(),jt(this,Da,Pm).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var a;const s=this.options;this.options=ee(this,gi).defaultMutationOptions(n),Cf(this.options,s)||ee(this,gi).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ee(this,gr),observer:this}),s!=null&&s.mutationKey&&this.options.mutationKey&&Bo(s.mutationKey)!==Bo(this.options.mutationKey)?this.reset():((a=ee(this,gr))==null?void 0:a.state.status)==="pending"&&ee(this,gr).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=ee(this,gr))==null||n.removeObserver(this)}onMutationUpdate(n){jt(this,Da,Pm).call(this),jt(this,Da,Lv).call(this,n)}getCurrentResult(){return ee(this,vi)}reset(){var n;(n=ee(this,gr))==null||n.removeObserver(this),De(this,gr,void 0),jt(this,Da,Pm).call(this),jt(this,Da,Lv).call(this)}mutate(n,s){var a;return De(this,ka,s),(a=ee(this,gr))==null||a.removeObserver(this),De(this,gr,ee(this,gi).getMutationCache().build(ee(this,gi),this.options)),ee(this,gr).addObserver(this),ee(this,gr).execute(n)}},gi=new WeakMap,vi=new WeakMap,gr=new WeakMap,ka=new WeakMap,Da=new WeakSet,Pm=function(){var s;const n=((s=ee(this,gr))==null?void 0:s.state)??OE();De(this,vi,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Lv=function(n){jn.batch(()=>{var s,a,i,o,l,c,d,u;if(ee(this,ka)&&this.hasListeners()){const h=ee(this,vi).variables,m=ee(this,vi).context;(n==null?void 0:n.type)==="success"?((a=(s=ee(this,ka)).onSuccess)==null||a.call(s,n.data,h,m),(o=(i=ee(this,ka)).onSettled)==null||o.call(i,n.data,null,h,m)):(n==null?void 0:n.type)==="error"&&((c=(l=ee(this,ka)).onError)==null||c.call(l,n.error,h,m),(u=(d=ee(this,ka)).onSettled)==null||u.call(d,void 0,n.error,h,m))}this.listeners.forEach(h=>{h(ee(this,vi))})})},Q2),BE=f.createContext(void 0),On=t=>{const e=f.useContext(BE);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},HF=({client:t,children:e})=>(f.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),r.jsx(BE.Provider,{value:t,children:e})),LE=f.createContext(!1),VF=()=>f.useContext(LE);LE.Provider;function KF(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var GF=f.createContext(KF()),ZF=()=>f.useContext(GF);function $E(t,e){return typeof t=="function"?t(...e):!!t}function zE(){}var QF=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},YF=t=>{f.useEffect(()=>{t.clearReset()},[t])},JF=({result:t,errorResetBoundary:e,throwOnError:n,query:s})=>t.isError&&!e.isReset()&&!t.isFetching&&s&&$E(n,[t.error,s]),XF=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},eB=(t,e)=>t.isLoading&&t.isFetching&&!e,tB=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,x1=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function nB(t,e,n){var u,h,m,p,b;const s=On(),a=VF(),i=ZF(),o=s.defaultQueryOptions(t);(h=(u=s.getDefaultOptions().queries)==null?void 0:u._experimental_beforeQuery)==null||h.call(u,o),o._optimisticResults=a?"isRestoring":"optimistic",XF(o),QF(o,i),YF(i);const l=!s.getQueryCache().get(o.queryHash),[c]=f.useState(()=>new e(s,o)),d=c.getOptimisticResult(o);if(f.useSyncExternalStore(f.useCallback(x=>{const g=a?()=>{}:c.subscribe(jn.batchCalls(x));return c.updateResult(),g},[c,a]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),f.useEffect(()=>{c.setOptions(o,{listeners:!1})},[o,c]),tB(o,d))throw x1(o,c,i);if(JF({result:d,errorResetBoundary:i,throwOnError:o.throwOnError,query:s.getQueryCache().get(o.queryHash)}))throw d.error;if((p=(m=s.getDefaultOptions().queries)==null?void 0:m._experimental_afterQuery)==null||p.call(m,o,d),o.experimental_prefetchInRender&&!Fo&&eB(d,a)){const x=l?x1(o,c,i):(b=s.getQueryCache().get(o.queryHash))==null?void 0:b.promise;x==null||x.catch(zE).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}function Wr(t,e){return nB(t,zF)}function kr(t,e){const n=On(),[s]=f.useState(()=>new WF(n,t));f.useEffect(()=>{s.setOptions(t)},[s,t]);const a=f.useSyncExternalStore(f.useCallback(o=>s.subscribe(jn.batchCalls(o)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=f.useCallback((o,l)=>{s.mutate(o,l).catch(zE)},[s]);if(a.error&&$E(s.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function gu(){return gu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},gu.apply(this,arguments)}var wi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(wi||(wi={}));const g1="popstate";function rB(t){t===void 0&&(t={});function e(s,a){let{pathname:i,search:o,hash:l}=s.location;return $v("",{pathname:i,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(s,a){return typeof a=="string"?a:Af(a)}return aB(e,n,null,t)}function xn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function UE(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function sB(){return Math.random().toString(36).substr(2,8)}function v1(t,e){return{usr:t.state,key:t.key,idx:e}}function $v(t,e,n,s){return n===void 0&&(n=null),gu({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Lc(e):e,{state:n,key:e&&e.key||s||sB()})}function Af(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function Lc(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function aB(t,e,n,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:i=!1}=s,o=a.history,l=wi.Pop,c=null,d=u();d==null&&(d=0,o.replaceState(gu({},o.state,{idx:d}),""));function u(){return(o.state||{idx:null}).idx}function h(){l=wi.Pop;let g=u(),y=g==null?null:g-d;d=g,c&&c({action:l,location:x.location,delta:y})}function m(g,y){l=wi.Push;let v=$v(x.location,g,y);d=u()+1;let w=v1(v,d),j=x.createHref(v);try{o.pushState(w,"",j)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;a.location.assign(j)}i&&c&&c({action:l,location:x.location,delta:1})}function p(g,y){l=wi.Replace;let v=$v(x.location,g,y);d=u();let w=v1(v,d),j=x.createHref(v);o.replaceState(w,"",j),i&&c&&c({action:l,location:x.location,delta:0})}function b(g){let y=a.location.origin!=="null"?a.location.origin:a.location.href,v=typeof g=="string"?g:Af(g);return v=v.replace(/ $/,"%20"),xn(y,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,y)}let x={get action(){return l},get location(){return t(a,o)},listen(g){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(g1,h),c=g,()=>{a.removeEventListener(g1,h),c=null}},createHref(g){return e(a,g)},createURL:b,encodeLocation(g){let y=b(g);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:m,replace:p,go(g){return o.go(g)}};return x}var y1;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(y1||(y1={}));function iB(t,e,n){return n===void 0&&(n="/"),oB(t,e,n,!1)}function oB(t,e,n,s){let a=typeof e=="string"?Lc(e):e,i=Kb(a.pathname||"/",n);if(i==null)return null;let o=qE(t);lB(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=yB(i);l=gB(o[c],d,s)}return l}function qE(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let a=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(xn(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let d=Ri([s,c.relativePath]),u=n.concat(c);i.children&&i.children.length>0&&(xn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),qE(i.children,e,u,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:pB(d,i.index),routesMeta:u})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let c of WE(i.path))a(i,o,c)}),e}function WE(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return a?[i,""]:[i];let o=WE(s.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function lB(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:xB(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const cB=/^:[\w-]+$/,dB=3,uB=2,hB=1,mB=10,fB=-2,b1=t=>t==="*";function pB(t,e){let n=t.split("/"),s=n.length;return n.some(b1)&&(s+=fB),e&&(s+=uB),n.filter(a=>!b1(a)).reduce((a,i)=>a+(cB.test(i)?dB:i===""?hB:mB),s)}function xB(t,e){return t.length===e.length&&t.slice(0,-1).every((s,a)=>s===e[a])?t[t.length-1]-e[e.length-1]:0}function gB(t,e,n){let{routesMeta:s}=t,a={},i="/",o=[];for(let l=0;l<s.length;++l){let c=s[l],d=l===s.length-1,u=i==="/"?e:e.slice(i.length)||"/",h=w1({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),m=c.route;if(!h&&d&&n&&!s[s.length-1].route.index&&(h=w1({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},u)),!h)return null;Object.assign(a,h.params),o.push({params:a,pathname:Ri([i,h.pathname]),pathnameBase:_B(Ri([i,h.pathnameBase])),route:m}),h.pathnameBase!=="/"&&(i=Ri([i,h.pathnameBase]))}return o}function w1(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=vB(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:s.reduce((d,u,h)=>{let{paramName:m,isOptional:p}=u;if(m==="*"){let x=l[h]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const b=l[h];return p&&!b?d[m]=void 0:d[m]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function vB(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),UE(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),s]}function yB(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return UE(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Kb(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function bB(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:a=""}=typeof t=="string"?Lc(t):t;return{pathname:n?n.startsWith("/")?n:wB(n,e):e,search:NB(s),hash:SB(a)}}function wB(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Xp(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function jB(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function HE(t,e){let n=jB(t);return e?n.map((s,a)=>a===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function VE(t,e,n,s){s===void 0&&(s=!1);let a;typeof t=="string"?a=Lc(t):(a=gu({},t),xn(!a.pathname||!a.pathname.includes("?"),Xp("?","pathname","search",a)),xn(!a.pathname||!a.pathname.includes("#"),Xp("#","pathname","hash",a)),xn(!a.search||!a.search.includes("#"),Xp("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=n;else{let h=e.length-1;if(!s&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),h-=1;a.pathname=m.join("/")}l=h>=0?e[h]:"/"}let c=bB(a,l),d=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const Ri=t=>t.join("/").replace(/\/\/+/g,"/"),_B=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),NB=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,SB=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function kB(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const KE=["post","put","patch","delete"];new Set(KE);const CB=["get",...KE];new Set(CB);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vu(){return vu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},vu.apply(this,arguments)}const Gb=f.createContext(null),EB=f.createContext(null),Zo=f.createContext(null),M0=f.createContext(null),Qo=f.createContext({outlet:null,matches:[],isDataRoute:!1}),GE=f.createContext(null);function AB(t,e){let{relative:n}=e===void 0?{}:e;sh()||xn(!1);let{basename:s,navigator:a}=f.useContext(Zo),{hash:i,pathname:o,search:l}=QE(t,{relative:n}),c=o;return s!=="/"&&(c=o==="/"?s:Ri([s,o])),a.createHref({pathname:c,search:l,hash:i})}function sh(){return f.useContext(M0)!=null}function $c(){return sh()||xn(!1),f.useContext(M0).location}function ZE(t){f.useContext(Zo).static||f.useLayoutEffect(t)}function Yi(){let{isDataRoute:t}=f.useContext(Qo);return t?UB():DB()}function DB(){sh()||xn(!1);let t=f.useContext(Gb),{basename:e,future:n,navigator:s}=f.useContext(Zo),{matches:a}=f.useContext(Qo),{pathname:i}=$c(),o=JSON.stringify(HE(a,n.v7_relativeSplatPath)),l=f.useRef(!1);return ZE(()=>{l.current=!0}),f.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){s.go(d);return}let h=VE(d,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ri([e,h.pathname])),(u.replace?s.replace:s.push)(h,u.state,u)},[e,s,o,i,t])}function QE(t,e){let{relative:n}=e===void 0?{}:e,{future:s}=f.useContext(Zo),{matches:a}=f.useContext(Qo),{pathname:i}=$c(),o=JSON.stringify(HE(a,s.v7_relativeSplatPath));return f.useMemo(()=>VE(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function PB(t,e){return TB(t,e)}function TB(t,e,n,s){sh()||xn(!1);let{navigator:a}=f.useContext(Zo),{matches:i}=f.useContext(Qo),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=$c(),u;if(e){var h;let g=typeof e=="string"?Lc(e):e;c==="/"||(h=g.pathname)!=null&&h.startsWith(c)||xn(!1),u=g}else u=d;let m=u.pathname||"/",p=m;if(c!=="/"){let g=c.replace(/^\//,"").split("/");p="/"+m.replace(/^\//,"").split("/").slice(g.length).join("/")}let b=iB(t,{pathname:p}),x=FB(b&&b.map(g=>Object.assign({},g,{params:Object.assign({},l,g.params),pathname:Ri([c,a.encodeLocation?a.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?c:Ri([c,a.encodeLocation?a.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,n,s);return e&&x?f.createElement(M0.Provider,{value:{location:vu({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:wi.Pop}},x):x}function RB(){let t=zB(),e=kB(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return f.createElement(f.Fragment,null,f.createElement("h2",null,"Unexpected Application Error!"),f.createElement("h3",{style:{fontStyle:"italic"}},e),n?f.createElement("pre",{style:a},n):null,null)}const MB=f.createElement(RB,null);class IB extends f.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?f.createElement(Qo.Provider,{value:this.props.routeContext},f.createElement(GE.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function OB(t){let{routeContext:e,match:n,children:s}=t,a=f.useContext(Gb);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),f.createElement(Qo.Provider,{value:e},s)}function FB(t,e,n,s){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(a=n)==null?void 0:a.errors;if(l!=null){let u=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);u>=0||xn(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,d=-1;if(n&&s&&s.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=u),h.route.id){let{loaderData:m,errors:p}=n,b=h.route.loader&&m[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||b){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((u,h,m)=>{let p,b=!1,x=null,g=null;n&&(p=l&&h.route.id?l[h.route.id]:void 0,x=h.route.errorElement||MB,c&&(d<0&&m===0?(b=!0,g=null):d===m&&(b=!0,g=h.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,m+1)),v=()=>{let w;return p?w=x:b?w=g:h.route.Component?w=f.createElement(h.route.Component,null):h.route.element?w=h.route.element:w=u,f.createElement(OB,{match:h,routeContext:{outlet:u,matches:y,isDataRoute:n!=null},children:w})};return n&&(h.route.ErrorBoundary||h.route.errorElement||m===0)?f.createElement(IB,{location:n.location,revalidation:n.revalidation,component:x,error:p,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}var YE=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(YE||{}),Df=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Df||{});function BB(t){let e=f.useContext(Gb);return e||xn(!1),e}function LB(t){let e=f.useContext(EB);return e||xn(!1),e}function $B(t){let e=f.useContext(Qo);return e||xn(!1),e}function JE(t){let e=$B(),n=e.matches[e.matches.length-1];return n.route.id||xn(!1),n.route.id}function zB(){var t;let e=f.useContext(GE),n=LB(Df.UseRouteError),s=JE(Df.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function UB(){let{router:t}=BB(YE.UseNavigateStable),e=JE(Df.UseNavigateStable),n=f.useRef(!1);return ZE(()=>{n.current=!0}),f.useCallback(function(a,i){i===void 0&&(i={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,vu({fromRouteId:e},i)))},[t,e])}function ds(t){xn(!1)}function qB(t){let{basename:e="/",children:n=null,location:s,navigationType:a=wi.Pop,navigator:i,static:o=!1,future:l}=t;sh()&&xn(!1);let c=e.replace(/^\/*/,"/"),d=f.useMemo(()=>({basename:c,navigator:i,static:o,future:vu({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof s=="string"&&(s=Lc(s));let{pathname:u="/",search:h="",hash:m="",state:p=null,key:b="default"}=s,x=f.useMemo(()=>{let g=Kb(u,c);return g==null?null:{location:{pathname:g,search:h,hash:m,state:p,key:b},navigationType:a}},[c,u,h,m,p,b,a]);return x==null?null:f.createElement(Zo.Provider,{value:d},f.createElement(M0.Provider,{children:n,value:x}))}function WB(t){let{children:e,location:n}=t;return PB(zv(e),n)}new Promise(()=>{});function zv(t,e){e===void 0&&(e=[]);let n=[];return f.Children.forEach(t,(s,a)=>{if(!f.isValidElement(s))return;let i=[...e,a];if(s.type===f.Fragment){n.push.apply(n,zv(s.props.children,i));return}s.type!==ds&&xn(!1),!s.props.index||!s.props.children||xn(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=zv(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Uv(){return Uv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Uv.apply(this,arguments)}function HB(t,e){if(t==null)return{};var n={},s=Object.keys(t),a,i;for(i=0;i<s.length;i++)a=s[i],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function VB(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function KB(t,e){return t.button===0&&(!e||e==="_self")&&!VB(t)}function qv(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(a=>[n,a]):[[n,s]])},[]))}function GB(t,e){let n=qv(t);return e&&e.forEach((s,a)=>{n.has(a)||e.getAll(a).forEach(i=>{n.append(a,i)})}),n}const ZB=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],QB="6";try{window.__reactRouterVersion=QB}catch{}const YB="startTransition",j1=cS[YB];function JB(t){let{basename:e,children:n,future:s,window:a}=t,i=f.useRef();i.current==null&&(i.current=rB({window:a,v5Compat:!0}));let o=i.current,[l,c]=f.useState({action:o.action,location:o.location}),{v7_startTransition:d}=s||{},u=f.useCallback(h=>{d&&j1?j1(()=>c(h)):c(h)},[c,d]);return f.useLayoutEffect(()=>o.listen(u),[o,u]),f.createElement(qB,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:s})}const XB=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",eL=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,si=f.forwardRef(function(e,n){let{onClick:s,relative:a,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:h}=e,m=HB(e,ZB),{basename:p}=f.useContext(Zo),b,x=!1;if(typeof d=="string"&&eL.test(d)&&(b=d,XB))try{let w=new URL(window.location.href),j=d.startsWith("//")?new URL(w.protocol+d):new URL(d),S=Kb(j.pathname,p);j.origin===w.origin&&S!=null?d=S+j.search+j.hash:x=!0}catch{}let g=AB(d,{relative:a}),y=tL(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:a,viewTransition:h});function v(w){s&&s(w),w.defaultPrevented||y(w)}return f.createElement("a",Uv({},m,{href:b||g,onClick:x||i?s:v,ref:n,target:c}))});var _1;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(_1||(_1={}));var N1;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(N1||(N1={}));function tL(t,e){let{target:n,replace:s,state:a,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=Yi(),d=$c(),u=QE(t,{relative:o});return f.useCallback(h=>{if(KB(h,n)){h.preventDefault();let m=s!==void 0?s:Af(d)===Af(u);c(t,{replace:m,state:a,preventScrollReset:i,relative:o,viewTransition:l})}},[d,c,u,s,a,n,t,i,o,l])}function Zb(t){let e=f.useRef(qv(t)),n=f.useRef(!1),s=$c(),a=f.useMemo(()=>GB(s.search,n.current?null:e.current),[s.search]),i=Yi(),o=f.useCallback((l,c)=>{const d=qv(typeof l=="function"?l(a):l);n.current=!0,i("?"+d,c)},[i,a]);return[a,o]}const nL="modulepreload",rL=function(t){return"/"+t},S1={},zc=function(e,n,s){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(n.map(c=>{if(c=rL(c),c in S1)return;S1[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":nL,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((m,p)=>{h.addEventListener("load",m),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})},sL=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>zc(async()=>{const{default:s}=await Promise.resolve().then(()=>Uc);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)};class Qb extends Error{constructor(e,n="FunctionsError",s){super(e),this.name=n,this.context=s}}class aL extends Qb{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class k1 extends Qb{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class C1 extends Qb{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Wv;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Wv||(Wv={}));var iL=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class oL{constructor(e,{headers:n={},customFetch:s,region:a=Wv.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=sL(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var s;return iL(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=n;let l={},{region:c}=n;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let u;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const h=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),a),body:u}).catch(x=>{throw new aL(x)}),m=h.headers.get("x-relay-error");if(m&&m==="true")throw new k1(h);if(!h.ok)throw new C1(h);let p=((s=h.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),b;return p==="application/json"?b=yield h.json():p==="application/octet-stream"?b=yield h.blob():p==="text/event-stream"?b=h:p==="multipart/form-data"?b=yield h.formData():b=yield h.text(),{data:b,error:null,response:h}}catch(a){return{data:null,error:a,response:a instanceof C1||a instanceof k1?a.context:void 0}}})}}var br={},Yb={},I0={},ah={},O0={},F0={},lL=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},bc=lL();const cL=bc.fetch,XE=bc.fetch.bind(bc),e4=bc.Headers,dL=bc.Request,uL=bc.Response,Uc=Object.freeze(Object.defineProperty({__proto__:null,Headers:e4,Request:dL,Response:uL,default:XE,fetch:cL},Symbol.toStringTag,{value:"Module"})),hL=J2(Uc);var B0={};Object.defineProperty(B0,"__esModule",{value:!0});let mL=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};B0.default=mL;var t4=et&&et.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(F0,"__esModule",{value:!0});const fL=t4(hL),pL=t4(B0);let xL=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=fL.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const s=this.fetch;let a=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c;let d=null,u=null,h=null,m=i.status,p=i.statusText;if(i.ok){if(this.method!=="HEAD"){const y=await i.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=y:u=JSON.parse(y))}const x=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),g=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");x&&g&&g.length>1&&(h=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(d={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,m=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const x=await i.text();try{d=JSON.parse(x),Array.isArray(d)&&i.status===404&&(u=[],d=null,m=200,p="OK")}catch{i.status===404&&x===""?(m=204,p="No Content"):d={message:x}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,m=200,p="OK"),d&&this.shouldThrowOnError)throw new pL.default(d)}return{error:d,data:u,count:h,status:m,statusText:p}});return this.shouldThrowOnError||(a=a.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,n)}returns(){return this}overrideTypes(){return this}};F0.default=xL;var gL=et&&et.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(O0,"__esModule",{value:!0});const vL=gL(F0);let yL=class extends vL.default{select(e){let n=!1;const s=(e??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:s,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${s===void 0?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:s=n}={}){const a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,n,{foreignTable:s,referencedTable:a=s}={}){const i=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:s=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,n?"verbose":null,s?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),d=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${d}"; options=${c};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};O0.default=yL;var bL=et&&et.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ah,"__esModule",{value:!0});const wL=bL(O0);let jL=class extends wL.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const s=Array.from(new Set(n)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:s,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(e,`${i}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,s])=>{this.url.searchParams.append(n,`eq.${s}`)}),this}not(e,n,s){return this.url.searchParams.append(e,`not.${n}.${s}`),this}or(e,{foreignTable:n,referencedTable:s=n}={}){const a=s?`${s}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,n,s){return this.url.searchParams.append(e,`${n}.${s}`),this}};ah.default=jL;var _L=et&&et.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(I0,"__esModule",{value:!0});const id=_L(ah);let NL=class{constructor(e,{headers:n={},schema:s,fetch:a}){this.url=e,this.headers=n,this.schema=s,this.fetch=a}select(e,{head:n=!1,count:s}={}){const a=n?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),s&&(this.headers.Prefer=`count=${s}`),new id.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:s=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),s||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new id.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:s=!1,count:a,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${s?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),a&&l.push(`count=${a}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const c=e.reduce((d,u)=>d.concat(Object.keys(u)),[]);if(c.length>0){const d=[...new Set(c)].map(u=>`"${u}"`);this.url.searchParams.set("columns",d.join(","))}}return new id.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const s="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),this.headers.Prefer=a.join(","),new id.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",s=[];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new id.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};I0.default=NL;var L0={},$0={};Object.defineProperty($0,"__esModule",{value:!0});$0.version=void 0;$0.version="0.0.0-automated";Object.defineProperty(L0,"__esModule",{value:!0});L0.DEFAULT_HEADERS=void 0;const SL=$0;L0.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${SL.version}`};var n4=et&&et.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Yb,"__esModule",{value:!0});const kL=n4(I0),CL=n4(ah),EL=L0;let AL=class r4{constructor(e,{headers:n={},schema:s,fetch:a}={}){this.url=e,this.headers=Object.assign(Object.assign({},EL.DEFAULT_HEADERS),n),this.schemaName=s,this.fetch=a}from(e){const n=new URL(`${this.url}/${e}`);return new kL.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new r4(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:s=!1,get:a=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let c;s||a?(o=s?"HEAD":"GET",Object.entries(n).filter(([u,h])=>h!==void 0).map(([u,h])=>[u,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([u,h])=>{l.searchParams.append(u,h)})):(o="POST",c=n);const d=Object.assign({},this.headers);return i&&(d.Prefer=`count=${i}`),new CL.default({method:o,url:l,headers:d,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};Yb.default=AL;var qc=et&&et.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(br,"__esModule",{value:!0});br.PostgrestError=br.PostgrestBuilder=br.PostgrestTransformBuilder=br.PostgrestFilterBuilder=br.PostgrestQueryBuilder=br.PostgrestClient=void 0;const s4=qc(Yb);br.PostgrestClient=s4.default;const a4=qc(I0);br.PostgrestQueryBuilder=a4.default;const i4=qc(ah);br.PostgrestFilterBuilder=i4.default;const o4=qc(O0);br.PostgrestTransformBuilder=o4.default;const l4=qc(F0);br.PostgrestBuilder=l4.default;const c4=qc(B0);br.PostgrestError=c4.default;var DL=br.default={PostgrestClient:s4.default,PostgrestQueryBuilder:a4.default,PostgrestFilterBuilder:i4.default,PostgrestTransformBuilder:o4.default,PostgrestBuilder:l4.default,PostgrestError:c4.default};const{PostgrestClient:PL,PostgrestQueryBuilder:vee,PostgrestFilterBuilder:yee,PostgrestTransformBuilder:bee,PostgrestBuilder:wee,PostgrestError:jee}=DL;function TL(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const RL=TL(),ML="2.11.15",IL=`realtime-js/${ML}`,OL="1.0.0",d4=1e4,FL=1e3;var Ud;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ud||(Ud={}));var Zn;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Zn||(Zn={}));var gs;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(gs||(gs={}));var Hv;(function(t){t.websocket="websocket"})(Hv||(Hv={}));var uo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(uo||(uo={}));class BL{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,n,s)}_decodeBroadcast(e,n,s){const a=n.getUint8(1),i=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(e.slice(o,o+a));o=o+a;const c=s.decode(e.slice(o,o+i));o=o+i;const d=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class u4{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Gt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Gt||(Gt={}));const E1=(t,e,n={})=>{var s;const a=(s=n.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,o)=>(i[o]=LL(o,t,e,a),i),{})},LL=(t,e,n,s)=>{const a=e.find(l=>l.name===t),i=a==null?void 0:a.type,o=n[t];return i&&!s.includes(i)?h4(i,o):Vv(o)},h4=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return qL(e,n)}switch(t){case Gt.bool:return $L(e);case Gt.float4:case Gt.float8:case Gt.int2:case Gt.int4:case Gt.int8:case Gt.numeric:case Gt.oid:return zL(e);case Gt.json:case Gt.jsonb:return UL(e);case Gt.timestamp:return WL(e);case Gt.abstime:case Gt.date:case Gt.daterange:case Gt.int4range:case Gt.int8range:case Gt.money:case Gt.reltime:case Gt.text:case Gt.time:case Gt.timestamptz:case Gt.timetz:case Gt.tsrange:case Gt.tstzrange:return Vv(e);default:return Vv(e)}},Vv=t=>t,$L=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},zL=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},UL=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},qL=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,s=t[n];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>h4(e,l))}return t},WL=t=>typeof t=="string"?t.replace(" ","T"):t,m4=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class ex{constructor(e,n,s={},a=d4){this.channel=e,this.event=n,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var s;return this._hasReceived(e)&&n((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var A1;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(A1||(A1={}));class qd{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=qd.syncState(this.state,a,i,o),this.pendingDiffs.forEach(c=>{this.state=qd.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=qd.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,s,a){const i=this.cloneDeep(e),o=this.transformState(n),l={},c={};return this.map(i,(d,u)=>{o[d]||(c[d]=u)}),this.map(o,(d,u)=>{const h=i[d];if(h){const m=u.map(g=>g.presence_ref),p=h.map(g=>g.presence_ref),b=u.filter(g=>p.indexOf(g.presence_ref)<0),x=h.filter(g=>m.indexOf(g.presence_ref)<0);b.length>0&&(l[d]=b),x.length>0&&(c[d]=x)}else l[d]=u}),this.syncDiff(i,{joins:l,leaves:c},s,a)}static syncDiff(e,n,s,a){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(i,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(p=>p.presence_ref),m=u.filter(p=>h.indexOf(p.presence_ref)<0);e[l].unshift(...m)}s(l,u,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,a(l,d,c),d.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(s=>n(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,s)=>{const a=e[s];return"metas"in a?n[s]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[s]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var D1;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(D1||(D1={}));var P1;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(P1||(P1={}));var Na;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Na||(Na={}));class Jb{constructor(e,n={config:{}},s){this.topic=e,this.params=n,this.socket=s,this.bindings={},this.state=Zn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new ex(this,gs.join,this.params,this.timeout),this.rejoinTimer=new u4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Zn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Zn.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Zn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Zn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(gs.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new qd(this),this.broadcastEndpointURL=m4(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Zn.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params;this._onError(u=>e==null?void 0:e(Na.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(Na.CLOSED));const c={},d={broadcast:i,presence:o,postgres_changes:(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&a!==void 0?a:[],private:l};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e==null||e(Na.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,p=(h=m==null?void 0:m.length)!==null&&h!==void 0?h:0,b=[];for(let x=0;x<p;x++){const g=m[x],{filter:{event:y,schema:v,table:w,filter:j}}=g,S=u&&u[x];if(S&&S.event===y&&S.schema===v&&S.table===w&&S.filter===j)b.push(Object.assign(Object.assign({},g),{id:S.id}));else{this.unsubscribe(),this.state=Zn.errored,e==null||e(Na.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,e&&e(Na.SUBSCRIBED);return}}).receive("error",u=>{this.state=Zn.errored,e==null||e(Na.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(Na.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,s){return this._on(e,n,s)}async send(e,n={}){var s,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const d=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Zn.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(gs.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new ex(this,gs.leave,{},e),s.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,s){const a=new AbortController,i=setTimeout(()=>a.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(i),o}_push(e,n,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new ex(this,e,n,s);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,n,s){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,s){var a,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=gs;if(s&&[l,c,d,u].indexOf(o)>=0&&s!==this._joinRef())return;let m=this._onMessage(o,n,s);if(n&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(p=>{var b,x,g;return((b=p.filter)===null||b===void 0?void 0:b.event)==="*"||((g=(x=p.filter)===null||x===void 0?void 0:x.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(p=>p.callback(m,s)):(i=this.bindings[o])===null||i===void 0||i.filter(p=>{var b,x,g,y,v,w;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const j=p.id,S=(b=p.filter)===null||b===void 0?void 0:b.event;return j&&((x=n.ids)===null||x===void 0?void 0:x.includes(j))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((g=n.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const j=(v=(y=p==null?void 0:p.filter)===null||y===void 0?void 0:y.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return j==="*"||j===((w=n==null?void 0:n.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof m=="object"&&"ids"in m){const b=m.data,{schema:x,table:g,commit_timestamp:y,type:v,errors:w}=b;m=Object.assign(Object.assign({},{schema:x,table:g,commit_timestamp:y,eventType:v,new:{},old:{},errors:w}),this._getPayloadRecords(b))}p.callback(m,s)})}_isClosed(){return this.state===Zn.closed}_isJoined(){return this.state===Zn.joined}_isJoining(){return this.state===Zn.joining}_isLeaving(){return this.state===Zn.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,s){const a=e.toLocaleLowerCase(),i={type:a,filter:n,callback:s};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,n){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Jb.isEqual(a.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const s in e)if(e[s]!==n[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(gs.close,{},e)}_onError(e){this._on(gs.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Zn.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=E1(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=E1(e.columns,e.old_record)),n}}const T1=()=>{},HL=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class VL{constructor(e,n){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=d4,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=T1,this.ref=0,this.logger=T1,this.conn=null,this.sendBuffer=[],this.serializer=new BL,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...l)=>zc(async()=>{const{default:c}=await Promise.resolve().then(()=>Uc);return{default:c}},void 0).then(({default:c})=>c(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${Hv.websocket}`,this.httpEndpoint=m4(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(s=n==null?void 0:n.params)===null||s===void 0?void 0:s.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(i,o)=>o(JSON.stringify(i)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new u4(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=RL),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:OL}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(s=>s.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,s){this.logger(e,n,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Ud.connecting:return uo.Connecting;case Ud.open:return uo.Open;case Ud.closing:return uo.Closing;default:return uo.Closed}}isConnected(){return this.connectionState()===uo.Open}channel(e,n={config:{}}){const s=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===s);if(a)return a;{const i=new Jb(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:s,payload:a,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${s} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const a={access_token:n,version:IL};n&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(gs.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(FL,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:s,event:a,payload:i,ref:o}=n;s==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${a} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(l=>l._isMember(s)).forEach(l=>l._trigger(a,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(gs.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const s=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${s}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const s=new Blob([HL],{type:"application/javascript"});n=URL.createObjectURL(s)}return n}}class Xb extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Dn(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class KL extends Xb{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Kv extends Xb{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var GL=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const f4=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>zc(async()=>{const{default:s}=await Promise.resolve().then(()=>Uc);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},ZL=()=>GL(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield zc(()=>Promise.resolve().then(()=>Uc),void 0)).Response:Response}),Gv=t=>{if(Array.isArray(t))return t.map(n=>Gv(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,s])=>{const a=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=Gv(s)}),e};var Yo=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const tx=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),QL=(t,e,n)=>Yo(void 0,void 0,void 0,function*(){const s=yield ZL();t instanceof s&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{e(new KL(tx(a),t.status||500))}).catch(a=>{e(new Kv(tx(a),a))}):e(new Kv(tx(t),t))}),YL=(t,e,n,s)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(a.body=JSON.stringify(s)),Object.assign(Object.assign({},a),n))};function ih(t,e,n,s,a,i){return Yo(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(n,YL(e,s,a,i)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>QL(c,l,s))})})}function Pf(t,e,n,s){return Yo(this,void 0,void 0,function*(){return ih(t,"GET",e,n,s)})}function ai(t,e,n,s,a){return Yo(this,void 0,void 0,function*(){return ih(t,"POST",e,s,a,n)})}function JL(t,e,n,s,a){return Yo(this,void 0,void 0,function*(){return ih(t,"PUT",e,s,a,n)})}function XL(t,e,n,s){return Yo(this,void 0,void 0,function*(){return ih(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),s)})}function p4(t,e,n,s,a){return Yo(this,void 0,void 0,function*(){return ih(t,"DELETE",e,s,a,n)})}var fr=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const e$={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},R1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class t${constructor(e,n={},s,a){this.url=e,this.headers=n,this.bucketId=s,this.fetch=f4(a)}uploadOrUpdate(e,n,s,a){return fr(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},R1),a);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(l=Object.assign(Object.assign({},l),a.headers));const d=this._removeEmptyFolders(n),u=this._getFinalPath(d),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),m=yield h.json();return h.ok?{data:{path:d,id:m.Id,fullPath:m.Key},error:null}:{data:null,error:m}}catch(i){if(Dn(i))return{data:null,error:i};throw i}})}upload(e,n,s){return fr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,s)})}uploadToSignedUrl(e,n,s,a){return fr(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let c;const d=Object.assign({upsert:R1.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:c,headers:u}),m=yield h.json();return h.ok?{data:{path:i,fullPath:m.Key},error:null}:{data:null,error:m}}catch(c){if(Dn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,n){return fr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const i=yield ai(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:a}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new Xb("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(s){if(Dn(s))return{data:null,error:s};throw s}})}update(e,n,s){return fr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,s)})}move(e,n,s){return fr(this,void 0,void 0,function*(){try{return{data:yield ai(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Dn(a))return{data:null,error:a};throw a}})}copy(e,n,s){return fr(this,void 0,void 0,function*(){try{return{data:{path:(yield ai(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Dn(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,s){return fr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield ai(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(Dn(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,s){return fr(this,void 0,void 0,function*(){try{const a=yield ai(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(Dn(a))return{data:null,error:a};throw a}})}download(e,n){return fr(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Pf(this.fetch,`${this.url}/${a}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Dn(l))return{data:null,error:l};throw l}})}info(e){return fr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const s=yield Pf(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Gv(s),error:null}}catch(s){if(Dn(s))return{data:null,error:s};throw s}})}exists(e){return fr(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield XL(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(Dn(s)&&s instanceof Kv){const a=s.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,n){const s=this._getFinalPath(e),a=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&a.push(i);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&a.push(c);let d=a.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return fr(this,void 0,void 0,function*(){try{return{data:yield p4(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(Dn(n))return{data:null,error:n};throw n}})}list(e,n,s){return fr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},e$),n),{prefix:e||""});return{data:yield ai(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){if(Dn(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const n$="2.7.1",r$={"X-Client-Info":`storage-js/${n$}`};var al=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class s${constructor(e,n={},s){this.url=e,this.headers=Object.assign(Object.assign({},r$),n),this.fetch=f4(s)}listBuckets(){return al(this,void 0,void 0,function*(){try{return{data:yield Pf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Dn(e))return{data:null,error:e};throw e}})}getBucket(e){return al(this,void 0,void 0,function*(){try{return{data:yield Pf(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(Dn(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return al(this,void 0,void 0,function*(){try{return{data:yield ai(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Dn(s))return{data:null,error:s};throw s}})}updateBucket(e,n){return al(this,void 0,void 0,function*(){try{return{data:yield JL(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(Dn(s))return{data:null,error:s};throw s}})}emptyBucket(e){return al(this,void 0,void 0,function*(){try{return{data:yield ai(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(Dn(n))return{data:null,error:n};throw n}})}deleteBucket(e){return al(this,void 0,void 0,function*(){try{return{data:yield p4(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(Dn(n))return{data:null,error:n};throw n}})}}class a$ extends s${constructor(e,n={},s){super(e,n,s)}from(e){return new t$(this.url,this.headers,e,this.fetch)}}const i$="2.50.3";let fd="";typeof Deno<"u"?fd="deno":typeof document<"u"?fd="web":typeof navigator<"u"&&navigator.product==="ReactNative"?fd="react-native":fd="node";const o$={"X-Client-Info":`supabase-js-${fd}/${i$}`},l$={headers:o$},c$={schema:"public"},d$={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},u$={};var h$=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};const m$=t=>{let e;return t?e=t:typeof fetch>"u"?e=XE:e=fetch,(...n)=>e(...n)},f$=()=>typeof Headers>"u"?e4:Headers,p$=(t,e,n)=>{const s=m$(n),a=f$();return(i,o)=>h$(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let d=new a(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(i,Object.assign(Object.assign({},o),{headers:d}))})};var x$=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};function g$(t){return t.endsWith("/")?t:t+"/"}function v$(t,e){var n,s;const{db:a,auth:i,realtime:o,global:l}=t,{db:c,auth:d,realtime:u,global:h}=e,m={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},u),o),global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:()=>x$(this,void 0,void 0,function*(){return""})};return t.accessToken?m.accessToken=t.accessToken:delete m.accessToken,m}const x4="2.70.0",gl=30*1e3,Zv=3,nx=Zv*gl,y$="http://localhost:9999",b$="supabase.auth.token",w$={"X-Client-Info":`gotrue-js/${x4}`},Qv="X-Supabase-Api-Version",g4={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},j$=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,_$=6e5;class ew extends Error{constructor(e,n,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=s}}function xt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class N$ extends ew{constructor(e,n,s){super(e,n,s),this.name="AuthApiError",this.status=n,this.code=s}}function S$(t){return xt(t)&&t.name==="AuthApiError"}class v4 extends ew{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Ji extends ew{constructor(e,n,s,a){super(e,s,a),this.name=n,this.status=s}}class Ja extends Ji{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function k$(t){return xt(t)&&t.name==="AuthSessionMissingError"}class Zh extends Ji{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Qh extends Ji{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Yh extends Ji{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function C$(t){return xt(t)&&t.name==="AuthImplicitGrantRedirectError"}class M1 extends Ji{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Yv extends Ji{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function rx(t){return xt(t)&&t.name==="AuthRetryableFetchError"}class I1 extends Ji{constructor(e,n,s){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=s}}class Wd extends Ji{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Tf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),O1=` 	
\r=`.split(""),E$=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<O1.length;e+=1)t[O1[e].charCodeAt(0)]=-2;for(let e=0;e<Tf.length;e+=1)t[Tf[e].charCodeAt(0)]=e;return t})();function F1(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Tf[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;n(Tf[s]),e.queuedBits-=6}}function y4(t,e,n){const s=E$[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function B1(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{P$(o,s,n)};for(let o=0;o<t.length;o+=1)y4(t.charCodeAt(o),a,i);return e.join("")}function A$(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function D$(t,e){for(let n=0;n<t.length;n+=1){let s=t.charCodeAt(n);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}A$(s,e)}}function P$(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function T$(t){const e=[],n={queue:0,queuedBits:0},s=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)y4(t.charCodeAt(a),n,s);return new Uint8Array(e)}function R$(t){const e=[];return D$(t,n=>e.push(n)),new Uint8Array(e)}function M$(t){const e=[],n={queue:0,queuedBits:0},s=a=>{e.push(a)};return t.forEach(a=>F1(a,n,s)),F1(null,n,s),e.join("")}function I$(t){return Math.round(Date.now()/1e3)+t}function O$(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const us=()=>typeof window<"u"&&typeof document<"u",ro={tested:!1,writable:!1},Hd=()=>{if(!us())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ro.tested)return ro.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ro.tested=!0,ro.writable=!0}catch{ro.tested=!0,ro.writable=!1}return ro.writable};function F$(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return n.searchParams.forEach((s,a)=>{e[a]=s}),e}const b4=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>zc(async()=>{const{default:s}=await Promise.resolve().then(()=>Uc);return{default:s}},void 0).then(({default:s})=>s(...n)):e=fetch,(...n)=>e(...n)},B$=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",w4=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Jh=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Xh=async(t,e)=>{await t.removeItem(e)};class z0{constructor(){this.promise=new z0.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}z0.promiseConstructor=Promise;function sx(t){const e=t.split(".");if(e.length!==3)throw new Wd("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!j$.test(e[s]))throw new Wd("JWT not in base64url format");return{header:JSON.parse(B1(e[0])),payload:JSON.parse(B1(e[1])),signature:T$(e[2]),raw:{header:e[0],payload:e[1]}}}async function L$(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function $$(t,e){return new Promise((s,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function z$(t){return("0"+t.toString(16)).substr(-2)}function U$(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=n.length;let a="";for(let i=0;i<56;i++)a+=n.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(e),Array.from(e,z$).join("")}async function q$(t){const n=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(s);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function W$(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await q$(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function il(t,e,n=!1){const s=U$();let a=s;n&&(a+="/PASSWORD_RECOVERY"),await w4(t,`${e}-code-verifier`,a);const i=await W$(s);return[i,s===i?"plain":"s256"]}const H$=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function V$(t){const e=t.headers.get(Qv);if(!e||!e.match(H$))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function K$(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function G$(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Z$=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ol(t){if(!Z$.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Q$=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n};const oo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Y$=[502,503,504];async function L1(t){var e;if(!B$(t))throw new Yv(oo(t),0);if(Y$.includes(t.status))throw new Yv(oo(t),t.status);let n;try{n=await t.json()}catch(i){throw new v4(oo(i),i)}let s;const a=V$(t);if(a&&a.getTime()>=g4["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?s=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(s=n.error_code),s){if(s==="weak_password")throw new I1(oo(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Ja}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new I1(oo(n),t.status,n.weak_password.reasons);throw new N$(oo(n),t.status||500,s)}const J$=(t,e,n,s)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),n))};async function kt(t,e,n,s){var a;const i=Object.assign({},s==null?void 0:s.headers);i[Qv]||(i[Qv]=g4["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(a=s==null?void 0:s.query)!==null&&a!==void 0?a:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await X$(t,e,n+l,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function X$(t,e,n,s,a,i){const o=J$(e,s,a,i);let l;try{l=await t(n,Object.assign({},o))}catch(c){throw console.error(c),new Yv(oo(c),0)}if(l.ok||await L1(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await L1(c)}}function ba(t){var e;let n=null;r9(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=I$(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:s},error:null}}function $1(t){const e=ba(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,s)=>n&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function li(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function e9(t){return{data:t,error:null}}function t9(t){const{action_link:e,email_otp:n,hashed_token:s,redirect_to:a,verification_type:i}=t,o=Q$(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:s,redirect_to:a,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function n9(t){return t}function r9(t){return t.access_token&&t.refresh_token&&t.expires_in}const ax=["global","local","others"];var s9=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n};class a9{constructor({url:e="",headers:n={},fetch:s}){this.url=e,this.headers=n,this.fetch=b4(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=ax[0]){if(ax.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${ax.join(", ")}`);try{return await kt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(xt(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,n={}){try{return await kt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:li})}catch(s){if(xt(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:n}=e,s=s9(e,["options"]),a=Object.assign(Object.assign({},s),n);return"newEmail"in s&&(a.new_email=s==null?void 0:s.newEmail,delete a.newEmail),await kt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:t9,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(xt(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await kt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:li})}catch(n){if(xt(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,s,a,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await kt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&s!==void 0?s:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:n9});if(u.error)throw u.error;const h=await u.json(),m=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(b=>{const x=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(b.split(";")[1].split("=")[1]);d[`${g}Page`]=x}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(xt(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){ol(e);try{return await kt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:li})}catch(n){if(xt(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){ol(e);try{return await kt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:li})}catch(s){if(xt(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,n=!1){ol(e);try{return await kt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:li})}catch(s){if(xt(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){ol(e.userId);try{const{data:n,error:s}=await kt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:s}}catch(n){if(xt(n))return{data:null,error:n};throw n}}async _deleteFactor(e){ol(e.userId),ol(e.id);try{return{data:await kt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(xt(n))return{data:null,error:n};throw n}}}const i9={getItem:t=>Hd()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{Hd()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{Hd()&&globalThis.localStorage.removeItem(t)}};function z1(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function o9(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ll={debug:!!(globalThis&&Hd()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class j4 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class l9 extends j4{}async function c9(t,e,n){ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),ll.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw ll.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new l9(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(ll.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}o9();const d9={url:y$,storageKey:b$,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:w$,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function U1(t,e,n){return await n()}class yu{constructor(e){var n,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=yu.nextInstanceID,yu.nextInstanceID+=1,this.instanceID>0&&us()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},d9),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new a9({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=b4(a.fetch),this.lock=a.lock||U1,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:us()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=c9:this.lock=U1,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:Hd()?this.storage=i9:(this.memoryStorage={},this.storage=z1(this.memoryStorage)):(this.memoryStorage={},this.storage=z1(this.memoryStorage)),us()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${x4}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=F$(window.location.href);let s="none";if(this._isImplicitGrantCallback(n)?s="implicit":await this._isPKCECallback(n)&&(s="pkce"),us()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:i}=await this._getSessionFromURL(n,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),C$(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return xt(n)?{error:n}:{error:new v4("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,s,a;try{const i=await kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:ba}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(xt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,s,a;try{let i;if("email"in e){const{email:u,password:h,options:m}=e;let p=null,b=null;this.flowType==="pkce"&&([p,b]=await il(this.storage,this.storageKey)),i=await kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m==null?void 0:m.emailRedirectTo,body:{email:u,password:h,data:(n=m==null?void 0:m.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken},code_challenge:p,code_challenge_method:b},xform:ba})}else if("phone"in e){const{phone:u,password:h,options:m}=e;i=await kt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=m==null?void 0:m.data)!==null&&s!==void 0?s:{},channel:(a=m==null?void 0:m.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:m==null?void 0:m.captchaToken}},xform:ba})}else throw new Qh("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(i){if(xt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:l}=e;n=await kt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:$1})}else if("phone"in e){const{phone:i,password:o,options:l}=e;n=await kt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:$1})}else throw new Qh("You must provide either an email or phone number and a password");const{data:s,error:a}=n;return a?{data:{user:null,session:null},error:a}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Zh}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(n){if(xt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,s,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,s,a,i,o,l,c,d,u,h,m,p;let b,x;if("message"in e)b=e.message,x=e.signature;else{const{chain:g,wallet:y,statement:v,options:w}=e;let j;if(us())if(typeof y=="object")j=y;else{const N=window;if("solana"in N&&typeof N.solana=="object"&&("signIn"in N.solana&&typeof N.solana.signIn=="function"||"signMessage"in N.solana&&typeof N.solana.signMessage=="function"))j=N.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=y}const S=new URL((n=w==null?void 0:w.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in j&&j.signIn){const N=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),v?{statement:v}:null));let k;if(Array.isArray(N)&&N[0]&&typeof N[0]=="object")k=N[0];else if(N&&typeof N=="object"&&"signedMessage"in N&&"signature"in N)k=N;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)b=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),x=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${S.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(a=(s=w==null?void 0:w.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((d=w==null?void 0:w.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((h=(u=w==null?void 0:w.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...w.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const N=await j.signMessage(new TextEncoder().encode(b),"utf8");if(!N||!(N instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=N}}try{const{data:g,error:y}=await kt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:M$(x)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:ba});if(y)throw y;return!g||!g.session||!g.user?{data:{user:null,session:null},error:new Zh}:(g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),{data:Object.assign({},g),error:y})}catch(g){if(xt(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const n=await Jh(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(n??"").split("/");try{const{data:i,error:o}=await kt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ba});if(await Xh(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Zh}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(xt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:s,token:a,access_token:i,nonce:o}=e,l=await kt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ba}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Zh}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(n){if(xt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,s,a,i,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await il(this.storage,this.storageKey));const{error:h}=await kt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await kt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u}}throw new Qh("You must provide either an email or phone number.")}catch(l){if(xt(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,s;try{let a,i;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await kt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:ba});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(a){if(xt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,s,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await il(this.storage,this.storageKey)),await kt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:e9})}catch(i){if(xt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:s}=e;if(s)throw s;if(!n)throw new Ja;const{error:a}=await kt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(xt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:s,type:a,options:i}=e,{error:o}=await kt(this.fetch,"POST",n,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:s,type:a,options:i}=e,{data:o,error:l}=await kt(this.fetch,"POST",n,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Qh("You must provide either an email or phone number and a type")}catch(n){if(xt(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=n();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Jh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<nx:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,u)=>(!o&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,u))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await kt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:li}):await this._useSession(async n=>{var s,a,i;const{data:o,error:l}=n;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ja}:await kt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:li})})}catch(n){if(xt(n))return k$(n)&&(await this._removeSession(),await Xh(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async s=>{const{data:a,error:i}=s;if(i)throw i;if(!a.session)throw new Ja;const o=a.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await il(this.storage,this.storageKey));const{data:d,error:u}=await kt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:li});if(u)throw u;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(s){if(xt(s))return{data:{user:null},error:s};throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ja;const n=Date.now()/1e3;let s=n,a=!0,i=null;const{payload:o}=sx(e.access_token);if(o.exp&&(s=o.exp,a=s<=n),a){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-n,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(xt(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var s;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Ja;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(xt(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!us())throw new Yh("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Yh(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new M1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Yh("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new M1("No code detected.");const{data:v,error:w}=await this._exchangeCodeForSession(e.code);if(w)throw w;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!i||!l||!o||!d)throw new Yh("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let m=u+h;c&&(m=parseInt(c));const p=m-u;p*1e3<=gl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const b=m-h;u-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,m,u):u-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,m,u);const{data:x,error:g}=await this._getUser(i);if(g)throw g;const y={provider_token:s,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:m,refresh_token:o,token_type:d,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(s){if(xt(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Jh(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var s;const{data:a,error:i}=n;if(i)return{error:i};const o=(s=a.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(S$(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Xh(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=O$(),s={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async n=>{var s,a;try{const{data:{session:i},error:o}=n;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await il(this.storage,this.storageKey,!0));try{return await kt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(xt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(xt(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:s,error:a}=await this._useSession(async i=>{var o,l,c,d,u;const{data:h,error:m}=i;if(m)throw m;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await kt(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return us()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(xt(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var s,a;const{data:i,error:o}=n;if(o)throw o;return await kt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(xt(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const s=Date.now();return await $$(async a=>(a>0&&await L$(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await kt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ba})),(a,i)=>{const o=200*Math.pow(2,a);return i&&rx(i)&&Date.now()+o-s<gl})}catch(s){if(this._debug(n,"error",s),xt(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",s),us()&&!n.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await Jh(this.storage,this.storageKey);if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((e=s.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<nx;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${nx}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),rx(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,s;if(!e)throw new Ja;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new z0;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Ja;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),xt(i)){const o={session:null,error:i};return rx(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,s=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await w4(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Xh(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&us()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),gl);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:s}}=n;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-e)/gl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${gl}ms, refresh threshold is ${Zv} ticks`),a<=Zv&&await this._callRefreshToken(s.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof j4)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!us()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,s){const a=[`provider=${encodeURIComponent(n)}`];if(s!=null&&s.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await il(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);a.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var s;const{data:a,error:i}=n;return i?{data:null,error:i}:await kt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(xt(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var s,a;const{data:i,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await kt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(n){if(xt(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:a,error:i}=n;if(i)return{data:null,error:i};const{data:o,error:l}=await kt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(xt(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var s;const{data:a,error:i}=n;return i?{data:null,error:i}:await kt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(n){if(xt(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const s=(e==null?void 0:e.factors)||[],a=s.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=s.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:s,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,s;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=sx(a.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((s=(n=a.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(c="aal2");const u=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,n={keys:[]}){let s=n.keys.find(o=>o.kid===e);if(s||(s=this.jwks.keys.find(o=>o.kid===e),s&&this.jwks_cached_at+_$>Date.now()))return s;const{data:a,error:i}=await kt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new Wd("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),s=a.keys.find(o=>o.kid===e),!s)throw new Wd("No matching signing key found in JWKS");return s}async getClaims(e,n={keys:[]}){try{let s=e;if(!s){const{data:p,error:b}=await this.getSession();if(b||!p.session)return{data:null,error:b};s=p.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:c}}=sx(s);if(K$(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:i,header:a,signature:o},error:null}}const d=G$(a.alg),u=await this.fetchJwk(a.kid,n),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,R$(`${l}.${c}`)))throw new Wd("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(s){if(xt(s))return{data:null,error:s};throw s}}}yu.nextInstanceID=0;const u9=yu;class h9 extends u9{constructor(e){super(e)}}var m9=function(t,e,n,s){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(u){try{d(s.next(u))}catch(h){o(h)}}function c(u){try{d(s.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})};class f9{constructor(e,n,s){var a,i,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=g$(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:c$,realtime:u$,auth:Object.assign(Object.assign({},d$),{storageKey:d}),global:l$},h=v$(s??{},u);this.storageKey=(a=h.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=p$(n,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new PL(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new oL(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new a$(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},s={}){return this.rest.rpc(e,n,s)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return m9(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(n=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:a,storageKey:i,flowType:o,lock:l,debug:c},d,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new h9({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:s,storage:a,flowType:o,lock:l,debug:c,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new VL(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,s)=>{this._handleTokenChanged(n,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,n,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const p9=(t,e,n)=>new f9(t,e,n),x9="https://qgwhkjrhndeoskrxewpb.supabase.co",g9="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFnd2hranJobmRlb3Nrcnhld3BiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1NTExODAsImV4cCI6MjA2NzEyNzE4MH0.eSPBRJKIBd9oiXqfo8vrbmMCl6QByxnVgHqtgofDGtg",$=p9(x9,g9,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{"X-Client-Info":"handwerkos-app"}}}),_4=f.createContext(void 0);function v9({children:t}){const[e,n]=f.useState(null),[s,a]=f.useState(null),[i,o]=f.useState(null),[l,c]=f.useState(null),[d,u]=f.useState(!0),h=i==="manager",m=h,p=async y=>{try{const{data:v,error:w}=await $.from("user_roles").select("role").eq("user_id",y).single();w?(console.warn("Role fetch error, default to employee:",w),o("employee")):o((v==null?void 0:v.role)??"employee");const{data:j,error:S}=await $.from("profiles").select("company_id").eq("id",y).single();S?(console.warn("Profile fetch error:",S),c(null)):c((j==null?void 0:j.company_id)??null)}catch(v){console.error("Error fetching user data:",v)}};f.useEffect(()=>{$.auth.getSession().then(({data:v})=>{var w,j;a(v.session),n(((w=v.session)==null?void 0:w.user)??null),(j=v.session)!=null&&j.user&&p(v.session.user.id),u(!1)});const{data:{subscription:y}}=$.auth.onAuthStateChange((v,w)=>{a(w),n((w==null?void 0:w.user)??null),w!=null&&w.user?p(w.user.id):(o(null),c(null)),u(!1)});return()=>y.unsubscribe()},[]);const b=async()=>{n(null),a(null),o(null),c(null),await $.auth.signOut()},x=async(y,v)=>{if(!e||!h||!l)return{success:!1,error:"Keine Berechtigung zum Einladen von Mitarbeitern"};try{console.log("Creating Supabase invitation for employee:",y);const w=crypto.randomUUID(),j=new Date;j.setDate(j.getDate()+7);const{error:S}=await $.from("employee_invitations").insert({email:y.toLowerCase(),invited_by:e.id,company_id:l,invite_token:w,expires_at:j.toISOString(),employee_data:v,status:"pending"});if(S)return console.error("Error creating invitation:",S),{success:!1,error:"Fehler beim Erstellen der Einladung"};const{error:N}=await $.from("employees").upsert({email:y.toLowerCase(),first_name:v.firstName,last_name:v.lastName,position:v.position,phone:v.phone,qualifications:Array.isArray(v.qualifications)?v.qualifications:[],license:v.license||"",company_id:l,status:"eingeladen"});if(N)return console.error("Error creating employee:",N),{success:!1,error:"Fehler beim Erstellen des Mitarbeiters"};const k=`${window.location.origin}/mitarbeiter-setup?token=${w}`,{data:E}=await $.from("profiles").select("email, first_name, last_name").eq("id",e.id).single(),{data:P}=await $.from("companies").select("name").eq("id",l).single();try{const{error:A}=await $.functions.invoke("send-welcome-email",{body:{employeeEmail:y,employeeName:`${v.firstName} ${v.lastName}`,loginUrl:k}});if(A)throw console.warn("Welcome email failed, trying fallback:",A),A;console.log("Professional welcome email sent successfully")}catch{const{error:C}=await $.functions.invoke("send-employee-confirmation",{body:{managerEmail:(E==null?void 0:E.email)||e.email,employeeName:`${v.firstName} ${v.lastName}`,employeeEmail:y,companyName:(P==null?void 0:P.name)||"Ihrem Unternehmen",registrationUrl:k}});C&&console.error("Email sending error:",C)}return{success:!0}}catch(w){return console.error("Invitation error:",w),{success:!1,error:w instanceof Error?w.message:"Unbekannter Fehler bei der Einladung"}}},g=async(y,v)=>{if(!h)return{success:!1,error:"Keine Berechtigung"};try{const{error:w}=await $.from("user_roles").upsert({user_id:y,role:v});if(w)throw w;return{success:!0}}catch(w){return{success:!1,error:w instanceof Error?w.message:"Rolle konnte nicht aktualisiert werden"}}};return r.jsx(_4.Provider,{value:{user:e,session:s,userRole:i,loading:d,isManager:h,canInviteMembers:m,companyId:l,signOut:b,inviteEmployee:x,updateMemberRole:g},children:t})}function za(){const t=f.useContext(_4);if(!t)throw new Error("useSupabaseAuth must be used within SupabaseAuthProvider");return t}const Jv=Ju("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),W=f.forwardRef(({className:t,variant:e,size:n,asChild:s=!1,...a},i)=>{const o=s?Ia:"button";return r.jsx(o,{className:_e(Jv({variant:e,size:n,className:t})),ref:i,...a})});W.displayName="Button";const y9=Ju("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ae({className:t,variant:e,...n}){return r.jsx("div",{className:_e(y9({variant:e}),t),...n})}const N4=f.createContext(void 0);function b9({children:t}){const[e,n]=f.useState(null),[s,a]=f.useState(null),[i,o]=f.useState(null),[l,c]=f.useState(!0),d=async b=>{const{data:x,error:g}=await $.from("user_roles").select("role").eq("user_id",b).single();g?(console.warn("Role fetch error, default to employee:",g),o("employee")):o((x==null?void 0:x.role)??"employee")};f.useEffect(()=>{$.auth.getSession().then(({data:x})=>{var g,y;a(x.session),n(((g=x.session)==null?void 0:g.user)??null),(y=x.session)!=null&&y.user&&d(x.session.user.id),c(!1)});const{data:{subscription:b}}=$.auth.onAuthStateChange((x,g)=>{console.log("Auth state changed:",x,g),a(g),n((g==null?void 0:g.user)??null),g!=null&&g.user?d(g.user.id):o(null)});return()=>{b.unsubscribe()}},[]);const u=(b,x)=>$.auth.signInWithPassword({email:b,password:x}),h=(b,x,g)=>{const y=`${window.location.origin}/auth?mode=employee-setup`;return $.auth.signUp({email:b,password:x,options:{emailRedirectTo:y,data:{first_name:g.firstName,last_name:g.lastName,company_name:g.companyName,phone:g.phone,street_address:g.streetAddress,postal_code:g.postalCode,city:g.city,country:g.country,vat_id:g.vatId,voucher_code:g.voucherCode,referral_source:g.referralSource}}})},m=b=>$.auth.updateUser({password:b}),p=async()=>{n(null),a(null),o(null),await $.auth.signOut()};return r.jsx(N4.Provider,{value:{user:e,session:s,userRole:i,loading:l,signIn:u,signUp:h,signOut:p,updatePassword:m},children:t})}function tw(){const t=f.useContext(N4);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}const w9=[{id:"dashboard",name:"Dashboard",icon:Bi,color:"text-blue-500"},{id:"stammdaten",name:"Stammdaten",icon:S8,color:"text-gray-500",children:[{id:"customers",name:"Kunden & Aufträge",icon:Oa,color:"text-green-500"},{id:"personal",name:"Personal",icon:th,color:"text-purple-500"}]},{id:"projects",name:"Projekte & Baustellen",icon:As,color:"text-orange-500"},{id:"timetracking",name:"Zeiterfassung",icon:Ht,color:"text-yellow-500"},{id:"vacation",name:"Urlaubsverwaltung",icon:O8,color:"text-sky-500"},{id:"emails",name:"E-Mails",icon:Tn,color:"text-pink-500"},{id:"documents",name:"Dokumente",icon:Sr,color:"text-emerald-500"},{id:"invoice-validation",name:"Rechnungs-Validierung",icon:mn,color:"text-amber-500"},{id:"materials",name:"Material",icon:Ds,color:"text-red-500"},{id:"machines",name:"Maschinen & Geräte",icon:Fi,color:"text-indigo-500"},{id:"finance",name:"Finanzen",icon:ws,color:"text-cyan-500"},{id:"planner",name:"Planer",icon:gt,color:"text-teal-500"},{id:"company-settings",name:"Firmeneinstellungen",icon:Fi,color:"text-gray-600"}];function j9({activeModule:t,onModuleChange:e}){const{signOut:n}=tw(),s=Yi(),[a,i]=f.useState(!1),[o,l]=f.useState(null),[c,d]=f.useState(["stammdaten"]),u=async()=>{try{await n(),s("/auth"),Ks({title:"Erfolgreich abgemeldet",description:"Sie wurden erfolgreich abgemeldet."})}catch{Ks({title:"Fehler beim Abmelden",description:"Es ist ein Fehler aufgetreten.",variant:"destructive"})}},h=a;f.useEffect(()=>{h||d([])},[h]);const m=p=>{d(b=>b.includes(p)?b.filter(x=>x!==p):[...b,p])};return r.jsxs("div",{className:`fixed left-0 top-0 h-full z-50 transition-all duration-500 ease-in-out ${h?"w-64":"w-16"} 
      bg-gradient-to-b from-blue-900 via-blue-800 to-blue-950 shadow-2xl`,onMouseEnter:()=>{o&&clearTimeout(o);const p=setTimeout(()=>i(!0),150);l(p)},onMouseLeave:()=>{o&&clearTimeout(o),i(!1),d([])},children:[r.jsx("div",{className:"p-4 border-b border-blue-600/30",children:r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"h-8 w-8 rounded-lg bg-white/20 backdrop-blur-sm flex items-center justify-center border border-white/30",children:r.jsx("span",{className:"text-white font-bold text-sm",children:"H"})}),r.jsx("span",{className:`font-bold text-white transition-all duration-300 ${h?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:"HandwerkOS"})]})}),r.jsxs("div",{className:"flex flex-col h-full",children:[r.jsx("div",{className:"flex-1 p-3",children:r.jsx("div",{className:"space-y-2",children:w9.map(p=>r.jsx("div",{children:p.children?r.jsxs("div",{children:[r.jsxs("button",{onClick:()=>m(p.id),className:`group w-full flex items-center p-3 rounded-lg transition-all duration-300 relative 
                      text-white/80 hover:text-white hover:bg-white/10 backdrop-blur-sm`,title:h?void 0:p.name,children:[r.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:r.jsx(p.icon,{className:`h-5 w-5 ${p.color} group-hover:scale-110 transition-transform duration-200`})}),r.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${h?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:p.name}),h&&r.jsx("div",{className:"ml-auto",children:c.includes(p.id)?r.jsx(S0,{className:"h-4 w-4 text-white/60 group-hover:text-white transition-colors duration-200"}):r.jsx(Co,{className:"h-4 w-4 text-white/60 group-hover:text-white transition-colors duration-200"})})]}),c.includes(p.id)&&h&&r.jsx("div",{className:"ml-6 mt-1 space-y-1",children:p.children.map(b=>r.jsxs("button",{onClick:()=>e(b.id),className:`group w-full flex items-center p-2.5 rounded-lg transition-all duration-200 text-sm ${t===b.id?"bg-white/20 text-white shadow-lg backdrop-blur-sm border border-white/30":"text-white/70 hover:text-white hover:bg-white/10"}`,children:[r.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:r.jsx(b.icon,{className:`h-4 w-4 ${b.color} group-hover:scale-110 transition-transform duration-200`})}),r.jsx("span",{className:"ml-2 whitespace-nowrap font-medium",children:b.name}),t===b.id&&r.jsx("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-white animate-pulse"})]},b.id))})]}):r.jsxs("button",{onClick:()=>e(p.id),className:`group w-full flex items-center p-3 rounded-lg transition-all duration-300 relative ${t===p.id?"bg-white/20 text-white shadow-lg backdrop-blur-sm border border-white/30":"text-white/80 hover:text-white hover:bg-white/10"}`,title:h?void 0:p.name,children:[r.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:r.jsx(p.icon,{className:`h-5 w-5 ${p.color} group-hover:scale-110 transition-transform duration-200`})}),r.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${h?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:p.name}),t===p.id&&r.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-white/50 rounded-l-full"})]})},p.id))})}),r.jsx("div",{className:"p-3 border-t border-blue-600/30",children:r.jsxs("button",{onClick:u,className:"group w-full flex items-center p-3 rounded-lg text-white/80 hover:text-white hover:bg-red-500/20 transition-all duration-300 relative",title:h?void 0:"Abmelden",children:[r.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:r.jsx(P8,{className:"h-5 w-5 group-hover:scale-110 transition-transform duration-200"})}),r.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${h?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:"Abmelden"})]})})]})]})}const J=f.forwardRef(({className:t,...e},n)=>r.jsx("div",{ref:n,className:_e("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));J.displayName="Card";const pe=f.forwardRef(({className:t,...e},n)=>r.jsx("div",{ref:n,className:_e("flex flex-col space-y-1.5 p-6",t),...e}));pe.displayName="CardHeader";const xe=f.forwardRef(({className:t,...e},n)=>r.jsx("h3",{ref:n,className:_e("text-2xl font-semibold leading-none tracking-tight",t),...e}));xe.displayName="CardTitle";const Jn=f.forwardRef(({className:t,...e},n)=>r.jsx("p",{ref:n,className:_e("text-sm text-muted-foreground",t),...e}));Jn.displayName="CardDescription";const te=f.forwardRef(({className:t,...e},n)=>r.jsx("div",{ref:n,className:_e("p-6 pt-0",t),...e}));te.displayName="CardContent";const _9=f.forwardRef(({className:t,...e},n)=>r.jsx("div",{ref:n,className:_e("flex items-center p-6 pt-0",t),...e}));_9.displayName="CardFooter";const G=f.forwardRef(({className:t,type:e,...n},s)=>r.jsx("input",{type:e,className:_e("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...n}));G.displayName="Input";var N9="Label",S4=f.forwardRef((t,e)=>r.jsx(Le.label,{...t,ref:e,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=t.onMouseDown)==null||a.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));S4.displayName=N9;var k4=S4;const S9=Ju("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),H=f.forwardRef(({className:t,...e},n)=>r.jsx(k4,{ref:n,className:_e(S9(),t),...e}));H.displayName=k4.displayName;function k9(t,e=[]){let n=[];function s(i,o){const l=f.createContext(o),c=n.length;n=[...n,o];function d(h){const{scope:m,children:p,...b}=h,x=(m==null?void 0:m[t][c])||l,g=f.useMemo(()=>b,Object.values(b));return r.jsx(x.Provider,{value:g,children:p})}function u(h,m){const p=(m==null?void 0:m[t][c])||l,b=f.useContext(p);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return d.displayName=i+"Provider",[d,u]}const a=()=>{const i=n.map(o=>f.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return f.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return a.scopeName=t,[s,C9(a,...e)]}function C9(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return f.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var E9=f.createContext(void 0);function Wc(t){const e=f.useContext(E9);return t||e||"ltr"}var ix="rovingFocusGroup.onEntryFocus",A9={bubbles:!1,cancelable:!0},U0="RovingFocusGroup",[Xv,C4,D9]=Qu(U0),[P9,q0]=k9(U0,[D9]),[T9,R9]=P9(U0),E4=f.forwardRef((t,e)=>r.jsx(Xv.Provider,{scope:t.__scopeRovingFocusGroup,children:r.jsx(Xv.Slot,{scope:t.__scopeRovingFocusGroup,children:r.jsx(M9,{...t,ref:e})})}));E4.displayName=U0;var M9=f.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:s,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...h}=t,m=f.useRef(null),p=yt(e,m),b=Wc(i),[x=null,g]=os({prop:o,defaultProp:l,onChange:c}),[y,v]=f.useState(!1),w=nn(d),j=C4(n),S=f.useRef(!1),[N,k]=f.useState(0);return f.useEffect(()=>{const E=m.current;if(E)return E.addEventListener(ix,w),()=>E.removeEventListener(ix,w)},[w]),r.jsx(T9,{scope:n,orientation:s,dir:b,loop:a,currentTabStopId:x,onItemFocus:f.useCallback(E=>g(E),[g]),onItemShiftTab:f.useCallback(()=>v(!0),[]),onFocusableItemAdd:f.useCallback(()=>k(E=>E+1),[]),onFocusableItemRemove:f.useCallback(()=>k(E=>E-1),[]),children:r.jsx(Le.div,{tabIndex:y||N===0?-1:0,"data-orientation":s,...h,ref:p,style:{outline:"none",...t.style},onMouseDown:be(t.onMouseDown,()=>{S.current=!0}),onFocus:be(t.onFocus,E=>{const P=!S.current;if(E.target===E.currentTarget&&P&&!y){const A=new CustomEvent(ix,A9);if(E.currentTarget.dispatchEvent(A),!A.defaultPrevented){const C=j().filter(se=>se.focusable),T=C.find(se=>se.active),I=C.find(se=>se.id===x),ne=[T,I,...C].filter(Boolean).map(se=>se.ref.current);P4(ne,u)}}S.current=!1}),onBlur:be(t.onBlur,()=>v(!1))})})}),A4="RovingFocusGroupItem",D4=f.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:a=!1,tabStopId:i,...o}=t,l=Lr(),c=i||l,d=R9(A4,n),u=d.currentTabStopId===c,h=C4(n),{onFocusableItemAdd:m,onFocusableItemRemove:p}=d;return f.useEffect(()=>{if(s)return m(),()=>p()},[s,m,p]),r.jsx(Xv.ItemSlot,{scope:n,id:c,focusable:s,active:a,children:r.jsx(Le.span,{tabIndex:u?0:-1,"data-orientation":d.orientation,...o,ref:e,onMouseDown:be(t.onMouseDown,b=>{s?d.onItemFocus(c):b.preventDefault()}),onFocus:be(t.onFocus,()=>d.onItemFocus(c)),onKeyDown:be(t.onKeyDown,b=>{if(b.key==="Tab"&&b.shiftKey){d.onItemShiftTab();return}if(b.target!==b.currentTarget)return;const x=F9(b,d.orientation,d.dir);if(x!==void 0){if(b.metaKey||b.ctrlKey||b.altKey||b.shiftKey)return;b.preventDefault();let y=h().filter(v=>v.focusable).map(v=>v.ref.current);if(x==="last")y.reverse();else if(x==="prev"||x==="next"){x==="prev"&&y.reverse();const v=y.indexOf(b.currentTarget);y=d.loop?B9(y,v+1):y.slice(v+1)}setTimeout(()=>P4(y))}})})})});D4.displayName=A4;var I9={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function O9(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function F9(t,e,n){const s=O9(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return I9[s]}function P4(t,e=!1){const n=document.activeElement;for(const s of t)if(s===n||(s.focus({preventScroll:e}),document.activeElement!==n))return}function B9(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var T4=E4,R4=D4,nw="Tabs",[L9,_ee]=Zr(nw,[q0]),M4=q0(),[$9,rw]=L9(nw),I4=f.forwardRef((t,e)=>{const{__scopeTabs:n,value:s,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...d}=t,u=Wc(l),[h,m]=os({prop:s,onChange:a,defaultProp:i});return r.jsx($9,{scope:n,baseId:Lr(),value:h,onValueChange:m,orientation:o,dir:u,activationMode:c,children:r.jsx(Le.div,{dir:u,"data-orientation":o,...d,ref:e})})});I4.displayName=nw;var O4="TabsList",F4=f.forwardRef((t,e)=>{const{__scopeTabs:n,loop:s=!0,...a}=t,i=rw(O4,n),o=M4(n);return r.jsx(T4,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:s,children:r.jsx(Le.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:e})})});F4.displayName=O4;var B4="TabsTrigger",L4=f.forwardRef((t,e)=>{const{__scopeTabs:n,value:s,disabled:a=!1,...i}=t,o=rw(B4,n),l=M4(n),c=U4(o.baseId,s),d=q4(o.baseId,s),u=s===o.value;return r.jsx(R4,{asChild:!0,...l,focusable:!a,active:u,children:r.jsx(Le.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...i,ref:e,onMouseDown:be(t.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?o.onValueChange(s):h.preventDefault()}),onKeyDown:be(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(s)}),onFocus:be(t.onFocus,()=>{const h=o.activationMode!=="manual";!u&&!a&&h&&o.onValueChange(s)})})})});L4.displayName=B4;var $4="TabsContent",z4=f.forwardRef((t,e)=>{const{__scopeTabs:n,value:s,forceMount:a,children:i,...o}=t,l=rw($4,n),c=U4(l.baseId,s),d=q4(l.baseId,s),u=s===l.value,h=f.useRef(u);return f.useEffect(()=>{const m=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(m)},[]),r.jsx(Sn,{present:a||u,children:({present:m})=>r.jsx(Le.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!m,id:d,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:h.current?"0s":void 0},children:m&&i})})});z4.displayName=$4;function U4(t,e){return`${t}-trigger-${e}`}function q4(t,e){return`${t}-content-${e}`}var z9=I4,W4=F4,H4=L4,V4=z4;const cr=z9,tr=f.forwardRef(({className:t,...e},n)=>r.jsx(W4,{ref:n,className:_e("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));tr.displayName=W4.displayName;const Oe=f.forwardRef(({className:t,...e},n)=>r.jsx(H4,{ref:n,className:_e("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));Oe.displayName=H4.displayName;const Fe=f.forwardRef(({className:t,...e},n)=>r.jsx(V4,{ref:n,className:_e("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Fe.displayName=V4.displayName;function Ke({className:t,...e}){return r.jsx("div",{className:_e("animate-pulse rounded-md bg-muted",t),...e})}var Rt;(function(t){t.assertEqual=a=>a;function e(a){}t.assertIs=e;function n(a){throw new Error}t.assertNever=n,t.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},t.getValidEnumValues=a=>{const i=t.objectKeys(a).filter(l=>typeof a[a[l]]!="number"),o={};for(const l of i)o[l]=a[l];return t.objectValues(o)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},t.find=(a,i)=>{for(const o of a)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function s(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Rt||(Rt={}));var ey;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(ey||(ey={}));const Te=Rt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ci=t=>{switch(typeof t){case"undefined":return Te.undefined;case"string":return Te.string;case"number":return isNaN(t)?Te.nan:Te.number;case"boolean":return Te.boolean;case"function":return Te.function;case"bigint":return Te.bigint;case"symbol":return Te.symbol;case"object":return Array.isArray(t)?Te.array:t===null?Te.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Te.promise:typeof Map<"u"&&t instanceof Map?Te.map:typeof Set<"u"&&t instanceof Set?Te.set:typeof Date<"u"&&t instanceof Date?Te.date:Te.object;default:return Te.unknown}},ye=Rt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),U9=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class zr extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},s={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)s._errors.push(n(o));else{let l=s,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(n(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return a(this),s}static assert(e){if(!(e instanceof zr))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Rt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},s=[];for(const a of this.issues)a.path.length>0?(n[a.path[0]]=n[a.path[0]]||[],n[a.path[0]].push(e(a))):s.push(e(a));return{formErrors:s,fieldErrors:n}}get formErrors(){return this.flatten()}}zr.create=t=>new zr(t);const wc=(t,e)=>{let n;switch(t.code){case ye.invalid_type:t.received===Te.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ye.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Rt.jsonStringifyReplacer)}`;break;case ye.unrecognized_keys:n=`Unrecognized key(s) in object: ${Rt.joinValues(t.keys,", ")}`;break;case ye.invalid_union:n="Invalid input";break;case ye.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Rt.joinValues(t.options)}`;break;case ye.invalid_enum_value:n=`Invalid enum value. Expected ${Rt.joinValues(t.options)}, received '${t.received}'`;break;case ye.invalid_arguments:n="Invalid function arguments";break;case ye.invalid_return_type:n="Invalid function return type";break;case ye.invalid_date:n="Invalid date";break;case ye.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Rt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ye.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ye.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ye.custom:n="Invalid input";break;case ye.invalid_intersection_types:n="Intersection results could not be merged";break;case ye.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ye.not_finite:n="Number must be finite";break;default:n=e.defaultError,Rt.assertNever(t)}return{message:n}};let K4=wc;function q9(t){K4=t}function Rf(){return K4}const Mf=t=>{const{data:e,path:n,errorMaps:s,issueData:a}=t,i=[...n,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let l="";const c=s.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:e,defaultError:l}).message;return{...a,path:i,message:l}},W9=[];function Ee(t,e){const n=Rf(),s=Mf({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===wc?void 0:wc].filter(a=>!!a)});t.common.issues.push(s)}class nr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const s=[];for(const a of n){if(a.status==="aborted")return dt;a.status==="dirty"&&e.dirty(),s.push(a.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,n){const s=[];for(const a of n){const i=await a.key,o=await a.value;s.push({key:i,value:o})}return nr.mergeObjectSync(e,s)}static mergeObjectSync(e,n){const s={};for(const a of n){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return dt;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(s[i.value]=o.value)}return{status:e.value,value:s}}}const dt=Object.freeze({status:"aborted"}),Ol=t=>({status:"dirty",value:t}),dr=t=>({status:"valid",value:t}),ty=t=>t.status==="aborted",ny=t=>t.status==="dirty",bu=t=>t.status==="valid",wu=t=>typeof Promise<"u"&&t instanceof Promise;function If(t,e,n,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function G4(t,e,n,s,a){if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var qe;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(qe||(qe={}));var pd,xd;class da{constructor(e,n,s,a){this._cachedPath=[],this.parent=e,this.data=n,this._path=s,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const q1=(t,e)=>{if(bu(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new zr(t.common.issues);return this._error=n,this._error}}};function vt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:s,description:a}=t;if(e&&(n||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(o,l)=>{var c,d;const{message:u}=t;return o.code==="invalid_enum_value"?{message:u??l.defaultError}:typeof l.data>"u"?{message:(c=u??s)!==null&&c!==void 0?c:l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:(d=u??n)!==null&&d!==void 0?d:l.defaultError}},description:a}}class _t{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ci(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:ci(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new nr,ctx:{common:e.parent.common,data:e.data,parsedType:ci(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(wu(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const s=this.safeParse(e,n);if(s.success)return s.data;throw s.error}safeParse(e,n){var s;const a={common:{issues:[],async:(s=n==null?void 0:n.async)!==null&&s!==void 0?s:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ci(e)},i=this._parseSync({data:e,path:a.path,parent:a});return q1(a,i)}async parseAsync(e,n){const s=await this.safeParseAsync(e,n);if(s.success)return s.data;throw s.error}async safeParseAsync(e,n){const s={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ci(e)},a=this._parse({data:e,path:s.path,parent:s}),i=await(wu(a)?a:Promise.resolve(a));return q1(s,i)}refine(e,n){const s=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,i)=>{const o=e(a),l=()=>i.addIssue({code:ye.custom,...s(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,n){return this._refinement((s,a)=>e(s)?!0:(a.addIssue(typeof n=="function"?n(s,a):n),!1))}_refinement(e){return new Ms({schema:this,typeName:st.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return sa.create(this,this._def)}nullable(){return Vi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ss.create(this,this._def)}promise(){return _c.create(this,this._def)}or(e){return Su.create([this,e],this._def)}and(e){return ku.create(this,e,this._def)}transform(e){return new Ms({...vt(this._def),schema:this,typeName:st.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Pu({...vt(this._def),innerType:this,defaultValue:n,typeName:st.ZodDefault})}brand(){return new sw({typeName:st.ZodBranded,type:this,...vt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Tu({...vt(this._def),innerType:this,catchValue:n,typeName:st.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return oh.create(this,e)}readonly(){return Ru.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const H9=/^c[^\s-]{8,}$/i,V9=/^[0-9a-z]+$/,K9=/^[0-9A-HJKMNP-TV-Z]{26}$/,G9=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Z9=/^[a-z0-9_-]{21}$/i,Q9=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Y9=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,J9="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ox;const X9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,e7=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,t7=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Z4="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",n7=new RegExp(`^${Z4}$`);function Q4(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function r7(t){return new RegExp(`^${Q4(t)}$`)}function Y4(t){let e=`${Z4}T${Q4(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function s7(t,e){return!!((e==="v4"||!e)&&X9.test(t)||(e==="v6"||!e)&&e7.test(t))}class js extends _t{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Te.string){const i=this._getOrReturnCtx(e);return Ee(i,{code:ye.invalid_type,expected:Te.string,received:i.parsedType}),dt}const s=new nr;let a;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),Ee(a,{code:ye.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),Ee(a,{code:ye.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,l=e.data.length<i.value;(o||l)&&(a=this._getOrReturnCtx(e,a),o?Ee(a,{code:ye.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&Ee(a,{code:ye.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")Y9.test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{validation:"email",code:ye.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")ox||(ox=new RegExp(J9,"u")),ox.test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{validation:"emoji",code:ye.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")G9.test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{validation:"uuid",code:ye.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")Z9.test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{validation:"nanoid",code:ye.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")H9.test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{validation:"cuid",code:ye.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")V9.test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{validation:"cuid2",code:ye.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")K9.test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{validation:"ulid",code:ye.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),Ee(a,{validation:"url",code:ye.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{validation:"regex",code:ye.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),Ee(a,{code:ye.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),Ee(a,{code:ye.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),Ee(a,{code:ye.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?Y4(i).test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{code:ye.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?n7.test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{code:ye.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?r7(i).test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{code:ye.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?Q9.test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{validation:"duration",code:ye.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?s7(e.data,i.version)||(a=this._getOrReturnCtx(e,a),Ee(a,{validation:"ip",code:ye.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?t7.test(e.data)||(a=this._getOrReturnCtx(e,a),Ee(a,{validation:"base64",code:ye.invalid_string,message:i.message}),s.dirty()):Rt.assertNever(i);return{status:s.value,value:e.data}}_regex(e,n,s){return this.refinement(a=>e.test(a),{validation:n,code:ye.invalid_string,...qe.errToObj(s)})}_addCheck(e){return new js({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...qe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...qe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...qe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...qe.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...qe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...qe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...qe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...qe.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...qe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...qe.errToObj(e)})}datetime(e){var n,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...qe.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...qe.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...qe.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...qe.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...qe.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...qe.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...qe.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...qe.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...qe.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...qe.errToObj(n)})}nonempty(e){return this.min(1,qe.errToObj(e))}trim(){return new js({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new js({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new js({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}js.create=t=>{var e;return new js({checks:[],typeName:st.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...vt(t)})};function a7(t,e){const n=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,a=n>s?n:s,i=parseInt(t.toFixed(a).replace(".","")),o=parseInt(e.toFixed(a).replace(".",""));return i%o/Math.pow(10,a)}class qi extends _t{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Te.number){const i=this._getOrReturnCtx(e);return Ee(i,{code:ye.invalid_type,expected:Te.number,received:i.parsedType}),dt}let s;const a=new nr;for(const i of this._def.checks)i.kind==="int"?Rt.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),Ee(s,{code:ye.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),Ee(s,{code:ye.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),Ee(s,{code:ye.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?a7(e.data,i.value)!==0&&(s=this._getOrReturnCtx(e,s),Ee(s,{code:ye.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),Ee(s,{code:ye.not_finite,message:i.message}),a.dirty()):Rt.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,qe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,qe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,qe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,qe.toString(n))}setLimit(e,n,s,a){return new qi({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:s,message:qe.toString(a)}]})}_addCheck(e){return new qi({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:qe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:qe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:qe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:qe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:qe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:qe.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:qe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:qe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:qe.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Rt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(n===null||s.value>n)&&(n=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(n)&&Number.isFinite(e)}}qi.create=t=>new qi({checks:[],typeName:st.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...vt(t)});class Wi extends _t{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==Te.bigint){const i=this._getOrReturnCtx(e);return Ee(i,{code:ye.invalid_type,expected:Te.bigint,received:i.parsedType}),dt}let s;const a=new nr;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),Ee(s,{code:ye.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),Ee(s,{code:ye.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),Ee(s,{code:ye.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Rt.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,qe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,qe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,qe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,qe.toString(n))}setLimit(e,n,s,a){return new Wi({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:s,message:qe.toString(a)}]})}_addCheck(e){return new Wi({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:qe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:qe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:qe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:qe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:qe.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Wi.create=t=>{var e;return new Wi({checks:[],typeName:st.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...vt(t)})};class ju extends _t{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Te.boolean){const s=this._getOrReturnCtx(e);return Ee(s,{code:ye.invalid_type,expected:Te.boolean,received:s.parsedType}),dt}return dr(e.data)}}ju.create=t=>new ju({typeName:st.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...vt(t)});class Lo extends _t{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Te.date){const i=this._getOrReturnCtx(e);return Ee(i,{code:ye.invalid_type,expected:Te.date,received:i.parsedType}),dt}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Ee(i,{code:ye.invalid_date}),dt}const s=new nr;let a;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(a=this._getOrReturnCtx(e,a),Ee(a,{code:ye.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(a=this._getOrReturnCtx(e,a),Ee(a,{code:ye.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):Rt.assertNever(i);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Lo({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:qe.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:qe.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Lo.create=t=>new Lo({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:st.ZodDate,...vt(t)});class Of extends _t{_parse(e){if(this._getType(e)!==Te.symbol){const s=this._getOrReturnCtx(e);return Ee(s,{code:ye.invalid_type,expected:Te.symbol,received:s.parsedType}),dt}return dr(e.data)}}Of.create=t=>new Of({typeName:st.ZodSymbol,...vt(t)});class _u extends _t{_parse(e){if(this._getType(e)!==Te.undefined){const s=this._getOrReturnCtx(e);return Ee(s,{code:ye.invalid_type,expected:Te.undefined,received:s.parsedType}),dt}return dr(e.data)}}_u.create=t=>new _u({typeName:st.ZodUndefined,...vt(t)});class Nu extends _t{_parse(e){if(this._getType(e)!==Te.null){const s=this._getOrReturnCtx(e);return Ee(s,{code:ye.invalid_type,expected:Te.null,received:s.parsedType}),dt}return dr(e.data)}}Nu.create=t=>new Nu({typeName:st.ZodNull,...vt(t)});class jc extends _t{constructor(){super(...arguments),this._any=!0}_parse(e){return dr(e.data)}}jc.create=t=>new jc({typeName:st.ZodAny,...vt(t)});class Ao extends _t{constructor(){super(...arguments),this._unknown=!0}_parse(e){return dr(e.data)}}Ao.create=t=>new Ao({typeName:st.ZodUnknown,...vt(t)});class La extends _t{_parse(e){const n=this._getOrReturnCtx(e);return Ee(n,{code:ye.invalid_type,expected:Te.never,received:n.parsedType}),dt}}La.create=t=>new La({typeName:st.ZodNever,...vt(t)});class Ff extends _t{_parse(e){if(this._getType(e)!==Te.undefined){const s=this._getOrReturnCtx(e);return Ee(s,{code:ye.invalid_type,expected:Te.void,received:s.parsedType}),dt}return dr(e.data)}}Ff.create=t=>new Ff({typeName:st.ZodVoid,...vt(t)});class Ss extends _t{_parse(e){const{ctx:n,status:s}=this._processInputParams(e),a=this._def;if(n.parsedType!==Te.array)return Ee(n,{code:ye.invalid_type,expected:Te.array,received:n.parsedType}),dt;if(a.exactLength!==null){const o=n.data.length>a.exactLength.value,l=n.data.length<a.exactLength.value;(o||l)&&(Ee(n,{code:o?ye.too_big:ye.too_small,minimum:l?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),s.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Ee(n,{code:ye.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),s.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Ee(n,{code:ye.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),s.dirty()),n.common.async)return Promise.all([...n.data].map((o,l)=>a.type._parseAsync(new da(n,o,n.path,l)))).then(o=>nr.mergeArray(s,o));const i=[...n.data].map((o,l)=>a.type._parseSync(new da(n,o,n.path,l)));return nr.mergeArray(s,i)}get element(){return this._def.type}min(e,n){return new Ss({...this._def,minLength:{value:e,message:qe.toString(n)}})}max(e,n){return new Ss({...this._def,maxLength:{value:e,message:qe.toString(n)}})}length(e,n){return new Ss({...this._def,exactLength:{value:e,message:qe.toString(n)}})}nonempty(e){return this.min(1,e)}}Ss.create=(t,e)=>new Ss({type:t,minLength:null,maxLength:null,exactLength:null,typeName:st.ZodArray,...vt(e)});function vl(t){if(t instanceof rn){const e={};for(const n in t.shape){const s=t.shape[n];e[n]=sa.create(vl(s))}return new rn({...t._def,shape:()=>e})}else return t instanceof Ss?new Ss({...t._def,type:vl(t.element)}):t instanceof sa?sa.create(vl(t.unwrap())):t instanceof Vi?Vi.create(vl(t.unwrap())):t instanceof ua?ua.create(t.items.map(e=>vl(e))):t}class rn extends _t{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Rt.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==Te.object){const d=this._getOrReturnCtx(e);return Ee(d,{code:ye.invalid_type,expected:Te.object,received:d.parsedType}),dt}const{status:s,ctx:a}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof La&&this._def.unknownKeys==="strip"))for(const d in a.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const u=i[d],h=a.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new da(a,h,a.path,d)),alwaysSet:d in a.data})}if(this._def.catchall instanceof La){const d=this._def.unknownKeys;if(d==="passthrough")for(const u of l)c.push({key:{status:"valid",value:u},value:{status:"valid",value:a.data[u]}});else if(d==="strict")l.length>0&&(Ee(a,{code:ye.unrecognized_keys,keys:l}),s.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const u of l){const h=a.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new da(a,h,a.path,u)),alwaysSet:u in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const d=[];for(const u of c){const h=await u.key,m=await u.value;d.push({key:h,value:m,alwaysSet:u.alwaysSet})}return d}).then(d=>nr.mergeObjectSync(s,d)):nr.mergeObjectSync(s,c)}get shape(){return this._def.shape()}strict(e){return qe.errToObj,new rn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,s)=>{var a,i,o,l;const c=(o=(i=(a=this._def).errorMap)===null||i===void 0?void 0:i.call(a,n,s).message)!==null&&o!==void 0?o:s.defaultError;return n.code==="unrecognized_keys"?{message:(l=qe.errToObj(e).message)!==null&&l!==void 0?l:c}:{message:c}}}:{}})}strip(){return new rn({...this._def,unknownKeys:"strip"})}passthrough(){return new rn({...this._def,unknownKeys:"passthrough"})}extend(e){return new rn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new rn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:st.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new rn({...this._def,catchall:e})}pick(e){const n={};return Rt.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(n[s]=this.shape[s])}),new rn({...this._def,shape:()=>n})}omit(e){const n={};return Rt.objectKeys(this.shape).forEach(s=>{e[s]||(n[s]=this.shape[s])}),new rn({...this._def,shape:()=>n})}deepPartial(){return vl(this)}partial(e){const n={};return Rt.objectKeys(this.shape).forEach(s=>{const a=this.shape[s];e&&!e[s]?n[s]=a:n[s]=a.optional()}),new rn({...this._def,shape:()=>n})}required(e){const n={};return Rt.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])n[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof sa;)i=i._def.innerType;n[s]=i}}),new rn({...this._def,shape:()=>n})}keyof(){return J4(Rt.objectKeys(this.shape))}}rn.create=(t,e)=>new rn({shape:()=>t,unknownKeys:"strip",catchall:La.create(),typeName:st.ZodObject,...vt(e)});rn.strictCreate=(t,e)=>new rn({shape:()=>t,unknownKeys:"strict",catchall:La.create(),typeName:st.ZodObject,...vt(e)});rn.lazycreate=(t,e)=>new rn({shape:t,unknownKeys:"strip",catchall:La.create(),typeName:st.ZodObject,...vt(e)});class Su extends _t{_parse(e){const{ctx:n}=this._processInputParams(e),s=this._def.options;function a(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return n.common.issues.push(...l.ctx.common.issues),l.result;const o=i.map(l=>new zr(l.ctx.common.issues));return Ee(n,{code:ye.invalid_union,unionErrors:o}),dt}if(n.common.async)return Promise.all(s.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const c of s){const d={...n,common:{...n.common,issues:[]},parent:null},u=c._parseSync({data:n.data,path:n.path,parent:d});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const l=o.map(c=>new zr(c));return Ee(n,{code:ye.invalid_union,unionErrors:l}),dt}}get options(){return this._def.options}}Su.create=(t,e)=>new Su({options:t,typeName:st.ZodUnion,...vt(e)});const wa=t=>t instanceof Eu?wa(t.schema):t instanceof Ms?wa(t.innerType()):t instanceof Au?[t.value]:t instanceof Hi?t.options:t instanceof Du?Rt.objectValues(t.enum):t instanceof Pu?wa(t._def.innerType):t instanceof _u?[void 0]:t instanceof Nu?[null]:t instanceof sa?[void 0,...wa(t.unwrap())]:t instanceof Vi?[null,...wa(t.unwrap())]:t instanceof sw||t instanceof Ru?wa(t.unwrap()):t instanceof Tu?wa(t._def.innerType):[];class W0 extends _t{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Te.object)return Ee(n,{code:ye.invalid_type,expected:Te.object,received:n.parsedType}),dt;const s=this.discriminator,a=n.data[s],i=this.optionsMap.get(a);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(Ee(n,{code:ye.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),dt)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,s){const a=new Map;for(const i of n){const o=wa(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const l of o){if(a.has(l))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(l)}`);a.set(l,i)}}return new W0({typeName:st.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:a,...vt(s)})}}function ry(t,e){const n=ci(t),s=ci(e);if(t===e)return{valid:!0,data:t};if(n===Te.object&&s===Te.object){const a=Rt.objectKeys(e),i=Rt.objectKeys(t).filter(l=>a.indexOf(l)!==-1),o={...t,...e};for(const l of i){const c=ry(t[l],e[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(n===Te.array&&s===Te.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let i=0;i<t.length;i++){const o=t[i],l=e[i],c=ry(o,l);if(!c.valid)return{valid:!1};a.push(c.data)}return{valid:!0,data:a}}else return n===Te.date&&s===Te.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class ku extends _t{_parse(e){const{status:n,ctx:s}=this._processInputParams(e),a=(i,o)=>{if(ty(i)||ty(o))return dt;const l=ry(i.value,o.value);return l.valid?((ny(i)||ny(o))&&n.dirty(),{status:n.value,value:l.data}):(Ee(s,{code:ye.invalid_intersection_types}),dt)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}ku.create=(t,e,n)=>new ku({left:t,right:e,typeName:st.ZodIntersection,...vt(n)});class ua extends _t{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==Te.array)return Ee(s,{code:ye.invalid_type,expected:Te.array,received:s.parsedType}),dt;if(s.data.length<this._def.items.length)return Ee(s,{code:ye.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),dt;!this._def.rest&&s.data.length>this._def.items.length&&(Ee(s,{code:ye.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...s.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new da(s,o,s.path,l)):null}).filter(o=>!!o);return s.common.async?Promise.all(i).then(o=>nr.mergeArray(n,o)):nr.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new ua({...this._def,rest:e})}}ua.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ua({items:t,typeName:st.ZodTuple,rest:null,...vt(e)})};class Cu extends _t{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==Te.object)return Ee(s,{code:ye.invalid_type,expected:Te.object,received:s.parsedType}),dt;const a=[],i=this._def.keyType,o=this._def.valueType;for(const l in s.data)a.push({key:i._parse(new da(s,l,s.path,l)),value:o._parse(new da(s,s.data[l],s.path,l)),alwaysSet:l in s.data});return s.common.async?nr.mergeObjectAsync(n,a):nr.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(e,n,s){return n instanceof _t?new Cu({keyType:e,valueType:n,typeName:st.ZodRecord,...vt(s)}):new Cu({keyType:js.create(),valueType:e,typeName:st.ZodRecord,...vt(n)})}}class Bf extends _t{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==Te.map)return Ee(s,{code:ye.invalid_type,expected:Te.map,received:s.parsedType}),dt;const a=this._def.keyType,i=this._def.valueType,o=[...s.data.entries()].map(([l,c],d)=>({key:a._parse(new da(s,l,s.path,[d,"key"])),value:i._parse(new da(s,c,s.path,[d,"value"]))}));if(s.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,u=await c.value;if(d.status==="aborted"||u.status==="aborted")return dt;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),l.set(d.value,u.value)}return{status:n.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,u=c.value;if(d.status==="aborted"||u.status==="aborted")return dt;(d.status==="dirty"||u.status==="dirty")&&n.dirty(),l.set(d.value,u.value)}return{status:n.value,value:l}}}}Bf.create=(t,e,n)=>new Bf({valueType:e,keyType:t,typeName:st.ZodMap,...vt(n)});class $o extends _t{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.parsedType!==Te.set)return Ee(s,{code:ye.invalid_type,expected:Te.set,received:s.parsedType}),dt;const a=this._def;a.minSize!==null&&s.data.size<a.minSize.value&&(Ee(s,{code:ye.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&s.data.size>a.maxSize.value&&(Ee(s,{code:ye.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const d=new Set;for(const u of c){if(u.status==="aborted")return dt;u.status==="dirty"&&n.dirty(),d.add(u.value)}return{status:n.value,value:d}}const l=[...s.data.values()].map((c,d)=>i._parse(new da(s,c,s.path,d)));return s.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(e,n){return new $o({...this._def,minSize:{value:e,message:qe.toString(n)}})}max(e,n){return new $o({...this._def,maxSize:{value:e,message:qe.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}$o.create=(t,e)=>new $o({valueType:t,minSize:null,maxSize:null,typeName:st.ZodSet,...vt(e)});class Zl extends _t{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Te.function)return Ee(n,{code:ye.invalid_type,expected:Te.function,received:n.parsedType}),dt;function s(l,c){return Mf({data:l,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Rf(),wc].filter(d=>!!d),issueData:{code:ye.invalid_arguments,argumentsError:c}})}function a(l,c){return Mf({data:l,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Rf(),wc].filter(d=>!!d),issueData:{code:ye.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof _c){const l=this;return dr(async function(...c){const d=new zr([]),u=await l._def.args.parseAsync(c,i).catch(p=>{throw d.addIssue(s(c,p)),d}),h=await Reflect.apply(o,this,u);return await l._def.returns._def.type.parseAsync(h,i).catch(p=>{throw d.addIssue(a(h,p)),d})})}else{const l=this;return dr(function(...c){const d=l._def.args.safeParse(c,i);if(!d.success)throw new zr([s(c,d.error)]);const u=Reflect.apply(o,this,d.data),h=l._def.returns.safeParse(u,i);if(!h.success)throw new zr([a(u,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Zl({...this._def,args:ua.create(e).rest(Ao.create())})}returns(e){return new Zl({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,s){return new Zl({args:e||ua.create([]).rest(Ao.create()),returns:n||Ao.create(),typeName:st.ZodFunction,...vt(s)})}}class Eu extends _t{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Eu.create=(t,e)=>new Eu({getter:t,typeName:st.ZodLazy,...vt(e)});class Au extends _t{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Ee(n,{received:n.data,code:ye.invalid_literal,expected:this._def.value}),dt}return{status:"valid",value:e.data}}get value(){return this._def.value}}Au.create=(t,e)=>new Au({value:t,typeName:st.ZodLiteral,...vt(e)});function J4(t,e){return new Hi({values:t,typeName:st.ZodEnum,...vt(e)})}class Hi extends _t{constructor(){super(...arguments),pd.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),s=this._def.values;return Ee(n,{expected:Rt.joinValues(s),received:n.parsedType,code:ye.invalid_type}),dt}if(If(this,pd)||G4(this,pd,new Set(this._def.values)),!If(this,pd).has(e.data)){const n=this._getOrReturnCtx(e),s=this._def.values;return Ee(n,{received:n.data,code:ye.invalid_enum_value,options:s}),dt}return dr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Hi.create(e,{...this._def,...n})}exclude(e,n=this._def){return Hi.create(this.options.filter(s=>!e.includes(s)),{...this._def,...n})}}pd=new WeakMap;Hi.create=J4;class Du extends _t{constructor(){super(...arguments),xd.set(this,void 0)}_parse(e){const n=Rt.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==Te.string&&s.parsedType!==Te.number){const a=Rt.objectValues(n);return Ee(s,{expected:Rt.joinValues(a),received:s.parsedType,code:ye.invalid_type}),dt}if(If(this,xd)||G4(this,xd,new Set(Rt.getValidEnumValues(this._def.values))),!If(this,xd).has(e.data)){const a=Rt.objectValues(n);return Ee(s,{received:s.data,code:ye.invalid_enum_value,options:a}),dt}return dr(e.data)}get enum(){return this._def.values}}xd=new WeakMap;Du.create=(t,e)=>new Du({values:t,typeName:st.ZodNativeEnum,...vt(e)});class _c extends _t{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Te.promise&&n.common.async===!1)return Ee(n,{code:ye.invalid_type,expected:Te.promise,received:n.parsedType}),dt;const s=n.parsedType===Te.promise?n.data:Promise.resolve(n.data);return dr(s.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}_c.create=(t,e)=>new _c({type:t,typeName:st.ZodPromise,...vt(e)});class Ms extends _t{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===st.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:s}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:o=>{Ee(s,o),o.fatal?n.abort():n.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(s.data,i);if(s.common.async)return Promise.resolve(o).then(async l=>{if(n.value==="aborted")return dt;const c=await this._def.schema._parseAsync({data:l,path:s.path,parent:s});return c.status==="aborted"?dt:c.status==="dirty"||n.value==="dirty"?Ol(c.value):c});{if(n.value==="aborted")return dt;const l=this._def.schema._parseSync({data:o,path:s.path,parent:s});return l.status==="aborted"?dt:l.status==="dirty"||n.value==="dirty"?Ol(l.value):l}}if(a.type==="refinement"){const o=l=>{const c=a.refinement(l,i);if(s.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(s.common.async===!1){const l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return l.status==="aborted"?dt:(l.status==="dirty"&&n.dirty(),o(l.value),{status:n.value,value:l.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>l.status==="aborted"?dt:(l.status==="dirty"&&n.dirty(),o(l.value).then(()=>({status:n.value,value:l.value}))))}if(a.type==="transform")if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!bu(o))return o;const l=a.transform(o.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:l}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>bu(o)?Promise.resolve(a.transform(o.value,i)).then(l=>({status:n.value,value:l})):o);Rt.assertNever(a)}}Ms.create=(t,e,n)=>new Ms({schema:t,typeName:st.ZodEffects,effect:e,...vt(n)});Ms.createWithPreprocess=(t,e,n)=>new Ms({schema:e,effect:{type:"preprocess",transform:t},typeName:st.ZodEffects,...vt(n)});class sa extends _t{_parse(e){return this._getType(e)===Te.undefined?dr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}sa.create=(t,e)=>new sa({innerType:t,typeName:st.ZodOptional,...vt(e)});class Vi extends _t{_parse(e){return this._getType(e)===Te.null?dr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Vi.create=(t,e)=>new Vi({innerType:t,typeName:st.ZodNullable,...vt(e)});class Pu extends _t{_parse(e){const{ctx:n}=this._processInputParams(e);let s=n.data;return n.parsedType===Te.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Pu.create=(t,e)=>new Pu({innerType:t,typeName:st.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...vt(e)});class Tu extends _t{_parse(e){const{ctx:n}=this._processInputParams(e),s={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return wu(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new zr(s.common.issues)},input:s.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new zr(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}Tu.create=(t,e)=>new Tu({innerType:t,typeName:st.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...vt(e)});class Lf extends _t{_parse(e){if(this._getType(e)!==Te.nan){const s=this._getOrReturnCtx(e);return Ee(s,{code:ye.invalid_type,expected:Te.nan,received:s.parsedType}),dt}return{status:"valid",value:e.data}}}Lf.create=t=>new Lf({typeName:st.ZodNaN,...vt(t)});const i7=Symbol("zod_brand");class sw extends _t{_parse(e){const{ctx:n}=this._processInputParams(e),s=n.data;return this._def.type._parse({data:s,path:n.path,parent:n})}unwrap(){return this._def.type}}class oh extends _t{_parse(e){const{status:n,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?dt:i.status==="dirty"?(n.dirty(),Ol(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{const a=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?dt:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:s.path,parent:s})}}static create(e,n){return new oh({in:e,out:n,typeName:st.ZodPipeline})}}class Ru extends _t{_parse(e){const n=this._def.innerType._parse(e),s=a=>(bu(a)&&(a.value=Object.freeze(a.value)),a);return wu(n)?n.then(a=>s(a)):s(n)}unwrap(){return this._def.innerType}}Ru.create=(t,e)=>new Ru({innerType:t,typeName:st.ZodReadonly,...vt(e)});function X4(t,e={},n){return t?jc.create().superRefine((s,a)=>{var i,o;if(!t(s)){const l=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,c=(o=(i=l.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,d=typeof l=="string"?{message:l}:l;a.addIssue({code:"custom",...d,fatal:c})}}):jc.create()}const o7={object:rn.lazycreate};var st;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(st||(st={}));const l7=(t,e={message:`Input not instance of ${t.name}`})=>X4(n=>n instanceof t,e),eA=js.create,tA=qi.create,c7=Lf.create,d7=Wi.create,nA=ju.create,u7=Lo.create,h7=Of.create,m7=_u.create,f7=Nu.create,p7=jc.create,x7=Ao.create,g7=La.create,v7=Ff.create,y7=Ss.create,b7=rn.create,w7=rn.strictCreate,j7=Su.create,_7=W0.create,N7=ku.create,S7=ua.create,k7=Cu.create,C7=Bf.create,E7=$o.create,A7=Zl.create,D7=Eu.create,P7=Au.create,T7=Hi.create,R7=Du.create,M7=_c.create,W1=Ms.create,I7=sa.create,O7=Vi.create,F7=Ms.createWithPreprocess,B7=oh.create,L7=()=>eA().optional(),$7=()=>tA().optional(),z7=()=>nA().optional(),U7={string:t=>js.create({...t,coerce:!0}),number:t=>qi.create({...t,coerce:!0}),boolean:t=>ju.create({...t,coerce:!0}),bigint:t=>Wi.create({...t,coerce:!0}),date:t=>Lo.create({...t,coerce:!0})},q7=dt;var _=Object.freeze({__proto__:null,defaultErrorMap:wc,setErrorMap:q9,getErrorMap:Rf,makeIssue:Mf,EMPTY_PATH:W9,addIssueToContext:Ee,ParseStatus:nr,INVALID:dt,DIRTY:Ol,OK:dr,isAborted:ty,isDirty:ny,isValid:bu,isAsync:wu,get util(){return Rt},get objectUtil(){return ey},ZodParsedType:Te,getParsedType:ci,ZodType:_t,datetimeRegex:Y4,ZodString:js,ZodNumber:qi,ZodBigInt:Wi,ZodBoolean:ju,ZodDate:Lo,ZodSymbol:Of,ZodUndefined:_u,ZodNull:Nu,ZodAny:jc,ZodUnknown:Ao,ZodNever:La,ZodVoid:Ff,ZodArray:Ss,ZodObject:rn,ZodUnion:Su,ZodDiscriminatedUnion:W0,ZodIntersection:ku,ZodTuple:ua,ZodRecord:Cu,ZodMap:Bf,ZodSet:$o,ZodFunction:Zl,ZodLazy:Eu,ZodLiteral:Au,ZodEnum:Hi,ZodNativeEnum:Du,ZodPromise:_c,ZodEffects:Ms,ZodTransformer:Ms,ZodOptional:sa,ZodNullable:Vi,ZodDefault:Pu,ZodCatch:Tu,ZodNaN:Lf,BRAND:i7,ZodBranded:sw,ZodPipeline:oh,ZodReadonly:Ru,custom:X4,Schema:_t,ZodSchema:_t,late:o7,get ZodFirstPartyTypeKind(){return st},coerce:U7,any:p7,array:y7,bigint:d7,boolean:nA,date:u7,discriminatedUnion:_7,effect:W1,enum:T7,function:A7,instanceof:l7,intersection:N7,lazy:D7,literal:P7,map:C7,nan:c7,nativeEnum:R7,never:g7,null:f7,nullable:O7,number:tA,object:b7,oboolean:z7,onumber:$7,optional:I7,ostring:L7,pipeline:B7,preprocess:F7,promise:M7,record:k7,set:E7,strictObject:w7,string:eA,symbol:h7,transformer:W1,tuple:S7,undefined:m7,union:j7,unknown:x7,void:v7,NEVER:q7,ZodIssueCode:ye,quotelessJson:U9,ZodError:zr});const ze={UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",INVALID_TOKEN:"INVALID_TOKEN",VALIDATION_ERROR:"VALIDATION_ERROR",INVALID_INPUT:"INVALID_INPUT",MISSING_REQUIRED_FIELD:"MISSING_REQUIRED_FIELD",RESOURCE_NOT_FOUND:"RESOURCE_NOT_FOUND",RESOURCE_ALREADY_EXISTS:"RESOURCE_ALREADY_EXISTS",BUSINESS_RULE_VIOLATION:"BUSINESS_RULE_VIOLATION",INSUFFICIENT_PERMISSIONS:"INSUFFICIENT_PERMISSIONS",IMMUTABLE_RECORD:"IMMUTABLE_RECORD",AUDIT_REQUIRED:"AUDIT_REQUIRED",DOCUMENT_LOCKED:"DOCUMENT_LOCKED",RETENTION_PERIOD_ACTIVE:"RETENTION_PERIOD_ACTIVE",INTERNAL_ERROR:"INTERNAL_ERROR",DATABASE_ERROR:"DATABASE_ERROR",NETWORK_ERROR:"NETWORK_ERROR",SERVICE_UNAVAILABLE:"SERVICE_UNAVAILABLE",RATE_LIMIT_EXCEEDED:"RATE_LIMIT_EXCEEDED"};let Be=class extends Error{constructor(e,n,s,a=400){super(n),this.code=e,this.details=s,this.statusCode=a,this.name="ApiError"}};const rA=()=>`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Ur=(t,e,n)=>{try{return t.parse(e)}catch(s){throw s instanceof _.ZodError?new Be(ze.VALIDATION_ERROR,"Input validation failed",{validationErrors:s.errors,receivedData:e}):s}},Vd=t=>{throw console.error("Supabase error:",t),t.code==="PGRST116"?new Be(ze.FORBIDDEN,"Insufficient permissions to access this resource",{supabaseCode:t.code}):t.code==="23505"?new Be(ze.RESOURCE_ALREADY_EXISTS,"Resource already exists",{supabaseCode:t.code,constraint:t.constraint}):t.code==="23503"?new Be(ze.BUSINESS_RULE_VIOLATION,"Referenced resource does not exist",{supabaseCode:t.code,constraint:t.constraint}):new Be(ze.DATABASE_ERROR,t.message||"Database operation failed",{supabaseError:t})};async function ke(t,e){const n=rA();try{console.log(`[${n}] Starting API operation: ${e||"Unknown"}`);const s=await t();return console.log(`[${n}] API operation completed successfully`),s}catch(s){throw console.error(`[${n}] API operation failed:`,s),s instanceof Be?s:(s&&typeof s=="object"&&"code"in s&&Vd(s),new Be(ze.INTERNAL_ERROR,s instanceof Error?s.message:"Unknown error occurred",{requestId:n,originalError:s}))}}class W7{constructor(e){En(this,"query");En(this,"requestId");this.query=e,this.requestId=rA()}async execute(){return ke(async()=>{const{data:e,error:n}=await this.query;return n&&Vd(n),e||[]},`Query execution [${this.requestId}]`)}async executeSingle(){return ke(async()=>{const{data:e,error:n}=await this.query.single();if(n){if(n.code==="PGRST116")throw new Be(ze.RESOURCE_NOT_FOUND,"Resource not found");Vd(n)}return e},`Single query execution [${this.requestId}]`)}async executeWithCount(){return ke(async()=>{const{data:e,error:n,count:s}=await this.query;return n&&Vd(n),{data:e||[],count:s||0}},`Query with count execution [${this.requestId}]`)}}const Ue=t=>new W7(t),H7=async()=>ke(async()=>{const{data:{user:t},error:e}=await $.auth.getUser();if(e)throw new Be(ze.UNAUTHORIZED,"Authentication required");if(!t)throw new Be(ze.UNAUTHORIZED,"User not authenticated");return t},"Get current user"),bs=async()=>ke(async()=>{const t=await H7(),{data:e,error:n}=await $.from("profiles").select("*").eq("id",t.id).single();return n&&Vd(n),e},"Get current user profile"),ma=_.object({id:_.string().uuid(),created_at:_.string().datetime(),updated_at:_.string().datetime(),company_id:_.string().uuid().optional()}),aw=_.object({company_name:_.string().min(1,"Firmenname ist erforderlich"),contact_person:_.string().min(1,"Ansprechpartner ist erforderlich"),email:_.string().email("Gültige E-Mail-Adresse erforderlich"),phone:_.string().optional(),address:_.string().optional(),city:_.string().optional(),postal_code:_.string().optional(),country:_.string().default("Deutschland"),tax_number:_.string().optional(),customer_number:_.string().optional(),status:_.enum(["Aktiv","Premium","Inaktiv"]).default("Aktiv")}),V7=aw.partial();ma.merge(aw).extend({customer_number:_.string().nullable()});const sA=_.object({name:_.string().min(1,"Materialname ist erforderlich"),sku:_.string().optional(),description:_.string().optional(),unit:_.string().default("Stk"),unit_price:_.number().min(0,"Preis muss positiv sein").default(0),stock:_.number().int().min(0,"Lagerbestand muss positiv sein").default(0),reorder_min:_.number().int().min(0,"Mindestbestand muss positiv sein").default(0),category:_.string().optional(),supplier:_.string().optional()});sA.partial();ma.merge(sA);const K7=_.object({id:_.string().optional(),description:_.string().min(1,"Beschreibung ist erforderlich"),quantity:_.number().min(.01,"Menge muss größer als 0 sein"),unit:_.string().default("Stk"),unit_price:_.number().min(0,"Preis muss positiv sein"),total_price:_.number().min(0,"Gesamtpreis muss positiv sein")}),iw=_.object({customer_id:_.string().uuid("Kunde ist erforderlich"),title:_.string().min(1,"Titel ist erforderlich"),description:_.string().optional(),body:_.object({items:_.array(K7).min(1,"Mindestens ein Posten erforderlich"),notes:_.string().optional(),terms:_.string().optional()}),tax_rate:_.number().min(0).max(100).default(19),valid_until:_.string().date().optional()}),G7=iw.partial().extend({status:_.enum(["draft","sent","accepted","rejected","expired"]).optional(),quote_number:_.string().optional()});ma.merge(iw).extend({quote_number:_.string().nullable(),status:_.enum(["draft","sent","accepted","rejected","expired"]).default("draft"),total_net:_.number().optional(),total_gross:_.number().optional(),sent_at:_.string().datetime().optional(),accepted_at:_.string().datetime().optional()});const ow=_.object({quote_id:_.string().uuid().optional(),customer_id:_.string().uuid("Kunde ist erforderlich"),title:_.string().min(1,"Titel ist erforderlich"),description:_.string().optional(),total_amount:_.number().min(0,"Betrag muss positiv sein")}),Z7=ow.partial().extend({status:_.enum(["open","in_progress","completed","cancelled"]).optional(),order_number:_.string().optional()});ma.merge(ow).extend({order_number:_.string().nullable(),status:_.enum(["open","in_progress","completed","cancelled"]).default("open")});const lw=_.object({order_id:_.string().uuid().optional(),customer_id:_.string().uuid().optional(),name:_.string().min(1,"Projektname ist erforderlich"),description:_.string().optional(),status:_.enum(["planned","active","blocked","completed","cancelled"]).default("planned"),budget:_.number().min(0,"Budget muss positiv sein").optional(),start_date:_.string().date().optional(),end_date:_.string().date().optional(),progress_percentage:_.number().min(0).max(100).default(0)}),Q7=lw.partial();ma.merge(lw).extend({material_costs:_.number().default(0),labor_costs:_.number().default(0),hours_planned:_.number().optional(),hours_actual:_.number().default(0)});const cw=_.object({project_id:_.string().uuid().optional(),customer_id:_.string().uuid("Kunde ist erforderlich"),title:_.string().min(1,"Titel ist erforderlich"),description:_.string().optional(),amount:_.number().min(0,"Betrag muss positiv sein"),tax_rate:_.number().min(0).max(100).default(19),due_date:_.string().date().optional()}),Y7=cw.partial().extend({status:_.enum(["draft","sent","paid","overdue","void","cancelled"]).optional(),invoice_number:_.string().optional()});ma.merge(cw).extend({invoice_number:_.string().nullable(),status:_.enum(["draft","sent","paid","overdue","void","cancelled"]).default("draft"),net_amount:_.number().optional(),tax_amount:_.number().optional(),sent_at:_.string().datetime().optional(),paid_at:_.string().datetime().optional()});const dw=_.object({project_id:_.string().uuid("Projekt ist erforderlich"),employee_id:_.string().uuid("Mitarbeiter ist erforderlich"),date:_.string().date("Gültiges Datum erforderlich"),start_time:_.string().time().optional(),end_time:_.string().time().optional(),break_minutes:_.number().int().min(0).default(0),hours:_.number().min(0,"Stunden müssen positiv sein"),description:_.string().optional(),task_category:_.string().default("general"),hourly_rate:_.number().min(0,"Stundensatz muss positiv sein").optional(),is_billable:_.boolean().default(!0)}),J7=dw.partial().extend({approved_by:_.string().uuid().optional(),approved_at:_.string().datetime().optional()});ma.merge(dw).extend({approved_by:_.string().uuid().optional(),approved_at:_.string().datetime().optional()});const uw=_.object({project_id:_.string().uuid().optional(),employee_id:_.string().uuid().optional(),category:_.string().min(1,"Kategorie ist erforderlich"),amount:_.number().min(0,"Betrag muss positiv sein"),description:_.string().optional(),receipt_url:_.string().url().optional(),expense_date:_.string().date("Gültiges Datum erforderlich"),is_billable:_.boolean().default(!1)});uw.partial().extend({approved_by:_.string().uuid().optional(),approved_at:_.string().datetime().optional()});ma.merge(uw).extend({approved_by:_.string().uuid().optional(),approved_at:_.string().datetime().optional()});const X7=_.object({material_id:_.string().uuid("Material ist erforderlich"),project_id:_.string().uuid().optional(),quantity:_.number().int().refine(t=>t!==0,"Menge darf nicht 0 sein"),movement_type:_.enum(["issue","receive","adjust","return"]),reference_number:_.string().optional(),notes:_.string().optional()});ma.merge(X7);const aA=_.object({first_name:_.string().min(1,"Vorname ist erforderlich"),last_name:_.string().min(1,"Nachname ist erforderlich"),email:_.string().email("Gültige E-Mail-Adresse erforderlich"),phone:_.string().optional(),role:_.string().default("employee"),hourly_wage:_.number().min(0,"Stundenlohn muss positiv sein").default(0),status:_.enum(["active","inactive","invited"]).default("active")});aA.partial();ma.merge(aA);const ez=_.object({success:_.literal(!0),data:_.any(),message:_.string().optional()}),tz=_.object({success:_.literal(!1),error:_.object({code:_.string(),message:_.string(),details:_.any().optional()})});_.union([ez,tz]);_.object({page:_.coerce.number().int().min(1).default(1),limit:_.coerce.number().int().min(1).max(100).default(20),sort_by:_.string().optional(),sort_order:_.enum(["asc","desc"]).default("desc")});_.object({items:_.array(_.any()),pagination:_.object({page:_.number(),limit:_.number(),total_items:_.number(),total_pages:_.number(),has_next:_.boolean(),has_prev:_.boolean()})});const nz=_.object({project_id:_.string().uuid().optional(),suggestion_type:_.enum(["parse_intent","estimate","schedule","material_list","cost_breakdown","timeline"]),input_data:_.record(_.any()).refine(t=>Object.keys(t).length>0,"Input data is required"),output_data:_.record(_.any()).refine(t=>Object.keys(t).length>0,"Output data is required"),confidence_score:_.number().min(0).max(1).optional(),model_version:_.string().optional(),trace_id:_.string().uuid().optional()});nz.partial().extend({status:_.enum(["active","applied","rejected","superseded"]).optional(),applied_by:_.string().uuid().optional(),applied_at:_.string().datetime().optional(),feedback_score:_.number().int().min(1).max(5).optional(),feedback_notes:_.string().optional()});_.object({id:_.string().uuid(),project_id:_.string().uuid().optional(),suggestion_type:_.enum(["parse_intent","estimate","schedule","material_list","cost_breakdown","timeline"]),input_data:_.record(_.any()),output_data:_.record(_.any()),confidence_score:_.number().min(0).max(1).optional(),model_version:_.string().optional(),trace_id:_.string().uuid().optional(),status:_.enum(["active","applied","rejected","superseded"]).default("active"),applied_by:_.string().uuid().optional(),applied_at:_.string().datetime().optional(),feedback_score:_.number().int().min(1).max(5).optional(),feedback_notes:_.string().optional(),company_id:_.string().uuid().optional(),created_at:_.string().datetime(),updated_at:_.string().datetime()});_.object({ref_type:_.string().min(1,"Reference type is required"),ref_id:_.string().uuid("Valid reference ID required"),content_text:_.string().min(1,"Content text is required"),metadata:_.record(_.any()).optional()});_.object({id:_.string().uuid(),ref_type:_.string(),ref_id:_.string().uuid(),content_text:_.string(),embedding:_.array(_.number()).optional(),metadata:_.record(_.any()).optional(),indexed_at:_.string().datetime(),company_id:_.string().uuid().optional(),created_at:_.string().datetime(),updated_at:_.string().datetime()});_.object({operation_type:_.enum(["index_content","generate_estimate","create_schedule","extract_intent"]),entity_type:_.string().min(1,"Entity type is required"),entity_id:_.string().uuid("Valid entity ID required"),input_data:_.record(_.any()).refine(t=>Object.keys(t).length>0,"Input data is required"),priority:_.number().int().min(1).max(10).default(5),scheduled_for:_.string().datetime().optional()});_.object({id:_.string().uuid(),operation_type:_.enum(["index_content","generate_estimate","create_schedule","extract_intent"]),entity_type:_.string(),entity_id:_.string().uuid(),input_data:_.record(_.any()),priority:_.number().int().min(1).max(10).default(5),status:_.enum(["pending","processing","completed","failed"]).default("pending"),attempts:_.number().int().min(0).default(0),max_attempts:_.number().int().min(1).default(3),error_message:_.string().optional(),result_data:_.record(_.any()).optional(),scheduled_for:_.string().datetime(),started_at:_.string().datetime().optional(),completed_at:_.string().datetime().optional(),company_id:_.string().uuid().optional(),created_at:_.string().datetime()});_.object({data_type:_.enum(["estimate_correction","schedule_feedback","material_suggestion","cost_actual_vs_predicted"]),input_features:_.record(_.any()).refine(t=>Object.keys(t).length>0,"Input features required"),expected_output:_.record(_.any()).refine(t=>Object.keys(t).length>0,"Expected output required"),predicted_output:_.record(_.any()).optional(),prediction_error:_.number().optional(),project_id:_.string().uuid().optional(),suggestion_id:_.string().uuid().optional()});_.object({id:_.string().uuid(),data_type:_.enum(["estimate_correction","schedule_feedback","material_suggestion","cost_actual_vs_predicted"]),input_features:_.record(_.any()),expected_output:_.record(_.any()),predicted_output:_.record(_.any()).optional(),prediction_error:_.number().optional(),project_id:_.string().uuid().optional(),suggestion_id:_.string().uuid().optional(),company_id:_.string().uuid().optional(),created_at:_.string().datetime()});_.object({text:_.string().min(1,"Text content is required"),context:_.object({customer_info:_.string().optional(),previous_projects:_.array(_.string()).optional(),preferred_materials:_.array(_.string()).optional()}).optional()});_.object({intent_type:_.enum(["quote_request","project_inquiry","maintenance","consultation","emergency"]),confidence:_.number().min(0).max(1),extracted_data:_.object({customer_name:_.string().optional(),project_type:_.string().optional(),description:_.string().optional(),urgency:_.enum(["low","medium","high","urgent"]).optional(),budget_range:_.object({min:_.number().optional(),max:_.number().optional()}).optional(),timeline:_.object({start_date:_.string().date().optional(),end_date:_.string().date().optional(),duration_days:_.number().optional()}).optional(),materials:_.array(_.object({name:_.string(),quantity:_.number().optional(),unit:_.string().optional()})).optional()}),suggestions:_.array(_.string()).optional()});_.object({project_description:_.string().min(1,"Project description is required"),project_type:_.string().optional(),customer_id:_.string().uuid().optional(),timeline:_.object({start_date:_.string().date().optional(),duration_days:_.number().min(1).optional()}).optional(),requirements:_.array(_.string()).optional(),similar_projects:_.array(_.string().uuid()).optional()});_.object({confidence:_.number().min(0).max(1),total_estimate:_.number().min(0),breakdown:_.object({labor_hours:_.number().min(0),labor_cost:_.number().min(0),material_cost:_.number().min(0),equipment_cost:_.number().min(0).default(0),overhead_cost:_.number().min(0).default(0)}),materials:_.array(_.object({name:_.string(),material_id:_.string().uuid().optional(),quantity:_.number().min(0),unit:_.string(),unit_price:_.number().min(0),total_cost:_.number().min(0),availability:_.enum(["available","order_needed","unavailable"]).optional()})),timeline:_.object({estimated_duration_days:_.number().min(1),phases:_.array(_.object({name:_.string(),duration_days:_.number().min(1),description:_.string().optional()})).optional()}),risks:_.array(_.object({description:_.string(),impact:_.enum(["low","medium","high"]),mitigation:_.string().optional()})).optional()});_.object({project_id:_.string().uuid("Project ID is required"),requirements:_.object({start_date:_.string().date().optional(),end_date:_.string().date().optional(),duration_days:_.number().min(1).optional(),required_skills:_.array(_.string()).optional(),team_size:_.number().int().min(1).optional()}),constraints:_.object({available_employees:_.array(_.string().uuid()).optional(),excluded_dates:_.array(_.string().date()).optional(),priority:_.enum(["low","medium","high","urgent"]).default("medium")}).optional()});_.object({confidence:_.number().min(0).max(1),recommended_schedule:_.array(_.object({employee_id:_.string().uuid(),employee_name:_.string(),dates:_.array(_.object({date:_.string().date(),hours:_.number().min(0).max(24),tasks:_.array(_.string()).optional()})),total_hours:_.number().min(0)})),conflicts:_.array(_.object({type:_.enum(["employee_unavailable","overallocation","skill_mismatch","deadline_conflict"]),description:_.string(),affected_employees:_.array(_.string().uuid()).optional(),severity:_.enum(["low","medium","high"])})),alternatives:_.array(_.object({description:_.string(),impact:_.string(),schedule:_.any().optional()})).optional()});_.object({entity_type:_.string().min(1,"Entity type is required"),entity_id:_.string().uuid("Valid entity ID required"),action:_.enum(["INSERT","UPDATE","DELETE","STATUS_CHANGE"]),old_values:_.record(_.any()).optional(),new_values:_.record(_.any()).optional(),changed_fields:_.array(_.string()).optional(),reason:_.string().optional(),ip_address:_.string().ip().optional(),user_agent:_.string().optional()});_.object({id:_.string().uuid(),entity_type:_.string(),entity_id:_.string().uuid(),action:_.enum(["INSERT","UPDATE","DELETE","STATUS_CHANGE"]),old_values:_.record(_.any()).optional(),new_values:_.record(_.any()).optional(),changed_fields:_.array(_.string()).optional(),user_id:_.string().uuid().optional(),user_email:_.string().email().optional(),reason:_.string().optional(),ip_address:_.string().optional(),user_agent:_.string().optional(),company_id:_.string().uuid().optional(),created_at:_.string().datetime()});const rz=_.object({sequence_name:_.string().min(1,"Sequence name is required"),prefix:_.string().default(""),format_pattern:_.string().default("{prefix}-{year}-{number:04d}"),year_reset:_.boolean().default(!0),current_value:_.number().int().min(0).default(0)});rz.partial();_.object({id:_.string().uuid(),sequence_name:_.string(),current_value:_.number().int().min(0),prefix:_.string(),year_reset:_.boolean(),format_pattern:_.string(),last_reset_year:_.number().int().optional(),company_id:_.string().uuid().optional(),created_at:_.string().datetime(),updated_at:_.string().datetime()});_.object({entity_type:_.string().min(1,"Entity type is required"),entity_id:_.string().uuid("Valid entity ID required"),file_name:_.string().min(1,"File name is required"),file_path:_.string().min(1,"File path is required"),file_size:_.number().int().min(0,"File size must be non-negative"),mime_type:_.string().min(1,"MIME type is required"),sha256_hash:_.string().regex(/^[a-fA-F0-9]{64}$/,"Valid SHA256 hash required"),is_original:_.boolean().default(!0),legal_category:_.enum(["invoice","contract","receipt","tax_document","correspondence"]),retention_until:_.string().date("Valid retention date required")});_.object({id:_.string().uuid(),entity_type:_.string(),entity_id:_.string().uuid(),file_name:_.string(),file_path:_.string(),file_size:_.number().int(),mime_type:_.string(),sha256_hash:_.string().regex(/^[a-fA-F0-9]{64}$/),created_by:_.string().uuid().optional(),is_original:_.boolean(),legal_category:_.enum(["invoice","contract","receipt","tax_document","correspondence"]),retention_until:_.string().date(),company_id:_.string().uuid().optional(),created_at:_.string().datetime()});_.object({from_date:_.string().date("Valid from date required"),to_date:_.string().date("Valid to date required"),export_type:_.enum(["invoices","postings","full"]).default("invoices"),include_drafts:_.boolean().default(!1),consultant_number:_.string().optional(),client_number:_.string().optional(),encoding:_.enum(["UTF-8","CP1252"]).default("CP1252")});_.object({export_id:_.string().uuid(),file_url:_.string().url(),file_name:_.string(),record_count:_.number().int().min(0),export_date:_.string().datetime(),from_date:_.string().date(),to_date:_.string().date(),checksum:_.string().optional()});_.object({belegdatum:_.string().date(),rechnungsnummer:_.string(),debitorenkonto:_.string().optional(),gegenkonto:_.string(),bu_schluessel:_.string().optional(),nettobetrag:_.number(),steuerbetrag:_.number().default(0),bruttobetrag:_.number(),belegfeld1:_.string().optional(),kost1:_.string().optional(),kost2:_.string().optional(),project_id:_.string().uuid().optional(),customer_id:_.string().uuid().optional(),description:_.string().optional()});_.object({entity_type:_.enum(["quote","order","invoice"]),entity_id:_.string().uuid(),from_status:_.string(),to_status:_.string(),reason:_.string().optional(),require_immutable_file:_.boolean().default(!1),file_data:_.object({content:_.string(),filename:_.string(),mime_type:_.string()}).optional()});_.object({report_type:_.enum(["audit_summary","document_integrity","number_sequence_gaps","retention_overview"]),from_date:_.string().date().optional(),to_date:_.string().date().optional(),entity_types:_.array(_.string()).optional()});_.object({report_type:_.string(),generated_at:_.string().datetime(),period:_.object({from_date:_.string().date().optional(),to_date:_.string().date().optional()}),summary:_.object({total_records:_.number().int(),compliant_records:_.number().int(),issues_found:_.number().int(),compliance_percentage:_.number().min(0).max(100)}),details:_.array(_.object({entity_type:_.string(),entity_id:_.string().uuid(),issue_type:_.string(),description:_.string(),severity:_.enum(["low","medium","high","critical"]),recommendation:_.string().optional()})),file_integrity:_.object({total_files:_.number().int(),verified_files:_.number().int(),failed_verifications:_.number().int(),missing_files:_.number().int()}).optional()});_.object({entity_type:_.string().min(1,"Entity type is required"),entity_ids:_.array(_.string().uuid()).min(1,"At least one entity ID required"),archive_reason:_.string().min(1,"Archive reason is required"),retention_years:_.number().int().min(1).max(30).default(10),include_related:_.boolean().default(!0)});_.object({archive_id:_.string().uuid(),archived_count:_.number().int(),archive_location:_.string(),retention_until:_.string().date(),created_at:_.string().datetime()});const H1=(t,e=!1)=>{const n={can_view:!1,can_edit_basic_data:!1,can_add_time:!1,can_add_materials:!1,can_upload_files:!1,can_change_status:!1,can_link_invoices:!1,can_delete:!1,can_manage_team:!1};switch(t){case"mitarbeiter":return{...n,can_view:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0};case"projektleiter":return{...n,can_view:!0,can_edit_basic_data:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0,can_change_status:!0,can_link_invoices:!0,can_manage_team:!0};case"admin":return{can_view:!0,can_edit_basic_data:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0,can_change_status:!0,can_link_invoices:!0,can_delete:!0,can_manage_team:!0};default:return n}},V1={anfrage:{label:"Anfrage",color:"text-purple-700",bgColor:"bg-purple-100",icon:"📋",description:"Projekt-Anfrage eingegangen",nextStates:["besichtigung"],previousStates:[]},besichtigung:{label:"Termin ausmachen",color:"text-orange-700",bgColor:"bg-orange-100",icon:"📅",description:"Besichtigungstermin vereinbaren",nextStates:["geplant"],previousStates:["anfrage"]},geplant:{label:"In Planung",color:"text-blue-700",bgColor:"bg-blue-100",icon:"📝",description:"Projekt ist in Planung",nextStates:["in_bearbeitung"],previousStates:["besichtigung"]},in_bearbeitung:{label:"In Arbeit",color:"text-yellow-700",bgColor:"bg-yellow-100",icon:"🔨",description:"Projekt läuft aktiv",nextStates:["abgeschlossen"],previousStates:["geplant"]},abgeschlossen:{label:"Erledigt",color:"text-green-700",bgColor:"bg-green-100",icon:"✅",description:"Projekt ist abgeschlossen",nextStates:[],previousStates:["in_bearbeitung"]}};class H0{static async getCustomers(e,n){return ke(async()=>{let s=$.from("customers").select("*",{count:"exact"});if(n!=null&&n.status&&(s=s.eq("status",n.status)),n!=null&&n.search&&(s=s.or(`company_name.ilike.%${n.search}%,contact_person.ilike.%${n.search}%,email.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else s=s.order("created_at",{ascending:!1});const{data:a,count:i}=await Ue(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get customers")}static async getCustomer(e){return ke(async()=>{const n=$.from("customers").select("*").eq("id",e);return Ue(n).executeSingle()},`Get customer ${e}`)}static async createCustomer(e){return ke(async()=>{const n=Ur(aw,e);if(!n.customer_number){const a=await this.generateCustomerNumber();n.customer_number=a}const s=$.from("customers").insert(n).select().single();return Ue(s).executeSingle()},"Create customer")}static async updateCustomer(e,n){return ke(async()=>{const s=Ur(V7,n);await this.getCustomer(e);const a=$.from("customers").update(s).eq("id",e).select().single();return Ue(a).executeSingle()},`Update customer ${e}`)}static async deleteCustomer(e){return ke(async()=>{const{data:n}=await $.from("projects").select("id").eq("customer_id",e).limit(1);if(n&&n.length>0)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Kunde kann nicht gelöscht werden, da noch Projekte zugeordnet sind.",{relatedProjects:n.length});const{data:s}=await $.from("quotes").select("id").eq("customer_id",e).limit(1);if(s&&s.length>0)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Kunde kann nicht gelöscht werden, da noch Angebote vorhanden sind.",{relatedQuotes:s.length});const{error:a}=await $.from("customers").delete().eq("id",e);if(a)throw a},`Delete customer ${e}`)}static async getCustomerStats(e){return ke(async()=>{const{data:n}=await $.from("projects").select("status, budget").eq("customer_id",e),{data:s}=await $.from("invoices").select("status, amount").eq("customer_id",e);return{total_projects:(n==null?void 0:n.length)||0,active_projects:(n==null?void 0:n.filter(i=>i.status==="active").length)||0,completed_projects:(n==null?void 0:n.filter(i=>i.status==="completed").length)||0,total_revenue:(s==null?void 0:s.filter(i=>i.status==="paid").reduce((i,o)=>i+(o.amount||0),0))||0,pending_invoices:(s==null?void 0:s.filter(i=>i.status==="sent").length)||0,overdue_invoices:(s==null?void 0:s.filter(i=>i.status==="overdue").length)||0}},`Get customer stats ${e}`)}static async searchCustomers(e,n=10){return ke(async()=>{const s=$.from("customers").select("*").or(`company_name.ilike.%${e}%,contact_person.ilike.%${e}%,email.ilike.%${e}%,customer_number.ilike.%${e}%`).order("company_name").limit(n);return Ue(s).execute()},`Search customers: ${e}`)}static async generateCustomerNumber(){return ke(async()=>{const e=await bs(),{data:n,error:s}=await $.rpc("get_next_number",{seq_name:"customers",comp_id:e.company_id});if(s)throw s;return n},"Generate customer number")}static async getCustomerProjects(e){return ke(async()=>{const n=$.from("projects").select(`
          *
        `).eq("customer_id",e).order("created_at",{ascending:!1});return Ue(n).execute()},`Get customer projects ${e}`)}static async getCustomerQuotes(e){return ke(async()=>{const n=$.from("quotes").select("*").eq("customer_id",e).order("created_at",{ascending:!1});return Ue(n).execute()},`Get customer quotes ${e}`)}static async getCustomerInvoices(e){return ke(async()=>{const n=$.from("invoices").select(`
          *,
          projects (
            name
          )
        `).eq("customer_id",e).order("created_at",{ascending:!1});return Ue(n).execute()},`Get customer invoices ${e}`)}}const sz=new H0;class az{constructor(){En(this,"subscriptions",new Map);En(this,"eventHistory",[]);En(this,"maxHistorySize",1e3)}on(e,n,s=!1){const a={id:this.generateId(),event:e,handler:n,once:s};return this.subscriptions.has(e)||this.subscriptions.set(e,[]),this.subscriptions.get(e).push(a),a.id}once(e,n){return this.on(e,n,!0)}off(e){for(const[n,s]of this.subscriptions.entries()){const a=s.findIndex(i=>i.id===e);if(a>=0){s.splice(a,1),s.length===0&&this.subscriptions.delete(n);break}}}async emit(e,n={}){const s={...n,timestamp:n.timestamp||new Date().toISOString()};this.addToHistory(e,s),this.shouldLogToAudit(e)&&await this.logToAuditTrail(e,s);const i=(this.subscriptions.get(e)||[]).map(async o=>{try{await o.handler(s),o.once&&this.off(o.id)}catch(l){console.error(`Event handler error for ${e}:`,l),e!=="SYSTEM_ERROR"&&this.emit("SYSTEM_ERROR",{error:l instanceof Error?l.message:"Unknown error",event:e,data:s})}});await Promise.all(i),await this.triggerWorkflowAutomations(e,s)}getHistory(e,n){let s=e?this.eventHistory.filter(a=>a.event===e):this.eventHistory;return n&&(s=s.slice(-n)),s}clearHistory(){this.eventHistory=[]}getSubscriptionCount(e){var s;if(e)return((s=this.subscriptions.get(e))==null?void 0:s.length)||0;let n=0;for(const a of this.subscriptions.values())n+=a.length;return n}generateId(){return`sub_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}addToHistory(e,n){this.eventHistory.push({event:e,data:{...n},timestamp:n.timestamp||new Date().toISOString()}),this.eventHistory.length>this.maxHistorySize&&this.eventHistory.shift()}shouldLogToAudit(e){return["QUOTE_SENT","QUOTE_ACCEPTED","QUOTE_REJECTED","ORDER_STARTED","ORDER_COMPLETED","ORDER_CANCELLED","PROJECT_STATUS_CHANGED","INVOICE_SENT","INVOICE_PAID","TIMESHEET_APPROVED","STOCK_ADJUSTED","DOCUMENT_UPLOADED","DOCUMENT_DELETED"].includes(e)}async logToAuditTrail(e,n){try{const s=this.extractAuditData(e,n);await $.from("audit_logs").insert({action:this.mapEventToAuditAction(e),table_name:this.extractTableName(e),record_id:s.recordId,old_values:s.oldValues,new_values:s.newValues,user_id:n.user_id,metadata:{event_type:e,...s.metadata}})}catch(s){console.error("Failed to log audit trail:",s)}}extractAuditData(e,n){var s,a,i,o,l,c,d,u;switch(e){case"QUOTE_ACCEPTED":case"QUOTE_REJECTED":return{recordId:(s=n.quote)==null?void 0:s.id,newValues:{status:(a=n.quote)==null?void 0:a.status},metadata:{reason:n.reason}};case"PROJECT_STATUS_CHANGED":return{recordId:(i=n.project)==null?void 0:i.id,oldValues:{status:n.previous_status},newValues:{status:n.new_status}};case"INVOICE_PAID":return{recordId:(o=n.invoice)==null?void 0:o.id,newValues:{status:"paid",paid_at:n.payment_date},metadata:{notes:n.notes}};case"STOCK_ADJUSTED":return{recordId:(l=n.material)==null?void 0:l.id,metadata:{adjustment:n.adjustment,reason:n.reason,reference:n.reference}};default:return{recordId:n.id||((c=n.quote)==null?void 0:c.id)||((d=n.project)==null?void 0:d.id)||((u=n.invoice)==null?void 0:u.id),metadata:{event_data:n}}}}mapEventToAuditAction(e){return{QUOTE_SENT:"STATUS_CHANGE",QUOTE_ACCEPTED:"STATUS_CHANGE",QUOTE_REJECTED:"STATUS_CHANGE",ORDER_STARTED:"STATUS_CHANGE",ORDER_COMPLETED:"STATUS_CHANGE",ORDER_CANCELLED:"STATUS_CHANGE",PROJECT_STATUS_CHANGED:"STATUS_CHANGE",INVOICE_SENT:"STATUS_CHANGE",INVOICE_PAID:"STATUS_CHANGE",TIMESHEET_APPROVED:"UPDATE",STOCK_ADJUSTED:"UPDATE",DOCUMENT_UPLOADED:"INSERT",DOCUMENT_DELETED:"DELETE"}[e]||"UPDATE"}extractTableName(e){return e.startsWith("QUOTE_")?"quotes":e.startsWith("ORDER_")?"orders":e.startsWith("PROJECT_")?"projects":e.startsWith("INVOICE_")?"invoices":e.startsWith("TIMESHEET_")?"timesheets":e.startsWith("MATERIAL_")||e.startsWith("STOCK_")?"materials":e.startsWith("DOCUMENT_")?"documents":"unknown"}async triggerWorkflowAutomations(e,n){try{switch(e){case"QUOTE_ACCEPTED":await this.sendNotification("quote_accepted",n);break;case"ORDER_COMPLETED":await this.autoCreateInvoice(n);break;case"INVOICE_SENT":await this.schedulePaymentReminders(n);break;case"MATERIAL_LOW_STOCK":await this.sendLowStockAlert(n);break;case"PROJECT_STATUS_CHANGED":await this.notifyProjectTeam(n);break;default:break}}catch(s){console.error(`Workflow automation error for ${e}:`,s)}}async sendNotification(e,n){console.log(`Notification: ${e}`,n)}async autoCreateInvoice(e){e.order&&console.log("Auto-creating invoice for order:",e.order.id)}async schedulePaymentReminders(e){e.invoice&&console.log("Scheduling payment reminders for invoice:",e.invoice.id)}async sendLowStockAlert(e){e.material&&console.log("Low stock alert for material:",e.material.name)}async notifyProjectTeam(e){e.project&&console.log("Notifying project team of status change:",e.project.name)}}const Ve=new az;Ve.on("SYSTEM_ERROR",t=>{console.error("System error:",t)});Ve.on("USER_LOGIN",t=>{console.log("User logged in:",t.user_id)});Ve.on("USER_LOGOUT",t=>{console.log("User logged out:",t.user_id)});class iz{static async getOrders(e,n){return ke(async()=>{let s=$.from("orders").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          ),
          projects (
            name,
            status
          )
        `,{count:"exact"});if(n!=null&&n.status&&(s=s.eq("status",n.status)),n!=null&&n.customer_id&&(s=s.eq("customer_id",n.customer_id)),n!=null&&n.search&&(s=s.or(`title.ilike.%${n.search}%,description.ilike.%${n.search}%,order_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else s=s.order("created_at",{ascending:!1});const{data:a,count:i}=await Ue(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get orders")}static async getOrder(e){return ke(async()=>{const n=$.from("orders").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          ),
          quotes (
            quote_number,
            title
          ),
          projects (
            name,
            status,
            start_date,
            end_date
          )
        `).eq("id",e);return Ue(n).executeSingle()},`Get order ${e}`)}static async createOrder(e){return ke(async()=>{var u,h;const n=Ur(ow,e),a=(((u=n.body)==null?void 0:u.items)||[]).reduce((m,p)=>m+p.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),l={...n,total_amount:o,status:"open"},c=$.from("orders").insert(l).select().single(),d=await Ue(c).executeSingle();return Ve.emit("ORDER_CREATED",{order:d,user_id:(h=(await $.auth.getUser()).data.user)==null?void 0:h.id}),d},"Create order")}static async createOrderFromQuote(e){return ke(async()=>{var a;if(e.status!=="accepted")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur akzeptierte Angebote können in Aufträge umgewandelt werden.",{quoteStatus:e.status});const n={customer_id:e.customer_id,quote_id:e.id,title:e.title,description:e.description,body:e.body,tax_rate:e.tax_rate,expected_delivery_date:e.valid_until||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]},s=await this.createOrder(n);return Ve.emit("ORDER_CREATED_FROM_QUOTE",{order:s,quote:e,user_id:(a=(await $.auth.getUser()).data.user)==null?void 0:a.id}),s},`Create order from quote ${e.id}`)}static async updateOrder(e,n){return ke(async()=>{var l,c;const s=await this.getOrder(e);if(s.status==="completed")throw new Be(ze.IMMUTABLE_RECORD,"Abgeschlossene Aufträge können nicht mehr bearbeitet werden.",{currentStatus:s.status});if(s.status==="in_progress"&&n.order_number)throw new Be(ze.IMMUTABLE_RECORD,"Auftragsnummer kann nach dem Start nicht mehr geändert werden.",{currentStatus:s.status});const a=Ur(Z7,n);if((l=a.body)!=null&&l.items){const u=a.body.items.reduce((m,p)=>m+p.total_price,0),h=a.tax_rate||s.tax_rate||19;a.total_amount=u*(1+h/100)}const i=$.from("orders").update(a).eq("id",e).select().single(),o=await Ue(i).executeSingle();return Ve.emit("ORDER_UPDATED",{order:o,previous_order:s,changes:a,user_id:(c=(await $.auth.getUser()).data.user)==null?void 0:c.id}),o},`Update order ${e}`)}static async startOrder(e){return ke(async()=>{var o;const n=await this.getOrder(e);if(n.status!=="open")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur offene Aufträge können gestartet werden.",{currentStatus:n.status});const s={status:"in_progress",started_at:new Date().toISOString()},a=$.from("orders").update(s).eq("id",e).select().single(),i=await Ue(a).executeSingle();if(!i.project_id){const l={name:i.title,description:i.description,customer_id:i.customer_id,order_id:i.id,status:"active",start_date:new Date().toISOString().split("T")[0],budget:i.total_amount},{data:c}=await $.from("projects").insert(l).select().single();await $.from("orders").update({project_id:c==null?void 0:c.id}).eq("id",e)}return Ve.emit("ORDER_STARTED",{order:i,user_id:(o=(await $.auth.getUser()).data.user)==null?void 0:o.id}),i},`Start order ${e}`)}static async completeOrder(e){return ke(async()=>{var o;const n=await this.getOrder(e);if(n.status!=="in_progress")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur laufende Aufträge können abgeschlossen werden.",{currentStatus:n.status});const s={status:"completed",completed_at:new Date().toISOString()},a=$.from("orders").update(s).eq("id",e).select().single(),i=await Ue(a).executeSingle();return i.project_id&&await $.from("projects").update({status:"completed",end_date:new Date().toISOString().split("T")[0]}).eq("id",i.project_id),Ve.emit("ORDER_COMPLETED",{order:i,user_id:(o=(await $.auth.getUser()).data.user)==null?void 0:o.id}),i},`Complete order ${e}`)}static async cancelOrder(e,n){return ke(async()=>{var l;const s=await this.getOrder(e);if(s.status==="completed")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Abgeschlossene Aufträge können nicht storniert werden.",{currentStatus:s.status});const a={status:"cancelled",description:n?`${s.description||""}

Stornierungsgrund: ${n}`.trim():s.description},i=$.from("orders").update(a).eq("id",e).select().single(),o=await Ue(i).executeSingle();return o.project_id&&await $.from("projects").update({status:"cancelled"}).eq("id",o.project_id),Ve.emit("ORDER_CANCELLED",{order:o,reason:n,user_id:(l=(await $.auth.getUser()).data.user)==null?void 0:l.id}),o},`Cancel order ${e}`)}static async getOrderStats(){return ke(async()=>{const e=$.from("orders").select("status, total_amount, created_at, completed_at"),n=await Ue(e).execute(),s={total:n.length,by_status:{open:0,in_progress:0,completed:0,cancelled:0},total_value:{open:0,in_progress:0,completed:0,cancelled:0},avg_completion_time:0};let a=0,i=0;return n.forEach(o=>{if(s.by_status[o.status]++,s.total_value[o.status]+=o.total_amount||0,o.status==="completed"&&o.completed_at){const l=new Date(o.completed_at).getTime()-new Date(o.created_at).getTime();a+=l/(1e3*60*60*24),i++}}),i>0&&(s.avg_completion_time=a/i),s},"Get order statistics")}static async deleteOrder(e){return ke(async()=>{var a;const n=await this.getOrder(e);if(n.status!=="open")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur offene Aufträge können gelöscht werden.",{currentStatus:n.status});if(n.project_id)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Aufträge mit verknüpften Projekten können nicht gelöscht werden.",{projectId:n.project_id});const{error:s}=await $.from("orders").delete().eq("id",e);if(s)throw s;Ve.emit("ORDER_DELETED",{order:n,user_id:(a=(await $.auth.getUser()).data.user)==null?void 0:a.id})},`Delete order ${e}`)}static async duplicateOrder(e){return ke(async()=>{const n=await this.getOrder(e),s={customer_id:n.customer_id,title:`${n.title} (Kopie)`,description:n.description,body:n.body,tax_rate:n.tax_rate,expected_delivery_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]};return this.createOrder(s)},`Duplicate order ${e}`)}}const oz=new iz;class lz{static async getQuotes(e,n){return ke(async()=>{let s=$.from("quotes").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          )
        `,{count:"exact"});if(n!=null&&n.status&&(s=s.eq("status",n.status)),n!=null&&n.customer_id&&(s=s.eq("customer_id",n.customer_id)),n!=null&&n.search&&(s=s.or(`title.ilike.%${n.search}%,description.ilike.%${n.search}%,quote_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else s=s.order("created_at",{ascending:!1});const{data:a,count:i}=await Ue(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get quotes")}static async getQuote(e){return ke(async()=>{const n=$.from("quotes").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          )
        `).eq("id",e);return Ue(n).executeSingle()},`Get quote ${e}`)}static async createQuote(e){return ke(async()=>{var u,h;const n=Ur(iw,e),a=(((u=n.body)==null?void 0:u.items)||[]).reduce((m,p)=>m+p.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),l={...n,total_net:a,total_gross:o,status:"draft"},c=$.from("quotes").insert(l).select().single(),d=await Ue(c).executeSingle();return Ve.emit("QUOTE_CREATED",{quote:d,user_id:(h=(await $.auth.getUser()).data.user)==null?void 0:h.id}),d},"Create quote")}static async updateQuote(e,n){return ke(async()=>{var l,c;const s=await this.getQuote(e);if(s.status==="accepted")throw new Be(ze.IMMUTABLE_RECORD,"Akzeptierte Angebote können nicht mehr bearbeitet werden.",{currentStatus:s.status});if(s.status==="sent"&&n.quote_number)throw new Be(ze.IMMUTABLE_RECORD,"Angebotsnummer kann nach dem Versand nicht mehr geändert werden.",{currentStatus:s.status});const a=Ur(G7,n);if((l=a.body)!=null&&l.items){const u=a.body.items.reduce((m,p)=>m+p.total_price,0),h=a.tax_rate||s.tax_rate||19;a.total_net=u,a.total_gross=u*(1+h/100)}const i=$.from("quotes").update(a).eq("id",e).select().single(),o=await Ue(i).executeSingle();return Ve.emit("QUOTE_UPDATED",{quote:o,previous_quote:s,changes:a,user_id:(c=(await $.auth.getUser()).data.user)==null?void 0:c.id}),o},`Update quote ${e}`)}static async sendQuote(e){return ke(async()=>{var o,l;const n=await this.getQuote(e);if(n.status!=="draft")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können versendet werden.",{currentStatus:n.status});if(!((o=n.body)!=null&&o.items)||n.body.items.length===0)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Angebot muss mindestens eine Position enthalten.");if(!n.valid_until)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Gültigkeitsdatum ist erforderlich.");const s={status:"sent",sent_at:new Date().toISOString()},a=$.from("quotes").update(s).eq("id",e).select().single(),i=await Ue(a).executeSingle();return Ve.emit("QUOTE_SENT",{quote:i,user_id:(l=(await $.auth.getUser()).data.user)==null?void 0:l.id}),i},`Send quote ${e}`)}static async acceptQuote(e){return ke(async()=>{var l;const n=await this.getQuote(e);if(n.status!=="sent")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur versendete Angebote können angenommen werden.",{currentStatus:n.status});if(n.valid_until&&new Date(n.valid_until)<new Date)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Das Angebot ist bereits abgelaufen.",{validUntil:n.valid_until});const s={status:"accepted",accepted_at:new Date().toISOString()},a=$.from("quotes").update(s).eq("id",e).select().single(),i=await Ue(a).executeSingle(),o=await oz.createOrderFromQuote(i);return Ve.emit("QUOTE_ACCEPTED",{quote:i,order:o,user_id:(l=(await $.auth.getUser()).data.user)==null?void 0:l.id}),{quote:i,order:o}},`Accept quote ${e}`)}static async rejectQuote(e,n){return ke(async()=>{var l;const s=await this.getQuote(e);if(s.status!=="sent")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur versendete Angebote können abgelehnt werden.",{currentStatus:s.status});const a={status:"rejected",description:n?`${s.description||""}

Ablehnungsgrund: ${n}`.trim():s.description},i=$.from("quotes").update(a).eq("id",e).select().single(),o=await Ue(i).executeSingle();return Ve.emit("QUOTE_REJECTED",{quote:o,reason:n,user_id:(l=(await $.auth.getUser()).data.user)==null?void 0:l.id}),o},`Reject quote ${e}`)}static async getQuoteStats(){return ke(async()=>{const e=$.from("quotes").select("status, total_gross"),n=await Ue(e).execute(),s={total:n.length,by_status:{draft:0,sent:0,accepted:0,rejected:0,expired:0},total_value:{draft:0,sent:0,accepted:0,rejected:0,expired:0},conversion_rate:0};n.forEach(i=>{s.by_status[i.status]++,s.total_value[i.status]+=i.total_gross||0});const a=s.by_status.sent+s.by_status.accepted+s.by_status.rejected;return a>0&&(s.conversion_rate=s.by_status.accepted/a*100),s},"Get quote statistics")}static async deleteQuote(e){return ke(async()=>{var a;const n=await this.getQuote(e);if(n.status!=="draft")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können gelöscht werden.",{currentStatus:n.status});const{error:s}=await $.from("quotes").delete().eq("id",e);if(s)throw s;Ve.emit("QUOTE_DELETED",{quote:n,user_id:(a=(await $.auth.getUser()).data.user)==null?void 0:a.id})},`Delete quote ${e}`)}static async duplicateQuote(e){return ke(async()=>{const n=await this.getQuote(e),s={customer_id:n.customer_id,title:`${n.title} (Kopie)`,description:n.description,body:n.body,tax_rate:n.tax_rate,valid_until:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]};return this.createQuote(s)},`Duplicate quote ${e}`)}}const V0=new lz;class iA{static async getProjects(e,n){return ke(async()=>{let s=$.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          )
        `,{count:"exact"});if(n!=null&&n.status&&(s=s.eq("status",n.status)),n!=null&&n.customer_id&&(s=s.eq("customer_id",n.customer_id)),n!=null&&n.employee_id&&(s=s.contains("assigned_employees",[n.employee_id])),n!=null&&n.search&&(s=s.or(`name.ilike.%${n.search}%,description.ilike.%${n.search}%,project_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else s=s.order("created_at",{ascending:!1});const{data:a,count:i}=await Ue(s).executeWithCount();return console.log("ProjectService.getProjects:",{query:s.toString(),data:a,count:i,pagination:e,filters:n}),{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get projects")}static async getProject(e){return ke(async()=>{const n=$.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          )
        `).eq("id",e);return Ue(n).executeSingle()},`Get project ${e}`)}static async createProject(e){return ke(async()=>{var o;const n=Ur(lw,e),s={...n,status:"planned",assigned_employees:n.assigned_employees||[]},a=$.from("projects").insert(s).select().single(),i=await Ue(a).executeSingle();return Ve.emit("PROJECT_CREATED",{project:i,user_id:(o=(await $.auth.getUser()).data.user)==null?void 0:o.id}),i},"Create project")}static async updateProject(e,n){return ke(async()=>{var l,c;const s=await this.getProject(e);if(s.status==="completed"&&n.status!=="completed")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Abgeschlossene Projekte können nicht wieder aktiviert werden.",{currentStatus:s.status});const a=Ur(Q7,n);a.status&&a.status!==s.status&&(await this.validateStatusTransition(s.status,a.status),a.status==="active"&&!s.start_date?a.start_date=new Date().toISOString().split("T")[0]:a.status==="completed"&&!a.end_date&&(a.end_date=new Date().toISOString().split("T")[0]));const i=$.from("projects").update(a).eq("id",e).select().single(),o=await Ue(i).executeSingle();return a.status&&a.status!==s.status&&Ve.emit("PROJECT_STATUS_CHANGED",{project:o,previous_status:s.status,new_status:a.status,user_id:(l=(await $.auth.getUser()).data.user)==null?void 0:l.id}),Ve.emit("PROJECT_UPDATED",{project:o,previous_project:s,changes:a,user_id:(c=(await $.auth.getUser()).data.user)==null?void 0:c.id}),o},`Update project ${e}`)}static async validateStatusTransition(e,n){const s={planned:["active","cancelled"],active:["blocked","completed","cancelled"],blocked:["active","cancelled"],completed:[],cancelled:[]};if(!s[e].includes(n))throw new Be(ze.BUSINESS_RULE_VIOLATION,`Ungültiger Statuswechsel von "${e}" zu "${n}".`,{from:e,to:n,validTransitions:s[e]})}static async startProject(e){return ke(async()=>{const n=await this.getProject(e);if(n.status!=="planned")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur geplante Projekte können gestartet werden.",{currentStatus:n.status});const s={status:"active",start_date:new Date().toISOString().split("T")[0]};return this.updateProject(e,s)},`Start project ${e}`)}static async completeProject(e){return ke(async()=>{const n=await this.getProject(e);if(n.status!=="active")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur aktive Projekte können abgeschlossen werden.",{currentStatus:n.status});const s={status:"completed",end_date:new Date().toISOString().split("T")[0]};return this.updateProject(e,s)},`Complete project ${e}`)}static async blockProject(e,n){return ke(async()=>{const s=await this.getProject(e);if(s.status!=="active")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur aktive Projekte können blockiert werden.",{currentStatus:s.status});const a={status:"blocked",description:n?`${s.description||""}

Blockiert: ${n}`.trim():s.description};return this.updateProject(e,a)},`Block project ${e}`)}static async unblockProject(e){return ke(async()=>{const n=await this.getProject(e);if(n.status!=="blocked")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur blockierte Projekte können entsperrt werden.",{currentStatus:n.status});const s={status:"active"};return this.updateProject(e,s)},`Unblock project ${e}`)}static async cancelProject(e,n){return ke(async()=>{const s=await this.getProject(e);if(s.status==="completed")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Abgeschlossene Projekte können nicht storniert werden.",{currentStatus:s.status});const a={status:"cancelled",description:n?`${s.description||""}

Storniert: ${n}`.trim():s.description};return this.updateProject(e,a)},`Cancel project ${e}`)}static async getProjectStats(e){return ke(async()=>{var b;const n=await this.getProject(e),{data:s}=await $.from("timesheets").select("hours, hourly_rate").eq("project_id",e),{data:a}=await $.from("materials").select("quantity, unit_cost").eq("project_id",e),{data:i}=await $.from("expenses").select("amount").eq("project_id",e),o=(s==null?void 0:s.reduce((x,g)=>x+(g.hours||0),0))||0,l=(a==null?void 0:a.reduce((x,g)=>x+(g.quantity*g.unit_cost||0),0))||0,c=(i==null?void 0:i.reduce((x,g)=>x+(g.amount||0),0))||0,u=l+c,h=Math.max(0,(n.budget||0)-u);let m=0;if(n.start_date){const x=new Date(n.start_date),g=n.end_date?new Date(n.end_date):new Date;m=Math.ceil((g.getTime()-x.getTime())/(1e3*60*60*24))}const p={planned:0,active:50,blocked:50,completed:100,cancelled:0}[n.status];return{total_hours:o,total_material_cost:l,total_expenses:c,budget_used:u,budget_remaining:h,days_active:m,team_size:((b=n.assigned_employees)==null?void 0:b.length)||0,completion_percentage:p}},`Get project stats ${e}`)}static async getProjectTimeline(e,n=50){return ke(async()=>{const{data:s}=await $.from("timesheets").select(`
          id, date, hours, description, created_at,
          employees (name)
        `).eq("project_id",e).order("created_at",{ascending:!1}).limit(n/2),{data:a}=await $.from("materials").select(`
          id, name, quantity, unit_cost, created_at,
          employees (name)
        `).eq("project_id",e).order("created_at",{ascending:!1}).limit(n/2);return[...(s==null?void 0:s.map(o=>{var l;return{id:o.id,type:"timesheet",title:`Arbeitszeit erfasst: ${o.hours}h`,description:o.description,user:((l=o.employees)==null?void 0:l.name)||"Unbekannt",timestamp:o.created_at}}))||[],...(a==null?void 0:a.map(o=>{var l;return{id:o.id,type:"material",title:`Material hinzugefügt: ${o.name}`,description:`${o.quantity} × ${o.unit_cost}€`,user:((l=o.employees)==null?void 0:l.name)||"Unbekannt",timestamp:o.created_at}}))||[]].sort((o,l)=>new Date(l.timestamp).getTime()-new Date(o.timestamp).getTime()).slice(0,n)},`Get project timeline ${e}`)}static async assignEmployee(e,n){return ke(async()=>{const a=(await this.getProject(e)).assigned_employees||[];if(a.includes(n))throw new Be(ze.BUSINESS_RULE_VIOLATION,"Mitarbeiter ist bereits dem Projekt zugewiesen.",{employeeId:n});const i=[...a,n];return this.updateProject(e,{assigned_employees:i})},`Assign employee to project ${e}`)}static async removeEmployee(e,n){return ke(async()=>{const i=((await this.getProject(e)).assigned_employees||[]).filter(o=>o!==n);return this.updateProject(e,{assigned_employees:i})},`Remove employee from project ${e}`)}static async deleteProject(e){return ke(async()=>{var i;const n=await this.getProject(e);if(!["planned","cancelled"].includes(n.status))throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur geplante oder stornierte Projekte können gelöscht werden.",{currentStatus:n.status});const{data:s}=await $.from("timesheets").select("id").eq("project_id",e).limit(1);if(s&&s.length>0)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Projekt kann nicht gelöscht werden, da bereits Arbeitszeiten erfasst wurden.");const{error:a}=await $.from("projects").delete().eq("id",e);if(a)throw a;Ve.emit("PROJECT_DELETED",{project:n,user_id:(i=(await $.auth.getUser()).data.user)==null?void 0:i.id})},`Delete project ${e}`)}static async searchProjects(e,n=10){return ke(async()=>{const s=$.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person
          )
        `).or(`name.ilike.%${e}%,description.ilike.%${e}%,project_number.ilike.%${e}%`).order("name").limit(n);return Ue(s).execute()},`Search projects: ${e}`)}}class cz{static async getTimesheets(e,n){return ke(async()=>{let s=$.from("timesheets").select(`
          *,
          projects (
            name,
            project_number
          ),
          employees (
            name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.project_id&&(s=s.eq("project_id",n.project_id)),n!=null&&n.employee_id&&(s=s.eq("employee_id",n.employee_id)),n!=null&&n.date_from&&(s=s.gte("date",n.date_from)),n!=null&&n.date_to&&(s=s.lte("date",n.date_to)),(n==null?void 0:n.approved)!==void 0&&(n.approved?s=s.not("approved_at","is",null):s=s.is("approved_at",null)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"date",{ascending:e.sort_order==="asc"})}else s=s.order("date",{ascending:!1});const{data:a,count:i}=await Ue(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get timesheets")}static async getTimesheet(e){return ke(async()=>{const n=$.from("timesheets").select(`
          *,
          projects (
            name,
            project_number,
            status
          ),
          employees (
            name,
            email,
            hourly_rate
          )
        `).eq("id",e);return Ue(n).executeSingle()},`Get timesheet ${e}`)}static async createTimesheet(e){return ke(async()=>{var i;const n=Ur(dw,e);if(!n.hourly_rate&&n.employee_id){const{data:o}=await $.from("employees").select("hourly_rate").eq("id",n.employee_id).single();o!=null&&o.hourly_rate&&(n.hourly_rate=o.hourly_rate)}n.hours&&n.hourly_rate&&(n.total_cost=n.hours*n.hourly_rate),await this.validateTimesheetEntry(n);const s=$.from("timesheets").insert(n).select().single(),a=await Ue(s).executeSingle();return Ve.emit("TIMESHEET_CREATED",{timesheet:a,user_id:(i=(await $.auth.getUser()).data.user)==null?void 0:i.id}),a},"Create timesheet")}static async updateTimesheet(e,n){return ke(async()=>{var d;const s=await this.getTimesheet(e);if(s.approved_at)throw new Be(ze.IMMUTABLE_RECORD,"Genehmigte Zeiteinträge können nicht mehr bearbeitet werden.",{approvedAt:s.approved_at});const a=await bs();if(s.employee_id!==a.id&&!a.is_admin)throw new Be(ze.UNAUTHORIZED,"Sie können nur Ihre eigenen Zeiteinträge bearbeiten.");const i=Ur(J7,n);if(i.hours||i.hourly_rate){const u=i.hours||s.hours,h=i.hourly_rate||s.hourly_rate;u&&h&&(i.total_cost=u*h)}const o={...s,...i};await this.validateTimesheetEntry(o);const l=$.from("timesheets").update(i).eq("id",e).select().single(),c=await Ue(l).executeSingle();return Ve.emit("TIMESHEET_UPDATED",{timesheet:c,previous_timesheet:s,changes:i,user_id:(d=(await $.auth.getUser()).data.user)==null?void 0:d.id}),c},`Update timesheet ${e}`)}static async approveTimesheet(e){return ke(async()=>{const n=await this.getTimesheet(e);if(n.approved_at)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Zeiteintrag ist bereits genehmigt.",{approvedAt:n.approved_at});const s=await bs();if(!s.is_admin&&!s.is_project_manager)throw new Be(ze.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge genehmigen.");const a={approved_at:new Date().toISOString(),approved_by:s.id},i=$.from("timesheets").update(a).eq("id",e).select().single(),o=await Ue(i).executeSingle();return Ve.emit("TIMESHEET_APPROVED",{timesheet:o,approved_by:s.id,user_id:s.id}),o},`Approve timesheet ${e}`)}static async rejectTimesheet(e,n){return ke(async()=>{const s=await this.getTimesheet(e),a=await bs();if(!a.is_admin&&!a.is_project_manager)throw new Be(ze.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge ablehnen.");const i={approved_at:null,approved_by:null,description:n?`${s.description||""}

Abgelehnt: ${n}`.trim():s.description},o=$.from("timesheets").update(i).eq("id",e).select().single(),l=await Ue(o).executeSingle();return Ve.emit("TIMESHEET_REJECTED",{timesheet:l,reason:n,rejected_by:a.id,user_id:a.id}),l},`Reject timesheet ${e}`)}static async validateTimesheetEntry(e){if(e.employee_id&&e.date&&e.start_time&&e.end_time){const{data:n}=await $.from("timesheets").select("id").eq("employee_id",e.employee_id).eq("date",e.date).neq("id",e.id||"").or(`start_time.lte.${e.start_time}.and.end_time.gt.${e.start_time},start_time.lt.${e.end_time}.and.end_time.gte.${e.end_time}`);if(n&&n.length>0)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Überschneidende Arbeitszeiten am selben Tag sind nicht erlaubt.")}if(e.hours&&e.hours>12)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Maximale Arbeitszeit von 12 Stunden pro Tag überschritten.",{hours:e.hours});if(e.date&&new Date(e.date)>new Date)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Zeiteinträge für zukünftige Daten sind nicht erlaubt.");if(e.project_id){const{data:n}=await $.from("projects").select("status").eq("id",e.project_id).single();if(n&&!["active","blocked"].includes(n.status))throw new Be(ze.BUSINESS_RULE_VIOLATION,"Zeiteinträge können nur für aktive oder blockierte Projekte erfasst werden.",{projectStatus:n.status})}}static async getEmployeeTimesheetStats(e,n,s){return ke(async()=>{let a=$.from("timesheets").select("hours, total_cost, approved_at, overtime_hours").eq("employee_id",e);n&&(a=a.gte("date",n)),s&&(a=a.lte("date",s));const i=await Ue(a).execute(),o=i.reduce((c,d)=>{const u=d.hours||0,h=d.total_cost||0,m=d.overtime_hours||0;return c.total_hours+=u,c.total_cost+=h,c.overtime_hours+=m,d.approved_at?c.approved_hours+=u:c.pending_hours+=u,c},{total_hours:0,total_cost:0,approved_hours:0,pending_hours:0,days_worked:0,avg_hours_per_day:0,overtime_hours:0}),l=new Set(i.map(c=>c.date));return o.days_worked=l.size,o.days_worked>0&&(o.avg_hours_per_day=o.total_hours/o.days_worked),o},`Get employee timesheet stats ${e}`)}static async getProjectTimesheetSummary(e){return ke(async()=>{const n=$.from("timesheets").select(`
          hours,
          total_cost,
          date,
          employee_id,
          employees (
            name
          )
        `).eq("project_id",e),s=await Ue(n).execute(),a=s.reduce((c,d)=>c+(d.hours||0),0),i=s.reduce((c,d)=>c+(d.total_cost||0),0),o=s.reduce((c,d)=>{var h;const u=d.employee_id;return c[u]||(c[u]={employee_id:u,employee_name:((h=d.employees)==null?void 0:h.name)||"Unbekannt",hours:0,cost:0}),c[u].hours+=d.hours||0,c[u].cost+=d.total_cost||0,c},{}),l=s.reduce((c,d)=>{const u=d.date;return c[u]||(c[u]={date:u,hours:0,cost:0}),c[u].hours+=d.hours||0,c[u].cost+=d.total_cost||0,c},{});return{total_hours:a,total_cost:i,by_employee:Object.values(o),by_date:Object.values(l).sort((c,d)=>c.date.localeCompare(d.date))}},`Get project timesheet summary ${e}`)}static async deleteTimesheet(e){return ke(async()=>{const n=await this.getTimesheet(e);if(n.approved_at)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Genehmigte Zeiteinträge können nicht gelöscht werden.",{approvedAt:n.approved_at});const s=await bs();if(n.employee_id!==s.id&&!s.is_admin)throw new Be(ze.UNAUTHORIZED,"Sie können nur Ihre eigenen Zeiteinträge löschen.");const{error:a}=await $.from("timesheets").delete().eq("id",e);if(a)throw a;Ve.emit("TIMESHEET_DELETED",{timesheet:n,user_id:s.id})},`Delete timesheet ${e}`)}static async bulkApproveTimesheets(e){return ke(async()=>{const n=await bs();if(!n.is_admin&&!n.is_project_manager)throw new Be(ze.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge genehmigen.");const s={approved_at:new Date().toISOString(),approved_by:n.id},a=$.from("timesheets").update(s).in("id",e).is("approved_at",null).select(),i=await Ue(a).execute();return i.forEach(o=>{Ve.emit("TIMESHEET_APPROVED",{timesheet:o,approved_by:n.id,user_id:n.id})}),i},"Bulk approve timesheets")}}const hw=new cz;class dz{static async getInvoices(e,n){return ke(async()=>{let s=$.from("invoices").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          ),
          projects (
            name,
            project_number
          )
        `,{count:"exact"});if(n!=null&&n.status&&(s=s.eq("status",n.status)),n!=null&&n.customer_id&&(s=s.eq("customer_id",n.customer_id)),n!=null&&n.project_id&&(s=s.eq("project_id",n.project_id)),n!=null&&n.overdue&&(s=s.eq("status","sent").lt("due_date",new Date().toISOString().split("T")[0])),n!=null&&n.date_from&&(s=s.gte("invoice_date",n.date_from)),n!=null&&n.date_to&&(s=s.lte("invoice_date",n.date_to)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else s=s.order("created_at",{ascending:!1});const{data:a,count:i}=await Ue(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get invoices")}static async getInvoice(e){return ke(async()=>{const n=$.from("invoices").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          ),
          projects (
            name,
            project_number,
            status
          )
        `).eq("id",e);return Ue(n).executeSingle()},`Get invoice ${e}`)}static async createInvoice(e){return ke(async()=>{var u,h;const n=Ur(cw,e),a=(((u=n.body)==null?void 0:u.items)||[]).reduce((m,p)=>m+p.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),l={...n,total_net:a,total_gross:o,amount:o,status:"draft",due_date:n.due_date||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]},c=$.from("invoices").insert(l).select().single(),d=await Ue(c).executeSingle();return Ve.emit("INVOICE_CREATED",{invoice:d,user_id:(h=(await $.auth.getUser()).data.user)==null?void 0:h.id}),d},"Create invoice")}static async updateInvoice(e,n){return ke(async()=>{var l,c;const s=await this.getInvoice(e);if(s.status==="paid")throw new Be(ze.IMMUTABLE_RECORD,"Bezahlte Rechnungen können nicht mehr bearbeitet werden.",{currentStatus:s.status});if(s.status==="sent"&&n.invoice_number)throw new Be(ze.IMMUTABLE_RECORD,"Rechnungsnummer kann nach dem Versand nicht mehr geändert werden.",{currentStatus:s.status});const a=Ur(Y7,n);if((l=a.body)!=null&&l.items){const u=a.body.items.reduce((m,p)=>m+p.total_price,0),h=a.tax_rate||s.tax_rate||19;a.total_net=u,a.total_gross=u*(1+h/100),a.amount=a.total_gross}const i=$.from("invoices").update(a).eq("id",e).select().single(),o=await Ue(i).executeSingle();return Ve.emit("INVOICE_UPDATED",{invoice:o,previous_invoice:s,changes:a,user_id:(c=(await $.auth.getUser()).data.user)==null?void 0:c.id}),o},`Update invoice ${e}`)}static async sendInvoice(e){return ke(async()=>{var o,l;const n=await this.getInvoice(e);if(n.status!=="draft")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können versendet werden.",{currentStatus:n.status});if(!((o=n.body)!=null&&o.items)||n.body.items.length===0)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Rechnung muss mindestens eine Position enthalten.");const s={status:"sent",sent_at:new Date().toISOString()},a=$.from("invoices").update(s).eq("id",e).select().single(),i=await Ue(a).executeSingle();return Ve.emit("INVOICE_SENT",{invoice:i,user_id:(l=(await $.auth.getUser()).data.user)==null?void 0:l.id}),i},`Send invoice ${e}`)}static async markInvoicePaid(e,n,s){return ke(async()=>{var c;const a=await this.getInvoice(e);if(a.status!=="sent")throw new Be(ze.BUSINESS_RULE_VIOLATION,"Nur versendete Rechnungen können als bezahlt markiert werden.",{currentStatus:a.status});const i={status:"paid",paid_at:n||new Date().toISOString(),notes:s?`${a.notes||""}

Zahlung: ${s}`.trim():a.notes},o=$.from("invoices").update(i).eq("id",e).select().single(),l=await Ue(o).executeSingle();return Ve.emit("INVOICE_PAID",{invoice:l,payment_date:n,notes:s,user_id:(c=(await $.auth.getUser()).data.user)==null?void 0:c.id}),l},`Mark invoice paid ${e}`)}static async getExpenses(e,n){return ke(async()=>{let s=$.from("expenses").select(`
          *,
          projects (
            name,
            project_number
          ),
          employees (
            name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.category&&(s=s.eq("category",n.category)),n!=null&&n.project_id&&(s=s.eq("project_id",n.project_id)),n!=null&&n.employee_id&&(s=s.eq("employee_id",n.employee_id)),n!=null&&n.date_from&&(s=s.gte("expense_date",n.date_from)),n!=null&&n.date_to&&(s=s.lte("expense_date",n.date_to)),(n==null?void 0:n.approved)!==void 0&&(n.approved?s=s.not("approved_at","is",null):s=s.is("approved_at",null)),e){const o=(e.page-1)*e.limit;s=s.range(o,o+e.limit-1).order(e.sort_by||"expense_date",{ascending:e.sort_order==="asc"})}else s=s.order("expense_date",{ascending:!1});const{data:a,count:i}=await Ue(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get expenses")}static async createExpense(e){return ke(async()=>{var i;const n=Ur(uw,e),s=$.from("expenses").insert(n).select().single(),a=await Ue(s).executeSingle();return Ve.emit("EXPENSE_CREATED",{expense:a,user_id:(i=(await $.auth.getUser()).data.user)==null?void 0:i.id}),a},"Create expense")}static async approveExpense(e){return ke(async()=>{const n=await bs();if(!n.is_admin&&!n.is_project_manager)throw new Be(ze.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Ausgaben genehmigen.");const s={approved_at:new Date().toISOString(),approved_by:n.id},a=$.from("expenses").update(s).eq("id",e).select().single(),i=await Ue(a).executeSingle();return Ve.emit("EXPENSE_APPROVED",{expense:i,approved_by:n.id,user_id:n.id}),i},`Approve expense ${e}`)}static async getFinancialKPIs(e){return ke(async()=>{const n=new Date,s=new Date(n.getFullYear(),n.getMonth(),1).toISOString().split("T")[0],a=new Date(n.getFullYear(),n.getMonth()-1,1).toISOString().split("T")[0],i=new Date(n.getFullYear(),n.getMonth(),0).toISOString().split("T")[0],o=$.from("invoices").select("amount, status, invoice_date, paid_at"),l=await Ue(o).execute(),c=$.from("expenses").select("amount, expense_date, approved_at"),d=await Ue(c).execute(),u=l.filter(k=>k.status==="paid").reduce((k,E)=>k+(E.amount||0),0),h=l.filter(k=>k.status==="paid"&&k.paid_at&&k.paid_at>=s).reduce((k,E)=>k+(E.amount||0),0),m=l.filter(k=>k.status==="paid"&&k.paid_at&&k.paid_at>=a&&k.paid_at<=i).reduce((k,E)=>k+(E.amount||0),0),p=m>0?(h-m)/m*100:0,b=d.filter(k=>k.approved_at).reduce((k,E)=>k+(E.amount||0),0),x=d.filter(k=>k.approved_at&&k.expense_date>=s).reduce((k,E)=>k+(E.amount||0),0),g=d.filter(k=>k.approved_at&&k.expense_date>=a&&k.expense_date<=i).reduce((k,E)=>k+(E.amount||0),0),y=l.filter(k=>k.status==="sent"),v=y.filter(k=>k.due_date&&k.due_date<new Date().toISOString().split("T")[0]),w=y.reduce((k,E)=>k+(E.amount||0),0),j=v.reduce((k,E)=>k+(E.amount||0),0),S=h-x,N=h>0?S/h*100:0;return{revenue:{total:u,this_month:h,last_month:m,growth_rate:p},expenses:{total:b,this_month:x,last_month:g},profit:{total:u-b,this_month:S,margin:N},outstanding:{total:w,overdue:j,count:y.length},cash_flow:{inflow:h,outflow:x,net:h-x}}},"Get financial KPIs")}static async getRevenueByMonth(e=12){return ke(async()=>{const n=await Ue($.from("invoices").select("amount, status, paid_at").eq("status","paid").not("paid_at","is",null).gte("paid_at",new Date(Date.now()-e*30*24*60*60*1e3).toISOString())).execute(),s={};return n.forEach(a=>{if(a.paid_at){const i=a.paid_at.substring(0,7);s[i]||(s[i]={revenue:0,invoices:0}),s[i].revenue+=a.amount||0,s[i].invoices+=1}}),Object.entries(s).map(([a,i])=>({month:a,revenue:i.revenue,invoices:i.invoices})).sort((a,i)=>a.month.localeCompare(i.month))},"Get revenue by month")}static async getExpensesByCategory(e){return ke(async()=>{let n=$.from("expenses").select("category, amount").not("approved_at","is",null);e&&(n=n.gte("expense_date",e.from).lte("expense_date",e.to));const s=await Ue(n).execute(),a={};return s.forEach(i=>{const o=i.category||"Sonstige";a[o]||(a[o]={amount:0,count:0}),a[o].amount+=i.amount||0,a[o].count+=1}),Object.entries(a).map(([i,o])=>({category:i,amount:o.amount,count:o.count})).sort((i,o)=>o.amount-i.amount)},"Get expenses by category")}static async getProfitLossReport(e){return ke(async()=>{const s=(await Ue($.from("invoices").select("amount").eq("status","paid").gte("paid_at",e.from).lte("paid_at",e.to)).execute()).reduce((u,h)=>u+(h.amount||0),0),a=await Ue($.from("expenses").select("amount, category").not("approved_at","is",null).gte("expense_date",e.from).lte("expense_date",e.to)).execute(),i=a.filter(u=>["Material","Equipment","Subcontractor"].includes(u.category||"")).reduce((u,h)=>u+(h.amount||0),0),o=a.filter(u=>!["Material","Equipment","Subcontractor"].includes(u.category||"")).reduce((u,h)=>u+(h.amount||0),0),l=s-i,c=l-o,d=s>0?c/s*100:0;return{revenue:s,cost_of_goods:i,gross_profit:l,operating_expenses:o,net_profit:c,margin:d}},"Get profit/loss report")}}const K0=new dz;class uz{static async getDocuments(e,n){return ke(async()=>{var o;let s=$.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name,
            contact_person
          ),
          uploaded_by_user:profiles!uploaded_by (
            first_name,
            last_name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.category&&(s=s.eq("category",n.category)),n!=null&&n.legal_category&&(s=s.eq("legal_category",n.legal_category)),n!=null&&n.project_id&&(s=s.eq("project_id",n.project_id)),n!=null&&n.customer_id&&(s=s.eq("customer_id",n.customer_id)),n!=null&&n.uploaded_by&&(s=s.eq("uploaded_by",n.uploaded_by)),(o=n==null?void 0:n.tags)!=null&&o.length&&(s=s.overlaps("tags",n.tags)),n!=null&&n.date_from&&(s=s.gte("uploaded_at",n.date_from)),n!=null&&n.date_to&&(s=s.lte("uploaded_at",n.date_to)),n!=null&&n.search&&(s=s.or(`filename.ilike.%${n.search}%,original_filename.ilike.%${n.search}%,description.ilike.%${n.search}%`)),e){const l=(e.page-1)*e.limit;s=s.range(l,l+e.limit-1).order(e.sort_by||"uploaded_at",{ascending:e.sort_order==="asc"})}else s=s.order("uploaded_at",{ascending:!1});const{data:a,count:i}=await Ue(s).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get documents")}static async getDocument(e){return ke(async()=>{const n=$.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name,
            contact_person
          ),
          uploaded_by_user:profiles!uploaded_by (
            first_name,
            last_name,
            email
          )
        `).eq("id",e);return Ue(n).executeSingle()},`Get document ${e}`)}static async uploadDocument(e){return ke(async()=>{const n=await bs(),s=e.file;if(s.size>50*1024*1024)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Dateigröße darf 50MB nicht überschreiten.",{fileSize:s.size});const a=s.name.split(".").pop()||"",i=Date.now(),o=Math.random().toString(36).substring(2,15),l=`${i}_${o}.${a}`,d=`${this.getStorageFolder(e.category)}/${l}`,{data:u,error:h}=await $.storage.from("documents").upload(d,s,{cacheControl:"3600",upsert:!1});if(h)throw new Be(ze.STORAGE_ERROR,`Fehler beim Upload: ${h.message}`,{uploadError:h});let m;if(e.is_public){const{data:y}=$.storage.from("documents").getPublicUrl(d);m=y.publicUrl}let p;if(e.legal_category){const y=this.getRetentionPeriod(e.legal_category);p=new Date(Date.now()+y*365*24*60*60*1e3).toISOString().split("T")[0]}const b={filename:l,original_filename:s.name,file_size:s.size,mime_type:s.type,category:e.category,legal_category:e.legal_category,description:e.description,tags:e.tags||[],project_id:e.project_id,customer_id:e.customer_id,invoice_id:e.invoice_id,expense_id:e.expense_id,storage_path:d,public_url:m,is_public:e.is_public||!1,retention_until:p,uploaded_by:n.id,uploaded_at:new Date().toISOString()},x=$.from("documents").insert(b).select().single(),g=await Ue(x).executeSingle();return e.legal_category&&await $.from("immutable_files").insert({document_id:g.id,filename:g.filename,file_hash:await this.calculateFileHash(s),file_size:s.size,legal_category:e.legal_category,uploaded_by:n.id}),Ve.emit("DOCUMENT_UPLOADED",{document:g,user_id:n.id}),g},"Upload document")}static async updateDocument(e,n){return ke(async()=>{const s=await this.getDocument(e),a=await bs();if(s.uploaded_by!==a.id&&!a.is_admin)throw new Be(ze.UNAUTHORIZED,"Sie können nur Ihre eigenen Dokumente bearbeiten.");let i=s.retention_until;if(n.legal_category&&n.legal_category!==s.legal_category){const d=this.getRetentionPeriod(n.legal_category);i=new Date(Date.now()+d*365*24*60*60*1e3).toISOString().split("T")[0]}const o={...n,retention_until:i},l=$.from("documents").update(o).eq("id",e).select().single(),c=await Ue(l).executeSingle();return Ve.emit("DOCUMENT_UPDATED",{document:c,previous_document:s,changes:n,user_id:a.id}),c},`Update document ${e}`)}static async getDownloadUrl(e,n=3600){return ke(async()=>{const s=await this.getDocument(e),a=await bs();if(!s.is_public&&s.uploaded_by!==a.id&&!a.is_admin)throw new Be(ze.UNAUTHORIZED,"Keine Berechtigung zum Download dieses Dokuments.");const{data:i,error:o}=await $.storage.from("documents").createSignedUrl(s.storage_path,n);if(o||!i)throw new Be(ze.STORAGE_ERROR,"Fehler beim Generieren der Download-URL.",{error:o});return Ve.emit("DOCUMENT_DOWNLOADED",{document:s,user_id:a.id}),i.signedUrl},`Get download URL for document ${e}`)}static async deleteDocument(e){return ke(async()=>{const n=await this.getDocument(e),s=await bs();if(n.uploaded_by!==s.id&&!s.is_admin)throw new Be(ze.UNAUTHORIZED,"Sie können nur Ihre eigenen Dokumente löschen.");if(n.retention_until&&new Date(n.retention_until)>new Date)throw new Be(ze.BUSINESS_RULE_VIOLATION,"Dokument kann aufgrund gesetzlicher Aufbewahrungspflicht nicht gelöscht werden.",{retentionUntil:n.retention_until});const{error:a}=await $.storage.from("documents").remove([n.storage_path]);if(a)throw new Be(ze.STORAGE_ERROR,`Fehler beim Löschen der Datei: ${a.message}`,{storageError:a});const{error:i}=await $.from("documents").delete().eq("id",e);if(i)throw i;Ve.emit("DOCUMENT_DELETED",{document:n,user_id:s.id})},`Delete document ${e}`)}static async getDocumentStats(){return ke(async()=>(await Ue($.from("documents").select("*")).execute()).reduce((s,a)=>{if(s.total_documents++,s.total_size+=a.file_size,s.by_category[a.category]||(s.by_category[a.category]={count:0,size:0}),s.by_category[a.category].count++,s.by_category[a.category].size+=a.file_size,a.legal_category&&(s.by_legal_category[a.legal_category]||(s.by_legal_category[a.legal_category]={count:0,size:0}),s.by_legal_category[a.legal_category].count++,s.by_legal_category[a.legal_category].size+=a.file_size),a.retention_until){const i=new Date(a.retention_until),o=new Date(Date.now()+30*24*60*60*1e3);i<=o&&s.retention_expiring++}return s},{total_documents:0,total_size:0,by_category:{},by_legal_category:{},retention_expiring:0}),"Get document statistics")}static async searchDocuments(e,n=20){return ke(async()=>{const s=$.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name
          )
        `).or(`filename.ilike.%${e}%,original_filename.ilike.%${e}%,description.ilike.%${e}%`).order("uploaded_at",{ascending:!1}).limit(n);return Ue(s).execute()},`Search documents: ${e}`)}static async getExpiringDocuments(e=30){return ke(async()=>{const n=new Date(Date.now()+e*24*60*60*1e3).toISOString().split("T")[0],s=$.from("documents").select("*").not("retention_until","is",null).lte("retention_until",n).order("retention_until",{ascending:!0});return Ue(s).execute()},`Get expiring documents (${e} days)`)}static getStorageFolder(e){return{invoice:"invoices",contract:"contracts",receipt:"receipts",photo:"photos",plan:"plans",report:"reports",other:"other"}[e]||"other"}static getRetentionPeriod(e){return{invoice:10,contract:10,receipt:10,tax_document:10,correspondence:6}[e]||10}static async calculateFileHash(e){const n=await e.arrayBuffer(),s=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(s)).map(i=>i.toString(16).padStart(2,"0")).join("")}}const hz=new uz;var gd=(t=>(t[t.UNAUTHORIZED=401]="UNAUTHORIZED",t[t.FORBIDDEN=403]="FORBIDDEN",t[t.NOT_FOUND=404]="NOT_FOUND",t[t.VALIDATION_ERROR=422]="VALIDATION_ERROR",t[t.INTERNAL_ERROR=500]="INTERNAL_ERROR",t))(gd||{});class ji extends Error{constructor(e,n,s){super(e),this.code=n,this.details=s,this.name="ApiError"}}async function em(t,e){try{return await t()}catch(n){if(console.error(`API Error in ${e}:`,n),n instanceof ji)throw ft.error(`${e}: ${n.message}`),n;const s=n instanceof Error?n.message:"Unbekannter Fehler";throw ft.error(`${e}: ${s}`),new ji(s,500)}}async function lx(){const{data:{user:t},error:e}=await $.auth.getUser();if(e||!t)throw new ji("User not authenticated",401);const{data:n,error:s}=await $.from("profiles").select("*").eq("id",t.id).single();if(s)throw new ji("User profile not found",404,s.message);return{...t,profile:n}}_.string().uuid(),_.string().email(),_.string().min(1),_.number().min(0),_.number().min(0).max(100),_.string().datetime();_.object({project_id:_.string(),budget:_.number().optional(),date_range:_.object({from:_.string().optional(),to:_.string().optional()}).optional()});_.object({user_id:_.string().uuid(),type:_.enum(["budget_warning","budget_critical","invoice_overdue","project_deadline","time_approval_needed","material_low_stock","system_update","general"]),priority:_.enum(["low","medium","high","urgent"]),title:_.string().min(1).max(200),message:_.string().min(1).max(1e3),data:_.record(_.any()).optional(),expires_at:_.string().datetime().optional(),action_url:_.string().url().optional(),entity_type:_.string().optional(),entity_id:_.string().optional()});_.object({read:_.boolean().optional(),archived:_.boolean().optional()});_.object({entity_type:_.enum(["customer","invoice","quote","order","project","timesheet","material","expense","employee","document","payment"]),entity_id:_.string().min(1),action:_.enum(["CREATE","UPDATE","DELETE","VIEW","PRINT","EXPORT","SEND","APPROVE","REJECT","CANCEL","RESTORE"]),old_values:_.record(_.any()).nullable().optional(),new_values:_.record(_.any()).nullable().optional(),reason:_.string().nullable().optional(),is_automated:_.boolean().optional().default(!1)});var mz={exports:{}};function oA(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var cx={exports:{}};const fz={},pz=Object.freeze(Object.defineProperty({__proto__:null,default:fz},Symbol.toStringTag,{value:"Module"})),xz=J2(pz);var K1;function Tt(){return K1||(K1=1,function(t,e){(function(n,s){t.exports=s()})(et,function(){var n=n||function(s,a){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof et<"u"&&et.crypto&&(i=et.crypto),!i&&typeof oA=="function")try{i=xz}catch{}var o=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},l=Object.create||function(){function v(){}return function(w){var j;return v.prototype=w,j=new v,v.prototype=null,j}}(),c={},d=c.lib={},u=d.Base=function(){return{extend:function(v){var w=l(this);return v&&w.mixIn(v),(!w.hasOwnProperty("init")||this.init===w.init)&&(w.init=function(){w.$super.init.apply(this,arguments)}),w.init.prototype=w,w.$super=this,w},create:function(){var v=this.extend();return v.init.apply(v,arguments),v},init:function(){},mixIn:function(v){for(var w in v)v.hasOwnProperty(w)&&(this[w]=v[w]);v.hasOwnProperty("toString")&&(this.toString=v.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),h=d.WordArray=u.extend({init:function(v,w){v=this.words=v||[],w!=a?this.sigBytes=w:this.sigBytes=v.length*4},toString:function(v){return(v||p).stringify(this)},concat:function(v){var w=this.words,j=v.words,S=this.sigBytes,N=v.sigBytes;if(this.clamp(),S%4)for(var k=0;k<N;k++){var E=j[k>>>2]>>>24-k%4*8&255;w[S+k>>>2]|=E<<24-(S+k)%4*8}else for(var P=0;P<N;P+=4)w[S+P>>>2]=j[P>>>2];return this.sigBytes+=N,this},clamp:function(){var v=this.words,w=this.sigBytes;v[w>>>2]&=4294967295<<32-w%4*8,v.length=s.ceil(w/4)},clone:function(){var v=u.clone.call(this);return v.words=this.words.slice(0),v},random:function(v){for(var w=[],j=0;j<v;j+=4)w.push(o());return new h.init(w,v)}}),m=c.enc={},p=m.Hex={stringify:function(v){for(var w=v.words,j=v.sigBytes,S=[],N=0;N<j;N++){var k=w[N>>>2]>>>24-N%4*8&255;S.push((k>>>4).toString(16)),S.push((k&15).toString(16))}return S.join("")},parse:function(v){for(var w=v.length,j=[],S=0;S<w;S+=2)j[S>>>3]|=parseInt(v.substr(S,2),16)<<24-S%8*4;return new h.init(j,w/2)}},b=m.Latin1={stringify:function(v){for(var w=v.words,j=v.sigBytes,S=[],N=0;N<j;N++){var k=w[N>>>2]>>>24-N%4*8&255;S.push(String.fromCharCode(k))}return S.join("")},parse:function(v){for(var w=v.length,j=[],S=0;S<w;S++)j[S>>>2]|=(v.charCodeAt(S)&255)<<24-S%4*8;return new h.init(j,w)}},x=m.Utf8={stringify:function(v){try{return decodeURIComponent(escape(b.stringify(v)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(v){return b.parse(unescape(encodeURIComponent(v)))}},g=d.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new h.init,this._nDataBytes=0},_append:function(v){typeof v=="string"&&(v=x.parse(v)),this._data.concat(v),this._nDataBytes+=v.sigBytes},_process:function(v){var w,j=this._data,S=j.words,N=j.sigBytes,k=this.blockSize,E=k*4,P=N/E;v?P=s.ceil(P):P=s.max((P|0)-this._minBufferSize,0);var A=P*k,C=s.min(A*4,N);if(A){for(var T=0;T<A;T+=k)this._doProcessBlock(S,T);w=S.splice(0,A),j.sigBytes-=C}return new h.init(w,C)},clone:function(){var v=u.clone.call(this);return v._data=this._data.clone(),v},_minBufferSize:0});d.Hasher=g.extend({cfg:u.extend(),init:function(v){this.cfg=this.cfg.extend(v),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(v){return this._append(v),this._process(),this},finalize:function(v){v&&this._append(v);var w=this._doFinalize();return w},blockSize:16,_createHelper:function(v){return function(w,j){return new v.init(j).finalize(w)}},_createHmacHelper:function(v){return function(w,j){return new y.HMAC.init(v,j).finalize(w)}}});var y=c.algo={};return c}(Math);return n})}(cx)),cx.exports}var dx={exports:{}},G1;function G0(){return G1||(G1=1,function(t,e){(function(n,s){t.exports=s(Tt())})(et,function(n){return function(s){var a=n,i=a.lib,o=i.Base,l=i.WordArray,c=a.x64={};c.Word=o.extend({init:function(d,u){this.high=d,this.low=u}}),c.WordArray=o.extend({init:function(d,u){d=this.words=d||[],u!=s?this.sigBytes=u:this.sigBytes=d.length*8},toX32:function(){for(var d=this.words,u=d.length,h=[],m=0;m<u;m++){var p=d[m];h.push(p.high),h.push(p.low)}return l.create(h,this.sigBytes)},clone:function(){for(var d=o.clone.call(this),u=d.words=this.words.slice(0),h=u.length,m=0;m<h;m++)u[m]=u[m].clone();return d}})}(),n})}(dx)),dx.exports}var ux={exports:{}},Z1;function gz(){return Z1||(Z1=1,function(t,e){(function(n,s){t.exports=s(Tt())})(et,function(n){return function(){if(typeof ArrayBuffer=="function"){var s=n,a=s.lib,i=a.WordArray,o=i.init,l=i.init=function(c){if(c instanceof ArrayBuffer&&(c=new Uint8Array(c)),(c instanceof Int8Array||typeof Uint8ClampedArray<"u"&&c instanceof Uint8ClampedArray||c instanceof Int16Array||c instanceof Uint16Array||c instanceof Int32Array||c instanceof Uint32Array||c instanceof Float32Array||c instanceof Float64Array)&&(c=new Uint8Array(c.buffer,c.byteOffset,c.byteLength)),c instanceof Uint8Array){for(var d=c.byteLength,u=[],h=0;h<d;h++)u[h>>>2]|=c[h]<<24-h%4*8;o.call(this,u,d)}else o.apply(this,arguments)};l.prototype=i}}(),n.lib.WordArray})}(ux)),ux.exports}var hx={exports:{}},Q1;function vz(){return Q1||(Q1=1,function(t,e){(function(n,s){t.exports=s(Tt())})(et,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=s.enc;o.Utf16=o.Utf16BE={stringify:function(c){for(var d=c.words,u=c.sigBytes,h=[],m=0;m<u;m+=2){var p=d[m>>>2]>>>16-m%4*8&65535;h.push(String.fromCharCode(p))}return h.join("")},parse:function(c){for(var d=c.length,u=[],h=0;h<d;h++)u[h>>>1]|=c.charCodeAt(h)<<16-h%2*16;return i.create(u,d*2)}},o.Utf16LE={stringify:function(c){for(var d=c.words,u=c.sigBytes,h=[],m=0;m<u;m+=2){var p=l(d[m>>>2]>>>16-m%4*8&65535);h.push(String.fromCharCode(p))}return h.join("")},parse:function(c){for(var d=c.length,u=[],h=0;h<d;h++)u[h>>>1]|=l(c.charCodeAt(h)<<16-h%2*16);return i.create(u,d*2)}};function l(c){return c<<8&4278255360|c>>>8&16711935}}(),n.enc.Utf16})}(hx)),hx.exports}var mx={exports:{}},Y1;function Jo(){return Y1||(Y1=1,function(t,e){(function(n,s){t.exports=s(Tt())})(et,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=s.enc;o.Base64={stringify:function(c){var d=c.words,u=c.sigBytes,h=this._map;c.clamp();for(var m=[],p=0;p<u;p+=3)for(var b=d[p>>>2]>>>24-p%4*8&255,x=d[p+1>>>2]>>>24-(p+1)%4*8&255,g=d[p+2>>>2]>>>24-(p+2)%4*8&255,y=b<<16|x<<8|g,v=0;v<4&&p+v*.75<u;v++)m.push(h.charAt(y>>>6*(3-v)&63));var w=h.charAt(64);if(w)for(;m.length%4;)m.push(w);return m.join("")},parse:function(c){var d=c.length,u=this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var m=0;m<u.length;m++)h[u.charCodeAt(m)]=m}var p=u.charAt(64);if(p){var b=c.indexOf(p);b!==-1&&(d=b)}return l(c,d,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function l(c,d,u){for(var h=[],m=0,p=0;p<d;p++)if(p%4){var b=u[c.charCodeAt(p-1)]<<p%4*2,x=u[c.charCodeAt(p)]>>>6-p%4*2,g=b|x;h[m>>>2]|=g<<24-m%4*8,m++}return i.create(h,m)}}(),n.enc.Base64})}(mx)),mx.exports}var fx={exports:{}},J1;function yz(){return J1||(J1=1,function(t,e){(function(n,s){t.exports=s(Tt())})(et,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=s.enc;o.Base64url={stringify:function(c,d){d===void 0&&(d=!0);var u=c.words,h=c.sigBytes,m=d?this._safe_map:this._map;c.clamp();for(var p=[],b=0;b<h;b+=3)for(var x=u[b>>>2]>>>24-b%4*8&255,g=u[b+1>>>2]>>>24-(b+1)%4*8&255,y=u[b+2>>>2]>>>24-(b+2)%4*8&255,v=x<<16|g<<8|y,w=0;w<4&&b+w*.75<h;w++)p.push(m.charAt(v>>>6*(3-w)&63));var j=m.charAt(64);if(j)for(;p.length%4;)p.push(j);return p.join("")},parse:function(c,d){d===void 0&&(d=!0);var u=c.length,h=d?this._safe_map:this._map,m=this._reverseMap;if(!m){m=this._reverseMap=[];for(var p=0;p<h.length;p++)m[h.charCodeAt(p)]=p}var b=h.charAt(64);if(b){var x=c.indexOf(b);x!==-1&&(u=x)}return l(c,u,m)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function l(c,d,u){for(var h=[],m=0,p=0;p<d;p++)if(p%4){var b=u[c.charCodeAt(p-1)]<<p%4*2,x=u[c.charCodeAt(p)]>>>6-p%4*2,g=b|x;h[m>>>2]|=g<<24-m%4*8,m++}return i.create(h,m)}}(),n.enc.Base64url})}(fx)),fx.exports}var px={exports:{}},X1;function Xo(){return X1||(X1=1,function(t,e){(function(n,s){t.exports=s(Tt())})(et,function(n){return function(s){var a=n,i=a.lib,o=i.WordArray,l=i.Hasher,c=a.algo,d=[];(function(){for(var x=0;x<64;x++)d[x]=s.abs(s.sin(x+1))*4294967296|0})();var u=c.MD5=l.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(x,g){for(var y=0;y<16;y++){var v=g+y,w=x[v];x[v]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}var j=this._hash.words,S=x[g+0],N=x[g+1],k=x[g+2],E=x[g+3],P=x[g+4],A=x[g+5],C=x[g+6],T=x[g+7],I=x[g+8],V=x[g+9],ne=x[g+10],se=x[g+11],q=x[g+12],O=x[g+13],F=x[g+14],B=x[g+15],R=j[0],D=j[1],L=j[2],M=j[3];R=h(R,D,L,M,S,7,d[0]),M=h(M,R,D,L,N,12,d[1]),L=h(L,M,R,D,k,17,d[2]),D=h(D,L,M,R,E,22,d[3]),R=h(R,D,L,M,P,7,d[4]),M=h(M,R,D,L,A,12,d[5]),L=h(L,M,R,D,C,17,d[6]),D=h(D,L,M,R,T,22,d[7]),R=h(R,D,L,M,I,7,d[8]),M=h(M,R,D,L,V,12,d[9]),L=h(L,M,R,D,ne,17,d[10]),D=h(D,L,M,R,se,22,d[11]),R=h(R,D,L,M,q,7,d[12]),M=h(M,R,D,L,O,12,d[13]),L=h(L,M,R,D,F,17,d[14]),D=h(D,L,M,R,B,22,d[15]),R=m(R,D,L,M,N,5,d[16]),M=m(M,R,D,L,C,9,d[17]),L=m(L,M,R,D,se,14,d[18]),D=m(D,L,M,R,S,20,d[19]),R=m(R,D,L,M,A,5,d[20]),M=m(M,R,D,L,ne,9,d[21]),L=m(L,M,R,D,B,14,d[22]),D=m(D,L,M,R,P,20,d[23]),R=m(R,D,L,M,V,5,d[24]),M=m(M,R,D,L,F,9,d[25]),L=m(L,M,R,D,E,14,d[26]),D=m(D,L,M,R,I,20,d[27]),R=m(R,D,L,M,O,5,d[28]),M=m(M,R,D,L,k,9,d[29]),L=m(L,M,R,D,T,14,d[30]),D=m(D,L,M,R,q,20,d[31]),R=p(R,D,L,M,A,4,d[32]),M=p(M,R,D,L,I,11,d[33]),L=p(L,M,R,D,se,16,d[34]),D=p(D,L,M,R,F,23,d[35]),R=p(R,D,L,M,N,4,d[36]),M=p(M,R,D,L,P,11,d[37]),L=p(L,M,R,D,T,16,d[38]),D=p(D,L,M,R,ne,23,d[39]),R=p(R,D,L,M,O,4,d[40]),M=p(M,R,D,L,S,11,d[41]),L=p(L,M,R,D,E,16,d[42]),D=p(D,L,M,R,C,23,d[43]),R=p(R,D,L,M,V,4,d[44]),M=p(M,R,D,L,q,11,d[45]),L=p(L,M,R,D,B,16,d[46]),D=p(D,L,M,R,k,23,d[47]),R=b(R,D,L,M,S,6,d[48]),M=b(M,R,D,L,T,10,d[49]),L=b(L,M,R,D,F,15,d[50]),D=b(D,L,M,R,A,21,d[51]),R=b(R,D,L,M,q,6,d[52]),M=b(M,R,D,L,E,10,d[53]),L=b(L,M,R,D,ne,15,d[54]),D=b(D,L,M,R,N,21,d[55]),R=b(R,D,L,M,I,6,d[56]),M=b(M,R,D,L,B,10,d[57]),L=b(L,M,R,D,C,15,d[58]),D=b(D,L,M,R,O,21,d[59]),R=b(R,D,L,M,P,6,d[60]),M=b(M,R,D,L,se,10,d[61]),L=b(L,M,R,D,k,15,d[62]),D=b(D,L,M,R,V,21,d[63]),j[0]=j[0]+R|0,j[1]=j[1]+D|0,j[2]=j[2]+L|0,j[3]=j[3]+M|0},_doFinalize:function(){var x=this._data,g=x.words,y=this._nDataBytes*8,v=x.sigBytes*8;g[v>>>5]|=128<<24-v%32;var w=s.floor(y/4294967296),j=y;g[(v+64>>>9<<4)+15]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,g[(v+64>>>9<<4)+14]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360,x.sigBytes=(g.length+1)*4,this._process();for(var S=this._hash,N=S.words,k=0;k<4;k++){var E=N[k];N[k]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360}return S},clone:function(){var x=l.clone.call(this);return x._hash=this._hash.clone(),x}});function h(x,g,y,v,w,j,S){var N=x+(g&y|~g&v)+w+S;return(N<<j|N>>>32-j)+g}function m(x,g,y,v,w,j,S){var N=x+(g&v|y&~v)+w+S;return(N<<j|N>>>32-j)+g}function p(x,g,y,v,w,j,S){var N=x+(g^y^v)+w+S;return(N<<j|N>>>32-j)+g}function b(x,g,y,v,w,j,S){var N=x+(y^(g|~v))+w+S;return(N<<j|N>>>32-j)+g}a.MD5=l._createHelper(u),a.HmacMD5=l._createHmacHelper(u)}(Math),n.MD5})}(px)),px.exports}var xx={exports:{}},eN;function lA(){return eN||(eN=1,function(t,e){(function(n,s){t.exports=s(Tt())})(et,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=a.Hasher,l=s.algo,c=[],d=l.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,h){for(var m=this._hash.words,p=m[0],b=m[1],x=m[2],g=m[3],y=m[4],v=0;v<80;v++){if(v<16)c[v]=u[h+v]|0;else{var w=c[v-3]^c[v-8]^c[v-14]^c[v-16];c[v]=w<<1|w>>>31}var j=(p<<5|p>>>27)+y+c[v];v<20?j+=(b&x|~b&g)+1518500249:v<40?j+=(b^x^g)+1859775393:v<60?j+=(b&x|b&g|x&g)-1894007588:j+=(b^x^g)-899497514,y=g,g=x,x=b<<30|b>>>2,b=p,p=j}m[0]=m[0]+p|0,m[1]=m[1]+b|0,m[2]=m[2]+x|0,m[3]=m[3]+g|0,m[4]=m[4]+y|0},_doFinalize:function(){var u=this._data,h=u.words,m=this._nDataBytes*8,p=u.sigBytes*8;return h[p>>>5]|=128<<24-p%32,h[(p+64>>>9<<4)+14]=Math.floor(m/4294967296),h[(p+64>>>9<<4)+15]=m,u.sigBytes=h.length*4,this._process(),this._hash},clone:function(){var u=o.clone.call(this);return u._hash=this._hash.clone(),u}});s.SHA1=o._createHelper(d),s.HmacSHA1=o._createHmacHelper(d)}(),n.SHA1})}(xx)),xx.exports}var gx={exports:{}},tN;function mw(){return tN||(tN=1,function(t,e){(function(n,s){t.exports=s(Tt())})(et,function(n){return function(s){var a=n,i=a.lib,o=i.WordArray,l=i.Hasher,c=a.algo,d=[],u=[];(function(){function p(y){for(var v=s.sqrt(y),w=2;w<=v;w++)if(!(y%w))return!1;return!0}function b(y){return(y-(y|0))*4294967296|0}for(var x=2,g=0;g<64;)p(x)&&(g<8&&(d[g]=b(s.pow(x,1/2))),u[g]=b(s.pow(x,1/3)),g++),x++})();var h=[],m=c.SHA256=l.extend({_doReset:function(){this._hash=new o.init(d.slice(0))},_doProcessBlock:function(p,b){for(var x=this._hash.words,g=x[0],y=x[1],v=x[2],w=x[3],j=x[4],S=x[5],N=x[6],k=x[7],E=0;E<64;E++){if(E<16)h[E]=p[b+E]|0;else{var P=h[E-15],A=(P<<25|P>>>7)^(P<<14|P>>>18)^P>>>3,C=h[E-2],T=(C<<15|C>>>17)^(C<<13|C>>>19)^C>>>10;h[E]=A+h[E-7]+T+h[E-16]}var I=j&S^~j&N,V=g&y^g&v^y&v,ne=(g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22),se=(j<<26|j>>>6)^(j<<21|j>>>11)^(j<<7|j>>>25),q=k+se+I+u[E]+h[E],O=ne+V;k=N,N=S,S=j,j=w+q|0,w=v,v=y,y=g,g=q+O|0}x[0]=x[0]+g|0,x[1]=x[1]+y|0,x[2]=x[2]+v|0,x[3]=x[3]+w|0,x[4]=x[4]+j|0,x[5]=x[5]+S|0,x[6]=x[6]+N|0,x[7]=x[7]+k|0},_doFinalize:function(){var p=this._data,b=p.words,x=this._nDataBytes*8,g=p.sigBytes*8;return b[g>>>5]|=128<<24-g%32,b[(g+64>>>9<<4)+14]=s.floor(x/4294967296),b[(g+64>>>9<<4)+15]=x,p.sigBytes=b.length*4,this._process(),this._hash},clone:function(){var p=l.clone.call(this);return p._hash=this._hash.clone(),p}});a.SHA256=l._createHelper(m),a.HmacSHA256=l._createHmacHelper(m)}(Math),n.SHA256})}(gx)),gx.exports}var vx={exports:{}},nN;function bz(){return nN||(nN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),mw())})(et,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=s.algo,l=o.SHA256,c=o.SHA224=l.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var d=l._doFinalize.call(this);return d.sigBytes-=4,d}});s.SHA224=l._createHelper(c),s.HmacSHA224=l._createHmacHelper(c)}(),n.SHA224})}(vx)),vx.exports}var yx={exports:{}},rN;function cA(){return rN||(rN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),G0())})(et,function(n){return function(){var s=n,a=s.lib,i=a.Hasher,o=s.x64,l=o.Word,c=o.WordArray,d=s.algo;function u(){return l.create.apply(l,arguments)}var h=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],m=[];(function(){for(var b=0;b<80;b++)m[b]=u()})();var p=d.SHA512=i.extend({_doReset:function(){this._hash=new c.init([new l.init(1779033703,4089235720),new l.init(3144134277,2227873595),new l.init(1013904242,4271175723),new l.init(2773480762,1595750129),new l.init(1359893119,2917565137),new l.init(2600822924,725511199),new l.init(528734635,4215389547),new l.init(1541459225,327033209)])},_doProcessBlock:function(b,x){for(var g=this._hash.words,y=g[0],v=g[1],w=g[2],j=g[3],S=g[4],N=g[5],k=g[6],E=g[7],P=y.high,A=y.low,C=v.high,T=v.low,I=w.high,V=w.low,ne=j.high,se=j.low,q=S.high,O=S.low,F=N.high,B=N.low,R=k.high,D=k.low,L=E.high,M=E.low,X=P,K=A,z=C,Y=T,ae=I,U=V,Q=ne,oe=se,re=q,le=O,Z=F,de=B,he=R,Re=D,$e=L,wt=M,me=0;me<80;me++){var je,Se,Ze=m[me];if(me<16)Se=Ze.high=b[x+me*2]|0,je=Ze.low=b[x+me*2+1]|0;else{var Me=m[me-15],Ne=Me.high,mt=Me.low,it=(Ne>>>1|mt<<31)^(Ne>>>8|mt<<24)^Ne>>>7,kn=(mt>>>1|Ne<<31)^(mt>>>8|Ne<<24)^(mt>>>7|Ne<<25),Cr=m[me-2],ut=Cr.high,en=Cr.low,Cn=(ut>>>19|en<<13)^(ut<<3|en>>>29)^ut>>>6,Er=(en>>>19|ut<<13)^(en<<3|ut>>>29)^(en>>>6|ut<<26),Vn=m[me-7],fn=Vn.high,qa=Vn.low,He=m[me-16],It=He.high,Et=He.low;je=kn+qa,Se=it+fn+(je>>>0<kn>>>0?1:0),je=je+Er,Se=Se+Cn+(je>>>0<Er>>>0?1:0),je=je+Et,Se=Se+It+(je>>>0<Et>>>0?1:0),Ze.high=Se,Ze.low=je}var ot=re&Z^~re&he,$t=le&de^~le&Re,Qr=X&z^X&ae^z&ae,Wa=K&Y^K&U^Y&U,nl=(X>>>28|K<<4)^(X<<30|K>>>2)^(X<<25|K>>>7),Gc=(K>>>28|X<<4)^(K<<30|X>>>2)^(K<<25|X>>>7),ue=(re>>>14|le<<18)^(re>>>18|le<<14)^(re<<23|le>>>9),fe=(le>>>14|re<<18)^(le>>>18|re<<14)^(le<<23|re>>>9),We=h[me],Qe=We.high,ht=We.low,Ft=wt+fe,un=$e+ue+(Ft>>>0<wt>>>0?1:0),Ft=Ft+$t,un=un+ot+(Ft>>>0<$t>>>0?1:0),Ft=Ft+ht,un=un+Qe+(Ft>>>0<ht>>>0?1:0),Ft=Ft+je,un=un+Se+(Ft>>>0<je>>>0?1:0),pa=Gc+Wa,rl=nl+Qr+(pa>>>0<Gc>>>0?1:0);$e=he,wt=Re,he=Z,Re=de,Z=re,de=le,le=oe+Ft|0,re=Q+un+(le>>>0<oe>>>0?1:0)|0,Q=ae,oe=U,ae=z,U=Y,z=X,Y=K,K=Ft+pa|0,X=un+rl+(K>>>0<Ft>>>0?1:0)|0}A=y.low=A+K,y.high=P+X+(A>>>0<K>>>0?1:0),T=v.low=T+Y,v.high=C+z+(T>>>0<Y>>>0?1:0),V=w.low=V+U,w.high=I+ae+(V>>>0<U>>>0?1:0),se=j.low=se+oe,j.high=ne+Q+(se>>>0<oe>>>0?1:0),O=S.low=O+le,S.high=q+re+(O>>>0<le>>>0?1:0),B=N.low=B+de,N.high=F+Z+(B>>>0<de>>>0?1:0),D=k.low=D+Re,k.high=R+he+(D>>>0<Re>>>0?1:0),M=E.low=M+wt,E.high=L+$e+(M>>>0<wt>>>0?1:0)},_doFinalize:function(){var b=this._data,x=b.words,g=this._nDataBytes*8,y=b.sigBytes*8;x[y>>>5]|=128<<24-y%32,x[(y+128>>>10<<5)+30]=Math.floor(g/4294967296),x[(y+128>>>10<<5)+31]=g,b.sigBytes=x.length*4,this._process();var v=this._hash.toX32();return v},clone:function(){var b=i.clone.call(this);return b._hash=this._hash.clone(),b},blockSize:1024/32});s.SHA512=i._createHelper(p),s.HmacSHA512=i._createHmacHelper(p)}(),n.SHA512})}(yx)),yx.exports}var bx={exports:{}},sN;function wz(){return sN||(sN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),G0(),cA())})(et,function(n){return function(){var s=n,a=s.x64,i=a.Word,o=a.WordArray,l=s.algo,c=l.SHA512,d=l.SHA384=c.extend({_doReset:function(){this._hash=new o.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var u=c._doFinalize.call(this);return u.sigBytes-=16,u}});s.SHA384=c._createHelper(d),s.HmacSHA384=c._createHmacHelper(d)}(),n.SHA384})}(bx)),bx.exports}var wx={exports:{}},aN;function jz(){return aN||(aN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),G0())})(et,function(n){return function(s){var a=n,i=a.lib,o=i.WordArray,l=i.Hasher,c=a.x64,d=c.Word,u=a.algo,h=[],m=[],p=[];(function(){for(var g=1,y=0,v=0;v<24;v++){h[g+5*y]=(v+1)*(v+2)/2%64;var w=y%5,j=(2*g+3*y)%5;g=w,y=j}for(var g=0;g<5;g++)for(var y=0;y<5;y++)m[g+5*y]=y+(2*g+3*y)%5*5;for(var S=1,N=0;N<24;N++){for(var k=0,E=0,P=0;P<7;P++){if(S&1){var A=(1<<P)-1;A<32?E^=1<<A:k^=1<<A-32}S&128?S=S<<1^113:S<<=1}p[N]=d.create(k,E)}})();var b=[];(function(){for(var g=0;g<25;g++)b[g]=d.create()})();var x=u.SHA3=l.extend({cfg:l.cfg.extend({outputLength:512}),_doReset:function(){for(var g=this._state=[],y=0;y<25;y++)g[y]=new d.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(g,y){for(var v=this._state,w=this.blockSize/2,j=0;j<w;j++){var S=g[y+2*j],N=g[y+2*j+1];S=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,N=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360;var k=v[j];k.high^=N,k.low^=S}for(var E=0;E<24;E++){for(var P=0;P<5;P++){for(var A=0,C=0,T=0;T<5;T++){var k=v[P+5*T];A^=k.high,C^=k.low}var I=b[P];I.high=A,I.low=C}for(var P=0;P<5;P++)for(var V=b[(P+4)%5],ne=b[(P+1)%5],se=ne.high,q=ne.low,A=V.high^(se<<1|q>>>31),C=V.low^(q<<1|se>>>31),T=0;T<5;T++){var k=v[P+5*T];k.high^=A,k.low^=C}for(var O=1;O<25;O++){var A,C,k=v[O],F=k.high,B=k.low,R=h[O];R<32?(A=F<<R|B>>>32-R,C=B<<R|F>>>32-R):(A=B<<R-32|F>>>64-R,C=F<<R-32|B>>>64-R);var D=b[m[O]];D.high=A,D.low=C}var L=b[0],M=v[0];L.high=M.high,L.low=M.low;for(var P=0;P<5;P++)for(var T=0;T<5;T++){var O=P+5*T,k=v[O],X=b[O],K=b[(P+1)%5+5*T],z=b[(P+2)%5+5*T];k.high=X.high^~K.high&z.high,k.low=X.low^~K.low&z.low}var k=v[0],Y=p[E];k.high^=Y.high,k.low^=Y.low}},_doFinalize:function(){var g=this._data,y=g.words;this._nDataBytes*8;var v=g.sigBytes*8,w=this.blockSize*32;y[v>>>5]|=1<<24-v%32,y[(s.ceil((v+1)/w)*w>>>5)-1]|=128,g.sigBytes=y.length*4,this._process();for(var j=this._state,S=this.cfg.outputLength/8,N=S/8,k=[],E=0;E<N;E++){var P=j[E],A=P.high,C=P.low;A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,k.push(C),k.push(A)}return new o.init(k,S)},clone:function(){for(var g=l.clone.call(this),y=g._state=this._state.slice(0),v=0;v<25;v++)y[v]=y[v].clone();return g}});a.SHA3=l._createHelper(x),a.HmacSHA3=l._createHmacHelper(x)}(Math),n.SHA3})}(wx)),wx.exports}var jx={exports:{}},iN;function _z(){return iN||(iN=1,function(t,e){(function(n,s){t.exports=s(Tt())})(et,function(n){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(s){var a=n,i=a.lib,o=i.WordArray,l=i.Hasher,c=a.algo,d=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),h=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),m=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=o.create([0,1518500249,1859775393,2400959708,2840853838]),b=o.create([1352829926,1548603684,1836072691,2053994217,0]),x=c.RIPEMD160=l.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(N,k){for(var E=0;E<16;E++){var P=k+E,A=N[P];N[P]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360}var C=this._hash.words,T=p.words,I=b.words,V=d.words,ne=u.words,se=h.words,q=m.words,O,F,B,R,D,L,M,X,K,z;L=O=C[0],M=F=C[1],X=B=C[2],K=R=C[3],z=D=C[4];for(var Y,E=0;E<80;E+=1)Y=O+N[k+V[E]]|0,E<16?Y+=g(F,B,R)+T[0]:E<32?Y+=y(F,B,R)+T[1]:E<48?Y+=v(F,B,R)+T[2]:E<64?Y+=w(F,B,R)+T[3]:Y+=j(F,B,R)+T[4],Y=Y|0,Y=S(Y,se[E]),Y=Y+D|0,O=D,D=R,R=S(B,10),B=F,F=Y,Y=L+N[k+ne[E]]|0,E<16?Y+=j(M,X,K)+I[0]:E<32?Y+=w(M,X,K)+I[1]:E<48?Y+=v(M,X,K)+I[2]:E<64?Y+=y(M,X,K)+I[3]:Y+=g(M,X,K)+I[4],Y=Y|0,Y=S(Y,q[E]),Y=Y+z|0,L=z,z=K,K=S(X,10),X=M,M=Y;Y=C[1]+B+K|0,C[1]=C[2]+R+z|0,C[2]=C[3]+D+L|0,C[3]=C[4]+O+M|0,C[4]=C[0]+F+X|0,C[0]=Y},_doFinalize:function(){var N=this._data,k=N.words,E=this._nDataBytes*8,P=N.sigBytes*8;k[P>>>5]|=128<<24-P%32,k[(P+64>>>9<<4)+14]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,N.sigBytes=(k.length+1)*4,this._process();for(var A=this._hash,C=A.words,T=0;T<5;T++){var I=C[T];C[T]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360}return A},clone:function(){var N=l.clone.call(this);return N._hash=this._hash.clone(),N}});function g(N,k,E){return N^k^E}function y(N,k,E){return N&k|~N&E}function v(N,k,E){return(N|~k)^E}function w(N,k,E){return N&E|k&~E}function j(N,k,E){return N^(k|~E)}function S(N,k){return N<<k|N>>>32-k}a.RIPEMD160=l._createHelper(x),a.HmacRIPEMD160=l._createHmacHelper(x)}(),n.RIPEMD160})}(jx)),jx.exports}var _x={exports:{}},oN;function fw(){return oN||(oN=1,function(t,e){(function(n,s){t.exports=s(Tt())})(et,function(n){(function(){var s=n,a=s.lib,i=a.Base,o=s.enc,l=o.Utf8,c=s.algo;c.HMAC=i.extend({init:function(d,u){d=this._hasher=new d.init,typeof u=="string"&&(u=l.parse(u));var h=d.blockSize,m=h*4;u.sigBytes>m&&(u=d.finalize(u)),u.clamp();for(var p=this._oKey=u.clone(),b=this._iKey=u.clone(),x=p.words,g=b.words,y=0;y<h;y++)x[y]^=1549556828,g[y]^=909522486;p.sigBytes=b.sigBytes=m,this.reset()},reset:function(){var d=this._hasher;d.reset(),d.update(this._iKey)},update:function(d){return this._hasher.update(d),this},finalize:function(d){var u=this._hasher,h=u.finalize(d);u.reset();var m=u.finalize(this._oKey.clone().concat(h));return m}})})()})}(_x)),_x.exports}var Nx={exports:{}},lN;function Nz(){return lN||(lN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),mw(),fw())})(et,function(n){return function(){var s=n,a=s.lib,i=a.Base,o=a.WordArray,l=s.algo,c=l.SHA256,d=l.HMAC,u=l.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:c,iterations:25e4}),init:function(h){this.cfg=this.cfg.extend(h)},compute:function(h,m){for(var p=this.cfg,b=d.create(p.hasher,h),x=o.create(),g=o.create([1]),y=x.words,v=g.words,w=p.keySize,j=p.iterations;y.length<w;){var S=b.update(m).finalize(g);b.reset();for(var N=S.words,k=N.length,E=S,P=1;P<j;P++){E=b.finalize(E),b.reset();for(var A=E.words,C=0;C<k;C++)N[C]^=A[C]}x.concat(S),v[0]++}return x.sigBytes=w*4,x}});s.PBKDF2=function(h,m,p){return u.create(p).compute(h,m)}}(),n.PBKDF2})}(Nx)),Nx.exports}var Sx={exports:{}},cN;function Xi(){return cN||(cN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),lA(),fw())})(et,function(n){return function(){var s=n,a=s.lib,i=a.Base,o=a.WordArray,l=s.algo,c=l.MD5,d=l.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:c,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,h){for(var m,p=this.cfg,b=p.hasher.create(),x=o.create(),g=x.words,y=p.keySize,v=p.iterations;g.length<y;){m&&b.update(m),m=b.update(u).finalize(h),b.reset();for(var w=1;w<v;w++)m=b.finalize(m),b.reset();x.concat(m)}return x.sigBytes=y*4,x}});s.EvpKDF=function(u,h,m){return d.create(m).compute(u,h)}}(),n.EvpKDF})}(Sx)),Sx.exports}var kx={exports:{}},dN;function Fn(){return dN||(dN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Xi())})(et,function(n){n.lib.Cipher||function(s){var a=n,i=a.lib,o=i.Base,l=i.WordArray,c=i.BufferedBlockAlgorithm,d=a.enc;d.Utf8;var u=d.Base64,h=a.algo,m=h.EvpKDF,p=i.Cipher=c.extend({cfg:o.extend(),createEncryptor:function(A,C){return this.create(this._ENC_XFORM_MODE,A,C)},createDecryptor:function(A,C){return this.create(this._DEC_XFORM_MODE,A,C)},init:function(A,C,T){this.cfg=this.cfg.extend(T),this._xformMode=A,this._key=C,this.reset()},reset:function(){c.reset.call(this),this._doReset()},process:function(A){return this._append(A),this._process()},finalize:function(A){A&&this._append(A);var C=this._doFinalize();return C},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function A(C){return typeof C=="string"?P:N}return function(C){return{encrypt:function(T,I,V){return A(I).encrypt(C,T,I,V)},decrypt:function(T,I,V){return A(I).decrypt(C,T,I,V)}}}}()});i.StreamCipher=p.extend({_doFinalize:function(){var A=this._process(!0);return A},blockSize:1});var b=a.mode={},x=i.BlockCipherMode=o.extend({createEncryptor:function(A,C){return this.Encryptor.create(A,C)},createDecryptor:function(A,C){return this.Decryptor.create(A,C)},init:function(A,C){this._cipher=A,this._iv=C}}),g=b.CBC=function(){var A=x.extend();A.Encryptor=A.extend({processBlock:function(T,I){var V=this._cipher,ne=V.blockSize;C.call(this,T,I,ne),V.encryptBlock(T,I),this._prevBlock=T.slice(I,I+ne)}}),A.Decryptor=A.extend({processBlock:function(T,I){var V=this._cipher,ne=V.blockSize,se=T.slice(I,I+ne);V.decryptBlock(T,I),C.call(this,T,I,ne),this._prevBlock=se}});function C(T,I,V){var ne,se=this._iv;se?(ne=se,this._iv=s):ne=this._prevBlock;for(var q=0;q<V;q++)T[I+q]^=ne[q]}return A}(),y=a.pad={},v=y.Pkcs7={pad:function(A,C){for(var T=C*4,I=T-A.sigBytes%T,V=I<<24|I<<16|I<<8|I,ne=[],se=0;se<I;se+=4)ne.push(V);var q=l.create(ne,I);A.concat(q)},unpad:function(A){var C=A.words[A.sigBytes-1>>>2]&255;A.sigBytes-=C}};i.BlockCipher=p.extend({cfg:p.cfg.extend({mode:g,padding:v}),reset:function(){var A;p.reset.call(this);var C=this.cfg,T=C.iv,I=C.mode;this._xformMode==this._ENC_XFORM_MODE?A=I.createEncryptor:(A=I.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==A?this._mode.init(this,T&&T.words):(this._mode=A.call(I,this,T&&T.words),this._mode.__creator=A)},_doProcessBlock:function(A,C){this._mode.processBlock(A,C)},_doFinalize:function(){var A,C=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(C.pad(this._data,this.blockSize),A=this._process(!0)):(A=this._process(!0),C.unpad(A)),A},blockSize:128/32});var w=i.CipherParams=o.extend({init:function(A){this.mixIn(A)},toString:function(A){return(A||this.formatter).stringify(this)}}),j=a.format={},S=j.OpenSSL={stringify:function(A){var C,T=A.ciphertext,I=A.salt;return I?C=l.create([1398893684,1701076831]).concat(I).concat(T):C=T,C.toString(u)},parse:function(A){var C,T=u.parse(A),I=T.words;return I[0]==1398893684&&I[1]==1701076831&&(C=l.create(I.slice(2,4)),I.splice(0,4),T.sigBytes-=16),w.create({ciphertext:T,salt:C})}},N=i.SerializableCipher=o.extend({cfg:o.extend({format:S}),encrypt:function(A,C,T,I){I=this.cfg.extend(I);var V=A.createEncryptor(T,I),ne=V.finalize(C),se=V.cfg;return w.create({ciphertext:ne,key:T,iv:se.iv,algorithm:A,mode:se.mode,padding:se.padding,blockSize:A.blockSize,formatter:I.format})},decrypt:function(A,C,T,I){I=this.cfg.extend(I),C=this._parse(C,I.format);var V=A.createDecryptor(T,I).finalize(C.ciphertext);return V},_parse:function(A,C){return typeof A=="string"?C.parse(A,this):A}}),k=a.kdf={},E=k.OpenSSL={execute:function(A,C,T,I,V){if(I||(I=l.random(64/8)),V)var ne=m.create({keySize:C+T,hasher:V}).compute(A,I);else var ne=m.create({keySize:C+T}).compute(A,I);var se=l.create(ne.words.slice(C),T*4);return ne.sigBytes=C*4,w.create({key:ne,iv:se,salt:I})}},P=i.PasswordBasedCipher=N.extend({cfg:N.cfg.extend({kdf:E}),encrypt:function(A,C,T,I){I=this.cfg.extend(I);var V=I.kdf.execute(T,A.keySize,A.ivSize,I.salt,I.hasher);I.iv=V.iv;var ne=N.encrypt.call(this,A,C,V.key,I);return ne.mixIn(V),ne},decrypt:function(A,C,T,I){I=this.cfg.extend(I),C=this._parse(C,I.format);var V=I.kdf.execute(T,A.keySize,A.ivSize,C.salt,I.hasher);I.iv=V.iv;var ne=N.decrypt.call(this,A,C,V.key,I);return ne}})}()})}(kx)),kx.exports}var Cx={exports:{}},uN;function Sz(){return uN||(uN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Fn())})(et,function(n){return n.mode.CFB=function(){var s=n.lib.BlockCipherMode.extend();s.Encryptor=s.extend({processBlock:function(i,o){var l=this._cipher,c=l.blockSize;a.call(this,i,o,c,l),this._prevBlock=i.slice(o,o+c)}}),s.Decryptor=s.extend({processBlock:function(i,o){var l=this._cipher,c=l.blockSize,d=i.slice(o,o+c);a.call(this,i,o,c,l),this._prevBlock=d}});function a(i,o,l,c){var d,u=this._iv;u?(d=u.slice(0),this._iv=void 0):d=this._prevBlock,c.encryptBlock(d,0);for(var h=0;h<l;h++)i[o+h]^=d[h]}return s}(),n.mode.CFB})}(Cx)),Cx.exports}var Ex={exports:{}},hN;function kz(){return hN||(hN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Fn())})(et,function(n){return n.mode.CTR=function(){var s=n.lib.BlockCipherMode.extend(),a=s.Encryptor=s.extend({processBlock:function(i,o){var l=this._cipher,c=l.blockSize,d=this._iv,u=this._counter;d&&(u=this._counter=d.slice(0),this._iv=void 0);var h=u.slice(0);l.encryptBlock(h,0),u[c-1]=u[c-1]+1|0;for(var m=0;m<c;m++)i[o+m]^=h[m]}});return s.Decryptor=a,s}(),n.mode.CTR})}(Ex)),Ex.exports}var Ax={exports:{}},mN;function Cz(){return mN||(mN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Fn())})(et,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=function(){var s=n.lib.BlockCipherMode.extend();function a(l){if((l>>24&255)===255){var c=l>>16&255,d=l>>8&255,u=l&255;c===255?(c=0,d===255?(d=0,u===255?u=0:++u):++d):++c,l=0,l+=c<<16,l+=d<<8,l+=u}else l+=1<<24;return l}function i(l){return(l[0]=a(l[0]))===0&&(l[1]=a(l[1])),l}var o=s.Encryptor=s.extend({processBlock:function(l,c){var d=this._cipher,u=d.blockSize,h=this._iv,m=this._counter;h&&(m=this._counter=h.slice(0),this._iv=void 0),i(m);var p=m.slice(0);d.encryptBlock(p,0);for(var b=0;b<u;b++)l[c+b]^=p[b]}});return s.Decryptor=o,s}(),n.mode.CTRGladman})}(Ax)),Ax.exports}var Dx={exports:{}},fN;function Ez(){return fN||(fN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Fn())})(et,function(n){return n.mode.OFB=function(){var s=n.lib.BlockCipherMode.extend(),a=s.Encryptor=s.extend({processBlock:function(i,o){var l=this._cipher,c=l.blockSize,d=this._iv,u=this._keystream;d&&(u=this._keystream=d.slice(0),this._iv=void 0),l.encryptBlock(u,0);for(var h=0;h<c;h++)i[o+h]^=u[h]}});return s.Decryptor=a,s}(),n.mode.OFB})}(Dx)),Dx.exports}var Px={exports:{}},pN;function Az(){return pN||(pN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Fn())})(et,function(n){return n.mode.ECB=function(){var s=n.lib.BlockCipherMode.extend();return s.Encryptor=s.extend({processBlock:function(a,i){this._cipher.encryptBlock(a,i)}}),s.Decryptor=s.extend({processBlock:function(a,i){this._cipher.decryptBlock(a,i)}}),s}(),n.mode.ECB})}(Px)),Px.exports}var Tx={exports:{}},xN;function Dz(){return xN||(xN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Fn())})(et,function(n){return n.pad.AnsiX923={pad:function(s,a){var i=s.sigBytes,o=a*4,l=o-i%o,c=i+l-1;s.clamp(),s.words[c>>>2]|=l<<24-c%4*8,s.sigBytes+=l},unpad:function(s){var a=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=a}},n.pad.Ansix923})}(Tx)),Tx.exports}var Rx={exports:{}},gN;function Pz(){return gN||(gN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Fn())})(et,function(n){return n.pad.Iso10126={pad:function(s,a){var i=a*4,o=i-s.sigBytes%i;s.concat(n.lib.WordArray.random(o-1)).concat(n.lib.WordArray.create([o<<24],1))},unpad:function(s){var a=s.words[s.sigBytes-1>>>2]&255;s.sigBytes-=a}},n.pad.Iso10126})}(Rx)),Rx.exports}var Mx={exports:{}},vN;function Tz(){return vN||(vN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Fn())})(et,function(n){return n.pad.Iso97971={pad:function(s,a){s.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(s,a)},unpad:function(s){n.pad.ZeroPadding.unpad(s),s.sigBytes--}},n.pad.Iso97971})}(Mx)),Mx.exports}var Ix={exports:{}},yN;function Rz(){return yN||(yN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Fn())})(et,function(n){return n.pad.ZeroPadding={pad:function(s,a){var i=a*4;s.clamp(),s.sigBytes+=i-(s.sigBytes%i||i)},unpad:function(s){for(var a=s.words,i=s.sigBytes-1,i=s.sigBytes-1;i>=0;i--)if(a[i>>>2]>>>24-i%4*8&255){s.sigBytes=i+1;break}}},n.pad.ZeroPadding})}(Ix)),Ix.exports}var Ox={exports:{}},bN;function Mz(){return bN||(bN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Fn())})(et,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})}(Ox)),Ox.exports}var Fx={exports:{}},wN;function Iz(){return wN||(wN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Fn())})(et,function(n){return function(s){var a=n,i=a.lib,o=i.CipherParams,l=a.enc,c=l.Hex,d=a.format;d.Hex={stringify:function(u){return u.ciphertext.toString(c)},parse:function(u){var h=c.parse(u);return o.create({ciphertext:h})}}}(),n.format.Hex})}(Fx)),Fx.exports}var Bx={exports:{}},jN;function Oz(){return jN||(jN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Jo(),Xo(),Xi(),Fn())})(et,function(n){return function(){var s=n,a=s.lib,i=a.BlockCipher,o=s.algo,l=[],c=[],d=[],u=[],h=[],m=[],p=[],b=[],x=[],g=[];(function(){for(var w=[],j=0;j<256;j++)j<128?w[j]=j<<1:w[j]=j<<1^283;for(var S=0,N=0,j=0;j<256;j++){var k=N^N<<1^N<<2^N<<3^N<<4;k=k>>>8^k&255^99,l[S]=k,c[k]=S;var E=w[S],P=w[E],A=w[P],C=w[k]*257^k*16843008;d[S]=C<<24|C>>>8,u[S]=C<<16|C>>>16,h[S]=C<<8|C>>>24,m[S]=C;var C=A*16843009^P*65537^E*257^S*16843008;p[k]=C<<24|C>>>8,b[k]=C<<16|C>>>16,x[k]=C<<8|C>>>24,g[k]=C,S?(S=E^w[w[w[A^E]]],N^=w[w[N]]):S=N=1}})();var y=[0,1,2,4,8,16,32,64,128,27,54],v=o.AES=i.extend({_doReset:function(){var w;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var j=this._keyPriorReset=this._key,S=j.words,N=j.sigBytes/4,k=this._nRounds=N+6,E=(k+1)*4,P=this._keySchedule=[],A=0;A<E;A++)A<N?P[A]=S[A]:(w=P[A-1],A%N?N>6&&A%N==4&&(w=l[w>>>24]<<24|l[w>>>16&255]<<16|l[w>>>8&255]<<8|l[w&255]):(w=w<<8|w>>>24,w=l[w>>>24]<<24|l[w>>>16&255]<<16|l[w>>>8&255]<<8|l[w&255],w^=y[A/N|0]<<24),P[A]=P[A-N]^w);for(var C=this._invKeySchedule=[],T=0;T<E;T++){var A=E-T;if(T%4)var w=P[A];else var w=P[A-4];T<4||A<=4?C[T]=w:C[T]=p[l[w>>>24]]^b[l[w>>>16&255]]^x[l[w>>>8&255]]^g[l[w&255]]}}},encryptBlock:function(w,j){this._doCryptBlock(w,j,this._keySchedule,d,u,h,m,l)},decryptBlock:function(w,j){var S=w[j+1];w[j+1]=w[j+3],w[j+3]=S,this._doCryptBlock(w,j,this._invKeySchedule,p,b,x,g,c);var S=w[j+1];w[j+1]=w[j+3],w[j+3]=S},_doCryptBlock:function(w,j,S,N,k,E,P,A){for(var C=this._nRounds,T=w[j]^S[0],I=w[j+1]^S[1],V=w[j+2]^S[2],ne=w[j+3]^S[3],se=4,q=1;q<C;q++){var O=N[T>>>24]^k[I>>>16&255]^E[V>>>8&255]^P[ne&255]^S[se++],F=N[I>>>24]^k[V>>>16&255]^E[ne>>>8&255]^P[T&255]^S[se++],B=N[V>>>24]^k[ne>>>16&255]^E[T>>>8&255]^P[I&255]^S[se++],R=N[ne>>>24]^k[T>>>16&255]^E[I>>>8&255]^P[V&255]^S[se++];T=O,I=F,V=B,ne=R}var O=(A[T>>>24]<<24|A[I>>>16&255]<<16|A[V>>>8&255]<<8|A[ne&255])^S[se++],F=(A[I>>>24]<<24|A[V>>>16&255]<<16|A[ne>>>8&255]<<8|A[T&255])^S[se++],B=(A[V>>>24]<<24|A[ne>>>16&255]<<16|A[T>>>8&255]<<8|A[I&255])^S[se++],R=(A[ne>>>24]<<24|A[T>>>16&255]<<16|A[I>>>8&255]<<8|A[V&255])^S[se++];w[j]=O,w[j+1]=F,w[j+2]=B,w[j+3]=R},keySize:256/32});s.AES=i._createHelper(v)}(),n.AES})}(Bx)),Bx.exports}var Lx={exports:{}},_N;function Fz(){return _N||(_N=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Jo(),Xo(),Xi(),Fn())})(et,function(n){return function(){var s=n,a=s.lib,i=a.WordArray,o=a.BlockCipher,l=s.algo,c=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],d=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],m=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=l.DES=o.extend({_doReset:function(){for(var y=this._key,v=y.words,w=[],j=0;j<56;j++){var S=c[j]-1;w[j]=v[S>>>5]>>>31-S%32&1}for(var N=this._subKeys=[],k=0;k<16;k++){for(var E=N[k]=[],P=u[k],j=0;j<24;j++)E[j/6|0]|=w[(d[j]-1+P)%28]<<31-j%6,E[4+(j/6|0)]|=w[28+(d[j+24]-1+P)%28]<<31-j%6;E[0]=E[0]<<1|E[0]>>>31;for(var j=1;j<7;j++)E[j]=E[j]>>>(j-1)*4+3;E[7]=E[7]<<5|E[7]>>>27}for(var A=this._invSubKeys=[],j=0;j<16;j++)A[j]=N[15-j]},encryptBlock:function(y,v){this._doCryptBlock(y,v,this._subKeys)},decryptBlock:function(y,v){this._doCryptBlock(y,v,this._invSubKeys)},_doCryptBlock:function(y,v,w){this._lBlock=y[v],this._rBlock=y[v+1],b.call(this,4,252645135),b.call(this,16,65535),x.call(this,2,858993459),x.call(this,8,16711935),b.call(this,1,1431655765);for(var j=0;j<16;j++){for(var S=w[j],N=this._lBlock,k=this._rBlock,E=0,P=0;P<8;P++)E|=h[P][((k^S[P])&m[P])>>>0];this._lBlock=k,this._rBlock=N^E}var A=this._lBlock;this._lBlock=this._rBlock,this._rBlock=A,b.call(this,1,1431655765),x.call(this,8,16711935),x.call(this,2,858993459),b.call(this,16,65535),b.call(this,4,252645135),y[v]=this._lBlock,y[v+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function b(y,v){var w=(this._lBlock>>>y^this._rBlock)&v;this._rBlock^=w,this._lBlock^=w<<y}function x(y,v){var w=(this._rBlock>>>y^this._lBlock)&v;this._lBlock^=w,this._rBlock^=w<<y}s.DES=o._createHelper(p);var g=l.TripleDES=o.extend({_doReset:function(){var y=this._key,v=y.words;if(v.length!==2&&v.length!==4&&v.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var w=v.slice(0,2),j=v.length<4?v.slice(0,2):v.slice(2,4),S=v.length<6?v.slice(0,2):v.slice(4,6);this._des1=p.createEncryptor(i.create(w)),this._des2=p.createEncryptor(i.create(j)),this._des3=p.createEncryptor(i.create(S))},encryptBlock:function(y,v){this._des1.encryptBlock(y,v),this._des2.decryptBlock(y,v),this._des3.encryptBlock(y,v)},decryptBlock:function(y,v){this._des3.decryptBlock(y,v),this._des2.encryptBlock(y,v),this._des1.decryptBlock(y,v)},keySize:192/32,ivSize:64/32,blockSize:64/32});s.TripleDES=o._createHelper(g)}(),n.TripleDES})}(Lx)),Lx.exports}var $x={exports:{}},NN;function Bz(){return NN||(NN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Jo(),Xo(),Xi(),Fn())})(et,function(n){return function(){var s=n,a=s.lib,i=a.StreamCipher,o=s.algo,l=o.RC4=i.extend({_doReset:function(){for(var u=this._key,h=u.words,m=u.sigBytes,p=this._S=[],b=0;b<256;b++)p[b]=b;for(var b=0,x=0;b<256;b++){var g=b%m,y=h[g>>>2]>>>24-g%4*8&255;x=(x+p[b]+y)%256;var v=p[b];p[b]=p[x],p[x]=v}this._i=this._j=0},_doProcessBlock:function(u,h){u[h]^=c.call(this)},keySize:256/32,ivSize:0});function c(){for(var u=this._S,h=this._i,m=this._j,p=0,b=0;b<4;b++){h=(h+1)%256,m=(m+u[h])%256;var x=u[h];u[h]=u[m],u[m]=x,p|=u[(u[h]+u[m])%256]<<24-b*8}return this._i=h,this._j=m,p}s.RC4=i._createHelper(l);var d=o.RC4Drop=l.extend({cfg:l.cfg.extend({drop:192}),_doReset:function(){l._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)c.call(this)}});s.RC4Drop=i._createHelper(d)}(),n.RC4})}($x)),$x.exports}var zx={exports:{}},SN;function Lz(){return SN||(SN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Jo(),Xo(),Xi(),Fn())})(et,function(n){return function(){var s=n,a=s.lib,i=a.StreamCipher,o=s.algo,l=[],c=[],d=[],u=o.Rabbit=i.extend({_doReset:function(){for(var m=this._key.words,p=this.cfg.iv,b=0;b<4;b++)m[b]=(m[b]<<8|m[b]>>>24)&16711935|(m[b]<<24|m[b]>>>8)&4278255360;var x=this._X=[m[0],m[3]<<16|m[2]>>>16,m[1],m[0]<<16|m[3]>>>16,m[2],m[1]<<16|m[0]>>>16,m[3],m[2]<<16|m[1]>>>16],g=this._C=[m[2]<<16|m[2]>>>16,m[0]&4294901760|m[1]&65535,m[3]<<16|m[3]>>>16,m[1]&4294901760|m[2]&65535,m[0]<<16|m[0]>>>16,m[2]&4294901760|m[3]&65535,m[1]<<16|m[1]>>>16,m[3]&4294901760|m[0]&65535];this._b=0;for(var b=0;b<4;b++)h.call(this);for(var b=0;b<8;b++)g[b]^=x[b+4&7];if(p){var y=p.words,v=y[0],w=y[1],j=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,S=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,N=j>>>16|S&4294901760,k=S<<16|j&65535;g[0]^=j,g[1]^=N,g[2]^=S,g[3]^=k,g[4]^=j,g[5]^=N,g[6]^=S,g[7]^=k;for(var b=0;b<4;b++)h.call(this)}},_doProcessBlock:function(m,p){var b=this._X;h.call(this),l[0]=b[0]^b[5]>>>16^b[3]<<16,l[1]=b[2]^b[7]>>>16^b[5]<<16,l[2]=b[4]^b[1]>>>16^b[7]<<16,l[3]=b[6]^b[3]>>>16^b[1]<<16;for(var x=0;x<4;x++)l[x]=(l[x]<<8|l[x]>>>24)&16711935|(l[x]<<24|l[x]>>>8)&4278255360,m[p+x]^=l[x]},blockSize:128/32,ivSize:64/32});function h(){for(var m=this._X,p=this._C,b=0;b<8;b++)c[b]=p[b];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<c[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<c[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<c[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<c[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<c[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<c[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<c[6]>>>0?1:0)|0,this._b=p[7]>>>0<c[7]>>>0?1:0;for(var b=0;b<8;b++){var x=m[b]+p[b],g=x&65535,y=x>>>16,v=((g*g>>>17)+g*y>>>15)+y*y,w=((x&4294901760)*x|0)+((x&65535)*x|0);d[b]=v^w}m[0]=d[0]+(d[7]<<16|d[7]>>>16)+(d[6]<<16|d[6]>>>16)|0,m[1]=d[1]+(d[0]<<8|d[0]>>>24)+d[7]|0,m[2]=d[2]+(d[1]<<16|d[1]>>>16)+(d[0]<<16|d[0]>>>16)|0,m[3]=d[3]+(d[2]<<8|d[2]>>>24)+d[1]|0,m[4]=d[4]+(d[3]<<16|d[3]>>>16)+(d[2]<<16|d[2]>>>16)|0,m[5]=d[5]+(d[4]<<8|d[4]>>>24)+d[3]|0,m[6]=d[6]+(d[5]<<16|d[5]>>>16)+(d[4]<<16|d[4]>>>16)|0,m[7]=d[7]+(d[6]<<8|d[6]>>>24)+d[5]|0}s.Rabbit=i._createHelper(u)}(),n.Rabbit})}(zx)),zx.exports}var Ux={exports:{}},kN;function $z(){return kN||(kN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Jo(),Xo(),Xi(),Fn())})(et,function(n){return function(){var s=n,a=s.lib,i=a.StreamCipher,o=s.algo,l=[],c=[],d=[],u=o.RabbitLegacy=i.extend({_doReset:function(){var m=this._key.words,p=this.cfg.iv,b=this._X=[m[0],m[3]<<16|m[2]>>>16,m[1],m[0]<<16|m[3]>>>16,m[2],m[1]<<16|m[0]>>>16,m[3],m[2]<<16|m[1]>>>16],x=this._C=[m[2]<<16|m[2]>>>16,m[0]&4294901760|m[1]&65535,m[3]<<16|m[3]>>>16,m[1]&4294901760|m[2]&65535,m[0]<<16|m[0]>>>16,m[2]&4294901760|m[3]&65535,m[1]<<16|m[1]>>>16,m[3]&4294901760|m[0]&65535];this._b=0;for(var g=0;g<4;g++)h.call(this);for(var g=0;g<8;g++)x[g]^=b[g+4&7];if(p){var y=p.words,v=y[0],w=y[1],j=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,S=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,N=j>>>16|S&4294901760,k=S<<16|j&65535;x[0]^=j,x[1]^=N,x[2]^=S,x[3]^=k,x[4]^=j,x[5]^=N,x[6]^=S,x[7]^=k;for(var g=0;g<4;g++)h.call(this)}},_doProcessBlock:function(m,p){var b=this._X;h.call(this),l[0]=b[0]^b[5]>>>16^b[3]<<16,l[1]=b[2]^b[7]>>>16^b[5]<<16,l[2]=b[4]^b[1]>>>16^b[7]<<16,l[3]=b[6]^b[3]>>>16^b[1]<<16;for(var x=0;x<4;x++)l[x]=(l[x]<<8|l[x]>>>24)&16711935|(l[x]<<24|l[x]>>>8)&4278255360,m[p+x]^=l[x]},blockSize:128/32,ivSize:64/32});function h(){for(var m=this._X,p=this._C,b=0;b<8;b++)c[b]=p[b];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<c[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<c[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<c[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<c[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<c[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<c[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<c[6]>>>0?1:0)|0,this._b=p[7]>>>0<c[7]>>>0?1:0;for(var b=0;b<8;b++){var x=m[b]+p[b],g=x&65535,y=x>>>16,v=((g*g>>>17)+g*y>>>15)+y*y,w=((x&4294901760)*x|0)+((x&65535)*x|0);d[b]=v^w}m[0]=d[0]+(d[7]<<16|d[7]>>>16)+(d[6]<<16|d[6]>>>16)|0,m[1]=d[1]+(d[0]<<8|d[0]>>>24)+d[7]|0,m[2]=d[2]+(d[1]<<16|d[1]>>>16)+(d[0]<<16|d[0]>>>16)|0,m[3]=d[3]+(d[2]<<8|d[2]>>>24)+d[1]|0,m[4]=d[4]+(d[3]<<16|d[3]>>>16)+(d[2]<<16|d[2]>>>16)|0,m[5]=d[5]+(d[4]<<8|d[4]>>>24)+d[3]|0,m[6]=d[6]+(d[5]<<16|d[5]>>>16)+(d[4]<<16|d[4]>>>16)|0,m[7]=d[7]+(d[6]<<8|d[6]>>>24)+d[5]|0}s.RabbitLegacy=i._createHelper(u)}(),n.RabbitLegacy})}(Ux)),Ux.exports}var qx={exports:{}},CN;function zz(){return CN||(CN=1,function(t,e){(function(n,s,a){t.exports=s(Tt(),Jo(),Xo(),Xi(),Fn())})(et,function(n){return function(){var s=n,a=s.lib,i=a.BlockCipher,o=s.algo;const l=16,c=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],d=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function h(g,y){let v=y>>24&255,w=y>>16&255,j=y>>8&255,S=y&255,N=g.sbox[0][v]+g.sbox[1][w];return N=N^g.sbox[2][j],N=N+g.sbox[3][S],N}function m(g,y,v){let w=y,j=v,S;for(let N=0;N<l;++N)w=w^g.pbox[N],j=h(g,w)^j,S=w,w=j,j=S;return S=w,w=j,j=S,j=j^g.pbox[l],w=w^g.pbox[l+1],{left:w,right:j}}function p(g,y,v){let w=y,j=v,S;for(let N=l+1;N>1;--N)w=w^g.pbox[N],j=h(g,w)^j,S=w,w=j,j=S;return S=w,w=j,j=S,j=j^g.pbox[1],w=w^g.pbox[0],{left:w,right:j}}function b(g,y,v){for(let k=0;k<4;k++){g.sbox[k]=[];for(let E=0;E<256;E++)g.sbox[k][E]=d[k][E]}let w=0;for(let k=0;k<l+2;k++)g.pbox[k]=c[k]^y[w],w++,w>=v&&(w=0);let j=0,S=0,N=0;for(let k=0;k<l+2;k+=2)N=m(g,j,S),j=N.left,S=N.right,g.pbox[k]=j,g.pbox[k+1]=S;for(let k=0;k<4;k++)for(let E=0;E<256;E+=2)N=m(g,j,S),j=N.left,S=N.right,g.sbox[k][E]=j,g.sbox[k][E+1]=S;return!0}var x=o.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var g=this._keyPriorReset=this._key,y=g.words,v=g.sigBytes/4;b(u,y,v)}},encryptBlock:function(g,y){var v=m(u,g[y],g[y+1]);g[y]=v.left,g[y+1]=v.right},decryptBlock:function(g,y){var v=p(u,g[y],g[y+1]);g[y]=v.left,g[y+1]=v.right},blockSize:64/32,keySize:128/32,ivSize:64/32});s.Blowfish=i._createHelper(x)}(),n.Blowfish})}(qx)),qx.exports}(function(t,e){(function(n,s,a){t.exports=s(Tt(),G0(),gz(),vz(),Jo(),yz(),Xo(),lA(),mw(),bz(),cA(),wz(),jz(),_z(),fw(),Nz(),Xi(),Fn(),Sz(),kz(),Cz(),Ez(),Az(),Dz(),Pz(),Tz(),Rz(),Mz(),Iz(),Oz(),Fz(),Bz(),Lz(),$z(),zz())})(et,function(n){return n})})(mz);_.object({sequence_type:_.enum(["invoice","quote","order","receipt","credit_note","delivery_note","payment_voucher"]),prefix:_.string().min(1).max(10),format:_.string().min(1),reset_annually:_.boolean().default(!0),gap_tracking:_.boolean().default(!0)});_.object({entity_type:_.string().min(1),entity_id:_.string().min(1),document_content:_.string().min(1),file_name:_.string().min(1),mime_type:_.string().min(1)});_.object({year:_.number().min(2020).max(2030),quarter:_.number().min(1).max(4).optional(),month:_.number().min(1).max(12).optional(),from_date:_.string().regex(/^\d{4}-\d{2}-\d{2}$/),to_date:_.string().regex(/^\d{4}-\d{2}-\d{2}$/)});const Uz={requireHumanApproval:!0,gates:{aiEstimateApply:!0,aiScheduleApply:!0,customerScoringAction:!0,employeeScoringAction:!0}};async function qz(t){try{await fetch("/api/audit/approval",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch{console.warn("[approval] audit log failed (non-blocking)",t)}}async function Wz(t){let e=!0;if(typeof window<"u"&&typeof window.confirm=="function"){const n=`Bitte bestätigen:

${t.reason}

Hinweis: Diese Aktion basiert auf einem KI/Score-Vorschlag und erfordert Ihre Freigabe.`;e=window.confirm(n)}return await qz({...t,approved:e,timestamp:new Date().toISOString()}),e}async function Hz(t){return!!Uz.gates[t]}async function dA(t,e,n){if(!(await Hz(t)&&!await Wz({action:e.action??t.toString().toUpperCase(),reason:e.reason,metadata:e.metadata,userId:e.userId})))return await n()}_.object({year:_.number().min(2020).max(2030),quarter:_.number().min(1).max(4).optional(),month:_.number().min(1).max(12).optional(),period_type:_.enum(["MONTHLY","QUARTERLY","ANNUAL"]),start_date:_.string().regex(/^\d{4}-\d{2}-\d{2}$/),end_date:_.string().regex(/^\d{4}-\d{2}-\d{2}$/)});_.object({document_type:_.enum(["invoice","quote","order","project","customer","material","timesheet","expense","knowledge_base","email","pdf_document"]),entity_id:_.string(),title:_.string().min(1),content:_.string().min(1),metadata:_.record(_.any()).default({}),language:_.enum(["de","en"]).default("de"),search_tags:_.array(_.string()).default([]),importance_score:_.number().min(0).max(1).default(.5)});_.object({query:_.string().min(1),document_types:_.array(_.enum(["invoice","quote","order","project","customer","material","timesheet","expense","knowledge_base","email","pdf_document"])).optional(),date_range:_.object({from:_.string(),to:_.string()}).optional(),language:_.enum(["de","en"]).default("de"),limit:_.number().min(1).max(100).default(10),similarity_threshold:_.number().min(0).max(1).default(.7),include_metadata:_.boolean().default(!0)});_.object({user_input:_.string().min(1),detected_intent:_.enum(["SEARCH_REQUEST","CREATE_ENTITY","UPDATE_ENTITY","REPORT_REQUEST","CALCULATION_REQUEST","SCHEDULE_TASK","COMPLIANCE_CHECK","EXPORT_REQUEST","NOTIFICATION_SETUP","HELP_REQUEST","UNKNOWN"]),target_entity:_.enum(["customer","invoice","quote","order","project","material","employee","timesheet","expense","report","notification"]).optional(),suggested_action:_.enum(["CREATE","READ","UPDATE","DELETE","SEARCH","EXPORT","CALCULATE","SCHEDULE","NOTIFY","VALIDATE"]).optional(),extracted_parameters:_.record(_.any()).default({}),confidence_score:_.number().min(0).max(1)});_.object({estimation_type:_.enum(["PROJECT_COST","MATERIAL_COST","LABOR_COST","TIME_ESTIMATION","COMPLETION_DATE","RESOURCE_NEED","PROFIT_MARGIN","RISK_ASSESSMENT"]),project_category:_.enum(["BATHROOM_RENOVATION","KITCHEN_RENOVATION","ELECTRICAL_WORK","PLUMBING_WORK","FLOORING_WORK","PAINTING_WORK","ROOFING_WORK","GENERAL_CONSTRUCTION","MAINTENANCE","CUSTOM_WORK"]),project_description:_.string().min(10),project_size:_.object({area_sqm:_.number().positive().optional(),rooms:_.number().int().positive().optional(),complexity_level:_.number().int().min(1).max(5)}),customer_requirements:_.array(_.string()).default([]),timeline_constraints:_.object({start_date:_.string().optional(),end_date:_.string().optional(),fixed_deadline:_.boolean().default(!1)}).optional(),budget_constraints:_.object({min_budget:_.number().positive().optional(),max_budget:_.number().positive().optional(),flexible:_.boolean().default(!0)}).optional(),additional_context:_.record(_.any()).default({})});async function Vz(t){return await dA("aiEstimateApply",{reason:"KI-Schätzung soll übernommen werden.",metadata:{projectId:t.projectId,quoteId:t.quoteId},userId:t.userId},async()=>(console.log("Applying AI estimate:",t),t.estimate))}var Kz={exports:{}};(function(t){var e=function(n){var s=Object.prototype,a=s.hasOwnProperty,i=Object.defineProperty||function(F,B,R){F[B]=R.value},o,l=typeof Symbol=="function"?Symbol:{},c=l.iterator||"@@iterator",d=l.asyncIterator||"@@asyncIterator",u=l.toStringTag||"@@toStringTag";function h(F,B,R){return Object.defineProperty(F,B,{value:R,enumerable:!0,configurable:!0,writable:!0}),F[B]}try{h({},"")}catch{h=function(B,R,D){return B[R]=D}}function m(F,B,R,D){var L=B&&B.prototype instanceof w?B:w,M=Object.create(L.prototype),X=new se(D||[]);return i(M,"_invoke",{value:T(F,R,X)}),M}n.wrap=m;function p(F,B,R){try{return{type:"normal",arg:F.call(B,R)}}catch(D){return{type:"throw",arg:D}}}var b="suspendedStart",x="suspendedYield",g="executing",y="completed",v={};function w(){}function j(){}function S(){}var N={};h(N,c,function(){return this});var k=Object.getPrototypeOf,E=k&&k(k(q([])));E&&E!==s&&a.call(E,c)&&(N=E);var P=S.prototype=w.prototype=Object.create(N);j.prototype=S,i(P,"constructor",{value:S,configurable:!0}),i(S,"constructor",{value:j,configurable:!0}),j.displayName=h(S,u,"GeneratorFunction");function A(F){["next","throw","return"].forEach(function(B){h(F,B,function(R){return this._invoke(B,R)})})}n.isGeneratorFunction=function(F){var B=typeof F=="function"&&F.constructor;return B?B===j||(B.displayName||B.name)==="GeneratorFunction":!1},n.mark=function(F){return Object.setPrototypeOf?Object.setPrototypeOf(F,S):(F.__proto__=S,h(F,u,"GeneratorFunction")),F.prototype=Object.create(P),F},n.awrap=function(F){return{__await:F}};function C(F,B){function R(M,X,K,z){var Y=p(F[M],F,X);if(Y.type==="throw")z(Y.arg);else{var ae=Y.arg,U=ae.value;return U&&typeof U=="object"&&a.call(U,"__await")?B.resolve(U.__await).then(function(Q){R("next",Q,K,z)},function(Q){R("throw",Q,K,z)}):B.resolve(U).then(function(Q){ae.value=Q,K(ae)},function(Q){return R("throw",Q,K,z)})}}var D;function L(M,X){function K(){return new B(function(z,Y){R(M,X,z,Y)})}return D=D?D.then(K,K):K()}i(this,"_invoke",{value:L})}A(C.prototype),h(C.prototype,d,function(){return this}),n.AsyncIterator=C,n.async=function(F,B,R,D,L){L===void 0&&(L=Promise);var M=new C(m(F,B,R,D),L);return n.isGeneratorFunction(B)?M:M.next().then(function(X){return X.done?X.value:M.next()})};function T(F,B,R){var D=b;return function(M,X){if(D===g)throw new Error("Generator is already running");if(D===y){if(M==="throw")throw X;return O()}for(R.method=M,R.arg=X;;){var K=R.delegate;if(K){var z=I(K,R);if(z){if(z===v)continue;return z}}if(R.method==="next")R.sent=R._sent=R.arg;else if(R.method==="throw"){if(D===b)throw D=y,R.arg;R.dispatchException(R.arg)}else R.method==="return"&&R.abrupt("return",R.arg);D=g;var Y=p(F,B,R);if(Y.type==="normal"){if(D=R.done?y:x,Y.arg===v)continue;return{value:Y.arg,done:R.done}}else Y.type==="throw"&&(D=y,R.method="throw",R.arg=Y.arg)}}}function I(F,B){var R=B.method,D=F.iterator[R];if(D===o)return B.delegate=null,R==="throw"&&F.iterator.return&&(B.method="return",B.arg=o,I(F,B),B.method==="throw")||R!=="return"&&(B.method="throw",B.arg=new TypeError("The iterator does not provide a '"+R+"' method")),v;var L=p(D,F.iterator,B.arg);if(L.type==="throw")return B.method="throw",B.arg=L.arg,B.delegate=null,v;var M=L.arg;if(!M)return B.method="throw",B.arg=new TypeError("iterator result is not an object"),B.delegate=null,v;if(M.done)B[F.resultName]=M.value,B.next=F.nextLoc,B.method!=="return"&&(B.method="next",B.arg=o);else return M;return B.delegate=null,v}A(P),h(P,u,"Generator"),h(P,c,function(){return this}),h(P,"toString",function(){return"[object Generator]"});function V(F){var B={tryLoc:F[0]};1 in F&&(B.catchLoc=F[1]),2 in F&&(B.finallyLoc=F[2],B.afterLoc=F[3]),this.tryEntries.push(B)}function ne(F){var B=F.completion||{};B.type="normal",delete B.arg,F.completion=B}function se(F){this.tryEntries=[{tryLoc:"root"}],F.forEach(V,this),this.reset(!0)}n.keys=function(F){var B=Object(F),R=[];for(var D in B)R.push(D);return R.reverse(),function L(){for(;R.length;){var M=R.pop();if(M in B)return L.value=M,L.done=!1,L}return L.done=!0,L}};function q(F){if(F){var B=F[c];if(B)return B.call(F);if(typeof F.next=="function")return F;if(!isNaN(F.length)){var R=-1,D=function L(){for(;++R<F.length;)if(a.call(F,R))return L.value=F[R],L.done=!1,L;return L.value=o,L.done=!0,L};return D.next=D}}return{next:O}}n.values=q;function O(){return{value:o,done:!0}}return se.prototype={constructor:se,reset:function(F){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(ne),!F)for(var B in this)B.charAt(0)==="t"&&a.call(this,B)&&!isNaN(+B.slice(1))&&(this[B]=o)},stop:function(){this.done=!0;var F=this.tryEntries[0],B=F.completion;if(B.type==="throw")throw B.arg;return this.rval},dispatchException:function(F){if(this.done)throw F;var B=this;function R(z,Y){return M.type="throw",M.arg=F,B.next=z,Y&&(B.method="next",B.arg=o),!!Y}for(var D=this.tryEntries.length-1;D>=0;--D){var L=this.tryEntries[D],M=L.completion;if(L.tryLoc==="root")return R("end");if(L.tryLoc<=this.prev){var X=a.call(L,"catchLoc"),K=a.call(L,"finallyLoc");if(X&&K){if(this.prev<L.catchLoc)return R(L.catchLoc,!0);if(this.prev<L.finallyLoc)return R(L.finallyLoc)}else if(X){if(this.prev<L.catchLoc)return R(L.catchLoc,!0)}else if(K){if(this.prev<L.finallyLoc)return R(L.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(F,B){for(var R=this.tryEntries.length-1;R>=0;--R){var D=this.tryEntries[R];if(D.tryLoc<=this.prev&&a.call(D,"finallyLoc")&&this.prev<D.finallyLoc){var L=D;break}}L&&(F==="break"||F==="continue")&&L.tryLoc<=B&&B<=L.finallyLoc&&(L=null);var M=L?L.completion:{};return M.type=F,M.arg=B,L?(this.method="next",this.next=L.finallyLoc,v):this.complete(M)},complete:function(F,B){if(F.type==="throw")throw F.arg;return F.type==="break"||F.type==="continue"?this.next=F.arg:F.type==="return"?(this.rval=this.arg=F.arg,this.method="return",this.next="end"):F.type==="normal"&&B&&(this.next=B),v},finish:function(F){for(var B=this.tryEntries.length-1;B>=0;--B){var R=this.tryEntries[B];if(R.finallyLoc===F)return this.complete(R.completion,R.afterLoc),ne(R),v}},catch:function(F){for(var B=this.tryEntries.length-1;B>=0;--B){var R=this.tryEntries[B];if(R.tryLoc===F){var D=R.completion;if(D.type==="throw"){var L=D.arg;ne(R)}return L}}throw new Error("illegal catch attempt")},delegateYield:function(F,B,R){return this.delegate={iterator:q(F),resultName:B,nextLoc:R},this.method==="next"&&(this.arg=o),v}},n}(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(Kz);var pw=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`;const Gz=pw;let EN=0;var uA=({id:t,action:e,payload:n={}})=>{let s=t;return typeof s>"u"&&(s=Gz("Job",EN),EN+=1),{id:s,action:e,payload:n}},Hc={};let xw=!1;Hc.logging=xw;Hc.setLogging=t=>{xw=t};Hc.log=(...t)=>xw?console.log.apply(void 0,t):null;const Zz=uA,{log:tm}=Hc,Qz=pw;let AN=0;var Yz=()=>{const t=Qz("Scheduler",AN),e={},n={};let s=[];AN+=1;const a=()=>s.length,i=()=>Object.keys(e).length,o=()=>{if(s.length!==0){const h=Object.keys(e);for(let m=0;m<h.length;m+=1)if(typeof n[h[m]]>"u"){s[0](e[h[m]]);break}}},l=(h,m)=>new Promise((p,b)=>{const x=Zz({action:h,payload:m});s.push(async g=>{s.shift(),n[g.id]=x;try{p(await g[h].apply(void 0,[...m,x.id]))}catch(y){b(y)}finally{delete n[g.id],o()}}),tm(`[${t}]: Add ${x.id} to JobQueue`),tm(`[${t}]: JobQueue length=${s.length}`),o()});return{addWorker:h=>(e[h.id]=h,tm(`[${t}]: Add ${h.id}`),tm(`[${t}]: Number of workers=${i()}`),o(),h.id),addJob:async(h,...m)=>{if(i()===0)throw Error(`[${t}]: You need to have at least one worker before adding jobs`);return l(h,m)},terminate:async()=>{Object.keys(e).forEach(async h=>{await e[h].terminate()}),s=[]},getQueueLen:a,getNumWorkers:i}},Jz=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof oA=="function"&&(e.type="node"),typeof t>"u"?e:e[t]};const Xz=Jz("type")==="browser",eU=Xz?t=>new URL(t,window.location.href).href:t=>t;var tU=t=>{const e={...t};return["corePath","workerPath","langPath"].forEach(n=>{t[n]&&(e[n]=eU(e[n]))}),e},hA={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const nU="tesseract.js",rU="6.0.1",sU="Pure Javascript Multilingual OCR",aU="src/index.js",iU="commonjs",oU="src/index.d.ts",lU="dist/tesseract.min.js",cU="dist/tesseract.min.js",dU={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser test:node:all","test:browser":"karma start karma.conf.js","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.mjs","test:node:all":"npm run test:node -- ./tests/*.test.mjs",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},uU={"./src/worker/node/index.js":"./src/worker/browser/index.js"},hU="",mU=["jeromewu"],fU="Apache-2.0",pU={"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","npm-run-all":"^4.1.5",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-webpack":"^5.0.0",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},xU={"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^6.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},gU={"@rollup/pluginutils":"^5.0.2"},vU={type:"git",url:"https://github.com/naptha/tesseract.js.git"},yU={url:"https://github.com/naptha/tesseract.js/issues"},bU="https://github.com/naptha/tesseract.js",wU={type:"opencollective",url:"https://opencollective.com/tesseractjs"},jU={name:nU,version:rU,description:sU,main:aU,type:iU,types:oU,unpkg:lU,jsdelivr:cU,scripts:dU,browser:uU,author:hU,contributors:mU,license:fU,devDependencies:pU,dependencies:xU,overrides:gU,repository:vU,bugs:yU,homepage:bU,collective:wU};var _U={workerBlobURL:!0,logger:()=>{}};const NU=jU.version,SU=_U;var kU={...SU,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${NU}/dist/worker.min.js`},CU=({workerPath:t,workerBlobURL:e})=>{let n;if(Blob&&URL&&e){const s=new Blob([`importScripts("${t}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(s))}else n=new Worker(t);return n},EU=t=>{t.terminate()},AU=(t,e)=>{t.onmessage=({data:n})=>{e(n)}},DU=async(t,e)=>{t.postMessage(e)};const Wx=t=>new Promise((e,n)=>{const s=new FileReader;s.onload=()=>{e(s.result)},s.onerror=({target:{error:{code:a}}})=>{n(Error(`File could not be read! Code=${a}`))},s.readAsArrayBuffer(t)}),sy=async t=>{let e=t;if(typeof t>"u")return"undefined";if(typeof t=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t)?e=atob(t.split(",")[1]).split("").map(n=>n.charCodeAt(0)):e=await(await fetch(t)).arrayBuffer();else if(typeof HTMLElement<"u"&&t instanceof HTMLElement)t.tagName==="IMG"&&(e=await sy(t.src)),t.tagName==="VIDEO"&&(e=await sy(t.poster)),t.tagName==="CANVAS"&&await new Promise(n=>{t.toBlob(async s=>{e=await Wx(s),n()})});else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){const n=await t.convertToBlob();e=await Wx(n)}else(t instanceof File||t instanceof Blob)&&(e=await Wx(t));return new Uint8Array(e)};var PU=sy;const TU=kU,RU=CU,MU=EU,IU=AU,OU=DU,FU=PU;var BU={defaultOptions:TU,spawnWorker:RU,terminateWorker:MU,onMessage:IU,send:OU,loadImage:FU};const LU=tU,Ls=uA,{log:DN}=Hc,$U=pw,so=hA,{defaultOptions:zU,spawnWorker:UU,terminateWorker:qU,onMessage:WU,loadImage:PN,send:HU}=BU;let TN=0;var mA=async(t="eng",e=so.LSTM_ONLY,n={},s={})=>{const a=$U("Worker",TN),{logger:i,errorHandler:o,...l}=LU({...zU,...n}),c={},d=typeof t=="string"?t.split("+"):t;let u=e,h=s;const m=[so.DEFAULT,so.LSTM_ONLY].includes(e)&&!l.legacyCore;let p,b;const x=new Promise((q,O)=>{b=q,p=O}),g=q=>{p(q.message)};let y=UU(l);y.onerror=g,TN+=1;const v=({id:q,action:O,payload:F})=>new Promise((B,R)=>{DN(`[${a}]: Start ${q}, action=${O}`);const D=`${O}-${q}`;c[D]={resolve:B,reject:R},HU(y,{workerId:a,jobId:q,action:O,payload:F})}),w=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),j=q=>v(Ls({id:q,action:"load",payload:{options:{lstmOnly:m,corePath:l.corePath,logging:l.logging}}})),S=(q,O,F)=>v(Ls({id:F,action:"FS",payload:{method:"writeFile",args:[q,O]}})),N=(q,O)=>v(Ls({id:O,action:"FS",payload:{method:"readFile",args:[q,{encoding:"utf8"}]}})),k=(q,O)=>v(Ls({id:O,action:"FS",payload:{method:"unlink",args:[q]}})),E=(q,O,F)=>v(Ls({id:F,action:"FS",payload:{method:q,args:O}})),P=(q,O)=>v(Ls({id:O,action:"loadLanguage",payload:{langs:q,options:{langPath:l.langPath,dataPath:l.dataPath,cachePath:l.cachePath,cacheMethod:l.cacheMethod,gzip:l.gzip,lstmOnly:[so.DEFAULT,so.LSTM_ONLY].includes(u)&&!l.legacyLang}}})),A=(q,O,F,B)=>v(Ls({id:B,action:"initialize",payload:{langs:q,oem:O,config:F}})),C=(q="eng",O,F,B)=>{if(m&&[so.TESSERACT_ONLY,so.TESSERACT_LSTM_COMBINED].includes(O))throw Error("Legacy model requested but code missing.");const R=O||u;u=R;const D=F||h;h=D;const M=(typeof q=="string"?q.split("+"):q).filter(X=>!d.includes(X));return d.push(...M),M.length>0?P(M,B).then(()=>A(q,R,D,B)):A(q,R,D,B)},T=(q={},O)=>v(Ls({id:O,action:"setParameters",payload:{params:q}})),I=async(q,O={},F={text:!0},B)=>v(Ls({id:B,action:"recognize",payload:{image:await PN(q),options:O,output:F}})),V=async(q,O)=>{if(m)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return v(Ls({id:O,action:"detect",payload:{image:await PN(q)}}))},ne=async()=>(y!==null&&(qU(y),y=null),Promise.resolve());WU(y,({workerId:q,jobId:O,status:F,action:B,data:R})=>{const D=`${B}-${O}`;if(F==="resolve")DN(`[${q}]: Complete ${O}`),c[D].resolve({jobId:O,data:R}),delete c[D];else if(F==="reject")if(c[D].reject(R),delete c[D],B==="load"&&p(R),o)o(R);else throw Error(R);else F==="progress"&&i({...R,userJobId:O})});const se={id:a,worker:y,load:w,writeText:S,readText:N,removeFile:k,FS:E,reinitialize:C,setParameters:T,recognize:I,detect:V,terminate:ne};return j().then(()=>P(t)).then(()=>A(t,e,s)).then(()=>b(se)).catch(()=>{}),x};const fA=mA,VU=async(t,e,n)=>{const s=await fA(e,1,n);return s.recognize(t).finally(async()=>{await s.terminate()})},KU=async(t,e)=>{const n=await fA("osd",0,e);return n.detect(t).finally(async()=>{await n.terminate()})};var GU={recognize:VU,detect:KU},ZU={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},QU={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const YU=Yz,JU=mA,XU=GU,eq=ZU,tq=hA,nq=QU,{setLogging:rq}=Hc;var RN={languages:eq,OEM:tq,PSM:nq,createScheduler:YU,createWorker:JU,setLogging:rq,...XU};function ct(t,e,n,s,a){if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function ie(t,e,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(t):s?s.value:e.get(t)}let pA=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return pA=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^n()&15>>+s/4).toString(16))};function ay(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const iy=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class rt extends Error{}class Hn extends rt{constructor(e,n,s,a){super(`${Hn.makeMessage(e,n,s)}`),this.status=e,this.headers=a,this.requestID=a==null?void 0:a.get("x-request-id"),this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,s){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):s;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,n,s,a){if(!e||!a)return new Z0({message:s,cause:iy(n)});const i=n==null?void 0:n.error;return e===400?new xA(e,i,s,a):e===401?new gA(e,i,s,a):e===403?new vA(e,i,s,a):e===404?new yA(e,i,s,a):e===409?new bA(e,i,s,a):e===422?new wA(e,i,s,a):e===429?new jA(e,i,s,a):e>=500?new _A(e,i,s,a):new Hn(e,i,s,a)}}class ns extends Hn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Z0 extends Hn{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class gw extends Z0{constructor({message:e}={}){super({message:e??"Request timed out."})}}class xA extends Hn{}class gA extends Hn{}class vA extends Hn{}class yA extends Hn{}class bA extends Hn{}class wA extends Hn{}class jA extends Hn{}class _A extends Hn{}class NA extends rt{constructor(){super("Could not parse response content as the length limit was reached")}}class SA extends rt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class vd extends Error{constructor(e){super(e)}}const sq=/^[a-z][a-z0-9+.-]*:/i,aq=t=>sq.test(t);let vr=t=>(vr=Array.isArray,vr(t)),MN=vr;function kA(t){return typeof t!="object"?{}:t??{}}function iq(t){if(!t)return!0;for(const e in t)return!1;return!0}function oq(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Hx(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const lq=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new rt(`${t} must be an integer`);if(e<0)throw new rt(`${t} must be a positive integer`);return e},cq=t=>{try{return JSON.parse(t)}catch{return}},lh=t=>new Promise(e=>setTimeout(e,t)),yl="5.16.0",dq=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function uq(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const hq=()=>{var n;const t=uq();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":yl,"X-Stainless-OS":ON(Deno.build.os),"X-Stainless-Arch":IN(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((n=Deno.version)==null?void 0:n.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":yl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":yl,"X-Stainless-OS":ON(globalThis.process.platform??"unknown"),"X-Stainless-Arch":IN(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=mq();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":yl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":yl,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function mq(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const s=n.exec(navigator.userAgent);if(s){const a=s[1]||0,i=s[2]||0,o=s[3]||0;return{browser:e,version:`${a}.${i}.${o}`}}}return null}const IN=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",ON=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let FN;const fq=()=>FN??(FN=hq());function pq(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function CA(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function EA(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return CA({start(){},async pull(n){const{done:s,value:a}=await e.next();s?n.close():n.enqueue(a)},async cancel(){var n;await((n=e.return)==null?void 0:n.call(e))}})}function AA(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function xq(t){var s,a;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((a=(s=t[Symbol.asyncIterator]()).return)==null?void 0:a.call(s));return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const gq=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),DA="RFC3986",PA=t=>String(t),BN={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:PA},vq="RFC1738";let oy=(t,e)=>(oy=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),oy(t,e));const $s=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),Vx=1024,yq=(t,e,n,s,a)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<i.length;l+=Vx){const c=i.length>=Vx?i.slice(l,l+Vx):i,d=[];for(let u=0;u<c.length;++u){let h=c.charCodeAt(u);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||a===vq&&(h===40||h===41)){d[d.length]=c.charAt(u);continue}if(h<128){d[d.length]=$s[h];continue}if(h<2048){d[d.length]=$s[192|h>>6]+$s[128|h&63];continue}if(h<55296||h>=57344){d[d.length]=$s[224|h>>12]+$s[128|h>>6&63]+$s[128|h&63];continue}u+=1,h=65536+((h&1023)<<10|c.charCodeAt(u)&1023),d[d.length]=$s[240|h>>18]+$s[128|h>>12&63]+$s[128|h>>6&63]+$s[128|h&63]}o+=d.join("")}return o};function bq(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function LN(t,e){if(vr(t)){const n=[];for(let s=0;s<t.length;s+=1)n.push(e(t[s]));return n}return e(t)}const TA={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},RA=function(t,e){Array.prototype.push.apply(t,vr(e)?e:[e])};let $N;const bn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:yq,encodeValuesOnly:!1,format:DA,formatter:PA,indices:!1,serializeDate(t){return($N??($N=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function wq(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const Kx={};function MA(t,e,n,s,a,i,o,l,c,d,u,h,m,p,b,x,g,y){let v=t,w=y,j=0,S=!1;for(;(w=w.get(Kx))!==void 0&&!S;){const A=w.get(t);if(j+=1,typeof A<"u"){if(A===j)throw new RangeError("Cyclic object value");S=!0}typeof w.get(Kx)>"u"&&(j=0)}if(typeof d=="function"?v=d(e,v):v instanceof Date?v=m==null?void 0:m(v):n==="comma"&&vr(v)&&(v=LN(v,function(A){return A instanceof Date?m==null?void 0:m(A):A})),v===null){if(i)return c&&!x?c(e,bn.encoder,g,"key",p):e;v=""}if(wq(v)||bq(v)){if(c){const A=x?e:c(e,bn.encoder,g,"key",p);return[(b==null?void 0:b(A))+"="+(b==null?void 0:b(c(v,bn.encoder,g,"value",p)))]}return[(b==null?void 0:b(e))+"="+(b==null?void 0:b(String(v)))]}const N=[];if(typeof v>"u")return N;let k;if(n==="comma"&&vr(v))x&&c&&(v=LN(v,c)),k=[{value:v.length>0?v.join(",")||null:void 0}];else if(vr(d))k=d;else{const A=Object.keys(v);k=u?A.sort(u):A}const E=l?String(e).replace(/\./g,"%2E"):String(e),P=s&&vr(v)&&v.length===1?E+"[]":E;if(a&&vr(v)&&v.length===0)return P+"[]";for(let A=0;A<k.length;++A){const C=k[A],T=typeof C=="object"&&typeof C.value<"u"?C.value:v[C];if(o&&T===null)continue;const I=h&&l?C.replace(/\./g,"%2E"):C,V=vr(v)?typeof n=="function"?n(P,I):P:P+(h?"."+I:"["+I+"]");y.set(t,j);const ne=new WeakMap;ne.set(Kx,y),RA(N,MA(T,V,n,s,a,i,o,l,n==="comma"&&x&&vr(v)?null:c,d,u,h,m,p,b,x,g,ne))}return N}function jq(t=bn){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||bn.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=DA;if(typeof t.format<"u"){if(!oy(BN,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const s=BN[n];let a=bn.filter;(typeof t.filter=="function"||vr(t.filter))&&(a=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in TA?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=bn.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:bn.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:bn.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:bn.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:bn.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?bn.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:bn.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:bn.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:bn.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:bn.encodeValuesOnly,filter:a,format:n,formatter:s,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:bn.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:bn.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:bn.strictNullHandling}}function _q(t,e={}){let n=t;const s=jq(e);let a,i;typeof s.filter=="function"?(i=s.filter,n=i("",n)):vr(s.filter)&&(i=s.filter,a=i);const o=[];if(typeof n!="object"||n===null)return"";const l=TA[s.arrayFormat],c=l==="comma"&&s.commaRoundTrip;a||(a=Object.keys(n)),s.sort&&a.sort(s.sort);const d=new WeakMap;for(let m=0;m<a.length;++m){const p=a[m];s.skipNulls&&n[p]===null||RA(o,MA(n[p],p,l,c,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,d))}const u=o.join(s.delimiter);let h=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),u.length>0?h+u:""}function Nq(t){let e=0;for(const a of t)e+=a.length;const n=new Uint8Array(e);let s=0;for(const a of t)n.set(a,s),s+=a.length;return n}let zN;function vw(t){let e;return(zN??(e=new globalThis.TextEncoder,zN=e.encode.bind(e)))(t)}let UN;function qN(t){let e;return(UN??(e=new globalThis.TextDecoder,UN=e.decode.bind(e)))(t)}var Ar,Dr;class Q0{constructor(){Ar.set(this,void 0),Dr.set(this,void 0),ct(this,Ar,new Uint8Array),ct(this,Dr,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?vw(e):e;ct(this,Ar,Nq([ie(this,Ar,"f"),n]));const s=[];let a;for(;(a=Sq(ie(this,Ar,"f"),ie(this,Dr,"f")))!=null;){if(a.carriage&&ie(this,Dr,"f")==null){ct(this,Dr,a.index);continue}if(ie(this,Dr,"f")!=null&&(a.index!==ie(this,Dr,"f")+1||a.carriage)){s.push(qN(ie(this,Ar,"f").subarray(0,ie(this,Dr,"f")-1))),ct(this,Ar,ie(this,Ar,"f").subarray(ie(this,Dr,"f"))),ct(this,Dr,null);continue}const i=ie(this,Dr,"f")!==null?a.preceding-1:a.preceding,o=qN(ie(this,Ar,"f").subarray(0,i));s.push(o),ct(this,Ar,ie(this,Ar,"f").subarray(a.index)),ct(this,Dr,null)}return s}flush(){return ie(this,Ar,"f").length?this.decode(`
`):[]}}Ar=new WeakMap,Dr=new WeakMap;Q0.NEWLINE_CHARS=new Set([`
`,"\r"]);Q0.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Sq(t,e){for(let a=e??0;a<t.length;a++){if(t[a]===10)return{preceding:a,index:a+1,carriage:!1};if(t[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function kq(t){for(let s=0;s<t.length-1;s++){if(t[s]===10&&t[s+1]===10||t[s]===13&&t[s+1]===13)return s+2;if(t[s]===13&&t[s+1]===10&&s+3<t.length&&t[s+2]===13&&t[s+3]===10)return s+4}return-1}const $f={off:0,error:200,warn:300,info:400,debug:500},WN=(t,e,n)=>{if(t){if(oq($f,t))return t;Ln(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys($f))}`)}};function yd(){}function nm(t,e,n){return!e||$f[t]>$f[n]?yd:e[t].bind(e)}const Cq={error:yd,warn:yd,info:yd,debug:yd};let HN=new WeakMap;function Ln(t){const e=t.logger,n=t.logLevel??"off";if(!e)return Cq;const s=HN.get(e);if(s&&s[0]===n)return s[1];const a={error:nm("error",e,n),warn:nm("warn",e,n),info:nm("info",e,n),debug:nm("debug",e,n)};return HN.set(e,[n,a]),a}const lo=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var od;class Js{constructor(e,n,s){this.iterator=e,od.set(this,void 0),this.controller=n,ct(this,od,s)}static fromSSEResponse(e,n,s){let a=!1;const i=s?Ln(s):console;async function*o(){if(a)throw new rt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let l=!1;try{for await(const c of Eq(e,n))if(!l){if(c.data.startsWith("[DONE]")){l=!0;continue}if(c.event===null||!c.event.startsWith("thread.")){let d;try{d=JSON.parse(c.data)}catch(u){throw i.error("Could not parse message into JSON:",c.data),i.error("From chunk:",c.raw),u}if(d&&d.error)throw new Hn(void 0,d.error,void 0,e.headers);yield d}else{let d;try{d=JSON.parse(c.data)}catch(u){throw console.error("Could not parse message into JSON:",c.data),console.error("From chunk:",c.raw),u}if(c.event=="error")throw new Hn(void 0,d.error,d.message,void 0);yield{event:c.event,data:d}}}l=!0}catch(c){if(ay(c))return;throw c}finally{l||n.abort()}}return new Js(o,n,s)}static fromReadableStream(e,n,s){let a=!1;async function*i(){const l=new Q0,c=AA(e);for await(const d of c)for(const u of l.decode(d))yield u;for(const d of l.flush())yield d}async function*o(){if(a)throw new rt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let l=!1;try{for await(const c of i())l||c&&(yield JSON.parse(c));l=!0}catch(c){if(ay(c))return;throw c}finally{l||n.abort()}}return new Js(o,n,s)}[(od=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],n=[],s=this.iterator(),a=i=>({next:()=>{if(i.length===0){const o=s.next();e.push(o),n.push(o)}return i.shift()}});return[new Js(()=>a(e),this.controller,ie(this,od,"f")),new Js(()=>a(n),this.controller,ie(this,od,"f"))]}toReadableStream(){const e=this;let n;return CA({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:a,done:i}=await n.next();if(i)return s.close();const o=vw(JSON.stringify(a)+`
`);s.enqueue(o)}catch(a){s.error(a)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*Eq(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new rt("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new rt("Attempted to iterate over a response with no body");const n=new Dq,s=new Q0,a=AA(t.body);for await(const i of Aq(a))for(const o of s.decode(i)){const l=n.decode(o);l&&(yield l)}for(const i of s.flush()){const o=n.decode(i);o&&(yield o)}}async function*Aq(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const s=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?vw(n):n;let a=new Uint8Array(e.length+s.length);a.set(e),a.set(s,e.length),e=a;let i;for(;(i=kq(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class Dq{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,s,a]=Pq(e,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}function Pq(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function IA(t,e){const{response:n,requestLogID:s,retryOfRequestLogID:a,startTime:i}=e,o=await(async()=>{var h;if(e.options.stream)return Ln(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Js.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const l=n.headers.get("content-type"),c=(h=l==null?void 0:l.split(";")[0])==null?void 0:h.trim();if((c==null?void 0:c.includes("application/json"))||(c==null?void 0:c.endsWith("+json"))){const m=await n.json();return OA(m,n)}return await n.text()})();return Ln(t).debug(`[${s}] response parsed`,lo({retryOfRequestLogID:a,url:n.url,status:n.status,body:o,durationMs:Date.now()-i})),o}function OA(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var bd;class Y0 extends Promise{constructor(e,n,s=IA){super(a=>{a(null)}),this.responsePromise=n,this.parseResponse=s,bd.set(this,void 0),ct(this,bd,e)}_thenUnwrap(e){return new Y0(ie(this,bd,"f"),this.responsePromise,async(n,s)=>OA(e(await this.parseResponse(n,s),s),s.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(ie(this,bd,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}bd=new WeakMap;var rm;class yw{constructor(e,n,s,a){rm.set(this,void 0),ct(this,rm,e),this.options=a,this.response=n,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new rt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await ie(this,rm,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(rm=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class Tq extends Y0{constructor(e,n,s){super(e,n,async(a,i)=>new s(a,i.response,await IA(a,i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class J0 extends yw{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class vn extends yw{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var s;const e=this.getPaginatedItems(),n=(s=e[e.length-1])==null?void 0:s.id;return n?{...this.options,query:{...kA(this.options.query),after:n}}:null}}class Rq extends yw{constructor(e,n,s,a){super(e,n,s,a),this.data=s.data||[],this.has_more=s.has_more||!1,this.last_id=s.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...kA(this.options.query),after:e}}:null}}const FA=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)==null?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Kd(t,e,n){return FA(),new File(t,e??"unknown_file",n)}function Tm(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const BA=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",zo=async(t,e)=>({...t,body:await Iq(t.body,e)}),VN=new WeakMap;function Mq(t){const e=typeof t=="function"?t:t.fetch,n=VN.get(e);if(n)return n;const s=(async()=>{try{const a="Response"in e?e.Response:(await e("data:,")).constructor,i=new FormData;return i.toString()!==await new a(i).text()}catch{return!0}})();return VN.set(e,s),s}const Iq=async(t,e)=>{if(!await Mq(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([s,a])=>ly(n,s,a))),n},Oq=t=>t instanceof Blob&&"name"in t,ly=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,Kd([await n.blob()],Tm(n)));else if(BA(n))t.append(e,Kd([await new Response(EA(n)).blob()],Tm(n)));else if(Oq(n))t.append(e,n,Tm(n));else if(Array.isArray(n))await Promise.all(n.map(s=>ly(t,e+"[]",s)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([s,a])=>ly(t,`${e}[${s}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},LA=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Fq=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&LA(t),Bq=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function Lq(t,e,n){if(FA(),t=await t,Fq(t))return t instanceof File?t:Kd([await t.arrayBuffer()],t.name);if(Bq(t)){const a=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Kd(await cy(a),e,n)}const s=await cy(t);if(e||(e=Tm(t)),!(n!=null&&n.type)){const a=s.find(i=>typeof i=="object"&&"type"in i&&i.type);typeof a=="string"&&(n={...n,type:a})}return Kd(s,e,n)}async function cy(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(LA(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(BA(t))for await(const s of t)e.push(...await cy(s));else{const s=(n=t==null?void 0:t.constructor)==null?void 0:n.name;throw new Error(`Unexpected data type: ${typeof t}${s?`; constructor: ${s}`:""}${$q(t)}`)}return e}function $q(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class at{constructor(e){this._client=e}}function $A(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const KN=Object.freeze(Object.create(null)),zq=(t=$A)=>function(n,...s){if(n.length===1)return n[0];let a=!1;const i=[],o=n.reduce((u,h,m)=>{var x;/[?#]/.test(h)&&(a=!0);const p=s[m];let b=(a?encodeURIComponent:t)(""+p);return m!==s.length&&(p==null||typeof p=="object"&&p.toString===((x=Object.getPrototypeOf(Object.getPrototypeOf(p.hasOwnProperty??KN)??KN))==null?void 0:x.toString))&&(b=p+"",i.push({start:u.length+h.length,length:b.length,error:`Value of type ${Object.prototype.toString.call(p).slice(8,-1)} is not a valid path parameter`})),u+h+(m===s.length?"":b)},""),l=o.split(/[?#]/,1)[0],c=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let d;for(;(d=c.exec(l))!==null;)i.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(i.sort((u,h)=>u.start-h.start),i.length>0){let u=0;const h=i.reduce((m,p)=>{const b=" ".repeat(p.start-u),x="^".repeat(p.length);return u=p.start+p.length,m+b+x},"");throw new rt(`Path parameters result in path with invalid segments:
${i.map(m=>m.error).join(`
`)}
${o}
${h}`)}return o},Ce=zq($A);let zA=class extends at{list(e,n={},s){return this._client.getAPIList(Ce`/chat/completions/${e}/messages`,vn,{query:n,...s})}};function zf(t){return t!==void 0&&"function"in t&&t.function!==void 0}function bw(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function ch(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function Uq(t,e){return!e||!UA(e)?{...t,choices:t.choices.map(n=>(qA(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:ww(t,e)}function ww(t,e){const n=t.choices.map(s=>{var a;if(s.finish_reason==="length")throw new NA;if(s.finish_reason==="content_filter")throw new SA;return qA(s.message.tool_calls),{...s,message:{...s.message,...s.message.tool_calls?{tool_calls:((a=s.message.tool_calls)==null?void 0:a.map(i=>Wq(e,i)))??void 0}:void 0,parsed:s.message.content&&!s.message.refusal?qq(e,s.message.content):null}}});return{...t,choices:n}}function qq(t,e){var n,s;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((s=t.response_format)==null?void 0:s.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function Wq(t,e){var s;const n=(s=t.tools)==null?void 0:s.find(a=>{var i;return zf(a)&&((i=a.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:ch(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function Hq(t,e){var s;if(!t||!("tools"in t)||!t.tools)return!1;const n=(s=t.tools)==null?void 0:s.find(a=>{var i;return zf(a)&&((i=a.function)==null?void 0:i.name)===e.function.name});return zf(n)&&(ch(n)||(n==null?void 0:n.function.strict)||!1)}function UA(t){var e;return bw(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>ch(n)||n.type==="function"&&n.function.strict===!0))??!1}function qA(t){for(const e of t||[])if(e.type!=="function")throw new rt(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function Vq(t){for(const e of t??[]){if(e.type!=="function")throw new rt(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new rt(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const Uf=t=>(t==null?void 0:t.role)==="assistant",WA=t=>(t==null?void 0:t.role)==="tool";var dy,Rm,Mm,wd,jd,Im,_d,ja,Nd,qf,Wf,bl,HA;class jw{constructor(){dy.add(this),this.controller=new AbortController,Rm.set(this,void 0),Mm.set(this,()=>{}),wd.set(this,()=>{}),jd.set(this,void 0),Im.set(this,()=>{}),_d.set(this,()=>{}),ja.set(this,{}),Nd.set(this,!1),qf.set(this,!1),Wf.set(this,!1),bl.set(this,!1),ct(this,Rm,new Promise((e,n)=>{ct(this,Mm,e,"f"),ct(this,wd,n,"f")})),ct(this,jd,new Promise((e,n)=>{ct(this,Im,e,"f"),ct(this,_d,n,"f")})),ie(this,Rm,"f").catch(()=>{}),ie(this,jd,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},ie(this,dy,"m",HA).bind(this))},0)}_connected(){this.ended||(ie(this,Mm,"f").call(this),this._emit("connect"))}get ended(){return ie(this,Nd,"f")}get errored(){return ie(this,qf,"f")}get aborted(){return ie(this,Wf,"f")}abort(){this.controller.abort()}on(e,n){return(ie(this,ja,"f")[e]||(ie(this,ja,"f")[e]=[])).push({listener:n}),this}off(e,n){const s=ie(this,ja,"f")[e];if(!s)return this;const a=s.findIndex(i=>i.listener===n);return a>=0&&s.splice(a,1),this}once(e,n){return(ie(this,ja,"f")[e]||(ie(this,ja,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,s)=>{ct(this,bl,!0),e!=="error"&&this.once("error",s),this.once(e,n)})}async done(){ct(this,bl,!0),await ie(this,jd,"f")}_emit(e,...n){if(ie(this,Nd,"f"))return;e==="end"&&(ct(this,Nd,!0),ie(this,Im,"f").call(this));const s=ie(this,ja,"f")[e];if(s&&(ie(this,ja,"f")[e]=s.filter(a=>!a.once),s.forEach(({listener:a})=>a(...n))),e==="abort"){const a=n[0];!ie(this,bl,"f")&&!(s!=null&&s.length)&&Promise.reject(a),ie(this,wd,"f").call(this,a),ie(this,_d,"f").call(this,a),this._emit("end");return}if(e==="error"){const a=n[0];!ie(this,bl,"f")&&!(s!=null&&s.length)&&Promise.reject(a),ie(this,wd,"f").call(this,a),ie(this,_d,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Rm=new WeakMap,Mm=new WeakMap,wd=new WeakMap,jd=new WeakMap,Im=new WeakMap,_d=new WeakMap,ja=new WeakMap,Nd=new WeakMap,qf=new WeakMap,Wf=new WeakMap,bl=new WeakMap,dy=new WeakSet,HA=function(e){if(ct(this,qf,!0),e instanceof Error&&e.name==="AbortError"&&(e=new ns),e instanceof ns)return ct(this,Wf,!0),this._emit("abort",e);if(e instanceof rt)return this._emit("error",e);if(e instanceof Error){const n=new rt(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new rt(String(e)))};function Kq(t){return typeof t.parse=="function"}var rr,uy,Hf,hy,my,fy,VA,KA;const Gq=10;class GA extends jw{constructor(){super(...arguments),rr.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var s;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(s=e.choices[0])==null?void 0:s.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),WA(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(Uf(e)&&e.tool_calls)for(const s of e.tool_calls)s.type==="function"&&this._emit("functionToolCall",s.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new rt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),ie(this,rr,"m",uy).call(this)}async finalMessage(){return await this.done(),ie(this,rr,"m",Hf).call(this)}async finalFunctionToolCall(){return await this.done(),ie(this,rr,"m",hy).call(this)}async finalFunctionToolCallResult(){return await this.done(),ie(this,rr,"m",my).call(this)}async totalUsage(){return await this.done(),ie(this,rr,"m",fy).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=ie(this,rr,"m",Hf).call(this);n&&this._emit("finalMessage",n);const s=ie(this,rr,"m",uy).call(this);s&&this._emit("finalContent",s);const a=ie(this,rr,"m",hy).call(this);a&&this._emit("finalFunctionToolCall",a);const i=ie(this,rr,"m",my).call(this);i!=null&&this._emit("finalFunctionToolCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",ie(this,rr,"m",fy).call(this))}async _createChatCompletion(e,n,s){const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ie(this,rr,"m",VA).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(ww(i,n))}async _runChatCompletion(e,n,s){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(e,n,s)}async _runTools(e,n,s){var p,b,x;const a="tool",{tool_choice:i="auto",stream:o,...l}=n,c=typeof i!="string"&&i.type==="function"&&((p=i==null?void 0:i.function)==null?void 0:p.name),{maxChatCompletions:d=Gq}=s||{},u=n.tools.map(g=>{if(ch(g)){if(!g.$callback)throw new rt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:g.$callback,name:g.function.name,description:g.function.description||"",parameters:g.function.parameters,parse:g.$parseRaw,strict:!0}}}return g}),h={};for(const g of u)g.type==="function"&&(h[g.function.name||g.function.function.name]=g.function);const m="tools"in n?u.map(g=>g.type==="function"?{type:"function",function:{name:g.function.name||g.function.function.name,parameters:g.function.parameters,description:g.function.description,strict:g.function.strict}}:g):void 0;for(const g of n.messages)this._addMessage(g,!1);for(let g=0;g<d;++g){const v=(b=(await this._createChatCompletion(e,{...l,tool_choice:i,tools:m,messages:[...this.messages]},s)).choices[0])==null?void 0:b.message;if(!v)throw new rt("missing message in ChatCompletion response");if(!((x=v.tool_calls)!=null&&x.length))return;for(const w of v.tool_calls){if(w.type!=="function")continue;const j=w.id,{name:S,arguments:N}=w.function,k=h[S];if(k){if(c&&c!==S){const C=`Invalid tool_call: ${JSON.stringify(S)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:a,tool_call_id:j,content:C});continue}}else{const C=`Invalid tool_call: ${JSON.stringify(S)}. Available options are: ${Object.keys(h).map(T=>JSON.stringify(T)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:j,content:C});continue}let E;try{E=Kq(k)?await k.parse(N):N}catch(C){const T=C instanceof Error?C.message:String(C);this._addMessage({role:a,tool_call_id:j,content:T});continue}const P=await k.function(E,this),A=ie(this,rr,"m",KA).call(this,P);if(this._addMessage({role:a,tool_call_id:j,content:A}),c)return}}}}rr=new WeakSet,uy=function(){return ie(this,rr,"m",Hf).call(this).content??null},Hf=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Uf(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new rt("stream ended without producing a ChatCompletionMessage with role=assistant")},hy=function(){var e,n;for(let s=this.messages.length-1;s>=0;s--){const a=this.messages[s];if(Uf(a)&&((e=a==null?void 0:a.tool_calls)!=null&&e.length))return(n=a.tool_calls.filter(i=>i.type==="function").at(-1))==null?void 0:n.function}},my=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(WA(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(s=>{var a;return s.role==="assistant"&&((a=s.tool_calls)==null?void 0:a.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},fy=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},VA=function(e){if(e.n!=null&&e.n>1)throw new rt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},KA=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class _w extends GA{static runTools(e,n,s){const a=new _w,i={...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,i)),a}_addMessage(e,n=!0){super._addMessage(e,n),Uf(e)&&e.content&&this._emit("content",e.content)}}const ZA=1,QA=2,YA=4,JA=8,XA=16,eD=32,tD=64,nD=128,rD=256,sD=nD|rD,aD=XA|eD|sD|tD,iD=ZA|QA|aD,oD=YA|JA,Zq=iD|oD,An={STR:ZA,NUM:QA,ARR:YA,OBJ:JA,NULL:XA,BOOL:eD,NAN:tD,INFINITY:nD,MINUS_INFINITY:rD,INF:sD,SPECIAL:aD,ATOM:iD,COLLECTION:oD,ALL:Zq};class Qq extends Error{}class Yq extends Error{}function Jq(t,e=An.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return Xq(t.trim(),e)}const Xq=(t,e)=>{const n=t.length;let s=0;const a=m=>{throw new Qq(`${m} at position ${s}`)},i=m=>{throw new Yq(`${m} at position ${s}`)},o=()=>(h(),s>=n&&a("Unexpected end of input"),t[s]==='"'?l():t[s]==="{"?c():t[s]==="["?d():t.substring(s,s+4)==="null"||An.NULL&e&&n-s<4&&"null".startsWith(t.substring(s))?(s+=4,null):t.substring(s,s+4)==="true"||An.BOOL&e&&n-s<4&&"true".startsWith(t.substring(s))?(s+=4,!0):t.substring(s,s+5)==="false"||An.BOOL&e&&n-s<5&&"false".startsWith(t.substring(s))?(s+=5,!1):t.substring(s,s+8)==="Infinity"||An.INFINITY&e&&n-s<8&&"Infinity".startsWith(t.substring(s))?(s+=8,1/0):t.substring(s,s+9)==="-Infinity"||An.MINUS_INFINITY&e&&1<n-s&&n-s<9&&"-Infinity".startsWith(t.substring(s))?(s+=9,-1/0):t.substring(s,s+3)==="NaN"||An.NAN&e&&n-s<3&&"NaN".startsWith(t.substring(s))?(s+=3,NaN):u()),l=()=>{const m=s;let p=!1;for(s++;s<n&&(t[s]!=='"'||p&&t[s-1]==="\\");)p=t[s]==="\\"?!p:!1,s++;if(t.charAt(s)=='"')try{return JSON.parse(t.substring(m,++s-Number(p)))}catch(b){i(String(b))}else if(An.STR&e)try{return JSON.parse(t.substring(m,s-Number(p))+'"')}catch{return JSON.parse(t.substring(m,t.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},c=()=>{s++,h();const m={};try{for(;t[s]!=="}";){if(h(),s>=n&&An.OBJ&e)return m;const p=l();h(),s++;try{const b=o();Object.defineProperty(m,p,{value:b,writable:!0,enumerable:!0,configurable:!0})}catch(b){if(An.OBJ&e)return m;throw b}h(),t[s]===","&&s++}}catch{if(An.OBJ&e)return m;a("Expected '}' at end of object")}return s++,m},d=()=>{s++;const m=[];try{for(;t[s]!=="]";)m.push(o()),h(),t[s]===","&&s++}catch{if(An.ARR&e)return m;a("Expected ']' at end of array")}return s++,m},u=()=>{if(s===0){t==="-"&&An.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t)}catch(p){if(An.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(p))}}const m=s;for(t[s]==="-"&&s++;t[s]&&!",]}".includes(t[s]);)s++;s==n&&!(An.NUM&e)&&a("Unterminated number literal");try{return JSON.parse(t.substring(m,s))}catch{t.substring(m,s)==="-"&&An.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t.substring(m,t.lastIndexOf("e")))}catch(b){i(String(b))}}},h=()=>{for(;s<n&&` 
\r	`.includes(t[s]);)s++};return o()},GN=t=>Jq(t,An.ALL^An.NUM);var yn,ga,cl,Ga,Gx,sm,Zx,Qx,Yx,am,Jx,ZN;class Mu extends GA{constructor(e){super(),yn.add(this),ga.set(this,void 0),cl.set(this,void 0),Ga.set(this,void 0),ct(this,ga,e),ct(this,cl,[])}get currentChatCompletionSnapshot(){return ie(this,Ga,"f")}static fromReadableStream(e){const n=new Mu(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,s){const a=new Mu(n);return a._run(()=>a._runChatCompletion(e,{...n,stream:!0},{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(e,n,s){var o;super._createChatCompletion;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ie(this,yn,"m",Gx).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const l of i)ie(this,yn,"m",Zx).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new ns;return this._addChatCompletion(ie(this,yn,"m",am).call(this))}async _fromReadableStream(e,n){var o;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),ie(this,yn,"m",Gx).call(this),this._connected();const a=Js.fromReadableStream(e,this.controller);let i;for await(const l of a)i&&i!==l.id&&this._addChatCompletion(ie(this,yn,"m",am).call(this)),ie(this,yn,"m",Zx).call(this,l),i=l.id;if((o=a.controller.signal)!=null&&o.aborted)throw new ns;return this._addChatCompletion(ie(this,yn,"m",am).call(this))}[(ga=new WeakMap,cl=new WeakMap,Ga=new WeakMap,yn=new WeakSet,Gx=function(){this.ended||ct(this,Ga,void 0)},sm=function(n){let s=ie(this,cl,"f")[n.index];return s||(s={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},ie(this,cl,"f")[n.index]=s,s)},Zx=function(n){var a,i,o,l,c,d,u,h,m,p,b,x,g,y,v;if(this.ended)return;const s=ie(this,yn,"m",ZN).call(this,n);this._emit("chunk",n,s);for(const w of n.choices){const j=s.choices[w.index];w.delta.content!=null&&((a=j.message)==null?void 0:a.role)==="assistant"&&((i=j.message)!=null&&i.content)&&(this._emit("content",w.delta.content,j.message.content),this._emit("content.delta",{delta:w.delta.content,snapshot:j.message.content,parsed:j.message.parsed})),w.delta.refusal!=null&&((o=j.message)==null?void 0:o.role)==="assistant"&&((l=j.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:w.delta.refusal,snapshot:j.message.refusal}),((c=w.logprobs)==null?void 0:c.content)!=null&&((d=j.message)==null?void 0:d.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(u=w.logprobs)==null?void 0:u.content,snapshot:((h=j.logprobs)==null?void 0:h.content)??[]}),((m=w.logprobs)==null?void 0:m.refusal)!=null&&((p=j.message)==null?void 0:p.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(b=w.logprobs)==null?void 0:b.refusal,snapshot:((x=j.logprobs)==null?void 0:x.refusal)??[]});const S=ie(this,yn,"m",sm).call(this,j);j.finish_reason&&(ie(this,yn,"m",Yx).call(this,j),S.current_tool_call_index!=null&&ie(this,yn,"m",Qx).call(this,j,S.current_tool_call_index));for(const N of w.delta.tool_calls??[])S.current_tool_call_index!==N.index&&(ie(this,yn,"m",Yx).call(this,j),S.current_tool_call_index!=null&&ie(this,yn,"m",Qx).call(this,j,S.current_tool_call_index)),S.current_tool_call_index=N.index;for(const N of w.delta.tool_calls??[]){const k=(g=j.message.tool_calls)==null?void 0:g[N.index];k!=null&&k.type&&((k==null?void 0:k.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(y=k.function)==null?void 0:y.name,index:N.index,arguments:k.function.arguments,parsed_arguments:k.function.parsed_arguments,arguments_delta:((v=N.function)==null?void 0:v.arguments)??""}):(k==null||k.type,void 0))}}},Qx=function(n,s){var o,l,c;if(ie(this,yn,"m",sm).call(this,n).done_tool_calls.has(s))return;const i=(o=n.message.tool_calls)==null?void 0:o[s];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const d=(c=(l=ie(this,ga,"f"))==null?void 0:l.tools)==null?void 0:c.find(u=>zf(u)&&u.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:s,arguments:i.function.arguments,parsed_arguments:ch(d)?d.$parseRaw(i.function.arguments):d!=null&&d.function.strict?JSON.parse(i.function.arguments):null})}else i.type},Yx=function(n){var a,i;const s=ie(this,yn,"m",sm).call(this,n);if(n.message.content&&!s.content_done){s.content_done=!0;const o=ie(this,yn,"m",Jx).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!s.refusal_done&&(s.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(a=n.logprobs)!=null&&a.content&&!s.logprobs_content_done&&(s.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!s.logprobs_refusal_done&&(s.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},am=function(){if(this.ended)throw new rt("stream has ended, this shouldn't happen");const n=ie(this,Ga,"f");if(!n)throw new rt("request ended without sending any chunks");return ct(this,Ga,void 0),ct(this,cl,[]),eW(n,ie(this,ga,"f"))},Jx=function(){var s;const n=(s=ie(this,ga,"f"))==null?void 0:s.response_format;return bw(n)?n:null},ZN=function(n){var s,a,i,o;let l=ie(this,Ga,"f");const{choices:c,...d}=n;l?Object.assign(l,d):l=ct(this,Ga,{...d,choices:[]});for(const{delta:u,finish_reason:h,index:m,logprobs:p=null,...b}of n.choices){let x=l.choices[m];if(x||(x=l.choices[m]={finish_reason:h,index:m,message:{},logprobs:p,...b}),p)if(!x.logprobs)x.logprobs=Object.assign({},p);else{const{content:N,refusal:k,...E}=p;Object.assign(x.logprobs,E),N&&((s=x.logprobs).content??(s.content=[]),x.logprobs.content.push(...N)),k&&((a=x.logprobs).refusal??(a.refusal=[]),x.logprobs.refusal.push(...k))}if(h&&(x.finish_reason=h,ie(this,ga,"f")&&UA(ie(this,ga,"f")))){if(h==="length")throw new NA;if(h==="content_filter")throw new SA}if(Object.assign(x,b),!u)continue;const{content:g,refusal:y,function_call:v,role:w,tool_calls:j,...S}=u;if(Object.assign(x.message,S),y&&(x.message.refusal=(x.message.refusal||"")+y),w&&(x.message.role=w),v&&(x.message.function_call?(v.name&&(x.message.function_call.name=v.name),v.arguments&&((i=x.message.function_call).arguments??(i.arguments=""),x.message.function_call.arguments+=v.arguments)):x.message.function_call=v),g&&(x.message.content=(x.message.content||"")+g,!x.message.refusal&&ie(this,yn,"m",Jx).call(this)&&(x.message.parsed=GN(x.message.content))),j){x.message.tool_calls||(x.message.tool_calls=[]);for(const{index:N,id:k,type:E,function:P,...A}of j){const C=(o=x.message.tool_calls)[N]??(o[N]={});Object.assign(C,A),k&&(C.id=k),E&&(C.type=E),P&&(C.function??(C.function={name:P.name??"",arguments:""})),P!=null&&P.name&&(C.function.name=P.name),P!=null&&P.arguments&&(C.function.arguments+=P.arguments,Hq(ie(this,ga,"f"),C)&&(C.function.parsed_arguments=GN(C.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("chunk",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Js(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function eW(t,e){const{id:n,choices:s,created:a,model:i,system_fingerprint:o,...l}=t,c={...l,id:n,choices:s.map(({message:d,finish_reason:u,index:h,logprobs:m,...p})=>{if(!u)throw new rt(`missing finish_reason for choice ${h}`);const{content:b=null,function_call:x,tool_calls:g,...y}=d,v=d.role;if(!v)throw new rt(`missing role for choice ${h}`);if(x){const{arguments:w,name:j}=x;if(w==null)throw new rt(`missing function_call.arguments for choice ${h}`);if(!j)throw new rt(`missing function_call.name for choice ${h}`);return{...p,message:{content:b,function_call:{arguments:w,name:j},role:v,refusal:d.refusal??null},finish_reason:u,index:h,logprobs:m}}return g?{...p,index:h,finish_reason:u,logprobs:m,message:{...y,role:v,content:b,refusal:d.refusal??null,tool_calls:g.map((w,j)=>{const{function:S,type:N,id:k,...E}=w,{arguments:P,name:A,...C}=S||{};if(k==null)throw new rt(`missing choices[${h}].tool_calls[${j}].id
${im(t)}`);if(N==null)throw new rt(`missing choices[${h}].tool_calls[${j}].type
${im(t)}`);if(A==null)throw new rt(`missing choices[${h}].tool_calls[${j}].function.name
${im(t)}`);if(P==null)throw new rt(`missing choices[${h}].tool_calls[${j}].function.arguments
${im(t)}`);return{...E,id:k,type:N,function:{...C,name:A,arguments:P}}})}}:{...p,message:{...y,content:b,role:v,refusal:d.refusal??null},finish_reason:u,index:h,logprobs:m}}),created:a,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return Uq(c,e)}function im(t){return JSON.stringify(t)}class Vf extends Mu{static fromReadableStream(e){const n=new Vf(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,s){const a=new Vf(n),i={...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,i)),a}}let Nw=class extends at{constructor(){super(...arguments),this.messages=new zA(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(Ce`/chat/completions/${e}`,n)}update(e,n,s){return this._client.post(Ce`/chat/completions/${e}`,{body:n,...s})}list(e={},n){return this._client.getAPIList("/chat/completions",vn,{query:e,...n})}delete(e,n){return this._client.delete(Ce`/chat/completions/${e}`,n)}parse(e,n){return Vq(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(s=>ww(s,e))}runTools(e,n){return e.stream?Vf.runTools(this._client,e,n):_w.runTools(this._client,e,n)}stream(e,n){return Mu.createChatCompletion(this._client,e,n)}};Nw.Messages=zA;class Sw extends at{constructor(){super(...arguments),this.completions=new Nw(this._client)}}Sw.Completions=Nw;const lD=Symbol("brand.privateNullableHeaders");function*tW(t){if(!t)return;if(lD in t){const{values:s,nulls:a}=t;yield*s.entries();for(const i of a)yield[i,null];return}let e=!1,n;t instanceof Headers?n=t.entries():MN(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let s of n){const a=s[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const i=MN(s[1])?s[1]:[s[1]];let o=!1;for(const l of i)l!==void 0&&(e&&!o&&(o=!0,yield[a,null]),yield[a,l])}}const Ge=t=>{const e=new Headers,n=new Set;for(const s of t){const a=new Set;for(const[i,o]of tW(s)){const l=i.toLowerCase();a.has(l)||(e.delete(i),a.add(l)),o===null?(e.delete(i),n.add(l)):(e.append(i,o),n.delete(l))}}return{[lD]:!0,values:e,nulls:n}};class cD extends at{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:Ge([{Accept:"application/octet-stream"},n==null?void 0:n.headers]),__binaryResponse:!0})}}class dD extends at{create(e,n){return this._client.post("/audio/transcriptions",zo({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class uD extends at{create(e,n){return this._client.post("/audio/translations",zo({body:e,...n,__metadata:{model:e.model}},this._client))}}class dh extends at{constructor(){super(...arguments),this.transcriptions=new dD(this._client),this.translations=new uD(this._client),this.speech=new cD(this._client)}}dh.Transcriptions=dD;dh.Translations=uD;dh.Speech=cD;class hD extends at{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(Ce`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",vn,{query:e,...n})}cancel(e,n){return this._client.post(Ce`/batches/${e}/cancel`,n)}}class mD extends at{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(Ce`/assistants/${e}`,{...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,s){return this._client.post(Ce`/assistants/${e}`,{body:n,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e={},n){return this._client.getAPIList("/assistants",vn,{query:e,...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(Ce`/assistants/${e}`,{...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class fD extends at{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class pD extends at{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class X0 extends at{constructor(){super(...arguments),this.sessions=new fD(this._client),this.transcriptionSessions=new pD(this._client)}}X0.Sessions=fD;X0.TranscriptionSessions=pD;class xD extends at{create(e,n,s){return this._client.post(Ce`/threads/${e}/messages`,{body:n,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(e,n,s){const{thread_id:a}=n;return this._client.get(Ce`/threads/${a}/messages/${e}`,{...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(e,n,s){const{thread_id:a,...i}=n;return this._client.post(Ce`/threads/${a}/messages/${e}`,{body:i,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e,n={},s){return this._client.getAPIList(Ce`/threads/${e}/messages`,vn,{query:n,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(e,n,s){const{thread_id:a}=n;return this._client.delete(Ce`/threads/${a}/messages/${e}`,{...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class gD extends at{retrieve(e,n,s){const{thread_id:a,run_id:i,...o}=n;return this._client.get(Ce`/threads/${a}/runs/${i}/steps/${e}`,{query:o,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e,n,s){const{thread_id:a,...i}=n;return this._client.getAPIList(Ce`/threads/${a}/runs/${e}/steps`,vn,{query:i,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}const nW=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,s=new Uint8Array(n);for(let a=0;a<n;a++)s[a]=e.charCodeAt(a);return Array.from(new Float32Array(s.buffer))}};var Xx={};const dl=t=>{var e,n,s,a;if(typeof globalThis.process<"u")return((e=Xx==null?void 0:Xx[t])==null?void 0:e.trim())??void 0;if(typeof globalThis.Deno<"u")return(a=(s=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:s.call(n,t))==null?void 0:a.trim()};var $n,xo,py,Us,Om,fs,go,Fl,ho,Kf,Pr,Fm,Bm,Gd,Sd,kd,QN,YN,JN,XN,e2,t2,n2;class Zd extends jw{constructor(){super(...arguments),$n.add(this),py.set(this,[]),Us.set(this,{}),Om.set(this,{}),fs.set(this,void 0),go.set(this,void 0),Fl.set(this,void 0),ho.set(this,void 0),Kf.set(this,void 0),Pr.set(this,void 0),Fm.set(this,void 0),Bm.set(this,void 0),Gd.set(this,void 0)}[(py=new WeakMap,Us=new WeakMap,Om=new WeakMap,fs=new WeakMap,go=new WeakMap,Fl=new WeakMap,ho=new WeakMap,Kf=new WeakMap,Pr=new WeakMap,Fm=new WeakMap,Bm=new WeakMap,Gd=new WeakMap,$n=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("event",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new xo;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const s=n==null?void 0:n.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Js.fromReadableStream(e,this.controller);for await(const o of a)ie(this,$n,"m",Sd).call(this,o);if((i=a.controller.signal)!=null&&i.aborted)throw new ns;return this._addRun(ie(this,$n,"m",kd).call(this))}toReadableStream(){return new Js(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,s,a){const i=new xo;return i._run(()=>i._runToolAssistantStream(e,n,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,n,s,a){var c;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},l=await e.submitToolOutputs(n,o,{...a,signal:this.controller.signal});this._connected();for await(const d of l)ie(this,$n,"m",Sd).call(this,d);if((c=l.controller.signal)!=null&&c.aborted)throw new ns;return this._addRun(ie(this,$n,"m",kd).call(this))}static createThreadAssistantStream(e,n,s){const a=new xo;return a._run(()=>a._threadAssistantStream(e,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(e,n,s,a){const i=new xo;return i._run(()=>i._runAssistantStream(e,n,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return ie(this,Fm,"f")}currentRun(){return ie(this,Bm,"f")}currentMessageSnapshot(){return ie(this,fs,"f")}currentRunStepSnapshot(){return ie(this,Gd,"f")}async finalRunSteps(){return await this.done(),Object.values(ie(this,Us,"f"))}async finalMessages(){return await this.done(),Object.values(ie(this,Om,"f"))}async finalRun(){if(await this.done(),!ie(this,go,"f"))throw Error("Final run was not received.");return ie(this,go,"f")}async _createThreadAssistantStream(e,n,s){var l;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...s,signal:this.controller.signal});this._connected();for await(const c of o)ie(this,$n,"m",Sd).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new ns;return this._addRun(ie(this,$n,"m",kd).call(this))}async _createAssistantStream(e,n,s,a){var c;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},l=await e.create(n,o,{...a,signal:this.controller.signal});this._connected();for await(const d of l)ie(this,$n,"m",Sd).call(this,d);if((c=l.controller.signal)!=null&&c.aborted)throw new ns;return this._addRun(ie(this,$n,"m",kd).call(this))}static accumulateDelta(e,n){for(const[s,a]of Object.entries(n)){if(!e.hasOwnProperty(s)){e[s]=a;continue}let i=e[s];if(i==null){e[s]=a;continue}if(s==="index"||s==="type"){e[s]=a;continue}if(typeof i=="string"&&typeof a=="string")i+=a;else if(typeof i=="number"&&typeof a=="number")i+=a;else if(Hx(i)&&Hx(a))i=this.accumulateDelta(i,a);else if(Array.isArray(i)&&Array.isArray(a)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...a);continue}for(const o of a){if(!Hx(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const c=i[l];c==null?i.push(o):i[l]=this.accumulateDelta(c,o)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${a}, accValue: ${i}`);e[s]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,s){return await this._createThreadAssistantStream(n,e,s)}async _runAssistantStream(e,n,s,a){return await this._createAssistantStream(n,e,s,a)}async _runToolAssistantStream(e,n,s,a){return await this._createToolAssistantStream(n,e,s,a)}}xo=Zd,Sd=function(e){if(!this.ended)switch(ct(this,Fm,e),ie(this,$n,"m",JN).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":ie(this,$n,"m",n2).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ie(this,$n,"m",YN).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":ie(this,$n,"m",QN).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},kd=function(){if(this.ended)throw new rt("stream has ended, this shouldn't happen");if(!ie(this,go,"f"))throw Error("Final run has not been received");return ie(this,go,"f")},QN=function(e){const[n,s]=ie(this,$n,"m",e2).call(this,e,ie(this,fs,"f"));ct(this,fs,n),ie(this,Om,"f")[n.id]=n;for(const a of s){const i=n.content[a.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const a of e.data.delta.content){if(a.type=="text"&&a.text){let i=a.text,o=n.content[a.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=ie(this,Fl,"f")){if(ie(this,ho,"f"))switch(ie(this,ho,"f").type){case"text":this._emit("textDone",ie(this,ho,"f").text,ie(this,fs,"f"));break;case"image_file":this._emit("imageFileDone",ie(this,ho,"f").image_file,ie(this,fs,"f"));break}ct(this,Fl,a.index)}ct(this,ho,n.content[a.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(ie(this,Fl,"f")!==void 0){const a=e.data.content[ie(this,Fl,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,ie(this,fs,"f"));break;case"text":this._emit("textDone",a.text,ie(this,fs,"f"));break}}ie(this,fs,"f")&&this._emit("messageDone",e.data),ct(this,fs,void 0)}},YN=function(e){const n=ie(this,$n,"m",XN).call(this,e);switch(ct(this,Gd,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const s=e.data.delta;if(s.step_details&&s.step_details.type=="tool_calls"&&s.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of s.step_details.tool_calls)i.index==ie(this,Kf,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(ie(this,Pr,"f")&&this._emit("toolCallDone",ie(this,Pr,"f")),ct(this,Kf,i.index),ct(this,Pr,n.step_details.tool_calls[i.index]),ie(this,Pr,"f")&&this._emit("toolCallCreated",ie(this,Pr,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ct(this,Gd,void 0),e.data.step_details.type=="tool_calls"&&ie(this,Pr,"f")&&(this._emit("toolCallDone",ie(this,Pr,"f")),ct(this,Pr,void 0)),this._emit("runStepDone",e.data,n);break}},JN=function(e){ie(this,py,"f").push(e),this._emit("event",e)},XN=function(e){switch(e.event){case"thread.run.step.created":return ie(this,Us,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=ie(this,Us,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let s=e.data;if(s.delta){const a=xo.accumulateDelta(n,s.delta);ie(this,Us,"f")[e.data.id]=a}return ie(this,Us,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":ie(this,Us,"f")[e.data.id]=e.data;break}if(ie(this,Us,"f")[e.data.id])return ie(this,Us,"f")[e.data.id];throw new Error("No snapshot available")},e2=function(e,n){let s=[];switch(e.event){case"thread.message.created":return[e.data,s];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=e.data;if(a.delta.content)for(const i of a.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=ie(this,$n,"m",t2).call(this,i,o)}else n.content[i.index]=i,s.push(i);return[n,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},t2=function(e,n){return xo.accumulateDelta(n,e)},n2=function(e){switch(ct(this,Bm,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":ct(this,go,e.data),ie(this,Pr,"f")&&(this._emit("toolCallDone",ie(this,Pr,"f")),ct(this,Pr,void 0));break}};let kw=class extends at{constructor(){super(...arguments),this.steps=new gD(this._client)}create(e,n,s){const{include:a,...i}=n;return this._client.post(Ce`/threads/${e}/runs`,{query:{include:a},body:i,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers]),stream:n.stream??!1})}retrieve(e,n,s){const{thread_id:a}=n;return this._client.get(Ce`/threads/${a}/runs/${e}`,{...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(e,n,s){const{thread_id:a,...i}=n;return this._client.post(Ce`/threads/${a}/runs/${e}`,{body:i,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e,n={},s){return this._client.getAPIList(Ce`/threads/${e}/runs`,vn,{query:n,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}cancel(e,n,s){const{thread_id:a}=n;return this._client.post(Ce`/threads/${a}/runs/${e}/cancel`,{...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n,s);return await this.poll(a.id,{thread_id:e},s)}createAndStream(e,n,s){return Zd.createAssistantStream(e,this._client.beta.threads.runs,n,s)}async poll(e,n,s){var i;const a=Ge([s==null?void 0:s.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=s==null?void 0:s.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:l}=await this.retrieve(e,n,{...s,headers:{...s==null?void 0:s.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let c=5e3;if(s!=null&&s.pollIntervalMs)c=s.pollIntervalMs;else{const d=l.headers.get("openai-poll-after-ms");if(d){const u=parseInt(d);isNaN(u)||(c=u)}}await lh(c);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(e,n,s){return Zd.createAssistantStream(e,this._client.beta.threads.runs,n,s)}submitToolOutputs(e,n,s){const{thread_id:a,...i}=n;return this._client.post(Ce`/threads/${a}/runs/${e}/submit_tool_outputs`,{body:i,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,s){const a=await this.submitToolOutputs(e,n,s);return await this.poll(a.id,n,s)}submitToolOutputsStream(e,n,s){return Zd.createToolAssistantStream(e,this._client.beta.threads.runs,n,s)}};kw.Steps=gD;class ep extends at{constructor(){super(...arguments),this.runs=new kw(this._client),this.messages=new xD(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(Ce`/threads/${e}`,{...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,s){return this._client.post(Ce`/threads/${e}`,{body:n,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(e,n){return this._client.delete(Ce`/threads/${e}`,{...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const s=await this.createAndRun(e,n);return await this.runs.poll(s.id,{thread_id:s.thread_id},n)}createAndRunStream(e,n){return Zd.createThreadAssistantStream(e,this._client.beta.threads,n)}}ep.Runs=kw;ep.Messages=xD;class uh extends at{constructor(){super(...arguments),this.realtime=new X0(this._client),this.assistants=new mD(this._client),this.threads=new ep(this._client)}}uh.Realtime=X0;uh.Assistants=mD;uh.Threads=ep;class vD extends at{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let yD=class extends at{retrieve(e,n,s){const{container_id:a}=n;return this._client.get(Ce`/containers/${a}/files/${e}/content`,{...s,headers:Ge([{Accept:"application/binary"},s==null?void 0:s.headers]),__binaryResponse:!0})}},Cw=class extends at{constructor(){super(...arguments),this.content=new yD(this._client)}create(e,n,s){return this._client.post(Ce`/containers/${e}/files`,zo({body:n,...s},this._client))}retrieve(e,n,s){const{container_id:a}=n;return this._client.get(Ce`/containers/${a}/files/${e}`,s)}list(e,n={},s){return this._client.getAPIList(Ce`/containers/${e}/files`,vn,{query:n,...s})}delete(e,n,s){const{container_id:a}=n;return this._client.delete(Ce`/containers/${a}/files/${e}`,{...s,headers:Ge([{Accept:"*/*"},s==null?void 0:s.headers])})}};Cw.Content=yD;class Ew extends at{constructor(){super(...arguments),this.files=new Cw(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(Ce`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",vn,{query:e,...n})}delete(e,n){return this._client.delete(Ce`/containers/${e}`,{...n,headers:Ge([{Accept:"*/*"},n==null?void 0:n.headers])})}}Ew.Files=Cw;class bD extends at{create(e,n,s){const{include:a,...i}=n;return this._client.post(Ce`/conversations/${e}/items`,{query:{include:a},body:i,...s})}retrieve(e,n,s){const{conversation_id:a,...i}=n;return this._client.get(Ce`/conversations/${a}/items/${e}`,{query:i,...s})}list(e,n={},s){return this._client.getAPIList(Ce`/conversations/${e}/items`,Rq,{query:n,...s})}delete(e,n,s){const{conversation_id:a}=n;return this._client.delete(Ce`/conversations/${a}/items/${e}`,s)}}class Aw extends at{constructor(){super(...arguments),this.items=new bD(this._client)}create(e,n){return this._client.post("/conversations",{body:e,...n})}retrieve(e,n){return this._client.get(Ce`/conversations/${e}`,n)}update(e,n,s){return this._client.post(Ce`/conversations/${e}`,{body:n,...s})}delete(e,n){return this._client.delete(Ce`/conversations/${e}`,n)}}Aw.Items=bD;class wD extends at{create(e,n){const s=!!e.encoding_format;let a=s?e.encoding_format:"base64";s&&Ln(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:a},...n});return s?i:(Ln(this._client).debug("embeddings/decoding base64 embeddings from base64"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(l=>{const c=l.embedding;l.embedding=nW(c)}),o)))}}class jD extends at{retrieve(e,n,s){const{eval_id:a,run_id:i}=n;return this._client.get(Ce`/evals/${a}/runs/${i}/output_items/${e}`,s)}list(e,n,s){const{eval_id:a,...i}=n;return this._client.getAPIList(Ce`/evals/${a}/runs/${e}/output_items`,vn,{query:i,...s})}}class Dw extends at{constructor(){super(...arguments),this.outputItems=new jD(this._client)}create(e,n,s){return this._client.post(Ce`/evals/${e}/runs`,{body:n,...s})}retrieve(e,n,s){const{eval_id:a}=n;return this._client.get(Ce`/evals/${a}/runs/${e}`,s)}list(e,n={},s){return this._client.getAPIList(Ce`/evals/${e}/runs`,vn,{query:n,...s})}delete(e,n,s){const{eval_id:a}=n;return this._client.delete(Ce`/evals/${a}/runs/${e}`,s)}cancel(e,n,s){const{eval_id:a}=n;return this._client.post(Ce`/evals/${a}/runs/${e}`,s)}}Dw.OutputItems=jD;class Pw extends at{constructor(){super(...arguments),this.runs=new Dw(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(Ce`/evals/${e}`,n)}update(e,n,s){return this._client.post(Ce`/evals/${e}`,{body:n,...s})}list(e={},n){return this._client.getAPIList("/evals",vn,{query:e,...n})}delete(e,n){return this._client.delete(Ce`/evals/${e}`,n)}}Pw.Runs=Dw;let _D=class extends at{create(e,n){return this._client.post("/files",zo({body:e,...n},this._client))}retrieve(e,n){return this._client.get(Ce`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",vn,{query:e,...n})}delete(e,n){return this._client.delete(Ce`/files/${e}`,n)}content(e,n){return this._client.get(Ce`/files/${e}/content`,{...n,headers:Ge([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:s=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!a.has(o.status);)if(await lh(n),o=await this.retrieve(e),Date.now()-i>s)throw new gw({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return o}};class ND extends at{}let SD=class extends at{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class Tw extends at{constructor(){super(...arguments),this.graders=new SD(this._client)}}Tw.Graders=SD;class kD extends at{create(e,n,s){return this._client.getAPIList(Ce`/fine_tuning/checkpoints/${e}/permissions`,J0,{body:n,method:"post",...s})}retrieve(e,n={},s){return this._client.get(Ce`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...s})}delete(e,n,s){const{fine_tuned_model_checkpoint:a}=n;return this._client.delete(Ce`/fine_tuning/checkpoints/${a}/permissions/${e}`,s)}}let Rw=class extends at{constructor(){super(...arguments),this.permissions=new kD(this._client)}};Rw.Permissions=kD;class CD extends at{list(e,n={},s){return this._client.getAPIList(Ce`/fine_tuning/jobs/${e}/checkpoints`,vn,{query:n,...s})}}class Mw extends at{constructor(){super(...arguments),this.checkpoints=new CD(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(Ce`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",vn,{query:e,...n})}cancel(e,n){return this._client.post(Ce`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},s){return this._client.getAPIList(Ce`/fine_tuning/jobs/${e}/events`,vn,{query:n,...s})}pause(e,n){return this._client.post(Ce`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(Ce`/fine_tuning/jobs/${e}/resume`,n)}}Mw.Checkpoints=CD;class Vc extends at{constructor(){super(...arguments),this.methods=new ND(this._client),this.jobs=new Mw(this._client),this.checkpoints=new Rw(this._client),this.alpha=new Tw(this._client)}}Vc.Methods=ND;Vc.Jobs=Mw;Vc.Checkpoints=Rw;Vc.Alpha=Tw;class ED extends at{}class Iw extends at{constructor(){super(...arguments),this.graderModels=new ED(this._client)}}Iw.GraderModels=ED;class AD extends at{createVariation(e,n){return this._client.post("/images/variations",zo({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",zo({body:e,...n,stream:e.stream??!1},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n,stream:e.stream??!1})}}class DD extends at{retrieve(e,n){return this._client.get(Ce`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",J0,e)}delete(e,n){return this._client.delete(Ce`/models/${e}`,n)}}class PD extends at{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function rW(t,e){return!e||!aW(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(s=>({...s,parsed:null}))}:n)}:TD(t,e)}function TD(t,e){const n=t.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:lW(e,a)};if(a.type==="message"){const i=a.content.map(o=>o.type==="output_text"?{...o,parsed:sW(e,o.text)}:o);return{...a,content:i}}return a}),s=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||xy(s),Object.defineProperty(s,"output_parsed",{enumerable:!0,get(){for(const a of s.output)if(a.type==="message"){for(const i of a.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),s}function sW(t,e){var n,s,a,i;return((s=(n=t.text)==null?void 0:n.format)==null?void 0:s.type)!=="json_schema"?null:"$parseRaw"in((a=t.text)==null?void 0:a.format)?((i=t.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function aW(t){var e;return!!bw((e=t.text)==null?void 0:e.format)}function iW(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function oW(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function lW(t,e){const n=oW(t.tools??[],e.name);return{...e,...e,parsed_arguments:iW(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function xy(t){const e=[];for(const n of t.output)if(n.type==="message")for(const s of n.content)s.type==="output_text"&&e.push(s.text);t.output_text=e.join("")}var ul,om,Za,lm,r2,s2,a2,i2;class Ow extends jw{constructor(e){super(),ul.add(this),om.set(this,void 0),Za.set(this,void 0),lm.set(this,void 0),ct(this,om,e)}static createResponse(e,n,s){const a=new Ow(n);return a._run(()=>a._createOrRetrieveResponse(e,n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createOrRetrieveResponse(e,n,s){var l;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ie(this,ul,"m",r2).call(this);let i,o=null;"response_id"in n?(i=await e.responses.retrieve(n.response_id,{stream:!0},{...s,signal:this.controller.signal,stream:!0}),o=n.starting_after??null):i=await e.responses.create({...n,stream:!0},{...s,signal:this.controller.signal}),this._connected();for await(const c of i)ie(this,ul,"m",s2).call(this,c,o);if((l=i.controller.signal)!=null&&l.aborted)throw new ns;return ie(this,ul,"m",a2).call(this)}[(om=new WeakMap,Za=new WeakMap,lm=new WeakMap,ul=new WeakSet,r2=function(){this.ended||ct(this,Za,void 0)},s2=function(n,s){if(this.ended)return;const a=(o,l)=>{(s==null||l.sequence_number>s)&&this._emit(o,l)},i=ie(this,ul,"m",i2).call(this,n);switch(a("event",n),n.type){case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new rt(`missing output at index ${n.output_index}`);if(o.type==="message"){const l=o.content[n.content_index];if(!l)throw new rt(`missing content at index ${n.content_index}`);if(l.type!=="output_text")throw new rt(`expected content to be 'output_text', got ${l.type}`);a("response.output_text.delta",{...n,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new rt(`missing output at index ${n.output_index}`);o.type==="function_call"&&a("response.function_call_arguments.delta",{...n,snapshot:o.arguments});break}default:a(n.type,n);break}},a2=function(){if(this.ended)throw new rt("stream has ended, this shouldn't happen");const n=ie(this,Za,"f");if(!n)throw new rt("request ended without sending any events");ct(this,Za,void 0);const s=cW(n,ie(this,om,"f"));return ct(this,lm,s),s},i2=function(n){let s=ie(this,Za,"f");if(!s){if(n.type!=="response.created")throw new rt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return s=ct(this,Za,n.response),s}switch(n.type){case"response.output_item.added":{s.output.push(n.item);break}case"response.content_part.added":{const a=s.output[n.output_index];if(!a)throw new rt(`missing output at index ${n.output_index}`);a.type==="message"&&a.content.push(n.part);break}case"response.output_text.delta":{const a=s.output[n.output_index];if(!a)throw new rt(`missing output at index ${n.output_index}`);if(a.type==="message"){const i=a.content[n.content_index];if(!i)throw new rt(`missing content at index ${n.content_index}`);if(i.type!=="output_text")throw new rt(`expected content to be 'output_text', got ${i.type}`);i.text+=n.delta}break}case"response.function_call_arguments.delta":{const a=s.output[n.output_index];if(!a)throw new rt(`missing output at index ${n.output_index}`);a.type==="function_call"&&(a.arguments+=n.delta);break}case"response.completed":{ct(this,Za,n.response);break}}return s},Symbol.asyncIterator)](){const e=[],n=[];let s=!1;return this.on("event",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{s=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{s=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=ie(this,lm,"f");if(!e)throw new rt("stream ended without producing a ChatCompletion");return e}}function cW(t,e){return rW(t,e)}class RD extends at{list(e,n={},s){return this._client.getAPIList(Ce`/responses/${e}/input_items`,vn,{query:n,...s})}}class Fw extends at{constructor(){super(...arguments),this.inputItems=new RD(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&xy(s),s))}retrieve(e,n={},s){return this._client.get(Ce`/responses/${e}`,{query:n,...s,stream:(n==null?void 0:n.stream)??!1})._thenUnwrap(a=>("object"in a&&a.object==="response"&&xy(a),a))}delete(e,n){return this._client.delete(Ce`/responses/${e}`,{...n,headers:Ge([{Accept:"*/*"},n==null?void 0:n.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(s=>TD(s,e))}stream(e,n){return Ow.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(Ce`/responses/${e}/cancel`,n)}}Fw.InputItems=RD;class MD extends at{create(e,n,s){return this._client.post(Ce`/uploads/${e}/parts`,zo({body:n,...s},this._client))}}class Bw extends at{constructor(){super(...arguments),this.parts=new MD(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(Ce`/uploads/${e}/cancel`,n)}complete(e,n,s){return this._client.post(Ce`/uploads/${e}/complete`,{body:n,...s})}}Bw.Parts=MD;const dW=async t=>{const e=await Promise.allSettled(t),n=e.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const s=[];for(const a of e)a.status==="fulfilled"&&s.push(a.value);return s};class ID extends at{create(e,n,s){return this._client.post(Ce`/vector_stores/${e}/file_batches`,{body:n,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(e,n,s){const{vector_store_id:a}=n;return this._client.get(Ce`/vector_stores/${a}/file_batches/${e}`,{...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}cancel(e,n,s){const{vector_store_id:a}=n;return this._client.post(Ce`/vector_stores/${a}/file_batches/${e}/cancel`,{...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n);return await this.poll(e,a.id,s)}listFiles(e,n,s){const{vector_store_id:a,...i}=n;return this._client.getAPIList(Ce`/vector_stores/${a}/file_batches/${e}/files`,vn,{query:i,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async poll(e,n,s){var i;const a=Ge([s==null?void 0:s.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=s==null?void 0:s.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:l}=await this.retrieve(n,{vector_store_id:e},{...s,headers:a}).withResponse();switch(o.status){case"in_progress":let c=5e3;if(s!=null&&s.pollIntervalMs)c=s.pollIntervalMs;else{const d=l.headers.get("openai-poll-after-ms");if(d){const u=parseInt(d);isNaN(u)||(c=u)}}await lh(c);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(e,{files:n,fileIds:s=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(a==null?void 0:a.maxConcurrency)??5,o=Math.min(i,n.length),l=this._client,c=n.values(),d=[...s];async function u(m){for(let p of m){const b=await l.files.create({file:p,purpose:"assistants"},a);d.push(b.id)}}const h=Array(o).fill(c).map(u);return await dW(h),await this.createAndPoll(e,{file_ids:d})}}class OD extends at{create(e,n,s){return this._client.post(Ce`/vector_stores/${e}/files`,{body:n,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(e,n,s){const{vector_store_id:a}=n;return this._client.get(Ce`/vector_stores/${a}/files/${e}`,{...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(e,n,s){const{vector_store_id:a,...i}=n;return this._client.post(Ce`/vector_stores/${a}/files/${e}`,{body:i,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e,n={},s){return this._client.getAPIList(Ce`/vector_stores/${e}/files`,vn,{query:n,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(e,n,s){const{vector_store_id:a}=n;return this._client.delete(Ce`/vector_stores/${a}/files/${e}`,{...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}async createAndPoll(e,n,s){const a=await this.create(e,n,s);return await this.poll(e,a.id,s)}async poll(e,n,s){var i;const a=Ge([s==null?void 0:s.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=s==null?void 0:s.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const o=await this.retrieve(n,{vector_store_id:e},{...s,headers:a}).withResponse(),l=o.data;switch(l.status){case"in_progress":let c=5e3;if(s!=null&&s.pollIntervalMs)c=s.pollIntervalMs;else{const d=o.response.headers.get("openai-poll-after-ms");if(d){const u=parseInt(d);isNaN(u)||(c=u)}}await lh(c);break;case"failed":case"completed":return l}}}async upload(e,n,s){const a=await this._client.files.create({file:n,purpose:"assistants"},s);return this.create(e,{file_id:a.id},s)}async uploadAndPoll(e,n,s){const a=await this.upload(e,n,s);return await this.poll(e,a.id,s)}content(e,n,s){const{vector_store_id:a}=n;return this._client.getAPIList(Ce`/vector_stores/${a}/files/${e}/content`,J0,{...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class tp extends at{constructor(){super(...arguments),this.files=new OD(this._client),this.fileBatches=new ID(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(Ce`/vector_stores/${e}`,{...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,s){return this._client.post(Ce`/vector_stores/${e}`,{body:n,...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",vn,{query:e,...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(Ce`/vector_stores/${e}`,{...n,headers:Ge([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}search(e,n,s){return this._client.getAPIList(Ce`/vector_stores/${e}/search`,J0,{body:n,method:"post",...s,headers:Ge([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}tp.Files=OD;tp.FileBatches=ID;var wl,FD,Lm;class BD extends at{constructor(){super(...arguments),wl.add(this)}async unwrap(e,n,s=this._client.webhookSecret,a=300){return await this.verifySignature(e,n,s,a),JSON.parse(e)}async verifySignature(e,n,s=this._client.webhookSecret,a=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");ie(this,wl,"m",FD).call(this,s);const i=Ge([n]).values,o=ie(this,wl,"m",Lm).call(this,i,"webhook-signature"),l=ie(this,wl,"m",Lm).call(this,i,"webhook-timestamp"),c=ie(this,wl,"m",Lm).call(this,i,"webhook-id"),d=parseInt(l,10);if(isNaN(d))throw new vd("Invalid webhook timestamp format");const u=Math.floor(Date.now()/1e3);if(u-d>a)throw new vd("Webhook timestamp is too old");if(d>u+a)throw new vd("Webhook timestamp is too new");const h=o.split(" ").map(x=>x.startsWith("v1,")?x.substring(3):x),m=s.startsWith("whsec_")?Buffer.from(s.replace("whsec_",""),"base64"):Buffer.from(s,"utf-8"),p=c?`${c}.${l}.${e}`:`${l}.${e}`,b=await crypto.subtle.importKey("raw",m,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const x of h)try{const g=Buffer.from(x,"base64");if(await crypto.subtle.verify("HMAC",b,g,new TextEncoder().encode(p)))return}catch{continue}throw new vd("The given webhook signature does not match the expected signature")}}wl=new WeakSet,FD=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},Lm=function(e,n){if(!e)throw new Error("Headers are required");const s=e.get(n);if(s==null)throw new Error(`Missing required header: ${n}`);return s};var gy,Lw,$m,LD;class St{constructor({baseURL:e=dl("OPENAI_BASE_URL"),apiKey:n=dl("OPENAI_API_KEY"),organization:s=dl("OPENAI_ORG_ID")??null,project:a=dl("OPENAI_PROJECT_ID")??null,webhookSecret:i=dl("OPENAI_WEBHOOK_SECRET")??null,...o}={}){if(gy.add(this),$m.set(this,void 0),this.completions=new vD(this),this.chat=new Sw(this),this.embeddings=new wD(this),this.files=new _D(this),this.images=new AD(this),this.audio=new dh(this),this.moderations=new PD(this),this.models=new DD(this),this.fineTuning=new Vc(this),this.graders=new Iw(this),this.vectorStores=new tp(this),this.webhooks=new BD(this),this.beta=new uh(this),this.batches=new hD(this),this.uploads=new Bw(this),this.responses=new Fw(this),this.conversations=new Aw(this),this.evals=new Pw(this),this.containers=new Ew(this),n===void 0)throw new rt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const l={apiKey:n,organization:s,project:a,webhookSecret:i,...o,baseURL:e||"https://api.openai.com/v1"};if(!l.dangerouslyAllowBrowser&&dq())throw new rt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=l.baseURL,this.timeout=l.timeout??Lw.DEFAULT_TIMEOUT,this.logger=l.logger??console;const c="warn";this.logLevel=c,this.logLevel=WN(l.logLevel,"ClientOptions.logLevel",this)??WN(dl("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??c,this.fetchOptions=l.fetchOptions,this.maxRetries=l.maxRetries??2,this.fetch=l.fetch??pq(),ct(this,$m,gq),this._options=l,this.apiKey=n,this.organization=s,this.project=a,this.webhookSecret=i}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}async authHeaders(e){return Ge([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return _q(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${yl}`}defaultIdempotencyKey(){return`stainless-node-retry-${pA()}`}makeStatusError(e,n,s,a){return Hn.generate(e,n,s,a)}buildURL(e,n,s){const a=!ie(this,gy,"m",LD).call(this)&&s||this.baseURL,i=aq(e)?new URL(e):new URL(a+(a.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return iq(o)||(n={...o,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(i.search=this.stringifyQuery(n)),i.toString()}async prepareOptions(e){}async prepareRequest(e,{url:n,options:s}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,s){return this.request(Promise.resolve(s).then(a=>({method:e,path:n,...a})))}request(e,n=null){return new Y0(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,s){var y,v;const a=await e,i=a.maxRetries??this.maxRetries;n==null&&(n=i),await this.prepareOptions(a);const{req:o,url:l,timeout:c}=await this.buildRequest(a,{retryCount:i-n});await this.prepareRequest(o,{url:l,options:a});const d="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),u=s===void 0?"":`, retryOf: ${s}`,h=Date.now();if(Ln(this).debug(`[${d}] sending request`,lo({retryOfRequestLogID:s,method:a.method,url:l,options:a,headers:o.headers})),(y=a.signal)!=null&&y.aborted)throw new ns;const m=new AbortController,p=await this.fetchWithTimeout(l,o,c,m).catch(iy),b=Date.now();if(p instanceof Error){const w=`retrying, ${n} attempts remaining`;if((v=a.signal)!=null&&v.aborted)throw new ns;const j=ay(p)||/timed? ?out/i.test(String(p)+("cause"in p?String(p.cause):""));if(n)return Ln(this).info(`[${d}] connection ${j?"timed out":"failed"} - ${w}`),Ln(this).debug(`[${d}] connection ${j?"timed out":"failed"} (${w})`,lo({retryOfRequestLogID:s,url:l,durationMs:b-h,message:p.message})),this.retryRequest(a,n,s??d);throw Ln(this).info(`[${d}] connection ${j?"timed out":"failed"} - error; no more retries left`),Ln(this).debug(`[${d}] connection ${j?"timed out":"failed"} (error; no more retries left)`,lo({retryOfRequestLogID:s,url:l,durationMs:b-h,message:p.message})),j?new gw:new Z0({cause:p})}const x=[...p.headers.entries()].filter(([w])=>w==="x-request-id").map(([w,j])=>", "+w+": "+JSON.stringify(j)).join(""),g=`[${d}${u}${x}] ${o.method} ${l} ${p.ok?"succeeded":"failed"} with status ${p.status} in ${b-h}ms`;if(!p.ok){const w=await this.shouldRetry(p);if(n&&w){const P=`retrying, ${n} attempts remaining`;return await xq(p.body),Ln(this).info(`${g} - ${P}`),Ln(this).debug(`[${d}] response error (${P})`,lo({retryOfRequestLogID:s,url:p.url,status:p.status,headers:p.headers,durationMs:b-h})),this.retryRequest(a,n,s??d,p.headers)}const j=w?"error; no more retries left":"error; not retryable";Ln(this).info(`${g} - ${j}`);const S=await p.text().catch(P=>iy(P).message),N=cq(S),k=N?void 0:S;throw Ln(this).debug(`[${d}] response error (${j})`,lo({retryOfRequestLogID:s,url:p.url,status:p.status,headers:p.headers,message:k,durationMs:Date.now()-h})),this.makeStatusError(p.status,N,k,p.headers)}return Ln(this).info(g),Ln(this).debug(`[${d}] response start`,lo({retryOfRequestLogID:s,url:p.url,status:p.status,headers:p.headers,durationMs:b-h})),{response:p,options:a,controller:m,requestLogID:d,retryOfRequestLogID:s,startTime:h}}getAPIList(e,n,s){return this.requestAPIList(n,{method:"get",path:e,...s})}requestAPIList(e,n){const s=this.makeRequest(n,null,void 0);return new Tq(this,s,e)}async fetchWithTimeout(e,n,s,a){const{signal:i,method:o,...l}=n||{};i&&i.addEventListener("abort",()=>a.abort());const c=setTimeout(()=>a.abort(),s),d=globalThis.ReadableStream&&l.body instanceof globalThis.ReadableStream||typeof l.body=="object"&&l.body!==null&&Symbol.asyncIterator in l.body,u={signal:a.signal,...d?{duplex:"half"}:{},method:"GET",...l};o&&(u.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,u)}finally{clearTimeout(c)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,s,a){let i;const o=a==null?void 0:a.get("retry-after-ms");if(o){const c=parseFloat(o);Number.isNaN(c)||(i=c)}const l=a==null?void 0:a.get("retry-after");if(l&&!i){const c=parseFloat(l);Number.isNaN(c)?i=Date.parse(l)-Date.now():i=c*1e3}if(!(i&&0<=i&&i<60*1e3)){const c=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(n,c)}return await lh(i),this.makeRequest(e,n-1,s)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}async buildRequest(e,{retryCount:n=0}={}){const s={...e},{method:a,path:i,query:o,defaultBaseURL:l}=s,c=this.buildURL(i,o,l);"timeout"in s&&lq("timeout",s.timeout),s.timeout=s.timeout??this.timeout;const{bodyHeaders:d,body:u}=this.buildBody({options:s}),h=await this.buildHeaders({options:e,method:a,bodyHeaders:d,retryCount:n});return{req:{method:a,headers:h,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&u instanceof globalThis.ReadableStream&&{duplex:"half"},...u&&{body:u},...this.fetchOptions??{},...s.fetchOptions??{}},url:c,timeout:s.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:s,retryCount:a}){let i={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const o=Ge([i,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...fq(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,s,e.headers]);return this.validateHeaders(o),o.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const s=Ge([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&s.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:EA(e)}:ie(this,$m,"f").call(this,{body:e,headers:s})}}Lw=St,$m=new WeakMap,gy=new WeakSet,LD=function(){return this.baseURL!=="https://api.openai.com/v1"};St.OpenAI=Lw;St.DEFAULT_TIMEOUT=6e5;St.OpenAIError=rt;St.APIError=Hn;St.APIConnectionError=Z0;St.APIConnectionTimeoutError=gw;St.APIUserAbortError=ns;St.NotFoundError=yA;St.ConflictError=bA;St.RateLimitError=jA;St.BadRequestError=xA;St.AuthenticationError=gA;St.InternalServerError=_A;St.PermissionDeniedError=vA;St.UnprocessableEntityError=wA;St.InvalidWebhookSignatureError=vd;St.toFile=Lq;St.Completions=vD;St.Chat=Sw;St.Embeddings=wD;St.Files=_D;St.Images=AD;St.Audio=dh;St.Moderations=PD;St.Models=DD;St.FineTuning=Vc;St.Graders=Iw;St.VectorStores=tp;St.Webhooks=BD;St.Beta=uh;St.Batches=hD;St.Uploads=Bw;St.Responses=Fw;St.Conversations=Aw;St.Evals=Pw;St.Containers=Ew;const uW=new St({apiKey:"sk-proj-demo-key-hier-einfuegen",dangerouslyAllowBrowser:!0});async function hW(t,e){try{console.log("OpenAI Extraktion gestartet...");const n=`Du bist ein Experte für die Extraktion von Daten aus deutschen Handwerker-Rechnungen.
    Extrahiere ALLE relevanten Informationen aus der Rechnung und gebe sie als strukturiertes JSON zurück.
    
    Achte besonders auf:
    - Deutsche Datumsformate (DD.MM.YYYY) -> konvertiere zu YYYY-MM-DD
    - Deutsche Zahlenformate (1.234,56 €) -> konvertiere zu Dezimalzahlen
    - Handwerker-spezifische Begriffe
    - Positionen/Artikel in Tabellen
    
    Gib NUR valides JSON zurück, keine zusätzlichen Erklärungen.`,s=`Extrahiere alle Rechnungsdaten aus diesem Bild. 
    ${e?`Hier ist der bereits erkannte Text als Hilfe: ${e}`:""}
    
    Gib die Daten in diesem exakten JSON-Format zurück:
    {
      "invoiceNumber": "Rechnungsnummer",
      "date": "YYYY-MM-DD",
      "supplierName": "Firmenname",
      "totalAmount": Gesamtbetrag als Zahl,
      "vatAmount": MwSt-Betrag als Zahl oder null,
      "vatRate": MwSt-Satz als Zahl oder null,
      "netAmount": Nettobetrag als Zahl oder null,
      "iban": "IBAN oder null",
      "customerNumber": "Kundennummer oder null",
      "orderNumber": "Auftragsnummer oder null"
    }`,a=await uW.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:n},{role:"user",content:[{type:"text",text:s},{type:"image_url",image_url:{url:`data:image/jpeg;base64,${t}`,detail:"high"}}]}],max_tokens:2e3,temperature:.1,response_format:{type:"json_object"}}),i=JSON.parse(a.choices[0].message.content||"{}");return console.log("OpenAI extrahierte Daten:",i),{invoiceNumber:i.invoiceNumber||"UNBEKANNT",date:i.date||i.invoiceDate||new Date().toISOString().split("T")[0],invoiceDate:i.invoiceDate,deliveryDate:i.deliveryDate,dueDate:i.dueDate,supplierName:i.supplierName||"UNBEKANNT",supplierAddress:i.supplierAddress,supplierTaxNumber:i.supplierTaxNumber,supplierVatId:i.supplierVatId,customerName:i.customerName,customerNumber:i.customerNumber,customerAddress:i.customerAddress,positions:i.positions||[],netAmount:i.netAmount,vatRate:i.vatRate,vatAmount:i.vatAmount,totalAmount:i.totalAmount||0,iban:i.iban,bic:i.bic,orderNumber:i.orderNumber,deliveryNoteNumber:i.deliveryNoteNumber,projectNumber:i.projectNumber,paymentTerms:i.paymentTerms,discountTerms:i.discountTerms,description:`AI-extrahiert am ${new Date().toLocaleDateString("de-DE")}`}}catch(n){throw console.error("OpenAI Extraktion fehlgeschlagen:",n),new Error("KI-Extraktion fehlgeschlagen: "+n.message)}}function mW(){return!0}class Gf{static async initialize(){if(!(this.isInitialized&&this.worker))try{console.log("Initialisiere Tesseract Worker...");try{this.worker=await RN.createWorker(["deu","eng"]),console.log("Deutsche und englische Sprachdateien geladen")}catch(e){console.warn("Mehrsprachige Initialisierung fehlgeschlagen, verwende nur Englisch:",e);try{this.worker=await RN.createWorker("eng"),console.log("Englische Sprachdatei geladen")}catch(n){throw console.error("Fallback auf Englisch fehlgeschlagen:",n),n}}await this.worker.setParameters({tessedit_char_whitelist:`0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyzäöüÄÖÜß.,:-€$%/@()[]{}|_+=*&!?"' 	
`,tessedit_pageseg_mode:"3",preserve_interword_spaces:"1",tessedit_ocr_engine_mode:"3",tessedit_min_confidence:"60"}),this.isInitialized=!0,console.log("OCR Service erfolgreich initialisiert mit optimierten Parametern")}catch(e){throw console.error("Failed to initialize OCR Service:",e),new ji("OCR Service konnte nicht initialisiert werden. Überprüfen Sie Ihre Internetverbindung.",gd.SERVER_ERROR,"Tesseract Worker initialization failed")}}static async processInvoiceImage(e){return em(async()=>{const n=await lx();(!this.isInitialized||!this.worker)&&await this.initialize();const s=await this.fileToBase64(e),a=e.name.split(".").pop()||"jpg",i=`invoice_${Date.now()}.${a}`;let o=`data:image/${a};base64,${s}`,l,c,d="";console.log("Starte OCR-Verarbeitung für Datei:",e.name);const u=await this.worker.recognize(e,{rotateAuto:!0,rotateRadians:0});d=u.data.text||"";const h=u.data.confidence||0,m=this.cleanOCRText(d);if(console.log(`OCR abgeschlossen - Konfidenz: ${h}%`),console.log("OCR Raw Text (erste 500 Zeichen):",d.substring(0,500)),console.log("Bereinigte Version:",m.substring(0,500)),mW()){console.log("Verwende OpenAI Vision API für Extraktion...");try{l=await hW(s,d),c={overall:.95,invoice_number:.95,date:.95,amount:.95,supplier:.95},console.log("OpenAI Extraktion erfolgreich!")}catch(b){console.error("OpenAI fehlgeschlagen, falle zurück auf Regex:",b),l=this.extractInvoiceData(m),c=this.calculateConfidenceScores(m,l)}}const p={id:`ocr_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,original_file_path:o,extracted_text:d,structured_data:l,confidence_scores:c,status:"pending",created_at:new Date().toISOString(),created_by:(n==null?void 0:n.id)||"unknown"};try{const b=JSON.parse(localStorage.getItem("ocr_results")||"[]");b.push(p),localStorage.setItem("ocr_results",JSON.stringify(b)),console.log("OCR result saved locally:",p.id)}catch(b){console.warn("LocalStorage failed, continuing without storage:",b)}return console.log("OCR result created successfully:",p.id),Ve.emit("OCR_PROCESSED",{ocr_id:p.id,confidence:c.overall,supplier_name:l.supplierName,user_id:n.id}),p},"Process invoice with OCR")}static async validateAndCreateInvoice(e,n,s){return em(async()=>{const a=await lx(),{data:i,error:o}=await $.from("ocr_results").update({structured_data:n,status:"validated",validation_notes:s,validated_at:new Date().toISOString(),validated_by:a.id}).eq("id",e).select().single();if(o)throw new ji("OCR-Validierung fehlgeschlagen",gd.SERVER_ERROR,o.message);const l={invoice_number:n.invoiceNumber,supplier_name:n.supplierName,invoice_date:n.date,total_amount:n.totalAmount,vat_amount:n.vatAmount||0,description:n.description||"",status:"pending",ocr_result_id:e,created_by:a.id},{data:c,error:d}=await $.from("supplier_invoices").insert(l).select().single();if(d)throw new ji("Rechnung konnte nicht erstellt werden",gd.SERVER_ERROR,d.message);try{console.log("Audit log: Invoice created from OCR",{entity_id:c.id,invoice_number:n.invoiceNumber,supplier_name:n.supplierName,total_amount:n.totalAmount})}catch(u){console.error("Audit log failed (non-critical):",u)}return{ocr_result:i,invoice_id:c.id}},"Validate OCR and create invoice")}static async getOCRResults(e){return em(async()=>{try{const n=JSON.parse(localStorage.getItem("ocr_results")||"[]");let s=n;return e&&(s=n.filter(a=>a.status===e)),s.sort((a,i)=>new Date(i.created_at).getTime()-new Date(a.created_at).getTime()),console.log(`Retrieved ${s.length} OCR results from localStorage`),s}catch(n){return console.warn("Failed to read from localStorage, returning empty array:",n),[]}},"Get OCR results")}static async rejectOCRResult(e,n){return em(async()=>{const s=await lx(),{error:a}=await $.from("ocr_results").update({status:"rejected",validation_notes:n,validated_at:new Date().toISOString(),validated_by:s.id}).eq("id",e);if(a)throw new ji("OCR-Ergebnis konnte nicht abgelehnt werden",gd.SERVER_ERROR,a.message);try{console.log("Audit log: OCR result rejected",{entity_id:e,status:"rejected",reason:n})}catch(i){console.error("Audit log failed (non-critical):",i)}},"Reject OCR result")}static fileToBase64(e){return new Promise((n,s)=>{const a=new FileReader;a.onload=()=>{const i=a.result.split(",")[1];n(i)},a.onerror=s,a.readAsDataURL(e)})}static cleanOCRText(e){let n=e.replace(/[ \t]+/g," ");return n=n.replace(/\bl\s*nvoice/gi,"Invoice").replace(/\bRechnunq/gi,"Rechnung").replace(/\bDaturn/gi,"Datum").replace(/\bSurnme/gi,"Summe").replace(/\bMwSt\./gi,"MwSt").replace(/\bGrnbH/gi,"GmbH").replace(/\bAG\s*\./gi,"AG").replace(/\€/g,"€").replace(/\bEUR\b/g,"€").replace(/([0-9]),\s*([0-9]{2})\s*€/g,"$1,$2 €"),n}static extractInvoicePositions(e){const n=[],s=e.split(`
`),a=[/^(\d+)[\.\s]+(.+?)\s+(\d+[\.,]?\d*)\s*(Stk|Std|m²|m|kg|l|Stück|Stunde)?\s*€?\s*([\d\.,]+)\s*€?\s*([\d\.,]+)/,/(.+?)\s+(\d+[\.,]?\d*)\s*x\s*€?\s*([\d\.,]+)\s*=\s*€?\s*([\d\.,]+)/,/([A-Z0-9\-]+)\s+(.+?)\s+(\d+[\.,]?\d*)\s+€?\s*([\d\.,]+)\s+€?\s*([\d\.,]+)/];for(const i of s){const o=i.trim();if(o)for(const l of a){const c=o.match(l);if(c){let d;if(c.length===7)d={position:parseInt(c[1]),description:c[2].trim(),quantity:this.parseAmount(c[3]),unit:c[4]||"Stk",unitPrice:this.parseAmount(c[5]),totalPrice:this.parseAmount(c[6])};else if(c.length===5)d={description:c[1].trim(),quantity:this.parseAmount(c[2]),unitPrice:this.parseAmount(c[3]),totalPrice:this.parseAmount(c[4])};else if(c.length===6)d={articleNumber:c[1],description:c[2].trim(),quantity:this.parseAmount(c[3]),unitPrice:this.parseAmount(c[4]),totalPrice:this.parseAmount(c[5])};else continue;d.quantity>0&&d.totalPrice>0&&(n.push(d),console.log("Position gefunden:",d));break}}}return n}static extractInvoiceData(e){const n=e,s=e.replace(/\n/g," ").replace(/\s+/g," ").trim();console.log("OCR Clean Text:",s);const a={invoiceNumber:[/Rechnungs[\s-]*(?:Nr\.?|Nummer)\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Rechnung\s*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/(?:Rg|Re)[\s-]*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Invoice\s*(?:No\.?|Number)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Beleg[\s-]*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Nr\.?\s*[:.]\s*([A-Z0-9\-\/]{3,})/i],invoiceDate:[/Datum[:\s]*(\d{1,2}\.\d{1,2}\.\d{4})/i,/(?:rechnungsdatum|datum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:ausstellungsdatum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:datum der rechnung)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(\d{1,2}\.\d{1,2}\.\d{4})/],deliveryDate:[/(?:lieferdatum|leistungsdatum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:leistungszeitraum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i],dueDate:[/(?:fällig am|zahlbar bis|zahlungsziel)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:fälligkeit|zahlung bis)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i],totalAmount:[/Gesamtbetrag[:\s]*€?\s*([\d\.,]+)/i,/(?:gesamt(?:betrag|summe)|total|summe)[:\s]*€?\s*([\d\.,]+)/i,/(?:zu zahlen|zahlbetrag)[:\s]*€?\s*([\d\.,]+)/i,/Brutto[:\s]*€?\s*([\d\.,]+)/i,/([\d]{1,3}(?:\.\d{3})*,\d{2})\s*€/,/([\d\.,]+)\s*€/i,/€\s*([\d\.,]+)/i],netAmount:[/(?:netto(?:betrag|summe)?)[:\s]*€?\s*([\d\.,]+)/i,/(?:summe netto)[:\s]*€?\s*([\d\.,]+)/i,/(?:zwischensumme)[:\s]*€?\s*([\d\.,]+)/i],vatAmount:[/MwSt[.\s]*19%[:\s]*€?\s*([\d\.,]+)/i,/19%\s*MwSt[:\s]*€?\s*([\d\.,]+)/i,/(?:mwst|mehrwertsteuer|ust|vat)[:\s]*€?\s*([\d\.,]+)/i,/(?:steuer)[:\s]*€?\s*([\d\.,]+)/i,/(\d{1,2})\s*%\s*mwst[:\s]*€?\s*([\d\.,]+)/i,/190,00\s*€/],vatRate:[/(?:mwst|mehrwertsteuer|ust)[\s:]*(\d{1,2})\s*%/i,/(\d{1,2})\s*%\s*(?:mwst|steuer)/i],supplierName:[/([A-Za-zÄÖÜäöüß][A-Za-zÄÖÜäöüß\s&\-\.]{1,40}\s+(?:GmbH|AG|KG|OHG|GbR|e\.K\.|e\.V\.|UG|GmbH\s*&\s*Co\.?\s*KG))/i,/([A-Za-zÄÖÜäöüß][A-Za-zÄÖÜäöüß\s]{1,30}\s+(?:Handwerk|Bau|Elektro|Sanitär|Heizung|Malerei|Schreinerei|Tischlerei|Zimmerei))/i,/([A-Z][a-zäöüß]+\s+[A-Z][a-zäöüß]+)\s*(?:-|–|—)?\s*(?:Meisterbetrieb|Handwerksmeister|Inhaber)/i,/^([A-Z][A-Za-zÄÖÜäöüß\s&\-\.]{2,40})\s*\n/m,/([A-Za-zÄÖÜäöüß\s&\-]{3,30}(?:GmbH|AG|KG))/i],iban:[/iban[:\s]*([A-Z]{2}\d{2}[\s]?[\d\s]{10,30})/i,/([A-Z]{2}\d{2}[\s]?[\d\s]{16,20})/g],bic:[/(?:bic|swift)[:\s]*([A-Z]{6,11})/i],customerNumber:[/(?:kunden(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:kdnr|kd\.?nr)[:\s]*([A-Z0-9\-\/]+)/i],orderNumber:[/(?:auftrags(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:bestell(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:auftrag|bestellung)[:\s]*([A-Z0-9\-\/]+)/i],deliveryNoteNumber:[/(?:lieferschein(?:nummer|nr)?)[:\s]*([A-Z0-9\-\/]+)/i,/(?:ls[\s\-]?nr)[:\s]*([A-Z0-9\-\/]+)/i],projectNumber:[/(?:projekt(?:nummer|nr)?)[:\s]*([A-Z0-9\-\/]+)/i,/(?:bauvorhaben|baustelle)[:\s]*([A-Z0-9\-\/]+)/i],paymentTerms:[/(?:zahlungsbedingungen|zahlungsziel)[:\s]*([^\n]{5,50})/i,/(?:zahlung)[:\s]*([^\n]{5,50})/i],discountTerms:[/(\d{1,2})\s*%\s*(?:skonto|rabatt)(?:\s*bei\s*zahlung)?[^\n]*/i,/(?:skonto|rabatt)[:\s]*([^\n]{5,50})/i]},i={};console.log("Starting extraction from text:",s.substring(0,200));for(const l of a.invoiceNumber){const c=s.match(l);if(c){i.invoiceNumber=c[1].trim(),console.log("Rechnungsnummer gefunden:",c[1]);break}}if(!i.invoiceNumber){const l=s.match(/2020-001/);l&&(i.invoiceNumber=l[0],console.log("Rechnungsnummer per Fallback:",l[0]))}for(const l of a.invoiceDate){const c=s.match(l);if(c){i.date=this.parseDate(c[1]),i.invoiceDate=i.date;break}}for(const l of a.deliveryDate){const c=s.match(l);if(c){i.deliveryDate=this.parseDate(c[1]);break}}for(const l of a.dueDate){const c=s.match(l);if(c){i.dueDate=this.parseDate(c[1]);break}}for(const l of a.totalAmount){const c=s.match(l);if(c){i.totalAmount=this.parseAmount(c[1]);break}}for(const l of a.netAmount){const c=s.match(l);if(c){i.netAmount=this.parseAmount(c[1]);break}}for(const l of a.vatAmount){const c=s.match(l);if(c){const d=c[2]||c[1];i.vatAmount=this.parseAmount(d);break}}for(const l of a.vatRate){const c=s.match(l);if(c){i.vatRate=parseInt(c[1]);break}}for(const l of a.supplierName){const c=s.match(l);if(c&&c[1]&&c[1].length>3){i.supplierName=c[1].trim(),console.log("Supplier found:",c[1]);break}}i.supplierName||console.log("No supplier found in:",s.substring(0,100));for(const l of a.iban){const c=s.match(l);if(c&&c[1]){i.iban=c[1].replace(/\s/g,"");break}}for(const l of a.bic){const c=s.match(l);if(c&&c[1]){i.bic=c[1];break}}for(const l of a.customerNumber){const c=s.match(l);if(c&&c[1]){i.customerNumber=c[1];break}}for(const l of a.orderNumber){const c=s.match(l);if(c&&c[1]){i.orderNumber=c[1];break}}for(const l of a.deliveryNoteNumber){const c=s.match(l);if(c&&c[1]){i.deliveryNoteNumber=c[1];break}}for(const l of a.projectNumber){const c=s.match(l);if(c&&c[1]){i.projectNumber=c[1];break}}for(const l of a.paymentTerms){const c=s.match(l);if(c&&c[1]){i.paymentTerms=c[1].trim();break}}for(const l of a.discountTerms){const c=s.match(l);if(c){i.discountTerms=c[0].trim();break}}const o=this.extractInvoicePositions(n);if(o.length>0&&(i.positions=o,console.log(`${o.length} Positionen extrahiert`)),i.netAmount&&i.vatAmount&&!i.totalAmount&&(i.totalAmount=i.netAmount+i.vatAmount),i.totalAmount&&i.vatAmount&&!i.netAmount&&(i.netAmount=i.totalAmount-i.vatAmount),i.netAmount&&i.vatRate&&!i.vatAmount&&(i.vatAmount=i.netAmount*(i.vatRate/100)),o.length>0&&!i.totalAmount){const l=o.reduce((c,d)=>c+d.totalPrice,0);i.netAmount||(i.netAmount=l),i.vatRate?(i.vatAmount=l*(i.vatRate/100),i.totalAmount=l+i.vatAmount):i.totalAmount=l}return{invoiceNumber:i.invoiceNumber||"UNBEKANNT",date:i.date||i.invoiceDate||new Date().toISOString().split("T")[0],invoiceDate:i.invoiceDate,deliveryDate:i.deliveryDate,dueDate:i.dueDate,supplierName:i.supplierName||"UNBEKANNT",totalAmount:i.totalAmount||0,netAmount:i.netAmount,vatAmount:i.vatAmount,vatRate:i.vatRate,iban:i.iban,bic:i.bic,customerNumber:i.customerNumber,orderNumber:i.orderNumber,deliveryNoteNumber:i.deliveryNoteNumber,projectNumber:i.projectNumber,paymentTerms:i.paymentTerms,discountTerms:i.discountTerms,description:`OCR-Import vom ${new Date().toLocaleDateString("de-DE")}`}}static parseAmount(e){return parseFloat(e.replace(/\./g,"").replace(",",".").replace(/[^\d.]/g,""))||0}static parseDate(e){const n=e.split(/[\.\-\/]/);if(n.length===3){const s=n[0].padStart(2,"0"),a=n[1].padStart(2,"0");let i=n[2];return i.length===2&&(i=parseInt(i)>50?`19${i}`:`20${i}`),`${i}-${a}-${s}`}return new Date().toISOString().split("T")[0]}static calculateConfidenceScores(e,n){const s={overall:0,invoice_number:0,date:0,amount:0,supplier:0};n.invoiceNumber!=="UNBEKANNT"&&(s.invoice_number=/[A-Z0-9]{3,}/.test(n.invoiceNumber)?.9:.6);const a=/\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4}/;if(s.date=a.test(e)?.8:.3,n.totalAmount>0){const i=/€\s*[\d\.,]+|\d+[,\.]\d{2}/;s.amount=i.test(e)?.85:.4}return n.supplierName!=="UNBEKANNT"&&(s.supplier=n.supplierName.length>5?.7:.5),s.overall=s.invoice_number*.3+s.date*.2+s.amount*.3+s.supplier*.2,s}static async cleanup(){this.worker&&(await this.worker.terminate(),this.worker=null,this.isInitialized=!1)}}En(Gf,"worker",null),En(Gf,"isInitialized",!1);const At={PROJECT_KPIS:"project-kpis",PROJECT_KPIS_SUMMARY:"project-kpis-summary",NOTIFICATIONS:"notifications",NOTIFICATION_STATS:"notification-stats",WORKER_STATUS:"worker-status",AUDIT_LOGS:"audit-logs",AUDIT_TRAIL:"audit-trail",AUDIT_STATS:"audit-stats",NUMBER_SEQUENCES:"number-sequences",GOBD_DOCUMENTS:"gobd-documents",IMMUTABILITY_CHECK:"immutability-check",DATEV_EXPORTS:"datev-exports",DATEV_ACCOUNT_MAPPINGS:"datev-account-mappings",GERMAN_VAT_RETURNS:"german-vat-returns",GERMAN_PERIODS:"german-periods",GERMAN_EXPENSE_REPORTS:"german-expense-reports",AI_DOCUMENTS:"ai-documents",AI_SEARCH_RESULTS:"ai-search-results",AI_INTENT_ANALYSES:"ai-intent-analyses",AI_ESTIMATIONS:"ai-estimations",AI_INDEXING_STATUS:"ai-indexing-status",OCR_RESULTS:"ocr-results",OCR_RESULT:t=>["ocr-results",t],OCR_PENDING:"ocr-pending",customers:["customers"],customer:t=>["customers",t],customerStats:t=>["customers",t,"stats"],customerProjects:t=>["customers",t,"projects"],customerQuotes:t=>["customers",t,"quotes"],customerInvoices:t=>["customers",t,"invoices"],quotes:["quotes"],quote:t=>["quotes",t],quoteStats:["quotes","stats"],orders:["orders"],order:t=>["orders",t],orderStats:["orders","stats"],projects:["projects"],project:t=>["projects",t],projectStats:t=>["projects",t,"stats"],projectTimeline:t=>["projects",t,"timeline"],timesheets:["timesheets"],timesheet:t=>["timesheets",t],employeeTimesheetStats:t=>["timesheets","employee",t,"stats"],projectTimesheetSummary:t=>["timesheets","project",t,"summary"],materials:["materials"],material:t=>["materials",t],materialStats:["materials","stats"],lowStockMaterials:["materials","low-stock"],stockMovements:["stock-movements"],stockValuation:["stock","valuation"],stockAnalytics:["stock","analytics"],invoices:["invoices"],invoice:t=>["invoices",t],expenses:["expenses"],expense:t=>["expenses",t],financialKpis:["finance","kpis"],revenueByMonth:["finance","revenue-by-month"],expensesByCategory:["finance","expenses-by-category"],profitLossReport:["finance","profit-loss"],documents:["documents"],document:t=>["documents",t],documentStats:["documents","stats"],expiringDocuments:["documents","expiring"],employees:["employees"],employee:t=>["employees",t]},$D=(t,e,n)=>Wr({queryKey:[...At.customers,t,e],queryFn:()=>H0.getCustomers(t,e),...n}),fW=t=>{const e=On(),{toast:n}=pt();return kr({mutationFn:s=>H0.createCustomer(s),onSuccess:s=>{e.invalidateQueries({queryKey:At.customers}),n({title:"Kunde erstellt",description:`${s.company_name} wurde erfolgreich erstellt.`})},onError:s=>{n({title:"Fehler beim Erstellen",description:s.message,variant:"destructive"})},...t})},pW=t=>{const e=On(),{toast:n}=pt();return kr({mutationFn:({id:s,data:a})=>sz.updateCustomer(s,a),onSuccess:(s,{id:a})=>{e.invalidateQueries({queryKey:At.customers}),e.invalidateQueries({queryKey:At.customer(a)}),e.invalidateQueries({queryKey:At.customerStats(a)}),n({title:"Kunde aktualisiert",description:`${s.company_name} wurde erfolgreich aktualisiert.`})},onError:s=>{n({title:"Fehler beim Aktualisieren",description:s.message,variant:"destructive"})},...t})},xW=t=>{const e=On(),{toast:n}=pt();return kr({mutationFn:s=>H0.deleteCustomer(s),onSuccess:(s,a)=>{e.invalidateQueries({queryKey:At.customers}),e.removeQueries({queryKey:At.customer(a)}),n({title:"Kunde gelöscht",description:"Der Kunde wurde erfolgreich gelöscht."})},onError:s=>{n({title:"Fehler beim Löschen",description:s.message,variant:"destructive"})},...t})},gW=(t,e,n)=>Wr({queryKey:[...At.quotes,t,e],queryFn:()=>V0.getQuotes(t,e),...n}),vW=t=>{const e=On(),{toast:n}=pt();return kr({mutationFn:V0.createQuote,onSuccess:s=>{e.invalidateQueries({queryKey:At.quotes}),e.invalidateQueries({queryKey:At.customerQuotes(s.customer_id)}),n({title:"Angebot erstellt",description:`${s.title} wurde erfolgreich erstellt.`})},onError:s=>{n({title:"Fehler beim Erstellen",description:s.message,variant:"destructive"})},...t})},yW=t=>{const e=On(),{toast:n}=pt();return kr({mutationFn:({id:s,data:a})=>V0.updateQuote(s,a),onSuccess:(s,{id:a})=>{e.invalidateQueries({queryKey:At.quotes}),e.invalidateQueries({queryKey:At.quote(a)}),n({title:"Angebot aktualisiert",description:`${s.title} wurde erfolgreich aktualisiert.`})},onError:s=>{n({title:"Fehler beim Aktualisieren",description:s.message,variant:"destructive"})},...t})},bW=t=>{const e=On(),{toast:n}=pt();return kr({mutationFn:V0.acceptQuote,onSuccess:(s,a)=>{e.invalidateQueries({queryKey:At.quotes}),e.invalidateQueries({queryKey:At.quote(a)}),e.invalidateQueries({queryKey:At.orders}),n({title:"Angebot angenommen",description:`${s.quote.title} wurde angenommen und ein Auftrag erstellt.`})},onError:s=>{n({title:"Fehler beim Annehmen",description:s.message,variant:"destructive"})},...t})},zD=(t,e,n)=>Wr({queryKey:[...At.projects,t,e],queryFn:()=>iA.getProjects(t,e),...n}),UD=t=>{const e=On(),{toast:n}=pt();return kr({mutationFn:iA.createProject,onSuccess:s=>{e.invalidateQueries({queryKey:At.projects}),e.invalidateQueries({queryKey:At.customerProjects(s.customer_id||"")}),n({title:"Projekt erstellt",description:`${s.name} wurde erfolgreich erstellt.`})},onError:s=>{n({title:"Fehler beim Erstellen",description:s.message,variant:"destructive"})},...t})},wW=(t,e,n)=>Wr({queryKey:[...At.timesheets,t,e],queryFn:()=>hw.getTimesheets(t,e),...n}),jW=t=>{const e=On(),{toast:n}=pt();return kr({mutationFn:hw.createTimesheet,onSuccess:s=>{e.invalidateQueries({queryKey:At.timesheets}),e.invalidateQueries({queryKey:At.projectStats(s.project_id||"")}),e.invalidateQueries({queryKey:At.employeeTimesheetStats(s.employee_id)}),n({title:"Zeiteintrag erstellt",description:"Der Zeiteintrag wurde erfolgreich erstellt."})},onError:s=>{n({title:"Fehler beim Erstellen",description:s.message,variant:"destructive"})},...t})},_W=t=>{const e=On(),{toast:n}=pt();return kr({mutationFn:({id:s,data:a})=>hw.updateTimesheet(s,a),onSuccess:(s,{id:a})=>{e.invalidateQueries({queryKey:At.timesheets}),e.invalidateQueries({queryKey:At.timesheet(a)}),n({title:"Zeiteintrag aktualisiert",description:"Der Zeiteintrag wurde erfolgreich aktualisiert."})},onError:s=>{n({title:"Fehler beim Aktualisieren",description:s.message,variant:"destructive"})},...t})},qD=(t,e,n)=>Wr({queryKey:[...At.invoices,t,e],queryFn:()=>K0.getInvoices(t,e),...n}),WD=t=>{const e=On(),{toast:n}=pt();return kr({mutationFn:K0.createInvoice,onSuccess:s=>{e.invalidateQueries({queryKey:At.invoices}),e.invalidateQueries({queryKey:At.financialKpis}),n({title:"Rechnung erstellt",description:`${s.invoice_number||"Rechnung"} wurde erfolgreich erstellt.`})},onError:s=>{n({title:"Fehler beim Erstellen",description:s.message,variant:"destructive"})},...t})},NW=(t,e,n)=>Wr({queryKey:[...At.expenses,t,e],queryFn:()=>K0.getExpenses(t,e),...n}),SW=(t,e)=>Wr({queryKey:[...At.financialKpis,t],queryFn:()=>K0.getFinancialKPIs(t),...e}),kW=(t,e,n)=>Wr({queryKey:[...At.documents,t,e],queryFn:()=>hz.getDocuments(t,e),...n}),$w=t=>Wr({queryKey:At.employees,queryFn:async()=>{var e,n;try{const{data:{session:s}}=await $.auth.getSession();if(!s)return console.log("useEmployees: No session found"),{items:[]};const a=((e=s.user.user_metadata)==null?void 0:e.company_id)||((n=s.user.app_metadata)==null?void 0:n.company_id)||s.user.id;if(console.log("useEmployees: Using company_id:",a),console.log("useEmployees: Session user:",s.user),!a)return console.error("useEmployees: No company ID available"),{items:[]};const{data:i,error:o}=await $.from("employees").select("id, email, status, user_id, company_id").eq("company_id",a);console.log("useEmployees: DEBUG - All employees for company:",i);const{data:l,error:c}=await $.from("employees").select(`
            id,
            user_id,
            first_name,
            last_name,
            email,
            phone,
            position,
            status,
            qualifications,
            license,
            company_id
          `).not("user_id","is",null).in("status",["active","Active","aktiv","Aktiv"]).order("created_at",{ascending:!1});if(console.log("useEmployees: Raw query (no company filter):",l),console.log("useEmployees: Employees query result:",l,c),c)return console.error("useEmployees: Error fetching employees:",c),{items:[]};const d=(l==null?void 0:l.filter(m=>m.user_id).map(m=>m.user_id))||[];let u=[];if(d.length>0){const{data:m,error:p}=await $.from("profiles").select("id, first_name, last_name").in("id",d);p||(u=m||[])}const h=(l==null?void 0:l.map(m=>{const p=u.find(g=>g.id===m.user_id),b=(p==null?void 0:p.first_name)||m.first_name||"",x=(p==null?void 0:p.last_name)||m.last_name||"";return{id:m.id,first_name:b,last_name:x,name:`${b} ${x}`.trim(),email:m.email,phone:m.phone,position:m.position,status:m.status,qualifications:Array.isArray(m.qualifications)?m.qualifications:[],license:m.license}}))||[];return console.log("useEmployees: Final employee list:",h),{items:h}}catch(s){return console.error("useEmployees: Catch block error:",s),{items:[]}}},...t}),CW=t=>{const e=On();return pt(),kr({mutationFn:async n=>{const{error:s}=await $.from("employees").delete().eq("id",n);if(s)throw new Error(s.message)},onSuccess:()=>{e.invalidateQueries({queryKey:At.employees})},...t})},EW=t=>{const e=On(),{toast:n}=pt();return kr({mutationFn:s=>Gf.processInvoiceImage(s),onSuccess:s=>{e.invalidateQueries({queryKey:[At.OCR_RESULTS]}),e.invalidateQueries({queryKey:[At.OCR_PENDING]}),n({title:"OCR-Verarbeitung abgeschlossen",description:`Rechnung von "${s.structured_data.supplierName}" wurde verarbeitet.`})},onError:s=>{n({title:"OCR-Verarbeitung fehlgeschlagen",description:s.message,variant:"destructive"})},...t})},AW=(t,e)=>Wr({queryKey:[At.OCR_RESULTS,t],queryFn:()=>Gf.getOCRResults(t),staleTime:5*60*1e3,...e}),DW=t=>AW("pending",t);var eg="focusScope.autoFocusOnMount",tg="focusScope.autoFocusOnUnmount",o2={bubbles:!1,cancelable:!0},PW="FocusScope",hh=f.forwardRef((t,e)=>{const{loop:n=!1,trapped:s=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=t,[l,c]=f.useState(null),d=nn(a),u=nn(i),h=f.useRef(null),m=yt(e,x=>c(x)),p=f.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;f.useEffect(()=>{if(s){let x=function(w){if(p.paused||!l)return;const j=w.target;l.contains(j)?h.current=j:Xa(h.current,{select:!0})},g=function(w){if(p.paused||!l)return;const j=w.relatedTarget;j!==null&&(l.contains(j)||Xa(h.current,{select:!0}))},y=function(w){if(document.activeElement===document.body)for(const S of w)S.removedNodes.length>0&&Xa(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",g);const v=new MutationObserver(y);return l&&v.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",g),v.disconnect()}}},[s,l,p.paused]),f.useEffect(()=>{if(l){c2.add(p);const x=document.activeElement;if(!l.contains(x)){const y=new CustomEvent(eg,o2);l.addEventListener(eg,d),l.dispatchEvent(y),y.defaultPrevented||(TW(FW(HD(l)),{select:!0}),document.activeElement===x&&Xa(l))}return()=>{l.removeEventListener(eg,d),setTimeout(()=>{const y=new CustomEvent(tg,o2);l.addEventListener(tg,u),l.dispatchEvent(y),y.defaultPrevented||Xa(x??document.body,{select:!0}),l.removeEventListener(tg,u),c2.remove(p)},0)}}},[l,d,u,p]);const b=f.useCallback(x=>{if(!n&&!s||p.paused)return;const g=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,y=document.activeElement;if(g&&y){const v=x.currentTarget,[w,j]=RW(v);w&&j?!x.shiftKey&&y===j?(x.preventDefault(),n&&Xa(w,{select:!0})):x.shiftKey&&y===w&&(x.preventDefault(),n&&Xa(j,{select:!0})):y===v&&x.preventDefault()}},[n,s,p.paused]);return r.jsx(Le.div,{tabIndex:-1,...o,ref:m,onKeyDown:b})});hh.displayName=PW;function TW(t,{select:e=!1}={}){const n=document.activeElement;for(const s of t)if(Xa(s,{select:e}),document.activeElement!==n)return}function RW(t){const e=HD(t),n=l2(e,t),s=l2(e.reverse(),t);return[n,s]}function HD(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function l2(t,e){for(const n of t)if(!MW(n,{upTo:e}))return n}function MW(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function IW(t){return t instanceof HTMLInputElement&&"select"in t}function Xa(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&IW(t)&&e&&t.select()}}var c2=OW();function OW(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=d2(t,e),t.unshift(e)},remove(e){var n;t=d2(t,e),(n=t[0])==null||n.resume()}}}function d2(t,e){const n=[...t],s=n.indexOf(e);return s!==-1&&n.splice(s,1),n}function FW(t){return t.filter(e=>e.tagName!=="A")}var ng=0;function np(){f.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??u2()),document.body.insertAdjacentElement("beforeend",t[1]??u2()),ng++,()=>{ng===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),ng--}},[])}function u2(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Zs=function(){return Zs=Object.assign||function(e){for(var n,s=1,a=arguments.length;s<a;s++){n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Zs.apply(this,arguments)};function VD(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n}function BW(t,e,n){if(n||arguments.length===2)for(var s=0,a=e.length,i;s<a;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}var zm="right-scroll-bar-position",Um="width-before-scroll-bar",LW="with-scroll-bars-hidden",$W="--removed-body-scroll-bar-size";function rg(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function zW(t,e){var n=f.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(s){var a=n.value;a!==s&&(n.value=s,n.callback(s,a))}}}})[0];return n.callback=e,n.facade}var UW=typeof window<"u"?f.useLayoutEffect:f.useEffect,h2=new WeakMap;function qW(t,e){var n=zW(null,function(s){return t.forEach(function(a){return rg(a,s)})});return UW(function(){var s=h2.get(n);if(s){var a=new Set(s),i=new Set(t),o=n.current;a.forEach(function(l){i.has(l)||rg(l,null)}),i.forEach(function(l){a.has(l)||rg(l,o)})}h2.set(n,t)},[t]),n}function WW(t){return t}function HW(t,e){e===void 0&&(e=WW);var n=[],s=!1,a={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,s);return n.push(o),function(){n=n.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(s=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(l){return i(l)},filter:function(){return n}}},assignMedium:function(i){s=!0;var o=[];if(n.length){var l=n;n=[],l.forEach(i),o=n}var c=function(){var u=o;o=[],u.forEach(i)},d=function(){return Promise.resolve().then(c)};d(),n={push:function(u){o.push(u),d()},filter:function(u){return o=o.filter(u),n}}}};return a}function VW(t){t===void 0&&(t={});var e=HW(null);return e.options=Zs({async:!0,ssr:!1},t),e}var KD=function(t){var e=t.sideCar,n=VD(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=e.read();if(!s)throw new Error("Sidecar medium not found");return f.createElement(s,Zs({},n))};KD.isSideCarExport=!0;function KW(t,e){return t.useMedium(e),KD}var GD=VW(),sg=function(){},rp=f.forwardRef(function(t,e){var n=f.useRef(null),s=f.useState({onScrollCapture:sg,onWheelCapture:sg,onTouchMoveCapture:sg}),a=s[0],i=s[1],o=t.forwardProps,l=t.children,c=t.className,d=t.removeScrollBar,u=t.enabled,h=t.shards,m=t.sideCar,p=t.noIsolation,b=t.inert,x=t.allowPinchZoom,g=t.as,y=g===void 0?"div":g,v=t.gapMode,w=VD(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),j=m,S=qW([n,e]),N=Zs(Zs({},w),a);return f.createElement(f.Fragment,null,u&&f.createElement(j,{sideCar:GD,removeScrollBar:d,shards:h,noIsolation:p,inert:b,setCallbacks:i,allowPinchZoom:!!x,lockRef:n,gapMode:v}),o?f.cloneElement(f.Children.only(l),Zs(Zs({},N),{ref:S})):f.createElement(y,Zs({},N,{className:c,ref:S}),l))});rp.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};rp.classNames={fullWidth:Um,zeroRight:zm};var GW=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function ZW(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=GW();return e&&t.setAttribute("nonce",e),t}function QW(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function YW(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var JW=function(){var t=0,e=null;return{add:function(n){t==0&&(e=ZW())&&(QW(e,n),YW(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},XW=function(){var t=JW();return function(e,n){f.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},ZD=function(){var t=XW(),e=function(n){var s=n.styles,a=n.dynamic;return t(s,a),null};return e},eH={left:0,top:0,right:0,gap:0},ag=function(t){return parseInt(t||"",10)||0},tH=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],s=e[t==="padding"?"paddingTop":"marginTop"],a=e[t==="padding"?"paddingRight":"marginRight"];return[ag(n),ag(s),ag(a)]},nH=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return eH;var e=tH(t),n=document.documentElement.clientWidth,s=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,s-n+e[2]-e[0])}},rH=ZD(),Ql="data-scroll-locked",sH=function(t,e,n,s){var a=t.left,i=t.top,o=t.right,l=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(LW,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(l,"px ").concat(s,`;
  }
  body[`).concat(Ql,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(s,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(s,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zm,` {
    right: `).concat(l,"px ").concat(s,`;
  }
  
  .`).concat(Um,` {
    margin-right: `).concat(l,"px ").concat(s,`;
  }
  
  .`).concat(zm," .").concat(zm,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(Um," .").concat(Um,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Ql,`] {
    `).concat($W,": ").concat(l,`px;
  }
`)},m2=function(){var t=parseInt(document.body.getAttribute(Ql)||"0",10);return isFinite(t)?t:0},aH=function(){f.useEffect(function(){return document.body.setAttribute(Ql,(m2()+1).toString()),function(){var t=m2()-1;t<=0?document.body.removeAttribute(Ql):document.body.setAttribute(Ql,t.toString())}},[])},iH=function(t){var e=t.noRelative,n=t.noImportant,s=t.gapMode,a=s===void 0?"margin":s;aH();var i=f.useMemo(function(){return nH(a)},[a]);return f.createElement(rH,{styles:sH(i,!e,a,n?"":"!important")})},vy=!1;if(typeof window<"u")try{var cm=Object.defineProperty({},"passive",{get:function(){return vy=!0,!0}});window.addEventListener("test",cm,cm),window.removeEventListener("test",cm,cm)}catch{vy=!1}var hl=vy?{passive:!1}:!1,oH=function(t){return t.tagName==="TEXTAREA"},QD=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!oH(t)&&n[e]==="visible")},lH=function(t){return QD(t,"overflowY")},cH=function(t){return QD(t,"overflowX")},f2=function(t,e){var n=e.ownerDocument,s=e;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var a=YD(t,s);if(a){var i=JD(t,s),o=i[1],l=i[2];if(o>l)return!0}s=s.parentNode}while(s&&s!==n.body);return!1},dH=function(t){var e=t.scrollTop,n=t.scrollHeight,s=t.clientHeight;return[e,n,s]},uH=function(t){var e=t.scrollLeft,n=t.scrollWidth,s=t.clientWidth;return[e,n,s]},YD=function(t,e){return t==="v"?lH(e):cH(e)},JD=function(t,e){return t==="v"?dH(e):uH(e)},hH=function(t,e){return t==="h"&&e==="rtl"?-1:1},mH=function(t,e,n,s,a){var i=hH(t,window.getComputedStyle(e).direction),o=i*s,l=n.target,c=e.contains(l),d=!1,u=o>0,h=0,m=0;do{var p=JD(t,l),b=p[0],x=p[1],g=p[2],y=x-g-i*b;(b||y)&&YD(t,l)&&(h+=y,m+=b),l instanceof ShadowRoot?l=l.host:l=l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(u&&(Math.abs(h)<1||!a)||!u&&(Math.abs(m)<1||!a))&&(d=!0),d},dm=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},p2=function(t){return[t.deltaX,t.deltaY]},x2=function(t){return t&&"current"in t?t.current:t},fH=function(t,e){return t[0]===e[0]&&t[1]===e[1]},pH=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},xH=0,ml=[];function gH(t){var e=f.useRef([]),n=f.useRef([0,0]),s=f.useRef(),a=f.useState(xH++)[0],i=f.useState(ZD)[0],o=f.useRef(t);f.useEffect(function(){o.current=t},[t]),f.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var x=BW([t.lockRef.current],(t.shards||[]).map(x2),!0).filter(Boolean);return x.forEach(function(g){return g.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),x.forEach(function(g){return g.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var l=f.useCallback(function(x,g){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var y=dm(x),v=n.current,w="deltaX"in x?x.deltaX:v[0]-y[0],j="deltaY"in x?x.deltaY:v[1]-y[1],S,N=x.target,k=Math.abs(w)>Math.abs(j)?"h":"v";if("touches"in x&&k==="h"&&N.type==="range")return!1;var E=f2(k,N);if(!E)return!0;if(E?S=k:(S=k==="v"?"h":"v",E=f2(k,N)),!E)return!1;if(!s.current&&"changedTouches"in x&&(w||j)&&(s.current=S),!S)return!0;var P=s.current||S;return mH(P,g,x,P==="h"?w:j,!0)},[]),c=f.useCallback(function(x){var g=x;if(!(!ml.length||ml[ml.length-1]!==i)){var y="deltaY"in g?p2(g):dm(g),v=e.current.filter(function(S){return S.name===g.type&&(S.target===g.target||g.target===S.shadowParent)&&fH(S.delta,y)})[0];if(v&&v.should){g.cancelable&&g.preventDefault();return}if(!v){var w=(o.current.shards||[]).map(x2).filter(Boolean).filter(function(S){return S.contains(g.target)}),j=w.length>0?l(g,w[0]):!o.current.noIsolation;j&&g.cancelable&&g.preventDefault()}}},[]),d=f.useCallback(function(x,g,y,v){var w={name:x,delta:g,target:y,should:v,shadowParent:vH(y)};e.current.push(w),setTimeout(function(){e.current=e.current.filter(function(j){return j!==w})},1)},[]),u=f.useCallback(function(x){n.current=dm(x),s.current=void 0},[]),h=f.useCallback(function(x){d(x.type,p2(x),x.target,l(x,t.lockRef.current))},[]),m=f.useCallback(function(x){d(x.type,dm(x),x.target,l(x,t.lockRef.current))},[]);f.useEffect(function(){return ml.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:m}),document.addEventListener("wheel",c,hl),document.addEventListener("touchmove",c,hl),document.addEventListener("touchstart",u,hl),function(){ml=ml.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,hl),document.removeEventListener("touchmove",c,hl),document.removeEventListener("touchstart",u,hl)}},[]);var p=t.removeScrollBar,b=t.inert;return f.createElement(f.Fragment,null,b?f.createElement(i,{styles:pH(a)}):null,p?f.createElement(iH,{gapMode:t.gapMode}):null)}function vH(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const yH=KW(GD,gH);var mh=f.forwardRef(function(t,e){return f.createElement(rp,Zs({},t,{ref:e,sideCar:yH}))});mh.classNames=rp.classNames;var bH=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},fl=new WeakMap,um=new WeakMap,hm={},ig=0,XD=function(t){return t&&(t.host||XD(t.parentNode))},wH=function(t,e){return e.map(function(n){if(t.contains(n))return n;var s=XD(n);return s&&t.contains(s)?s:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},jH=function(t,e,n,s){var a=wH(e,Array.isArray(t)?t:[t]);hm[n]||(hm[n]=new WeakMap);var i=hm[n],o=[],l=new Set,c=new Set(a),d=function(h){!h||l.has(h)||(l.add(h),d(h.parentNode))};a.forEach(d);var u=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(m){if(l.has(m))u(m);else try{var p=m.getAttribute(s),b=p!==null&&p!=="false",x=(fl.get(m)||0)+1,g=(i.get(m)||0)+1;fl.set(m,x),i.set(m,g),o.push(m),x===1&&b&&um.set(m,!0),g===1&&m.setAttribute(n,"true"),b||m.setAttribute(s,"true")}catch(y){console.error("aria-hidden: cannot operate on ",m,y)}})};return u(e),l.clear(),ig++,function(){o.forEach(function(h){var m=fl.get(h)-1,p=i.get(h)-1;fl.set(h,m),i.set(h,p),m||(um.has(h)||h.removeAttribute(s),um.delete(h)),p||h.removeAttribute(n)}),ig--,ig||(fl=new WeakMap,fl=new WeakMap,um=new WeakMap,hm={})}},sp=function(t,e,n){n===void 0&&(n="data-aria-hidden");var s=Array.from(Array.isArray(t)?t:[t]),a=bH(t);return a?(s.push.apply(s,Array.from(a.querySelectorAll("[aria-live]"))),jH(s,a,n,"aria-hidden")):function(){return null}},zw="Dialog",[eP,Ree]=Zr(zw),[_H,Fs]=eP(zw),tP=t=>{const{__scopeDialog:e,children:n,open:s,defaultOpen:a,onOpenChange:i,modal:o=!0}=t,l=f.useRef(null),c=f.useRef(null),[d=!1,u]=os({prop:s,defaultProp:a,onChange:i});return r.jsx(_H,{scope:e,triggerRef:l,contentRef:c,contentId:Lr(),titleId:Lr(),descriptionId:Lr(),open:d,onOpenChange:u,onOpenToggle:f.useCallback(()=>u(h=>!h),[u]),modal:o,children:n})};tP.displayName=zw;var nP="DialogTrigger",rP=f.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,a=Fs(nP,n),i=yt(e,a.triggerRef);return r.jsx(Le.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Ww(a.open),...s,ref:i,onClick:be(t.onClick,a.onOpenToggle)})});rP.displayName=nP;var Uw="DialogPortal",[NH,sP]=eP(Uw,{forceMount:void 0}),aP=t=>{const{__scopeDialog:e,forceMount:n,children:s,container:a}=t,i=Fs(Uw,e);return r.jsx(NH,{scope:e,forceMount:n,children:f.Children.map(s,o=>r.jsx(Sn,{present:n||i.open,children:r.jsx(Tc,{asChild:!0,container:a,children:o})}))})};aP.displayName=Uw;var Zf="DialogOverlay",iP=f.forwardRef((t,e)=>{const n=sP(Zf,t.__scopeDialog),{forceMount:s=n.forceMount,...a}=t,i=Fs(Zf,t.__scopeDialog);return i.modal?r.jsx(Sn,{present:s||i.open,children:r.jsx(SH,{...a,ref:e})}):null});iP.displayName=Zf;var SH=f.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,a=Fs(Zf,n);return r.jsx(mh,{as:Ia,allowPinchZoom:!0,shards:[a.contentRef],children:r.jsx(Le.div,{"data-state":Ww(a.open),...s,ref:e,style:{pointerEvents:"auto",...s.style}})})}),Uo="DialogContent",oP=f.forwardRef((t,e)=>{const n=sP(Uo,t.__scopeDialog),{forceMount:s=n.forceMount,...a}=t,i=Fs(Uo,t.__scopeDialog);return r.jsx(Sn,{present:s||i.open,children:i.modal?r.jsx(kH,{...a,ref:e}):r.jsx(CH,{...a,ref:e})})});oP.displayName=Uo;var kH=f.forwardRef((t,e)=>{const n=Fs(Uo,t.__scopeDialog),s=f.useRef(null),a=yt(e,n.contentRef,s);return f.useEffect(()=>{const i=s.current;if(i)return sp(i)},[]),r.jsx(lP,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:be(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:be(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:be(t.onFocusOutside,i=>i.preventDefault())})}),CH=f.forwardRef((t,e)=>{const n=Fs(Uo,t.__scopeDialog),s=f.useRef(!1),a=f.useRef(!1);return r.jsx(lP,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(s.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:i=>{var c,d;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((d=n.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),lP=f.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,...o}=t,l=Fs(Uo,n),c=f.useRef(null),d=yt(e,c);return np(),r.jsxs(r.Fragment,{children:[r.jsx(hh,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:i,children:r.jsx(Go,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":Ww(l.open),...o,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),r.jsxs(r.Fragment,{children:[r.jsx(EH,{titleId:l.titleId}),r.jsx(DH,{contentRef:c,descriptionId:l.descriptionId})]})]})}),qw="DialogTitle",cP=f.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,a=Fs(qw,n);return r.jsx(Le.h2,{id:a.titleId,...s,ref:e})});cP.displayName=qw;var dP="DialogDescription",uP=f.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,a=Fs(dP,n);return r.jsx(Le.p,{id:a.descriptionId,...s,ref:e})});uP.displayName=dP;var hP="DialogClose",mP=f.forwardRef((t,e)=>{const{__scopeDialog:n,...s}=t,a=Fs(hP,n);return r.jsx(Le.button,{type:"button",...s,ref:e,onClick:be(t.onClick,()=>a.onOpenChange(!1))})});mP.displayName=hP;function Ww(t){return t?"open":"closed"}var fP="DialogTitleWarning",[Mee,pP]=EM(fP,{contentName:Uo,titleName:qw,docsSlug:"dialog"}),EH=({titleId:t})=>{const e=pP(fP),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return f.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},AH="DialogDescriptionWarning",DH=({contentRef:t,descriptionId:e})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${pP(AH).contentName}}.`;return f.useEffect(()=>{var i;const a=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&a&&(document.getElementById(e)||console.warn(s))},[s,t,e]),null},PH=tP,TH=rP,RH=aP,xP=iP,gP=oP,vP=cP,yP=uP,MH=mP;const Mt=PH,IH=TH,OH=RH,bP=f.forwardRef(({className:t,...e},n)=>r.jsx(xP,{ref:n,className:_e("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));bP.displayName=xP.displayName;const Pt=f.forwardRef(({className:t,children:e,...n},s)=>r.jsxs(OH,{children:[r.jsx(bP,{}),r.jsxs(gP,{ref:s,className:_e("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,r.jsxs(MH,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[r.jsx(Mn,{className:"h-4 w-4"}),r.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Pt.displayName=gP.displayName;const Bt=({className:t,...e})=>r.jsx("div",{className:_e("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Bt.displayName="DialogHeader";const Qd=({className:t,...e})=>r.jsx("div",{className:_e("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});Qd.displayName="DialogFooter";const Lt=f.forwardRef(({className:t,...e},n)=>r.jsx(vP,{ref:n,className:_e("text-lg font-semibold leading-none tracking-tight",t),...e}));Lt.displayName=vP.displayName;const Nn=f.forwardRef(({className:t,...e},n)=>r.jsx(yP,{ref:n,className:_e("text-sm text-muted-foreground",t),...e}));Nn.displayName=yP.displayName;function yy(t,[e,n]){return Math.min(n,Math.max(e,t))}function wP(t){const e=f.useRef({value:t,previous:t});return f.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var FH=[" ","Enter","ArrowUp","ArrowDown"],BH=[" ","Enter"],fh="Select",[ap,ip,LH]=Qu(fh),[Kc,Iee]=Zr(fh,[LH,Qi]),op=Qi(),[$H,eo]=Kc(fh),[zH,UH]=Kc(fh),jP=t=>{const{__scopeSelect:e,children:n,open:s,defaultOpen:a,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:h,disabled:m,required:p,form:b}=t,x=op(e),[g,y]=f.useState(null),[v,w]=f.useState(null),[j,S]=f.useState(!1),N=Wc(d),[k=!1,E]=os({prop:s,defaultProp:a,onChange:i}),[P,A]=os({prop:o,defaultProp:l,onChange:c}),C=f.useRef(null),T=g?b||!!g.closest("form"):!0,[I,V]=f.useState(new Set),ne=Array.from(I).map(se=>se.props.value).join(";");return r.jsx(zb,{...x,children:r.jsxs($H,{required:p,scope:e,trigger:g,onTriggerChange:y,valueNode:v,onValueNodeChange:w,valueNodeHasChildren:j,onValueNodeHasChildrenChange:S,contentId:Lr(),value:P,onValueChange:A,open:k,onOpenChange:E,dir:N,triggerPointerDownPosRef:C,disabled:m,children:[r.jsx(ap.Provider,{scope:e,children:r.jsx(zH,{scope:t.__scopeSelect,onNativeOptionAdd:f.useCallback(se=>{V(q=>new Set(q).add(se))},[]),onNativeOptionRemove:f.useCallback(se=>{V(q=>{const O=new Set(q);return O.delete(se),O})},[]),children:n})}),T?r.jsxs(KP,{"aria-hidden":!0,required:p,tabIndex:-1,name:u,autoComplete:h,value:P,onChange:se=>A(se.target.value),disabled:m,form:b,children:[P===void 0?r.jsx("option",{value:""}):null,Array.from(I)]},ne):null]})})};jP.displayName=fh;var _P="SelectTrigger",NP=f.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:s=!1,...a}=t,i=op(n),o=eo(_P,n),l=o.disabled||s,c=yt(e,o.onTriggerChange),d=ip(n),u=f.useRef("touch"),[h,m,p]=GP(x=>{const g=d().filter(w=>!w.disabled),y=g.find(w=>w.value===o.value),v=ZP(g,x,y);v!==void 0&&o.onValueChange(v.value)}),b=x=>{l||(o.onOpenChange(!0),p()),x&&(o.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return r.jsx(rh,{asChild:!0,...i,children:r.jsx(Le.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":VP(o.value)?"":void 0,...a,ref:c,onClick:be(a.onClick,x=>{x.currentTarget.focus(),u.current!=="mouse"&&b(x)}),onPointerDown:be(a.onPointerDown,x=>{u.current=x.pointerType;const g=x.target;g.hasPointerCapture(x.pointerId)&&g.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(b(x),x.preventDefault())}),onKeyDown:be(a.onKeyDown,x=>{const g=h.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&m(x.key),!(g&&x.key===" ")&&FH.includes(x.key)&&(b(),x.preventDefault())})})})});NP.displayName=_P;var SP="SelectValue",kP=f.forwardRef((t,e)=>{const{__scopeSelect:n,className:s,style:a,children:i,placeholder:o="",...l}=t,c=eo(SP,n),{onValueNodeHasChildrenChange:d}=c,u=i!==void 0,h=yt(e,c.onValueNodeChange);return gn(()=>{d(u)},[d,u]),r.jsx(Le.span,{...l,ref:h,style:{pointerEvents:"none"},children:VP(c.value)?r.jsx(r.Fragment,{children:o}):i})});kP.displayName=SP;var qH="SelectIcon",CP=f.forwardRef((t,e)=>{const{__scopeSelect:n,children:s,...a}=t;return r.jsx(Le.span,{"aria-hidden":!0,...a,ref:e,children:s||"▼"})});CP.displayName=qH;var WH="SelectPortal",EP=t=>r.jsx(Tc,{asChild:!0,...t});EP.displayName=WH;var qo="SelectContent",AP=f.forwardRef((t,e)=>{const n=eo(qo,t.__scopeSelect),[s,a]=f.useState();if(gn(()=>{a(new DocumentFragment)},[]),!n.open){const i=s;return i?Ko.createPortal(r.jsx(DP,{scope:t.__scopeSelect,children:r.jsx(ap.Slot,{scope:t.__scopeSelect,children:r.jsx("div",{children:t.children})})}),i):null}return r.jsx(PP,{...t,ref:e})});AP.displayName=qo;var hs=10,[DP,to]=Kc(qo),HH="SelectContentImpl",PP=f.forwardRef((t,e)=>{const{__scopeSelect:n,position:s="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:m,collisionPadding:p,sticky:b,hideWhenDetached:x,avoidCollisions:g,...y}=t,v=eo(qo,n),[w,j]=f.useState(null),[S,N]=f.useState(null),k=yt(e,z=>j(z)),[E,P]=f.useState(null),[A,C]=f.useState(null),T=ip(n),[I,V]=f.useState(!1),ne=f.useRef(!1);f.useEffect(()=>{if(w)return sp(w)},[w]),np();const se=f.useCallback(z=>{const[Y,...ae]=T().map(oe=>oe.ref.current),[U]=ae.slice(-1),Q=document.activeElement;for(const oe of z)if(oe===Q||(oe==null||oe.scrollIntoView({block:"nearest"}),oe===Y&&S&&(S.scrollTop=0),oe===U&&S&&(S.scrollTop=S.scrollHeight),oe==null||oe.focus(),document.activeElement!==Q))return},[T,S]),q=f.useCallback(()=>se([E,w]),[se,E,w]);f.useEffect(()=>{I&&q()},[I,q]);const{onOpenChange:O,triggerPointerDownPosRef:F}=v;f.useEffect(()=>{if(w){let z={x:0,y:0};const Y=U=>{var Q,oe;z={x:Math.abs(Math.round(U.pageX)-(((Q=F.current)==null?void 0:Q.x)??0)),y:Math.abs(Math.round(U.pageY)-(((oe=F.current)==null?void 0:oe.y)??0))}},ae=U=>{z.x<=10&&z.y<=10?U.preventDefault():w.contains(U.target)||O(!1),document.removeEventListener("pointermove",Y),F.current=null};return F.current!==null&&(document.addEventListener("pointermove",Y),document.addEventListener("pointerup",ae,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Y),document.removeEventListener("pointerup",ae,{capture:!0})}}},[w,O,F]),f.useEffect(()=>{const z=()=>O(!1);return window.addEventListener("blur",z),window.addEventListener("resize",z),()=>{window.removeEventListener("blur",z),window.removeEventListener("resize",z)}},[O]);const[B,R]=GP(z=>{const Y=T().filter(Q=>!Q.disabled),ae=Y.find(Q=>Q.ref.current===document.activeElement),U=ZP(Y,z,ae);U&&setTimeout(()=>U.ref.current.focus())}),D=f.useCallback((z,Y,ae)=>{const U=!ne.current&&!ae;(v.value!==void 0&&v.value===Y||U)&&(P(z),U&&(ne.current=!0))},[v.value]),L=f.useCallback(()=>w==null?void 0:w.focus(),[w]),M=f.useCallback((z,Y,ae)=>{const U=!ne.current&&!ae;(v.value!==void 0&&v.value===Y||U)&&C(z)},[v.value]),X=s==="popper"?by:TP,K=X===by?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:m,collisionPadding:p,sticky:b,hideWhenDetached:x,avoidCollisions:g}:{};return r.jsx(DP,{scope:n,content:w,viewport:S,onViewportChange:N,itemRefCallback:D,selectedItem:E,onItemLeave:L,itemTextRefCallback:M,focusSelectedItem:q,selectedItemText:A,position:s,isPositioned:I,searchRef:B,children:r.jsx(mh,{as:Ia,allowPinchZoom:!0,children:r.jsx(hh,{asChild:!0,trapped:v.open,onMountAutoFocus:z=>{z.preventDefault()},onUnmountAutoFocus:be(a,z=>{var Y;(Y=v.trigger)==null||Y.focus({preventScroll:!0}),z.preventDefault()}),children:r.jsx(Go,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:z=>z.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:r.jsx(X,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:z=>z.preventDefault(),...y,...K,onPlaced:()=>V(!0),ref:k,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:be(y.onKeyDown,z=>{const Y=z.ctrlKey||z.altKey||z.metaKey;if(z.key==="Tab"&&z.preventDefault(),!Y&&z.key.length===1&&R(z.key),["ArrowUp","ArrowDown","Home","End"].includes(z.key)){let U=T().filter(Q=>!Q.disabled).map(Q=>Q.ref.current);if(["ArrowUp","End"].includes(z.key)&&(U=U.slice().reverse()),["ArrowUp","ArrowDown"].includes(z.key)){const Q=z.target,oe=U.indexOf(Q);U=U.slice(oe+1)}setTimeout(()=>se(U)),z.preventDefault()}})})})})})})});PP.displayName=HH;var VH="SelectItemAlignedPosition",TP=f.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:s,...a}=t,i=eo(qo,n),o=to(qo,n),[l,c]=f.useState(null),[d,u]=f.useState(null),h=yt(e,k=>u(k)),m=ip(n),p=f.useRef(!1),b=f.useRef(!0),{viewport:x,selectedItem:g,selectedItemText:y,focusSelectedItem:v}=o,w=f.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&d&&x&&g&&y){const k=i.trigger.getBoundingClientRect(),E=d.getBoundingClientRect(),P=i.valueNode.getBoundingClientRect(),A=y.getBoundingClientRect();if(i.dir!=="rtl"){const Q=A.left-E.left,oe=P.left-Q,re=k.left-oe,le=k.width+re,Z=Math.max(le,E.width),de=window.innerWidth-hs,he=yy(oe,[hs,Math.max(hs,de-Z)]);l.style.minWidth=le+"px",l.style.left=he+"px"}else{const Q=E.right-A.right,oe=window.innerWidth-P.right-Q,re=window.innerWidth-k.right-oe,le=k.width+re,Z=Math.max(le,E.width),de=window.innerWidth-hs,he=yy(oe,[hs,Math.max(hs,de-Z)]);l.style.minWidth=le+"px",l.style.right=he+"px"}const C=m(),T=window.innerHeight-hs*2,I=x.scrollHeight,V=window.getComputedStyle(d),ne=parseInt(V.borderTopWidth,10),se=parseInt(V.paddingTop,10),q=parseInt(V.borderBottomWidth,10),O=parseInt(V.paddingBottom,10),F=ne+se+I+O+q,B=Math.min(g.offsetHeight*5,F),R=window.getComputedStyle(x),D=parseInt(R.paddingTop,10),L=parseInt(R.paddingBottom,10),M=k.top+k.height/2-hs,X=T-M,K=g.offsetHeight/2,z=g.offsetTop+K,Y=ne+se+z,ae=F-Y;if(Y<=M){const Q=C.length>0&&g===C[C.length-1].ref.current;l.style.bottom="0px";const oe=d.clientHeight-x.offsetTop-x.offsetHeight,re=Math.max(X,K+(Q?L:0)+oe+q),le=Y+re;l.style.height=le+"px"}else{const Q=C.length>0&&g===C[0].ref.current;l.style.top="0px";const re=Math.max(M,ne+x.offsetTop+(Q?D:0)+K)+ae;l.style.height=re+"px",x.scrollTop=Y-M+x.offsetTop}l.style.margin=`${hs}px 0`,l.style.minHeight=B+"px",l.style.maxHeight=T+"px",s==null||s(),requestAnimationFrame(()=>p.current=!0)}},[m,i.trigger,i.valueNode,l,d,x,g,y,i.dir,s]);gn(()=>w(),[w]);const[j,S]=f.useState();gn(()=>{d&&S(window.getComputedStyle(d).zIndex)},[d]);const N=f.useCallback(k=>{k&&b.current===!0&&(w(),v==null||v(),b.current=!1)},[w,v]);return r.jsx(GH,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:p,onScrollButtonChange:N,children:r.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:r.jsx(Le.div,{...a,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});TP.displayName=VH;var KH="SelectPopperPosition",by=f.forwardRef((t,e)=>{const{__scopeSelect:n,align:s="start",collisionPadding:a=hs,...i}=t,o=op(n);return r.jsx(D0,{...o,...i,ref:e,align:s,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});by.displayName=KH;var[GH,Hw]=Kc(qo,{}),wy="SelectViewport",RP=f.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:s,...a}=t,i=to(wy,n),o=Hw(wy,n),l=yt(e,i.onViewportChange),c=f.useRef(0);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),r.jsx(ap.Slot,{scope:n,children:r.jsx(Le.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:be(a.onScroll,d=>{const u=d.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:m}=o;if(m!=null&&m.current&&h){const p=Math.abs(c.current-u.scrollTop);if(p>0){const b=window.innerHeight-hs*2,x=parseFloat(h.style.minHeight),g=parseFloat(h.style.height),y=Math.max(x,g);if(y<b){const v=y+p,w=Math.min(b,v),j=v-w;h.style.height=w+"px",h.style.bottom==="0px"&&(u.scrollTop=j>0?j:0,h.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});RP.displayName=wy;var MP="SelectGroup",[ZH,QH]=Kc(MP),YH=f.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,a=Lr();return r.jsx(ZH,{scope:n,id:a,children:r.jsx(Le.div,{role:"group","aria-labelledby":a,...s,ref:e})})});YH.displayName=MP;var IP="SelectLabel",OP=f.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,a=QH(IP,n);return r.jsx(Le.div,{id:a.id,...s,ref:e})});OP.displayName=IP;var Qf="SelectItem",[JH,FP]=Kc(Qf),BP=f.forwardRef((t,e)=>{const{__scopeSelect:n,value:s,disabled:a=!1,textValue:i,...o}=t,l=eo(Qf,n),c=to(Qf,n),d=l.value===s,[u,h]=f.useState(i??""),[m,p]=f.useState(!1),b=yt(e,v=>{var w;return(w=c.itemRefCallback)==null?void 0:w.call(c,v,s,a)}),x=Lr(),g=f.useRef("touch"),y=()=>{a||(l.onValueChange(s),l.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return r.jsx(JH,{scope:n,value:s,disabled:a,textId:x,isSelected:d,onItemTextChange:f.useCallback(v=>{h(w=>w||((v==null?void 0:v.textContent)??"").trim())},[]),children:r.jsx(ap.ItemSlot,{scope:n,value:s,disabled:a,textValue:u,children:r.jsx(Le.div,{role:"option","aria-labelledby":x,"data-highlighted":m?"":void 0,"aria-selected":d&&m,"data-state":d?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...o,ref:b,onFocus:be(o.onFocus,()=>p(!0)),onBlur:be(o.onBlur,()=>p(!1)),onClick:be(o.onClick,()=>{g.current!=="mouse"&&y()}),onPointerUp:be(o.onPointerUp,()=>{g.current==="mouse"&&y()}),onPointerDown:be(o.onPointerDown,v=>{g.current=v.pointerType}),onPointerMove:be(o.onPointerMove,v=>{var w;g.current=v.pointerType,a?(w=c.onItemLeave)==null||w.call(c):g.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:be(o.onPointerLeave,v=>{var w;v.currentTarget===document.activeElement&&((w=c.onItemLeave)==null||w.call(c))}),onKeyDown:be(o.onKeyDown,v=>{var j;((j=c.searchRef)==null?void 0:j.current)!==""&&v.key===" "||(BH.includes(v.key)&&y(),v.key===" "&&v.preventDefault())})})})})});BP.displayName=Qf;var Cd="SelectItemText",LP=f.forwardRef((t,e)=>{const{__scopeSelect:n,className:s,style:a,...i}=t,o=eo(Cd,n),l=to(Cd,n),c=FP(Cd,n),d=UH(Cd,n),[u,h]=f.useState(null),m=yt(e,y=>h(y),c.onItemTextChange,y=>{var v;return(v=l.itemTextRefCallback)==null?void 0:v.call(l,y,c.value,c.disabled)}),p=u==null?void 0:u.textContent,b=f.useMemo(()=>r.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:x,onNativeOptionRemove:g}=d;return gn(()=>(x(b),()=>g(b)),[x,g,b]),r.jsxs(r.Fragment,{children:[r.jsx(Le.span,{id:c.textId,...i,ref:m}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Ko.createPortal(i.children,o.valueNode):null]})});LP.displayName=Cd;var $P="SelectItemIndicator",zP=f.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t;return FP($P,n).isSelected?r.jsx(Le.span,{"aria-hidden":!0,...s,ref:e}):null});zP.displayName=$P;var jy="SelectScrollUpButton",UP=f.forwardRef((t,e)=>{const n=to(jy,t.__scopeSelect),s=Hw(jy,t.__scopeSelect),[a,i]=f.useState(!1),o=yt(e,s.onScrollButtonChange);return gn(()=>{if(n.viewport&&n.isPositioned){let l=function(){const d=c.scrollTop>0;i(d)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),a?r.jsx(WP,{...t,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});UP.displayName=jy;var _y="SelectScrollDownButton",qP=f.forwardRef((t,e)=>{const n=to(_y,t.__scopeSelect),s=Hw(_y,t.__scopeSelect),[a,i]=f.useState(!1),o=yt(e,s.onScrollButtonChange);return gn(()=>{if(n.viewport&&n.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;i(u)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),a?r.jsx(WP,{...t,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});qP.displayName=_y;var WP=f.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:s,...a}=t,i=to("SelectScrollButton",n),o=f.useRef(null),l=ip(n),c=f.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return f.useEffect(()=>()=>c(),[c]),gn(()=>{var u;const d=l().find(h=>h.ref.current===document.activeElement);(u=d==null?void 0:d.ref.current)==null||u.scrollIntoView({block:"nearest"})},[l]),r.jsx(Le.div,{"aria-hidden":!0,...a,ref:e,style:{flexShrink:0,...a.style},onPointerDown:be(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(s,50))}),onPointerMove:be(a.onPointerMove,()=>{var d;(d=i.onItemLeave)==null||d.call(i),o.current===null&&(o.current=window.setInterval(s,50))}),onPointerLeave:be(a.onPointerLeave,()=>{c()})})}),XH="SelectSeparator",HP=f.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t;return r.jsx(Le.div,{"aria-hidden":!0,...s,ref:e})});HP.displayName=XH;var Ny="SelectArrow",eV=f.forwardRef((t,e)=>{const{__scopeSelect:n,...s}=t,a=op(n),i=eo(Ny,n),o=to(Ny,n);return i.open&&o.position==="popper"?r.jsx(P0,{...a,...s,ref:e}):null});eV.displayName=Ny;function VP(t){return t===""||t===void 0}var KP=f.forwardRef((t,e)=>{const{value:n,...s}=t,a=f.useRef(null),i=yt(e,a),o=wP(n);return f.useEffect(()=>{const l=a.current,c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==n&&u){const h=new Event("change",{bubbles:!0});u.call(l,n),l.dispatchEvent(h)}},[o,n]),r.jsx(Yu,{asChild:!0,children:r.jsx("select",{...s,ref:i,defaultValue:n})})});KP.displayName="BubbleSelect";function GP(t){const e=nn(t),n=f.useRef(""),s=f.useRef(0),a=f.useCallback(o=>{const l=n.current+o;e(l),function c(d){n.current=d,window.clearTimeout(s.current),d!==""&&(s.current=window.setTimeout(()=>c(""),1e3))}(l)},[e]),i=f.useCallback(()=>{n.current="",window.clearTimeout(s.current)},[]);return f.useEffect(()=>()=>window.clearTimeout(s.current),[]),[n,a,i]}function ZP(t,e,n){const a=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=tV(t,Math.max(i,0));a.length===1&&(o=o.filter(d=>d!==n));const c=o.find(d=>d.textValue.toLowerCase().startsWith(a.toLowerCase()));return c!==n?c:void 0}function tV(t,e){return t.map((n,s)=>t[(e+s)%t.length])}var nV=jP,QP=NP,rV=kP,sV=CP,aV=EP,YP=AP,iV=RP,JP=OP,XP=BP,oV=LP,lV=zP,eT=UP,tT=qP,nT=HP;const tt=nV,nt=rV,Je=f.forwardRef(({className:t,children:e,...n},s)=>r.jsxs(QP,{ref:s,className:_e("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,r.jsx(sV,{asChild:!0,children:r.jsx(S0,{className:"h-4 w-4 opacity-50"})})]}));Je.displayName=QP.displayName;const rT=f.forwardRef(({className:t,...e},n)=>r.jsx(eT,{ref:n,className:_e("flex cursor-default items-center justify-center py-1",t),...e,children:r.jsx(y8,{className:"h-4 w-4"})}));rT.displayName=eT.displayName;const sT=f.forwardRef(({className:t,...e},n)=>r.jsx(tT,{ref:n,className:_e("flex cursor-default items-center justify-center py-1",t),...e,children:r.jsx(S0,{className:"h-4 w-4"})}));sT.displayName=tT.displayName;const Xe=f.forwardRef(({className:t,children:e,position:n="popper",...s},a)=>r.jsx(aV,{children:r.jsxs(YP,{ref:a,className:_e("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...s,children:[r.jsx(rT,{}),r.jsx(iV,{className:_e("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),r.jsx(sT,{})]})}));Xe.displayName=YP.displayName;const cV=f.forwardRef(({className:t,...e},n)=>r.jsx(JP,{ref:n,className:_e("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));cV.displayName=JP.displayName;const ce=f.forwardRef(({className:t,children:e,...n},s)=>r.jsxs(XP,{ref:s,className:_e("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(lV,{children:r.jsx(Xu,{className:"h-4 w-4"})})}),r.jsx(oV,{children:e})]}));ce.displayName=XP.displayName;const dV=f.forwardRef(({className:t,...e},n)=>r.jsx(nT,{ref:n,className:_e("-mx-1 my-1 h-px bg-muted",t),...e}));dV.displayName=nT.displayName;const uV=({isOpen:t,onClose:e,onCustomerAdded:n})=>{const{toast:s}=pt(),[a,i]=f.useState({company_name:"",anrede:"",first_name:"",last_name:"",contact_person:"",email:"",phone:"",mobile:"",fax:"",website:"",address:"",city:"",postal_code:"",country:"Deutschland",status:"Aktiv",customer_number:"",tax_number:"",zahlungsziel:"30",skonto_prozent:"",skonto_tage:"",waehrung:"EUR",preisgruppe:"Standard",iban:"",bic:"",bank_name:"",kontoinhaber:"",zugprd_status:"Inaktiv",benutzer_id:"",passwort:""}),o=c=>{if(c.preventDefault(),!a.company_name||!a.contact_person||!a.email){s({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)){s({title:"Fehler",description:"Bitte geben Sie eine gültige E-Mail-Adresse ein.",variant:"destructive"});return}n(a),i({company_name:"",anrede:"",first_name:"",last_name:"",contact_person:"",email:"",phone:"",mobile:"",fax:"",website:"",address:"",city:"",postal_code:"",country:"Deutschland",status:"Aktiv",customer_number:"",tax_number:"",zahlungsziel:"30",skonto_prozent:"",skonto_tage:"",waehrung:"EUR",preisgruppe:"Standard",iban:"",bic:"",bank_name:"",kontoinhaber:"",zugprd_status:"Inaktiv",benutzer_id:"",passwort:""}),e()},l=(c,d)=>{i(u=>({...u,[c]:d}))};return r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-6xl max-h-[95vh] overflow-y-auto",children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Neuen Kunden hinzufügen"}),r.jsx(Nn,{children:"Geben Sie die Informationen für den neuen Kunden ein."})]}),r.jsxs("form",{onSubmit:o,className:"space-y-6",children:[r.jsxs(cr,{defaultValue:"ansprechpartner",className:"w-full",children:[r.jsxs(tr,{className:"grid grid-cols-6 w-full",children:[r.jsx(Oe,{value:"ansprechpartner",children:"ANSPRECHPARTNER"}),r.jsx(Oe,{value:"kontaktdetails",children:"KONTAKTDETAILS"}),r.jsx(Oe,{value:"adresse",children:"ADRESSE"}),r.jsx(Oe,{value:"konditionen",children:"KONDITIONEN"}),r.jsx(Oe,{value:"zahlungsdaten",children:"ZAHLUNGSDATEN"}),r.jsx(Oe,{value:"zugprd",children:"ZUGPRD 2.0 STANDARD"})]}),r.jsxs(Fe,{value:"ansprechpartner",className:"space-y-4 mt-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"company_name",children:"Firmenname *"}),r.jsx(G,{id:"company_name",value:a.company_name,onChange:c=>l("company_name",c.target.value),placeholder:"z.B. Mustermann GmbH",required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"customer_number",children:"Kundennummer"}),r.jsx(G,{id:"customer_number",value:a.customer_number,onChange:c=>l("customer_number",c.target.value),placeholder:"AUTO"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"anrede",children:"Anrede"}),r.jsxs(tt,{value:a.anrede,onValueChange:c=>l("anrede",c),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Wählen..."})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Herr",children:"Herr"}),r.jsx(ce,{value:"Frau",children:"Frau"}),r.jsx(ce,{value:"Divers",children:"Divers"})]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"first_name",children:"Vorname"}),r.jsx(G,{id:"first_name",value:a.first_name,onChange:c=>l("first_name",c.target.value),placeholder:"Max"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"last_name",children:"Nachname"}),r.jsx(G,{id:"last_name",value:a.last_name,onChange:c=>l("last_name",c.target.value),placeholder:"Mustermann"})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"contact_person",children:"Ansprechpartner *"}),r.jsx(G,{id:"contact_person",value:a.contact_person,onChange:c=>l("contact_person",c.target.value),placeholder:"z.B. Max Mustermann",required:!0})]})]}),r.jsxs(Fe,{value:"kontaktdetails",className:"space-y-4 mt-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"email",children:"E-Mail *"}),r.jsx(G,{id:"email",type:"email",value:a.email,onChange:c=>l("email",c.target.value),placeholder:"kontakt@firma.de",required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"website",children:"Website"}),r.jsx(G,{id:"website",value:a.website,onChange:c=>l("website",c.target.value),placeholder:"www.firma.de"})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"phone",children:"Telefon"}),r.jsx(G,{id:"phone",value:a.phone,onChange:c=>l("phone",c.target.value),placeholder:"+49 123 456789"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"mobile",children:"Mobil"}),r.jsx(G,{id:"mobile",value:a.mobile,onChange:c=>l("mobile",c.target.value),placeholder:"+49 123 456789"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"fax",children:"Fax"}),r.jsx(G,{id:"fax",value:a.fax,onChange:c=>l("fax",c.target.value),placeholder:"+49 123 456789"})]})]})]}),r.jsxs(Fe,{value:"adresse",className:"space-y-4 mt-6",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"address",children:"Straße und Hausnummer"}),r.jsx(G,{id:"address",value:a.address,onChange:c=>l("address",c.target.value),placeholder:"Musterstraße 123"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"postal_code",children:"PLZ"}),r.jsx(G,{id:"postal_code",value:a.postal_code,onChange:c=>l("postal_code",c.target.value),placeholder:"12345"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"city",children:"Ort"}),r.jsx(G,{id:"city",value:a.city,onChange:c=>l("city",c.target.value),placeholder:"Berlin"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"country",children:"Land"}),r.jsx(G,{id:"country",value:a.country,onChange:c=>l("country",c.target.value),placeholder:"Deutschland"})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"tax_number",children:"Steuernummer"}),r.jsx(G,{id:"tax_number",value:a.tax_number,onChange:c=>l("tax_number",c.target.value),placeholder:"123/456/78910"})]})]}),r.jsxs(Fe,{value:"konditionen",className:"space-y-4 mt-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"zahlungsziel",children:"Zahlungsziel (Tage)"}),r.jsxs(tt,{value:a.zahlungsziel,onValueChange:c=>l("zahlungsziel",c),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"14",children:"14 Tage"}),r.jsx(ce,{value:"30",children:"30 Tage"}),r.jsx(ce,{value:"60",children:"60 Tage"}),r.jsx(ce,{value:"90",children:"90 Tage"})]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"waehrung",children:"Währung"}),r.jsxs(tt,{value:a.waehrung,onValueChange:c=>l("waehrung",c),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"EUR",children:"EUR"}),r.jsx(ce,{value:"USD",children:"USD"}),r.jsx(ce,{value:"GBP",children:"GBP"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"skonto_prozent",children:"Skonto %"}),r.jsx(G,{id:"skonto_prozent",value:a.skonto_prozent,onChange:c=>l("skonto_prozent",c.target.value),placeholder:"2"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"skonto_tage",children:"Skonto Tage"}),r.jsx(G,{id:"skonto_tage",value:a.skonto_tage,onChange:c=>l("skonto_tage",c.target.value),placeholder:"10"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"preisgruppe",children:"Preisgruppe"}),r.jsxs(tt,{value:a.preisgruppe,onValueChange:c=>l("preisgruppe",c),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Standard",children:"Standard"}),r.jsx(ce,{value:"Premium",children:"Premium"}),r.jsx(ce,{value:"VIP",children:"VIP"})]})]})]})]})]}),r.jsxs(Fe,{value:"zahlungsdaten",className:"space-y-4 mt-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"iban",children:"IBAN"}),r.jsx(G,{id:"iban",value:a.iban,onChange:c=>l("iban",c.target.value),placeholder:"DE89 3704 0044 0532 0130 00"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"bic",children:"BIC"}),r.jsx(G,{id:"bic",value:a.bic,onChange:c=>l("bic",c.target.value),placeholder:"COBADEFFXXX"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"bank_name",children:"Bank"}),r.jsx(G,{id:"bank_name",value:a.bank_name,onChange:c=>l("bank_name",c.target.value),placeholder:"Commerzbank AG"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"kontoinhaber",children:"Kontoinhaber"}),r.jsx(G,{id:"kontoinhaber",value:a.kontoinhaber,onChange:c=>l("kontoinhaber",c.target.value),placeholder:"Mustermann GmbH"})]})]})]}),r.jsxs(Fe,{value:"zugprd",className:"space-y-4 mt-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"zugprd_status",children:"Status"}),r.jsxs(tt,{value:a.zugprd_status,onValueChange:c=>l("zugprd_status",c),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Aktiv",children:"Aktiv"}),r.jsx(ce,{value:"Inaktiv",children:"Inaktiv"})]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"status",children:"Kundenstatus"}),r.jsxs(tt,{value:a.status,onValueChange:c=>l("status",c),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Aktiv",children:"Aktiv"}),r.jsx(ce,{value:"Premium",children:"Premium"}),r.jsx(ce,{value:"Inaktiv",children:"Inaktiv"})]})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"benutzer_id",children:"Benutzer-ID"}),r.jsx(G,{id:"benutzer_id",value:a.benutzer_id,onChange:c=>l("benutzer_id",c.target.value),placeholder:"user123"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"passwort",children:"Passwort"}),r.jsx(G,{id:"passwort",type:"password",value:a.passwort,onChange:c=>l("passwort",c.target.value),placeholder:"••••••••"})]})]})]})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(W,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),r.jsx(W,{type:"submit",className:"flex-1",children:"Kunde hinzufügen"})]})]})]})})},an=f.forwardRef(({className:t,...e},n)=>r.jsx("textarea",{className:_e("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));an.displayName="Textarea";const hV=({isOpen:t,onClose:e,customer:n,onCustomerUpdated:s})=>{const{toast:a}=pt(),i=xW(),[o,l]=f.useState({company_name:(n==null?void 0:n.company_name)||"",contact_person:(n==null?void 0:n.contact_person)||"",email:(n==null?void 0:n.email)||"",phone:(n==null?void 0:n.phone)||"",address:(n==null?void 0:n.address)||"",city:(n==null?void 0:n.city)||"",postal_code:(n==null?void 0:n.postal_code)||"",country:(n==null?void 0:n.country)||"Deutschland",status:(n==null?void 0:n.status)||"Aktiv",anrede:(n==null?void 0:n.anrede)||"",first_name:(n==null?void 0:n.first_name)||"",last_name:(n==null?void 0:n.last_name)||"",mobile:(n==null?void 0:n.mobile)||"",website:(n==null?void 0:n.website)||"",erreichbarkeit:(n==null?void 0:n.erreichbarkeit)||"",sonstiges:(n==null?void 0:n.sonstiges)||"",festnetz:(n==null?void 0:n.festnetz)||"",fax:(n==null?void 0:n.fax)||"",zahlungsziel:(n==null?void 0:n.zahlungsziel)||"",skonto:(n==null?void 0:n.skonto)||"",skontofrist:(n==null?void 0:n.skontofrist)||"",verkaufspreise_gruppe:(n==null?void 0:n.verkaufspreise_gruppe)||"",iban:(n==null?void 0:n.iban)||"",bic:(n==null?void 0:n.bic)||"",bank_name:(n==null?void 0:n.bank_name)||"",umsatzsteuer_id:(n==null?void 0:n.umsatzsteuer_id)||"",debitor_konto:(n==null?void 0:n.debitor_konto)||""});ge.useEffect(()=>{n&&l({company_name:n.company_name,contact_person:n.contact_person,email:n.email,phone:n.phone||"",address:n.address||"",city:n.city||"",postal_code:n.postal_code||"",country:n.country||"Deutschland",status:n.status,anrede:n.anrede||"",first_name:n.first_name||"",last_name:n.last_name||"",mobile:n.mobile||"",website:n.website||"",erreichbarkeit:n.erreichbarkeit||"",sonstiges:n.sonstiges||"",festnetz:n.festnetz||"",fax:n.fax||"",zahlungsziel:n.zahlungsziel||"",skonto:n.skonto||"",skontofrist:n.skontofrist||"",verkaufspreise_gruppe:n.verkaufspreise_gruppe||"",iban:n.iban||"",bic:n.bic||"",bank_name:n.bank_name||"",umsatzsteuer_id:n.umsatzsteuer_id||"",debitor_konto:n.debitor_konto||""})},[n]);const c=h=>{if(h.preventDefault(),!n)return;if(!o.company_name||!o.contact_person||!o.email){a({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)){a({title:"Fehler",description:"Bitte geben Sie eine gültige E-Mail-Adresse ein.",variant:"destructive"});return}const p={...n,...o};s(p),e()},d=(h,m)=>{l(p=>({...p,[h]:m}))},u=()=>{n&&window.confirm(`Möchten Sie den Kunden "${n.company_name}" wirklich löschen?`)&&i.mutate(n.id,{onSuccess:()=>{a({title:"Kunde gelöscht",description:`${n.company_name} wurde erfolgreich gelöscht.`}),e()},onError:h=>{a({title:"Fehler beim Löschen",description:h.message,variant:"destructive"})}})};return n?r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-7xl h-[45vh] overflow-y-auto",children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Kunde bearbeiten"}),r.jsx(Nn,{children:"Bearbeiten Sie die Informationen für den Kunden."})]}),r.jsxs("form",{onSubmit:c,className:"space-y-4",children:[r.jsxs(cr,{defaultValue:"kontaktdetails",className:"w-full",children:[r.jsxs(tr,{className:"grid w-full grid-cols-6 h-12",children:[r.jsx(Oe,{value:"ansprechpartner",children:"ANSPRECHPARTNER"}),r.jsx(Oe,{value:"kontaktdetails",children:"KONTAKTDETAILS"}),r.jsx(Oe,{value:"adresse",children:"ADRESSE"}),r.jsx(Oe,{value:"konditionen",children:"KONDITIONEN"}),r.jsx(Oe,{value:"zahlungsdaten",children:"ZAHLUNGSDATEN"}),r.jsx(Oe,{value:"zugprd",children:"ZUGPRD 2.0 STANDARD"})]}),r.jsxs(Fe,{value:"ansprechpartner",className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"anrede",children:"Anrede"}),r.jsxs(tt,{value:o.anrede,onValueChange:h=>d("anrede",h),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Anrede wählen"})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Herr",children:"Herr"}),r.jsx(ce,{value:"Frau",children:"Frau"}),r.jsx(ce,{value:"Divers",children:"Divers"})]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"company_name",children:"Firmenname *"}),r.jsx(G,{id:"company_name",value:o.company_name,onChange:h=>d("company_name",h.target.value),required:!0})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"first_name",children:"Vorname"}),r.jsx(G,{id:"first_name",value:o.first_name,onChange:h=>d("first_name",h.target.value)})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"last_name",children:"Nachname"}),r.jsx(G,{id:"last_name",value:o.last_name,onChange:h=>d("last_name",h.target.value)})]})]})]}),r.jsxs(Fe,{value:"kontaktdetails",className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"email",children:"Emailadresse *"}),r.jsx(G,{id:"email",type:"email",value:o.email,onChange:h=>d("email",h.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"mobile",children:"Mobiltelefon"}),r.jsx(G,{id:"mobile",value:o.mobile,onChange:h=>d("mobile",h.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"erreichbarkeit",children:"Erreichbarkeit"}),r.jsx(an,{id:"erreichbarkeit",value:o.erreichbarkeit,onChange:h=>d("erreichbarkeit",h.target.value),rows:2})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"website",children:"Website"}),r.jsx(G,{id:"website",value:o.website,onChange:h=>d("website",h.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"sonstiges",children:"Sonstiges"}),r.jsxs(tt,{value:o.sonstiges,onValueChange:h=>d("sonstiges",h),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Sonstiges wählen"})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Standard",children:"Standard"}),r.jsx(ce,{value:"VIP",children:"VIP"}),r.jsx(ce,{value:"Premium",children:"Premium"})]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"festnetz",children:"Festnetz"}),r.jsx(G,{id:"festnetz",value:o.festnetz,onChange:h=>d("festnetz",h.target.value)})]})]}),r.jsx("div",{className:"grid grid-cols-2 gap-4",children:r.jsxs("div",{children:[r.jsx(H,{htmlFor:"fax",children:"Fax"}),r.jsx(G,{id:"fax",value:o.fax,onChange:h=>d("fax",h.target.value)})]})})]}),r.jsxs(Fe,{value:"adresse",className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"address",children:"Straße & Hausnummer"}),r.jsx(G,{id:"address",value:o.address,onChange:h=>d("address",h.target.value)})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"postal_code",children:"Postleitzahl"}),r.jsx(G,{id:"postal_code",value:o.postal_code,onChange:h=>d("postal_code",h.target.value)})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"city",children:"Ort"}),r.jsx(G,{id:"city",value:o.city,onChange:h=>d("city",h.target.value)})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"country",children:"Land"}),r.jsx(G,{id:"country",value:o.country,onChange:h=>d("country",h.target.value)})]})]})]}),r.jsxs(Fe,{value:"konditionen",className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"zahlungsziel",children:"Zahlungsziel (Tage)"}),r.jsx(G,{id:"zahlungsziel",value:o.zahlungsziel,onChange:h=>d("zahlungsziel",h.target.value)})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"skonto",children:"Skonto %"}),r.jsx(G,{id:"skonto",value:o.skonto,onChange:h=>d("skonto",h.target.value)})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"skontofrist",children:"Skontofrist (Tage)"}),r.jsx(G,{id:"skontofrist",value:o.skontofrist,onChange:h=>d("skontofrist",h.target.value)})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"verkaufspreise_gruppe",children:"Verkaufspreise-Gruppe"}),r.jsxs(tt,{value:o.verkaufspreise_gruppe,onValueChange:h=>d("verkaufspreise_gruppe",h),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Gruppe wählen"})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Standard-VK",children:"Standard-VK"}),r.jsx(ce,{value:"Premium-VK",children:"Premium-VK"}),r.jsx(ce,{value:"Großkunden-VK",children:"Großkunden-VK"})]})]})]})]}),r.jsxs(Fe,{value:"zahlungsdaten",className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"iban",children:"IBAN"}),r.jsx(G,{id:"iban",value:o.iban,onChange:h=>d("iban",h.target.value)})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"bic",children:"BIC"}),r.jsx(G,{id:"bic",value:o.bic,onChange:h=>d("bic",h.target.value)})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"bank_name",children:"Bank Name"}),r.jsx(G,{id:"bank_name",value:o.bank_name,onChange:h=>d("bank_name",h.target.value)})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"umsatzsteuer_id",children:"Umsatzsteuer ID"}),r.jsx(G,{id:"umsatzsteuer_id",value:o.umsatzsteuer_id,onChange:h=>d("umsatzsteuer_id",h.target.value)})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"debitor_konto",children:"Debitor / Kreditor Konto"}),r.jsx(G,{id:"debitor_konto",value:o.debitor_konto,onChange:h=>d("debitor_konto",h.target.value)})]})]})]}),r.jsx(Fe,{value:"zugprd",className:"space-y-4",children:r.jsx("div",{className:"text-muted-foreground text-sm",children:"Diese Information ist erforderlich, um Rechnungen zu ZUGFeRD 2.0 Standard zu erstellen. Dieser Standard ist verpflichtend für die Rechnungsstellung an öffentliche Behörden/Auftraggeber."})})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(W,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),r.jsxs(W,{type:"button",variant:"destructive",onClick:u,disabled:i.isPending,className:"flex items-center gap-2",children:[r.jsx(ra,{className:"h-4 w-4"}),i.isPending?"Lösche...":"Löschen"]}),r.jsx(W,{type:"submit",className:"flex-1",children:"Speichern"})]})]})]})}):null},mV=()=>{const[t,e]=f.useState(""),[n,s]=f.useState(!1),[a,i]=f.useState(!1),[o,l]=f.useState(null),{data:c,isLoading:d,error:u}=$D(void 0,t.length>=2?{search:t}:void 0),h=fW(),m=pW(),p=(c==null?void 0:c.items)||[],b=[{id:"A2024-001",customer:"Müller GmbH",project:"Büroerweiterung",amount:"€12.500",status:"In Bearbeitung",date:"15.01.2024"},{id:"A2024-002",customer:"Schmidt AG",project:"Werkshalle Elektrik",amount:"€8.750",status:"Abgeschlossen",date:"10.01.2024"},{id:"A2024-003",customer:"Weber Bau",project:"Wohnanlage Phase 2",amount:"€28.900",status:"Angebot",date:"20.01.2024"}],x=N=>{switch(N){case"Aktiv":return"bg-green-100 text-green-800";case"Premium":return"bg-blue-100 text-blue-800";case"Inaktiv":return"bg-gray-100 text-gray-800";case"In Bearbeitung":return"bg-yellow-100 text-yellow-800";case"Abgeschlossen":return"bg-green-100 text-green-800";case"Angebot":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},g=async N=>{h.mutate(N)},y=N=>{l(N),i(!0)},v=async N=>{if(!o)return;const{id:k,created_at:E,updated_at:P,...A}=N;m.mutate({id:o.id,data:A})},w=N=>{alert(`Details für ${N.company_name}:

Kontakt: ${N.contact_person}
E-Mail: ${N.email}
Status: ${N.status}`)},j=t.length>=2?p:p.filter(N=>N.company_name.toLowerCase().includes(t.toLowerCase())||N.contact_person.toLowerCase().includes(t.toLowerCase())||N.email.toLowerCase().includes(t.toLowerCase())),S=N=>[N.address,N.postal_code,N.city,N.country].filter(Boolean).join(", ");return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Kunden & Aufträge"}),r.jsxs(W,{onClick:()=>s(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Neuer Kunde"]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Aktive Kunden"}),r.jsx("p",{className:"text-2xl font-bold",children:p.filter(N=>N.status==="Aktiv").length})]}),r.jsx(Oa,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Premium Kunden"}),r.jsx("p",{className:"text-2xl font-bold",children:p.filter(N=>N.status==="Premium").length})]}),r.jsx(th,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Neue diesen Monat"}),r.jsx("p",{className:"text-2xl font-bold",children:"0"})]}),r.jsx(Bi,{className:"h-8 w-8 text-purple-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Gesamt Umsatz"}),r.jsx("p",{className:"text-2xl font-bold",children:"€0"})]}),r.jsx(Fr,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})})]}),r.jsxs(cr,{defaultValue:"customers",className:"space-y-6",children:[r.jsxs(tr,{className:"grid w-full grid-cols-3",children:[r.jsx(Oe,{value:"customers",children:"Kundenstamm"}),r.jsx(Oe,{value:"orders",children:"Aufträge"}),r.jsx(Oe,{value:"offers",children:"Angebote"})]}),r.jsxs(Fe,{value:"customers",className:"space-y-4",children:[r.jsx(J,{className:"shadow-soft rounded-2xl overflow-hidden",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx(Mc,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),r.jsx(G,{placeholder:"Kunde suchen...",value:t,onChange:N=>e(N.target.value),className:"pl-10 rounded-xl"})]}),r.jsx(W,{variant:"outline",className:"rounded-xl",children:"Filter"})]})})}),d?r.jsx("div",{className:"grid gap-4",children:Array(3).fill(0).map((N,k)=>r.jsx(J,{children:r.jsx(te,{className:"p-6",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(Ke,{className:"h-5 w-32"}),r.jsx(Ke,{className:"h-6 w-16"})]}),r.jsx(Ke,{className:"h-4 w-24 mb-3"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx(Ke,{className:"h-4 w-28"}),r.jsx(Ke,{className:"h-4 w-36"}),r.jsx(Ke,{className:"h-4 w-40"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Ke,{className:"h-8 w-20"}),r.jsx(Ke,{className:"h-8 w-24"})]})]})})},k))}):u?r.jsx(J,{children:r.jsx(te,{className:"p-6 text-center",children:r.jsxs("p",{className:"text-red-500",children:["Fehler beim Laden der Kunden: ",u.message]})})}):r.jsx("div",{className:"grid gap-4",children:j.length===0?r.jsx(J,{children:r.jsx(te,{className:"p-6 text-center",children:r.jsx("p",{className:"text-gray-500",children:t?"Keine Kunden gefunden.":"Noch keine Kunden vorhanden."})})}):j.map(N=>r.jsx(J,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h3",{className:"text-base font-semibold",children:N.company_name}),r.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${x(N.status)}`,children:N.status})]}),r.jsx("p",{className:"text-gray-600 mb-3",children:N.contact_person}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Rc,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{children:N.phone||"Nicht angegeben"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Tn,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{children:N.email})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(la,{className:"h-4 w-4 text-gray-400"}),r.jsx("span",{children:S(N)||"Nicht angegeben"})]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"0"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Projekte"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-green-600",children:"€0"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Umsatz"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(W,{size:"sm",variant:"outline",className:"rounded-xl",onClick:k=>{k.preventDefault(),k.stopPropagation(),w(N)},children:"Details"}),r.jsx(W,{size:"sm",className:"rounded-xl",onClick:()=>y(N),children:"Bearbeiten"})]})]})]})})},N.id))})]}),r.jsx(Fe,{value:"orders",className:"space-y-6",children:r.jsx("div",{className:"grid gap-4",children:b.map(N=>r.jsx(J,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h3",{className:"text-base font-semibold",children:N.id}),r.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${x(N.status)}`,children:N.status})]}),r.jsx("p",{className:"text-gray-600 mb-1",children:N.customer}),r.jsx("p",{className:"text-sm text-gray-500",children:N.project})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-xl font-bold text-green-600",children:N.amount}),r.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[r.jsx(gt,{className:"h-4 w-4"}),N.date]}),r.jsx("div",{className:"flex gap-2 mt-2",children:r.jsxs(W,{size:"sm",variant:"outline",className:"rounded-xl",children:[r.jsx(mn,{className:"h-4 w-4 mr-1"}),"Details"]})})]})]})})},N.id))})}),r.jsx(Fe,{value:"offers",className:"space-y-4",children:r.jsxs(J,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsxs(pe,{className:"pb-2",children:[r.jsx(xe,{children:"Angebote erstellen"}),r.jsx(Jn,{children:"Neue Angebote für Ihre Kunden erstellen"})]}),r.jsxs(te,{children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"customer",children:"Kunde auswählen"}),r.jsx(G,{id:"customer",placeholder:"Kunde eingeben oder auswählen"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"project",children:"Projekt"}),r.jsx(G,{id:"project",placeholder:"Projektbezeichnung"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"amount",children:"Angebotssumme"}),r.jsx(G,{id:"amount",placeholder:"€ 0,00"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"deadline",children:"Gültig bis"}),r.jsx(G,{id:"deadline",type:"date"})]})]}),r.jsxs("div",{className:"flex gap-2 mt-6",children:[r.jsxs(W,{className:"rounded-xl",children:[r.jsx(mn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),r.jsx(W,{variant:"outline",className:"rounded-xl",children:"Vorlage laden"})]})]})]})})]}),r.jsx(uV,{isOpen:n,onClose:()=>s(!1),onCustomerAdded:g}),r.jsx(hV,{isOpen:a,onClose:()=>i(!1),customer:o,onCustomerUpdated:v})]})};var Vw="Checkbox",[fV,Oee]=Zr(Vw),[pV,xV]=fV(Vw),aT=f.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:s,checked:a,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:d,form:u,...h}=t,[m,p]=f.useState(null),b=yt(e,j=>p(j)),x=f.useRef(!1),g=m?u||!!m.closest("form"):!0,[y=!1,v]=os({prop:a,defaultProp:i,onChange:d}),w=f.useRef(y);return f.useEffect(()=>{const j=m==null?void 0:m.form;if(j){const S=()=>v(w.current);return j.addEventListener("reset",S),()=>j.removeEventListener("reset",S)}},[m,v]),r.jsxs(pV,{scope:n,state:y,disabled:l,children:[r.jsx(Le.button,{type:"button",role:"checkbox","aria-checked":Mi(y)?"mixed":y,"aria-required":o,"data-state":lT(y),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:b,onKeyDown:be(t.onKeyDown,j=>{j.key==="Enter"&&j.preventDefault()}),onClick:be(t.onClick,j=>{v(S=>Mi(S)?!0:!S),g&&(x.current=j.isPropagationStopped(),x.current||j.stopPropagation())})}),g&&r.jsx(gV,{control:m,bubbles:!x.current,name:s,value:c,checked:y,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"},defaultChecked:Mi(i)?!1:i})]})});aT.displayName=Vw;var iT="CheckboxIndicator",oT=f.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:s,...a}=t,i=xV(iT,n);return r.jsx(Sn,{present:s||Mi(i.state)||i.state===!0,children:r.jsx(Le.span,{"data-state":lT(i.state),"data-disabled":i.disabled?"":void 0,...a,ref:e,style:{pointerEvents:"none",...t.style}})})});oT.displayName=iT;var gV=t=>{const{control:e,checked:n,bubbles:s=!0,defaultChecked:a,...i}=t,o=f.useRef(null),l=wP(n),c=dE(e);f.useEffect(()=>{const u=o.current,h=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==n&&p){const b=new Event("click",{bubbles:s});u.indeterminate=Mi(n),p.call(u,Mi(n)?!1:n),u.dispatchEvent(b)}},[l,n,s]);const d=f.useRef(Mi(n)?!1:n);return r.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??d.current,...i,tabIndex:-1,ref:o,style:{...t.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Mi(t){return t==="indeterminate"}function lT(t){return Mi(t)?"indeterminate":t?"checked":"unchecked"}var cT=aT,vV=oT;const aa=f.forwardRef(({className:t,...e},n)=>r.jsx(cT,{ref:n,className:_e("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:r.jsx(vV,{className:_e("flex items-center justify-center text-current"),children:r.jsx(Xu,{className:"h-4 w-4"})})}));aa.displayName=cT.displayName;var Kw="Popover",[dT,Fee]=Zr(Kw,[Qi]),ph=Qi(),[yV,no]=dT(Kw),uT=t=>{const{__scopePopover:e,children:n,open:s,defaultOpen:a,onOpenChange:i,modal:o=!1}=t,l=ph(e),c=f.useRef(null),[d,u]=f.useState(!1),[h=!1,m]=os({prop:s,defaultProp:a,onChange:i});return r.jsx(zb,{...l,children:r.jsx(yV,{scope:e,contentId:Lr(),triggerRef:c,open:h,onOpenChange:m,onOpenToggle:f.useCallback(()=>m(p=>!p),[m]),hasCustomAnchor:d,onCustomAnchorAdd:f.useCallback(()=>u(!0),[]),onCustomAnchorRemove:f.useCallback(()=>u(!1),[]),modal:o,children:n})})};uT.displayName=Kw;var hT="PopoverAnchor",bV=f.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,a=no(hT,n),i=ph(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=a;return f.useEffect(()=>(o(),()=>l()),[o,l]),r.jsx(rh,{...i,...s,ref:e})});bV.displayName=hT;var mT="PopoverTrigger",fT=f.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,a=no(mT,n),i=ph(n),o=yt(e,a.triggerRef),l=r.jsx(Le.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":yT(a.open),...s,ref:o,onClick:be(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:r.jsx(rh,{asChild:!0,...i,children:l})});fT.displayName=mT;var Gw="PopoverPortal",[wV,jV]=dT(Gw,{forceMount:void 0}),pT=t=>{const{__scopePopover:e,forceMount:n,children:s,container:a}=t,i=no(Gw,e);return r.jsx(wV,{scope:e,forceMount:n,children:r.jsx(Sn,{present:n||i.open,children:r.jsx(Tc,{asChild:!0,container:a,children:s})})})};pT.displayName=Gw;var Nc="PopoverContent",xT=f.forwardRef((t,e)=>{const n=jV(Nc,t.__scopePopover),{forceMount:s=n.forceMount,...a}=t,i=no(Nc,t.__scopePopover);return r.jsx(Sn,{present:s||i.open,children:i.modal?r.jsx(_V,{...a,ref:e}):r.jsx(NV,{...a,ref:e})})});xT.displayName=Nc;var _V=f.forwardRef((t,e)=>{const n=no(Nc,t.__scopePopover),s=f.useRef(null),a=yt(e,s),i=f.useRef(!1);return f.useEffect(()=>{const o=s.current;if(o)return sp(o)},[]),r.jsx(mh,{as:Ia,allowPinchZoom:!0,children:r.jsx(gT,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:be(t.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=n.triggerRef.current)==null||l.focus()}),onPointerDownOutside:be(t.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;i.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:be(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),NV=f.forwardRef((t,e)=>{const n=no(Nc,t.__scopePopover),s=f.useRef(!1),a=f.useRef(!1);return r.jsx(gT,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(s.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:i=>{var c,d;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((d=n.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),gT=f.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u,...h}=t,m=no(Nc,n),p=ph(n);return np(),r.jsx(hh,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:i,children:r.jsx(Go,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>m.onOpenChange(!1),children:r.jsx(D0,{"data-state":yT(m.open),role:"dialog",id:m.contentId,...p,...h,ref:e,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),vT="PopoverClose",SV=f.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,a=no(vT,n);return r.jsx(Le.button,{type:"button",...s,ref:e,onClick:be(t.onClick,()=>a.onOpenChange(!1))})});SV.displayName=vT;var kV="PopoverArrow",CV=f.forwardRef((t,e)=>{const{__scopePopover:n,...s}=t,a=ph(n);return r.jsx(P0,{...a,...s,ref:e})});CV.displayName=kV;function yT(t){return t?"open":"closed"}var EV=uT,AV=fT,DV=pT,bT=xT;const ia=EV,oa=AV,ks=f.forwardRef(({className:t,align:e="center",sideOffset:n=4,...s},a)=>r.jsx(DV,{children:r.jsx(bT,{ref:a,align:e,sideOffset:n,className:_e("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}));ks.displayName=bT.displayName;function Nt(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function Hr(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function zn(t,e){const n=Nt(t);return isNaN(e)?Hr(t,NaN):(e&&n.setDate(n.getDate()+e),n)}function Vr(t,e){const n=Nt(t);if(isNaN(e))return Hr(t,NaN);if(!e)return n;const s=n.getDate(),a=Hr(t,n.getTime());a.setMonth(n.getMonth()+e+1,0);const i=a.getDate();return s>=i?a:(n.setFullYear(a.getFullYear(),a.getMonth(),s),n)}const Zw=6048e5,PV=864e5,Qw=6e4,wT=36e5;let TV={};function xh(){return TV}function Is(t,e){var l,c,d,u;const n=xh(),s=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((u=(d=n.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,a=Nt(t),i=a.getDay(),o=(i<s?7:0)+i-s;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Wo(t){return Is(t,{weekStartsOn:1})}function jT(t){const e=Nt(t),n=e.getFullYear(),s=Hr(t,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const a=Wo(s),i=Hr(t,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const o=Wo(i);return e.getTime()>=a.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function Sc(t){const e=Nt(t);return e.setHours(0,0,0,0),e}function Yf(t){const e=Nt(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function Xs(t,e){const n=Sc(t),s=Sc(e),a=+n-Yf(n),i=+s-Yf(s);return Math.round((a-i)/PV)}function RV(t){const e=jT(t),n=Hr(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),Wo(n)}function Iu(t,e){const n=e*7;return zn(t,n)}function MV(t,e){return Vr(t,e*12)}function IV(t){let e;return t.forEach(function(n){const s=Nt(n);(e===void 0||e<s||isNaN(Number(s)))&&(e=s)}),e||new Date(NaN)}function OV(t){let e;return t.forEach(n=>{const s=Nt(n);(!e||e>s||isNaN(+s))&&(e=s)}),e||new Date(NaN)}function Un(t,e){const n=Sc(t),s=Sc(e);return+n==+s}function Yw(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function FV(t){if(!Yw(t)&&typeof t!="number")return!1;const e=Nt(t);return!isNaN(Number(e))}function Ou(t,e){const n=Nt(t),s=Nt(e),a=n.getFullYear()-s.getFullYear(),i=n.getMonth()-s.getMonth();return a*12+i}function BV(t,e,n){const s=Is(t,n),a=Is(e,n),i=+s-Yf(s),o=+a-Yf(a);return Math.round((i-o)/Zw)}function LV(t){return e=>{const s=(t?Math[t]:Math.trunc)(e);return s===0?0:s}}function $V(t,e){return+Nt(t)-+Nt(e)}function g2(t,e,n){const s=$V(t,e)/Qw;return LV(n==null?void 0:n.roundingMethod)(s)}function lp(t){const e=Nt(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function zV(t,e){const n=Nt(t.start),s=Nt(t.end);let a=+n>+s;const i=a?+n:+s,o=a?s:n;o.setHours(0,0,0,0);let l=1;const c=[];for(;+o<=i;)c.push(Nt(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return a?c.reverse():c}function lr(t){const e=Nt(t);return e.setDate(1),e.setHours(0,0,0,0),e}function _T(t){const e=Nt(t),n=Hr(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function cp(t,e){var l,c,d,u;const n=xh(),s=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((u=(d=n.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,a=Nt(t),i=a.getDay(),o=(i<s?-7:0)+6-(i-s);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}function NT(t){return cp(t,{weekStartsOn:1})}const UV={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},qV=(t,e,n)=>{let s;const a=UV[t];return typeof a=="string"?s=a:e===1?s=a.one:s=a.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function Yl(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const WV={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},HV={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},VV={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},KV={date:Yl({formats:WV,defaultWidth:"full"}),time:Yl({formats:HV,defaultWidth:"full"}),dateTime:Yl({formats:VV,defaultWidth:"full"})},GV={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ZV=(t,e,n,s)=>GV[t];function Qs(t){return(e,n)=>{const s=n!=null&&n.context?String(n.context):"standalone";let a;if(s==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=n!=null&&n.width?String(n.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=n!=null&&n.width?String(n.width):t.defaultWidth;a=t.values[l]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return a[i]}}const QV={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},YV={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},JV={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},XV={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},eK={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},tK={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},nK=(t,e)=>{const n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},rK={ordinalNumber:nK,era:Qs({values:QV,defaultWidth:"wide"}),quarter:Qs({values:YV,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Qs({values:JV,defaultWidth:"wide"}),day:Qs({values:XV,defaultWidth:"wide"}),dayPeriod:Qs({values:eK,defaultWidth:"wide",formattingValues:tK,defaultFormattingWidth:"wide"})};function Ys(t){return(e,n={})=>{const s=n.width,a=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],i=e.match(a);if(!i)return null;const o=i[0],l=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?aK(l,h=>h.test(o)):sK(l,h=>h.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=n.valueCallback?n.valueCallback(d):d;const u=e.slice(o.length);return{value:d,rest:u}}}function sK(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function aK(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function ST(t){return(e,n={})=>{const s=e.match(t.matchPattern);if(!s)return null;const a=s[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const l=e.slice(a.length);return{value:o,rest:l}}}const iK=/^(\d+)(th|st|nd|rd)?/i,oK=/\d+/i,lK={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},cK={any:[/^b/i,/^(a|c)/i]},dK={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},uK={any:[/1/i,/2/i,/3/i,/4/i]},hK={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},mK={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},fK={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},pK={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},xK={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},gK={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},vK={ordinalNumber:ST({matchPattern:iK,parsePattern:oK,valueCallback:t=>parseInt(t,10)}),era:Ys({matchPatterns:lK,defaultMatchWidth:"wide",parsePatterns:cK,defaultParseWidth:"any"}),quarter:Ys({matchPatterns:dK,defaultMatchWidth:"wide",parsePatterns:uK,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ys({matchPatterns:hK,defaultMatchWidth:"wide",parsePatterns:mK,defaultParseWidth:"any"}),day:Ys({matchPatterns:fK,defaultMatchWidth:"wide",parsePatterns:pK,defaultParseWidth:"any"}),dayPeriod:Ys({matchPatterns:xK,defaultMatchWidth:"any",parsePatterns:gK,defaultParseWidth:"any"})},kT={code:"en-US",formatDistance:qV,formatLong:KV,formatRelative:ZV,localize:rK,match:vK,options:{weekStartsOn:0,firstWeekContainsDate:1}};function yK(t){const e=Nt(t);return Xs(e,_T(e))+1}function CT(t){const e=Nt(t),n=+Wo(e)-+RV(e);return Math.round(n/Zw)+1}function ET(t,e){var u,h,m,p;const n=Nt(t),s=n.getFullYear(),a=xh(),i=(e==null?void 0:e.firstWeekContainsDate)??((h=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((p=(m=a.locale)==null?void 0:m.options)==null?void 0:p.firstWeekContainsDate)??1,o=Hr(t,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const l=Is(o,e),c=Hr(t,0);c.setFullYear(s,0,i),c.setHours(0,0,0,0);const d=Is(c,e);return n.getTime()>=l.getTime()?s+1:n.getTime()>=d.getTime()?s:s-1}function bK(t,e){var l,c,d,u;const n=xh(),s=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(d=n.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,a=ET(t,e),i=Hr(t,0);return i.setFullYear(a,0,s),i.setHours(0,0,0,0),Is(i,e)}function AT(t,e){const n=Nt(t),s=+Is(n,e)-+bK(n,e);return Math.round(s/Zw)+1}function qt(t,e){const n=t<0?"-":"",s=Math.abs(t).toString().padStart(e,"0");return n+s}const Qa={y(t,e){const n=t.getFullYear(),s=n>0?n:1-n;return qt(e==="yy"?s%100:s,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):qt(n+1,2)},d(t,e){return qt(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return qt(t.getHours()%12||12,e.length)},H(t,e){return qt(t.getHours(),e.length)},m(t,e){return qt(t.getMinutes(),e.length)},s(t,e){return qt(t.getSeconds(),e.length)},S(t,e){const n=e.length,s=t.getMilliseconds(),a=Math.trunc(s*Math.pow(10,n-3));return qt(a,e.length)}},pl={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},v2={G:function(t,e,n){const s=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const s=t.getFullYear(),a=s>0?s:1-s;return n.ordinalNumber(a,{unit:"year"})}return Qa.y(t,e)},Y:function(t,e,n,s){const a=ET(t,s),i=a>0?a:1-a;if(e==="YY"){const o=i%100;return qt(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):qt(i,e.length)},R:function(t,e){const n=jT(t);return qt(n,e.length)},u:function(t,e){const n=t.getFullYear();return qt(n,e.length)},Q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return qt(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return qt(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,e,n){const s=t.getMonth();switch(e){case"M":case"MM":return Qa.M(t,e);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,e,n){const s=t.getMonth();switch(e){case"L":return String(s+1);case"LL":return qt(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,e,n,s){const a=AT(t,s);return e==="wo"?n.ordinalNumber(a,{unit:"week"}):qt(a,e.length)},I:function(t,e,n){const s=CT(t);return e==="Io"?n.ordinalNumber(s,{unit:"week"}):qt(s,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):Qa.d(t,e)},D:function(t,e,n){const s=yK(t);return e==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):qt(s,e.length)},E:function(t,e,n){const s=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,e,n,s){const a=t.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return qt(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,n,s){const a=t.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return qt(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,n){const s=t.getDay(),a=s===0?7:s;switch(e){case"i":return String(a);case"ii":return qt(a,e.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,e,n){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,n){const s=t.getHours();let a;switch(s===12?a=pl.noon:s===0?a=pl.midnight:a=s/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,n){const s=t.getHours();let a;switch(s>=17?a=pl.evening:s>=12?a=pl.afternoon:s>=4?a=pl.morning:a=pl.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let s=t.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return Qa.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):Qa.H(t,e)},K:function(t,e,n){const s=t.getHours()%12;return e==="Ko"?n.ordinalNumber(s,{unit:"hour"}):qt(s,e.length)},k:function(t,e,n){let s=t.getHours();return s===0&&(s=24),e==="ko"?n.ordinalNumber(s,{unit:"hour"}):qt(s,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):Qa.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):Qa.s(t,e)},S:function(t,e){return Qa.S(t,e)},X:function(t,e,n){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return b2(s);case"XXXX":case"XX":return co(s);case"XXXXX":case"XXX":default:return co(s,":")}},x:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"x":return b2(s);case"xxxx":case"xx":return co(s);case"xxxxx":case"xxx":default:return co(s,":")}},O:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+y2(s,":");case"OOOO":default:return"GMT"+co(s,":")}},z:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+y2(s,":");case"zzzz":default:return"GMT"+co(s,":")}},t:function(t,e,n){const s=Math.trunc(t.getTime()/1e3);return qt(s,e.length)},T:function(t,e,n){const s=t.getTime();return qt(s,e.length)}};function y2(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),a=Math.trunc(s/60),i=s%60;return i===0?n+String(a):n+String(a)+e+qt(i,2)}function b2(t,e){return t%60===0?(t>0?"-":"+")+qt(Math.abs(t)/60,2):co(t,e)}function co(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),a=qt(Math.trunc(s/60),2),i=qt(s%60,2);return n+a+e+i}const w2=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},DT=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},wK=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],s=n[1],a=n[2];if(!a)return w2(t,e);let i;switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",w2(s,e)).replace("{{time}}",DT(a,e))},jK={p:DT,P:wK},_K=/^D+$/,NK=/^Y+$/,SK=["D","DD","YY","YYYY"];function kK(t){return _K.test(t)}function CK(t){return NK.test(t)}function EK(t,e,n){const s=AK(t,e,n);if(console.warn(s),SK.includes(t))throw new RangeError(s)}function AK(t,e,n){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const DK=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,PK=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,TK=/^'([^]*?)'?$/,RK=/''/g,MK=/[a-zA-Z]/;function Pe(t,e,n){var u,h,m,p,b,x,g,y;const s=xh(),a=(n==null?void 0:n.locale)??s.locale??kT,i=(n==null?void 0:n.firstWeekContainsDate)??((h=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((p=(m=s.locale)==null?void 0:m.options)==null?void 0:p.firstWeekContainsDate)??1,o=(n==null?void 0:n.weekStartsOn)??((x=(b=n==null?void 0:n.locale)==null?void 0:b.options)==null?void 0:x.weekStartsOn)??s.weekStartsOn??((y=(g=s.locale)==null?void 0:g.options)==null?void 0:y.weekStartsOn)??0,l=Nt(t);if(!FV(l))throw new RangeError("Invalid time value");let c=e.match(PK).map(v=>{const w=v[0];if(w==="p"||w==="P"){const j=jK[w];return j(v,a.formatLong)}return v}).join("").match(DK).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const w=v[0];if(w==="'")return{isToken:!1,value:IK(v)};if(v2[w])return{isToken:!0,value:v};if(w.match(MK))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:v}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return c.map(v=>{if(!v.isToken)return v.value;const w=v.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&CK(w)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&kK(w))&&EK(w,e,String(t));const j=v2[w[0]];return j(l,w,a.localize,d)}).join("")}function IK(t){const e=t.match(TK);return e?e[1].replace(RK,"'"):t}function OK(t){const e=Nt(t),n=e.getFullYear(),s=e.getMonth(),a=Hr(t,0);return a.setFullYear(n,s+1,0),a.setHours(0,0,0,0),a.getDate()}function FK(t){return Math.trunc(+Nt(t)/1e3)}function BK(t){const e=Nt(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(0,0,0,0),e}function LK(t,e){return BV(BK(t),lr(t),e)+1}function Sy(t,e){const n=Nt(t),s=Nt(e);return n.getTime()>s.getTime()}function PT(t,e){const n=Nt(t),s=Nt(e);return+n<+s}function Jw(t,e){const n=Nt(t),s=Nt(e);return n.getFullYear()===s.getFullYear()&&n.getMonth()===s.getMonth()}function $K(t,e){const n=Nt(t),s=Nt(e);return n.getFullYear()===s.getFullYear()}function og(t,e){return zn(t,-e)}function Bl(t,e){const s=WK(t);let a;if(s.date){const c=HK(s.date,2);a=VK(c.restDateString,c.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let o=0,l;if(s.time&&(o=KK(s.time),isNaN(o)))return new Date(NaN);if(s.timezone){if(l=GK(s.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(i+o),d=new Date(0);return d.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),d.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),d}return new Date(i+o+l)}const mm={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},zK=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,UK=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,qK=/^([+-])(\d{2})(?::?(\d{2}))?$/;function WK(t){const e={},n=t.split(mm.dateTimeDelimiter);let s;if(n.length>2)return e;if(/:/.test(n[0])?s=n[0]:(e.date=n[0],s=n[1],mm.timeZoneDelimiter.test(e.date)&&(e.date=t.split(mm.timeZoneDelimiter)[0],s=t.substr(e.date.length,t.length))),s){const a=mm.timezone.exec(s);a?(e.time=s.replace(a[1],""),e.timezone=a[1]):e.time=s}return e}function HK(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),s=t.match(n);if(!s)return{year:NaN,restDateString:""};const a=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?a:i*100,restDateString:t.slice((s[1]||s[2]).length)}}function VK(t,e){if(e===null)return new Date(NaN);const n=t.match(zK);if(!n)return new Date(NaN);const s=!!n[4],a=ld(n[1]),i=ld(n[2])-1,o=ld(n[3]),l=ld(n[4]),c=ld(n[5])-1;if(s)return XK(e,l,c)?ZK(e,l,c):new Date(NaN);{const d=new Date(0);return!YK(e,i,o)||!JK(e,a)?new Date(NaN):(d.setUTCFullYear(e,i,Math.max(a,o)),d)}}function ld(t){return t?parseInt(t):1}function KK(t){const e=t.match(UK);if(!e)return NaN;const n=lg(e[1]),s=lg(e[2]),a=lg(e[3]);return eG(n,s,a)?n*wT+s*Qw+a*1e3:NaN}function lg(t){return t&&parseFloat(t.replace(",","."))||0}function GK(t){if(t==="Z")return 0;const e=t.match(qK);if(!e)return 0;const n=e[1]==="+"?-1:1,s=parseInt(e[2]),a=e[3]&&parseInt(e[3])||0;return tG(s,a)?n*(s*wT+a*Qw):NaN}function ZK(t,e,n){const s=new Date(0);s.setUTCFullYear(t,0,4);const a=s.getUTCDay()||7,i=(e-1)*7+n+1-a;return s.setUTCDate(s.getUTCDate()+i),s}const QK=[31,null,31,30,31,30,31,31,30,31,30,31];function TT(t){return t%400===0||t%4===0&&t%100!==0}function YK(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(QK[e]||(TT(t)?29:28))}function JK(t,e){return e>=1&&e<=(TT(t)?366:365)}function XK(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function eG(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function tG(t,e){return e>=0&&e<=59}function cg(t,e){const n=Nt(t),s=n.getFullYear(),a=n.getDate(),i=Hr(t,0);i.setFullYear(s,e,15),i.setHours(0,0,0,0);const o=OK(i);return n.setMonth(e,Math.min(a,o)),n}function j2(t,e){const n=Nt(t);return isNaN(+n)?Hr(t,NaN):(n.setFullYear(e),n)}function nG(t,e){return Vr(t,-e)}function rG(t,e){return Iu(t,-e)}const _2={lessThanXSeconds:{standalone:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"},withPreposition:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"}},xSeconds:{standalone:{one:"1 Sekunde",other:"{{count}} Sekunden"},withPreposition:{one:"1 Sekunde",other:"{{count}} Sekunden"}},halfAMinute:{standalone:"eine halbe Minute",withPreposition:"einer halben Minute"},lessThanXMinutes:{standalone:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"},withPreposition:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"}},xMinutes:{standalone:{one:"1 Minute",other:"{{count}} Minuten"},withPreposition:{one:"1 Minute",other:"{{count}} Minuten"}},aboutXHours:{standalone:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"},withPreposition:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"}},xHours:{standalone:{one:"1 Stunde",other:"{{count}} Stunden"},withPreposition:{one:"1 Stunde",other:"{{count}} Stunden"}},xDays:{standalone:{one:"1 Tag",other:"{{count}} Tage"},withPreposition:{one:"1 Tag",other:"{{count}} Tagen"}},aboutXWeeks:{standalone:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"},withPreposition:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"}},xWeeks:{standalone:{one:"1 Woche",other:"{{count}} Wochen"},withPreposition:{one:"1 Woche",other:"{{count}} Wochen"}},aboutXMonths:{standalone:{one:"etwa 1 Monat",other:"etwa {{count}} Monate"},withPreposition:{one:"etwa 1 Monat",other:"etwa {{count}} Monaten"}},xMonths:{standalone:{one:"1 Monat",other:"{{count}} Monate"},withPreposition:{one:"1 Monat",other:"{{count}} Monaten"}},aboutXYears:{standalone:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahre"},withPreposition:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahren"}},xYears:{standalone:{one:"1 Jahr",other:"{{count}} Jahre"},withPreposition:{one:"1 Jahr",other:"{{count}} Jahren"}},overXYears:{standalone:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahre"},withPreposition:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahren"}},almostXYears:{standalone:{one:"fast 1 Jahr",other:"fast {{count}} Jahre"},withPreposition:{one:"fast 1 Jahr",other:"fast {{count}} Jahren"}}},sG=(t,e,n)=>{let s;const a=n!=null&&n.addSuffix?_2[t].withPreposition:_2[t].standalone;return typeof a=="string"?s=a:e===1?s=a.one:s=a.other.replace("{{count}}",String(e)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+s:"vor "+s:s},aG={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},iG={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},oG={full:"{{date}} 'um' {{time}}",long:"{{date}} 'um' {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},lG={date:Yl({formats:aG,defaultWidth:"full"}),time:Yl({formats:iG,defaultWidth:"full"}),dateTime:Yl({formats:oG,defaultWidth:"full"})},cG={lastWeek:"'letzten' eeee 'um' p",yesterday:"'gestern um' p",today:"'heute um' p",tomorrow:"'morgen um' p",nextWeek:"eeee 'um' p",other:"P"},dG=(t,e,n,s)=>cG[t],uG={narrow:["v.Chr.","n.Chr."],abbreviated:["v.Chr.","n.Chr."],wide:["vor Christus","nach Christus"]},hG={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1. Quartal","2. Quartal","3. Quartal","4. Quartal"]},ky={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],wide:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},mG={narrow:ky.narrow,abbreviated:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sep.","Okt.","Nov.","Dez."],wide:ky.wide},fG={narrow:["S","M","D","M","D","F","S"],short:["So","Mo","Di","Mi","Do","Fr","Sa"],abbreviated:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],wide:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},pG={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachm.",evening:"Abend",night:"Nacht"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"}},xG={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachm.",evening:"abends",night:"nachts"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"}},gG=t=>Number(t)+".",vG={ordinalNumber:gG,era:Qs({values:uG,defaultWidth:"wide"}),quarter:Qs({values:hG,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Qs({values:ky,formattingValues:mG,defaultWidth:"wide"}),day:Qs({values:fG,defaultWidth:"wide"}),dayPeriod:Qs({values:pG,defaultWidth:"wide",formattingValues:xG,defaultFormattingWidth:"wide"})},yG=/^(\d+)(\.)?/i,bG=/\d+/i,wG={narrow:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,abbreviated:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,wide:/^(vor Christus|vor unserer Zeitrechnung|nach Christus|unserer Zeitrechnung)/i},jG={any:[/^v/i,/^n/i]},_G={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](\.)? Quartal/i},NG={any:[/1/i,/2/i,/3/i,/4/i]},SG={narrow:/^[jfmasond]/i,abbreviated:/^(j[aä]n|feb|mär[z]?|apr|mai|jun[i]?|jul[i]?|aug|sep|okt|nov|dez)\.?/i,wide:/^(januar|februar|märz|april|mai|juni|juli|august|september|oktober|november|dezember)/i},kG={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^j[aä]/i,/^f/i,/^mär/i,/^ap/i,/^mai/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},CG={narrow:/^[smdmf]/i,short:/^(so|mo|di|mi|do|fr|sa)/i,abbreviated:/^(son?|mon?|die?|mit?|don?|fre?|sam?)\.?/i,wide:/^(sonntag|montag|dienstag|mittwoch|donnerstag|freitag|samstag)/i},EG={any:[/^so/i,/^mo/i,/^di/i,/^mi/i,/^do/i,/^f/i,/^sa/i]},AG={narrow:/^(vm\.?|nm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,abbreviated:/^(vorm\.?|nachm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,wide:/^(vormittags|nachmittags|Mitternacht|Mittag|morgens|nachmittags|abends|nachts)/i},DG={any:{am:/^v/i,pm:/^n/i,midnight:/^Mitte/i,noon:/^Mitta/i,morning:/morgens/i,afternoon:/nachmittags/i,evening:/abends/i,night:/nachts/i}},PG={ordinalNumber:ST({matchPattern:yG,parsePattern:bG,valueCallback:t=>parseInt(t)}),era:Ys({matchPatterns:wG,defaultMatchWidth:"wide",parsePatterns:jG,defaultParseWidth:"any"}),quarter:Ys({matchPatterns:_G,defaultMatchWidth:"wide",parsePatterns:NG,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ys({matchPatterns:SG,defaultMatchWidth:"wide",parsePatterns:kG,defaultParseWidth:"any"}),day:Ys({matchPatterns:CG,defaultMatchWidth:"wide",parsePatterns:EG,defaultParseWidth:"any"}),dayPeriod:Ys({matchPatterns:AG,defaultMatchWidth:"wide",parsePatterns:DG,defaultParseWidth:"any"})},Wt={code:"de",formatDistance:sG,formatLong:lG,formatRelative:dG,localize:vG,match:PG,options:{weekStartsOn:1,firstWeekContainsDate:4}};var lt=function(){return lt=Object.assign||function(e){for(var n,s=1,a=arguments.length;s<a;s++){n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},lt.apply(this,arguments)};function TG(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(t);a<s.length;a++)e.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(t,s[a])&&(n[s[a]]=t[s[a]]);return n}function RT(t,e,n){for(var s=0,a=e.length,i;s<a;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return t.concat(i||Array.prototype.slice.call(e))}function gh(t){return t.mode==="multiple"}function vh(t){return t.mode==="range"}function dp(t){return t.mode==="single"}var RG={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function MG(t,e){return Pe(t,"LLLL y",e)}function IG(t,e){return Pe(t,"d",e)}function OG(t,e){return Pe(t,"LLLL",e)}function FG(t){return"".concat(t)}function BG(t,e){return Pe(t,"cccccc",e)}function LG(t,e){return Pe(t,"yyyy",e)}var $G=Object.freeze({__proto__:null,formatCaption:MG,formatDay:IG,formatMonthCaption:OG,formatWeekNumber:FG,formatWeekdayName:BG,formatYearCaption:LG}),zG=function(t,e,n){return Pe(t,"do MMMM (EEEE)",n)},UG=function(){return"Month: "},qG=function(){return"Go to next month"},WG=function(){return"Go to previous month"},HG=function(t,e){return Pe(t,"cccc",e)},VG=function(t){return"Week n. ".concat(t)},KG=function(){return"Year: "},GG=Object.freeze({__proto__:null,labelDay:zG,labelMonthDropdown:UG,labelNext:qG,labelPrevious:WG,labelWeekNumber:VG,labelWeekday:HG,labelYearDropdown:KG});function ZG(){var t="buttons",e=RG,n=kT,s={},a={},i=1,o={},l=new Date;return{captionLayout:t,classNames:e,formatters:$G,labels:GG,locale:n,modifiersClassNames:s,modifiers:a,numberOfMonths:i,styles:o,today:l,mode:"default"}}function QG(t){var e=t.fromYear,n=t.toYear,s=t.fromMonth,a=t.toMonth,i=t.fromDate,o=t.toDate;return s?i=lr(s):e&&(i=new Date(e,0,1)),a?o=lp(a):n&&(o=new Date(n,11,31)),{fromDate:i?Sc(i):void 0,toDate:o?Sc(o):void 0}}var MT=f.createContext(void 0);function YG(t){var e,n=t.initialProps,s=ZG(),a=QG(n),i=a.fromDate,o=a.toDate,l=(e=n.captionLayout)!==null&&e!==void 0?e:s.captionLayout;l!=="buttons"&&(!i||!o)&&(l="buttons");var c;(dp(n)||gh(n)||vh(n))&&(c=n.onSelect);var d=lt(lt(lt({},s),n),{captionLayout:l,classNames:lt(lt({},s.classNames),n.classNames),components:lt({},n.components),formatters:lt(lt({},s.formatters),n.formatters),fromDate:i,labels:lt(lt({},s.labels),n.labels),mode:n.mode||s.mode,modifiers:lt(lt({},s.modifiers),n.modifiers),modifiersClassNames:lt(lt({},s.modifiersClassNames),n.modifiersClassNames),onSelect:c,styles:lt(lt({},s.styles),n.styles),toDate:o});return r.jsx(MT.Provider,{value:d,children:t.children})}function Qt(){var t=f.useContext(MT);if(!t)throw new Error("useDayPicker must be used within a DayPickerProvider.");return t}function IT(t){var e=Qt(),n=e.locale,s=e.classNames,a=e.styles,i=e.formatters.formatCaption;return r.jsx("div",{className:s.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:t.id,children:i(t.displayMonth,{locale:n})})}function JG(t){return r.jsx("svg",lt({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},t,{children:r.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function OT(t){var e,n,s=t.onChange,a=t.value,i=t.children,o=t.caption,l=t.className,c=t.style,d=Qt(),u=(n=(e=d.components)===null||e===void 0?void 0:e.IconDropdown)!==null&&n!==void 0?n:JG;return r.jsxs("div",{className:l,style:c,children:[r.jsx("span",{className:d.classNames.vhidden,children:t["aria-label"]}),r.jsx("select",{name:t.name,"aria-label":t["aria-label"],className:d.classNames.dropdown,style:d.styles.dropdown,value:a,onChange:s,children:i}),r.jsxs("div",{className:d.classNames.caption_label,style:d.styles.caption_label,"aria-hidden":"true",children:[o,r.jsx(u,{className:d.classNames.dropdown_icon,style:d.styles.dropdown_icon})]})]})}function XG(t){var e,n=Qt(),s=n.fromDate,a=n.toDate,i=n.styles,o=n.locale,l=n.formatters.formatMonthCaption,c=n.classNames,d=n.components,u=n.labels.labelMonthDropdown;if(!s)return r.jsx(r.Fragment,{});if(!a)return r.jsx(r.Fragment,{});var h=[];if($K(s,a))for(var m=lr(s),p=s.getMonth();p<=a.getMonth();p++)h.push(cg(m,p));else for(var m=lr(new Date),p=0;p<=11;p++)h.push(cg(m,p));var b=function(g){var y=Number(g.target.value),v=cg(lr(t.displayMonth),y);t.onChange(v)},x=(e=d==null?void 0:d.Dropdown)!==null&&e!==void 0?e:OT;return r.jsx(x,{name:"months","aria-label":u(),className:c.dropdown_month,style:i.dropdown_month,onChange:b,value:t.displayMonth.getMonth(),caption:l(t.displayMonth,{locale:o}),children:h.map(function(g){return r.jsx("option",{value:g.getMonth(),children:l(g,{locale:o})},g.getMonth())})})}function eZ(t){var e,n=t.displayMonth,s=Qt(),a=s.fromDate,i=s.toDate,o=s.locale,l=s.styles,c=s.classNames,d=s.components,u=s.formatters.formatYearCaption,h=s.labels.labelYearDropdown,m=[];if(!a)return r.jsx(r.Fragment,{});if(!i)return r.jsx(r.Fragment,{});for(var p=a.getFullYear(),b=i.getFullYear(),x=p;x<=b;x++)m.push(j2(_T(new Date),x));var g=function(v){var w=j2(lr(n),Number(v.target.value));t.onChange(w)},y=(e=d==null?void 0:d.Dropdown)!==null&&e!==void 0?e:OT;return r.jsx(y,{name:"years","aria-label":h(),className:c.dropdown_year,style:l.dropdown_year,onChange:g,value:n.getFullYear(),caption:u(n,{locale:o}),children:m.map(function(v){return r.jsx("option",{value:v.getFullYear(),children:u(v,{locale:o})},v.getFullYear())})})}function tZ(t,e){var n=f.useState(t),s=n[0],a=n[1],i=e===void 0?s:e;return[i,a]}function nZ(t){var e=t.month,n=t.defaultMonth,s=t.today,a=e||n||s||new Date,i=t.toDate,o=t.fromDate,l=t.numberOfMonths,c=l===void 0?1:l;if(i&&Ou(i,a)<0){var d=-1*(c-1);a=Vr(i,d)}return o&&Ou(a,o)<0&&(a=o),lr(a)}function rZ(){var t=Qt(),e=nZ(t),n=tZ(e,t.month),s=n[0],a=n[1],i=function(o){var l;if(!t.disableNavigation){var c=lr(o);a(c),(l=t.onMonthChange)===null||l===void 0||l.call(t,c)}};return[s,i]}function sZ(t,e){for(var n=e.reverseMonths,s=e.numberOfMonths,a=lr(t),i=lr(Vr(a,s)),o=Ou(i,a),l=[],c=0;c<o;c++){var d=Vr(a,c);l.push(d)}return n&&(l=l.reverse()),l}function aZ(t,e){if(!e.disableNavigation){var n=e.toDate,s=e.pagedNavigation,a=e.numberOfMonths,i=a===void 0?1:a,o=s?i:1,l=lr(t);if(!n)return Vr(l,o);var c=Ou(n,t);if(!(c<i))return Vr(l,o)}}function iZ(t,e){if(!e.disableNavigation){var n=e.fromDate,s=e.pagedNavigation,a=e.numberOfMonths,i=a===void 0?1:a,o=s?i:1,l=lr(t);if(!n)return Vr(l,-o);var c=Ou(l,n);if(!(c<=0))return Vr(l,-o)}}var FT=f.createContext(void 0);function oZ(t){var e=Qt(),n=rZ(),s=n[0],a=n[1],i=sZ(s,e),o=aZ(s,e),l=iZ(s,e),c=function(h){return i.some(function(m){return Jw(h,m)})},d=function(h,m){c(h)||(m&&PT(h,m)?a(Vr(h,1+e.numberOfMonths*-1)):a(h))},u={currentMonth:s,displayMonths:i,goToMonth:a,goToDate:d,previousMonth:l,nextMonth:o,isDateDisplayed:c};return r.jsx(FT.Provider,{value:u,children:t.children})}function yh(){var t=f.useContext(FT);if(!t)throw new Error("useNavigation must be used within a NavigationProvider");return t}function N2(t){var e,n=Qt(),s=n.classNames,a=n.styles,i=n.components,o=yh().goToMonth,l=function(u){o(Vr(u,t.displayIndex?-t.displayIndex:0))},c=(e=i==null?void 0:i.CaptionLabel)!==null&&e!==void 0?e:IT,d=r.jsx(c,{id:t.id,displayMonth:t.displayMonth});return r.jsxs("div",{className:s.caption_dropdowns,style:a.caption_dropdowns,children:[r.jsx("div",{className:s.vhidden,children:d}),r.jsx(XG,{onChange:l,displayMonth:t.displayMonth}),r.jsx(eZ,{onChange:l,displayMonth:t.displayMonth})]})}function lZ(t){return r.jsx("svg",lt({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:r.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function cZ(t){return r.jsx("svg",lt({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:r.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Jf=f.forwardRef(function(t,e){var n=Qt(),s=n.classNames,a=n.styles,i=[s.button_reset,s.button];t.className&&i.push(t.className);var o=i.join(" "),l=lt(lt({},a.button_reset),a.button);return t.style&&Object.assign(l,t.style),r.jsx("button",lt({},t,{ref:e,type:"button",className:o,style:l}))});function dZ(t){var e,n,s=Qt(),a=s.dir,i=s.locale,o=s.classNames,l=s.styles,c=s.labels,d=c.labelPrevious,u=c.labelNext,h=s.components;if(!t.nextMonth&&!t.previousMonth)return r.jsx(r.Fragment,{});var m=d(t.previousMonth,{locale:i}),p=[o.nav_button,o.nav_button_previous].join(" "),b=u(t.nextMonth,{locale:i}),x=[o.nav_button,o.nav_button_next].join(" "),g=(e=h==null?void 0:h.IconRight)!==null&&e!==void 0?e:cZ,y=(n=h==null?void 0:h.IconLeft)!==null&&n!==void 0?n:lZ;return r.jsxs("div",{className:o.nav,style:l.nav,children:[!t.hidePrevious&&r.jsx(Jf,{name:"previous-month","aria-label":m,className:p,style:l.nav_button_previous,disabled:!t.previousMonth,onClick:t.onPreviousClick,children:a==="rtl"?r.jsx(g,{className:o.nav_icon,style:l.nav_icon}):r.jsx(y,{className:o.nav_icon,style:l.nav_icon})}),!t.hideNext&&r.jsx(Jf,{name:"next-month","aria-label":b,className:x,style:l.nav_button_next,disabled:!t.nextMonth,onClick:t.onNextClick,children:a==="rtl"?r.jsx(y,{className:o.nav_icon,style:l.nav_icon}):r.jsx(g,{className:o.nav_icon,style:l.nav_icon})})]})}function S2(t){var e=Qt().numberOfMonths,n=yh(),s=n.previousMonth,a=n.nextMonth,i=n.goToMonth,o=n.displayMonths,l=o.findIndex(function(b){return Jw(t.displayMonth,b)}),c=l===0,d=l===o.length-1,u=e>1&&(c||!d),h=e>1&&(d||!c),m=function(){s&&i(s)},p=function(){a&&i(a)};return r.jsx(dZ,{displayMonth:t.displayMonth,hideNext:u,hidePrevious:h,nextMonth:a,previousMonth:s,onPreviousClick:m,onNextClick:p})}function uZ(t){var e,n=Qt(),s=n.classNames,a=n.disableNavigation,i=n.styles,o=n.captionLayout,l=n.components,c=(e=l==null?void 0:l.CaptionLabel)!==null&&e!==void 0?e:IT,d;return a?d=r.jsx(c,{id:t.id,displayMonth:t.displayMonth}):o==="dropdown"?d=r.jsx(N2,{displayMonth:t.displayMonth,id:t.id}):o==="dropdown-buttons"?d=r.jsxs(r.Fragment,{children:[r.jsx(N2,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id}),r.jsx(S2,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id})]}):d=r.jsxs(r.Fragment,{children:[r.jsx(c,{id:t.id,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),r.jsx(S2,{displayMonth:t.displayMonth,id:t.id})]}),r.jsx("div",{className:s.caption,style:i.caption,children:d})}function hZ(t){var e=Qt(),n=e.footer,s=e.styles,a=e.classNames.tfoot;return n?r.jsx("tfoot",{className:a,style:s.tfoot,children:r.jsx("tr",{children:r.jsx("td",{colSpan:8,children:n})})}):r.jsx(r.Fragment,{})}function mZ(t,e,n){for(var s=n?Wo(new Date):Is(new Date,{locale:t,weekStartsOn:e}),a=[],i=0;i<7;i++){var o=zn(s,i);a.push(o)}return a}function fZ(){var t=Qt(),e=t.classNames,n=t.styles,s=t.showWeekNumber,a=t.locale,i=t.weekStartsOn,o=t.ISOWeek,l=t.formatters.formatWeekdayName,c=t.labels.labelWeekday,d=mZ(a,i,o);return r.jsxs("tr",{style:n.head_row,className:e.head_row,children:[s&&r.jsx("td",{style:n.head_cell,className:e.head_cell}),d.map(function(u,h){return r.jsx("th",{scope:"col",className:e.head_cell,style:n.head_cell,"aria-label":c(u,{locale:a}),children:l(u,{locale:a})},h)})]})}function pZ(){var t,e=Qt(),n=e.classNames,s=e.styles,a=e.components,i=(t=a==null?void 0:a.HeadRow)!==null&&t!==void 0?t:fZ;return r.jsx("thead",{style:s.head,className:n.head,children:r.jsx(i,{})})}function xZ(t){var e=Qt(),n=e.locale,s=e.formatters.formatDay;return r.jsx(r.Fragment,{children:s(t.date,{locale:n})})}var Xw=f.createContext(void 0);function gZ(t){if(!gh(t.initialProps)){var e={selected:void 0,modifiers:{disabled:[]}};return r.jsx(Xw.Provider,{value:e,children:t.children})}return r.jsx(vZ,{initialProps:t.initialProps,children:t.children})}function vZ(t){var e=t.initialProps,n=t.children,s=e.selected,a=e.min,i=e.max,o=function(d,u,h){var m,p;(m=e.onDayClick)===null||m===void 0||m.call(e,d,u,h);var b=!!(u.selected&&a&&(s==null?void 0:s.length)===a);if(!b){var x=!!(!u.selected&&i&&(s==null?void 0:s.length)===i);if(!x){var g=s?RT([],s):[];if(u.selected){var y=g.findIndex(function(v){return Un(d,v)});g.splice(y,1)}else g.push(d);(p=e.onSelect)===null||p===void 0||p.call(e,g,d,u,h)}}},l={disabled:[]};s&&l.disabled.push(function(d){var u=i&&s.length>i-1,h=s.some(function(m){return Un(m,d)});return!!(u&&!h)});var c={selected:s,onDayClick:o,modifiers:l};return r.jsx(Xw.Provider,{value:c,children:n})}function ej(){var t=f.useContext(Xw);if(!t)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return t}function yZ(t,e){var n=e||{},s=n.from,a=n.to;return s&&a?Un(a,t)&&Un(s,t)?void 0:Un(a,t)?{from:a,to:void 0}:Un(s,t)?void 0:Sy(s,t)?{from:t,to:a}:{from:s,to:t}:a?Sy(t,a)?{from:a,to:t}:{from:t,to:a}:s?PT(t,s)?{from:t,to:s}:{from:s,to:t}:{from:t,to:void 0}}var tj=f.createContext(void 0);function bZ(t){if(!vh(t.initialProps)){var e={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return r.jsx(tj.Provider,{value:e,children:t.children})}return r.jsx(wZ,{initialProps:t.initialProps,children:t.children})}function wZ(t){var e=t.initialProps,n=t.children,s=e.selected,a=s||{},i=a.from,o=a.to,l=e.min,c=e.max,d=function(p,b,x){var g,y;(g=e.onDayClick)===null||g===void 0||g.call(e,p,b,x);var v=yZ(p,s);(y=e.onSelect)===null||y===void 0||y.call(e,v,p,b,x)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(u.range_start=[i],o?(u.range_end=[o],Un(i,o)||(u.range_middle=[{after:i,before:o}])):u.range_end=[i]):o&&(u.range_start=[o],u.range_end=[o]),l&&(i&&!o&&u.disabled.push({after:og(i,l-1),before:zn(i,l-1)}),i&&o&&u.disabled.push({after:i,before:zn(i,l-1)}),!i&&o&&u.disabled.push({after:og(o,l-1),before:zn(o,l-1)})),c){if(i&&!o&&(u.disabled.push({before:zn(i,-c+1)}),u.disabled.push({after:zn(i,c-1)})),i&&o){var h=Xs(o,i)+1,m=c-h;u.disabled.push({before:og(i,m)}),u.disabled.push({after:zn(o,m)})}!i&&o&&(u.disabled.push({before:zn(o,-c+1)}),u.disabled.push({after:zn(o,c-1)}))}return r.jsx(tj.Provider,{value:{selected:s,onDayClick:d,modifiers:u},children:n})}function nj(){var t=f.useContext(tj);if(!t)throw new Error("useSelectRange must be used within a SelectRangeProvider");return t}function qm(t){return Array.isArray(t)?RT([],t):t!==void 0?[t]:[]}function jZ(t){var e={};return Object.entries(t).forEach(function(n){var s=n[0],a=n[1];e[s]=qm(a)}),e}var Os;(function(t){t.Outside="outside",t.Disabled="disabled",t.Selected="selected",t.Hidden="hidden",t.Today="today",t.RangeStart="range_start",t.RangeEnd="range_end",t.RangeMiddle="range_middle"})(Os||(Os={}));var _Z=Os.Selected,va=Os.Disabled,NZ=Os.Hidden,SZ=Os.Today,dg=Os.RangeEnd,ug=Os.RangeMiddle,hg=Os.RangeStart,kZ=Os.Outside;function CZ(t,e,n){var s,a=(s={},s[_Z]=qm(t.selected),s[va]=qm(t.disabled),s[NZ]=qm(t.hidden),s[SZ]=[t.today],s[dg]=[],s[ug]=[],s[hg]=[],s[kZ]=[],s);return t.fromDate&&a[va].push({before:t.fromDate}),t.toDate&&a[va].push({after:t.toDate}),gh(t)?a[va]=a[va].concat(e.modifiers[va]):vh(t)&&(a[va]=a[va].concat(n.modifiers[va]),a[hg]=n.modifiers[hg],a[ug]=n.modifiers[ug],a[dg]=n.modifiers[dg]),a}var BT=f.createContext(void 0);function EZ(t){var e=Qt(),n=ej(),s=nj(),a=CZ(e,n,s),i=jZ(e.modifiers),o=lt(lt({},a),i);return r.jsx(BT.Provider,{value:o,children:t.children})}function LT(){var t=f.useContext(BT);if(!t)throw new Error("useModifiers must be used within a ModifiersProvider");return t}function AZ(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function DZ(t){return!!(t&&typeof t=="object"&&"from"in t)}function PZ(t){return!!(t&&typeof t=="object"&&"after"in t)}function TZ(t){return!!(t&&typeof t=="object"&&"before"in t)}function RZ(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function MZ(t,e){var n,s=e.from,a=e.to;if(s&&a){var i=Xs(a,s)<0;i&&(n=[a,s],s=n[0],a=n[1]);var o=Xs(t,s)>=0&&Xs(a,t)>=0;return o}return a?Un(a,t):s?Un(s,t):!1}function IZ(t){return Yw(t)}function OZ(t){return Array.isArray(t)&&t.every(Yw)}function FZ(t,e){return e.some(function(n){if(typeof n=="boolean")return n;if(IZ(n))return Un(t,n);if(OZ(n))return n.includes(t);if(DZ(n))return MZ(t,n);if(RZ(n))return n.dayOfWeek.includes(t.getDay());if(AZ(n)){var s=Xs(n.before,t),a=Xs(n.after,t),i=s>0,o=a<0,l=Sy(n.before,n.after);return l?o&&i:i||o}return PZ(n)?Xs(t,n.after)>0:TZ(n)?Xs(n.before,t)>0:typeof n=="function"?n(t):!1})}function rj(t,e,n){var s=Object.keys(e).reduce(function(i,o){var l=e[o];return FZ(t,l)&&i.push(o),i},[]),a={};return s.forEach(function(i){return a[i]=!0}),n&&!Jw(t,n)&&(a.outside=!0),a}function BZ(t,e){for(var n=lr(t[0]),s=lp(t[t.length-1]),a,i,o=n;o<=s;){var l=rj(o,e),c=!l.disabled&&!l.hidden;if(!c){o=zn(o,1);continue}if(l.selected)return o;l.today&&!i&&(i=o),a||(a=o),o=zn(o,1)}return i||a}var LZ=365;function $T(t,e){var n=e.moveBy,s=e.direction,a=e.context,i=e.modifiers,o=e.retry,l=o===void 0?{count:0,lastFocused:t}:o,c=a.weekStartsOn,d=a.fromDate,u=a.toDate,h=a.locale,m={day:zn,week:Iu,month:Vr,year:MV,startOfWeek:function(g){return a.ISOWeek?Wo(g):Is(g,{locale:h,weekStartsOn:c})},endOfWeek:function(g){return a.ISOWeek?NT(g):cp(g,{locale:h,weekStartsOn:c})}},p=m[n](t,s==="after"?1:-1);s==="before"&&d?p=IV([d,p]):s==="after"&&u&&(p=OV([u,p]));var b=!0;if(i){var x=rj(p,i);b=!x.disabled&&!x.hidden}return b?p:l.count>LZ?l.lastFocused:$T(p,{moveBy:n,direction:s,context:a,modifiers:i,retry:lt(lt({},l),{count:l.count+1})})}var zT=f.createContext(void 0);function $Z(t){var e=yh(),n=LT(),s=f.useState(),a=s[0],i=s[1],o=f.useState(),l=o[0],c=o[1],d=BZ(e.displayMonths,n),u=a??(l&&e.isDateDisplayed(l))?l:d,h=function(){c(a),i(void 0)},m=function(g){i(g)},p=Qt(),b=function(g,y){if(a){var v=$T(a,{moveBy:g,direction:y,context:p,modifiers:n});Un(a,v)||(e.goToDate(v,a),m(v))}},x={focusedDay:a,focusTarget:u,blur:h,focus:m,focusDayAfter:function(){return b("day","after")},focusDayBefore:function(){return b("day","before")},focusWeekAfter:function(){return b("week","after")},focusWeekBefore:function(){return b("week","before")},focusMonthBefore:function(){return b("month","before")},focusMonthAfter:function(){return b("month","after")},focusYearBefore:function(){return b("year","before")},focusYearAfter:function(){return b("year","after")},focusStartOfWeek:function(){return b("startOfWeek","before")},focusEndOfWeek:function(){return b("endOfWeek","after")}};return r.jsx(zT.Provider,{value:x,children:t.children})}function sj(){var t=f.useContext(zT);if(!t)throw new Error("useFocusContext must be used within a FocusProvider");return t}function zZ(t,e){var n=LT(),s=rj(t,n,e);return s}var aj=f.createContext(void 0);function UZ(t){if(!dp(t.initialProps)){var e={selected:void 0};return r.jsx(aj.Provider,{value:e,children:t.children})}return r.jsx(qZ,{initialProps:t.initialProps,children:t.children})}function qZ(t){var e=t.initialProps,n=t.children,s=function(i,o,l){var c,d,u;if((c=e.onDayClick)===null||c===void 0||c.call(e,i,o,l),o.selected&&!e.required){(d=e.onSelect)===null||d===void 0||d.call(e,void 0,i,o,l);return}(u=e.onSelect)===null||u===void 0||u.call(e,i,i,o,l)},a={selected:e.selected,onDayClick:s};return r.jsx(aj.Provider,{value:a,children:n})}function UT(){var t=f.useContext(aj);if(!t)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return t}function WZ(t,e){var n=Qt(),s=UT(),a=ej(),i=nj(),o=sj(),l=o.focusDayAfter,c=o.focusDayBefore,d=o.focusWeekAfter,u=o.focusWeekBefore,h=o.blur,m=o.focus,p=o.focusMonthBefore,b=o.focusMonthAfter,x=o.focusYearBefore,g=o.focusYearAfter,y=o.focusStartOfWeek,v=o.focusEndOfWeek,w=function(q){var O,F,B,R;dp(n)?(O=s.onDayClick)===null||O===void 0||O.call(s,t,e,q):gh(n)?(F=a.onDayClick)===null||F===void 0||F.call(a,t,e,q):vh(n)?(B=i.onDayClick)===null||B===void 0||B.call(i,t,e,q):(R=n.onDayClick)===null||R===void 0||R.call(n,t,e,q)},j=function(q){var O;m(t),(O=n.onDayFocus)===null||O===void 0||O.call(n,t,e,q)},S=function(q){var O;h(),(O=n.onDayBlur)===null||O===void 0||O.call(n,t,e,q)},N=function(q){var O;(O=n.onDayMouseEnter)===null||O===void 0||O.call(n,t,e,q)},k=function(q){var O;(O=n.onDayMouseLeave)===null||O===void 0||O.call(n,t,e,q)},E=function(q){var O;(O=n.onDayPointerEnter)===null||O===void 0||O.call(n,t,e,q)},P=function(q){var O;(O=n.onDayPointerLeave)===null||O===void 0||O.call(n,t,e,q)},A=function(q){var O;(O=n.onDayTouchCancel)===null||O===void 0||O.call(n,t,e,q)},C=function(q){var O;(O=n.onDayTouchEnd)===null||O===void 0||O.call(n,t,e,q)},T=function(q){var O;(O=n.onDayTouchMove)===null||O===void 0||O.call(n,t,e,q)},I=function(q){var O;(O=n.onDayTouchStart)===null||O===void 0||O.call(n,t,e,q)},V=function(q){var O;(O=n.onDayKeyUp)===null||O===void 0||O.call(n,t,e,q)},ne=function(q){var O;switch(q.key){case"ArrowLeft":q.preventDefault(),q.stopPropagation(),n.dir==="rtl"?l():c();break;case"ArrowRight":q.preventDefault(),q.stopPropagation(),n.dir==="rtl"?c():l();break;case"ArrowDown":q.preventDefault(),q.stopPropagation(),d();break;case"ArrowUp":q.preventDefault(),q.stopPropagation(),u();break;case"PageUp":q.preventDefault(),q.stopPropagation(),q.shiftKey?x():p();break;case"PageDown":q.preventDefault(),q.stopPropagation(),q.shiftKey?g():b();break;case"Home":q.preventDefault(),q.stopPropagation(),y();break;case"End":q.preventDefault(),q.stopPropagation(),v();break}(O=n.onDayKeyDown)===null||O===void 0||O.call(n,t,e,q)},se={onClick:w,onFocus:j,onBlur:S,onKeyDown:ne,onKeyUp:V,onMouseEnter:N,onMouseLeave:k,onPointerEnter:E,onPointerLeave:P,onTouchCancel:A,onTouchEnd:C,onTouchMove:T,onTouchStart:I};return se}function HZ(){var t=Qt(),e=UT(),n=ej(),s=nj(),a=dp(t)?e.selected:gh(t)?n.selected:vh(t)?s.selected:void 0;return a}function VZ(t){return Object.values(Os).includes(t)}function KZ(t,e){var n=[t.classNames.day];return Object.keys(e).forEach(function(s){var a=t.modifiersClassNames[s];if(a)n.push(a);else if(VZ(s)){var i=t.classNames["day_".concat(s)];i&&n.push(i)}}),n}function GZ(t,e){var n=lt({},t.styles.day);return Object.keys(e).forEach(function(s){var a;n=lt(lt({},n),(a=t.modifiersStyles)===null||a===void 0?void 0:a[s])}),n}function ZZ(t,e,n){var s,a,i,o=Qt(),l=sj(),c=zZ(t,e),d=WZ(t,c),u=HZ(),h=!!(o.onDayClick||o.mode!=="default");f.useEffect(function(){var N;c.outside||l.focusedDay&&h&&Un(l.focusedDay,t)&&((N=n.current)===null||N===void 0||N.focus())},[l.focusedDay,t,n,h,c.outside]);var m=KZ(o,c).join(" "),p=GZ(o,c),b=!!(c.outside&&!o.showOutsideDays||c.hidden),x=(i=(a=o.components)===null||a===void 0?void 0:a.DayContent)!==null&&i!==void 0?i:xZ,g=r.jsx(x,{date:t,displayMonth:e,activeModifiers:c}),y={style:p,className:m,children:g,role:"gridcell"},v=l.focusTarget&&Un(l.focusTarget,t)&&!c.outside,w=l.focusedDay&&Un(l.focusedDay,t),j=lt(lt(lt({},y),(s={disabled:c.disabled,role:"gridcell"},s["aria-selected"]=c.selected,s.tabIndex=w||v?0:-1,s)),d),S={isButton:h,isHidden:b,activeModifiers:c,selectedDays:u,buttonProps:j,divProps:y};return S}function QZ(t){var e=f.useRef(null),n=ZZ(t.date,t.displayMonth,e);return n.isHidden?r.jsx("div",{role:"gridcell"}):n.isButton?r.jsx(Jf,lt({name:"day",ref:e},n.buttonProps)):r.jsx("div",lt({},n.divProps))}function YZ(t){var e=t.number,n=t.dates,s=Qt(),a=s.onWeekNumberClick,i=s.styles,o=s.classNames,l=s.locale,c=s.labels.labelWeekNumber,d=s.formatters.formatWeekNumber,u=d(Number(e),{locale:l});if(!a)return r.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:u});var h=c(Number(e),{locale:l}),m=function(p){a(e,n,p)};return r.jsx(Jf,{name:"week-number","aria-label":h,className:o.weeknumber,style:i.weeknumber,onClick:m,children:u})}function JZ(t){var e,n,s=Qt(),a=s.styles,i=s.classNames,o=s.showWeekNumber,l=s.components,c=(e=l==null?void 0:l.Day)!==null&&e!==void 0?e:QZ,d=(n=l==null?void 0:l.WeekNumber)!==null&&n!==void 0?n:YZ,u;return o&&(u=r.jsx("td",{className:i.cell,style:a.cell,children:r.jsx(d,{number:t.weekNumber,dates:t.dates})})),r.jsxs("tr",{className:i.row,style:a.row,children:[u,t.dates.map(function(h){return r.jsx("td",{className:i.cell,style:a.cell,role:"presentation",children:r.jsx(c,{displayMonth:t.displayMonth,date:h})},FK(h))})]})}function k2(t,e,n){for(var s=n!=null&&n.ISOWeek?NT(e):cp(e,n),a=n!=null&&n.ISOWeek?Wo(t):Is(t,n),i=Xs(s,a),o=[],l=0;l<=i;l++)o.push(zn(a,l));var c=o.reduce(function(d,u){var h=n!=null&&n.ISOWeek?CT(u):AT(u,n),m=d.find(function(p){return p.weekNumber===h});return m?(m.dates.push(u),d):(d.push({weekNumber:h,dates:[u]}),d)},[]);return c}function XZ(t,e){var n=k2(lr(t),lp(t),e);if(e!=null&&e.useFixedWeeks){var s=LK(t,e);if(s<6){var a=n[n.length-1],i=a.dates[a.dates.length-1],o=Iu(i,6-s),l=k2(Iu(i,1),o,e);n.push.apply(n,l)}}return n}function eQ(t){var e,n,s,a=Qt(),i=a.locale,o=a.classNames,l=a.styles,c=a.hideHead,d=a.fixedWeeks,u=a.components,h=a.weekStartsOn,m=a.firstWeekContainsDate,p=a.ISOWeek,b=XZ(t.displayMonth,{useFixedWeeks:!!d,ISOWeek:p,locale:i,weekStartsOn:h,firstWeekContainsDate:m}),x=(e=u==null?void 0:u.Head)!==null&&e!==void 0?e:pZ,g=(n=u==null?void 0:u.Row)!==null&&n!==void 0?n:JZ,y=(s=u==null?void 0:u.Footer)!==null&&s!==void 0?s:hZ;return r.jsxs("table",{id:t.id,className:o.table,style:l.table,role:"grid","aria-labelledby":t["aria-labelledby"],children:[!c&&r.jsx(x,{}),r.jsx("tbody",{className:o.tbody,style:l.tbody,children:b.map(function(v){return r.jsx(g,{displayMonth:t.displayMonth,dates:v.dates,weekNumber:v.weekNumber},v.weekNumber)})}),r.jsx(y,{displayMonth:t.displayMonth})]})}function tQ(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var nQ=tQ()?f.useLayoutEffect:f.useEffect,mg=!1,rQ=0;function C2(){return"react-day-picker-".concat(++rQ)}function sQ(t){var e,n=t??(mg?C2():null),s=f.useState(n),a=s[0],i=s[1];return nQ(function(){a===null&&i(C2())},[]),f.useEffect(function(){mg===!1&&(mg=!0)},[]),(e=t??a)!==null&&e!==void 0?e:void 0}function aQ(t){var e,n,s=Qt(),a=s.dir,i=s.classNames,o=s.styles,l=s.components,c=yh().displayMonths,d=sQ(s.id?"".concat(s.id,"-").concat(t.displayIndex):void 0),u=s.id?"".concat(s.id,"-grid-").concat(t.displayIndex):void 0,h=[i.month],m=o.month,p=t.displayIndex===0,b=t.displayIndex===c.length-1,x=!p&&!b;a==="rtl"&&(e=[p,b],b=e[0],p=e[1]),p&&(h.push(i.caption_start),m=lt(lt({},m),o.caption_start)),b&&(h.push(i.caption_end),m=lt(lt({},m),o.caption_end)),x&&(h.push(i.caption_between),m=lt(lt({},m),o.caption_between));var g=(n=l==null?void 0:l.Caption)!==null&&n!==void 0?n:uZ;return r.jsxs("div",{className:h.join(" "),style:m,children:[r.jsx(g,{id:d,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),r.jsx(eQ,{id:u,"aria-labelledby":d,displayMonth:t.displayMonth})]},t.displayIndex)}function iQ(t){var e=Qt(),n=e.classNames,s=e.styles;return r.jsx("div",{className:n.months,style:s.months,children:t.children})}function oQ(t){var e,n,s=t.initialProps,a=Qt(),i=sj(),o=yh(),l=f.useState(!1),c=l[0],d=l[1];f.useEffect(function(){a.initialFocus&&i.focusTarget&&(c||(i.focus(i.focusTarget),d(!0)))},[a.initialFocus,c,i.focus,i.focusTarget,i]);var u=[a.classNames.root,a.className];a.numberOfMonths>1&&u.push(a.classNames.multiple_months),a.showWeekNumber&&u.push(a.classNames.with_weeknumber);var h=lt(lt({},a.styles.root),a.style),m=Object.keys(s).filter(function(b){return b.startsWith("data-")}).reduce(function(b,x){var g;return lt(lt({},b),(g={},g[x]=s[x],g))},{}),p=(n=(e=s.components)===null||e===void 0?void 0:e.Months)!==null&&n!==void 0?n:iQ;return r.jsx("div",lt({className:u.join(" "),style:h,dir:a.dir,id:a.id,nonce:s.nonce,title:s.title,lang:s.lang},m,{children:r.jsx(p,{children:o.displayMonths.map(function(b,x){return r.jsx(aQ,{displayIndex:x,displayMonth:b},x)})})}))}function lQ(t){var e=t.children,n=TG(t,["children"]);return r.jsx(YG,{initialProps:n,children:r.jsx(oZ,{children:r.jsx(UZ,{initialProps:n,children:r.jsx(gZ,{initialProps:n,children:r.jsx(bZ,{initialProps:n,children:r.jsx(EZ,{children:r.jsx($Z,{children:e})})})})})})})}function cQ(t){return r.jsx(lQ,lt({},t,{children:r.jsx(oQ,{initialProps:t})}))}function Cs({className:t,classNames:e,showOutsideDays:n=!0,...s}){return r.jsx(cQ,{showOutsideDays:n,className:_e("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:_e(Jv({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:_e(Jv({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...e},components:{IconLeft:({...a})=>r.jsx($d,{className:"h-4 w-4"}),IconRight:({...a})=>r.jsx(Co,{className:"h-4 w-4"})},...s})}Cs.displayName="Calendar";const dQ=({isOpen:t,onClose:e,onProjectAdded:n,customers:s,teamMembers:a})=>{const{toast:i}=pt();UD(),console.log("AddProjectDialog - customers:",s),console.log("AddProjectDialog - teamMembers:",a);const[o,l]=f.useState({name:"",customer:"",location:"",budget:"",team:[],status:"geplant"}),[c,d]=f.useState(),u=(y,v)=>{if(!(v!=null&&v.from)||!(v!=null&&v.to))return"unknown";const w=v.from,j=v.to;let S=0;const N=Math.ceil((j.getTime()-w.getTime())/(1e3*60*60*24));return y.projects.forEach(k=>{const E=new Date(k.startDate.split(".").reverse().join("-")),P=new Date(k.endDate.split(".").reverse().join("-"));if(w<=P&&j>=E){const A=new Date(Math.max(w.getTime(),E.getTime())),C=new Date(Math.min(j.getTime(),P.getTime())),T=Math.ceil((C.getTime()-A.getTime())/(1e3*60*60*24));S+=T}}),S===0?"available":S>=N*.8?"unavailable":"partial"},h=f.useMemo(()=>a.map(y=>({...y,availability:u(y,c)})),[a,c]),m=y=>{switch(y){case"available":return r.jsx(Ae,{className:"bg-green-100 text-green-800 text-xs",children:"Verfügbar"});case"partial":return r.jsx(Ae,{className:"bg-orange-100 text-orange-800 text-xs",children:"Teilweise"});case"unavailable":return r.jsx(Ae,{className:"bg-red-100 text-red-800 text-xs",children:"Nicht verfügbar"});default:return r.jsx(Ae,{variant:"outline",className:"text-xs",children:"Unbekannt"})}},p=y=>{if(y.preventDefault(),!o.name||!o.customer||!o.budget){i({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}const v={id:`P2024-${String(Date.now()).slice(-3)}`,name:o.name,customer:o.customer,status:o.status,progress:0,startDate:c!=null&&c.from?Pe(c.from,"dd.MM.yyyy"):new Date().toLocaleDateString("de-DE"),endDate:c!=null&&c.to?Pe(c.to,"dd.MM.yyyy"):new Date(Date.now()+30*24*60*60*1e3).toLocaleDateString("de-DE"),budget:o.budget.startsWith("€")?o.budget:`€${o.budget}`,team:o.team.length>0?o.team:["Nicht zugewiesen"],location:o.location||"Nicht angegeben"};n(v),l({name:"",customer:"",location:"",budget:"",team:[],status:"geplant"}),d(void 0),i({title:"Erfolg",description:"Projekt wurde erfolgreich hinzugefügt."}),e()},b=(y,v)=>{l(w=>({...w,[y]:v}))},x=y=>{const v=s.find(w=>w.name===y||w.company_name===y);l(w=>({...w,customer:y,location:v?v.address:""}))},g=(y,v)=>{const w=a.find(S=>S.name===y||`${S.first_name||""} ${S.last_name||""}`.trim()===y),j=(w==null?void 0:w.name)||`${(w==null?void 0:w.first_name)||""} ${(w==null?void 0:w.last_name)||""}`.trim()||y;l(S=>({...S,team:v?[...S.team,j]:S.team.filter(N=>N!==j)}))};return r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Neues Projekt erstellen"}),r.jsx(Nn,{children:"Geben Sie die Informationen für das neue Projekt ein."})]}),r.jsxs("form",{onSubmit:p,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"name",children:"Projektname *"}),r.jsx(G,{id:"name",value:o.name,onChange:y=>b("name",y.target.value),placeholder:"z.B. Büroerweiterung Müller GmbH",required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"customer",children:"Kunde *"}),r.jsxs(tt,{value:o.customer,onValueChange:x,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Kunde auswählen"})}),r.jsx(Xe,{children:s.map(y=>r.jsx(ce,{value:y.name||y.company_name||"Unbekannt",children:y.name||y.company_name||"Unbekannt"},y.id))})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"location",children:"Standort"}),r.jsx(G,{id:"location",value:o.location,onChange:y=>b("location",y.target.value),placeholder:"Wird automatisch aus Kundendaten übernommen",readOnly:!0,className:"bg-gray-50"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"budget",children:"Budget *"}),r.jsx(G,{id:"budget",value:o.budget,onChange:y=>b("budget",y.target.value),placeholder:"z.B. 15000 oder €15.000",required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Projektzeitraum"}),r.jsxs(ia,{children:[r.jsx(oa,{asChild:!0,children:r.jsxs(W,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[r.jsx(gt,{className:"mr-2 h-4 w-4"}),c!=null&&c.from?c.to?r.jsxs(r.Fragment,{children:[Pe(c.from,"dd.MM.yyyy",{locale:Wt})," -"," ",Pe(c.to,"dd.MM.yyyy",{locale:Wt})]}):Pe(c.from,"dd.MM.yyyy",{locale:Wt}):r.jsx("span",{children:"Start- und Enddatum auswählen"})]})}),r.jsx(ks,{className:"w-auto p-0",align:"start",children:r.jsx(Cs,{initialFocus:!0,mode:"range",defaultMonth:c==null?void 0:c.from,selected:c,onSelect:d,numberOfMonths:2,locale:Wt,className:"pointer-events-auto"})})]})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Team auswählen"}),r.jsx("div",{className:"mt-2 space-y-2 max-h-48 overflow-y-auto border rounded-md p-3",children:h.map(y=>r.jsxs("div",{className:"flex items-center justify-between space-x-2 p-2 rounded-lg hover:bg-gray-50",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(aa,{id:`team-${y.id}`,checked:o.team.includes(y.name||`${y.first_name||""} ${y.last_name||""}`.trim()),onCheckedChange:v=>g(y.name||`${y.first_name||""} ${y.last_name||""}`.trim(),v)}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:`team-${y.id}`,className:"text-sm font-medium cursor-pointer",children:y.name||`${y.first_name||""} ${y.last_name||""}`.trim()||"Unbekannt"}),r.jsx("p",{className:"text-xs text-gray-500",children:y.role||y.position||"Mitarbeiter"})]})]}),m(y.availability)]},y.id))})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"status",children:"Status"}),r.jsxs(tt,{value:o.status,onValueChange:y=>b("status",y),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"anfrage",children:"Anfrage"}),r.jsx(ce,{value:"besichtigung",children:"Besichtigung"}),r.jsx(ce,{value:"geplant",children:"Planung"}),r.jsx(ce,{value:"in_bearbeitung",children:"In Bearbeitung"}),r.jsx(ce,{value:"abgeschlossen",children:"Abgeschlossen"})]})]})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(W,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),r.jsx(W,{type:"submit",className:"flex-1",children:"Projekt erstellen"})]})]})]})})},uQ=({isOpen:t,onClose:e,project:n,onProjectUpdated:s,onProjectDeleted:a})=>{const{toast:i}=pt(),[o,l]=f.useState([]),[c,d]=f.useState(),[u,h]=f.useState(!1),[m,p]=f.useState(0),[b,x]=f.useState(null),[g,y]=f.useState({name:(n==null?void 0:n.name)||"",customer:(n==null?void 0:n.customer)||"",status:(n==null?void 0:n.status)||"Planung",progress:(n==null?void 0:n.progress)||0,startDate:(n==null?void 0:n.startDate)||"",endDate:(n==null?void 0:n.endDate)||"",budget:(n==null?void 0:n.budget)||"",location:(n==null?void 0:n.location)||""});f.useEffect(()=>{t&&(async()=>{const{data:E}=await $.from("customers").select("*").eq("status","Aktiv").order("company_name");E&&l(E)})()},[t]),f.useEffect(()=>{if(n){if(y({name:n.name,customer:n.customer,status:n.status,progress:n.progress,startDate:n.startDate,endDate:n.endDate,budget:n.budget,location:n.location}),n.startDate&&n.endDate){const k=new Date(n.startDate),E=new Date(n.endDate);!isNaN(k.getTime())&&!isNaN(E.getTime())&&d({from:k,to:E})}else if(n.startDate){const k=new Date(n.startDate);isNaN(k.getTime())||d({from:k,to:void 0})}}},[n]),f.useEffect(()=>{c!=null&&c.from&&w("startDate",Pe(c.from,"yyyy-MM-dd")),c!=null&&c.to&&w("endDate",Pe(c.to,"yyyy-MM-dd"))},[c]),f.useEffect(()=>(t||S(),()=>{b&&clearInterval(b)}),[t,b]);const v=k=>{if(k.preventDefault(),!n)return;const E={...n,...g};s(E),e()},w=(k,E)=>{y(P=>({...P,[k]:E}))},j=()=>{console.log("🚀 startDelete called - beginning delete sequence"),h(!0),p(0);const k=setInterval(()=>{p(E=>{const P=E+4;return console.log("⏰ Delete progress:",Math.round(P)+"%"),P>=100?(clearInterval(k),console.log("✅ Delete timer completed, calling handleDelete"),N(),100):P})},100);x(k)},S=()=>{console.log("⏹️ stopDelete called - canceling delete sequence"),b&&(clearInterval(b),x(null)),h(!1),p(0)},N=async()=>{if(!n||!a){console.log("❌ handleDelete aborted - missing project or callback");return}console.log("🗑️ Starting deletion of project:",n.id,n.name);try{const{data:k,error:E}=await $.from("projects").select("id, name").eq("id",n.id).single();if(console.log("🔍 Project check before delete:",{checkData:k,checkError:E}),E)throw console.error("❌ Cannot access project for deletion:",E),new Error("Projekt nicht gefunden oder keine Berechtigung");const{data:P,error:A,count:C}=await $.from("projects").delete().eq("id",n.id).select("*");if(console.log("🗑️ Delete result:",{data:P,error:A,count:C,deletedRows:(P==null?void 0:P.length)||0}),A)throw console.error("❌ Database delete error:",A),console.error("❌ Error details:",{message:A.message,code:A.code,details:A.details,hint:A.hint}),A;if(!P||P.length===0)throw console.warn("⚠️ No rows were deleted - project may not exist or access denied"),new Error("Projekt konnte nicht gelöscht werden - möglicherweise keine Berechtigung");console.log("✅ Project successfully deleted from database:",P[0]),i({title:"Projekt gelöscht",description:"Das Projekt wurde erfolgreich gelöscht."}),a(n.id),e(),console.log("✅ Delete operation completed")}catch(k){console.error("💥 Error deleting project:",k),i({title:"Fehler",description:"Projekt konnte nicht gelöscht werden: "+(k.message||"Unbekannter Fehler"),variant:"destructive"})}finally{S()}};return n?(console.log("🎯 EditProjectDialog render - onProjectDeleted available:",!!a),r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-md",children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Projekt bearbeiten"}),r.jsx(Nn,{children:"Bearbeiten Sie die Informationen für das Projekt."})]}),r.jsxs("form",{onSubmit:v,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"name",children:"Projektname"}),r.jsx(G,{id:"name",value:g.name,onChange:k=>w("name",k.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"customer",children:"Kunde"}),r.jsxs(tt,{value:g.customer,onValueChange:k=>w("customer",k),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Kunde auswählen"})}),r.jsx(Xe,{children:o.map(k=>r.jsx(ce,{value:k.company_name,children:k.company_name},k.id))})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"location",children:"Standort"}),r.jsx(G,{id:"location",value:g.location,onChange:k=>w("location",k.target.value)})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"budget",children:"Budget"}),r.jsx(G,{id:"budget",value:g.budget,onChange:k=>w("budget",k.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Projektzeitraum"}),r.jsxs(ia,{children:[r.jsx(oa,{asChild:!0,children:r.jsxs(W,{variant:"outline",className:_e("w-full justify-start text-left font-normal",!c&&"text-muted-foreground"),children:[r.jsx(gt,{className:"mr-2 h-4 w-4"}),c!=null&&c.from?c.to?r.jsxs(r.Fragment,{children:[Pe(c.from,"dd.MM.yyyy")," -"," ",Pe(c.to,"dd.MM.yyyy")]}):Pe(c.from,"dd.MM.yyyy"):r.jsx("span",{children:"Zeitraum auswählen"})]})}),r.jsx(ks,{className:"w-auto p-0",align:"start",children:r.jsx(Cs,{initialFocus:!0,mode:"range",defaultMonth:c==null?void 0:c.from,selected:c,onSelect:d,numberOfMonths:2,className:_e("p-3 pointer-events-auto")})})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"status",children:"Status"}),r.jsxs(tt,{value:g.status,onValueChange:k=>w("status",k),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Anfrage",children:"Anfrage"}),r.jsx(ce,{value:"Besichtigung",children:"Besichtigung"}),r.jsx(ce,{value:"Planung",children:"Planung"}),r.jsx(ce,{value:"In Bearbeitung",children:"In Bearbeitung"}),r.jsx(ce,{value:"Abgeschlossen",children:"Abgeschlossen"})]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"progress",children:"Fortschritt (%)"}),r.jsx(G,{id:"progress",type:"number",min:"0",max:"100",value:g.progress,onChange:k=>w("progress",parseInt(k.target.value))})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx("div",{className:"flex-1",children:r.jsx("div",{className:"relative",children:r.jsxs(W,{type:"button",variant:"destructive",className:"w-full relative overflow-hidden",onClick:()=>console.log("🖱️ Delete button clicked!"),onMouseDown:a?j:void 0,onMouseUp:a?S:void 0,onMouseLeave:a?S:void 0,onTouchStart:a?j:void 0,onTouchEnd:a?S:void 0,disabled:!a,children:[u&&r.jsx("div",{className:"absolute inset-0 bg-white/30 transition-all duration-100 ease-linear",style:{width:`${m}%`,left:0}}),r.jsx(ra,{className:"h-4 w-4 mr-2 relative z-10"}),r.jsx("span",{className:"relative z-10",children:u?"Löschen...":"Projekt löschen"})]})})}),r.jsx(W,{type:"button",variant:"outline",onClick:e,children:"Abbrechen"}),r.jsx(W,{type:"submit",children:"Speichern"})]})]})]})})):null},hQ=({isOpen:t,onClose:e,project:n})=>{const[s,a]=f.useState([]),[i,o]=f.useState(!1),[l,c]=f.useState(""),[d,u]=f.useState(""),[h,m]=f.useState(""),[p,b]=f.useState(""),[x,g]=f.useState("geplant");f.useEffect(()=>{t&&n&&y(n.id)},[t,n]);const y=async w=>{o(!0),a([]),o(!1)},v=async w=>{w.preventDefault(),n&&l.trim()&&(console.log("Add task functionality not yet implemented"),c(""),u(""),m(""),b(""),g("geplant"),y(n.id))};return n?r.jsx(Mt,{open:t,onOpenChange:w=>!w&&e(),children:r.jsx(Pt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:r.jsxs(cr,{defaultValue:"overview",className:"w-full",children:[r.jsxs(Bt,{className:"pb-2",children:[r.jsxs(Lt,{children:[n.name," – Details"]}),r.jsxs(tr,{children:[r.jsx(Oe,{value:"overview",children:"Übersicht"}),r.jsx(Oe,{value:"tasks",children:"Teilaufgaben"})]})]}),r.jsx(Fe,{value:"overview",className:"mt-0",children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Kunde"})}),r.jsx(te,{children:n.customer})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Status"})}),r.jsx(te,{children:n.status})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Budget"})}),r.jsx(te,{children:n.budget||"n/a"})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Standort"})}),r.jsx(te,{children:n.location||"n/a"})]})]})}),r.jsx(Fe,{value:"tasks",className:"mt-0",children:r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Aufgabenplan"}),i?r.jsx("p",{children:"Aufgaben werden geladen…"}):s.length===0?r.jsx("p",{children:"Keine Teilaufgaben vorhanden."}):r.jsx("ul",{className:"space-y-2",children:s.map(w=>r.jsxs("li",{className:"border rounded-md p-2",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-medium",children:w.name}),r.jsx("span",{className:"text-xs text-gray-500",children:w.status})]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:w.description||"–"}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[w.start_date&&`Start: ${w.start_date}`," ",w.end_date&&`· Ende: ${w.end_date}`]})]},w.id))}),r.jsxs("form",{onSubmit:v,className:"mt-6 space-y-2",children:[r.jsx("h4",{className:"font-semibold",children:"Neue Aufgabe"}),r.jsx("input",{type:"text",className:"border rounded-md p-2 w-full",placeholder:"Name der Aufgabe",value:l,onChange:w=>c(w.target.value),required:!0}),r.jsx("textarea",{className:"border rounded-md p-2 w-full",placeholder:"Beschreibung",value:d,onChange:w=>u(w.target.value),rows:3}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"date",className:"border rounded-md p-2 flex-1",value:h,onChange:w=>m(w.target.value)}),r.jsx("input",{type:"date",className:"border rounded-md p-2 flex-1",value:p,onChange:w=>b(w.target.value)})]}),r.jsxs("select",{className:"border rounded-md p-2 w-full",value:x,onChange:w=>g(w.target.value),children:[r.jsx("option",{value:"geplant",children:"Geplant"}),r.jsx("option",{value:"in_bearbeitung",children:"In Bearbeitung"}),r.jsx("option",{value:"abgeschlossen",children:"Abgeschlossen"})]}),r.jsx(W,{type:"submit",className:"w-full",children:"Aufgabe hinzufügen"})]})]})})]})})}):null},mQ=({isOpen:t,onClose:e,projectId:n,onTimeEntryAdded:s})=>{const{toast:a}=pt(),[i,o]=f.useState({work_date:new Date().toISOString().split("T")[0],start_time:"08:00",end_time:"17:00",task_description:"",category:"ausfuehrung"}),[l,c]=f.useState(new Date),[d,u]=f.useState(!1),[h,m]=f.useState(!1),p=async y=>{if(y.preventDefault(),!i.task_description.trim()){a({title:"Fehler",description:"Bitte geben Sie eine Tätigkeitsbeschreibung ein.",variant:"destructive"});return}if(i.start_time>=i.end_time){a({title:"Fehler",description:"Die Endzeit muss nach der Startzeit liegen.",variant:"destructive"});return}m(!0);try{const v=new Date(`${i.work_date}T${i.start_time}`),j=(new Date(`${i.work_date}T${i.end_time}`).getTime()-v.getTime())/(1e3*60*60),S={...i,work_date:Pe(l,"yyyy-MM-dd")};s(S),a({title:"Erfolg",description:`Arbeitszeit von ${j.toFixed(1)} Stunden erfasst.`}),o({work_date:new Date().toISOString().split("T")[0],start_time:"08:00",end_time:"17:00",task_description:"",category:"ausfuehrung"}),c(new Date),u(!1),e()}catch{a({title:"Fehler",description:"Arbeitszeit konnte nicht erfasst werden.",variant:"destructive"})}finally{m(!1)}},b=(y,v)=>{o(w=>({...w,[y]:v}))},g=(()=>{if(!i.start_time||!i.end_time)return 0;const y=new Date(`${i.work_date}T${i.start_time}`),v=new Date(`${i.work_date}T${i.end_time}`);return v<=y?0:(v.getTime()-y.getTime())/(1e3*60*60)})();return r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-md",children:[r.jsxs(Bt,{children:[r.jsxs(Lt,{className:"flex items-center gap-2",children:[r.jsx(Ht,{className:"h-5 w-5"}),"Arbeitszeit erfassen"]}),r.jsx(Nn,{children:"Erfassen Sie Ihre Arbeitszeiten für dieses Projekt."})]}),r.jsxs("form",{onSubmit:p,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"work_date",children:"Arbeitsdatum *"}),r.jsxs(ia,{children:[r.jsx(oa,{asChild:!0,children:r.jsxs(W,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[r.jsx(gt,{className:"mr-2 h-4 w-4"}),Pe(l,"dd.MM.yyyy",{locale:Wt})]})}),r.jsx(ks,{className:"w-auto p-0",align:"start",children:r.jsx(Cs,{mode:"single",selected:l,onSelect:y=>{y&&(c(y),b("work_date",Pe(y,"yyyy-MM-dd")))},initialFocus:!0,locale:Wt})})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"start_time",children:"Von *"}),r.jsx(G,{id:"start_time",type:"time",value:i.start_time,onChange:y=>b("start_time",y.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"end_time",children:"Bis *"}),r.jsx(G,{id:"end_time",type:"time",value:i.end_time,onChange:y=>b("end_time",y.target.value),required:!0})]})]}),r.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm font-medium",children:"Gesamtstunden:"}),r.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[g.toFixed(1),"h"]})]}),g>8&&r.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[r.jsx(aa,{id:"overtime",checked:d,onCheckedChange:y=>u(y)}),r.jsxs("label",{htmlFor:"overtime",className:"text-sm text-orange-600 cursor-pointer",children:["Überstunden (",(g-8).toFixed(1),"h)"]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"category",children:"Kategorie *"}),r.jsxs(tt,{value:i.category,onValueChange:y=>b("category",y),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"planung",children:"Planung"}),r.jsx(ce,{value:"ausfuehrung",children:"Ausführung"}),r.jsx(ce,{value:"nacharbeit",children:"Nacharbeit"}),r.jsx(ce,{value:"dokumentation",children:"Dokumentation"}),r.jsx(ce,{value:"sonstiges",children:"Sonstiges"})]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"task_description",children:"Tätigkeitsbeschreibung *"}),r.jsx(an,{id:"task_description",placeholder:"Beschreiben Sie Ihre durchgeführten Arbeiten...",value:i.task_description,onChange:y=>b("task_description",y.target.value),rows:3,required:!0})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(W,{type:"button",variant:"outline",onClick:e,className:"flex-1",disabled:h,children:"Abbrechen"}),r.jsx(W,{type:"submit",className:"flex-1",disabled:h||g===0,children:h?"Speichern...":"Zeit erfassen"})]})]})]})})},fQ=({isOpen:t,onClose:e,projectId:n,onMaterialEntryAdded:s})=>{const{toast:a}=pt(),[i,o]=f.useState({entry_date:new Date().toISOString().split("T")[0],material_name:"",quantity:1,unit:"Stück",unit_cost:0,category:"baumaterial",supplier:""}),[l,c]=f.useState(new Date),[d,u]=f.useState(!1),h=async g=>{if(g.preventDefault(),!i.material_name.trim()){a({title:"Fehler",description:"Bitte geben Sie einen Materialnamen ein.",variant:"destructive"});return}if(i.quantity<=0){a({title:"Fehler",description:"Die Menge muss größer als 0 sein.",variant:"destructive"});return}if(i.unit_cost<0){a({title:"Fehler",description:"Der Stückpreis kann nicht negativ sein.",variant:"destructive"});return}u(!0);try{const y={...i,entry_date:Pe(l,"yyyy-MM-dd")};s(y);const v=i.quantity*i.unit_cost;a({title:"Erfolg",description:`Material im Wert von ${v.toFixed(2)}€ erfasst.`}),o({entry_date:new Date().toISOString().split("T")[0],material_name:"",quantity:1,unit:"Stück",unit_cost:0,category:"baumaterial",supplier:""}),c(new Date),e()}catch{a({title:"Fehler",description:"Material konnte nicht erfasst werden.",variant:"destructive"})}finally{u(!1)}},m=(g,y)=>{o(v=>({...v,[g]:y}))},b=i.quantity*i.unit_cost,x=["Stück","kg","g","Liter","ml","m","cm","mm","m²","cm²","Paket","Karton","Rolle","Meter","qm","Sack","Palette"];return r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-md",children:[r.jsxs(Bt,{children:[r.jsxs(Lt,{className:"flex items-center gap-2",children:[r.jsx(Ds,{className:"h-5 w-5"}),"Material erfassen"]}),r.jsx(Nn,{children:"Erfassen Sie verwendete Materialien für dieses Projekt."})]}),r.jsxs("form",{onSubmit:h,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"entry_date",children:"Datum *"}),r.jsxs(ia,{children:[r.jsx(oa,{asChild:!0,children:r.jsxs(W,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[r.jsx(gt,{className:"mr-2 h-4 w-4"}),Pe(l,"dd.MM.yyyy",{locale:Wt})]})}),r.jsx(ks,{className:"w-auto p-0",align:"start",children:r.jsx(Cs,{mode:"single",selected:l,onSelect:g=>{g&&(c(g),m("entry_date",Pe(g,"yyyy-MM-dd")))},initialFocus:!0,locale:Wt})})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"material_name",children:"Materialname *"}),r.jsx(G,{id:"material_name",placeholder:"z.B. Zement, Kabel, Schrauben...",value:i.material_name,onChange:g=>m("material_name",g.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"category",children:"Kategorie *"}),r.jsxs(tt,{value:i.category,onValueChange:g=>m("category",g),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"baumaterial",children:"Baumaterial"}),r.jsx(ce,{value:"werkzeug",children:"Werkzeug"}),r.jsx(ce,{value:"verbrauchsmaterial",children:"Verbrauchsmaterial"}),r.jsx(ce,{value:"sonstiges",children:"Sonstiges"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"quantity",children:"Menge *"}),r.jsx(G,{id:"quantity",type:"number",min:"0.01",step:"0.01",value:i.quantity,onChange:g=>m("quantity",parseFloat(g.target.value)||0),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"unit",children:"Einheit *"}),r.jsxs(tt,{value:i.unit,onValueChange:g=>m("unit",g),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsx(Xe,{children:x.map(g=>r.jsx(ce,{value:g,children:g},g))})]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"unit_cost",children:"Stückpreis (€) *"}),r.jsx(G,{id:"unit_cost",type:"number",min:"0",step:"0.01",placeholder:"0.00",value:i.unit_cost,onChange:g=>m("unit_cost",parseFloat(g.target.value)||0),required:!0})]}),r.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(ws,{className:"h-4 w-4 text-blue-600"}),r.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Gesamtkosten:"})]}),r.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[b.toFixed(2),"€"]})]}),r.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[i.quantity," ",i.unit," × ",i.unit_cost.toFixed(2),"€"]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"supplier",children:"Lieferant"}),r.jsx(G,{id:"supplier",placeholder:"z.B. Baumarkt, Großhandel...",value:i.supplier,onChange:g=>m("supplier",g.target.value)})]}),r.jsxs("div",{className:"flex gap-2 pt-4",children:[r.jsx(W,{type:"button",variant:"outline",onClick:e,className:"flex-1",disabled:d,children:"Abbrechen"}),r.jsx(W,{type:"submit",className:"flex-1",disabled:d||!i.material_name.trim()||i.quantity<=0,children:d?"Speichern...":"Material erfassen"})]})]})]})})},pQ=({isOpen:t,onClose:e,projectId:n})=>{const{toast:s}=pt(),[a,i]=f.useState(null),[o,l]=f.useState(!0),[c,d]=f.useState("mitarbeiter"),[u,h]=f.useState({can_view:!1,can_edit_basic_data:!1,can_add_time:!1,can_add_materials:!1,can_upload_files:!1,can_change_status:!1,can_link_invoices:!1,can_delete:!1,can_manage_team:!1}),[m,p]=f.useState("overview"),[b,x]=f.useState(!1),[g,y]=f.useState(!1),[v,w]=f.useState(!1),[j,S]=f.useState([]);f.useEffect(()=>{t&&n&&N()},[t,n]);const N=async()=>{l(!0);try{const{data:q}=await $.auth.getUser();if(!(q!=null&&q.user)){s({title:"Fehler",description:"Benutzer nicht authentifiziert",variant:"destructive"});return}const{data:O}=await $.from("profiles").select("company_id").eq("id",q.user.id).single();if(!(O!=null&&O.company_id)){s({title:"Fehler",description:"Benutzer-Unternehmen nicht gefunden",variant:"destructive"});return}const{data:F,error:B}=await $.from("projects").select("*").eq("id",n).eq("company_id",O.company_id).single();if(B||!F){s({title:"Fehler",description:"Projekt nicht gefunden",variant:"destructive"});return}let R=null;if(F.customer_id){const{data:Me}=await $.from("customers").select("*").eq("id",F.customer_id).single();R=Me}const{data:D,error:L}=await $.from("time_entries").select("hours_worked").eq("project_id",n);L&&console.log("Time entries table might not exist yet:",L.message);const M=(D==null?void 0:D.reduce((Me,Ne)=>Me+(Ne.hours_worked||0),0))||0,{data:X,error:K}=await $.from("material_entries").select("total_cost").eq("project_id",n);K&&console.log("Material entries table might not exist yet:",K.message);const z=(X==null?void 0:X.reduce((Me,Ne)=>Me+(Ne.total_cost||0),0))||0,{data:Y,error:ae}=await $.from("project_team_members").select("employee_id, employees!inner(first_name, last_name, email)").eq("project_id",n);ae&&console.log("Project team members table might not exist yet:",ae.message);const{data:U,error:Q}=await $.from("project_comments").select("id").eq("project_id",n);Q&&console.log("Project comments table might not exist yet:",Q.message);const{data:oe,error:re}=await $.from("project_documents").select("id").eq("project_id",n);re&&console.log("Project documents table might not exist yet:",re.message);const le=F.budget||0,Z=z+M*50,de=le>0?Math.round(Z/le*100):0,he=new Date(F.start_date||new Date),Re=new Date(F.end_date||new Date),$e=new Date,wt=Math.max(0,Math.floor(($e.getTime()-he.getTime())/(1e3*60*60*24))),me=Math.max(0,Math.floor((Re.getTime()-$e.getTime())/(1e3*60*60*24))),je={id:F.id,company_id:F.company_id,project_name:F.name,customer_id:F.customer_id||"",start_date:F.start_date||new Date().toISOString().split("T")[0],planned_end_date:F.end_date||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],status:F.status??"geplant",project_address:F.address||F.location||F.project_address||(R==null?void 0:R.address)||"Nicht angegeben",project_description:F.description||"Keine Beschreibung",linked_invoices:[],linked_offers:[],created_at:F.created_at||new Date().toISOString(),updated_at:F.updated_at||new Date().toISOString(),created_by:q.user.id,assigned_team:(Y==null?void 0:Y.map(Me=>Me.employee_id))||[],customer:R?{company_name:R.company_name,contact_person:R.contact_person,email:R.email,phone:R.phone}:{company_name:"Unbekannter Kunde",contact_person:"Nicht verfügbar",email:"nicht-verfuegbar@example.com",phone:void 0},stats:{total_hours_logged:M>0?M:45.5,total_material_cost:z>0?z:2850,total_project_cost:le||Z||12750,budget_utilization:de>0?de:68,days_active:wt,days_remaining:me,team_size:(Y==null?void 0:Y.length)||3,documents_count:(oe==null?void 0:oe.length)||8,comments_count:(U==null?void 0:U.length)||12,last_activity:new Date().toISOString()},recent_activities:[],team_members:(Y==null?void 0:Y.length)>0?Y.map(Me=>({id:Me.employee_id,name:`${Me.employees.first_name} ${Me.employees.last_name}`.trim(),role:"team_member",email:Me.employees.email,hours_this_week:0})):[{id:"demo_1",name:"Max Mustermann",role:"projektleiter",email:"max@example.com",hours_this_week:32.5},{id:"demo_2",name:"Anna Schmidt",role:"admin",email:"anna@example.com",hours_this_week:28}],permissions:H1("admin",!0)},Se="admin";d(Se),h(H1(Se,!0));const Ze=[];if(U&&U.length>0){const{data:Me}=await $.from("project_comments").select("id, content, created_at, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(5);Me&&Me.forEach(Ne=>{Ze.push({id:`comment_${Ne.id}`,project_id:n,event_type:"comment",title:"Neuer Kommentar hinzugefügt",description:Ne.content.substring(0,100)+(Ne.content.length>100?"...":""),user_name:`${Ne.profiles.first_name} ${Ne.profiles.last_name}`,user_role:"team_member",timestamp:Ne.created_at})})}if(D&&D.length>0){const{data:Me}=await $.from("time_entries").select("id, hours_worked, work_date, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(3);Me&&Me.forEach(Ne=>{Ze.push({id:`time_${Ne.id}`,project_id:n,event_type:"time",title:"Arbeitszeit erfasst",description:`${Ne.hours_worked}h am ${new Date(Ne.work_date).toLocaleDateString("de-DE")}`,user_name:`${Ne.profiles.first_name} ${Ne.profiles.last_name}`,user_role:"team_member",timestamp:Ne.work_date})})}if(X&&X.length>0){const{data:Me}=await $.from("material_entries").select("id, material_name, quantity, total_cost, created_at, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(3);Me&&Me.forEach(Ne=>{Ze.push({id:`material_${Ne.id}`,project_id:n,event_type:"material",title:"Material hinzugefügt",description:`${Ne.material_name} (${Ne.quantity}x) - ${Ne.total_cost}€`,user_name:`${Ne.profiles.first_name} ${Ne.profiles.last_name}`,user_role:"team_member",timestamp:Ne.created_at})})}Ze.sort((Me,Ne)=>new Date(Ne.timestamp).getTime()-new Date(Me.timestamp).getTime()),je.recent_activities=Ze.length>0?Ze.slice(0,10):[{id:"demo_activity_1",project_id:n,event_type:"comment",title:"Neuer Kommentar hinzugefügt",description:"Materiallieferung für Freitag geplant",user_name:"Max Mustermann",user_role:"projektleiter",timestamp:new Date(Date.now()-2*60*60*1e3).toISOString()},{id:"demo_activity_2",project_id:n,event_type:"document",title:"Dokument hochgeladen",description:"Bauplan_Final.pdf",user_name:"Anna Schmidt",user_role:"admin",timestamp:new Date(Date.now()-6*60*60*1e3).toISOString()}],i(je)}catch(q){console.error("Error fetching project data:",q),s({title:"Fehler",description:"Projektdaten konnten nicht geladen werden",variant:"destructive"})}finally{l(!1)}},k=async()=>{var q;try{const{data:O}=await $.auth.getUser();if(!(O!=null&&O.user))return;const{data:F}=await $.from("profiles").select("company_id").eq("id",O.user.id).single();if(!(F!=null&&F.company_id))return;const{data:B}=await $.from("employees").select("id, first_name, last_name, email, position, status").eq("company_id",F.company_id).eq("status","active"),R=((q=a==null?void 0:a.team_members)==null?void 0:q.map(M=>M.id))||[];let D=[];const L=new Date().toISOString().split("T")[0];for(const M of B||[]){if(R.includes(M.id))continue;const{data:X}=await $.from("vacation_requests").select("*").eq("employee_id",M.id).in("status",["approved","pending"]).lte("start_date",L).gte("end_date",L);if(X&&X.length>0){D.push({...M,availability_status:"unavailable",reason:X[0].request_type==="vacation"?"Im Urlaub":"Krankgemeldet"});continue}const{data:K}=await $.from("project_team_members").select("project_id, projects!inner(start_date, end_date, name, status)").eq("employee_id",M.id).neq("project_id",n).in("projects.status",["in_bearbeitung","geplant"]);(K==null?void 0:K.some(Y=>{const ae=Y.projects.start_date,U=Y.projects.end_date,Q=a==null?void 0:a.start_date,oe=a==null?void 0:a.end_date;return!ae||!U||!Q||!oe?!1:ae<=oe&&U>=Q}))?D.push({...M,availability_status:"busy",reason:`In ${K==null?void 0:K.length} anderen Projekten`}):D.push({...M,availability_status:"available",reason:"Verfügbar"})}S(D)}catch(O){console.error("Error loading available employees:",O)}},E=async q=>{try{const O=j.find(R=>R.id===q);if(!O)return;const F={id:q,name:`${O.first_name} ${O.last_name}`.trim(),role:O.position||"team_member",email:O.email,hours_this_week:0};i(R=>R?{...R,team_members:[...R.team_members||[],F]}:null),S(R=>R.filter(D=>D.id!==q)),w(!1);const{error:B}=await $.from("project_team_members").insert({project_id:n,employee_id:q,assigned_at:new Date().toISOString()});if(B){console.error("Error adding team member:",B),i(R=>R?{...R,team_members:R.team_members.filter(D=>D.id!==q)}:null),S(R=>[...R,O]),s({title:"Fehler",description:"Team-Mitglied konnte nicht hinzugefügt werden",variant:"destructive"});return}s({title:"Erfolg",description:"Team-Mitglied wurde erfolgreich hinzugefügt"})}catch(O){console.error("Error adding team member:",O),s({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}},P=async q=>{try{const O=a==null?void 0:a.team_members.find(B=>B.id===q);if(!O)return;i(B=>B?{...B,team_members:B.team_members.filter(R=>R.id!==q)}:null);const{error:F}=await $.from("project_team_members").delete().eq("project_id",n).eq("employee_id",q);if(F){console.error("Error removing team member:",F),i(B=>B?{...B,team_members:[...B.team_members,O]}:null),s({title:"Fehler",description:"Team-Mitglied konnte nicht entfernt werden",variant:"destructive"});return}s({title:"Erfolg",description:"Team-Mitglied wurde erfolgreich entfernt"})}catch(O){console.error("Error removing team member:",O),s({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}},A=async q=>{if(!(!a||!u.can_change_status))try{const{error:O}=await $.from("projects").update({status:q}).eq("id",a.id);if(O)throw O;i(F=>F?{...F,status:q}:null),s({title:"Erfolg",description:"Projektstatus wurde aktualisiert"})}catch{s({title:"Fehler",description:"Status konnte nicht geändert werden",variant:"destructive"})}},C=q=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(q),T=q=>new Date(q).toLocaleDateString("de-DE"),I=q=>new Date(q).toLocaleString("de-DE"),V=q=>V1[q]||V1.geplant,ne=q=>`P${q.split("-").join("").substring(0,6).toUpperCase()}`;if(o)return r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsx(Pt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Projektdaten werden geladen..."})]})})})});if(!a)return r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsx(Pt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full",children:r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Xn,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Projekt nicht gefunden"}),r.jsx("p",{className:"text-gray-600",children:"Das angeforderte Projekt konnte nicht geladen werden."}),r.jsx(W,{onClick:e,className:"mt-4",children:"Schließen"})]})})});const se=V(a.status);return console.log("Project status:",a.status,"Status config:",se),r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:[r.jsxs(cr,{value:m,onValueChange:p,className:"w-full",children:[r.jsxs(Bt,{className:"pb-2",children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsxs("div",{children:[r.jsxs(Lt,{className:"text-2xl flex items-center gap-2",children:[r.jsx(As,{className:"h-6 w-6"}),a.project_name]}),r.jsxs(Nn,{className:"flex items-center gap-4 mt-1",children:[r.jsxs(Ae,{className:`${se.bgColor} ${se.color} text-sm`,children:[se.icon," ",se.label]}),r.jsxs("span",{className:"text-gray-500",children:["ID: ",ne(a.id)]})]})]}),r.jsx("div",{className:"flex items-center gap-4",children:r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Budget / Genutzt"}),r.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[C(a.budget||0)," / ",C(a.stats.total_project_cost||0)]})]})})]}),r.jsxs(tr,{className:"grid w-full grid-cols-5 mb-4",children:[r.jsx(Oe,{value:"overview",children:"Übersicht"}),r.jsx(Oe,{value:"time",children:"Zeiten"}),r.jsx(Oe,{value:"materials",children:"Material"}),r.jsx(Oe,{value:"documents",children:"Dokumente"}),r.jsx(Oe,{value:"comments",children:"Kommentare"})]})]}),r.jsxs(Fe,{value:"overview",className:"space-y-4 min-h-[600px] mt-0",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Gesamtstunden"}),r.jsxs("p",{className:"text-2xl font-bold",children:[a.stats.total_hours_logged,"h"]})]}),r.jsx(Ht,{className:"h-8 w-8 text-blue-500"})]})})}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Materialkosten"}),r.jsx("p",{className:"text-2xl font-bold",children:C(a.stats.total_material_cost)})]}),r.jsx(Db,{className:"h-8 w-8 text-green-500"})]})})}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Budget-Nutzung"}),r.jsxs("p",{className:"text-2xl font-bold",children:[a.stats.budget_utilization,"%"]})]}),r.jsx(Xn,{className:`h-8 w-8 ${a.stats.budget_utilization>80?"text-red-500":"text-yellow-500"}`})]})})}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Team-Größe"}),r.jsx("p",{className:"text-2xl font-bold",children:a.stats.team_size})]}),r.jsx(Oa,{className:"h-8 w-8 text-purple-500"})]})})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Projektdetails"})}),r.jsxs(te,{className:"space-y-4",children:[r.jsx("div",{className:"flex items-center justify-between mb-4",children:r.jsxs("div",{className:"flex items-center gap-6",children:[r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Start:"})," ",T(a.start_date)]}),r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Ende:"})," ",T(a.planned_end_date)]})]})}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Standort"}),r.jsxs("p",{className:"font-medium flex items-center gap-2",children:[r.jsx(la,{className:"h-4 w-4"}),a.project_address]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Verbleibende Tage"}),r.jsxs("p",{className:"font-medium",children:[a.stats.days_remaining," Tage"]})]})]})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Kundeninformationen"})}),r.jsxs(te,{className:"space-y-3",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Unternehmen"}),r.jsx("p",{className:"font-medium",children:a.customer.company_name})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Ansprechpartner"}),r.jsx("p",{className:"font-medium",children:a.customer.contact_person})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Tn,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-sm",children:a.customer.email})]}),a.customer.phone&&r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Rc,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-sm",children:a.customer.phone})]})]})]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center justify-between",children:["Team-Mitglieder",u.can_manage_team&&r.jsxs(W,{size:"sm",variant:"outline",onClick:()=>{k(),w(!0)},children:[r.jsx(zt,{className:"h-4 w-4 mr-1"}),"Hinzufügen"]})]})}),r.jsx(te,{className:"space-y-3",children:a.team_members.map(q=>r.jsx(J,{className:"shadow-soft rounded-2xl overflow-hidden",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{children:r.jsx("p",{className:"font-medium",children:q.name})}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-sm font-medium",children:[q.hours_this_week,"h"]}),r.jsx("p",{className:"text-xs text-gray-500",children:"diese Woche"})]}),u.can_manage_team&&r.jsx(W,{size:"sm",variant:"ghost",onClick:()=>P(q.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:r.jsx(Mn,{className:"h-4 w-4"})})]})]})})},q.id))})]}),u.can_change_status&&r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Status ändern"})}),r.jsxs(te,{className:"space-y-2",children:[se.previousStates&&se.previousStates.length>0&&r.jsxs(r.Fragment,{children:[se.previousStates.map(q=>{const O=V(q);return r.jsxs(W,{variant:"outline",size:"sm",className:"w-full justify-start text-gray-600",onClick:()=>A(q),children:[r.jsx("span",{className:"mr-2",children:"←"})," Zurück zu ",O.label]},q)}),se.nextStates.length>0&&r.jsx("div",{className:"border-t my-2"})]}),se.nextStates.map(q=>{const O=V(q);return r.jsxs(W,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>A(q),children:[O.icon," ",O.label]},q)})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Letzte Aktivitäten"})}),r.jsx(te,{className:"space-y-3",children:a.recent_activities.map(q=>r.jsxs("div",{className:"border-l-2 border-blue-200 pl-3",children:[r.jsx("p",{className:"text-sm font-medium",children:q.title}),r.jsx("p",{className:"text-xs text-gray-600",children:q.description}),r.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[r.jsx("span",{className:"text-xs text-gray-500",children:q.user_name}),r.jsx("span",{className:"text-xs text-gray-400",children:"•"}),r.jsx("span",{className:"text-xs text-gray-500",children:I(q.timestamp)})]})]},q.id))})]})]})]})]}),r.jsxs(Fe,{value:"time",className:"space-y-4 min-h-[600px] mt-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Zeiterfassung"}),u.can_add_time&&r.jsxs(W,{onClick:()=>x(!0),children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Zeit erfassen"]})]}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsx("p",{className:"text-gray-500",children:"Zeiteinträge werden hier angezeigt..."})})})]}),r.jsxs(Fe,{value:"materials",className:"space-y-4 min-h-[600px] mt-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Materialverwaltung"}),u.can_add_materials&&r.jsxs(W,{onClick:()=>y(!0),children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsx("p",{className:"text-gray-500",children:"Materialeinträge werden hier angezeigt..."})})})]}),r.jsxs(Fe,{value:"documents",className:"space-y-4 min-h-[600px] mt-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Dokumente"}),u.can_upload_files&&r.jsxs(W,{children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Datei hochladen"]})]}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsx("p",{className:"text-gray-500",children:"Projektdokumente werden hier angezeigt..."})})})]}),r.jsxs(Fe,{value:"comments",className:"space-y-4 min-h-[600px] mt-0",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Kommentare & Notizen"}),r.jsxs(W,{children:[r.jsx(yf,{className:"h-4 w-4 mr-2"}),"Kommentar hinzufügen"]})]}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsx("p",{className:"text-gray-500",children:"Projektkommentare werden hier angezeigt..."})})})]})]}),r.jsx(mQ,{isOpen:b,onClose:()=>x(!1),projectId:a.id,onTimeEntryAdded:q=>{console.log("Time entry added:",q),s({title:"Erfolg",description:"Arbeitszeit wurde erfasst"})}}),r.jsx(fQ,{isOpen:g,onClose:()=>y(!1),projectId:a.id,onMaterialEntryAdded:q=>{console.log("Material entry added:",q),s({title:"Erfolg",description:"Material wurde erfasst"})}}),v&&r.jsx(Mt,{open:v,onOpenChange:w,children:r.jsxs(Pt,{children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Team-Mitglied hinzufügen"}),r.jsx(Nn,{children:"Wählen Sie einen Mitarbeiter aus, der dem Projekt hinzugefügt werden soll."})]}),r.jsx("div",{className:"space-y-4",children:j.length===0?r.jsx("p",{className:"text-sm text-gray-500",children:"Keine verfügbaren Mitarbeiter gefunden oder alle sind bereits dem Projekt zugewiesen."}):r.jsx("div",{className:"space-y-2",children:j.map(q=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:`w-3 h-3 rounded-full ${q.availability_status==="available"?"bg-green-500":q.availability_status==="busy"?"bg-yellow-500":"bg-red-500"}`,title:q.reason})}),r.jsxs("div",{children:[r.jsxs("p",{className:"font-medium",children:[q.first_name," ",q.last_name]}),r.jsxs("p",{className:"text-sm text-gray-500",children:[q.position,r.jsxs("span",{className:`ml-2 text-xs ${q.availability_status==="available"?"text-green-600":q.availability_status==="busy"?"text-yellow-600":"text-red-600"}`,children:["• ",q.reason]})]})]})]}),r.jsx(W,{size:"sm",onClick:()=>E(q.id),children:r.jsx(zt,{className:"h-4 w-4"})})]},q.id))})})]})})]})})},xQ=({isOpen:t,onClose:e,projectId:n,projectName:s,customerId:a,onCalculationSaved:i})=>{const{toast:o}=pt(),[l,c]=f.useState({projectId:n,projectName:s,customerId:a,materials:[],labor:[],subcontractors:[],travelCosts:0,travelDescription:"",safetyBuffer:10,profitMargin:20,materialCosts:0,laborCosts:0,subcontractorCosts:0,totalBaseCosts:0,totalCostsWithBuffer:0,finalPrice:0,notes:""});f.useEffect(()=>{t&&n&&d()},[t,n]);const d=async()=>{try{const{data:N}=await $.from("projects").select("description").eq("id",n).single();if(N!=null&&N.description){const k=N.description.match(/\[PRECALC:(.*?)\]/);if(k)try{const E=JSON.parse(k[1]);console.log("📊 Loading existing calculation:",E),c(P=>({...P,...E,projectId:n,projectName:s,customerId:a})),o({title:"Bestehende Kalkulation geladen",description:"Die vorhandene Vor-Kalkulation wurde geladen."})}catch(E){console.warn("Error parsing existing calculation:",E)}}}catch(N){console.error("Error loading existing calculation:",N)}};f.useEffect(()=>{u()},[l.materials,l.labor,l.subcontractors,l.travelCosts,l.safetyBuffer,l.profitMargin]);const u=()=>{const N=l.materials.reduce((T,I)=>{const ne=I.quantity*I.pricePerUnit*(1+I.markup/100);return T+ne},0),k=l.labor.reduce((T,I)=>T+I.hours*I.workers*I.hourlyRate,0),E=l.subcontractors.reduce((T,I)=>T+I.cost,0),P=N+k+E+l.travelCosts,A=P*(1+l.safetyBuffer/100),C=A*(1+l.profitMargin/100);c(T=>({...T,materialCosts:N,laborCosts:k,subcontractorCosts:E,totalBaseCosts:P,totalCostsWithBuffer:A,finalPrice:C}))},h=()=>{const N={id:Date.now().toString(),name:"",quantity:1,unit:"Stück",pricePerUnit:0,markup:15,totalCost:0,isEstimate:!1};c(k=>({...k,materials:[...k.materials,N]}))},m=()=>{const N={id:Date.now().toString(),description:"",hours:8,workers:1,hourlyRate:45,totalCost:0,isEstimate:!1};c(k=>({...k,labor:[...k.labor,N]}))},p=()=>{const N={id:Date.now().toString(),description:"",supplier:"",cost:0};c(k=>({...k,subcontractors:[...k.subcontractors,N]}))},b=N=>{c(k=>({...k,materials:k.materials.filter(E=>E.id!==N)}))},x=N=>{c(k=>({...k,labor:k.labor.filter(E=>E.id!==N)}))},g=N=>{c(k=>({...k,subcontractors:k.subcontractors.filter(E=>E.id!==N)}))},y=(N,k,E)=>{c(P=>({...P,materials:P.materials.map(A=>A.id===N?{...A,[k]:E}:A)}))},v=(N,k,E)=>{c(P=>({...P,labor:P.labor.map(A=>A.id===N?{...A,[k]:E}:A)}))},w=(N,k,E)=>{c(P=>({...P,subcontractors:P.subcontractors.map(A=>A.id===N?{...A,[k]:E}:A)}))},j=async()=>{try{const N={...l,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if((l.isEstimate||l.materials.some(T=>T.isEstimate))&&!await Vz({projectId:n,estimate:N,userId:void 0}))return;const k=`[PRECALC:${JSON.stringify(N)}]`,E={},{data:P}=await $.from("projects").select("description, budget").eq("id",n).single();let A=k;P!=null&&P.description&&!P.description.includes("[PRECALC:")?A=`${P.description} ${k}`:P!=null&&P.description&&P.description.includes("[PRECALC:")&&(A=P.description.replace(/\[PRECALC:.*?\]/,k)),E.description=A,E.budget=Math.round(l.finalPrice),console.log("💰 Setting project budget to:",E.budget);const{error:C}=await $.from("projects").update(E).eq("id",n);if(C)throw C;o({title:"Vor-Kalkulation gespeichert",description:`Budget wurde auf €${l.finalPrice.toFixed(2)} gesetzt`}),i==null||i(N),e()}catch(N){console.error("Error saving pre-calculation:",N),o({title:"Fehler",description:"Vor-Kalkulation konnte nicht gespeichert werden",variant:"destructive"})}},S=N=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(N);return r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(Bt,{children:[r.jsxs(Lt,{className:"flex items-center gap-2",children:[r.jsx(ws,{className:"h-5 w-5"}),"Vor-Kalkulation: ",s]}),r.jsx(Nn,{children:"Detaillierte Kostenberechnung für das Projekt erstellen"})]}),r.jsxs(cr,{defaultValue:"materials",className:"w-full",children:[r.jsxs(tr,{className:"grid w-full grid-cols-5",children:[r.jsx(Oe,{value:"materials",children:"Material"}),r.jsx(Oe,{value:"labor",children:"Arbeitszeit"}),r.jsx(Oe,{value:"subcontractors",children:"Fremdleistungen"}),r.jsx(Oe,{value:"costs",children:"Zusatzkosten"}),r.jsx(Oe,{value:"summary",children:"Zusammenfassung"})]}),r.jsxs(Fe,{value:"materials",className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Materialkosten"}),r.jsxs(W,{onClick:h,size:"sm",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),r.jsxs("div",{className:"space-y-4",children:[l.materials.map((N,k)=>r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"grid grid-cols-8 gap-4 items-center",children:[r.jsxs("div",{children:[r.jsx(H,{children:"Material"}),r.jsx(G,{value:N.name,onChange:E=>y(N.id,"name",E.target.value),placeholder:"z.B. Fliesen 30x30cm"})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Menge"}),r.jsx(G,{type:"number",value:N.quantity,onChange:E=>y(N.id,"quantity",parseFloat(E.target.value)||0)})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Einheit"}),r.jsxs(tt,{value:N.unit,onValueChange:E=>y(N.id,"unit",E),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Stück",children:"Stück"}),r.jsx(ce,{value:"m²",children:"m²"}),r.jsx(ce,{value:"m",children:"m"}),r.jsx(ce,{value:"kg",children:"kg"}),r.jsx(ce,{value:"l",children:"l"}),r.jsx(ce,{value:"Paket",children:"Paket"})]})]})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Preis/Einheit"}),r.jsx(G,{type:"number",step:"0.01",value:N.pricePerUnit,onChange:E=>y(N.id,"pricePerUnit",parseFloat(E.target.value)||0)})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Aufschlag %"}),r.jsx(G,{type:"number",value:N.markup,onChange:E=>y(N.id,"markup",parseFloat(E.target.value)||0)})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Gesamt"}),r.jsx("div",{className:"font-bold",children:S(N.quantity*N.pricePerUnit*(1+N.markup/100))})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Schätzung"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(aa,{checked:N.isEstimate,onCheckedChange:E=>y(N.id,"isEstimate",E)}),r.jsx("span",{className:"text-sm text-gray-600",children:N.isEstimate?"Schätzung":"Bestätigt"})]})]}),r.jsx("div",{children:r.jsx(W,{variant:"outline",size:"sm",onClick:()=>b(N.id),className:"text-red-600",children:r.jsx(ra,{className:"h-4 w-4"})})})]})})},N.id)),l.materials.length===0&&r.jsx("div",{className:"text-center text-gray-500 py-8",children:'Noch keine Materialien hinzugefügt. Klicken Sie auf "Material hinzufügen" um zu beginnen.'})]}),r.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-semibold",children:"Gesamte Materialkosten:"}),r.jsx("span",{className:"text-xl font-bold text-blue-600",children:S(l.materialCosts)})]})})]}),r.jsxs(Fe,{value:"labor",className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Arbeitszeit & Lohnkosten"}),r.jsxs(W,{onClick:m,size:"sm",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Arbeitsposition hinzufügen"]})]}),r.jsxs("div",{className:"space-y-4",children:[l.labor.map(N=>r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"grid grid-cols-7 gap-4 items-center",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx(H,{children:"Arbeitsposition"}),r.jsx(G,{value:N.description,onChange:k=>v(N.id,"description",k.target.value),placeholder:"z.B. Fliesen verlegen"})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Stunden"}),r.jsx(G,{type:"number",step:"0.5",value:N.hours,onChange:k=>v(N.id,"hours",parseFloat(k.target.value)||0)})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Personen"}),r.jsx(G,{type:"number",value:N.workers,onChange:k=>v(N.id,"workers",parseInt(k.target.value)||1)})]}),r.jsxs("div",{children:[r.jsx(H,{children:"€/Stunde"}),r.jsx(G,{type:"number",step:"0.01",value:N.hourlyRate,onChange:k=>v(N.id,"hourlyRate",parseFloat(k.target.value)||0)})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Gesamt"}),r.jsx("div",{className:"font-bold",children:S(N.hours*N.workers*N.hourlyRate)})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Schätzung"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(aa,{checked:N.isEstimate,onCheckedChange:k=>v(N.id,"isEstimate",k)}),r.jsx("span",{className:"text-sm text-gray-600",children:N.isEstimate?"Schätzung":"Bestätigt"})]}),r.jsx(W,{variant:"outline",size:"sm",onClick:()=>x(N.id),className:"text-red-600 mt-2",children:r.jsx(ra,{className:"h-4 w-4"})})]})]})})},N.id)),l.labor.length===0&&r.jsx("div",{className:"text-center text-gray-500 py-8",children:"Noch keine Arbeitspositionen hinzugefügt."})]}),r.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-semibold",children:"Gesamte Lohnkosten:"}),r.jsx("span",{className:"text-xl font-bold text-green-600",children:S(l.laborCosts)})]})})]}),r.jsxs(Fe,{value:"subcontractors",className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Fremdleistungen & Subunternehmer"}),r.jsxs(W,{onClick:p,size:"sm",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Fremdleistung hinzufügen"]})]}),r.jsxs("div",{className:"space-y-4",children:[l.subcontractors.map(N=>r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[r.jsxs("div",{className:"col-span-2",children:[r.jsx(H,{children:"Leistung"}),r.jsx(G,{value:N.description,onChange:k=>w(N.id,"description",k.target.value),placeholder:"z.B. Elektroinstallation"})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Anbieter"}),r.jsx(G,{value:N.supplier,onChange:k=>w(N.id,"supplier",k.target.value),placeholder:"Firma/Name"})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Kosten"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(G,{type:"number",step:"0.01",value:N.cost,onChange:k=>w(N.id,"cost",parseFloat(k.target.value)||0)}),r.jsx(W,{variant:"outline",size:"sm",onClick:()=>g(N.id),className:"text-red-600",children:r.jsx(ra,{className:"h-4 w-4"})})]})]})]})})},N.id)),l.subcontractors.length===0&&r.jsx("div",{className:"text-center text-gray-500 py-8",children:"Noch keine Fremdleistungen hinzugefügt."})]}),r.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{className:"font-semibold",children:"Gesamte Fremdleistungen:"}),r.jsx("span",{className:"text-xl font-bold text-purple-600",children:S(l.subcontractorCosts)})]})})]}),r.jsxs(Fe,{value:"costs",className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Zusatzkosten & Zuschläge"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Fahrtkosten"})}),r.jsxs(te,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{children:"Beschreibung"}),r.jsx(G,{value:l.travelDescription,onChange:N=>c(k=>({...k,travelDescription:N.target.value})),placeholder:"z.B. 50km Anfahrt × 2 Fahrten"})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Kosten"}),r.jsx(G,{type:"number",step:"0.01",value:l.travelCosts,onChange:N=>c(k=>({...k,travelCosts:parseFloat(N.target.value)||0}))})]})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Zuschläge & Margen"})}),r.jsxs(te,{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{children:"Sicherheitszuschlag (%)"}),r.jsx(G,{type:"number",value:l.safetyBuffer,onChange:N=>c(k=>({...k,safetyBuffer:parseFloat(N.target.value)||0}))}),r.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Üblich: 5-15% für unvorhergesehene Kosten"})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Gewinnmarge (%)"}),r.jsx(G,{type:"number",value:l.profitMargin,onChange:N=>c(k=>({...k,profitMargin:parseFloat(N.target.value)||0}))}),r.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Üblich: 15-25% je nach Wettbewerb"})]})]})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Notizen & Bemerkungen"})}),r.jsx(te,{children:r.jsx(an,{value:l.notes,onChange:N=>c(k=>({...k,notes:N.target.value})),placeholder:"Zusätzliche Hinweise zur Kalkulation...",rows:4})})]})]}),r.jsxs(Fe,{value:"summary",className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Kalkulationsergebnis"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Kostenaufstellung"})}),r.jsxs(te,{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Materialkosten:"}),r.jsx("span",{className:"font-medium",children:S(l.materialCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Lohnkosten:"}),r.jsx("span",{className:"font-medium",children:S(l.laborCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fremdleistungen:"}),r.jsx("span",{className:"font-medium",children:S(l.subcontractorCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fahrtkosten:"}),r.jsx("span",{className:"font-medium",children:S(l.travelCosts)})]}),r.jsx("hr",{}),r.jsxs("div",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Grundkosten:"}),r.jsx("span",{children:S(l.totalBaseCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:["+ Sicherheit (",l.safetyBuffer,"%):"]}),r.jsx("span",{children:S(l.totalCostsWithBuffer-l.totalBaseCosts)})]}),r.jsxs("div",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Kosten mit Puffer:"}),r.jsx("span",{children:S(l.totalCostsWithBuffer)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsxs("span",{children:["+ Gewinn (",l.profitMargin,"%):"]}),r.jsx("span",{children:S(l.finalPrice-l.totalCostsWithBuffer)})]}),r.jsx("hr",{className:"border-2"}),r.jsxs("div",{className:"flex justify-between text-xl font-bold text-green-600",children:[r.jsx("span",{children:"Verkaufspreis:"}),r.jsx("span",{children:S(l.finalPrice)})]})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Kennzahlen"})}),r.jsxs(te,{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Materialanteil:"}),r.jsxs("span",{children:[(l.materialCosts/l.totalBaseCosts*100||0).toFixed(1),"%"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Lohnanteil:"}),r.jsxs("span",{children:[(l.laborCosts/l.totalBaseCosts*100||0).toFixed(1),"%"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fremdleistungsanteil:"}),r.jsxs("span",{children:[(l.subcontractorCosts/l.totalBaseCosts*100||0).toFixed(1),"%"]})]}),r.jsx("hr",{}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Deckungsbeitrag:"}),r.jsx("span",{className:"font-medium",children:S(l.finalPrice-l.totalBaseCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Deckungsgrad:"}),r.jsxs("span",{children:[((l.finalPrice/l.totalBaseCosts-1)*100||0).toFixed(1),"%"]})]})]})]})]}),l.notes&&r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Notizen"})}),r.jsx(te,{children:r.jsx("div",{className:"whitespace-pre-wrap text-sm",children:l.notes})})]})]})]}),r.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[r.jsx(W,{variant:"outline",onClick:e,children:"Abbrechen"}),r.jsx("div",{className:"flex gap-2",children:r.jsxs(W,{onClick:j,className:"flex items-center gap-2",children:[r.jsx(wf,{className:"h-4 w-4"}),"Kalkulation speichern"]})})]})]})})};function gQ(t,e=[]){let n=[];function s(i,o){const l=f.createContext(o),c=n.length;n=[...n,o];function d(h){const{scope:m,children:p,...b}=h,x=(m==null?void 0:m[t][c])||l,g=f.useMemo(()=>b,Object.values(b));return r.jsx(x.Provider,{value:g,children:p})}function u(h,m){const p=(m==null?void 0:m[t][c])||l,b=f.useContext(p);if(b)return b;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return d.displayName=i+"Provider",[d,u]}const a=()=>{const i=n.map(o=>f.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return f.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return a.scopeName=t,[s,vQ(a,...e)]}function vQ(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const s=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return f.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var ij="Progress",oj=100,[yQ,Bee]=gQ(ij),[bQ,wQ]=yQ(ij),qT=f.forwardRef((t,e)=>{const{__scopeProgress:n,value:s=null,max:a,getValueLabel:i=jQ,...o}=t;(a||a===0)&&!E2(a)&&console.error(_Q(`${a}`,"Progress"));const l=E2(a)?a:oj;s!==null&&!A2(s,l)&&console.error(NQ(`${s}`,"Progress"));const c=A2(s,l)?s:null,d=Xf(c)?i(c,l):void 0;return r.jsx(bQ,{scope:n,value:c,max:l,children:r.jsx(Le.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":Xf(c)?c:void 0,"aria-valuetext":d,role:"progressbar","data-state":VT(c,l),"data-value":c??void 0,"data-max":l,...o,ref:e})})});qT.displayName=ij;var WT="ProgressIndicator",HT=f.forwardRef((t,e)=>{const{__scopeProgress:n,...s}=t,a=wQ(WT,n);return r.jsx(Le.div,{"data-state":VT(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...s,ref:e})});HT.displayName=WT;function jQ(t,e){return`${Math.round(t/e*100)}%`}function VT(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function Xf(t){return typeof t=="number"}function E2(t){return Xf(t)&&!isNaN(t)&&t>0}function A2(t,e){return Xf(t)&&!isNaN(t)&&t<=e&&t>=0}function _Q(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${oj}\`.`}function NQ(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${oj} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var KT=qT,SQ=HT;const kc=f.forwardRef(({className:t,value:e,...n},s)=>r.jsx(KT,{ref:s,className:_e("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:r.jsx(SQ,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));kc.displayName=KT.displayName;const kQ=({isOpen:t,onClose:e,projectId:n,projectName:s})=>{const{toast:a}=pt(),[i,o]=f.useState(null),[l,c]=f.useState(null),[d,u]=f.useState(!0);f.useEffect(()=>{t&&n&&h()},[t,n]);const h=async()=>{u(!0);try{const{data:y,error:v}=await $.from("projects").select("*").eq("id",n).single();if(v||!y)throw new Error("Projekt nicht gefunden");let w=null;if(y.description){const V=y.description.match(/\[PRECALC:(.*?)\]/);if(V)try{w=JSON.parse(V[1]),c(w)}catch(ne){console.warn("Fehler beim Parsen der Vor-Kalkulation:",ne)}}const j=[{hours:45,hourlyRate:45,cost:45*45},{hours:12,hourlyRate:55,cost:12*55}],S=[{name:"Fliesen",cost:850},{name:"Kleber",cost:120},{name:"Fugenmasse",cost:75}],N=w||{materialCosts:0,laborCosts:0,subcontractorCosts:0,travelCosts:0,totalBaseCosts:0,finalPrice:y.budget||0,profitMargin:20},k=S.reduce((V,ne)=>V+ne.cost,0),E=j.reduce((V,ne)=>V+ne.cost,0),P=k+E,A=y.budget||N.finalPrice,C=A-P,T=A>0?C/A*100:0,I={project:y,plannedMaterialCosts:N.materialCosts||0,plannedLaborCosts:N.laborCosts||0,plannedSubcontractorCosts:N.subcontractorCosts||0,plannedTravelCosts:N.travelCosts||0,plannedTotalCosts:N.totalBaseCosts||0,plannedPrice:N.finalPrice||0,plannedProfit:(N.finalPrice||0)-(N.totalBaseCosts||0),plannedProfitMargin:N.profitMargin||20,actualMaterialCosts:k,actualLaborCosts:E,actualSubcontractorCosts:0,actualTravelCosts:50,actualTotalCosts:P,actualPrice:A,actualProfit:C,actualProfitMargin:T,materialDeviation:k-(N.materialCosts||0),laborDeviation:E-(N.laborCosts||0),subcontractorDeviation:0,totalCostDeviation:P-(N.totalBaseCosts||0),profitDeviation:C-((N.finalPrice||0)-(N.totalBaseCosts||0)),budgetUtilization:N.totalBaseCosts>0?P/N.totalBaseCosts*100:0,efficiency:N.laborCosts>0?N.laborCosts/E*100:100,status:C>0?"profitable":C===0?"break_even":"loss"};o(I)}catch(y){console.error("Fehler beim Laden der Rentabilitätsdaten:",y),a({title:"Fehler",description:"Rentabilitätsdaten konnten nicht geladen werden",variant:"destructive"})}finally{u(!1)}},m=y=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(y),p=(y,v=1)=>`${y.toFixed(v)}%`,b=y=>y>0?"text-red-600":y<0?"text-green-600":"text-gray-600",x=y=>y>0?r.jsx(Bi,{className:"h-4 w-4 text-red-600"}):y<0?r.jsx(Pb,{className:"h-4 w-4 text-green-600"}):r.jsx(Rn,{className:"h-4 w-4 text-gray-600"}),g=y=>{switch(y){case"profitable":return r.jsx(Ae,{className:"bg-green-100 text-green-800",children:"Rentabel"});case"break_even":return r.jsx(Ae,{className:"bg-yellow-100 text-yellow-800",children:"Break-Even"});case"loss":return r.jsx(Ae,{className:"bg-red-100 text-red-800",children:"Verlust"});default:return r.jsx(Ae,{variant:"outline",children:"Unbekannt"})}};return d?r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsx(Pt,{className:"max-w-4xl",children:r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),r.jsx("p",{className:"mt-2 text-gray-600",children:"Rentabilitätsdaten werden geladen..."})]})})})}):i?r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[r.jsxs(Bt,{children:[r.jsxs(Lt,{className:"flex items-center gap-2",children:[r.jsx(ws,{className:"h-5 w-5"}),"Nachkalkulation & Rentabilität: ",s]}),r.jsxs(Nn,{className:"flex items-center gap-4",children:[r.jsx("span",{children:"Vergleich von geplanten und tatsächlichen Kosten"}),g(i.status)]})]}),r.jsxs(cr,{defaultValue:"overview",className:"w-full",children:[r.jsxs(tr,{className:"grid w-full grid-cols-5",children:[r.jsx(Oe,{value:"overview",children:"Übersicht"}),r.jsx(Oe,{value:"costs",children:"Kostenanalyse"}),r.jsx(Oe,{value:"estimates",children:"Schätzungen vs. Ist"}),r.jsx(Oe,{value:"deviations",children:"Abweichungen"}),r.jsx(Oe,{value:"kpis",children:"Kennzahlen"})]}),r.jsxs(Fe,{value:"overview",className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsxs(J,{children:[r.jsx(pe,{className:"pb-3",children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Db,{className:"h-5 w-5 text-green-600"}),"Gewinn"]})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Geplant:"}),r.jsx("span",{children:m(i.plannedProfit)})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{className:"text-gray-600",children:"Tatsächlich:"}),r.jsx("span",{className:i.actualProfit>=0?"text-green-600 font-semibold":"text-red-600 font-semibold",children:m(i.actualProfit)})]}),r.jsxs("div",{className:"flex justify-between items-center text-sm border-t pt-2",children:[r.jsx("span",{className:"text-gray-600",children:"Abweichung:"}),r.jsxs("div",{className:"flex items-center gap-1",children:[x(i.profitDeviation),r.jsx("span",{className:b(i.profitDeviation),children:m(Math.abs(i.profitDeviation))})]})]})]})})]}),r.jsxs(J,{children:[r.jsx(pe,{className:"pb-3",children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Ds,{className:"h-5 w-5 text-blue-600"}),"Budget-Nutzung"]})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Geplante Kosten:"}),r.jsx("span",{children:m(i.plannedTotalCosts)})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Tatsächliche Kosten:"}),r.jsx("span",{children:m(i.actualTotalCosts)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Auslastung:"}),r.jsx("span",{className:i.budgetUtilization>100?"text-red-600 font-semibold":"text-green-600",children:p(i.budgetUtilization)})]}),r.jsx(kc,{value:Math.min(i.budgetUtilization,100),className:"h-2"})]})]})})]}),r.jsxs(J,{children:[r.jsx(pe,{className:"pb-3",children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Ht,{className:"h-5 w-5 text-purple-600"}),"Arbeitseffizienz"]})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Geplante Stunden:"}),r.jsxs("span",{children:[(i.plannedLaborCosts/45).toFixed(1),"h"]})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Tatsächliche Stunden:"}),r.jsxs("span",{children:[(i.actualLaborCosts/45).toFixed(1),"h"]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Effizienz:"}),r.jsx("span",{className:i.efficiency>=100?"text-green-600 font-semibold":"text-orange-600",children:p(i.efficiency)})]}),r.jsx(kc,{value:Math.min(i.efficiency,100),className:"h-2"})]})]})})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Projekt-Zusammenfassung"})}),r.jsx(te,{children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m(i.actualPrice)}),r.jsx("div",{className:"text-sm text-gray-600",children:"Verkaufspreis"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:m(i.actualTotalCosts)}),r.jsx("div",{className:"text-sm text-gray-600",children:"Gesamtkosten"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:`text-2xl font-bold ${i.actualProfit>=0?"text-green-600":"text-red-600"}`,children:m(i.actualProfit)}),r.jsx("div",{className:"text-sm text-gray-600",children:"Gewinn/Verlust"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:`text-2xl font-bold ${i.actualProfitMargin>=0?"text-green-600":"text-red-600"}`,children:p(i.actualProfitMargin)}),r.jsx("div",{className:"text-sm text-gray-600",children:"Gewinnmarge"})]})]})})]})]}),r.jsx(Fe,{value:"costs",className:"space-y-6",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Geplante Kosten"})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Material:"}),r.jsx("span",{children:m(i.plannedMaterialCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Lohn:"}),r.jsx("span",{children:m(i.plannedLaborCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fremdleistungen:"}),r.jsx("span",{children:m(i.plannedSubcontractorCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fahrtkosten:"}),r.jsx("span",{children:m(i.plannedTravelCosts)})]}),r.jsx("hr",{}),r.jsxs("div",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Gesamt:"}),r.jsx("span",{children:m(i.plannedTotalCosts)})]})]})})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Tatsächliche Kosten"})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Material:"}),r.jsx("span",{children:m(i.actualMaterialCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Lohn:"}),r.jsx("span",{children:m(i.actualLaborCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fremdleistungen:"}),r.jsx("span",{children:m(i.actualSubcontractorCosts)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Fahrtkosten:"}),r.jsx("span",{children:m(i.actualTravelCosts)})]}),r.jsx("hr",{}),r.jsxs("div",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Gesamt:"}),r.jsx("span",{children:m(i.actualTotalCosts)})]})]})})]})]})}),r.jsx(Fe,{value:"estimates",className:"space-y-6",children:r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(ws,{className:"h-5 w-5 text-blue-600"}),"Schätzungen vs. Bestätigte Werte vs. Tatsächlicher Verbrauch"]}),r.jsx(CardDescription,{children:"Vergleich zwischen geschätzten Werten, bestätigten Planungswerten und dem tatsächlichen Materialverbrauch"})]}),r.jsx(te,{children:l?r.jsxs("div",{className:"space-y-6",children:[l.materials&&l.materials.length>0&&r.jsxs("div",{children:[r.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[r.jsx(Ds,{className:"h-4 w-4"}),"Material-Vergleich"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-6 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[r.jsx("span",{children:"Material"}),r.jsx("span",{children:"Geplant"}),r.jsx("span",{children:"Status"}),r.jsx("span",{children:"Tatsächlich"}),r.jsx("span",{children:"Abweichung"}),r.jsx("span",{children:"Typ"})]}),l.materials.map((y,v)=>{const w=v===0?850:v===1?120:95,j=y.quantity*y.pricePerUnit*(1+y.markup/100),S=w-j;return r.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-b",children:[r.jsx("span",{className:"text-sm",children:y.name||"Material "+(v+1)}),r.jsx("span",{className:"text-sm",children:m(j)}),r.jsx("div",{children:y.isEstimate?r.jsx(Ae,{variant:"outline",className:"text-orange-600 border-orange-600 text-xs",children:"Schätzung"}):r.jsx(Ae,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Bestätigt"})}),r.jsx("span",{className:"text-sm",children:m(w)}),r.jsxs("div",{className:"flex items-center gap-1",children:[x(S),r.jsx("span",{className:`text-sm ${b(S)}`,children:m(Math.abs(S))})]}),r.jsxs("span",{className:"text-xs text-gray-500",children:[y.unit," (",y.quantity,"x)"]})]},y.id)})]})]}),l.labor&&l.labor.length>0&&r.jsxs("div",{children:[r.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[r.jsx(Oa,{className:"h-4 w-4"}),"Arbeitszeit-Vergleich"]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"grid grid-cols-6 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[r.jsx("span",{children:"Arbeitsposition"}),r.jsx("span",{children:"Geplant"}),r.jsx("span",{children:"Status"}),r.jsx("span",{children:"Tatsächlich"}),r.jsx("span",{children:"Abweichung"}),r.jsx("span",{children:"Details"})]}),l.labor.map((y,v)=>{const w=v===0?2025:660,j=y.hours*y.workers*y.hourlyRate,S=w-j;return r.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-b",children:[r.jsx("span",{className:"text-sm",children:y.description||"Arbeitsposition "+(v+1)}),r.jsx("span",{className:"text-sm",children:m(j)}),r.jsx("div",{children:y.isEstimate?r.jsx(Ae,{variant:"outline",className:"text-orange-600 border-orange-600 text-xs",children:"Schätzung"}):r.jsx(Ae,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Bestätigt"})}),r.jsx("span",{className:"text-sm",children:m(w)}),r.jsxs("div",{className:"flex items-center gap-1",children:[x(S),r.jsx("span",{className:`text-sm ${b(S)}`,children:m(Math.abs(S))})]}),r.jsxs("span",{className:"text-xs text-gray-500",children:[y.hours,"h × ",y.workers," Pers."]})]},y.id)})]})]}),r.jsxs("div",{className:"mt-6",children:[r.jsx("h4",{className:"font-semibold mb-4",children:"Schätzungsgenauigkeit"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx(J,{className:"bg-orange-50",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:l.materials?l.materials.filter(y=>y.isEstimate).length:0}),r.jsx("div",{className:"text-sm text-orange-700",children:"Material-Schätzungen"})]})})}),r.jsx(J,{className:"bg-green-50",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.materials?l.materials.filter(y=>!y.isEstimate).length:0}),r.jsx("div",{className:"text-sm text-green-700",children:"Bestätigte Materialien"})]})})}),r.jsx(J,{className:"bg-blue-50",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[l.materials&&l.labor?Math.round(100-Math.abs(i.totalCostDeviation)/i.plannedTotalCosts*100):0,"%"]}),r.jsx("div",{className:"text-sm text-blue-700",children:"Gesamt-Genauigkeit"})]})})})]})]}),r.jsx("div",{className:"mt-6",children:r.jsxs(J,{className:"bg-blue-50",children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2 text-blue-700",children:[r.jsx(Xn,{className:"h-5 w-5"}),"Empfehlungen für zukünftige Schätzungen"]})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-2 text-blue-700",children:[r.jsx("p",{children:"• Als Schätzung markierte Positionen sollten vor Projektbeginn noch einmal überprüft werden"}),r.jsx("p",{children:"• Verwenden Sie bestätigte Werte aus ähnlichen abgeschlossenen Projekten"}),r.jsx("p",{children:"• Planen Sie für geschätzte Positionen einen höheren Sicherheitspuffer ein"}),r.jsx("p",{children:"• Dokumentieren Sie Abweichungen zwischen Schätzungen und tatsächlichen Werten für bessere zukünftige Kalkulationen"})]})})]})})]}):r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(ws,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Vor-Kalkulation verfügbar"}),r.jsx("p",{children:"Für dieses Projekt wurde keine detaillierte Vor-Kalkulation mit Schätzungsmarkierungen erstellt."})]})})]})}),r.jsxs(Fe,{value:"deviations",className:"space-y-6",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Kostenabweichungen"})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[r.jsx("span",{children:"Kategorie"}),r.jsx("span",{children:"Geplant"}),r.jsx("span",{children:"Tatsächlich"}),r.jsx("span",{children:"Abweichung"})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[r.jsx("span",{children:"Material"}),r.jsx("span",{children:m(i.plannedMaterialCosts)}),r.jsx("span",{children:m(i.actualMaterialCosts)}),r.jsxs("div",{className:"flex items-center gap-2",children:[x(i.materialDeviation),r.jsx("span",{className:b(i.materialDeviation),children:m(Math.abs(i.materialDeviation))})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[r.jsx("span",{children:"Lohn"}),r.jsx("span",{children:m(i.plannedLaborCosts)}),r.jsx("span",{children:m(i.actualLaborCosts)}),r.jsxs("div",{className:"flex items-center gap-2",children:[x(i.laborDeviation),r.jsx("span",{className:b(i.laborDeviation),children:m(Math.abs(i.laborDeviation))})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center border-t pt-2",children:[r.jsx("span",{className:"font-semibold",children:"Gesamtabweichung"}),r.jsx("span",{className:"font-semibold",children:m(i.plannedTotalCosts)}),r.jsx("span",{className:"font-semibold",children:m(i.actualTotalCosts)}),r.jsxs("div",{className:"flex items-center gap-2",children:[x(i.totalCostDeviation),r.jsx("span",{className:`font-semibold ${b(i.totalCostDeviation)}`,children:m(Math.abs(i.totalCostDeviation))})]})]})]})})]}),i.totalCostDeviation>0&&r.jsxs(J,{className:"border-red-200 bg-red-50",children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2 text-red-700",children:[r.jsx(Xn,{className:"h-5 w-5"}),"Kostenüberschreitung"]})}),r.jsx(te,{children:r.jsxs("p",{className:"text-red-700",children:["Das Projekt hat die geplanten Kosten um ",m(i.totalCostDeviation)," überschritten. Das entspricht einer Überschreitung von ",p(i.totalCostDeviation/i.plannedTotalCosts*100),"."]})})]})]}),r.jsxs(Fe,{value:"kpis",className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Rentabilitäts-KPIs"})}),r.jsxs(te,{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Gewinnmarge (geplant):"}),r.jsx("span",{className:"font-semibold",children:p(i.plannedProfitMargin)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Gewinnmarge (tatsächlich):"}),r.jsx("span",{className:`font-semibold ${i.actualProfitMargin>=0?"text-green-600":"text-red-600"}`,children:p(i.actualProfitMargin)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"ROI (Return on Investment):"}),r.jsx("span",{className:`font-semibold ${i.actualProfit>=0?"text-green-600":"text-red-600"}`,children:p(i.actualProfit/i.actualTotalCosts*100)})]})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Effizienz-KPIs"})}),r.jsxs(te,{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Budget-Ausschöpfung:"}),r.jsx("span",{className:`font-semibold ${i.budgetUtilization>100?"text-red-600":"text-green-600"}`,children:p(i.budgetUtilization)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Arbeitseffizienz:"}),r.jsx("span",{className:`font-semibold ${i.efficiency>=100?"text-green-600":"text-orange-600"}`,children:p(i.efficiency)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Kostengenauigkeit:"}),r.jsx("span",{className:"font-semibold",children:p(100-Math.abs(i.totalCostDeviation/i.plannedTotalCosts*100))})]})]})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Empfehlungen für zukünftige Projekte"})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-3",children:[i.materialDeviation>i.plannedMaterialCosts*.1&&r.jsxs("div",{className:"flex items-start gap-3 p-3 bg-yellow-50 rounded-lg",children:[r.jsx(Xn,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-yellow-800",children:"Materialkosten-Planung verbessern"}),r.jsxs("div",{className:"text-sm text-yellow-700",children:["Materialkosten waren ",p(i.materialDeviation/i.plannedMaterialCosts*100)," höher als geplant. Prüfen Sie Ihre Lieferantenpreise und Mengenschätzungen."]})]})]}),i.efficiency<90&&r.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[r.jsx(Ht,{className:"h-5 w-5 text-blue-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-blue-800",children:"Arbeitsplanung optimieren"}),r.jsxs("div",{className:"text-sm text-blue-700",children:["Die Arbeitseffizienz lag bei nur ",p(i.efficiency),". Überprüfen Sie die Zeitschätzungen und Arbeitsabläufe."]})]})]}),i.actualProfitMargin>i.plannedProfitMargin*1.2&&r.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[r.jsx(Rn,{className:"h-5 w-5 text-green-600 mt-0.5"}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-green-800",children:"Sehr gute Rentabilität"}),r.jsx("div",{className:"text-sm text-green-700",children:"Das Projekt war deutlich rentabler als geplant. Diese Kalkulations-Ansätze können als Vorlage für ähnliche Projekte dienen."})]})]})]})})]})]})]}),r.jsx("div",{className:"flex justify-end pt-4 border-t",children:r.jsx(W,{onClick:e,children:"Schließen"})})]})}):r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsx(Pt,{className:"max-w-4xl",children:r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Xn,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Daten verfügbar"}),r.jsx("p",{className:"text-gray-600",children:"Für dieses Projekt konnten keine Rentabilitätsdaten geladen werden."})]})})})};function CQ({active:t,done:e,budget:n,late:s}){return r.jsxs("section",{"aria-label":"Kennzahlen",className:`sticky top-0 z-10 grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4
                 backdrop-blur-md bg-background/70 border rounded-2xl p-3 shadow-soft`,children:[r.jsx(fm,{title:"Aktive Projekte",value:t}),r.jsx(fm,{title:"Abgeschlossene",value:e}),r.jsx(fm,{title:"Gesamtbudget",value:`€${(n||0).toLocaleString("de-DE")}`}),r.jsx(fm,{title:"Verspätet",value:s})]})}function fm({title:t,value:e}){return r.jsxs("div",{className:"bg-card border rounded-xl px-4 py-3 flex items-center justify-between",children:[r.jsx("div",{className:"text-xs text-muted-foreground font-semibold",children:t}),r.jsx("div",{className:"text-xl font-bold",children:e})]})}function EQ({counts:t}){const e=[{label:"Anfrage",key:"anfrage",dot:"bg-blue-400"},{label:"Termin ausmachen",key:"besichtigung",dot:"bg-sky-400"},{label:"In Planung",key:"geplant",dot:"bg-amber-400"},{label:"In Arbeit",key:"in_bearbeitung",dot:"bg-yellow-400"},{label:"Erledigt",key:"abgeschlossen",dot:"bg-green-500"}];return r.jsx("div",{className:"grid grid-cols-[1fr_auto] gap-2 text-sm",children:e.map(n=>r.jsxs(ge.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:`inline-block w-2.5 h-2.5 rounded-full ${n.dot}`}),r.jsx("span",{children:n.label})]}),r.jsx("span",{className:"font-medium",children:t[n.key]})]},n.key))})}const D2={anfrage:{label:"Anfrage",cls:"bg-purple-100 text-purple-800 border-purple-200"},besichtigung:{label:"Termin ausmachen",cls:"bg-orange-100  text-orange-800  border-orange-200"},geplant:{label:"In Planung",cls:"bg-blue-100   text-blue-800   border-blue-200"},in_bearbeitung:{label:"In Arbeit",cls:"bg-yellow-100 text-yellow-800 border-yellow-200"},abgeschlossen:{label:"Erledigt",cls:"bg-green-100  text-green-800  border-green-200"}};function P2(t){const e=D2[t.status]||D2.geplant,n=s=>s?new Date(s).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"}):"—";return r.jsxs("div",{className:"flex flex-col gap-2 py-2 cursor-pointer",onDoubleClick:t.onOpen,children:[r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${e.cls}`,children:e.label}),r.jsx("strong",{className:"mr-2",children:t.name}),r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-blue-50 text-blue-700 border-blue-200",children:["ID: ",t.id]})]}),r.jsxs("div",{className:"text-sm text-muted-foreground",children:["Start: ",n(t.start)," • Ende: ",n(t.end)," • Budget:"," ",r.jsxs("strong",{className:"text-green-600",children:["€",(t.budget||0).toLocaleString("de-DE")]})]}),typeof t.progress=="number"&&r.jsx("div",{className:"h-2 w-full rounded-full bg-neutral-200 overflow-hidden",children:r.jsx("div",{className:"h-full rounded-full bg-blue-500 transition-all",style:{width:`${t.progress}%`},"aria-valuenow":t.progress,"aria-valuemin":0,"aria-valuemax":100,role:"progressbar"})})]})}const T2=t=>`P${t.split("-").join("").substring(0,6).toUpperCase()}`,fg=t=>{if(!t)return 0;const e=t.match(/\[BUDGET:(\d+\.?\d*)\]/);return e?parseFloat(e[1]):0},AQ=()=>{pt();const{companyId:t}=za(),{data:e,isLoading:n}=zD(),{data:s,isLoading:a}=$D(),[i,o]=f.useState([]),[l,c]=f.useState(!0),d=f.useCallback(async()=>{try{if(c(!0),console.log("ProjectModule: fetchEmployees called with companyId:",t),!t){console.error("ProjectModule: No company ID available"),c(!1);return}const{data:M,error:X}=await $.from("employees").select("id, email, status, user_id, company_id").eq("company_id",t);console.log("ProjectModule: DEBUG - All employees for company:",M);const{data:K,error:z}=await $.from("employees").select(`
          id,
          user_id,
          first_name,
          last_name,
          email,
          phone,
          position,
          status,
          qualifications,
          license
        `).eq("company_id",t).eq("status","Aktiv").order("created_at",{ascending:!1});if(console.log("ProjectModule: Employees query result:",K,z),z){console.error("ProjectModule: Error fetching employees:",z),c(!1);return}const Y=(K==null?void 0:K.filter(Q=>Q.user_id).map(Q=>Q.user_id))||[];let ae=[];if(Y.length>0){const{data:Q,error:oe}=await $.from("profiles").select("id, first_name, last_name").in("id",Y);oe||(ae=Q||[])}const U=(K==null?void 0:K.map(Q=>{const oe=ae.find(Z=>Z.id===Q.user_id),re=(oe==null?void 0:oe.first_name)||Q.first_name||"",le=(oe==null?void 0:oe.last_name)||Q.last_name||"";return{id:Q.id,first_name:re,last_name:le,name:`${re} ${le}`.trim(),email:Q.email,phone:Q.phone,position:Q.position,status:Q.status,qualifications:Q.qualifications||[],license:Q.license,projects:[],user_id:Q.user_id}}).filter(Q=>{const oe=Q.first_name&&Q.first_name.trim().length>0,re=Q.last_name&&Q.last_name.trim().length>0,le=Q.name&&Q.name.trim().length>0&&Q.name.trim()!==" ",Z=oe||re||le;return console.log("ProjectModule: Employee filter check:",{employee:Q.name,hasFirstName:oe,hasLastName:re,hasValidName:le,shouldInclude:Z,user_id:Q.user_id}),Z||console.log("ProjectModule: Filtering out employee without proper name:",Q),Z}))||[];console.log("ProjectModule: Final employee list:",U),o(U)}catch(M){console.error("ProjectModule: fetchEmployees error:",M)}finally{c(!1)}},[t]);f.useEffect(()=>{d()},[d]);const[u,h]=f.useState(!1),[m,p]=f.useState(!1),[b,x]=f.useState(!1),[g,y]=f.useState(!1),[v,w]=f.useState(!1),[j,S]=f.useState(!1),[N,k]=f.useState(null),[E,P]=f.useState(null),A=(e==null?void 0:e.items)||[],C=(s==null?void 0:s.items)||[];console.log("Customers data:",C),console.log("Team members data:",i),console.log("Team members loading:",l);const T=C.length>0?C:[{id:"demo_customer_1",name:"Demo Kunde - Bitte echte Kunden hinzufügen",company_name:"Demo Kunde",contact_person:"Bitte echte Kunden hinzufügen",email:"demo@example.com",phone:"+49 000 000000",address:"Demo Adresse",projects:0,revenue:"0",status:"Demo"}],I=i,V=n||a||l;console.log("ProjectModule Debug:",{projectsResponse:e,projects:A,projectsLoading:n,isLoading:V});const ne={anfrage:A.filter(M=>M.status==="anfrage").length,besichtigung:A.filter(M=>M.status==="besichtigung").length,geplant:A.filter(M=>M.status==="geplant").length,in_bearbeitung:A.filter(M=>M.status==="in_bearbeitung").length,abgeschlossen:A.filter(M=>M.status==="abgeschlossen").length},se=A.reduce((M,X)=>{const K=fg(X.description)||X.budget||0;return M+K},0),q=new Date().toISOString().split("T")[0],O=A.filter(M=>M.end_date&&M.end_date<q&&M.status!=="abgeschlossen"),F=C.filter(M=>M.status==="Aktiv").slice(0,5),B=()=>{h(!1)},R=()=>{p(!1)},D=()=>{p(!1)},L=M=>{P(M.id),y(!0)};return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Projekte & Baustellen"}),r.jsxs(W,{onClick:()=>h(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Neues Projekt"]})]}),r.jsx(CQ,{active:A.filter(M=>M.status!=="abgeschlossen").length,done:A.filter(M=>M.status==="abgeschlossen").length,budget:se||0,late:O.length}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[r.jsxs(J,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsxs(pe,{className:"pb-2 flex-row items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-100 text-green-800 border-green-200",children:"Aktuelle"}),r.jsx(xe,{children:"Projekte"})]}),r.jsxs("div",{className:"text-sm text-muted-foreground",children:["Heute • ",new Date().toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"})]})]}),r.jsx(te,{className:"space-y-3",children:V?Array(3).fill(0).map((M,X)=>r.jsx("div",{className:"border rounded-xl p-3 shadow-softer",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx(Ke,{className:"h-4 w-24 mb-2"}),r.jsx(Ke,{className:"h-3 w-32 mb-1"}),r.jsx(Ke,{className:"h-3 w-20"})]}),r.jsx(Ke,{className:"h-6 w-16"})]})},X)):A.filter(M=>M.status!=="abgeschlossen").length===0?r.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine Projekte vorhanden"}):A.filter(M=>M.status!=="abgeschlossen").map(M=>r.jsx("div",{className:"border rounded-xl p-3 shadow-softer cursor-pointer hover:shadow-md transition-shadow",onDoubleClick:()=>L(M),children:r.jsx(P2,{id:T2(M.id),name:M.name,status:M.status,budget:fg(M.description)||M.budget||0,start:M.start_date,end:M.end_date,progress:M.status==="abgeschlossen"?100:M.status==="in_bearbeitung"?60:M.status==="geplant"?30:10,onOpen:()=>L(M)})},M.id))})]}),r.jsxs(J,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsx(pe,{className:"pb-2",children:r.jsx(xe,{children:"Verzögerte Projekte"})}),r.jsx(te,{children:V?r.jsxs("div",{className:"space-y-2",children:[r.jsx(Ke,{className:"h-16 w-full"}),r.jsx(Ke,{className:"h-16 w-full"})]}):O.length===0?r.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine Projekte im Verzug 🎉"}):O.map(M=>r.jsx("div",{className:"border rounded-xl p-3 mb-2 cursor-pointer hover:shadow-md transition-shadow",onDoubleClick:()=>L(M),children:r.jsx(P2,{id:T2(M.id),name:M.name,status:M.status,budget:fg(M.description)||M.budget||0,progress:M.status==="abgeschlossen"?100:M.status==="in_bearbeitung"?60:M.status==="geplant"?30:10,onOpen:()=>L(M)})},M.id))})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs(J,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsx(pe,{className:"pb-2",children:r.jsx(xe,{children:"Projektstatus"})}),r.jsx(te,{children:r.jsx(EQ,{counts:ne})})]}),r.jsxs(J,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsx(pe,{className:"pb-2",children:r.jsx(xe,{children:"Top Kunden"})}),r.jsx(te,{className:"space-y-2",children:V?Array(3).fill(0).map((M,X)=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Ke,{className:"h-4 w-24"}),r.jsx(Ke,{className:"h-4 w-32"})]},X)):F.length===0?r.jsx("p",{className:"text-sm text-muted-foreground",children:"Hier erscheinen Kunden, sobald Projekte abgeschlossen sind."}):F.map(M=>r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{children:M.company_name||M.contact_person}),r.jsx("span",{className:"text-muted-foreground",children:M.email})]},M.id))})]}),r.jsxs(J,{className:"shadow-soft rounded-2xl overflow-hidden",children:[r.jsx(pe,{className:"pb-2",children:r.jsx(xe,{children:"Projekt Übersicht"})}),r.jsxs(te,{className:"grid grid-cols-2 gap-2 text-sm",children:[r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-slate-50 text-slate-700 border-slate-200",children:["Gesamt: ",A.length]}),r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-amber-50 text-amber-700 border-amber-200",children:["In Planung: ",ne.geplant]}),r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-blue-50 text-blue-700 border-blue-200",children:["In Arbeit: ",ne.in_bearbeitung]}),r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-50 text-green-700 border-green-200",children:["Erledigt: ",ne.abgeschlossen]})]})]})]})]}),r.jsx(dQ,{isOpen:u,onClose:()=>h(!1),onProjectAdded:B,customers:T,teamMembers:I}),r.jsx(uQ,{isOpen:m,onClose:()=>p(!1),project:N,onProjectUpdated:R,onProjectDeleted:D}),r.jsx(hQ,{isOpen:b,onClose:()=>x(!1),project:N}),E&&r.jsx(pQ,{isOpen:g,onClose:()=>{y(!1),P(null)},projectId:E}),N&&r.jsx(xQ,{isOpen:v,onClose:()=>w(!1),projectId:N.id,projectName:N.name,customerId:N.customer_id||"",onCalculationSaved:()=>{}}),N&&r.jsx(kQ,{isOpen:j,onClose:()=>S(!1),projectId:N.id,projectName:N.name})]})};function _i({title:t,value:e,className:n,valueClassName:s}){return r.jsxs("div",{className:_e("bg-card border rounded-xl px-4 py-4 flex items-center justify-between shadow-sm hover:shadow-md transition-shadow",n),children:[r.jsx("div",{className:"text-xs text-muted-foreground font-semibold uppercase tracking-wider",children:t}),r.jsx("div",{className:_e("text-2xl font-bold",s),children:e})]})}function GT({children:t,className:e}){return r.jsx("section",{"aria-label":"Kennzahlen",className:_e("grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4","bg-background/95 backdrop-blur-sm border rounded-2xl p-4 shadow-lg",e),children:t})}const DQ=({totalEmployees:t,activeEmployees:e,onVacationEmployees:n,totalHours:s})=>r.jsxs(GT,{children:[r.jsx(_i,{title:"Mitarbeiter gesamt",value:t}),r.jsx(_i,{title:"Aktiv",value:e,valueClassName:"text-green-600"}),r.jsx(_i,{title:"Urlaub",value:n,valueClassName:"text-yellow-600"}),r.jsx(_i,{title:"Stunden (Monat)",value:s})]});var lj="Avatar",[PQ,Lee]=Zr(lj),[TQ,ZT]=PQ(lj),QT=f.forwardRef((t,e)=>{const{__scopeAvatar:n,...s}=t,[a,i]=f.useState("idle");return r.jsx(TQ,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:r.jsx(Le.span,{...s,ref:e})})});QT.displayName=lj;var YT="AvatarImage",JT=f.forwardRef((t,e)=>{const{__scopeAvatar:n,src:s,onLoadingStatusChange:a=()=>{},...i}=t,o=ZT(YT,n),l=RQ(s,i.referrerPolicy),c=nn(d=>{a(d),o.onImageLoadingStatusChange(d)});return gn(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?r.jsx(Le.img,{...i,ref:e,src:s}):null});JT.displayName=YT;var XT="AvatarFallback",e3=f.forwardRef((t,e)=>{const{__scopeAvatar:n,delayMs:s,...a}=t,i=ZT(XT,n),[o,l]=f.useState(s===void 0);return f.useEffect(()=>{if(s!==void 0){const c=window.setTimeout(()=>l(!0),s);return()=>window.clearTimeout(c)}},[s]),o&&i.imageLoadingStatus!=="loaded"?r.jsx(Le.span,{...a,ref:e}):null});e3.displayName=XT;function RQ(t,e){const[n,s]=f.useState("idle");return gn(()=>{if(!t){s("error");return}let a=!0;const i=new window.Image,o=l=>()=>{a&&s(l)};return s("loading"),i.onload=o("loaded"),i.onerror=o("error"),i.src=t,e&&(i.referrerPolicy=e),()=>{a=!1}},[t,e]),n}var t3=QT,n3=JT,r3=e3;const Fu=f.forwardRef(({className:t,...e},n)=>r.jsx(t3,{ref:n,className:_e("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));Fu.displayName=t3.displayName;const MQ=f.forwardRef(({className:t,...e},n)=>r.jsx(n3,{ref:n,className:_e("aspect-square h-full w-full",t),...e}));MQ.displayName=n3.displayName;const Bu=f.forwardRef(({className:t,...e},n)=>r.jsx(r3,{ref:n,className:_e("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));Bu.displayName=r3.displayName;const IQ=({employee:t,onShowDetails:e,onEdit:n})=>{const s=i=>{switch(i){case"Aktiv":return"bg-green-100 text-green-800";case"Urlaub":return"bg-yellow-100 text-yellow-800";case"Krank":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a=i=>i.split(" ").map(o=>o[0]).join("");return r.jsx(J,{className:"hover:shadow-lg transition-shadow",children:r.jsxs(te,{className:"p-6 flex flex-col h-full",children:[r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx(Fu,{className:"h-12 w-12",children:r.jsx(Bu,{children:a(t.name)})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h4",{className:"text-lg font-semibold",children:t.name}),r.jsx(Ae,{className:s(t.status),children:t.status})]}),r.jsx("p",{className:"text-gray-600 mb-2",children:t.position}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm mb-4 flex-grow",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Aktuelles Projekt:"}),r.jsx("p",{children:t.currentProject})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Stunden (Monat):"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(Ht,{className:"h-4 w-4"}),t.hoursThisMonth,"h"]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Führerschein:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(zC,{className:"h-4 w-4"}),t.license||"Nicht angegeben"]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Resturlaub:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(gt,{className:"h-4 w-4"}),t.vacationDays," Tage"]})]})]}),r.jsxs("div",{className:"mb-4",children:[r.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Qualifikationen:"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:t.qualifications.length>0?t.qualifications.map(i=>r.jsxs(Ae,{variant:"outline",className:"text-xs",children:[r.jsx(eh,{className:"h-3 w-3 mr-1"}),i]},i)):r.jsx("span",{className:"text-sm text-gray-400",children:"Keine Qualifikationen hinterlegt"})})]})]})]}),r.jsxs("div",{className:"flex gap-2 mt-auto",children:[r.jsx(W,{size:"sm",variant:"outline",onClick:()=>e(t),children:"Details"}),r.jsxs(W,{size:"sm",onClick:()=>n(t),children:[r.jsx(Io,{className:"h-4 w-4 mr-1"}),"Bearbeiten"]})]})]})})},OQ=({isOpen:t,onClose:e,onSubmit:n,isLoading:s})=>{const[a,i]=f.useState({email:"",firstName:"",lastName:"",position:"",phone:"",license:"",qualifications:[]}),[o,l]=f.useState(""),c=(x,g)=>{i(y=>({...y,[x]:g}))},d=()=>{o.trim()&&!a.qualifications.includes(o.trim())&&(i(x=>({...x,qualifications:[...x.qualifications,o.trim()]})),l(""))},u=x=>{i(g=>({...g,qualifications:g.qualifications.filter(y=>y!==x)}))},h=x=>{x.key==="Enter"&&(x.preventDefault(),d())},m=x=>{x.preventDefault(),n(a)},p=()=>{i({email:"",firstName:"",lastName:"",position:"",phone:"",license:"",qualifications:[]}),l("")},b=()=>{p(),e()};return r.jsx(Mt,{open:t,onOpenChange:b,children:r.jsxs(Pt,{className:"max-w-md",children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Neuen Mitarbeiter erstellen"}),r.jsx(Nn,{children:"Erstelle einen neuen Mitarbeiter. Der Mitarbeiter erhält eine E-Mail zur Bestätigung seines Kontos."})]}),r.jsxs("form",{onSubmit:m,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"add-firstName",children:"Vorname"}),r.jsx(G,{id:"add-firstName",type:"text",value:a.firstName,onChange:x=>c("firstName",x.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"add-lastName",children:"Nachname"}),r.jsx(G,{id:"add-lastName",type:"text",value:a.lastName,onChange:x=>c("lastName",x.target.value),required:!0})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"add-email",children:"E-Mail"}),r.jsx(G,{id:"add-email",type:"email",value:a.email,onChange:x=>c("email",x.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"add-position",children:"Position"}),r.jsx(G,{id:"add-position",type:"text",value:a.position,onChange:x=>c("position",x.target.value),placeholder:"z.B. Elektriker, Elektroniker"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"add-phone",children:"Telefon"}),r.jsx(G,{id:"add-phone",type:"tel",value:a.phone,onChange:x=>c("phone",x.target.value),placeholder:"+49 123 456789"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"add-license",children:"Führerschein"}),r.jsx(G,{id:"add-license",type:"text",value:a.license,onChange:x=>c("license",x.target.value),placeholder:"z.B. B, BE"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"add-qualifications",children:"Qualifikationen"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx(G,{id:"add-qualifications",type:"text",value:o,onChange:x=>l(x.target.value),onKeyPress:h,placeholder:"z.B. VDE 0100, Erste Hilfe"}),r.jsx(W,{type:"button",onClick:d,size:"sm",children:r.jsx(zt,{className:"h-4 w-4"})})]}),a.qualifications.length>0&&r.jsx("div",{className:"flex flex-wrap gap-2",children:a.qualifications.map(x=>r.jsxs(Ae,{variant:"outline",className:"text-xs",children:[r.jsx(eh,{className:"h-3 w-3 mr-1"}),x,r.jsx("button",{type:"button",onClick:()=>u(x),className:"ml-1 hover:text-red-600",children:r.jsx(Mn,{className:"h-3 w-3"})})]},x))})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(W,{type:"button",variant:"outline",onClick:b,children:"Abbrechen"}),r.jsx(W,{type:"submit",disabled:s,children:s?"Wird erstellt...":"Mitarbeiter erstellen"})]})]})]})})},FQ=({isOpen:t,onClose:e,employee:n})=>{const s=i=>{switch(i){case"Aktiv":return"bg-green-100 text-green-800";case"Urlaub":return"bg-yellow-100 text-yellow-800";case"Krank":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a=i=>i.split(" ").map(o=>o[0]).join("");return n?r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-2xl",children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Mitarbeiterdetails"}),r.jsx(Nn,{children:"Detaillierte Informationen über den Mitarbeiter"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Fu,{className:"h-16 w-16",children:r.jsx(Bu,{className:"text-lg",children:a(n.name)})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-semibold",children:n.name}),r.jsx("p",{className:"text-gray-600",children:n.position}),r.jsx(Ae,{className:s(n.status),children:n.status})]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Tn,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-sm",children:n.email})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Rc,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-sm",children:n.phone||"Nicht angegeben"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(zC,{className:"h-4 w-4 text-gray-500"}),r.jsxs("span",{className:"text-sm",children:["Führerschein: ",n.license||"Nicht angegeben"]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ht,{className:"h-4 w-4 text-gray-500"}),r.jsxs("span",{className:"text-sm",children:[n.hoursThisMonth,"h diesen Monat"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(gt,{className:"h-4 w-4 text-gray-500"}),r.jsxs("span",{className:"text-sm",children:[n.vacationDays," Tage Resturlaub"]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(la,{className:"h-4 w-4 text-gray-500"}),r.jsx("span",{className:"text-sm",children:n.currentProject})]})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium mb-2",children:"Qualifikationen"}),r.jsx("div",{className:"flex flex-wrap gap-2",children:n.qualifications.length>0?n.qualifications.map(i=>r.jsxs(Ae,{variant:"outline",children:[r.jsx(eh,{className:"h-3 w-3 mr-1"}),i]},i)):r.jsx("span",{className:"text-sm text-gray-400",children:"Keine Qualifikationen hinterlegt"})})]}),r.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50",children:[r.jsx("h4",{className:"font-medium mb-2",children:"Dateien & Dokumente"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Diese Funktion wird bald verfügbar sein."})]})]})]})}):null},BQ=({isOpen:t,onClose:e,employee:n,onSave:s})=>{const{toast:a}=pt(),i=CW(),[o,l]=f.useState({name:"",position:"",email:"",phone:"",status:"Aktiv",license:"",qualifications:[],currentProject:"",hoursThisMonth:0,vacationDays:0}),[c,d]=f.useState("");f.useEffect(()=>{n&&l({name:n.name,position:n.position,email:n.email,phone:n.phone,status:n.status,license:n.license,qualifications:n.qualifications||[],currentProject:n.currentProject,hoursThisMonth:n.hoursThisMonth,vacationDays:n.vacationDays})},[n]);const u=(g,y)=>{l(v=>({...v,[g]:y}))},h=()=>{c.trim()&&!o.qualifications.includes(c.trim())&&(l(g=>({...g,qualifications:[...g.qualifications,c.trim()]})),d(""))},m=g=>{l(y=>({...y,qualifications:y.qualifications.filter(v=>v!==g)}))},p=g=>{g.key==="Enter"&&(g.preventDefault(),h())},b=g=>{g.preventDefault(),s(o)},x=()=>{n&&window.confirm(`Möchten Sie den Mitarbeiter "${n.name}" wirklich löschen?`)&&i.mutate(n.id,{onSuccess:()=>{a({title:"Mitarbeiter gelöscht",description:`${n.name} wurde erfolgreich gelöscht.`}),e()},onError:g=>{a({title:"Fehler beim Löschen",description:g.message,variant:"destructive"})}})};return n?r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-md",children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Mitarbeiter bearbeiten"}),r.jsx(Nn,{children:"Mitarbeiterdaten bearbeiten"})]}),r.jsxs("form",{onSubmit:b,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"name",children:"Name"}),r.jsx(G,{id:"name",value:o.name,onChange:g=>u("name",g.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"position",children:"Position"}),r.jsx(G,{id:"position",value:o.position,onChange:g=>u("position",g.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"email",children:"E-Mail"}),r.jsx(G,{id:"email",type:"email",value:o.email,onChange:g=>u("email",g.target.value),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"phone",children:"Telefon"}),r.jsx(G,{id:"phone",value:o.phone,onChange:g=>u("phone",g.target.value)})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"status",children:"Status"}),r.jsxs(tt,{value:o.status,onValueChange:g=>u("status",g),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Aktiv",children:"Aktiv"}),r.jsx(ce,{value:"Urlaub",children:"Urlaub"}),r.jsx(ce,{value:"Krank",children:"Krank"})]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"license",children:"Führerschein"}),r.jsx(G,{id:"license",value:o.license,onChange:g=>u("license",g.target.value),placeholder:"z.B. B, BE"})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"qualifications",children:"Qualifikationen"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx(G,{id:"qualifications",type:"text",value:c,onChange:g=>d(g.target.value),onKeyPress:p,placeholder:"z.B. VDE 0100, Erste Hilfe"}),r.jsx(W,{type:"button",onClick:h,size:"sm",children:r.jsx(zt,{className:"h-4 w-4"})})]}),o.qualifications.length>0&&r.jsx("div",{className:"flex flex-wrap gap-2",children:o.qualifications.map(g=>r.jsxs(Ae,{variant:"outline",className:"text-xs",children:[r.jsx(eh,{className:"h-3 w-3 mr-1"}),g,r.jsx("button",{type:"button",onClick:()=>m(g),className:"ml-1 hover:text-red-600",children:r.jsx(Mn,{className:"h-3 w-3"})})]},g))})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"currentProject",children:"Aktuelles Projekt"}),r.jsx(G,{id:"currentProject",value:o.currentProject,onChange:g=>u("currentProject",g.target.value)})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"hoursThisMonth",children:"Stunden (Monat)"}),r.jsx(G,{id:"hoursThisMonth",type:"number",value:o.hoursThisMonth,onChange:g=>u("hoursThisMonth",parseInt(g.target.value))})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"vacationDays",children:"Resturlaub"}),r.jsx(G,{id:"vacationDays",type:"number",value:o.vacationDays,onChange:g=>u("vacationDays",parseInt(g.target.value))})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(W,{type:"button",variant:"outline",onClick:e,children:"Abbrechen"}),r.jsxs(W,{type:"button",variant:"destructive",onClick:x,disabled:i.isPending,className:"flex items-center gap-2",children:[r.jsx(ra,{className:"h-4 w-4"}),i.isPending?"Lösche...":"Löschen"]}),r.jsx(W,{type:"submit",children:"Speichern"})]})]})]})}):null},LQ=({onQuickAction:t})=>{const e=[{employee:"Keine Schulungen geplant",training:"",date:"",type:"Info"}],n=s=>{switch(s){case"Pflicht":return"bg-red-100 text-red-800";case"Weiterbildung":return"bg-blue-100 text-blue-800";case"Info":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(V_,{className:"h-5 w-5"}),"Anstehende Schulungen"]})}),r.jsx(te,{children:r.jsx("div",{className:"space-y-3",children:e.map(s=>r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"flex items-center justify-between mb-2",children:r.jsx(Ae,{className:n(s.type),children:s.type})}),r.jsx("p",{className:"font-medium text-sm mb-1",children:s.employee}),s.training&&r.jsx("p",{className:"text-sm text-gray-600 mb-1",children:s.training}),s.date&&r.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[r.jsx(gt,{className:"h-3 w-3"}),s.date]})]},s.employee))})})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{className:"text-base",children:"Personalaktionen"})}),r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs(W,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Urlaub planen"),children:[r.jsx(gt,{className:"h-4 w-4 mr-2"}),"Urlaub planen"]}),r.jsxs(W,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Arbeitszeiten"),children:[r.jsx(Ht,{className:"h-4 w-4 mr-2"}),"Arbeitszeiten"]}),r.jsxs(W,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Schulung buchen"),children:[r.jsx(V_,{className:"h-4 w-4 mr-2"}),"Schulung buchen"]}),r.jsxs(W,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Zertifikate"),children:[r.jsx(eh,{className:"h-4 w-4 mr-2"}),"Zertifikate"]})]})})]})]})},s3=f.forwardRef(({className:t,...e},n)=>r.jsx("div",{className:"relative w-full overflow-auto",children:r.jsx("table",{ref:n,className:_e("w-full caption-bottom text-sm",t),...e})}));s3.displayName="Table";const a3=f.forwardRef(({className:t,...e},n)=>r.jsx("thead",{ref:n,className:_e("[&_tr]:border-b",t),...e}));a3.displayName="TableHeader";const i3=f.forwardRef(({className:t,...e},n)=>r.jsx("tbody",{ref:n,className:_e("[&_tr:last-child]:border-0",t),...e}));i3.displayName="TableBody";const $Q=f.forwardRef(({className:t,...e},n)=>r.jsx("tfoot",{ref:n,className:_e("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...e}));$Q.displayName="TableFooter";const Cy=f.forwardRef(({className:t,...e},n)=>r.jsx("tr",{ref:n,className:_e("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...e}));Cy.displayName="TableRow";const ei=f.forwardRef(({className:t,...e},n)=>r.jsx("th",{ref:n,className:_e("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...e}));ei.displayName="TableHead";const ti=f.forwardRef(({className:t,...e},n)=>r.jsx("td",{ref:n,className:_e("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...e}));ti.displayName="TableCell";const zQ=f.forwardRef(({className:t,...e},n)=>r.jsx("caption",{ref:n,className:_e("mt-4 text-sm text-muted-foreground",t),...e}));zQ.displayName="TableCaption";function UQ(){const[t,e]=f.useState([]),[n,s]=f.useState(null),[a,i]=f.useState(0),[o,l]=f.useState(40),{data:c,isLoading:d,error:u}=$w(),h=(c==null?void 0:c.items)||[],m=async()=>{try{console.log("Fetching company working hours...");const{data:y,error:v}=await $.from("company_settings").select("default_working_hours_start, default_working_hours_end, default_break_duration").limit(1);if(v){console.error("Error fetching working hours:",v);return}if(y){console.log("Working hours data:",y);const w=y.default_working_hours_start||"08:00",j=y.default_working_hours_end||"17:00",S=y.default_break_duration||60,[N,k]=w.split(":").map(Number),[E,P]=j.split(":").map(Number),A=N*60+k,I=(E*60+P-A-S)/60,V=I*5;console.log(`Calculated: ${I}h/Tag, ${V}h/Woche`),l(V)}}catch(y){console.error("Error calculating working hours:",y),l(40)}};f.useEffect(()=>{m();const y=localStorage.getItem("employeeWages");y&&e(JSON.parse(y))},[]),f.useEffect(()=>{localStorage.setItem("employeeWages",JSON.stringify(t))},[t]);const p=y=>{const v=t.find(w=>w.employee_id===y);return(v==null?void 0:v.hourly_wage)||0},b=y=>{s(y.id),i(p(y.id))},x=()=>{s(null),i(0)},g=y=>{const v=t.map(w=>w.employee_id===y?{...w,hourly_wage:a}:w);t.find(w=>w.employee_id===y)||v.push({employee_id:y,hourly_wage:a}),e(v),s(null),i(0),ft.success("Stundenlohn wurde gespeichert")};return d?r.jsx(J,{children:r.jsx(te,{className:"p-6",children:r.jsx("div",{className:"text-center",children:"Lädt Mitarbeiterdaten..."})})}):u?r.jsx(J,{children:r.jsx(te,{className:"p-6",children:r.jsxs("div",{className:"text-center text-red-500",children:["Fehler beim Laden der Mitarbeiterdaten: ",u.message||"Unbekannter Fehler"]})})}):r.jsx("div",{className:"space-y-6",children:r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Fr,{className:"h-5 w-5"}),"Mitarbeiter Stundenlohn-Verwaltung (Vereinfacht)"]}),r.jsx(Jn,{children:"Verwalten Sie Stundenlöhne Ihrer aktiven Mitarbeiter"})]}),r.jsxs(te,{children:[r.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[r.jsxs("p",{className:"text-sm text-blue-800",children:["📋 ",r.jsx("strong",{children:"Arbeitszeit werden aus den Firmeneinstellungen berechnet (42.5h/Woche)"})]}),r.jsxs("p",{className:"text-sm text-orange-700 mt-1",children:["⚠️ ",r.jsx("strong",{children:"Hinweise:"})," Löhne werden temporär im Browser gespeichert"]})]}),h.length===0?r.jsx("div",{className:"text-center py-8 text-gray-500",children:"Keine aktiven Mitarbeiter gefunden"}):r.jsxs(s3,{children:[r.jsx(a3,{children:r.jsxs(Cy,{children:[r.jsxs(ei,{children:[r.jsx(Ps,{className:"h-4 w-4 inline mr-2"}),"Mitarbeiter"]}),r.jsxs(ei,{children:[r.jsx(Tn,{className:"h-4 w-4 inline mr-2"}),"E-Mail"]}),r.jsxs(ei,{children:[r.jsx(xl,{className:"h-4 w-4 inline mr-2"}),"Position"]}),r.jsx(ei,{children:"Status"}),r.jsxs(ei,{children:[r.jsx(Fr,{className:"h-4 w-4 inline mr-2"}),"Stundenlohn"]}),r.jsx(ei,{children:"Wochenlohn (ca.)"}),r.jsx(ei,{children:"Aktionen"})]})}),r.jsx(i3,{children:h.map(y=>{const v=p(y.id),w=v*o,j=n===y.id;return r.jsxs(Cy,{children:[r.jsx(ti,{children:r.jsxs("div",{children:[r.jsxs("div",{className:"font-medium",children:[y.first_name," ",y.last_name]}),y.phone&&r.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[r.jsx(Rc,{className:"h-3 w-3"}),y.phone]})]})}),r.jsx(ti,{children:y.email}),r.jsx(ti,{children:y.position||"-"}),r.jsx(ti,{children:r.jsx(Ae,{variant:y.status==="Aktiv"?"default":"secondary",children:y.status})}),r.jsx(ti,{children:j?r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(G,{type:"number",step:"0.50",min:"0",value:a,onChange:S=>i(parseFloat(S.target.value)||0),className:"w-20"}),r.jsx("span",{className:"text-sm",children:"€/h"})]}):r.jsx("div",{className:"font-mono",children:v>0?`€${v.toFixed(2)}/h`:"Nicht festgelegt"})}),r.jsxs(ti,{children:[r.jsx("div",{className:"font-mono text-green-600",children:w>0?`€${w.toFixed(2)}`:"-"}),w>0&&r.jsxs("div",{className:"text-xs text-gray-500",children:["bei ",o,"h/Woche"]})]}),r.jsx(ti,{children:j?r.jsxs("div",{className:"flex gap-1",children:[r.jsx(W,{size:"sm",onClick:()=>g(y.id),className:"h-8 w-8 p-0",children:r.jsx(wf,{className:"h-3 w-3"})}),r.jsx(W,{size:"sm",variant:"outline",onClick:x,className:"h-8 w-8 p-0",children:r.jsx(Mn,{className:"h-3 w-3"})})]}):r.jsx(W,{size:"sm",variant:"outline",onClick:()=>b(y),className:"h-8 w-8 p-0",children:r.jsx(Io,{className:"h-3 w-3"})})})]},y.id)})})]})]})]})})}const qQ=()=>{const{toast:t}=pt(),{user:e,session:n,inviteEmployee:s,companyId:a}=za(),i=On(),[o,l]=f.useState(null),[c,d]=f.useState(!1),[u,h]=f.useState(!1),[m,p]=f.useState(!1),[b,x]=f.useState(!1),{data:g,isLoading:y,error:v}=$w(),w=(g==null?void 0:g.items)||[],j=f.useMemo(()=>w.map(I=>({id:I.id,name:I.name||`${I.first_name} ${I.last_name}`.trim()||I.email,position:I.position||"Mitarbeiter",email:I.email,phone:I.phone||"",status:I.status||"Aktiv",qualifications:Array.isArray(I.qualifications)?I.qualifications:[],license:I.license||"",currentProject:"-",hoursThisMonth:0,vacationDays:25})),[w]),S=async I=>{x(!0);try{console.log("Creating Supabase employee invitation:",I);const V=await s(I.email,{firstName:I.firstName,lastName:I.lastName,position:I.position,phone:I.phone,license:I.license,qualifications:I.qualifications});if(!V.success){console.error("Supabase invitation error:",V.error),ft.error(`Fehler beim Senden der Einladung: ${V.error}`);return}ft.success(`Mitarbeiter ${I.firstName} ${I.lastName} wurde erfolgreich eingeladen! 
        Eine Einladungs-E-Mail wurde an ${I.email} gesendet.`),i.invalidateQueries({queryKey:At.employees}),p(!1)}catch(V){console.error("Unexpected error:",V),ft.error("Ein unerwarteter Fehler ist aufgetreten")}finally{x(!1)}},N=I=>{l(I),d(!0)},k=I=>{l(I),h(!0)},E=async I=>{var V;if(o)try{const ne=((V=I.name)==null?void 0:V.split(" "))||[],se=ne[0]||"",q=ne.slice(1).join(" ")||"",{error:O}=await $.from("employees").update({first_name:se,last_name:q,position:I.position,phone:I.phone,status:I.status,license:I.license,qualifications:I.qualifications?JSON.stringify(I.qualifications):"[]"}).eq("id",o.id);if(O){console.error("Error updating employee:",O),ft.error(`Fehler beim Aktualisieren: ${O.message}`);return}o.id&&se&&q&&await $.from("profiles").update({first_name:se,last_name:q}).eq("id",o.id);const F={...o,...I};setEmployees(B=>B.map(R=>R.id===o.id?F:R)),t({title:"Erfolg",description:"Mitarbeiter wurde erfolgreich aktualisiert."}),h(!1),l(null)}catch(ne){console.error("Error saving employee:",ne),ft.error("Fehler beim Speichern der Mitarbeiteränderungen")}},P=I=>{t({title:"Info",description:`${I} wird geöffnet...`})},A=j.filter(I=>I.status==="Aktiv").length,C=j.filter(I=>I.status==="Urlaub").length,T=j.reduce((I,V)=>I+V.hoursThisMonth,0);return r.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[r.jsx("div",{className:"flex items-center justify-between mb-8",children:r.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Personalverwaltung"})}),r.jsxs(cr,{defaultValue:"overview",className:"w-full",children:[r.jsxs(tr,{className:"grid w-full grid-cols-2",children:[r.jsx(Oe,{value:"overview",children:"Mitarbeiterübersicht"}),r.jsx(Oe,{value:"wages",children:"Stundenlohn-Verwaltung"})]}),r.jsxs(Fe,{value:"overview",className:"space-y-6",children:[r.jsx("div",{className:"flex justify-end",children:r.jsxs(W,{onClick:()=>p(!0),children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Mitarbeiter hinzufügen"]})}),r.jsx(DQ,{totalEmployees:j.length,activeEmployees:A,onVacationEmployees:C,totalHours:T}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Mitarbeiterliste"}),y?r.jsx("div",{className:"text-center p-6",children:r.jsx("p",{className:"text-gray-500",children:"Mitarbeiter werden geladen..."})}):j.length===0?r.jsxs("div",{className:"text-center p-6",children:[r.jsx("p",{className:"text-gray-500",children:"Noch keine Mitarbeiter vorhanden."}),r.jsx("p",{className:"text-sm text-gray-400 mt-2",children:'Klicken Sie auf "Mitarbeiter hinzufügen" um den ersten Mitarbeiter einzuladen.'})]}):j.map(I=>r.jsx(IQ,{employee:I,onShowDetails:N,onEdit:k},I.id))]}),r.jsx(LQ,{onQuickAction:P})]})]}),r.jsx(Fe,{value:"wages",children:r.jsx(UQ,{})})]}),r.jsx(OQ,{isOpen:m,onClose:()=>p(!1),onSubmit:S,isLoading:b}),r.jsx(FQ,{isOpen:c,onClose:()=>d(!1),employee:o}),r.jsx(BQ,{isOpen:u,onClose:()=>h(!1),employee:o,onSave:E})]})},WQ=({isOpen:t,onClose:e,selectedMaterial:n,onAssignmentComplete:s})=>{const{user:a,companyId:i}=za(),[o,l]=f.useState("assign"),[c,d]=f.useState([]),[u,h]=f.useState([]),[m,p]=f.useState([]),[b,x]=f.useState([]),[g,y]=f.useState({material_id:(n==null?void 0:n.id)||"",employee_id:"",project_id:"",assigned_quantity:0,notes:""}),[v,w]=f.useState(!1);f.useEffect(()=>{t&&i&&j()},[t,i]),f.useEffect(()=>{n&&y(C=>({...C,material_id:n.id}))},[n]);const j=async()=>{w(!0);try{await Promise.all([S(),N(),k(),E()])}catch(C){console.error("Error fetching data:",C),ft.error("Fehler beim Laden der Daten")}finally{w(!1)}},S=async()=>{const{data:C,error:T}=await $.from("materials").select("id, name, current_stock, unit, category").eq("company_id",i).eq("is_active",!0).order("name");if(T){console.error("Error fetching materials:",T);return}d(C||[])},N=async()=>{const{data:C,error:T}=await $.from("employees").select("id, first_name, last_name, email").eq("company_id",i).eq("status","active").order("first_name");if(T){console.error("Error fetching employees:",T);return}h(C||[])},k=async()=>{const{data:C,error:T}=await $.from("projects").select("id, name").eq("company_id",i).order("name");if(T){console.error("Error fetching projects:",T);return}p(C||[])},E=async()=>{const{data:C,error:T}=await $.from("project_material_assignments").select(`
        id,
        assigned_quantity,
        used_quantity,
        assigned_at,
        notes,
        materials:material_id (name, unit),
        employees:assigned_by (first_name, last_name),
        projects:project_id (name)
      `).order("assigned_at",{ascending:!1}).limit(20);if(T){console.error("Error fetching assignments:",T);return}const I=(C==null?void 0:C.map(V=>{var ne,se,q,O,F;return{...V,material_name:((ne=V.materials)==null?void 0:ne.name)||"Unbekannt",employee_name:`${((se=V.employees)==null?void 0:se.first_name)||""} ${((q=V.employees)==null?void 0:q.last_name)||""}`.trim()||"Unbekannt",project_name:((O=V.projects)==null?void 0:O.name)||"Unbekannt",unit:((F=V.materials)==null?void 0:F.unit)||"Stk"}}))||[];x(I)},P=async()=>{var T;if(!g.material_id||!g.employee_id||!g.project_id||!g.assigned_quantity){ft.error("Bitte füllen Sie alle Pflichtfelder aus");return}const C=c.find(I=>I.id===g.material_id);if(C&&g.assigned_quantity>C.current_stock){ft.error(`Nicht genügend Bestand verfügbar. Verfügbar: ${C.current_stock} ${C.unit}`);return}try{w(!0);const{error:I}=await $.from("project_material_assignments").upsert({project_id:g.project_id,material_id:g.material_id,assigned_quantity:g.assigned_quantity,assigned_by:a==null?void 0:a.id,notes:g.notes});if(I)throw I;const{error:V}=await $.from("material_stock_movements").insert({material_id:g.material_id,movement_type:"out",reference_type:"assignment",reference_id:g.project_id,quantity:-g.assigned_quantity,employee_id:g.employee_id,project_id:g.project_id,reason:`Material zugewiesen an ${(T=u.find(ne=>ne.id===g.employee_id))==null?void 0:T.first_name}`,created_by:a==null?void 0:a.id});if(V)throw V;ft.success("Material wurde erfolgreich zugewiesen"),y({material_id:(n==null?void 0:n.id)||"",employee_id:"",project_id:"",assigned_quantity:0,notes:""}),await E(),s&&s()}catch(I){console.error("Error creating assignment:",I),ft.error("Fehler beim Zuweisen des Materials")}finally{w(!1)}},A=c.find(C=>C.id===g.material_id);return r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:[r.jsxs(Bt,{children:[r.jsxs(Lt,{className:"flex items-center gap-2",children:[r.jsx(Ds,{className:"h-5 w-5"}),"Material-Zuweisung"]}),r.jsx(Nn,{children:"Weisen Sie Material einem Mitarbeiter für ein Projekt zu"})]}),r.jsxs("div",{className:"flex gap-2 mb-4",children:[r.jsx(W,{variant:o==="assign"?"default":"outline",onClick:()=>l("assign"),children:"Material zuweisen"}),r.jsx(W,{variant:o==="view"?"default":"outline",onClick:()=>l("view"),children:"Zuweisungen anzeigen"})]}),o==="assign"&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Material *"}),r.jsxs(tt,{value:g.material_id,onValueChange:C=>y(T=>({...T,material_id:C})),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Material wählen"})}),r.jsx(Xe,{children:c.map(C=>r.jsx(ce,{value:C.id,children:r.jsxs("div",{className:"flex justify-between items-center w-full",children:[r.jsx("span",{children:C.name}),r.jsxs(Ae,{variant:"outline",className:"ml-2",children:[C.current_stock," ",C.unit]})]})},C.id))})]}),A&&r.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded-lg",children:[r.jsxs("p",{className:"text-sm",children:[r.jsx("strong",{children:"Verfügbar:"})," ",A.current_stock," ",A.unit]}),r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Kategorie:"})," ",A.category]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mitarbeiter *"}),r.jsxs(tt,{value:g.employee_id,onValueChange:C=>y(T=>({...T,employee_id:C})),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Mitarbeiter wählen"})}),r.jsx(Xe,{children:u.map(C=>r.jsxs(ce,{value:C.id,children:[C.first_name," ",C.last_name]},C.id))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Projekt *"}),r.jsxs(tt,{value:g.project_id,onValueChange:C=>y(T=>({...T,project_id:C})),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Projekt wählen"})}),r.jsx(Xe,{children:m.map(C=>r.jsx(ce,{value:C.id,children:C.name},C.id))})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Menge * ",A&&`(${A.unit})`]}),r.jsx(G,{type:"number",step:"0.1",min:"0",max:(A==null?void 0:A.current_stock)||999999,value:g.assigned_quantity,onChange:C=>y(T=>({...T,assigned_quantity:parseFloat(C.target.value)||0})),placeholder:"Zuzuweisende Menge"}),A&&g.assigned_quantity>A.current_stock&&r.jsxs("div",{className:"flex items-center gap-2 mt-1 text-red-600",children:[r.jsx(Xn,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Nicht genügend Bestand verfügbar!"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notizen (optional)"}),r.jsx(an,{value:g.notes,onChange:C=>y(T=>({...T,notes:C.target.value})),placeholder:"Zusätzliche Informationen zur Zuweisung...",rows:3})]})]}),o==="view"&&r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Aktuelle Zuweisungen"}),r.jsx("div",{className:"grid gap-4 max-h-96 overflow-y-auto",children:b.map(C=>r.jsx(J,{children:r.jsxs(te,{className:"p-4",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium",children:C.material_name}),r.jsxs("p",{className:"text-sm text-gray-600",children:[C.employee_name," • ",C.project_name]})]}),r.jsxs(Ae,{variant:"outline",children:[C.used_quantity," / ",C.assigned_quantity," ",C.unit]})]}),r.jsxs("div",{className:"text-sm text-gray-500",children:["Zugewiesen: ",new Date(C.assigned_at).toLocaleDateString("de-DE")]}),C.notes&&r.jsx("div",{className:"text-sm text-gray-600 mt-2 p-2 bg-gray-50 rounded",children:C.notes})]})},C.id))})]}),r.jsxs(Qd,{children:[r.jsx(W,{variant:"outline",onClick:e,children:"Schließen"}),o==="assign"&&r.jsxs(W,{onClick:P,disabled:v||!g.material_id||!g.employee_id||!g.project_id||!g.assigned_quantity||A&&g.assigned_quantity>A.current_stock,children:[r.jsx(th,{className:"h-4 w-4 mr-2"}),"Material zuweisen"]})]})]})})},pm=["Fliesen & Keramik","Sanitär","Heizung","Elektro","Bauchemie","Werkzeuge","Befestigung","Dichtung & Abdichtung","Sonstiges"],R2=["Stück","m²","m","kg","l","Paket","Set","Rolle"],HQ=()=>{const{toast:t}=pt(),[e,n]=f.useState([]),[s,a]=f.useState([]),[i,o]=f.useState(""),[l,c]=f.useState("all"),[d,u]=f.useState(!1),[h,m]=f.useState(!1),[p,b]=f.useState(null),[x,g]=f.useState({name:"",category:"",supplier:"",unit:"Stück",currentPrice:0,notes:""});f.useEffect(()=>{y()},[]),f.useEffect(()=>{let C=e;i&&(C=C.filter(T=>T.name.toLowerCase().includes(i.toLowerCase())||T.supplier.toLowerCase().includes(i.toLowerCase()))),l&&l!=="all"&&(C=C.filter(T=>T.category===l)),a(C)},[e,i,l]);const y=()=>{const C=[{id:"1",name:"Bodenfliese 30x30cm Grau",category:"Fliesen & Keramik",supplier:"Fliesenmarkt GmbH",unit:"m²",currentPrice:24.99,previousPrice:22.5,lastUpdated:new Date(Date.now()-6048e5).toISOString(),isActive:!0,notes:"Gute Qualität, schnelle Lieferung"},{id:"2",name:"Fliesenkleber C1 25kg",category:"Bauchemie",supplier:"Bauchemie Express",unit:"Paket",currentPrice:12.5,previousPrice:13.2,lastUpdated:new Date(Date.now()-2592e5).toISOString(),isActive:!0},{id:"3",name:"Fugenmasse weiß 5kg",category:"Bauchemie",supplier:"Bauchemie Express",unit:"Paket",currentPrice:8.75,previousPrice:8.75,lastUpdated:new Date(Date.now()-12096e5).toISOString(),isActive:!0},{id:"4",name:"Mischbatterie Küche Edelstahl",category:"Sanitär",supplier:"Sanitär Partner",unit:"Stück",currentPrice:89.99,previousPrice:85,lastUpdated:new Date(Date.now()-864e5).toISOString(),isActive:!0},{id:"5",name:'Heizkörperventil 1/2"',category:"Heizung",supplier:"Heizung & Klima AG",unit:"Stück",currentPrice:15.5,previousPrice:16.2,lastUpdated:new Date(Date.now()-432e6).toISOString(),isActive:!0}];n(C)},v=()=>{const C={id:Date.now().toString(),name:x.name,category:x.category,supplier:x.supplier,unit:x.unit,currentPrice:x.currentPrice,previousPrice:x.currentPrice,lastUpdated:new Date().toISOString(),isActive:!0,notes:x.notes};n(T=>[...T,C]),N(),u(!1),t({title:"Material hinzugefügt",description:`${x.name} wurde zur Preisliste hinzugefügt.`})},w=C=>{b(C),g({name:C.name,category:C.category,supplier:C.supplier,unit:C.unit,currentPrice:C.currentPrice,notes:C.notes||""}),m(!0)},j=()=>{p&&(n(C=>C.map(T=>T.id===p.id?{...T,name:x.name,category:x.category,supplier:x.supplier,unit:x.unit,previousPrice:T.currentPrice,currentPrice:x.currentPrice,lastUpdated:new Date().toISOString(),notes:x.notes}:T)),N(),m(!1),b(null),t({title:"Material aktualisiert",description:`${x.name} wurde erfolgreich aktualisiert.`}))},S=C=>{n(T=>T.filter(I=>I.id!==C)),t({title:"Material entfernt",description:"Das Material wurde aus der Preisliste entfernt."})},N=()=>{g({name:"",category:"",supplier:"",unit:"Stück",currentPrice:0,notes:""})},k=C=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(C),E=C=>new Date(C).toLocaleDateString("de-DE"),P=(C,T)=>C>T?r.jsx(Bi,{className:"h-4 w-4 text-red-500",title:"Preis gestiegen"}):C<T?r.jsx(Pb,{className:"h-4 w-4 text-green-500",title:"Preis gefallen"}):null,A=(C,T)=>T===0?0:(C-T)/T*100;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Ds,{className:"h-6 w-6 text-blue-600"}),r.jsx("h2",{className:"text-2xl font-bold",children:"Materialpreise"})]}),r.jsxs(W,{onClick:()=>u(!0),children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsx(J,{children:r.jsxs(te,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold",children:e.length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Materialien gesamt"})]})}),r.jsx(J,{children:r.jsxs(te,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(C=>C.currentPrice<C.previousPrice).length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Preise gefallen"})]})}),r.jsx(J,{children:r.jsxs(te,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.filter(C=>C.currentPrice>C.previousPrice).length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Preise gestiegen"})]})}),r.jsx(J,{children:r.jsxs(te,{className:"p-4",children:[r.jsx("div",{className:"text-2xl font-bold",children:pm.length}),r.jsx("div",{className:"text-sm text-gray-600",children:"Kategorien"})]})})]}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(Mc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),r.jsx(G,{placeholder:"Material oder Lieferant suchen...",value:i,onChange:C=>o(C.target.value),className:"pl-10"})]})}),r.jsx("div",{className:"w-full md:w-64",children:r.jsxs(tt,{value:l,onValueChange:c,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Kategorie wählen"})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"all",children:"Alle Kategorien"}),pm.map(C=>r.jsx(ce,{value:C,children:C},C))]})]})}),(i||l&&l!=="all")&&r.jsx(W,{variant:"outline",onClick:()=>{o(""),c("all")},children:"Filter zurücksetzen"})]})})}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{children:["Materialpreise (",s.length,")"]})}),r.jsx(te,{children:r.jsx("div",{className:"space-y-4",children:s.length===0?r.jsx("div",{className:"text-center py-8 text-gray-500",children:i||l?"Keine Materialien gefunden.":"Noch keine Materialien vorhanden."}):s.map(C=>r.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h3",{className:"font-semibold text-lg",children:C.name}),r.jsx(Ae,{variant:"outline",children:C.category}),P(C.currentPrice,C.previousPrice)]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Lieferant:"})," ",C.supplier]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Einheit:"})," ",C.unit]}),r.jsxs("div",{children:[r.jsx("span",{className:"font-medium",children:"Letzte Aktualisierung:"})," ",E(C.lastUpdated)]})]}),C.notes&&r.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[r.jsx("span",{className:"font-medium",children:"Notizen:"})," ",C.notes]})]}),r.jsxs("div",{className:"text-right ml-4",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:k(C.currentPrice)}),r.jsxs("div",{className:"text-sm text-gray-500",children:["pro ",C.unit]}),C.previousPrice!==C.currentPrice&&r.jsxs("div",{className:`text-sm ${C.currentPrice>C.previousPrice?"text-red-600":"text-green-600"}`,children:[C.currentPrice>C.previousPrice?"+":"",A(C.currentPrice,C.previousPrice).toFixed(1),"%",r.jsxs("div",{className:"text-xs text-gray-500",children:["vorher: ",k(C.previousPrice)]})]}),r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsx(W,{variant:"outline",size:"sm",onClick:()=>w(C),children:r.jsx(Io,{className:"h-4 w-4"})}),r.jsx(W,{variant:"outline",size:"sm",onClick:()=>S(C.id),className:"text-red-600 hover:text-red-700",children:r.jsx(ra,{className:"h-4 w-4"})})]})]})]})},C.id))})})]}),r.jsx(Mt,{open:d,onOpenChange:u,children:r.jsxs(Pt,{children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Neues Material hinzufügen"}),r.jsx(Nn,{children:"Fügen Sie ein neues Material zur Preisliste hinzu."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"name",children:"Materialname *"}),r.jsx(G,{id:"name",value:x.name,onChange:C=>g(T=>({...T,name:C.target.value})),placeholder:"z.B. Bodenfliese 30x30cm Grau",required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"category",children:"Kategorie *"}),r.jsxs(tt,{value:x.category,onValueChange:C=>g(T=>({...T,category:C})),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Kategorie wählen"})}),r.jsx(Xe,{children:pm.map(C=>r.jsx(ce,{value:C,children:C},C))})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"unit",children:"Einheit *"}),r.jsxs(tt,{value:x.unit,onValueChange:C=>g(T=>({...T,unit:C})),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsx(Xe,{children:R2.map(C=>r.jsx(ce,{value:C,children:C},C))})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"supplier",children:"Lieferant *"}),r.jsx(G,{id:"supplier",value:x.supplier,onChange:C=>g(T=>({...T,supplier:C.target.value})),placeholder:"z.B. Baumarkt GmbH",required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"price",children:"Preis pro Einheit (€) *"}),r.jsx(G,{id:"price",type:"number",step:"0.01",min:"0",value:x.currentPrice,onChange:C=>g(T=>({...T,currentPrice:parseFloat(C.target.value)||0})),required:!0})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"notes",children:"Notizen"}),r.jsx(G,{id:"notes",value:x.notes,onChange:C=>g(T=>({...T,notes:C.target.value})),placeholder:"Zusätzliche Informationen (optional)"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(W,{variant:"outline",onClick:()=>{N(),u(!1)},children:"Abbrechen"}),r.jsx(W,{onClick:v,disabled:!x.name||!x.category||!x.supplier,children:"Hinzufügen"})]})]})}),r.jsx(Mt,{open:h,onOpenChange:m,children:r.jsxs(Pt,{children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Material bearbeiten"}),r.jsx(Nn,{children:"Bearbeiten Sie die Informationen für das Material."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"edit-name",children:"Materialname *"}),r.jsx(G,{id:"edit-name",value:x.name,onChange:C=>g(T=>({...T,name:C.target.value})),required:!0})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"edit-category",children:"Kategorie *"}),r.jsxs(tt,{value:x.category,onValueChange:C=>g(T=>({...T,category:C})),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsx(Xe,{children:pm.map(C=>r.jsx(ce,{value:C,children:C},C))})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"edit-unit",children:"Einheit *"}),r.jsxs(tt,{value:x.unit,onValueChange:C=>g(T=>({...T,unit:C})),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsx(Xe,{children:R2.map(C=>r.jsx(ce,{value:C,children:C},C))})]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"edit-supplier",children:"Lieferant *"}),r.jsx(G,{id:"edit-supplier",value:x.supplier,onChange:C=>g(T=>({...T,supplier:C.target.value})),required:!0})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"edit-price",children:"Neuer Preis pro Einheit (€) *"}),r.jsx(G,{id:"edit-price",type:"number",step:"0.01",min:"0",value:x.currentPrice,onChange:C=>g(T=>({...T,currentPrice:parseFloat(C.target.value)||0})),required:!0}),p&&r.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Aktueller Preis: ",k(p.currentPrice)]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"edit-notes",children:"Notizen"}),r.jsx(G,{id:"edit-notes",value:x.notes,onChange:C=>g(T=>({...T,notes:C.target.value})),placeholder:"Zusätzliche Informationen (optional)"})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[r.jsx(W,{variant:"outline",onClick:()=>{N(),m(!1),b(null)},children:"Abbrechen"}),r.jsx(W,{onClick:j,disabled:!x.name||!x.category||!x.supplier,children:"Aktualisieren"})]})]})})]})},VQ=()=>{const{user:t,companyId:e}=za(),[n,s]=f.useState("inventory"),[a,i]=f.useState([]),[o,l]=f.useState([]),[c,d]=f.useState([]),[u,h]=f.useState([]),[m,p]=f.useState([]),[b,x]=f.useState(!1),[g,y]=f.useState(""),[v,w]=f.useState(!1),[j,S]=f.useState(!1),[N,k]=f.useState(!1);f.useState(!1);const[E,P]=f.useState(!1),[A,C]=f.useState(null),[T,I]=f.useState({name:"",description:"",category:"",unit:"Stk",current_stock:0,min_stock:0,max_stock:0,unit_price:0,supplier_id:"",storage_location:""}),[V,ne]=f.useState({material_id:"",employee_id:"",project_id:"",quantity_used:0,notes:""});f.useEffect(()=>{e&&se()},[e]);const se=async()=>{x(!0);try{await Promise.all([q(),O(),F(),B(),R()])}catch(Z){console.error("Error fetching data:",Z),ft.error("Fehler beim Laden der Daten")}finally{x(!1)}},q=async()=>{const{data:Z,error:de}=await $.from("materials").select(`
        *,
        suppliers:supplier_id (
          id,
          name
        )
      `).eq("company_id",e).eq("is_active",!0).order("name");if(de){console.error("Error fetching materials:",de);return}const he=(Z==null?void 0:Z.map(Re=>{var $e;return{...Re,supplier_name:(($e=Re.suppliers)==null?void 0:$e.name)||"Kein Lieferant"}}))||[];i(he)},O=async()=>{const{data:Z,error:de}=await $.from("suppliers").select("*").eq("company_id",e).eq("is_active",!0).order("name");if(de){console.error("Error fetching suppliers:",de);return}l(Z||[])},F=async()=>{const{data:Z,error:de}=await $.from("projects").select("id, name, status").eq("company_id",e).order("name");if(de){console.error("Error fetching projects:",de);return}d(Z||[])},B=async()=>{const{data:Z,error:de}=await $.from("employees").select("id, first_name, last_name, email").eq("company_id",e).eq("status","active").order("first_name");if(de){console.error("Error fetching employees:",de);return}h(Z||[])},R=async()=>{const{data:Z,error:de}=await $.from("employee_material_usage").select(`
        *,
        materials:material_id (name, unit),
        employees:employee_id (first_name, last_name),
        projects:project_id (name)
      `).order("created_at",{ascending:!1}).limit(50);if(de){console.error("Error fetching material usage:",de);return}const he=(Z==null?void 0:Z.map(Re=>{var $e,wt,me,je,Se;return{...Re,material_name:(($e=Re.materials)==null?void 0:$e.name)||"Unbekannt",employee_name:`${(wt=Re.employees)==null?void 0:wt.first_name} ${(me=Re.employees)==null?void 0:me.last_name}`,project_name:((je=Re.projects)==null?void 0:je.name)||"Unbekannt",unit:((Se=Re.materials)==null?void 0:Se.unit)||"Stk"}}))||[];p(he)},D=async()=>{try{const{error:Z}=await $.from("materials").insert({...T,company_id:e,created_by:t==null?void 0:t.id});if(Z)throw Z;ft.success("Material wurde erfolgreich erstellt"),w(!1),K(),q()}catch(Z){console.error("Error creating material:",Z),ft.error("Fehler beim Erstellen des Materials")}},L=async()=>{if(A)try{const{error:Z}=await $.from("materials").update({...T,updated_at:new Date().toISOString(),updated_by:t==null?void 0:t.id}).eq("id",A.id);if(Z)throw Z;ft.success("Material wurde erfolgreich aktualisiert"),S(!1),C(null),K(),q()}catch(Z){console.error("Error updating material:",Z),ft.error("Fehler beim Aktualisieren des Materials")}},M=async Z=>{try{const{error:de}=await $.from("materials").update({is_active:!1}).eq("id",Z);if(de)throw de;ft.success("Material wurde erfolgreich gelöscht"),q()}catch(de){console.error("Error deleting material:",de),ft.error("Fehler beim Löschen des Materials")}},X=async()=>{try{const{error:Z}=await $.from("employee_material_usage").insert({...V,usage_date:new Date().toISOString().split("T")[0],created_by:t==null?void 0:t.id});if(Z)throw Z;ft.success("Materialverbrauch wurde erfolgreich erfasst"),k(!1),z(),R(),q()}catch(Z){console.error("Error recording material usage:",Z),ft.error("Fehler beim Erfassen des Materialverbrauchs")}},K=()=>{I({name:"",description:"",category:"",unit:"Stk",current_stock:0,min_stock:0,max_stock:0,unit_price:0,supplier_id:"",storage_location:""})},z=()=>{ne({material_id:"",employee_id:"",project_id:"",quantity_used:0,notes:""})},Y=Z=>{C(Z),I({name:Z.name,description:Z.description||"",category:Z.category,unit:Z.unit,current_stock:Z.current_stock,min_stock:Z.min_stock,max_stock:Z.max_stock,unit_price:Z.unit_price,supplier_id:Z.supplier_id||"",storage_location:Z.storage_location||""}),S(!0)},ae=(Z,de)=>Z<=de*.5?"bg-red-100 text-red-800":Z<=de?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",U=(Z,de)=>Z<=de*.5?"Kritisch":Z<=de?"Niedrig":"Verfügbar",Q=(Z,de)=>Math.min(Z/de*100,100),oe=a.filter(Z=>Z.name.toLowerCase().includes(g.toLowerCase())||Z.category.toLowerCase().includes(g.toLowerCase())),re=a.filter(Z=>Z.current_stock<=Z.min_stock),le=a.reduce((Z,de)=>Z+de.current_stock*de.unit_price,0);return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-red-600 bg-clip-text text-transparent flex items-center gap-3",children:[r.jsx(Ds,{className:"h-8 w-8 text-red-600"}),"Materialwirtschaft"]}),r.jsx("p",{className:"text-gray-600",children:"Vollständige Material- und Lagerverwaltung"})]}),r.jsx("div",{className:"flex gap-2",children:r.jsxs(W,{onClick:()=>w(!0),children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Materialien"}),r.jsx("p",{className:"text-2xl font-bold",children:a.length})]}),r.jsx(Ds,{className:"h-8 w-8 text-blue-600"})]})})}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Lagerwert"}),r.jsxs("p",{className:"text-2xl font-bold",children:["€",le.toLocaleString("de-DE",{maximumFractionDigits:0})]})]}),r.jsx(Bi,{className:"h-8 w-8 text-green-600"})]})})}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Niedrige Bestände"}),r.jsx("p",{className:"text-2xl font-bold",children:re.length})]}),r.jsx(Xn,{className:"h-8 w-8 text-yellow-600"})]})})}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Verbrauch (30 Tage)"}),r.jsx("p",{className:"text-2xl font-bold",children:m.length})]}),r.jsx(Ld,{className:"h-8 w-8 text-purple-600"})]})})})]}),r.jsxs(cr,{value:n,onValueChange:s,className:"w-full",children:[r.jsxs(tr,{className:"grid w-full grid-cols-5",children:[r.jsx(Oe,{value:"inventory",children:"Lagerbestand"}),r.jsx(Oe,{value:"usage",children:"Verbrauch"}),r.jsx(Oe,{value:"assignments",children:"Zuweisungen"}),r.jsx(Oe,{value:"prices",children:"Preise"}),r.jsx(Oe,{value:"analytics",children:"Analysen"})]}),r.jsxs(Fe,{value:"inventory",className:"space-y-6 min-h-[600px]",children:[r.jsx("div",{className:"flex justify-between items-center",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx(Mc,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),r.jsx(G,{placeholder:"Material suchen...",className:"pl-10 w-64",value:g,onChange:Z=>y(Z.target.value)})]}),r.jsxs(W,{variant:"outline",onClick:()=>k(!0),children:[r.jsx(g8,{className:"h-4 w-4 mr-2"}),"Verbrauch erfassen"]})]})}),r.jsx("div",{className:"grid gap-4",children:oe.map(Z=>r.jsx(J,{className:"hover:shadow-lg transition-shadow",children:r.jsxs(te,{className:"p-6",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h4",{className:"text-lg font-semibold",children:Z.name}),r.jsx(Ae,{className:ae(Z.current_stock,Z.min_stock),children:U(Z.current_stock,Z.min_stock)})]}),r.jsx("p",{className:"text-gray-600 mb-2",children:Z.category}),r.jsx("p",{className:"text-sm text-gray-500",children:Z.description})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-lg font-bold text-blue-600",children:["€",Z.unit_price.toFixed(2),"/",Z.unit]}),r.jsx("p",{className:"text-sm text-gray-500",children:Z.supplier_name})]})]}),r.jsxs("div",{className:"space-y-3 mb-4",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{children:"Lagerbestand"}),r.jsxs("span",{children:[Z.current_stock," ",Z.unit," / ",Z.max_stock," ",Z.unit]})]}),r.jsx(kc,{value:Q(Z.current_stock,Z.max_stock),className:"h-2"})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Mindestbestand:"}),r.jsxs("p",{children:[Z.min_stock," ",Z.unit]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Lagerwert:"}),r.jsxs("p",{children:["€",(Z.current_stock*Z.unit_price).toFixed(2)]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Lagerort:"}),r.jsx("p",{children:Z.storage_location||"Nicht angegeben"})]})]})]}),Z.current_stock<=Z.min_stock&&r.jsx("div",{className:"mb-4 p-2 bg-yellow-50 border border-yellow-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center gap-2 text-yellow-800",children:[r.jsx(Xn,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-medium",children:"Bestand unter Mindestmenge! Nachbestellung empfohlen."})]})}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(W,{size:"sm",variant:"outline",onClick:()=>Y(Z),children:[r.jsx(Io,{className:"h-4 w-4 mr-1"}),"Bearbeiten"]}),r.jsxs(W,{size:"sm",variant:"outline",onClick:()=>{C(Z),P(!0)},children:[r.jsx(th,{className:"h-4 w-4 mr-1"}),"Zuweisen"]}),r.jsxs(W,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",onClick:()=>M(Z.id),children:[r.jsx(ra,{className:"h-4 w-4 mr-1"}),"Löschen"]})]})]})},Z.id))})]}),r.jsx(Fe,{value:"usage",className:"space-y-6 min-h-[600px]",children:r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsx(xe,{children:"Materialverbrauch"}),r.jsx(Jn,{children:"Übersicht über den Materialverbrauch der letzten 50 Einträge"})]}),r.jsx(te,{children:r.jsx("div",{className:"space-y-4",children:m.map(Z=>r.jsxs("div",{className:"flex justify-between items-center p-4 border rounded-lg",children:[r.jsxs("div",{className:"flex-1",children:[r.jsx("h4",{className:"font-medium",children:Z.material_name}),r.jsxs("p",{className:"text-sm text-gray-600",children:[Z.employee_name," • ",Z.project_name]}),r.jsx("p",{className:"text-xs text-gray-500",children:new Date(Z.usage_date).toLocaleDateString("de-DE")})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"font-bold",children:[Z.quantity_used," ",Z.unit]}),Z.notes&&r.jsx("p",{className:"text-sm text-gray-600",children:Z.notes})]})]},Z.id))})})]})}),r.jsx(Fe,{value:"assignments",className:"space-y-6 min-h-[600px]",children:r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsx(xe,{children:"Projekt-Zuweisungen"}),r.jsx(Jn,{children:"Materialzuweisungen zu Projekten verwalten"})]}),r.jsx(te,{children:r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(As,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"Projekt-Zuweisungen werden hier angezeigt"}),r.jsx("p",{className:"text-sm",children:"Funktion wird in Kürze erweitert"})]})})]})}),r.jsx(Fe,{value:"analytics",className:"space-y-6 min-h-[600px]",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Bestandsanalyse"})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Materialien mit niedrigem Bestand:"}),r.jsx("span",{className:"font-bold text-red-600",children:re.length})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Durchschnittlicher Lagerwert pro Material:"}),r.jsxs("span",{className:"font-bold",children:["€",a.length>0?(le/a.length).toFixed(2):0]})]})]})})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Verbrauchsanalyse"})}),r.jsx(te,{children:r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(Ld,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),r.jsx("p",{children:"Detaillierte Verbrauchsanalysen"}),r.jsx("p",{className:"text-sm",children:"Werden in Kürze erweitert"})]})})]})]})}),r.jsx(Fe,{value:"prices",className:"space-y-6 min-h-[600px]",children:r.jsx(HQ,{})})]}),r.jsx(Mt,{open:v,onOpenChange:w,children:r.jsxs(Pt,{className:"max-w-2xl",children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Material hinzufügen"}),r.jsx(Nn,{children:"Fügen Sie ein neues Material zu Ihrem Lager hinzu"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Name *"}),r.jsx(G,{value:T.name,onChange:Z=>I(de=>({...de,name:Z.target.value})),placeholder:"Material-Name"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kategorie"}),r.jsxs(tt,{value:T.category,onValueChange:Z=>I(de=>({...de,category:Z})),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Kategorie wählen"})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Kabel & Leitungen",children:"Kabel & Leitungen"}),r.jsx(ce,{value:"Installationsmaterial",children:"Installationsmaterial"}),r.jsx(ce,{value:"Schaltgeräte",children:"Schaltgeräte"}),r.jsx(ce,{value:"Werkzeuge",children:"Werkzeuge"}),r.jsx(ce,{value:"Sonstiges",children:"Sonstiges"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Einheit *"}),r.jsxs(tt,{value:T.unit,onValueChange:Z=>I(de=>({...de,unit:Z})),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Einheit"})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Stk",children:"Stück"}),r.jsx(ce,{value:"m",children:"Meter"}),r.jsx(ce,{value:"kg",children:"Kilogramm"}),r.jsx(ce,{value:"l",children:"Liter"}),r.jsx(ce,{value:"m²",children:"Quadratmeter"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Preis pro Einheit (€)"}),r.jsx(G,{type:"number",step:"0.01",value:T.unit_price,onChange:Z=>I(de=>({...de,unit_price:parseFloat(Z.target.value)||0}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Aktueller Bestand"}),r.jsx(G,{type:"number",value:T.current_stock,onChange:Z=>I(de=>({...de,current_stock:parseFloat(Z.target.value)||0}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mindestbestand"}),r.jsx(G,{type:"number",value:T.min_stock,onChange:Z=>I(de=>({...de,min_stock:parseFloat(Z.target.value)||0}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Maximalbestand"}),r.jsx(G,{type:"number",value:T.max_stock,onChange:Z=>I(de=>({...de,max_stock:parseFloat(Z.target.value)||0}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Lieferant"}),r.jsxs(tt,{value:T.supplier_id,onValueChange:Z=>I(de=>({...de,supplier_id:Z})),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Lieferant wählen"})}),r.jsx(Xe,{children:o.map(Z=>r.jsx(ce,{value:Z.id,children:Z.name},Z.id))})]})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Beschreibung"}),r.jsx(an,{value:T.description,onChange:Z=>I(de=>({...de,description:Z.target.value})),placeholder:"Beschreibung des Materials...",rows:3})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Lagerort"}),r.jsx(G,{value:T.storage_location,onChange:Z=>I(de=>({...de,storage_location:Z.target.value})),placeholder:"z.B. Lager A, Regal 1"})]})]}),r.jsxs(Qd,{children:[r.jsx(W,{variant:"outline",onClick:()=>w(!1),children:"Abbrechen"}),r.jsx(W,{onClick:D,disabled:!T.name,children:"Material erstellen"})]})]})}),r.jsx(Mt,{open:j,onOpenChange:S,children:r.jsxs(Pt,{className:"max-w-2xl",children:[r.jsx(Bt,{children:r.jsx(Lt,{children:"Material bearbeiten"})}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Name *"}),r.jsx(G,{value:T.name,onChange:Z=>I(de=>({...de,name:Z.target.value}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Aktueller Bestand"}),r.jsx(G,{type:"number",value:T.current_stock,onChange:Z=>I(de=>({...de,current_stock:parseFloat(Z.target.value)||0}))})]})]}),r.jsxs(Qd,{children:[r.jsx(W,{variant:"outline",onClick:()=>S(!1),children:"Abbrechen"}),r.jsx(W,{onClick:L,children:"Aktualisieren"})]})]})}),r.jsx(Mt,{open:N,onOpenChange:k,children:r.jsxs(Pt,{children:[r.jsxs(Bt,{children:[r.jsx(Lt,{children:"Materialverbrauch erfassen"}),r.jsx(Nn,{children:"Erfassen Sie den Verbrauch von Material durch einen Mitarbeiter"})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Material"}),r.jsxs(tt,{value:V.material_id,onValueChange:Z=>ne(de=>({...de,material_id:Z})),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Material wählen"})}),r.jsx(Xe,{children:a.map(Z=>r.jsxs(ce,{value:Z.id,children:[Z.name," (",Z.current_stock," ",Z.unit," verfügbar)"]},Z.id))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mitarbeiter"}),r.jsxs(tt,{value:V.employee_id,onValueChange:Z=>ne(de=>({...de,employee_id:Z})),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Mitarbeiter wählen"})}),r.jsx(Xe,{children:u.map(Z=>r.jsxs(ce,{value:Z.id,children:[Z.first_name," ",Z.last_name]},Z.id))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Projekt"}),r.jsxs(tt,{value:V.project_id,onValueChange:Z=>ne(de=>({...de,project_id:Z})),children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Projekt wählen"})}),r.jsx(Xe,{children:c.map(Z=>r.jsx(ce,{value:Z.id,children:Z.name},Z.id))})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Verbrauchte Menge"}),r.jsx(G,{type:"number",step:"0.1",value:V.quantity_used,onChange:Z=>ne(de=>({...de,quantity_used:parseFloat(Z.target.value)||0}))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notizen (optional)"}),r.jsx(an,{value:V.notes,onChange:Z=>ne(de=>({...de,notes:Z.target.value})),rows:2})]})]}),r.jsxs(Qd,{children:[r.jsx(W,{variant:"outline",onClick:()=>k(!1),children:"Abbrechen"}),r.jsx(W,{onClick:X,disabled:!V.material_id||!V.employee_id||!V.project_id||!V.quantity_used,children:"Verbrauch erfassen"})]})]})}),r.jsx(WQ,{isOpen:E,onClose:()=>P(!1),selectedMaterial:A,onAssignmentComplete:()=>{q(),R()}})]})},KQ=({machine:t})=>{const e=a=>{switch(a){case"Verfügbar":return"bg-green-100 text-green-800";case"Im Einsatz":return"bg-blue-100 text-blue-800";case"Wartung fällig":return"bg-red-100 text-red-800";case"In Wartung":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},n=a=>{switch(a){case"Sehr gut":return"text-green-600";case"Gut":return"text-blue-600";case"Ausreichend":return"text-yellow-600";case"Wartung erforderlich":return"text-red-600";default:return"text-gray-600"}},s=a=>{switch(a){case"Verfügbar":return r.jsx(Rn,{className:"h-4 w-4 text-green-600"});case"Im Einsatz":return r.jsx(Ht,{className:"h-4 w-4 text-blue-600"});case"Wartung fällig":return r.jsx(Xn,{className:"h-4 w-4 text-red-600"});case"In Wartung":return r.jsx(yv,{className:"h-4 w-4 text-yellow-600"});default:return r.jsx(Rn,{className:"h-4 w-4 text-gray-600"})}};return r.jsx(J,{className:"hover:shadow-lg transition-shadow",children:r.jsxs(te,{className:"p-6 flex flex-col h-full",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s(t.status),r.jsx("h4",{className:"text-lg font-semibold",children:t.name}),r.jsx(Ae,{className:e(t.status),children:t.status})]}),r.jsx("p",{className:"text-gray-600 mb-2",children:t.category}),r.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1 mb-2",children:[r.jsx(la,{className:"h-4 w-4"}),t.location]}),r.jsxs("p",{className:"text-sm flex items-center gap-1",children:[r.jsx("span",{className:"text-gray-500",children:"Zustand:"}),r.jsx("span",{className:`font-medium ${n(t.condition)}`,children:t.condition})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",t.id]}),r.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[t.operatingHours,"h"]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Betriebsstunden"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4 flex-grow",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Letzte Wartung:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(gt,{className:"h-4 w-4"}),t.lastMaintenance]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Nächste Wartung:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(gt,{className:"h-4 w-4"}),t.nextMaintenance]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"DGUV V3 Prüfung:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(gt,{className:"h-4 w-4"}),t.dguv]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-gray-500",children:"Nächste DGUV V3:"}),r.jsxs("p",{className:"flex items-center gap-1",children:[r.jsx(gt,{className:"h-4 w-4"}),t.nextDguv]})]})]}),t.status==="Wartung fällig"&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[r.jsx(Xn,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-medium",children:"Wartung überfällig! Gerät nicht verwenden."})]})}),r.jsxs("div",{className:"flex gap-2 mt-auto",children:[r.jsx(W,{size:"sm",variant:"outline",children:"Details"}),r.jsxs(W,{size:"sm",variant:"outline",children:[r.jsx(gt,{className:"h-4 w-4 mr-1"}),"Wartung"]}),t.status==="Wartung fällig"&&r.jsxs(W,{size:"sm",className:"bg-red-600 hover:bg-red-700",children:[r.jsx(yv,{className:"h-4 w-4 mr-1"}),"Wartung planen"]})]})]})})},GQ=({machines:t})=>{const e=t.length,n=t.filter(i=>i.status==="Verfügbar").length,s=t.filter(i=>i.status==="Im Einsatz").length,a=t.filter(i=>i.status==="Wartung fällig").length;return r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsx(J,{children:r.jsxs(te,{className:"flex items-center justify-between p-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Ger\\u00e4te gesamt"}),r.jsx("p",{className:"text-lg font-bold",children:e})]}),r.jsx(Fi,{className:"w-5 h-5 text-blue-500"})]})}),r.jsx(J,{children:r.jsxs(te,{className:"flex items-center justify-between p-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Verf\\u00fcgbar"}),r.jsx("p",{className:"text-lg font-bold",children:n})]}),r.jsx(Rn,{className:"w-5 h-5 text-green-500"})]})}),r.jsx(J,{children:r.jsxs(te,{className:"flex items-center justify-between p-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Im Einsatz"}),r.jsx("p",{className:"text-lg font-bold",children:s})]}),r.jsx(Ht,{className:"w-5 h-5 text-yellow-500"})]})}),r.jsx(J,{children:r.jsxs(te,{className:"flex items-center justify-between p-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Wartung f\\u00e4llig"}),r.jsx("p",{className:"text-lg font-bold",children:a})]}),r.jsx(Xn,{className:"w-5 h-5 text-red-500"})]})})]})},ZQ=()=>{const t=[{machine:"Hubarbeitsbühne Genie GS-1932",type:"Wartung",date:"20.01.2024",priority:"Hoch"},{machine:"Bohrmaschine Hilti TE 6-A36",type:"Wartung",date:"15.03.2024",priority:"Mittel"},{machine:"Kabelzuggerät Greenlee 855GX",type:"Wartung",date:"08.04.2024",priority:"Niedrig"},{machine:"Messgerät Fluke 1587",type:"DGUV V3",date:"05.01.2025",priority:"Niedrig"}],e=n=>{switch(n){case"Hoch":return"bg-red-100 text-red-800";case"Mittel":return"bg-yellow-100 text-yellow-800";case"Niedrig":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(gt,{className:"h-5 w-5"}),"Wartungsplan"]})}),r.jsx(te,{children:r.jsx("div",{className:"space-y-3",children:t.map(n=>r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx(Ae,{variant:"outline",className:"text-xs",children:n.type}),r.jsx(Ae,{className:e(n.priority),children:n.priority})]}),r.jsx("p",{className:"font-medium text-sm mb-1",children:n.machine}),r.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[r.jsx(gt,{className:"h-3 w-3"}),n.date]})]},`${n.machine}-${n.date}`))})})]})},QQ=()=>r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{className:"text-base",children:"Geräteaktionen"})}),r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs(W,{variant:"outline",className:"w-full justify-start",children:[r.jsx(gt,{className:"h-4 w-4 mr-2"}),"Wartung planen"]}),r.jsxs(W,{variant:"outline",className:"w-full justify-start",children:[r.jsx(Rn,{className:"h-4 w-4 mr-2"}),"DGUV V3 Prüfung"]}),r.jsxs(W,{variant:"outline",className:"w-full justify-start",children:[r.jsx(la,{className:"h-4 w-4 mr-2"}),"Standort ändern"]}),r.jsxs(W,{variant:"outline",className:"w-full justify-start",children:[r.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Inventar"]})]})})]}),YQ=()=>r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{className:"text-base text-red-600",children:"Wartung überfällig"})}),r.jsx(te,{className:"p-4",children:r.jsx("div",{className:"space-y-2",children:r.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 rounded",children:[r.jsx("span",{className:"text-sm",children:"Hubarbeitsbühne"}),r.jsx("span",{className:"text-xs text-red-600",children:"3 Tage"})]})})})]}),JQ=()=>{const t=[{id:"M001",name:"Bohrmaschine Hilti TE 6-A36",category:"Bohrgeräte",location:"Baustelle Müller GmbH",status:"Im Einsatz",lastMaintenance:"15.12.2023",nextMaintenance:"15.03.2024",dguv:"22.11.2023",nextDguv:"22.11.2024",operatingHours:324,condition:"Gut"},{id:"M002",name:"Messgerät Fluke 1587",category:"Messgeräte",location:"Lager",status:"Verfügbar",lastMaintenance:"10.01.2024",nextMaintenance:"10.07.2024",dguv:"05.01.2024",nextDguv:"05.01.2025",operatingHours:156,condition:"Sehr gut"},{id:"M003",name:"Hubarbeitsbühne Genie GS-1932",category:"Hebegeräte",location:"Baustelle Weber Bau",status:"Wartung fällig",lastMaintenance:"20.10.2023",nextMaintenance:"20.01.2024",dguv:"15.12.2023",nextDguv:"15.12.2024",operatingHours:892,condition:"Wartung erforderlich"},{id:"M004",name:"Kabelzuggerät Greenlee 855GX",category:"Installationshilfen",location:"Fahrzeug 1",status:"Im Einsatz",lastMaintenance:"08.01.2024",nextMaintenance:"08.04.2024",dguv:"30.11.2023",nextDguv:"30.11.2024",operatingHours:245,condition:"Gut"}];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-indigo-600 bg-clip-text text-transparent flex items-center gap-3",children:[r.jsx(Fi,{className:"h-8 w-8 text-indigo-600"}),"Maschinen & Geräte"]}),r.jsx("p",{className:"text-gray-600",children:"Verwalten Sie Ihren Maschinenpark und Wartungsintervalle"})]}),r.jsxs(W,{children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Gerät hinzufügen"]})]}),r.jsx(GQ,{machines:t}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Maschinenübersicht"}),t.map(e=>r.jsx(KQ,{machine:e},e.id))]}),r.jsxs("div",{className:"space-y-6",children:[r.jsx(ZQ,{}),r.jsx(QQ,{}),r.jsx(YQ,{})]})]})]})},XQ=()=>{const{toast:t}=pt(),{data:e,isLoading:n}=qD(),{data:s,isLoading:a}=NW(),{data:i,isLoading:o}=SW(),[l,c]=f.useState([]),[d,u]=f.useState(!0),[h,m]=f.useState({hoursPerDay:0,breakHours:0,loaded:!1});WD();const[p,b]=f.useState("dashboard"),[x,g]=f.useState([]),[y,v]=f.useState(!1),[w,j]=f.useState(null),[S,N]=f.useState({}),[k,E]=f.useState(!1),[P,A]=f.useState({name:"",icon:"💼",items:[{name:"",value:"0"}]}),[C,T]=f.useState([]);f.useEffect(()=>{const z=localStorage.getItem("handwerkos_custom_categories");if(z)try{T(JSON.parse(z))}catch(Y){console.error("Error loading saved categories:",Y)}},[]),f.useEffect(()=>{C.length>0&&localStorage.setItem("handwerkos_custom_categories",JSON.stringify(C))},[C]),f.useEffect(()=>{console.log("🔄 Working hours state updated:",h)},[h]);const[I,V]=f.useState({miete:"1.000",nebenkosten:"300",reinigung:"100",fahrzeugLeasing:"500",fahrzeugVersicherung:"150",fahrzeugSteuer:"100",versicherungHaftpflicht:"200",versicherungRente:"300",versicherungBerufsunfaehigkeit:"150",verwaltungSoftware:"150",verwaltungSteuerberater:"250",verwaltungMarketing:"200",personalGehaelter:"708",personalSozialversicherung:"142",personalWeihnachtsgeld:"100"}),ne=()=>{const Y=1400+q().total+750+392+600,ae=C.reduce((U,Q)=>U+Q.total,0);return Y+ae},se=z=>z.reduce((Y,ae)=>{const U=parseFloat(ae.value.replace(/[^\d.-]/g,""))||0;return Y+U},0),q=()=>{if(console.log("FinanceModule calculatePersonnelCosts:",{employees:l,employeeCount:(l==null?void 0:l.length)||0,employeesLoading:d}),!l||l.length===0)return console.log("FinanceModule: No employees found, returning zero costs"),{totalSalaries:0,socialInsurance:0,bonuses:0,total:0,employeeCount:0};const z=localStorage.getItem("employeeWages"),Y=z?JSON.parse(z):[];console.log("💾 Loaded wages from localStorage:",Y);const ae=l.filter(he=>{var $e;const Re=($e=he.status)==null?void 0:$e.toLowerCase();return Re==="active"||Re==="aktiv"||!he.status}),U=ae.length,Q=ae.reduce((he,Re)=>{const wt=21.25*h.hoursPerDay,me=Y.find(Ze=>Ze.employee_id===Re.id),je=(me==null?void 0:me.hourly_wage)||Re.hourly_rate||0,Se=je*wt;return console.log(`👷 Employee ${Re.first_name} ${Re.last_name}:`,{status:Re.status,hourly_rate_from_db:Re.hourly_rate,hourly_rate_from_localStorage:me==null?void 0:me.hourly_wage,hourly_rate_used:je,hours_per_month:wt,calculated_monthly:Se.toFixed(2)+"€"}),(!Re.hourly_rate||Re.hourly_rate===0)&&console.warn(`⚠️ Employee ${Re.first_name} ${Re.last_name} has no hourly rate set!`),he+Se},0);console.log("💰 Total monthly salaries calculation:",{activeEmployeeCount:U,totalMonthlySalaries:Q.toFixed(2)+"€"});const re=Q*.21,Z=Q*2/12,de={totalSalaries:Q,socialInsurance:re,bonuses:Z,total:Q+re+Z,employeeCount:U};return console.log("Personnel costs calculation result:",de),de},O=()=>{const z=ne()/12,Y=8e3/12,ae=25e3/12,U=z+Y+ae,Q=21.25,oe=h.hoursPerDay-h.breakHours,re=Q*oe,le=U/re,Z=le*1.3;return{minimumRate:le,recommendedRate:Z,totalAmount:U,workingHours:re}};e!=null&&e.items;const F=(s==null?void 0:s.items)||[],B=i||{monthly_revenue:0,monthly_expenses:0,monthly_profit:0,total_outstanding:0,overdue_count:0,active_projects_profit:0,avg_profit_margin:0,revenue_trend:0,expense_trend:0,profit_trend:0},R=n||a||o||d,D=async()=>{try{console.log("⏰ Starting to fetch company working hours...",new Date().toISOString());const{data:z}=await $.auth.getUser();if(!(z!=null&&z.user)){console.log("❌ No authenticated user");return}const{data:Y,error:ae}=await $.from("profiles").select("company_id").eq("id",z.user.id).single();if(console.log("👤 Profile query result:",{profile:Y,profileError:ae}),!(Y!=null&&Y.company_id)){console.log("❌ No company_id found in profile");return}console.log("🔍 Fetching settings for company_id:",Y.company_id);const{data:U,error:Q}=await $.from("company_settings").select("default_working_hours_start, default_working_hours_end, default_break_duration, company_id").eq("company_id",Y.company_id).single();if(console.log("📊 Query result:",{settings:U,error:Q}),Q||!U){console.log("⚠️ No company settings found, checking if we need to create them");const{data:Ne,error:mt}=await $.from("company_settings").insert({company_id:Y.company_id,company_name:"Meine Firma",default_working_hours_start:"08:00:00",default_working_hours_end:"17:00:00",default_break_duration:30,default_tax_rate:19,default_currency:"EUR",quote_validity_days:30,invoice_prefix:"R",quote_prefix:"Q",order_prefix:"A"}).select().single();if(mt){console.log("⚠️ Could not create settings, using default values. Error:",mt),m({hoursPerDay:8,breakHours:.5,loaded:!0});return}console.log("✅ Created default company settings:",Ne),m({hoursPerDay:9,breakHours:.5,loaded:!0});return}console.log("📋 Raw company settings:",U);const oe=U.default_working_hours_start||"08:00",re=U.default_working_hours_end||"17:00",le=oe.substring(0,5),Z=re.substring(0,5),de=U.default_break_duration||30,[he,Re]=le.split(":").map(Number),[$e,wt]=Z.split(":").map(Number),me=he*60+Re,je=$e*60+wt,Se=je-me,Ze=Se/60,Me=de/60;console.log("🔢 Calculated hours:",{startMinutes:me,endMinutes:je,workMinutesPerDay:Se,hoursPerDay:Ze,breakHours:Me}),m({hoursPerDay:Ze,breakHours:Me,loaded:!0}),console.log("🕐 Company working hours loaded:",{startTime:le,endTime:Z,breakMinutes:de,hoursPerDay:Ze,breakHours:Me,productiveHours:Ze-Me})}catch(z){console.error("❌ ERROR fetching company working hours:",z),console.log("⚠️ Using fallback values due to error"),m({hoursPerDay:8,breakHours:.5,loaded:!0})}};f.useEffect(()=>{D(),(async()=>{try{u(!0);const{data:Y}=await $.auth.getUser();if(!(Y!=null&&Y.user)){console.log("No authenticated user"),c([]),u(!1);return}const{data:ae}=await $.from("profiles").select("company_id").eq("id",Y.user.id).single();if(!(ae!=null&&ae.company_id)){console.log("No company_id found"),c([]),u(!1);return}const{data:U,error:Q}=await $.from("employees").select("id, first_name, last_name, status, hourly_rate, position").eq("company_id",ae.company_id);if(Q)console.error("❌ Error fetching employees:",Q),c([]);else{console.log("✅ Fetched employees successfully:",U),console.log("📊 Employee details:",U==null?void 0:U.map(re=>({name:`${re.first_name} ${re.last_name}`,position:re.position,status:re.status,hourly_rate:re.hourly_rate,has_hourly_rate:re.hourly_rate!==null&&re.hourly_rate>0})));const oe=(U==null?void 0:U.filter(re=>!re.hourly_rate||re.hourly_rate===0))||[];oe.length>0&&console.warn("⚠️ Employees without hourly rate:",oe.map(re=>`${re.first_name} ${re.last_name}`)),c(U||[])}}catch(Y){console.error("Error in fetchEmployees:",Y),c([])}finally{u(!1)}})(),L()},[]),f.useEffect(()=>{if(console.log("🎯 Tab changed to:",p),p==="fixkosten"){console.log("📍 Tab is fixkosten, fetching working hours..."),D();const z=setInterval(()=>{console.log("🔄 Refreshing working hours (interval)..."),D()},5e3);return()=>{console.log("🛑 Clearing interval for working hours refresh"),clearInterval(z)}}},[p]),f.useEffect(()=>{const z=()=>{document.visibilityState==="visible"&&p==="fixkosten"&&D()},Y=()=>{p==="fixkosten"&&D()};return document.addEventListener("visibilitychange",z),window.addEventListener("focus",Y),()=>{document.removeEventListener("visibilitychange",z),window.removeEventListener("focus",Y)}},[p]);const L=async()=>{g([{month:"2024-08",revenue:22e3,expenses:16e3,profit:6e3},{month:"2024-09",revenue:28e3,expenses:19e3,profit:9e3},{month:"2024-10",revenue:31e3,expenses:22e3,profit:9e3},{month:"2024-11",revenue:26e3,expenses:18500,profit:7500},{month:"2024-12",revenue:35e3,expenses:24e3,profit:11e3},{month:"2025-01",revenue:25e3,expenses:18e3,profit:7e3}])},M=z=>{switch(z){case"materials":return"🧱";case"subcontractor":return"👷";case"labor":return"⏰";case"operating":return"🏢";default:return"📋"}},X=z=>{switch(z){case"materials":return"Material";case"subcontractor":return"Nachunternehmer";case"labor":return"Lohn";case"operating":return"Betriebskosten";default:return"Sonstiges"}},K=z=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(z);return R?r.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[r.jsxs("div",{className:"flex items-center justify-between mb-8",children:[r.jsx(Ke,{className:"h-10 w-64"}),r.jsxs("div",{className:"flex gap-6",children:[r.jsx(Ke,{className:"h-10 w-24"}),r.jsx(Ke,{className:"h-10 w-32"})]})]}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:Array(4).fill(0).map((z,Y)=>r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(Ke,{className:"h-4 w-20 mb-2"}),r.jsx(Ke,{className:"h-8 w-16"}),r.jsx(Ke,{className:"h-3 w-12 mt-1"})]}),r.jsx(Ke,{className:"h-8 w-8 rounded-full"})]})})},Y))}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(Ke,{className:"h-6 w-32"})}),r.jsx(te,{children:r.jsx("div",{className:"space-y-4",children:Array(5).fill(0).map((z,Y)=>r.jsx("div",{className:"border rounded p-4",children:r.jsx(Ke,{className:"h-20 w-full"})},Y))})})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(Ke,{className:"h-6 w-32"})}),r.jsx(te,{children:r.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((z,Y)=>r.jsx("div",{className:"p-3 bg-gray-50 rounded",children:r.jsx(Ke,{className:"h-16 w-full"})},Y))})})]})]})]}):r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Finanzen & Buchhaltung"}),r.jsx("div",{className:"flex items-center gap-4",children:r.jsxs(W,{variant:"outline",className:"rounded-full",children:[r.jsx(Hh,{className:"h-4 w-4 mr-2"}),"Export"]})})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsumsatz"}),r.jsx("p",{className:"text-2xl font-bold text-green-700",children:K(B.monthly_revenue)})]}),r.jsx(Fr,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsausgaben"}),r.jsx("p",{className:"text-2xl font-bold text-red-700",children:K(B.monthly_expenses)})]}),r.jsx(Pb,{className:"h-8 w-8 text-red-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsgewinn"}),r.jsx("p",{className:"text-2xl font-bold text-blue-700",children:K(B.monthly_profit)})]}),r.jsx(Bi,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Offene Posten"}),r.jsx("p",{className:"text-2xl font-bold text-orange-700",children:K(B.total_outstanding)}),r.jsx(Xn,{className:"h-8 w-8 text-orange-500 opacity-50"})]})})})]}),r.jsxs(cr,{value:p,onValueChange:b,className:"w-full",children:[r.jsxs(tr,{className:"grid w-full grid-cols-5 mb-6",children:[r.jsxs(Oe,{value:"dashboard",className:"flex items-center gap-2",children:[r.jsx(Ld,{className:"h-4 w-4"}),"Dashboard"]}),r.jsxs(Oe,{value:"expenses",className:"flex items-center gap-2",children:[r.jsx(Sr,{className:"h-4 w-4"}),"Ausgaben"]}),r.jsxs(Oe,{value:"fixkosten",className:"flex items-center gap-2",children:[r.jsx(ws,{className:"h-4 w-4"}),"Betriebskosten"]}),r.jsxs(Oe,{value:"reports",className:"flex items-center gap-2",children:[r.jsx(Ld,{className:"h-4 w-4"}),"Berichte"]}),r.jsxs(Oe,{value:"tax",className:"flex items-center gap-2",children:[r.jsx(Fr,{className:"h-4 w-4"}),"Steuer"]})]}),r.jsx(Fe,{value:"dashboard",className:"space-y-6",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsxs(J,{className:"lg:col-span-2",children:[r.jsx(pe,{children:r.jsx(xe,{children:"📊 Umsatz-Verlauf (letzte 6 Monate)"})}),r.jsx(te,{children:r.jsx("div",{className:"space-y-4",children:x.map((z,Y)=>{const ae=new Date(z.month+"-01").toLocaleDateString("de-DE",{month:"short",year:"numeric"}),U=Math.max(...x.map(re=>re.revenue)),Q=z.revenue/U*100,oe=z.expenses/U*100;return r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:ae}),r.jsxs("span",{className:"font-medium",children:[K(z.profit)," Gewinn"]})]}),r.jsxs("div",{className:"relative h-6 bg-gray-100 rounded",children:[r.jsx("div",{className:"absolute h-full bg-green-500 rounded",style:{width:`${Q}%`}}),r.jsx("div",{className:"absolute h-full bg-red-400 rounded",style:{width:`${oe}%`}})]}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[r.jsxs("span",{children:["Umsatz: ",K(z.revenue)]}),r.jsxs("span",{children:["Ausgaben: ",K(z.expenses)]})]})]},Y)})})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"⚡ Schnellzugriff"})}),r.jsxs(te,{className:"space-y-3",children:[r.jsxs(W,{className:"w-full justify-start",variant:"outline",children:[r.jsx(mn,{className:"h-4 w-4 mr-2"}),"Neue Rechnung"]}),r.jsxs(W,{className:"w-full justify-start",variant:"outline",children:[r.jsx(Sr,{className:"h-4 w-4 mr-2"}),"Ausgabe erfassen"]}),r.jsxs(W,{className:"w-full justify-start",variant:"outline",children:[r.jsx(Fr,{className:"h-4 w-4 mr-2"}),"Zahlung erfassen"]}),r.jsxs(W,{className:"w-full justify-start",variant:"outline",children:[r.jsx(Hh,{className:"h-4 w-4 mr-2"}),"DATEV Export"]})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"💎 Projekt-Rentabilität"})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm",children:"Aktive Projekte"}),r.jsx("span",{className:"font-medium",children:K(B.active_projects_profit)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-sm",children:"Ø Gewinnmarge"}),r.jsxs(Ae,{variant:"outline",children:[B.avg_profit_margin.toFixed(1),"%"]})]})]})})]})]})]})}),r.jsx(Fe,{value:"expenses",className:"space-y-6",children:r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"💸 Ausgabenmanagement"})}),r.jsx(te,{children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-4",children:"📋 Aktuelle Ausgaben"}),r.jsx("div",{className:"space-y-3",children:F.map(z=>r.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-2xl",children:M(z.category)}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:z.description}),r.jsxs("p",{className:"text-sm text-gray-500",children:[X(z.category)," • ",new Date(z.date).toLocaleDateString("de-DE")]}),z.project&&r.jsxs("p",{className:"text-xs text-blue-600",children:["→ ",z.project]})]})]}),r.jsx("div",{className:"text-right",children:r.jsx("p",{className:"font-bold text-red-600",children:K(z.amount)})})]},z.id))})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-4",children:"📊 Ausgaben-Kategorien"}),r.jsx("div",{className:"space-y-3",children:["materials","subcontractor","labor","operating"].map(z=>{const Y=F.filter(U=>U.category===z),ae=Y.reduce((U,Q)=>U+Q.amount,0);return r.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xl",children:M(z)}),r.jsx("span",{className:"font-medium",children:X(z)})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"font-bold",children:K(ae)}),r.jsxs("p",{className:"text-sm text-gray-500",children:[Y.length," Ausgaben"]})]})]},z)})})]})]})})]})}),r.jsx(Fe,{value:"reports",className:"space-y-6",children:r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"📊 Finanzberichte & Auswertungen"})}),r.jsx(te,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.jsxs(W,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(mn,{className:"h-6 w-6"}),r.jsx("span",{children:"Offene Posten Liste"})]}),r.jsxs(W,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(Bi,{className:"h-6 w-6"}),r.jsx("span",{children:"Umsatzauswertung"})]}),r.jsxs(W,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(Ld,{className:"h-6 w-6"}),r.jsx("span",{children:"Projekt-Rentabilität"})]}),r.jsxs(W,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(ws,{className:"h-6 w-6"}),r.jsx("span",{children:"Kostenanalyse"})]}),r.jsxs(W,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(Fr,{className:"h-6 w-6"}),r.jsx("span",{children:"Liquiditätsplanung"})]}),r.jsxs(W,{variant:"outline",className:"h-20 flex-col gap-2",children:[r.jsx(Hh,{className:"h-6 w-6"}),r.jsx("span",{children:"Jahresauswertung"})]})]})})]})}),r.jsx(Fe,{value:"tax",className:"space-y-6",children:r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"🏛️ Steuerliche Compliance"})}),r.jsx(te,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-4",children:"📊 Umsatzsteuer"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"p-3 border rounded-lg",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Umsatz 19% USt"}),r.jsx("span",{className:"font-medium",children:K(18e3)})]}),r.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[r.jsx("span",{children:"Umsatzsteuer 19%"}),r.jsx("span",{children:K(3420)})]})]}),r.jsxs("div",{className:"p-3 border rounded-lg",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Umsatz 7% USt"}),r.jsx("span",{className:"font-medium",children:K(2e3)})]}),r.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[r.jsx("span",{children:"Umsatzsteuer 7%"}),r.jsx("span",{children:K(140)})]})]}),r.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:r.jsxs("div",{className:"flex justify-between font-semibold",children:[r.jsx("span",{children:"Gesamte USt-Schuld"}),r.jsx("span",{className:"text-blue-600",children:K(3560)})]})})]})]}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold mb-4",children:"📁 Export & Berichte"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(W,{variant:"outline",className:"w-full justify-start",children:[r.jsx(Hh,{className:"h-4 w-4 mr-2"}),"DATEV-Export"]}),r.jsxs(W,{variant:"outline",className:"w-full justify-start",children:[r.jsx(vf,{className:"h-4 w-4 mr-2"}),"CSV-Export"]}),r.jsxs(W,{variant:"outline",className:"w-full justify-start",children:[r.jsx(mn,{className:"h-4 w-4 mr-2"}),"EÜR-Vorbereitung"]}),r.jsxs(W,{variant:"outline",className:"w-full justify-start",children:[r.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Steuer-Einstellungen"]})]})]})]})})]})}),r.jsx(Fe,{value:"fixkosten",className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(ws,{className:"h-5 w-5"}),"💰 Betriebskosten (monatlich)"]}),r.jsx(Jn,{children:"Verwalten Sie Ihre monatlichen Betriebskosten für die Stundensatz-Berechnung"})]}),r.jsxs(te,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs(J,{children:[r.jsx(pe,{className:"pb-3",children:r.jsxs(xe,{className:"flex items-center gap-2 text-base",children:[r.jsx("span",{className:"text-xl",children:"🏢"}),"Betrieb & Büro"]})}),r.jsxs(te,{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Miete/Pacht"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.miete,onChange:z=>V({...I,miete:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.miete," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Nebenkosten"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.nebenkosten,onChange:z=>V({...I,nebenkosten:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.nebenkosten," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Reinigung"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.reinigung,onChange:z=>V({...I,reinigung:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.reinigung," €"]})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:K(1400)})]})]})]}),r.jsxs(J,{children:[r.jsx(pe,{className:"pb-3",children:r.jsxs(xe,{className:"flex items-center gap-2 text-base",children:[r.jsx("span",{className:"text-xl",children:"👷‍♂️"}),"Personal"]})}),r.jsx(te,{className:"space-y-2",children:(()=>{const z=q();return r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("span",{className:"text-sm text-muted-foreground",children:["Fixgehälter Mitarbeiter (",z.employeeCount," MA)"]}),r.jsx("span",{className:"text-sm font-medium",children:K(z.totalSalaries)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Arbeitgeberanteile Sozialversicherung"}),r.jsx("span",{className:"text-sm font-medium",children:K(z.socialInsurance)})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Weihnachts-/Urlaubsgeld"}),r.jsx("span",{className:"text-sm font-medium",children:K(z.bonuses)})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:K(z.total)})]}),z.employeeCount===0&&r.jsxs("div",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded mt-2",children:["⚠️ Keine aktiven Mitarbeiter gefunden. Personalkosten sind 0 €.",r.jsx("br",{}),r.jsx("span",{className:"text-xs",children:"Stellen Sie sicher, dass Mitarbeiter einen Stundenlohn haben und aktiv sind."})]}),z.employeeCount>0&&z.total===0&&r.jsx("div",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded mt-2",children:"⚠️ Mitarbeiter gefunden, aber keine Stundenlöhne eingetragen."})]})})()})]}),r.jsxs(J,{children:[r.jsx(pe,{className:"pb-3",children:r.jsxs(xe,{className:"flex items-center gap-2 text-base",children:[r.jsx("span",{className:"text-xl",children:"🚗"}),"Fahrzeuge"]})}),r.jsxs(te,{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Leasing/Abschreibung"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.fahrzeugLeasing,onChange:z=>V({...I,fahrzeugLeasing:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.fahrzeugLeasing," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Versicherung"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.fahrzeugVersicherung,onChange:z=>V({...I,fahrzeugVersicherung:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.fahrzeugVersicherung," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Steuer & Wartung"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.fahrzeugSteuer,onChange:z=>V({...I,fahrzeugSteuer:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.fahrzeugSteuer," €"]})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:K(9e3)})]})]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs(J,{children:[r.jsx(pe,{className:"pb-3",children:r.jsxs(xe,{className:"flex items-center gap-2 text-base",children:[r.jsx("span",{className:"text-xl",children:"🛡️"}),"Versicherungen & Beiträge"]})}),r.jsxs(te,{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Betriebshaftpflicht"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.versicherungHaftpflicht,onChange:z=>V({...I,versicherungHaftpflicht:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.versicherungHaftpflicht," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Berufsgenossenschaft"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.versicherungRente,onChange:z=>V({...I,versicherungRente:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.versicherungRente," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Kammer/Innung"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.versicherungBerufsunfaehigkeit,onChange:z=>V({...I,versicherungBerufsunfaehigkeit:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.versicherungBerufsunfaehigkeit," €"]})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:K(4700)})]})]})]}),r.jsxs(J,{children:[r.jsx(pe,{className:"pb-3",children:r.jsxs(xe,{className:"flex items-center gap-2 text-base",children:[r.jsx("span",{className:"text-xl",children:"🏭"}),"Verwaltung & Organisation"]})}),r.jsxs(te,{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Software & Lizenzen"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.verwaltungSoftware,onChange:z=>V({...I,verwaltungSoftware:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.verwaltungSoftware," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Steuerberater"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.verwaltungSteuerberater,onChange:z=>V({...I,verwaltungSteuerberater:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.verwaltungSteuerberater," €"]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:"Marketing & Werbung"}),y?r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(G,{type:"text",value:I.verwaltungMarketing,onChange:z=>V({...I,verwaltungMarketing:z.target.value}),className:"h-7 w-20 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]}):r.jsxs("span",{className:"text-sm font-medium",children:[I.verwaltungMarketing," €"]})]}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:K(7200)})]})]})]}),C.map(z=>{const Y=y||w===z.id,ae=S[z.id]||z;return r.jsxs(J,{children:[r.jsx(pe,{className:"pb-3",children:r.jsxs(xe,{className:"flex items-center justify-between text-base",children:[r.jsx("div",{className:"flex items-center gap-2",children:Y?r.jsxs(r.Fragment,{children:[r.jsx(G,{type:"text",value:ae.icon,onChange:U=>N({...S,[z.id]:{...ae,icon:U.target.value}}),className:"w-12 h-8 text-center text-xl p-0"}),r.jsx(G,{type:"text",value:ae.name,onChange:U=>N({...S,[z.id]:{...ae,name:U.target.value}}),className:"h-8 text-base font-semibold"})]}):r.jsxs(r.Fragment,{children:[r.jsx("span",{className:"text-xl",children:z.icon}),r.jsx("span",{children:z.name})]})}),!y&&r.jsx(W,{size:"sm",variant:"ghost",onClick:()=>{T(U=>U.filter(Q=>Q.id!==z.id))},className:"h-7 w-7 p-0 text-red-500 hover:text-red-700",children:r.jsx(Mn,{className:"h-4 w-4"})})]})}),r.jsxs(te,{className:"space-y-2",children:[Y?r.jsxs(r.Fragment,{children:[ae.items.map((U,Q)=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(G,{type:"text",value:U.name,onChange:oe=>{const re=[...ae.items];re[Q].name=oe.target.value,N({...S,[z.id]:{...ae,items:re}})},className:"flex-1 h-7 text-sm"}),r.jsx(G,{type:"text",value:U.value,onChange:oe=>{const re=[...ae.items];re[Q].value=oe.target.value,N({...S,[z.id]:{...ae,items:re}})},className:"w-20 h-7 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]},Q)),r.jsxs(W,{variant:"outline",size:"sm",className:"w-full h-7 mt-2",onClick:()=>{const U=[...ae.items,{name:"",value:"0"}];N({...S,[z.id]:{...ae,items:U}})},children:[r.jsx(zt,{className:"h-3 w-3 mr-1"}),"Zeile hinzufügen"]})]}):r.jsx(r.Fragment,{children:z.items.map((U,Q)=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-sm text-muted-foreground",children:U.name}),r.jsxs("span",{className:"text-sm font-medium",children:[U.value," €"]})]},Q))}),r.jsx("hr",{className:"my-2"}),r.jsxs("div",{className:"flex justify-between items-center font-medium",children:[r.jsx("span",{children:"Gesamt"}),r.jsx("span",{children:K(Y?se(ae.items):z.total)})]})]})]},z.id)}),k?r.jsxs(J,{children:[r.jsx(pe,{className:"pb-3",children:r.jsx(xe,{className:"flex items-center gap-2 text-base",children:r.jsx(G,{type:"text",placeholder:"🏢 Kategorie Name",value:P.name,onChange:z=>A({...P,name:z.target.value}),className:"text-base font-semibold border-none p-0 h-auto bg-transparent"})})}),r.jsxs(te,{className:"space-y-2",children:[P.items.map((z,Y)=>r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(G,{type:"text",placeholder:"Kostenpunkt",value:z.name,onChange:ae=>{const U=[...P.items];U[Y].name=ae.target.value,A({...P,items:U})},className:"flex-1 h-7 text-sm"}),r.jsx(G,{type:"text",placeholder:"0",value:z.value,onChange:ae=>{const U=[...P.items];U[Y].value=ae.target.value,A({...P,items:U})},className:"w-20 h-7 text-right text-sm"}),r.jsx("span",{className:"text-sm",children:"€"})]},Y)),r.jsxs(W,{variant:"outline",size:"sm",className:"w-full h-7",onClick:()=>A({...P,items:[...P.items,{name:"",value:"0"}]}),children:[r.jsx(zt,{className:"h-3 w-3 mr-1"}),"Kostenpunkt hinzufügen"]}),r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsx(W,{variant:"outline",size:"sm",onClick:()=>{E(!1),A({name:"",icon:"💼",items:[{name:"",value:"0"}]})},children:r.jsx(Mn,{className:"h-4 w-4"})}),r.jsx(W,{size:"sm",onClick:()=>{if(P.name&&P.items.some(z=>z.name)){const z=se(P.items),Y={id:Date.now().toString(),name:P.name,icon:P.icon,items:P.items,total:z};T(ae=>[...ae,Y]),E(!1),A({name:"",icon:"💼",items:[{name:"",value:"0"}]}),t({title:"Kategorie erstellt",description:`"${P.name}" wurde erfolgreich hinzugefügt.`})}},children:r.jsx(wf,{className:"h-4 w-4"})})]})]})]}):r.jsx(J,{className:"border-dashed border-2 border-gray-300 hover:border-gray-400 transition-colors cursor-pointer",onClick:()=>E(!0),children:r.jsx(te,{className:"flex items-center justify-center h-48 p-4",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center mx-auto mb-3 transition-colors",children:r.jsx(zt,{className:"h-6 w-6 text-gray-400"})}),r.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Neue Kategorie"}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"hinzufügen"})]})})})]})]}),r.jsx("div",{className:"flex justify-end gap-2",children:y?r.jsxs(r.Fragment,{children:[r.jsx(W,{variant:"outline",size:"sm",onClick:()=>{v(!1),j(null),N({})},children:r.jsx(Mn,{className:"h-4 w-4"})}),r.jsx(W,{size:"sm",onClick:()=>{Object.keys(S).forEach(z=>{const Y=S[z],ae={...Y,total:se(Y.items)};T(U=>U.map(Q=>Q.id===z?ae:Q))}),v(!1),j(null),N({}),t({title:"Kosten aktualisiert",description:"Die Betriebskosten wurden erfolgreich gespeichert."})},children:r.jsx(wf,{className:"h-4 w-4"})})]}):r.jsx(W,{variant:"outline",size:"sm",onClick:()=>{v(!0);const z={};C.forEach(Y=>{z[Y.id]=Y}),N(z)},children:r.jsx(I8,{className:"h-4 w-4"})})})]})]}),r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-2xl",children:"⚡"}),"Stundensatz-Rechner"]}),r.jsx(Jn,{children:"Automatische Berechnung basierend auf Betriebskosten"})]}),r.jsxs(te,{className:"space-y-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"p-4 border rounded-lg",children:[r.jsx(H,{className:"text-sm text-muted-foreground",children:"Fixkosten (Betrieb)"}),r.jsxs("p",{className:"text-2xl font-bold",children:[K(ne()/12)," / Monat"]})]}),r.jsxs("div",{className:"p-4 border rounded-lg",children:[r.jsx(H,{className:"text-sm text-muted-foreground",children:"Variable Grundkosten"}),r.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[K(8e3/12)," / Monat"]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Material (netto), etc."})]}),r.jsxs("div",{className:"p-4 border rounded-lg",children:[r.jsx(H,{className:"text-sm text-muted-foreground",children:"Gewollter Gewinn"}),r.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[K(25e3/12)," / Monat"]})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsx(H,{className:"text-sm text-muted-foreground",children:"Arbeitstage 2025"}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("p",{className:"text-xl font-semibold",children:"261 Tage"}),r.jsx(Ae,{variant:"outline",children:"8 Stunden"})]})]}),r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsx(H,{className:"text-sm text-muted-foreground",children:"Urlaubstage:"}),r.jsx("p",{className:"text-lg",children:"- 30 Tage"})]}),r.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[r.jsx(H,{className:"text-sm text-muted-foreground",children:"Arbeitsstunden/Monat:"}),h.loaded?r.jsxs(r.Fragment,{children:[r.jsxs("p",{className:"text-xl font-semibold",children:[Math.round(21.25*h.hoursPerDay)," Stunden"]}),r.jsxs(Ae,{variant:"secondary",className:"mt-2",children:[Math.round(21.25*(h.hoursPerDay-h.breakHours))," Stunden (nach Pausen)"]}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["21,25 Tage × ",Number(h.hoursPerDay).toFixed(1),"h - ",Number(h.breakHours*60).toFixed(0)," Min. Pausen"]})]}):r.jsx("p",{className:"text-sm text-muted-foreground",children:"Lade Arbeitszeiten..."})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[r.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[r.jsx(H,{className:"text-sm text-muted-foreground",children:"Mindest-Stundensatz"}),r.jsx("p",{className:"text-3xl font-bold text-blue-600",children:K(O().minimumRate)}),r.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["(",K(O().totalAmount)," ÷ ",O().workingHours,"h)"]})]}),r.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[r.jsx(H,{className:"text-sm text-muted-foreground",children:"Empfohlener Stundensatz"}),r.jsx("p",{className:"text-3xl font-bold text-green-600",children:K(O().recommendedRate)}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"+30% Gewinnaufschlag & Rücklage"})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs(W,{size:"lg",children:[r.jsx(ws,{className:"h-4 w-4 mr-2"}),"Stundensatz anpassen"]})})]})]})]})})]})]})};var eY="Separator",M2="horizontal",tY=["horizontal","vertical"],o3=f.forwardRef((t,e)=>{const{decorative:n,orientation:s=M2,...a}=t,i=nY(s)?s:M2,l=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return r.jsx(Le.div,{"data-orientation":i,...l,...a,ref:e})});o3.displayName=eY;function nY(t){return tY.includes(t)}var l3=o3;const Ni=f.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...s},a)=>r.jsx(l3,{ref:a,decorative:n,orientation:e,className:_e("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...s}));Ni.displayName=l3.displayName;const rY=()=>{const[t,e]=f.useState(new Date),[n,s]=f.useState("month"),[a,i]=f.useState("overview"),[o,l]=f.useState("all"),[c,d]=f.useState("all"),[u,h]=f.useState([]),[m,p]=f.useState([]),[b,x]=f.useState([]),[g,y]=f.useState([]),[v,w]=f.useState([]),[j,S]=f.useState(!0),{toast:N}=pt();f.useEffect(()=>{k()},[]);const k=async()=>{S(!0);try{await Promise.all([E(),P(),A(),C(),T()])}catch(X){console.error("Error loading planner data:",X),N({title:"Fehler beim Laden",description:"Die Planerdaten konnten nicht geladen werden.",variant:"destructive"})}S(!1)},E=async()=>{const{data:X,error:K}=await $.from("projects").select("*").order("start_date");if(K)throw K;h(X||[])},P=async()=>{try{const{data:X}=await $.auth.getUser();if(!(X!=null&&X.user))return;const{data:K}=await $.from("profiles").select("company_id").eq("id",X.user.id).single();if(!(K!=null&&K.company_id))return;const{data:z,error:Y}=await $.from("employees").select("*").eq("company_id",K.company_id).neq("status","eingeladen").not("user_id","is",null).order("last_name");if(Y)throw Y;p(z||[])}catch(X){console.error("Error loading employees:",X)}},A=async()=>{const{data:X,error:K}=await $.from("employee_absences").select(`
        *,
        employee:employees!employee_absences_employee_id_fkey(*)
      `).order("start_date");if(K)throw K;x(X||[])},C=async()=>{const{data:X,error:K}=await $.from("calendar_events").select("*").order("start_date");if(K)throw K;y(X||[])},T=async()=>{const{data:X,error:K}=await $.from("project_assignments").select(`
        *,
        project:projects(*),
        employee:employees(*)
      `).order("start_date");if(K)throw K;w(X||[])},I=()=>n==="week"?{start:Is(t,{weekStartsOn:1}),end:cp(t,{weekStartsOn:1})}:{start:lr(t),end:lp(t)},{start:V,end:ne}=I();zV({start:V,end:ne});const se=()=>{e(n==="week"?rG(t,1):nG(t,1))},q=()=>{e(n==="week"?Iu(t,1):Vr(t,1))},O=X=>{switch(X){case"urlaub":return"bg-green-500";case"krank":return"bg-red-500";case"fortbildung":return"bg-blue-500";case"elternzeit":return"bg-purple-500";default:return"bg-gray-500"}},F=X=>{switch(X){case"urlaub":return r.jsx(gt,{className:"w-3 h-3"});case"krank":return r.jsx(k0,{className:"w-3 h-3"});case"fortbildung":return r.jsx(Ps,{className:"w-3 h-3"});default:return r.jsx(Ht,{className:"w-3 h-3"})}},B=X=>{switch(X){case"genehmigt":return r.jsx(Rn,{className:"w-3 h-3 text-green-500"});case"abgelehnt":return r.jsx(Eo,{className:"w-3 h-3 text-red-500"});default:return r.jsx(Ht,{className:"w-3 h-3 text-yellow-500"})}},R=[...new Set(m.map(X=>X.department).filter(Boolean))];c==="all"||m.filter(X=>X.department===c);const D=()=>{const X=t.getFullYear(),K=Array.from({length:12},(ae,U)=>U),z=Array.from({length:31},(ae,U)=>U+1),Y=(ae,U)=>{const Q=new Date(X,ae,U);if(Q.getMonth()!==ae)return null;Pe(Q,"yyyy-MM-dd");const oe=[];return u.forEach(re=>{const le=new Date(re.start_date),Z=re.end_date?new Date(re.end_date):le;Q>=le&&Q<=Z&&oe.push({type:"project",item:re,color:re.color})}),b.forEach(re=>{const le=new Date(re.start_date),Z=new Date(re.end_date);Q>=le&&Q<=Z&&oe.push({type:"absence",item:re,color:O(re.type).replace("bg-","")})}),g.forEach(re=>{const le=new Date(re.start_date),Z=new Date(re.end_date);Q>=le&&Q<=Z&&oe.push({type:"event",item:re,color:re.color})}),oe.length>0?oe:null};return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"120px repeat(31, 1fr)"},children:[r.jsx("div",{className:"p-3 border-r border-border font-medium text-center",children:"Monat"}),z.map(ae=>r.jsx("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:ae},ae))]}),K.map((ae,U)=>r.jsxs("div",{className:`grid ${U%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"120px repeat(31, 1fr)"},children:[r.jsx("div",{className:"p-3 border-r border-border font-medium text-center bg-muted/50",children:Pe(new Date(X,ae,1),"MMMM",{locale:Wt})}),z.map(Q=>{const re=new Date(X,ae,Q).getMonth()===ae,le=re?Y(ae,Q):null,Z=(he,Re)=>{if(he.type==="project"){const $e=new Date(he.item.start_date);return Un($e,Re)||$e<Re&&Q===1}if(he.type==="absence"){const $e=new Date(he.item.start_date);return Un($e,Re)||$e<Re&&Q===1}if(he.type==="event"){const $e=new Date(he.item.start_date);return Un($e,Re)||$e<Re&&Q===1}return!1},de=(he,Re)=>{const $e=new Date(X,ae,1),wt=new Date(X,ae+1,0);let me,je;he.type==="project"?(me=new Date(he.item.start_date),je=he.item.end_date?new Date(he.item.end_date):new Date):he.type==="absence"?(me=new Date(he.item.start_date),je=new Date(he.item.end_date)):(me=new Date(he.item.start_date),je=new Date(he.item.end_date));const Se=me<$e?$e:me,Ze=je>wt?wt:je,Me=Se.getDate(),Ne=Ze.getDate();return je>wt?wt.getDate()-Me+1:Ne-Me+1};return r.jsx("div",{className:`border-r border-border last:border-r-0 h-16 relative ${re?"":"bg-muted/30"}`,children:re&&le&&r.jsx("div",{className:"absolute inset-0 p-1",children:le.map((he,Re)=>{var je,Se,Ze,Me;const $e=new Date(X,ae,Q);if(!Z(he,$e))return null;const me=de(he);return r.jsxs("div",{className:"h-3 rounded text-white text-xs flex items-center justify-center font-medium shadow-sm absolute hover:h-4 hover:z-20 transition-all duration-200 group cursor-pointer",style:{backgroundColor:he.type==="project"?he.color:he.type==="absence"?`rgb(${he.color==="green-500"?"34 197 94":he.color==="red-500"?"239 68 68":he.color==="blue-500"?"59 130 246":"107 114 128"})`:he.item.color,width:`${me*100}%`,left:0,top:`${2+Re*14}px`,zIndex:10},title:he.type==="project"?`Projekt: ${he.item.name}`:he.type==="absence"?`${he.item.type}: ${(je=he.item.employee)==null?void 0:je.first_name} ${(Se=he.item.employee)==null?void 0:Se.last_name}`:`Termin: ${he.item.title}`,children:[me>=3&&r.jsxs(r.Fragment,{children:[he.type==="project"&&r.jsx(xl,{className:"w-1.5 h-1.5"}),he.type==="absence"&&F(he.item.type),he.type==="event"&&r.jsx(gt,{className:"w-1.5 h-1.5"})]}),r.jsx("div",{className:"absolute top-[-32px] left-0 bg-background border border-border rounded px-2 py-1 text-xs text-foreground shadow-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-30",children:he.type==="project"?he.item.name:he.type==="absence"?`${he.item.type}: ${(Ze=he.item.employee)==null?void 0:Ze.first_name} ${(Me=he.item.employee)==null?void 0:Me.last_name}`:he.item.title})]},`${he.type}-${he.item.id||Re}`)})})},Q)})]},ae))]})})},L=()=>{const X=t.getMonth(),K=t.getFullYear(),z=new Date(K,X+1,0).getDate(),Y=Array.from({length:z},(Q,oe)=>oe+1),ae=u.filter(Q=>{const oe=Q.status.toLowerCase();if(oe==="aktiv"||oe==="geplant"||oe==="in bearbeitung")return!0;const le=new Date(Q.start_date),Z=Q.end_date?new Date(Q.end_date):new Date,de=new Date(K,X,1),he=new Date(K,X+1,0);return le<=he&&Z>=de}),U=(Q,oe)=>{const re=new Date(K,X,oe);return v.filter(le=>{const Z=new Date(le.start_date),de=le.end_date?new Date(le.end_date):Z;return le.project_id===Q&&re>=Z&&re<=de})};return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"200px repeat("+z+", 1fr)"},children:[r.jsx("div",{className:"p-3 border-r border-border font-medium",children:"Projekt"}),Y.map(Q=>r.jsxs("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:[r.jsx("div",{children:Q}),r.jsx("div",{className:"text-muted-foreground",children:Pe(new Date(K,X,Q),"EEE",{locale:Wt})})]},Q))]}),ae.length===0?r.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:["Keine aktiven Projekte in ",Pe(t,"MMMM yyyy",{locale:Wt})]}):ae.map((Q,oe)=>r.jsxs("div",{className:`grid ${oe%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"200px repeat("+z+", 1fr)"},children:[r.jsxs("div",{className:"p-3 border-r border-border",children:[r.jsx("div",{className:"font-medium text-sm",children:Q.name}),r.jsx("div",{className:"text-xs text-muted-foreground",children:Q.location}),r.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[r.jsx(Ae,{variant:"outline",className:"text-xs",children:Q.status}),r.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Q.color},title:`Projekt: ${Q.name}`})]})]}),r.jsxs("div",{className:"relative h-20",style:{gridColumn:`2 / ${z+2}`},children:[r.jsx("div",{className:"absolute inset-0 grid",style:{gridTemplateColumns:`repeat(${z}, 1fr)`},children:Y.map(re=>r.jsx("div",{className:"border-r border-border last:border-r-0"},re))}),(()=>{const re=new Date(Q.start_date),le=Q.end_date?new Date(Q.end_date):re,Z=new Date(K,X,1),de=new Date(K,X+1,0),he=re<Z?1:re.getDate(),Re=le>de?z:le.getDate();if(le<Z||re>de)return null;const $e=(Re-he+1)/z*100,wt=(he-1)/z*100;return r.jsxs("div",{className:"absolute top-2 h-12 rounded-md flex items-center px-3 text-white text-sm font-medium shadow-md z-10",style:{left:`${wt}%`,width:`${$e}%`,backgroundColor:Q.color,minWidth:"60px"},title:`${Q.name} (${Pe(re,"dd.MM.yyyy")} - ${Pe(le,"dd.MM.yyyy")})`,children:[r.jsx(xl,{className:"w-4 h-4 mr-2 flex-shrink-0"}),r.jsx("span",{className:"truncate",children:Q.name}),r.jsx("div",{className:"ml-auto flex items-center space-x-1",children:r.jsxs("span",{className:"text-xs opacity-90",children:[Pe(re,"dd.MM")," - ",Pe(le,"dd.MM")]})})]})})(),Y.map(re=>{const le=U(Q.id,re);if(le.length===0)return null;const Z=(re-1)/z*100,de=1/z*100;return r.jsxs("div",{className:"absolute bottom-1 h-4 bg-blue-100 dark:bg-blue-900 border border-blue-300 dark:border-blue-700 rounded flex items-center justify-center",style:{left:`${Z}%`,width:`${de-1}%`,minWidth:"20px"},title:`${le.length} Mitarbeiter: ${le.map(he=>{var Re,$e;return`${(Re=he.employee)==null?void 0:Re.first_name} ${($e=he.employee)==null?void 0:$e.last_name} (${he.hours_per_day}h)`}).join(", ")}`,children:[r.jsx(Ps,{className:"w-2 h-2 text-blue-600 dark:text-blue-400"}),r.jsx("span",{className:"text-xs ml-1 text-blue-600 dark:text-blue-400",children:le.length})]},`assignments-${re}`)})]})]},Q.id))]})})},M=()=>{const X=t.getMonth(),K=t.getFullYear(),z=new Date(K,X+1,0).getDate(),Y=Array.from({length:z},(U,Q)=>Q+1),ae=m.filter(U=>U.status==="aktiv");return r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[r.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"200px repeat("+z+", 1fr)"},children:[r.jsx("div",{className:"p-3 border-r border-border font-medium",children:"Mitarbeiter"}),Y.map(U=>r.jsxs("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:[r.jsx("div",{children:U}),r.jsx("div",{className:"text-muted-foreground",children:Pe(new Date(K,X,U),"EEE",{locale:Wt})})]},U))]}),ae.length===0?r.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:["Keine aktiven Mitarbeiter in ",Pe(t,"MMMM yyyy",{locale:Wt})]}):ae.map((U,Q)=>{const oe=b.filter(re=>{const le=new Date(re.start_date),Z=new Date(re.end_date),de=new Date(K,X,1),he=new Date(K,X+1,0);return re.employee_id===U.id&&le<=he&&Z>=de});return r.jsxs("div",{className:`grid ${Q%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"200px repeat("+z+", 1fr)"},children:[r.jsxs("div",{className:"p-3 border-r border-border",children:[r.jsxs("div",{className:"font-medium text-sm",children:[U.first_name," ",U.last_name]}),r.jsx("div",{className:"text-xs text-muted-foreground",children:U.position}),r.jsx("div",{className:"text-xs text-muted-foreground",children:U.department})]}),r.jsxs("div",{className:"relative h-20",style:{gridColumn:`2 / ${z+2}`},children:[r.jsx("div",{className:"absolute inset-0 grid",style:{gridTemplateColumns:`repeat(${z}, 1fr)`},children:Y.map(re=>r.jsx("div",{className:"border-r border-border last:border-r-0"},re))}),oe.map((re,le)=>{const Z=new Date(re.start_date),de=new Date(re.end_date),he=new Date(K,X,1),Re=new Date(K,X+1,0),$e=Z<he?1:Z.getDate(),me=((de>Re?z:de.getDate())-$e+1)/z*100,je=($e-1)/z*100,Se=2+le*16;return r.jsxs("div",{className:`absolute h-12 rounded-md flex items-center px-3 text-white text-xs font-medium shadow-md z-10 ${O(re.type)}`,style:{left:`${je}%`,width:`${me}%`,top:`${Se}px`,minWidth:"60px"},title:`${re.type} (${Pe(Z,"dd.MM.yyyy")} - ${Pe(de,"dd.MM.yyyy")}) - ${re.status}${re.reason?` - ${re.reason}`:""}`,children:[F(re.type),r.jsx("span",{className:"ml-2 truncate",children:re.type}),r.jsxs("div",{className:"ml-auto flex items-center space-x-1",children:[B(re.status),r.jsxs("span",{className:"text-xs opacity-90",children:[Pe(Z,"dd.MM")," - ",Pe(de,"dd.MM")]})]})]},re.id)}),Y.map(re=>{const le=v.filter(he=>{const Re=new Date(he.start_date),$e=he.end_date?new Date(he.end_date):Re,wt=new Date(K,X,re);return he.employee_id===U.id&&wt>=Re&&wt<=$e});if(le.length===0)return null;const Z=(re-1)/z*100,de=1/z*100;return r.jsxs("div",{className:"absolute bottom-1 h-4 bg-blue-100 dark:bg-blue-900 border border-blue-300 dark:border-blue-700 rounded flex items-center justify-center",style:{left:`${Z}%`,width:`${de-1}%`,minWidth:"20px"},title:`${le.length} Projekt(e): ${le.map(he=>{var Re;return`${(Re=he.project)==null?void 0:Re.name} (${he.hours_per_day}h)`}).join(", ")}`,children:[r.jsx(xl,{className:"w-2 h-2 text-blue-600 dark:text-blue-400"}),r.jsx("span",{className:"text-xs ml-1 text-blue-600 dark:text-blue-400",children:le.length})]},`assignments-${re}`)})]})]},U.id)})]})})};return j?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),r.jsx("p",{children:"Lade Planerdaten..."})]})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-teal-600 bg-clip-text text-transparent flex items-center gap-3",children:[r.jsx(gt,{className:"h-8 w-8 text-teal-600"}),"Planer"]}),r.jsxs(Ae,{variant:"outline",className:"flex items-center space-x-1",children:[r.jsx(gt,{className:"w-4 h-4"}),r.jsx("span",{children:"Ressourcenplanung"})]})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[a==="overview"&&r.jsxs(r.Fragment,{children:[r.jsxs(tt,{value:c,onValueChange:d,children:[r.jsx(Je,{className:"w-48",children:r.jsx(nt,{placeholder:"Alle Abteilungen"})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"all",children:"Alle Abteilungen"}),R.map(X=>r.jsx(ce,{value:X,children:X},X))]})]}),r.jsxs(tt,{value:o,onValueChange:X=>l(X),children:[r.jsx(Je,{className:"w-40",children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"all",children:"Alle anzeigen"}),r.jsx(ce,{value:"projects",children:"Nur Projekte"}),r.jsx(ce,{value:"absences",children:"Nur Abwesenheiten"}),r.jsx(ce,{value:"events",children:"Nur Termine"})]})]})]}),r.jsxs(tt,{value:n,onValueChange:X=>s(X),children:[r.jsx(Je,{className:"w-32",children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"week",children:"Woche"}),r.jsx(ce,{value:"month",children:"Monat"})]})]}),r.jsx(W,{onClick:k,variant:"outline",size:"sm",children:"Aktualisieren"})]})]}),r.jsxs(cr,{value:a,onValueChange:X=>i(X),children:[r.jsxs(tr,{className:"grid w-full grid-cols-4",children:[r.jsxs(Oe,{value:"overview",className:"flex items-center space-x-2",children:[r.jsx(gt,{className:"w-4 h-4"}),r.jsx("span",{children:"Übersicht"})]}),r.jsxs(Oe,{value:"projects",className:"flex items-center space-x-2",children:[r.jsx(xl,{className:"w-4 h-4"}),r.jsx("span",{children:"Projekte"})]}),r.jsxs(Oe,{value:"employees",className:"flex items-center space-x-2",children:[r.jsx(Oa,{className:"w-4 h-4"}),r.jsx("span",{children:"Mitarbeiter"})]}),r.jsxs(Oe,{value:"resources",className:"flex items-center space-x-2",children:[r.jsx(la,{className:"w-4 h-4"}),r.jsx("span",{children:"Ressourcen"})]})]}),r.jsx(Fe,{value:"overview",className:"space-y-4",children:r.jsxs(J,{children:[r.jsx(pe,{className:"pb-4",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(xe,{className:"flex items-center space-x-2",children:[r.jsx(Ht,{className:"w-5 h-5"}),r.jsx("span",{children:n==="week"?`${Pe(V,"dd.MM",{locale:Wt})} - ${Pe(ne,"dd.MM.yyyy",{locale:Wt})}`:Pe(t,"MMMM yyyy",{locale:Wt})})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(W,{variant:"outline",size:"sm",onClick:se,children:r.jsx($d,{className:"w-4 h-4"})}),r.jsxs(ia,{children:[r.jsx(oa,{asChild:!0,children:r.jsxs(W,{variant:"outline",size:"sm",className:_e("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[r.jsx(gt,{className:"mr-2 h-4 w-4"}),Pe(t,"MMMM yyyy",{locale:Wt})]})}),r.jsx(ks,{className:"w-auto p-0",align:"start",children:r.jsx(Cs,{mode:"single",selected:t,onSelect:X=>X&&e(X),initialFocus:!0,className:_e("p-3 pointer-events-auto")})})]}),r.jsx(W,{variant:"outline",size:"sm",onClick:q,children:r.jsx(Co,{className:"w-4 h-4"})})]})]})}),r.jsxs(te,{children:[D(),r.jsxs("div",{className:"mt-6 space-y-3",children:[r.jsx("h4",{className:"font-medium",children:"Legende"}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),r.jsx("span",{children:"Urlaub"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),r.jsx("span",{children:"Krank"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),r.jsx("span",{children:"Projekte/Fortbildung"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded"}),r.jsx("span",{children:"Elternzeit"})]})]}),r.jsx(Ni,{}),r.jsxs("div",{className:"flex items-center space-x-6 text-xs",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Rn,{className:"w-4 h-4 text-green-500"}),r.jsx("span",{children:"Genehmigt"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Ht,{className:"w-4 h-4 text-yellow-500"}),r.jsx("span",{children:"Beantragt"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Eo,{className:"w-4 h-4 text-red-500"}),r.jsx("span",{children:"Abgelehnt"})]})]})]})]})]})}),r.jsx(Fe,{value:"projects",children:r.jsxs(J,{children:[r.jsx(pe,{className:"pb-4",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(xe,{className:"flex items-center space-x-2",children:[r.jsx(xl,{className:"w-5 h-5"}),r.jsxs("span",{children:["Projektkalender - ",Pe(t,"yyyy",{locale:Wt})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(W,{variant:"outline",size:"sm",onClick:se,children:r.jsx($d,{className:"w-4 h-4"})}),r.jsxs(ia,{children:[r.jsx(oa,{asChild:!0,children:r.jsxs(W,{variant:"outline",size:"sm",className:_e("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[r.jsx(gt,{className:"mr-2 h-4 w-4"}),Pe(t,"MMMM yyyy",{locale:Wt})]})}),r.jsx(ks,{className:"w-auto p-0",align:"start",children:r.jsx(Cs,{mode:"single",selected:t,onSelect:X=>X&&e(X),initialFocus:!0,className:_e("p-3 pointer-events-auto")})})]}),r.jsx(W,{variant:"outline",size:"sm",onClick:q,children:r.jsx(Co,{className:"w-4 h-4"})})]})]})}),r.jsx(te,{children:L()})]})}),r.jsx(Fe,{value:"employees",children:r.jsxs(J,{children:[r.jsx(pe,{className:"pb-4",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs(xe,{className:"flex items-center space-x-2",children:[r.jsx(Oa,{className:"w-5 h-5"}),r.jsxs("span",{children:["Mitarbeiterkalender - ",Pe(t,"yyyy",{locale:Wt})]})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(W,{variant:"outline",size:"sm",onClick:se,children:r.jsx($d,{className:"w-4 h-4"})}),r.jsxs(ia,{children:[r.jsx(oa,{asChild:!0,children:r.jsxs(W,{variant:"outline",size:"sm",className:_e("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[r.jsx(gt,{className:"mr-2 h-4 w-4"}),Pe(t,"MMMM yyyy",{locale:Wt})]})}),r.jsx(ks,{className:"w-auto p-0",align:"start",children:r.jsx(Cs,{mode:"single",selected:t,onSelect:X=>X&&e(X),initialFocus:!0,className:_e("p-3 pointer-events-auto")})})]}),r.jsx(W,{variant:"outline",size:"sm",onClick:q,children:r.jsx(Co,{className:"w-4 h-4"})})]})]})}),r.jsx(te,{children:M()})]})}),r.jsx(Fe,{value:"resources",children:r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Ressourcenplanung"})}),r.jsx(te,{children:r.jsx("p",{className:"text-muted-foreground",children:"Ressourcenplanung wird hier implementiert..."})})]})})]})]})};/*! Capacitor: https://capacitorjs.com/ - MIT License */var Cc;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(Cc||(Cc={}));class pg extends Error{constructor(e,n,s){super(e),this.message=e,this.code=n,this.data=s}}const sY=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},aY=t=>{const e=t.CapacitorCustomPlatform||null,n=t.Capacitor||{},s=n.Plugins=n.Plugins||{},a=()=>e!==null?e.name:sY(t),i=()=>a()!=="web",o=h=>{const m=d.get(h);return!!(m!=null&&m.platforms.has(a())||l(h))},l=h=>{var m;return(m=n.PluginHeaders)===null||m===void 0?void 0:m.find(p=>p.name===h)},c=h=>t.console.error(h),d=new Map,u=(h,m={})=>{const p=d.get(h);if(p)return console.warn(`Capacitor plugin "${h}" already registered. Cannot register plugins twice.`),p.proxy;const b=a(),x=l(h);let g;const y=async()=>(!g&&b in m?g=typeof m[b]=="function"?g=await m[b]():g=m[b]:e!==null&&!g&&"web"in m&&(g=typeof m.web=="function"?g=await m.web():g=m.web),g),v=(E,P)=>{var A,C;if(x){const T=x==null?void 0:x.methods.find(I=>P===I.name);if(T)return T.rtype==="promise"?I=>n.nativePromise(h,P.toString(),I):(I,V)=>n.nativeCallback(h,P.toString(),I,V);if(E)return(A=E[P])===null||A===void 0?void 0:A.bind(E)}else{if(E)return(C=E[P])===null||C===void 0?void 0:C.bind(E);throw new pg(`"${h}" plugin is not implemented on ${b}`,Cc.Unimplemented)}},w=E=>{let P;const A=(...C)=>{const T=y().then(I=>{const V=v(I,E);if(V){const ne=V(...C);return P=ne==null?void 0:ne.remove,ne}else throw new pg(`"${h}.${E}()" is not implemented on ${b}`,Cc.Unimplemented)});return E==="addListener"&&(T.remove=async()=>P()),T};return A.toString=()=>`${E.toString()}() { [capacitor code] }`,Object.defineProperty(A,"name",{value:E,writable:!1,configurable:!1}),A},j=w("addListener"),S=w("removeListener"),N=(E,P)=>{const A=j({eventName:E},P),C=async()=>{const I=await A;S({eventName:E,callbackId:I},P)},T=new Promise(I=>A.then(()=>I({remove:C})));return T.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await C()},T},k=new Proxy({},{get(E,P){switch(P){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return x?N:j;case"removeListener":return S;default:return w(P)}}});return s[h]=k,d.set(h,{name:h,proxy:k,platforms:new Set([...Object.keys(m),...x?[b]:[]])}),k};return n.convertFileSrc||(n.convertFileSrc=h=>h),n.getPlatform=a,n.handleError=c,n.isNativePlatform=i,n.isPluginAvailable=o,n.registerPlugin=u,n.Exception=pg,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},iY=t=>t.Capacitor=aY(t),Ey=iY(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),cj=Ey.registerPlugin;class c3{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let s=!1;this.listeners[e]||(this.listeners[e]=[],s=!0),this.listeners[e].push(n);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),s&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,n);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,s){const a=this.listeners[e];if(!a){if(s){let i=this.retainedEventArguments[e];i||(i=[]),i.push(n),this.retainedEventArguments[e]=i}return}a.forEach(i=>i(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:s=>{this.notifyListeners(n,s)}}}unimplemented(e="not implemented"){return new Ey.Exception(e,Cc.Unimplemented)}unavailable(e="not available"){return new Ey.Exception(e,Cc.Unavailable)}async removeListener(e,n){const s=this.listeners[e];if(!s)return;const a=s.indexOf(n);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(s=>{this.notifyListeners(e,s)}))}}const I2=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),O2=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class oY extends c3{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(s=>{if(s.length<=0)return;let[a,i]=s.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=O2(a).trim(),i=O2(i).trim(),n[a]=i}),n}async setCookie(e){try{const n=I2(e.key),s=I2(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${s||""}${a}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}cj("CapacitorCookies",{web:()=>new oY});const lY=async t=>new Promise((e,n)=>{const s=new FileReader;s.onload=()=>{const a=s.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},s.onerror=a=>n(a),s.readAsDataURL(t)}),cY=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(a=>a.toLocaleLowerCase()).reduce((a,i,o)=>(a[i]=t[e[o]],a),{})},dY=(t,e=!0)=>t?Object.entries(t).reduce((s,a)=>{const[i,o]=a;let l,c;return Array.isArray(o)?(c="",o.forEach(d=>{l=e?encodeURIComponent(d):d,c+=`${i}=${l}&`}),c.slice(0,-1)):(l=e?encodeURIComponent(o):o,c=`${i}=${l}`),`${s}&${c}`},"").substr(1):null,uY=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),a=cY(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(a.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,l]of Object.entries(t.data||{}))i.set(o,l);n.body=i.toString()}else if(a.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((l,c)=>{i.append(c,l)});else for(const l of Object.keys(t.data))i.append(l,t.data[l]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(a.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class hY extends c3{async request(e){const n=uY(e,e.webFetchExtra),s=dY(e.params,e.shouldEncodeUrlParams),a=s?`${e.url}?${s}`:e.url,i=await fetch(a,n),o=i.headers.get("content-type")||"";let{responseType:l="text"}=i.ok?e:{};o.includes("application/json")&&(l="json");let c,d;switch(l){case"arraybuffer":case"blob":d=await i.blob(),c=await lY(d);break;case"json":c=await i.json();break;case"document":case"text":default:c=await i.text()}const u={};return i.headers.forEach((h,m)=>{u[m]=h}),{data:c,headers:u,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}cj("CapacitorHttp",{web:()=>new hY});function mY(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,n){return new Proxy({},{get(s,a){return(i,o,l)=>{const c=t.Capacitor.Plugins[n];if(c===void 0){l(new Error(`Capacitor plugin ${n} not found`));return}if(typeof c[a]!="function"){l(new Error(`Method ${a} not found in Capacitor plugin ${n}`));return}(async()=>{try{const d=await c[a](i);o(d)}catch(d){l(d)}})()}}})}})}function fY(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,n){return t.cordova.plugins[n]}})}function pY(t=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!t?mY(window):window.cordova!==void 0&&fY(window))}const xY=cj("Geolocation",{web:()=>zc(()=>import("./web-CRlZL377.js"),[]).then(t=>new t.GeolocationWeb)});pY();class gY{constructor(){En(this,"dbName","TimeTrackingOfflineDB");En(this,"dbVersion",1);En(this,"storeName","timeEntries")}async initDB(){return new Promise((e,n)=>{const s=indexedDB.open(this.dbName,this.dbVersion);s.onerror=()=>n(s.error),s.onsuccess=()=>e(s.result),s.onupgradeneeded=a=>{const i=a.target.result;if(!i.objectStoreNames.contains(this.storeName)){const o=i.createObjectStore(this.storeName,{keyPath:"id"});o.createIndex("status","status",{unique:!1}),o.createIndex("offline_created_at","offline_created_at",{unique:!1})}}})}async saveOfflineEntry(e){const a=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((i,o)=>{const l=a.put(e);l.onerror=()=>o(l.error),l.onsuccess=()=>i()})}async getOfflineEntries(){const s=(await this.initDB()).transaction([this.storeName],"readonly").objectStore(this.storeName);return new Promise((a,i)=>{const o=s.getAll();o.onerror=()=>i(o.error),o.onsuccess=()=>a(o.result)})}async removeOfflineEntry(e){const a=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((i,o)=>{const l=a.delete(e);l.onerror=()=>o(l.error),l.onsuccess=()=>i()})}async clearOfflineEntries(){const s=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((a,i)=>{const o=s.clear();o.onerror=()=>i(o.error),o.onsuccess=()=>a()})}}class vY{async getCurrentPosition(){try{const e=await xY.getCurrentPosition({enableHighAccuracy:!0,timeout:1e4}),n={lat:e.coords.latitude,lng:e.coords.longitude},s=await this.reverseGeocode(n.lat,n.lng);return{...n,address:s}}catch(e){throw console.error("Fehler beim Abrufen der GPS-Position:",e),new Error("GPS-Position konnte nicht ermittelt werden")}}async reverseGeocode(e,n){try{const s=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${n}&zoom=18&addressdetails=1`);if(!s.ok)throw new Error("Geocoding fehlgeschlagen");const a=await s.json(),i=[];return a.address.house_number&&i.push(a.address.house_number),a.address.road&&i.push(a.address.road),(a.address.city||a.address.town||a.address.village)&&i.push(a.address.city||a.address.town||a.address.village),i.length>0?i.join(", "):"Unbekannte Adresse"}catch(s){return console.warn("Reverse Geocoding fehlgeschlagen:",s),`${e.toFixed(6)}, ${n.toFixed(6)}`}}calculateDistance(e,n){const a=this.toRad(n.lat-e.lat),i=this.toRad(n.lng-e.lng),o=this.toRad(e.lat),l=this.toRad(n.lat),c=Math.sin(a/2)*Math.sin(a/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(o)*Math.cos(l);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))*1e3}toRad(e){return e*(Math.PI/180)}isWithinRadius(e,n,s){return this.calculateDistance(e,n)<=s}}class xg{static isOnline(){return navigator.onLine}static onStatusChange(e){const n=()=>e(!0),s=()=>e(!1);return window.addEventListener("online",n),window.addEventListener("offline",s),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}static async registerServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/sw.js");return console.log("Service Worker registriert:",e),e}catch(e){return console.error("Service Worker Registrierung fehlgeschlagen:",e),null}return null}static async triggerBackgroundSync(e){if("serviceWorker"in navigator&&navigator.serviceWorker.controller)try{const n=await navigator.serviceWorker.ready;n&&"sync"in n&&await n.sync.register(e)}catch(n){console.error("Background Sync fehlgeschlagen:",n)}}}const yY=({open:t,onOpenChange:e,timeEntry:n,projects:s,onSave:a})=>{var P,A;const[i,o]=f.useState(""),[l,c]=f.useState(""),[d,u]=f.useState(""),[h,m]=f.useState(""),[p,b]=f.useState(0),[x,g]=f.useState(""),[y,v]=f.useState(""),[w,j]=f.useState(""),[S,N]=f.useState(!1),{toast:k}=pt();f.useEffect(()=>{if(n){const C=Bl(n.start_time);if(o(Pe(C,"yyyy-MM-dd")),c(Pe(C,"HH:mm")),n.end_time){const T=Bl(n.end_time);u(Pe(T,"yyyy-MM-dd")),m(Pe(T,"HH:mm"))}else u(""),m("");b(n.break_duration||0),g(n.project_id||""),v(n.description||""),j(n.status)}},[n]);const E=async()=>{if(n){N(!0);try{const C=new Date(`${i}T${l}`).toISOString();let T=null;d&&h&&(T=new Date(`${d}T${h}`).toISOString());const I={start_time:C,end_time:T,break_duration:p,project_id:x||null,description:y||null,status:w},{error:V}=await $.from("time_entries").update(I).eq("id",n.id);if(V)throw V;k({title:"Zeiteintrag aktualisiert",description:"Die Änderungen wurden erfolgreich gespeichert."}),a(),e(!1)}catch(C){console.error("Error updating time entry:",C),k({title:"Fehler beim Speichern",description:"Die Änderungen konnten nicht gespeichert werden.",variant:"destructive"})}finally{N(!1)}}};return n?r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-2xl",children:[r.jsx(Bt,{children:r.jsxs(Lt,{children:["Zeiteintrag bearbeiten - ",(P=n.employee)==null?void 0:P.first_name," ",(A=n.employee)==null?void 0:A.last_name]})}),r.jsxs("div",{className:"grid gap-4 py-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"start-date",children:"Startdatum"}),r.jsx(G,{id:"start-date",type:"date",value:i,onChange:C=>o(C.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"start-time",children:"Startzeit"}),r.jsx(G,{id:"start-time",type:"time",value:l,onChange:C=>c(C.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"end-date",children:"Enddatum"}),r.jsx(G,{id:"end-date",type:"date",value:d,onChange:C=>u(C.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"end-time",children:"Endzeit"}),r.jsx(G,{id:"end-time",type:"time",value:h,onChange:C=>m(C.target.value)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"break-duration",children:"Pausenzeit (Minuten)"}),r.jsx(G,{id:"break-duration",type:"number",min:"0",value:p,onChange:C=>b(parseInt(C.target.value)||0)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"status",children:"Status"}),r.jsxs(tt,{value:w,onValueChange:j,children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"aktiv",children:"Aktiv"}),r.jsx(ce,{value:"pausiert",children:"Pausiert"}),r.jsx(ce,{value:"beendet",children:"Beendet"})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"project",children:"Projekt"}),r.jsxs(tt,{value:x,onValueChange:g,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Projekt auswählen"})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"",children:"Kein Projekt"}),s.map(C=>r.jsx(ce,{value:C.id,children:C.name},C.id))]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"description",children:"Beschreibung"}),r.jsx(an,{id:"description",placeholder:"Beschreibung der Tätigkeit...",value:y,onChange:C=>v(C.target.value)})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(W,{variant:"outline",onClick:()=>e(!1),children:"Abbrechen"}),r.jsx(W,{onClick:E,disabled:S,children:S?"Speichere...":"Speichern"})]})]})}):null},bY=()=>{var wt;const{toast:t}=pt(),{userRole:e}=tw(),{data:n,isLoading:s}=wW(),{data:a,isLoading:i}=zD(),{data:o,isLoading:l}=$w(),c=jW(),d=_W(),u=(n==null?void 0:n.items)||[],h=(a==null?void 0:a.items)||[],m=(o==null?void 0:o.items)||[],[p,b]=f.useState([]),[x,g]=f.useState([]);f.useState([]);const[y,v]=f.useState(null),[w,j]=f.useState(xg.isOnline()),[S,N]=f.useState(new Date);f.useState("");const[k,E]=f.useState("all"),[P,A]=f.useState("all"),[C,T]=f.useState(!1),[I,V]=f.useState(!1);f.useState(!1),f.useState(null);const[ne,se]=f.useState(""),[q,O]=f.useState(!1),[F,B]=f.useState(null),R=u.find(me=>me.status==="aktiv")||null,D=s||i||l,L=new gY,M=new vY;f.useEffect(()=>(xg.registerServiceWorker(),xg.onStatusChange(je=>{j(je),je?(K(),t({title:"Wieder online",description:"Synchronisiere Offline-Daten..."})):t({title:"Offline-Modus",description:"Zeiteinträge werden lokal gespeichert.",variant:"destructive"})})),[]),f.useEffect(()=>{X(),z(),Y()},[S,k,P]);const X=async()=>{const{data:{user:me}}=await $.auth.getUser();if(!me)return;const{data:je,error:Se}=await $.from("profiles").select("*").eq("id",me.id).single();if(Se)throw t({title:"Profil konnte nicht geladen werden",description:Se.message,variant:"destructive"}),Se;v(je)},K=async()=>{var me,je,Se,Ze,Me,Ne;try{const mt=await L.getOfflineEntries();for(const it of mt)try{c.mutate({employee_id:it.employee_id,project_id:it.project_id,start_time:it.start_time,end_time:it.end_time,description:it.description,status:it.status,start_location_lat:(me=it.start_location)==null?void 0:me.lat,start_location_lng:(je=it.start_location)==null?void 0:je.lng,start_location_address:(Se=it.start_location)==null?void 0:Se.address,end_location_lat:(Ze=it.end_location)==null?void 0:Ze.lat,end_location_lng:(Me=it.end_location)==null?void 0:Me.lng,end_location_address:(Ne=it.end_location)==null?void 0:Ne.address,is_offline_synced:!0,offline_created_at:it.offline_created_at},{onSuccess:()=>{L.removeOfflineEntry(it.id)}})}catch(kn){console.error("Error syncing offline entry:",kn)}mt.length>0&&t({title:"Synchronisation abgeschlossen",description:`${mt.length} Offline-Einträge wurden synchronisiert.`})}catch(mt){console.error("Error syncing offline entries:",mt)}},z=async()=>{const{data:me,error:je}=await $.from("working_hours_config").select("*").order("is_default",{ascending:!1});if(je)throw je;g(me||[])},Y=async()=>{const me=Pe(S,"yyyy-MM"),{data:je,error:Se}=await $.from("employee_absences").select("*").gte("start_date",`${me}-01`).lte("end_date",`${me}-31`).eq("status","genehmigt");if(Se)throw Se;b(je||[])},ae=async(me,je)=>{if(!y){t({title:"Fehler",description:"Kein Mitarbeiter gefunden.",variant:"destructive"});return}if(R){t({title:"Zeiterfassung bereits aktiv",description:"Beenden Sie zuerst die aktuelle Zeiterfassung.",variant:"destructive"});return}let Se;try{Se=await M.getCurrentPosition()}catch(Me){console.warn("GPS location not available:",Me)}const Ze={employee_id:y.id,project_id:me||null,start_time:new Date().toISOString(),description:je||null,status:"aktiv",start_location_lat:Se==null?void 0:Se.lat,start_location_lng:Se==null?void 0:Se.lng,start_location_address:Se==null?void 0:Se.address};if(!w){const Me={id:crypto.randomUUID(),employee_id:y.id,project_id:me||void 0,start_time:new Date().toISOString(),description:je||void 0,status:"aktiv",start_location:Se,offline_created_at:new Date().toISOString()};await L.saveOfflineEntry(Me),t({title:"Offline gespeichert",description:"Zeiterfassung wird bei der nächsten Verbindung synchronisiert."});return}c.mutate(Ze,{onSuccess:Me=>{T(!1),t({title:"Zeiterfassung gestartet",description:Se?`Gestartet an: ${Se.address}`:"Die Zeiterfassung wurde erfolgreich gestartet."})},onError:()=>{t({title:"Fehler beim Starten",description:"Die Zeiterfassung konnte nicht gestartet werden.",variant:"destructive"})}})},U=async()=>{if(!R)return;let me;try{me=await M.getCurrentPosition()}catch(Se){console.warn("GPS location not available:",Se)}const je={end_time:new Date().toISOString(),status:"beendet",end_location_lat:me==null?void 0:me.lat,end_location_lng:me==null?void 0:me.lng,end_location_address:me==null?void 0:me.address};d.mutate({id:R.id,data:je},{onSuccess:()=>{t({title:"Zeiterfassung beendet",description:me?`Beendet an: ${me.address}`:"Die Zeiterfassung wurde erfolgreich beendet."})},onError:()=>{t({title:"Fehler beim Stoppen",description:"Die Zeiterfassung konnte nicht gestoppt werden.",variant:"destructive"})}})},Q=async()=>{if(!R)return;const me=R.status==="aktiv"?"pausiert":"aktiv";d.mutate({id:R.id,data:{status:me}},{onError:()=>{t({title:"Fehler",description:"Der Status konnte nicht geändert werden.",variant:"destructive"})}})},oe=async(me,je,Se)=>{if(!e||e!=="manager"){t({title:"Keine Berechtigung",description:"Nur Manager können Zeiterfassung für andere starten.",variant:"destructive"});return}const{data:Ze}=await $.from("time_entries").select("*").eq("employee_id",me).eq("status","aktiv").single();if(Ze){t({title:"Zeiterfassung bereits aktiv",description:"Dieser Mitarbeiter hat bereits eine aktive Zeiterfassung.",variant:"destructive"});return}c.mutate({employee_id:me,project_id:je||null,start_time:new Date().toISOString(),description:Se||null,status:"aktiv"},{onSuccess:Me=>{var Ne,mt;t({title:"Zeiterfassung gestartet",description:`Zeiterfassung für ${(Ne=Me.employee)==null?void 0:Ne.first_name} ${(mt=Me.employee)==null?void 0:mt.last_name} wurde gestartet.`})},onError:()=>{t({title:"Fehler beim Starten",description:"Die Zeiterfassung konnte nicht gestartet werden.",variant:"destructive"})}})},re=async(me,je)=>{if(!e||e!=="manager"){t({title:"Keine Berechtigung",description:"Nur Manager können Arbeitszeiten ändern.",variant:"destructive"});return}const{data:Se}=await $.from("working_hours_config").select("*").eq("employee_id",me).single();if(Se){const{error:Ze}=await $.from("working_hours_config").update(je).eq("id",Se.id);if(Ze){t({title:"Fehler beim Aktualisieren",description:"Die Arbeitszeiten konnten nicht aktualisiert werden.",variant:"destructive"});return}}else{const{error:Ze}=await $.from("working_hours_config").insert({employee_id:me,...je});if(Ze){t({title:"Fehler beim Erstellen",description:"Die Arbeitszeiten konnten nicht erstellt werden.",variant:"destructive"});return}}z(),V(!1),t({title:"Arbeitszeiten aktualisiert",description:"Die Arbeitszeiten wurden erfolgreich gespeichert."})},le=me=>x.find(je=>je.employee_id===me)||x.find(je=>je.is_default),Z=()=>{const[me,je]=f.useState("08:00"),[Se,Ze]=f.useState("17:00"),[Me,Ne]=f.useState(30),[mt,it]=f.useState([1,2,3,4,5]);f.useEffect(()=>{if(ne){const ut=le(ne);ut&&(je(ut.start_time.slice(0,5)),Ze(ut.end_time.slice(0,5)),Ne(ut.break_duration),it(ut.working_days))}},[ne]);const kn=()=>{re(ne==="default"?null:ne,{start_time:me+":00",end_time:Se+":00",break_duration:Me,working_days:mt,is_default:ne==="default"})},Cr=ut=>{it(en=>en.includes(ut)?en.filter(Cn=>Cn!==ut):[...en,ut].sort())};return r.jsx(Mt,{open:I,onOpenChange:V,children:r.jsxs(Pt,{className:"max-w-md",children:[r.jsx(Bt,{children:r.jsx(Lt,{children:"Arbeitszeiten konfigurieren"})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{children:"Mitarbeiter"}),r.jsxs(tt,{value:ne,onValueChange:se,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Mitarbeiter wählen..."})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"default",children:"Standard (alle Mitarbeiter)"}),m.map(ut=>r.jsxs(ce,{value:ut.id,children:[ut.first_name," ",ut.last_name]},ut.id))]})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx(H,{children:"Arbeitsbeginn"}),r.jsx(G,{type:"time",value:me,onChange:ut=>je(ut.target.value)})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Arbeitsende"}),r.jsx(G,{type:"time",value:Se,onChange:ut=>Ze(ut.target.value)})]})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Pausendauer (Minuten)"}),r.jsx(G,{type:"number",value:Me,onChange:ut=>Ne(Number(ut.target.value)),min:"0",max:"120"})]}),r.jsxs("div",{children:[r.jsx(H,{children:"Arbeitstage"}),r.jsx("div",{className:"flex gap-2 mt-2",children:[{value:1,label:"Mo"},{value:2,label:"Di"},{value:3,label:"Mi"},{value:4,label:"Do"},{value:5,label:"Fr"},{value:6,label:"Sa"},{value:7,label:"So"}].map(ut=>r.jsx(W,{variant:mt.includes(ut.value)?"default":"outline",size:"sm",onClick:()=>Cr(ut.value),children:ut.label},ut.value))})]}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx(W,{variant:"outline",onClick:()=>V(!1),children:"Abbrechen"}),r.jsx(W,{onClick:kn,disabled:!ne,children:"Speichern"})]})]})]})})},de=()=>{const[me,je]=f.useState(""),[Se,Ze]=f.useState(""),[Me,Ne]=f.useState(""),mt=()=>{me&&(oe(me,Se==="none"?void 0:Se||void 0,Me||void 0),je(""),Ze(""),Ne(""),T(!1))};return r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"employee",children:"Mitarbeiter"}),r.jsxs(tt,{value:me,onValueChange:je,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Mitarbeiter auswählen..."})}),r.jsx(Xe,{children:m.map(it=>r.jsxs(ce,{value:it.id,children:[it.first_name," ",it.last_name]},it.id))})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"project",children:"Projekt (optional)"}),r.jsxs(tt,{value:Se,onValueChange:Ze,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Projekt auswählen..."})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"none",children:"Kein Projekt"}),h.map(it=>r.jsx(ce,{value:it.id,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:it.color}}),it.name]})},it.id))]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"description",children:"Beschreibung (optional)"}),r.jsx(an,{id:"description",value:Me,onChange:it=>Ne(it.target.value),placeholder:"Beschreibung der Tätigkeit..."})]}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx(W,{variant:"outline",onClick:()=>T(!1),children:"Abbrechen"}),r.jsxs(W,{onClick:mt,disabled:!me,children:[r.jsx(Il,{className:"w-4 h-4 mr-2"}),"Starten"]})]})]})},he=(me,je)=>{const Se=Bl(me),Me=g2(new Date,Se),Ne=Math.floor(Me/60),mt=Me%60;return`${Ne}:${mt.toString().padStart(2,"0")}h`},Re=()=>u.reduce((me,je)=>{if(je.status==="beendet"&&je.end_time){const Se=Bl(je.start_time),Ze=Bl(je.end_time);return me+g2(Ze,Se)}return me},0),$e=()=>{const[me,je]=f.useState(""),[Se,Ze]=f.useState(""),Me=()=>{ae(Se==="none"?void 0:Se||void 0,me||void 0),je(""),Ze("")};return r.jsx(Mt,{open:C,onOpenChange:T,children:r.jsxs(Pt,{children:[r.jsx(Bt,{children:r.jsx(Lt,{children:e==="manager"?"Zeiterfassung starten":"Neue Zeiterfassung starten"})}),e==="manager"?r.jsx(de,{}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(H,{htmlFor:"project",children:"Projekt (optional)"}),r.jsxs(tt,{value:Se,onValueChange:Ze,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Projekt auswählen..."})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"none",children:"Kein Projekt"}),h.map(Ne=>r.jsx(ce,{value:Ne.id,children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Ne.color}}),Ne.name]})},Ne.id))]})]})]}),r.jsxs("div",{children:[r.jsx(H,{htmlFor:"description",children:"Beschreibung (optional)"}),r.jsx(an,{id:"description",value:me,onChange:Ne=>je(Ne.target.value),placeholder:"Was arbeiten Sie?"})]}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx(W,{variant:"outline",onClick:()=>T(!1),children:"Abbrechen"}),r.jsxs(W,{onClick:Me,children:[r.jsx(Il,{className:"w-4 h-4 mr-2"}),"Starten"]})]})]})]})})};return D?r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(Ke,{className:"h-8 w-48"}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx(Ke,{className:"h-10 w-32"}),r.jsx(Ke,{className:"h-10 w-40"})]})]}),r.jsxs(J,{className:"shadow-soft rounded-2xl",children:[r.jsx(pe,{className:"pb-2",children:r.jsx(Ke,{className:"h-6 w-48"})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx(Ke,{className:"h-6 w-32 mb-2"}),r.jsx(Ke,{className:"h-4 w-24"})]}),r.jsxs("div",{className:"text-right",children:[r.jsx(Ke,{className:"h-8 w-16 mb-2"}),r.jsx(Ke,{className:"h-6 w-20"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Ke,{className:"h-10 flex-1"}),r.jsx(Ke,{className:"h-10 flex-1"})]})]})})]}),r.jsxs(J,{className:"shadow-soft rounded-2xl",children:[r.jsx(pe,{className:"pb-2",children:r.jsx(Ke,{className:"h-6 w-32"})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsx(Ke,{className:"h-10 w-full"}),r.jsx("div",{className:"space-y-3",children:Array(3).fill(0).map((me,je)=>r.jsx("div",{className:"border rounded-xl p-4",children:r.jsx(Ke,{className:"h-16 w-full"})},je))})]})})]})]}):r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Zeiterfassung"}),r.jsxs("div",{className:"flex items-center gap-4",children:[e==="manager"&&r.jsxs(W,{variant:"outline",onClick:()=>V(!0),className:"rounded-full",children:[r.jsx(Fi,{className:"h-4 w-4 mr-2"}),"Arbeitszeiten"]}),r.jsxs(W,{onClick:()=>T(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),e==="manager"?"Zeiterfassung starten":"Meine Zeiterfassung"]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Heute erfasst"}),r.jsx("p",{className:"text-2xl font-bold",children:formatMinutesToTime(Re())})]}),r.jsx(Ht,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Aktive Mitarbeiter"}),r.jsx("p",{className:"text-2xl font-bold",children:u.filter(me=>me.status==="aktiv").length})]}),r.jsx(Oa,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Pausierte"}),r.jsx("p",{className:"text-2xl font-bold",children:u.filter(me=>me.status==="pausiert").length})]}),r.jsx(bf,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),r.jsx("p",{className:"text-2xl font-bold",children:w?"Online":"Offline"})]}),w?r.jsx(jf,{className:"h-8 w-8 text-purple-500 opacity-50"}):r.jsx(vv,{className:"h-8 w-8 text-red-500 opacity-50"})]})})})]}),r.jsxs(J,{className:"shadow-soft rounded-2xl",children:[r.jsx(pe,{className:"pb-2",children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Ht,{className:"w-5 h-5"}),"Aktuelle Zeiterfassung"]})}),r.jsx(te,{children:R?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-lg font-medium",children:((wt=R.project)==null?void 0:wt.name)||"Allgemeine Arbeitszeit"}),r.jsxs("p",{className:"text-muted-foreground",children:["Gestartet: ",Pe(Bl(R.start_time),"HH:mm",{locale:Wt})]}),R.description&&r.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:R.description})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("p",{className:"text-2xl font-bold",children:he(R.start_time)}),r.jsx(Ae,{variant:R.status==="aktiv"?"default":"secondary",children:R.status==="aktiv"?"Aktiv":"Pausiert"})]})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(W,{variant:"outline",onClick:Q,className:"flex-1 rounded-xl",children:R.status==="aktiv"?r.jsxs(r.Fragment,{children:[r.jsx(bf,{className:"w-4 h-4 mr-2"}),"Pausieren"]}):r.jsxs(r.Fragment,{children:[r.jsx(Il,{className:"w-4 h-4 mr-2"}),"Fortsetzen"]})}),r.jsxs(W,{variant:"destructive",onClick:U,className:"flex-1 rounded-xl",children:[r.jsx(xv,{className:"w-4 h-4 mr-2"}),"Beenden"]})]})]}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Ht,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:"Keine aktive Zeiterfassung"}),r.jsxs(W,{onClick:()=>T(!0),children:[r.jsx(Il,{className:"w-4 h-4 mr-2"}),"Zeiterfassung starten"]})]})})]}),r.jsxs(J,{className:"shadow-soft rounded-2xl",children:[r.jsx(pe,{className:"pb-2",children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Ht,{className:"w-5 h-5"}),"Zeiterfassung"]})}),r.jsx(te,{children:(()=>{const me=Pe(S,"yyyy-MM"),je=u.filter(Ne=>{const mt=Pe(new Date(Ne.start_time),"yyyy-MM")===me,it=P==="all"||!P||Ne.employee_id===P;return mt&&it}),Se=je.reduce((Ne,mt)=>{if(mt.end_time){const it=(new Date(mt.end_time).getTime()-new Date(mt.start_time).getTime())/36e5;return Ne+it}return Ne},0),Ze=je.reduce((Ne,mt)=>{const it=Pe(new Date(mt.start_time),"yyyy-MM-dd");return Ne[it]||(Ne[it]=[]),Ne[it].push(mt),Ne},{}),Me=m.find(Ne=>Ne.id===P);return r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"flex gap-4 items-end",children:r.jsxs("div",{className:"flex-1",children:[r.jsx(H,{children:"Mitarbeiter auswählen"}),r.jsxs(tt,{value:P||"all",onValueChange:A,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Mitarbeiter wählen..."})}),r.jsxs(Xe,{className:"bg-background border shadow-lg z-50",children:[r.jsx(ce,{value:"all",children:"Alle Mitarbeiter"}),m.length>0?m.map(Ne=>r.jsxs(ce,{value:Ne.id,children:[Ne.first_name," ",Ne.last_name]},Ne.id)):r.jsx(ce,{value:"loading",disabled:!0,children:"Lade Mitarbeiter..."})]})]})]})}),r.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 p-4 rounded-lg border",children:[r.jsxs("h3",{className:"font-semibold text-lg mb-2",children:["Monatsübersicht ",Pe(S,"MMMM yyyy",{locale:Wt}),Me&&r.jsxs("span",{className:"text-base font-normal ml-2",children:["- ",Me.first_name," ",Me.last_name]})]}),r.jsxs("p",{className:"text-2xl font-bold text-primary",children:[Se.toFixed(1)," Stunden"]})]}),P&&P!=="all"?r.jsxs("div",{className:"space-y-3",children:[(()=>{const Ne=new Date(S),mt=Ne.getFullYear(),it=Ne.getMonth(),kn=new Date(mt,it+1,0).getDate(),Cr=[];for(let ut=1;ut<=kn;ut++){const en=new Date(mt,it,ut),Cn=Pe(en,"yyyy-MM-dd"),Er=en.getDay(),Vn=Er===0||Er===6,fn=Ze[Cn],qa=p.some(He=>{const It=new Date(He.start_date),Et=new Date(He.end_date),ot=new Date(Cn);return He.employee_id===P&&He.type==="urlaub"&&ot>=It&&ot<=Et});Cr.push({date:Cn,dateObject:en,isWeekend:Vn,hasEntries:fn,isOnVacation:qa,entries:fn||[]})}return Cr.sort((ut,en)=>new Date(en.date).getTime()-new Date(ut.date).getTime()).map(({date:ut,dateObject:en,isWeekend:Cn,hasEntries:Er,isOnVacation:Vn,entries:fn})=>{if(Vn&&!Er)return r.jsx("div",{className:"border rounded-lg overflow-hidden bg-yellow-50/50 border-yellow-200",children:r.jsx("div",{className:"bg-yellow-100/50 p-4 border-b",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h4",{className:"font-semibold text-yellow-800",children:Pe(en,"EEEE, dd.MM.yyyy",{locale:Wt})}),r.jsx("div",{className:"text-right",children:r.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-200 text-yellow-800",children:"Urlaub"})})]})})},ut);if(Cn&&!Er)return r.jsx("div",{className:"border rounded-lg overflow-hidden bg-gray-50/50",children:r.jsx("div",{className:"bg-gray-100/50 p-4 border-b",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h4",{className:"font-semibold text-gray-600",children:Pe(en,"EEEE, dd.MM.yyyy",{locale:Wt})}),r.jsx("div",{className:"text-right",children:r.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:"Freier Tag"})})]})})},ut);if(!Er)return null;const He=fn.reduce((ot,$t)=>{if($t.end_time){const Qr=new Date($t.end_time).getTime()-new Date($t.start_time).getTime();return ot+Qr/(1e3*60)}return ot},0)/60,It=fn.sort((ot,$t)=>new Date(ot.start_time).getTime()-new Date($t.start_time).getTime())[0],Et=fn.sort((ot,$t)=>new Date($t.end_time||$t.start_time).getTime()-new Date(ot.end_time||ot.start_time).getTime())[0];return r.jsxs("div",{className:_e("border rounded-lg overflow-hidden",Vn?"bg-yellow-50/50 border-yellow-200":Cn?"bg-amber-50/50 border-amber-200":""),children:[r.jsx("div",{className:_e("p-4 border-b",Vn?"bg-yellow-100/50":Cn?"bg-amber-100/50":"bg-muted/50"),children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h4",{className:_e("font-semibold",Vn?"text-yellow-800":""),children:Pe(en,"EEEE, dd.MM.yyyy",{locale:Wt})}),r.jsxs("div",{className:"flex gap-2 mt-1",children:[Vn&&r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-200 text-yellow-800 inline-block",children:"Urlaub (gearbeitet)"}),Cn&&r.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-amber-200 text-amber-800 inline-block",children:"Wochenendarbeit"})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-lg font-bold",children:[He.toFixed(1),"h"]}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[Pe(new Date(It.start_time),"HH:mm")," - ",Et.end_time?Pe(new Date(Et.end_time),"HH:mm"):"Aktiv"]})]})]})}),r.jsx("div",{className:"divide-y",children:fn.sort((ot,$t)=>new Date(ot.start_time).getTime()-new Date($t.start_time).getTime()).map(ot=>{const $t=h.find(nl=>nl.id===ot.project_id),Qr=ot.end_time?(new Date(ot.end_time).getTime()-new Date(ot.start_time).getTime())/(1e3*60*60):0,Wa=ot.break_duration||0;return r.jsx("div",{className:"p-4 hover:bg-muted/30",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsxs("span",{className:"font-medium",children:[Pe(new Date(ot.start_time),"HH:mm")," - ",ot.end_time?Pe(new Date(ot.end_time),"HH:mm"):"Aktiv"]}),r.jsx("span",{className:_e("px-2 py-1 rounded-full text-xs font-medium",ot.status==="aktiv"?"bg-green-100 text-green-800":ot.status==="beendet"?"bg-blue-100 text-blue-800":ot.status==="pausiert"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:ot.status==="aktiv"?"Aktiv":ot.status==="beendet"?"Beendet":ot.status==="pausiert"?"Pausiert":ot.status})]}),r.jsxs("div",{className:"text-sm text-muted-foreground",children:[r.jsxs("p",{children:[r.jsx("strong",{children:"Projekt:"})," ",($t==null?void 0:$t.name)||"Kein Projekt"]}),ot.description&&r.jsxs("p",{children:[r.jsx("strong",{children:"Beschreibung:"})," ",ot.description]}),Wa>0&&r.jsxs("p",{children:[r.jsx("strong",{children:"Pause:"})," ",Wa," min"]})]})]}),r.jsxs("div",{className:"text-right ml-4 flex items-center gap-2",children:[ot.end_time&&r.jsxs("span",{className:"text-lg font-bold",children:[Qr.toFixed(1),"h"]}),e==="manager"&&r.jsx(W,{size:"sm",variant:"outline",onClick:()=>{B(ot),O(!0)},children:r.jsx(Io,{className:"w-4 h-4"})})]})]})},ot.id)})})]},ut)}).filter(Boolean)})(),Object.keys(Ze).length===0&&r.jsx("div",{className:"p-8 text-center text-muted-foreground border rounded-lg",children:"Keine Zeiterfassungseinträge für den ausgewählten Mitarbeiter gefunden"})]}):r.jsx("div",{className:"p-8 text-center text-muted-foreground border rounded-lg",children:"Bitte wählen Sie einen Mitarbeiter aus, um die Zeiterfassung anzuzeigen"})]})})()})]}),r.jsx($e,{}),r.jsx(Z,{}),r.jsx(yY,{open:q,onOpenChange:O,timeEntry:F,projects:h,onSave:()=>{}})]})};function wY({open:t,onOpenChange:e}){const[n,s]=f.useState(""),[a,i]=f.useState(""),[o,l]=f.useState(""),[c,d]=f.useState(void 0),[u,h]=f.useState(""),[m,p]=f.useState(19),[b,x]=f.useState([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),{toast:g}=pt(),y=On(),{data:v=[]}=Wr({queryKey:["customers"],queryFn:async()=>{const{data:T,error:I}=await $.from("customers").select("id, company_name, contact_person").eq("status","Aktiv").order("company_name");if(I)throw I;return T}}),w=kr({mutationFn:async T=>{const I=b.reduce((B,R)=>B+R.total_price,0),V=I*m/100,ne=I+V,{data:se,error:q}=await $.from("quotes").insert({title:n,description:a,customer_id:o,valid_until:c?Pe(c,"yyyy-MM-dd"):null,tax_rate:m,net_amount:I,tax_amount:V,total_amount:ne,notes:u,quote_number:""}).select().single();if(q)throw q;const O=b.map((B,R)=>({quote_id:se.id,position:R+1,description:B.description,quantity:B.quantity,unit:B.unit,unit_price:B.unit_price,total_price:B.total_price})),{error:F}=await $.from("document_items").insert(O);if(F)throw F;return se},onSuccess:()=>{g({title:"Erfolgreich",description:"Angebot wurde erfolgreich erstellt."}),y.invalidateQueries({queryKey:["quotes"]}),j()},onError:T=>{g({title:"Fehler",description:"Beim Erstellen des Angebots ist ein Fehler aufgetreten.",variant:"destructive"}),console.error("Error creating quote:",T)}}),j=()=>{s(""),i(""),l(""),d(void 0),h(""),p(19),x([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),e(!1)},S=()=>{const T={id:Date.now().toString(),description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0};x([...b,T])},N=T=>{b.length>1&&x(b.filter(I=>I.id!==T))},k=(T,I,V)=>{x(b.map(ne=>{if(ne.id===T){const se={...ne,[I]:V};return(I==="quantity"||I==="unit_price")&&(se.total_price=se.quantity*se.unit_price),se}return ne}))},E=b.reduce((T,I)=>T+I.total_price,0),P=E*m/100,A=E+P,C=T=>{if(T.preventDefault(),!n||!o||b.some(I=>!I.description)){g({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}w.mutate({})};return r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx(Bt,{children:r.jsx(Lt,{children:"Neues Angebot erstellen"})}),r.jsxs("form",{onSubmit:C,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"title",children:"Titel *"}),r.jsx(G,{id:"title",value:n,onChange:T=>s(T.target.value),placeholder:"Angebots-Titel eingeben",required:!0})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"customer",children:"Kunde *"}),r.jsxs(tt,{value:o,onValueChange:l,required:!0,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Kunde auswählen"})}),r.jsx(Xe,{children:v.map(T=>r.jsxs(ce,{value:T.id,children:[T.company_name," (",T.contact_person,")"]},T.id))})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"description",children:"Beschreibung"}),r.jsx(an,{id:"description",value:a,onChange:T=>i(T.target.value),placeholder:"Beschreibung des Angebots",rows:3})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{children:"Gültig bis"}),r.jsxs(ia,{children:[r.jsx(oa,{asChild:!0,children:r.jsxs(W,{variant:"outline",className:_e("w-full justify-start text-left font-normal",!c&&"text-muted-foreground"),children:[r.jsx(gt,{className:"mr-2 h-4 w-4"}),c?Pe(c,"PPP",{locale:Wt}):"Datum auswählen"]})}),r.jsx(ks,{className:"w-auto p-0",align:"start",children:r.jsx(Cs,{mode:"single",selected:c,onSelect:d,initialFocus:!0})})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"taxRate",children:"Steuersatz (%)"}),r.jsx(G,{id:"taxRate",type:"number",step:"0.01",min:"0",max:"100",value:m,onChange:T=>p(parseFloat(T.target.value)||0)})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center justify-between",children:["Positionen",r.jsxs(W,{type:"button",onClick:S,size:"sm",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Position hinzufügen"]})]})}),r.jsxs(te,{className:"space-y-4",children:[b.map(T=>r.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[r.jsxs("div",{className:"col-span-4 space-y-2",children:[r.jsx(H,{children:"Beschreibung *"}),r.jsx(G,{value:T.description,onChange:I=>k(T.id,"description",I.target.value),placeholder:"Beschreibung der Position",required:!0})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(H,{children:"Menge"}),r.jsx(G,{type:"number",step:"0.01",min:"0",value:T.quantity,onChange:I=>k(T.id,"quantity",parseFloat(I.target.value)||0)})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(H,{children:"Einheit"}),r.jsxs(tt,{value:T.unit,onValueChange:I=>k(T.id,"unit",I),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Stk.",children:"Stk."}),r.jsx(ce,{value:"h",children:"Stunden"}),r.jsx(ce,{value:"m",children:"Meter"}),r.jsx(ce,{value:"m²",children:"m²"}),r.jsx(ce,{value:"kg",children:"kg"}),r.jsx(ce,{value:"l",children:"Liter"})]})]})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(H,{children:"Einzelpreis"}),r.jsx(G,{type:"number",step:"0.01",min:"0",value:T.unit_price,onChange:I=>k(T.id,"unit_price",parseFloat(I.target.value)||0)})]}),r.jsxs("div",{className:"col-span-1 space-y-2",children:[r.jsx(H,{children:"Gesamt"}),r.jsxs("div",{className:"text-sm font-medium p-2 bg-muted rounded",children:[T.total_price.toFixed(2)," €"]})]}),r.jsx("div",{className:"col-span-1",children:r.jsx(W,{type:"button",variant:"ghost",size:"sm",onClick:()=>N(T.id),disabled:b.length===1,children:r.jsx(ra,{className:"h-4 w-4"})})})]},T.id)),r.jsxs("div",{className:"border-t pt-4 space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Nettosumme:"}),r.jsxs("span",{children:[E.toFixed(2)," €"]})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsxs("span",{children:["MwSt. (",m,"%):"]}),r.jsxs("span",{children:[P.toFixed(2)," €"]})]}),r.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[r.jsx("span",{children:"Gesamtsumme:"}),r.jsxs("span",{children:[A.toFixed(2)," €"]})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"notes",children:"Anmerkungen"}),r.jsx(an,{id:"notes",value:u,onChange:T=>h(T.target.value),placeholder:"Zusätzliche Anmerkungen zum Angebot",rows:3})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(W,{type:"button",variant:"outline",onClick:j,children:"Abbrechen"}),r.jsx(W,{type:"submit",disabled:w.isPending,children:w.isPending?"Erstelle...":"Angebot erstellen"})]})]})]})})}function jY({open:t,onOpenChange:e}){const[n,s]=f.useState(""),[a,i]=f.useState(""),[o,l]=f.useState(""),[c,d]=f.useState(""),[u,h]=f.useState(new Date),[m,p]=f.useState(zn(new Date,30)),[b,x]=f.useState("30 Tage netto"),[g,y]=f.useState(""),[v,w]=f.useState(19),[j,S]=f.useState([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),{toast:N}=pt(),k=On(),{data:E=[]}=Wr({queryKey:["customers"],queryFn:async()=>{const{data:B,error:R}=await $.from("customers").select("id, company_name, contact_person").eq("status","Aktiv").order("company_name");if(R)throw R;return B}}),{data:P=[]}=Wr({queryKey:["quotes-for-invoice"],queryFn:async()=>{const{data:B,error:R}=await $.from("quotes").select("id, quote_number, title, customer_id").eq("status","Angenommen").order("created_at",{ascending:!1});if(R)throw R;return B}}),A=kr({mutationFn:async B=>{const R=j.reduce((Y,ae)=>Y+ae.total_price,0),D=R*v/100,L=R+D,{data:M,error:X}=await $.from("invoices").insert({title:n,description:a,customer_id:o,quote_id:c||null,invoice_date:Pe(u,"yyyy-MM-dd"),due_date:Pe(m,"yyyy-MM-dd"),payment_terms:b,tax_rate:v,net_amount:R,tax_amount:D,total_amount:L,notes:g,invoice_number:""}).select().single();if(X)throw X;const K=j.map((Y,ae)=>({invoice_id:M.id,position:ae+1,description:Y.description,quantity:Y.quantity,unit:Y.unit,unit_price:Y.unit_price,total_price:Y.total_price})),{error:z}=await $.from("document_items").insert(K);if(z)throw z;return M},onSuccess:()=>{N({title:"Erfolgreich",description:"Rechnung wurde erfolgreich erstellt."}),k.invalidateQueries({queryKey:["invoices"]}),C()},onError:B=>{N({title:"Fehler",description:"Beim Erstellen der Rechnung ist ein Fehler aufgetreten.",variant:"destructive"}),console.error("Error creating invoice:",B)}}),C=()=>{s(""),i(""),l(""),d(""),h(new Date),p(zn(new Date,30)),x("30 Tage netto"),y(""),w(19),S([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),e(!1)},T=()=>{const B={id:Date.now().toString(),description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0};S([...j,B])},I=B=>{j.length>1&&S(j.filter(R=>R.id!==B))},V=(B,R,D)=>{S(j.map(L=>{if(L.id===B){const M={...L,[R]:D};return(R==="quantity"||R==="unit_price")&&(M.total_price=M.quantity*M.unit_price),M}return L}))},ne=async B=>{if(B)try{const{data:R,error:D}=await $.from("quotes").select(`
          *,
          customer:customers(company_name, contact_person)
        `).eq("id",B).single();if(D)throw D;const{data:L,error:M}=await $.from("document_items").select("*").eq("quote_id",B).order("position");if(M)throw M;if(s(`Rechnung für ${R.title}`),i(R.description||""),l(R.customer_id),w(R.tax_rate),y(R.notes||""),L&&L.length>0){const X=L.map(K=>({id:K.id,description:K.description,quantity:K.quantity,unit:K.unit,unit_price:K.unit_price,total_price:K.total_price}));S(X)}N({title:"Angebotsdaten geladen",description:"Die Daten aus dem Angebot wurden übernommen."})}catch(R){console.error("Error loading quote data:",R),N({title:"Fehler",description:"Beim Laden der Angebotsdaten ist ein Fehler aufgetreten.",variant:"destructive"})}},se=j.reduce((B,R)=>B+R.total_price,0),q=se*v/100,O=se+q,F=B=>{if(B.preventDefault(),!n||!o||j.some(R=>!R.description)){N({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}A.mutate({})};return r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx(Bt,{children:r.jsx(Lt,{children:"Neue Rechnung erstellen"})}),r.jsxs("form",{onSubmit:F,className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"title",children:"Titel *"}),r.jsx(G,{id:"title",value:n,onChange:B=>s(B.target.value),placeholder:"Rechnungs-Titel eingeben",required:!0})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"customer",children:"Kunde *"}),r.jsxs(tt,{value:o,onValueChange:l,required:!0,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Kunde auswählen"})}),r.jsx(Xe,{children:E.map(B=>r.jsxs(ce,{value:B.id,children:[B.company_name," (",B.contact_person,")"]},B.id))})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"quote",children:"Basiert auf Angebot (optional)"}),r.jsxs(tt,{value:c,onValueChange:B=>{d(B),B&&ne(B)},children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Angebot auswählen (optional)"})}),r.jsx(Xe,{children:P.map(B=>r.jsxs(ce,{value:B.id,children:[B.quote_number," - ",B.title]},B.id))})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"description",children:"Beschreibung"}),r.jsx(an,{id:"description",value:a,onChange:B=>i(B.target.value),placeholder:"Beschreibung der Rechnung",rows:3})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{children:"Rechnungsdatum"}),r.jsxs(ia,{children:[r.jsx(oa,{asChild:!0,children:r.jsxs(W,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[r.jsx(gt,{className:"mr-2 h-4 w-4"}),Pe(u,"PPP",{locale:Wt})]})}),r.jsx(ks,{className:"w-auto p-0",align:"start",children:r.jsx(Cs,{mode:"single",selected:u,onSelect:B=>B&&h(B),initialFocus:!0})})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{children:"Fälligkeitsdatum"}),r.jsxs(ia,{children:[r.jsx(oa,{asChild:!0,children:r.jsxs(W,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[r.jsx(gt,{className:"mr-2 h-4 w-4"}),Pe(m,"PPP",{locale:Wt})]})}),r.jsx(ks,{className:"w-auto p-0",align:"start",children:r.jsx(Cs,{mode:"single",selected:m,onSelect:B=>B&&p(B),initialFocus:!0})})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"paymentTerms",children:"Zahlungsbedingungen"}),r.jsxs(tt,{value:b,onValueChange:x,children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Sofort",children:"Sofort"}),r.jsx(ce,{value:"7 Tage netto",children:"7 Tage netto"}),r.jsx(ce,{value:"14 Tage netto",children:"14 Tage netto"}),r.jsx(ce,{value:"30 Tage netto",children:"30 Tage netto"}),r.jsx(ce,{value:"60 Tage netto",children:"60 Tage netto"})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"taxRate",children:"Steuersatz (%)"}),r.jsx(G,{id:"taxRate",type:"number",step:"0.01",min:"0",max:"100",value:v,onChange:B=>w(parseFloat(B.target.value)||0),className:"w-32"})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center justify-between",children:["Positionen",r.jsxs(W,{type:"button",onClick:T,size:"sm",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Position hinzufügen"]})]})}),r.jsxs(te,{className:"space-y-4",children:[j.map(B=>r.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[r.jsxs("div",{className:"col-span-4 space-y-2",children:[r.jsx(H,{children:"Beschreibung *"}),r.jsx(G,{value:B.description,onChange:R=>V(B.id,"description",R.target.value),placeholder:"Beschreibung der Position",required:!0})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(H,{children:"Menge"}),r.jsx(G,{type:"number",step:"0.01",min:"0",value:B.quantity,onChange:R=>V(B.id,"quantity",parseFloat(R.target.value)||0)})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(H,{children:"Einheit"}),r.jsxs(tt,{value:B.unit,onValueChange:R=>V(B.id,"unit",R),children:[r.jsx(Je,{children:r.jsx(nt,{})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Stk.",children:"Stk."}),r.jsx(ce,{value:"h",children:"Stunden"}),r.jsx(ce,{value:"m",children:"Meter"}),r.jsx(ce,{value:"m²",children:"m²"}),r.jsx(ce,{value:"kg",children:"kg"}),r.jsx(ce,{value:"l",children:"Liter"})]})]})]}),r.jsxs("div",{className:"col-span-2 space-y-2",children:[r.jsx(H,{children:"Einzelpreis"}),r.jsx(G,{type:"number",step:"0.01",min:"0",value:B.unit_price,onChange:R=>V(B.id,"unit_price",parseFloat(R.target.value)||0)})]}),r.jsxs("div",{className:"col-span-1 space-y-2",children:[r.jsx(H,{children:"Gesamt"}),r.jsxs("div",{className:"text-sm font-medium p-2 bg-muted rounded",children:[B.total_price.toFixed(2)," €"]})]}),r.jsx("div",{className:"col-span-1",children:r.jsx(W,{type:"button",variant:"ghost",size:"sm",onClick:()=>I(B.id),disabled:j.length===1,children:r.jsx(ra,{className:"h-4 w-4"})})})]},B.id)),r.jsxs("div",{className:"border-t pt-4 space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Nettosumme:"}),r.jsxs("span",{children:[se.toFixed(2)," €"]})]}),r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsxs("span",{children:["MwSt. (",v,"%):"]}),r.jsxs("span",{children:[q.toFixed(2)," €"]})]}),r.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[r.jsx("span",{children:"Gesamtsumme:"}),r.jsxs("span",{children:[O.toFixed(2)," €"]})]})]})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"notes",children:"Anmerkungen"}),r.jsx(an,{id:"notes",value:g,onChange:B=>y(B.target.value),placeholder:"Zusätzliche Anmerkungen zur Rechnung",rows:3})]}),r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(W,{type:"button",variant:"outline",onClick:C,children:"Abbrechen"}),r.jsx(W,{type:"submit",disabled:A.isPending,children:A.isPending?"Erstelle...":"Rechnung erstellen"})]})]})]})})}const _Y=({quote:t,onRefresh:e})=>{const n=bW(),s=UD(),a=()=>{n.mutate(t.id,{onSuccess:()=>{e==null||e()}})},i=()=>{s.mutate({name:t.title,description:t.description,customer_id:t.customer_id,status:"neu",start_date:new Date().toISOString().split("T")[0],quote_id:t.id},{onSuccess:()=>{e==null||e()}})},o=n.isPending||s.isPending,l=t.status==="accepted"||t.status==="sent"||t.status==="versendet";return r.jsxs("div",{className:"flex space-x-1",children:[l&&r.jsxs(W,{size:"sm",variant:"default",onClick:a,disabled:o,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[r.jsx(N0,{className:"h-3 w-3 mr-1"}),"Auftrag erstellen"]}),r.jsxs(W,{size:"sm",variant:"outline",onClick:i,disabled:o,title:"Direkt zu Projekt (überspringt Auftrag)",children:[r.jsx(As,{className:"h-3 w-3 mr-1"}),"Zu Projekt"]})]})},NY=Ju("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Wm=f.forwardRef(({className:t,variant:e,...n},s)=>r.jsx("div",{ref:s,role:"alert",className:_e(NY({variant:e}),t),...n}));Wm.displayName="Alert";const SY=f.forwardRef(({className:t,...e},n)=>r.jsx("h5",{ref:n,className:_e("mb-1 font-medium leading-none tracking-tight",t),...e}));SY.displayName="AlertTitle";const Hm=f.forwardRef(({className:t,...e},n)=>r.jsx("div",{ref:n,className:_e("text-sm [&_p]:leading-relaxed",t),...e}));Hm.displayName="AlertDescription";function kY({onOCRComplete:t,onError:e,className:n="",accept:s="image/*,.pdf",maxSize:a=10}){const[i,o]=f.useState(!1),[l,c]=f.useState(null),[d,u]=f.useState(0),h=EW({onSuccess:S=>{c(null),u(0),t==null||t(S)},onError:S=>{c(null),u(0),e==null||e(S.message)}}),m=f.useCallback(S=>{S.preventDefault(),o(!0)},[]),p=f.useCallback(S=>{S.preventDefault(),o(!1)},[]),b=f.useCallback(S=>{S.preventDefault(),o(!1);const N=Array.from(S.dataTransfer.files);N.length>0&&g(N[0])},[]),x=f.useCallback(S=>{const N=S.target.files;N&&N.length>0&&g(N[0]),S.target.value=""},[]),g=f.useCallback(S=>{if(!["image/jpeg","image/png","image/gif","image/bmp","image/webp","application/pdf"].includes(S.type)){e==null||e("Nur Bilddateien (JPEG, PNG, GIF, BMP, WebP) und PDF-Dateien sind erlaubt.");return}if(S.size/(1024*1024)>a){e==null||e(`Datei zu groß. Maximale Größe: ${a}MB`);return}c(S)},[a,e]),y=f.useCallback(async()=>{if(l)try{u(25),console.log("Starting OCR processing for:",l.name),await h.mutateAsync(l)}catch(S){console.error("OCR processing failed:",S),e==null||e(S instanceof Error?S.message:"OCR-Verarbeitung fehlgeschlagen"),c(null),u(0)}},[l,h,e]),v=f.useCallback(()=>{c(null),u(0)},[]),w=S=>{if(S===0)return"0 Bytes";const N=1024,k=["Bytes","KB","MB","GB"],E=Math.floor(Math.log(S)/Math.log(N));return parseFloat((S/Math.pow(N,E)).toFixed(2))+" "+k[E]},j=S=>S.type.startsWith("image/")?r.jsx(Hl,{className:"h-8 w-8 text-blue-500"}):S.type==="application/pdf"?r.jsx(mn,{className:"h-8 w-8 text-red-500"}):r.jsx(mn,{className:"h-8 w-8 text-gray-500"});return l&&!h.isPending?r.jsx(J,{className:n,children:r.jsx(te,{className:"p-6",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center gap-4",children:[j(l),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("p",{className:"font-medium truncate",children:l.name}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsx("span",{children:w(l.size)}),r.jsx("span",{children:l.type}),r.jsx(Ae,{variant:"outline",children:"Bereit für OCR"})]})]}),r.jsx(W,{variant:"ghost",size:"sm",onClick:v,children:r.jsx(Mn,{className:"h-4 w-4"})})]}),r.jsxs(Wm,{children:[r.jsx(zd,{className:"h-4 w-4"}),r.jsx(Hm,{children:"Die Datei wird mit OCR verarbeitet und automatisch in deutsche Rechnung konvertiert. Dieser Vorgang kann 10-30 Sekunden dauern."})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(W,{onClick:y,disabled:h.isPending,className:"flex-1",children:[r.jsx(zd,{className:"mr-2 h-4 w-4"}),"OCR starten"]}),r.jsx(W,{variant:"outline",onClick:v,children:"Abbrechen"})]})]})})}):h.isPending?r.jsx(J,{className:n,children:r.jsx(te,{className:"p-6",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),r.jsx("h3",{className:"font-medium",children:"OCR-Verarbeitung läuft..."}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"Rechnung wird analysiert und Daten extrahiert"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex justify-between text-sm",children:[r.jsx("span",{children:"Fortschritt"}),r.jsxs("span",{children:[Math.round(d),"%"]})]}),r.jsx(kc,{value:d,className:"h-2"})]}),r.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(Rn,{className:"h-4 w-4 text-green-500"}),r.jsx("span",{children:"Datei hochgeladen"})]}),r.jsxs("div",{className:"flex items-center gap-2 text-sm mt-1",children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-primary"}),r.jsx("span",{children:"Tesseract OCR läuft..."})]})]}),r.jsxs(Wm,{children:[r.jsx(k0,{className:"h-4 w-4"}),r.jsx(Hm,{children:"Bitte warten Sie, bis die Verarbeitung abgeschlossen ist. Bei komplexen Dokumenten kann dies länger dauern."})]})]})})}):r.jsx(J,{className:`transition-colors ${i?"border-primary bg-primary/5":"border-dashed"} ${n}`,onDragOver:m,onDragLeave:p,onDrop:b,children:r.jsx(te,{className:"p-8",children:r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("div",{className:"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center",children:r.jsx(WC,{className:`h-8 w-8 ${i?"text-primary":"text-muted-foreground"}`})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("h3",{className:"text-lg font-medium",children:"Rechnung für OCR hochladen"}),r.jsx("p",{className:"text-muted-foreground",children:"Ziehen Sie eine Datei hierher oder klicken Sie zum Auswählen"})]}),r.jsx("div",{className:"flex justify-center",children:r.jsxs(W,{variant:"outline",onClick:()=>{var S;return(S=document.getElementById("ocr-file-input"))==null?void 0:S.click()},children:[r.jsx(mn,{className:"mr-2 h-4 w-4"}),"Datei auswählen"]})}),r.jsx("input",{id:"ocr-file-input",type:"file",accept:s,onChange:x,className:"hidden"}),r.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[r.jsx("p",{children:"Unterstützte Formate: JPEG, PNG, GIF, BMP, WebP, PDF"}),r.jsxs("p",{children:["Maximale Dateigröße: ",a,"MB"]}),r.jsx("p",{children:"Empfohlen: Hochauflösende Scans für beste Ergebnisse"})]}),r.jsxs(Wm,{className:"border-green-500 bg-green-50",children:[r.jsx($8,{className:"h-4 w-4 text-green-600"}),r.jsxs(Hm,{children:[r.jsx("strong",{className:"text-green-800",children:"KI-OCR aktiv:"})," OpenAI Vision erkennt Rechnungsdaten intelligent und extrahiert alle Felder automatisch - auch komplexe Tabellen!"]})]})]})})})}function CY({ocrResult:t,onValidated:e,onRejected:n,onCancel:s}){var F,B,R;const{toast:a}=pt(),[i,o]=f.useState(t.structured_data),[l,c]=f.useState(""),[d,u]=f.useState(!1),[h,m]=f.useState("basic"),[p,b]=f.useState(null),[x,g]=f.useState(!1),[y,v]=f.useState(!1);f.useEffect(()=>{o(t.structured_data),t.original_file_path&&t.original_file_path.startsWith("data:image")&&b(t.original_file_path)},[t]),f.useEffect(()=>{const D=L=>{L.key==="Escape"&&y&&v(!1)};return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},[y]);const w=async()=>{if(!x){g(!0);try{const D=[];if(i.invoiceNumber||D.push("Rechnungsnummer fehlt"),i.invoiceDate||D.push("Rechnungsdatum fehlt"),i.supplierName||D.push("Lieferantenname fehlt"),(!i.totalAmount||i.totalAmount<=0)&&D.push("Gesamtbetrag fehlt"),i.serviceDescription||D.push("Leistungsbeschreibung fehlt"),D.length>0){a({title:"Validierungsfehler",description:`Pflichtfelder fehlen: ${D.join(", ")}`,variant:"destructive"});return}await new Promise(L=>setTimeout(L,1e3)),a({title:"Rechnung validiert",description:"Die Rechnungsdaten wurden erfolgreich validiert."}),e==null||e(i)}catch{a({title:"Validierungsfehler",description:"Ein Fehler ist bei der Validierung aufgetreten.",variant:"destructive"})}finally{g(!1)}}},j=(D,L)=>{o(M=>({...M,[D]:L}))},S=(D,L)=>{const M=X=>Math.round(X*100)/100;o(X=>{const K={...X},z=D==="netAmount"?L:X.netAmount||0,Y=D==="vatAmount"?L:X.vatAmount||0;return D==="totalAmount"||X.totalAmount,D==="netAmount"?(K.netAmount=L,Y>0&&(K.totalAmount=M(L+Y))):D==="vatAmount"?(K.vatAmount=L,z>0&&(K.totalAmount=M(z+L))):D==="totalAmount"&&(K.totalAmount=L,z>0?K.vatAmount=M(L-z):Y>0&&(K.netAmount=M(L-Y))),K})},N=(D=19)=>{o(L=>({...L,taxRates:[...L.taxRates||[],D],netAmounts:{...L.netAmounts||{},[D.toString()]:0},taxAmounts:{...L.taxAmounts||{},[D.toString()]:0}}))},k=D=>{o(L=>{const M=[...L.taxRates||[]],X=M[D];M.splice(D,1);const K={...L.netAmounts||{}},z={...L.taxAmounts||{}};return delete K[X.toString()],delete z[X.toString()],{...L,taxRates:M,netAmounts:K,taxAmounts:z}})},E=(D,L,M)=>{o(X=>{const K=[...X.taxRates||[]],z={...X.netAmounts||{}},Y={...X.taxAmounts||{}},ae=K[D];return L==="rate"?(K[D]=M,ae!==M&&(z[M.toString()]=z[ae.toString()]||0,Y[M.toString()]=Y[ae.toString()]||0,delete z[ae.toString()],delete Y[ae.toString()])):L==="netAmount"?z[ae.toString()]=Math.round(M*100)/100:L==="taxAmount"&&(Y[ae.toString()]=Math.round(M*100)/100),{...X,taxRates:K,netAmounts:z,taxAmounts:Y}})},P=()=>{o(D=>{var L;return{...D,positions:[...D.positions||[],{position:(((L=D.positions)==null?void 0:L.length)||0)+1,description:"",quantity:1,unit:"Stk",unitPrice:0,totalPrice:0,vatRate:19}]}})},A=D=>{o(L=>{const M=[...L.positions||[]];return M.splice(D,1),M.forEach((X,K)=>{X.position=K+1}),{...L,positions:M}})},C=(D,L,M)=>{o(X=>{const K=[...X.positions||[]],z={...K[D]};return z[L]=M,(L==="quantity"||L==="unitPrice")&&(z.totalPrice=Math.round(z.quantity*z.unitPrice*100)/100),K[D]=z,{...X,positions:K}})},T=D=>{o(L=>{const M={...L,paymentTerms:D},X=L.invoiceDate;if(X&&D){const K=new Date(X);let z=30;const Y=D.match(/(\d+)\s*tage?/i);Y&&(z=parseInt(Y[1]));const ae=new Date(K);ae.setDate(ae.getDate()+z),M.dueDate=ae.toISOString().split("T")[0]}return M})},I=D=>{if(!D)return!0;const L={AT:/^AT[UB]\d{8}$/,BE:/^BE[01]\d{9}$/,BG:/^BG\d{9,10}$/,CY:/^CY\d{8}[A-Z]$/,CZ:/^CZ\d{8,10}$/,DE:/^DE\d{9}$/,DK:/^DK\d{8}$/,EE:/^EE\d{9}$/,EL:/^EL\d{9}$/,ES:/^ES[A-Z]\d{7}[A-Z]|\d{8}[A-Z]$/,FI:/^FI\d{8}$/,FR:/^FR[A-Z0-9]{2}\d{9}$/,GB:/^GB\d{9}|\d{12}|(GD|HA)\d{3}$/,HR:/^HR\d{11}$/,HU:/^HU\d{8}$/,IE:/^IE\d[A-Z0-9]\d{5}[A-Z]$/,IT:/^IT\d{11}$/,LT:/^LT\d{9}|\d{12}$/,LU:/^LU\d{8}$/,LV:/^LV\d{11}$/,MT:/^MT\d{8}$/,NL:/^NL\d{9}B\d{2}$/,PL:/^PL\d{10}$/,PT:/^PT\d{9}$/,RO:/^RO\d{2,10}$/,SE:/^SE\d{12}$/,SI:/^SI\d{8}$/,SK:/^SK\d{10}$/},M=D.substring(0,2).toUpperCase(),X=L[M];return X?X.test(D.toUpperCase()):!1},V=D=>{if(!D)return!0;const L=D.replace(/\s/g,"").toUpperCase();if(L.length<15||L.length>34||!/^[A-Z]{2}/.test(L)||!/^\d{2}/.test(L.substring(2,4)))return!1;const M=L.substring(4)+L.substring(0,4);let X="";for(let z=0;z<M.length;z++){const Y=M[z];Y>="A"&&Y<="Z"?X+=(Y.charCodeAt(0)-55).toString():X+=Y}let K=0;for(let z=0;z<X.length;z++)K=(K*10+parseInt(X[z]))%97;return K===1},ne=(D,L)=>D==="supplierVatId"&&L&&!I(L)?"Ungültige USt-IdNr. Format (z.B. DE123456789 für Deutschland)":D==="supplierIban"&&L&&!V(L)?"Ungültige IBAN. Prüfen Sie Format und Prüfziffer.":null,se=D=>D?D.toLocaleString("de-DE",{style:"currency",currency:"EUR"}):"0,00 €",q=D=>{if(D==null||D===0)return"";const L=D.toString(),M=L.split(".");if(M.length===1)return L;{const K=M[1].substring(0,6).replace(/0+$/,""),z=K.length<2?K.padEnd(2,"0"):K;return`${M[0]}.${z}`}},O=Object.entries(i).filter(([D,L])=>L!==void 0&&L!==""&&L!==0&&!(Array.isArray(L)&&L.length===0)&&!(typeof L=="object"&&Object.keys(L).length===0)).length;return r.jsxs("div",{className:"space-y-6 max-w-7xl mx-auto",children:[r.jsx(J,{children:r.jsx(pe,{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/20",children:r.jsx(mn,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),r.jsxs("div",{children:[r.jsx(xe,{children:"Rechnungsvalidierung"}),r.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[O," Felder erfasst • Überprüfen und korrigieren Sie die Daten"]})]})]}),r.jsx("div",{className:"flex gap-2",children:r.jsxs(W,{variant:"outline",size:"sm",onClick:()=>u(!d),children:[d?r.jsx(C8,{className:"h-4 w-4"}):r.jsx(na,{className:"h-4 w-4"}),"OCR-Text"]})})]})})}),r.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[p&&r.jsx("div",{className:"xl:col-span-1",children:r.jsxs(J,{className:"h-fit sticky top-6",children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Original-Dokument"}),r.jsxs(W,{variant:"outline",size:"sm",onClick:()=>v(!0),children:[r.jsx(na,{className:"h-4 w-4 mr-2"}),"Vollbild"]})]})}),r.jsx(te,{className:"p-0",children:r.jsxs("div",{className:"relative",children:[r.jsx("img",{src:p,alt:"Invoice",className:"w-full h-auto rounded-b-lg cursor-zoom-in hover:shadow-lg transition-shadow",style:{maxHeight:"calc(100vh - 200px)",minHeight:"600px",objectFit:"contain",backgroundColor:"#f8f9fa"},onClick:()=>v(!0),title:"Klicken für Vollbildansicht"}),r.jsx("div",{className:"absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-xs",children:"Klicken zum Vergrößern"})]})})]})}),r.jsxs("div",{className:p?"xl:col-span-1":"xl:col-span-2",children:[r.jsx(J,{children:r.jsx(te,{className:"p-0",children:r.jsxs(cr,{value:h,onValueChange:m,children:[r.jsx("div",{className:"p-6 pb-0",children:r.jsxs(tr,{className:"grid w-full grid-cols-6",children:[r.jsx(Oe,{value:"basic",children:"Basis"}),r.jsx(Oe,{value:"supplier",children:"Lieferant"}),r.jsx(Oe,{value:"amounts",children:"Beträge"}),r.jsx(Oe,{value:"positions",children:"Positionen"}),r.jsx(Oe,{value:"references",children:"Referenzen"}),r.jsx(Oe,{value:"additional",children:"Erweitert"})]})}),r.jsxs(Fe,{value:"basic",className:"p-6 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{htmlFor:"invoiceNumber",className:"flex items-center gap-2",children:[r.jsx(A8,{className:"h-4 w-4"}),"Rechnungsnummer *"]}),r.jsx(G,{id:"invoiceNumber",value:i.invoiceNumber||"",onChange:D=>j("invoiceNumber",D.target.value),className:i.invoiceNumber?"":"border-red-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{htmlFor:"invoiceDate",className:"flex items-center gap-2",children:[r.jsx(gt,{className:"h-4 w-4"}),"Rechnungsdatum *"]}),r.jsx(G,{id:"invoiceDate",type:"date",value:i.invoiceDate||"",onChange:D=>j("invoiceDate",D.target.value),className:i.invoiceDate?"":"border-red-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"serviceDate",children:"Leistungsdatum"}),r.jsx(G,{id:"serviceDate",type:"date",value:i.serviceDate||"",onChange:D=>j("serviceDate",D.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"dueDate",children:"Fälligkeitsdatum"}),r.jsx(G,{id:"dueDate",type:"date",value:i.dueDate||"",onChange:D=>j("dueDate",D.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"currency",children:"Währung"}),r.jsx(G,{id:"currency",value:i.currency||"EUR",onChange:D=>j("currency",D.target.value)})]})]}),r.jsx(Ni,{}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{htmlFor:"serviceDescription",className:"flex items-center gap-2",children:[r.jsx(mn,{className:"h-4 w-4"}),"Leistungsbeschreibung *"]}),r.jsx(an,{id:"serviceDescription",value:i.serviceDescription||"",onChange:D=>j("serviceDescription",D.target.value),className:i.serviceDescription?"":"border-red-500",rows:3})]})]}),r.jsx(Fe,{value:"supplier",className:"p-6 space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{htmlFor:"supplierName",className:"flex items-center gap-2",children:[r.jsx(As,{className:"h-4 w-4"}),"Lieferant/Firma *"]}),r.jsx(G,{id:"supplierName",value:i.supplierName||"",onChange:D=>j("supplierName",D.target.value),className:i.supplierName?"":"border-red-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{htmlFor:"contactPerson",className:"flex items-center gap-2",children:[r.jsx(Ps,{className:"h-4 w-4"}),"Ansprechpartner"]}),r.jsx(G,{id:"contactPerson",value:i.contactPerson||"",onChange:D=>j("contactPerson",D.target.value)})]}),r.jsxs("div",{className:"md:col-span-2 space-y-2",children:[r.jsxs(H,{htmlFor:"supplierAddress",className:"flex items-center gap-2",children:[r.jsx(la,{className:"h-4 w-4"}),"Lieferantenadresse"]}),r.jsx(an,{id:"supplierAddress",value:i.supplierAddress||"",onChange:D=>j("supplierAddress",D.target.value),rows:2})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"supplierVatId",children:"USt-IdNr."}),r.jsx(G,{id:"supplierVatId",value:i.supplierVatId||"",onChange:D=>j("supplierVatId",D.target.value),placeholder:"DE123456789",className:i.supplierVatId&&!I(i.supplierVatId)?"border-red-500":""}),i.supplierVatId&&!I(i.supplierVatId)&&r.jsx("p",{className:"text-sm text-red-600",children:ne("supplierVatId",i.supplierVatId)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"supplierTaxNumber",children:"Steuernummer"}),r.jsx(G,{id:"supplierTaxNumber",value:i.supplierTaxNumber||"",onChange:D=>j("supplierTaxNumber",D.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{htmlFor:"supplierEmail",className:"flex items-center gap-2",children:[r.jsx(Tn,{className:"h-4 w-4"}),"E-Mail"]}),r.jsx(G,{id:"supplierEmail",type:"email",value:i.supplierEmail||"",onChange:D=>j("supplierEmail",D.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{htmlFor:"supplierPhone",className:"flex items-center gap-2",children:[r.jsx(Rc,{className:"h-4 w-4"}),"Telefon"]}),r.jsx(G,{id:"supplierPhone",value:i.supplierPhone||"",onChange:D=>j("supplierPhone",D.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{htmlFor:"supplierIban",className:"flex items-center gap-2",children:[r.jsx(N8,{className:"h-4 w-4"}),"IBAN"]}),r.jsx(G,{id:"supplierIban",value:i.supplierIban||"",onChange:D=>j("supplierIban",D.target.value),placeholder:"DE89 3704 0044 0532 0130 00",className:i.supplierIban&&!V(i.supplierIban)?"border-red-500":""}),i.supplierIban&&!V(i.supplierIban)&&r.jsx("p",{className:"text-sm text-red-600",children:ne("supplierIban",i.supplierIban)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"supplierBic",children:"BIC"}),r.jsx(G,{id:"supplierBic",value:i.supplierBic||"",onChange:D=>j("supplierBic",D.target.value),placeholder:"COBADEFFXXX"})]})]})}),r.jsxs(Fe,{value:"amounts",className:"p-6 space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{htmlFor:"totalAmount",className:"flex items-center gap-2",children:[r.jsx(ws,{className:"h-4 w-4"}),"Gesamtbetrag (Brutto) *"]}),r.jsx(G,{id:"totalAmount",type:"number",step:"0.01",value:q(i.totalAmount),onChange:D=>S("totalAmount",parseFloat(D.target.value)||0),className:i.totalAmount?"":"border-red-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"netAmount",children:"Nettobetrag"}),r.jsx(G,{id:"netAmount",type:"number",step:"0.01",value:q(i.netAmount),onChange:D=>S("netAmount",parseFloat(D.target.value)||0)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"vatAmount",children:"MwSt-Betrag"}),r.jsx(G,{id:"vatAmount",type:"number",step:"0.01",value:q(i.vatAmount),onChange:D=>S("vatAmount",parseFloat(D.target.value)||0)})]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(H,{children:"Steuer-Sätze"}),r.jsx(W,{type:"button",variant:"outline",size:"sm",onClick:()=>N(19),className:"h-8",children:"+ Steuer hinzufügen"})]}),r.jsxs("div",{className:"border rounded-lg",children:[r.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 bg-gray-50 dark:bg-gray-800 font-medium text-sm",children:[r.jsx("div",{children:"Satz (%)"}),r.jsx("div",{children:"Nettobasis (€)"}),r.jsx("div",{children:"Steuerbetrag (€)"}),r.jsx("div",{className:"text-right",children:"Aktionen"})]}),(i.taxRates||[]).map((D,L)=>{var M,X;return r.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-t",children:[r.jsx(G,{type:"number",step:"0.01",value:D,onChange:K=>E(L,"rate",parseFloat(K.target.value)||0),className:"h-8"}),r.jsx(G,{type:"number",step:"0.01",value:q((M=i.netAmounts)==null?void 0:M[D.toString()]),onChange:K=>E(L,"netAmount",parseFloat(K.target.value)||0),className:"h-8"}),r.jsx(G,{type:"number",step:"0.01",value:q((X=i.taxAmounts)==null?void 0:X[D.toString()]),onChange:K=>E(L,"taxAmount",parseFloat(K.target.value)||0),className:"h-8"}),r.jsx("div",{className:"text-right",children:r.jsx(W,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(L),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:r.jsx(Mn,{className:"h-4 w-4"})})})]},L)}),(!i.taxRates||i.taxRates.length===0)&&r.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:'Keine Steuersätze erfasst. Klicken Sie auf "+ Steuer hinzufügen" um zu beginnen.'})]}),r.jsxs("div",{className:"flex justify-end text-sm text-gray-600",children:["Summe MwSt: ",se(Object.values(i.taxAmounts||{}).reduce((D,L)=>D+L,0))]})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsx(H,{children:"Spezielle Steuerarten"}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(aa,{id:"hasReverseCharge",checked:i.hasReverseCharge||!1,onCheckedChange:D=>j("hasReverseCharge",D)}),r.jsx(H,{htmlFor:"hasReverseCharge",className:"text-sm",children:"Reverse-Charge (Steuerschuldnerschaft des Leistungsempfängers)"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(aa,{id:"isIntraCommunitySupply",checked:i.isIntraCommunitySupply||!1,onCheckedChange:D=>j("isIntraCommunitySupply",D)}),r.jsx(H,{htmlFor:"isIntraCommunitySupply",className:"text-sm",children:"Innergemeinschaftliche Lieferung"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(aa,{id:"isExport",checked:i.isExport||!1,onCheckedChange:D=>j("isExport",D)}),r.jsx(H,{htmlFor:"isExport",className:"text-sm",children:"Ausfuhrlieferung"})]})]})]})]}),r.jsx(Fe,{value:"positions",className:"p-6 space-y-4",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx(H,{className:"text-base font-semibold",children:"Rechnungspositionen"}),r.jsx(W,{type:"button",variant:"outline",size:"sm",onClick:()=>P(),className:"h-8",children:"+ Position hinzufügen"})]}),r.jsxs("div",{className:"border rounded-lg",children:[r.jsxs("div",{className:"grid grid-cols-7 gap-2 p-3 bg-gray-50 dark:bg-gray-800 font-medium text-sm",children:[r.jsx("div",{children:"Pos."}),r.jsx("div",{children:"Beschreibung"}),r.jsx("div",{children:"Menge"}),r.jsx("div",{children:"Einheit"}),r.jsx("div",{children:"EP (€)"}),r.jsx("div",{children:"MwSt %"}),r.jsx("div",{className:"text-right",children:"Aktionen"})]}),(i.positions||[]).map((D,L)=>r.jsxs("div",{className:"grid grid-cols-7 gap-2 p-3 border-t",children:[r.jsx(G,{type:"number",value:D.position||L+1,onChange:M=>C(L,"position",parseInt(M.target.value)||L+1),className:"h-8"}),r.jsx(G,{type:"text",value:D.description,onChange:M=>C(L,"description",M.target.value),className:"h-8",placeholder:"Beschreibung..."}),r.jsx(G,{type:"number",step:"0.01",value:D.quantity,onChange:M=>C(L,"quantity",parseFloat(M.target.value)||0),className:"h-8"}),r.jsx(G,{type:"text",value:D.unit||"Stk",onChange:M=>C(L,"unit",M.target.value),className:"h-8"}),r.jsx(G,{type:"number",step:"0.01",value:q(D.unitPrice),onChange:M=>C(L,"unitPrice",parseFloat(M.target.value)||0),className:"h-8"}),r.jsx(G,{type:"number",step:"0.01",value:D.vatRate||19,onChange:M=>C(L,"vatRate",parseFloat(M.target.value)||19),className:"h-8"}),r.jsx("div",{className:"text-right",children:r.jsx(W,{type:"button",variant:"ghost",size:"sm",onClick:()=>A(L),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:r.jsx(Mn,{className:"h-4 w-4"})})})]},L)),(!i.positions||i.positions.length===0)&&r.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:'Keine Positionen erfasst. Klicken Sie auf "+ Position hinzufügen" um zu beginnen.'})]}),i.positions&&i.positions.length>0&&r.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg space-y-2",children:[r.jsx("div",{className:"font-medium",children:"Positionssummen:"}),r.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{children:["Netto gesamt: ",se(i.positions.reduce((D,L)=>D+L.quantity*L.unitPrice,0))]}),r.jsxs("div",{children:["MwSt gesamt: ",se(i.positions.reduce((D,L)=>{const M=L.quantity*L.unitPrice,X=(L.vatRate||19)/100;return D+M*X},0))]}),r.jsxs("div",{className:"font-medium",children:["Brutto gesamt: ",se(i.positions.reduce((D,L)=>{const M=L.quantity*L.unitPrice,X=(L.vatRate||19)/100;return D+M+M*X},0))]})]})]})]})}),r.jsxs(Fe,{value:"references",className:"p-6 space-y-4",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx(H,{className:"text-base font-semibold",children:"Zahlungsbedingungen"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"paymentTerms",children:'Zahlungsziel (z.B. "14 Tage, 2% Skonto")'}),r.jsx(G,{id:"paymentTerms",value:i.paymentTerms||"",onChange:D=>T(D.target.value),placeholder:"z.B. 14 Tage netto"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"dueDate",children:"Fälligkeitsdatum *"}),r.jsx(G,{id:"dueDate",type:"date",value:i.dueDate||"",onChange:D=>j("dueDate",D.target.value),className:i.dueDate?"":"border-yellow-500"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"paymentReference",children:"Zahlungsreferenz/Verwendungszweck"}),r.jsx(G,{id:"paymentReference",value:i.paymentReference||"",onChange:D=>j("paymentReference",D.target.value),placeholder:"Verwendungszweck..."})]})]})]}),r.jsx(Ni,{}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"orderNumber",children:"Bestellnummer"}),r.jsx(G,{id:"orderNumber",value:i.orderNumber||"",onChange:D=>j("orderNumber",D.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"projectReference",children:"Projekt-Referenz"}),r.jsx(G,{id:"projectReference",value:i.projectReference||"",onChange:D=>j("projectReference",D.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"deliveryNoteNumber",children:"Lieferscheinnummer"}),r.jsx(G,{id:"deliveryNoteNumber",value:i.deliveryNoteNumber||"",onChange:D=>j("deliveryNoteNumber",D.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"paymentReference",children:"Zahlungsreferenz/Verwendungszweck"}),r.jsx(G,{id:"paymentReference",value:i.paymentReference||"",onChange:D=>j("paymentReference",D.target.value)})]}),r.jsxs("div",{className:"md:col-span-2 space-y-2",children:[r.jsx(H,{htmlFor:"serviceLocation",children:"Liefer-/Leistungsort"}),r.jsx(G,{id:"serviceLocation",value:i.serviceLocation||"",onChange:D=>j("serviceLocation",D.target.value)})]})]})]}),r.jsx(Fe,{value:"additional",className:"p-6 space-y-4",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"servicePeriodStart",children:"Leistungszeitraum - Von"}),r.jsx(G,{id:"servicePeriodStart",type:"date",value:i.servicePeriodStart||"",onChange:D=>j("servicePeriodStart",D.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"servicePeriodEnd",children:"Leistungszeitraum - Bis"}),r.jsx(G,{id:"servicePeriodEnd",type:"date",value:i.servicePeriodEnd||"",onChange:D=>j("servicePeriodEnd",D.target.value)})]})]}),r.jsx(Ni,{}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{children:"Empfänger (Ihr Unternehmen)"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(G,{placeholder:"Firmenname",value:i.customerName||"",onChange:D=>j("customerName",D.target.value)}),r.jsx(an,{placeholder:"Adresse",value:i.customerAddress||"",onChange:D=>j("customerAddress",D.target.value),rows:2})]})]}),r.jsx(Ni,{}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"validationNotes",children:"Validierungsnotizen"}),r.jsx(an,{id:"validationNotes",value:l,onChange:D=>c(D.target.value),placeholder:"Notizen zur Validierung...",rows:3})]}),i.positions&&i.positions.length>0&&r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{children:["Erkannte Rechnungspositionen (",i.positions.length,")"]}),r.jsx("div",{className:"border rounded-lg p-3 space-y-2 max-h-40 overflow-y-auto",children:i.positions.map((D,L)=>r.jsxs("div",{className:"text-sm p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[r.jsx("div",{className:"font-medium",children:D.description}),r.jsxs("div",{className:"text-gray-500",children:[D.quantity," ",D.unit||"Stk"," × ",se(D.unitPrice||0)," = ",se(D.totalPrice||0)]})]},L))})]})]})})]})})}),r.jsx(J,{className:"shadow-lg border border-gray-200 dark:border-gray-700 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm",children:r.jsx(te,{className:"p-4",children:r.jsx("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4",children:r.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400",children:[r.jsxs("div",{className:"flex items-center gap-2 bg-green-50 dark:bg-green-900/20 px-3 py-1.5 rounded-full",children:[r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),r.jsxs("span",{className:"font-medium text-green-700 dark:text-green-400",children:[O," von 30+ Feldern erfasst"]})]}),r.jsxs(Ae,{variant:"outline",className:`${(((F=t.confidence_scores)==null?void 0:F.overall)||0)>=.8?"bg-green-50 text-green-700 border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-800":(((B=t.confidence_scores)==null?void 0:B.overall)||0)>=.6?"bg-yellow-50 text-yellow-700 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-800":"bg-red-50 text-red-700 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800"}`,children:[Math.round((((R=t.confidence_scores)==null?void 0:R.overall)||0)*100),"% Vertrauen"]})]})})})}),r.jsx(J,{className:"shadow-lg border border-gray-200 dark:border-gray-700 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex justify-center items-center gap-3",children:[r.jsx(W,{variant:"outline",onClick:s,className:"px-5 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800 border-gray-300 dark:border-gray-600 transition-all duration-200",children:"Abbrechen"}),r.jsxs(W,{variant:"outline",onClick:n,className:"px-5 py-2 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/30 border-red-200 hover:border-red-300 dark:border-red-800 dark:hover:border-red-700 transition-all duration-200",children:[r.jsx(Mn,{className:"h-4 w-4 mr-2"}),"Ablehnen"]}),r.jsx(W,{onClick:w,disabled:x,className:"px-8 py-2 bg-green-600 hover:bg-green-700 text-white font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:x?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"animate-spin h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full"}),"Verarbeitung..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Xu,{className:"h-4 w-4 mr-2"}),"Validieren & Übernehmen"]})})]})})})]})]}),d&&r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(na,{className:"h-5 w-5"}),"OCR Rohtext"]})}),r.jsx(te,{children:r.jsx("pre",{className:"text-sm bg-gray-100 dark:bg-gray-800 p-4 rounded-lg whitespace-pre-wrap max-h-60 overflow-y-auto",children:t.extracted_text})})]}),y&&p&&r.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",onClick:()=>v(!1),children:r.jsxs("div",{className:"relative max-w-7xl max-h-full w-full h-full flex items-center justify-center",children:[r.jsx("button",{onClick:()=>v(!1),className:"absolute top-4 right-4 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",title:"Schließen (ESC)",children:r.jsx(Mn,{className:"h-6 w-6"})}),r.jsx("img",{src:p,alt:"Vergrößerte Rechnung",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",onClick:D=>D.stopPropagation()})]})})]})}function EY(){const[t,e]=f.useState([]),[n,s]=f.useState(!0),[a,i]=f.useState(""),[o,l]=f.useState("all"),[c,d]=f.useState(null);f.useEffect(()=>{u()},[]);const u=async()=>{try{s(!0);const{data:{user:g}}=await $.auth.getUser();if(!g)return;const{data:y,error:v}=await $.from("supplier_invoices").select("*").eq("created_by",g.id).order("created_at",{ascending:!1});if(v){console.error("Error loading supplier invoices:",v);return}e(y||[])}catch(g){console.error("Failed to load supplier invoices:",g)}finally{s(!1)}},h=g=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(g),m=g=>new Date(g).toLocaleDateString("de-DE"),p=g=>{switch(g){case"pending":return r.jsxs(Ae,{variant:"outline",className:"bg-yellow-50 text-yellow-800 border-yellow-200",children:[r.jsx(Ht,{className:"h-3 w-3 mr-1"}),"Ausstehend"]});case"approved":return r.jsxs(Ae,{variant:"outline",className:"bg-blue-50 text-blue-800 border-blue-200",children:[r.jsx(Rn,{className:"h-3 w-3 mr-1"}),"Genehmigt"]});case"paid":return r.jsxs(Ae,{variant:"outline",className:"bg-green-50 text-green-800 border-green-200",children:[r.jsx(Rn,{className:"h-3 w-3 mr-1"}),"Bezahlt"]});case"cancelled":return r.jsxs(Ae,{variant:"outline",className:"bg-red-50 text-red-800 border-red-200",children:[r.jsx(Eo,{className:"h-3 w-3 mr-1"}),"Storniert"]});default:return r.jsx(Ae,{variant:"outline",children:g})}},b=async(g,y)=>{try{const{error:v}=await $.from("supplier_invoices").update({status:y,updated_at:new Date().toISOString()}).eq("id",g);if(v){console.error("Error updating invoice status:",v);return}e(w=>w.map(j=>j.id===g?{...j,status:y}:j))}catch(v){console.error("Failed to update invoice status:",v)}},x=t.filter(g=>{const y=g.invoice_number.toLowerCase().includes(a.toLowerCase())||g.supplier_name.toLowerCase().includes(a.toLowerCase()),v=o==="all"||g.status===o;return y&&v});return n?r.jsx("div",{className:"flex items-center justify-center p-8",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),r.jsx("p",{children:"Lade Lieferantenrechnungen..."})]})}):r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsxs("div",{children:[r.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[r.jsx(Sr,{className:"h-6 w-6"}),"Lieferantenrechnungen"]}),r.jsx("p",{className:"text-muted-foreground mt-1",children:"Verwalten Sie Ihre eingescannten und erstellten Lieferantenrechnungen"})]})}),r.jsx(J,{children:r.jsx(te,{className:"pt-6",children:r.jsxs("div",{className:"flex gap-4",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx(Mc,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"Nach Rechnungsnummer oder Lieferant suchen...",value:a,onChange:g=>i(g.target.value),className:"pl-9"})]})}),r.jsxs("select",{value:o,onChange:g=>l(g.target.value),className:"px-3 py-2 border rounded-md bg-background",children:[r.jsx("option",{value:"all",children:"Alle Status"}),r.jsx("option",{value:"pending",children:"Ausstehend"}),r.jsx("option",{value:"approved",children:"Genehmigt"}),r.jsx("option",{value:"paid",children:"Bezahlt"}),r.jsx("option",{value:"cancelled",children:"Storniert"})]})]})})}),x.length===0?r.jsx(J,{children:r.jsx(te,{className:"py-12",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Sr,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Rechnungen gefunden"}),r.jsx("p",{className:"text-muted-foreground",children:a||o!=="all"?"Keine Rechnungen entsprechen den aktuellen Filterkriterien.":"Sie haben noch keine Lieferantenrechnungen erstellt."})]})})}):r.jsx("div",{className:"grid gap-4",children:x.map(g=>r.jsx(J,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>d(g),children:r.jsx(te,{className:"p-6",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"space-y-3 flex-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("h3",{className:"font-semibold text-lg",children:g.invoice_number}),g.ocr_result_id&&r.jsxs(Ae,{variant:"outline",className:"text-xs",children:[r.jsx(H_,{className:"h-3 w-3 mr-1"}),"OCR"]})]}),p(g.status)]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(As,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{className:"font-medium",children:g.supplier_name})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(gt,{className:"h-4 w-4 text-muted-foreground"}),r.jsxs("span",{children:["Datum: ",m(g.invoice_date)]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Fr,{className:"h-4 w-4 text-muted-foreground"}),r.jsx("span",{className:"font-semibold text-primary",children:h(g.total_amount)})]})]}),(g.description||g.iban)&&r.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[g.description&&r.jsxs("div",{children:["Beschreibung: ",g.description]}),g.iban&&r.jsxs("div",{children:["IBAN: ",g.iban]})]}),g.vat_amount&&g.vat_amount>0&&r.jsxs("div",{className:"text-sm text-muted-foreground",children:["inkl. MwSt: ",h(g.vat_amount)]})]}),r.jsxs("div",{className:"flex gap-2 ml-4",children:[g.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsx(W,{size:"sm",onClick:()=>b(g.id,"approved"),className:"bg-blue-600 hover:bg-blue-700",children:"Genehmigen"}),r.jsx(W,{size:"sm",variant:"outline",onClick:()=>b(g.id,"cancelled"),className:"border-red-600 text-red-600 hover:bg-red-50",children:"Stornieren"})]}),g.status==="approved"&&r.jsx(W,{size:"sm",onClick:()=>b(g.id,"paid"),className:"bg-green-600 hover:bg-green-700",children:"Als bezahlt markieren"})]})]})})},g.id))}),x.length>0&&r.jsx(J,{className:"bg-muted/50",children:r.jsx(te,{className:"pt-6",children:r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("span",{className:"text-sm text-muted-foreground",children:[x.length," Rechnung",x.length!==1?"en":""," gefunden"]}),r.jsxs("span",{className:"font-semibold",children:["Gesamtsumme: ",h(x.filter(g=>g.status!=="cancelled").reduce((g,y)=>g+y.total_amount,0))]})]})})}),c&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>d(null),children:r.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:g=>g.stopPropagation(),children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[r.jsx(Sr,{className:"h-6 w-6"}),"Rechnungsdetails"]}),r.jsx(W,{variant:"ghost",size:"sm",onClick:()=>d(null),className:"hover:bg-gray-100",children:r.jsx(Eo,{className:"h-4 w-4"})})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Rechnungsinformationen"}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Rechnungsnummer:"}),r.jsx("span",{className:"font-medium",children:c.invoice_number})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Lieferant:"}),r.jsx("span",{className:"font-medium",children:c.supplier_name})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Rechnungsdatum:"}),r.jsx("span",{children:m(c.invoice_date)})]}),c.due_date&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Fälligkeitsdatum:"}),r.jsx("span",{children:m(c.due_date)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Status:"}),p(c.status)]})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Beträge"}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"Gesamtbetrag:"}),r.jsx("span",{className:"font-bold text-lg text-primary",children:h(c.total_amount)})]}),c.vat_amount&&c.vat_amount>0&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-muted-foreground",children:"MwSt-Betrag:"}),r.jsx("span",{children:h(c.vat_amount)})]})]})]})]}),c.description&&r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Beschreibung"}),r.jsx("p",{className:"text-sm text-muted-foreground bg-gray-50 p-3 rounded-lg",children:c.description})]}),c.iban&&r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Zahlungsinformationen"}),r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"text-muted-foreground",children:"IBAN: "}),r.jsx("span",{className:"font-mono bg-gray-50 px-2 py-1 rounded",children:c.iban})]})]}),c.ocr_result_id&&r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[r.jsx(H_,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm font-medium",children:"Diese Rechnung wurde über OCR erfasst"})]})}),r.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[c.status==="pending"&&r.jsxs(r.Fragment,{children:[r.jsxs(W,{onClick:()=>{b(c.id,"approved"),d(null)},className:"bg-blue-600 hover:bg-blue-700",children:[r.jsx(Rn,{className:"h-4 w-4 mr-2"}),"Genehmigen"]}),r.jsxs(W,{variant:"outline",onClick:()=>{b(c.id,"cancelled"),d(null)},className:"border-red-600 text-red-600 hover:bg-red-50",children:[r.jsx(Eo,{className:"h-4 w-4 mr-2"}),"Stornieren"]})]}),c.status==="approved"&&r.jsxs(W,{onClick:()=>{b(c.id,"paid"),d(null)},className:"bg-green-600 hover:bg-green-700",children:[r.jsx(Rn,{className:"h-4 w-4 mr-2"}),"Als bezahlt markieren"]}),r.jsx(W,{variant:"outline",onClick:()=>d(null),children:"Schließen"})]})]})]})})]})}function AY(){const[t,e]=f.useState(""),[n,s]=f.useState(!1),[a,i]=f.useState(!1),[o,l]=f.useState(null),{toast:c}=pt(),{data:d,isLoading:u}=gW(),{data:h,isLoading:m}=qD(),{data:p,isLoading:b}=kW(),{data:x,isLoading:g}=DW(),y=On();vW(),WD(),yW();const v=(d==null?void 0:d.items)||[],w=(h==null?void 0:h.items)||[];p!=null&&p.items;const j=u||m||b,S=async(C,T,I)=>{var V;try{c({title:"E-Mail versendet",description:`${C==="quote"?"Angebot":"Rechnung"} wurde erfolgreich an ${((V=I.customer)==null?void 0:V.email)||"den Kunden"} versendet.`})}catch{c({title:"Fehler beim Versenden",description:"Die E-Mail konnte nicht versendet werden.",variant:"destructive"})}},N=C=>{switch(C){case"Entwurf":return"secondary";case"Versendet":return"default";case"Angenommen":case"Bezahlt":return"default";case"Abgelehnt":case"Storniert":return"destructive";case"Überfällig":return"destructive";case"Abgelaufen":return"secondary";default:return"default"}},k=(C,T="EUR")=>new Intl.NumberFormat("de-DE",{style:"currency",currency:T}).format(C),E=C=>new Date(C).toLocaleDateString("de-DE"),P=v.filter(C=>C.title.toLowerCase().includes(t.toLowerCase())||C.quote_number.toLowerCase().includes(t.toLowerCase())||C.customer.company_name.toLowerCase().includes(t.toLowerCase())),A=w.filter(C=>C.title.toLowerCase().includes(t.toLowerCase())||C.invoice_number.toLowerCase().includes(t.toLowerCase())||C.customer.company_name.toLowerCase().includes(t.toLowerCase()));return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dokumente"}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs(W,{onClick:()=>s(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),r.jsxs(W,{onClick:()=>i(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Rechnung erstellen"]})]})]}),r.jsx(J,{className:"shadow-soft rounded-2xl overflow-hidden",children:r.jsx(te,{className:"p-4",children:r.jsx("div",{className:"flex items-center space-x-2",children:r.jsxs("div",{className:"relative flex-1 max-w-sm",children:[r.jsx(Mc,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"Dokumente suchen...",value:t,onChange:C=>e(C.target.value),className:"pl-8 rounded-xl"})]})})})}),r.jsxs(cr,{defaultValue:"quotes",className:"space-y-4",children:[r.jsxs(tr,{children:[r.jsxs(Oe,{value:"quotes",className:"flex items-center gap-2",children:[r.jsx(mn,{className:"h-4 w-4"}),"Angebote (",v.length,")"]}),r.jsxs(Oe,{value:"invoices",className:"flex items-center gap-2",children:[r.jsx(Sr,{className:"h-4 w-4"}),"Rechnungen (",w.length,")"]}),r.jsxs(Oe,{value:"ocr",className:"flex items-center gap-2",children:[r.jsx(zd,{className:"h-4 w-4"}),"OCR-Import ",x&&x.length>0&&r.jsx(Ae,{variant:"destructive",className:"ml-1 px-1.5 py-0.5 text-xs",children:x.length})]}),r.jsxs(Oe,{value:"templates",className:"flex items-center gap-2",children:[r.jsx(mn,{className:"h-4 w-4"}),"Vorlagen"]})]}),r.jsx(Fe,{value:"quotes",className:"space-y-4",children:j?r.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((C,T)=>r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(Ke,{className:"h-5 w-32"}),r.jsx(Ke,{className:"h-6 w-20"})]}),r.jsx(Ke,{className:"h-4 w-48 mb-2"}),r.jsx(Ke,{className:"h-4 w-24"})]}),r.jsxs("div",{className:"text-right",children:[r.jsx(Ke,{className:"h-6 w-20 mb-2"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Ke,{className:"h-8 w-16"}),r.jsx(Ke,{className:"h-8 w-16"})]})]})]})})},T))}):P.length===0?r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsxs(te,{className:"py-8 text-center",children:[r.jsx(mn,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Angebote gefunden"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:t?"Keine Angebote entsprechen Ihren Suchkriterien.":"Erstellen Sie Ihr erstes Angebot."}),r.jsxs(W,{onClick:()=>s(!0),children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]})]})}):r.jsx("div",{className:"grid gap-4",children:P.map(C=>r.jsx(J,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h3",{className:"font-semibold",children:C.quote_number}),r.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${C.status==="Entwurf"?"bg-gray-100 text-gray-800":C.status==="Versendet"?"bg-blue-100 text-blue-800":C.status==="Angenommen"?"bg-green-100 text-green-800":C.status==="Abgelehnt"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:C.status})]}),r.jsx("h4",{className:"text-lg font-medium mb-1",children:C.title}),r.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[C.customer.company_name," • ",C.customer.contact_person]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsxs("span",{children:["Erstellt: ",E(C.quote_date)]}),C.valid_until&&r.jsxs("span",{children:["Gültig bis: ",E(C.valid_until)]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-xl font-bold mb-2",children:k(C.total_amount,C.currency)}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx(W,{variant:"ghost",size:"sm",title:"Ansehen",className:"rounded-xl",children:r.jsx(na,{className:"h-4 w-4"})}),r.jsx(W,{variant:"ghost",size:"sm",title:"Bearbeiten",className:"rounded-xl",children:r.jsx(Io,{className:"h-4 w-4"})}),r.jsx(W,{variant:"ghost",size:"sm",className:"rounded-xl",title:"Per E-Mail versenden",onClick:()=>S("quote",C.id,C),disabled:!1,children:r.jsx(Tn,{className:"h-4 w-4"})}),r.jsx(W,{variant:"ghost",size:"sm",title:"Herunterladen",className:"rounded-xl",children:r.jsx(vf,{className:"h-4 w-4"})}),r.jsx(_Y,{quote:C,onRefresh:()=>y.invalidateQueries({queryKey:["quotes"]})})]})]})]})})},C.id))})}),r.jsx(Fe,{value:"invoices",className:"space-y-4",children:r.jsxs(cr,{defaultValue:"customer",className:"space-y-4",children:[r.jsxs(tr,{children:[r.jsxs(Oe,{value:"customer",children:["Kundenrechnungen (",w.length,")"]}),r.jsx(Oe,{value:"supplier",children:"Lieferantenrechnungen"})]}),r.jsx(Fe,{value:"customer",className:"space-y-4",children:j?r.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((C,T)=>r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex justify-between items-start",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx(Ke,{className:"h-5 w-32"}),r.jsx(Ke,{className:"h-6 w-20"})]}),r.jsx(Ke,{className:"h-4 w-48 mb-2"}),r.jsx(Ke,{className:"h-4 w-24"})]}),r.jsxs("div",{className:"text-right",children:[r.jsx(Ke,{className:"h-6 w-20 mb-2"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(Ke,{className:"h-8 w-16"}),r.jsx(Ke,{className:"h-8 w-16"})]})]})]})})},T))}):A.length===0?r.jsx(J,{children:r.jsxs(te,{className:"py-8 text-center",children:[r.jsx(Sr,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Kundenrechnungen gefunden"}),r.jsx("p",{className:"text-muted-foreground mb-4",children:t?"Keine Kundenrechnungen entsprechen Ihren Suchkriterien.":"Erstellen Sie Ihre erste Kundenrechnung."}),r.jsxs(W,{onClick:()=>i(!0),children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Kundenrechnung erstellen"]})]})}):r.jsx("div",{className:"grid gap-4",children:A.map(C=>r.jsx(J,{className:"hover:shadow-lg transition-shadow",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h3",{className:"font-semibold",children:C.invoice_number}),r.jsx(Ae,{variant:N(C.status),children:C.status})]}),r.jsx("h4",{className:"text-lg font-medium mb-1",children:C.title}),r.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[C.customer.company_name," • ",C.customer.contact_person]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsxs("span",{children:["Erstellt: ",E(C.invoice_date)]}),r.jsxs("span",{children:["Fällig: ",E(C.due_date)]})]})]}),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-xl font-bold mb-2",children:k(C.total_amount,C.currency)}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx(W,{variant:"ghost",size:"sm",title:"Ansehen",children:r.jsx(na,{className:"h-4 w-4"})}),r.jsx(W,{variant:"ghost",size:"sm",title:"Bearbeiten",children:r.jsx(Io,{className:"h-4 w-4"})}),r.jsx(W,{variant:"ghost",size:"sm",title:"Per E-Mail versenden",onClick:()=>S("invoice",C.id,C),disabled:!1,children:r.jsx(Tn,{className:"h-4 w-4"})}),r.jsx(W,{variant:"ghost",size:"sm",title:"Herunterladen",children:r.jsx(vf,{className:"h-4 w-4"})})]})]})]})})},C.id))})}),r.jsx(Fe,{value:"supplier",className:"space-y-4",children:r.jsx(EY,{})})]})}),r.jsx(Fe,{value:"ocr",className:"space-y-4",children:o?r.jsx(CY,{ocrResult:o,onValidated:C=>{l(null),c({title:"Rechnung validiert",description:"Die Rechnungsdaten wurden erfolgreich validiert und können übernommen werden."}),console.log("Validated invoice data:",C)},onRejected:()=>{l(null),c({title:"OCR-Ergebnis abgelehnt",description:"Das OCR-Ergebnis wurde abgelehnt."})},onCancel:()=>l(null)}):r.jsxs("div",{className:"space-y-6",children:[r.jsx(kY,{onOCRComplete:C=>{l(C)},onError:C=>{c({title:"OCR-Fehler",description:C,variant:"destructive"})}}),x&&x.length>0&&r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(zd,{className:"h-5 w-5"}),"Ausstehende Validierungen (",x.length,")"]})}),r.jsx(te,{children:r.jsx("div",{className:"space-y-4",children:x.map(C=>r.jsx(J,{className:"border-orange-200 bg-orange-50",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[r.jsx("h4",{className:"font-medium",children:C.structured_data.supplierName}),r.jsx(Ae,{variant:"outline",className:"bg-orange-100 text-orange-800",children:"Ausstehend"}),r.jsxs(Ae,{variant:"outline",children:[Math.round(C.confidence_scores.overall*100),"% Konfidenz"]})]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[r.jsxs("span",{children:["Rechnung: ",C.structured_data.invoiceNumber]}),r.jsxs("span",{children:["Betrag: ",C.structured_data.totalAmount.toLocaleString("de-DE",{style:"currency",currency:"EUR"})]}),r.jsxs("span",{children:["Datum: ",new Date(C.structured_data.date).toLocaleDateString("de-DE")]}),r.jsxs("span",{children:["Verarbeitet: ",new Date(C.created_at).toLocaleString("de-DE")]})]})]}),r.jsx(W,{onClick:()=>l(C),size:"sm",children:"Validieren"})]})})},C.id))})})]}),r.jsx(J,{className:"bg-blue-50 border-blue-200",children:r.jsx(te,{className:"p-6",children:r.jsxs("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:r.jsx(zd,{className:"h-6 w-6 text-blue-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Automatische Rechnungserfassung mit OCR"}),r.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[r.jsx("li",{children:"• Laden Sie Bilder oder PDFs von Lieferantenrechnungen hoch"}),r.jsx("li",{children:"• OCR erkennt automatisch Rechnungsnummer, Betrag, Lieferant und Datum"}),r.jsx("li",{children:"• Validieren Sie die erkannten Daten vor der Übernahme"}),r.jsx("li",{children:"• Rechnungen werden automatisch in Ihrem System angelegt"})]})]})]})})})]})}),r.jsx(Fe,{value:"templates",className:"space-y-4",children:r.jsx(J,{children:r.jsxs(te,{className:"py-8 text-center",children:[r.jsx(mn,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Vorlagen-Manager"}),r.jsx("p",{className:"text-muted-foreground",children:"Die Vorlagen-Funktionalität wird bald verfügbar sein."})]})})})]}),r.jsx(wY,{open:n,onOpenChange:s}),r.jsx(jY,{open:a,onOpenChange:i})]})}function DY(){const{user:t,userProfile:e}=za(),{toast:n}=pt(),[s,a]=f.useState([]),[i,o]=f.useState(null),[l,c]=f.useState(!1),[d,u]=f.useState(!0),[h,m]=f.useState(""),[p,b]=f.useState(!1);f.useEffect(()=>{x()},[t,e]);const x=async()=>{if(!(!t||!(e!=null&&e.company_id)))try{u(!0);const{data:j,error:S}=await $.rpc("get_pending_invoice_validations",{manager_company_id:e.company_id});if(S)throw S;a(j||[])}catch(j){console.error("Error loading pending invoices:",j),n({title:"Fehler beim Laden",description:"Ausstehende Validierungen konnten nicht geladen werden.",variant:"destructive"})}finally{u(!1)}},g=async(j,S)=>{if(t)try{const{data:N,error:k}=await $.rpc("validate_receipt",{receipt_id:j,manager_id:t.id,action:S,reason:S==="reject"?h:null,validated_data:S==="validate"?{validated_by_manager:!0}:null});if(k)throw k;await x(),o(null),c(!1),b(!1),m(""),n({title:S==="validate"?"Rechnung genehmigt":"Rechnung abgelehnt",description:S==="validate"?"Die Rechnung wurde erfolgreich validiert und genehmigt.":"Die Rechnung wurde abgelehnt und der Mitarbeiter wurde benachrichtigt.",variant:S==="validate"?"default":"destructive"})}catch(N){console.error(`Error ${S}ing invoice:`,N),n({title:"Fehler",description:`Rechnung konnte nicht ${S==="validate"?"genehmigt":"abgelehnt"} werden.`,variant:"destructive"})}},y=j=>{switch(j){case"submitted":return r.jsx(Ae,{variant:"outline",className:"bg-blue-50 text-blue-700",children:"Eingereicht"});case"pending":return r.jsx(Ae,{variant:"outline",className:"bg-yellow-50 text-yellow-700",children:"In Bearbeitung"});case"validated":return r.jsx(Ae,{variant:"outline",className:"bg-green-50 text-green-700",children:"Genehmigt"});case"rejected":return r.jsx(Ae,{variant:"outline",className:"bg-red-50 text-red-700",children:"Abgelehnt"});default:return r.jsx(Ae,{variant:"outline",children:j})}},v=j=>j?j.toLocaleString("de-DE",{style:"currency",currency:"EUR"}):"-",w=j=>j.startsWith("data:")?j:`${$.storage.from("project-media").getPublicUrl(j).data.publicUrl}`;return d?r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Sr,{className:"h-5 w-5"}),"Rechnungsvalidierung"]})}),r.jsx(te,{children:r.jsx("div",{className:"flex items-center justify-center h-32",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Ht,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-gray-400"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Lade ausstehende Validierungen..."})]})})})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Sr,{className:"h-5 w-5"}),"Rechnungsvalidierung"]}),r.jsx(Jn,{children:"Überprüfen und genehmigen Sie von Mitarbeitern eingereichte Rechnungen"})]}),r.jsxs(te,{children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsxs("div",{className:"text-sm text-gray-600",children:[s.length," ausstehende Validierungen"]}),r.jsx(W,{onClick:x,variant:"outline",size:"sm",children:"Aktualisieren"})]}),s.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Sr,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Keine ausstehenden Validierungen"}),r.jsx("p",{className:"text-gray-500",children:"Alle eingereichten Rechnungen wurden bereits bearbeitet."})]}):r.jsx("div",{className:"space-y-4",children:s.map(j=>r.jsx(J,{className:"border-l-4 border-l-blue-500",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("h4",{className:"font-semibold",children:j.project_name}),y(j.validation_status)]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-3",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(Ps,{className:"h-4 w-4"}),j.employee_name]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(gt,{className:"h-4 w-4"}),new Date(j.created_at).toLocaleDateString("de-DE")]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(Fr,{className:"h-4 w-4"}),v(j.amount)]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(mn,{className:"h-4 w-4"}),j.document_name]})]}),j.description&&r.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded mb-3",children:j.description})]}),r.jsx("div",{className:"flex flex-col gap-2 ml-4",children:r.jsxs(Mt,{children:[r.jsx(IH,{asChild:!0,children:r.jsxs(W,{variant:"outline",size:"sm",onClick:()=>o(j),children:[r.jsx(na,{className:"h-4 w-4 mr-2"}),"Prüfen"]})}),r.jsxs(Pt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx(Bt,{children:r.jsxs(Lt,{children:["Rechnungsvalidierung - ",j.project_name]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Original-Dokument"}),r.jsx("img",{src:w(j.file_url),alt:"Receipt",className:"w-full rounded border",style:{maxHeight:"400px",objectFit:"contain"}})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Details"}),r.jsxs("div",{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Mitarbeiter:"}),r.jsx("span",{className:"font-medium",children:j.employee_name})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Projekt:"}),r.jsx("span",{className:"font-medium",children:j.project_name})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Betrag:"}),r.jsx("span",{className:"font-medium",children:v(j.amount)})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Eingereicht:"}),r.jsx("span",{className:"font-medium",children:new Date(j.created_at).toLocaleString("de-DE")})]})]})]}),j.description&&r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"Beschreibung"}),r.jsx("p",{className:"text-sm bg-gray-50 p-3 rounded",children:j.description})]}),j.ocr_result&&r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold mb-2",children:"OCR-Ergebnis"}),r.jsxs("div",{className:"text-sm bg-blue-50 p-3 rounded",children:[r.jsxs("div",{className:"flex justify-between mb-2",children:[r.jsx("span",{children:"Status:"}),r.jsx("span",{className:"font-medium",children:j.ocr_result.status})]}),j.ocr_result.confidence&&r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Vertrauen:"}),r.jsxs("span",{className:"font-medium",children:[Math.round(j.ocr_result.confidence*100),"%"]})]})]})]}),r.jsx(Ni,{}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(W,{onClick:()=>g(j.id,"validate"),className:"flex-1",children:[r.jsx(Xu,{className:"h-4 w-4 mr-2"}),"Genehmigen"]}),r.jsxs(W,{variant:"outline",onClick:()=>{o(j),b(!0)},className:"flex-1 text-red-600 border-red-200 hover:bg-red-50",children:[r.jsx(Mn,{className:"h-4 w-4 mr-2"}),"Ablehnen"]})]})]})]})]})]})})]})})},j.id))})]})]}),r.jsx(Mt,{open:p,onOpenChange:b,children:r.jsxs(Pt,{children:[r.jsx(Bt,{children:r.jsxs(Lt,{className:"flex items-center gap-2 text-red-600",children:[r.jsx(Mn,{className:"h-5 w-5"}),"Rechnung ablehnen"]})}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Bitte geben Sie einen Grund für die Ablehnung an. Der Mitarbeiter wird über die Ablehnung und den Grund informiert."}),r.jsx(an,{placeholder:"Grund für die Ablehnung...",value:h,onChange:j=>m(j.target.value),rows:3}),r.jsxs("div",{className:"flex gap-2 justify-end",children:[r.jsx(W,{variant:"outline",onClick:()=>{b(!1),m("")},children:"Abbrechen"}),r.jsxs(W,{variant:"destructive",onClick:()=>i&&g(i.id,"reject"),disabled:!h.trim(),children:[r.jsx(Mn,{className:"h-4 w-4 mr-2"}),"Ablehnen"]})]})]})]})})]})}function PY(){const{toast:t}=pt(),[e,n]=f.useState(null),[s,a]=f.useState(!0),[i,o]=f.useState(!1),l=async()=>{try{console.log("Creating default settings...");const{data:{user:h}}=await $.auth.getUser();if(!h)throw new Error("Nicht angemeldet");const m={company_name:"Meine Firma",address:"",postal_code:"",city:"",country:"Deutschland",phone:"",email:"",website:"",tax_id:"",default_working_hours_start:"08:00",default_working_hours_end:"17:00",default_break_duration:60,default_hourly_rate:50,default_overtime_rate:62.5,default_currency:"EUR",default_tax_rate:19,default_vacation_days:25,invoice_prefix:"RE",quote_prefix:"AN",project_prefix:"PR",is_active:!0};console.log("Inserting default settings:",m);const{data:p,error:b}=await $.from("company_settings").insert(m).select().single();if(console.log("Insert result:",{data:p,error:b}),b)throw b;n(p),t({title:"Erfolg",description:"Standard-Einstellungen wurden erstellt."})}catch(h){const m=h instanceof Error?h.message:String(h);console.error("Error creating default settings:",h),t({title:"Fehler",description:`Standard-Einstellungen konnten nicht erstellt werden: ${m}`,variant:"destructive"})}},c=async()=>{try{console.log("Loading company settings...");const{data:{user:h},error:m}=await $.auth.getUser();if(console.log("Current user:",h),console.log("Auth error:",m),m||!h)throw new Error("Nicht angemeldet");const{data:p,error:b}=await $.from("company_settings").select("*").limit(1).maybeSingle();if(console.log("Load result:",{data:p,error:b}),b)throw console.error("Supabase error details:",b),b;p?n(p):(console.log("No settings found, creating default..."),await l())}catch(h){const m=h instanceof Error?h.message:String(h);console.error("Error loading settings:",h),t({title:"Fehler beim Laden",description:`Einstellungen konnten nicht geladen werden: ${m}`,variant:"destructive"})}finally{a(!1)}};f.useEffect(()=>{c()},[]);const d=async()=>{if(!(e!=null&&e.id)){t({title:"Fehler",description:"Keine gültige Einstellungs-ID gefunden.",variant:"destructive"});return}o(!0);try{console.log("Saving settings:",e);const{data:{user:h}}=await $.auth.getUser();if(!h)throw new Error("Nicht angemeldet");const m={company_name:e.company_name,company_address:e.company_address,company_city:e.company_city,company_postal_code:e.company_postal_code,company_country:e.company_country,company_phone:e.company_phone,company_email:e.company_email,tax_number:e.tax_number,vat_id:e.vat_id,website:e.website,default_working_hours_start:e.default_working_hours_start,default_working_hours_end:e.default_working_hours_end,default_break_duration:e.default_break_duration,default_hourly_rate:e.default_hourly_rate,default_overtime_rate:e.default_overtime_rate,default_currency:e.default_currency,default_tax_rate:e.default_tax_rate,default_vacation_days:e.default_vacation_days,invoice_prefix:e.invoice_prefix,quote_prefix:e.quote_prefix,project_prefix:e.project_prefix};console.log("Update data:",m),console.log("Settings ID:",e.id);const{data:p,error:b}=await $.from("company_settings").update(m).eq("id",e.id).select();if(console.log("Save result:",{data:p,error:b}),b)throw b;t({title:"Erfolgreich gespeichert",description:"Die Firmeneinstellungen wurden aktualisiert."})}catch(h){const m=h instanceof Error?h.message:String(h);console.error("Error saving settings:",h),t({title:"Fehler beim Speichern",description:`Einstellungen konnten nicht gespeichert werden: ${m}`,variant:"destructive"})}finally{o(!1)}},u=(h,m)=>{e&&n({...e,[h]:m})};return s?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-muted-foreground",children:"Lade Einstellungen..."})}):e?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-gray-600 bg-clip-text text-transparent flex items-center gap-3",children:[r.jsx(Fi,{className:"h-8 w-8 text-gray-600"}),"Firmeneinstellungen"]}),r.jsx("p",{className:"text-muted-foreground",children:"Verwalten Sie alle wichtigen Firmeninformationen"})]}),r.jsx(W,{onClick:d,disabled:i,children:i?"Speichere...":"Einstellungen speichern"})]}),r.jsxs("div",{className:"grid gap-6",children:[r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(As,{className:"h-5 w-5"}),"Firmeninformationen"]}),r.jsx(Jn,{children:"Grundlegende Informationen über Ihr Unternehmen"})]}),r.jsxs(te,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"company_name",children:"Firmenname"}),r.jsx(G,{id:"company_name",value:e.company_name||"",onChange:h=>u("company_name",h.target.value),placeholder:"Ihr Firmenname"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"website",children:"Website"}),r.jsx(G,{id:"website",value:e.website||"",onChange:h=>u("website",h.target.value),placeholder:"https://www.ihre-website.de"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"company_address",children:"Adresse"}),r.jsx(an,{id:"company_address",value:e.company_address||"",onChange:h=>u("company_address",h.target.value),placeholder:"Straße und Hausnummer",rows:2})]}),r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"company_postal_code",children:"Postleitzahl"}),r.jsx(G,{id:"company_postal_code",value:e.company_postal_code||"",onChange:h=>u("company_postal_code",h.target.value),placeholder:"12345"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"company_city",children:"Stadt"}),r.jsx(G,{id:"company_city",value:e.company_city||"",onChange:h=>u("company_city",h.target.value),placeholder:"Ihre Stadt"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"company_country",children:"Land"}),r.jsx(G,{id:"company_country",value:e.company_country||"",onChange:h=>u("company_country",h.target.value),placeholder:"Deutschland"})]})]})]})]}),r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Tn,{className:"h-5 w-5"}),"Kontaktinformationen"]}),r.jsx(Jn,{children:"Wie Kunden Sie erreichen können"})]}),r.jsxs(te,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"company_phone",children:"Telefon"}),r.jsx(G,{id:"company_phone",value:e.company_phone||"",onChange:h=>u("company_phone",h.target.value),placeholder:"+49 123 456789"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"company_email",children:"E-Mail"}),r.jsx(G,{id:"company_email",type:"email",value:e.company_email||"",onChange:h=>u("company_email",h.target.value),placeholder:"info@ihre-firma.de"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"tax_number",children:"Steuernummer"}),r.jsx(G,{id:"tax_number",value:e.tax_number||"",onChange:h=>u("tax_number",h.target.value),placeholder:"123/456/78901"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"vat_id",children:"USt-IdNr."}),r.jsx(G,{id:"vat_id",value:e.vat_id||"",onChange:h=>u("vat_id",h.target.value),placeholder:"DE123456789"})]})]})]})]}),r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Ht,{className:"h-5 w-5"}),"Arbeitszeiten"]}),r.jsx(Jn,{children:"Standard-Arbeitszeiten für Berechnungen und Zeiterfassung"})]}),r.jsx(te,{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"default_working_hours_start",children:"Arbeitsbeginn"}),r.jsx(G,{id:"default_working_hours_start",type:"time",value:e.default_working_hours_start||"08:00",onChange:h=>u("default_working_hours_start",h.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"default_working_hours_end",children:"Arbeitsende"}),r.jsx(G,{id:"default_working_hours_end",type:"time",value:e.default_working_hours_end||"17:00",onChange:h=>u("default_working_hours_end",h.target.value)})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"default_break_duration",children:"Pausendauer (Min.)"}),r.jsx(G,{id:"default_break_duration",type:"number",value:e.default_break_duration||60,onChange:h=>u("default_break_duration",Number(h.target.value)),placeholder:"60"})]})]})})]}),r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Db,{className:"h-5 w-5"}),"Finanzeinstellungen"]}),r.jsx(Jn,{children:"Standard-Werte für Preise und Steuern"})]}),r.jsxs(te,{className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"default_hourly_rate",children:"Standard-Stundensatz (€)"}),r.jsx(G,{id:"default_hourly_rate",type:"number",step:"0.50",value:e.default_hourly_rate||"",onChange:h=>u("default_hourly_rate",Number(h.target.value)),placeholder:"50.00"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"default_overtime_rate",children:"Überstunden-Satz (€)"}),r.jsx(G,{id:"default_overtime_rate",type:"number",step:"0.50",value:e.default_overtime_rate||"",onChange:h=>u("default_overtime_rate",Number(h.target.value)),placeholder:"62.50"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"default_currency",children:"Währung"}),r.jsx(G,{id:"default_currency",value:e.default_currency||"EUR",onChange:h=>u("default_currency",h.target.value),placeholder:"EUR"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"default_tax_rate",children:"Steuersatz (%)"}),r.jsx(G,{id:"default_tax_rate",type:"number",step:"0.1",value:e.default_tax_rate||"",onChange:h=>u("default_tax_rate",Number(h.target.value)),placeholder:"19.0"})]})]})]})]}),r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(gt,{className:"h-5 w-5"}),"Urlaubseinstellungen"]}),r.jsx(Jn,{children:"Standard-Urlaubstage für neue Mitarbeiter"})]}),r.jsx(te,{className:"space-y-4",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"default_vacation_days",children:"Standard Urlaubstage pro Jahr"}),r.jsx(G,{id:"default_vacation_days",type:"number",min:"0",max:"50",value:e.default_vacation_days||25,onChange:h=>u("default_vacation_days",Number(h.target.value)),placeholder:"25"}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Diese Anzahl wird automatisch jedem neuen Mitarbeiter bei der Erstellung zugewiesen"})]})})]}),r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(mn,{className:"h-5 w-5"}),"Dokumenteinstellungen"]}),r.jsx(Jn,{children:"Präfixe für automatische Nummerierung"})]}),r.jsx(te,{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"invoice_prefix",children:"Rechnungs-Präfix"}),r.jsx(G,{id:"invoice_prefix",value:e.invoice_prefix||"",onChange:h=>u("invoice_prefix",h.target.value),placeholder:"RE"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"quote_prefix",children:"Angebots-Präfix"}),r.jsx(G,{id:"quote_prefix",value:e.quote_prefix||"",onChange:h=>u("quote_prefix",h.target.value),placeholder:"AN"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"project_prefix",children:"Projekt-Präfix"}),r.jsx(G,{id:"project_prefix",value:e.project_prefix||"",onChange:h=>u("project_prefix",h.target.value),placeholder:"PR"})]})]})})]})]})]}):r.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[r.jsx("div",{className:"text-muted-foreground",children:"Keine Einstellungen gefunden"}),r.jsx(W,{onClick:l,children:"Standard-Einstellungen erstellen"})]})}function TY(t,e){return f.useReducer((n,s)=>e[n][s]??n,t)}var dj="ScrollArea",[d3,$ee]=Zr(dj),[RY,ls]=d3(dj),u3=f.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:s="hover",dir:a,scrollHideDelay:i=600,...o}=t,[l,c]=f.useState(null),[d,u]=f.useState(null),[h,m]=f.useState(null),[p,b]=f.useState(null),[x,g]=f.useState(null),[y,v]=f.useState(0),[w,j]=f.useState(0),[S,N]=f.useState(!1),[k,E]=f.useState(!1),P=yt(e,C=>c(C)),A=Wc(a);return r.jsx(RY,{scope:n,type:s,dir:A,scrollHideDelay:i,scrollArea:l,viewport:d,onViewportChange:u,content:h,onContentChange:m,scrollbarX:p,onScrollbarXChange:b,scrollbarXEnabled:S,onScrollbarXEnabledChange:N,scrollbarY:x,onScrollbarYChange:g,scrollbarYEnabled:k,onScrollbarYEnabledChange:E,onCornerWidthChange:v,onCornerHeightChange:j,children:r.jsx(Le.div,{dir:A,...o,ref:P,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":w+"px",...t.style}})})});u3.displayName=dj;var h3="ScrollAreaViewport",m3=f.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:s,asChild:a,nonce:i,...o}=t,l=ls(h3,n),c=f.useRef(null),d=yt(e,c,l.onViewportChange);return r.jsxs(r.Fragment,{children:[r.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:i}),r.jsx(Le.div,{"data-radix-scroll-area-viewport":"",...o,asChild:a,ref:d,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...t.style},children:qY({asChild:a,children:s},u=>r.jsx("div",{"data-radix-scroll-area-content":"",ref:l.onContentChange,style:{minWidth:l.scrollbarXEnabled?"fit-content":void 0},children:u}))})]})});m3.displayName=h3;var fa="ScrollAreaScrollbar",uj=f.forwardRef((t,e)=>{const{forceMount:n,...s}=t,a=ls(fa,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,l=t.orientation==="horizontal";return f.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),a.type==="hover"?r.jsx(MY,{...s,ref:e,forceMount:n}):a.type==="scroll"?r.jsx(IY,{...s,ref:e,forceMount:n}):a.type==="auto"?r.jsx(f3,{...s,ref:e,forceMount:n}):a.type==="always"?r.jsx(hj,{...s,ref:e}):null});uj.displayName=fa;var MY=f.forwardRef((t,e)=>{const{forceMount:n,...s}=t,a=ls(fa,t.__scopeScrollArea),[i,o]=f.useState(!1);return f.useEffect(()=>{const l=a.scrollArea;let c=0;if(l){const d=()=>{window.clearTimeout(c),o(!0)},u=()=>{c=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return l.addEventListener("pointerenter",d),l.addEventListener("pointerleave",u),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",d),l.removeEventListener("pointerleave",u)}}},[a.scrollArea,a.scrollHideDelay]),r.jsx(Sn,{present:n||i,children:r.jsx(f3,{"data-state":i?"visible":"hidden",...s,ref:e})})}),IY=f.forwardRef((t,e)=>{const{forceMount:n,...s}=t,a=ls(fa,t.__scopeScrollArea),i=t.orientation==="horizontal",o=hp(()=>c("SCROLL_END"),100),[l,c]=TY("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return f.useEffect(()=>{if(l==="idle"){const d=window.setTimeout(()=>c("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(d)}},[l,a.scrollHideDelay,c]),f.useEffect(()=>{const d=a.viewport,u=i?"scrollLeft":"scrollTop";if(d){let h=d[u];const m=()=>{const p=d[u];h!==p&&(c("SCROLL"),o()),h=p};return d.addEventListener("scroll",m),()=>d.removeEventListener("scroll",m)}},[a.viewport,i,c,o]),r.jsx(Sn,{present:n||l!=="hidden",children:r.jsx(hj,{"data-state":l==="hidden"?"hidden":"visible",...s,ref:e,onPointerEnter:be(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:be(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),f3=f.forwardRef((t,e)=>{const n=ls(fa,t.__scopeScrollArea),{forceMount:s,...a}=t,[i,o]=f.useState(!1),l=t.orientation==="horizontal",c=hp(()=>{if(n.viewport){const d=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;o(l?d:u)}},10);return Ec(n.viewport,c),Ec(n.content,c),r.jsx(Sn,{present:s||i,children:r.jsx(hj,{"data-state":i?"visible":"hidden",...a,ref:e})})}),hj=f.forwardRef((t,e)=>{const{orientation:n="vertical",...s}=t,a=ls(fa,t.__scopeScrollArea),i=f.useRef(null),o=f.useRef(0),[l,c]=f.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=y3(l.viewport,l.content),u={...s,sizes:l,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:m=>i.current=m,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:m=>o.current=m};function h(m,p){return zY(m,o.current,l,p)}return n==="horizontal"?r.jsx(OY,{...u,ref:e,onThumbPositionChange:()=>{if(a.viewport&&i.current){const m=a.viewport.scrollLeft,p=F2(m,l,a.dir);i.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollLeft=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollLeft=h(m,a.dir))}}):n==="vertical"?r.jsx(FY,{...u,ref:e,onThumbPositionChange:()=>{if(a.viewport&&i.current){const m=a.viewport.scrollTop,p=F2(m,l);i.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollTop=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollTop=h(m))}}):null}),OY=f.forwardRef((t,e)=>{const{sizes:n,onSizesChange:s,...a}=t,i=ls(fa,t.__scopeScrollArea),[o,l]=f.useState(),c=f.useRef(null),d=yt(e,c,i.onScrollbarXChange);return f.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),r.jsx(x3,{"data-orientation":"horizontal",...a,ref:d,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":up(n)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.x),onDragScroll:u=>t.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(i.viewport){const m=i.viewport.scrollLeft+u.deltaX;t.onWheelScroll(m),w3(m,h)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&s({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:t0(o.paddingLeft),paddingEnd:t0(o.paddingRight)}})}})}),FY=f.forwardRef((t,e)=>{const{sizes:n,onSizesChange:s,...a}=t,i=ls(fa,t.__scopeScrollArea),[o,l]=f.useState(),c=f.useRef(null),d=yt(e,c,i.onScrollbarYChange);return f.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),r.jsx(x3,{"data-orientation":"vertical",...a,ref:d,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":up(n)+"px",...t.style},onThumbPointerDown:u=>t.onThumbPointerDown(u.y),onDragScroll:u=>t.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(i.viewport){const m=i.viewport.scrollTop+u.deltaY;t.onWheelScroll(m),w3(m,h)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&s({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:t0(o.paddingTop),paddingEnd:t0(o.paddingBottom)}})}})}),[BY,p3]=d3(fa),x3=f.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:s,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:u,onResize:h,...m}=t,p=ls(fa,n),[b,x]=f.useState(null),g=yt(e,P=>x(P)),y=f.useRef(null),v=f.useRef(""),w=p.viewport,j=s.content-s.viewport,S=nn(u),N=nn(c),k=hp(h,10);function E(P){if(y.current){const A=P.clientX-y.current.left,C=P.clientY-y.current.top;d({x:A,y:C})}}return f.useEffect(()=>{const P=A=>{const C=A.target;(b==null?void 0:b.contains(C))&&S(A,j)};return document.addEventListener("wheel",P,{passive:!1}),()=>document.removeEventListener("wheel",P,{passive:!1})},[w,b,j,S]),f.useEffect(N,[s,N]),Ec(b,k),Ec(p.content,k),r.jsx(BY,{scope:n,scrollbar:b,hasThumb:a,onThumbChange:nn(i),onThumbPointerUp:nn(o),onThumbPositionChange:N,onThumbPointerDown:nn(l),children:r.jsx(Le.div,{...m,ref:g,style:{position:"absolute",...m.style},onPointerDown:be(t.onPointerDown,P=>{P.button===0&&(P.target.setPointerCapture(P.pointerId),y.current=b.getBoundingClientRect(),v.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),E(P))}),onPointerMove:be(t.onPointerMove,E),onPointerUp:be(t.onPointerUp,P=>{const A=P.target;A.hasPointerCapture(P.pointerId)&&A.releasePointerCapture(P.pointerId),document.body.style.webkitUserSelect=v.current,p.viewport&&(p.viewport.style.scrollBehavior=""),y.current=null})})})}),e0="ScrollAreaThumb",g3=f.forwardRef((t,e)=>{const{forceMount:n,...s}=t,a=p3(e0,t.__scopeScrollArea);return r.jsx(Sn,{present:n||a.hasThumb,children:r.jsx(LY,{ref:e,...s})})}),LY=f.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:s,...a}=t,i=ls(e0,n),o=p3(e0,n),{onThumbPositionChange:l}=o,c=yt(e,h=>o.onThumbChange(h)),d=f.useRef(),u=hp(()=>{d.current&&(d.current(),d.current=void 0)},100);return f.useEffect(()=>{const h=i.viewport;if(h){const m=()=>{if(u(),!d.current){const p=UY(h,l);d.current=p,l()}};return l(),h.addEventListener("scroll",m),()=>h.removeEventListener("scroll",m)}},[i.viewport,u,l]),r.jsx(Le.div,{"data-state":o.hasThumb?"visible":"hidden",...a,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:be(t.onPointerDownCapture,h=>{const p=h.target.getBoundingClientRect(),b=h.clientX-p.left,x=h.clientY-p.top;o.onThumbPointerDown({x:b,y:x})}),onPointerUp:be(t.onPointerUp,o.onThumbPointerUp)})});g3.displayName=e0;var mj="ScrollAreaCorner",v3=f.forwardRef((t,e)=>{const n=ls(mj,t.__scopeScrollArea),s=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&s?r.jsx($Y,{...t,ref:e}):null});v3.displayName=mj;var $Y=f.forwardRef((t,e)=>{const{__scopeScrollArea:n,...s}=t,a=ls(mj,n),[i,o]=f.useState(0),[l,c]=f.useState(0),d=!!(i&&l);return Ec(a.scrollbarX,()=>{var h;const u=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(u),c(u)}),Ec(a.scrollbarY,()=>{var h;const u=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(u),o(u)}),d?r.jsx(Le.div,{...s,ref:e,style:{width:i,height:l,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function t0(t){return t?parseInt(t,10):0}function y3(t,e){const n=t/e;return isNaN(n)?0:n}function up(t){const e=y3(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,s=(t.scrollbar.size-n)*e;return Math.max(s,18)}function zY(t,e,n,s="ltr"){const a=up(n),i=a/2,o=e||i,l=a-o,c=n.scrollbar.paddingStart+o,d=n.scrollbar.size-n.scrollbar.paddingEnd-l,u=n.content-n.viewport,h=s==="ltr"?[0,u]:[u*-1,0];return b3([c,d],h)(t)}function F2(t,e,n="ltr"){const s=up(e),a=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-a,o=e.content-e.viewport,l=i-s,c=n==="ltr"?[0,o]:[o*-1,0],d=yy(t,c);return b3([0,o],[0,l])(d)}function b3(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const s=(e[1]-e[0])/(t[1]-t[0]);return e[0]+s*(n-t[0])}}function w3(t,e){return t>0&&t<e}var UY=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},s=0;return function a(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,l=n.top!==i.top;(o||l)&&e(),n=i,s=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(s)};function hp(t,e){const n=nn(t),s=f.useRef(0);return f.useEffect(()=>()=>window.clearTimeout(s.current),[]),f.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(n,e)},[n,e])}function Ec(t,e){const n=nn(e);gn(()=>{let s=0;if(t){const a=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(n)});return a.observe(t),()=>{window.cancelAnimationFrame(s),a.unobserve(t)}}},[t,n])}function qY(t,e){const{asChild:n,children:s}=t;if(!n)return typeof e=="function"?e(s):e;const a=f.Children.only(s);return f.cloneElement(a,{children:typeof e=="function"?e(a.props.children):e})}var j3=u3,WY=m3,HY=v3;const Ay=f.forwardRef(({className:t,children:e,...n},s)=>r.jsxs(j3,{ref:s,className:_e("relative overflow-hidden",t),...n,children:[r.jsx(WY,{className:"h-full w-full rounded-[inherit]",children:e}),r.jsx(_3,{}),r.jsx(HY,{})]}));Ay.displayName=j3.displayName;const _3=f.forwardRef(({className:t,orientation:e="vertical",...n},s)=>r.jsx(uj,{ref:s,orientation:e,className:_e("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:r.jsx(g3,{className:"relative flex-1 rounded-full bg-border"})}));_3.displayName=uj.displayName;const VY=()=>{var Y,ae;const{toast:t}=pt(),[e,n]=f.useState([]),[s,a]=f.useState([]),[i,o]=f.useState(null),[l,c]=f.useState([]),[d,u]=f.useState("inbox"),[h,m]=f.useState(""),[p,b]=f.useState(!1),[x,g]=f.useState(""),[y,v]=f.useState(!1),[w,j]=f.useState(!1),[S,N]=f.useState(!1),k=U=>{try{return new Date(U).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}catch{return"00:00"}},E=U=>{try{return new Date(U).toLocaleDateString("de-DE")}catch{return"01.01.2024"}},P=U=>{try{const Q=new Date(U);return Q.toLocaleDateString("de-DE")+" "+Q.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}catch{return"01.01.2024 00:00"}},A={mail:Tn,"shopping-cart":B8,"message-square":yf,receipt:Sr,"help-circle":w8,newspaper:R8};f.useEffect(()=>{T(),I(),C()},[]),f.useEffect(()=>{if(x)return V(),ne()},[x]);const C=async()=>{try{const{data:{user:U}}=await $.auth.getUser();if(!U){N(!1);return}console.log("Checking Gmail connection for user:",U.id);const{data:Q,error:oe}=await $.from("user_email_connections").select("*").eq("user_id",U.id).eq("provider","gmail").eq("is_active",!0);console.log("Gmail connections query result:",{connections:Q,error:oe}),!oe&&Q&&Q.length>0?(N(!0),console.log("Gmail connection found:",Q[0])):(console.log("No active Gmail connection found, but enabling sync for testing"),N(!0))}catch(U){console.error("Error checking Gmail connection:",U),N(!0)}},T=async()=>{try{const{data:{user:U}}=await $.auth.getUser();if(!U)return;const{data:Q}=await $.from("profiles").select("company_email").eq("id",U.id).single();Q!=null&&Q.company_email&&g(Q.company_email)}catch(U){console.error("Error fetching company email:",U)}},I=async()=>{try{const{data:U,error:Q}=await $.from("email_categories").select("*").order("name");a(!Q&&U?U:[{id:"orders",name:"Bestellungen",color:"#10b981",icon:"shopping-cart"},{id:"inquiries",name:"Anfragen",color:"#3b82f6",icon:"message-square"},{id:"invoices",name:"Rechnungen",color:"#f59e0b",icon:"receipt"},{id:"support",name:"Support",color:"#ef4444",icon:"help-circle"},{id:"newsletter",name:"Newsletter",color:"#8b5cf6",icon:"newspaper"}])}catch(U){console.error("Error fetching categories:",U)}},V=f.useCallback(async()=>{try{const{data:{user:U}}=await $.auth.getUser();if(U){const{data:Q}=await $.from("profiles").select("company_id").eq("id",U.id).single();if(Q!=null&&Q.company_id){const{data:oe,error:re}=await $.from("emails").select(`
              *,
              email_categories (name, color, icon),
              customers (company_name, contact_person, phone, website)
            `).eq("company_id",Q.company_id).order("received_at",{ascending:!1}).limit(50);if(!re&&oe){console.log(`Loaded ${oe.length} real emails from database`);const le=oe.map(Z=>({...Z,reply_count:oe.filter(de=>de.thread_id===Z.thread_id).length-1}));n(le);return}else console.error("Error loading emails from database:",re)}}}catch(U){console.error("Error fetching emails:",U)}console.log("No emails in database - user needs to sync Gmail first"),n([])},[]),ne=f.useCallback(()=>{const U=$.channel("emails-modern").on("postgres_changes",{event:"INSERT",schema:"public",table:"emails",filter:`recipient_email=eq.${x}`},Q=>{const oe=Q.new;n(re=>[oe,...re]),t({title:"📧 Neue E-Mail",description:`Von: ${oe.sender_name||oe.sender_email}`,action:r.jsx(W,{size:"sm",onClick:()=>o(oe),children:"Anzeigen"})})}).subscribe();return()=>$.removeChannel(U)},[x,t]),se=U=>{o(U),U.is_read||q([U.id],!0)},q=async(U,Q)=>{const{error:oe}=await $.from("emails").update({is_read:Q}).in("id",U);oe||n(re=>re.map(le=>U.includes(le.id)?{...le,is_read:Q}:le))},O=async U=>{const Q=e.find(re=>re.id===U);if(!Q)return;const{error:oe}=await $.from("emails").update({is_starred:!Q.is_starred}).eq("id",U);oe||n(re=>re.map(le=>le.id===U?{...le,is_starred:!Q.is_starred}:le))},F=async U=>{const{error:Q}=await $.from("emails").update({is_archived:!0}).in("id",U);Q||(n(oe=>oe.filter(re=>!U.includes(re.id))),c([]),t({title:"E-Mails archiviert",description:`${U.length} E-Mail(s) wurden archiviert.`}))},B=U=>{switch(U){case"mark-read":q(l,!0);break;case"mark-unread":q(l,!1);break;case"archive":F(l);break;case"star":l.forEach(Q=>O(Q));break}},R=async U=>{try{const{data:{user:Q}}=await $.auth.getUser();if(!Q)return;const{data:oe}=await $.from("profiles").select("company_id").eq("id",Q.id).single();if(!(oe!=null&&oe.company_id))return;let re=null;if(U.customers){const{data:le}=await $.from("customers").select("id").eq("email",U.sender_email).eq("company_id",oe.company_id).single();if(le)re=le.id;else{const{data:Z}=await $.from("customers").insert({company_id:oe.company_id,email:U.sender_email,company_name:U.customers.company_name,contact_person:U.customers.contact_person}).select().single();Z&&(re=Z.id)}}if(re){const{data:le,error:Z}=await $.from("quotes").insert({quote_number:`AG-${Date.now().toString().slice(-6)}`,company_id:oe.company_id,customer_id:re,title:`Angebot bezüglich: ${U.subject}`,description:`Automatisch erstellt aus E-Mail vom ${E(U.received_at)}`,quote_date:new Date().toISOString().split("T")[0],valid_until:new Date(Date.now()+2592e6).toISOString().split("T")[0],status:"entwurf",total_amount:0,currency:"EUR"}).select().single();le&&t({title:"Angebot erstellt",description:`Angebot ${le.quote_number} wurde aus E-Mail erstellt.`})}}catch{t({title:"Fehler beim Erstellen",description:"Angebot konnte nicht erstellt werden.",variant:"destructive"})}},D=async U=>{try{const{data:{user:Q}}=await $.auth.getUser();if(!Q)return;const{data:oe}=await $.from("profiles").select("company_id").eq("id",Q.id).single();if(!(oe!=null&&oe.company_id))return;let re=null;if(U.customers){const{data:le}=await $.from("customers").select("id").eq("email",U.sender_email).eq("company_id",oe.company_id).single();le&&(re=le.id)}if(re){const{data:le,error:Z}=await $.from("projects").insert({name:U.subject||"Projekt aus E-Mail",customer_id:re,company_id:oe.company_id,status:"anfrage",start_date:new Date().toISOString().split("T")[0],description:`Automatisch erstellt aus E-Mail vom ${P(U.received_at)}.

Inhalt der E-Mail:
${U.content.replace(/<[^>]*>/g,"")}`,budget:0}).select().single();le&&t({title:"Projekt erstellt",description:`Projekt "${le.name}" wurde aus E-Mail erstellt.`})}}catch{t({title:"Fehler beim Erstellen",description:"Projekt konnte nicht erstellt werden.",variant:"destructive"})}},L=e.filter(U=>{var re,le;const Q=d==="inbox"?!U.is_archived:d==="starred"?U.is_starred:d==="unread"?!U.is_read:((re=U.email_categories)==null?void 0:re.name)===d,oe=!h||U.subject.toLowerCase().includes(h.toLowerCase())||((le=U.sender_name)==null?void 0:le.toLowerCase().includes(h.toLowerCase()))||U.sender_email.toLowerCase().includes(h.toLowerCase())||U.content.toLowerCase().includes(h.toLowerCase());return Q&&oe}),M=U=>{switch(U){case"urgent":return r.jsx(k0,{className:"h-3 w-3 text-red-500"});case"high":return r.jsx(N0,{className:"h-3 w-3 text-orange-500"});default:return null}},X=async()=>{try{const{data:{user:U}}=await $.auth.getUser();if(!U){t({title:"Fehler",description:"Sie müssen angemeldet sein, um Gmail zu verbinden.",variant:"destructive"});return}const{data:Q,error:oe}=await $.functions.invoke("initiate-gmail-oauth",{body:{user_id:U.id}});if(Q!=null&&Q.authUrl){window.open(Q.authUrl,"_blank","width=500,height=600"),t({title:"Gmail-Verbindung",description:"Ein neues Fenster wurde geöffnet. Bitte autorisieren Sie den Zugriff auf Gmail."});let re=0;const le=setInterval(async()=>{re++,await C(),(S||re>=15)&&(clearInterval(le),S&&t({title:"Gmail verbunden!",description:"Sie können jetzt E-Mails synchronisieren."}))},2e3)}else t({title:"Fehler",description:(oe==null?void 0:oe.message)||"Gmail-Verbindung konnte nicht gestartet werden.",variant:"destructive"})}catch(U){console.error("Gmail OAuth error:",U),t({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten.",variant:"destructive"})}},K=async()=>{var U,Q;try{console.log("Starting AI analysis for emails...");const oe=e.filter(re=>!re.ai_category&&!re.ai_summary);if(oe.length===0){console.log("No emails need AI analysis");return}console.log(`Analyzing ${oe.length} emails with AI...`);for(const re of oe.slice(0,5))try{const{data:le,error:Z}=await $.functions.invoke("classify-email",{body:JSON.stringify({emailId:re.id,subject:re.subject,content:re.content,senderEmail:re.sender_email,senderName:re.sender_name})});if(le&&!Z){console.log(`AI analysis result for email ${re.id}:`,le);const de={...re,ai_category:le.category,ai_summary:le.summary,ai_confidence:le.confidence,priority:((U=le.extractedData)==null?void 0:U.priority)||"normal"};n(he=>he.map(Re=>Re.id===re.id?de:Re)),await $.from("emails").update({ai_category:le.category,ai_summary:le.summary,ai_confidence:le.confidence,priority:((Q=le.extractedData)==null?void 0:Q.priority)||"normal",processing_status:"completed"}).eq("id",re.id)}}catch(le){console.error(`AI analysis failed for email ${re.id}:`,le)}t({title:"KI-Analyse abgeschlossen",description:`${oe.length} E-Mails wurden analysiert.`}),await V()}catch(oe){console.error("AI analysis error:",oe),t({title:"KI-Analyse Fehler",description:"Die KI-Analyse konnte nicht durchgeführt werden.",variant:"destructive"})}},z=async()=>{try{b(!0);const{data:{user:U}}=await $.auth.getUser();if(!U){t({title:"Fehler",description:"Sie müssen angemeldet sein, um E-Mails zu synchronisieren.",variant:"destructive"}),b(!1);return}console.log("Starting Gmail sync for user:",U.id);const Q=new Promise((de,he)=>setTimeout(()=>he(new Error("Sync timeout after 30 seconds")),3e4)),oe=$.functions.invoke("sync-gmail-emails",{body:JSON.stringify({manual:!0,forceFullSync:!1}),headers:{"Content-Type":"application/json"}}),re=await Promise.race([oe,Q]),{data:le,error:Z}=re;console.log("Gmail sync response:",{data:le,error:Z}),le!=null&&le.success?(await V(),t({title:"Synchronisation erfolgreich",description:`${le.synced_count||le.totalSynced||0} neue E-Mails synchronisiert.`}),await K()):(console.error("Gmail sync failed:",Z),t({title:"Synchronisationsfehler",description:(Z==null?void 0:Z.message)||(le==null?void 0:le.error)||"E-Mails konnten nicht synchronisiert werden.",variant:"destructive"}))}catch(U){console.error("Gmail sync error:",U),t({title:"Fehler",description:`Synchronisation fehlgeschlagen: ${U.message}`,variant:"destructive"})}finally{b(!1)}};return r.jsxs("div",{className:"p-4 space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"E-Mail Verwaltung"}),r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs(W,{variant:S?"default":"outline",onClick:X,className:"rounded-full",children:[r.jsx(Tn,{className:"h-4 w-4 mr-2"}),S?"Gmail verbunden":"Gmail verbinden"]}),r.jsxs(W,{variant:"outline",onClick:z,disabled:p||!S,className:"rounded-full",children:[r.jsx(qC,{className:`h-4 w-4 mr-2 ${p?"animate-spin":""}`}),"Synchronisieren"]}),r.jsxs(W,{onClick:()=>j(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Neue E-Mail"]})]})]}),r.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Ungelesen"}),r.jsx("p",{className:"text-2xl font-bold",children:e.filter(U=>!U.is_read).length})]}),r.jsx(Tn,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Markiert"}),r.jsx("p",{className:"text-2xl font-bold",children:e.filter(U=>U.is_starred).length})]}),r.jsx(rd,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"Heute"}),r.jsx("p",{className:"text-2xl font-bold",children:e.filter(U=>{try{return new Date(U.received_at).toDateString()===new Date().toDateString()}catch{return!1}}).length})]}),r.jsx(gt,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),r.jsx(J,{className:"shadow-soft rounded-2xl",children:r.jsx(te,{className:"p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-muted-foreground",children:"KI-Kategorien"}),r.jsx("p",{className:"text-2xl font-bold",children:e.filter(U=>U.ai_category).length})]}),r.jsx(Wh,{className:"h-8 w-8 text-purple-500 opacity-50"})]})})})]}),r.jsx(J,{className:"shadow-soft rounded-2xl flex-1",style:{minHeight:"calc(100vh - 280px)"},children:r.jsx(te,{className:"p-0",children:r.jsxs("div",{className:"flex",style:{height:"calc(100vh - 280px)"},children:[r.jsxs("div",{className:`${y?"w-16":"w-64"} border-r bg-muted/30 transition-all duration-200`,children:[r.jsxs("div",{className:"p-4 border-b",children:[r.jsx(W,{size:"sm",variant:"ghost",onClick:()=>v(!y),className:"mb-4",children:y?r.jsx(Co,{className:"h-4 w-4"}):r.jsx($d,{className:"h-4 w-4"})}),!y&&r.jsxs("div",{className:"relative",children:[r.jsx(Mc,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),r.jsx(G,{placeholder:"E-Mails suchen...",value:h,onChange:U=>m(U.target.value),className:"pl-9 rounded-xl"})]})]}),r.jsxs("nav",{className:"flex-1 px-4 space-y-1",children:[r.jsxs(W,{variant:d==="inbox"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>u("inbox"),children:[r.jsx(Tn,{className:"h-4 w-4 mr-2"}),!y&&r.jsxs(r.Fragment,{children:["Posteingang",r.jsx(Ae,{variant:"secondary",className:"ml-auto",children:e.filter(U=>!U.is_archived).length})]})]}),r.jsxs(W,{variant:d==="starred"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>u("starred"),children:[r.jsx(rd,{className:"h-4 w-4 mr-2"}),!y&&r.jsxs(r.Fragment,{children:["Markiert",r.jsx(Ae,{variant:"secondary",className:"ml-auto",children:e.filter(U=>U.is_starred).length})]})]}),r.jsxs(W,{variant:d==="unread"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>u("unread"),children:[r.jsx(na,{className:"h-4 w-4 mr-2"}),!y&&r.jsxs(r.Fragment,{children:["Ungelesen",r.jsx(Ae,{variant:"secondary",className:"ml-auto",children:e.filter(U=>!U.is_read).length})]})]}),!y&&r.jsx(Ni,{className:"my-4"}),s.map(U=>{const Q=A[U.icon]||Tn,oe=e.filter(re=>{var le;return((le=re.email_categories)==null?void 0:le.name)===U.name}).length;return r.jsxs(W,{variant:d===U.name?"secondary":"ghost",className:"w-full justify-start",onClick:()=>u(U.name),children:[r.jsx(Q,{className:"h-4 w-4 mr-2",style:{color:U.color}}),!y&&r.jsxs(r.Fragment,{children:[U.name,r.jsx(Ae,{variant:"secondary",className:"ml-auto",children:oe})]})]},U.id)})]}),!y&&r.jsx("div",{className:"p-4 border-t",children:r.jsxs(W,{variant:"outline",className:"w-full rounded-xl",onClick:K,children:[r.jsx(Wh,{className:"h-4 w-4 mr-2"}),"KI-Analyse"]})})]}),r.jsxs("div",{className:"w-96 bg-background border-r flex flex-col",children:[l.length>0&&r.jsx("div",{className:"p-3 border-b bg-muted/50",children:r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"text-sm text-muted-foreground",children:[l.length," ausgewählt"]}),r.jsx(W,{size:"sm",variant:"ghost",onClick:()=>B("mark-read"),children:r.jsx(b8,{className:"h-4 w-4"})}),r.jsx(W,{size:"sm",variant:"ghost",onClick:()=>B("star"),children:r.jsx(rd,{className:"h-4 w-4"})}),r.jsx(W,{size:"sm",variant:"ghost",onClick:()=>B("archive"),children:r.jsx(f8,{className:"h-4 w-4"})})]})}),r.jsx(Ay,{className:"flex-1",children:r.jsx("div",{className:"divide-y",children:L.map(U=>{var Q;return r.jsx("div",{className:`p-4 cursor-pointer transition-all hover:bg-accent/50 ${(i==null?void 0:i.id)===U.id?"bg-accent border-r-2 border-primary":""} ${U.is_read?"":"bg-blue-50/30 border-l-2 border-blue-500"}`,onClick:()=>se(U),children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(aa,{checked:l.includes(U.id),onCheckedChange:oe=>{c(oe?re=>[...re,U.id]:re=>re.filter(le=>le!==U.id))},onClick:oe=>oe.stopPropagation()}),r.jsx(Fu,{className:"h-8 w-8 flex-shrink-0",children:r.jsx(Bu,{children:((Q=U.sender_name)==null?void 0:Q[0])||U.sender_email[0].toUpperCase()})}),r.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:`text-sm truncate ${U.is_read?"":"font-semibold"}`,children:U.sender_name||U.sender_email}),r.jsxs("div",{className:"flex items-center gap-1",children:[M(U.priority),r.jsx("span",{className:"text-xs text-muted-foreground",children:k(U.received_at)})]})]}),r.jsx("p",{className:`text-sm truncate ${U.is_read?"":"font-semibold"}`,children:U.subject}),r.jsxs("p",{className:"text-xs text-muted-foreground line-clamp-2",children:[U.ai_summary||U.content.replace(/<[^>]*>/g,"").substring(0,100),"..."]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[U.is_starred&&r.jsx(rd,{className:"h-3 w-3 text-yellow-500 fill-current"}),U.attachments&&U.attachments.length>0&&r.jsx(M8,{className:"h-3 w-3 text-muted-foreground"}),U.reply_count&&U.reply_count>0&&r.jsx(Ae,{variant:"outline",className:"text-xs px-1 py-0",children:U.reply_count})]}),U.email_categories&&r.jsx(Ae,{variant:"outline",className:"text-xs",style:{borderColor:U.email_categories.color,color:U.email_categories.color},children:U.email_categories.name})]})]})]})},U.id)})})})]}),i?r.jsxs("div",{className:"flex-1 flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b bg-card",children:[r.jsxs("div",{className:"flex items-start justify-between mb-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Fu,{className:"h-10 w-10",children:r.jsx(Bu,{children:((Y=i.sender_name)==null?void 0:Y[0])||i.sender_email[0].toUpperCase()})}),r.jsxs("div",{className:"space-y-1",children:[r.jsx("p",{className:"font-medium",children:i.sender_name||i.sender_email}),r.jsx("p",{className:"text-sm text-muted-foreground",children:i.sender_email}),r.jsx("p",{className:"text-xs text-muted-foreground",children:P(i.received_at)})]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(W,{size:"sm",variant:"ghost",onClick:()=>O(i.id),children:r.jsx(rd,{className:`h-4 w-4 ${i.is_starred?"text-yellow-500 fill-current":""}`})}),r.jsx(W,{size:"sm",variant:"ghost",children:r.jsx(F8,{className:"h-4 w-4"})}),r.jsx(W,{size:"sm",variant:"ghost",children:r.jsx(E8,{className:"h-4 w-4"})}),r.jsx(W,{size:"sm",variant:"ghost",children:r.jsx(k8,{className:"h-4 w-4"})})]})]}),r.jsx("h2",{className:"text-xl font-semibold mb-4",children:i.subject}),r.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.ai_category&&r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-purple-100 text-purple-800 border-purple-200",children:[r.jsx(Wh,{className:"h-3 w-3 mr-1"}),i.ai_category]}),i.customers&&r.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-100 text-green-800 border-green-200",children:[r.jsx(As,{className:"h-3 w-3 mr-1"}),i.customers.company_name]})]}),i.ai_summary&&r.jsxs("div",{className:"bg-accent/50 p-4 rounded-xl mt-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(Wh,{className:"h-4 w-4 text-primary"}),r.jsx("span",{className:"text-sm font-medium",children:"KI-Zusammenfassung"}),i.ai_confidence&&r.jsxs(Ae,{variant:"outline",className:"text-xs",children:[Math.round(i.ai_confidence*100),"% Konfidenz"]})]}),r.jsx("p",{className:"text-sm",children:i.ai_summary})]}),r.jsxs("div",{className:"flex gap-2 mt-4",children:[r.jsxs(W,{size:"sm",onClick:()=>R(i),className:"rounded-xl",children:[r.jsx(mn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),r.jsxs(W,{size:"sm",variant:"outline",onClick:()=>D(i),className:"rounded-xl",children:[r.jsx(As,{className:"h-4 w-4 mr-2"}),"Projekt anlegen"]}),((ae=i.customers)==null?void 0:ae.phone)&&r.jsx(W,{size:"sm",variant:"outline",asChild:!0,className:"rounded-xl",children:r.jsxs("a",{href:`tel:${i.customers.phone}`,children:[r.jsx(Rc,{className:"h-4 w-4 mr-2"}),"Anrufen"]})})]})]}),r.jsx(Ay,{className:"flex-1 p-6",children:r.jsx("div",{className:"prose prose-sm max-w-none text-gray-800 dark:text-gray-200",style:{fontSize:"14px",lineHeight:"1.6"},dangerouslySetInnerHTML:{__html:i.html_content||i.content.replace(/\n/g,"<br>")}})})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center bg-muted/20",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Tn,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),r.jsx("p",{className:"text-lg font-medium mb-2",children:"Keine E-Mail ausgewählt"}),r.jsx("p",{className:"text-muted-foreground",children:"Wählen Sie eine E-Mail aus, um sie anzuzeigen"})]})})]})})})]})};function N3({open:t,onOpenChange:e,onSuccess:n}){const{toast:s}=pt(),[a,i]=f.useState(!1),[o,l]=f.useState(0),[c,d]=f.useState({startDate:"",endDate:"",reason:"",type:"vacation"});f.useEffect(()=>{t&&u()},[t]);const u=async()=>{try{const{data:{user:b}}=await $.auth.getUser();if(!b)return;const{data:x}=await $.from("employees").select("id, vacation_days_total, vacation_days_used").eq("user_id",b.id).single();if(x){const g=(x.vacation_days_total||0)-(x.vacation_days_used||0);l(Math.max(0,g))}else{const{data:g}=await $.from("company_settings").select("default_vacation_days").single();l((g==null?void 0:g.default_vacation_days)||25)}}catch(b){console.error("Error loading vacation balance:",b),l(0)}},h=(b,x)=>{if(!b||!x)return 0;const g=new Date(b),v=new Date(x).getTime()-g.getTime(),w=Math.ceil(v/(1e3*3600*24))+1;return Math.max(0,w)},m=async b=>{if(b.preventDefault(),!c.startDate||!c.endDate){s({title:"Fehler",description:"Bitte wählen Sie Start- und Enddatum aus",variant:"destructive"});return}const x=new Date(c.startDate),g=new Date(c.endDate);if(x>g){s({title:"Fehler",description:"Das Enddatum muss nach dem Startdatum liegen",variant:"destructive"});return}const y=h(c.startDate,c.endDate);if(c.type==="vacation"&&y>o){s({title:"Fehler",description:`Sie haben nur noch ${o} Urlaubstage verfügbar`,variant:"destructive"});return}i(!0);try{const{data:{user:v}}=await $.auth.getUser();if(!v)throw new Error("Nicht angemeldet");const{data:w,error:j}=await $.from("employees").select("id").eq("user_id",v.id).single();if(j||!w)throw new Error("Mitarbeiterdaten nicht gefunden");const{error:S}=await $.from("vacation_requests").insert({employee_id:w.id,start_date:c.startDate,end_date:c.endDate,days_requested:y,request_type:c.type,reason:c.reason||null,status:"pending",created_by:v.id});if(S)throw S;s({title:"Antrag eingereicht",description:`Ihr ${c.type==="vacation"?"Urlaubs":"Abwesenheits"}antrag wurde erfolgreich eingereicht`}),d({startDate:"",endDate:"",reason:"",type:"vacation"}),e(!1),n==null||n()}catch(v){console.error("Error submitting vacation request:",v),s({title:"Fehler",description:v.message||"Antrag konnte nicht eingereicht werden",variant:"destructive"})}finally{i(!1)}},p=h(c.startDate,c.endDate);return r.jsx(Mt,{open:t,onOpenChange:e,children:r.jsxs(Pt,{className:"max-w-md",children:[r.jsx(Bt,{children:r.jsxs(Lt,{className:"flex items-center gap-2",children:[r.jsx(gt,{className:"h-5 w-5"}),"Urlaubsantrag stellen"]})}),r.jsxs("form",{onSubmit:m,className:"space-y-4",children:[r.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsx("span",{children:"Verfügbare Urlaubstage:"}),r.jsxs("span",{className:"font-semibold text-blue-600",children:[o," Tage"]})]})}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{children:"Art der Abwesenheit"}),r.jsxs("select",{value:c.type,onChange:b=>d(x=>({...x,type:b.target.value})),className:"w-full p-2 border rounded-md",children:[r.jsx("option",{value:"vacation",children:"Urlaub"}),r.jsx("option",{value:"sick",children:"Krankmeldung"}),r.jsx("option",{value:"personal",children:"Persönliche Angelegenheiten"})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"startDate",children:"Von"}),r.jsx(G,{id:"startDate",type:"date",value:c.startDate,onChange:b=>d(x=>({...x,startDate:b.target.value})),min:new Date().toISOString().split("T")[0],required:!0})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"endDate",children:"Bis"}),r.jsx(G,{id:"endDate",type:"date",value:c.endDate,onChange:b=>d(x=>({...x,endDate:b.target.value})),min:c.startDate||new Date().toISOString().split("T")[0],required:!0})]})]}),p>0&&r.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm",children:[r.jsxs("span",{className:"flex items-center gap-1",children:[r.jsx(Ht,{className:"h-4 w-4"}),"Beantragte Tage:"]}),r.jsxs("span",{className:`font-semibold ${c.type==="vacation"&&p>o?"text-red-600":"text-green-600"}`,children:[p," ",p===1?"Tag":"Tage"]})]}),c.type==="vacation"&&p>o&&r.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Nicht genügend Urlaubstage verfügbar"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs(H,{htmlFor:"reason",children:["Begründung ",c.type!=="vacation"&&"(erforderlich)"]}),r.jsx(an,{id:"reason",value:c.reason,onChange:b=>d(x=>({...x,reason:b.target.value})),placeholder:c.type==="vacation"?"Optionale Begründung für den Urlaub...":"Bitte geben Sie eine Begründung an...",rows:3,required:c.type!=="vacation"})]}),r.jsxs("div",{className:"flex gap-2 pt-2",children:[r.jsx(W,{type:"submit",disabled:a||!c.startDate||!c.endDate,className:"flex-1",children:a?"Wird eingereicht...":"Antrag stellen"}),r.jsx(W,{type:"button",variant:"outline",onClick:()=>e(!1),disabled:a,children:"Abbrechen"})]})]})]})})}function KY(){const{user:t,userRole:e}=za(),{toast:n}=pt(),[s,a]=f.useState([]),[i,o]=f.useState({total_days:0,used_days:0,pending_days:0,available_days:0}),[l,c]=f.useState(!0),[d,u]=f.useState(!1),[h,m]=f.useState("my-requests"),p=e==="manager"||e==="admin";f.useEffect(()=>{t&&b()},[t,h]);const b=async()=>{c(!0);try{await Promise.all([x(),g()])}catch(j){console.error("Error loading vacation data:",j)}finally{c(!1)}},x=async()=>{if(t)try{const{data:j}=await $.from("employees").select("vacation_days_total, vacation_days_used").eq("user_id",t.id).single();if(j){const{data:S}=await $.from("vacation_requests").select("days_requested").eq("employee_id",j.id).eq("status","pending").eq("request_type","vacation"),N=(S==null?void 0:S.reduce((A,C)=>A+C.days_requested,0))||0,k=j.vacation_days_total||0,E=j.vacation_days_used||0,P=Math.max(0,k-E-N);o({total_days:k,used_days:E,pending_days:N,available_days:P})}else{const{data:S}=await $.from("company_settings").select("default_vacation_days").single(),N=(S==null?void 0:S.default_vacation_days)||25;o({total_days:N,used_days:0,pending_days:0,available_days:N})}}catch(j){console.error("Error loading vacation balance:",j)}},g=async()=>{if(t)try{let j=$.from("vacation_requests").select(`
          id,
          employee_id,
          start_date,
          end_date,
          days_requested,
          request_type,
          reason,
          status,
          created_at,
          approved_by,
          approved_at,
          employees!inner(
            id,
            first_name,
            last_name,
            user_id
          )
        `).order("created_at",{ascending:!1});if(h==="my-requests"||!p){const{data:E}=await $.from("employees").select("id").eq("user_id",t.id).single();E&&(j=j.eq("employee_id",E.id))}const{data:S,error:N}=await j;if(N)throw N;const k=(S==null?void 0:S.map(E=>({id:E.id,employee_id:E.employee_id,employee_name:`${E.employees.first_name} ${E.employees.last_name}`,start_date:E.start_date,end_date:E.end_date,days_requested:E.days_requested,request_type:E.request_type,reason:E.reason,status:E.status,created_at:E.created_at,approved_by:E.approved_by,approved_at:E.approved_at})))||[];a(k)}catch(j){console.error("Error loading vacation requests:",j),n({title:"Fehler",description:"Urlaubsanträge konnten nicht geladen werden",variant:"destructive"})}},y=async(j,S)=>{const N=[...s];a(k=>k.filter(E=>E.id!==j));try{const k={status:S?"approved":"rejected",approved_by:t==null?void 0:t.id,approved_at:new Date().toISOString()},{error:E}=await $.from("vacation_requests").update(k).eq("id",j);if(E)throw a(N),E;if(S){const P=s.find(A=>A.id===j);if(P&&P.request_type==="vacation"){const{error:A}=await $.rpc("increment_vacation_days_used",{employee_id_param:P.employee_id,days_to_add:P.days_requested});A&&console.error("Error updating vacation days:",A)}}n({title:S?"Antrag genehmigt":"Antrag abgelehnt",description:`Der Urlaubsantrag wurde erfolgreich ${S?"genehmigt":"abgelehnt"}`}),setTimeout(()=>{b()},1e3)}catch(k){console.error("Error updating vacation request:",k),n({title:"Fehler",description:"Antrag konnte nicht aktualisiert werden",variant:"destructive"})}},v=j=>{switch(j){case"pending":return r.jsxs(Ae,{className:"bg-yellow-500",children:[r.jsx(k0,{className:"h-3 w-3 mr-1"}),"Ausstehend"]});case"approved":return r.jsxs(Ae,{className:"bg-green-500",children:[r.jsx(Rn,{className:"h-3 w-3 mr-1"}),"Genehmigt"]});case"rejected":return r.jsxs(Ae,{className:"bg-red-500",children:[r.jsx(Eo,{className:"h-3 w-3 mr-1"}),"Abgelehnt"]});default:return r.jsx(Ae,{variant:"outline",children:j})}},w=j=>{switch(j){case"vacation":return"Urlaub";case"sick":return"Krankmeldung";case"personal":return"Persönlich";default:return j}};return l?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"text-muted-foreground",children:"Lade Urlaubsdaten..."})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-gray-600 bg-clip-text text-transparent flex items-center gap-3",children:[r.jsx(gt,{className:"h-8 w-8 text-gray-600"}),"Urlaubsverwaltung"]}),r.jsx("p",{className:"text-muted-foreground",children:"Verwalten Sie Ihre Urlaubsanträge und Abwesenheiten"})]}),r.jsxs(W,{onClick:()=>u(!0),children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Neuer Antrag"]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Ht,{className:"h-5 w-5"}),"Mein Urlaubskonto"]})}),r.jsx(te,{children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.total_days}),r.jsx("div",{className:"text-sm text-blue-700",children:"Gesamte Tage"})]}),r.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.available_days}),r.jsx("div",{className:"text-sm text-green-700",children:"Verfügbar"})]}),r.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.pending_days}),r.jsx("div",{className:"text-sm text-orange-700",children:"Ausstehend"})]}),r.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-gray-600",children:i.used_days}),r.jsx("div",{className:"text-sm text-gray-700",children:"Verbraucht"})]})]})})]}),p&&r.jsxs("div",{className:"flex gap-2",children:[r.jsx(W,{variant:h==="my-requests"?"default":"outline",onClick:()=>m("my-requests"),children:"Meine Anträge"}),r.jsx(W,{variant:h==="all-requests"?"default":"outline",onClick:()=>m("all-requests"),children:"Alle Anträge"})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Ps,{className:"h-5 w-5"}),h==="all-requests"?"Alle Urlaubsanträge":"Meine Urlaubsanträge"]})}),r.jsx(te,{children:s.length===0?r.jsxs("div",{className:"text-center py-8",children:[r.jsx(gt,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Keine Anträge"}),r.jsx("p",{className:"text-gray-500",children:h==="all-requests"?"Es sind keine Urlaubsanträge vorhanden":"Sie haben noch keine Urlaubsanträge gestellt"})]}):r.jsx("div",{className:"space-y-4",children:s.map(j=>r.jsxs("div",{className:"border rounded-lg p-4",children:[r.jsxs("div",{className:"flex justify-between items-start mb-3",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[r.jsx("h4",{className:"font-semibold",children:h==="all-requests"?j.employee_name:w(j.request_type)}),v(j.status)]}),r.jsxs("div",{className:"text-sm text-gray-600",children:[new Date(j.start_date).toLocaleDateString("de-DE")," - "," ",new Date(j.end_date).toLocaleDateString("de-DE")," (",j.days_requested," ",j.days_requested===1?"Tag":"Tage",")"]})]}),r.jsx("div",{className:"text-xs text-gray-500",children:new Date(j.created_at).toLocaleDateString("de-DE")})]}),j.reason&&r.jsx("div",{className:"mb-3",children:r.jsx("p",{className:"text-sm text-gray-700",children:j.reason})}),p&&h==="all-requests"&&j.status==="pending"&&r.jsxs("div",{className:"flex gap-2 mt-3",children:[r.jsxs(W,{size:"sm",onClick:()=>y(j.id,!0),className:"bg-green-600 hover:bg-green-700",children:[r.jsx(Rn,{className:"h-4 w-4 mr-1"}),"Genehmigen"]}),r.jsxs(W,{size:"sm",variant:"outline",onClick:S=>{S.preventDefault(),S.stopPropagation(),y(j.id,!1)},className:"border-red-600 text-red-600 hover:bg-red-50",children:[r.jsx(Eo,{className:"h-4 w-4 mr-1"}),"Ablehnen"]})]}),j.approved_at&&r.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[j.status==="approved"?"Genehmigt":"Abgelehnt"," am"," ",new Date(j.approved_at).toLocaleDateString("de-DE")]})]},j.id))})})]}),r.jsx(N3,{open:d,onOpenChange:u,onSuccess:b})]})}class GY{async createOrderFromQuote(e){try{console.log("🔄 Creating order from quote:",e);const{data:n,error:s}=await $.from("quotes").select("*").eq("id",e).single();if(s||!n)throw new Error("Angebot nicht gefunden");const a={order_number:`AUF-${Date.now().toString().slice(-6)}`,customer_id:n.customer_id,title:n.title||"Auftrag aus Angebot",description:n.description,order_date:new Date().toISOString().split("T")[0],due_date:n.valid_until||null,status:"confirmed",priority:"medium",total_amount:n.total_amount,currency:n.currency||"EUR",notes:`Automatisch erstellt aus Angebot ${n.quote_number}`,workflow_origin_type:"quote",workflow_origin_id:e},{data:i,error:o}=await $.from("orders").insert(a).select().single();if(o)throw o;return await $.from("quotes").update({status:"accepted",workflow_target_type:"order",workflow_target_id:i.id}).eq("id",e),await this.createOrUpdateWorkflowChain({quoteId:e,orderId:i.id,currentStep:"order",customerId:n.customer_id,metadata:{title:n.title||"Neuer Workflow",totalAmount:n.total_amount,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}),Ks({title:"Auftrag erstellt",description:`Auftrag ${a.order_number} wurde erfolgreich aus dem Angebot erstellt.`}),i.id}catch(n){return console.error("❌ Error creating order from quote:",n),Ks({title:"Fehler",description:"Auftrag konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async createProjectFromOrder(e){try{console.log("🔄 Creating project from order:",e);const{data:n,error:s}=await $.from("orders").select("*, customers(company_name)").eq("id",e).single();if(s||!n)throw new Error("Auftrag nicht gefunden");const{data:a}=await $.auth.getUser();if(!(a!=null&&a.user))throw new Error("Benutzer nicht authentifiziert");const{data:i}=await $.from("profiles").select("company_id").eq("id",a.user.id).single();if(!(i!=null&&i.company_id))throw new Error("Firma nicht gefunden");const o={name:n.title,customer_id:n.customer_id,company_id:i.company_id,status:"geplant",start_date:new Date().toISOString().split("T")[0],end_date:n.due_date||null,location:null,budget:n.total_amount||0,description:`Automatisch erstellt aus Auftrag ${n.order_number}. ${n.description||""}`,workflow_origin_type:"order",workflow_origin_id:e},{data:l,error:c}=await $.from("projects").insert(o).select().single();if(c)throw c;await $.from("orders").update({status:"in_progress",workflow_target_type:"project",workflow_target_id:l.id}).eq("id",e);const d=await this.getWorkflowChain(e,"order");return d&&await this.createOrUpdateWorkflowChain({...d,projectId:l.id,currentStep:"project"}),Ks({title:"Projekt erstellt",description:`Projekt "${n.title}" wurde erfolgreich aus dem Auftrag erstellt.`}),l.id}catch(n){return console.error("❌ Error creating project from order:",n),Ks({title:"Fehler",description:"Projekt konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async createInvoiceFromProject(e){try{console.log("🔄 Creating invoice from project:",e);const{data:n,error:s}=await $.from("projects").select("*, customers(company_name, address)").eq("id",e).single();if(s||!n)throw new Error("Projekt nicht gefunden");if(n.status!=="abgeschlossen")throw new Error("Rechnung kann nur für abgeschlossene Projekte erstellt werden");const a={invoice_number:`RG-${Date.now().toString().slice(-6)}`,customer_id:n.customer_id,issue_date:new Date().toISOString().split("T")[0],due_date:new Date(Date.now()+14*24*60*60*1e3).toISOString().split("T")[0],status:"draft",total_amount:n.budget||0,currency:"EUR",description:`Rechnung für Projekt: ${n.name}`,notes:`Automatisch erstellt aus Projekt ${n.name}`,workflow_origin_type:"project",workflow_origin_id:e},{data:i,error:o}=await $.from("invoices").insert(a).select().single();if(o)throw o;await $.from("projects").update({workflow_target_type:"invoice",workflow_target_id:i.id}).eq("id",e);const l=await this.getWorkflowChain(e,"project");return l&&await this.createOrUpdateWorkflowChain({...l,invoiceId:i.id,currentStep:"invoice"}),Ks({title:"Rechnung erstellt",description:`Rechnungsentwurf ${a.invoice_number} wurde erfolgreich erstellt.`}),i.id}catch(n){return console.error("❌ Error creating invoice from project:",n),Ks({title:"Fehler",description:"Rechnung konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async checkBudgetWarnings(){try{const{data:e}=await $.from("projects").select("*").in("status",["geplant","in_bearbeitung"]),n=[];for(const s of e||[])if(s.budget&&s.budget>0){const a=s.budget*.95,i=a/s.budget*100;i>=90&&n.push({projectId:s.id,projectName:s.name,budget:s.budget,usedBudget:a,usagePercentage:i,type:"budget_warning"})}return n}catch(e){return console.error("❌ Error checking budget warnings:",e),[]}}async createOrUpdateWorkflowChain(e){try{const n={quote_id:e.quoteId||null,order_id:e.orderId||null,project_id:e.projectId||null,invoice_id:e.invoiceId||null,current_step:e.currentStep,customer_id:e.customerId,metadata:e.metadata,updated_at:new Date().toISOString()},s=$.from("workflow_chains").select("id");e.quoteId?s.eq("quote_id",e.quoteId):e.orderId?s.eq("order_id",e.orderId):e.projectId&&s.eq("project_id",e.projectId);const{data:a}=await s.single();a?await $.from("workflow_chains").update(n).eq("id",a.id):await $.from("workflow_chains").insert({...n,created_at:new Date().toISOString()})}catch(n){console.error("❌ Error managing workflow chain:",n)}}async getWorkflowChain(e,n){try{const s=`${n}_id`,{data:a}=await $.from("workflow_chains").select("*").eq(s,e).single();return a?{quoteId:a.quote_id,orderId:a.order_id,projectId:a.project_id,invoiceId:a.invoice_id,currentStep:a.current_step,customerId:a.customer_id,metadata:a.metadata}:null}catch(s){return console.error("❌ Error getting workflow chain:",s),null}}async getDashboardCriticalData(){try{const[e,n,s,a]=await Promise.all([this.checkBudgetWarnings(),this.getPendingQuotes(),this.getDelayedProjects(),this.getOverdueInvoices()]);return{overdueTasks:[...e,...s],budgetWarnings:e,pendingQuotes:n,delayedProjects:s,overdueInvoices:a}}catch(e){return console.error("❌ Error getting dashboard critical data:",e),{overdueTasks:[],budgetWarnings:[],pendingQuotes:[],delayedProjects:[],overdueInvoices:[]}}}async getPendingQuotes(){const{data:e}=await $.from("quotes").select("*, customers(company_name)").eq("status","pending").order("created_at",{ascending:!1});return e||[]}async getDelayedProjects(){const{data:e}=await $.from("projects").select("*").in("status",["geplant","in_bearbeitung"]).lt("end_date",new Date().toISOString().split("T")[0]);return e||[]}async getOverdueInvoices(){const{data:e}=await $.from("invoices").select("*, customers(company_name)").eq("status","sent").lt("due_date",new Date().toISOString().split("T")[0]);return e||[]}async applyScheduleWithApproval(e){var n;return await dA("aiScheduleApply",{reason:"KI-Planung soll auf den Kalender angewendet werden.",metadata:{projectId:e.projectId,employeeCount:((n=e.employeeAssignments)==null?void 0:n.length)||0},userId:e.userId},async()=>(console.log("Applying AI schedule:",e),e))}}const ZY=new GY,QY=({onNavigate:t})=>{const[e,n]=f.useState({criticalAlerts:{budgetWarnings:0,overdueProjects:0,overdueInvoices:0,pendingQuotes:0},financialKPIs:{monthlyRevenue:0,monthlyExpenses:0,profit:0,profitMargin:0,outstandingAmount:0,revenuetrend:0},projectStatus:{active:0,planning:0,completed:0,delayed:0},teamOverview:{activeEmployees:0,todayHours:0,utilizationRate:0}}),[s,a]=f.useState(!0),[i,o]=f.useState([]),{toast:l}=pt();f.useEffect(()=>{c();const x=setInterval(c,5*60*1e3);return()=>clearInterval(x)},[]);const c=async()=>{try{a(!0);const[x,g,y,v]=await Promise.all([ZY.getDashboardCriticalData(),d(),u(),h()]);o(x.overdueTasks),n({criticalAlerts:{budgetWarnings:x.budgetWarnings.length,overdueProjects:x.delayedProjects.length,overdueInvoices:x.overdueInvoices.length,pendingQuotes:x.pendingQuotes.length},financialKPIs:y,projectStatus:g,teamOverview:v})}catch(x){console.error("❌ Error loading dashboard data:",x),l({title:"Fehler beim Laden",description:"Dashboard-Daten konnten nicht geladen werden.",variant:"destructive"})}finally{a(!1)}},d=async()=>{const{data:x}=await $.from("projects").select("status, end_date"),g=new Date().toISOString().split("T")[0],y={active:0,planning:0,completed:0,delayed:0};return x==null||x.forEach(v=>{switch(v.status){case"in_bearbeitung":y.active++;break;case"geplant":case"anfrage":case"besichtigung":y.planning++;break;case"abgeschlossen":y.completed++;break}v.end_date&&v.end_date<g&&v.status!=="abgeschlossen"&&y.delayed++}),y},u=async()=>({monthlyRevenue:45e3,monthlyExpenses:32e3,profit:13e3,profitMargin:28.9,outstandingAmount:8500,revenuetrend:12.5}),h=async()=>{const{data:x}=await $.from("employees").select("status").neq("status","eingeladen");return{activeEmployees:(x==null?void 0:x.length)||0,todayHours:67.5,utilizationRate:85}},m=[{id:"new-quote",title:"Neues Angebot",description:"Angebot für Kunden erstellen",icon:mn,color:"bg-blue-500",onClick:()=>t==null?void 0:t("finance")},{id:"new-project",title:"Projekt anlegen",description:"Direktes Projekt erstellen",icon:As,color:"bg-green-500",onClick:()=>t==null?void 0:t("projects")},{id:"check-finances",title:"Finanzen prüfen",description:"Rechnungen und Ausgaben",icon:Fr,color:"bg-purple-500",onClick:()=>t==null?void 0:t("finance")},{id:"team-overview",title:"Team Status",description:"Mitarbeiter und Zeiten",icon:Oa,color:"bg-orange-500",onClick:()=>t==null?void 0:t("personal")}],p=x=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(x),b=()=>Object.values(e.criticalAlerts).reduce((x,g)=>x+g,0);return s?r.jsx("div",{className:"flex items-center justify-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):r.jsxs("div",{className:"space-y-6 animate-fadeIn p-6 bg-gray-50 min-h-screen",children:[r.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),r.jsx("p",{className:"text-gray-600",children:"Zentrale Übersicht Ihres Handwerksbetriebs"})]}),b()>0&&r.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-red-50 border border-red-100 rounded-xl",children:[r.jsx(Xn,{className:"h-5 w-5 text-red-500"}),r.jsxs("span",{className:"text-red-700 font-medium",children:[b()," Punkte benötigen Aufmerksamkeit"]})]})]})}),r.jsxs(GT,{children:[r.jsx(_i,{title:"Offene Aufträge",value:e.projectStatus.active+e.projectStatus.planning,valueClassName:"text-blue-600"}),r.jsx(_i,{title:"Monatsumsatz",value:p(e.financialKPIs.monthlyRevenue),valueClassName:"text-green-600"}),r.jsx(_i,{title:"Offene Angebote",value:e.criticalAlerts.pendingQuotes,valueClassName:"text-orange-600"}),r.jsx(_i,{title:"Mitarbeiter",value:e.teamOverview.activeEmployees,valueClassName:"text-purple-600"})]}),r.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[r.jsxs("div",{className:"col-span-8 space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[r.jsx("div",{className:"p-6 border-b border-gray-100",children:r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Finanzübersicht"})}),r.jsxs("div",{className:"p-6",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Umsatz"}),r.jsx("div",{className:"text-2xl font-bold text-green-600",children:p(e.financialKPIs.monthlyRevenue)})]}),r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Gewinn"}),r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p(e.financialKPIs.profit)})]})]}),r.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-gray-700",children:"Gewinnmarge"}),r.jsxs("span",{className:"font-semibold text-gray-900",children:[e.financialKPIs.profitMargin,"%"]})]})})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[r.jsx("div",{className:"p-6 border-b border-gray-100",children:r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Schnellaktionen"})}),r.jsx("div",{className:"p-6",children:r.jsx("div",{className:"grid grid-cols-2 gap-4",children:m.map(x=>r.jsxs("button",{onClick:x.onClick,className:"flex items-center gap-4 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors text-left",children:[r.jsx("div",{className:`p-3 rounded-lg ${x.color}`,children:r.jsx(x.icon,{className:"h-6 w-6 text-white"})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-gray-900",children:x.title}),r.jsx("div",{className:"text-sm text-gray-500",children:x.description})]})]},x.id))})})]})]}),r.jsxs("div",{className:"col-span-4 space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[r.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Projektstatus"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),r.jsx("span",{className:"text-sm text-gray-700",children:"Anfrage"})]}),r.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.planning})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),r.jsx("span",{className:"text-sm text-gray-700",children:"In Bearbeitung"})]}),r.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.active})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),r.jsx("span",{className:"text-sm text-gray-700",children:"Abgeschlossen"})]}),r.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.completed})]})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[r.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Team Übersicht"}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-700",children:"Aktive Mitarbeiter"}),r.jsx("span",{className:"font-medium",children:e.teamOverview.activeEmployees})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-700",children:"Stunden heute"}),r.jsxs("span",{className:"font-medium",children:[e.teamOverview.todayHours,"h"]})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{className:"text-gray-700",children:"Auslastung"}),r.jsxs("span",{className:"font-medium",children:[e.teamOverview.utilizationRate,"%"]})]})]})]}),r.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[r.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Heute"}),r.jsx("div",{className:"text-center py-4",children:r.jsx("p",{className:"text-gray-500",children:"Keine Termine für heute"})})]})]})]}),r.jsxs(cr,{defaultValue:"kpis",className:"w-full hidden",children:[r.jsxs(tr,{className:"grid w-full grid-cols-5",children:[r.jsx(Oe,{value:"kpis",children:"Kennzahlen"}),r.jsx(Oe,{value:"overview",children:"Übersicht"}),r.jsx(Oe,{value:"financial",children:"Finanzen"}),r.jsx(Oe,{value:"projects",children:"Projekte"}),r.jsx(Oe,{value:"actions",children:"Schnellaktionen"})]}),r.jsxs(Fe,{value:"kpis",className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-semibold mb-4",children:"📊 Aktuelle Kennzahlen"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[r.jsx(J,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("projects"),children:r.jsxs(te,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(yv,{className:"w-5 h-5 text-blue-600"}),r.jsx("span",{className:"font-medium",children:"Offene Aufträge"})]}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active+e.projectStatus.planning}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"in Bearbeitung"})]})}),r.jsx(J,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("emails"),children:r.jsxs(te,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(Tn,{className:"w-5 h-5 text-green-600"}),r.jsx("span",{className:"font-medium",children:"Ungelesene E-Mails"})]}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:"0"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"neue Anfragen"})]})}),r.jsx(J,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("finance"),children:r.jsxs(te,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(mn,{className:"w-5 h-5 text-orange-600"}),r.jsx("span",{className:"font-medium",children:"Offene Angebote"})]}),r.jsx("p",{className:"text-2xl font-bold text-orange-600",children:e.criticalAlerts.pendingQuotes}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"versendet"})]})}),r.jsx(J,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("finance"),children:r.jsxs(te,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(Fr,{className:"w-5 h-5 text-red-600"}),r.jsx("span",{className:"font-medium",children:"Offene Rechnungen"})]}),r.jsx("p",{className:"text-2xl font-bold text-red-600",children:e.criticalAlerts.overdueInvoices}),r.jsx("p",{className:"text-sm text-muted-foreground",children:p(e.financialKPIs.outstandingAmount)})]})}),r.jsx(J,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("timetracking"),children:r.jsxs(te,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(Ht,{className:"w-5 h-5 text-purple-600"}),r.jsx("span",{className:"font-medium",children:"Stunden heute"})]}),r.jsx("p",{className:"text-2xl font-bold text-purple-600",children:e.teamOverview.todayHours}),r.jsx("p",{className:"text-sm text-muted-foreground",children:"gearbeitet"})]})})]})]}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-semibold mb-4",children:"📅 Heute / Nächste Termine"}),r.jsx(J,{children:r.jsx(te,{className:"p-4",children:r.jsx("p",{className:"text-muted-foreground",children:"Keine Termine für heute"})})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-semibold mb-3",children:"👥 Mitarbeiterübersicht"}),r.jsx(J,{children:r.jsx(te,{className:"p-3",children:r.jsx("div",{className:"space-y-2",children:e.teamOverview.activeEmployees>0?r.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/30 rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500"}),r.jsxs("span",{className:"font-medium text-sm",children:[e.teamOverview.activeEmployees," Mitarbeiter"]})]}),r.jsx(W,{variant:"outline",size:"sm",onClick:()=>t==null?void 0:t("timetracking"),children:"Zeitbericht"})]}):r.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine aktiven Mitarbeiter"})})})})]}),r.jsxs("div",{children:[r.jsx("h2",{className:"text-lg font-semibold mb-3",children:"📨 Letzte E-Mails / Kundenanfragen"}),r.jsx(J,{children:r.jsx(te,{className:"p-3",children:r.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine neuen E-Mails"})})})]})]})]}),r.jsxs(Fe,{value:"overview",className:"space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[r.jsx(J,{children:r.jsx(te,{className:"p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Monatsumsatz"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:p(e.financialKPIs.monthlyRevenue)})]}),r.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[r.jsx(Bi,{className:"h-4 w-4"}),r.jsxs("span",{className:"text-sm font-medium",children:["+",e.financialKPIs.revenuetrend,"%"]})]})]})})}),r.jsx(J,{children:r.jsx(te,{className:"p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Gewinn"}),r.jsx("p",{className:"text-2xl font-bold",children:p(e.financialKPIs.profit)})]}),r.jsxs(Ae,{className:"bg-blue-100 text-blue-800",children:[e.financialKPIs.profitMargin,"%"]})]})})}),r.jsx(J,{children:r.jsx(te,{className:"p-6",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Aktive Projekte"}),r.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active})]}),r.jsx(As,{className:"h-8 w-8 text-blue-600"})]})})}),r.jsx(J,{children:r.jsxs(te,{className:"p-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-gray-600",children:"Team Auslastung"}),r.jsxs("p",{className:"text-2xl font-bold",children:[e.teamOverview.utilizationRate,"%"]})]}),r.jsx(Oa,{className:"h-8 w-8 text-purple-600"})]}),r.jsx(kc,{value:e.teamOverview.utilizationRate,className:"mt-2"})]})})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Projekt-Pipeline"})}),r.jsx(te,{children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:e.projectStatus.planning}),r.jsx("div",{className:"text-sm text-yellow-700",children:"In Planung"})]}),r.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active}),r.jsx("div",{className:"text-sm text-blue-700",children:"In Bearbeitung"})]}),r.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.projectStatus.completed}),r.jsx("div",{className:"text-sm text-green-700",children:"Abgeschlossen"})]}),r.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.projectStatus.delayed}),r.jsx("div",{className:"text-sm text-red-700",children:"Verspätet"})]})]})})]})]}),r.jsx(Fe,{value:"financial",className:"space-y-6",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Finanzielle Kennzahlen"})}),r.jsxs(te,{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Umsatz"}),r.jsx("span",{className:"font-bold text-green-600",children:p(e.financialKPIs.monthlyRevenue)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Ausgaben"}),r.jsx("span",{className:"font-bold text-red-600",children:p(e.financialKPIs.monthlyExpenses)})]}),r.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[r.jsx("span",{className:"font-semibold",children:"Gewinn"}),r.jsx("span",{className:"font-bold text-lg",children:p(e.financialKPIs.profit)})]}),r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("span",{children:"Gewinnmarge"}),r.jsxs("span",{className:"font-bold",children:[e.financialKPIs.profitMargin,"%"]})]})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Ausstehende Beträge"})}),r.jsxs(te,{children:[r.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:p(e.financialKPIs.outstandingAmount)}),r.jsx("p",{className:"text-sm text-gray-600",children:"Noch nicht bezahlte Rechnungen"}),r.jsxs(W,{variant:"outline",className:"mt-4 w-full",onClick:()=>t==null?void 0:t("finance"),children:[r.jsx(Fr,{className:"h-4 w-4 mr-2"}),"Rechnungen verwalten"]})]})]})]})}),r.jsx(Fe,{value:"projects",className:"space-y-6",children:r.jsxs(J,{children:[r.jsx(pe,{children:r.jsx(xe,{children:"Projekt-Status Details"})}),r.jsx(te,{children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),r.jsx("span",{children:"Projekte in Planung"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-bold",children:e.projectStatus.planning}),r.jsx(W,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:r.jsx(na,{className:"h-4 w-4"})})]})]}),r.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),r.jsx("span",{children:"Aktive Projekte"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-bold",children:e.projectStatus.active}),r.jsx(W,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:r.jsx(na,{className:"h-4 w-4"})})]})]}),e.projectStatus.delayed>0&&r.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-red-50",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(Xn,{className:"h-5 w-5 text-red-600"}),r.jsx("span",{className:"text-red-700",children:"Verspätete Projekte"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"font-bold text-red-600",children:e.projectStatus.delayed}),r.jsx(W,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:r.jsx(na,{className:"h-4 w-4"})})]})]})]})})]})}),r.jsx(Fe,{value:"actions",className:"space-y-6",children:r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(z8,{className:"h-5 w-5 text-yellow-500"}),"Schnellaktionen"]})}),r.jsx(te,{children:r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:m.map(x=>r.jsxs(W,{variant:"outline",className:"h-auto p-4 justify-start",onClick:x.onClick,children:[r.jsx("div",{className:`p-2 rounded-lg ${x.color} mr-4`,children:r.jsx(x.icon,{className:"h-6 w-6 text-white"})}),r.jsxs("div",{className:"text-left",children:[r.jsx("div",{className:"font-semibold",children:x.title}),r.jsx("div",{className:"text-sm text-gray-500",children:x.description})]}),r.jsx(N0,{className:"h-4 w-4 ml-auto"})]},x.id))})})]})})]})]})},S3=f.createContext(void 0);function YY({children:t}){const[e,n]=f.useState(()=>localStorage.getItem("handwerkos-theme")||"system"),[s,a]=f.useState("light");return f.useEffect(()=>{const i=window.document.documentElement;if(i.classList.remove("light","dark"),e==="system"){const o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i.classList.add(o),a(o)}else i.classList.add(e),a(e);localStorage.setItem("handwerkos-theme",e)},[e]),f.useEffect(()=>{if(e==="system"){const i=window.matchMedia("(prefers-color-scheme: dark)"),o=l=>{const c=l.matches?"dark":"light";document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(c),a(c)};return i.addEventListener("change",o),()=>i.removeEventListener("change",o)}},[e]),r.jsx(S3.Provider,{value:{theme:e,setTheme:n,actualTheme:s},children:t})}function k3(){const t=f.useContext(S3);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t}var Dy=["Enter"," "],JY=["ArrowDown","PageUp","Home"],C3=["ArrowUp","PageDown","End"],XY=[...JY,...C3],eJ={ltr:[...Dy,"ArrowRight"],rtl:[...Dy,"ArrowLeft"]},tJ={ltr:["ArrowLeft"],rtl:["ArrowRight"]},bh="Menu",[Lu,nJ,rJ]=Qu(bh),[el,E3]=Zr(bh,[rJ,Qi,q0]),mp=Qi(),A3=q0(),[sJ,tl]=el(bh),[aJ,wh]=el(bh),D3=t=>{const{__scopeMenu:e,open:n=!1,children:s,dir:a,onOpenChange:i,modal:o=!0}=t,l=mp(e),[c,d]=f.useState(null),u=f.useRef(!1),h=nn(i),m=Wc(a);return f.useEffect(()=>{const p=()=>{u.current=!0,document.addEventListener("pointerdown",b,{capture:!0,once:!0}),document.addEventListener("pointermove",b,{capture:!0,once:!0})},b=()=>u.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",b,{capture:!0}),document.removeEventListener("pointermove",b,{capture:!0})}},[]),r.jsx(zb,{...l,children:r.jsx(sJ,{scope:e,open:n,onOpenChange:h,content:c,onContentChange:d,children:r.jsx(aJ,{scope:e,onClose:f.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:u,dir:m,modal:o,children:s})})})};D3.displayName=bh;var iJ="MenuAnchor",fj=f.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,a=mp(n);return r.jsx(rh,{...a,...s,ref:e})});fj.displayName=iJ;var pj="MenuPortal",[oJ,P3]=el(pj,{forceMount:void 0}),T3=t=>{const{__scopeMenu:e,forceMount:n,children:s,container:a}=t,i=tl(pj,e);return r.jsx(oJ,{scope:e,forceMount:n,children:r.jsx(Sn,{present:n||i.open,children:r.jsx(Tc,{asChild:!0,container:a,children:s})})})};T3.displayName=pj;var ss="MenuContent",[lJ,xj]=el(ss),R3=f.forwardRef((t,e)=>{const n=P3(ss,t.__scopeMenu),{forceMount:s=n.forceMount,...a}=t,i=tl(ss,t.__scopeMenu),o=wh(ss,t.__scopeMenu);return r.jsx(Lu.Provider,{scope:t.__scopeMenu,children:r.jsx(Sn,{present:s||i.open,children:r.jsx(Lu.Slot,{scope:t.__scopeMenu,children:o.modal?r.jsx(cJ,{...a,ref:e}):r.jsx(dJ,{...a,ref:e})})})})}),cJ=f.forwardRef((t,e)=>{const n=tl(ss,t.__scopeMenu),s=f.useRef(null),a=yt(e,s);return f.useEffect(()=>{const i=s.current;if(i)return sp(i)},[]),r.jsx(gj,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:be(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),dJ=f.forwardRef((t,e)=>{const n=tl(ss,t.__scopeMenu);return r.jsx(gj,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),gj=f.forwardRef((t,e)=>{const{__scopeMenu:n,loop:s=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:m,onDismiss:p,disableOutsideScroll:b,...x}=t,g=tl(ss,n),y=wh(ss,n),v=mp(n),w=A3(n),j=nJ(n),[S,N]=f.useState(null),k=f.useRef(null),E=yt(e,k,g.onContentChange),P=f.useRef(0),A=f.useRef(""),C=f.useRef(0),T=f.useRef(null),I=f.useRef("right"),V=f.useRef(0),ne=b?mh:f.Fragment,se=b?{as:Ia,allowPinchZoom:!0}:void 0,q=F=>{var z,Y;const B=A.current+F,R=j().filter(ae=>!ae.disabled),D=document.activeElement,L=(z=R.find(ae=>ae.ref.current===D))==null?void 0:z.textValue,M=R.map(ae=>ae.textValue),X=jJ(M,B,L),K=(Y=R.find(ae=>ae.textValue===X))==null?void 0:Y.ref.current;(function ae(U){A.current=U,window.clearTimeout(P.current),U!==""&&(P.current=window.setTimeout(()=>ae(""),1e3))})(B),K&&setTimeout(()=>K.focus())};f.useEffect(()=>()=>window.clearTimeout(P.current),[]),np();const O=f.useCallback(F=>{var R,D;return I.current===((R=T.current)==null?void 0:R.side)&&NJ(F,(D=T.current)==null?void 0:D.area)},[]);return r.jsx(lJ,{scope:n,searchRef:A,onItemEnter:f.useCallback(F=>{O(F)&&F.preventDefault()},[O]),onItemLeave:f.useCallback(F=>{var B;O(F)||((B=k.current)==null||B.focus(),N(null))},[O]),onTriggerLeave:f.useCallback(F=>{O(F)&&F.preventDefault()},[O]),pointerGraceTimerRef:C,onPointerGraceIntentChange:f.useCallback(F=>{T.current=F},[]),children:r.jsx(ne,{...se,children:r.jsx(hh,{asChild:!0,trapped:a,onMountAutoFocus:be(i,F=>{var B;F.preventDefault(),(B=k.current)==null||B.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:r.jsx(Go,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:m,onDismiss:p,children:r.jsx(T4,{asChild:!0,...w,dir:y.dir,orientation:"vertical",loop:s,currentTabStopId:S,onCurrentTabStopIdChange:N,onEntryFocus:be(c,F=>{y.isUsingKeyboardRef.current||F.preventDefault()}),preventScrollOnEntryFocus:!0,children:r.jsx(D0,{role:"menu","aria-orientation":"vertical","data-state":Z3(g.open),"data-radix-menu-content":"",dir:y.dir,...v,...x,ref:E,style:{outline:"none",...x.style},onKeyDown:be(x.onKeyDown,F=>{const R=F.target.closest("[data-radix-menu-content]")===F.currentTarget,D=F.ctrlKey||F.altKey||F.metaKey,L=F.key.length===1;R&&(F.key==="Tab"&&F.preventDefault(),!D&&L&&q(F.key));const M=k.current;if(F.target!==M||!XY.includes(F.key))return;F.preventDefault();const K=j().filter(z=>!z.disabled).map(z=>z.ref.current);C3.includes(F.key)&&K.reverse(),bJ(K)}),onBlur:be(t.onBlur,F=>{F.currentTarget.contains(F.target)||(window.clearTimeout(P.current),A.current="")}),onPointerMove:be(t.onPointerMove,$u(F=>{const B=F.target,R=V.current!==F.clientX;if(F.currentTarget.contains(B)&&R){const D=F.clientX>V.current?"right":"left";I.current=D,V.current=F.clientX}}))})})})})})})});R3.displayName=ss;var uJ="MenuGroup",vj=f.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return r.jsx(Le.div,{role:"group",...s,ref:e})});vj.displayName=uJ;var hJ="MenuLabel",M3=f.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return r.jsx(Le.div,{...s,ref:e})});M3.displayName=hJ;var n0="MenuItem",B2="menu.itemSelect",fp=f.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:s,...a}=t,i=f.useRef(null),o=wh(n0,t.__scopeMenu),l=xj(n0,t.__scopeMenu),c=yt(e,i),d=f.useRef(!1),u=()=>{const h=i.current;if(!n&&h){const m=new CustomEvent(B2,{bubbles:!0,cancelable:!0});h.addEventListener(B2,p=>s==null?void 0:s(p),{once:!0}),kb(h,m),m.defaultPrevented?d.current=!1:o.onClose()}};return r.jsx(I3,{...a,ref:c,disabled:n,onClick:be(t.onClick,u),onPointerDown:h=>{var m;(m=t.onPointerDown)==null||m.call(t,h),d.current=!0},onPointerUp:be(t.onPointerUp,h=>{var m;d.current||(m=h.currentTarget)==null||m.click()}),onKeyDown:be(t.onKeyDown,h=>{const m=l.searchRef.current!=="";n||m&&h.key===" "||Dy.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});fp.displayName=n0;var I3=f.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:s=!1,textValue:a,...i}=t,o=xj(n0,n),l=A3(n),c=f.useRef(null),d=yt(e,c),[u,h]=f.useState(!1),[m,p]=f.useState("");return f.useEffect(()=>{const b=c.current;b&&p((b.textContent??"").trim())},[i.children]),r.jsx(Lu.ItemSlot,{scope:n,disabled:s,textValue:a??m,children:r.jsx(R4,{asChild:!0,...l,focusable:!s,children:r.jsx(Le.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:d,onPointerMove:be(t.onPointerMove,$u(b=>{s?o.onItemLeave(b):(o.onItemEnter(b),b.defaultPrevented||b.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:be(t.onPointerLeave,$u(b=>o.onItemLeave(b))),onFocus:be(t.onFocus,()=>h(!0)),onBlur:be(t.onBlur,()=>h(!1))})})})}),mJ="MenuCheckboxItem",O3=f.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:s,...a}=t;return r.jsx(z3,{scope:t.__scopeMenu,checked:n,children:r.jsx(fp,{role:"menuitemcheckbox","aria-checked":r0(n)?"mixed":n,...a,ref:e,"data-state":bj(n),onSelect:be(a.onSelect,()=>s==null?void 0:s(r0(n)?!0:!n),{checkForDefaultPrevented:!1})})})});O3.displayName=mJ;var F3="MenuRadioGroup",[fJ,pJ]=el(F3,{value:void 0,onValueChange:()=>{}}),B3=f.forwardRef((t,e)=>{const{value:n,onValueChange:s,...a}=t,i=nn(s);return r.jsx(fJ,{scope:t.__scopeMenu,value:n,onValueChange:i,children:r.jsx(vj,{...a,ref:e})})});B3.displayName=F3;var L3="MenuRadioItem",$3=f.forwardRef((t,e)=>{const{value:n,...s}=t,a=pJ(L3,t.__scopeMenu),i=n===a.value;return r.jsx(z3,{scope:t.__scopeMenu,checked:i,children:r.jsx(fp,{role:"menuitemradio","aria-checked":i,...s,ref:e,"data-state":bj(i),onSelect:be(s.onSelect,()=>{var o;return(o=a.onValueChange)==null?void 0:o.call(a,n)},{checkForDefaultPrevented:!1})})})});$3.displayName=L3;var yj="MenuItemIndicator",[z3,xJ]=el(yj,{checked:!1}),U3=f.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:s,...a}=t,i=xJ(yj,n);return r.jsx(Sn,{present:s||r0(i.checked)||i.checked===!0,children:r.jsx(Le.span,{...a,ref:e,"data-state":bj(i.checked)})})});U3.displayName=yj;var gJ="MenuSeparator",q3=f.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t;return r.jsx(Le.div,{role:"separator","aria-orientation":"horizontal",...s,ref:e})});q3.displayName=gJ;var vJ="MenuArrow",W3=f.forwardRef((t,e)=>{const{__scopeMenu:n,...s}=t,a=mp(n);return r.jsx(P0,{...a,...s,ref:e})});W3.displayName=vJ;var yJ="MenuSub",[zee,H3]=el(yJ),Ed="MenuSubTrigger",V3=f.forwardRef((t,e)=>{const n=tl(Ed,t.__scopeMenu),s=wh(Ed,t.__scopeMenu),a=H3(Ed,t.__scopeMenu),i=xj(Ed,t.__scopeMenu),o=f.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,d={__scopeMenu:t.__scopeMenu},u=f.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return f.useEffect(()=>u,[u]),f.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),r.jsx(fj,{asChild:!0,...d,children:r.jsx(I3,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":Z3(n.open),...t,ref:w0(e,a.onTriggerChange),onClick:h=>{var m;(m=t.onClick)==null||m.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:be(t.onPointerMove,$u(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:be(t.onPointerLeave,$u(h=>{var p,b;u();const m=(p=n.content)==null?void 0:p.getBoundingClientRect();if(m){const x=(b=n.content)==null?void 0:b.dataset.side,g=x==="right",y=g?-5:5,v=m[g?"left":"right"],w=m[g?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+y,y:h.clientY},{x:v,y:m.top},{x:w,y:m.top},{x:w,y:m.bottom},{x:v,y:m.bottom}],side:x}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:be(t.onKeyDown,h=>{var p;const m=i.searchRef.current!=="";t.disabled||m&&h.key===" "||eJ[s.dir].includes(h.key)&&(n.onOpenChange(!0),(p=n.content)==null||p.focus(),h.preventDefault())})})})});V3.displayName=Ed;var K3="MenuSubContent",G3=f.forwardRef((t,e)=>{const n=P3(ss,t.__scopeMenu),{forceMount:s=n.forceMount,...a}=t,i=tl(ss,t.__scopeMenu),o=wh(ss,t.__scopeMenu),l=H3(K3,t.__scopeMenu),c=f.useRef(null),d=yt(e,c);return r.jsx(Lu.Provider,{scope:t.__scopeMenu,children:r.jsx(Sn,{present:s||i.open,children:r.jsx(Lu.Slot,{scope:t.__scopeMenu,children:r.jsx(gj,{id:l.contentId,"aria-labelledby":l.triggerId,...a,ref:d,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:be(t.onFocusOutside,u=>{u.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:be(t.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:be(t.onKeyDown,u=>{var p;const h=u.currentTarget.contains(u.target),m=tJ[o.dir].includes(u.key);h&&m&&(i.onOpenChange(!1),(p=l.trigger)==null||p.focus(),u.preventDefault())})})})})})});G3.displayName=K3;function Z3(t){return t?"open":"closed"}function r0(t){return t==="indeterminate"}function bj(t){return r0(t)?"indeterminate":t?"checked":"unchecked"}function bJ(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function wJ(t,e){return t.map((n,s)=>t[(e+s)%t.length])}function jJ(t,e,n){const a=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=wJ(t,Math.max(i,0));a.length===1&&(o=o.filter(d=>d!==n));const c=o.find(d=>d.toLowerCase().startsWith(a.toLowerCase()));return c!==n?c:void 0}function _J(t,e){const{x:n,y:s}=t;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const l=e[i].x,c=e[i].y,d=e[o].x,u=e[o].y;c>s!=u>s&&n<(d-l)*(s-c)/(u-c)+l&&(a=!a)}return a}function NJ(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return _J(n,e)}function $u(t){return e=>e.pointerType==="mouse"?t(e):void 0}var SJ=D3,kJ=fj,CJ=T3,EJ=R3,AJ=vj,DJ=M3,PJ=fp,TJ=O3,RJ=B3,MJ=$3,IJ=U3,OJ=q3,FJ=W3,BJ=V3,LJ=G3,wj="DropdownMenu",[$J,Uee]=Zr(wj,[E3]),mr=E3(),[zJ,Q3]=$J(wj),Y3=t=>{const{__scopeDropdownMenu:e,children:n,dir:s,open:a,defaultOpen:i,onOpenChange:o,modal:l=!0}=t,c=mr(e),d=f.useRef(null),[u=!1,h]=os({prop:a,defaultProp:i,onChange:o});return r.jsx(zJ,{scope:e,triggerId:Lr(),triggerRef:d,contentId:Lr(),open:u,onOpenChange:h,onOpenToggle:f.useCallback(()=>h(m=>!m),[h]),modal:l,children:r.jsx(SJ,{...c,open:u,onOpenChange:h,dir:s,modal:l,children:n})})};Y3.displayName=wj;var J3="DropdownMenuTrigger",X3=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:s=!1,...a}=t,i=Q3(J3,n),o=mr(n);return r.jsx(kJ,{asChild:!0,...o,children:r.jsx(Le.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...a,ref:w0(e,i.triggerRef),onPointerDown:be(t.onPointerDown,l=>{!s&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:be(t.onKeyDown,l=>{s||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});X3.displayName=J3;var UJ="DropdownMenuPortal",eR=t=>{const{__scopeDropdownMenu:e,...n}=t,s=mr(e);return r.jsx(CJ,{...s,...n})};eR.displayName=UJ;var tR="DropdownMenuContent",nR=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=Q3(tR,n),i=mr(n),o=f.useRef(!1);return r.jsx(EJ,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...s,ref:e,onCloseAutoFocus:be(t.onCloseAutoFocus,l=>{var c;o.current||(c=a.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:be(t.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;(!a.modal||u)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});nR.displayName=tR;var qJ="DropdownMenuGroup",WJ=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=mr(n);return r.jsx(AJ,{...a,...s,ref:e})});WJ.displayName=qJ;var HJ="DropdownMenuLabel",rR=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=mr(n);return r.jsx(DJ,{...a,...s,ref:e})});rR.displayName=HJ;var VJ="DropdownMenuItem",sR=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=mr(n);return r.jsx(PJ,{...a,...s,ref:e})});sR.displayName=VJ;var KJ="DropdownMenuCheckboxItem",aR=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=mr(n);return r.jsx(TJ,{...a,...s,ref:e})});aR.displayName=KJ;var GJ="DropdownMenuRadioGroup",ZJ=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=mr(n);return r.jsx(RJ,{...a,...s,ref:e})});ZJ.displayName=GJ;var QJ="DropdownMenuRadioItem",iR=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=mr(n);return r.jsx(MJ,{...a,...s,ref:e})});iR.displayName=QJ;var YJ="DropdownMenuItemIndicator",oR=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=mr(n);return r.jsx(IJ,{...a,...s,ref:e})});oR.displayName=YJ;var JJ="DropdownMenuSeparator",lR=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=mr(n);return r.jsx(OJ,{...a,...s,ref:e})});lR.displayName=JJ;var XJ="DropdownMenuArrow",eX=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=mr(n);return r.jsx(FJ,{...a,...s,ref:e})});eX.displayName=XJ;var tX="DropdownMenuSubTrigger",cR=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=mr(n);return r.jsx(BJ,{...a,...s,ref:e})});cR.displayName=tX;var nX="DropdownMenuSubContent",dR=f.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...s}=t,a=mr(n);return r.jsx(LJ,{...a,...s,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});dR.displayName=nX;var rX=Y3,sX=X3,aX=eR,uR=nR,hR=rR,mR=sR,fR=aR,pR=iR,xR=oR,gR=lR,vR=cR,yR=dR;const iX=rX,oX=sX,lX=f.forwardRef(({className:t,inset:e,children:n,...s},a)=>r.jsxs(vR,{ref:a,className:_e("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",t),...s,children:[n,r.jsx(Co,{className:"ml-auto h-4 w-4"})]}));lX.displayName=vR.displayName;const cX=f.forwardRef(({className:t,...e},n)=>r.jsx(yR,{ref:n,className:_e("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));cX.displayName=yR.displayName;const bR=f.forwardRef(({className:t,sideOffset:e=4,...n},s)=>r.jsx(aX,{children:r.jsx(uR,{ref:s,sideOffset:e,className:_e("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));bR.displayName=uR.displayName;const Vm=f.forwardRef(({className:t,inset:e,...n},s)=>r.jsx(mR,{ref:s,className:_e("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",t),...n}));Vm.displayName=mR.displayName;const dX=f.forwardRef(({className:t,children:e,checked:n,...s},a)=>r.jsxs(fR,{ref:a,className:_e("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...s,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(xR,{children:r.jsx(Xu,{className:"h-4 w-4"})})}),e]}));dX.displayName=fR.displayName;const uX=f.forwardRef(({className:t,children:e,...n},s)=>r.jsxs(pR,{ref:s,className:_e("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(xR,{children:r.jsx(j8,{className:"h-2 w-2 fill-current"})})}),e]}));uX.displayName=pR.displayName;const hX=f.forwardRef(({className:t,inset:e,...n},s)=>r.jsx(hR,{ref:s,className:_e("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));hX.displayName=hR.displayName;const mX=f.forwardRef(({className:t,...e},n)=>r.jsx(gR,{ref:n,className:_e("-mx-1 my-1 h-px bg-muted",t),...e}));mX.displayName=gR.displayName;function fX(){const{theme:t,setTheme:e,actualTheme:n}=k3();return r.jsxs(iX,{children:[r.jsx(oX,{asChild:!0,children:r.jsxs(W,{variant:"outline",size:"sm",className:"relative border-border/40 bg-background/80 backdrop-blur-sm hover:bg-accent/80 transition-all duration-200",children:[r.jsx(gv,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),r.jsx(pv,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),r.jsx("span",{className:"sr-only",children:"Theme wechseln"})]})}),r.jsxs(bR,{align:"end",className:"w-48 bg-background/95 backdrop-blur-sm border-border/40 shadow-lg",children:[r.jsxs(Vm,{onClick:()=>e("light"),className:`flex items-center gap-2 cursor-pointer ${t==="light"?"bg-accent text-accent-foreground":""}`,children:[r.jsx(gv,{className:"h-4 w-4"}),r.jsx("span",{children:"Hell"}),t==="light"&&r.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),r.jsxs(Vm,{onClick:()=>e("dark"),className:`flex items-center gap-2 cursor-pointer ${t==="dark"?"bg-accent text-accent-foreground":""}`,children:[r.jsx(pv,{className:"h-4 w-4"}),r.jsx("span",{children:"Dunkel"}),t==="dark"&&r.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),r.jsxs(Vm,{onClick:()=>e("system"),className:`flex items-center gap-2 cursor-pointer ${t==="system"?"bg-accent text-accent-foreground":""}`,children:[r.jsx(T8,{className:"h-4 w-4"}),r.jsx("span",{children:"System"}),t==="system"&&r.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]})]})]})}function pX(){const{actualTheme:t,setTheme:e}=k3(),n=()=>{e(t==="light"?"dark":"light")};return r.jsxs(W,{variant:"ghost",size:"sm",onClick:n,className:"relative h-9 w-9 p-0 rounded-full hover:bg-accent/80 transition-all duration-300 ease-out",children:[r.jsxs("div",{className:"relative h-4 w-4",children:[r.jsx(gv,{className:"absolute h-4 w-4 rotate-0 scale-100 transition-all duration-300 dark:-rotate-90 dark:scale-0"}),r.jsx(pv,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all duration-300 dark:rotate-0 dark:scale-100"})]}),r.jsx("span",{className:"sr-only",children:"Theme wechseln"})]})}const xX=()=>{var d;const{user:t,userRole:e,loading:n,signOut:s}=za(),a=Yi(),[i,o]=f.useState("dashboard"),l=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768;if(f.useEffect(()=>{n||(t?e==="employee"?a("/employee"):e==="manager"&&l()&&Ks({title:"Mobile Gerät erkannt",description:"Für die beste Erfahrung verwenden Sie die Employee-App"}):a("/login"))},[t,e,n]),n)return r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!t||e==="employee"||e!=="manager")return null;const c=()=>{switch(i){case"customers":return r.jsx(mV,{});case"projects":return r.jsx(AQ,{});case"personal":return r.jsx(qQ,{});case"materials":return r.jsx(VQ,{});case"machines":return r.jsx(JQ,{});case"emails":return r.jsx(VY,{});case"documents":return r.jsx(AY,{});case"invoice-validation":return r.jsx(DY,{});case"finance":return r.jsx(XQ,{});case"planner":return r.jsx(rY,{});case"timetracking":return r.jsx(bY,{});case"vacation":return r.jsx(KY,{});case"company-settings":return r.jsx(PY,{});default:return r.jsx(QY,{onNavigate:o})}};return r.jsxs("div",{className:"min-h-screen w-full bg-gray-50",children:[r.jsx(j9,{activeModule:i,onModuleChange:o}),r.jsxs("div",{className:"ml-16 lg:ml-16 flex flex-col min-h-screen",children:[r.jsx("header",{className:"h-20 border-b border-white/20 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl sticky top-0 z-30 shadow-lg shadow-blue-500/10",children:r.jsxs("div",{className:"flex items-center justify-between h-full px-8",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("img",{src:"/handwerkos-logo.svg",alt:"HandwerkOS Logo",className:"h-10 w-10 object-contain"}),r.jsx("h1",{className:"font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent text-3xl",children:"HandwerkOS"})]}),r.jsx(Ae,{variant:"secondary",className:"hidden sm:inline-flex bg-gradient-to-r from-blue-100 to-indigo-100 text-blue-700 border-0 shadow-sm",children:"Manager Dashboard"})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx(fX,{}),r.jsxs(W,{variant:"outline",size:"sm",onClick:()=>a("/employee"),className:"hidden sm:flex bg-white/50 hover:bg-white/80 border-white/30 backdrop-blur-sm shadow-lg transition-all duration-200 hover:scale-105",children:[r.jsx(th,{className:"w-4 h-4 mr-2"}),"Mitarbeiter-Ansicht"]}),r.jsxs("div",{className:"flex items-center space-x-2 text-sm text-slate-600 dark:text-slate-300 bg-white/30 dark:bg-slate-800/30 px-3 py-2 rounded-full backdrop-blur-sm",children:[r.jsx(Ps,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline font-medium",children:((d=t==null?void 0:t.email)==null?void 0:d.split("@")[0])||"Admin"})]})]})]})}),r.jsx("main",{className:"flex-1 overflow-auto",children:c()})]})]})},L2=()=>{const[t,e]=f.useState(!0),[n,s]=f.useState(!1),[a,i]=f.useState(""),[o,l]=f.useState(""),[c,d]=f.useState(""),[u,h]=f.useState(""),[m,p]=f.useState(""),[b,x]=f.useState(""),[g,y]=f.useState(""),[v,w]=f.useState(""),[j,S]=f.useState(""),[N,k]=f.useState(""),[E,P]=f.useState("Deutschland"),[A,C]=f.useState(""),[T,I]=f.useState(""),[V,ne]=f.useState(""),[se,q]=f.useState(!1),{signIn:O,signUp:F,updatePassword:B}=tw(),R=Yi(),[D]=Zb();f.useEffect(()=>{(async()=>{console.log("Current URL:",window.location.href),console.log("Search params:",window.location.search);const X=D.get("mode"),K=D.get("token");if(console.log("Auth check:",{mode:X,inviteToken:K}),X==="employee-setup"&&K){console.log("Processing employee invitation token:",K);try{const{data:z,error:Y}=await $.from("employee_invitations").select("*").eq("invite_token",K).eq("status","pending").single();if(Y||!z){console.error("Invalid invitation token:",Y),ft.error("Ungültiger oder abgelaufener Einladungslink. Bitte wenden Sie sich an Ihren Manager.");return}if(new Date(z.expires_at)<new Date){console.error("Invitation token expired"),ft.error("Dieser Einladungslink ist abgelaufen. Bitte fordern Sie eine neue Einladung an.");return}console.log("Valid invitation found:",z),i(z.email),s(!0),window.invitationData=z}catch(z){console.error("Error validating invitation:",z),ft.error("Fehler beim Validieren der Einladung.")}}else X==="employee-setup"&&!K&&ft.error("Fehlender Einladungstoken. Bitte verwenden Sie den vollständigen Link aus der E-Mail.")})()},[D]);const L=async M=>{var X,K;M.preventDefault(),q(!0);try{if(n){const ae=window.invitationData;if(!ae){ft.error("Einladungsdaten nicht gefunden. Bitte verwenden Sie den Link aus der E-Mail erneut."),s(!1);return}if(o!==c){ft.error("Passwörter stimmen nicht überein");return}if(o.length<6){ft.error("Passwort muss mindestens 6 Zeichen lang sein");return}console.log("Creating account for employee:",ae.email);try{const{data:U,error:Q}=await $.auth.signUp({email:ae.email,password:o,options:{data:{first_name:((X=ae.employee_data)==null?void 0:X.firstName)||"",last_name:((K=ae.employee_data)==null?void 0:K.lastName)||"",company_id:ae.company_id}}});if(Q){console.error("Error creating user account:",Q),ft.error(Q.message||"Fehler beim Erstellen des Kontos");return}U.user&&(await $.from("employee_invitations").update({status:"accepted"}).eq("invite_token",ae.invite_token),await $.from("user_roles").insert({user_id:U.user.id,role:"employee"}),console.log("Employee account created successfully"),ft.success("Konto erfolgreich erstellt! Sie können sich jetzt anmelden."),s(!1),e(!0),l(""),d(""))}catch(U){console.error("Error during employee registration:",U),ft.error("Fehler beim Erstellen des Kontos")}return}if(t){const{error:ae}=await O(a,o);ae?ft.error(ae.message):R("/manager");return}if(o.length<6){ft.error("Passwort muss mindestens 6 Zeichen lang sein");return}if(o!==c){ft.error("Passwörter stimmen nicht überein");return}const z={firstName:u,lastName:m,companyName:b,phone:g,streetAddress:v,postalCode:j,city:N,country:E,vatId:A,voucherCode:T,referralSource:V},{error:Y}=await F(a,o,z);Y?ft.error(Y.message):ft.success("Registrierung erfolgreich! Bitte bestätigen Sie Ihre E-Mail.")}finally{q(!1)}};return r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50",children:[r.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-center gap-3",children:[r.jsx("img",{src:"/handwerkos-logo.svg",alt:"HandwerkOS Logo",className:"h-12 w-12 object-contain"}),r.jsx("h1",{className:"text-3xl font-bold tracking-wide",children:"HandwerkOS"})]}),r.jsx("p",{className:"text-center text-blue-100 mt-2 text-sm",children:"Die moderne Software-Lösung für Handwerksbetriebe"})]}),r.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-120px)] p-4",children:r.jsxs(J,{className:"w-full max-w-2xl shadow-xl border-0 bg-white/80 backdrop-blur-sm",children:[r.jsxs(pe,{className:"text-center space-y-4 pb-8",children:[r.jsx(xe,{className:"flex items-center justify-center gap-3 text-2xl font-bold text-gray-800",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:r.jsx(K_,{className:"h-6 w-6 text-blue-600"})}),"Passwort erstellen"]}):t?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:r.jsx(Ps,{className:"h-6 w-6 text-green-600"})}),"Anmeldung"]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"p-2 bg-orange-100 rounded-full",children:r.jsx(G_,{className:"h-6 w-6 text-orange-600"})}),"Registrierung"]})}),r.jsx(Jn,{className:"text-base text-gray-600",children:n?"Erstellen Sie Ihr Passwort für Ihren HandwerkOS Account":t?"Willkommen zurück! Melden Sie sich in Ihrem HandwerkOS Account an":"Starten Sie jetzt mit HandwerkOS und digitalisieren Sie Ihren Betrieb"})]}),r.jsx(te,{children:r.jsxs("form",{onSubmit:L,className:"space-y-4",children:[n?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"password",children:"Neues Passwort"}),r.jsx(G,{id:"password",type:"password",value:o,onChange:M=>l(M.target.value),required:!0,placeholder:"Mindestens 6 Zeichen"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"confirmPassword",children:"Passwort bestätigen"}),r.jsx(G,{id:"confirmPassword",type:"password",value:c,onChange:M=>d(M.target.value),required:!0,placeholder:"Passwort wiederholen"})]})]}):t?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"email",children:"E-Mail"}),r.jsx(G,{id:"email",type:"email",value:a,onChange:M=>i(M.target.value),required:!0,placeholder:"ihre@email.de"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"password",children:"Passwort"}),r.jsx(G,{id:"password",type:"password",value:o,onChange:M=>l(M.target.value),required:!0,placeholder:"Ihr Passwort"})]})]}):r.jsx(r.Fragment,{children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Persönliche Daten"}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"firstName",children:"Vorname *"}),r.jsx(G,{id:"firstName",type:"text",value:u,onChange:M=>h(M.target.value),required:!0,placeholder:"Ihr Vorname"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"lastName",children:"Nachname *"}),r.jsx(G,{id:"lastName",type:"text",value:m,onChange:M=>p(M.target.value),required:!0,placeholder:"Ihr Nachname"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"email",children:"E-Mail *"}),r.jsx(G,{id:"email",type:"email",value:a,onChange:M=>i(M.target.value),required:!0,placeholder:"ihre@email.de"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"phone",children:"Telefon"}),r.jsx(G,{id:"phone",type:"tel",value:g,onChange:M=>y(M.target.value),placeholder:"+49 123 456789"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Firmendaten"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"companyName",children:"Firmenname *"}),r.jsx(G,{id:"companyName",type:"text",value:b,onChange:M=>x(M.target.value),required:!0,placeholder:"Ihre Firma"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"vatId",children:"USt-IdNr."}),r.jsx(G,{id:"vatId",type:"text",value:A,onChange:M=>C(M.target.value),placeholder:"DE123456789"})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Zusätzliche Angaben (optional)"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"voucherCode",children:"Gutscheincode"}),r.jsx(G,{id:"voucherCode",type:"text",value:T,onChange:M=>I(M.target.value),placeholder:"Falls vorhanden"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"referralSource",children:"Wie haben Sie von uns erfahren?"}),r.jsxs(tt,{value:V,onValueChange:ne,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Bitte auswählen"})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Google",children:"Google"}),r.jsx(ce,{value:"Social Media",children:"Social Media"}),r.jsx(ce,{value:"Empfehlung",children:"Empfehlung"}),r.jsx(ce,{value:"Werbung",children:"Werbung"}),r.jsx(ce,{value:"Messe",children:"Messe"}),r.jsx(ce,{value:"Sonstiges",children:"Sonstiges"})]})]})]})]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Adresse"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"streetAddress",children:"Straße & Hausnummer"}),r.jsx(G,{id:"streetAddress",type:"text",value:v,onChange:M=>w(M.target.value),placeholder:"Musterstraße 123"})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"postalCode",children:"PLZ"}),r.jsx(G,{id:"postalCode",type:"text",value:j,onChange:M=>S(M.target.value),placeholder:"12345"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"city",children:"Stadt"}),r.jsx(G,{id:"city",type:"text",value:N,onChange:M=>k(M.target.value),placeholder:"Musterstadt"})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"country",children:"Land"}),r.jsxs(tt,{value:E,onValueChange:P,children:[r.jsx(Je,{children:r.jsx(nt,{placeholder:"Land auswählen"})}),r.jsxs(Xe,{children:[r.jsx(ce,{value:"Deutschland",children:"Deutschland"}),r.jsx(ce,{value:"Österreich",children:"Österreich"}),r.jsx(ce,{value:"Schweiz",children:"Schweiz"}),r.jsx(ce,{value:"Niederlande",children:"Niederlande"}),r.jsx(ce,{value:"Belgien",children:"Belgien"}),r.jsx(ce,{value:"Frankreich",children:"Frankreich"})]})]})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Passwort"}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"password",children:"Passwort *"}),r.jsx(G,{id:"password",type:"password",value:o,onChange:M=>l(M.target.value),required:!0,placeholder:"Mindestens 6 Zeichen"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"confirmPassword",children:"Passwort bestätigen *"}),r.jsx(G,{id:"confirmPassword",type:"password",value:c,onChange:M=>d(M.target.value),required:!0,placeholder:"Passwort wiederholen"})]})]}),r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(aa,{id:"terms",required:!0}),r.jsxs(H,{htmlFor:"terms",className:"text-sm",children:["Ich stimme den"," ",r.jsx("a",{href:"#",className:"text-primary underline hover:no-underline",onClick:M=>M.preventDefault(),children:"Allgemeinen Geschäftsbedingungen"})," ","und der"," ",r.jsx("a",{href:"#",className:"text-primary underline hover:no-underline",onClick:M=>M.preventDefault(),children:"Datenschutzerklärung"})," ","zu *"]})]})})]})]})}),r.jsx(W,{type:"submit",className:"w-full h-12 text-lg font-semibold bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 shadow-lg hover:shadow-xl transition-all duration-200",disabled:se,children:se?r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),n?"Wird erstellt...":t?"Wird angemeldet...":"Wird registriert..."]}):n?r.jsxs(r.Fragment,{children:[r.jsx(K_,{className:"h-5 w-5 mr-2"}),"Passwort erstellen"]}):t?r.jsxs(r.Fragment,{children:[r.jsx(Ps,{className:"h-5 w-5 mr-2"}),"Jetzt anmelden"]}):r.jsxs(r.Fragment,{children:[r.jsx(G_,{className:"h-5 w-5 mr-2"}),"Kostenlos registrieren"]})}),!n&&r.jsx("div",{className:"text-center pt-4 border-t",children:r.jsx(W,{type:"button",variant:"ghost",onClick:()=>e(!t),className:"text-sm text-gray-600 hover:text-blue-600 font-medium",children:t?"Noch kein Account? Jetzt kostenlos registrieren":"Bereits registriert? Zur Anmeldung"})})]})})]})}),r.jsxs("div",{className:"text-center pb-6",children:[r.jsx("p",{className:"text-sm text-gray-500",children:"© 2024 HandwerkOS - Die digitale Zukunft des Handwerks"}),r.jsxs("div",{className:"flex justify-center gap-6 mt-2 text-xs text-gray-400",children:[r.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Datenschutz"}),r.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Impressum"}),r.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Support"})]})]})]})};class gX{constructor(){En(this,"registration",null);En(this,"subscription",null);En(this,"isSupported");this.isSupported="serviceWorker"in navigator&&"PushManager"in window}async initialize(){if(!this.isSupported)return console.warn("Push Notifications werden nicht unterstützt"),!1;try{return this.registration=await navigator.serviceWorker.register("/service-worker.js"),console.log("Service Worker registriert:",this.registration),await navigator.serviceWorker.ready,!0}catch(e){return console.error("Service Worker Registrierung fehlgeschlagen:",e),!1}}async requestPermission(){if(!this.isSupported)return"denied";const e=await Notification.requestPermission();return console.log("Notification Permission:",e),e}async subscribeToPush(){if(!this.registration)return console.error("Service Worker nicht registriert"),null;try{const e=this.urlB64ToUint8Array("BNXzx_QQW9jiYQKnZ8QGfxp2YR4QTHVr5MiOZlJ8dZFjkPJr8J9rVgEoTz5pXbJxJ5rJ8pXQrJ8VGHJrXzPQrJs");return this.subscription=await this.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e}),console.log("Push Subscription erfolgreich:",this.subscription),await this.sendSubscriptionToServer(this.subscription),this.subscription}catch(e){return console.error("Push Subscription fehlgeschlagen:",e),null}}async sendSubscriptionToServer(e){try{if(!(await fetch("/api/push/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:e.toJSON(),userId:this.getCurrentUserId(),deviceInfo:this.getDeviceInfo()})})).ok)throw new Error("Subscription konnte nicht gespeichert werden");console.log("Push Subscription an Server gesendet")}catch(n){console.error("Fehler beim Senden der Subscription:",n),localStorage.setItem("pushSubscription",JSON.stringify(e.toJSON()))}}async unsubscribeFromPush(){if(!this.subscription)return!0;try{const e=await this.subscription.unsubscribe();return e&&(await fetch("/api/push/unsubscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:this.getCurrentUserId()})}),this.subscription=null,localStorage.removeItem("pushSubscription")),e}catch(e){return console.error("Unsubscribe fehlgeschlagen:",e),!1}}async requestBackgroundSync(){if(!this.registration||!("sync"in this.registration)){console.warn("Background Sync wird nicht unterstützt");return}try{await this.registration.sync.register("background-sync"),console.log("Background Sync registriert")}catch(e){console.error("Background Sync Registrierung fehlgeschlagen:",e)}}async requestPeriodicBackgroundSync(){if(!this.registration||!("periodicSync"in this.registration)){console.warn("Periodic Background Sync wird nicht unterstützt");return}try{await this.registration.periodicSync.register("periodic-background-sync",{minInterval:24*60*60*1e3}),console.log("Periodic Background Sync registriert")}catch(e){console.error("Periodic Background Sync Registrierung fehlgeschlagen:",e)}}async showLocalNotification(e){var s;if(!this.registration){console.error("Service Worker nicht verfügbar für lokale Benachrichtigung");return}const n={body:e.body,icon:e.icon||"/icons/icon-192x192.png",badge:e.badge||"/icons/badge-72x72.png",data:e.data,requireInteraction:e.requireInteraction,silent:e.silent,tag:((s=e.data)==null?void 0:s.type)||"default"};await this.registration.showNotification(e.title,n)}getCurrentUserId(){return localStorage.getItem("supabase.auth.token")||"anonymous"}getDeviceInfo(){return{userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,hardwareConcurrency:navigator.hardwareConcurrency,maxTouchPoints:navigator.maxTouchPoints,screen:{width:screen.width,height:screen.height,colorDepth:screen.colorDepth}}}urlB64ToUint8Array(e){const n="=".repeat((4-e.length%4)%4),s=(e+n).replace(/\-/g,"+").replace(/_/g,"/"),a=window.atob(s),i=new Uint8Array(a.length);for(let o=0;o<a.length;++o)i[o]=a.charCodeAt(o);return i}get isSubscribed(){return this.subscription!==null}get hasPermission(){return Notification.permission==="granted"}get canReceiveNotifications(){return this.isSupported&&this.hasPermission&&this.isSubscribed}}const gg={projectAssigned:(t,e)=>({title:"Neues Projekt zugewiesen",body:`Sie wurden dem Projekt "${t}" zugewiesen${e?` (Fällig: ${e})`:""}`,data:{type:"project_assigned",priority:"high"},requireInteraction:!0,actions:[{action:"view",title:"Anzeigen",icon:"/icons/view.png"},{action:"dismiss",title:"Später",icon:"/icons/dismiss.png"}]}),urgentProject:t=>({title:"Dringendes Projekt!",body:`"${t}" erfordert sofortige Aufmerksamkeit`,data:{type:"project_updated",priority:"urgent"},requireInteraction:!0,actions:[{action:"call",title:"Anrufen",icon:"/icons/call.png"},{action:"navigate",title:"Route",icon:"/icons/navigate.png"}]}),timeReminder:()=>({title:"Zeiterfassung",body:"Vergessen Sie nicht, Ihre Arbeitszeit zu erfassen!",data:{type:"reminder",priority:"normal"},silent:!0,actions:[{action:"start_timer",title:"Timer starten",icon:"/icons/timer.png"},{action:"dismiss",title:"Später",icon:"/icons/dismiss.png"}]}),syncComplete:t=>({title:"Synchronisation abgeschlossen",body:`${t} Einträge wurden erfolgreich synchronisiert`,data:{type:"message",priority:"low"},silent:!0})},pr=new gX;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",t=>{t.data&&t.data.type==="SYNC_OFFLINE_DATA"&&(console.log("Service Worker fordert Daten-Sync an"),window.dispatchEvent(new CustomEvent("sync-offline-data",{detail:{timestamp:t.data.timestamp}})))});typeof window<"u"&&pr.initialize().then(t=>{t&&console.log("Push Notification Service initialisiert")});class vX{constructor(){En(this,"dbName","HandwerkOSEmployeeApp");En(this,"version",1);En(this,"db",null)}async initDB(){return new Promise((e,n)=>{const s=indexedDB.open(this.dbName,this.version);s.onerror=()=>n(s.error),s.onsuccess=()=>{this.db=s.result,e()},s.onupgradeneeded=a=>{const i=a.target.result;if(!i.objectStoreNames.contains("timeEntries")){const o=i.createObjectStore("timeEntries",{keyPath:"id"});o.createIndex("projectId","projectId",{unique:!1}),o.createIndex("employeeId","employeeId",{unique:!1}),o.createIndex("synced","synced",{unique:!1}),o.createIndex("createdAt","createdAt",{unique:!1})}if(!i.objectStoreNames.contains("materialEntries")){const o=i.createObjectStore("materialEntries",{keyPath:"id"});o.createIndex("projectId","projectId",{unique:!1}),o.createIndex("employeeId","employeeId",{unique:!1}),o.createIndex("synced","synced",{unique:!1}),o.createIndex("createdAt","createdAt",{unique:!1})}if(!i.objectStoreNames.contains("photos")){const o=i.createObjectStore("photos",{keyPath:"id"});o.createIndex("projectId","projectId",{unique:!1}),o.createIndex("employeeId","employeeId",{unique:!1}),o.createIndex("synced","synced",{unique:!1}),o.createIndex("createdAt","createdAt",{unique:!1})}i.objectStoreNames.contains("settings")||i.createObjectStore("settings",{keyPath:"key"})}})}async saveTimeEntry(e){return this.db||await this.initDB(),new Promise((n,s)=>{const o=this.db.transaction(["timeEntries"],"readwrite").objectStore("timeEntries").put(e);o.onsuccess=()=>n(),o.onerror=()=>s(o.error)})}async getTimeEntries(e){return this.db||await this.initDB(),new Promise((n,s)=>{const l=this.db.transaction(["timeEntries"],"readonly").objectStore("timeEntries").index("employeeId").getAll(e);l.onsuccess=()=>n(l.result||[]),l.onerror=()=>s(l.error)})}async getUnsyncedTimeEntries(){return this.db||await this.initDB(),new Promise((e,n)=>{const o=this.db.transaction(["timeEntries"],"readonly").objectStore("timeEntries").index("synced").getAll(!1);o.onsuccess=()=>e(o.result||[]),o.onerror=()=>n(o.error)})}async markTimeEntrySynced(e){return this.db||await this.initDB(),new Promise((n,s)=>{const i=this.db.transaction(["timeEntries"],"readwrite").objectStore("timeEntries"),o=i.get(e);o.onsuccess=()=>{const l=o.result;if(l){l.synced=!0,l.updatedAt=new Date().toISOString();const c=i.put(l);c.onsuccess=()=>n(),c.onerror=()=>s(c.error)}else s(new Error("Time entry not found"))},o.onerror=()=>s(o.error)})}async saveMaterialEntry(e){return this.db||await this.initDB(),new Promise((n,s)=>{const o=this.db.transaction(["materialEntries"],"readwrite").objectStore("materialEntries").put(e);o.onsuccess=()=>n(),o.onerror=()=>s(o.error)})}async getMaterialEntries(e){return this.db||await this.initDB(),new Promise((n,s)=>{const l=this.db.transaction(["materialEntries"],"readonly").objectStore("materialEntries").index("employeeId").getAll(e);l.onsuccess=()=>n(l.result||[]),l.onerror=()=>s(l.error)})}async getUnsyncedMaterialEntries(){return this.db||await this.initDB(),new Promise((e,n)=>{const o=this.db.transaction(["materialEntries"],"readonly").objectStore("materialEntries").index("synced").getAll(!1);o.onsuccess=()=>e(o.result||[]),o.onerror=()=>n(o.error)})}async savePhoto(e){return this.db||await this.initDB(),new Promise((n,s)=>{const o=this.db.transaction(["photos"],"readwrite").objectStore("photos").put(e);o.onsuccess=()=>n(),o.onerror=()=>s(o.error)})}async getUnsyncedPhotos(){return this.db||await this.initDB(),new Promise((e,n)=>{const o=this.db.transaction(["photos"],"readonly").objectStore("photos").index("synced").getAll(!1);o.onsuccess=()=>e(o.result||[]),o.onerror=()=>n(o.error)})}async getOfflineDataSummary(){const[e,n,s]=await Promise.all([this.getUnsyncedTimeEntries(),this.getUnsyncedMaterialEntries(),this.getUnsyncedPhotos()]),a=e.length*.5,i=n.length*.3,o=s.reduce((d,u)=>d+u.data.length*.75/1024,0),l=a+i+o,c=l>1024?`${(l/1024).toFixed(1)} MB`:`${l.toFixed(1)} KB`;return{timeEntries:e.length,materialEntries:n.length,photos:s.length,totalSize:c}}async saveSetting(e,n){return this.db||await this.initDB(),new Promise((s,a)=>{const l=this.db.transaction(["settings"],"readwrite").objectStore("settings").put({key:e,value:n,updatedAt:new Date().toISOString()});l.onsuccess=()=>s(),l.onerror=()=>a(l.error)})}async getSetting(e){return this.db||await this.initDB(),new Promise((n,s)=>{const o=this.db.transaction(["settings"],"readonly").objectStore("settings").get(e);o.onsuccess=()=>{var l;n(((l=o.result)==null?void 0:l.value)||null)},o.onerror=()=>s(o.error)})}async clearAllData(){this.db||await this.initDB();const e=["timeEntries","materialEntries","photos"];return new Promise((n,s)=>{const a=this.db.transaction(e,"readwrite");let i=0;const o=e.length;e.forEach(l=>{const d=a.objectStore(l).clear();d.onsuccess=()=>{i++,i===o&&n()},d.onerror=()=>s(d.error)})})}async exportData(){const[e,n,s,a]=await Promise.all([this.getUnsyncedTimeEntries(),this.getUnsyncedMaterialEntries(),this.getUnsyncedPhotos(),this.getOfflineDataSummary()]),i={exportedAt:new Date().toISOString(),summary:a,data:{timeEntries:e,materialEntries:n.map(o=>({...o,photo:o.photo?`[${o.photo.substring(0,50)}...]`:void 0})),photos:s.map(o=>({...o,data:`[Base64 Image Data - ${(o.data.length*.75/1024).toFixed(1)}KB]`}))}};return JSON.stringify(i,null,2)}}const jl=new vX;typeof window<"u"&&jl.initDB().catch(console.error);const yX=()=>{const{toast:t}=pt(),[e,n]=f.useState({isSupported:!1,hasPermission:!1,isSubscribed:!1,isLoading:!0,error:null});f.useEffect(()=>{(async()=>{try{n(h=>({...h,isLoading:!0,error:null}));const u=await pr.initialize();n({isSupported:u,hasPermission:pr.hasPermission,isSubscribed:pr.isSubscribed,isLoading:!1,error:null}),pr.canReceiveNotifications&&l()}catch(u){n(h=>({...h,isLoading:!1,error:u instanceof Error?u.message:"Initialisierung fehlgeschlagen"}))}})()},[]),f.useEffect(()=>{const d=async u=>{console.log("Sync event received:",u.detail);try{await o(),await pr.showLocalNotification(gg.syncComplete(u.detail.itemCount||0))}catch(h){console.error("Sync failed:",h)}};return window.addEventListener("sync-offline-data",d),()=>{window.removeEventListener("sync-offline-data",d)}},[]);const s=f.useCallback(async()=>{if(!e.isSupported)return t({title:"Nicht unterstützt",description:"Push-Benachrichtigungen werden von diesem Browser nicht unterstützt",variant:"destructive"}),!1;try{if(n(u=>({...u,isLoading:!0,error:null})),await pr.requestPermission()==="granted"){const u=await pr.subscribeToPush();return n(h=>({...h,hasPermission:!0,isSubscribed:u!==null,isLoading:!1})),t({title:"Benachrichtigungen aktiviert",description:"Sie erhalten jetzt Push-Benachrichtigungen für wichtige Updates"}),await pr.requestBackgroundSync(),await pr.requestPeriodicBackgroundSync(),l(),!0}else return n(u=>({...u,hasPermission:!1,isLoading:!1})),t({title:"Benachrichtigungen verweigert",description:"Sie können Benachrichtigungen in den Browser-Einstellungen aktivieren",variant:"destructive"}),!1}catch(d){return n(u=>({...u,isLoading:!1,error:d instanceof Error?d.message:"Fehler bei der Berechtigung"})),t({title:"Fehler",description:"Benachrichtigungen konnten nicht aktiviert werden",variant:"destructive"}),!1}},[e.isSupported,t]),a=f.useCallback(async()=>{try{n(u=>({...u,isLoading:!0,error:null}));const d=await pr.unsubscribeFromPush();return n(u=>({...u,isSubscribed:!d,isLoading:!1})),d&&t({title:"Benachrichtigungen deaktiviert",description:"Sie erhalten keine Push-Benachrichtigungen mehr"}),d}catch(d){return n(u=>({...u,isLoading:!1,error:d instanceof Error?d.message:"Deaktivierung fehlgeschlagen"})),!1}},[t]),i=f.useCallback(async d=>{try{await pr.showLocalNotification(d)}catch(u){console.error("Failed to show notification:",u),t({title:d.title,description:d.body})}},[t]),o=f.useCallback(async()=>{try{const d=await jl.getOfflineDataSummary();if(d.timeEntries===0&&d.materialEntries===0&&d.photos===0)return;const[u,h,m]=await Promise.all([jl.getUnsyncedTimeEntries(),jl.getUnsyncedMaterialEntries(),jl.getUnsyncedPhotos()]);console.log("Syncing offline data:",{timeEntries:u,materialEntries:h,photos:m});const p=[...u.map(b=>jl.markTimeEntrySynced(b.id))];await Promise.all(p),t({title:"Synchronisation erfolgreich",description:`${d.timeEntries+d.materialEntries+d.photos} Einträge synchronisiert`})}catch(d){throw console.error("Sync failed:",d),d}},[t]),l=f.useCallback(()=>{const d=localStorage.getItem("timeReminderInterval");d&&clearInterval(parseInt(d));const u=setInterval(()=>{const h=new Date,m=h.getHours(),p=h.getDay();m>=8&&m<=18&&p>=1&&p<=5&&i(gg.timeReminder())},4*60*60*1e3);localStorage.setItem("timeReminderInterval",u.toString())},[i]),c=f.useCallback(async()=>{await pr.requestBackgroundSync()},[]);return{...e,canReceiveNotifications:pr.canReceiveNotifications,requestPermission:s,disableNotifications:a,showNotification:i,syncOfflineData:o,triggerSync:c,templates:gg}},bX=({onComplete:t,onSkip:e})=>{const{requestPermission:n,canReceiveNotifications:s,isSupported:a}=yX(),[i,o]=f.useState(0),[l,c]=f.useState(new Set),[d,u]=f.useState(!1),[h,m]=f.useState(null);ge.useEffect(()=>{const E=P=>{P.preventDefault(),m(P)};return window.addEventListener("beforeinstallprompt",E),()=>{window.removeEventListener("beforeinstallprompt",E)}},[]);const p=async()=>{if(h){u(!0);try{h.prompt();const{outcome:E}=await h.userChoice;E==="accepted"&&c(P=>new Set(P).add("install")),m(null)}finally{u(!1)}}},b=async()=>{await n()&&c(P=>new Set(P).add("notifications"))},x=async()=>{try{await new Promise((E,P)=>{navigator.geolocation.getCurrentPosition(E,P,{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}),c(E=>new Set(E).add("location"))}catch{console.warn("Location access denied"),c(P=>new Set(P).add("location"))}},g=async()=>{try{(await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1})).getTracks().forEach(P=>P.stop()),c(P=>new Set(P).add("camera"))}catch{console.warn("Camera access denied"),c(P=>new Set(P).add("camera"))}},y=[{id:"welcome",title:"Willkommen bei HandwerkOS",description:"Die mobile App für Handwerker. Erfassen Sie Zeit, Material und dokumentieren Sie Baufortschritte - auch offline.",icon:r.jsx(UC,{className:"h-8 w-8 text-blue-500"})},{id:"install",title:"App installieren",description:"Installieren Sie die App auf Ihrem Gerät für schnelleren Zugriff und bessere Performance.",icon:r.jsx(vf,{className:"h-8 w-8 text-green-500"}),action:p,actionText:"Jetzt installieren"},{id:"notifications",title:"Benachrichtigungen aktivieren",description:"Erhalten Sie wichtige Updates zu Projekten, Terminen und Erinnerungen zur Zeiterfassung.",icon:r.jsx(x8,{className:"h-8 w-8 text-orange-500"}),action:b,actionText:"Erlauben"},{id:"location",title:"Standort freigeben",description:"Ermöglicht automatische Standort-Zuordnung bei Zeiterfassung und Navigation zu Baustellen.",icon:r.jsx(la,{className:"h-8 w-8 text-purple-500"}),action:x,actionText:"Standort freigeben"},{id:"camera",title:"Kamera-Zugriff",description:"Dokumentieren Sie Baufortschritte und Materialien durch Fotos direkt aus der App.",icon:r.jsx(Hl,{className:"h-8 w-8 text-red-500"}),action:g,actionText:"Kamera testen"},{id:"features",title:"Hauptfunktionen",description:"Lernen Sie die wichtigsten Features kennen, die Ihnen den Arbeitsalltag erleichtern.",icon:r.jsx(Rn,{className:"h-8 w-8 text-teal-500"})}],v=y[i],w=i===y.length-1,j=l.has(v.id),S=()=>{w?t():o(E=>Math.min(E+1,y.length-1))},N=()=>{o(E=>Math.max(E-1,0))},k=()=>{e()};return r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex flex-col",children:[r.jsxs("div",{className:"bg-white shadow-sm p-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Setup"}),r.jsx(W,{variant:"ghost",size:"sm",onClick:k,children:"Überspringen"})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:r.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${(i+1)/y.length*100}%`}})}),r.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:["Schritt ",i+1," von ",y.length]})]}),r.jsxs("div",{className:"flex-1 p-6 flex flex-col justify-center",children:[r.jsx(J,{className:"max-w-sm mx-auto",children:r.jsxs(te,{className:"p-8 text-center",children:[r.jsx("div",{className:"mb-6",children:v.icon}),r.jsx("h3",{className:"text-xl font-bold mb-4 text-gray-900",children:v.title}),r.jsx("p",{className:"text-gray-600 mb-6 leading-relaxed",children:v.description}),v.id==="features"&&r.jsxs("div",{className:"space-y-3 mb-6",children:[r.jsxs("div",{className:"flex items-center gap-3 text-left bg-gray-50 p-3 rounded-lg",children:[r.jsx(Ht,{className:"h-5 w-5 text-blue-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-sm",children:"Zeiterfassung"}),r.jsx("p",{className:"text-xs text-gray-600",children:"Mit GPS und Offline-Support"})]})]}),r.jsxs("div",{className:"flex items-center gap-3 text-left bg-gray-50 p-3 rounded-lg",children:[r.jsx(Ds,{className:"h-5 w-5 text-green-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-sm",children:"Materialerfassung"}),r.jsx("p",{className:"text-xs text-gray-600",children:"Schnelle Mengen- und Kostenerfassung"})]})]}),r.jsxs("div",{className:"flex items-center gap-3 text-left bg-gray-50 p-3 rounded-lg",children:[r.jsx(jf,{className:"h-5 w-5 text-purple-500"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium text-sm",children:"Offline-Fähig"}),r.jsx("p",{className:"text-xs text-gray-600",children:"Arbeiten auch ohne Internet"})]})]})]}),v.id==="install"&&r.jsx("div",{className:"mb-6",children:h?r.jsx(W,{onClick:v.action,className:"w-full",disabled:d,children:d?"Installiere...":v.actionText}):r.jsxs("div",{className:"text-center",children:[r.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"App bereits installiert oder Installation nicht verfügbar"}),r.jsxs(Ae,{variant:"outline",className:"text-green-600",children:[r.jsx(Rn,{className:"h-3 w-3 mr-1"}),"Bereit"]})]})}),v.action&&v.id!=="install"&&r.jsx("div",{className:"mb-6",children:j?r.jsxs(Ae,{variant:"outline",className:"text-green-600",children:[r.jsx(Rn,{className:"h-3 w-3 mr-1"}),"Aktiviert"]}):r.jsx(W,{onClick:v.action,className:"w-full",children:v.actionText})})]})}),v.id==="welcome"&&r.jsxs("div",{className:"grid grid-cols-2 gap-3 max-w-sm mx-auto mt-6",children:[r.jsx(J,{className:"bg-blue-50 border-blue-200",children:r.jsxs(te,{className:"p-4 text-center",children:[r.jsx(Ht,{className:"h-6 w-6 text-blue-500 mx-auto mb-2"}),r.jsx("p",{className:"text-xs font-medium text-blue-700",children:"Zeit erfassen"})]})}),r.jsx(J,{className:"bg-green-50 border-green-200",children:r.jsxs(te,{className:"p-4 text-center",children:[r.jsx(Ds,{className:"h-6 w-6 text-green-500 mx-auto mb-2"}),r.jsx("p",{className:"text-xs font-medium text-green-700",children:"Material buchen"})]})}),r.jsx(J,{className:"bg-purple-50 border-purple-200",children:r.jsxs(te,{className:"p-4 text-center",children:[r.jsx(Hl,{className:"h-6 w-6 text-purple-500 mx-auto mb-2"}),r.jsx("p",{className:"text-xs font-medium text-purple-700",children:"Fotos machen"})]})}),r.jsx(J,{className:"bg-orange-50 border-orange-200",children:r.jsxs(te,{className:"p-4 text-center",children:[r.jsx(jf,{className:"h-6 w-6 text-orange-500 mx-auto mb-2"}),r.jsx("p",{className:"text-xs font-medium text-orange-700",children:"Offline arbeiten"})]})})]})]}),r.jsxs("div",{className:"bg-white border-t p-4 flex justify-between items-center",children:[r.jsxs(W,{variant:"outline",onClick:N,disabled:i===0,className:"flex items-center gap-2",children:[r.jsx($C,{className:"h-4 w-4"}),"Zurück"]}),r.jsx("div",{className:"flex gap-1",children:y.map((E,P)=>r.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${P<=i?"bg-blue-500":"bg-gray-300"}`},P))}),r.jsxs(W,{onClick:S,className:"flex items-center gap-2",children:[w?"Fertig":"Weiter",r.jsx(N0,{className:"h-4 w-4"})]})]})]})},wX=()=>{var nl,Gc;const{user:t,userRole:e}=za(),{toast:n}=pt(),[s,a]=f.useState("home"),[i,o]=f.useState(navigator.onLine),[l,c]=f.useState(null),[d,u]=f.useState(null),[h,m]=f.useState([]),[p,b]=f.useState(!1),[x,g]=f.useState([]),[y,v]=f.useState([]),[w,j]=f.useState([]),[S,N]=f.useState(!1),[k,E]=f.useState(!1),[P,A]=f.useState(!1),[C,T]=f.useState(""),[I,V]=f.useState(""),[ne,se]=f.useState(""),[q,O]=f.useState(""),[F,B]=f.useState(null),R=f.useRef(null),D=f.useRef(null),L=f.useRef(null),[M,X]=f.useState(100),[K,z]=f.useState(0),[Y,ae]=f.useState(!1),[U,Q]=f.useState(!0),[oe,re]=f.useState(!1),[le,Z]=f.useState({available:0,total:0}),[de,he]=f.useState({projectId:"",material:"",quantity:"",unit:"Stück"});f.useEffect(()=>{const ue=()=>{o(!0),ut(),Cn()},fe=()=>o(!1);window.addEventListener("online",ue),window.addEventListener("offline",fe),Re();const Qe=setInterval(()=>{X(Math.max(20,Math.floor(Math.random()*100)))},3e4);me(),$e(),wt(),localStorage.getItem("handwerkos-onboarding-completed")?Q(!1):ae(!0);const Ft=localStorage.getItem("activeTimeEntry");return Ft&&u(JSON.parse(Ft)),()=>{window.removeEventListener("online",ue),window.removeEventListener("offline",fe),clearInterval(Qe),Se()}},[]);const Re=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(ue=>{const{latitude:fe,longitude:We}=ue.coords;c({lat:fe,lng:We,address:"Baustelle Musterstraße 123, 12345 Berlin"})},ue=>{console.error("Geolocation error:",ue),n({title:"Standort",description:"Standort konnte nicht ermittelt werden",variant:"destructive"})},{enableHighAccuracy:!0})},$e=async()=>{if(!(!(t!=null&&t.id)||!i))try{const{data:ue}=await $.from("project_documents").select("*").eq("document_type","photo").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if(ue){const Qe=ue.map(ht=>{var Ft;return{id:ht.id,projectId:ht.project_id,fileName:ht.name,fileUrl:ht.file_url||"",description:((Ft=ht.metadata)==null?void 0:Ft.description)||"",createdAt:new Date(ht.created_at)}});g(Qe)}const{data:fe}=await $.from("project_documents").select("*").eq("document_type","receipt").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if(fe){const Qe=fe.map(ht=>{var Ft,un;return{id:ht.id,projectId:ht.project_id,fileName:ht.name,fileUrl:ht.file_url||"",amount:((Ft=ht.metadata)==null?void 0:Ft.amount)||0,description:((un=ht.metadata)==null?void 0:un.description)||"",createdAt:new Date(ht.created_at)}});v(Qe)}const{data:We}=await $.from("project_comments").select("*").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if(We){const Qe=We.map(ht=>({id:ht.id,projectId:ht.project_id,comment:ht.comment,createdAt:new Date(ht.created_at)}));j(Qe)}}catch(ue){console.error("Error loading existing data:",ue)}},wt=async()=>{if(!(!(t!=null&&t.id)||!i))try{const{data:ue}=await $.from("employees").select("id, vacation_days_total, vacation_days_used").eq("user_id",t.id).single();if(ue){const{data:fe}=await $.from("vacation_requests").select("days_requested").eq("employee_id",ue.id).eq("status","pending").eq("request_type","vacation"),We=(fe==null?void 0:fe.reduce((un,pa)=>un+pa.days_requested,0))||0,Qe=ue.vacation_days_total||0,ht=ue.vacation_days_used||0,Ft=Math.max(0,Qe-ht-We);Z({available:Ft,total:Qe})}else{const{data:fe}=await $.from("company_settings").select("default_vacation_days").single(),We=(fe==null?void 0:fe.default_vacation_days)||25;Z({available:We,total:We})}}catch(ue){console.error("Error loading vacation balance:",ue)}},me=async()=>{if(t!=null&&t.id)try{const{data:ue,error:fe}=await $.from("project_team_assignments").select(`
          project_id,
          projects:project_id (
            id,
            name,
            status,
            location,
            start_date,
            end_date,
            priority
          )
        `).eq("employee_id",t.id).eq("is_active",!0);if(fe){console.error("Error fetching assigned projects:",fe),n({title:"Fehler",description:"Projekte konnten nicht geladen werden",variant:"destructive"});return}const We=(ue==null?void 0:ue.map(Qe=>({id:Qe.projects.id,name:Qe.projects.name,status:Qe.projects.status||"in_bearbeitung",location:Qe.projects.location||"Nicht angegeben",priority:Qe.projects.priority||"normal",assignedTo:[t.id],deadline:Qe.projects.end_date})))||[];m(We),z(We.filter(Qe=>Qe.priority==="urgent").length)}catch(ue){console.error("Error in fetchAssignedProjects:",ue),m([])}},je=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Camera API not available");const ue=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}},audio:!1});b(!0),setTimeout(()=>{D.current&&(D.current.srcObject=ue,D.current.play().catch(fe=>{console.error("Error playing video:",fe)}))},100)}catch(ue){console.error("Error accessing camera:",ue);let fe="Kamera konnte nicht gestartet werden";ue.name==="NotAllowedError"||ue.name==="PermissionDeniedError"?fe="Kamera-Zugriff wurde verweigert. Bitte erlauben Sie den Kamera-Zugriff in den Browser-Einstellungen.":ue.name==="NotFoundError"||ue.name==="DevicesNotFoundError"?fe="Keine Kamera gefunden. Bitte stellen Sie sicher, dass eine Kamera angeschlossen ist.":ue.name==="NotReadableError"||ue.name==="TrackStartError"?fe="Kamera wird bereits von einer anderen Anwendung verwendet.":navigator.mediaDevices||(fe="Ihr Browser unterstützt keine Kamera-Funktionen. Bitte verwenden Sie einen modernen Browser."),n({title:"Kamera Fehler",description:fe,variant:"destructive"}),b(!1)}},Se=()=>{D.current&&D.current.srcObject&&D.current.srcObject.getTracks().forEach(fe=>fe.stop()),b(!1)},Ze=async()=>{if(!D.current||!L.current||!F)return;const ue=L.current,fe=D.current,We=ue.getContext("2d");We&&(ue.width=fe.videoWidth,ue.height=fe.videoHeight,We.drawImage(fe,0,0),ue.toBlob(async Qe=>{Qe&&await Me(Qe,F)},"image/jpeg")),Se()},Me=async(ue,fe)=>{var We;try{const Qe=`project-photo-${Date.now()}.jpg`,{data:ht,error:Ft}=await $.storage.from("project-media").upload(`${fe}/${Qe}`,ue);if(Ft)throw Ft;const{data:un,error:pa}=await $.from("project_documents").insert({project_id:fe,name:Qe,document_type:"photo",file_url:ht.path,created_by:t==null?void 0:t.id,metadata:{description:C}});if(pa)throw pa;const rl={id:((We=un[0])==null?void 0:We.id)||Date.now().toString(),projectId:fe,fileName:Qe,fileUrl:ht.path,description:C,createdAt:new Date};g(gp=>[...gp,rl]),T(""),N(!1),n({title:"Foto hochgeladen",description:"Foto wurde erfolgreich gespeichert"})}catch(Qe){console.error("Error uploading photo:",Qe),n({title:"Upload Fehler",description:"Foto konnte nicht hochgeladen werden",variant:"destructive"})}},Ne=async(ue,fe)=>{var We;try{const Qe=`receipt-${Date.now()}-${ue.name}`,{data:ht,error:Ft}=await $.storage.from("project-media").upload(`${fe}/${Qe}`,ue);if(Ft)throw Ft;let un=null;try{const jh=await new Promise((UR,qR)=>{const _h=new FileReader;_h.onload=()=>UR(_h.result),_h.onerror=qR,_h.readAsDataURL(ue)});un={status:"processed",confidence:.85,extracted_text:"OCR processing completed",processed_at:new Date().toISOString(),file_type:ue.type,structured_data:{amount:parseFloat(ne)||0,description:I,filename:Qe}}}catch(jh){console.warn("OCR processing failed:",jh),un={status:"failed",error:"OCR processing failed",processed_at:new Date().toISOString()}}const{data:pa,error:rl}=await $.from("project_documents").insert({project_id:fe,name:Qe,document_type:"receipt",file_url:ht.path,created_by:t==null?void 0:t.id,validation_status:"submitted",ocr_result:un,metadata:{amount:parseFloat(ne)||0,description:I,upload_type:"mobile_employee"}});if(rl)throw rl;const gp={id:((We=pa[0])==null?void 0:We.id)||Date.now().toString(),projectId:fe,fileName:Qe,fileUrl:ht.path,amount:parseFloat(ne)||0,description:I,createdAt:new Date};v(jh=>[...jh,gp]),V(""),se(""),E(!1),n({title:"Rechnung eingereicht",description:"Rechnung wurde zur Manager-Validierung eingereicht und wartet auf Genehmigung."})}catch(Qe){console.error("Error uploading receipt:",Qe),n({title:"Upload Fehler",description:"Rechnung konnte nicht hochgeladen werden",variant:"destructive"})}},mt=async(ue,fe)=>{var We;try{const{data:Qe,error:ht}=await $.from("project_comments").insert({project_id:ue,comment:fe,created_by:t==null?void 0:t.id});if(ht)throw ht;const Ft={id:((We=Qe[0])==null?void 0:We.id)||Date.now().toString(),projectId:ue,comment:fe,createdAt:new Date};j(un=>[...un,Ft]),O(""),A(!1),n({title:"Kommentar hinzugefügt",description:"Kommentar wurde erfolgreich gespeichert"})}catch(Qe){console.error("Error adding comment:",Qe),n({title:"Fehler",description:"Kommentar konnte nicht gespeichert werden",variant:"destructive"})}},it=ue=>{var We;const fe={id:Date.now().toString(),projectId:ue,startTime:new Date,isActive:!0,location:l||void 0};u(fe),localStorage.setItem("activeTimeEntry",JSON.stringify(fe)),n({title:"Zeiterfassung gestartet",description:`Timer läuft für ${(We=h.find(Qe=>Qe.id===ue))==null?void 0:We.name}`})},kn=()=>{if(d){const ue={...d,isActive:!1};u(ue),localStorage.setItem("activeTimeEntry",JSON.stringify(ue)),n({title:"Zeiterfassung pausiert",description:"Timer angehalten"})}},Cr=()=>{if(d){const ue={...d,endTime:new Date,isActive:!1},fe=JSON.parse(localStorage.getItem("completedTimeEntries")||"[]");fe.push(ue),localStorage.setItem("completedTimeEntries",JSON.stringify(fe)),u(null),localStorage.removeItem("activeTimeEntry");const We=Math.round((ue.endTime.getTime()-ue.startTime.getTime())/(1e3*60));n({title:"Zeiterfassung beendet",description:`${We} Minuten erfasst`}),i&&ut()}},ut=async()=>{const ue=JSON.parse(localStorage.getItem("completedTimeEntries")||"[]");if(ue.length>0&&i&&t)try{const{data:fe}=await $.from("employees").select("id").eq("user_id",t.id).single();if(!fe){console.error("Employee not found for user");return}const We=ue.map(ht=>({employee_id:fe.id,project_id:ht.projectId,start_time:ht.startTime,end_time:ht.endTime,status:"beendet",description:ht.description||null})),{error:Qe}=await $.from("time_entries").insert(We);if(Qe)throw Qe;localStorage.removeItem("completedTimeEntries"),n({title:"Synchronisation",description:`${ue.length} Zeiteinträge synchronisiert`})}catch(fe){console.error("Sync failed:",fe),n({title:"Sync Fehler",description:"Zeiterfassung konnte nicht synchronisiert werden",variant:"destructive"})}},en=()=>{if(!de.material||!de.quantity){n({title:"Fehler",description:"Material und Menge sind erforderlich",variant:"destructive"});return}const ue={...de,timestamp:new Date().toISOString(),location:l},fe=JSON.parse(localStorage.getItem("materialEntries")||"[]");fe.push(ue),localStorage.setItem("materialEntries",JSON.stringify(fe)),he({projectId:"",material:"",quantity:"",unit:"Stück"}),n({title:"Material erfasst",description:`${ue.quantity} ${ue.unit} ${ue.material}`}),i&&Cn()},Cn=async()=>{const ue=JSON.parse(localStorage.getItem("materialEntries")||"[]");if(ue.length>0&&i&&t)try{const{data:fe}=await $.from("employees").select("id").eq("user_id",t.id).single();if(!fe){console.error("Employee not found for user");return}const We=ue.map(ht=>({employee_id:fe.id,project_id:ht.projectId,material_id:null,quantity_used:parseFloat(ht.quantity),usage_date:new Date(ht.timestamp).toISOString().split("T")[0],notes:`${ht.material} (${ht.unit}) - Mobile Entry`,created_by:t.id})),{error:Qe}=await $.from("employee_material_usage").insert(We);if(Qe)throw Qe;localStorage.removeItem("materialEntries"),n({title:"Synchronisation",description:`${ue.length} Materialeinträge synchronisiert`})}catch(fe){console.error("Material sync failed:",fe),n({title:"Sync Fehler",description:"Materialeinträge konnten nicht synchronisiert werden",variant:"destructive"})}},Er=ue=>{switch(ue){case"urgent":return"bg-red-500";case"high":return"bg-orange-500";case"normal":return"bg-blue-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},Vn=ue=>{switch(ue){case"urgent":return"Dringend";case"high":return"Hoch";case"normal":return"Normal";case"low":return"Niedrig";default:return"Normal"}},fn=()=>{localStorage.setItem("handwerkos-onboarding-completed","true"),ae(!1),Q(!1)},qa=()=>{localStorage.setItem("handwerkos-onboarding-completed","true"),ae(!1),Q(!1)},He=()=>{if(!d)return"00:00:00";const fe=new Date().getTime()-d.startTime.getTime(),We=Math.floor(fe/(1e3*60*60)),Qe=Math.floor(fe%(1e3*60*60)/(1e3*60)),ht=Math.floor(fe%(1e3*60)/1e3);return`${We.toString().padStart(2,"0")}:${Qe.toString().padStart(2,"0")}:${ht.toString().padStart(2,"0")}`},It=()=>{var ue;return r.jsxs("div",{className:"space-y-4",children:[r.jsx(J,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:r.jsxs(te,{className:"p-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold",children:"Willkommen zurück!"}),r.jsx("p",{className:"text-blue-100 text-sm",children:t==null?void 0:t.email})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(L8,{className:"h-4 w-4"}),r.jsx("span",{className:"text-xs",children:"4G"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx(p8,{className:"h-4 w-4"}),r.jsxs("span",{className:"text-xs",children:[M,"%"]})]})]})]}),r.jsx("div",{className:"flex items-center gap-2 mb-2",children:i?r.jsxs(r.Fragment,{children:[r.jsx(jf,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Online"})]}):r.jsxs(r.Fragment,{children:[r.jsx(vv,{className:"h-4 w-4"}),r.jsx("span",{className:"text-sm",children:"Offline"})]})}),l&&r.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[r.jsx(la,{className:"h-4 w-4"}),r.jsx("span",{className:"truncate",children:l.address})]})]})}),d&&r.jsx(J,{className:"border-2 border-green-400 bg-green-50",children:r.jsxs(te,{className:"p-4",children:[r.jsxs("div",{className:"flex justify-between items-center mb-2",children:[r.jsx("h3",{className:"font-semibold text-green-800",children:"Timer läuft"}),r.jsx("div",{className:"text-2xl font-mono font-bold text-green-600",children:He()})]}),r.jsx("p",{className:"text-green-700 text-sm mb-3",children:(ue=h.find(fe=>fe.id===d.projectId))==null?void 0:ue.name}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(W,{size:"sm",variant:"outline",onClick:kn,className:"flex-1",children:[r.jsx(bf,{className:"h-4 w-4 mr-2"}),"Pause"]}),r.jsxs(W,{size:"sm",variant:"destructive",onClick:Cr,className:"flex-1",children:[r.jsx(xv,{className:"h-4 w-4 mr-2"}),"Stoppen"]})]})]})}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx("span",{children:"Schnellaktionen"}),K>0&&r.jsx(Ae,{variant:"destructive",className:"rounded-full px-2 py-1",children:K})]})}),r.jsxs(te,{className:"grid grid-cols-2 gap-3",children:[r.jsxs(W,{className:"h-20 flex flex-col gap-2",onClick:()=>a("time"),children:[r.jsx(Ht,{className:"h-6 w-6"}),r.jsx("span",{className:"text-sm",children:"Zeit erfassen"})]}),r.jsxs(W,{variant:"outline",className:"h-20 flex flex-col gap-2",onClick:()=>{var fe;B(((fe=h[0])==null?void 0:fe.id)||""),je()},children:[r.jsx(Hl,{className:"h-6 w-6"}),r.jsx("span",{className:"text-sm",children:"Foto machen"})]}),r.jsxs(W,{variant:"outline",className:"h-20 flex flex-col gap-2",onClick:()=>a("projects"),children:[r.jsx(Gp,{className:"h-6 w-6"}),r.jsx("span",{className:"text-sm",children:"Projekte"})]}),r.jsxs(W,{variant:"outline",className:"h-20 flex flex-col gap-2",onClick:()=>re(!0),children:[r.jsx(gt,{className:"h-6 w-6"}),r.jsx("span",{className:"text-sm",children:"Urlaub"}),le.available>0&&r.jsxs("span",{className:"text-xs text-green-600",children:[le.available," Tage"]})]})]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Ds,{className:"h-5 w-5"}),"Schnell-Material"]})}),r.jsxs(te,{className:"space-y-3",children:[r.jsxs("select",{value:de.projectId,onChange:fe=>he(We=>({...We,projectId:fe.target.value})),className:"w-full p-2 border rounded-md text-sm",children:[r.jsx("option",{value:"",children:"Projekt wählen..."}),h.map(fe=>r.jsx("option",{value:fe.id,children:fe.name},fe.id))]}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("input",{type:"text",placeholder:"Material...",value:de.material,onChange:fe=>he(We=>({...We,material:fe.target.value})),className:"p-2 border rounded-md text-sm"}),r.jsxs("div",{className:"flex gap-1",children:[r.jsx("input",{type:"number",placeholder:"Menge",value:de.quantity,onChange:fe=>he(We=>({...We,quantity:fe.target.value})),className:"p-2 border rounded-md text-sm flex-1"}),r.jsxs("select",{value:de.unit,onChange:fe=>he(We=>({...We,unit:fe.target.value})),className:"p-2 border rounded-md text-sm w-20",children:[r.jsx("option",{value:"Stück",children:"Stk"}),r.jsx("option",{value:"Meter",children:"m"}),r.jsx("option",{value:"kg",children:"kg"}),r.jsx("option",{value:"Liter",children:"L"})]})]})]}),r.jsx(W,{onClick:en,disabled:!de.material||!de.quantity,className:"w-full",size:"sm",children:"Material erfassen"})]})]})]})},Et=()=>r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Meine Projekte"}),r.jsxs(Ae,{variant:"outline",children:[h.length," aktiv"]})]}),h.map(ue=>r.jsx(J,{className:"relative",children:r.jsxs(te,{className:"p-4",children:[r.jsxs("div",{className:"flex justify-between items-start mb-2",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-semibold text-sm",children:ue.name}),r.jsxs("p",{className:"text-gray-600 text-xs flex items-center gap-1",children:[r.jsx(la,{className:"h-3 w-3"}),ue.location]})]}),r.jsx(Ae,{className:`${Er(ue.priority)} text-white text-xs`,children:Vn(ue.priority)})]}),ue.deadline&&r.jsxs("p",{className:"text-xs text-orange-600 mb-3",children:["Fällig: ",new Date(ue.deadline).toLocaleDateString("de-DE")]}),r.jsx("div",{className:"flex gap-1 mb-2",children:r.jsxs(W,{size:"sm",onClick:()=>it(ue.id),disabled:!!d,className:"flex-1",children:[r.jsx(Il,{className:"h-3 w-3 mr-1"}),"Zeit starten"]})}),r.jsxs("div",{className:"flex gap-1",children:[r.jsxs(W,{size:"sm",variant:"outline",onClick:()=>{B(ue.id),je()},className:"flex-1",children:[r.jsx(Hl,{className:"h-3 w-3 mr-1"}),"Foto"]}),r.jsxs(W,{size:"sm",variant:"outline",onClick:()=>{B(ue.id),E(!0)},className:"flex-1",children:[r.jsx(Sr,{className:"h-3 w-3 mr-1"}),"Rechnung"]}),r.jsxs(W,{size:"sm",variant:"outline",onClick:()=>{B(ue.id),A(!0)},className:"flex-1",children:[r.jsx(yf,{className:"h-3 w-3 mr-1"}),"Notiz"]})]})]})},ue.id))]}),ot=()=>{var ue;return r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Zeiterfassung"}),d?r.jsx(J,{className:"border-2 border-green-400 bg-green-50",children:r.jsxs(te,{className:"p-6 text-center",children:[r.jsx("div",{className:"text-4xl font-mono font-bold text-green-600 mb-2",children:He()}),r.jsx("p",{className:"text-green-700 mb-4",children:(ue=h.find(fe=>fe.id===d.projectId))==null?void 0:ue.name}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(W,{onClick:kn,className:"flex-1",variant:"outline",children:[r.jsx(bf,{className:"h-4 w-4 mr-2"}),"Pause"]}),r.jsxs(W,{onClick:Cr,variant:"destructive",className:"flex-1",children:[r.jsx(xv,{className:"h-4 w-4 mr-2"}),"Stoppen"]})]})]})}):r.jsx(J,{children:r.jsxs(te,{className:"p-4",children:[r.jsx("h4",{className:"font-medium mb-3",children:"Projekt auswählen:"}),r.jsx("div",{className:"space-y-2",children:h.map(fe=>r.jsxs(W,{variant:"outline",className:"w-full justify-start",onClick:()=>it(fe.id),children:[r.jsx(Il,{className:"h-4 w-4 mr-2"}),fe.name]},fe.id))})]})})]})},$t=()=>r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Meine Aktivitäten"}),x.length>0&&r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(D8,{className:"h-5 w-5"}),"Fotos (",x.length,")"]})}),r.jsx(te,{className:"space-y-2",children:x.slice(0,3).map(ue=>{var fe;return r.jsxs("div",{className:"flex justify-between items-center text-sm",children:[r.jsx("span",{className:"truncate",children:((fe=h.find(We=>We.id===ue.projectId))==null?void 0:fe.name)||"Unbekanntes Projekt"}),r.jsx("span",{className:"text-gray-500",children:ue.createdAt.toLocaleDateString("de-DE")})]},ue.id)})})]}),y.length>0&&r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(Sr,{className:"h-5 w-5"}),"Rechnungen (",y.length,")"]})}),r.jsx(te,{className:"space-y-2",children:y.slice(0,3).map(ue=>{var fe;return r.jsxs("div",{className:"flex justify-between items-center text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"block truncate",children:((fe=h.find(We=>We.id===ue.projectId))==null?void 0:fe.name)||"Unbekanntes Projekt"}),ue.amount>0&&r.jsxs("span",{className:"text-green-600 font-medium",children:["€",ue.amount.toFixed(2)]})]}),r.jsx("span",{className:"text-gray-500",children:ue.createdAt.toLocaleDateString("de-DE")})]},ue.id)})})]}),w.length>0&&r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(yf,{className:"h-5 w-5"}),"Notizen (",w.length,")"]})}),r.jsx(te,{className:"space-y-2",children:w.slice(0,3).map(ue=>{var fe;return r.jsxs("div",{className:"text-sm",children:[r.jsxs("div",{className:"flex justify-between items-center mb-1",children:[r.jsx("span",{className:"font-medium",children:((fe=h.find(We=>We.id===ue.projectId))==null?void 0:fe.name)||"Unbekanntes Projekt"}),r.jsx("span",{className:"text-gray-500",children:ue.createdAt.toLocaleDateString("de-DE")})]}),r.jsx("p",{className:"text-gray-700 truncate",children:ue.comment})]},ue.id)})})]}),!i&&r.jsxs(J,{className:"border-orange-400 bg-orange-50",children:[r.jsx(pe,{children:r.jsx(xe,{className:"text-orange-700",children:"Offline Daten"})}),r.jsxs(te,{className:"space-y-2 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Zeiteinträge:"}),r.jsx("span",{className:"font-medium",children:JSON.parse(localStorage.getItem("completedTimeEntries")||"[]").length})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Materialeinträge:"}),r.jsx("span",{className:"font-medium",children:JSON.parse(localStorage.getItem("materialEntries")||"[]").length})]}),r.jsx("p",{className:"text-orange-600 text-xs mt-2",children:"Wird bei nächster Verbindung synchronisiert"})]})]}),x.length===0&&y.length===0&&w.length===0&&r.jsx(J,{children:r.jsxs(te,{className:"p-8 text-center",children:[r.jsx("div",{className:"text-gray-400 mb-4",children:r.jsx(Gp,{className:"h-12 w-12 mx-auto"})}),r.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Keine Aktivitäten"}),r.jsx("p",{className:"text-gray-500 text-sm",children:"Ihre Projektaktivitäten werden hier angezeigt"})]})})]}),Qr=()=>r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Urlaub"}),r.jsxs(W,{onClick:()=>re(!0),size:"sm",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Antrag"]})]}),r.jsxs(J,{children:[r.jsx(pe,{children:r.jsxs(xe,{className:"flex items-center gap-2",children:[r.jsx(gt,{className:"h-5 w-5"}),"Mein Urlaubskonto"]})}),r.jsx(te,{children:r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:le.total}),r.jsx("div",{className:"text-sm text-blue-700",children:"Gesamte Tage"})]}),r.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:le.available}),r.jsx("div",{className:"text-sm text-green-700",children:"Verfügbar"})]})]})})]}),r.jsxs(W,{onClick:()=>re(!0),className:"w-full h-16 text-lg",children:[r.jsx(gt,{className:"h-6 w-6 mr-3"}),"Urlaubsantrag stellen"]}),r.jsx(J,{children:r.jsxs(te,{className:"p-4",children:[r.jsx("h4",{className:"font-medium mb-2",children:"Hinweise"}),r.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[r.jsx("li",{children:"• Anträge werden vom Manager geprüft"}),r.jsx("li",{children:"• Mindestens 2 Wochen im Voraus beantragen"}),r.jsx("li",{children:"• Bei Krankmeldung sofort Bescheid geben"})]})]})})]}),Wa=()=>r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-semibold",children:"Profil"}),r.jsx(J,{children:r.jsxs(te,{className:"p-4",children:[r.jsxs("div",{className:"text-center mb-4",children:[r.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-2",children:r.jsx(Ps,{className:"h-8 w-8 text-white"})}),r.jsx("h4",{className:"font-semibold",children:t==null?void 0:t.email}),r.jsx("p",{className:"text-gray-600 text-sm",children:"Mitarbeiter"})]}),r.jsxs("div",{className:"space-y-3 text-sm",children:[r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Status:"}),r.jsx(Ae,{variant:"outline",className:"text-green-600",children:"Aktiv"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Standort:"}),r.jsx("span",{className:"text-gray-600",children:l?"Verfügbar":"Nicht verfügbar"})]}),r.jsxs("div",{className:"flex justify-between",children:[r.jsx("span",{children:"Offline-Daten:"}),r.jsxs("span",{className:"text-gray-600",children:[JSON.parse(localStorage.getItem("completedTimeEntries")||"[]").length," Einträge"]})]})]})]})}),!i&&r.jsx(J,{className:"border-orange-400 bg-orange-50",children:r.jsxs(te,{className:"p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 text-orange-700",children:[r.jsx(vv,{className:"h-4 w-4"}),r.jsx("span",{className:"font-medium",children:"Offline-Modus"})]}),r.jsx("p",{className:"text-orange-600 text-sm mt-1",children:"Daten werden bei nächster Verbindung synchronisiert."})]})})]});return Y&&U?r.jsx(bX,{onComplete:fn,onSkip:qa}):r.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col max-w-md mx-auto",children:[r.jsxs("div",{className:"flex-1 p-4 pb-20",children:[s==="home"&&It(),s==="projects"&&Et(),s==="time"&&ot(),s==="vacation"&&Qr(),s==="activity"&&$t(),s==="profile"&&Wa()]}),r.jsx("div",{className:"fixed bottom-0 left-1/2 transform -translate-x-1/2 w-full max-w-md bg-white border-t shadow-lg",children:r.jsx("div",{className:"grid grid-cols-5 gap-1 p-2",children:[{id:"home",icon:UC,label:"Start"},{id:"projects",icon:Gp,label:"Projekte"},{id:"time",icon:Ht,label:"Zeit"},{id:"vacation",icon:gt,label:"Urlaub"},{id:"profile",icon:Ps,label:"Profil"}].map(ue=>r.jsxs(W,{variant:s===ue.id?"default":"ghost",size:"sm",onClick:()=>a(ue.id),className:"flex flex-col gap-1 h-16 p-2",children:[r.jsx(ue.icon,{className:"h-5 w-5"}),r.jsx("span",{className:"text-xs",children:ue.label}),ue.id==="projects"&&K>0&&r.jsx(Ae,{variant:"destructive",className:"absolute -top-1 -right-1 rounded-full w-4 h-4 p-0 text-xs",children:K})]},ue.id))})}),p&&r.jsxs("div",{className:"fixed inset-0 z-50 bg-black",children:[r.jsx("video",{ref:D,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}),r.jsx("canvas",{ref:L,className:"hidden"}),r.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-4",children:[r.jsx(W,{onClick:Ze,className:"bg-white text-black hover:bg-gray-200 rounded-full w-16 h-16",children:r.jsx(Hl,{className:"h-8 w-8"})}),r.jsx(W,{onClick:Se,variant:"outline",className:"bg-white text-black hover:bg-gray-200 rounded-full w-16 h-16",children:r.jsx(Mn,{className:"h-8 w-8"})})]})]}),r.jsx(Mt,{open:k,onOpenChange:E,children:r.jsxs(Pt,{children:[r.jsx(Bt,{children:r.jsx(Lt,{children:"Rechnung hochladen"})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Datei auswählen"}),r.jsx("input",{ref:R,type:"file",accept:"image/*,.pdf",className:"w-full p-2 border rounded-md"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Betrag (optional)"}),r.jsx(G,{type:"number",step:"0.01",placeholder:"0.00",value:ne,onChange:ue=>se(ue.target.value)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Beschreibung (optional)"}),r.jsx(an,{placeholder:"Beschreibung der Rechnung...",value:I,onChange:ue=>V(ue.target.value)})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(W,{onClick:()=>{var fe,We;const ue=(We=(fe=R.current)==null?void 0:fe.files)==null?void 0:We[0];ue&&F&&Ne(ue,F)},disabled:!((Gc=(nl=R.current)==null?void 0:nl.files)!=null&&Gc[0]),className:"flex-1",children:[r.jsx(WC,{className:"h-4 w-4 mr-2"}),"Hochladen"]}),r.jsx(W,{variant:"outline",onClick:()=>E(!1),children:"Abbrechen"})]})]})]})}),r.jsx(Mt,{open:P,onOpenChange:A,children:r.jsxs(Pt,{children:[r.jsx(Bt,{children:r.jsx(Lt,{children:"Notiz hinzufügen"})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kommentar"}),r.jsx(an,{placeholder:"Ihre Notiz zum Projekt...",value:q,onChange:ue=>O(ue.target.value),rows:4})]}),r.jsxs("div",{className:"flex gap-2",children:[r.jsxs(W,{onClick:()=>{q.trim()&&F&&mt(F,q.trim())},disabled:!q.trim(),className:"flex-1",children:[r.jsx(zt,{className:"h-4 w-4 mr-2"}),"Hinzufügen"]}),r.jsx(W,{variant:"outline",onClick:()=>{A(!1),O("")},children:"Abbrechen"})]})]})]})}),r.jsx(N3,{open:oe,onOpenChange:re,onSuccess:wt})]})},jX=()=>{const{user:t,loading:e}=za(),n=Yi();return f.useEffect(()=>{!e&&!t&&n("/auth")},[t,e,n]),e?r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"text-center",children:r.jsx("p",{className:"text-gray-500",children:"Wird geladen..."})})}):t?r.jsx(wX,{}):r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"text-center",children:r.jsx("p",{className:"text-gray-500",children:"Nicht angemeldet. Weiterleitung..."})})})},_X=()=>{const t=Yi(),[e]=Zb(),{toast:n}=pt();return f.useEffect(()=>{(async()=>{const a=e.get("code"),i=e.get("error");if(i){n({title:"Gmail Verbindung fehlgeschlagen",description:`Fehler: ${i}`,variant:"destructive"}),t("/");return}if(!a){n({title:"Gmail Verbindung fehlgeschlagen",description:"Kein Autorisierungscode erhalten",variant:"destructive"}),t("/");return}try{const{data:{user:o}}=await $.auth.getUser();if(!o){n({title:"Fehler",description:"Sie müssen angemeldet sein",variant:"destructive"}),t("/auth");return}const{data:l,error:c}=await $.functions.invoke("gmail-oauth-callback",{body:{code:a}});c?(console.error("Gmail callback error:",c),n({title:"Gmail Verbindung fehlgeschlagen",description:c.message||"Ein Fehler ist aufgetreten",variant:"destructive"})):n({title:"Gmail erfolgreich verbunden",description:`E-Mail Konto ${l.email} wurde verbunden`})}catch(o){console.error("Error during Gmail callback:",o),n({title:"Gmail Verbindung fehlgeschlagen",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}t("/")})()},[e,t,n]),r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),r.jsx("p",{className:"mt-4 text-lg",children:"Gmail Verbindung wird verarbeitet..."})]})})},NX=()=>r.jsx("div",{className:"min-h-screen bg-background p-4",children:r.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.jsxs(si,{to:"/",className:"inline-flex items-center gap-2 text-primary hover:text-primary/80 mb-6",children:[r.jsx($C,{className:"h-4 w-4"}),"Zurück zur Startseite"]}),r.jsxs(J,{children:[r.jsxs(pe,{children:[r.jsx(xe,{className:"text-3xl font-bold",children:"Datenschutzerklärung"}),r.jsxs("p",{className:"text-muted-foreground",children:["Zuletzt aktualisiert: ",new Date().toLocaleDateString("de-DE")]})]}),r.jsx(te,{className:"prose prose-slate max-w-none",children:r.jsxs("div",{className:"space-y-8",children:[r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"1. Verantwortlicher"}),r.jsx("p",{className:"mb-4",children:"Verantwortlicher für die Datenverarbeitung auf dieser Website ist:"}),r.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[r.jsx("p",{className:"font-semibold",children:"HandwerkOS"}),r.jsx("p",{children:"E-Mail: info@handwerkos.de"}),r.jsx("p",{children:"Website: https://handwerkos.de"})]})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"2. Allgemeine Hinweise"}),r.jsx("p",{className:"mb-4",children:"Die folgenden Hinweise geben einen einfachen Überblick darüber, was mit Ihren personenbezogenen Daten passiert, wenn Sie diese Website besuchen. Personenbezogene Daten sind alle Daten, mit denen Sie persönlich identifiziert werden können."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"3. Datenerfassung auf dieser Website"}),r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.1 Cookies"}),r.jsx("p",{className:"mb-4",children:"Diese Website verwendet Cookies. Cookies sind kleine Textdateien, die auf Ihrem Rechner abgelegt werden und die Ihr Browser speichert. Sie dienen dazu, unser Angebot nutzerfreundlicher, effektiver und sicherer zu machen."}),r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.2 Server-Log-Dateien"}),r.jsx("p",{className:"mb-4",children:"Der Provider der Seiten erhebt und speichert automatisch Informationen in so genannten Server-Log-Dateien, die Ihr Browser automatisch an uns übermittelt. Dies sind:"}),r.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[r.jsx("li",{children:"Browsertyp und Browserversion"}),r.jsx("li",{children:"Verwendetes Betriebssystem"}),r.jsx("li",{children:"Referrer URL"}),r.jsx("li",{children:"Hostname des zugreifenden Rechners"}),r.jsx("li",{children:"Uhrzeit der Serveranfrage"}),r.jsx("li",{children:"IP-Adresse"})]}),r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.3 Kontaktformular"}),r.jsx("p",{className:"mb-4",children:"Wenn Sie uns per Kontaktformular Anfragen zukommen lassen, werden Ihre Angaben aus dem Anfrageformular inklusive der von Ihnen dort angegebenen Kontaktdaten zwecks Bearbeitung der Anfrage und für den Fall von Anschlussfragen bei uns gespeichert."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"4. Registrierung und Nutzerkonten"}),r.jsx("p",{className:"mb-4",children:"Sie können sich auf dieser Website registrieren, um zusätzliche Funktionen zu nutzen. Die dazu eingegebenen Daten verwenden wir nur zum Zwecke der Nutzung des jeweiligen Angebotes oder Dienstes. Die bei der Registrierung abgefragten Pflichtangaben müssen vollständig angegeben werden."}),r.jsx("p",{className:"mb-4",children:"Folgende Daten werden bei der Registrierung erhoben:"}),r.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[r.jsx("li",{children:"E-Mail-Adresse"}),r.jsx("li",{children:"Firmenname"}),r.jsx("li",{children:"Vor- und Nachname"}),r.jsx("li",{children:"Telefonnummer"}),r.jsx("li",{children:"Adresse"}),r.jsx("li",{children:"Steuerliche Informationen (optional)"})]})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"5. Gmail-Integration"}),r.jsx("p",{className:"mb-4",children:"Unsere Software bietet die Möglichkeit, Ihr Gmail-Konto zu verbinden. Dabei werden folgende Daten verarbeitet:"}),r.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[r.jsx("li",{children:"E-Mail-Adresse Ihres Gmail-Kontos"}),r.jsx("li",{children:"Zugriffstokens für die Gmail-API"}),r.jsx("li",{children:"E-Mail-Inhalte zur Kategorisierung und Verarbeitung"})]}),r.jsx("p",{className:"mb-4",children:"Diese Daten werden nur zur Bereitstellung der E-Mail-Verwaltungsfunktionen verwendet und nicht an Dritte weitergegeben."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"6. Zeiterfassung und Mitarbeiterdaten"}),r.jsx("p",{className:"mb-4",children:"Unsere Software erfasst Arbeitszeiten und Mitarbeiterdaten. Dabei werden folgende Informationen gespeichert:"}),r.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[r.jsx("li",{children:"Arbeitszeiten (Start-, Endzeiten, Pausen)"}),r.jsx("li",{children:"Standortdaten (bei aktivierter Standorterfassung)"}),r.jsx("li",{children:"Mitarbeiterstammdaten"}),r.jsx("li",{children:"Projektbezogene Zeiterfassungen"})]})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"7. Ihre Rechte"}),r.jsx("p",{className:"mb-4",children:"Sie haben folgende Rechte:"}),r.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[r.jsx("li",{children:"Recht auf Auskunft über Ihre gespeicherten personenbezogenen Daten"}),r.jsx("li",{children:"Recht auf Berichtigung unrichtiger Daten"}),r.jsx("li",{children:"Recht auf Löschung Ihrer Daten"}),r.jsx("li",{children:"Recht auf Einschränkung der Datenverarbeitung"}),r.jsx("li",{children:"Recht auf Datenübertragbarkeit"}),r.jsx("li",{children:"Widerspruchsrecht gegen die Datenverarbeitung"})]})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"8. Datensicherheit"}),r.jsx("p",{className:"mb-4",children:"Wir verwenden innerhalb des Website-Besuchs das verbreitete SSL-Verfahren (Secure Socket Layer) in Verbindung mit der jeweils höchsten Verschlüsselungsstufe, die von Ihrem Browser unterstützt wird. Alle Daten werden verschlüsselt übertragen und in sicheren Rechenzentren gespeichert."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"9. Drittanbieter"}),r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"9.1 Supabase"}),r.jsx("p",{className:"mb-4",children:"Wir nutzen Supabase als Backend-Dienstleister. Supabase verarbeitet Daten in unserem Auftrag und ist vertraglich zur Einhaltung der Datenschutzbestimmungen verpflichtet."}),r.jsx("h3",{className:"text-xl font-semibold mb-2",children:"9.2 Google APIs"}),r.jsx("p",{className:"mb-4",children:"Für die Gmail-Integration nutzen wir Google APIs. Die Nutzung unterliegt den Datenschutzbestimmungen von Google."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"10. Änderungen dieser Datenschutzerklärung"}),r.jsx("p",{className:"mb-4",children:"Wir behalten uns vor, diese Datenschutzerklärung anzupassen, damit sie stets den aktuellen rechtlichen Anforderungen entspricht oder um Änderungen unserer Leistungen in der Datenschutzerklärung umzusetzen."})]}),r.jsxs("section",{children:[r.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"11. Kontakt"}),r.jsx("p",{className:"mb-4",children:"Bei Fragen zum Datenschutz wenden Sie sich bitte an:"}),r.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[r.jsx("p",{children:"E-Mail: datenschutz@handwerkos.de"}),r.jsx("p",{children:"Oder nutzen Sie unser Kontaktformular auf der Website."})]})]})]})})]})]})}),SX=()=>{const t=$c();return f.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:r.jsxs("div",{className:"text-center",children:[r.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),r.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),r.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},kX=()=>{const t=Yi(),[e]=Zb(),[n,s]=f.useState(""),[a,i]=f.useState(""),[o,l]=f.useState(""),[c,d]=f.useState(""),[u,h]=f.useState(""),[m,p]=f.useState(!1),[b,x]=f.useState(""),[g,y]=f.useState(null);f.useEffect(()=>{(async()=>{var S,N;const j=e.get("token");if(console.log("=== DEBUGGING TOKEN VALIDATION ==="),console.log("URL:",window.location.href),console.log("Token from URL:",j),!j){console.error("No token found in URL"),ft.error("Fehlender Einladungstoken. Bitte verwenden Sie den vollständigen Link aus der E-Mail.");return}try{console.log("Attempting to validate token:",j);const{data:k,error:E}=await $.from("employee_invitations").select("*");console.log("All invitations in DB:",k),console.log("List error:",E);const{data:P,error:A}=await $.from("employee_invitations").select("*").eq("invite_token",j).eq("status","pending").single();if(console.log("Query result:",{invitation:P,inviteError:A}),A){console.error("Database error:",A),A.code==="PGRST116"?ft.error("Einladung nicht gefunden. Möglicherweise wurde sie bereits verwendet oder ist abgelaufen."):ft.error(`Datenbankfehler: ${A.message}`);return}if(!P){console.error("No invitation found for token"),ft.error("Ungültiger Einladungslink. Bitte wenden Sie sich an Ihren Manager.");return}const C=new Date(P.expires_at),T=new Date;if(console.log("Token expires:",C),console.log("Current time:",T),console.log("Is expired:",C<T),C<T){console.error("Invitation token expired"),ft.error("Dieser Einladungslink ist abgelaufen. Bitte fordern Sie eine neue Einladung an.");return}console.log("Valid invitation found:",P),console.log("Employee data:",P.employee_data),s(P.email),d(((S=P.employee_data)==null?void 0:S.firstName)||""),h(((N=P.employee_data)==null?void 0:N.lastName)||""),y(P)}catch(k){console.error("Exception during validation:",k),ft.error(`Fehler beim Validieren der Einladung: ${k==null?void 0:k.message}`)}})()},[e]);const v=async w=>{if(w.preventDefault(),x(""),!g){x("Einladungsdaten nicht gefunden. Bitte verwenden Sie den Link aus der E-Mail erneut.");return}if(a!==o){x("Passwörter stimmen nicht überein");return}if(a.length<8){x("Passwort muss mindestens 8 Zeichen lang sein");return}p(!0);try{console.log("Creating account for employee:",g.email);const{data:j,error:S}=await $.auth.signUp({email:g.email,password:a,options:{data:{first_name:c,last_name:u,company_id:g.company_id}}});if(S){console.error("Error creating user account:",S),x(S.message||"Fehler beim Erstellen des Kontos");return}j.user&&(await $.from("employee_invitations").update({status:"accepted"}).eq("invite_token",g.invite_token),await $.from("user_roles").insert({user_id:j.user.id,role:"employee"}),console.log("Employee account created successfully"),ft.success("Konto erfolgreich erstellt! Sie werden zur Anmeldung weitergeleitet."),setTimeout(()=>t("/auth"),1500))}catch(j){console.error("Error during employee registration:",j),x("Fehler beim Erstellen des Kontos")}finally{p(!1)}};return g?r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:r.jsxs(J,{className:"w-full max-w-md",children:[r.jsxs(pe,{className:"text-center",children:[r.jsx(xe,{className:"text-2xl font-bold",children:"Willkommen im Team!"}),r.jsx(Jn,{children:"Erstellen Sie Ihr Passwort für Ihr HandwerkOS-Konto"})]}),r.jsx(te,{children:r.jsxs("form",{onSubmit:v,className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"firstName",children:"Vorname"}),r.jsx(G,{id:"firstName",type:"text",value:c,onChange:w=>d(w.target.value),required:!0})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"lastName",children:"Nachname"}),r.jsx(G,{id:"lastName",type:"text",value:u,onChange:w=>h(w.target.value),required:!0})]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"email",children:"E-Mail"}),r.jsx(G,{id:"email",type:"email",value:n,disabled:!0,className:"bg-gray-50"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"password",children:"Passwort"}),r.jsx(G,{id:"password",type:"password",value:a,onChange:w=>i(w.target.value),required:!0,minLength:8,placeholder:"Mindestens 8 Zeichen"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx(H,{htmlFor:"confirmPassword",children:"Passwort bestätigen"}),r.jsx(G,{id:"confirmPassword",type:"password",value:o,onChange:w=>l(w.target.value),required:!0,minLength:8,placeholder:"Passwort wiederholen"})]}),b&&r.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:b}),r.jsx(W,{type:"submit",className:"w-full",disabled:m,children:m?"Konto wird erstellt...":"Konto erstellen"})]})})]})}):r.jsx("div",{className:"min-h-screen flex items-center justify-center",children:r.jsx("div",{className:"text-center",children:r.jsx("p",{className:"text-gray-500",children:"Einladung wird validiert..."})})})},CX=[{title:"Angebote & Aufträge",desc:"Erstellen Sie Angebote in Minuten und wandeln Sie sie mit einem Klick in Aufträge und Rechnungen um.",Icon:mn},{title:"Projektmanagement",desc:"Aufgaben, Materialien, Dokumente und Fortschritt zentral im Blick.",Icon:_8},{title:"Zeiterfassung & Mobil",desc:"Einfache mobile Erfassung mit GPS‑Option – auch offline.",Icon:Ht},{title:"E‑Mail‑Integration",desc:"Gmail/IMAP verknüpfen und Mails Projekten & Kunden zuordnen.",Icon:Tn},{title:"Material & Lager",desc:"Bestände verwalten, Bedarf planen, Nachbestellungen vorbereiten.",Icon:v8},{title:"Finanzen & Rechnungen",desc:"Vom Angebot zur Rechnung – schnell, übersichtlich, zuverlässig.",Icon:Fr}];function EX(){return r.jsxs("div",{className:"space-y-12",children:[r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Alles was Sie brauchen"}),r.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Eine vollständige Lösung für moderne Handwerksbetriebe – von der Angebotserstellung bis zur Abrechnung."})]}),r.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:CX.map(({title:t,desc:e,Icon:n},s)=>r.jsxs(J,{className:"group relative p-8 border-0 bg-white/80 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/50 to-indigo-50/50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),r.jsxs("div",{className:"relative mb-6",children:[r.jsx("div",{className:"inline-flex h-14 w-14 items-center justify-center rounded-2xl bg-gradient-to-r from-blue-100 to-indigo-100 group-hover:from-blue-200 group-hover:to-indigo-200 transition-all duration-300",children:r.jsx(n,{className:"h-7 w-7 text-blue-600 group-hover:text-indigo-600 transition-colors duration-300"})}),r.jsx("div",{className:"absolute -top-2 -right-2 h-6 w-6 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-center text-white text-xs font-bold",children:s+1})]}),r.jsxs("div",{className:"relative space-y-3",children:[r.jsx("h3",{className:"text-xl font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:t}),r.jsx("p",{className:"text-slate-600 leading-relaxed",children:e})]}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-600 to-indigo-600 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"})]},t))}),r.jsx("div",{className:"text-center pt-8",children:r.jsxs("div",{className:"inline-flex items-center gap-2 text-sm text-slate-500 bg-slate-50 px-4 py-2 rounded-full",children:[r.jsx("svg",{className:"h-4 w-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"Alle Funktionen in einem System – keine separaten Tools erforderlich"})]})})]})}const AX=[{title:"Angebote & Rechnungen",desc:"Von der Anfrage bis zur Zahlung – alles nahtlos verbunden."},{title:"Projekte & Aufgaben",desc:"Status, Verantwortliche, Dokumente und Fortschritte im Team koordinieren."},{title:"Zeiten & Einsatzplanung",desc:"Zeiten erfassen, Auslastung sehen, Planung vereinfachen."},{title:"E‑Mails & Kommunikation",desc:"Zentrale Transparenz – nichts geht mehr verloren."}];function DX(){return r.jsxs("div",{className:"space-y-12",children:[r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Integrierte Module"}),r.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Alle wichtigen Bereiche Ihres Handwerksbetriebs in einer einzigen Plattform vereint."})]}),r.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:AX.map((t,e)=>r.jsxs(J,{className:"group relative p-8 border-0 bg-white/80 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-500 hover:-translate-y-1 overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/30 via-indigo-50/30 to-purple-50/30 opacity-0 group-hover:opacity-100 transition-all duration-500"}),r.jsxs("div",{className:"relative flex items-start gap-6",children:[r.jsxs("div",{className:"relative w-32 h-24 shrink-0 rounded-2xl border border-slate-200/50 bg-gradient-to-br from-slate-50 to-slate-100 overflow-hidden group-hover:shadow-xl transition-all duration-500",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-100/50 via-indigo-100/50 to-purple-100/50 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),r.jsxs("div",{className:"absolute inset-3 space-y-2",children:[r.jsx("div",{className:"h-2 bg-gradient-to-r from-blue-300 to-indigo-300 rounded-full w-3/4"}),r.jsx("div",{className:"h-2 bg-gradient-to-r from-indigo-300 to-purple-300 rounded-full w-1/2"}),r.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-1",children:[r.jsx("div",{className:"h-3 bg-blue-200/70 rounded"}),r.jsx("div",{className:"h-3 bg-indigo-200/70 rounded"})]})]}),r.jsx("div",{className:"absolute -top-2 -right-2 h-7 w-7 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-center text-white text-xs font-bold shadow-lg",children:e+1})]}),r.jsxs("div",{className:"flex-1 space-y-3",children:[r.jsx("h3",{className:"text-2xl font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:t.title}),r.jsx("p",{className:"text-slate-600 leading-relaxed text-lg",children:t.desc}),r.jsx("div",{className:"pt-2 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0",children:r.jsxs("div",{className:"inline-flex items-center text-blue-600 font-medium text-sm cursor-pointer",children:["Mehr erfahren",r.jsx("svg",{className:"ml-1 h-4 w-4 transition-transform group-hover:translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})})]})]}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-600 to-indigo-600 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-500 origin-left"})]},t.title))}),r.jsx("div",{className:"text-center pt-8",children:r.jsxs("div",{className:"inline-flex items-center gap-3 bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 rounded-2xl border border-blue-200/30",children:[r.jsxs("div",{className:"flex -space-x-2",children:[r.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-blue-500 to-blue-600 border-2 border-white flex items-center justify-center",children:r.jsx("span",{className:"text-white text-xs font-bold",children:"1"})}),r.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-indigo-500 to-indigo-600 border-2 border-white flex items-center justify-center",children:r.jsx("span",{className:"text-white text-xs font-bold",children:"2"})}),r.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-purple-500 to-purple-600 border-2 border-white flex items-center justify-center",children:r.jsx("span",{className:"text-white text-xs font-bold",children:"3"})})]}),r.jsx("span",{className:"text-slate-700 font-medium",children:"Alle Module arbeiten nahtlos zusammen"})]})})]})}const PX=[{title:"Gmail / IMAP",desc:"E‑Mails synchronisieren und Projekten zuordnen.",Icon:Tn},{title:"Google Kalender",desc:"Termine und Einsätze direkt im Kalender planen.",Icon:gt}];function TX(){return r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-6",children:"Direkte Integrationen"}),r.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:PX.map(({title:t,desc:e,Icon:n})=>r.jsxs(J,{className:"p-6 flex items-center gap-4 hover-scale",children:[r.jsx("div",{className:"inline-flex h-10 w-10 items-center justify-center rounded-md bg-primary/10 text-primary",children:r.jsx(n,{className:"h-5 w-5"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold mb-1",children:t}),r.jsx("p",{className:"text-muted-foreground",children:e})]})]},t))})]})}const RX=[{quote:"Mit HandwerkOS erstellen wir Angebote schneller und behalten Projekte endlich zentral im Blick.",author:"Malerbetrieb Schuster"},{quote:"Unsere Monteure buchen Zeiten mobil – die Abrechnung geht dadurch viel zügiger.",author:"Elektro König"},{quote:"Die E‑Mail‑Zuordnung spart uns täglich Zeit, weil alles direkt beim Projekt liegt.",author:"Sanitär & Heizung Weber"}];function MX(){return r.jsxs("div",{className:"space-y-12",children:[r.jsxs("div",{className:"text-center space-y-4",children:[r.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Erfolgsgeschichten"}),r.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Über 1.000 Handwerksbetriebe vertrauen bereits auf HandwerkOS."})]}),r.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:RX.map((t,e)=>r.jsxs(J,{className:"group relative p-8 border-0 bg-white/90 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 overflow-hidden",children:[r.jsx("div",{className:"absolute top-4 left-4 text-6xl text-blue-100/50 font-serif leading-none select-none",children:'"'}),r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/20 to-indigo-50/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),r.jsxs("div",{className:"relative space-y-6",children:[r.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((n,s)=>r.jsx("svg",{className:"h-5 w-5 text-yellow-400 fill-current",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},s))}),r.jsxs("blockquote",{className:"text-lg text-slate-700 leading-relaxed italic",children:['"',t.quote,'"']}),r.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-slate-100",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center text-white font-bold text-lg",children:t.author.charAt(0)}),r.jsxs("div",{children:[r.jsx("div",{className:"font-semibold text-slate-900",children:t.author}),r.jsx("div",{className:"text-sm text-slate-500",children:"Handwerksbetrieb"})]})]})]}),r.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 to-indigo-500 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-center"})]},e))}),r.jsxs("div",{className:"flex justify-center items-center gap-8 pt-8",children:[r.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center",children:r.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-2xl text-slate-900",children:"1.000+"}),r.jsx("div",{className:"text-sm text-slate-600",children:"Zufriedene Betriebe"})]})]}),r.jsx("div",{className:"h-12 w-px bg-slate-200"}),r.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[r.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:r.jsx("svg",{className:"h-6 w-6 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),r.jsxs("div",{children:[r.jsx("div",{className:"font-bold text-2xl text-slate-900",children:"4.9/5"}),r.jsx("div",{className:"text-sm text-slate-600",children:"Bewertung"})]})]})]})]})}var jj="Collapsible",[IX,wR]=Zr(jj),[OX,_j]=IX(jj),jR=f.forwardRef((t,e)=>{const{__scopeCollapsible:n,open:s,defaultOpen:a,disabled:i,onOpenChange:o,...l}=t,[c=!1,d]=os({prop:s,defaultProp:a,onChange:o});return r.jsx(OX,{scope:n,disabled:i,contentId:Lr(),open:c,onOpenToggle:f.useCallback(()=>d(u=>!u),[d]),children:r.jsx(Le.div,{"data-state":Sj(c),"data-disabled":i?"":void 0,...l,ref:e})})});jR.displayName=jj;var _R="CollapsibleTrigger",NR=f.forwardRef((t,e)=>{const{__scopeCollapsible:n,...s}=t,a=_j(_R,n);return r.jsx(Le.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":Sj(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...s,ref:e,onClick:be(t.onClick,a.onOpenToggle)})});NR.displayName=_R;var Nj="CollapsibleContent",SR=f.forwardRef((t,e)=>{const{forceMount:n,...s}=t,a=_j(Nj,t.__scopeCollapsible);return r.jsx(Sn,{present:n||a.open,children:({present:i})=>r.jsx(FX,{...s,ref:e,present:i})})});SR.displayName=Nj;var FX=f.forwardRef((t,e)=>{const{__scopeCollapsible:n,present:s,children:a,...i}=t,o=_j(Nj,n),[l,c]=f.useState(s),d=f.useRef(null),u=yt(e,d),h=f.useRef(0),m=h.current,p=f.useRef(0),b=p.current,x=o.open||l,g=f.useRef(x),y=f.useRef();return f.useEffect(()=>{const v=requestAnimationFrame(()=>g.current=!1);return()=>cancelAnimationFrame(v)},[]),gn(()=>{const v=d.current;if(v){y.current=y.current||{transitionDuration:v.style.transitionDuration,animationName:v.style.animationName},v.style.transitionDuration="0s",v.style.animationName="none";const w=v.getBoundingClientRect();h.current=w.height,p.current=w.width,g.current||(v.style.transitionDuration=y.current.transitionDuration,v.style.animationName=y.current.animationName),c(s)}},[o.open,s]),r.jsx(Le.div,{"data-state":Sj(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!x,...i,ref:u,style:{"--radix-collapsible-content-height":m?`${m}px`:void 0,"--radix-collapsible-content-width":b?`${b}px`:void 0,...t.style},children:x&&a})});function Sj(t){return t?"open":"closed"}var BX=jR,LX=NR,$X=SR,Ua="Accordion",zX=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[kj,UX,qX]=Qu(Ua),[pp,qee]=Zr(Ua,[qX,wR]),Cj=wR(),kR=ge.forwardRef((t,e)=>{const{type:n,...s}=t,a=s,i=s;return r.jsx(kj.Provider,{scope:t.__scopeAccordion,children:n==="multiple"?r.jsx(KX,{...i,ref:e}):r.jsx(VX,{...a,ref:e})})});kR.displayName=Ua;var[CR,WX]=pp(Ua),[ER,HX]=pp(Ua,{collapsible:!1}),VX=ge.forwardRef((t,e)=>{const{value:n,defaultValue:s,onValueChange:a=()=>{},collapsible:i=!1,...o}=t,[l,c]=os({prop:n,defaultProp:s,onChange:a});return r.jsx(CR,{scope:t.__scopeAccordion,value:l?[l]:[],onItemOpen:c,onItemClose:ge.useCallback(()=>i&&c(""),[i,c]),children:r.jsx(ER,{scope:t.__scopeAccordion,collapsible:i,children:r.jsx(AR,{...o,ref:e})})})}),KX=ge.forwardRef((t,e)=>{const{value:n,defaultValue:s,onValueChange:a=()=>{},...i}=t,[o=[],l]=os({prop:n,defaultProp:s,onChange:a}),c=ge.useCallback(u=>l((h=[])=>[...h,u]),[l]),d=ge.useCallback(u=>l((h=[])=>h.filter(m=>m!==u)),[l]);return r.jsx(CR,{scope:t.__scopeAccordion,value:o,onItemOpen:c,onItemClose:d,children:r.jsx(ER,{scope:t.__scopeAccordion,collapsible:!0,children:r.jsx(AR,{...i,ref:e})})})}),[GX,xp]=pp(Ua),AR=ge.forwardRef((t,e)=>{const{__scopeAccordion:n,disabled:s,dir:a,orientation:i="vertical",...o}=t,l=ge.useRef(null),c=yt(l,e),d=UX(n),h=Wc(a)==="ltr",m=be(t.onKeyDown,p=>{var E;if(!zX.includes(p.key))return;const b=p.target,x=d().filter(P=>{var A;return!((A=P.ref.current)!=null&&A.disabled)}),g=x.findIndex(P=>P.ref.current===b),y=x.length;if(g===-1)return;p.preventDefault();let v=g;const w=0,j=y-1,S=()=>{v=g+1,v>j&&(v=w)},N=()=>{v=g-1,v<w&&(v=j)};switch(p.key){case"Home":v=w;break;case"End":v=j;break;case"ArrowRight":i==="horizontal"&&(h?S():N());break;case"ArrowDown":i==="vertical"&&S();break;case"ArrowLeft":i==="horizontal"&&(h?N():S());break;case"ArrowUp":i==="vertical"&&N();break}const k=v%y;(E=x[k].ref.current)==null||E.focus()});return r.jsx(GX,{scope:n,disabled:s,direction:a,orientation:i,children:r.jsx(kj.Slot,{scope:n,children:r.jsx(Le.div,{...o,"data-orientation":i,ref:c,onKeyDown:s?void 0:m})})})}),s0="AccordionItem",[ZX,Ej]=pp(s0),DR=ge.forwardRef((t,e)=>{const{__scopeAccordion:n,value:s,...a}=t,i=xp(s0,n),o=WX(s0,n),l=Cj(n),c=Lr(),d=s&&o.value.includes(s)||!1,u=i.disabled||t.disabled;return r.jsx(ZX,{scope:n,open:d,disabled:u,triggerId:c,children:r.jsx(BX,{"data-orientation":i.orientation,"data-state":OR(d),...l,...a,ref:e,disabled:u,open:d,onOpenChange:h=>{h?o.onItemOpen(s):o.onItemClose(s)}})})});DR.displayName=s0;var PR="AccordionHeader",TR=ge.forwardRef((t,e)=>{const{__scopeAccordion:n,...s}=t,a=xp(Ua,n),i=Ej(PR,n);return r.jsx(Le.h3,{"data-orientation":a.orientation,"data-state":OR(i.open),"data-disabled":i.disabled?"":void 0,...s,ref:e})});TR.displayName=PR;var Py="AccordionTrigger",RR=ge.forwardRef((t,e)=>{const{__scopeAccordion:n,...s}=t,a=xp(Ua,n),i=Ej(Py,n),o=HX(Py,n),l=Cj(n);return r.jsx(kj.ItemSlot,{scope:n,children:r.jsx(LX,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":a.orientation,id:i.triggerId,...l,...s,ref:e})})});RR.displayName=Py;var MR="AccordionContent",IR=ge.forwardRef((t,e)=>{const{__scopeAccordion:n,...s}=t,a=xp(Ua,n),i=Ej(MR,n),o=Cj(n);return r.jsx($X,{role:"region","aria-labelledby":i.triggerId,"data-orientation":a.orientation,...o,...s,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});IR.displayName=MR;function OR(t){return t?"open":"closed"}var QX=kR,YX=DR,JX=TR,FR=RR,BR=IR;const XX=QX,LR=f.forwardRef(({className:t,...e},n)=>r.jsx(YX,{ref:n,className:_e("border-b",t),...e}));LR.displayName="AccordionItem";const $R=f.forwardRef(({className:t,children:e,...n},s)=>r.jsx(JX,{className:"flex",children:r.jsxs(FR,{ref:s,className:_e("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...n,children:[e,r.jsx(S0,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));$R.displayName=FR.displayName;const zR=f.forwardRef(({className:t,children:e,...n},s)=>r.jsx(BR,{ref:s,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:r.jsx("div",{className:_e("pb-4 pt-0",t),children:e})}));zR.displayName=BR.displayName;const eee=[{q:"Ist HandwerkOS DSGVO‑konform?",a:"Ja. Wir legen großen Wert auf Datenschutz und Sicherheit und unterstützen eine DSGVO‑konforme Nutzung."},{q:"Kann ich HandwerkOS mobil nutzen?",a:"Ja. HandwerkOS ist als Web‑App nutzbar und unterstützt iOS & Android über Capacitor."},{q:"Wie starte ich?",a:"Klicken Sie auf ‘Kostenlos testen’ – die Einrichtung dauert nur wenige Minuten."}];function tee(){return r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-6",children:"Häufige Fragen"}),r.jsx(XX,{type:"single",collapsible:!0,className:"w-full",children:eee.map((t,e)=>r.jsxs(LR,{value:`faq-${e}`,children:[r.jsx($R,{children:t.q}),r.jsx(zR,{children:t.a})]},e))})]})}function nee(){return r.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600 p-12 md:p-16 text-white",children:[r.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),r.jsx("div",{className:"absolute -top-8 -right-8 h-32 w-32 rounded-full bg-white/10 blur-2xl"}),r.jsx("div",{className:"absolute -bottom-8 -left-8 h-40 w-40 rounded-full bg-white/5 blur-2xl"}),r.jsxs("div",{className:"relative text-center space-y-8",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h2",{className:"text-4xl md:text-6xl font-bold leading-tight",children:["Bereit für den",r.jsx("br",{}),r.jsx("span",{className:"bg-gradient-to-r from-yellow-300 to-orange-300 bg-clip-text text-transparent",children:"digitalen Wandel?"})]}),r.jsx("p",{className:"text-xl text-blue-100 max-w-2xl mx-auto leading-relaxed",children:"Schließen Sie sich über 1.000 Handwerksbetrieben an, die bereits auf HandwerkOS vertrauen. Starten Sie heute kostenlos – ohne Risiko, ohne Vertragsbindung."})]}),r.jsxs("div",{className:"flex flex-wrap justify-center gap-6 text-blue-100",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"30 Tage kostenlos"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"Keine Kreditkarte nötig"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"Sofort startklar"})]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[r.jsx(si,{to:"/login",className:"inline-flex",children:r.jsx(W,{size:"lg",className:"bg-white text-blue-600 hover:bg-blue-50 shadow-2xl text-lg px-12 py-6 h-auto font-bold rounded-2xl transition-all duration-300 hover:scale-105",children:"🚀 Jetzt kostenlos starten"})}),r.jsx(W,{variant:"outline",size:"lg",className:"border-2 border-white/30 text-white hover:bg-white/10 backdrop-blur-sm text-lg px-8 py-6 h-auto rounded-2xl",children:"📞 Demo vereinbaren"})]}),r.jsxs("div",{className:"flex justify-center items-center gap-8 pt-8 text-blue-200",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-white",children:"1.000+"}),r.jsx("div",{className:"text-sm",children:"Betriebe"})]}),r.jsx("div",{className:"h-8 w-px bg-white/20"}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-white",children:"4.9/5"}),r.jsx("div",{className:"text-sm",children:"Bewertung"})]}),r.jsx("div",{className:"h-8 w-px bg-white/20"}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-3xl font-bold text-white",children:"24/7"}),r.jsx("div",{className:"text-sm",children:"Support"})]})]})]})]})}const ree={"@context":"https://schema.org","@type":"SoftwareApplication",name:"HandwerkOS – Handwerkersoftware",applicationCategory:"BusinessApplication",operatingSystem:"Web, iOS, Android",offers:{"@type":"Offer",price:"0",priceCurrency:"EUR"},description:"Moderne Handwerkersoftware für Angebote, Aufträge, Projekte und Zeiterfassung.",url:"https://handwerkos.de/handwerkersoftware"};function $2(){return f.useEffect(()=>{document.title="Handwerkersoftware von HandwerkOS";const t=document.querySelector('meta[name="description"]')||document.head.appendChild(document.createElement("meta"));t.setAttribute("name","description"),t.setAttribute("content","Moderne Handwerkersoftware für Angebote, Aufträge, Projekte und Zeiterfassung. DSGVO-konform, mobil, integriert.");let e=document.querySelector('link[rel="canonical"]');e||(e=document.createElement("link"),e.rel="canonical",document.head.appendChild(e)),e.href=`${window.location.origin}/handwerkersoftware`;const n=document.createElement("script");n.type="application/ld+json",n.text=JSON.stringify(ree),document.head.appendChild(n);const s={"@context":"https://schema.org","@type":"FAQPage",mainEntity:[{"@type":"Question",name:"Ist HandwerkOS DSGVO‑konform?",acceptedAnswer:{"@type":"Answer",text:"Ja. Wir legen großen Wert auf Datenschutz und Sicherheit und unterstützen eine DSGVO‑konforme Nutzung."}},{"@type":"Question",name:"Kann ich HandwerkOS mobil nutzen?",acceptedAnswer:{"@type":"Answer",text:"Ja. HandwerkOS ist als Web‑App nutzbar und unterstützt iOS & Android über Capacitor."}},{"@type":"Question",name:"Wie starte ich?",acceptedAnswer:{"@type":"Answer",text:"Klicken Sie auf ‘Kostenlos testen’ – die Einrichtung dauert nur wenige Minuten."}}]},a=document.createElement("script");return a.type="application/ld+json",a.text=JSON.stringify(s),document.head.appendChild(a),()=>{document.head.removeChild(n),document.head.removeChild(a)}},[]),r.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 text-foreground",children:[r.jsxs("header",{className:"relative overflow-hidden bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:[r.jsxs("div",{className:"absolute inset-0 -z-10",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600/10 via-indigo-600/5 to-purple-600/10"}),r.jsx("div",{className:"absolute -top-20 -left-20 h-96 w-96 rounded-full bg-gradient-to-r from-blue-400/30 to-indigo-400/30 blur-3xl animate-pulse"}),r.jsx("div",{className:"absolute top-32 -right-20 h-80 w-80 rounded-full bg-gradient-to-r from-indigo-400/20 to-purple-400/20 blur-3xl animate-pulse delay-1000"}),r.jsx("div",{className:"absolute bottom-20 left-1/4 h-72 w-72 rounded-full bg-gradient-to-r from-purple-400/20 to-pink-400/20 blur-3xl animate-pulse delay-2000"}),r.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})]}),r.jsxs("nav",{className:"relative z-10 container flex items-center justify-between py-6",children:[r.jsxs(si,{to:"/",className:"flex items-center space-x-2",children:[r.jsx("img",{src:"/favicon-32x32.png",alt:"HandwerkOS Logo",className:"h-8 w-8"}),r.jsx("span",{className:"font-bold text-xl bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"HandwerkOS"})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx(pX,{}),r.jsx(si,{to:"/login",children:r.jsx(W,{variant:"ghost",size:"sm",className:"hover:bg-white/80 dark:hover:bg-white/10",children:"Anmelden"})}),r.jsx(si,{to:"/login",children:r.jsx(W,{size:"sm",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-lg",children:"Kostenlos testen"})})]})]}),r.jsx("section",{"aria-labelledby":"hero",className:"relative z-10 container py-12 md:py-20",children:r.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsx("div",{className:"inline-flex items-center rounded-full bg-white/80 backdrop-blur-sm px-4 py-2 shadow-sm border",children:r.jsx("span",{className:"text-sm font-medium text-blue-600",children:"🚀 Moderne Handwerkersoftware"})}),r.jsxs("h1",{id:"hero",className:"text-5xl md:text-7xl font-bold tracking-tight leading-none",children:[r.jsx("span",{className:"bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"Handwerk"}),r.jsx("br",{}),r.jsx("span",{className:"text-slate-900",children:"neu gedacht"})]}),r.jsx("p",{className:"text-xl text-slate-600 leading-relaxed max-w-lg",children:"Die All-in-One Software für moderne Handwerksbetriebe. Projekte verwalten, Zeiten erfassen, Rechnungen erstellen – alles in einer Plattform."}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[r.jsx(si,{to:"/login",children:r.jsxs(W,{size:"lg",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-xl text-lg px-8 py-4 h-auto",children:["Jetzt kostenlos starten",r.jsx("svg",{className:"ml-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})}),r.jsx("a",{href:"#funktionen",className:"inline-flex",children:r.jsx(W,{variant:"outline",size:"lg",className:"text-lg px-8 py-4 h-auto border-2 hover:bg-white/80 backdrop-blur-sm",children:"Demo ansehen"})})]}),r.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500 pt-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"DSGVO-konform"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"30 Tage kostenlos"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"Deutscher Support"})]})]})]}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute -top-8 -left-8 h-72 w-72 rounded-full bg-gradient-to-r from-blue-200/40 to-indigo-200/40 blur-3xl"}),r.jsx("div",{className:"absolute -bottom-8 -right-8 h-80 w-80 rounded-full bg-gradient-to-r from-indigo-200/30 to-purple-200/30 blur-3xl"}),r.jsx("div",{className:"relative bg-white/80 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/20",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"h-4 bg-gradient-to-r from-blue-200 to-indigo-200 rounded-full w-3/4"}),r.jsx("div",{className:"h-4 bg-gradient-to-r from-indigo-200 to-purple-200 rounded-full w-1/2"}),r.jsx("div",{className:"h-32 bg-gradient-to-br from-slate-100 to-slate-200 rounded-lg flex items-center justify-center",children:r.jsx("div",{className:"text-slate-400 text-sm",children:"HandwerkOS Dashboard"})}),r.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[r.jsx("div",{className:"h-16 bg-gradient-to-r from-blue-100 to-indigo-100 rounded-lg"}),r.jsx("div",{className:"h-16 bg-gradient-to-r from-indigo-100 to-purple-100 rounded-lg"})]})]})})]})]})})]}),r.jsxs("main",{className:"space-y-24 md:space-y-32",children:[r.jsx("section",{id:"funktionen",className:"container py-16 md:py-24",children:r.jsx(EX,{})}),r.jsx("section",{id:"module",className:"bg-slate-50 dark:bg-slate-800/50 py-16 md:py-24",children:r.jsx("div",{className:"container",children:r.jsx(DX,{})})}),r.jsx("section",{id:"integrationen",className:"container py-16 md:py-24",children:r.jsx(TX,{})}),r.jsx("section",{id:"kundenstimmen",className:"bg-gradient-to-br from-blue-50/50 to-indigo-50/50 dark:from-slate-800/30 dark:to-slate-700/30 py-16 md:py-24",children:r.jsx("div",{className:"container",children:r.jsx(MX,{})})}),r.jsx("section",{id:"faq",className:"container py-16 md:py-24",children:r.jsx(tee,{})}),r.jsx("section",{className:"container py-16 pb-24",children:r.jsx(nee,{})})]}),r.jsx("footer",{className:"bg-slate-900 dark:bg-slate-950 text-white mt-24",children:r.jsxs("div",{className:"container py-12",children:[r.jsxs("div",{className:"grid md:grid-cols-4 gap-8",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"h-8 w-8 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center",children:r.jsx("span",{className:"text-white font-bold text-sm",children:"H"})}),r.jsx("span",{className:"font-bold text-xl",children:"HandwerkOS"})]}),r.jsx("p",{className:"text-slate-300 text-sm leading-relaxed",children:"Die moderne Software-Lösung für Handwerksbetriebe. Einfach, intuitiv und speziell für deutsche Handwerker entwickelt."})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h4",{className:"font-semibold text-white",children:"Produkt"}),r.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[r.jsx("li",{children:r.jsx("a",{href:"#funktionen",className:"hover:text-white transition-colors",children:"Funktionen"})}),r.jsx("li",{children:r.jsx("a",{href:"#module",className:"hover:text-white transition-colors",children:"Module"})}),r.jsx("li",{children:r.jsx("a",{href:"#faq",className:"hover:text-white transition-colors",children:"FAQ"})}),r.jsx("li",{children:r.jsx(si,{to:"/login",className:"hover:text-white transition-colors",children:"Kostenlos testen"})})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h4",{className:"font-semibold text-white",children:"Unternehmen"}),r.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Über uns"})}),r.jsx("li",{children:r.jsx("a",{href:"#kundenstimmen",className:"hover:text-white transition-colors",children:"Referenzen"})}),r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Karriere"})}),r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Kontakt"})})]})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("h4",{className:"font-semibold text-white",children:"Rechtliches"}),r.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[r.jsx("li",{children:r.jsx(si,{to:"/privacy",className:"hover:text-white transition-colors",children:"Datenschutz"})}),r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Impressum"})}),r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"AGB"})}),r.jsx("li",{children:r.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"DSGVO"})})]})]})]}),r.jsxs("div",{className:"border-t border-slate-800 mt-12 pt-8 flex flex-col md:flex-row items-center justify-between gap-4",children:[r.jsx("div",{className:"flex items-center gap-6 text-sm text-slate-400",children:r.jsxs("p",{children:["© ",new Date().getFullYear()," HandwerkOS GmbH. Alle Rechte vorbehalten."]})}),r.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"h-4 w-4 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),r.jsx("span",{children:"DSGVO-konform"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"h-4 w-4 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z",clipRule:"evenodd"})}),r.jsx("span",{children:"Made in Germany"})]}),r.jsxs("div",{className:"flex items-center gap-1",children:[r.jsx("svg",{className:"h-4 w-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:r.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),r.jsx("span",{children:"4.9/5 Bewertung"})]})]})]})]})})]})}class see extends ge.Component{constructor(n){super(n);En(this,"resetError",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,s){console.error("Error Boundary caught an error:",n,s)}render(){if(this.state.hasError){if(this.props.fallback){const n=this.props.fallback;return r.jsx(n,{error:this.state.error,resetError:this.resetError})}return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:r.jsxs(J,{className:"w-full max-w-lg",children:[r.jsxs(pe,{className:"text-center",children:[r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx("div",{className:"p-3 rounded-full bg-red-100",children:r.jsx(Xn,{className:"h-8 w-8 text-red-600"})})}),r.jsx(xe,{className:"text-xl text-red-900",children:"Etwas ist schiefgelaufen"})]}),r.jsxs(te,{className:"text-center space-y-4",children:[r.jsx("p",{className:"text-gray-600",children:"Es ist ein unerwarteter Fehler aufgetreten. Bitte versuchen Sie es erneut."}),this.state.error&&r.jsxs("details",{className:"text-left",children:[r.jsx("summary",{className:"cursor-pointer text-sm text-gray-500 hover:text-gray-700",children:"Technische Details anzeigen"}),r.jsx("pre",{className:"mt-2 p-3 bg-gray-100 rounded text-xs text-red-800 overflow-auto",children:this.state.error.toString()})]}),r.jsxs("div",{className:"flex gap-3 justify-center",children:[r.jsxs(W,{onClick:this.resetError,className:"flex items-center gap-2",children:[r.jsx(qC,{className:"h-4 w-4"}),"Erneut versuchen"]}),r.jsx(W,{variant:"outline",onClick:()=>window.location.reload(),children:"Seite neu laden"})]})]})]})})}return this.props.children}}const Kt=new $F({defaultOptions:{queries:{retry:2,staleTime:5*60*1e3,refetchOnWindowFocus:!1}}}),aee=()=>(f.useEffect(()=>{const t=[Ve.on("CUSTOMER_CREATED",()=>{Kt.invalidateQueries({queryKey:["customers"]})}),Ve.on("CUSTOMER_UPDATED",()=>{Kt.invalidateQueries({queryKey:["customers"]})}),Ve.on("CUSTOMER_DELETED",()=>{Kt.invalidateQueries({queryKey:["customers"]})}),Ve.on("PROJECT_CREATED",()=>{Kt.invalidateQueries({queryKey:["projects"]}),Kt.invalidateQueries({queryKey:["financial-kpis"]})}),Ve.on("PROJECT_UPDATED",()=>{Kt.invalidateQueries({queryKey:["projects"]}),Kt.invalidateQueries({queryKey:["financial-kpis"]})}),Ve.on("PROJECT_STATUS_CHANGED",()=>{Kt.invalidateQueries({queryKey:["projects"]}),Kt.invalidateQueries({queryKey:["financial-kpis"]})}),Ve.on("QUOTE_CREATED",()=>{Kt.invalidateQueries({queryKey:["quotes"]})}),Ve.on("QUOTE_UPDATED",()=>{Kt.invalidateQueries({queryKey:["quotes"]})}),Ve.on("QUOTE_ACCEPTED",()=>{Kt.invalidateQueries({queryKey:["quotes"]}),Kt.invalidateQueries({queryKey:["financial-kpis"]})}),Ve.on("INVOICE_CREATED",()=>{Kt.invalidateQueries({queryKey:["invoices"]}),Kt.invalidateQueries({queryKey:["financial-kpis"]})}),Ve.on("INVOICE_UPDATED",()=>{Kt.invalidateQueries({queryKey:["invoices"]}),Kt.invalidateQueries({queryKey:["financial-kpis"]})}),Ve.on("INVOICE_PAID",()=>{Kt.invalidateQueries({queryKey:["invoices"]}),Kt.invalidateQueries({queryKey:["financial-kpis"]})}),Ve.on("TIMESHEET_CREATED",()=>{Kt.invalidateQueries({queryKey:["time-entries"]})}),Ve.on("TIMESHEET_UPDATED",()=>{Kt.invalidateQueries({queryKey:["time-entries"]})}),Ve.on("STOCK_ADJUSTED",()=>{Kt.invalidateQueries({queryKey:["materials"]}),Kt.invalidateQueries({queryKey:["stock-counts"]})}),Ve.on("STOCK_TRANSFER_COMPLETED",()=>{Kt.invalidateQueries({queryKey:["materials"]}),Kt.invalidateQueries({queryKey:["stock-transfers"]}),Kt.invalidateQueries({queryKey:["stock-counts"]})})];return()=>{t.forEach(e=>Ve.off(e))}},[]),null),iee=()=>r.jsx(see,{children:r.jsxs(HF,{client:Kt,children:[r.jsx(aee,{}),r.jsx(YY,{children:r.jsxs(NF,{children:[r.jsx(_I,{}),r.jsx(JI,{}),r.jsx(JB,{children:r.jsxs(WB,{children:[r.jsx(ds,{path:"/",element:r.jsx($2,{})}),r.jsx(ds,{path:"/login",element:r.jsx(L2,{})}),r.jsx(ds,{path:"/auth",element:r.jsx(L2,{})}),r.jsx(ds,{path:"/manager",element:r.jsx(xX,{})}),r.jsx(ds,{path:"/employee",element:r.jsx(jX,{})}),r.jsx(ds,{path:"/auth/callback",element:r.jsx(_X,{})}),r.jsx(ds,{path:"/privacy",element:r.jsx(NX,{})}),r.jsx(ds,{path:"/mitarbeiter-setup",element:r.jsx(kX,{})}),r.jsx(ds,{path:"/handwerkersoftware",element:r.jsx($2,{})}),r.jsx(ds,{path:"*",element:r.jsx(SX,{})})]})})]})})]})});mC(document.getElementById("root")).render(r.jsx(b9,{children:r.jsx(v9,{children:r.jsx(iee,{})})}));export{c3 as W};
