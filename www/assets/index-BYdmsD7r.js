var A6=Object.defineProperty;var XN=t=>{throw TypeError(t)};var P6=(t,e,n)=>e in t?A6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var fs=(t,e,n)=>P6(t,typeof e!="symbol"?e+"":e,n),$x=(t,e,n)=>e.has(t)||XN("Cannot "+n);var ue=(t,e,n)=>($x(t,e,"read from private field"),n?n.call(t):e.get(t)),xt=(t,e,n)=>e.has(t)?XN("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Qe=(t,e,n,r)=>($x(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Ft=(t,e,n)=>($x(t,e,"access private method"),n);var vf=(t,e,n,r)=>({set _(a){Qe(t,e,a,n)},get _(){return ue(t,e,r)}});function D6(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in t)){const i=Object.getOwnPropertyDescriptor(r,a);i&&Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}})();var gt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function NE(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var SE={exports:{}},tg={},kE={exports:{}},Vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wm=Symbol.for("react.element"),T6=Symbol.for("react.portal"),M6=Symbol.for("react.fragment"),R6=Symbol.for("react.strict_mode"),I6=Symbol.for("react.profiler"),O6=Symbol.for("react.provider"),L6=Symbol.for("react.context"),F6=Symbol.for("react.forward_ref"),B6=Symbol.for("react.suspense"),z6=Symbol.for("react.memo"),$6=Symbol.for("react.lazy"),JN=Symbol.iterator;function U6(t){return t===null||typeof t!="object"?null:(t=JN&&t[JN]||t["@@iterator"],typeof t=="function"?t:null)}var CE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},EE=Object.assign,AE={};function qd(t,e,n){this.props=t,this.context=e,this.refs=AE,this.updater=n||CE}qd.prototype.isReactComponent={};qd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};qd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function PE(){}PE.prototype=qd.prototype;function rb(t,e,n){this.props=t,this.context=e,this.refs=AE,this.updater=n||CE}var ab=rb.prototype=new PE;ab.constructor=rb;EE(ab,qd.prototype);ab.isPureReactComponent=!0;var e2=Array.isArray,DE=Object.prototype.hasOwnProperty,ib={current:null},TE={key:!0,ref:!0,__self:!0,__source:!0};function ME(t,e,n){var r,a={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)DE.call(e,r)&&!TE.hasOwnProperty(r)&&(a[r]=e[r]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var d=Array(c),u=0;u<c;u++)d[u]=arguments[u+2];a.children=d}if(t&&t.defaultProps)for(r in c=t.defaultProps,c)a[r]===void 0&&(a[r]=c[r]);return{$$typeof:wm,type:t,key:i,ref:o,props:a,_owner:ib.current}}function q6(t,e){return{$$typeof:wm,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ob(t){return typeof t=="object"&&t!==null&&t.$$typeof===wm}function H6(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var t2=/\/+/g;function Ux(t,e){return typeof t=="object"&&t!==null&&t.key!=null?H6(""+t.key):e.toString(36)}function up(t,e,n,r,a){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case wm:case T6:o=!0}}if(o)return o=t,a=a(o),t=r===""?"."+Ux(o,0):r,e2(a)?(n="",t!=null&&(n=t.replace(t2,"$&/")+"/"),up(a,e,n,"",function(u){return u})):a!=null&&(ob(a)&&(a=q6(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(t2,"$&/")+"/")+t)),e.push(a)),1;if(o=0,r=r===""?".":r+":",e2(t))for(var c=0;c<t.length;c++){i=t[c];var d=r+Ux(i,c);o+=up(i,e,n,d,a)}else if(d=U6(t),typeof d=="function")for(t=d.call(t),c=0;!(i=t.next()).done;)i=i.value,d=r+Ux(i,c++),o+=up(i,e,n,d,a);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function yf(t,e,n){if(t==null)return t;var r=[],a=0;return up(t,r,"","",function(i){return e.call(n,i,a++)}),r}function W6(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $s={current:null},hp={transition:null},V6={ReactCurrentDispatcher:$s,ReactCurrentBatchConfig:hp,ReactCurrentOwner:ib};function RE(){throw Error("act(...) is not supported in production builds of React.")}Vt.Children={map:yf,forEach:function(t,e,n){yf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return yf(t,function(){e++}),e},toArray:function(t){return yf(t,function(e){return e})||[]},only:function(t){if(!ob(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Vt.Component=qd;Vt.Fragment=M6;Vt.Profiler=I6;Vt.PureComponent=rb;Vt.StrictMode=R6;Vt.Suspense=B6;Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V6;Vt.act=RE;Vt.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=EE({},t.props),a=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=ib.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(d in e)DE.call(e,d)&&!TE.hasOwnProperty(d)&&(r[d]=e[d]===void 0&&c!==void 0?c[d]:e[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){c=Array(d);for(var u=0;u<d;u++)c[u]=arguments[u+2];r.children=c}return{$$typeof:wm,type:t.type,key:a,ref:i,props:r,_owner:o}};Vt.createContext=function(t){return t={$$typeof:L6,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:O6,_context:t},t.Consumer=t};Vt.createElement=ME;Vt.createFactory=function(t){var e=ME.bind(null,t);return e.type=t,e};Vt.createRef=function(){return{current:null}};Vt.forwardRef=function(t){return{$$typeof:F6,render:t}};Vt.isValidElement=ob;Vt.lazy=function(t){return{$$typeof:$6,_payload:{_status:-1,_result:t},_init:W6}};Vt.memo=function(t,e){return{$$typeof:z6,type:t,compare:e===void 0?null:e}};Vt.startTransition=function(t){var e=hp.transition;hp.transition={};try{t()}finally{hp.transition=e}};Vt.unstable_act=RE;Vt.useCallback=function(t,e){return $s.current.useCallback(t,e)};Vt.useContext=function(t){return $s.current.useContext(t)};Vt.useDebugValue=function(){};Vt.useDeferredValue=function(t){return $s.current.useDeferredValue(t)};Vt.useEffect=function(t,e){return $s.current.useEffect(t,e)};Vt.useId=function(){return $s.current.useId()};Vt.useImperativeHandle=function(t,e,n){return $s.current.useImperativeHandle(t,e,n)};Vt.useInsertionEffect=function(t,e){return $s.current.useInsertionEffect(t,e)};Vt.useLayoutEffect=function(t,e){return $s.current.useLayoutEffect(t,e)};Vt.useMemo=function(t,e){return $s.current.useMemo(t,e)};Vt.useReducer=function(t,e,n){return $s.current.useReducer(t,e,n)};Vt.useRef=function(t){return $s.current.useRef(t)};Vt.useState=function(t){return $s.current.useState(t)};Vt.useSyncExternalStore=function(t,e,n){return $s.current.useSyncExternalStore(t,e,n)};Vt.useTransition=function(){return $s.current.useTransition()};Vt.version="18.3.1";kE.exports=Vt;var g=kE.exports;const Ae=sb(g),IE=D6({__proto__:null,default:Ae},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K6=g,Z6=Symbol.for("react.element"),G6=Symbol.for("react.fragment"),Q6=Object.prototype.hasOwnProperty,Y6=K6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,X6={key:!0,ref:!0,__self:!0,__source:!0};function OE(t,e,n){var r,a={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Q6.call(e,r)&&!X6.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:Z6,type:t,key:i,ref:o,props:a,_owner:Y6.current}}tg.Fragment=G6;tg.jsx=OE;tg.jsxs=OE;SE.exports=tg;var s=SE.exports,LE={exports:{}},Nr={},FE={exports:{}},BE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(T,q){var U=T.length;T.push(q);e:for(;0<U;){var B=U-1>>>1,O=T[B];if(0<a(O,q))T[B]=q,T[U]=O,U=B;else break e}}function n(T){return T.length===0?null:T[0]}function r(T){if(T.length===0)return null;var q=T[0],U=T.pop();if(U!==q){T[0]=U;e:for(var B=0,O=T.length,z=O>>>1;B<z;){var $=2*(B+1)-1,te=T[$],ee=$+1,Q=T[ee];if(0>a(te,U))ee<O&&0>a(Q,te)?(T[B]=Q,T[ee]=U,B=ee):(T[B]=te,T[$]=U,B=$);else if(ee<O&&0>a(Q,U))T[B]=Q,T[ee]=U,B=ee;else break e}}return q}function a(T,q){var U=T.sortIndex-q.sortIndex;return U!==0?U:T.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var d=[],u=[],m=1,f=null,p=3,v=!1,w=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(T){for(var q=n(u);q!==null;){if(q.callback===null)r(u);else if(q.startTime<=T)r(u),q.sortIndex=q.expirationTime,e(d,q);else break;q=n(u)}}function S(T){if(x=!1,N(T),!w)if(n(d)!==null)w=!0,X(E);else{var q=n(u);q!==null&&F(S,q.startTime-T)}}function E(T,q){w=!1,x&&(x=!1,j(R),R=-1),v=!0;var U=p;try{for(N(q),f=n(d);f!==null&&(!(f.expirationTime>q)||T&&!D());){var B=f.callback;if(typeof B=="function"){f.callback=null,p=f.priorityLevel;var O=B(f.expirationTime<=q);q=t.unstable_now(),typeof O=="function"?f.callback=O:f===n(d)&&r(d),N(q)}else r(d);f=n(d)}if(f!==null)var z=!0;else{var $=n(u);$!==null&&F(S,$.startTime-q),z=!1}return z}finally{f=null,p=U,v=!1}}var C=!1,P=null,R=-1,H=5,I=-1;function D(){return!(t.unstable_now()-I<H)}function W(){if(P!==null){var T=t.unstable_now();I=T;var q=!0;try{q=P(!0,T)}finally{q?V():(C=!1,P=null)}}else C=!1}var V;if(typeof b=="function")V=function(){b(W)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Y=G.port2;G.port1.onmessage=W,V=function(){Y.postMessage(null)}}else V=function(){y(W,0)};function X(T){P=T,C||(C=!0,V())}function F(T,q){R=y(function(){T(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(T){T.callback=null},t.unstable_continueExecution=function(){w||v||(w=!0,X(E))},t.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<T?Math.floor(1e3/T):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(T){switch(p){case 1:case 2:case 3:var q=3;break;default:q=p}var U=p;p=q;try{return T()}finally{p=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(T,q){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var U=p;p=T;try{return q()}finally{p=U}},t.unstable_scheduleCallback=function(T,q,U){var B=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?B+U:B):U=B,T){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=U+O,T={id:m++,callback:q,priorityLevel:T,startTime:U,expirationTime:O,sortIndex:-1},U>B?(T.sortIndex=U,e(u,T),n(d)===null&&T===n(u)&&(x?(j(R),R=-1):x=!0,F(S,U-B))):(T.sortIndex=O,e(d,T),w||v||(w=!0,X(E))),T},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(T){var q=p;return function(){var U=p;p=q;try{return T.apply(this,arguments)}finally{p=U}}}})(BE);FE.exports=BE;var J6=FE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e8=g,yr=J6;function Me(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var zE=new Set,wh={};function Ql(t,e){kd(t,e),kd(t+"Capture",e)}function kd(t,e){for(wh[t]=e,t=0;t<e.length;t++)zE.add(e[t])}var ji=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wy=Object.prototype.hasOwnProperty,t8=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,n2={},s2={};function n8(t){return Wy.call(s2,t)?!0:Wy.call(n2,t)?!1:t8.test(t)?s2[t]=!0:(n2[t]=!0,!1)}function s8(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function r8(t,e,n,r){if(e===null||typeof e>"u"||s8(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Us(t,e,n,r,a,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var ws={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ws[t]=new Us(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];ws[e]=new Us(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ws[t]=new Us(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ws[t]=new Us(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ws[t]=new Us(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ws[t]=new Us(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ws[t]=new Us(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ws[t]=new Us(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ws[t]=new Us(t,5,!1,t.toLowerCase(),null,!1,!1)});var lb=/[\-:]([a-z])/g;function cb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(lb,cb);ws[e]=new Us(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(lb,cb);ws[e]=new Us(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(lb,cb);ws[e]=new Us(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ws[t]=new Us(t,1,!1,t.toLowerCase(),null,!1,!1)});ws.xlinkHref=new Us("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ws[t]=new Us(t,1,!1,t.toLowerCase(),null,!0,!0)});function db(t,e,n,r){var a=ws.hasOwnProperty(e)?ws[e]:null;(a!==null?a.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(r8(e,n,a,r)&&(n=null),r||a===null?n8(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,r=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ti=e8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_f=Symbol.for("react.element"),Bc=Symbol.for("react.portal"),zc=Symbol.for("react.fragment"),ub=Symbol.for("react.strict_mode"),Vy=Symbol.for("react.profiler"),$E=Symbol.for("react.provider"),UE=Symbol.for("react.context"),hb=Symbol.for("react.forward_ref"),Ky=Symbol.for("react.suspense"),Zy=Symbol.for("react.suspense_list"),mb=Symbol.for("react.memo"),Ki=Symbol.for("react.lazy"),qE=Symbol.for("react.offscreen"),r2=Symbol.iterator;function wu(t){return t===null||typeof t!="object"?null:(t=r2&&t[r2]||t["@@iterator"],typeof t=="function"?t:null)}var An=Object.assign,qx;function Ru(t){if(qx===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qx=e&&e[1]||""}return`
`+qx+t}var Hx=!1;function Wx(t,e){if(!t||Hx)return"";Hx=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=r.stack.split(`
`),o=a.length-1,c=i.length-1;1<=o&&0<=c&&a[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(a[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||a[o]!==i[c]){var d=`
`+a[o].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=o&&0<=c);break}}}finally{Hx=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ru(t):""}function a8(t){switch(t.tag){case 5:return Ru(t.type);case 16:return Ru("Lazy");case 13:return Ru("Suspense");case 19:return Ru("SuspenseList");case 0:case 2:case 15:return t=Wx(t.type,!1),t;case 11:return t=Wx(t.type.render,!1),t;case 1:return t=Wx(t.type,!0),t;default:return""}}function Gy(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zc:return"Fragment";case Bc:return"Portal";case Vy:return"Profiler";case ub:return"StrictMode";case Ky:return"Suspense";case Zy:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case UE:return(t.displayName||"Context")+".Consumer";case $E:return(t._context.displayName||"Context")+".Provider";case hb:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case mb:return e=t.displayName||null,e!==null?e:Gy(t.type)||"Memo";case Ki:e=t._payload,t=t._init;try{return Gy(t(e))}catch{}}return null}function i8(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gy(e);case 8:return e===ub?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Eo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function HE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function o8(t){var e=HE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wf(t){t._valueTracker||(t._valueTracker=o8(t))}function WE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=HE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function $p(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Qy(t,e){var n=e.checked;return An({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function a2(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Eo(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function VE(t,e){e=e.checked,e!=null&&db(t,"checked",e,!1)}function Yy(t,e){VE(t,e);var n=Eo(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Xy(t,e.type,n):e.hasOwnProperty("defaultValue")&&Xy(t,e.type,Eo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function i2(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Xy(t,e,n){(e!=="number"||$p(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Iu=Array.isArray;function td(t,e,n,r){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Eo(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,r&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function Jy(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Me(91));return An({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function o2(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Me(92));if(Iu(n)){if(1<n.length)throw Error(Me(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Eo(n)}}function KE(t,e){var n=Eo(e.value),r=Eo(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function l2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ZE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function e_(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ZE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var bf,GE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(bf=bf||document.createElement("div"),bf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=bf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function bh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var eh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},l8=["Webkit","ms","Moz","O"];Object.keys(eh).forEach(function(t){l8.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),eh[e]=eh[t]})});function QE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||eh.hasOwnProperty(t)&&eh[t]?(""+e).trim():e+"px"}function YE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=QE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,a):t[n]=a}}var c8=An({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function t_(t,e){if(e){if(c8[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Me(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Me(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Me(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Me(62))}}function n_(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var s_=null;function fb(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var r_=null,nd=null,sd=null;function c2(t){if(t=Nm(t)){if(typeof r_!="function")throw Error(Me(280));var e=t.stateNode;e&&(e=ig(e),r_(t.stateNode,t.type,e))}}function XE(t){nd?sd?sd.push(t):sd=[t]:nd=t}function JE(){if(nd){var t=nd,e=sd;if(sd=nd=null,c2(t),e)for(t=0;t<e.length;t++)c2(e[t])}}function e4(t,e){return t(e)}function t4(){}var Vx=!1;function n4(t,e,n){if(Vx)return t(e,n);Vx=!0;try{return e4(t,e,n)}finally{Vx=!1,(nd!==null||sd!==null)&&(t4(),JE())}}function jh(t,e){var n=t.stateNode;if(n===null)return null;var r=ig(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Me(231,e,typeof n));return n}var a_=!1;if(ji)try{var bu={};Object.defineProperty(bu,"passive",{get:function(){a_=!0}}),window.addEventListener("test",bu,bu),window.removeEventListener("test",bu,bu)}catch{a_=!1}function d8(t,e,n,r,a,i,o,c,d){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(m){this.onError(m)}}var th=!1,Up=null,qp=!1,i_=null,u8={onError:function(t){th=!0,Up=t}};function h8(t,e,n,r,a,i,o,c,d){th=!1,Up=null,d8.apply(u8,arguments)}function m8(t,e,n,r,a,i,o,c,d){if(h8.apply(this,arguments),th){if(th){var u=Up;th=!1,Up=null}else throw Error(Me(198));qp||(qp=!0,i_=u)}}function Yl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function s4(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function d2(t){if(Yl(t)!==t)throw Error(Me(188))}function f8(t){var e=t.alternate;if(!e){if(e=Yl(t),e===null)throw Error(Me(188));return e!==t?null:t}for(var n=t,r=e;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return d2(a),t;if(i===r)return d2(a),e;i=i.sibling}throw Error(Me(188))}if(n.return!==r.return)n=a,r=i;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=i;break}if(c===r){o=!0,r=a,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=a;break}if(c===r){o=!0,r=i,n=a;break}c=c.sibling}if(!o)throw Error(Me(189))}}if(n.alternate!==r)throw Error(Me(190))}if(n.tag!==3)throw Error(Me(188));return n.stateNode.current===n?t:e}function r4(t){return t=f8(t),t!==null?a4(t):null}function a4(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=a4(t);if(e!==null)return e;t=t.sibling}return null}var i4=yr.unstable_scheduleCallback,u2=yr.unstable_cancelCallback,p8=yr.unstable_shouldYield,g8=yr.unstable_requestPaint,Rn=yr.unstable_now,x8=yr.unstable_getCurrentPriorityLevel,pb=yr.unstable_ImmediatePriority,o4=yr.unstable_UserBlockingPriority,Hp=yr.unstable_NormalPriority,v8=yr.unstable_LowPriority,l4=yr.unstable_IdlePriority,ng=null,Ha=null;function y8(t){if(Ha&&typeof Ha.onCommitFiberRoot=="function")try{Ha.onCommitFiberRoot(ng,t,void 0,(t.current.flags&128)===128)}catch{}}var ua=Math.clz32?Math.clz32:b8,_8=Math.log,w8=Math.LN2;function b8(t){return t>>>=0,t===0?32:31-(_8(t)/w8|0)|0}var jf=64,Nf=4194304;function Ou(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Wp(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,a=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var c=o&~a;c!==0?r=Ou(c):(i&=o,i!==0&&(r=Ou(i)))}else o=n&~a,o!==0?r=Ou(o):i!==0&&(r=Ou(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&a)&&(a=r&-r,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ua(e),a=1<<n,r|=t[n],e&=~a;return r}function j8(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function N8(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-ua(i),c=1<<o,d=a[o];d===-1?(!(c&n)||c&r)&&(a[o]=j8(c,e)):d<=e&&(t.expiredLanes|=c),i&=~c}}function o_(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function c4(){var t=jf;return jf<<=1,!(jf&4194240)&&(jf=64),t}function Kx(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function bm(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ua(e),t[e]=n}function S8(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-ua(n),i=1<<a;e[a]=0,r[a]=-1,t[a]=-1,n&=~i}}function gb(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ua(n),a=1<<r;a&e|t[r]&e&&(t[r]|=e),n&=~a}}var ln=0;function d4(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var u4,xb,h4,m4,f4,l_=!1,Sf=[],xo=null,vo=null,yo=null,Nh=new Map,Sh=new Map,Yi=[],k8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function h2(t,e){switch(t){case"focusin":case"focusout":xo=null;break;case"dragenter":case"dragleave":vo=null;break;case"mouseover":case"mouseout":yo=null;break;case"pointerover":case"pointerout":Nh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sh.delete(e.pointerId)}}function ju(t,e,n,r,a,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},e!==null&&(e=Nm(e),e!==null&&xb(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function C8(t,e,n,r,a){switch(e){case"focusin":return xo=ju(xo,t,e,n,r,a),!0;case"dragenter":return vo=ju(vo,t,e,n,r,a),!0;case"mouseover":return yo=ju(yo,t,e,n,r,a),!0;case"pointerover":var i=a.pointerId;return Nh.set(i,ju(Nh.get(i)||null,t,e,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Sh.set(i,ju(Sh.get(i)||null,t,e,n,r,a)),!0}return!1}function p4(t){var e=fl(t.target);if(e!==null){var n=Yl(e);if(n!==null){if(e=n.tag,e===13){if(e=s4(n),e!==null){t.blockedOn=e,f4(t.priority,function(){h4(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function mp(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=c_(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);s_=r,n.target.dispatchEvent(r),s_=null}else return e=Nm(n),e!==null&&xb(e),t.blockedOn=n,!1;e.shift()}return!0}function m2(t,e,n){mp(t)&&n.delete(e)}function E8(){l_=!1,xo!==null&&mp(xo)&&(xo=null),vo!==null&&mp(vo)&&(vo=null),yo!==null&&mp(yo)&&(yo=null),Nh.forEach(m2),Sh.forEach(m2)}function Nu(t,e){t.blockedOn===e&&(t.blockedOn=null,l_||(l_=!0,yr.unstable_scheduleCallback(yr.unstable_NormalPriority,E8)))}function kh(t){function e(a){return Nu(a,t)}if(0<Sf.length){Nu(Sf[0],t);for(var n=1;n<Sf.length;n++){var r=Sf[n];r.blockedOn===t&&(r.blockedOn=null)}}for(xo!==null&&Nu(xo,t),vo!==null&&Nu(vo,t),yo!==null&&Nu(yo,t),Nh.forEach(e),Sh.forEach(e),n=0;n<Yi.length;n++)r=Yi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Yi.length&&(n=Yi[0],n.blockedOn===null);)p4(n),n.blockedOn===null&&Yi.shift()}var rd=Ti.ReactCurrentBatchConfig,Vp=!0;function A8(t,e,n,r){var a=ln,i=rd.transition;rd.transition=null;try{ln=1,vb(t,e,n,r)}finally{ln=a,rd.transition=i}}function P8(t,e,n,r){var a=ln,i=rd.transition;rd.transition=null;try{ln=4,vb(t,e,n,r)}finally{ln=a,rd.transition=i}}function vb(t,e,n,r){if(Vp){var a=c_(t,e,n,r);if(a===null)sv(t,e,r,Kp,n),h2(t,r);else if(C8(a,t,e,n,r))r.stopPropagation();else if(h2(t,r),e&4&&-1<k8.indexOf(t)){for(;a!==null;){var i=Nm(a);if(i!==null&&u4(i),i=c_(t,e,n,r),i===null&&sv(t,e,r,Kp,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else sv(t,e,r,null,n)}}var Kp=null;function c_(t,e,n,r){if(Kp=null,t=fb(r),t=fl(t),t!==null)if(e=Yl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=s4(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Kp=t,null}function g4(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(x8()){case pb:return 1;case o4:return 4;case Hp:case v8:return 16;case l4:return 536870912;default:return 16}default:return 16}}var ho=null,yb=null,fp=null;function x4(){if(fp)return fp;var t,e=yb,n=e.length,r,a="value"in ho?ho.value:ho.textContent,i=a.length;for(t=0;t<n&&e[t]===a[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===a[i-r];r++);return fp=a.slice(t,1<r?1-r:void 0)}function pp(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function kf(){return!0}function f2(){return!1}function Sr(t){function e(n,r,a,i,o){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(n=t[c],this[c]=n?n(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?kf:f2,this.isPropagationStopped=f2,this}return An(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=kf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=kf)},persist:function(){},isPersistent:kf}),e}var Hd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_b=Sr(Hd),jm=An({},Hd,{view:0,detail:0}),D8=Sr(jm),Zx,Gx,Su,sg=An({},jm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Su&&(Su&&t.type==="mousemove"?(Zx=t.screenX-Su.screenX,Gx=t.screenY-Su.screenY):Gx=Zx=0,Su=t),Zx)},movementY:function(t){return"movementY"in t?t.movementY:Gx}}),p2=Sr(sg),T8=An({},sg,{dataTransfer:0}),M8=Sr(T8),R8=An({},jm,{relatedTarget:0}),Qx=Sr(R8),I8=An({},Hd,{animationName:0,elapsedTime:0,pseudoElement:0}),O8=Sr(I8),L8=An({},Hd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),F8=Sr(L8),B8=An({},Hd,{data:0}),g2=Sr(B8),z8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},U8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function q8(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=U8[t])?!!e[t]:!1}function wb(){return q8}var H8=An({},jm,{key:function(t){if(t.key){var e=z8[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=pp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?$8[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wb,charCode:function(t){return t.type==="keypress"?pp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?pp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),W8=Sr(H8),V8=An({},sg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),x2=Sr(V8),K8=An({},jm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wb}),Z8=Sr(K8),G8=An({},Hd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Q8=Sr(G8),Y8=An({},sg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),X8=Sr(Y8),J8=[9,13,27,32],bb=ji&&"CompositionEvent"in window,nh=null;ji&&"documentMode"in document&&(nh=document.documentMode);var eL=ji&&"TextEvent"in window&&!nh,v4=ji&&(!bb||nh&&8<nh&&11>=nh),v2=" ",y2=!1;function y4(t,e){switch(t){case"keyup":return J8.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _4(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var $c=!1;function tL(t,e){switch(t){case"compositionend":return _4(e);case"keypress":return e.which!==32?null:(y2=!0,v2);case"textInput":return t=e.data,t===v2&&y2?null:t;default:return null}}function nL(t,e){if($c)return t==="compositionend"||!bb&&y4(t,e)?(t=x4(),fp=yb=ho=null,$c=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return v4&&e.locale!=="ko"?null:e.data;default:return null}}var sL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!sL[t.type]:e==="textarea"}function w4(t,e,n,r){XE(r),e=Zp(e,"onChange"),0<e.length&&(n=new _b("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var sh=null,Ch=null;function rL(t){T4(t,0)}function rg(t){var e=Hc(t);if(WE(e))return t}function aL(t,e){if(t==="change")return e}var b4=!1;if(ji){var Yx;if(ji){var Xx="oninput"in document;if(!Xx){var w2=document.createElement("div");w2.setAttribute("oninput","return;"),Xx=typeof w2.oninput=="function"}Yx=Xx}else Yx=!1;b4=Yx&&(!document.documentMode||9<document.documentMode)}function b2(){sh&&(sh.detachEvent("onpropertychange",j4),Ch=sh=null)}function j4(t){if(t.propertyName==="value"&&rg(Ch)){var e=[];w4(e,Ch,t,fb(t)),n4(rL,e)}}function iL(t,e,n){t==="focusin"?(b2(),sh=e,Ch=n,sh.attachEvent("onpropertychange",j4)):t==="focusout"&&b2()}function oL(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return rg(Ch)}function lL(t,e){if(t==="click")return rg(e)}function cL(t,e){if(t==="input"||t==="change")return rg(e)}function dL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ga=typeof Object.is=="function"?Object.is:dL;function Eh(t,e){if(ga(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!Wy.call(e,a)||!ga(t[a],e[a]))return!1}return!0}function j2(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function N2(t,e){var n=j2(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=j2(n)}}function N4(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?N4(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function S4(){for(var t=window,e=$p();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=$p(t.document)}return e}function jb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function uL(t){var e=S4(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&N4(n.ownerDocument.documentElement,n)){if(r!==null&&jb(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!t.extend&&i>r&&(a=r,r=i,i=a),a=N2(n,i);var o=N2(n,r);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var hL=ji&&"documentMode"in document&&11>=document.documentMode,Uc=null,d_=null,rh=null,u_=!1;function S2(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;u_||Uc==null||Uc!==$p(r)||(r=Uc,"selectionStart"in r&&jb(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),rh&&Eh(rh,r)||(rh=r,r=Zp(d_,"onSelect"),0<r.length&&(e=new _b("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Uc)))}function Cf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var qc={animationend:Cf("Animation","AnimationEnd"),animationiteration:Cf("Animation","AnimationIteration"),animationstart:Cf("Animation","AnimationStart"),transitionend:Cf("Transition","TransitionEnd")},Jx={},k4={};ji&&(k4=document.createElement("div").style,"AnimationEvent"in window||(delete qc.animationend.animation,delete qc.animationiteration.animation,delete qc.animationstart.animation),"TransitionEvent"in window||delete qc.transitionend.transition);function ag(t){if(Jx[t])return Jx[t];if(!qc[t])return t;var e=qc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in k4)return Jx[t]=e[n];return t}var C4=ag("animationend"),E4=ag("animationiteration"),A4=ag("animationstart"),P4=ag("transitionend"),D4=new Map,k2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $o(t,e){D4.set(t,e),Ql(e,[t])}for(var ev=0;ev<k2.length;ev++){var tv=k2[ev],mL=tv.toLowerCase(),fL=tv[0].toUpperCase()+tv.slice(1);$o(mL,"on"+fL)}$o(C4,"onAnimationEnd");$o(E4,"onAnimationIteration");$o(A4,"onAnimationStart");$o("dblclick","onDoubleClick");$o("focusin","onFocus");$o("focusout","onBlur");$o(P4,"onTransitionEnd");kd("onMouseEnter",["mouseout","mouseover"]);kd("onMouseLeave",["mouseout","mouseover"]);kd("onPointerEnter",["pointerout","pointerover"]);kd("onPointerLeave",["pointerout","pointerover"]);Ql("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ql("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ql("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ql("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ql("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ql("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pL=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lu));function C2(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,m8(r,e,void 0,t),t.currentTarget=null}function T4(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],a=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var c=r[o],d=c.instance,u=c.currentTarget;if(c=c.listener,d!==i&&a.isPropagationStopped())break e;C2(a,c,u),i=d}else for(o=0;o<r.length;o++){if(c=r[o],d=c.instance,u=c.currentTarget,c=c.listener,d!==i&&a.isPropagationStopped())break e;C2(a,c,u),i=d}}}if(qp)throw t=i_,qp=!1,i_=null,t}function gn(t,e){var n=e[g_];n===void 0&&(n=e[g_]=new Set);var r=t+"__bubble";n.has(r)||(M4(e,t,2,!1),n.add(r))}function nv(t,e,n){var r=0;e&&(r|=4),M4(n,t,r,e)}var Ef="_reactListening"+Math.random().toString(36).slice(2);function Ah(t){if(!t[Ef]){t[Ef]=!0,zE.forEach(function(n){n!=="selectionchange"&&(pL.has(n)||nv(n,!1,t),nv(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ef]||(e[Ef]=!0,nv("selectionchange",!1,e))}}function M4(t,e,n,r){switch(g4(e)){case 1:var a=A8;break;case 4:a=P8;break;default:a=vb}n=a.bind(null,e,n,t),a=void 0,!a_||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),r?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function sv(t,e,n,r,a){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var c=r.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(o===4)for(o=r.return;o!==null;){var d=o.tag;if((d===3||d===4)&&(d=o.stateNode.containerInfo,d===a||d.nodeType===8&&d.parentNode===a))return;o=o.return}for(;c!==null;){if(o=fl(c),o===null)return;if(d=o.tag,d===5||d===6){r=i=o;continue e}c=c.parentNode}}r=r.return}n4(function(){var u=i,m=fb(n),f=[];e:{var p=D4.get(t);if(p!==void 0){var v=_b,w=t;switch(t){case"keypress":if(pp(n)===0)break e;case"keydown":case"keyup":v=W8;break;case"focusin":w="focus",v=Qx;break;case"focusout":w="blur",v=Qx;break;case"beforeblur":case"afterblur":v=Qx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=p2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=M8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=Z8;break;case C4:case E4:case A4:v=O8;break;case P4:v=Q8;break;case"scroll":v=D8;break;case"wheel":v=X8;break;case"copy":case"cut":case"paste":v=F8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=x2}var x=(e&4)!==0,y=!x&&t==="scroll",j=x?p!==null?p+"Capture":null:p;x=[];for(var b=u,N;b!==null;){N=b;var S=N.stateNode;if(N.tag===5&&S!==null&&(N=S,j!==null&&(S=jh(b,j),S!=null&&x.push(Ph(b,S,N)))),y)break;b=b.return}0<x.length&&(p=new v(p,w,null,n,m),f.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",p&&n!==s_&&(w=n.relatedTarget||n.fromElement)&&(fl(w)||w[Ni]))break e;if((v||p)&&(p=m.window===m?m:(p=m.ownerDocument)?p.defaultView||p.parentWindow:window,v?(w=n.relatedTarget||n.toElement,v=u,w=w?fl(w):null,w!==null&&(y=Yl(w),w!==y||w.tag!==5&&w.tag!==6)&&(w=null)):(v=null,w=u),v!==w)){if(x=p2,S="onMouseLeave",j="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(x=x2,S="onPointerLeave",j="onPointerEnter",b="pointer"),y=v==null?p:Hc(v),N=w==null?p:Hc(w),p=new x(S,b+"leave",v,n,m),p.target=y,p.relatedTarget=N,S=null,fl(m)===u&&(x=new x(j,b+"enter",w,n,m),x.target=N,x.relatedTarget=y,S=x),y=S,v&&w)t:{for(x=v,j=w,b=0,N=x;N;N=_c(N))b++;for(N=0,S=j;S;S=_c(S))N++;for(;0<b-N;)x=_c(x),b--;for(;0<N-b;)j=_c(j),N--;for(;b--;){if(x===j||j!==null&&x===j.alternate)break t;x=_c(x),j=_c(j)}x=null}else x=null;v!==null&&E2(f,p,v,x,!1),w!==null&&y!==null&&E2(f,y,w,x,!0)}}e:{if(p=u?Hc(u):window,v=p.nodeName&&p.nodeName.toLowerCase(),v==="select"||v==="input"&&p.type==="file")var E=aL;else if(_2(p))if(b4)E=cL;else{E=oL;var C=iL}else(v=p.nodeName)&&v.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(E=lL);if(E&&(E=E(t,u))){w4(f,E,n,m);break e}C&&C(t,p,u),t==="focusout"&&(C=p._wrapperState)&&C.controlled&&p.type==="number"&&Xy(p,"number",p.value)}switch(C=u?Hc(u):window,t){case"focusin":(_2(C)||C.contentEditable==="true")&&(Uc=C,d_=u,rh=null);break;case"focusout":rh=d_=Uc=null;break;case"mousedown":u_=!0;break;case"contextmenu":case"mouseup":case"dragend":u_=!1,S2(f,n,m);break;case"selectionchange":if(hL)break;case"keydown":case"keyup":S2(f,n,m)}var P;if(bb)e:{switch(t){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else $c?y4(t,n)&&(R="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(R="onCompositionStart");R&&(v4&&n.locale!=="ko"&&($c||R!=="onCompositionStart"?R==="onCompositionEnd"&&$c&&(P=x4()):(ho=m,yb="value"in ho?ho.value:ho.textContent,$c=!0)),C=Zp(u,R),0<C.length&&(R=new g2(R,t,null,n,m),f.push({event:R,listeners:C}),P?R.data=P:(P=_4(n),P!==null&&(R.data=P)))),(P=eL?tL(t,n):nL(t,n))&&(u=Zp(u,"onBeforeInput"),0<u.length&&(m=new g2("onBeforeInput","beforeinput",null,n,m),f.push({event:m,listeners:u}),m.data=P))}T4(f,e)})}function Ph(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Zp(t,e){for(var n=e+"Capture",r=[];t!==null;){var a=t,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=jh(t,n),i!=null&&r.unshift(Ph(t,i,a)),i=jh(t,e),i!=null&&r.push(Ph(t,i,a))),t=t.return}return r}function _c(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function E2(t,e,n,r,a){for(var i=e._reactName,o=[];n!==null&&n!==r;){var c=n,d=c.alternate,u=c.stateNode;if(d!==null&&d===r)break;c.tag===5&&u!==null&&(c=u,a?(d=jh(n,i),d!=null&&o.unshift(Ph(n,d,c))):a||(d=jh(n,i),d!=null&&o.push(Ph(n,d,c)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var gL=/\r\n?/g,xL=/\u0000|\uFFFD/g;function A2(t){return(typeof t=="string"?t:""+t).replace(gL,`
`).replace(xL,"")}function Af(t,e,n){if(e=A2(e),A2(t)!==e&&n)throw Error(Me(425))}function Gp(){}var h_=null,m_=null;function f_(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var p_=typeof setTimeout=="function"?setTimeout:void 0,vL=typeof clearTimeout=="function"?clearTimeout:void 0,P2=typeof Promise=="function"?Promise:void 0,yL=typeof queueMicrotask=="function"?queueMicrotask:typeof P2<"u"?function(t){return P2.resolve(null).then(t).catch(_L)}:p_;function _L(t){setTimeout(function(){throw t})}function rv(t,e){var n=e,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){t.removeChild(a),kh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);kh(e)}function _o(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function D2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Wd=Math.random().toString(36).slice(2),La="__reactFiber$"+Wd,Dh="__reactProps$"+Wd,Ni="__reactContainer$"+Wd,g_="__reactEvents$"+Wd,wL="__reactListeners$"+Wd,bL="__reactHandles$"+Wd;function fl(t){var e=t[La];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ni]||n[La]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=D2(t);t!==null;){if(n=t[La])return n;t=D2(t)}return e}t=n,n=t.parentNode}return null}function Nm(t){return t=t[La]||t[Ni],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Me(33))}function ig(t){return t[Dh]||null}var x_=[],Wc=-1;function Uo(t){return{current:t}}function xn(t){0>Wc||(t.current=x_[Wc],x_[Wc]=null,Wc--)}function mn(t,e){Wc++,x_[Wc]=t.current,t.current=e}var Ao={},Ps=Uo(Ao),er=Uo(!1),Il=Ao;function Cd(t,e){var n=t.type.contextTypes;if(!n)return Ao;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function tr(t){return t=t.childContextTypes,t!=null}function Qp(){xn(er),xn(Ps)}function T2(t,e,n){if(Ps.current!==Ao)throw Error(Me(168));mn(Ps,e),mn(er,n)}function R4(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in e))throw Error(Me(108,i8(t)||"Unknown",a));return An({},n,r)}function Yp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ao,Il=Ps.current,mn(Ps,t),mn(er,er.current),!0}function M2(t,e,n){var r=t.stateNode;if(!r)throw Error(Me(169));n?(t=R4(t,e,Il),r.__reactInternalMemoizedMergedChildContext=t,xn(er),xn(Ps),mn(Ps,t)):xn(er),mn(er,n)}var gi=null,og=!1,av=!1;function I4(t){gi===null?gi=[t]:gi.push(t)}function jL(t){og=!0,I4(t)}function qo(){if(!av&&gi!==null){av=!0;var t=0,e=ln;try{var n=gi;for(ln=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}gi=null,og=!1}catch(a){throw gi!==null&&(gi=gi.slice(t+1)),i4(pb,qo),a}finally{ln=e,av=!1}}return null}var Vc=[],Kc=0,Xp=null,Jp=0,Tr=[],Mr=0,Ol=null,vi=1,yi="";function rl(t,e){Vc[Kc++]=Jp,Vc[Kc++]=Xp,Xp=t,Jp=e}function O4(t,e,n){Tr[Mr++]=vi,Tr[Mr++]=yi,Tr[Mr++]=Ol,Ol=t;var r=vi;t=yi;var a=32-ua(r)-1;r&=~(1<<a),n+=1;var i=32-ua(e)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,vi=1<<32-ua(e)+a|n<<a|r,yi=i+t}else vi=1<<i|n<<a|r,yi=t}function Nb(t){t.return!==null&&(rl(t,1),O4(t,1,0))}function Sb(t){for(;t===Xp;)Xp=Vc[--Kc],Vc[Kc]=null,Jp=Vc[--Kc],Vc[Kc]=null;for(;t===Ol;)Ol=Tr[--Mr],Tr[Mr]=null,yi=Tr[--Mr],Tr[Mr]=null,vi=Tr[--Mr],Tr[Mr]=null}var fr=null,hr=null,yn=!1,ia=null;function L4(t,e){var n=Rr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function R2(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,fr=t,hr=_o(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,fr=t,hr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ol!==null?{id:vi,overflow:yi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Rr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,fr=t,hr=null,!0):!1;default:return!1}}function v_(t){return(t.mode&1)!==0&&(t.flags&128)===0}function y_(t){if(yn){var e=hr;if(e){var n=e;if(!R2(t,e)){if(v_(t))throw Error(Me(418));e=_o(n.nextSibling);var r=fr;e&&R2(t,e)?L4(r,n):(t.flags=t.flags&-4097|2,yn=!1,fr=t)}}else{if(v_(t))throw Error(Me(418));t.flags=t.flags&-4097|2,yn=!1,fr=t}}}function I2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fr=t}function Pf(t){if(t!==fr)return!1;if(!yn)return I2(t),yn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!f_(t.type,t.memoizedProps)),e&&(e=hr)){if(v_(t))throw F4(),Error(Me(418));for(;e;)L4(t,e),e=_o(e.nextSibling)}if(I2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Me(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){hr=_o(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}hr=null}}else hr=fr?_o(t.stateNode.nextSibling):null;return!0}function F4(){for(var t=hr;t;)t=_o(t.nextSibling)}function Ed(){hr=fr=null,yn=!1}function kb(t){ia===null?ia=[t]:ia.push(t)}var NL=Ti.ReactCurrentBatchConfig;function ku(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Me(309));var r=n.stateNode}if(!r)throw Error(Me(147,t));var a=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=a.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Me(284));if(!n._owner)throw Error(Me(290,t))}return t}function Df(t,e){throw t=Object.prototype.toString.call(e),Error(Me(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function O2(t){var e=t._init;return e(t._payload)}function B4(t){function e(j,b){if(t){var N=j.deletions;N===null?(j.deletions=[b],j.flags|=16):N.push(b)}}function n(j,b){if(!t)return null;for(;b!==null;)e(j,b),b=b.sibling;return null}function r(j,b){for(j=new Map;b!==null;)b.key!==null?j.set(b.key,b):j.set(b.index,b),b=b.sibling;return j}function a(j,b){return j=No(j,b),j.index=0,j.sibling=null,j}function i(j,b,N){return j.index=N,t?(N=j.alternate,N!==null?(N=N.index,N<b?(j.flags|=2,b):N):(j.flags|=2,b)):(j.flags|=1048576,b)}function o(j){return t&&j.alternate===null&&(j.flags|=2),j}function c(j,b,N,S){return b===null||b.tag!==6?(b=hv(N,j.mode,S),b.return=j,b):(b=a(b,N),b.return=j,b)}function d(j,b,N,S){var E=N.type;return E===zc?m(j,b,N.props.children,S,N.key):b!==null&&(b.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ki&&O2(E)===b.type)?(S=a(b,N.props),S.ref=ku(j,b,N),S.return=j,S):(S=bp(N.type,N.key,N.props,null,j.mode,S),S.ref=ku(j,b,N),S.return=j,S)}function u(j,b,N,S){return b===null||b.tag!==4||b.stateNode.containerInfo!==N.containerInfo||b.stateNode.implementation!==N.implementation?(b=mv(N,j.mode,S),b.return=j,b):(b=a(b,N.children||[]),b.return=j,b)}function m(j,b,N,S,E){return b===null||b.tag!==7?(b=El(N,j.mode,S,E),b.return=j,b):(b=a(b,N),b.return=j,b)}function f(j,b,N){if(typeof b=="string"&&b!==""||typeof b=="number")return b=hv(""+b,j.mode,N),b.return=j,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case _f:return N=bp(b.type,b.key,b.props,null,j.mode,N),N.ref=ku(j,null,b),N.return=j,N;case Bc:return b=mv(b,j.mode,N),b.return=j,b;case Ki:var S=b._init;return f(j,S(b._payload),N)}if(Iu(b)||wu(b))return b=El(b,j.mode,N,null),b.return=j,b;Df(j,b)}return null}function p(j,b,N,S){var E=b!==null?b.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return E!==null?null:c(j,b,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case _f:return N.key===E?d(j,b,N,S):null;case Bc:return N.key===E?u(j,b,N,S):null;case Ki:return E=N._init,p(j,b,E(N._payload),S)}if(Iu(N)||wu(N))return E!==null?null:m(j,b,N,S,null);Df(j,N)}return null}function v(j,b,N,S,E){if(typeof S=="string"&&S!==""||typeof S=="number")return j=j.get(N)||null,c(b,j,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case _f:return j=j.get(S.key===null?N:S.key)||null,d(b,j,S,E);case Bc:return j=j.get(S.key===null?N:S.key)||null,u(b,j,S,E);case Ki:var C=S._init;return v(j,b,N,C(S._payload),E)}if(Iu(S)||wu(S))return j=j.get(N)||null,m(b,j,S,E,null);Df(b,S)}return null}function w(j,b,N,S){for(var E=null,C=null,P=b,R=b=0,H=null;P!==null&&R<N.length;R++){P.index>R?(H=P,P=null):H=P.sibling;var I=p(j,P,N[R],S);if(I===null){P===null&&(P=H);break}t&&P&&I.alternate===null&&e(j,P),b=i(I,b,R),C===null?E=I:C.sibling=I,C=I,P=H}if(R===N.length)return n(j,P),yn&&rl(j,R),E;if(P===null){for(;R<N.length;R++)P=f(j,N[R],S),P!==null&&(b=i(P,b,R),C===null?E=P:C.sibling=P,C=P);return yn&&rl(j,R),E}for(P=r(j,P);R<N.length;R++)H=v(P,j,R,N[R],S),H!==null&&(t&&H.alternate!==null&&P.delete(H.key===null?R:H.key),b=i(H,b,R),C===null?E=H:C.sibling=H,C=H);return t&&P.forEach(function(D){return e(j,D)}),yn&&rl(j,R),E}function x(j,b,N,S){var E=wu(N);if(typeof E!="function")throw Error(Me(150));if(N=E.call(N),N==null)throw Error(Me(151));for(var C=E=null,P=b,R=b=0,H=null,I=N.next();P!==null&&!I.done;R++,I=N.next()){P.index>R?(H=P,P=null):H=P.sibling;var D=p(j,P,I.value,S);if(D===null){P===null&&(P=H);break}t&&P&&D.alternate===null&&e(j,P),b=i(D,b,R),C===null?E=D:C.sibling=D,C=D,P=H}if(I.done)return n(j,P),yn&&rl(j,R),E;if(P===null){for(;!I.done;R++,I=N.next())I=f(j,I.value,S),I!==null&&(b=i(I,b,R),C===null?E=I:C.sibling=I,C=I);return yn&&rl(j,R),E}for(P=r(j,P);!I.done;R++,I=N.next())I=v(P,j,R,I.value,S),I!==null&&(t&&I.alternate!==null&&P.delete(I.key===null?R:I.key),b=i(I,b,R),C===null?E=I:C.sibling=I,C=I);return t&&P.forEach(function(W){return e(j,W)}),yn&&rl(j,R),E}function y(j,b,N,S){if(typeof N=="object"&&N!==null&&N.type===zc&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case _f:e:{for(var E=N.key,C=b;C!==null;){if(C.key===E){if(E=N.type,E===zc){if(C.tag===7){n(j,C.sibling),b=a(C,N.props.children),b.return=j,j=b;break e}}else if(C.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ki&&O2(E)===C.type){n(j,C.sibling),b=a(C,N.props),b.ref=ku(j,C,N),b.return=j,j=b;break e}n(j,C);break}else e(j,C);C=C.sibling}N.type===zc?(b=El(N.props.children,j.mode,S,N.key),b.return=j,j=b):(S=bp(N.type,N.key,N.props,null,j.mode,S),S.ref=ku(j,b,N),S.return=j,j=S)}return o(j);case Bc:e:{for(C=N.key;b!==null;){if(b.key===C)if(b.tag===4&&b.stateNode.containerInfo===N.containerInfo&&b.stateNode.implementation===N.implementation){n(j,b.sibling),b=a(b,N.children||[]),b.return=j,j=b;break e}else{n(j,b);break}else e(j,b);b=b.sibling}b=mv(N,j.mode,S),b.return=j,j=b}return o(j);case Ki:return C=N._init,y(j,b,C(N._payload),S)}if(Iu(N))return w(j,b,N,S);if(wu(N))return x(j,b,N,S);Df(j,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,b!==null&&b.tag===6?(n(j,b.sibling),b=a(b,N),b.return=j,j=b):(n(j,b),b=hv(N,j.mode,S),b.return=j,j=b),o(j)):n(j,b)}return y}var Ad=B4(!0),z4=B4(!1),e0=Uo(null),t0=null,Zc=null,Cb=null;function Eb(){Cb=Zc=t0=null}function Ab(t){var e=e0.current;xn(e0),t._currentValue=e}function __(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ad(t,e){t0=t,Cb=Zc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Xs=!0),t.firstContext=null)}function $r(t){var e=t._currentValue;if(Cb!==t)if(t={context:t,memoizedValue:e,next:null},Zc===null){if(t0===null)throw Error(Me(308));Zc=t,t0.dependencies={lanes:0,firstContext:t}}else Zc=Zc.next=t;return e}var pl=null;function Pb(t){pl===null?pl=[t]:pl.push(t)}function $4(t,e,n,r){var a=e.interleaved;return a===null?(n.next=n,Pb(e)):(n.next=a.next,a.next=n),e.interleaved=n,Si(t,r)}function Si(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zi=!1;function Db(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function U4(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function _i(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function wo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,en&2){var a=r.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),r.pending=e,Si(t,n)}return a=r.interleaved,a===null?(e.next=e,Pb(r)):(e.next=a.next,a.next=e),r.interleaved=e,Si(t,n)}function gp(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gb(t,n)}}function L2(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?a=i=e:i=i.next=e}else a=i=e;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function n0(t,e,n,r){var a=t.updateQueue;Zi=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var d=c,u=d.next;d.next=null,o===null?i=u:o.next=u,o=d;var m=t.alternate;m!==null&&(m=m.updateQueue,c=m.lastBaseUpdate,c!==o&&(c===null?m.firstBaseUpdate=u:c.next=u,m.lastBaseUpdate=d))}if(i!==null){var f=a.baseState;o=0,m=u=d=null,c=i;do{var p=c.lane,v=c.eventTime;if((r&p)===p){m!==null&&(m=m.next={eventTime:v,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var w=t,x=c;switch(p=e,v=n,x.tag){case 1:if(w=x.payload,typeof w=="function"){f=w.call(v,f,p);break e}f=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=x.payload,p=typeof w=="function"?w.call(v,f,p):w,p==null)break e;f=An({},f,p);break e;case 2:Zi=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,p=a.effects,p===null?a.effects=[c]:p.push(c))}else v={eventTime:v,lane:p,tag:c.tag,payload:c.payload,callback:c.callback,next:null},m===null?(u=m=v,d=f):m=m.next=v,o|=p;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;p=c,c=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(m===null&&(d=f),a.baseState=d,a.firstBaseUpdate=u,a.lastBaseUpdate=m,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);Fl|=o,t.lanes=o,t.memoizedState=f}}function F2(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(Me(191,a));a.call(r)}}}var Sm={},Wa=Uo(Sm),Th=Uo(Sm),Mh=Uo(Sm);function gl(t){if(t===Sm)throw Error(Me(174));return t}function Tb(t,e){switch(mn(Mh,e),mn(Th,t),mn(Wa,Sm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:e_(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=e_(e,t)}xn(Wa),mn(Wa,e)}function Pd(){xn(Wa),xn(Th),xn(Mh)}function q4(t){gl(Mh.current);var e=gl(Wa.current),n=e_(e,t.type);e!==n&&(mn(Th,t),mn(Wa,n))}function Mb(t){Th.current===t&&(xn(Wa),xn(Th))}var kn=Uo(0);function s0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var iv=[];function Rb(){for(var t=0;t<iv.length;t++)iv[t]._workInProgressVersionPrimary=null;iv.length=0}var xp=Ti.ReactCurrentDispatcher,ov=Ti.ReactCurrentBatchConfig,Ll=0,En=null,Qn=null,is=null,r0=!1,ah=!1,Rh=0,SL=0;function Ns(){throw Error(Me(321))}function Ib(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ga(t[n],e[n]))return!1;return!0}function Ob(t,e,n,r,a,i){if(Ll=i,En=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xp.current=t===null||t.memoizedState===null?AL:PL,t=n(r,a),ah){i=0;do{if(ah=!1,Rh=0,25<=i)throw Error(Me(301));i+=1,is=Qn=null,e.updateQueue=null,xp.current=DL,t=n(r,a)}while(ah)}if(xp.current=a0,e=Qn!==null&&Qn.next!==null,Ll=0,is=Qn=En=null,r0=!1,e)throw Error(Me(300));return t}function Lb(){var t=Rh!==0;return Rh=0,t}function Pa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return is===null?En.memoizedState=is=t:is=is.next=t,is}function Ur(){if(Qn===null){var t=En.alternate;t=t!==null?t.memoizedState:null}else t=Qn.next;var e=is===null?En.memoizedState:is.next;if(e!==null)is=e,Qn=t;else{if(t===null)throw Error(Me(310));Qn=t,t={memoizedState:Qn.memoizedState,baseState:Qn.baseState,baseQueue:Qn.baseQueue,queue:Qn.queue,next:null},is===null?En.memoizedState=is=t:is=is.next=t}return is}function Ih(t,e){return typeof e=="function"?e(t):e}function lv(t){var e=Ur(),n=e.queue;if(n===null)throw Error(Me(311));n.lastRenderedReducer=t;var r=Qn,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var c=o=null,d=null,u=i;do{var m=u.lane;if((Ll&m)===m)d!==null&&(d=d.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var f={lane:m,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};d===null?(c=d=f,o=r):d=d.next=f,En.lanes|=m,Fl|=m}u=u.next}while(u!==null&&u!==i);d===null?o=r:d.next=c,ga(r,e.memoizedState)||(Xs=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=d,n.lastRenderedState=r}if(t=n.interleaved,t!==null){a=t;do i=a.lane,En.lanes|=i,Fl|=i,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cv(t){var e=Ur(),n=e.queue;if(n===null)throw Error(Me(311));n.lastRenderedReducer=t;var r=n.dispatch,a=n.pending,i=e.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do i=t(i,o.action),o=o.next;while(o!==a);ga(i,e.memoizedState)||(Xs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function H4(){}function W4(t,e){var n=En,r=Ur(),a=e(),i=!ga(r.memoizedState,a);if(i&&(r.memoizedState=a,Xs=!0),r=r.queue,Fb(Z4.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||is!==null&&is.memoizedState.tag&1){if(n.flags|=2048,Oh(9,K4.bind(null,n,r,a,e),void 0,null),cs===null)throw Error(Me(349));Ll&30||V4(n,e,a)}return a}function V4(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=En.updateQueue,e===null?(e={lastEffect:null,stores:null},En.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function K4(t,e,n,r){e.value=n,e.getSnapshot=r,G4(e)&&Q4(t)}function Z4(t,e,n){return n(function(){G4(e)&&Q4(t)})}function G4(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ga(t,n)}catch{return!0}}function Q4(t){var e=Si(t,1);e!==null&&ha(e,t,1,-1)}function B2(t){var e=Pa();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ih,lastRenderedState:t},e.queue=t,t=t.dispatch=EL.bind(null,En,t),[e.memoizedState,t]}function Oh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=En.updateQueue,e===null?(e={lastEffect:null,stores:null},En.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Y4(){return Ur().memoizedState}function vp(t,e,n,r){var a=Pa();En.flags|=t,a.memoizedState=Oh(1|e,n,void 0,r===void 0?null:r)}function lg(t,e,n,r){var a=Ur();r=r===void 0?null:r;var i=void 0;if(Qn!==null){var o=Qn.memoizedState;if(i=o.destroy,r!==null&&Ib(r,o.deps)){a.memoizedState=Oh(e,n,i,r);return}}En.flags|=t,a.memoizedState=Oh(1|e,n,i,r)}function z2(t,e){return vp(8390656,8,t,e)}function Fb(t,e){return lg(2048,8,t,e)}function X4(t,e){return lg(4,2,t,e)}function J4(t,e){return lg(4,4,t,e)}function eA(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function tA(t,e,n){return n=n!=null?n.concat([t]):null,lg(4,4,eA.bind(null,e,t),n)}function Bb(){}function nA(t,e){var n=Ur();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ib(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function sA(t,e){var n=Ur();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ib(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function rA(t,e,n){return Ll&21?(ga(n,e)||(n=c4(),En.lanes|=n,Fl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Xs=!0),t.memoizedState=n)}function kL(t,e){var n=ln;ln=n!==0&&4>n?n:4,t(!0);var r=ov.transition;ov.transition={};try{t(!1),e()}finally{ln=n,ov.transition=r}}function aA(){return Ur().memoizedState}function CL(t,e,n){var r=jo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},iA(t))oA(e,n);else if(n=$4(t,e,n,r),n!==null){var a=Bs();ha(n,t,r,a),lA(n,e,r)}}function EL(t,e,n){var r=jo(t),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(iA(t))oA(e,a);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,n);if(a.hasEagerState=!0,a.eagerState=c,ga(c,o)){var d=e.interleaved;d===null?(a.next=a,Pb(e)):(a.next=d.next,d.next=a),e.interleaved=a;return}}catch{}finally{}n=$4(t,e,a,r),n!==null&&(a=Bs(),ha(n,t,r,a),lA(n,e,r))}}function iA(t){var e=t.alternate;return t===En||e!==null&&e===En}function oA(t,e){ah=r0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function lA(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,gb(t,n)}}var a0={readContext:$r,useCallback:Ns,useContext:Ns,useEffect:Ns,useImperativeHandle:Ns,useInsertionEffect:Ns,useLayoutEffect:Ns,useMemo:Ns,useReducer:Ns,useRef:Ns,useState:Ns,useDebugValue:Ns,useDeferredValue:Ns,useTransition:Ns,useMutableSource:Ns,useSyncExternalStore:Ns,useId:Ns,unstable_isNewReconciler:!1},AL={readContext:$r,useCallback:function(t,e){return Pa().memoizedState=[t,e===void 0?null:e],t},useContext:$r,useEffect:z2,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,vp(4194308,4,eA.bind(null,e,t),n)},useLayoutEffect:function(t,e){return vp(4194308,4,t,e)},useInsertionEffect:function(t,e){return vp(4,2,t,e)},useMemo:function(t,e){var n=Pa();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Pa();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=CL.bind(null,En,t),[r.memoizedState,t]},useRef:function(t){var e=Pa();return t={current:t},e.memoizedState=t},useState:B2,useDebugValue:Bb,useDeferredValue:function(t){return Pa().memoizedState=t},useTransition:function(){var t=B2(!1),e=t[0];return t=kL.bind(null,t[1]),Pa().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=En,a=Pa();if(yn){if(n===void 0)throw Error(Me(407));n=n()}else{if(n=e(),cs===null)throw Error(Me(349));Ll&30||V4(r,e,n)}a.memoizedState=n;var i={value:n,getSnapshot:e};return a.queue=i,z2(Z4.bind(null,r,i,t),[t]),r.flags|=2048,Oh(9,K4.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Pa(),e=cs.identifierPrefix;if(yn){var n=yi,r=vi;n=(r&~(1<<32-ua(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Rh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=SL++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},PL={readContext:$r,useCallback:nA,useContext:$r,useEffect:Fb,useImperativeHandle:tA,useInsertionEffect:X4,useLayoutEffect:J4,useMemo:sA,useReducer:lv,useRef:Y4,useState:function(){return lv(Ih)},useDebugValue:Bb,useDeferredValue:function(t){var e=Ur();return rA(e,Qn.memoizedState,t)},useTransition:function(){var t=lv(Ih)[0],e=Ur().memoizedState;return[t,e]},useMutableSource:H4,useSyncExternalStore:W4,useId:aA,unstable_isNewReconciler:!1},DL={readContext:$r,useCallback:nA,useContext:$r,useEffect:Fb,useImperativeHandle:tA,useInsertionEffect:X4,useLayoutEffect:J4,useMemo:sA,useReducer:cv,useRef:Y4,useState:function(){return cv(Ih)},useDebugValue:Bb,useDeferredValue:function(t){var e=Ur();return Qn===null?e.memoizedState=t:rA(e,Qn.memoizedState,t)},useTransition:function(){var t=cv(Ih)[0],e=Ur().memoizedState;return[t,e]},useMutableSource:H4,useSyncExternalStore:W4,useId:aA,unstable_isNewReconciler:!1};function ta(t,e){if(t&&t.defaultProps){e=An({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function w_(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:An({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var cg={isMounted:function(t){return(t=t._reactInternals)?Yl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Bs(),a=jo(t),i=_i(r,a);i.payload=e,n!=null&&(i.callback=n),e=wo(t,i,a),e!==null&&(ha(e,t,a,r),gp(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Bs(),a=jo(t),i=_i(r,a);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=wo(t,i,a),e!==null&&(ha(e,t,a,r),gp(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Bs(),r=jo(t),a=_i(n,r);a.tag=2,e!=null&&(a.callback=e),e=wo(t,a,r),e!==null&&(ha(e,t,r,n),gp(e,t,r))}};function $2(t,e,n,r,a,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Eh(n,r)||!Eh(a,i):!0}function cA(t,e,n){var r=!1,a=Ao,i=e.contextType;return typeof i=="object"&&i!==null?i=$r(i):(a=tr(e)?Il:Ps.current,r=e.contextTypes,i=(r=r!=null)?Cd(t,a):Ao),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=cg,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function U2(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&cg.enqueueReplaceState(e,e.state,null)}function b_(t,e,n,r){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs={},Db(t);var i=e.contextType;typeof i=="object"&&i!==null?a.context=$r(i):(i=tr(e)?Il:Ps.current,a.context=Cd(t,i)),a.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(w_(t,e,i,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&cg.enqueueReplaceState(a,a.state,null),n0(t,n,a,r),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Dd(t,e){try{var n="",r=e;do n+=a8(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:a,digest:null}}function dv(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function j_(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var TL=typeof WeakMap=="function"?WeakMap:Map;function dA(t,e,n){n=_i(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){o0||(o0=!0,M_=r),j_(t,e)},n}function uA(t,e,n){n=_i(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var a=e.value;n.payload=function(){return r(a)},n.callback=function(){j_(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){j_(t,e),typeof r!="function"&&(bo===null?bo=new Set([this]):bo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function q2(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new TL;var a=new Set;r.set(e,a)}else a=r.get(e),a===void 0&&(a=new Set,r.set(e,a));a.has(n)||(a.add(n),t=VL.bind(null,t,e,n),e.then(t,t))}function H2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function W2(t,e,n,r,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=_i(-1,1),e.tag=2,wo(n,e,1))),n.lanes|=1),t)}var ML=Ti.ReactCurrentOwner,Xs=!1;function Fs(t,e,n,r){e.child=t===null?z4(e,null,n,r):Ad(e,t.child,n,r)}function V2(t,e,n,r,a){n=n.render;var i=e.ref;return ad(e,a),r=Ob(t,e,n,r,i,a),n=Lb(),t!==null&&!Xs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,ki(t,e,a)):(yn&&n&&Nb(e),e.flags|=1,Fs(t,e,r,a),e.child)}function K2(t,e,n,r,a){if(t===null){var i=n.type;return typeof i=="function"&&!Kb(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,hA(t,e,i,r,a)):(t=bp(n.type,null,r,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&a)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Eh,n(o,r)&&t.ref===e.ref)return ki(t,e,a)}return e.flags|=1,t=No(i,r),t.ref=e.ref,t.return=e,e.child=t}function hA(t,e,n,r,a){if(t!==null){var i=t.memoizedProps;if(Eh(i,r)&&t.ref===e.ref)if(Xs=!1,e.pendingProps=r=i,(t.lanes&a)!==0)t.flags&131072&&(Xs=!0);else return e.lanes=t.lanes,ki(t,e,a)}return N_(t,e,n,r,a)}function mA(t,e,n){var r=e.pendingProps,a=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},mn(Qc,dr),dr|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,mn(Qc,dr),dr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,mn(Qc,dr),dr|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,mn(Qc,dr),dr|=r;return Fs(t,e,a,n),e.child}function fA(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function N_(t,e,n,r,a){var i=tr(n)?Il:Ps.current;return i=Cd(e,i),ad(e,a),n=Ob(t,e,n,r,i,a),r=Lb(),t!==null&&!Xs?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,ki(t,e,a)):(yn&&r&&Nb(e),e.flags|=1,Fs(t,e,n,a),e.child)}function Z2(t,e,n,r,a){if(tr(n)){var i=!0;Yp(e)}else i=!1;if(ad(e,a),e.stateNode===null)yp(t,e),cA(e,n,r),b_(e,n,r,a),r=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var d=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=$r(u):(u=tr(n)?Il:Ps.current,u=Cd(e,u));var m=n.getDerivedStateFromProps,f=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==r||d!==u)&&U2(e,o,r,u),Zi=!1;var p=e.memoizedState;o.state=p,n0(e,r,o,a),d=e.memoizedState,c!==r||p!==d||er.current||Zi?(typeof m=="function"&&(w_(e,n,m,r),d=e.memoizedState),(c=Zi||$2(e,n,c,r,p,d,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=d),o.props=r,o.state=d,o.context=u,r=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,U4(t,e),c=e.memoizedProps,u=e.type===e.elementType?c:ta(e.type,c),o.props=u,f=e.pendingProps,p=o.context,d=n.contextType,typeof d=="object"&&d!==null?d=$r(d):(d=tr(n)?Il:Ps.current,d=Cd(e,d));var v=n.getDerivedStateFromProps;(m=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==f||p!==d)&&U2(e,o,r,d),Zi=!1,p=e.memoizedState,o.state=p,n0(e,r,o,a);var w=e.memoizedState;c!==f||p!==w||er.current||Zi?(typeof v=="function"&&(w_(e,n,v,r),w=e.memoizedState),(u=Zi||$2(e,n,u,r,p,w,d)||!1)?(m||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,w,d),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,w,d)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=w),o.props=r,o.state=w,o.context=d,r=u):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return S_(t,e,n,r,i,a)}function S_(t,e,n,r,a,i){fA(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return a&&M2(e,n,!1),ki(t,e,i);r=e.stateNode,ML.current=e;var c=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ad(e,t.child,null,i),e.child=Ad(e,null,c,i)):Fs(t,e,c,i),e.memoizedState=r.state,a&&M2(e,n,!0),e.child}function pA(t){var e=t.stateNode;e.pendingContext?T2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&T2(t,e.context,!1),Tb(t,e.containerInfo)}function G2(t,e,n,r,a){return Ed(),kb(a),e.flags|=256,Fs(t,e,n,r),e.child}var k_={dehydrated:null,treeContext:null,retryLane:0};function C_(t){return{baseLanes:t,cachePool:null,transitions:null}}function gA(t,e,n){var r=e.pendingProps,a=kn.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(a&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),mn(kn,a&1),t===null)return y_(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=hg(o,r,0,null),t=El(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=C_(n),e.memoizedState=k_,t):zb(e,o));if(a=t.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return RL(t,e,o,r,c,a,n);if(i){i=r.fallback,o=e.mode,a=t.child,c=a.sibling;var d={mode:"hidden",children:r.children};return!(o&1)&&e.child!==a?(r=e.child,r.childLanes=0,r.pendingProps=d,e.deletions=null):(r=No(a,d),r.subtreeFlags=a.subtreeFlags&14680064),c!==null?i=No(c,i):(i=El(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?C_(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=k_,r}return i=t.child,t=i.sibling,r=No(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function zb(t,e){return e=hg({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Tf(t,e,n,r){return r!==null&&kb(r),Ad(e,t.child,null,n),t=zb(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function RL(t,e,n,r,a,i,o){if(n)return e.flags&256?(e.flags&=-257,r=dv(Error(Me(422))),Tf(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,a=e.mode,r=hg({mode:"visible",children:r.children},a,0,null),i=El(i,a,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ad(e,t.child,null,o),e.child.memoizedState=C_(o),e.memoizedState=k_,i);if(!(e.mode&1))return Tf(t,e,o,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var c=r.dgst;return r=c,i=Error(Me(419)),r=dv(i,r,void 0),Tf(t,e,o,r)}if(c=(o&t.childLanes)!==0,Xs||c){if(r=cs,r!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Si(t,a),ha(r,t,a,-1))}return Vb(),r=dv(Error(Me(421))),Tf(t,e,o,r)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=KL.bind(null,t),a._reactRetry=e,null):(t=i.treeContext,hr=_o(a.nextSibling),fr=e,yn=!0,ia=null,t!==null&&(Tr[Mr++]=vi,Tr[Mr++]=yi,Tr[Mr++]=Ol,vi=t.id,yi=t.overflow,Ol=e),e=zb(e,r.children),e.flags|=4096,e)}function Q2(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),__(t.return,e,n)}function uv(t,e,n,r,a){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function xA(t,e,n){var r=e.pendingProps,a=r.revealOrder,i=r.tail;if(Fs(t,e,r.children,n),r=kn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Q2(t,n,e);else if(t.tag===19)Q2(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(mn(kn,r),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&s0(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),uv(e,!1,a,n,i);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&s0(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}uv(e,!0,n,null,i);break;case"together":uv(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function yp(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ki(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Fl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Me(153));if(e.child!==null){for(t=e.child,n=No(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=No(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function IL(t,e,n){switch(e.tag){case 3:pA(e),Ed();break;case 5:q4(e);break;case 1:tr(e.type)&&Yp(e);break;case 4:Tb(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,a=e.memoizedProps.value;mn(e0,r._currentValue),r._currentValue=a;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(mn(kn,kn.current&1),e.flags|=128,null):n&e.child.childLanes?gA(t,e,n):(mn(kn,kn.current&1),t=ki(t,e,n),t!==null?t.sibling:null);mn(kn,kn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return xA(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),mn(kn,kn.current),r)break;return null;case 22:case 23:return e.lanes=0,mA(t,e,n)}return ki(t,e,n)}var vA,E_,yA,_A;vA=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};E_=function(){};yA=function(t,e,n,r){var a=t.memoizedProps;if(a!==r){t=e.stateNode,gl(Wa.current);var i=null;switch(n){case"input":a=Qy(t,a),r=Qy(t,r),i=[];break;case"select":a=An({},a,{value:void 0}),r=An({},r,{value:void 0}),i=[];break;case"textarea":a=Jy(t,a),r=Jy(t,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Gp)}t_(n,r);var o;n=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var c=a[u];for(o in c)c.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(wh.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var d=r[u];if(c=a!=null?a[u]:void 0,r.hasOwnProperty(u)&&d!==c&&(d!=null||c!=null))if(u==="style")if(c){for(o in c)!c.hasOwnProperty(o)||d&&d.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in d)d.hasOwnProperty(o)&&c[o]!==d[o]&&(n||(n={}),n[o]=d[o])}else n||(i||(i=[]),i.push(u,n)),n=d;else u==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,c=c?c.__html:void 0,d!=null&&c!==d&&(i=i||[]).push(u,d)):u==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(u,""+d):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(wh.hasOwnProperty(u)?(d!=null&&u==="onScroll"&&gn("scroll",t),i||c===d||(i=[])):(i=i||[]).push(u,d))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};_A=function(t,e,n,r){n!==r&&(e.flags|=4)};function Cu(t,e){if(!yn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ss(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function OL(t,e,n){var r=e.pendingProps;switch(Sb(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ss(e),null;case 1:return tr(e.type)&&Qp(),Ss(e),null;case 3:return r=e.stateNode,Pd(),xn(er),xn(Ps),Rb(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Pf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ia!==null&&(O_(ia),ia=null))),E_(t,e),Ss(e),null;case 5:Mb(e);var a=gl(Mh.current);if(n=e.type,t!==null&&e.stateNode!=null)yA(t,e,n,r,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Me(166));return Ss(e),null}if(t=gl(Wa.current),Pf(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[La]=e,r[Dh]=i,t=(e.mode&1)!==0,n){case"dialog":gn("cancel",r),gn("close",r);break;case"iframe":case"object":case"embed":gn("load",r);break;case"video":case"audio":for(a=0;a<Lu.length;a++)gn(Lu[a],r);break;case"source":gn("error",r);break;case"img":case"image":case"link":gn("error",r),gn("load",r);break;case"details":gn("toggle",r);break;case"input":a2(r,i),gn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},gn("invalid",r);break;case"textarea":o2(r,i),gn("invalid",r)}t_(n,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?r.textContent!==c&&(i.suppressHydrationWarning!==!0&&Af(r.textContent,c,t),a=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&Af(r.textContent,c,t),a=["children",""+c]):wh.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&gn("scroll",r)}switch(n){case"input":wf(r),i2(r,i,!0);break;case"textarea":wf(r),l2(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Gp)}r=a,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ZE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[La]=e,t[Dh]=r,vA(t,e,!1,!1),e.stateNode=t;e:{switch(o=n_(n,r),n){case"dialog":gn("cancel",t),gn("close",t),a=r;break;case"iframe":case"object":case"embed":gn("load",t),a=r;break;case"video":case"audio":for(a=0;a<Lu.length;a++)gn(Lu[a],t);a=r;break;case"source":gn("error",t),a=r;break;case"img":case"image":case"link":gn("error",t),gn("load",t),a=r;break;case"details":gn("toggle",t),a=r;break;case"input":a2(t,r),a=Qy(t,r),gn("invalid",t);break;case"option":a=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},a=An({},r,{value:void 0}),gn("invalid",t);break;case"textarea":o2(t,r),a=Jy(t,r),gn("invalid",t);break;default:a=r}t_(n,a),c=a;for(i in c)if(c.hasOwnProperty(i)){var d=c[i];i==="style"?YE(t,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&GE(t,d)):i==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&bh(t,d):typeof d=="number"&&bh(t,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(wh.hasOwnProperty(i)?d!=null&&i==="onScroll"&&gn("scroll",t):d!=null&&db(t,i,d,o))}switch(n){case"input":wf(t),i2(t,r,!1);break;case"textarea":wf(t),l2(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Eo(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?td(t,!!r.multiple,i,!1):r.defaultValue!=null&&td(t,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Gp)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ss(e),null;case 6:if(t&&e.stateNode!=null)_A(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Me(166));if(n=gl(Mh.current),gl(Wa.current),Pf(e)){if(r=e.stateNode,n=e.memoizedProps,r[La]=e,(i=r.nodeValue!==n)&&(t=fr,t!==null))switch(t.tag){case 3:Af(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Af(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[La]=e,e.stateNode=r}return Ss(e),null;case 13:if(xn(kn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(yn&&hr!==null&&e.mode&1&&!(e.flags&128))F4(),Ed(),e.flags|=98560,i=!1;else if(i=Pf(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Me(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Me(317));i[La]=e}else Ed(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ss(e),i=!1}else ia!==null&&(O_(ia),ia=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||kn.current&1?Xn===0&&(Xn=3):Vb())),e.updateQueue!==null&&(e.flags|=4),Ss(e),null);case 4:return Pd(),E_(t,e),t===null&&Ah(e.stateNode.containerInfo),Ss(e),null;case 10:return Ab(e.type._context),Ss(e),null;case 17:return tr(e.type)&&Qp(),Ss(e),null;case 19:if(xn(kn),i=e.memoizedState,i===null)return Ss(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Cu(i,!1);else{if(Xn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=s0(t),o!==null){for(e.flags|=128,Cu(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return mn(kn,kn.current&1|2),e.child}t=t.sibling}i.tail!==null&&Rn()>Td&&(e.flags|=128,r=!0,Cu(i,!1),e.lanes=4194304)}else{if(!r)if(t=s0(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Cu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!yn)return Ss(e),null}else 2*Rn()-i.renderingStartTime>Td&&n!==1073741824&&(e.flags|=128,r=!0,Cu(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Rn(),e.sibling=null,n=kn.current,mn(kn,r?n&1|2:n&1),e):(Ss(e),null);case 22:case 23:return Wb(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?dr&1073741824&&(Ss(e),e.subtreeFlags&6&&(e.flags|=8192)):Ss(e),null;case 24:return null;case 25:return null}throw Error(Me(156,e.tag))}function LL(t,e){switch(Sb(e),e.tag){case 1:return tr(e.type)&&Qp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Pd(),xn(er),xn(Ps),Rb(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Mb(e),null;case 13:if(xn(kn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Me(340));Ed()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return xn(kn),null;case 4:return Pd(),null;case 10:return Ab(e.type._context),null;case 22:case 23:return Wb(),null;case 24:return null;default:return null}}var Mf=!1,Es=!1,FL=typeof WeakSet=="function"?WeakSet:Set,Je=null;function Gc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Tn(t,e,r)}else n.current=null}function A_(t,e,n){try{n()}catch(r){Tn(t,e,r)}}var Y2=!1;function BL(t,e){if(h_=Vp,t=S4(),jb(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,c=-1,d=-1,u=0,m=0,f=t,p=null;t:for(;;){for(var v;f!==n||a!==0&&f.nodeType!==3||(c=o+a),f!==i||r!==0&&f.nodeType!==3||(d=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(v=f.firstChild)!==null;)p=f,f=v;for(;;){if(f===t)break t;if(p===n&&++u===a&&(c=o),p===i&&++m===r&&(d=o),(v=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=v}n=c===-1||d===-1?null:{start:c,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(m_={focusedElem:t,selectionRange:n},Vp=!1,Je=e;Je!==null;)if(e=Je,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Je=t;else for(;Je!==null;){e=Je;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var x=w.memoizedProps,y=w.memoizedState,j=e.stateNode,b=j.getSnapshotBeforeUpdate(e.elementType===e.type?x:ta(e.type,x),y);j.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(S){Tn(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,Je=t;break}Je=e.return}return w=Y2,Y2=!1,w}function ih(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,i!==void 0&&A_(e,n,i)}a=a.next}while(a!==r)}}function dg(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function P_(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function wA(t){var e=t.alternate;e!==null&&(t.alternate=null,wA(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[La],delete e[Dh],delete e[g_],delete e[wL],delete e[bL])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function bA(t){return t.tag===5||t.tag===3||t.tag===4}function X2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||bA(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function D_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Gp));else if(r!==4&&(t=t.child,t!==null))for(D_(t,e,n),t=t.sibling;t!==null;)D_(t,e,n),t=t.sibling}function T_(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(T_(t,e,n),t=t.sibling;t!==null;)T_(t,e,n),t=t.sibling}var ps=null,ra=!1;function Fi(t,e,n){for(n=n.child;n!==null;)jA(t,e,n),n=n.sibling}function jA(t,e,n){if(Ha&&typeof Ha.onCommitFiberUnmount=="function")try{Ha.onCommitFiberUnmount(ng,n)}catch{}switch(n.tag){case 5:Es||Gc(n,e);case 6:var r=ps,a=ra;ps=null,Fi(t,e,n),ps=r,ra=a,ps!==null&&(ra?(t=ps,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ps.removeChild(n.stateNode));break;case 18:ps!==null&&(ra?(t=ps,n=n.stateNode,t.nodeType===8?rv(t.parentNode,n):t.nodeType===1&&rv(t,n),kh(t)):rv(ps,n.stateNode));break;case 4:r=ps,a=ra,ps=n.stateNode.containerInfo,ra=!0,Fi(t,e,n),ps=r,ra=a;break;case 0:case 11:case 14:case 15:if(!Es&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&A_(n,e,o),a=a.next}while(a!==r)}Fi(t,e,n);break;case 1:if(!Es&&(Gc(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){Tn(n,e,c)}Fi(t,e,n);break;case 21:Fi(t,e,n);break;case 22:n.mode&1?(Es=(r=Es)||n.memoizedState!==null,Fi(t,e,n),Es=r):Fi(t,e,n);break;default:Fi(t,e,n)}}function J2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new FL),e.forEach(function(r){var a=ZL.bind(null,t,r);n.has(r)||(n.add(r),r.then(a,a))})}}function Xr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:ps=c.stateNode,ra=!1;break e;case 3:ps=c.stateNode.containerInfo,ra=!0;break e;case 4:ps=c.stateNode.containerInfo,ra=!0;break e}c=c.return}if(ps===null)throw Error(Me(160));jA(i,o,a),ps=null,ra=!1;var d=a.alternate;d!==null&&(d.return=null),a.return=null}catch(u){Tn(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)NA(e,t),e=e.sibling}function NA(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xr(e,t),Ca(t),r&4){try{ih(3,t,t.return),dg(3,t)}catch(x){Tn(t,t.return,x)}try{ih(5,t,t.return)}catch(x){Tn(t,t.return,x)}}break;case 1:Xr(e,t),Ca(t),r&512&&n!==null&&Gc(n,n.return);break;case 5:if(Xr(e,t),Ca(t),r&512&&n!==null&&Gc(n,n.return),t.flags&32){var a=t.stateNode;try{bh(a,"")}catch(x){Tn(t,t.return,x)}}if(r&4&&(a=t.stateNode,a!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,c=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&VE(a,i),n_(c,o);var u=n_(c,i);for(o=0;o<d.length;o+=2){var m=d[o],f=d[o+1];m==="style"?YE(a,f):m==="dangerouslySetInnerHTML"?GE(a,f):m==="children"?bh(a,f):db(a,m,f,u)}switch(c){case"input":Yy(a,i);break;case"textarea":KE(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?td(a,!!i.multiple,v,!1):p!==!!i.multiple&&(i.defaultValue!=null?td(a,!!i.multiple,i.defaultValue,!0):td(a,!!i.multiple,i.multiple?[]:"",!1))}a[Dh]=i}catch(x){Tn(t,t.return,x)}}break;case 6:if(Xr(e,t),Ca(t),r&4){if(t.stateNode===null)throw Error(Me(162));a=t.stateNode,i=t.memoizedProps;try{a.nodeValue=i}catch(x){Tn(t,t.return,x)}}break;case 3:if(Xr(e,t),Ca(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{kh(e.containerInfo)}catch(x){Tn(t,t.return,x)}break;case 4:Xr(e,t),Ca(t);break;case 13:Xr(e,t),Ca(t),a=t.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(qb=Rn())),r&4&&J2(t);break;case 22:if(m=n!==null&&n.memoizedState!==null,t.mode&1?(Es=(u=Es)||m,Xr(e,t),Es=u):Xr(e,t),Ca(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!m&&t.mode&1)for(Je=t,m=t.child;m!==null;){for(f=Je=m;Je!==null;){switch(p=Je,v=p.child,p.tag){case 0:case 11:case 14:case 15:ih(4,p,p.return);break;case 1:Gc(p,p.return);var w=p.stateNode;if(typeof w.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(x){Tn(r,n,x)}}break;case 5:Gc(p,p.return);break;case 22:if(p.memoizedState!==null){tS(f);continue}}v!==null?(v.return=p,Je=v):tS(f)}m=m.sibling}e:for(m=null,f=t;;){if(f.tag===5){if(m===null){m=f;try{a=f.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=f.stateNode,d=f.memoizedProps.style,o=d!=null&&d.hasOwnProperty("display")?d.display:null,c.style.display=QE("display",o))}catch(x){Tn(t,t.return,x)}}}else if(f.tag===6){if(m===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){Tn(t,t.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;m===f&&(m=null),f=f.return}m===f&&(m=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Xr(e,t),Ca(t),r&4&&J2(t);break;case 21:break;default:Xr(e,t),Ca(t)}}function Ca(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(bA(n)){var r=n;break e}n=n.return}throw Error(Me(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(bh(a,""),r.flags&=-33);var i=X2(t);T_(t,i,a);break;case 3:case 4:var o=r.stateNode.containerInfo,c=X2(t);D_(t,c,o);break;default:throw Error(Me(161))}}catch(d){Tn(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function zL(t,e,n){Je=t,SA(t)}function SA(t,e,n){for(var r=(t.mode&1)!==0;Je!==null;){var a=Je,i=a.child;if(a.tag===22&&r){var o=a.memoizedState!==null||Mf;if(!o){var c=a.alternate,d=c!==null&&c.memoizedState!==null||Es;c=Mf;var u=Es;if(Mf=o,(Es=d)&&!u)for(Je=a;Je!==null;)o=Je,d=o.child,o.tag===22&&o.memoizedState!==null?nS(a):d!==null?(d.return=o,Je=d):nS(a);for(;i!==null;)Je=i,SA(i),i=i.sibling;Je=a,Mf=c,Es=u}eS(t)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Je=i):eS(t)}}function eS(t){for(;Je!==null;){var e=Je;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Es||dg(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Es)if(n===null)r.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:ta(e.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&F2(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}F2(e,o,n)}break;case 5:var c=e.stateNode;if(n===null&&e.flags&4){n=c;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var m=u.memoizedState;if(m!==null){var f=m.dehydrated;f!==null&&kh(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}Es||e.flags&512&&P_(e)}catch(p){Tn(e,e.return,p)}}if(e===t){Je=null;break}if(n=e.sibling,n!==null){n.return=e.return,Je=n;break}Je=e.return}}function tS(t){for(;Je!==null;){var e=Je;if(e===t){Je=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Je=n;break}Je=e.return}}function nS(t){for(;Je!==null;){var e=Je;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{dg(4,e)}catch(d){Tn(e,n,d)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var a=e.return;try{r.componentDidMount()}catch(d){Tn(e,a,d)}}var i=e.return;try{P_(e)}catch(d){Tn(e,i,d)}break;case 5:var o=e.return;try{P_(e)}catch(d){Tn(e,o,d)}}}catch(d){Tn(e,e.return,d)}if(e===t){Je=null;break}var c=e.sibling;if(c!==null){c.return=e.return,Je=c;break}Je=e.return}}var $L=Math.ceil,i0=Ti.ReactCurrentDispatcher,$b=Ti.ReactCurrentOwner,Or=Ti.ReactCurrentBatchConfig,en=0,cs=null,zn=null,_s=0,dr=0,Qc=Uo(0),Xn=0,Lh=null,Fl=0,ug=0,Ub=0,oh=null,Qs=null,qb=0,Td=1/0,fi=null,o0=!1,M_=null,bo=null,Rf=!1,mo=null,l0=0,lh=0,R_=null,_p=-1,wp=0;function Bs(){return en&6?Rn():_p!==-1?_p:_p=Rn()}function jo(t){return t.mode&1?en&2&&_s!==0?_s&-_s:NL.transition!==null?(wp===0&&(wp=c4()),wp):(t=ln,t!==0||(t=window.event,t=t===void 0?16:g4(t.type)),t):1}function ha(t,e,n,r){if(50<lh)throw lh=0,R_=null,Error(Me(185));bm(t,n,r),(!(en&2)||t!==cs)&&(t===cs&&(!(en&2)&&(ug|=n),Xn===4&&Xi(t,_s)),nr(t,r),n===1&&en===0&&!(e.mode&1)&&(Td=Rn()+500,og&&qo()))}function nr(t,e){var n=t.callbackNode;N8(t,e);var r=Wp(t,t===cs?_s:0);if(r===0)n!==null&&u2(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&u2(n),e===1)t.tag===0?jL(sS.bind(null,t)):I4(sS.bind(null,t)),yL(function(){!(en&6)&&qo()}),n=null;else{switch(d4(r)){case 1:n=pb;break;case 4:n=o4;break;case 16:n=Hp;break;case 536870912:n=l4;break;default:n=Hp}n=MA(n,kA.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function kA(t,e){if(_p=-1,wp=0,en&6)throw Error(Me(327));var n=t.callbackNode;if(id()&&t.callbackNode!==n)return null;var r=Wp(t,t===cs?_s:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=c0(t,r);else{e=r;var a=en;en|=2;var i=EA();(cs!==t||_s!==e)&&(fi=null,Td=Rn()+500,Cl(t,e));do try{HL();break}catch(c){CA(t,c)}while(!0);Eb(),i0.current=i,en=a,zn!==null?e=0:(cs=null,_s=0,e=Xn)}if(e!==0){if(e===2&&(a=o_(t),a!==0&&(r=a,e=I_(t,a))),e===1)throw n=Lh,Cl(t,0),Xi(t,r),nr(t,Rn()),n;if(e===6)Xi(t,r);else{if(a=t.current.alternate,!(r&30)&&!UL(a)&&(e=c0(t,r),e===2&&(i=o_(t),i!==0&&(r=i,e=I_(t,i))),e===1))throw n=Lh,Cl(t,0),Xi(t,r),nr(t,Rn()),n;switch(t.finishedWork=a,t.finishedLanes=r,e){case 0:case 1:throw Error(Me(345));case 2:al(t,Qs,fi);break;case 3:if(Xi(t,r),(r&130023424)===r&&(e=qb+500-Rn(),10<e)){if(Wp(t,0)!==0)break;if(a=t.suspendedLanes,(a&r)!==r){Bs(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=p_(al.bind(null,t,Qs,fi),e);break}al(t,Qs,fi);break;case 4:if(Xi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,a=-1;0<r;){var o=31-ua(r);i=1<<o,o=e[o],o>a&&(a=o),r&=~i}if(r=a,r=Rn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*$L(r/1960))-r,10<r){t.timeoutHandle=p_(al.bind(null,t,Qs,fi),r);break}al(t,Qs,fi);break;case 5:al(t,Qs,fi);break;default:throw Error(Me(329))}}}return nr(t,Rn()),t.callbackNode===n?kA.bind(null,t):null}function I_(t,e){var n=oh;return t.current.memoizedState.isDehydrated&&(Cl(t,e).flags|=256),t=c0(t,e),t!==2&&(e=Qs,Qs=n,e!==null&&O_(e)),t}function O_(t){Qs===null?Qs=t:Qs.push.apply(Qs,t)}function UL(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!ga(i(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Xi(t,e){for(e&=~Ub,e&=~ug,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ua(e),r=1<<n;t[n]=-1,e&=~r}}function sS(t){if(en&6)throw Error(Me(327));id();var e=Wp(t,0);if(!(e&1))return nr(t,Rn()),null;var n=c0(t,e);if(t.tag!==0&&n===2){var r=o_(t);r!==0&&(e=r,n=I_(t,r))}if(n===1)throw n=Lh,Cl(t,0),Xi(t,e),nr(t,Rn()),n;if(n===6)throw Error(Me(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,al(t,Qs,fi),nr(t,Rn()),null}function Hb(t,e){var n=en;en|=1;try{return t(e)}finally{en=n,en===0&&(Td=Rn()+500,og&&qo())}}function Bl(t){mo!==null&&mo.tag===0&&!(en&6)&&id();var e=en;en|=1;var n=Or.transition,r=ln;try{if(Or.transition=null,ln=1,t)return t()}finally{ln=r,Or.transition=n,en=e,!(en&6)&&qo()}}function Wb(){dr=Qc.current,xn(Qc)}function Cl(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,vL(n)),zn!==null)for(n=zn.return;n!==null;){var r=n;switch(Sb(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Qp();break;case 3:Pd(),xn(er),xn(Ps),Rb();break;case 5:Mb(r);break;case 4:Pd();break;case 13:xn(kn);break;case 19:xn(kn);break;case 10:Ab(r.type._context);break;case 22:case 23:Wb()}n=n.return}if(cs=t,zn=t=No(t.current,null),_s=dr=e,Xn=0,Lh=null,Ub=ug=Fl=0,Qs=oh=null,pl!==null){for(e=0;e<pl.length;e++)if(n=pl[e],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=a,r.next=o}n.pending=r}pl=null}return t}function CA(t,e){do{var n=zn;try{if(Eb(),xp.current=a0,r0){for(var r=En.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}r0=!1}if(Ll=0,is=Qn=En=null,ah=!1,Rh=0,$b.current=null,n===null||n.return===null){Xn=1,Lh=e,zn=null;break}e:{var i=t,o=n.return,c=n,d=e;if(e=_s,c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var u=d,m=c,f=m.tag;if(!(m.mode&1)&&(f===0||f===11||f===15)){var p=m.alternate;p?(m.updateQueue=p.updateQueue,m.memoizedState=p.memoizedState,m.lanes=p.lanes):(m.updateQueue=null,m.memoizedState=null)}var v=H2(o);if(v!==null){v.flags&=-257,W2(v,o,c,i,e),v.mode&1&&q2(i,u,e),e=v,d=u;var w=e.updateQueue;if(w===null){var x=new Set;x.add(d),e.updateQueue=x}else w.add(d);break e}else{if(!(e&1)){q2(i,u,e),Vb();break e}d=Error(Me(426))}}else if(yn&&c.mode&1){var y=H2(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),W2(y,o,c,i,e),kb(Dd(d,c));break e}}i=d=Dd(d,c),Xn!==4&&(Xn=2),oh===null?oh=[i]:oh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var j=dA(i,d,e);L2(i,j);break e;case 1:c=d;var b=i.type,N=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(bo===null||!bo.has(N)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=uA(i,c,e);L2(i,S);break e}}i=i.return}while(i!==null)}PA(n)}catch(E){e=E,zn===n&&n!==null&&(zn=n=n.return);continue}break}while(!0)}function EA(){var t=i0.current;return i0.current=a0,t===null?a0:t}function Vb(){(Xn===0||Xn===3||Xn===2)&&(Xn=4),cs===null||!(Fl&268435455)&&!(ug&268435455)||Xi(cs,_s)}function c0(t,e){var n=en;en|=2;var r=EA();(cs!==t||_s!==e)&&(fi=null,Cl(t,e));do try{qL();break}catch(a){CA(t,a)}while(!0);if(Eb(),en=n,i0.current=r,zn!==null)throw Error(Me(261));return cs=null,_s=0,Xn}function qL(){for(;zn!==null;)AA(zn)}function HL(){for(;zn!==null&&!p8();)AA(zn)}function AA(t){var e=TA(t.alternate,t,dr);t.memoizedProps=t.pendingProps,e===null?PA(t):zn=e,$b.current=null}function PA(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=LL(n,e),n!==null){n.flags&=32767,zn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Xn=6,zn=null;return}}else if(n=OL(n,e,dr),n!==null){zn=n;return}if(e=e.sibling,e!==null){zn=e;return}zn=e=t}while(e!==null);Xn===0&&(Xn=5)}function al(t,e,n){var r=ln,a=Or.transition;try{Or.transition=null,ln=1,WL(t,e,n,r)}finally{Or.transition=a,ln=r}return null}function WL(t,e,n,r){do id();while(mo!==null);if(en&6)throw Error(Me(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Me(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(S8(t,i),t===cs&&(zn=cs=null,_s=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Rf||(Rf=!0,MA(Hp,function(){return id(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Or.transition,Or.transition=null;var o=ln;ln=1;var c=en;en|=4,$b.current=null,BL(t,n),NA(n,t),uL(m_),Vp=!!h_,m_=h_=null,t.current=n,zL(n),g8(),en=c,ln=o,Or.transition=i}else t.current=n;if(Rf&&(Rf=!1,mo=t,l0=a),i=t.pendingLanes,i===0&&(bo=null),y8(n.stateNode),nr(t,Rn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(o0)throw o0=!1,t=M_,M_=null,t;return l0&1&&t.tag!==0&&id(),i=t.pendingLanes,i&1?t===R_?lh++:(lh=0,R_=t):lh=0,qo(),null}function id(){if(mo!==null){var t=d4(l0),e=Or.transition,n=ln;try{if(Or.transition=null,ln=16>t?16:t,mo===null)var r=!1;else{if(t=mo,mo=null,l0=0,en&6)throw Error(Me(331));var a=en;for(en|=4,Je=t.current;Je!==null;){var i=Je,o=i.child;if(Je.flags&16){var c=i.deletions;if(c!==null){for(var d=0;d<c.length;d++){var u=c[d];for(Je=u;Je!==null;){var m=Je;switch(m.tag){case 0:case 11:case 15:ih(8,m,i)}var f=m.child;if(f!==null)f.return=m,Je=f;else for(;Je!==null;){m=Je;var p=m.sibling,v=m.return;if(wA(m),m===u){Je=null;break}if(p!==null){p.return=v,Je=p;break}Je=v}}}var w=i.alternate;if(w!==null){var x=w.child;if(x!==null){w.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}Je=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Je=o;else e:for(;Je!==null;){if(i=Je,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ih(9,i,i.return)}var j=i.sibling;if(j!==null){j.return=i.return,Je=j;break e}Je=i.return}}var b=t.current;for(Je=b;Je!==null;){o=Je;var N=o.child;if(o.subtreeFlags&2064&&N!==null)N.return=o,Je=N;else e:for(o=b;Je!==null;){if(c=Je,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:dg(9,c)}}catch(E){Tn(c,c.return,E)}if(c===o){Je=null;break e}var S=c.sibling;if(S!==null){S.return=c.return,Je=S;break e}Je=c.return}}if(en=a,qo(),Ha&&typeof Ha.onPostCommitFiberRoot=="function")try{Ha.onPostCommitFiberRoot(ng,t)}catch{}r=!0}return r}finally{ln=n,Or.transition=e}}return!1}function rS(t,e,n){e=Dd(n,e),e=dA(t,e,1),t=wo(t,e,1),e=Bs(),t!==null&&(bm(t,1,e),nr(t,e))}function Tn(t,e,n){if(t.tag===3)rS(t,t,n);else for(;e!==null;){if(e.tag===3){rS(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(bo===null||!bo.has(r))){t=Dd(n,t),t=uA(e,t,1),e=wo(e,t,1),t=Bs(),e!==null&&(bm(e,1,t),nr(e,t));break}}e=e.return}}function VL(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Bs(),t.pingedLanes|=t.suspendedLanes&n,cs===t&&(_s&n)===n&&(Xn===4||Xn===3&&(_s&130023424)===_s&&500>Rn()-qb?Cl(t,0):Ub|=n),nr(t,e)}function DA(t,e){e===0&&(t.mode&1?(e=Nf,Nf<<=1,!(Nf&130023424)&&(Nf=4194304)):e=1);var n=Bs();t=Si(t,e),t!==null&&(bm(t,e,n),nr(t,n))}function KL(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),DA(t,n)}function ZL(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Me(314))}r!==null&&r.delete(e),DA(t,n)}var TA;TA=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||er.current)Xs=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Xs=!1,IL(t,e,n);Xs=!!(t.flags&131072)}else Xs=!1,yn&&e.flags&1048576&&O4(e,Jp,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;yp(t,e),t=e.pendingProps;var a=Cd(e,Ps.current);ad(e,n),a=Ob(null,e,r,t,a,n);var i=Lb();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,tr(r)?(i=!0,Yp(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Db(e),a.updater=cg,e.stateNode=a,a._reactInternals=e,b_(e,r,t,n),e=S_(null,e,r,!0,i,n)):(e.tag=0,yn&&i&&Nb(e),Fs(null,e,a,n),e=e.child),e;case 16:r=e.elementType;e:{switch(yp(t,e),t=e.pendingProps,a=r._init,r=a(r._payload),e.type=r,a=e.tag=QL(r),t=ta(r,t),a){case 0:e=N_(null,e,r,t,n);break e;case 1:e=Z2(null,e,r,t,n);break e;case 11:e=V2(null,e,r,t,n);break e;case 14:e=K2(null,e,r,ta(r.type,t),n);break e}throw Error(Me(306,r,""))}return e;case 0:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:ta(r,a),N_(t,e,r,a,n);case 1:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:ta(r,a),Z2(t,e,r,a,n);case 3:e:{if(pA(e),t===null)throw Error(Me(387));r=e.pendingProps,i=e.memoizedState,a=i.element,U4(t,e),n0(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=Dd(Error(Me(423)),e),e=G2(t,e,r,n,a);break e}else if(r!==a){a=Dd(Error(Me(424)),e),e=G2(t,e,r,n,a);break e}else for(hr=_o(e.stateNode.containerInfo.firstChild),fr=e,yn=!0,ia=null,n=z4(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ed(),r===a){e=ki(t,e,n);break e}Fs(t,e,r,n)}e=e.child}return e;case 5:return q4(e),t===null&&y_(e),r=e.type,a=e.pendingProps,i=t!==null?t.memoizedProps:null,o=a.children,f_(r,a)?o=null:i!==null&&f_(r,i)&&(e.flags|=32),fA(t,e),Fs(t,e,o,n),e.child;case 6:return t===null&&y_(e),null;case 13:return gA(t,e,n);case 4:return Tb(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ad(e,null,r,n):Fs(t,e,r,n),e.child;case 11:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:ta(r,a),V2(t,e,r,a,n);case 7:return Fs(t,e,e.pendingProps,n),e.child;case 8:return Fs(t,e,e.pendingProps.children,n),e.child;case 12:return Fs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,a=e.pendingProps,i=e.memoizedProps,o=a.value,mn(e0,r._currentValue),r._currentValue=o,i!==null)if(ga(i.value,o)){if(i.children===a.children&&!er.current){e=ki(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var d=c.firstContext;d!==null;){if(d.context===r){if(i.tag===1){d=_i(-1,n&-n),d.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var m=u.pending;m===null?d.next=d:(d.next=m.next,m.next=d),u.pending=d}}i.lanes|=n,d=i.alternate,d!==null&&(d.lanes|=n),__(i.return,n,e),c.lanes|=n;break}d=d.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Me(341));o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),__(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Fs(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,r=e.pendingProps.children,ad(e,n),a=$r(a),r=r(a),e.flags|=1,Fs(t,e,r,n),e.child;case 14:return r=e.type,a=ta(r,e.pendingProps),a=ta(r.type,a),K2(t,e,r,a,n);case 15:return hA(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:ta(r,a),yp(t,e),e.tag=1,tr(r)?(t=!0,Yp(e)):t=!1,ad(e,n),cA(e,r,a),b_(e,r,a,n),S_(null,e,r,!0,t,n);case 19:return xA(t,e,n);case 22:return mA(t,e,n)}throw Error(Me(156,e.tag))};function MA(t,e){return i4(t,e)}function GL(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rr(t,e,n,r){return new GL(t,e,n,r)}function Kb(t){return t=t.prototype,!(!t||!t.isReactComponent)}function QL(t){if(typeof t=="function")return Kb(t)?1:0;if(t!=null){if(t=t.$$typeof,t===hb)return 11;if(t===mb)return 14}return 2}function No(t,e){var n=t.alternate;return n===null?(n=Rr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function bp(t,e,n,r,a,i){var o=2;if(r=t,typeof t=="function")Kb(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case zc:return El(n.children,a,i,e);case ub:o=8,a|=8;break;case Vy:return t=Rr(12,n,e,a|2),t.elementType=Vy,t.lanes=i,t;case Ky:return t=Rr(13,n,e,a),t.elementType=Ky,t.lanes=i,t;case Zy:return t=Rr(19,n,e,a),t.elementType=Zy,t.lanes=i,t;case qE:return hg(n,a,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case $E:o=10;break e;case UE:o=9;break e;case hb:o=11;break e;case mb:o=14;break e;case Ki:o=16,r=null;break e}throw Error(Me(130,t==null?t:typeof t,""))}return e=Rr(o,n,e,a),e.elementType=t,e.type=r,e.lanes=i,e}function El(t,e,n,r){return t=Rr(7,t,r,e),t.lanes=n,t}function hg(t,e,n,r){return t=Rr(22,t,r,e),t.elementType=qE,t.lanes=n,t.stateNode={isHidden:!1},t}function hv(t,e,n){return t=Rr(6,t,null,e),t.lanes=n,t}function mv(t,e,n){return e=Rr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function YL(t,e,n,r,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kx(0),this.expirationTimes=Kx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kx(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Zb(t,e,n,r,a,i,o,c,d){return t=new YL(t,e,n,c,d),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Rr(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Db(i),t}function XL(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function RA(t){if(!t)return Ao;t=t._reactInternals;e:{if(Yl(t)!==t||t.tag!==1)throw Error(Me(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(tr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Me(171))}if(t.tag===1){var n=t.type;if(tr(n))return R4(t,n,e)}return e}function IA(t,e,n,r,a,i,o,c,d){return t=Zb(n,r,!0,t,a,i,o,c,d),t.context=RA(null),n=t.current,r=Bs(),a=jo(n),i=_i(r,a),i.callback=e??null,wo(n,i,a),t.current.lanes=a,bm(t,a,r),nr(t,r),t}function mg(t,e,n,r){var a=e.current,i=Bs(),o=jo(a);return n=RA(n),e.context===null?e.context=n:e.pendingContext=n,e=_i(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=wo(a,e,o),t!==null&&(ha(t,a,o,i),gp(t,a,o)),o}function d0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function aS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Gb(t,e){aS(t,e),(t=t.alternate)&&aS(t,e)}function JL(){return null}var OA=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qb(t){this._internalRoot=t}fg.prototype.render=Qb.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Me(409));mg(t,e,null,null)};fg.prototype.unmount=Qb.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Bl(function(){mg(null,t,null,null)}),e[Ni]=null}};function fg(t){this._internalRoot=t}fg.prototype.unstable_scheduleHydration=function(t){if(t){var e=m4();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Yi.length&&e!==0&&e<Yi[n].priority;n++);Yi.splice(n,0,t),n===0&&p4(t)}};function Yb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function pg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function iS(){}function eF(t,e,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var u=d0(o);i.call(u)}}var o=IA(e,r,t,0,null,!1,!1,"",iS);return t._reactRootContainer=o,t[Ni]=o.current,Ah(t.nodeType===8?t.parentNode:t),Bl(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof r=="function"){var c=r;r=function(){var u=d0(d);c.call(u)}}var d=Zb(t,0,!1,null,null,!1,!1,"",iS);return t._reactRootContainer=d,t[Ni]=d.current,Ah(t.nodeType===8?t.parentNode:t),Bl(function(){mg(e,d,n,r)}),d}function gg(t,e,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var c=a;a=function(){var d=d0(o);c.call(d)}}mg(e,o,t,a)}else o=eF(n,e,t,a,r);return d0(o)}u4=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ou(e.pendingLanes);n!==0&&(gb(e,n|1),nr(e,Rn()),!(en&6)&&(Td=Rn()+500,qo()))}break;case 13:Bl(function(){var r=Si(t,1);if(r!==null){var a=Bs();ha(r,t,1,a)}}),Gb(t,1)}};xb=function(t){if(t.tag===13){var e=Si(t,134217728);if(e!==null){var n=Bs();ha(e,t,134217728,n)}Gb(t,134217728)}};h4=function(t){if(t.tag===13){var e=jo(t),n=Si(t,e);if(n!==null){var r=Bs();ha(n,t,e,r)}Gb(t,e)}};m4=function(){return ln};f4=function(t,e){var n=ln;try{return ln=t,e()}finally{ln=n}};r_=function(t,e,n){switch(e){case"input":if(Yy(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var a=ig(r);if(!a)throw Error(Me(90));WE(r),Yy(r,a)}}}break;case"textarea":KE(t,n);break;case"select":e=n.value,e!=null&&td(t,!!n.multiple,e,!1)}};e4=Hb;t4=Bl;var tF={usingClientEntryPoint:!1,Events:[Nm,Hc,ig,XE,JE,Hb]},Eu={findFiberByHostInstance:fl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nF={bundleType:Eu.bundleType,version:Eu.version,rendererPackageName:Eu.rendererPackageName,rendererConfig:Eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ti.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=r4(t),t===null?null:t.stateNode},findFiberByHostInstance:Eu.findFiberByHostInstance||JL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var If=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!If.isDisabled&&If.supportsFiber)try{ng=If.inject(nF),Ha=If}catch{}}Nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tF;Nr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yb(e))throw Error(Me(200));return XL(t,e,null,n)};Nr.createRoot=function(t,e){if(!Yb(t))throw Error(Me(299));var n=!1,r="",a=OA;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=Zb(t,1,!1,null,null,n,!1,r,a),t[Ni]=e.current,Ah(t.nodeType===8?t.parentNode:t),new Qb(e)};Nr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Me(188)):(t=Object.keys(t).join(","),Error(Me(268,t)));return t=r4(e),t=t===null?null:t.stateNode,t};Nr.flushSync=function(t){return Bl(t)};Nr.hydrate=function(t,e,n){if(!pg(e))throw Error(Me(200));return gg(null,t,e,!0,n)};Nr.hydrateRoot=function(t,e,n){if(!Yb(t))throw Error(Me(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",o=OA;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=IA(e,null,t,1,n??null,a,!1,i,o),t[Ni]=e.current,Ah(t),r)for(t=0;t<r.length;t++)n=r[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new fg(e)};Nr.render=function(t,e,n){if(!pg(e))throw Error(Me(200));return gg(null,t,e,!1,n)};Nr.unmountComponentAtNode=function(t){if(!pg(t))throw Error(Me(40));return t._reactRootContainer?(Bl(function(){gg(null,null,t,!1,function(){t._reactRootContainer=null,t[Ni]=null})}),!0):!1};Nr.unstable_batchedUpdates=Hb;Nr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!pg(n))throw Error(Me(200));if(t==null||t._reactInternals===void 0)throw Error(Me(38));return gg(t,e,n,!1,r)};Nr.version="18.3.1-next-f1338f8080-20240426";function LA(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(LA)}catch(t){console.error(t)}}LA(),LE.exports=Nr;var Xl=LE.exports;const FA=sb(Xl);var BA,oS=Xl;BA=oS.createRoot,oS.hydrateRoot;const sF=1,rF=1e6;let fv=0;function aF(){return fv=(fv+1)%Number.MAX_SAFE_INTEGER,fv.toString()}const pv=new Map,lS=t=>{if(pv.has(t))return;const e=setTimeout(()=>{pv.delete(t),ch({type:"REMOVE_TOAST",toastId:t})},rF);pv.set(t,e)},iF=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,sF)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?lS(n):t.toasts.forEach(r=>{lS(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},jp=[];let Np={toasts:[]};function ch(t){Np=iF(Np,t),jp.forEach(e=>{e(Np)})}function Oa({...t}){const e=aF(),n=a=>ch({type:"UPDATE_TOAST",toast:{...a,id:e}}),r=()=>ch({type:"DISMISS_TOAST",toastId:e});return ch({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:a=>{a||r()}}}),{id:e,dismiss:r,update:n}}function It(){const[t,e]=g.useState(Np);return g.useEffect(()=>(jp.push(e),()=>{const n=jp.indexOf(e);n>-1&&jp.splice(n,1)}),[t]),{...t,toast:Oa,dismiss:n=>ch({type:"DISMISS_TOAST",toastId:n})}}function Oe(t,e,{checkForDefaultPrevented:n=!0}={}){return function(a){if(t==null||t(a),n===!1||!a.defaultPrevented)return e==null?void 0:e(a)}}function oF(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function xg(...t){return e=>t.forEach(n=>oF(n,e))}function Rt(...t){return g.useCallback(xg(...t),t)}function lF(t,e=[]){let n=[];function r(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:v,...w}=f,x=(p==null?void 0:p[t][d])||c,y=g.useMemo(()=>w,Object.values(w));return s.jsx(x.Provider,{value:y,children:v})}function m(f,p){const v=(p==null?void 0:p[t][d])||c,w=g.useContext(v);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[r,cF(a,...e)]}function cF(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=r.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var Ci=g.forwardRef((t,e)=>{const{children:n,...r}=t,a=g.Children.toArray(n),i=a.find(dF);if(i){const o=i.props.children,c=a.map(d=>d===i?g.Children.count(o)>1?g.Children.only(null):g.isValidElement(o)?o.props.children:null:d);return s.jsx(L_,{...r,ref:e,children:g.isValidElement(o)?g.cloneElement(o,void 0,c):null})}return s.jsx(L_,{...r,ref:e,children:n})});Ci.displayName="Slot";var L_=g.forwardRef((t,e)=>{const{children:n,...r}=t;if(g.isValidElement(n)){const a=hF(n);return g.cloneElement(n,{...uF(r,n.props),ref:e?xg(e,a):a})}return g.Children.count(n)>1?g.Children.only(null):null});L_.displayName="SlotClone";var zA=({children:t})=>s.jsx(s.Fragment,{children:t});function dF(t){return g.isValidElement(t)&&t.type===zA}function uF(t,e){const n={...e};for(const r in e){const a=t[r],i=e[r];/^on[A-Z]/.test(r)?a&&i?n[r]=(...c)=>{i(...c),a(...c)}:a&&(n[r]=a):r==="style"?n[r]={...a,...i}:r==="className"&&(n[r]=[a,i].filter(Boolean).join(" "))}return{...t,...n}}function hF(t){var r,a;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function km(t){const e=t+"CollectionProvider",[n,r]=lF(e),[a,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=v=>{const{scope:w,children:x}=v,y=Ae.useRef(null),j=Ae.useRef(new Map).current;return s.jsx(a,{scope:w,itemMap:j,collectionRef:y,children:x})};o.displayName=e;const c=t+"CollectionSlot",d=Ae.forwardRef((v,w)=>{const{scope:x,children:y}=v,j=i(c,x),b=Rt(w,j.collectionRef);return s.jsx(Ci,{ref:b,children:y})});d.displayName=c;const u=t+"CollectionItemSlot",m="data-radix-collection-item",f=Ae.forwardRef((v,w)=>{const{scope:x,children:y,...j}=v,b=Ae.useRef(null),N=Rt(w,b),S=i(u,x);return Ae.useEffect(()=>(S.itemMap.set(b,{ref:b,...j}),()=>void S.itemMap.delete(b))),s.jsx(Ci,{[m]:"",ref:N,children:y})});f.displayName=u;function p(v){const w=i(t+"CollectionConsumer",v);return Ae.useCallback(()=>{const y=w.collectionRef.current;if(!y)return[];const j=Array.from(y.querySelectorAll(`[${m}]`));return Array.from(w.itemMap.values()).sort((S,E)=>j.indexOf(S.ref.current)-j.indexOf(E.ref.current))},[w.collectionRef,w.itemMap])}return[{Provider:o,Slot:d,ItemSlot:f},p,r]}function mF(t,e){const n=g.createContext(e),r=i=>{const{children:o,...c}=i,d=g.useMemo(()=>c,Object.values(c));return s.jsx(n.Provider,{value:d,children:o})};r.displayName=t+"Provider";function a(i){const o=g.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,a]}function kr(t,e=[]){let n=[];function r(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];const u=f=>{var j;const{scope:p,children:v,...w}=f,x=((j=p==null?void 0:p[t])==null?void 0:j[d])||c,y=g.useMemo(()=>w,Object.values(w));return s.jsx(x.Provider,{value:y,children:v})};u.displayName=i+"Provider";function m(f,p){var x;const v=((x=p==null?void 0:p[t])==null?void 0:x[d])||c,w=g.useContext(v);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[r,fF(a,...e)]}function fF(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=r.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var pF=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],tt=pF.reduce((t,e)=>{const n=g.forwardRef((r,a)=>{const{asChild:i,...o}=r,c=i?Ci:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(c,{...o,ref:a})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function Xb(t,e){t&&Xl.flushSync(()=>t.dispatchEvent(e))}function _n(t){const e=g.useRef(t);return g.useEffect(()=>{e.current=t}),g.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function gF(t,e=globalThis==null?void 0:globalThis.document){const n=_n(t);g.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var xF="DismissableLayer",F_="dismissableLayer.update",vF="dismissableLayer.pointerDownOutside",yF="dismissableLayer.focusOutside",cS,$A=g.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Jl=g.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:c,...d}=t,u=g.useContext($A),[m,f]=g.useState(null),p=(m==null?void 0:m.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,v]=g.useState({}),w=Rt(e,P=>f(P)),x=Array.from(u.layers),[y]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),j=x.indexOf(y),b=m?x.indexOf(m):-1,N=u.layersWithOutsidePointerEventsDisabled.size>0,S=b>=j,E=wF(P=>{const R=P.target,H=[...u.branches].some(I=>I.contains(R));!S||H||(a==null||a(P),o==null||o(P),P.defaultPrevented||c==null||c())},p),C=bF(P=>{const R=P.target;[...u.branches].some(I=>I.contains(R))||(i==null||i(P),o==null||o(P),P.defaultPrevented||c==null||c())},p);return gF(P=>{b===u.layers.size-1&&(r==null||r(P),!P.defaultPrevented&&c&&(P.preventDefault(),c()))},p),g.useEffect(()=>{if(m)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(cS=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(m)),u.layers.add(m),dS(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=cS)}},[m,p,n,u]),g.useEffect(()=>()=>{m&&(u.layers.delete(m),u.layersWithOutsidePointerEventsDisabled.delete(m),dS())},[m,u]),g.useEffect(()=>{const P=()=>v({});return document.addEventListener(F_,P),()=>document.removeEventListener(F_,P)},[]),s.jsx(tt.div,{...d,ref:w,style:{pointerEvents:N?S?"auto":"none":void 0,...t.style},onFocusCapture:Oe(t.onFocusCapture,C.onFocusCapture),onBlurCapture:Oe(t.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Oe(t.onPointerDownCapture,E.onPointerDownCapture)})});Jl.displayName=xF;var _F="DismissableLayerBranch",UA=g.forwardRef((t,e)=>{const n=g.useContext($A),r=g.useRef(null),a=Rt(e,r);return g.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),s.jsx(tt.div,{...t,ref:a})});UA.displayName=_F;function wF(t,e=globalThis==null?void 0:globalThis.document){const n=_n(t),r=g.useRef(!1),a=g.useRef(()=>{});return g.useEffect(()=>{const i=c=>{if(c.target&&!r.current){let d=function(){qA(vF,n,u,{discrete:!0})};const u={originalEvent:c};c.pointerType==="touch"?(e.removeEventListener("click",a.current),a.current=d,e.addEventListener("click",a.current,{once:!0})):d()}else e.removeEventListener("click",a.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",a.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function bF(t,e=globalThis==null?void 0:globalThis.document){const n=_n(t),r=g.useRef(!1);return g.useEffect(()=>{const a=i=>{i.target&&!r.current&&qA(yF,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",a),()=>e.removeEventListener("focusin",a)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function dS(){const t=new CustomEvent(F_);document.dispatchEvent(t)}function qA(t,e,n,{discrete:r}){const a=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&a.addEventListener(t,e,{once:!0}),r?Xb(a,i):a.dispatchEvent(i)}var jF=Jl,NF=UA,qn=globalThis!=null&&globalThis.document?g.useLayoutEffect:()=>{},SF="Portal",Vd=g.forwardRef((t,e)=>{var c;const{container:n,...r}=t,[a,i]=g.useState(!1);qn(()=>i(!0),[]);const o=n||a&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return o?FA.createPortal(s.jsx(tt.div,{...r,ref:e}),o):null});Vd.displayName=SF;function kF(t,e){return g.useReducer((n,r)=>e[n][r]??n,t)}var ts=t=>{const{present:e,children:n}=t,r=CF(e),a=typeof n=="function"?n({present:r.isPresent}):g.Children.only(n),i=Rt(r.ref,EF(a));return typeof n=="function"||r.isPresent?g.cloneElement(a,{ref:i}):null};ts.displayName="Presence";function CF(t){const[e,n]=g.useState(),r=g.useRef({}),a=g.useRef(t),i=g.useRef("none"),o=t?"mounted":"unmounted",[c,d]=kF(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return g.useEffect(()=>{const u=Of(r.current);i.current=c==="mounted"?u:"none"},[c]),qn(()=>{const u=r.current,m=a.current;if(m!==t){const p=i.current,v=Of(u);t?d("MOUNT"):v==="none"||(u==null?void 0:u.display)==="none"?d("UNMOUNT"):d(m&&p!==v?"ANIMATION_OUT":"UNMOUNT"),a.current=t}},[t,d]),qn(()=>{if(e){let u;const m=e.ownerDocument.defaultView??window,f=v=>{const x=Of(r.current).includes(v.animationName);if(v.target===e&&x&&(d("ANIMATION_END"),!a.current)){const y=e.style.animationFillMode;e.style.animationFillMode="forwards",u=m.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=y)})}},p=v=>{v.target===e&&(i.current=Of(r.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{m.clearTimeout(u),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else d("ANIMATION_END")},[e,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:g.useCallback(u=>{u&&(r.current=getComputedStyle(u)),n(u)},[])}}function Of(t){return(t==null?void 0:t.animationName)||"none"}function EF(t){var r,a;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function qr({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,a]=AF({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,c=_n(n),d=g.useCallback(u=>{if(i){const f=typeof u=="function"?u(t):u;f!==t&&c(f)}else a(u)},[i,t,a,c]);return[o,d]}function AF({defaultProp:t,onChange:e}){const n=g.useState(t),[r]=n,a=g.useRef(r),i=_n(e);return g.useEffect(()=>{a.current!==r&&(i(r),a.current=r)},[r,a,i]),n}var PF="VisuallyHidden",Cm=g.forwardRef((t,e)=>s.jsx(tt.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));Cm.displayName=PF;var DF=Cm,Jb="ToastProvider",[ej,TF,MF]=km("Toast"),[HA,aae]=kr("Toast",[MF]),[RF,vg]=HA(Jb),WA=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:o}=t,[c,d]=g.useState(null),[u,m]=g.useState(0),f=g.useRef(!1),p=g.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${Jb}\`. Expected non-empty \`string\`.`),s.jsx(ej.Provider,{scope:e,children:s.jsx(RF,{scope:e,label:n,duration:r,swipeDirection:a,swipeThreshold:i,toastCount:u,viewport:c,onViewportChange:d,onToastAdd:g.useCallback(()=>m(v=>v+1),[]),onToastRemove:g.useCallback(()=>m(v=>v-1),[]),isFocusedToastEscapeKeyDownRef:f,isClosePausedRef:p,children:o})})};WA.displayName=Jb;var VA="ToastViewport",IF=["F8"],B_="toast.viewportPause",z_="toast.viewportResume",KA=g.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=IF,label:a="Notifications ({hotkey})",...i}=t,o=vg(VA,n),c=TF(n),d=g.useRef(null),u=g.useRef(null),m=g.useRef(null),f=g.useRef(null),p=Rt(e,f,o.onViewportChange),v=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),w=o.toastCount>0;g.useEffect(()=>{const y=j=>{var N;r.length!==0&&r.every(S=>j[S]||j.code===S)&&((N=f.current)==null||N.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[r]),g.useEffect(()=>{const y=d.current,j=f.current;if(w&&y&&j){const b=()=>{if(!o.isClosePausedRef.current){const C=new CustomEvent(B_);j.dispatchEvent(C),o.isClosePausedRef.current=!0}},N=()=>{if(o.isClosePausedRef.current){const C=new CustomEvent(z_);j.dispatchEvent(C),o.isClosePausedRef.current=!1}},S=C=>{!y.contains(C.relatedTarget)&&N()},E=()=>{y.contains(document.activeElement)||N()};return y.addEventListener("focusin",b),y.addEventListener("focusout",S),y.addEventListener("pointermove",b),y.addEventListener("pointerleave",E),window.addEventListener("blur",b),window.addEventListener("focus",N),()=>{y.removeEventListener("focusin",b),y.removeEventListener("focusout",S),y.removeEventListener("pointermove",b),y.removeEventListener("pointerleave",E),window.removeEventListener("blur",b),window.removeEventListener("focus",N)}}},[w,o.isClosePausedRef]);const x=g.useCallback(({tabbingDirection:y})=>{const b=c().map(N=>{const S=N.ref.current,E=[S,...ZF(S)];return y==="forwards"?E:E.reverse()});return(y==="forwards"?b.reverse():b).flat()},[c]);return g.useEffect(()=>{const y=f.current;if(y){const j=b=>{var E,C,P;const N=b.altKey||b.ctrlKey||b.metaKey;if(b.key==="Tab"&&!N){const R=document.activeElement,H=b.shiftKey;if(b.target===y&&H){(E=u.current)==null||E.focus();return}const W=x({tabbingDirection:H?"backwards":"forwards"}),V=W.findIndex(G=>G===R);gv(W.slice(V+1))?b.preventDefault():H?(C=u.current)==null||C.focus():(P=m.current)==null||P.focus()}};return y.addEventListener("keydown",j),()=>y.removeEventListener("keydown",j)}},[c,x]),s.jsxs(NF,{ref:d,role:"region","aria-label":a.replace("{hotkey}",v),tabIndex:-1,style:{pointerEvents:w?void 0:"none"},children:[w&&s.jsx($_,{ref:u,onFocusFromOutsideViewport:()=>{const y=x({tabbingDirection:"forwards"});gv(y)}}),s.jsx(ej.Slot,{scope:n,children:s.jsx(tt.ol,{tabIndex:-1,...i,ref:p})}),w&&s.jsx($_,{ref:m,onFocusFromOutsideViewport:()=>{const y=x({tabbingDirection:"backwards"});gv(y)}})]})});KA.displayName=VA;var ZA="ToastFocusProxy",$_=g.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...a}=t,i=vg(ZA,n);return s.jsx(Cm,{"aria-hidden":!0,tabIndex:0,...a,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const c=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(c))&&r()}})});$_.displayName=ZA;var yg="Toast",OF="toast.swipeStart",LF="toast.swipeMove",FF="toast.swipeCancel",BF="toast.swipeEnd",GA=g.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:a,onOpenChange:i,...o}=t,[c=!0,d]=qr({prop:r,defaultProp:a,onChange:i});return s.jsx(ts,{present:n||c,children:s.jsx(UF,{open:c,...o,ref:e,onClose:()=>d(!1),onPause:_n(t.onPause),onResume:_n(t.onResume),onSwipeStart:Oe(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Oe(t.onSwipeMove,u=>{const{x:m,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${m}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${f}px`)}),onSwipeCancel:Oe(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Oe(t.onSwipeEnd,u=>{const{x:m,y:f}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${m}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${f}px`),d(!1)})})})});GA.displayName=yg;var[zF,$F]=HA(yg,{onClose(){}}),UF=g.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:a,open:i,onClose:o,onEscapeKeyDown:c,onPause:d,onResume:u,onSwipeStart:m,onSwipeMove:f,onSwipeCancel:p,onSwipeEnd:v,...w}=t,x=vg(yg,n),[y,j]=g.useState(null),b=Rt(e,G=>j(G)),N=g.useRef(null),S=g.useRef(null),E=a||x.duration,C=g.useRef(0),P=g.useRef(E),R=g.useRef(0),{onToastAdd:H,onToastRemove:I}=x,D=_n(()=>{var Y;(y==null?void 0:y.contains(document.activeElement))&&((Y=x.viewport)==null||Y.focus()),o()}),W=g.useCallback(G=>{!G||G===1/0||(window.clearTimeout(R.current),C.current=new Date().getTime(),R.current=window.setTimeout(D,G))},[D]);g.useEffect(()=>{const G=x.viewport;if(G){const Y=()=>{W(P.current),u==null||u()},X=()=>{const F=new Date().getTime()-C.current;P.current=P.current-F,window.clearTimeout(R.current),d==null||d()};return G.addEventListener(B_,X),G.addEventListener(z_,Y),()=>{G.removeEventListener(B_,X),G.removeEventListener(z_,Y)}}},[x.viewport,E,d,u,W]),g.useEffect(()=>{i&&!x.isClosePausedRef.current&&W(E)},[i,E,x.isClosePausedRef,W]),g.useEffect(()=>(H(),()=>I()),[H,I]);const V=g.useMemo(()=>y?nP(y):null,[y]);return x.viewport?s.jsxs(s.Fragment,{children:[V&&s.jsx(qF,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:V}),s.jsx(zF,{scope:n,onClose:D,children:Xl.createPortal(s.jsx(ej.ItemSlot,{scope:n,children:s.jsx(jF,{asChild:!0,onEscapeKeyDown:Oe(c,()=>{x.isFocusedToastEscapeKeyDownRef.current||D(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:s.jsx(tt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":x.swipeDirection,...w,ref:b,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Oe(t.onKeyDown,G=>{G.key==="Escape"&&(c==null||c(G.nativeEvent),G.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,D()))}),onPointerDown:Oe(t.onPointerDown,G=>{G.button===0&&(N.current={x:G.clientX,y:G.clientY})}),onPointerMove:Oe(t.onPointerMove,G=>{if(!N.current)return;const Y=G.clientX-N.current.x,X=G.clientY-N.current.y,F=!!S.current,T=["left","right"].includes(x.swipeDirection),q=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,U=T?q(0,Y):0,B=T?0:q(0,X),O=G.pointerType==="touch"?10:2,z={x:U,y:B},$={originalEvent:G,delta:z};F?(S.current=z,Lf(LF,f,$,{discrete:!1})):uS(z,x.swipeDirection,O)?(S.current=z,Lf(OF,m,$,{discrete:!1}),G.target.setPointerCapture(G.pointerId)):(Math.abs(Y)>O||Math.abs(X)>O)&&(N.current=null)}),onPointerUp:Oe(t.onPointerUp,G=>{const Y=S.current,X=G.target;if(X.hasPointerCapture(G.pointerId)&&X.releasePointerCapture(G.pointerId),S.current=null,N.current=null,Y){const F=G.currentTarget,T={originalEvent:G,delta:Y};uS(Y,x.swipeDirection,x.swipeThreshold)?Lf(BF,v,T,{discrete:!0}):Lf(FF,p,T,{discrete:!0}),F.addEventListener("click",q=>q.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),qF=t=>{const{__scopeToast:e,children:n,...r}=t,a=vg(yg,e),[i,o]=g.useState(!1),[c,d]=g.useState(!1);return VF(()=>o(!0)),g.useEffect(()=>{const u=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(u)},[]),c?null:s.jsx(Vd,{asChild:!0,children:s.jsx(Cm,{...r,children:i&&s.jsxs(s.Fragment,{children:[a.label," ",n]})})})},HF="ToastTitle",QA=g.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return s.jsx(tt.div,{...r,ref:e})});QA.displayName=HF;var WF="ToastDescription",YA=g.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return s.jsx(tt.div,{...r,ref:e})});YA.displayName=WF;var XA="ToastAction",JA=g.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?s.jsx(tP,{altText:n,asChild:!0,children:s.jsx(tj,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${XA}\`. Expected non-empty \`string\`.`),null)});JA.displayName=XA;var eP="ToastClose",tj=g.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,a=$F(eP,n);return s.jsx(tP,{asChild:!0,children:s.jsx(tt.button,{type:"button",...r,ref:e,onClick:Oe(t.onClick,a.onClose)})})});tj.displayName=eP;var tP=g.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...a}=t;return s.jsx(tt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...a,ref:e})});function nP(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),KF(r)){const a=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...nP(r))}}),e}function Lf(t,e,n,{discrete:r}){const a=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&a.addEventListener(t,e,{once:!0}),r?Xb(a,i):a.dispatchEvent(i)}var uS=(t,e,n=0)=>{const r=Math.abs(t.x),a=Math.abs(t.y),i=r>a;return e==="left"||e==="right"?i&&r>n:!i&&a>n};function VF(t=()=>{}){const e=_n(t);qn(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function KF(t){return t.nodeType===t.ELEMENT_NODE}function ZF(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function gv(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var GF=WA,sP=KA,rP=GA,aP=QA,iP=YA,oP=JA,lP=tj;function cP(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(n=cP(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function dP(){for(var t,e,n=0,r="",a=arguments.length;n<a;n++)(t=arguments[n])&&(e=cP(t))&&(r&&(r+=" "),r+=e);return r}const hS=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,mS=dP,Kd=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return mS(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:i}=e,o=Object.keys(a).map(u=>{const m=n==null?void 0:n[u],f=i==null?void 0:i[u];if(m===null)return null;const p=hS(m)||hS(f);return a[u][p]}),c=n&&Object.entries(n).reduce((u,m)=>{let[f,p]=m;return p===void 0||(u[f]=p),u},{}),d=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,m)=>{let{class:f,className:p,...v}=m;return Object.entries(v).every(w=>{let[x,y]=w;return Array.isArray(y)?y.includes({...i,...c}[x]):{...i,...c}[x]===y})?[...u,f,p]:u},[]);return mS(t,o,d,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),uP=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var YF={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=g.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:i,iconNode:o,...c},d)=>g.createElement("svg",{ref:d,...YF,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:uP("lucide",a),...c},[...o.map(([u,m])=>g.createElement(u,m)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=(t,e)=>{const n=g.forwardRef(({className:r,...a},i)=>g.createElement(XF,{ref:i,iconNode:e,className:uP(`lucide-${QF(t)}`,r),...a}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=Pe("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=Pe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nj=Pe("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=Pe("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=Pe("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ff=Pe("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mc=Pe("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=Pe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=Pe("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=Pe("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=Pe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U_=Pe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _g=Pe("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Al=Pe("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Em=Pe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=Pe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dh=Pe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=Pe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=Pe("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Am=Pe("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=Pe("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=Pe("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=Pe("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const So=Pe("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=Pe("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=Pe("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=Pe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fh=Pe("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=Pe("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=Pe("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=Pe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=Pe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=Pe("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=Pe("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hP=Pe("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=Pe("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=Pe("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bf=Pe("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wn=Pe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=Pe("Forward",[["polyline",{points:"15 17 20 12 15 7",key:"1w3sku"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=Pe("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=Pe("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=Pe("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=Pe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=Pe("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=Pe("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=Pe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=Pe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=Pe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mi=Pe("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mP=Pe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=Pe("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=Pe("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=Pe("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=Pe("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=Pe("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W_=Pe("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=Pe("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bh=Pe("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=Pe("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=Pe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=Pe("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=Pe("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=Pe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xv=Pe("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=Pe("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uh=Pe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=Pe("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fP=Pe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zh=Pe("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hh=Pe("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ec=Pe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=Pe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=Pe("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NB=Pe("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pP=Pe("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=Pe("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zl=Pe("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sj=Pe("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ji=Pe("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=Pe("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rj=Pe("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=Pe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aj=Pe("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=Pe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=Pe("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gP=Pe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pm=Pe("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=Pe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=Pe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=Pe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xP=Pe("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kB=Pe("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=Pe("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $h=Pe("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=Pe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=Pe("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),ij="-",CB=t=>{const e=AB(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const c=o.split(ij);return c[0]===""&&c.length!==1&&c.shift(),vP(c,e)||EB(o)},getConflictingClassGroupIds:(o,c)=>{const d=n[o]||[];return c&&r[o]?[...d,...r[o]]:d}}},vP=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),a=r?vP(t.slice(1),r):void 0;if(a)return a;if(e.validators.length===0)return;const i=t.join(ij);return(o=e.validators.find(({validator:c})=>c(i)))==null?void 0:o.classGroupId},_S=/^\[(.+)\]$/,EB=t=>{if(_S.test(t)){const e=_S.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},AB=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return DB(Object.entries(t.classGroups),n).forEach(([i,o])=>{K_(o,r,i,e)}),r},K_=(t,e,n,r)=>{t.forEach(a=>{if(typeof a=="string"){const i=a===""?e:wS(e,a);i.classGroupId=n;return}if(typeof a=="function"){if(PB(a)){K_(a(r),e,n,r);return}e.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([i,o])=>{K_(o,wS(e,i),n,r)})})},wS=(t,e)=>{let n=t;return e.split(ij).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},PB=t=>t.isThemeGetter,DB=(t,e)=>e?t.map(([n,r])=>{const a=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,c])=>[e+o,c])):i);return[n,a]}):t,TB=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const a=(i,o)=>{n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return a(i,o),o},set(i,o){n.has(i)?n.set(i,o):a(i,o)}}},yP="!",MB=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,a=e[0],i=e.length,o=c=>{const d=[];let u=0,m=0,f;for(let y=0;y<c.length;y++){let j=c[y];if(u===0){if(j===a&&(r||c.slice(y,y+i)===e)){d.push(c.slice(m,y)),m=y+i;continue}if(j==="/"){f=y;continue}}j==="["?u++:j==="]"&&u--}const p=d.length===0?c:c.substring(m),v=p.startsWith(yP),w=v?p.substring(1):p,x=f&&f>m?f-m:void 0;return{modifiers:d,hasImportantModifier:v,baseClassName:w,maybePostfixModifierPosition:x}};return n?c=>n({className:c,parseClassName:o}):o},RB=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},IB=t=>({cache:TB(t.cacheSize),parseClassName:MB(t),...CB(t)}),OB=/\s+/,LB=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a}=e,i=[],o=t.trim().split(OB);let c="";for(let d=o.length-1;d>=0;d-=1){const u=o[d],{modifiers:m,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:v}=n(u);let w=!!v,x=r(w?p.substring(0,v):p);if(!x){if(!w){c=u+(c.length>0?" "+c:c);continue}if(x=r(p),!x){c=u+(c.length>0?" "+c:c);continue}w=!1}const y=RB(m).join(":"),j=f?y+yP:y,b=j+x;if(i.includes(b))continue;i.push(b);const N=a(x,w);for(let S=0;S<N.length;++S){const E=N[S];i.push(j+E)}c=u+(c.length>0?" "+c:c)}return c};function FB(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=_P(e))&&(r&&(r+=" "),r+=n);return r}const _P=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=_P(t[r]))&&(n&&(n+=" "),n+=e);return n};function BB(t,...e){let n,r,a,i=o;function o(d){const u=e.reduce((m,f)=>f(m),t());return n=IB(u),r=n.cache.get,a=n.cache.set,i=c,c(d)}function c(d){const u=r(d);if(u)return u;const m=LB(d,n);return a(d,m),m}return function(){return i(FB.apply(null,arguments))}}const pn=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},wP=/^\[(?:([a-z-]+):)?(.+)\]$/i,zB=/^\d+\/\d+$/,$B=new Set(["px","full","screen"]),UB=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,qB=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,HB=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,WB=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,VB=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,oi=t=>od(t)||$B.has(t)||zB.test(t),Bi=t=>Qd(t,"length",ez),od=t=>!!t&&!Number.isNaN(Number(t)),vv=t=>Qd(t,"number",od),Au=t=>!!t&&Number.isInteger(Number(t)),KB=t=>t.endsWith("%")&&od(t.slice(0,-1)),Ot=t=>wP.test(t),zi=t=>UB.test(t),ZB=new Set(["length","size","percentage"]),GB=t=>Qd(t,ZB,bP),QB=t=>Qd(t,"position",bP),YB=new Set(["image","url"]),XB=t=>Qd(t,YB,nz),JB=t=>Qd(t,"",tz),Pu=()=>!0,Qd=(t,e,n)=>{const r=wP.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},ez=t=>qB.test(t)&&!HB.test(t),bP=()=>!1,tz=t=>WB.test(t),nz=t=>VB.test(t),sz=()=>{const t=pn("colors"),e=pn("spacing"),n=pn("blur"),r=pn("brightness"),a=pn("borderColor"),i=pn("borderRadius"),o=pn("borderSpacing"),c=pn("borderWidth"),d=pn("contrast"),u=pn("grayscale"),m=pn("hueRotate"),f=pn("invert"),p=pn("gap"),v=pn("gradientColorStops"),w=pn("gradientColorStopPositions"),x=pn("inset"),y=pn("margin"),j=pn("opacity"),b=pn("padding"),N=pn("saturate"),S=pn("scale"),E=pn("sepia"),C=pn("skew"),P=pn("space"),R=pn("translate"),H=()=>["auto","contain","none"],I=()=>["auto","hidden","clip","visible","scroll"],D=()=>["auto",Ot,e],W=()=>[Ot,e],V=()=>["",oi,Bi],G=()=>["auto",od,Ot],Y=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],X=()=>["solid","dashed","dotted","double","none"],F=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],T=()=>["start","end","center","between","around","evenly","stretch"],q=()=>["","0",Ot],U=()=>["auto","avoid","all","avoid-page","page","left","right","column"],B=()=>[od,Ot];return{cacheSize:500,separator:":",theme:{colors:[Pu],spacing:[oi,Bi],blur:["none","",zi,Ot],brightness:B(),borderColor:[t],borderRadius:["none","","full",zi,Ot],borderSpacing:W(),borderWidth:V(),contrast:B(),grayscale:q(),hueRotate:B(),invert:q(),gap:W(),gradientColorStops:[t],gradientColorStopPositions:[KB,Bi],inset:D(),margin:D(),opacity:B(),padding:W(),saturate:B(),scale:B(),sepia:q(),skew:B(),space:W(),translate:W()},classGroups:{aspect:[{aspect:["auto","square","video",Ot]}],container:["container"],columns:[{columns:[zi]}],"break-after":[{"break-after":U()}],"break-before":[{"break-before":U()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Y(),Ot]}],overflow:[{overflow:I()}],"overflow-x":[{"overflow-x":I()}],"overflow-y":[{"overflow-y":I()}],overscroll:[{overscroll:H()}],"overscroll-x":[{"overscroll-x":H()}],"overscroll-y":[{"overscroll-y":H()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Au,Ot]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ot]}],grow:[{grow:q()}],shrink:[{shrink:q()}],order:[{order:["first","last","none",Au,Ot]}],"grid-cols":[{"grid-cols":[Pu]}],"col-start-end":[{col:["auto",{span:["full",Au,Ot]},Ot]}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":[Pu]}],"row-start-end":[{row:["auto",{span:[Au,Ot]},Ot]}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ot]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ot]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...T()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...T(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...T(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[P]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[P]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ot,e]}],"min-w":[{"min-w":[Ot,e,"min","max","fit"]}],"max-w":[{"max-w":[Ot,e,"none","full","min","max","fit","prose",{screen:[zi]},zi]}],h:[{h:[Ot,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ot,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ot,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ot,e,"auto","min","max","fit"]}],"font-size":[{text:["base",zi,Bi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",vv]}],"font-family":[{font:[Pu]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ot]}],"line-clamp":[{"line-clamp":["none",od,vv]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",oi,Ot]}],"list-image":[{"list-image":["none",Ot]}],"list-style-type":[{list:["none","disc","decimal",Ot]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[j]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[j]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...X(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",oi,Bi]}],"underline-offset":[{"underline-offset":["auto",oi,Ot]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:W()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ot]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ot]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[j]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Y(),QB]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",GB]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},XB]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[j]}],"border-style":[{border:[...X(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[j]}],"divide-style":[{divide:X()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...X()]}],"outline-offset":[{"outline-offset":[oi,Ot]}],"outline-w":[{outline:[oi,Bi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[j]}],"ring-offset-w":[{"ring-offset":[oi,Bi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",zi,JB]}],"shadow-color":[{shadow:[Pu]}],opacity:[{opacity:[j]}],"mix-blend":[{"mix-blend":[...F(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":F()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",zi,Ot]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[m]}],invert:[{invert:[f]}],saturate:[{saturate:[N]}],sepia:[{sepia:[E]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[m]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[j]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ot]}],duration:[{duration:B()}],ease:[{ease:["linear","in","out","in-out",Ot]}],delay:[{delay:B()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ot]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[Au,Ot]}],"translate-x":[{"translate-x":[R]}],"translate-y":[{"translate-y":[R]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ot]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ot]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":W()}],"scroll-mx":[{"scroll-mx":W()}],"scroll-my":[{"scroll-my":W()}],"scroll-ms":[{"scroll-ms":W()}],"scroll-me":[{"scroll-me":W()}],"scroll-mt":[{"scroll-mt":W()}],"scroll-mr":[{"scroll-mr":W()}],"scroll-mb":[{"scroll-mb":W()}],"scroll-ml":[{"scroll-ml":W()}],"scroll-p":[{"scroll-p":W()}],"scroll-px":[{"scroll-px":W()}],"scroll-py":[{"scroll-py":W()}],"scroll-ps":[{"scroll-ps":W()}],"scroll-pe":[{"scroll-pe":W()}],"scroll-pt":[{"scroll-pt":W()}],"scroll-pr":[{"scroll-pr":W()}],"scroll-pb":[{"scroll-pb":W()}],"scroll-pl":[{"scroll-pl":W()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ot]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[oi,Bi,vv]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},rz=BB(sz);function Ie(...t){return rz(dP(t))}const az=GF,jP=g.forwardRef(({className:t,...e},n)=>s.jsx(sP,{ref:n,className:Ie("fixed top-20 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));jP.displayName=sP.displayName;const iz=Kd("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),NP=g.forwardRef(({className:t,variant:e,...n},r)=>s.jsx(rP,{ref:r,className:Ie(iz({variant:e}),t),...n}));NP.displayName=rP.displayName;const oz=g.forwardRef(({className:t,...e},n)=>s.jsx(oP,{ref:n,className:Ie("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));oz.displayName=oP.displayName;const SP=g.forwardRef(({className:t,...e},n)=>s.jsx(lP,{ref:n,className:Ie("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:s.jsx($n,{className:"h-4 w-4"})}));SP.displayName=lP.displayName;const kP=g.forwardRef(({className:t,...e},n)=>s.jsx(aP,{ref:n,className:Ie("text-sm font-semibold",t),...e}));kP.displayName=aP.displayName;const CP=g.forwardRef(({className:t,...e},n)=>s.jsx(iP,{ref:n,className:Ie("text-sm opacity-90",t),...e}));CP.displayName=iP.displayName;function lz(){const{toasts:t}=It();return s.jsxs(az,{children:[t.map(function({id:e,title:n,description:r,action:a,...i}){return s.jsxs(NP,{...i,children:[s.jsxs("div",{className:"grid gap-1",children:[n&&s.jsx(kP,{children:n}),r&&s.jsx(CP,{children:r})]}),a,s.jsx(SP,{})]},e)}),s.jsx(jP,{})]})}const EP=g.createContext(void 0);function cz({children:t}){const[e,n]=g.useState(()=>localStorage.getItem("handwerkos-theme")||"light"),[r,a]=g.useState("light");return g.useEffect(()=>{const i=window.document.documentElement;if(i.classList.remove("light","dark"),e==="system"){const o=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i.classList.add(o),a(o)}else i.classList.add(e),a(e);localStorage.setItem("handwerkos-theme",e)},[e]),g.useEffect(()=>{if(e==="system"){const i=window.matchMedia("(prefers-color-scheme: dark)"),o=c=>{const d=c.matches?"dark":"light";document.documentElement.classList.remove("light","dark"),document.documentElement.classList.add(d),a(d)};return i.addEventListener("change",o),()=>i.removeEventListener("change",o)}},[e]),s.jsx(EP.Provider,{value:{theme:e,setTheme:n,actualTheme:r},children:t})}function oj(){const t=g.useContext(EP);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t}var dz=t=>{switch(t){case"success":return mz;case"info":return pz;case"warning":return fz;case"error":return gz;default:return null}},uz=Array(12).fill(0),hz=({visible:t})=>Ae.createElement("div",{className:"sonner-loading-wrapper","data-visible":t},Ae.createElement("div",{className:"sonner-spinner"},uz.map((e,n)=>Ae.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),mz=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),fz=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),pz=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),gz=Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ae.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),xz=()=>{let[t,e]=Ae.useState(document.hidden);return Ae.useEffect(()=>{let n=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),t},Z_=1,vz=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:n,...r}=t,a=typeof(t==null?void 0:t.id)=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:Z_++,i=this.toasts.find(c=>c.id===a),o=t.dismissible===void 0?!0:t.dismissible;return i?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...t,id:a,title:n}),{...c,...t,id:a,dismissible:o,title:n}):c):this.addToast({title:n,...r,dismissible:o,id:a}),a},this.dismiss=t=>(t||this.toasts.forEach(e=>{this.subscribers.forEach(n=>n({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let n;e.loading!==void 0&&(n=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let r=t instanceof Promise?t:t(),a=n!==void 0;return r.then(async i=>{if(_z(i)&&!i.ok){a=!1;let o=typeof e.error=="function"?await e.error(`HTTP error! status: ${i.status}`):e.error,c=typeof e.description=="function"?await e.description(`HTTP error! status: ${i.status}`):e.description;this.create({id:n,type:"error",message:o,description:c})}else if(e.success!==void 0){a=!1;let o=typeof e.success=="function"?await e.success(i):e.success,c=typeof e.description=="function"?await e.description(i):e.description;this.create({id:n,type:"success",message:o,description:c})}}).catch(async i=>{if(e.error!==void 0){a=!1;let o=typeof e.error=="function"?await e.error(i):e.error,c=typeof e.description=="function"?await e.description(i):e.description;this.create({id:n,type:"error",message:o,description:c})}}).finally(()=>{var i;a&&(this.dismiss(n),n=void 0),(i=e.finally)==null||i.call(e)}),n},this.custom=(t,e)=>{let n=(e==null?void 0:e.id)||Z_++;return this.create({jsx:t(n),id:n,...e}),n},this.subscribers=[],this.toasts=[]}},cr=new vz,yz=(t,e)=>{let n=(e==null?void 0:e.id)||Z_++;return cr.addToast({title:t,...e,id:n}),n},_z=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",wz=yz,bz=()=>cr.toasts,Te=Object.assign(wz,{success:cr.success,info:cr.info,warning:cr.warning,error:cr.error,custom:cr.custom,message:cr.message,promise:cr.promise,dismiss:cr.dismiss,loading:cr.loading},{getHistory:bz});function jz(t,{insertAt:e}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}jz(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function zf(t){return t.label!==void 0}var Nz=3,Sz="32px",kz=4e3,Cz=356,Ez=14,Az=20,Pz=200;function Dz(...t){return t.filter(Boolean).join(" ")}var Tz=t=>{var e,n,r,a,i,o,c,d,u,m;let{invert:f,toast:p,unstyled:v,interacting:w,setHeights:x,visibleToasts:y,heights:j,index:b,toasts:N,expanded:S,removeToast:E,defaultRichColors:C,closeButton:P,style:R,cancelButtonStyle:H,actionButtonStyle:I,className:D="",descriptionClassName:W="",duration:V,position:G,gap:Y,loadingIcon:X,expandByDefault:F,classNames:T,icons:q,closeButtonAriaLabel:U="Close toast",pauseWhenPageIsHidden:B,cn:O}=t,[z,$]=Ae.useState(!1),[te,ee]=Ae.useState(!1),[Q,le]=Ae.useState(!1),[pe,J]=Ae.useState(!1),[ae,fe]=Ae.useState(0),[he,ve]=Ae.useState(0),ie=Ae.useRef(null),_e=Ae.useRef(null),Se=b===0,Ve=b+1<=y,Xe=p.type,Et=p.dismissible!==!1,ke=p.className||"",Le=p.descriptionClassName||"",ze=Ae.useMemo(()=>j.findIndex(ot=>ot.toastId===p.id)||0,[j,p.id]),dt=Ae.useMemo(()=>{var ot;return(ot=p.closeButton)!=null?ot:P},[p.closeButton,P]),Ze=Ae.useMemo(()=>p.duration||V||kz,[p.duration,V]),Fe=Ae.useRef(0),Nt=Ae.useRef(0),vt=Ae.useRef(0),Vn=Ae.useRef(null),[js,yt]=G.split("-"),cn=Ae.useMemo(()=>j.reduce((ot,we,be)=>be>=ze?ot:ot+we.height,0),[j,ze]),On=xz(),hs=p.invert||f,Kn=Xe==="loading";Nt.current=Ae.useMemo(()=>ze*Y+cn,[ze,cn]),Ae.useEffect(()=>{$(!0)},[]),Ae.useLayoutEffect(()=>{if(!z)return;let ot=_e.current,we=ot.style.height;ot.style.height="auto";let be=ot.getBoundingClientRect().height;ot.style.height=we,ve(be),x(Ee=>Ee.find($e=>$e.toastId===p.id)?Ee.map($e=>$e.toastId===p.id?{...$e,height:be}:$e):[{toastId:p.id,height:be,position:p.position},...Ee])},[z,p.title,p.description,x,p.id]);let Pn=Ae.useCallback(()=>{ee(!0),fe(Nt.current),x(ot=>ot.filter(we=>we.toastId!==p.id)),setTimeout(()=>{E(p)},Pz)},[p,E,x,Nt]);Ae.useEffect(()=>{if(p.promise&&Xe==="loading"||p.duration===1/0||p.type==="loading")return;let ot,we=Ze;return S||w||B&&On?(()=>{if(vt.current<Fe.current){let be=new Date().getTime()-Fe.current;we=we-be}vt.current=new Date().getTime()})():we!==1/0&&(Fe.current=new Date().getTime(),ot=setTimeout(()=>{var be;(be=p.onAutoClose)==null||be.call(p,p),Pn()},we)),()=>clearTimeout(ot)},[S,w,F,p,Ze,Pn,p.promise,Xe,B,On]),Ae.useEffect(()=>{let ot=_e.current;if(ot){let we=ot.getBoundingClientRect().height;return ve(we),x(be=>[{toastId:p.id,height:we,position:p.position},...be]),()=>x(be=>be.filter(Ee=>Ee.toastId!==p.id))}},[x,p.id]),Ae.useEffect(()=>{p.delete&&Pn()},[Pn,p.delete]);function Ms(){return q!=null&&q.loading?Ae.createElement("div",{className:"sonner-loader","data-visible":Xe==="loading"},q.loading):X?Ae.createElement("div",{className:"sonner-loader","data-visible":Xe==="loading"},X):Ae.createElement(hz,{visible:Xe==="loading"})}return Ae.createElement("li",{"aria-live":p.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:_e,className:O(D,ke,T==null?void 0:T.toast,(e=p==null?void 0:p.classNames)==null?void 0:e.toast,T==null?void 0:T.default,T==null?void 0:T[Xe],(n=p==null?void 0:p.classNames)==null?void 0:n[Xe]),"data-sonner-toast":"","data-rich-colors":(r=p.richColors)!=null?r:C,"data-styled":!(p.jsx||p.unstyled||v),"data-mounted":z,"data-promise":!!p.promise,"data-removed":te,"data-visible":Ve,"data-y-position":js,"data-x-position":yt,"data-index":b,"data-front":Se,"data-swiping":Q,"data-dismissible":Et,"data-type":Xe,"data-invert":hs,"data-swipe-out":pe,"data-expanded":!!(S||F&&z),style:{"--index":b,"--toasts-before":b,"--z-index":N.length-b,"--offset":`${te?ae:Nt.current}px`,"--initial-height":F?"auto":`${he}px`,...R,...p.style},onPointerDown:ot=>{Kn||!Et||(ie.current=new Date,fe(Nt.current),ot.target.setPointerCapture(ot.pointerId),ot.target.tagName!=="BUTTON"&&(le(!0),Vn.current={x:ot.clientX,y:ot.clientY}))},onPointerUp:()=>{var ot,we,be,Ee;if(pe||!Et)return;Vn.current=null;let $e=Number(((ot=_e.current)==null?void 0:ot.style.getPropertyValue("--swipe-amount").replace("px",""))||0),st=new Date().getTime()-((we=ie.current)==null?void 0:we.getTime()),Yt=Math.abs($e)/st;if(Math.abs($e)>=Az||Yt>.11){fe(Nt.current),(be=p.onDismiss)==null||be.call(p,p),Pn(),J(!0);return}(Ee=_e.current)==null||Ee.style.setProperty("--swipe-amount","0px"),le(!1)},onPointerMove:ot=>{var we;if(!Vn.current||!Et)return;let be=ot.clientY-Vn.current.y,Ee=ot.clientX-Vn.current.x,$e=(js==="top"?Math.min:Math.max)(0,be),st=ot.pointerType==="touch"?10:2;Math.abs($e)>st?(we=_e.current)==null||we.style.setProperty("--swipe-amount",`${be}px`):Math.abs(Ee)>st&&(Vn.current=null)}},dt&&!p.jsx?Ae.createElement("button",{"aria-label":U,"data-disabled":Kn,"data-close-button":!0,onClick:Kn||!Et?()=>{}:()=>{var ot;Pn(),(ot=p.onDismiss)==null||ot.call(p,p)},className:O(T==null?void 0:T.closeButton,(a=p==null?void 0:p.classNames)==null?void 0:a.closeButton)},Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ae.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ae.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,p.jsx||Ae.isValidElement(p.title)?p.jsx||p.title:Ae.createElement(Ae.Fragment,null,Xe||p.icon||p.promise?Ae.createElement("div",{"data-icon":"",className:O(T==null?void 0:T.icon,(i=p==null?void 0:p.classNames)==null?void 0:i.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||Ms():null,p.type!=="loading"?p.icon||(q==null?void 0:q[Xe])||dz(Xe):null):null,Ae.createElement("div",{"data-content":"",className:O(T==null?void 0:T.content,(o=p==null?void 0:p.classNames)==null?void 0:o.content)},Ae.createElement("div",{"data-title":"",className:O(T==null?void 0:T.title,(c=p==null?void 0:p.classNames)==null?void 0:c.title)},p.title),p.description?Ae.createElement("div",{"data-description":"",className:O(W,Le,T==null?void 0:T.description,(d=p==null?void 0:p.classNames)==null?void 0:d.description)},p.description):null),Ae.isValidElement(p.cancel)?p.cancel:p.cancel&&zf(p.cancel)?Ae.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||H,onClick:ot=>{var we,be;zf(p.cancel)&&Et&&((be=(we=p.cancel).onClick)==null||be.call(we,ot),Pn())},className:O(T==null?void 0:T.cancelButton,(u=p==null?void 0:p.classNames)==null?void 0:u.cancelButton)},p.cancel.label):null,Ae.isValidElement(p.action)?p.action:p.action&&zf(p.action)?Ae.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||I,onClick:ot=>{var we,be;zf(p.action)&&(ot.defaultPrevented||((be=(we=p.action).onClick)==null||be.call(we,ot),Pn()))},className:O(T==null?void 0:T.actionButton,(m=p==null?void 0:p.classNames)==null?void 0:m.actionButton)},p.action.label):null))};function bS(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}var Mz=t=>{let{invert:e,position:n="bottom-right",hotkey:r=["altKey","KeyT"],expand:a,closeButton:i,className:o,offset:c,theme:d="light",richColors:u,duration:m,style:f,visibleToasts:p=Nz,toastOptions:v,dir:w=bS(),gap:x=Ez,loadingIcon:y,icons:j,containerAriaLabel:b="Notifications",pauseWhenPageIsHidden:N,cn:S=Dz}=t,[E,C]=Ae.useState([]),P=Ae.useMemo(()=>Array.from(new Set([n].concat(E.filter(B=>B.position).map(B=>B.position)))),[E,n]),[R,H]=Ae.useState([]),[I,D]=Ae.useState(!1),[W,V]=Ae.useState(!1),[G,Y]=Ae.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),X=Ae.useRef(null),F=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),T=Ae.useRef(null),q=Ae.useRef(!1),U=Ae.useCallback(B=>{var O;(O=E.find(z=>z.id===B.id))!=null&&O.delete||cr.dismiss(B.id),C(z=>z.filter(({id:$})=>$!==B.id))},[E]);return Ae.useEffect(()=>cr.subscribe(B=>{if(B.dismiss){C(O=>O.map(z=>z.id===B.id?{...z,delete:!0}:z));return}setTimeout(()=>{FA.flushSync(()=>{C(O=>{let z=O.findIndex($=>$.id===B.id);return z!==-1?[...O.slice(0,z),{...O[z],...B},...O.slice(z+1)]:[B,...O]})})})}),[]),Ae.useEffect(()=>{if(d!=="system"){Y(d);return}d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Y("dark"):Y("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:B})=>{Y(B?"dark":"light")})},[d]),Ae.useEffect(()=>{E.length<=1&&D(!1)},[E]),Ae.useEffect(()=>{let B=O=>{var z,$;r.every(te=>O[te]||O.code===te)&&(D(!0),(z=X.current)==null||z.focus()),O.code==="Escape"&&(document.activeElement===X.current||($=X.current)!=null&&$.contains(document.activeElement))&&D(!1)};return document.addEventListener("keydown",B),()=>document.removeEventListener("keydown",B)},[r]),Ae.useEffect(()=>{if(X.current)return()=>{T.current&&(T.current.focus({preventScroll:!0}),T.current=null,q.current=!1)}},[X.current]),E.length?Ae.createElement("section",{"aria-label":`${b} ${F}`,tabIndex:-1},P.map((B,O)=>{var z;let[$,te]=B.split("-");return Ae.createElement("ol",{key:B,dir:w==="auto"?bS():w,tabIndex:-1,ref:X,className:o,"data-sonner-toaster":!0,"data-theme":G,"data-y-position":$,"data-x-position":te,style:{"--front-toast-height":`${((z=R[0])==null?void 0:z.height)||0}px`,"--offset":typeof c=="number"?`${c}px`:c||Sz,"--width":`${Cz}px`,"--gap":`${x}px`,...f},onBlur:ee=>{q.current&&!ee.currentTarget.contains(ee.relatedTarget)&&(q.current=!1,T.current&&(T.current.focus({preventScroll:!0}),T.current=null))},onFocus:ee=>{ee.target instanceof HTMLElement&&ee.target.dataset.dismissible==="false"||q.current||(q.current=!0,T.current=ee.relatedTarget)},onMouseEnter:()=>D(!0),onMouseMove:()=>D(!0),onMouseLeave:()=>{W||D(!1)},onPointerDown:ee=>{ee.target instanceof HTMLElement&&ee.target.dataset.dismissible==="false"||V(!0)},onPointerUp:()=>V(!1)},E.filter(ee=>!ee.position&&O===0||ee.position===B).map((ee,Q)=>{var le,pe;return Ae.createElement(Tz,{key:ee.id,icons:j,index:Q,toast:ee,defaultRichColors:u,duration:(le=v==null?void 0:v.duration)!=null?le:m,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:e,visibleToasts:p,closeButton:(pe=v==null?void 0:v.closeButton)!=null?pe:i,interacting:W,position:B,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,removeToast:U,toasts:E.filter(J=>J.position==ee.position),heights:R.filter(J=>J.position==ee.position),setHeights:H,expandByDefault:a,gap:x,loadingIcon:y,expanded:I,pauseWhenPageIsHidden:N,cn:S})}))})):null};const Rz=({...t})=>{const{actualTheme:e}=oj();return s.jsx(Mz,{theme:e,className:"toaster group",position:"top-center",offset:80,toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var Iz=IE.useId||(()=>{}),Oz=0;function pr(t){const[e,n]=g.useState(Iz());return qn(()=>{t||n(r=>r??String(Oz++))},[t]),t||(e?`radix-${e}`:"")}const Lz=["top","right","bottom","left"],Do=Math.min,ur=Math.max,m0=Math.round,$f=Math.floor,To=t=>({x:t,y:t}),Fz={left:"right",right:"left",bottom:"top",top:"bottom"},Bz={start:"end",end:"start"};function G_(t,e,n){return ur(t,Do(e,n))}function Ai(t,e){return typeof t=="function"?t(e):t}function Pi(t){return t.split("-")[0]}function Yd(t){return t.split("-")[1]}function lj(t){return t==="x"?"y":"x"}function cj(t){return t==="y"?"height":"width"}function Mo(t){return["top","bottom"].includes(Pi(t))?"y":"x"}function dj(t){return lj(Mo(t))}function zz(t,e,n){n===void 0&&(n=!1);const r=Yd(t),a=dj(t),i=cj(a);let o=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=f0(o)),[o,f0(o)]}function $z(t){const e=f0(t);return[Q_(t),e,Q_(e)]}function Q_(t){return t.replace(/start|end/g,e=>Bz[e])}function Uz(t,e,n){const r=["left","right"],a=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?a:r:e?r:a;case"left":case"right":return e?i:o;default:return[]}}function qz(t,e,n,r){const a=Yd(t);let i=Uz(Pi(t),n==="start",r);return a&&(i=i.map(o=>o+"-"+a),e&&(i=i.concat(i.map(Q_)))),i}function f0(t){return t.replace(/left|right|bottom|top/g,e=>Fz[e])}function Hz(t){return{top:0,right:0,bottom:0,left:0,...t}}function AP(t){return typeof t!="number"?Hz(t):{top:t,right:t,bottom:t,left:t}}function p0(t){const{x:e,y:n,width:r,height:a}=t;return{width:r,height:a,top:n,left:e,right:e+r,bottom:n+a,x:e,y:n}}function jS(t,e,n){let{reference:r,floating:a}=t;const i=Mo(e),o=dj(e),c=cj(o),d=Pi(e),u=i==="y",m=r.x+r.width/2-a.width/2,f=r.y+r.height/2-a.height/2,p=r[c]/2-a[c]/2;let v;switch(d){case"top":v={x:m,y:r.y-a.height};break;case"bottom":v={x:m,y:r.y+r.height};break;case"right":v={x:r.x+r.width,y:f};break;case"left":v={x:r.x-a.width,y:f};break;default:v={x:r.x,y:r.y}}switch(Yd(e)){case"start":v[o]-=p*(n&&u?-1:1);break;case"end":v[o]+=p*(n&&u?-1:1);break}return v}const Wz=async(t,e,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:i=[],platform:o}=n,c=i.filter(Boolean),d=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:a}),{x:m,y:f}=jS(u,r,d),p=r,v={},w=0;for(let x=0;x<c.length;x++){const{name:y,fn:j}=c[x],{x:b,y:N,data:S,reset:E}=await j({x:m,y:f,initialPlacement:r,placement:p,strategy:a,middlewareData:v,rects:u,platform:o,elements:{reference:t,floating:e}});m=b??m,f=N??f,v={...v,[y]:{...v[y],...S}},E&&w<=50&&(w++,typeof E=="object"&&(E.placement&&(p=E.placement),E.rects&&(u=E.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:a}):E.rects),{x:m,y:f}=jS(u,p,d)),x=-1)}return{x:m,y:f,placement:p,strategy:a,middlewareData:v}};async function Uh(t,e){var n;e===void 0&&(e={});const{x:r,y:a,platform:i,rects:o,elements:c,strategy:d}=t,{boundary:u="clippingAncestors",rootBoundary:m="viewport",elementContext:f="floating",altBoundary:p=!1,padding:v=0}=Ai(e,t),w=AP(v),y=c[p?f==="floating"?"reference":"floating":f],j=p0(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(y)))==null||n?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(c.floating)),boundary:u,rootBoundary:m,strategy:d})),b=f==="floating"?{x:r,y:a,width:o.floating.width,height:o.floating.height}:o.reference,N=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c.floating)),S=await(i.isElement==null?void 0:i.isElement(N))?await(i.getScale==null?void 0:i.getScale(N))||{x:1,y:1}:{x:1,y:1},E=p0(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:b,offsetParent:N,strategy:d}):b);return{top:(j.top-E.top+w.top)/S.y,bottom:(E.bottom-j.bottom+w.bottom)/S.y,left:(j.left-E.left+w.left)/S.x,right:(E.right-j.right+w.right)/S.x}}const Vz=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:a,rects:i,platform:o,elements:c,middlewareData:d}=e,{element:u,padding:m=0}=Ai(t,e)||{};if(u==null)return{};const f=AP(m),p={x:n,y:r},v=dj(a),w=cj(v),x=await o.getDimensions(u),y=v==="y",j=y?"top":"left",b=y?"bottom":"right",N=y?"clientHeight":"clientWidth",S=i.reference[w]+i.reference[v]-p[v]-i.floating[w],E=p[v]-i.reference[v],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let P=C?C[N]:0;(!P||!await(o.isElement==null?void 0:o.isElement(C)))&&(P=c.floating[N]||i.floating[w]);const R=S/2-E/2,H=P/2-x[w]/2-1,I=Do(f[j],H),D=Do(f[b],H),W=I,V=P-x[w]-D,G=P/2-x[w]/2+R,Y=G_(W,G,V),X=!d.arrow&&Yd(a)!=null&&G!==Y&&i.reference[w]/2-(G<W?I:D)-x[w]/2<0,F=X?G<W?G-W:G-V:0;return{[v]:p[v]+F,data:{[v]:Y,centerOffset:G-Y-F,...X&&{alignmentOffset:F}},reset:X}}}),Kz=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:a,middlewareData:i,rects:o,initialPlacement:c,platform:d,elements:u}=e,{mainAxis:m=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:x=!0,...y}=Ai(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const j=Pi(a),b=Mo(c),N=Pi(c)===c,S=await(d.isRTL==null?void 0:d.isRTL(u.floating)),E=p||(N||!x?[f0(c)]:$z(c)),C=w!=="none";!p&&C&&E.push(...qz(c,x,w,S));const P=[c,...E],R=await Uh(e,y),H=[];let I=((r=i.flip)==null?void 0:r.overflows)||[];if(m&&H.push(R[j]),f){const G=zz(a,o,S);H.push(R[G[0]],R[G[1]])}if(I=[...I,{placement:a,overflows:H}],!H.every(G=>G<=0)){var D,W;const G=(((D=i.flip)==null?void 0:D.index)||0)+1,Y=P[G];if(Y)return{data:{index:G,overflows:I},reset:{placement:Y}};let X=(W=I.filter(F=>F.overflows[0]<=0).sort((F,T)=>F.overflows[1]-T.overflows[1])[0])==null?void 0:W.placement;if(!X)switch(v){case"bestFit":{var V;const F=(V=I.filter(T=>{if(C){const q=Mo(T.placement);return q===b||q==="y"}return!0}).map(T=>[T.placement,T.overflows.filter(q=>q>0).reduce((q,U)=>q+U,0)]).sort((T,q)=>T[1]-q[1])[0])==null?void 0:V[0];F&&(X=F);break}case"initialPlacement":X=c;break}if(a!==X)return{reset:{placement:X}}}return{}}}};function NS(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function SS(t){return Lz.some(e=>t[e]>=0)}const Zz=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...a}=Ai(t,e);switch(r){case"referenceHidden":{const i=await Uh(e,{...a,elementContext:"reference"}),o=NS(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:SS(o)}}}case"escaped":{const i=await Uh(e,{...a,altBoundary:!0}),o=NS(i,n.floating);return{data:{escapedOffsets:o,escaped:SS(o)}}}default:return{}}}}};async function Gz(t,e){const{placement:n,platform:r,elements:a}=t,i=await(r.isRTL==null?void 0:r.isRTL(a.floating)),o=Pi(n),c=Yd(n),d=Mo(n)==="y",u=["left","top"].includes(o)?-1:1,m=i&&d?-1:1,f=Ai(e,t);let{mainAxis:p,crossAxis:v,alignmentAxis:w}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return c&&typeof w=="number"&&(v=c==="end"?w*-1:w),d?{x:v*m,y:p*u}:{x:p*u,y:v*m}}const Qz=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:a,y:i,placement:o,middlewareData:c}=e,d=await Gz(e,t);return o===((n=c.offset)==null?void 0:n.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:a+d.x,y:i+d.y,data:{...d,placement:o}}}}},Yz=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:a}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:c={fn:y=>{let{x:j,y:b}=y;return{x:j,y:b}}},...d}=Ai(t,e),u={x:n,y:r},m=await Uh(e,d),f=Mo(Pi(a)),p=lj(f);let v=u[p],w=u[f];if(i){const y=p==="y"?"top":"left",j=p==="y"?"bottom":"right",b=v+m[y],N=v-m[j];v=G_(b,v,N)}if(o){const y=f==="y"?"top":"left",j=f==="y"?"bottom":"right",b=w+m[y],N=w-m[j];w=G_(b,w,N)}const x=c.fn({...e,[p]:v,[f]:w});return{...x,data:{x:x.x-n,y:x.y-r,enabled:{[p]:i,[f]:o}}}}}},Xz=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:a,rects:i,middlewareData:o}=e,{offset:c=0,mainAxis:d=!0,crossAxis:u=!0}=Ai(t,e),m={x:n,y:r},f=Mo(a),p=lj(f);let v=m[p],w=m[f];const x=Ai(c,e),y=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(d){const N=p==="y"?"height":"width",S=i.reference[p]-i.floating[N]+y.mainAxis,E=i.reference[p]+i.reference[N]-y.mainAxis;v<S?v=S:v>E&&(v=E)}if(u){var j,b;const N=p==="y"?"width":"height",S=["top","left"].includes(Pi(a)),E=i.reference[f]-i.floating[N]+(S&&((j=o.offset)==null?void 0:j[f])||0)+(S?0:y.crossAxis),C=i.reference[f]+i.reference[N]+(S?0:((b=o.offset)==null?void 0:b[f])||0)-(S?y.crossAxis:0);w<E?w=E:w>C&&(w=C)}return{[p]:v,[f]:w}}}},Jz=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:a,rects:i,platform:o,elements:c}=e,{apply:d=()=>{},...u}=Ai(t,e),m=await Uh(e,u),f=Pi(a),p=Yd(a),v=Mo(a)==="y",{width:w,height:x}=i.floating;let y,j;f==="top"||f==="bottom"?(y=f,j=p===(await(o.isRTL==null?void 0:o.isRTL(c.floating))?"start":"end")?"left":"right"):(j=f,y=p==="end"?"top":"bottom");const b=x-m.top-m.bottom,N=w-m.left-m.right,S=Do(x-m[y],b),E=Do(w-m[j],N),C=!e.middlewareData.shift;let P=S,R=E;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(R=N),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(P=b),C&&!p){const I=ur(m.left,0),D=ur(m.right,0),W=ur(m.top,0),V=ur(m.bottom,0);v?R=w-2*(I!==0||D!==0?I+D:ur(m.left,m.right)):P=x-2*(W!==0||V!==0?W+V:ur(m.top,m.bottom))}await d({...e,availableWidth:R,availableHeight:P});const H=await o.getDimensions(c.floating);return w!==H.width||x!==H.height?{reset:{rects:!0}}:{}}}};function bg(){return typeof window<"u"}function Xd(t){return PP(t)?(t.nodeName||"").toLowerCase():"#document"}function gr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function ei(t){var e;return(e=(PP(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function PP(t){return bg()?t instanceof Node||t instanceof gr(t).Node:!1}function xa(t){return bg()?t instanceof Element||t instanceof gr(t).Element:!1}function Ya(t){return bg()?t instanceof HTMLElement||t instanceof gr(t).HTMLElement:!1}function kS(t){return!bg()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof gr(t).ShadowRoot}function Dm(t){const{overflow:e,overflowX:n,overflowY:r,display:a}=va(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(a)}function e$(t){return["table","td","th"].includes(Xd(t))}function jg(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function uj(t){const e=hj(),n=xa(t)?va(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function t$(t){let e=Ro(t);for(;Ya(e)&&!Rd(e);){if(uj(e))return e;if(jg(e))return null;e=Ro(e)}return null}function hj(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Rd(t){return["html","body","#document"].includes(Xd(t))}function va(t){return gr(t).getComputedStyle(t)}function Ng(t){return xa(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Ro(t){if(Xd(t)==="html")return t;const e=t.assignedSlot||t.parentNode||kS(t)&&t.host||ei(t);return kS(e)?e.host:e}function DP(t){const e=Ro(t);return Rd(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ya(e)&&Dm(e)?e:DP(e)}function qh(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const a=DP(t),i=a===((r=t.ownerDocument)==null?void 0:r.body),o=gr(a);if(i){const c=Y_(o);return e.concat(o,o.visualViewport||[],Dm(a)?a:[],c&&n?qh(c):[])}return e.concat(a,qh(a,[],n))}function Y_(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function TP(t){const e=va(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const a=Ya(t),i=a?t.offsetWidth:n,o=a?t.offsetHeight:r,c=m0(n)!==i||m0(r)!==o;return c&&(n=i,r=o),{width:n,height:r,$:c}}function mj(t){return xa(t)?t:t.contextElement}function ld(t){const e=mj(t);if(!Ya(e))return To(1);const n=e.getBoundingClientRect(),{width:r,height:a,$:i}=TP(e);let o=(i?m0(n.width):n.width)/r,c=(i?m0(n.height):n.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!c||!Number.isFinite(c))&&(c=1),{x:o,y:c}}const n$=To(0);function MP(t){const e=gr(t);return!hj()||!e.visualViewport?n$:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function s$(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==gr(t)?!1:e}function $l(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const a=t.getBoundingClientRect(),i=mj(t);let o=To(1);e&&(r?xa(r)&&(o=ld(r)):o=ld(t));const c=s$(i,n,r)?MP(i):To(0);let d=(a.left+c.x)/o.x,u=(a.top+c.y)/o.y,m=a.width/o.x,f=a.height/o.y;if(i){const p=gr(i),v=r&&xa(r)?gr(r):r;let w=p,x=Y_(w);for(;x&&r&&v!==w;){const y=ld(x),j=x.getBoundingClientRect(),b=va(x),N=j.left+(x.clientLeft+parseFloat(b.paddingLeft))*y.x,S=j.top+(x.clientTop+parseFloat(b.paddingTop))*y.y;d*=y.x,u*=y.y,m*=y.x,f*=y.y,d+=N,u+=S,w=gr(x),x=Y_(w)}}return p0({width:m,height:f,x:d,y:u})}function r$(t){let{elements:e,rect:n,offsetParent:r,strategy:a}=t;const i=a==="fixed",o=ei(r),c=e?jg(e.floating):!1;if(r===o||c&&i)return n;let d={scrollLeft:0,scrollTop:0},u=To(1);const m=To(0),f=Ya(r);if((f||!f&&!i)&&((Xd(r)!=="body"||Dm(o))&&(d=Ng(r)),Ya(r))){const p=$l(r);u=ld(r),m.x=p.x+r.clientLeft,m.y=p.y+r.clientTop}return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-d.scrollLeft*u.x+m.x,y:n.y*u.y-d.scrollTop*u.y+m.y}}function a$(t){return Array.from(t.getClientRects())}function X_(t,e){const n=Ng(t).scrollLeft;return e?e.left+n:$l(ei(t)).left+n}function i$(t){const e=ei(t),n=Ng(t),r=t.ownerDocument.body,a=ur(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=ur(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+X_(t);const c=-n.scrollTop;return va(r).direction==="rtl"&&(o+=ur(e.clientWidth,r.clientWidth)-a),{width:a,height:i,x:o,y:c}}function o$(t,e){const n=gr(t),r=ei(t),a=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,c=0,d=0;if(a){i=a.width,o=a.height;const u=hj();(!u||u&&e==="fixed")&&(c=a.offsetLeft,d=a.offsetTop)}return{width:i,height:o,x:c,y:d}}function l$(t,e){const n=$l(t,!0,e==="fixed"),r=n.top+t.clientTop,a=n.left+t.clientLeft,i=Ya(t)?ld(t):To(1),o=t.clientWidth*i.x,c=t.clientHeight*i.y,d=a*i.x,u=r*i.y;return{width:o,height:c,x:d,y:u}}function CS(t,e,n){let r;if(e==="viewport")r=o$(t,n);else if(e==="document")r=i$(ei(t));else if(xa(e))r=l$(e,n);else{const a=MP(t);r={...e,x:e.x-a.x,y:e.y-a.y}}return p0(r)}function RP(t,e){const n=Ro(t);return n===e||!xa(n)||Rd(n)?!1:va(n).position==="fixed"||RP(n,e)}function c$(t,e){const n=e.get(t);if(n)return n;let r=qh(t,[],!1).filter(c=>xa(c)&&Xd(c)!=="body"),a=null;const i=va(t).position==="fixed";let o=i?Ro(t):t;for(;xa(o)&&!Rd(o);){const c=va(o),d=uj(o);!d&&c.position==="fixed"&&(a=null),(i?!d&&!a:!d&&c.position==="static"&&!!a&&["absolute","fixed"].includes(a.position)||Dm(o)&&!d&&RP(t,o))?r=r.filter(m=>m!==o):a=c,o=Ro(o)}return e.set(t,r),r}function d$(t){let{element:e,boundary:n,rootBoundary:r,strategy:a}=t;const o=[...n==="clippingAncestors"?jg(e)?[]:c$(e,this._c):[].concat(n),r],c=o[0],d=o.reduce((u,m)=>{const f=CS(e,m,a);return u.top=ur(f.top,u.top),u.right=Do(f.right,u.right),u.bottom=Do(f.bottom,u.bottom),u.left=ur(f.left,u.left),u},CS(e,c,a));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function u$(t){const{width:e,height:n}=TP(t);return{width:e,height:n}}function h$(t,e,n){const r=Ya(e),a=ei(e),i=n==="fixed",o=$l(t,!0,i,e);let c={scrollLeft:0,scrollTop:0};const d=To(0);if(r||!r&&!i)if((Xd(e)!=="body"||Dm(a))&&(c=Ng(e)),r){const v=$l(e,!0,i,e);d.x=v.x+e.clientLeft,d.y=v.y+e.clientTop}else a&&(d.x=X_(a));let u=0,m=0;if(a&&!r&&!i){const v=a.getBoundingClientRect();m=v.top+c.scrollTop,u=v.left+c.scrollLeft-X_(a,v)}const f=o.left+c.scrollLeft-d.x-u,p=o.top+c.scrollTop-d.y-m;return{x:f,y:p,width:o.width,height:o.height}}function yv(t){return va(t).position==="static"}function ES(t,e){if(!Ya(t)||va(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return ei(t)===n&&(n=n.ownerDocument.body),n}function IP(t,e){const n=gr(t);if(jg(t))return n;if(!Ya(t)){let a=Ro(t);for(;a&&!Rd(a);){if(xa(a)&&!yv(a))return a;a=Ro(a)}return n}let r=ES(t,e);for(;r&&e$(r)&&yv(r);)r=ES(r,e);return r&&Rd(r)&&yv(r)&&!uj(r)?n:r||t$(t)||n}const m$=async function(t){const e=this.getOffsetParent||IP,n=this.getDimensions,r=await n(t.floating);return{reference:h$(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function f$(t){return va(t).direction==="rtl"}const p$={convertOffsetParentRelativeRectToViewportRelativeRect:r$,getDocumentElement:ei,getClippingRect:d$,getOffsetParent:IP,getElementRects:m$,getClientRects:a$,getDimensions:u$,getScale:ld,isElement:xa,isRTL:f$};function g$(t,e){let n=null,r;const a=ei(t);function i(){var c;clearTimeout(r),(c=n)==null||c.disconnect(),n=null}function o(c,d){c===void 0&&(c=!1),d===void 0&&(d=1),i();const{left:u,top:m,width:f,height:p}=t.getBoundingClientRect();if(c||e(),!f||!p)return;const v=$f(m),w=$f(a.clientWidth-(u+f)),x=$f(a.clientHeight-(m+p)),y=$f(u),b={rootMargin:-v+"px "+-w+"px "+-x+"px "+-y+"px",threshold:ur(0,Do(1,d))||1};let N=!0;function S(E){const C=E[0].intersectionRatio;if(C!==d){if(!N)return o();C?o(!1,C):r=setTimeout(()=>{o(!1,1e-7)},1e3)}N=!1}try{n=new IntersectionObserver(S,{...b,root:a.ownerDocument})}catch{n=new IntersectionObserver(S,b)}n.observe(t)}return o(!0),i}function x$(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:d=!1}=r,u=mj(t),m=a||i?[...u?qh(u):[],...qh(e)]:[];m.forEach(j=>{a&&j.addEventListener("scroll",n,{passive:!0}),i&&j.addEventListener("resize",n)});const f=u&&c?g$(u,n):null;let p=-1,v=null;o&&(v=new ResizeObserver(j=>{let[b]=j;b&&b.target===u&&v&&(v.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var N;(N=v)==null||N.observe(e)})),n()}),u&&!d&&v.observe(u),v.observe(e));let w,x=d?$l(t):null;d&&y();function y(){const j=$l(t);x&&(j.x!==x.x||j.y!==x.y||j.width!==x.width||j.height!==x.height)&&n(),x=j,w=requestAnimationFrame(y)}return n(),()=>{var j;m.forEach(b=>{a&&b.removeEventListener("scroll",n),i&&b.removeEventListener("resize",n)}),f==null||f(),(j=v)==null||j.disconnect(),v=null,d&&cancelAnimationFrame(w)}}const v$=Qz,y$=Yz,_$=Kz,w$=Jz,b$=Zz,AS=Vz,j$=Xz,N$=(t,e,n)=>{const r=new Map,a={platform:p$,...n},i={...a.platform,_c:r};return Wz(t,e,{...a,platform:i})};var Sp=typeof document<"u"?g.useLayoutEffect:g.useEffect;function g0(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,a;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!g0(t[r],e[r]))return!1;return!0}if(a=Object.keys(t),n=a.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,a[r]))return!1;for(r=n;r--!==0;){const i=a[r];if(!(i==="_owner"&&t.$$typeof)&&!g0(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function OP(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function PS(t,e){const n=OP(t);return Math.round(e*n)/n}function _v(t){const e=g.useRef(t);return Sp(()=>{e.current=t}),e}function S$(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:i,floating:o}={},transform:c=!0,whileElementsMounted:d,open:u}=t,[m,f]=g.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[p,v]=g.useState(r);g0(p,r)||v(r);const[w,x]=g.useState(null),[y,j]=g.useState(null),b=g.useCallback(T=>{T!==C.current&&(C.current=T,x(T))},[]),N=g.useCallback(T=>{T!==P.current&&(P.current=T,j(T))},[]),S=i||w,E=o||y,C=g.useRef(null),P=g.useRef(null),R=g.useRef(m),H=d!=null,I=_v(d),D=_v(a),W=_v(u),V=g.useCallback(()=>{if(!C.current||!P.current)return;const T={placement:e,strategy:n,middleware:p};D.current&&(T.platform=D.current),N$(C.current,P.current,T).then(q=>{const U={...q,isPositioned:W.current!==!1};G.current&&!g0(R.current,U)&&(R.current=U,Xl.flushSync(()=>{f(U)}))})},[p,e,n,D,W]);Sp(()=>{u===!1&&R.current.isPositioned&&(R.current.isPositioned=!1,f(T=>({...T,isPositioned:!1})))},[u]);const G=g.useRef(!1);Sp(()=>(G.current=!0,()=>{G.current=!1}),[]),Sp(()=>{if(S&&(C.current=S),E&&(P.current=E),S&&E){if(I.current)return I.current(S,E,V);V()}},[S,E,V,I,H]);const Y=g.useMemo(()=>({reference:C,floating:P,setReference:b,setFloating:N}),[b,N]),X=g.useMemo(()=>({reference:S,floating:E}),[S,E]),F=g.useMemo(()=>{const T={position:n,left:0,top:0};if(!X.floating)return T;const q=PS(X.floating,m.x),U=PS(X.floating,m.y);return c?{...T,transform:"translate("+q+"px, "+U+"px)",...OP(X.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:q,top:U}},[n,c,X.floating,m.x,m.y]);return g.useMemo(()=>({...m,update:V,refs:Y,elements:X,floatingStyles:F}),[m,V,Y,X,F])}const k$=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:a}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?AS({element:r.current,padding:a}).fn(n):{}:r?AS({element:r,padding:a}).fn(n):{}}}},C$=(t,e)=>({...v$(t),options:[t,e]}),E$=(t,e)=>({...y$(t),options:[t,e]}),A$=(t,e)=>({...j$(t),options:[t,e]}),P$=(t,e)=>({..._$(t),options:[t,e]}),D$=(t,e)=>({...w$(t),options:[t,e]}),T$=(t,e)=>({...b$(t),options:[t,e]}),M$=(t,e)=>({...k$(t),options:[t,e]});var R$="Arrow",LP=g.forwardRef((t,e)=>{const{children:n,width:r=10,height:a=5,...i}=t;return s.jsx(tt.svg,{...i,ref:e,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:s.jsx("polygon",{points:"0,0 30,0 15,10"})})});LP.displayName=R$;var I$=LP;function O$(t,e=[]){let n=[];function r(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:v,...w}=f,x=(p==null?void 0:p[t][d])||c,y=g.useMemo(()=>w,Object.values(w));return s.jsx(x.Provider,{value:y,children:v})}function m(f,p){const v=(p==null?void 0:p[t][d])||c,w=g.useContext(v);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[r,L$(a,...e)]}function L$(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=r.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function FP(t){const[e,n]=g.useState(void 0);return qn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,c;if("borderBoxSize"in i){const d=i.borderBoxSize,u=Array.isArray(d)?d[0]:d;o=u.inlineSize,c=u.blockSize}else o=t.offsetWidth,c=t.offsetHeight;n({width:o,height:c})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var fj="Popper",[BP,Ho]=O$(fj),[F$,zP]=BP(fj),$P=t=>{const{__scopePopper:e,children:n}=t,[r,a]=g.useState(null);return s.jsx(F$,{scope:e,anchor:r,onAnchorChange:a,children:n})};$P.displayName=fj;var UP="PopperAnchor",qP=g.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...a}=t,i=zP(UP,n),o=g.useRef(null),c=Rt(e,o);return g.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:s.jsx(tt.div,{...a,ref:c})});qP.displayName=UP;var pj="PopperContent",[B$,z$]=BP(pj),HP=g.forwardRef((t,e)=>{var Q,le,pe,J,ae,fe;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:c=0,avoidCollisions:d=!0,collisionBoundary:u=[],collisionPadding:m=0,sticky:f="partial",hideWhenDetached:p=!1,updatePositionStrategy:v="optimized",onPlaced:w,...x}=t,y=zP(pj,n),[j,b]=g.useState(null),N=Rt(e,he=>b(he)),[S,E]=g.useState(null),C=FP(S),P=(C==null?void 0:C.width)??0,R=(C==null?void 0:C.height)??0,H=r+(i!=="center"?"-"+i:""),I=typeof m=="number"?m:{top:0,right:0,bottom:0,left:0,...m},D=Array.isArray(u)?u:[u],W=D.length>0,V={padding:I,boundary:D.filter(U$),altBoundary:W},{refs:G,floatingStyles:Y,placement:X,isPositioned:F,middlewareData:T}=S$({strategy:"fixed",placement:H,whileElementsMounted:(...he)=>x$(...he,{animationFrame:v==="always"}),elements:{reference:y.anchor},middleware:[C$({mainAxis:a+R,alignmentAxis:o}),d&&E$({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?A$():void 0,...V}),d&&P$({...V}),D$({...V,apply:({elements:he,rects:ve,availableWidth:ie,availableHeight:_e})=>{const{width:Se,height:Ve}=ve.reference,Xe=he.floating.style;Xe.setProperty("--radix-popper-available-width",`${ie}px`),Xe.setProperty("--radix-popper-available-height",`${_e}px`),Xe.setProperty("--radix-popper-anchor-width",`${Se}px`),Xe.setProperty("--radix-popper-anchor-height",`${Ve}px`)}}),S&&M$({element:S,padding:c}),q$({arrowWidth:P,arrowHeight:R}),p&&T$({strategy:"referenceHidden",...V})]}),[q,U]=KP(X),B=_n(w);qn(()=>{F&&(B==null||B())},[F,B]);const O=(Q=T.arrow)==null?void 0:Q.x,z=(le=T.arrow)==null?void 0:le.y,$=((pe=T.arrow)==null?void 0:pe.centerOffset)!==0,[te,ee]=g.useState();return qn(()=>{j&&ee(window.getComputedStyle(j).zIndex)},[j]),s.jsx("div",{ref:G.setFloating,"data-radix-popper-content-wrapper":"",style:{...Y,transform:F?Y.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:te,"--radix-popper-transform-origin":[(J=T.transformOrigin)==null?void 0:J.x,(ae=T.transformOrigin)==null?void 0:ae.y].join(" "),...((fe=T.hide)==null?void 0:fe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:s.jsx(B$,{scope:n,placedSide:q,onArrowChange:E,arrowX:O,arrowY:z,shouldHideArrow:$,children:s.jsx(tt.div,{"data-side":q,"data-align":U,...x,ref:N,style:{...x.style,animation:F?void 0:"none"}})})})});HP.displayName=pj;var WP="PopperArrow",$$={top:"bottom",right:"left",bottom:"top",left:"right"},VP=g.forwardRef(function(e,n){const{__scopePopper:r,...a}=e,i=z$(WP,r),o=$$[i.placedSide];return s.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:s.jsx(I$,{...a,ref:n,style:{...a.style,display:"block"}})})});VP.displayName=WP;function U$(t){return t!==null}var q$=t=>({name:"transformOrigin",options:t,fn(e){var y,j,b;const{placement:n,rects:r,middlewareData:a}=e,o=((y=a.arrow)==null?void 0:y.centerOffset)!==0,c=o?0:t.arrowWidth,d=o?0:t.arrowHeight,[u,m]=KP(n),f={start:"0%",center:"50%",end:"100%"}[m],p=(((j=a.arrow)==null?void 0:j.x)??0)+c/2,v=(((b=a.arrow)==null?void 0:b.y)??0)+d/2;let w="",x="";return u==="bottom"?(w=o?f:`${p}px`,x=`${-d}px`):u==="top"?(w=o?f:`${p}px`,x=`${r.floating.height+d}px`):u==="right"?(w=`${-d}px`,x=o?f:`${v}px`):u==="left"&&(w=`${r.floating.width+d}px`,x=o?f:`${v}px`),{data:{x:w,y:x}}}});function KP(t){const[e,n="center"]=t.split("-");return[e,n]}var gj=$P,Tm=qP,Sg=HP,kg=VP,[Cg,iae]=kr("Tooltip",[Ho]),xj=Ho(),ZP="TooltipProvider",H$=700,DS="tooltip.open",[W$,GP]=Cg(ZP),QP=t=>{const{__scopeTooltip:e,delayDuration:n=H$,skipDelayDuration:r=300,disableHoverableContent:a=!1,children:i}=t,[o,c]=g.useState(!0),d=g.useRef(!1),u=g.useRef(0);return g.useEffect(()=>{const m=u.current;return()=>window.clearTimeout(m)},[]),s.jsx(W$,{scope:e,isOpenDelayed:o,delayDuration:n,onOpen:g.useCallback(()=>{window.clearTimeout(u.current),c(!1)},[]),onClose:g.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>c(!0),r)},[r]),isPointerInTransitRef:d,onPointerInTransitChange:g.useCallback(m=>{d.current=m},[]),disableHoverableContent:a,children:i})};QP.displayName=ZP;var YP="Tooltip",[oae,Eg]=Cg(YP),J_="TooltipTrigger",V$=g.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,a=Eg(J_,n),i=GP(J_,n),o=xj(n),c=g.useRef(null),d=Rt(e,c,a.onTriggerChange),u=g.useRef(!1),m=g.useRef(!1),f=g.useCallback(()=>u.current=!1,[]);return g.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),s.jsx(Tm,{asChild:!0,...o,children:s.jsx(tt.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...r,ref:d,onPointerMove:Oe(t.onPointerMove,p=>{p.pointerType!=="touch"&&!m.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),m.current=!0)}),onPointerLeave:Oe(t.onPointerLeave,()=>{a.onTriggerLeave(),m.current=!1}),onPointerDown:Oe(t.onPointerDown,()=>{u.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:Oe(t.onFocus,()=>{u.current||a.onOpen()}),onBlur:Oe(t.onBlur,a.onClose),onClick:Oe(t.onClick,a.onClose)})})});V$.displayName=J_;var K$="TooltipPortal",[lae,Z$]=Cg(K$,{forceMount:void 0}),Id="TooltipContent",XP=g.forwardRef((t,e)=>{const n=Z$(Id,t.__scopeTooltip),{forceMount:r=n.forceMount,side:a="top",...i}=t,o=Eg(Id,t.__scopeTooltip);return s.jsx(ts,{present:r||o.open,children:o.disableHoverableContent?s.jsx(JP,{side:a,...i,ref:e}):s.jsx(G$,{side:a,...i,ref:e})})}),G$=g.forwardRef((t,e)=>{const n=Eg(Id,t.__scopeTooltip),r=GP(Id,t.__scopeTooltip),a=g.useRef(null),i=Rt(e,a),[o,c]=g.useState(null),{trigger:d,onClose:u}=n,m=a.current,{onPointerInTransitChange:f}=r,p=g.useCallback(()=>{c(null),f(!1)},[f]),v=g.useCallback((w,x)=>{const y=w.currentTarget,j={x:w.clientX,y:w.clientY},b=J$(j,y.getBoundingClientRect()),N=e9(j,b),S=t9(x.getBoundingClientRect()),E=s9([...N,...S]);c(E),f(!0)},[f]);return g.useEffect(()=>()=>p(),[p]),g.useEffect(()=>{if(d&&m){const w=y=>v(y,m),x=y=>v(y,d);return d.addEventListener("pointerleave",w),m.addEventListener("pointerleave",x),()=>{d.removeEventListener("pointerleave",w),m.removeEventListener("pointerleave",x)}}},[d,m,v,p]),g.useEffect(()=>{if(o){const w=x=>{const y=x.target,j={x:x.clientX,y:x.clientY},b=(d==null?void 0:d.contains(y))||(m==null?void 0:m.contains(y)),N=!n9(j,o);b?p():N&&(p(),u())};return document.addEventListener("pointermove",w),()=>document.removeEventListener("pointermove",w)}},[d,m,o,u,p]),s.jsx(JP,{...t,ref:i})}),[Q$,Y$]=Cg(YP,{isInside:!1}),JP=g.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...c}=t,d=Eg(Id,n),u=xj(n),{onClose:m}=d;return g.useEffect(()=>(document.addEventListener(DS,m),()=>document.removeEventListener(DS,m)),[m]),g.useEffect(()=>{if(d.trigger){const f=p=>{const v=p.target;v!=null&&v.contains(d.trigger)&&m()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[d.trigger,m]),s.jsx(Jl,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:m,children:s.jsxs(Sg,{"data-state":d.stateAttribute,...u,...c,ref:e,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[s.jsx(zA,{children:r}),s.jsx(Q$,{scope:n,isInside:!0,children:s.jsx(DF,{id:d.contentId,role:"tooltip",children:a||r})})]})})});XP.displayName=Id;var eD="TooltipArrow",X$=g.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,a=xj(n);return Y$(eD,n).isInside?null:s.jsx(kg,{...a,...r,ref:e})});X$.displayName=eD;function J$(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),a=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(n,r,a,i)){case i:return"left";case a:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function e9(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function t9(t){const{top:e,right:n,bottom:r,left:a}=t;return[{x:a,y:e},{x:n,y:e},{x:n,y:r},{x:a,y:r}]}function n9(t,e){const{x:n,y:r}=t;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const c=e[i].x,d=e[i].y,u=e[o].x,m=e[o].y;d>r!=m>r&&n<(u-c)*(r-d)/(m-d)+c&&(a=!a)}return a}function s9(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),r9(e)}function r9(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const a=t[r];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))e.pop();else break}e.push(a)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const a=t[r];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))n.pop();else break}n.push(a)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var a9=QP,tD=XP;const i9=a9,o9=g.forwardRef(({className:t,sideOffset:e=4,...n},r)=>s.jsx(tD,{ref:r,sideOffset:e,className:Ie("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n}));o9.displayName=tD.displayName;var Jd=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Ul=typeof window>"u"||"Deno"in globalThis;function Dr(){}function l9(t,e){return typeof t=="function"?t(e):t}function ew(t){return typeof t=="number"&&t>=0&&t!==1/0}function nD(t,e){return Math.max(t+(e||0)-Date.now(),0)}function cd(t,e){return typeof t=="function"?t(e):t}function oa(t,e){return typeof t=="function"?t(e):t}function TS(t,e){const{type:n="all",exact:r,fetchStatus:a,predicate:i,queryKey:o,stale:c}=t;if(o){if(r){if(e.queryHash!==vj(o,e.options))return!1}else if(!Hh(e.queryKey,o))return!1}if(n!=="all"){const d=e.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof c=="boolean"&&e.isStale()!==c||a&&a!==e.state.fetchStatus||i&&!i(e))}function MS(t,e){const{exact:n,status:r,predicate:a,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(ql(e.options.mutationKey)!==ql(i))return!1}else if(!Hh(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||a&&!a(e))}function vj(t,e){return((e==null?void 0:e.queryKeyHashFn)||ql)(t)}function ql(t){return JSON.stringify(t,(e,n)=>tw(n)?Object.keys(n).sort().reduce((r,a)=>(r[a]=n[a],r),{}):n)}function Hh(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(n=>!Hh(t[n],e[n])):!1}function sD(t,e){if(t===e)return t;const n=RS(t)&&RS(e);if(n||tw(t)&&tw(e)){const r=n?t:Object.keys(t),a=r.length,i=n?e:Object.keys(e),o=i.length,c=n?[]:{};let d=0;for(let u=0;u<o;u++){const m=n?u:i[u];(!n&&r.includes(m)||n)&&t[m]===void 0&&e[m]===void 0?(c[m]=void 0,d++):(c[m]=sD(t[m],e[m]),c[m]===t[m]&&t[m]!==void 0&&d++)}return a===o&&d===a?t:c}return e}function x0(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function RS(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function tw(t){if(!IS(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!IS(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function IS(t){return Object.prototype.toString.call(t)==="[object Object]"}function c9(t){return new Promise(e=>{setTimeout(e,t)})}function nw(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?sD(t,e):e}function d9(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function u9(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var yj=Symbol();function rD(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===yj?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var _l,no,md,fE,h9=(fE=class extends Jd{constructor(){super();xt(this,_l);xt(this,no);xt(this,md);Qe(this,md,e=>{if(!Ul&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){ue(this,no)||this.setEventListener(ue(this,md))}onUnsubscribe(){var e;this.hasListeners()||((e=ue(this,no))==null||e.call(this),Qe(this,no,void 0))}setEventListener(e){var n;Qe(this,md,e),(n=ue(this,no))==null||n.call(this),Qe(this,no,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){ue(this,_l)!==e&&(Qe(this,_l,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof ue(this,_l)=="boolean"?ue(this,_l):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},_l=new WeakMap,no=new WeakMap,md=new WeakMap,fE),_j=new h9,fd,so,pd,pE,m9=(pE=class extends Jd{constructor(){super();xt(this,fd,!0);xt(this,so);xt(this,pd);Qe(this,pd,e=>{if(!Ul&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){ue(this,so)||this.setEventListener(ue(this,pd))}onUnsubscribe(){var e;this.hasListeners()||((e=ue(this,so))==null||e.call(this),Qe(this,so,void 0))}setEventListener(e){var n;Qe(this,pd,e),(n=ue(this,so))==null||n.call(this),Qe(this,so,e(this.setOnline.bind(this)))}setOnline(e){ue(this,fd)!==e&&(Qe(this,fd,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return ue(this,fd)}},fd=new WeakMap,so=new WeakMap,pd=new WeakMap,pE),v0=new m9;function sw(){let t,e;const n=new Promise((a,i)=>{t=a,e=i});n.status="pending",n.catch(()=>{});function r(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{r({status:"fulfilled",value:a}),t(a)},n.reject=a=>{r({status:"rejected",reason:a}),e(a)},n}function f9(t){return Math.min(1e3*2**t,3e4)}function aD(t){return(t??"online")==="online"?v0.isOnline():!0}var iD=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function wv(t){return t instanceof iD}function oD(t){let e=!1,n=0,r=!1,a;const i=sw(),o=x=>{var y;r||(p(new iD(x)),(y=t.abort)==null||y.call(t))},c=()=>{e=!0},d=()=>{e=!1},u=()=>_j.isFocused()&&(t.networkMode==="always"||v0.isOnline())&&t.canRun(),m=()=>aD(t.networkMode)&&t.canRun(),f=x=>{var y;r||(r=!0,(y=t.onSuccess)==null||y.call(t,x),a==null||a(),i.resolve(x))},p=x=>{var y;r||(r=!0,(y=t.onError)==null||y.call(t,x),a==null||a(),i.reject(x))},v=()=>new Promise(x=>{var y;a=j=>{(r||u())&&x(j)},(y=t.onPause)==null||y.call(t)}).then(()=>{var x;a=void 0,r||(x=t.onContinue)==null||x.call(t)}),w=()=>{if(r)return;let x;const y=n===0?t.initialPromise:void 0;try{x=y??t.fn()}catch(j){x=Promise.reject(j)}Promise.resolve(x).then(f).catch(j=>{var C;if(r)return;const b=t.retry??(Ul?0:3),N=t.retryDelay??f9,S=typeof N=="function"?N(n,j):N,E=b===!0||typeof b=="number"&&n<b||typeof b=="function"&&b(n,j);if(e||!E){p(j);return}n++,(C=t.onFail)==null||C.call(t,n,j),c9(S).then(()=>u()?void 0:v()).then(()=>{e?p(j):w()})})};return{promise:i,cancel:o,continue:()=>(a==null||a(),i),cancelRetry:c,continueRetry:d,canStart:m,start:()=>(m()?w():v().then(w),i)}}function p9(){let t=[],e=0,n=c=>{c()},r=c=>{c()},a=c=>setTimeout(c,0);const i=c=>{e?t.push(c):a(()=>{n(c)})},o=()=>{const c=t;t=[],c.length&&a(()=>{r(()=>{c.forEach(d=>{n(d)})})})};return{batch:c=>{let d;e++;try{d=c()}finally{e--,e||o()}return d},batchCalls:c=>(...d)=>{i(()=>{c(...d)})},schedule:i,setNotifyFunction:c=>{n=c},setBatchNotifyFunction:c=>{r=c},setScheduler:c=>{a=c}}}var Yn=p9(),wl,gE,lD=(gE=class{constructor(){xt(this,wl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ew(this.gcTime)&&Qe(this,wl,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Ul?1/0:5*60*1e3))}clearGcTimeout(){ue(this,wl)&&(clearTimeout(ue(this,wl)),Qe(this,wl,void 0))}},wl=new WeakMap,gE),gd,xd,Pr,Cs,xm,bl,sa,di,xE,g9=(xE=class extends lD{constructor(e){super();xt(this,sa);xt(this,gd);xt(this,xd);xt(this,Pr);xt(this,Cs);xt(this,xm);xt(this,bl);Qe(this,bl,!1),Qe(this,xm,e.defaultOptions),this.setOptions(e.options),this.observers=[],Qe(this,Pr,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Qe(this,gd,x9(this.options)),this.state=e.state??ue(this,gd),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=ue(this,Cs))==null?void 0:e.promise}setOptions(e){this.options={...ue(this,xm),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ue(this,Pr).remove(this)}setData(e,n){const r=nw(this.state.data,e,this.options);return Ft(this,sa,di).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){Ft(this,sa,di).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,a;const n=(r=ue(this,Cs))==null?void 0:r.promise;return(a=ue(this,Cs))==null||a.cancel(e),n?n.then(Dr).catch(Dr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ue(this,gd))}isActive(){return this.observers.some(e=>oa(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===yj||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!nD(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=ue(this,Cs))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=ue(this,Cs))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),ue(this,Pr).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(ue(this,Cs)&&(ue(this,bl)?ue(this,Cs).cancel({revert:!0}):ue(this,Cs).cancelRetry()),this.scheduleGc()),ue(this,Pr).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ft(this,sa,di).call(this,{type:"invalidate"})}fetch(e,n){var d,u,m;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(ue(this,Cs))return ue(this,Cs).continueRetry(),ue(this,Cs).promise}if(e&&this.setOptions(e),!this.options.queryFn){const f=this.observers.find(p=>p.options.queryFn);f&&this.setOptions(f.options)}const r=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(Qe(this,bl,!0),r.signal)})},i=()=>{const f=rD(this.options,n),p={queryKey:this.queryKey,meta:this.meta};return a(p),Qe(this,bl,!1),this.options.persister?this.options.persister(f,p,this):f(p)},o={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:i};a(o),(d=this.options.behavior)==null||d.onFetch(o,this),Qe(this,xd,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=o.fetchOptions)==null?void 0:u.meta))&&Ft(this,sa,di).call(this,{type:"fetch",meta:(m=o.fetchOptions)==null?void 0:m.meta});const c=f=>{var p,v,w,x;wv(f)&&f.silent||Ft(this,sa,di).call(this,{type:"error",error:f}),wv(f)||((v=(p=ue(this,Pr).config).onError)==null||v.call(p,f,this),(x=(w=ue(this,Pr).config).onSettled)==null||x.call(w,this.state.data,f,this)),this.scheduleGc()};return Qe(this,Cs,oD({initialPromise:n==null?void 0:n.initialPromise,fn:o.fetchFn,abort:r.abort.bind(r),onSuccess:f=>{var p,v,w,x;if(f===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(y){c(y);return}(v=(p=ue(this,Pr).config).onSuccess)==null||v.call(p,f,this),(x=(w=ue(this,Pr).config).onSettled)==null||x.call(w,f,this.state.error,this),this.scheduleGc()},onError:c,onFail:(f,p)=>{Ft(this,sa,di).call(this,{type:"failed",failureCount:f,error:p})},onPause:()=>{Ft(this,sa,di).call(this,{type:"pause"})},onContinue:()=>{Ft(this,sa,di).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0})),ue(this,Cs).start()}},gd=new WeakMap,xd=new WeakMap,Pr=new WeakMap,Cs=new WeakMap,xm=new WeakMap,bl=new WeakMap,sa=new WeakSet,di=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...cD(r.data,this.options),fetchMeta:e.meta??null};case"success":return{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=e.error;return wv(a)&&a.revert&&ue(this,xd)?{...ue(this,xd),fetchStatus:"idle"}:{...r,error:a,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),Yn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),ue(this,Pr).notify({query:this,type:"updated",action:e})})},xE);function cD(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:aD(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function x9(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Ta,vE,v9=(vE=class extends Jd{constructor(e={}){super();xt(this,Ta);this.config=e,Qe(this,Ta,new Map)}build(e,n,r){const a=n.queryKey,i=n.queryHash??vj(a,n);let o=this.get(i);return o||(o=new g9({cache:this,queryKey:a,queryHash:i,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(a)}),this.add(o)),o}add(e){ue(this,Ta).has(e.queryHash)||(ue(this,Ta).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=ue(this,Ta).get(e.queryHash);n&&(e.destroy(),n===e&&ue(this,Ta).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Yn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return ue(this,Ta).get(e)}getAll(){return[...ue(this,Ta).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>TS(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>TS(e,r)):n}notify(e){Yn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Yn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Yn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Ta=new WeakMap,vE),Ma,Os,jl,Ra,Hi,yE,y9=(yE=class extends lD{constructor(e){super();xt(this,Ra);xt(this,Ma);xt(this,Os);xt(this,jl);this.mutationId=e.mutationId,Qe(this,Os,e.mutationCache),Qe(this,Ma,[]),this.state=e.state||dD(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){ue(this,Ma).includes(e)||(ue(this,Ma).push(e),this.clearGcTimeout(),ue(this,Os).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Qe(this,Ma,ue(this,Ma).filter(n=>n!==e)),this.scheduleGc(),ue(this,Os).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){ue(this,Ma).length||(this.state.status==="pending"?this.scheduleGc():ue(this,Os).remove(this))}continue(){var e;return((e=ue(this,jl))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var a,i,o,c,d,u,m,f,p,v,w,x,y,j,b,N,S,E,C,P;Qe(this,jl,oD({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(R,H)=>{Ft(this,Ra,Hi).call(this,{type:"failed",failureCount:R,error:H})},onPause:()=>{Ft(this,Ra,Hi).call(this,{type:"pause"})},onContinue:()=>{Ft(this,Ra,Hi).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ue(this,Os).canRun(this)}));const n=this.state.status==="pending",r=!ue(this,jl).canStart();try{if(!n){Ft(this,Ra,Hi).call(this,{type:"pending",variables:e,isPaused:r}),await((i=(a=ue(this,Os).config).onMutate)==null?void 0:i.call(a,e,this));const H=await((c=(o=this.options).onMutate)==null?void 0:c.call(o,e));H!==this.state.context&&Ft(this,Ra,Hi).call(this,{type:"pending",context:H,variables:e,isPaused:r})}const R=await ue(this,jl).start();return await((u=(d=ue(this,Os).config).onSuccess)==null?void 0:u.call(d,R,e,this.state.context,this)),await((f=(m=this.options).onSuccess)==null?void 0:f.call(m,R,e,this.state.context)),await((v=(p=ue(this,Os).config).onSettled)==null?void 0:v.call(p,R,null,this.state.variables,this.state.context,this)),await((x=(w=this.options).onSettled)==null?void 0:x.call(w,R,null,e,this.state.context)),Ft(this,Ra,Hi).call(this,{type:"success",data:R}),R}catch(R){try{throw await((j=(y=ue(this,Os).config).onError)==null?void 0:j.call(y,R,e,this.state.context,this)),await((N=(b=this.options).onError)==null?void 0:N.call(b,R,e,this.state.context)),await((E=(S=ue(this,Os).config).onSettled)==null?void 0:E.call(S,void 0,R,this.state.variables,this.state.context,this)),await((P=(C=this.options).onSettled)==null?void 0:P.call(C,void 0,R,e,this.state.context)),R}finally{Ft(this,Ra,Hi).call(this,{type:"error",error:R})}}finally{ue(this,Os).runNext(this)}}},Ma=new WeakMap,Os=new WeakMap,jl=new WeakMap,Ra=new WeakSet,Hi=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Yn.batch(()=>{ue(this,Ma).forEach(r=>{r.onMutationUpdate(e)}),ue(this,Os).notify({mutation:this,type:"updated",action:e})})},yE);function dD(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var lr,vm,_E,_9=(_E=class extends Jd{constructor(e={}){super();xt(this,lr);xt(this,vm);this.config=e,Qe(this,lr,new Map),Qe(this,vm,Date.now())}build(e,n,r){const a=new y9({mutationCache:this,mutationId:++vf(this,vm)._,options:e.defaultMutationOptions(n),state:r});return this.add(a),a}add(e){const n=Uf(e),r=ue(this,lr).get(n)??[];r.push(e),ue(this,lr).set(n,r),this.notify({type:"added",mutation:e})}remove(e){var r;const n=Uf(e);if(ue(this,lr).has(n)){const a=(r=ue(this,lr).get(n))==null?void 0:r.filter(i=>i!==e);a&&(a.length===0?ue(this,lr).delete(n):ue(this,lr).set(n,a))}this.notify({type:"removed",mutation:e})}canRun(e){var r;const n=(r=ue(this,lr).get(Uf(e)))==null?void 0:r.find(a=>a.state.status==="pending");return!n||n===e}runNext(e){var r;const n=(r=ue(this,lr).get(Uf(e)))==null?void 0:r.find(a=>a!==e&&a.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){Yn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...ue(this,lr).values()].flat()}find(e){const n={exact:!0,...e};return this.getAll().find(r=>MS(n,r))}findAll(e={}){return this.getAll().filter(n=>MS(e,n))}notify(e){Yn.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Yn.batch(()=>Promise.all(e.map(n=>n.continue().catch(Dr))))}},lr=new WeakMap,vm=new WeakMap,_E);function Uf(t){var e;return((e=t.options.scope)==null?void 0:e.id)??String(t.mutationId)}function OS(t){return{onFetch:(e,n)=>{var m,f,p,v,w;const r=e.options,a=(p=(f=(m=e.fetchOptions)==null?void 0:m.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,i=((v=e.state.data)==null?void 0:v.pages)||[],o=((w=e.state.data)==null?void 0:w.pageParams)||[];let c={pages:[],pageParams:[]},d=0;const u=async()=>{let x=!1;const y=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(e.signal.aborted?x=!0:e.signal.addEventListener("abort",()=>{x=!0}),e.signal)})},j=rD(e.options,e.fetchOptions),b=async(N,S,E)=>{if(x)return Promise.reject();if(S==null&&N.pages.length)return Promise.resolve(N);const C={queryKey:e.queryKey,pageParam:S,direction:E?"backward":"forward",meta:e.options.meta};y(C);const P=await j(C),{maxPages:R}=e.options,H=E?u9:d9;return{pages:H(N.pages,P,R),pageParams:H(N.pageParams,S,R)}};if(a&&i.length){const N=a==="backward",S=N?w9:LS,E={pages:i,pageParams:o},C=S(r,E);c=await b(E,C,N)}else{const N=t??i.length;do{const S=d===0?o[0]??r.initialPageParam:LS(r,c);if(d>0&&S==null)break;c=await b(c,S),d++}while(d<N)}return c};e.options.persister?e.fetchFn=()=>{var x,y;return(y=(x=e.options).persister)==null?void 0:y.call(x,u,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=u}}}function LS(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function w9(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var Dn,ro,ao,vd,yd,io,_d,wd,wE,b9=(wE=class{constructor(t={}){xt(this,Dn);xt(this,ro);xt(this,ao);xt(this,vd);xt(this,yd);xt(this,io);xt(this,_d);xt(this,wd);Qe(this,Dn,t.queryCache||new v9),Qe(this,ro,t.mutationCache||new _9),Qe(this,ao,t.defaultOptions||{}),Qe(this,vd,new Map),Qe(this,yd,new Map),Qe(this,io,0)}mount(){vf(this,io)._++,ue(this,io)===1&&(Qe(this,_d,_j.subscribe(async t=>{t&&(await this.resumePausedMutations(),ue(this,Dn).onFocus())})),Qe(this,wd,v0.subscribe(async t=>{t&&(await this.resumePausedMutations(),ue(this,Dn).onOnline())})))}unmount(){var t,e;vf(this,io)._--,ue(this,io)===0&&((t=ue(this,_d))==null||t.call(this),Qe(this,_d,void 0),(e=ue(this,wd))==null||e.call(this),Qe(this,wd,void 0))}isFetching(t){return ue(this,Dn).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return ue(this,ro).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=ue(this,Dn).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);if(e===void 0)return this.fetchQuery(t);{const n=this.defaultQueryOptions(t),r=ue(this,Dn).build(this,n);return t.revalidateIfStale&&r.isStaleByTime(cd(n.staleTime,r))&&this.prefetchQuery(n),Promise.resolve(e)}}getQueriesData(t){return ue(this,Dn).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),a=ue(this,Dn).get(r.queryHash),i=a==null?void 0:a.state.data,o=l9(e,i);if(o!==void 0)return ue(this,Dn).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return Yn.batch(()=>ue(this,Dn).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=ue(this,Dn).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=ue(this,Dn);Yn.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=ue(this,Dn),r={type:"active",...t};return Yn.batch(()=>(n.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(r,e)))}cancelQueries(t={},e={}){const n={revert:!0,...e},r=Yn.batch(()=>ue(this,Dn).findAll(t).map(a=>a.cancel(n)));return Promise.all(r).then(Dr).catch(Dr)}invalidateQueries(t={},e={}){return Yn.batch(()=>{if(ue(this,Dn).findAll(t).forEach(r=>{r.invalidate()}),t.refetchType==="none")return Promise.resolve();const n={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(n,e)})}refetchQueries(t={},e){const n={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},r=Yn.batch(()=>ue(this,Dn).findAll(t).filter(a=>!a.isDisabled()).map(a=>{let i=a.fetch(void 0,n);return n.throwOnError||(i=i.catch(Dr)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Dr)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=ue(this,Dn).build(this,e);return n.isStaleByTime(cd(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Dr).catch(Dr)}fetchInfiniteQuery(t){return t.behavior=OS(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Dr).catch(Dr)}ensureInfiniteQueryData(t){return t.behavior=OS(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return v0.isOnline()?ue(this,ro).resumePausedMutations():Promise.resolve()}getQueryCache(){return ue(this,Dn)}getMutationCache(){return ue(this,ro)}getDefaultOptions(){return ue(this,ao)}setDefaultOptions(t){Qe(this,ao,t)}setQueryDefaults(t,e){ue(this,vd).set(ql(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...ue(this,vd).values()];let n={};return e.forEach(r=>{Hh(t,r.queryKey)&&(n={...n,...r.defaultOptions})}),n}setMutationDefaults(t,e){ue(this,yd).set(ql(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...ue(this,yd).values()];let n={};return e.forEach(r=>{Hh(t,r.mutationKey)&&(n={...n,...r.defaultOptions})}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...ue(this,ao).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=vj(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===yj&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...ue(this,ao).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){ue(this,Dn).clear(),ue(this,ro).clear()}},Dn=new WeakMap,ro=new WeakMap,ao=new WeakMap,vd=new WeakMap,yd=new WeakMap,io=new WeakMap,_d=new WeakMap,wd=new WeakMap,wE),Ks,Gt,ym,Ls,Nl,bd,oo,Ia,_m,jd,Nd,Sl,kl,lo,Sd,an,Fu,rw,aw,iw,ow,lw,cw,dw,uD,bE,j9=(bE=class extends Jd{constructor(e,n){super();xt(this,an);xt(this,Ks);xt(this,Gt);xt(this,ym);xt(this,Ls);xt(this,Nl);xt(this,bd);xt(this,oo);xt(this,Ia);xt(this,_m);xt(this,jd);xt(this,Nd);xt(this,Sl);xt(this,kl);xt(this,lo);xt(this,Sd,new Set);this.options=n,Qe(this,Ks,e),Qe(this,Ia,null),Qe(this,oo,sw()),this.options.experimental_prefetchInRender||ue(this,oo).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ue(this,Gt).addObserver(this),FS(ue(this,Gt),this.options)?Ft(this,an,Fu).call(this):this.updateResult(),Ft(this,an,ow).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return uw(ue(this,Gt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return uw(ue(this,Gt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ft(this,an,lw).call(this),Ft(this,an,cw).call(this),ue(this,Gt).removeObserver(this)}setOptions(e,n){const r=this.options,a=ue(this,Gt);if(this.options=ue(this,Ks).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof oa(this.options.enabled,ue(this,Gt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ft(this,an,dw).call(this),ue(this,Gt).setOptions(this.options),r._defaulted&&!x0(this.options,r)&&ue(this,Ks).getQueryCache().notify({type:"observerOptionsUpdated",query:ue(this,Gt),observer:this});const i=this.hasListeners();i&&BS(ue(this,Gt),a,this.options,r)&&Ft(this,an,Fu).call(this),this.updateResult(n),i&&(ue(this,Gt)!==a||oa(this.options.enabled,ue(this,Gt))!==oa(r.enabled,ue(this,Gt))||cd(this.options.staleTime,ue(this,Gt))!==cd(r.staleTime,ue(this,Gt)))&&Ft(this,an,rw).call(this);const o=Ft(this,an,aw).call(this);i&&(ue(this,Gt)!==a||oa(this.options.enabled,ue(this,Gt))!==oa(r.enabled,ue(this,Gt))||o!==ue(this,lo))&&Ft(this,an,iw).call(this,o)}getOptimisticResult(e){const n=ue(this,Ks).getQueryCache().build(ue(this,Ks),e),r=this.createResult(n,e);return S9(this,r)&&(Qe(this,Ls,r),Qe(this,bd,this.options),Qe(this,Nl,ue(this,Gt).state)),r}getCurrentResult(){return ue(this,Ls)}trackResult(e,n){const r={};return Object.keys(e).forEach(a=>{Object.defineProperty(r,a,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(a),n==null||n(a),e[a])})}),r}trackProp(e){ue(this,Sd).add(e)}getCurrentQuery(){return ue(this,Gt)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=ue(this,Ks).defaultQueryOptions(e),r=ue(this,Ks).getQueryCache().build(ue(this,Ks),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(e){return Ft(this,an,Fu).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),ue(this,Ls)))}createResult(e,n){var R;const r=ue(this,Gt),a=this.options,i=ue(this,Ls),o=ue(this,Nl),c=ue(this,bd),u=e!==r?e.state:ue(this,ym),{state:m}=e;let f={...m},p=!1,v;if(n._optimisticResults){const H=this.hasListeners(),I=!H&&FS(e,n),D=H&&BS(e,r,n,a);(I||D)&&(f={...f,...cD(m.data,e.options)}),n._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:w,errorUpdatedAt:x,status:y}=f;if(n.select&&f.data!==void 0)if(i&&f.data===(o==null?void 0:o.data)&&n.select===ue(this,_m))v=ue(this,jd);else try{Qe(this,_m,n.select),v=n.select(f.data),v=nw(i==null?void 0:i.data,v,n),Qe(this,jd,v),Qe(this,Ia,null)}catch(H){Qe(this,Ia,H)}else v=f.data;if(n.placeholderData!==void 0&&v===void 0&&y==="pending"){let H;if(i!=null&&i.isPlaceholderData&&n.placeholderData===(c==null?void 0:c.placeholderData))H=i.data;else if(H=typeof n.placeholderData=="function"?n.placeholderData((R=ue(this,Nd))==null?void 0:R.state.data,ue(this,Nd)):n.placeholderData,n.select&&H!==void 0)try{H=n.select(H),Qe(this,Ia,null)}catch(I){Qe(this,Ia,I)}H!==void 0&&(y="success",v=nw(i==null?void 0:i.data,H,n),p=!0)}ue(this,Ia)&&(w=ue(this,Ia),v=ue(this,jd),x=Date.now(),y="error");const j=f.fetchStatus==="fetching",b=y==="pending",N=y==="error",S=b&&j,E=v!==void 0,P={status:y,fetchStatus:f.fetchStatus,isPending:b,isSuccess:y==="success",isError:N,isInitialLoading:S,isLoading:S,data:v,dataUpdatedAt:f.dataUpdatedAt,error:w,errorUpdatedAt:x,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>u.dataUpdateCount||f.errorUpdateCount>u.errorUpdateCount,isFetching:j,isRefetching:j&&!b,isLoadingError:N&&!E,isPaused:f.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:N&&E,isStale:wj(e,n),refetch:this.refetch,promise:ue(this,oo)};if(this.options.experimental_prefetchInRender){const H=W=>{P.status==="error"?W.reject(P.error):P.data!==void 0&&W.resolve(P.data)},I=()=>{const W=Qe(this,oo,P.promise=sw());H(W)},D=ue(this,oo);switch(D.status){case"pending":e.queryHash===r.queryHash&&H(D);break;case"fulfilled":(P.status==="error"||P.data!==D.value)&&I();break;case"rejected":(P.status!=="error"||P.error!==D.reason)&&I();break}}return P}updateResult(e){const n=ue(this,Ls),r=this.createResult(ue(this,Gt),this.options);if(Qe(this,Nl,ue(this,Gt).state),Qe(this,bd,this.options),ue(this,Nl).data!==void 0&&Qe(this,Nd,ue(this,Gt)),x0(r,n))return;Qe(this,Ls,r);const a={},i=()=>{if(!n)return!0;const{notifyOnChangeProps:o}=this.options,c=typeof o=="function"?o():o;if(c==="all"||!c&&!ue(this,Sd).size)return!0;const d=new Set(c??ue(this,Sd));return this.options.throwOnError&&d.add("error"),Object.keys(ue(this,Ls)).some(u=>{const m=u;return ue(this,Ls)[m]!==n[m]&&d.has(m)})};(e==null?void 0:e.listeners)!==!1&&i()&&(a.listeners=!0),Ft(this,an,uD).call(this,{...a,...e})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ft(this,an,ow).call(this)}},Ks=new WeakMap,Gt=new WeakMap,ym=new WeakMap,Ls=new WeakMap,Nl=new WeakMap,bd=new WeakMap,oo=new WeakMap,Ia=new WeakMap,_m=new WeakMap,jd=new WeakMap,Nd=new WeakMap,Sl=new WeakMap,kl=new WeakMap,lo=new WeakMap,Sd=new WeakMap,an=new WeakSet,Fu=function(e){Ft(this,an,dw).call(this);let n=ue(this,Gt).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(Dr)),n},rw=function(){Ft(this,an,lw).call(this);const e=cd(this.options.staleTime,ue(this,Gt));if(Ul||ue(this,Ls).isStale||!ew(e))return;const r=nD(ue(this,Ls).dataUpdatedAt,e)+1;Qe(this,Sl,setTimeout(()=>{ue(this,Ls).isStale||this.updateResult()},r))},aw=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ue(this,Gt)):this.options.refetchInterval)??!1},iw=function(e){Ft(this,an,cw).call(this),Qe(this,lo,e),!(Ul||oa(this.options.enabled,ue(this,Gt))===!1||!ew(ue(this,lo))||ue(this,lo)===0)&&Qe(this,kl,setInterval(()=>{(this.options.refetchIntervalInBackground||_j.isFocused())&&Ft(this,an,Fu).call(this)},ue(this,lo)))},ow=function(){Ft(this,an,rw).call(this),Ft(this,an,iw).call(this,Ft(this,an,aw).call(this))},lw=function(){ue(this,Sl)&&(clearTimeout(ue(this,Sl)),Qe(this,Sl,void 0))},cw=function(){ue(this,kl)&&(clearInterval(ue(this,kl)),Qe(this,kl,void 0))},dw=function(){const e=ue(this,Ks).getQueryCache().build(ue(this,Ks),this.options);if(e===ue(this,Gt))return;const n=ue(this,Gt);Qe(this,Gt,e),Qe(this,ym,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},uD=function(e){Yn.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(ue(this,Ls))}),ue(this,Ks).getQueryCache().notify({query:ue(this,Gt),type:"observerResultsUpdated"})})},bE);function N9(t,e){return oa(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function FS(t,e){return N9(t,e)||t.state.data!==void 0&&uw(t,e,e.refetchOnMount)}function uw(t,e,n){if(oa(e.enabled,t)!==!1){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&wj(t,e)}return!1}function BS(t,e,n,r){return(t!==e||oa(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&wj(t,n)}function wj(t,e){return oa(e.enabled,t)!==!1&&t.isStaleByTime(cd(e.staleTime,t))}function S9(t,e){return!x0(t.getCurrentResult(),e)}var co,uo,Zs,xi,bi,kp,hw,jE,k9=(jE=class extends Jd{constructor(n,r){super();xt(this,bi);xt(this,co);xt(this,uo);xt(this,Zs);xt(this,xi);Qe(this,co,n),this.setOptions(r),this.bindMethods(),Ft(this,bi,kp).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var a;const r=this.options;this.options=ue(this,co).defaultMutationOptions(n),x0(this.options,r)||ue(this,co).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ue(this,Zs),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&ql(r.mutationKey)!==ql(this.options.mutationKey)?this.reset():((a=ue(this,Zs))==null?void 0:a.state.status)==="pending"&&ue(this,Zs).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=ue(this,Zs))==null||n.removeObserver(this)}onMutationUpdate(n){Ft(this,bi,kp).call(this),Ft(this,bi,hw).call(this,n)}getCurrentResult(){return ue(this,uo)}reset(){var n;(n=ue(this,Zs))==null||n.removeObserver(this),Qe(this,Zs,void 0),Ft(this,bi,kp).call(this),Ft(this,bi,hw).call(this)}mutate(n,r){var a;return Qe(this,xi,r),(a=ue(this,Zs))==null||a.removeObserver(this),Qe(this,Zs,ue(this,co).getMutationCache().build(ue(this,co),this.options)),ue(this,Zs).addObserver(this),ue(this,Zs).execute(n)}},co=new WeakMap,uo=new WeakMap,Zs=new WeakMap,xi=new WeakMap,bi=new WeakSet,kp=function(){var r;const n=((r=ue(this,Zs))==null?void 0:r.state)??dD();Qe(this,uo,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},hw=function(n){Yn.batch(()=>{var r,a,i,o,c,d,u,m;if(ue(this,xi)&&this.hasListeners()){const f=ue(this,uo).variables,p=ue(this,uo).context;(n==null?void 0:n.type)==="success"?((a=(r=ue(this,xi)).onSuccess)==null||a.call(r,n.data,f,p),(o=(i=ue(this,xi)).onSettled)==null||o.call(i,n.data,null,f,p)):(n==null?void 0:n.type)==="error"&&((d=(c=ue(this,xi)).onError)==null||d.call(c,n.error,f,p),(m=(u=ue(this,xi)).onSettled)==null||m.call(u,void 0,n.error,f,p))}this.listeners.forEach(f=>{f(ue(this,uo))})})},jE),hD=g.createContext(void 0),ds=t=>{const e=g.useContext(hD);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},C9=({client:t,children:e})=>(g.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),s.jsx(hD.Provider,{value:t,children:e})),mD=g.createContext(!1),E9=()=>g.useContext(mD);mD.Provider;function A9(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var P9=g.createContext(A9()),D9=()=>g.useContext(P9);function fD(t,e){return typeof t=="function"?t(...e):!!t}function pD(){}var T9=(t,e)=>{(t.suspense||t.throwOnError)&&(e.isReset()||(t.retryOnMount=!1))},M9=t=>{g.useEffect(()=>{t.clearReset()},[t])},R9=({result:t,errorResetBoundary:e,throwOnError:n,query:r})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&fD(n,[t.error,r]),I9=t=>{t.suspense&&(t.staleTime===void 0&&(t.staleTime=1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},O9=(t,e)=>t.isLoading&&t.isFetching&&!e,L9=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,zS=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function F9(t,e,n){var m,f,p,v,w;const r=ds(),a=E9(),i=D9(),o=r.defaultQueryOptions(t);(f=(m=r.getDefaultOptions().queries)==null?void 0:m._experimental_beforeQuery)==null||f.call(m,o),o._optimisticResults=a?"isRestoring":"optimistic",I9(o),T9(o,i),M9(i);const c=!r.getQueryCache().get(o.queryHash),[d]=g.useState(()=>new e(r,o)),u=d.getOptimisticResult(o);if(g.useSyncExternalStore(g.useCallback(x=>{const y=a?()=>{}:d.subscribe(Yn.batchCalls(x));return d.updateResult(),y},[d,a]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),g.useEffect(()=>{d.setOptions(o,{listeners:!1})},[o,d]),L9(o,u))throw zS(o,d,i);if(R9({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:r.getQueryCache().get(o.queryHash)}))throw u.error;if((v=(p=r.getDefaultOptions().queries)==null?void 0:p._experimental_afterQuery)==null||v.call(p,o,u),o.experimental_prefetchInRender&&!Ul&&O9(u,a)){const x=c?zS(o,d,i):(w=r.getQueryCache().get(o.queryHash))==null?void 0:w.promise;x==null||x.catch(pD).finally(()=>{d.updateResult()})}return o.notifyOnChangeProps?u:d.trackResult(u)}function _r(t,e){return F9(t,j9)}function sr(t,e){const n=ds(),[r]=g.useState(()=>new k9(n,t));g.useEffect(()=>{r.setOptions(t)},[r,t]);const a=g.useSyncExternalStore(g.useCallback(o=>r.subscribe(Yn.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=g.useCallback((o,c)=>{r.mutate(o,c).catch(pD)},[r]);if(a.error&&fD(r.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wh(){return Wh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Wh.apply(this,arguments)}var fo;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(fo||(fo={}));const $S="popstate";function B9(t){t===void 0&&(t={});function e(r,a){let{pathname:i,search:o,hash:c}=r.location;return mw("",{pathname:i,search:o,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:y0(a)}return $9(e,n,null,t)}function Un(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function gD(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function z9(){return Math.random().toString(36).substr(2,8)}function US(t,e){return{usr:t.state,key:t.key,idx:e}}function mw(t,e,n,r){return n===void 0&&(n=null),Wh({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?eu(e):e,{state:n,key:e&&e.key||r||z9()})}function y0(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function eu(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function $9(t,e,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:i=!1}=r,o=a.history,c=fo.Pop,d=null,u=m();u==null&&(u=0,o.replaceState(Wh({},o.state,{idx:u}),""));function m(){return(o.state||{idx:null}).idx}function f(){c=fo.Pop;let y=m(),j=y==null?null:y-u;u=y,d&&d({action:c,location:x.location,delta:j})}function p(y,j){c=fo.Push;let b=mw(x.location,y,j);u=m()+1;let N=US(b,u),S=x.createHref(b);try{o.pushState(N,"",S)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;a.location.assign(S)}i&&d&&d({action:c,location:x.location,delta:1})}function v(y,j){c=fo.Replace;let b=mw(x.location,y,j);u=m();let N=US(b,u),S=x.createHref(b);o.replaceState(N,"",S),i&&d&&d({action:c,location:x.location,delta:0})}function w(y){let j=a.location.origin!=="null"?a.location.origin:a.location.href,b=typeof y=="string"?y:y0(y);return b=b.replace(/ $/,"%20"),Un(j,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,j)}let x={get action(){return c},get location(){return t(a,o)},listen(y){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener($S,f),d=y,()=>{a.removeEventListener($S,f),d=null}},createHref(y){return e(a,y)},createURL:w,encodeLocation(y){let j=w(y);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:p,replace:v,go(y){return o.go(y)}};return x}var qS;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(qS||(qS={}));function U9(t,e,n){return n===void 0&&(n="/"),q9(t,e,n,!1)}function q9(t,e,n,r){let a=typeof e=="string"?eu(e):e,i=bj(a.pathname||"/",n);if(i==null)return null;let o=xD(t);H9(o);let c=null;for(let d=0;c==null&&d<o.length;++d){let u=t7(i);c=J9(o[d],u,r)}return c}function xD(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(i,o,c)=>{let d={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};d.relativePath.startsWith("/")&&(Un(d.relativePath.startsWith(r),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(r.length));let u=ko([r,d.relativePath]),m=n.concat(d);i.children&&i.children.length>0&&(Un(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),xD(i.children,e,m,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:Y9(u,i.index),routesMeta:m})};return t.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))a(i,o);else for(let d of vD(i.path))a(i,o,d)}),e}function vD(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let o=vD(r.join("/")),c=[];return c.push(...o.map(d=>d===""?i:[i,d].join("/"))),a&&c.push(...o),c.map(d=>t.startsWith("/")&&d===""?"/":d)}function H9(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:X9(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const W9=/^:[\w-]+$/,V9=3,K9=2,Z9=1,G9=10,Q9=-2,HS=t=>t==="*";function Y9(t,e){let n=t.split("/"),r=n.length;return n.some(HS)&&(r+=Q9),e&&(r+=K9),n.filter(a=>!HS(a)).reduce((a,i)=>a+(W9.test(i)?V9:i===""?Z9:G9),r)}function X9(t,e){return t.length===e.length&&t.slice(0,-1).every((r,a)=>r===e[a])?t[t.length-1]-e[e.length-1]:0}function J9(t,e,n){let{routesMeta:r}=t,a={},i="/",o=[];for(let c=0;c<r.length;++c){let d=r[c],u=c===r.length-1,m=i==="/"?e:e.slice(i.length)||"/",f=WS({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},m),p=d.route;if(!f&&u&&n&&!r[r.length-1].route.index&&(f=WS({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:ko([i,f.pathname]),pathnameBase:a7(ko([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=ko([i,f.pathnameBase]))}return o}function WS(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=e7(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:r.reduce((u,m,f)=>{let{paramName:p,isOptional:v}=m;if(p==="*"){let x=c[f]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const w=c[f];return v&&!w?u[p]=void 0:u[p]=(w||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function e7(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),gD(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,d)=>(r.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function t7(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return gD(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function bj(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function n7(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?eu(t):t;return{pathname:n?n.startsWith("/")?n:s7(n,e):e,search:i7(r),hash:o7(a)}}function s7(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function bv(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function r7(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function yD(t,e){let n=r7(t);return e?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function _D(t,e,n,r){r===void 0&&(r=!1);let a;typeof t=="string"?a=eu(t):(a=Wh({},t),Un(!a.pathname||!a.pathname.includes("?"),bv("?","pathname","search",a)),Un(!a.pathname||!a.pathname.includes("#"),bv("#","pathname","hash",a)),Un(!a.search||!a.search.includes("#"),bv("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,c;if(o==null)c=n;else{let f=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;a.pathname=p.join("/")}c=f>=0?e[f]:"/"}let d=n7(a,c),u=o&&o!=="/"&&o.endsWith("/"),m=(i||o===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(u||m)&&(d.pathname+="/"),d}const ko=t=>t.join("/").replace(/\/\/+/g,"/"),a7=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),i7=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,o7=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function l7(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const wD=["post","put","patch","delete"];new Set(wD);const c7=["get",...wD];new Set(c7);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Vh(){return Vh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Vh.apply(this,arguments)}const jj=g.createContext(null),d7=g.createContext(null),tc=g.createContext(null),Ag=g.createContext(null),nc=g.createContext({outlet:null,matches:[],isDataRoute:!1}),bD=g.createContext(null);function u7(t,e){let{relative:n}=e===void 0?{}:e;Mm()||Un(!1);let{basename:r,navigator:a}=g.useContext(tc),{hash:i,pathname:o,search:c}=ND(t,{relative:n}),d=o;return r!=="/"&&(d=o==="/"?r:ko([r,o])),a.createHref({pathname:d,search:c,hash:i})}function Mm(){return g.useContext(Ag)!=null}function sc(){return Mm()||Un(!1),g.useContext(Ag).location}function jD(t){g.useContext(tc).static||g.useLayoutEffect(t)}function wa(){let{isDataRoute:t}=g.useContext(nc);return t?N7():h7()}function h7(){Mm()||Un(!1);let t=g.useContext(jj),{basename:e,future:n,navigator:r}=g.useContext(tc),{matches:a}=g.useContext(nc),{pathname:i}=sc(),o=JSON.stringify(yD(a,n.v7_relativeSplatPath)),c=g.useRef(!1);return jD(()=>{c.current=!0}),g.useCallback(function(u,m){if(m===void 0&&(m={}),!c.current)return;if(typeof u=="number"){r.go(u);return}let f=_D(u,JSON.parse(o),i,m.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:ko([e,f.pathname])),(m.replace?r.replace:r.push)(f,m.state,m)},[e,r,o,i,t])}function ND(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=g.useContext(tc),{matches:a}=g.useContext(nc),{pathname:i}=sc(),o=JSON.stringify(yD(a,r.v7_relativeSplatPath));return g.useMemo(()=>_D(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function m7(t,e){return f7(t,e)}function f7(t,e,n,r){Mm()||Un(!1);let{navigator:a}=g.useContext(tc),{matches:i}=g.useContext(nc),o=i[i.length-1],c=o?o.params:{};o&&o.pathname;let d=o?o.pathnameBase:"/";o&&o.route;let u=sc(),m;if(e){var f;let y=typeof e=="string"?eu(e):e;d==="/"||(f=y.pathname)!=null&&f.startsWith(d)||Un(!1),m=y}else m=u;let p=m.pathname||"/",v=p;if(d!=="/"){let y=d.replace(/^\//,"").split("/");v="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let w=U9(t,{pathname:v}),x=y7(w&&w.map(y=>Object.assign({},y,{params:Object.assign({},c,y.params),pathname:ko([d,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?d:ko([d,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,r);return e&&x?g.createElement(Ag.Provider,{value:{location:Vh({pathname:"/",search:"",hash:"",state:null,key:"default"},m),navigationType:fo.Pop}},x):x}function p7(){let t=j7(),e=l7(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),n?g.createElement("pre",{style:a},n):null,null)}const g7=g.createElement(p7,null);class x7 extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?g.createElement(nc.Provider,{value:this.props.routeContext},g.createElement(bD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function v7(t){let{routeContext:e,match:n,children:r}=t,a=g.useContext(jj);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),g.createElement(nc.Provider,{value:e},r)}function y7(t,e,n,r){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,c=(a=n)==null?void 0:a.errors;if(c!=null){let m=o.findIndex(f=>f.route.id&&(c==null?void 0:c[f.route.id])!==void 0);m>=0||Un(!1),o=o.slice(0,Math.min(o.length,m+1))}let d=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let m=0;m<o.length;m++){let f=o[m];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=m),f.route.id){let{loaderData:p,errors:v}=n,w=f.route.loader&&p[f.route.id]===void 0&&(!v||v[f.route.id]===void 0);if(f.route.lazy||w){d=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((m,f,p)=>{let v,w=!1,x=null,y=null;n&&(v=c&&f.route.id?c[f.route.id]:void 0,x=f.route.errorElement||g7,d&&(u<0&&p===0?(w=!0,y=null):u===p&&(w=!0,y=f.route.hydrateFallbackElement||null)));let j=e.concat(o.slice(0,p+1)),b=()=>{let N;return v?N=x:w?N=y:f.route.Component?N=g.createElement(f.route.Component,null):f.route.element?N=f.route.element:N=m,g.createElement(v7,{match:f,routeContext:{outlet:m,matches:j,isDataRoute:n!=null},children:N})};return n&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?g.createElement(x7,{location:n.location,revalidation:n.revalidation,component:x,error:v,children:b(),routeContext:{outlet:null,matches:j,isDataRoute:!0}}):b()},null)}var SD=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(SD||{}),_0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(_0||{});function _7(t){let e=g.useContext(jj);return e||Un(!1),e}function w7(t){let e=g.useContext(d7);return e||Un(!1),e}function b7(t){let e=g.useContext(nc);return e||Un(!1),e}function kD(t){let e=b7(),n=e.matches[e.matches.length-1];return n.route.id||Un(!1),n.route.id}function j7(){var t;let e=g.useContext(bD),n=w7(_0.UseRouteError),r=kD(_0.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function N7(){let{router:t}=_7(SD.UseNavigateStable),e=kD(_0.UseNavigateStable),n=g.useRef(!1);return jD(()=>{n.current=!0}),g.useCallback(function(a,i){i===void 0&&(i={}),n.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,Vh({fromRouteId:e},i)))},[t,e])}function Vs(t){Un(!1)}function S7(t){let{basename:e="/",children:n=null,location:r,navigationType:a=fo.Pop,navigator:i,static:o=!1,future:c}=t;Mm()&&Un(!1);let d=e.replace(/^\/*/,"/"),u=g.useMemo(()=>({basename:d,navigator:i,static:o,future:Vh({v7_relativeSplatPath:!1},c)}),[d,c,i,o]);typeof r=="string"&&(r=eu(r));let{pathname:m="/",search:f="",hash:p="",state:v=null,key:w="default"}=r,x=g.useMemo(()=>{let y=bj(m,d);return y==null?null:{location:{pathname:y,search:f,hash:p,state:v,key:w},navigationType:a}},[d,m,f,p,v,w,a]);return x==null?null:g.createElement(tc.Provider,{value:u},g.createElement(Ag.Provider,{children:n,value:x}))}function k7(t){let{children:e,location:n}=t;return m7(fw(e),n)}new Promise(()=>{});function fw(t,e){e===void 0&&(e=[]);let n=[];return g.Children.forEach(t,(r,a)=>{if(!g.isValidElement(r))return;let i=[...e,a];if(r.type===g.Fragment){n.push.apply(n,fw(r.props.children,i));return}r.type!==Vs&&Un(!1),!r.props.index||!r.props.children||Un(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=fw(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pw(){return pw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pw.apply(this,arguments)}function C7(t,e){if(t==null)return{};var n={},r=Object.keys(t),a,i;for(i=0;i<r.length;i++)a=r[i],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function E7(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function A7(t,e){return t.button===0&&(!e||e==="_self")&&!E7(t)}function gw(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(a=>[n,a]):[[n,r]])},[]))}function P7(t,e){let n=gw(t);return e&&e.forEach((r,a)=>{n.has(a)||e.getAll(a).forEach(i=>{n.append(a,i)})}),n}const D7=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],T7="6";try{window.__reactRouterVersion=T7}catch{}const M7="startTransition",VS=IE[M7];function R7(t){let{basename:e,children:n,future:r,window:a}=t,i=g.useRef();i.current==null&&(i.current=B9({window:a,v5Compat:!0}));let o=i.current,[c,d]=g.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},m=g.useCallback(f=>{u&&VS?VS(()=>d(f)):d(f)},[d,u]);return g.useLayoutEffect(()=>o.listen(m),[o,m]),g.createElement(S7,{basename:e,children:n,location:c.location,navigationType:c.action,navigator:o,future:r})}const I7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",O7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gi=g.forwardRef(function(e,n){let{onClick:r,relative:a,reloadDocument:i,replace:o,state:c,target:d,to:u,preventScrollReset:m,viewTransition:f}=e,p=C7(e,D7),{basename:v}=g.useContext(tc),w,x=!1;if(typeof u=="string"&&O7.test(u)&&(w=u,I7))try{let N=new URL(window.location.href),S=u.startsWith("//")?new URL(N.protocol+u):new URL(u),E=bj(S.pathname,v);S.origin===N.origin&&E!=null?u=E+S.search+S.hash:x=!0}catch{}let y=u7(u,{relative:a}),j=L7(u,{replace:o,state:c,target:d,preventScrollReset:m,relative:a,viewTransition:f});function b(N){r&&r(N),N.defaultPrevented||j(N)}return g.createElement("a",pw({},p,{href:w||y,onClick:x||i?r:b,ref:n,target:d}))});var KS;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(KS||(KS={}));var ZS;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(ZS||(ZS={}));function L7(t,e){let{target:n,replace:r,state:a,preventScrollReset:i,relative:o,viewTransition:c}=e===void 0?{}:e,d=wa(),u=sc(),m=ND(t,{relative:o});return g.useCallback(f=>{if(A7(f,n)){f.preventDefault();let p=r!==void 0?r:y0(u)===y0(m);d(t,{replace:p,state:a,preventScrollReset:i,relative:o,viewTransition:c})}},[u,d,m,r,a,n,t,i,o,c])}function Nj(t){let e=g.useRef(gw(t)),n=g.useRef(!1),r=sc(),a=g.useMemo(()=>P7(r.search,n.current?null:e.current),[r.search]),i=wa(),o=g.useCallback((c,d)=>{const u=gw(typeof c=="function"?c(a):c);n.current=!0,i("?"+u,d)},[i,a]);return[a,o]}const F7="modulepreload",B7=function(t,e){return new URL(t,e).href},GS={},tu=function(e,n,r){let a=Promise.resolve();if(n&&n.length>0){const o=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));a=Promise.allSettled(n.map(u=>{if(u=B7(u,r),u in GS)return;GS[u]=!0;const m=u.endsWith(".css"),f=m?'[rel="stylesheet"]':"";if(!!r)for(let w=o.length-1;w>=0;w--){const x=o[w];if(x.href===u&&(!m||x.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${f}`))return;const v=document.createElement("link");if(v.rel=m?"stylesheet":F7,m||(v.as="script"),v.crossOrigin="",v.href=u,d&&v.setAttribute("nonce",d),document.head.appendChild(v),m)return new Promise((w,x)=>{v.addEventListener("load",w),v.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return a.then(o=>{for(const c of o||[])c.status==="rejected"&&i(c.reason);return e().catch(i)})},z7=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>tu(async()=>{const{default:r}=await Promise.resolve().then(()=>nu);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Sj extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class $7 extends Sj{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class QS extends Sj{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class YS extends Sj{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var xw;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(xw||(xw={}));var U7=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};class q7{constructor(e,{headers:n={},customFetch:r,region:a=xw.Any}={}){this.url=e,this.headers=n,this.region=a,this.fetch=z7(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return U7(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:o}=n;let c={},{region:d}=n;d||(d=this.region);const u=new URL(`${this.url}/${e}`);d&&d!=="any"&&(c["x-region"]=d,u.searchParams.set("forceFunctionRegion",d));let m;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",m=o):typeof o=="string"?(c["Content-Type"]="text/plain",m=o):typeof FormData<"u"&&o instanceof FormData?m=o:(c["Content-Type"]="application/json",m=JSON.stringify(o)));const f=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:m}).catch(x=>{throw new $7(x)}),p=f.headers.get("x-relay-error");if(p&&p==="true")throw new QS(f);if(!f.ok)throw new YS(f);let v=((r=f.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),w;return v==="application/json"?w=yield f.json():v==="application/octet-stream"?w=yield f.blob():v==="text/event-stream"?w=f:v==="multipart/form-data"?w=yield f.formData():w=yield f.text(),{data:w,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof YS||a instanceof QS?a.context:void 0}}})}}var Ys={},kj={},Pg={},Rm={},Dg={},Tg={},H7=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Od=H7();const W7=Od.fetch,CD=Od.fetch.bind(Od),ED=Od.Headers,V7=Od.Request,K7=Od.Response,nu=Object.freeze(Object.defineProperty({__proto__:null,Headers:ED,Request:V7,Response:K7,default:CD,fetch:W7},Symbol.toStringTag,{value:"Module"})),Z7=NE(nu);var Mg={};Object.defineProperty(Mg,"__esModule",{value:!0});let G7=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Mg.default=G7;var AD=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Tg,"__esModule",{value:!0});const Q7=AD(Z7),Y7=AD(Mg);let X7=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Q7.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let a=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,c,d;let u=null,m=null,f=null,p=i.status,v=i.statusText;if(i.ok){if(this.method!=="HEAD"){const j=await i.text();j===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?m=j:m=JSON.parse(j))}const x=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(c=i.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");x&&y&&y.length>1&&(f=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(u={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,f=null,p=406,v="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{const x=await i.text();try{u=JSON.parse(x),Array.isArray(u)&&i.status===404&&(m=[],u=null,p=200,v="OK")}catch{i.status===404&&x===""?(p=204,v="No Content"):u={message:x}}if(u&&this.isMaybeSingle&&(!((d=u==null?void 0:u.details)===null||d===void 0)&&d.includes("0 rows"))&&(u=null,p=200,v="OK"),u&&this.shouldThrowOnError)throw new Y7.default(u)}return{error:u,data:m,count:f,status:p,statusText:v}});return this.shouldThrowOnError||(a=a.catch(i=>{var o,c,d;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(c=i==null?void 0:i.stack)!==null&&c!==void 0?c:""}`,hint:"",code:`${(d=i==null?void 0:i.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),a.then(e,n)}returns(){return this}overrideTypes(){return this}};Tg.default=X7;var J7=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Dg,"__esModule",{value:!0});const eU=J7(Tg);let tU=class extends eU.default{select(e){let n=!1;const r=(e??"*").split("").map(a=>/\s/.test(a)&&!n?"":(a==='"'&&(n=!n),a)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:a,referencedTable:i=a}={}){const o=i?`${i}.order`:"order",c=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${c?`${c},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:a=r}={}){const i=typeof a>"u"?"offset":`${a}.offset`,o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:a=!1,wal:i=!1,format:o="text"}={}){var c;const d=[e?"analyze":null,n?"verbose":null,r?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${d};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Dg.default=tU;var nU=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Rm,"__esModule",{value:!0});const sU=nU(Dg);let rU=class extends sU.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};Rm.default=rU;var aU=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Pg,"__esModule",{value:!0});const Du=aU(Rm);let iU=class{constructor(e,{headers:n={},schema:r,fetch:a}){this.url=e,this.headers=n,this.schema=r,this.fetch=a}select(e,{head:n=!1,count:r}={}){const a=n?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new Du.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:r=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const o=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(o.length>0){const c=[...new Set(o)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new Du.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:a,defaultToNull:i=!0}={}){const o="POST",c=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),i||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(e)){const d=e.reduce((u,m)=>u.concat(Object.keys(m)),[]);if(d.length>0){const u=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",u.join(","))}}return new Du.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const r="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),n&&a.push(`count=${n}`),this.headers.Prefer=a.join(","),new Du.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new Du.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Pg.default=iU;var Rg={},Ig={};Object.defineProperty(Ig,"__esModule",{value:!0});Ig.version=void 0;Ig.version="0.0.0-automated";Object.defineProperty(Rg,"__esModule",{value:!0});Rg.DEFAULT_HEADERS=void 0;const oU=Ig;Rg.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${oU.version}`};var PD=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(kj,"__esModule",{value:!0});const lU=PD(Pg),cU=PD(Rm),dU=Rg;let uU=class DD{constructor(e,{headers:n={},schema:r,fetch:a}={}){this.url=e,this.headers=Object.assign(Object.assign({},dU.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=a}from(e){const n=new URL(`${this.url}/${e}`);return new lU.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new DD(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:a=!1,count:i}={}){let o;const c=new URL(`${this.url}/rpc/${e}`);let d;r||a?(o=r?"HEAD":"GET",Object.entries(n).filter(([m,f])=>f!==void 0).map(([m,f])=>[m,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([m,f])=>{c.searchParams.append(m,f)})):(o="POST",d=n);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new cU.default({method:o,url:c,headers:u,schema:this.schemaName,body:d,fetch:this.fetch,allowEmpty:!1})}};kj.default=uU;var su=gt&&gt.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ys,"__esModule",{value:!0});Ys.PostgrestError=Ys.PostgrestBuilder=Ys.PostgrestTransformBuilder=Ys.PostgrestFilterBuilder=Ys.PostgrestQueryBuilder=Ys.PostgrestClient=void 0;const TD=su(kj);Ys.PostgrestClient=TD.default;const MD=su(Pg);Ys.PostgrestQueryBuilder=MD.default;const RD=su(Rm);Ys.PostgrestFilterBuilder=RD.default;const ID=su(Dg);Ys.PostgrestTransformBuilder=ID.default;const OD=su(Tg);Ys.PostgrestBuilder=OD.default;const LD=su(Mg);Ys.PostgrestError=LD.default;var hU=Ys.default={PostgrestClient:TD.default,PostgrestQueryBuilder:MD.default,PostgrestFilterBuilder:RD.default,PostgrestTransformBuilder:ID.default,PostgrestBuilder:OD.default,PostgrestError:LD.default};const{PostgrestClient:mU,PostgrestQueryBuilder:pae,PostgrestFilterBuilder:gae,PostgrestTransformBuilder:xae,PostgrestBuilder:vae,PostgrestError:yae}=hU;function fU(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const pU=fU(),gU="2.11.15",xU=`realtime-js/${gU}`,vU="1.0.0",FD=1e4,yU=1e3;var mh;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(mh||(mh={}));var ks;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ks||(ks={}));var aa;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(aa||(aa={}));var vw;(function(t){t.websocket="websocket"})(vw||(vw={}));var cl;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(cl||(cl={}));class _U{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const a=n.getUint8(1),i=n.getUint8(2);let o=this.HEADER_LENGTH+2;const c=r.decode(e.slice(o,o+a));o=o+a;const d=r.decode(e.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:c,event:d,payload:u}}}class BD{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var hn;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(hn||(hn={}));const XS=(t,e,n={})=>{var r;const a=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,o)=>(i[o]=wU(o,t,e,a),i),{})},wU=(t,e,n,r)=>{const a=e.find(c=>c.name===t),i=a==null?void 0:a.type,o=n[t];return i&&!r.includes(i)?zD(i,o):yw(o)},zD=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return SU(e,n)}switch(t){case hn.bool:return bU(e);case hn.float4:case hn.float8:case hn.int2:case hn.int4:case hn.int8:case hn.numeric:case hn.oid:return jU(e);case hn.json:case hn.jsonb:return NU(e);case hn.timestamp:return kU(e);case hn.abstime:case hn.date:case hn.daterange:case hn.int4range:case hn.int8range:case hn.money:case hn.reltime:case hn.text:case hn.time:case hn.timestamptz:case hn.timetz:case hn.tsrange:case hn.tstzrange:return yw(e);default:return yw(e)}},yw=t=>t,bU=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},jU=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},NU=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},SU=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const o=t.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>zD(e,c))}return t},kU=t=>typeof t=="string"?t.replace(" ","T"):t,$D=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class jv{constructor(e,n,r={},a=FD){this.channel=e,this.event=n,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var JS;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(JS||(JS={}));class fh{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=fh.syncState(this.state,a,i,o),this.pendingDiffs.forEach(d=>{this.state=fh.syncDiff(this.state,d,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(r.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=fh.syncDiff(this.state,a,i,o),c())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,a){const i=this.cloneDeep(e),o=this.transformState(n),c={},d={};return this.map(i,(u,m)=>{o[u]||(d[u]=m)}),this.map(o,(u,m)=>{const f=i[u];if(f){const p=m.map(y=>y.presence_ref),v=f.map(y=>y.presence_ref),w=m.filter(y=>v.indexOf(y.presence_ref)<0),x=f.filter(y=>p.indexOf(y.presence_ref)<0);w.length>0&&(c[u]=w),x.length>0&&(d[u]=x)}else c[u]=m}),this.syncDiff(i,{joins:c,leaves:d},r,a)}static syncDiff(e,n,r,a){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(i,(c,d)=>{var u;const m=(u=e[c])!==null&&u!==void 0?u:[];if(e[c]=this.cloneDeep(d),m.length>0){const f=e[c].map(v=>v.presence_ref),p=m.filter(v=>f.indexOf(v.presence_ref)<0);e[c].unshift(...p)}r(c,m,d)}),this.map(o,(c,d)=>{let u=e[c];if(!u)return;const m=d.map(f=>f.presence_ref);u=u.filter(f=>m.indexOf(f.presence_ref)<0),e[c]=u,a(c,u,d),u.length===0&&delete e[c]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const a=e[r];return"metas"in a?n[r]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=a,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ek;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(ek||(ek={}));var tk;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(tk||(tk={}));var pi;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(pi||(pi={}));class Cj{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=ks.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new jv(this,aa.join,this.params,this.timeout),this.rejoinTimer=new BD(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ks.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ks.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=ks.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ks.errored,this.rejoinTimer.scheduleTimeout())}),this._on(aa.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new fh(this),this.broadcastEndpointURL=$D(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.state==ks.closed){const{config:{broadcast:i,presence:o,private:c}}=this.params;this._onError(m=>e==null?void 0:e(pi.CHANNEL_ERROR,m)),this._onClose(()=>e==null?void 0:e(pi.CLOSED));const d={},u={broadcast:i,presence:o,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(m=>m.filter))!==null&&a!==void 0?a:[],private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:m})=>{var f;if(this.socket.setAuth(),m===void 0){e==null||e(pi.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,v=(f=p==null?void 0:p.length)!==null&&f!==void 0?f:0,w=[];for(let x=0;x<v;x++){const y=p[x],{filter:{event:j,schema:b,table:N,filter:S}}=y,E=m&&m[x];if(E&&E.event===j&&E.schema===b&&E.table===N&&E.filter===S)w.push(Object.assign(Object.assign({},y),{id:E.id}));else{this.unsubscribe(),this.state=ks.errored,e==null||e(pi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,e&&e(pi.SUBSCRIBED);return}}).receive("error",m=>{this.state=ks.errored,e==null||e(pi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(pi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,a;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,d;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((d=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ks.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(aa.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(a=>{r=new jv(this,aa.leave,{},e),r.receive("ok",()=>{n(),a("ok")}).receive("timeout",()=>{n(),a("timed out")}).receive("error",()=>{a("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,n,r){const a=new AbortController,i=setTimeout(()=>a.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:a.signal}));return clearTimeout(i),o}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new jv(this,e,n,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var a,i;const o=e.toLocaleLowerCase(),{close:c,error:d,leave:u,join:m}=aa;if(r&&[c,d,u,m].indexOf(o)>=0&&r!==this._joinRef())return;let p=this._onMessage(o,n,r);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(v=>{var w,x,y;return((w=v.filter)===null||w===void 0?void 0:w.event)==="*"||((y=(x=v.filter)===null||x===void 0?void 0:x.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(v=>v.callback(p,r)):(i=this.bindings[o])===null||i===void 0||i.filter(v=>{var w,x,y,j,b,N;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in v){const S=v.id,E=(w=v.filter)===null||w===void 0?void 0:w.event;return S&&((x=n.ids)===null||x===void 0?void 0:x.includes(S))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const S=(b=(j=v==null?void 0:v.filter)===null||j===void 0?void 0:j.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return S==="*"||S===((N=n==null?void 0:n.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===o}).map(v=>{if(typeof p=="object"&&"ids"in p){const w=p.data,{schema:x,table:y,commit_timestamp:j,type:b,errors:N}=w;p=Object.assign(Object.assign({},{schema:x,table:y,commit_timestamp:j,eventType:b,new:{},old:{},errors:N}),this._getPayloadRecords(w))}v.callback(p,r)})}_isClosed(){return this.state===ks.closed}_isJoined(){return this.state===ks.joined}_isJoining(){return this.state===ks.joining}_isLeaving(){return this.state===ks.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const a=e.toLocaleLowerCase(),i={type:a,filter:n,callback:r};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Cj.isEqual(a.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(aa.close,{},e)}_onError(e){this._on(aa.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ks.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=XS(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=XS(e.columns,e.old_record)),n}}const nk=()=>{},CU=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class EU{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=FD,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=nk,this.ref=0,this.logger=nk,this.conn=null,this.sendBuffer=[],this.serializer=new _U,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...c)=>tu(async()=>{const{default:d}=await Promise.resolve().then(()=>nu);return{default:d}},void 0,import.meta.url).then(({default:d})=>d(...c)):o=fetch,(...c)=>o(...c)},this.endPoint=`${e}/${vw.websocket}`,this.httpEndpoint=$D(e),n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),(n!=null&&n.logLevel||n!=null&&n.log_level)&&(this.logLevel=n.logLevel||n.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const a=(r=n==null?void 0:n.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(i,o)=>o(JSON.stringify(i)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new BD(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch),n!=null&&n.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(n==null?void 0:n.worker)||!1,this.workerUrl=n==null?void 0:n.workerUrl}this.accessToken=(n==null?void 0:n.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=pU),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:vU}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(r=>r.teardown()))}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case mh.connecting:return cl.Connecting;case mh.open:return cl.Open;case mh.closing:return cl.Closing;default:return cl.Closed}}isConnected(){return this.connectionState()===cl.Open}channel(e,n={config:{}}){const r=`realtime:${e}`,a=this.getChannels().find(i=>i.topic===r);if(a)return a;{const i=new Cj(`realtime:${e}`,n,this);return this.channels.push(i),i}}push(e){const{topic:n,event:r,payload:a,ref:i}=e,o=()=>{this.encode(e,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${n} ${r} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const a={access_token:n,version:xU};n&&r.updateJoinPayload(a),r.joinedOnce&&r._isJoined()&&r._push(aa.access_token,{access_token:n})}))}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(e=this.conn)===null||e===void 0||e.close(yU,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:a,payload:i,ref:o}=n;r==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(n.payload.status=="ok"?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${a} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(c=>c._isMember(r)).forEach(c=>c._trigger(a,i,o)),this.stateChangeCallbacks.message.forEach(c=>c(n))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(e=>e())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",`${e}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(aa.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",a=new URLSearchParams(n);return`${e}${r}${a}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([CU],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class Ej extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function as(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class AU extends Ej{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class _w extends Ej{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var PU=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};const UD=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>tu(async()=>{const{default:r}=await Promise.resolve().then(()=>nu);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},DU=()=>PU(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield tu(()=>Promise.resolve().then(()=>nu),void 0,import.meta.url)).Response:Response}),ww=t=>{if(Array.isArray(t))return t.map(n=>ww(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const a=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[a]=ww(r)}),e};var rc=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};const Nv=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),TU=(t,e,n)=>rc(void 0,void 0,void 0,function*(){const r=yield DU();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(a=>{e(new AU(Nv(a),t.status||500))}).catch(a=>{e(new _w(Nv(a),a))}):e(new _w(Nv(t),t))}),MU=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),n))};function Im(t,e,n,r,a,i){return rc(this,void 0,void 0,function*(){return new Promise((o,c)=>{t(n,MU(e,r,a,i)).then(d=>{if(!d.ok)throw d;return r!=null&&r.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>TU(d,c,r))})})}function w0(t,e,n,r){return rc(this,void 0,void 0,function*(){return Im(t,"GET",e,n,r)})}function Qi(t,e,n,r,a){return rc(this,void 0,void 0,function*(){return Im(t,"POST",e,r,a,n)})}function RU(t,e,n,r,a){return rc(this,void 0,void 0,function*(){return Im(t,"PUT",e,r,a,n)})}function IU(t,e,n,r){return rc(this,void 0,void 0,function*(){return Im(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function qD(t,e,n,r,a){return rc(this,void 0,void 0,function*(){return Im(t,"DELETE",e,r,a,n)})}var Ws=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};const OU={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},sk={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class LU{constructor(e,n={},r,a){this.url=e,this.headers=n,this.bucketId=r,this.fetch=UD(a)}uploadOrUpdate(e,n,r,a){return Ws(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},sk),a);let c=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",this.encodeMetadata(d)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",this.encodeMetadata(d))):(i=r,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,d&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const u=this._removeEmptyFolders(n),m=this._getFinalPath(u),f=yield this.fetch(`${this.url}/object/${m}`,Object.assign({method:e,body:i,headers:c},o!=null&&o.duplex?{duplex:o.duplex}:{})),p=yield f.json();return f.ok?{data:{path:u,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(i){if(as(i))return{data:null,error:i};throw i}})}upload(e,n,r){return Ws(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,a){return Ws(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),c=new URL(this.url+`/object/upload/sign/${o}`);c.searchParams.set("token",n);try{let d;const u=Object.assign({upsert:sk.upsert},a),m=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",u.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",u.cacheControl)):(d=r,m["cache-control"]=`max-age=${u.cacheControl}`,m["content-type"]=u.contentType);const f=yield this.fetch(c.toString(),{method:"PUT",body:d,headers:m}),p=yield f.json();return f.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(d){if(as(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(e,n){return Ws(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const a=Object.assign({},this.headers);n!=null&&n.upsert&&(a["x-upsert"]="true");const i=yield Qi(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),o=new URL(this.url+i.url),c=o.searchParams.get("token");if(!c)throw new Ej("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:c},error:null}}catch(r){if(as(r))return{data:null,error:r};throw r}})}update(e,n,r){return Ws(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Ws(this,void 0,void 0,function*(){try{return{data:yield Qi(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(as(a))return{data:null,error:a};throw a}})}copy(e,n,r){return Ws(this,void 0,void 0,function*(){try{return{data:{path:(yield Qi(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(as(a))return{data:null,error:a};throw a}})}createSignedUrl(e,n,r){return Ws(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e),i=yield Qi(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(as(a))return{data:null,error:a};throw a}})}createSignedUrls(e,n,r){return Ws(this,void 0,void 0,function*(){try{const a=yield Qi(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(as(a))return{data:null,error:a};throw a}})}download(e,n){return Ws(this,void 0,void 0,function*(){const a=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=i?`?${i}`:"";try{const c=this._getFinalPath(e);return{data:yield(yield w0(this.fetch,`${this.url}/${a}/${c}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(as(c))return{data:null,error:c};throw c}})}info(e){return Ws(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield w0(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:ww(r),error:null}}catch(r){if(as(r))return{data:null,error:r};throw r}})}exists(e){return Ws(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield IU(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(as(r)&&r instanceof _w){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),a=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&a.push(i);const c=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});d!==""&&a.push(d);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${u}`)}}}remove(e){return Ws(this,void 0,void 0,function*(){try{return{data:yield qD(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(as(n))return{data:null,error:n};throw n}})}list(e,n,r){return Ws(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},OU),n),{prefix:e||""});return{data:yield Qi(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(as(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const FU="2.7.1",BU={"X-Client-Info":`storage-js/${FU}`};var wc=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};class zU{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},BU),n),this.fetch=UD(r)}listBuckets(){return wc(this,void 0,void 0,function*(){try{return{data:yield w0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(as(e))return{data:null,error:e};throw e}})}getBucket(e){return wc(this,void 0,void 0,function*(){try{return{data:yield w0(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(as(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return wc(this,void 0,void 0,function*(){try{return{data:yield Qi(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(as(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return wc(this,void 0,void 0,function*(){try{return{data:yield RU(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(as(r))return{data:null,error:r};throw r}})}emptyBucket(e){return wc(this,void 0,void 0,function*(){try{return{data:yield Qi(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(as(n))return{data:null,error:n};throw n}})}deleteBucket(e){return wc(this,void 0,void 0,function*(){try{return{data:yield qD(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(as(n))return{data:null,error:n};throw n}})}}class $U extends zU{constructor(e,n={},r){super(e,n,r)}from(e){return new LU(this.url,this.headers,e,this.fetch)}}const UU="2.50.3";let Bu="";typeof Deno<"u"?Bu="deno":typeof document<"u"?Bu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Bu="react-native":Bu="node";const qU={"X-Client-Info":`supabase-js-${Bu}/${UU}`},HU={headers:qU},WU={schema:"public"},VU={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},KU={};var ZU=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};const GU=t=>{let e;return t?e=t:typeof fetch>"u"?e=CD:e=fetch,(...n)=>e(...n)},QU=()=>typeof Headers>"u"?ED:Headers,YU=(t,e,n)=>{const r=GU(n),a=QU();return(i,o)=>ZU(void 0,void 0,void 0,function*(){var c;const d=(c=yield e())!==null&&c!==void 0?c:t;let u=new a(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${d}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};var XU=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};function JU(t){return t.endsWith("/")?t:t+"/"}function eq(t,e){var n,r;const{db:a,auth:i,realtime:o,global:c}=t,{db:d,auth:u,realtime:m,global:f}=e,p={db:Object.assign(Object.assign({},d),a),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},m),o),global:Object.assign(Object.assign(Object.assign({},f),c),{headers:Object.assign(Object.assign({},(n=f==null?void 0:f.headers)!==null&&n!==void 0?n:{}),(r=c==null?void 0:c.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>XU(this,void 0,void 0,function*(){return""})};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}const HD="2.70.0",Rc=30*1e3,bw=3,Sv=bw*Rc,tq="http://localhost:9999",nq="supabase.auth.token",sq={"X-Client-Info":`gotrue-js/${HD}`},jw="X-Supabase-Api-Version",WD={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rq=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,aq=6e5;class Aj extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Tt(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class iq extends Aj{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function oq(t){return Tt(t)&&t.name==="AuthApiError"}class VD extends Aj{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Wo extends Aj{constructor(e,n,r,a){super(e,r,a),this.name=n,this.status=r}}class Wi extends Wo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function lq(t){return Tt(t)&&t.name==="AuthSessionMissingError"}class qf extends Wo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Hf extends Wo{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Wf extends Wo{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function cq(t){return Tt(t)&&t.name==="AuthImplicitGrantRedirectError"}class rk extends Wo{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Nw extends Wo{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function kv(t){return Tt(t)&&t.name==="AuthRetryableFetchError"}class ak extends Wo{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class ph extends Wo{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const b0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ik=` 	
\r=`.split(""),dq=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<ik.length;e+=1)t[ik[e].charCodeAt(0)]=-2;for(let e=0;e<b0.length;e+=1)t[b0[e].charCodeAt(0)]=e;return t})();function ok(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(b0[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(b0[r]),e.queuedBits-=6}}function KD(t,e,n){const r=dq[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function lk(t){const e=[],n=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{mq(o,r,n)};for(let o=0;o<t.length;o+=1)KD(t.charCodeAt(o),a,i);return e.join("")}function uq(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function hq(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const a=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|a)+65536,n+=1}uq(r,e)}}function mq(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function fq(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};for(let a=0;a<t.length;a+=1)KD(t.charCodeAt(a),n,r);return new Uint8Array(e)}function pq(t){const e=[];return hq(t,n=>e.push(n)),new Uint8Array(e)}function gq(t){const e=[],n={queue:0,queuedBits:0},r=a=>{e.push(a)};return t.forEach(a=>ok(a,n,r)),ok(null,n,r),e.join("")}function xq(t){return Math.round(Date.now()/1e3)+t}function vq(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Jr=()=>typeof window<"u"&&typeof document<"u",nl={tested:!1,writable:!1},gh=()=>{if(!Jr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(nl.tested)return nl.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),nl.tested=!0,nl.writable=!0}catch{nl.tested=!0,nl.writable=!1}return nl.writable};function yq(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((a,i)=>{e[i]=a})}catch{}return n.searchParams.forEach((r,a)=>{e[a]=r}),e}const ZD=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>tu(async()=>{const{default:r}=await Promise.resolve().then(()=>nu);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},_q=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",GD=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Vf=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Kf=async(t,e)=>{await t.removeItem(e)};class Og{constructor(){this.promise=new Og.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Og.promiseConstructor=Promise;function Cv(t){const e=t.split(".");if(e.length!==3)throw new ph("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!rq.test(e[r]))throw new ph("JWT not in base64url format");return{header:JSON.parse(lk(e[0])),payload:JSON.parse(lk(e[1])),signature:fq(e[2]),raw:{header:e[0],payload:e[1]}}}async function wq(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function bq(t,e){return new Promise((r,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await t(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){a(o);return}}})()})}function jq(t){return("0"+t.toString(16)).substr(-2)}function Nq(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let a="";for(let i=0;i<56;i++)a+=n.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(e),Array.from(e,jq).join("")}async function Sq(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),a=new Uint8Array(r);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function kq(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Sq(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function bc(t,e,n=!1){const r=Nq();let a=r;n&&(a+="/PASSWORD_RECOVERY"),await GD(t,`${e}-code-verifier`,a);const i=await kq(r);return[i,r===i?"plain":"s256"]}const Cq=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Eq(t){const e=t.headers.get(jw);if(!e||!e.match(Cq))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Aq(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Pq(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Dq=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function jc(t){if(!Dq.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var Tq=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};const il=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Mq=[502,503,504];async function ck(t){var e;if(!_q(t))throw new Nw(il(t),0);if(Mq.includes(t.status))throw new Nw(il(t),t.status);let n;try{n=await t.json()}catch(i){throw new VD(il(i),i)}let r;const a=Eq(t);if(a&&a.getTime()>=WD["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new ak(il(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Wi}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new ak(il(n),t.status,n.weak_password.reasons);throw new iq(il(n),t.status||500,r)}const Rq=(t,e,n,r)=>{const a={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),n))};async function Ht(t,e,n,r){var a;const i=Object.assign({},r==null?void 0:r.headers);i[jw]||(i[jw]=WD["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await Iq(t,e,n+c,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(d):{data:Object.assign({},d),error:null}}async function Iq(t,e,n,r,a,i){const o=Rq(e,r,a,i);let c;try{c=await t(n,Object.assign({},o))}catch(d){throw console.error(d),new Nw(il(d),0)}if(c.ok||await ck(c),r!=null&&r.noResolveJson)return c;try{return await c.json()}catch(d){await ck(d)}}function ui(t){var e;let n=null;Bq(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=xq(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function dk(t){const e=ui(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function eo(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Oq(t){return{data:t,error:null}}function Lq(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i}=t,o=Tq(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:e,email_otp:n,hashed_token:r,redirect_to:a,verification_type:i},d=Object.assign({},o);return{data:{properties:c,user:d},error:null}}function Fq(t){return t}function Bq(t){return t.access_token&&t.refresh_token&&t.expires_in}const Ev=["global","local","others"];var zq=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n};class $q{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=ZD(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=Ev[0]){if(Ev.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ev.join(", ")}`);try{return await Ht(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Tt(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await Ht(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:eo})}catch(r){if(Tt(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=zq(e,["options"]),a=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await Ht(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Lq,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Tt(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Ht(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:eo})}catch(n){if(Tt(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,a,i,o,c,d;try{const u={nextPage:null,lastPage:0,total:0},m=await Ht(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(a=e==null?void 0:e.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:Fq});if(m.error)throw m.error;const f=await m.json(),p=(o=m.headers.get("x-total-count"))!==null&&o!==void 0?o:0,v=(d=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return v.length>0&&(v.forEach(w=>{const x=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(w.split(";")[1].split("=")[1]);u[`${y}Page`]=x}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Tt(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){jc(e);try{return await Ht(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:eo})}catch(n){if(Tt(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){jc(e);try{return await Ht(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:eo})}catch(r){if(Tt(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){jc(e);try{return await Ht(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:eo})}catch(r){if(Tt(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){jc(e.userId);try{const{data:n,error:r}=await Ht(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:n,error:r}}catch(n){if(Tt(n))return{data:null,error:n};throw n}}async _deleteFactor(e){jc(e.userId),jc(e.id);try{return{data:await Ht(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Tt(n))return{data:null,error:n};throw n}}}const Uq={getItem:t=>gh()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{gh()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{gh()&&globalThis.localStorage.removeItem(t)}};function uk(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function qq(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Nc={debug:!!(globalThis&&gh()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class QD extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Hq extends QD{}async function Wq(t,e,n){Nc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Nc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){Nc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,a.name);try{return await n()}finally{Nc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,a.name)}}else{if(e===0)throw Nc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Hq(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Nc.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}qq();const Vq={url:tq,storageKey:nq,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:sq,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function hk(t,e,n){return await n()}class Kh{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Kh.nextInstanceID,Kh.nextInstanceID+=1,this.instanceID>0&&Jr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},Vq),e);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new $q({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=ZD(a.fetch),this.lock=a.lock||hk,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Jr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Wq:this.lock=hk,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:gh()?this.storage=Uq:(this.memoryStorage={},this.storage=uk(this.memoryStorage)):(this.memoryStorage={},this.storage=uk(this.memoryStorage)),Jr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${HD}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=yq(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Jr()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),cq(i)){const d=(e=i.details)===null||e===void 0?void 0:e.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Tt(n)?{error:n}:{error:new VD("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,a;try{const i=await Ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=e==null?void 0:e.options)===null||a===void 0?void 0:a.captchaToken}},xform:ui}),{data:o,error:c}=i;if(c||!o)return{data:{user:null,session:null},error:c};const d=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:u,session:d},error:null}}catch(i){if(Tt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,r,a;try{let i;if("email"in e){const{email:m,password:f,options:p}=e;let v=null,w=null;this.flowType==="pkce"&&([v,w]=await bc(this.storage,this.storageKey)),i=await Ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:m,password:f,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:v,code_challenge_method:w},xform:ui})}else if("phone"in e){const{phone:m,password:f,options:p}=e;i=await Ht(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:f,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},channel:(a=p==null?void 0:p.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:ui})}else throw new Hf("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return{data:{user:null,session:null},error:c};const d=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:u,session:d},error:null}}catch(i){if(Tt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:o,options:c}=e;n=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:dk})}else if("phone"in e){const{phone:i,password:o,options:c}=e;n=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:dk})}else throw new Hf("You must provide either an email or phone number and a password");const{data:r,error:a}=n;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new qf}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(n){if(Tt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,a,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,a,i,o,c,d,u,m,f,p,v;let w,x;if("message"in e)w=e.message,x=e.signature;else{const{chain:y,wallet:j,statement:b,options:N}=e;let S;if(Jr())if(typeof j=="object")S=j;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))S=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!(N!=null&&N.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=j}const E=new URL((n=N==null?void 0:N.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in S&&S.signIn){const C=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N==null?void 0:N.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),b?{statement:b}:null));let P;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")P=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)P=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)w=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),x=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${E.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(a=(r=N==null?void 0:N.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=N==null?void 0:N.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((o=N==null?void 0:N.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((c=N==null?void 0:N.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((d=N==null?void 0:N.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((u=N==null?void 0:N.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((f=(m=N==null?void 0:N.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||f===void 0)&&f.length?["Resources",...N.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const C=await S.signMessage(new TextEncoder().encode(w),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=C}}try{const{data:y,error:j}=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:gq(x)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:ui});if(j)throw j;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new qf}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:j})}catch(y){if(Tt(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(e){const n=await Vf(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(n??"").split("/");try{const{data:i,error:o}=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ui});if(await Kf(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new qf}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(Tt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:a,access_token:i,nonce:o}=e,c=await Ht(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ui}),{data:d,error:u}=c;return u?{data:{user:null,session:null},error:u}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new qf}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:u})}catch(n){if(Tt(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,a,i,o;try{if("email"in e){const{email:c,options:d}=e;let u=null,m=null;this.flowType==="pkce"&&([u,m]=await bc(this.storage,this.storageKey));const{error:f}=await Ht(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},create_user:(r=d==null?void 0:d.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:u,code_challenge_method:m},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:c,options:d}=e,{data:u,error:m}=await Ht(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(o=d==null?void 0:d.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:m}}throw new Hf("You must provide either an email or phone number.")}catch(c){if(Tt(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(e){var n,r;try{let a,i;"options"in e&&(a=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:c}=await Ht(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:ui});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,u=o.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:u,session:d},error:null}}catch(a){if(Tt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(e){var n,r,a;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await bc(this.storage,this.storageKey)),await Ht(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=e==null?void 0:e.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Oq})}catch(i){if(Tt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Wi;const{error:a}=await Ht(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:a}})}catch(e){if(Tt(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:a,options:i}=e,{error:o}=await Ht(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:a,options:i}=e,{data:o,error:c}=await Ht(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:c}}throw new Hf("You must provide either an email or phone number and a type")}catch(n){if(Tt(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Vf(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Sv:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(d,u,m)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,u,m))})}return{data:{session:e},error:null}}const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ht(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:eo}):await this._useSession(async n=>{var r,a,i;const{data:o,error:c}=n;if(c)throw c;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Wi}:await Ht(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:eo})})}catch(n){if(Tt(n))return lq(n)&&(await this._removeSession(),await Kf(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:a,error:i}=r;if(i)throw i;if(!a.session)throw new Wi;const o=a.session;let c=null,d=null;this.flowType==="pkce"&&e.email!=null&&([c,d]=await bc(this.storage,this.storageKey));const{data:u,error:m}=await Ht(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:c,code_challenge_method:d}),jwt:o.access_token,xform:eo});if(m)throw m;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(Tt(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Wi;const n=Date.now()/1e3;let r=n,a=!0,i=null;const{payload:o}=Cv(e.access_token);if(o.exp&&(r=o.exp,a=r<=n),a){const{session:c,error:d}=await this._callRefreshToken(e.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(e.access_token);if(d)throw d;i={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(Tt(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:o,error:c}=n;if(c)throw c;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Wi;const{session:a,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Tt(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Jr())throw new Wf("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Wf(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new rk("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Wf("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new rk("No code detected.");const{data:b,error:N}=await this._exchangeCodeForSession(e.code);if(N)throw N;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:c,expires_at:d,token_type:u}=e;if(!i||!c||!o||!u)throw new Wf("No session defined in URL");const m=Math.round(Date.now()/1e3),f=parseInt(c);let p=m+f;d&&(p=parseInt(d));const v=p-m;v*1e3<=Rc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${f}s`);const w=p-f;m-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,p,m):m-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,p,m);const{data:x,error:y}=await this._getUser(i);if(y)throw y;const j={provider_token:r,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:p,refresh_token:o,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:j,redirectType:e.type},error:null}}catch(r){if(Tt(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Vf(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{error:i};const o=(r=a.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:c}=await this.admin.signOut(o,e);if(c&&!(oq(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(await this._removeSession(),await Kf(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=vq(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,a;try{const{data:{session:i},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await bc(this.storage,this.storageKey,!0));try{return await Ht(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(Tt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Tt(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:a}=await this._useSession(async i=>{var o,c,d,u,m;const{data:f,error:p}=i;if(p)throw p;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=e.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Ht(this.fetch,"GET",v,{headers:this.headers,jwt:(m=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&m!==void 0?m:void 0})});if(a)throw a;return Jr()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Tt(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:o}=n;if(o)throw o;return await Ht(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(a=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(n){if(Tt(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await bq(async a=>(a>0&&await wq(200*Math.pow(2,a-1)),this._debug(n,"refreshing attempt",a),await Ht(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ui})),(a,i)=>{const o=200*Math.pow(2,a);return i&&kv(i)&&Date.now()+o-r<Rc})}catch(r){if(this._debug(n,"error",r),Tt(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Jr()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await Vf(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const a=((e=r.expires_at)!==null&&e!==void 0?e:1/0)*1e3-Date.now()<Sv;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${Sv}s`),a){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),kv(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Wi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Og;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Wi;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={session:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(a,"error",i),Tt(i)){const o={session:null,error:i};return kv(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(e,n,r=!0){const a=`#_notifyAllSubscribers(${e})`;this._debug(a,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(e,n)}catch(d){i.push(d)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await GD(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Kf(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Jr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Rc);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-e)/Rc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Rc}ms, refresh threshold is ${bw} ticks`),a<=bw&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof QD)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Jr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const a=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await bc(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(c.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);a.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${a.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await Ht(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Tt(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,a;const{data:i,error:o}=n;if(o)return{data:null,error:o};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:d,error:u}=await Ht(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((a=d==null?void 0:d.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(n){if(Tt(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;if(i)return{data:null,error:i};const{data:o,error:c}=await Ht(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:c})})}catch(n){if(Tt(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:a,error:i}=n;return i?{data:null,error:i}:await Ht(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Tt(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],a=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:a},error:i}=e;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Cv(a.access_token);let c=null;o.aal&&(c=o.aal);let d=c;((r=(n=a.user.factors)===null||n===void 0?void 0:n.filter(f=>f.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(d="aal2");const m=o.amr||[];return{data:{currentLevel:c,nextLevel:d,currentAuthenticationMethods:m},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(o=>o.kid===e);if(r||(r=this.jwks.keys.find(o=>o.kid===e),r&&this.jwks_cached_at+aq>Date.now()))return r;const{data:a,error:i}=await Ht(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new ph("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),r=a.keys.find(o=>o.kid===e),!r)throw new ph("No matching signing key found in JWKS");return r}async getClaims(e,n={keys:[]}){try{let r=e;if(!r){const{data:v,error:w}=await this.getSession();if(w||!v.session)return{data:null,error:w};r=v.session.access_token}const{header:a,payload:i,signature:o,raw:{header:c,payload:d}}=Cv(r);if(Aq(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:v}=await this.getUser(r);if(v)throw v;return{data:{claims:i,header:a,signature:o},error:null}}const u=Pq(a.alg),m=await this.fetchJwk(a.kid,n),f=await crypto.subtle.importKey("jwk",m,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,o,pq(`${c}.${d}`)))throw new ph("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(r){if(Tt(r))return{data:null,error:r};throw r}}}Kh.nextInstanceID=0;const Kq=Kh;class Zq extends Kq{constructor(e){super(e)}}var Gq=function(t,e,n,r){function a(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function c(m){try{u(r.next(m))}catch(f){o(f)}}function d(m){try{u(r.throw(m))}catch(f){o(f)}}function u(m){m.done?i(m.value):a(m.value).then(c,d)}u((r=r.apply(t,e||[])).next())})};class Qq{constructor(e,n,r){var a,i,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const c=JU(e),d=new URL(c);this.realtimeUrl=new URL("realtime/v1",d),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",d),this.storageUrl=new URL("storage/v1",d),this.functionsUrl=new URL("functions/v1",d);const u=`sb-${d.hostname.split(".")[0]}-auth-token`,m={db:WU,realtime:KU,auth:Object.assign(Object.assign({},VU),{storageKey:u}),global:HU},f=eq(r??{},m);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(p,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=f.auth)!==null&&o!==void 0?o:{},this.headers,f.global.fetch),this.fetch=YU(n,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new mU(new URL("rest/v1",d).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new q7(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new $U(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Gq(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,storageKey:i,flowType:o,lock:c,debug:d},u,m){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Zq({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),u),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:a,flowType:o,lock:c,debug:d,fetch:m,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new EU(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Yq=(t,e,n)=>new Qq(t,e,n),Xq="https://qgwhkjrhndeoskrxewpb.supabase.co",Jq="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFnd2hranJobmRlb3Nrcnhld3BiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1NTExODAsImV4cCI6MjA2NzEyNzE4MH0.eSPBRJKIBd9oiXqfo8vrbmMCl6QByxnVgHqtgofDGtg",K=Yq(Xq,Jq,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0},global:{headers:{"X-Client-Info":"handwerkos-app"}}}),YD=g.createContext(void 0);function eH({children:t}){const[e,n]=g.useState(null),[r,a]=g.useState(null),[i,o]=g.useState(null),[c,d]=g.useState(null),[u,m]=g.useState(!0),f=i==="manager",p=f,v=async j=>{try{const{data:b,error:N}=await K.from("user_roles").select("role").eq("user_id",j).single();N?(console.warn("Role fetch error, default to employee:",N),o("employee")):o((b==null?void 0:b.role)??"employee");const{data:S,error:E}=await K.from("profiles").select("company_id").eq("id",j).single();E?(console.warn("Profile fetch error:",E),d(null)):d((S==null?void 0:S.company_id)??null)}catch(b){console.error("Error fetching user data:",b)}};g.useEffect(()=>{K.auth.getSession().then(({data:b})=>{var N,S;a(b.session),n(((N=b.session)==null?void 0:N.user)??null),(S=b.session)!=null&&S.user&&v(b.session.user.id),m(!1)});const{data:{subscription:j}}=K.auth.onAuthStateChange((b,N)=>{a(N),n((N==null?void 0:N.user)??null),N!=null&&N.user?v(N.user.id):(o(null),d(null)),m(!1)});return()=>j.unsubscribe()},[]);const w=async()=>{n(null),a(null),o(null),d(null),await K.auth.signOut()},x=async(j,b)=>{if(!e||!f||!c)return{success:!1,error:"Keine Berechtigung zum Einladen von Mitarbeitern"};try{console.log("Creating Supabase invitation for employee:",j);const N=crypto.randomUUID(),S=new Date;S.setDate(S.getDate()+7);const{error:E}=await K.from("employee_invitations").insert({email:j.toLowerCase(),invited_by:e.id,company_id:c,invite_token:N,expires_at:S.toISOString(),employee_data:b,status:"pending"});if(E)return console.error("Error creating invitation:",E),{success:!1,error:"Fehler beim Erstellen der Einladung"};const{error:C}=await K.from("employees").upsert({email:j.toLowerCase(),first_name:b.firstName,last_name:b.lastName,position:b.position,phone:b.phone,qualifications:Array.isArray(b.qualifications)?b.qualifications:[],license:b.license||"",company_id:c,status:"eingeladen"});if(C)return console.error("Error creating employee:",C),{success:!1,error:"Fehler beim Erstellen des Mitarbeiters"};const P=`${window.location.origin}/mitarbeiter-setup?token=${N}`,{data:R}=await K.from("profiles").select("email, first_name, last_name").eq("id",e.id).single(),{data:H}=await K.from("companies").select("name").eq("id",c).single();try{const{error:I}=await K.functions.invoke("send-welcome-email",{body:{employeeEmail:j,employeeName:`${b.firstName} ${b.lastName}`,loginUrl:P}});if(I)throw console.warn("Welcome email failed, trying fallback:",I),I;console.log("Professional welcome email sent successfully")}catch{const{error:D}=await K.functions.invoke("send-employee-confirmation",{body:{managerEmail:(R==null?void 0:R.email)||e.email,employeeName:`${b.firstName} ${b.lastName}`,employeeEmail:j,companyName:(H==null?void 0:H.name)||"Ihrem Unternehmen",registrationUrl:P}});D&&console.error("Email sending error:",D)}return{success:!0}}catch(N){return console.error("Invitation error:",N),{success:!1,error:N instanceof Error?N.message:"Unbekannter Fehler bei der Einladung"}}},y=async(j,b)=>{if(!f)return{success:!1,error:"Keine Berechtigung"};try{const{error:N}=await K.from("user_roles").upsert({user_id:j,role:b});if(N)throw N;return{success:!0}}catch(N){return{success:!1,error:N instanceof Error?N.message:"Rolle konnte nicht aktualisiert werden"}}};return s.jsx(YD.Provider,{value:{user:e,session:r,userRole:i,loading:u,isManager:f,canInviteMembers:p,companyId:c,signOut:w,inviteEmployee:x,updateMemberRole:y},children:t})}function Vr(){const t=g.useContext(YD);if(!t)throw new Error("useSupabaseAuth must be used within SupabaseAuthProvider");return t}const Sw=Kd("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ne=g.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...a},i)=>{const o=r?Ci:"button";return s.jsx(o,{className:Ie(Sw({variant:e,size:n,className:t})),ref:i,...a})});ne.displayName="Button";const tH=Kd("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Be({className:t,variant:e,...n}){return s.jsx("div",{className:Ie(tH({variant:e}),t),...n})}const XD=g.createContext(void 0);function nH({children:t}){const[e,n]=g.useState(null),[r,a]=g.useState(null),[i,o]=g.useState(null),[c,d]=g.useState(!0),u=async w=>{const{data:x,error:y}=await K.from("user_roles").select("role").eq("user_id",w).single();y?(console.warn("Role fetch error, default to employee:",y),o("employee")):o((x==null?void 0:x.role)??"employee")};g.useEffect(()=>{K.auth.getSession().then(({data:x})=>{var y,j;a(x.session),n(((y=x.session)==null?void 0:y.user)??null),(j=x.session)!=null&&j.user&&u(x.session.user.id),d(!1)});const{data:{subscription:w}}=K.auth.onAuthStateChange((x,y)=>{console.log("Auth state changed:",x,y),a(y),n((y==null?void 0:y.user)??null),y!=null&&y.user?u(y.user.id):o(null)});return()=>{w.unsubscribe()}},[]);const m=(w,x)=>K.auth.signInWithPassword({email:w,password:x}),f=(w,x,y)=>{const j=`${window.location.origin}/auth?mode=employee-setup`;return K.auth.signUp({email:w,password:x,options:{emailRedirectTo:j,data:{first_name:y.firstName,last_name:y.lastName,company_name:y.companyName,phone:y.phone,street_address:y.streetAddress,postal_code:y.postalCode,city:y.city,country:y.country,vat_id:y.vatId,voucher_code:y.voucherCode,referral_source:y.referralSource}}})},p=w=>K.auth.updateUser({password:w}),v=async()=>{n(null),a(null),o(null),await K.auth.signOut()};return s.jsx(XD.Provider,{value:{user:e,session:r,userRole:i,loading:c,signIn:m,signUp:f,signOut:v,updatePassword:p},children:t})}function Lg(){const t=g.useContext(XD);if(!t)throw new Error("useAuth must be used within AuthProvider");return t}const sH=[{id:"dashboard",name:"Dashboard",icon:Ei,color:"text-blue-500"},{id:"stammdaten",name:"Stammdaten",icon:lB,color:"text-gray-500",children:[{id:"customers",name:"Kunden & Aufträge",icon:Br,color:"text-green-500"},{id:"personal",name:"Personal",icon:Pm,color:"text-purple-500"}]},{id:"projects",name:"Projekte & Baustellen",icon:Hr,color:"text-orange-500"},{id:"timetracking",name:"Zeiterfassung",icon:Pt,color:"text-yellow-500"},{id:"vacation",name:"Urlaubsverwaltung",icon:bB,color:"text-sky-500"},{id:"emails",name:"E-Mails",icon:os,color:"text-pink-500"},{id:"documents",name:"Dokumente",icon:Fr,color:"text-emerald-500"},{id:"invoice-validation",name:"Rechnungs-Validierung",icon:wn,color:"text-amber-500"},{id:"materials",name:"Material",icon:Qa,color:"text-red-500"},{id:"machines",name:"Maschinen & Geräte",icon:Po,color:"text-indigo-500"},{id:"finance",name:"Finanzen",icon:ca,color:"text-cyan-500"},{id:"planner",name:"Planer",icon:At,color:"text-teal-500"},{id:"company-settings",name:"Firmeneinstellungen",icon:Po,color:"text-gray-600"}];function rH({activeModule:t,onModuleChange:e}){const{signOut:n}=Lg(),r=wa(),[a,i]=g.useState(!1),[o,c]=g.useState(null),[d,u]=g.useState(["stammdaten"]),m=async()=>{try{await n(),r("/auth"),Oa({title:"Erfolgreich abgemeldet",description:"Sie wurden erfolgreich abgemeldet."})}catch{Oa({title:"Fehler beim Abmelden",description:"Es ist ein Fehler aufgetreten.",variant:"destructive"})}},f=a;g.useEffect(()=>{f||u([])},[f]);const p=v=>{u(w=>w.includes(v)?w.filter(x=>x!==v):[...w,v])};return s.jsxs("div",{className:`fixed left-0 top-0 h-full z-50 transition-all duration-500 ease-in-out ${f?"w-64":"w-16"} 
      bg-gradient-to-b from-blue-900 via-blue-800 to-blue-950 shadow-2xl`,onMouseEnter:()=>{o&&clearTimeout(o);const v=setTimeout(()=>i(!0),150);c(v)},onMouseLeave:()=>{o&&clearTimeout(o),i(!1),u([])},children:[s.jsx("div",{className:"p-4 border-b border-blue-600/30",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"h-8 w-8 rounded-lg bg-white/20 backdrop-blur-sm flex items-center justify-center border border-white/30",children:s.jsx("span",{className:"text-white font-bold text-sm",children:"H"})}),s.jsx("span",{className:`font-bold text-white transition-all duration-300 ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:"HandwerkOS"})]})}),s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsx("div",{className:"flex-1 p-3",children:s.jsx("div",{className:"space-y-2",children:sH.map(v=>s.jsx("div",{children:v.children?s.jsxs("div",{children:[s.jsxs("button",{onClick:()=>p(v.id),className:`group w-full flex items-center p-3 rounded-lg transition-all duration-300 relative 
                      text-white/80 hover:text-white hover:bg-white/10 backdrop-blur-sm`,title:f?void 0:v.name,children:[s.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:s.jsx(v.icon,{className:`h-5 w-5 ${v.color} group-hover:scale-110 transition-transform duration-200`})}),s.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:v.name}),f&&s.jsx("div",{className:"ml-auto",children:d.includes(v.id)?s.jsx(wg,{className:"h-4 w-4 text-white/60 group-hover:text-white transition-colors duration-200"}):s.jsx(Pl,{className:"h-4 w-4 text-white/60 group-hover:text-white transition-colors duration-200"})})]}),d.includes(v.id)&&f&&s.jsx("div",{className:"ml-6 mt-1 space-y-1",children:v.children.map(w=>s.jsxs("button",{onClick:()=>e(w.id),className:`group w-full flex items-center p-2.5 rounded-lg transition-all duration-200 text-sm ${t===w.id?"bg-white/20 text-white shadow-lg backdrop-blur-sm border border-white/30":"text-white/70 hover:text-white hover:bg-white/10"}`,children:[s.jsx("div",{className:"w-4 h-4 flex items-center justify-center flex-shrink-0",children:s.jsx(w.icon,{className:`h-4 w-4 ${w.color} group-hover:scale-110 transition-transform duration-200`})}),s.jsx("span",{className:"ml-2 whitespace-nowrap font-medium",children:w.name}),t===w.id&&s.jsx("div",{className:"ml-auto w-1.5 h-1.5 rounded-full bg-white animate-pulse"})]},w.id))})]}):s.jsxs("button",{onClick:()=>e(v.id),className:`group w-full flex items-center p-3 rounded-lg transition-all duration-300 relative ${t===v.id?"bg-white/20 text-white shadow-lg backdrop-blur-sm border border-white/30":"text-white/80 hover:text-white hover:bg-white/10"}`,title:f?void 0:v.name,children:[s.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:s.jsx(v.icon,{className:`h-5 w-5 ${v.color} group-hover:scale-110 transition-transform duration-200`})}),s.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:v.name}),t===v.id&&s.jsx("div",{className:"absolute right-0 top-1/2 -translate-y-1/2 w-1 h-8 bg-white/50 rounded-l-full"})]})},v.id))})}),s.jsx("div",{className:"p-3 border-t border-blue-600/30",children:s.jsxs("button",{onClick:m,className:"group w-full flex items-center p-3 rounded-lg text-white/80 hover:text-white hover:bg-red-500/20 transition-all duration-300 relative",title:f?void 0:"Abmelden",children:[s.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:s.jsx(gB,{className:"h-5 w-5 group-hover:scale-110 transition-transform duration-200"})}),s.jsx("span",{className:`ml-3 whitespace-nowrap transition-all duration-300 font-medium ${f?"opacity-100 translate-x-0":"opacity-0 -translate-x-2"}`,children:"Abmelden"})]})})]})]})}const oe=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{ref:n,className:Ie("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));oe.displayName="Card";const je=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{ref:n,className:Ie("flex flex-col space-y-1.5 p-6",t),...e}));je.displayName="CardHeader";const Ne=g.forwardRef(({className:t,...e},n)=>s.jsx("h3",{ref:n,className:Ie("text-2xl font-semibold leading-none tracking-tight",t),...e}));Ne.displayName="CardTitle";const vn=g.forwardRef(({className:t,...e},n)=>s.jsx("p",{ref:n,className:Ie("text-sm text-muted-foreground",t),...e}));vn.displayName="CardDescription";const de=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{ref:n,className:Ie("p-6 pt-0",t),...e}));de.displayName="CardContent";const aH=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{ref:n,className:Ie("flex items-center p-6 pt-0",t),...e}));aH.displayName="CardFooter";const re=g.forwardRef(({className:t,type:e,...n},r)=>s.jsx("input",{type:e,className:Ie("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));re.displayName="Input";var iH="Label",JD=g.forwardRef((t,e)=>s.jsx(tt.label,{...t,ref:e,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=t.onMouseDown)==null||a.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));JD.displayName=iH;var eT=JD;const oH=Kd("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),se=g.forwardRef(({className:t,...e},n)=>s.jsx(eT,{ref:n,className:Ie(oH(),t),...e}));se.displayName=eT.displayName;function lH(t,e=[]){let n=[];function r(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:v,...w}=f,x=(p==null?void 0:p[t][d])||c,y=g.useMemo(()=>w,Object.values(w));return s.jsx(x.Provider,{value:y,children:v})}function m(f,p){const v=(p==null?void 0:p[t][d])||c,w=g.useContext(v);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[r,cH(a,...e)]}function cH(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=r.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var dH=g.createContext(void 0);function ru(t){const e=g.useContext(dH);return t||e||"ltr"}var Av="rovingFocusGroup.onEntryFocus",uH={bubbles:!1,cancelable:!0},Fg="RovingFocusGroup",[kw,tT,hH]=km(Fg),[mH,Bg]=lH(Fg,[hH]),[fH,pH]=mH(Fg),nT=g.forwardRef((t,e)=>s.jsx(kw.Provider,{scope:t.__scopeRovingFocusGroup,children:s.jsx(kw.Slot,{scope:t.__scopeRovingFocusGroup,children:s.jsx(gH,{...t,ref:e})})}));nT.displayName=Fg;var gH=g.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:d,onEntryFocus:u,preventScrollOnEntryFocus:m=!1,...f}=t,p=g.useRef(null),v=Rt(e,p),w=ru(i),[x=null,y]=qr({prop:o,defaultProp:c,onChange:d}),[j,b]=g.useState(!1),N=_n(u),S=tT(n),E=g.useRef(!1),[C,P]=g.useState(0);return g.useEffect(()=>{const R=p.current;if(R)return R.addEventListener(Av,N),()=>R.removeEventListener(Av,N)},[N]),s.jsx(fH,{scope:n,orientation:r,dir:w,loop:a,currentTabStopId:x,onItemFocus:g.useCallback(R=>y(R),[y]),onItemShiftTab:g.useCallback(()=>b(!0),[]),onFocusableItemAdd:g.useCallback(()=>P(R=>R+1),[]),onFocusableItemRemove:g.useCallback(()=>P(R=>R-1),[]),children:s.jsx(tt.div,{tabIndex:j||C===0?-1:0,"data-orientation":r,...f,ref:v,style:{outline:"none",...t.style},onMouseDown:Oe(t.onMouseDown,()=>{E.current=!0}),onFocus:Oe(t.onFocus,R=>{const H=!E.current;if(R.target===R.currentTarget&&H&&!j){const I=new CustomEvent(Av,uH);if(R.currentTarget.dispatchEvent(I),!I.defaultPrevented){const D=S().filter(X=>X.focusable),W=D.find(X=>X.active),V=D.find(X=>X.id===x),Y=[W,V,...D].filter(Boolean).map(X=>X.ref.current);aT(Y,m)}}E.current=!1}),onBlur:Oe(t.onBlur,()=>b(!1))})})}),sT="RovingFocusGroupItem",rT=g.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:i,...o}=t,c=pr(),d=i||c,u=pH(sT,n),m=u.currentTabStopId===d,f=tT(n),{onFocusableItemAdd:p,onFocusableItemRemove:v}=u;return g.useEffect(()=>{if(r)return p(),()=>v()},[r,p,v]),s.jsx(kw.ItemSlot,{scope:n,id:d,focusable:r,active:a,children:s.jsx(tt.span,{tabIndex:m?0:-1,"data-orientation":u.orientation,...o,ref:e,onMouseDown:Oe(t.onMouseDown,w=>{r?u.onItemFocus(d):w.preventDefault()}),onFocus:Oe(t.onFocus,()=>u.onItemFocus(d)),onKeyDown:Oe(t.onKeyDown,w=>{if(w.key==="Tab"&&w.shiftKey){u.onItemShiftTab();return}if(w.target!==w.currentTarget)return;const x=yH(w,u.orientation,u.dir);if(x!==void 0){if(w.metaKey||w.ctrlKey||w.altKey||w.shiftKey)return;w.preventDefault();let j=f().filter(b=>b.focusable).map(b=>b.ref.current);if(x==="last")j.reverse();else if(x==="prev"||x==="next"){x==="prev"&&j.reverse();const b=j.indexOf(w.currentTarget);j=u.loop?_H(j,b+1):j.slice(b+1)}setTimeout(()=>aT(j))}})})})});rT.displayName=sT;var xH={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function vH(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function yH(t,e,n){const r=vH(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return xH[r]}function aT(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function _H(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var iT=nT,oT=rT,Pj="Tabs",[wH,_ae]=kr(Pj,[Bg]),lT=Bg(),[bH,Dj]=wH(Pj),cT=g.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:c,activationMode:d="automatic",...u}=t,m=ru(c),[f,p]=qr({prop:r,onChange:a,defaultProp:i});return s.jsx(bH,{scope:n,baseId:pr(),value:f,onValueChange:p,orientation:o,dir:m,activationMode:d,children:s.jsx(tt.div,{dir:m,"data-orientation":o,...u,ref:e})})});cT.displayName=Pj;var dT="TabsList",uT=g.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...a}=t,i=Dj(dT,n),o=lT(n);return s.jsx(iT,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:r,children:s.jsx(tt.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:e})})});uT.displayName=dT;var hT="TabsTrigger",mT=g.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:a=!1,...i}=t,o=Dj(hT,n),c=lT(n),d=gT(o.baseId,r),u=xT(o.baseId,r),m=r===o.value;return s.jsx(oT,{asChild:!0,...c,focusable:!a,active:m,children:s.jsx(tt.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":u,"data-state":m?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:d,...i,ref:e,onMouseDown:Oe(t.onMouseDown,f=>{!a&&f.button===0&&f.ctrlKey===!1?o.onValueChange(r):f.preventDefault()}),onKeyDown:Oe(t.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&o.onValueChange(r)}),onFocus:Oe(t.onFocus,()=>{const f=o.activationMode!=="manual";!m&&!a&&f&&o.onValueChange(r)})})})});mT.displayName=hT;var fT="TabsContent",pT=g.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:a,children:i,...o}=t,c=Dj(fT,n),d=gT(c.baseId,r),u=xT(c.baseId,r),m=r===c.value,f=g.useRef(m);return g.useEffect(()=>{const p=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(p)},[]),s.jsx(ts,{present:a||m,children:({present:p})=>s.jsx(tt.div,{"data-state":m?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!p,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:f.current?"0s":void 0},children:p&&i})})});pT.displayName=fT;function gT(t,e){return`${t}-trigger-${e}`}function xT(t,e){return`${t}-content-${e}`}var jH=cT,vT=uT,yT=mT,_T=pT;const es=jH,Hn=g.forwardRef(({className:t,...e},n)=>s.jsx(vT,{ref:n,className:Ie("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));Hn.displayName=vT.displayName;const He=g.forwardRef(({className:t,...e},n)=>s.jsx(yT,{ref:n,className:Ie("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));He.displayName=yT.displayName;const We=g.forwardRef(({className:t,...e},n)=>s.jsx(_T,{ref:n,className:Ie("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));We.displayName=_T.displayName;function ft({className:t,...e}){return s.jsx("div",{className:Ie("animate-pulse rounded-md bg-muted",t),...e})}var Jt;(function(t){t.assertEqual=a=>a;function e(a){}t.assertIs=e;function n(a){throw new Error}t.assertNever=n,t.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},t.getValidEnumValues=a=>{const i=t.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),o={};for(const c of i)o[c]=a[c];return t.objectValues(o)},t.objectValues=a=>t.objectKeys(a).map(function(i){return a[i]}),t.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},t.find=(a,i)=>{for(const o of a)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function r(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Jt||(Jt={}));var Cw;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(Cw||(Cw={}));const Ye=Jt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),to=t=>{switch(typeof t){case"undefined":return Ye.undefined;case"string":return Ye.string;case"number":return isNaN(t)?Ye.nan:Ye.number;case"boolean":return Ye.boolean;case"function":return Ye.function;case"bigint":return Ye.bigint;case"symbol":return Ye.symbol;case"object":return Array.isArray(t)?Ye.array:t===null?Ye.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Ye.promise:typeof Map<"u"&&t instanceof Map?Ye.map:typeof Set<"u"&&t instanceof Set?Ye.set:typeof Date<"u"&&t instanceof Date?Ye.date:Ye.object;default:return Ye.unknown}},Re=Jt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),NH=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class xr extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let c=r,d=0;for(;d<o.path.length;){const u=o.path[d];d===o.path.length-1?(c[u]=c[u]||{_errors:[]},c[u]._errors.push(n(o))):c[u]=c[u]||{_errors:[]},c=c[u],d++}}};return a(this),r}static assert(e){if(!(e instanceof xr))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Jt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const a of this.issues)a.path.length>0?(n[a.path[0]]=n[a.path[0]]||[],n[a.path[0]].push(e(a))):r.push(e(a));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}xr.create=t=>new xr(t);const Ld=(t,e)=>{let n;switch(t.code){case Re.invalid_type:t.received===Ye.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Re.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Jt.jsonStringifyReplacer)}`;break;case Re.unrecognized_keys:n=`Unrecognized key(s) in object: ${Jt.joinValues(t.keys,", ")}`;break;case Re.invalid_union:n="Invalid input";break;case Re.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Jt.joinValues(t.options)}`;break;case Re.invalid_enum_value:n=`Invalid enum value. Expected ${Jt.joinValues(t.options)}, received '${t.received}'`;break;case Re.invalid_arguments:n="Invalid function arguments";break;case Re.invalid_return_type:n="Invalid function return type";break;case Re.invalid_date:n="Invalid date";break;case Re.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Jt.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Re.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Re.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Re.custom:n="Invalid input";break;case Re.invalid_intersection_types:n="Intersection results could not be merged";break;case Re.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Re.not_finite:n="Number must be finite";break;default:n=e.defaultError,Jt.assertNever(t)}return{message:n}};let wT=Ld;function SH(t){wT=t}function j0(){return wT}const N0=t=>{const{data:e,path:n,errorMaps:r,issueData:a}=t,i=[...n,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let c="";const d=r.filter(u=>!!u).slice().reverse();for(const u of d)c=u(o,{data:e,defaultError:c}).message;return{...a,path:i,message:c}},kH=[];function Ke(t,e){const n=j0(),r=N0({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Ld?void 0:Ld].filter(a=>!!a)});t.common.issues.push(r)}class Ts{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const a of n){if(a.status==="aborted")return Ct;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const a of n){const i=await a.key,o=await a.value;r.push({key:i,value:o})}return Ts.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const a of n){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return Ct;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const Ct=Object.freeze({status:"aborted"}),Xc=t=>({status:"dirty",value:t}),zs=t=>({status:"valid",value:t}),Ew=t=>t.status==="aborted",Aw=t=>t.status==="dirty",Zh=t=>t.status==="valid",Gh=t=>typeof Promise<"u"&&t instanceof Promise;function S0(t,e,n,r){if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function bT(t,e,n,r,a){if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var it;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(it||(it={}));var zu,$u;class Xa{constructor(e,n,r,a){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const mk=(t,e)=>{if(Zh(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new xr(t.common.issues);return this._error=n,this._error}}};function Mt(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:a}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(o,c)=>{var d,u;const{message:m}=t;return o.code==="invalid_enum_value"?{message:m??c.defaultError}:typeof c.data>"u"?{message:(d=m??r)!==null&&d!==void 0?d:c.defaultError}:o.code!=="invalid_type"?{message:c.defaultError}:{message:(u=m??n)!==null&&u!==void 0?u:c.defaultError}},description:a}}class Bt{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return to(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:to(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ts,ctx:{common:e.parent.common,data:e.data,parsedType:to(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Gh(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const a={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:to(e)},i=this._parseSync({data:e,path:a.path,parent:a});return mk(a,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:to(e)},a=this._parse({data:e,path:r.path,parent:r}),i=await(Gh(a)?a:Promise.resolve(a));return mk(r,i)}refine(e,n){const r=a=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(a):n;return this._refinement((a,i)=>{const o=e(a),c=()=>i.addIssue({code:Re.custom,...r(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(d=>d?!0:(c(),!1)):o?!0:(c(),!1)})}refinement(e,n){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof n=="function"?n(r,a):n),!1))}_refinement(e){return new ya({schema:this,typeName:bt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Ka.create(this,this._def)}nullable(){return Fo.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ma.create(this,this._def)}promise(){return Bd.create(this,this._def)}or(e){return Jh.create([this,e],this._def)}and(e){return em.create(this,e,this._def)}transform(e){return new ya({...Mt(this._def),schema:this,typeName:bt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new am({...Mt(this._def),innerType:this,defaultValue:n,typeName:bt.ZodDefault})}brand(){return new Tj({typeName:bt.ZodBranded,type:this,...Mt(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new im({...Mt(this._def),innerType:this,catchValue:n,typeName:bt.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Om.create(this,e)}readonly(){return om.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const CH=/^c[^\s-]{8,}$/i,EH=/^[0-9a-z]+$/,AH=/^[0-9A-HJKMNP-TV-Z]{26}$/,PH=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,DH=/^[a-z0-9_-]{21}$/i,TH=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,MH=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,RH="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Pv;const IH=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,OH=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,LH=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,jT="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",FH=new RegExp(`^${jT}$`);function NT(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function BH(t){return new RegExp(`^${NT(t)}$`)}function ST(t){let e=`${jT}T${NT(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function zH(t,e){return!!((e==="v4"||!e)&&IH.test(t)||(e==="v6"||!e)&&OH.test(t))}class da extends Bt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Ye.string){const i=this._getOrReturnCtx(e);return Ke(i,{code:Re.invalid_type,expected:Ye.string,received:i.parsedType}),Ct}const r=new Ts;let a;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),Ke(a,{code:Re.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),Ke(a,{code:Re.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,c=e.data.length<i.value;(o||c)&&(a=this._getOrReturnCtx(e,a),o?Ke(a,{code:Re.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&Ke(a,{code:Re.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")MH.test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{validation:"email",code:Re.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Pv||(Pv=new RegExp(RH,"u")),Pv.test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{validation:"emoji",code:Re.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")PH.test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{validation:"uuid",code:Re.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")DH.test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{validation:"nanoid",code:Re.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")CH.test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{validation:"cuid",code:Re.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")EH.test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{validation:"cuid2",code:Re.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")AH.test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{validation:"ulid",code:Re.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),Ke(a,{validation:"url",code:Re.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{validation:"regex",code:Re.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),Ke(a,{code:Re.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),Ke(a,{code:Re.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),Ke(a,{code:Re.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?ST(i).test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{code:Re.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?FH.test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{code:Re.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?BH(i).test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{code:Re.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?TH.test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{validation:"duration",code:Re.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?zH(e.data,i.version)||(a=this._getOrReturnCtx(e,a),Ke(a,{validation:"ip",code:Re.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?LH.test(e.data)||(a=this._getOrReturnCtx(e,a),Ke(a,{validation:"base64",code:Re.invalid_string,message:i.message}),r.dirty()):Jt.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(a=>e.test(a),{validation:n,code:Re.invalid_string,...it.errToObj(r)})}_addCheck(e){return new da({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...it.errToObj(e)})}url(e){return this._addCheck({kind:"url",...it.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...it.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...it.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...it.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...it.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...it.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...it.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...it.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...it.errToObj(e)})}datetime(e){var n,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...it.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...it.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...it.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...it.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...it.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...it.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...it.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...it.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...it.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...it.errToObj(n)})}nonempty(e){return this.min(1,it.errToObj(e))}trim(){return new da({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new da({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new da({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}da.create=t=>{var e;return new da({checks:[],typeName:bt.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Mt(t)})};function $H(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=n>r?n:r,i=parseInt(t.toFixed(a).replace(".","")),o=parseInt(e.toFixed(a).replace(".",""));return i%o/Math.pow(10,a)}class Io extends Bt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Ye.number){const i=this._getOrReturnCtx(e);return Ke(i,{code:Re.invalid_type,expected:Ye.number,received:i.parsedType}),Ct}let r;const a=new Ts;for(const i of this._def.checks)i.kind==="int"?Jt.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Ke(r,{code:Re.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:Re.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:Re.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?$H(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:Re.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Ke(r,{code:Re.not_finite,message:i.message}),a.dirty()):Jt.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,it.toString(n))}gt(e,n){return this.setLimit("min",e,!1,it.toString(n))}lte(e,n){return this.setLimit("max",e,!0,it.toString(n))}lt(e,n){return this.setLimit("max",e,!1,it.toString(n))}setLimit(e,n,r,a){return new Io({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:it.toString(a)}]})}_addCheck(e){return new Io({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:it.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:it.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:it.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:it.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:it.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:it.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:it.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:it.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:it.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Jt.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Io.create=t=>new Io({checks:[],typeName:bt.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Mt(t)});class Oo extends Bt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==Ye.bigint){const i=this._getOrReturnCtx(e);return Ke(i,{code:Re.invalid_type,expected:Ye.bigint,received:i.parsedType}),Ct}let r;const a=new Ts;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:Re.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:Re.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Ke(r,{code:Re.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Jt.assertNever(i);return{status:a.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,it.toString(n))}gt(e,n){return this.setLimit("min",e,!1,it.toString(n))}lte(e,n){return this.setLimit("max",e,!0,it.toString(n))}lt(e,n){return this.setLimit("max",e,!1,it.toString(n))}setLimit(e,n,r,a){return new Oo({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:it.toString(a)}]})}_addCheck(e){return new Oo({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:it.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:it.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:it.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:it.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:it.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Oo.create=t=>{var e;return new Oo({checks:[],typeName:bt.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Mt(t)})};class Qh extends Bt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Ye.boolean){const r=this._getOrReturnCtx(e);return Ke(r,{code:Re.invalid_type,expected:Ye.boolean,received:r.parsedType}),Ct}return zs(e.data)}}Qh.create=t=>new Qh({typeName:bt.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Mt(t)});class Hl extends Bt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Ye.date){const i=this._getOrReturnCtx(e);return Ke(i,{code:Re.invalid_type,expected:Ye.date,received:i.parsedType}),Ct}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Ke(i,{code:Re.invalid_date}),Ct}const r=new Ts;let a;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(a=this._getOrReturnCtx(e,a),Ke(a,{code:Re.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(a=this._getOrReturnCtx(e,a),Ke(a,{code:Re.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Jt.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Hl({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:it.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:it.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Hl.create=t=>new Hl({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:bt.ZodDate,...Mt(t)});class k0 extends Bt{_parse(e){if(this._getType(e)!==Ye.symbol){const r=this._getOrReturnCtx(e);return Ke(r,{code:Re.invalid_type,expected:Ye.symbol,received:r.parsedType}),Ct}return zs(e.data)}}k0.create=t=>new k0({typeName:bt.ZodSymbol,...Mt(t)});class Yh extends Bt{_parse(e){if(this._getType(e)!==Ye.undefined){const r=this._getOrReturnCtx(e);return Ke(r,{code:Re.invalid_type,expected:Ye.undefined,received:r.parsedType}),Ct}return zs(e.data)}}Yh.create=t=>new Yh({typeName:bt.ZodUndefined,...Mt(t)});class Xh extends Bt{_parse(e){if(this._getType(e)!==Ye.null){const r=this._getOrReturnCtx(e);return Ke(r,{code:Re.invalid_type,expected:Ye.null,received:r.parsedType}),Ct}return zs(e.data)}}Xh.create=t=>new Xh({typeName:bt.ZodNull,...Mt(t)});class Fd extends Bt{constructor(){super(...arguments),this._any=!0}_parse(e){return zs(e.data)}}Fd.create=t=>new Fd({typeName:bt.ZodAny,...Mt(t)});class Dl extends Bt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return zs(e.data)}}Dl.create=t=>new Dl({typeName:bt.ZodUnknown,...Mt(t)});class Di extends Bt{_parse(e){const n=this._getOrReturnCtx(e);return Ke(n,{code:Re.invalid_type,expected:Ye.never,received:n.parsedType}),Ct}}Di.create=t=>new Di({typeName:bt.ZodNever,...Mt(t)});class C0 extends Bt{_parse(e){if(this._getType(e)!==Ye.undefined){const r=this._getOrReturnCtx(e);return Ke(r,{code:Re.invalid_type,expected:Ye.void,received:r.parsedType}),Ct}return zs(e.data)}}C0.create=t=>new C0({typeName:bt.ZodVoid,...Mt(t)});class ma extends Bt{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),a=this._def;if(n.parsedType!==Ye.array)return Ke(n,{code:Re.invalid_type,expected:Ye.array,received:n.parsedType}),Ct;if(a.exactLength!==null){const o=n.data.length>a.exactLength.value,c=n.data.length<a.exactLength.value;(o||c)&&(Ke(n,{code:o?Re.too_big:Re.too_small,minimum:c?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&n.data.length<a.minLength.value&&(Ke(n,{code:Re.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&n.data.length>a.maxLength.value&&(Ke(n,{code:Re.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,c)=>a.type._parseAsync(new Xa(n,o,n.path,c)))).then(o=>Ts.mergeArray(r,o));const i=[...n.data].map((o,c)=>a.type._parseSync(new Xa(n,o,n.path,c)));return Ts.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new ma({...this._def,minLength:{value:e,message:it.toString(n)}})}max(e,n){return new ma({...this._def,maxLength:{value:e,message:it.toString(n)}})}length(e,n){return new ma({...this._def,exactLength:{value:e,message:it.toString(n)}})}nonempty(e){return this.min(1,e)}}ma.create=(t,e)=>new ma({type:t,minLength:null,maxLength:null,exactLength:null,typeName:bt.ZodArray,...Mt(e)});function Ic(t){if(t instanceof Sn){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Ka.create(Ic(r))}return new Sn({...t._def,shape:()=>e})}else return t instanceof ma?new ma({...t._def,type:Ic(t.element)}):t instanceof Ka?Ka.create(Ic(t.unwrap())):t instanceof Fo?Fo.create(Ic(t.unwrap())):t instanceof Ja?Ja.create(t.items.map(e=>Ic(e))):t}class Sn extends Bt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Jt.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==Ye.object){const u=this._getOrReturnCtx(e);return Ke(u,{code:Re.invalid_type,expected:Ye.object,received:u.parsedType}),Ct}const{status:r,ctx:a}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),c=[];if(!(this._def.catchall instanceof Di&&this._def.unknownKeys==="strip"))for(const u in a.data)o.includes(u)||c.push(u);const d=[];for(const u of o){const m=i[u],f=a.data[u];d.push({key:{status:"valid",value:u},value:m._parse(new Xa(a,f,a.path,u)),alwaysSet:u in a.data})}if(this._def.catchall instanceof Di){const u=this._def.unknownKeys;if(u==="passthrough")for(const m of c)d.push({key:{status:"valid",value:m},value:{status:"valid",value:a.data[m]}});else if(u==="strict")c.length>0&&(Ke(a,{code:Re.unrecognized_keys,keys:c}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const m of c){const f=a.data[m];d.push({key:{status:"valid",value:m},value:u._parse(new Xa(a,f,a.path,m)),alwaysSet:m in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const u=[];for(const m of d){const f=await m.key,p=await m.value;u.push({key:f,value:p,alwaysSet:m.alwaysSet})}return u}).then(u=>Ts.mergeObjectSync(r,u)):Ts.mergeObjectSync(r,d)}get shape(){return this._def.shape()}strict(e){return it.errToObj,new Sn({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var a,i,o,c;const d=(o=(i=(a=this._def).errorMap)===null||i===void 0?void 0:i.call(a,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(c=it.errToObj(e).message)!==null&&c!==void 0?c:d}:{message:d}}}:{}})}strip(){return new Sn({...this._def,unknownKeys:"strip"})}passthrough(){return new Sn({...this._def,unknownKeys:"passthrough"})}extend(e){return new Sn({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Sn({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:bt.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Sn({...this._def,catchall:e})}pick(e){const n={};return Jt.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Sn({...this._def,shape:()=>n})}omit(e){const n={};return Jt.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new Sn({...this._def,shape:()=>n})}deepPartial(){return Ic(this)}partial(e){const n={};return Jt.objectKeys(this.shape).forEach(r=>{const a=this.shape[r];e&&!e[r]?n[r]=a:n[r]=a.optional()}),new Sn({...this._def,shape:()=>n})}required(e){const n={};return Jt.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Ka;)i=i._def.innerType;n[r]=i}}),new Sn({...this._def,shape:()=>n})}keyof(){return kT(Jt.objectKeys(this.shape))}}Sn.create=(t,e)=>new Sn({shape:()=>t,unknownKeys:"strip",catchall:Di.create(),typeName:bt.ZodObject,...Mt(e)});Sn.strictCreate=(t,e)=>new Sn({shape:()=>t,unknownKeys:"strict",catchall:Di.create(),typeName:bt.ZodObject,...Mt(e)});Sn.lazycreate=(t,e)=>new Sn({shape:t,unknownKeys:"strip",catchall:Di.create(),typeName:bt.ZodObject,...Mt(e)});class Jh extends Bt{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function a(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return n.common.issues.push(...c.ctx.common.issues),c.result;const o=i.map(c=>new xr(c.ctx.common.issues));return Ke(n,{code:Re.invalid_union,unionErrors:o}),Ct}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const d of r){const u={...n,common:{...n.common,issues:[]},parent:null},m=d._parseSync({data:n.data,path:n.path,parent:u});if(m.status==="valid")return m;m.status==="dirty"&&!i&&(i={result:m,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const c=o.map(d=>new xr(d));return Ke(n,{code:Re.invalid_union,unionErrors:c}),Ct}}get options(){return this._def.options}}Jh.create=(t,e)=>new Jh({options:t,typeName:bt.ZodUnion,...Mt(e)});const hi=t=>t instanceof nm?hi(t.schema):t instanceof ya?hi(t.innerType()):t instanceof sm?[t.value]:t instanceof Lo?t.options:t instanceof rm?Jt.objectValues(t.enum):t instanceof am?hi(t._def.innerType):t instanceof Yh?[void 0]:t instanceof Xh?[null]:t instanceof Ka?[void 0,...hi(t.unwrap())]:t instanceof Fo?[null,...hi(t.unwrap())]:t instanceof Tj||t instanceof om?hi(t.unwrap()):t instanceof im?hi(t._def.innerType):[];class zg extends Bt{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Ye.object)return Ke(n,{code:Re.invalid_type,expected:Ye.object,received:n.parsedType}),Ct;const r=this.discriminator,a=n.data[r],i=this.optionsMap.get(a);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(Ke(n,{code:Re.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Ct)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const a=new Map;for(const i of n){const o=hi(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const c of o){if(a.has(c))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(c)}`);a.set(c,i)}}return new zg({typeName:bt.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:a,...Mt(r)})}}function Pw(t,e){const n=to(t),r=to(e);if(t===e)return{valid:!0,data:t};if(n===Ye.object&&r===Ye.object){const a=Jt.objectKeys(e),i=Jt.objectKeys(t).filter(c=>a.indexOf(c)!==-1),o={...t,...e};for(const c of i){const d=Pw(t[c],e[c]);if(!d.valid)return{valid:!1};o[c]=d.data}return{valid:!0,data:o}}else if(n===Ye.array&&r===Ye.array){if(t.length!==e.length)return{valid:!1};const a=[];for(let i=0;i<t.length;i++){const o=t[i],c=e[i],d=Pw(o,c);if(!d.valid)return{valid:!1};a.push(d.data)}return{valid:!0,data:a}}else return n===Ye.date&&r===Ye.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class em extends Bt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=(i,o)=>{if(Ew(i)||Ew(o))return Ct;const c=Pw(i.value,o.value);return c.valid?((Aw(i)||Aw(o))&&n.dirty(),{status:n.value,value:c.data}):(Ke(r,{code:Re.invalid_intersection_types}),Ct)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}em.create=(t,e,n)=>new em({left:t,right:e,typeName:bt.ZodIntersection,...Mt(n)});class Ja extends Bt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ye.array)return Ke(r,{code:Re.invalid_type,expected:Ye.array,received:r.parsedType}),Ct;if(r.data.length<this._def.items.length)return Ke(r,{code:Re.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ct;!this._def.rest&&r.data.length>this._def.items.length&&(Ke(r,{code:Re.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new Xa(r,o,r.path,c)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>Ts.mergeArray(n,o)):Ts.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Ja({...this._def,rest:e})}}Ja.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ja({items:t,typeName:bt.ZodTuple,rest:null,...Mt(e)})};class tm extends Bt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ye.object)return Ke(r,{code:Re.invalid_type,expected:Ye.object,received:r.parsedType}),Ct;const a=[],i=this._def.keyType,o=this._def.valueType;for(const c in r.data)a.push({key:i._parse(new Xa(r,c,r.path,c)),value:o._parse(new Xa(r,r.data[c],r.path,c)),alwaysSet:c in r.data});return r.common.async?Ts.mergeObjectAsync(n,a):Ts.mergeObjectSync(n,a)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof Bt?new tm({keyType:e,valueType:n,typeName:bt.ZodRecord,...Mt(r)}):new tm({keyType:da.create(),valueType:e,typeName:bt.ZodRecord,...Mt(n)})}}class E0 extends Bt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ye.map)return Ke(r,{code:Re.invalid_type,expected:Ye.map,received:r.parsedType}),Ct;const a=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([c,d],u)=>({key:a._parse(new Xa(r,c,r.path,[u,"key"])),value:i._parse(new Xa(r,d,r.path,[u,"value"]))}));if(r.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of o){const u=await d.key,m=await d.value;if(u.status==="aborted"||m.status==="aborted")return Ct;(u.status==="dirty"||m.status==="dirty")&&n.dirty(),c.set(u.value,m.value)}return{status:n.value,value:c}})}else{const c=new Map;for(const d of o){const u=d.key,m=d.value;if(u.status==="aborted"||m.status==="aborted")return Ct;(u.status==="dirty"||m.status==="dirty")&&n.dirty(),c.set(u.value,m.value)}return{status:n.value,value:c}}}}E0.create=(t,e,n)=>new E0({valueType:e,keyType:t,typeName:bt.ZodMap,...Mt(n)});class Wl extends Bt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Ye.set)return Ke(r,{code:Re.invalid_type,expected:Ye.set,received:r.parsedType}),Ct;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(Ke(r,{code:Re.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),n.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(Ke(r,{code:Re.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),n.dirty());const i=this._def.valueType;function o(d){const u=new Set;for(const m of d){if(m.status==="aborted")return Ct;m.status==="dirty"&&n.dirty(),u.add(m.value)}return{status:n.value,value:u}}const c=[...r.data.values()].map((d,u)=>i._parse(new Xa(r,d,r.path,u)));return r.common.async?Promise.all(c).then(d=>o(d)):o(c)}min(e,n){return new Wl({...this._def,minSize:{value:e,message:it.toString(n)}})}max(e,n){return new Wl({...this._def,maxSize:{value:e,message:it.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Wl.create=(t,e)=>new Wl({valueType:t,minSize:null,maxSize:null,typeName:bt.ZodSet,...Mt(e)});class dd extends Bt{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Ye.function)return Ke(n,{code:Re.invalid_type,expected:Ye.function,received:n.parsedType}),Ct;function r(c,d){return N0({data:c,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,j0(),Ld].filter(u=>!!u),issueData:{code:Re.invalid_arguments,argumentsError:d}})}function a(c,d){return N0({data:c,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,j0(),Ld].filter(u=>!!u),issueData:{code:Re.invalid_return_type,returnTypeError:d}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof Bd){const c=this;return zs(async function(...d){const u=new xr([]),m=await c._def.args.parseAsync(d,i).catch(v=>{throw u.addIssue(r(d,v)),u}),f=await Reflect.apply(o,this,m);return await c._def.returns._def.type.parseAsync(f,i).catch(v=>{throw u.addIssue(a(f,v)),u})})}else{const c=this;return zs(function(...d){const u=c._def.args.safeParse(d,i);if(!u.success)throw new xr([r(d,u.error)]);const m=Reflect.apply(o,this,u.data),f=c._def.returns.safeParse(m,i);if(!f.success)throw new xr([a(m,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new dd({...this._def,args:Ja.create(e).rest(Dl.create())})}returns(e){return new dd({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new dd({args:e||Ja.create([]).rest(Dl.create()),returns:n||Dl.create(),typeName:bt.ZodFunction,...Mt(r)})}}class nm extends Bt{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}nm.create=(t,e)=>new nm({getter:t,typeName:bt.ZodLazy,...Mt(e)});class sm extends Bt{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return Ke(n,{received:n.data,code:Re.invalid_literal,expected:this._def.value}),Ct}return{status:"valid",value:e.data}}get value(){return this._def.value}}sm.create=(t,e)=>new sm({value:t,typeName:bt.ZodLiteral,...Mt(e)});function kT(t,e){return new Lo({values:t,typeName:bt.ZodEnum,...Mt(e)})}class Lo extends Bt{constructor(){super(...arguments),zu.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return Ke(n,{expected:Jt.joinValues(r),received:n.parsedType,code:Re.invalid_type}),Ct}if(S0(this,zu)||bT(this,zu,new Set(this._def.values)),!S0(this,zu).has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return Ke(n,{received:n.data,code:Re.invalid_enum_value,options:r}),Ct}return zs(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Lo.create(e,{...this._def,...n})}exclude(e,n=this._def){return Lo.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}zu=new WeakMap;Lo.create=kT;class rm extends Bt{constructor(){super(...arguments),$u.set(this,void 0)}_parse(e){const n=Jt.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Ye.string&&r.parsedType!==Ye.number){const a=Jt.objectValues(n);return Ke(r,{expected:Jt.joinValues(a),received:r.parsedType,code:Re.invalid_type}),Ct}if(S0(this,$u)||bT(this,$u,new Set(Jt.getValidEnumValues(this._def.values))),!S0(this,$u).has(e.data)){const a=Jt.objectValues(n);return Ke(r,{received:r.data,code:Re.invalid_enum_value,options:a}),Ct}return zs(e.data)}get enum(){return this._def.values}}$u=new WeakMap;rm.create=(t,e)=>new rm({values:t,typeName:bt.ZodNativeEnum,...Mt(e)});class Bd extends Bt{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Ye.promise&&n.common.async===!1)return Ke(n,{code:Re.invalid_type,expected:Ye.promise,received:n.parsedType}),Ct;const r=n.parsedType===Ye.promise?n.data:Promise.resolve(n.data);return zs(r.then(a=>this._def.type.parseAsync(a,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Bd.create=(t,e)=>new Bd({type:t,typeName:bt.ZodPromise,...Mt(e)});class ya extends Bt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===bt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:o=>{Ke(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(r.data,i);if(r.common.async)return Promise.resolve(o).then(async c=>{if(n.value==="aborted")return Ct;const d=await this._def.schema._parseAsync({data:c,path:r.path,parent:r});return d.status==="aborted"?Ct:d.status==="dirty"||n.value==="dirty"?Xc(d.value):d});{if(n.value==="aborted")return Ct;const c=this._def.schema._parseSync({data:o,path:r.path,parent:r});return c.status==="aborted"?Ct:c.status==="dirty"||n.value==="dirty"?Xc(c.value):c}}if(a.type==="refinement"){const o=c=>{const d=a.refinement(c,i);if(r.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(r.common.async===!1){const c=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return c.status==="aborted"?Ct:(c.status==="dirty"&&n.dirty(),o(c.value),{status:n.value,value:c.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(c=>c.status==="aborted"?Ct:(c.status==="dirty"&&n.dirty(),o(c.value).then(()=>({status:n.value,value:c.value}))))}if(a.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Zh(o))return o;const c=a.transform(o.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:c}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Zh(o)?Promise.resolve(a.transform(o.value,i)).then(c=>({status:n.value,value:c})):o);Jt.assertNever(a)}}ya.create=(t,e,n)=>new ya({schema:t,typeName:bt.ZodEffects,effect:e,...Mt(n)});ya.createWithPreprocess=(t,e,n)=>new ya({schema:e,effect:{type:"preprocess",transform:t},typeName:bt.ZodEffects,...Mt(n)});class Ka extends Bt{_parse(e){return this._getType(e)===Ye.undefined?zs(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ka.create=(t,e)=>new Ka({innerType:t,typeName:bt.ZodOptional,...Mt(e)});class Fo extends Bt{_parse(e){return this._getType(e)===Ye.null?zs(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Fo.create=(t,e)=>new Fo({innerType:t,typeName:bt.ZodNullable,...Mt(e)});class am extends Bt{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===Ye.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}am.create=(t,e)=>new am({innerType:t,typeName:bt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Mt(e)});class im extends Bt{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Gh(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new xr(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new xr(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}im.create=(t,e)=>new im({innerType:t,typeName:bt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Mt(e)});class A0 extends Bt{_parse(e){if(this._getType(e)!==Ye.nan){const r=this._getOrReturnCtx(e);return Ke(r,{code:Re.invalid_type,expected:Ye.nan,received:r.parsedType}),Ct}return{status:"valid",value:e.data}}}A0.create=t=>new A0({typeName:bt.ZodNaN,...Mt(t)});const UH=Symbol("zod_brand");class Tj extends Bt{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Om extends Bt{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?Ct:i.status==="dirty"?(n.dirty(),Xc(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Ct:a.status==="dirty"?(n.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,n){return new Om({in:e,out:n,typeName:bt.ZodPipeline})}}class om extends Bt{_parse(e){const n=this._def.innerType._parse(e),r=a=>(Zh(a)&&(a.value=Object.freeze(a.value)),a);return Gh(n)?n.then(a=>r(a)):r(n)}unwrap(){return this._def.innerType}}om.create=(t,e)=>new om({innerType:t,typeName:bt.ZodReadonly,...Mt(e)});function CT(t,e={},n){return t?Fd.create().superRefine((r,a)=>{var i,o;if(!t(r)){const c=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,d=(o=(i=c.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,u=typeof c=="string"?{message:c}:c;a.addIssue({code:"custom",...u,fatal:d})}}):Fd.create()}const qH={object:Sn.lazycreate};var bt;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(bt||(bt={}));const HH=(t,e={message:`Input not instance of ${t.name}`})=>CT(n=>n instanceof t,e),ET=da.create,AT=Io.create,WH=A0.create,VH=Oo.create,PT=Qh.create,KH=Hl.create,ZH=k0.create,GH=Yh.create,QH=Xh.create,YH=Fd.create,XH=Dl.create,JH=Di.create,eW=C0.create,tW=ma.create,nW=Sn.create,sW=Sn.strictCreate,rW=Jh.create,aW=zg.create,iW=em.create,oW=Ja.create,lW=tm.create,cW=E0.create,dW=Wl.create,uW=dd.create,hW=nm.create,mW=sm.create,fW=Lo.create,pW=rm.create,gW=Bd.create,fk=ya.create,xW=Ka.create,vW=Fo.create,yW=ya.createWithPreprocess,_W=Om.create,wW=()=>ET().optional(),bW=()=>AT().optional(),jW=()=>PT().optional(),NW={string:t=>da.create({...t,coerce:!0}),number:t=>Io.create({...t,coerce:!0}),boolean:t=>Qh.create({...t,coerce:!0}),bigint:t=>Oo.create({...t,coerce:!0}),date:t=>Hl.create({...t,coerce:!0})},SW=Ct;var A=Object.freeze({__proto__:null,defaultErrorMap:Ld,setErrorMap:SH,getErrorMap:j0,makeIssue:N0,EMPTY_PATH:kH,addIssueToContext:Ke,ParseStatus:Ts,INVALID:Ct,DIRTY:Xc,OK:zs,isAborted:Ew,isDirty:Aw,isValid:Zh,isAsync:Gh,get util(){return Jt},get objectUtil(){return Cw},ZodParsedType:Ye,getParsedType:to,ZodType:Bt,datetimeRegex:ST,ZodString:da,ZodNumber:Io,ZodBigInt:Oo,ZodBoolean:Qh,ZodDate:Hl,ZodSymbol:k0,ZodUndefined:Yh,ZodNull:Xh,ZodAny:Fd,ZodUnknown:Dl,ZodNever:Di,ZodVoid:C0,ZodArray:ma,ZodObject:Sn,ZodUnion:Jh,ZodDiscriminatedUnion:zg,ZodIntersection:em,ZodTuple:Ja,ZodRecord:tm,ZodMap:E0,ZodSet:Wl,ZodFunction:dd,ZodLazy:nm,ZodLiteral:sm,ZodEnum:Lo,ZodNativeEnum:rm,ZodPromise:Bd,ZodEffects:ya,ZodTransformer:ya,ZodOptional:Ka,ZodNullable:Fo,ZodDefault:am,ZodCatch:im,ZodNaN:A0,BRAND:UH,ZodBranded:Tj,ZodPipeline:Om,ZodReadonly:om,custom:CT,Schema:Bt,ZodSchema:Bt,late:qH,get ZodFirstPartyTypeKind(){return bt},coerce:NW,any:YH,array:tW,bigint:VH,boolean:PT,date:KH,discriminatedUnion:aW,effect:fk,enum:fW,function:uW,instanceof:HH,intersection:iW,lazy:hW,literal:mW,map:cW,nan:WH,nativeEnum:pW,never:JH,null:QH,nullable:vW,number:AT,object:nW,oboolean:jW,onumber:bW,optional:xW,ostring:wW,pipeline:_W,preprocess:yW,promise:gW,record:lW,set:dW,strictObject:sW,string:ET,symbol:ZH,transformer:fk,tuple:oW,undefined:GH,union:rW,unknown:XH,void:eW,NEVER:SW,ZodIssueCode:Re,quotelessJson:NH,ZodError:xr});const nt={UNAUTHORIZED:"UNAUTHORIZED",FORBIDDEN:"FORBIDDEN",INVALID_TOKEN:"INVALID_TOKEN",VALIDATION_ERROR:"VALIDATION_ERROR",INVALID_INPUT:"INVALID_INPUT",MISSING_REQUIRED_FIELD:"MISSING_REQUIRED_FIELD",RESOURCE_NOT_FOUND:"RESOURCE_NOT_FOUND",RESOURCE_ALREADY_EXISTS:"RESOURCE_ALREADY_EXISTS",BUSINESS_RULE_VIOLATION:"BUSINESS_RULE_VIOLATION",INSUFFICIENT_PERMISSIONS:"INSUFFICIENT_PERMISSIONS",IMMUTABLE_RECORD:"IMMUTABLE_RECORD",AUDIT_REQUIRED:"AUDIT_REQUIRED",DOCUMENT_LOCKED:"DOCUMENT_LOCKED",RETENTION_PERIOD_ACTIVE:"RETENTION_PERIOD_ACTIVE",INTERNAL_ERROR:"INTERNAL_ERROR",DATABASE_ERROR:"DATABASE_ERROR",NETWORK_ERROR:"NETWORK_ERROR",SERVICE_UNAVAILABLE:"SERVICE_UNAVAILABLE",RATE_LIMIT_EXCEEDED:"RATE_LIMIT_EXCEEDED"};let et=class extends Error{constructor(e,n,r,a=400){super(n),this.code=e,this.details=r,this.statusCode=a,this.name="ApiError"}};const DT=()=>`req_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,vr=(t,e,n)=>{try{return t.parse(e)}catch(r){throw r instanceof A.ZodError?new et(nt.VALIDATION_ERROR,"Input validation failed",{validationErrors:r.errors,receivedData:e}):r}},xh=t=>{throw console.error("Supabase error:",t),t.code==="PGRST116"?new et(nt.FORBIDDEN,"Insufficient permissions to access this resource",{supabaseCode:t.code}):t.code==="23505"?new et(nt.RESOURCE_ALREADY_EXISTS,"Resource already exists",{supabaseCode:t.code,constraint:t.constraint}):t.code==="23503"?new et(nt.BUSINESS_RULE_VIOLATION,"Referenced resource does not exist",{supabaseCode:t.code,constraint:t.constraint}):new et(nt.DATABASE_ERROR,t.message||"Database operation failed",{supabaseError:t})};async function Ue(t,e){const n=DT();try{console.log(`[${n}] Starting API operation: ${e||"Unknown"}`);const r=await t();return console.log(`[${n}] API operation completed successfully`),r}catch(r){throw console.error(`[${n}] API operation failed:`,r),r instanceof et?r:(r&&typeof r=="object"&&"code"in r&&xh(r),new et(nt.INTERNAL_ERROR,r instanceof Error?r.message:"Unknown error occurred",{requestId:n,originalError:r}))}}class kW{constructor(e){fs(this,"query");fs(this,"requestId");this.query=e,this.requestId=DT()}async execute(){return Ue(async()=>{const{data:e,error:n}=await this.query;return n&&xh(n),e||[]},`Query execution [${this.requestId}]`)}async executeSingle(){return Ue(async()=>{const{data:e,error:n}=await this.query.single();if(n){if(n.code==="PGRST116")throw new et(nt.RESOURCE_NOT_FOUND,"Resource not found");xh(n)}return e},`Single query execution [${this.requestId}]`)}async executeWithCount(){return Ue(async()=>{const{data:e,error:n,count:r}=await this.query;return n&&xh(n),{data:e||[],count:r||0}},`Query with count execution [${this.requestId}]`)}}const rt=t=>new kW(t),CW=async()=>Ue(async()=>{const{data:{user:t},error:e}=await K.auth.getUser();if(e)throw new et(nt.UNAUTHORIZED,"Authentication required");if(!t)throw new et(nt.UNAUTHORIZED,"User not authenticated");return t},"Get current user"),la=async()=>Ue(async()=>{const t=await CW(),{data:e,error:n}=await K.from("profiles").select("*").eq("id",t.id).single();return n&&xh(n),e},"Get current user profile"),ti=A.object({id:A.string().uuid(),created_at:A.string().datetime(),updated_at:A.string().datetime(),company_id:A.string().uuid().optional()}),Mj=A.object({company_name:A.string().min(1,"Firmenname ist erforderlich"),contact_person:A.string().min(1,"Ansprechpartner ist erforderlich"),email:A.string().email("Gültige E-Mail-Adresse erforderlich"),phone:A.string().optional(),address:A.string().optional(),city:A.string().optional(),postal_code:A.string().optional(),country:A.string().default("Deutschland"),tax_number:A.string().optional(),customer_number:A.string().optional(),status:A.enum(["Aktiv","Premium","Inaktiv"]).default("Aktiv")}),EW=Mj.partial();ti.merge(Mj).extend({customer_number:A.string().nullable()});const TT=A.object({name:A.string().min(1,"Materialname ist erforderlich"),sku:A.string().optional(),description:A.string().optional(),unit:A.string().default("Stk"),unit_price:A.number().min(0,"Preis muss positiv sein").default(0),stock:A.number().int().min(0,"Lagerbestand muss positiv sein").default(0),reorder_min:A.number().int().min(0,"Mindestbestand muss positiv sein").default(0),category:A.string().optional(),supplier:A.string().optional()});TT.partial();ti.merge(TT);const AW=A.object({id:A.string().optional(),description:A.string().min(1,"Beschreibung ist erforderlich"),quantity:A.number().min(.01,"Menge muss größer als 0 sein"),unit:A.string().default("Stk"),unit_price:A.number().min(0,"Preis muss positiv sein"),total_price:A.number().min(0,"Gesamtpreis muss positiv sein")}),Rj=A.object({customer_id:A.string().uuid("Kunde ist erforderlich"),title:A.string().min(1,"Titel ist erforderlich"),description:A.string().optional(),body:A.object({items:A.array(AW).min(1,"Mindestens ein Posten erforderlich"),notes:A.string().optional(),terms:A.string().optional()}),tax_rate:A.number().min(0).max(100).default(19),valid_until:A.string().date().optional()}),PW=Rj.partial().extend({status:A.enum(["draft","sent","accepted","rejected","expired"]).optional(),quote_number:A.string().optional()});ti.merge(Rj).extend({quote_number:A.string().nullable(),status:A.enum(["draft","sent","accepted","rejected","expired"]).default("draft"),total_net:A.number().optional(),total_gross:A.number().optional(),sent_at:A.string().datetime().optional(),accepted_at:A.string().datetime().optional()});const Ij=A.object({quote_id:A.string().uuid().optional(),customer_id:A.string().uuid("Kunde ist erforderlich"),title:A.string().min(1,"Titel ist erforderlich"),description:A.string().optional(),total_amount:A.number().min(0,"Betrag muss positiv sein")}),DW=Ij.partial().extend({status:A.enum(["open","in_progress","completed","cancelled"]).optional(),order_number:A.string().optional()});ti.merge(Ij).extend({order_number:A.string().nullable(),status:A.enum(["open","in_progress","completed","cancelled"]).default("open")});const Oj=A.object({order_id:A.string().uuid().optional(),customer_id:A.string().uuid().optional(),name:A.string().min(1,"Projektname ist erforderlich"),description:A.string().optional(),status:A.enum(["planned","active","blocked","completed","cancelled"]).default("planned"),budget:A.number().min(0,"Budget muss positiv sein").optional(),start_date:A.string().date().optional(),end_date:A.string().date().optional(),progress_percentage:A.number().min(0).max(100).default(0)}),TW=Oj.partial();ti.merge(Oj).extend({material_costs:A.number().default(0),labor_costs:A.number().default(0),hours_planned:A.number().optional(),hours_actual:A.number().default(0)});const Lj=A.object({project_id:A.string().uuid().optional(),customer_id:A.string().uuid("Kunde ist erforderlich"),title:A.string().min(1,"Titel ist erforderlich"),description:A.string().optional(),amount:A.number().min(0,"Betrag muss positiv sein"),tax_rate:A.number().min(0).max(100).default(19),due_date:A.string().date().optional()}),MW=Lj.partial().extend({status:A.enum(["draft","sent","paid","overdue","void","cancelled"]).optional(),invoice_number:A.string().optional()});ti.merge(Lj).extend({invoice_number:A.string().nullable(),status:A.enum(["draft","sent","paid","overdue","void","cancelled"]).default("draft"),net_amount:A.number().optional(),tax_amount:A.number().optional(),sent_at:A.string().datetime().optional(),paid_at:A.string().datetime().optional()});const Fj=A.object({project_id:A.string().uuid("Projekt ist erforderlich"),employee_id:A.string().uuid("Mitarbeiter ist erforderlich"),date:A.string().date("Gültiges Datum erforderlich"),start_time:A.string().time().optional(),end_time:A.string().time().optional(),break_minutes:A.number().int().min(0).default(0),hours:A.number().min(0,"Stunden müssen positiv sein"),description:A.string().optional(),task_category:A.string().default("general"),hourly_rate:A.number().min(0,"Stundensatz muss positiv sein").optional(),is_billable:A.boolean().default(!0)}),RW=Fj.partial().extend({approved_by:A.string().uuid().optional(),approved_at:A.string().datetime().optional()});ti.merge(Fj).extend({approved_by:A.string().uuid().optional(),approved_at:A.string().datetime().optional()});const Bj=A.object({project_id:A.string().uuid().optional(),employee_id:A.string().uuid().optional(),category:A.string().min(1,"Kategorie ist erforderlich"),amount:A.number().min(0,"Betrag muss positiv sein"),description:A.string().optional(),receipt_url:A.string().url().optional(),expense_date:A.string().date("Gültiges Datum erforderlich"),is_billable:A.boolean().default(!1)});Bj.partial().extend({approved_by:A.string().uuid().optional(),approved_at:A.string().datetime().optional()});ti.merge(Bj).extend({approved_by:A.string().uuid().optional(),approved_at:A.string().datetime().optional()});const IW=A.object({material_id:A.string().uuid("Material ist erforderlich"),project_id:A.string().uuid().optional(),quantity:A.number().int().refine(t=>t!==0,"Menge darf nicht 0 sein"),movement_type:A.enum(["issue","receive","adjust","return"]),reference_number:A.string().optional(),notes:A.string().optional()});ti.merge(IW);const MT=A.object({first_name:A.string().min(1,"Vorname ist erforderlich"),last_name:A.string().min(1,"Nachname ist erforderlich"),email:A.string().email("Gültige E-Mail-Adresse erforderlich"),phone:A.string().optional(),role:A.string().default("employee"),hourly_wage:A.number().min(0,"Stundenlohn muss positiv sein").default(0),status:A.enum(["active","inactive","invited"]).default("active")});MT.partial();ti.merge(MT);const OW=A.object({success:A.literal(!0),data:A.any(),message:A.string().optional()}),LW=A.object({success:A.literal(!1),error:A.object({code:A.string(),message:A.string(),details:A.any().optional()})});A.union([OW,LW]);A.object({page:A.coerce.number().int().min(1).default(1),limit:A.coerce.number().int().min(1).max(100).default(20),sort_by:A.string().optional(),sort_order:A.enum(["asc","desc"]).default("desc")});A.object({items:A.array(A.any()),pagination:A.object({page:A.number(),limit:A.number(),total_items:A.number(),total_pages:A.number(),has_next:A.boolean(),has_prev:A.boolean()})});const FW=A.object({project_id:A.string().uuid().optional(),suggestion_type:A.enum(["parse_intent","estimate","schedule","material_list","cost_breakdown","timeline"]),input_data:A.record(A.any()).refine(t=>Object.keys(t).length>0,"Input data is required"),output_data:A.record(A.any()).refine(t=>Object.keys(t).length>0,"Output data is required"),confidence_score:A.number().min(0).max(1).optional(),model_version:A.string().optional(),trace_id:A.string().uuid().optional()});FW.partial().extend({status:A.enum(["active","applied","rejected","superseded"]).optional(),applied_by:A.string().uuid().optional(),applied_at:A.string().datetime().optional(),feedback_score:A.number().int().min(1).max(5).optional(),feedback_notes:A.string().optional()});A.object({id:A.string().uuid(),project_id:A.string().uuid().optional(),suggestion_type:A.enum(["parse_intent","estimate","schedule","material_list","cost_breakdown","timeline"]),input_data:A.record(A.any()),output_data:A.record(A.any()),confidence_score:A.number().min(0).max(1).optional(),model_version:A.string().optional(),trace_id:A.string().uuid().optional(),status:A.enum(["active","applied","rejected","superseded"]).default("active"),applied_by:A.string().uuid().optional(),applied_at:A.string().datetime().optional(),feedback_score:A.number().int().min(1).max(5).optional(),feedback_notes:A.string().optional(),company_id:A.string().uuid().optional(),created_at:A.string().datetime(),updated_at:A.string().datetime()});A.object({ref_type:A.string().min(1,"Reference type is required"),ref_id:A.string().uuid("Valid reference ID required"),content_text:A.string().min(1,"Content text is required"),metadata:A.record(A.any()).optional()});A.object({id:A.string().uuid(),ref_type:A.string(),ref_id:A.string().uuid(),content_text:A.string(),embedding:A.array(A.number()).optional(),metadata:A.record(A.any()).optional(),indexed_at:A.string().datetime(),company_id:A.string().uuid().optional(),created_at:A.string().datetime(),updated_at:A.string().datetime()});A.object({operation_type:A.enum(["index_content","generate_estimate","create_schedule","extract_intent"]),entity_type:A.string().min(1,"Entity type is required"),entity_id:A.string().uuid("Valid entity ID required"),input_data:A.record(A.any()).refine(t=>Object.keys(t).length>0,"Input data is required"),priority:A.number().int().min(1).max(10).default(5),scheduled_for:A.string().datetime().optional()});A.object({id:A.string().uuid(),operation_type:A.enum(["index_content","generate_estimate","create_schedule","extract_intent"]),entity_type:A.string(),entity_id:A.string().uuid(),input_data:A.record(A.any()),priority:A.number().int().min(1).max(10).default(5),status:A.enum(["pending","processing","completed","failed"]).default("pending"),attempts:A.number().int().min(0).default(0),max_attempts:A.number().int().min(1).default(3),error_message:A.string().optional(),result_data:A.record(A.any()).optional(),scheduled_for:A.string().datetime(),started_at:A.string().datetime().optional(),completed_at:A.string().datetime().optional(),company_id:A.string().uuid().optional(),created_at:A.string().datetime()});A.object({data_type:A.enum(["estimate_correction","schedule_feedback","material_suggestion","cost_actual_vs_predicted"]),input_features:A.record(A.any()).refine(t=>Object.keys(t).length>0,"Input features required"),expected_output:A.record(A.any()).refine(t=>Object.keys(t).length>0,"Expected output required"),predicted_output:A.record(A.any()).optional(),prediction_error:A.number().optional(),project_id:A.string().uuid().optional(),suggestion_id:A.string().uuid().optional()});A.object({id:A.string().uuid(),data_type:A.enum(["estimate_correction","schedule_feedback","material_suggestion","cost_actual_vs_predicted"]),input_features:A.record(A.any()),expected_output:A.record(A.any()),predicted_output:A.record(A.any()).optional(),prediction_error:A.number().optional(),project_id:A.string().uuid().optional(),suggestion_id:A.string().uuid().optional(),company_id:A.string().uuid().optional(),created_at:A.string().datetime()});A.object({text:A.string().min(1,"Text content is required"),context:A.object({customer_info:A.string().optional(),previous_projects:A.array(A.string()).optional(),preferred_materials:A.array(A.string()).optional()}).optional()});A.object({intent_type:A.enum(["quote_request","project_inquiry","maintenance","consultation","emergency"]),confidence:A.number().min(0).max(1),extracted_data:A.object({customer_name:A.string().optional(),project_type:A.string().optional(),description:A.string().optional(),urgency:A.enum(["low","medium","high","urgent"]).optional(),budget_range:A.object({min:A.number().optional(),max:A.number().optional()}).optional(),timeline:A.object({start_date:A.string().date().optional(),end_date:A.string().date().optional(),duration_days:A.number().optional()}).optional(),materials:A.array(A.object({name:A.string(),quantity:A.number().optional(),unit:A.string().optional()})).optional()}),suggestions:A.array(A.string()).optional()});A.object({project_description:A.string().min(1,"Project description is required"),project_type:A.string().optional(),customer_id:A.string().uuid().optional(),timeline:A.object({start_date:A.string().date().optional(),duration_days:A.number().min(1).optional()}).optional(),requirements:A.array(A.string()).optional(),similar_projects:A.array(A.string().uuid()).optional()});A.object({confidence:A.number().min(0).max(1),total_estimate:A.number().min(0),breakdown:A.object({labor_hours:A.number().min(0),labor_cost:A.number().min(0),material_cost:A.number().min(0),equipment_cost:A.number().min(0).default(0),overhead_cost:A.number().min(0).default(0)}),materials:A.array(A.object({name:A.string(),material_id:A.string().uuid().optional(),quantity:A.number().min(0),unit:A.string(),unit_price:A.number().min(0),total_cost:A.number().min(0),availability:A.enum(["available","order_needed","unavailable"]).optional()})),timeline:A.object({estimated_duration_days:A.number().min(1),phases:A.array(A.object({name:A.string(),duration_days:A.number().min(1),description:A.string().optional()})).optional()}),risks:A.array(A.object({description:A.string(),impact:A.enum(["low","medium","high"]),mitigation:A.string().optional()})).optional()});A.object({project_id:A.string().uuid("Project ID is required"),requirements:A.object({start_date:A.string().date().optional(),end_date:A.string().date().optional(),duration_days:A.number().min(1).optional(),required_skills:A.array(A.string()).optional(),team_size:A.number().int().min(1).optional()}),constraints:A.object({available_employees:A.array(A.string().uuid()).optional(),excluded_dates:A.array(A.string().date()).optional(),priority:A.enum(["low","medium","high","urgent"]).default("medium")}).optional()});A.object({confidence:A.number().min(0).max(1),recommended_schedule:A.array(A.object({employee_id:A.string().uuid(),employee_name:A.string(),dates:A.array(A.object({date:A.string().date(),hours:A.number().min(0).max(24),tasks:A.array(A.string()).optional()})),total_hours:A.number().min(0)})),conflicts:A.array(A.object({type:A.enum(["employee_unavailable","overallocation","skill_mismatch","deadline_conflict"]),description:A.string(),affected_employees:A.array(A.string().uuid()).optional(),severity:A.enum(["low","medium","high"])})),alternatives:A.array(A.object({description:A.string(),impact:A.string(),schedule:A.any().optional()})).optional()});A.object({entity_type:A.string().min(1,"Entity type is required"),entity_id:A.string().uuid("Valid entity ID required"),action:A.enum(["INSERT","UPDATE","DELETE","STATUS_CHANGE"]),old_values:A.record(A.any()).optional(),new_values:A.record(A.any()).optional(),changed_fields:A.array(A.string()).optional(),reason:A.string().optional(),ip_address:A.string().ip().optional(),user_agent:A.string().optional()});A.object({id:A.string().uuid(),entity_type:A.string(),entity_id:A.string().uuid(),action:A.enum(["INSERT","UPDATE","DELETE","STATUS_CHANGE"]),old_values:A.record(A.any()).optional(),new_values:A.record(A.any()).optional(),changed_fields:A.array(A.string()).optional(),user_id:A.string().uuid().optional(),user_email:A.string().email().optional(),reason:A.string().optional(),ip_address:A.string().optional(),user_agent:A.string().optional(),company_id:A.string().uuid().optional(),created_at:A.string().datetime()});const BW=A.object({sequence_name:A.string().min(1,"Sequence name is required"),prefix:A.string().default(""),format_pattern:A.string().default("{prefix}-{year}-{number:04d}"),year_reset:A.boolean().default(!0),current_value:A.number().int().min(0).default(0)});BW.partial();A.object({id:A.string().uuid(),sequence_name:A.string(),current_value:A.number().int().min(0),prefix:A.string(),year_reset:A.boolean(),format_pattern:A.string(),last_reset_year:A.number().int().optional(),company_id:A.string().uuid().optional(),created_at:A.string().datetime(),updated_at:A.string().datetime()});A.object({entity_type:A.string().min(1,"Entity type is required"),entity_id:A.string().uuid("Valid entity ID required"),file_name:A.string().min(1,"File name is required"),file_path:A.string().min(1,"File path is required"),file_size:A.number().int().min(0,"File size must be non-negative"),mime_type:A.string().min(1,"MIME type is required"),sha256_hash:A.string().regex(/^[a-fA-F0-9]{64}$/,"Valid SHA256 hash required"),is_original:A.boolean().default(!0),legal_category:A.enum(["invoice","contract","receipt","tax_document","correspondence"]),retention_until:A.string().date("Valid retention date required")});A.object({id:A.string().uuid(),entity_type:A.string(),entity_id:A.string().uuid(),file_name:A.string(),file_path:A.string(),file_size:A.number().int(),mime_type:A.string(),sha256_hash:A.string().regex(/^[a-fA-F0-9]{64}$/),created_by:A.string().uuid().optional(),is_original:A.boolean(),legal_category:A.enum(["invoice","contract","receipt","tax_document","correspondence"]),retention_until:A.string().date(),company_id:A.string().uuid().optional(),created_at:A.string().datetime()});A.object({from_date:A.string().date("Valid from date required"),to_date:A.string().date("Valid to date required"),export_type:A.enum(["invoices","postings","full"]).default("invoices"),include_drafts:A.boolean().default(!1),consultant_number:A.string().optional(),client_number:A.string().optional(),encoding:A.enum(["UTF-8","CP1252"]).default("CP1252")});A.object({export_id:A.string().uuid(),file_url:A.string().url(),file_name:A.string(),record_count:A.number().int().min(0),export_date:A.string().datetime(),from_date:A.string().date(),to_date:A.string().date(),checksum:A.string().optional()});A.object({belegdatum:A.string().date(),rechnungsnummer:A.string(),debitorenkonto:A.string().optional(),gegenkonto:A.string(),bu_schluessel:A.string().optional(),nettobetrag:A.number(),steuerbetrag:A.number().default(0),bruttobetrag:A.number(),belegfeld1:A.string().optional(),kost1:A.string().optional(),kost2:A.string().optional(),project_id:A.string().uuid().optional(),customer_id:A.string().uuid().optional(),description:A.string().optional()});A.object({entity_type:A.enum(["quote","order","invoice"]),entity_id:A.string().uuid(),from_status:A.string(),to_status:A.string(),reason:A.string().optional(),require_immutable_file:A.boolean().default(!1),file_data:A.object({content:A.string(),filename:A.string(),mime_type:A.string()}).optional()});A.object({report_type:A.enum(["audit_summary","document_integrity","number_sequence_gaps","retention_overview"]),from_date:A.string().date().optional(),to_date:A.string().date().optional(),entity_types:A.array(A.string()).optional()});A.object({report_type:A.string(),generated_at:A.string().datetime(),period:A.object({from_date:A.string().date().optional(),to_date:A.string().date().optional()}),summary:A.object({total_records:A.number().int(),compliant_records:A.number().int(),issues_found:A.number().int(),compliance_percentage:A.number().min(0).max(100)}),details:A.array(A.object({entity_type:A.string(),entity_id:A.string().uuid(),issue_type:A.string(),description:A.string(),severity:A.enum(["low","medium","high","critical"]),recommendation:A.string().optional()})),file_integrity:A.object({total_files:A.number().int(),verified_files:A.number().int(),failed_verifications:A.number().int(),missing_files:A.number().int()}).optional()});A.object({entity_type:A.string().min(1,"Entity type is required"),entity_ids:A.array(A.string().uuid()).min(1,"At least one entity ID required"),archive_reason:A.string().min(1,"Archive reason is required"),retention_years:A.number().int().min(1).max(30).default(10),include_related:A.boolean().default(!0)});A.object({archive_id:A.string().uuid(),archived_count:A.number().int(),archive_location:A.string(),retention_until:A.string().date(),created_at:A.string().datetime()});const pk=(t,e=!1)=>{const n={can_view:!1,can_edit_basic_data:!1,can_add_time:!1,can_add_materials:!1,can_upload_files:!1,can_change_status:!1,can_link_invoices:!1,can_delete:!1,can_manage_team:!1};switch(t){case"mitarbeiter":return{...n,can_view:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0};case"projektleiter":return{...n,can_view:!0,can_edit_basic_data:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0,can_change_status:!0,can_link_invoices:!0,can_manage_team:!0};case"admin":return{can_view:!0,can_edit_basic_data:!0,can_add_time:!0,can_add_materials:!0,can_upload_files:!0,can_change_status:!0,can_link_invoices:!0,can_delete:!0,can_manage_team:!0};default:return n}},gk={anfrage:{label:"Anfrage",color:"text-purple-700",bgColor:"bg-purple-100",icon:"📋",description:"Projekt-Anfrage eingegangen",nextStates:["besichtigung"],previousStates:[]},besichtigung:{label:"Termin ausmachen",color:"text-orange-700",bgColor:"bg-orange-100",icon:"📅",description:"Besichtigungstermin vereinbaren",nextStates:["geplant"],previousStates:["anfrage"]},geplant:{label:"In Planung",color:"text-blue-700",bgColor:"bg-blue-100",icon:"📝",description:"Projekt ist in Planung",nextStates:["in_bearbeitung"],previousStates:["besichtigung"]},in_bearbeitung:{label:"In Arbeit",color:"text-yellow-700",bgColor:"bg-yellow-100",icon:"🔨",description:"Projekt läuft aktiv",nextStates:["abgeschlossen"],previousStates:["geplant"]},abgeschlossen:{label:"Erledigt",color:"text-green-700",bgColor:"bg-green-100",icon:"✅",description:"Projekt ist abgeschlossen",nextStates:[],previousStates:["in_bearbeitung"]}};class $g{static async getCustomers(e,n){return Ue(async()=>{let r=K.from("customers").select("*",{count:"exact"});if(n!=null&&n.status&&(r=r.eq("status",n.status)),n!=null&&n.search&&(r=r.or(`company_name.ilike.%${n.search}%,contact_person.ilike.%${n.search}%,email.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else r=r.order("created_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get customers")}static async getCustomer(e){return Ue(async()=>{const n=K.from("customers").select("*").eq("id",e);return rt(n).executeSingle()},`Get customer ${e}`)}static async createCustomer(e){return Ue(async()=>{const n=vr(Mj,e);if(!n.customer_number){const a=await this.generateCustomerNumber();n.customer_number=a}const r=K.from("customers").insert(n).select().single();return rt(r).executeSingle()},"Create customer")}static async updateCustomer(e,n){return Ue(async()=>{const r=vr(EW,n);await this.getCustomer(e);const a=K.from("customers").update(r).eq("id",e).select().single();return rt(a).executeSingle()},`Update customer ${e}`)}static async deleteCustomer(e){return Ue(async()=>{const{data:n}=await K.from("projects").select("id").eq("customer_id",e).limit(1);if(n&&n.length>0)throw new et(nt.BUSINESS_RULE_VIOLATION,"Kunde kann nicht gelöscht werden, da noch Projekte zugeordnet sind.",{relatedProjects:n.length});const{data:r}=await K.from("quotes").select("id").eq("customer_id",e).limit(1);if(r&&r.length>0)throw new et(nt.BUSINESS_RULE_VIOLATION,"Kunde kann nicht gelöscht werden, da noch Angebote vorhanden sind.",{relatedQuotes:r.length});const{error:a}=await K.from("customers").delete().eq("id",e);if(a)throw a},`Delete customer ${e}`)}static async getCustomerStats(e){return Ue(async()=>{const{data:n}=await K.from("projects").select("status, budget").eq("customer_id",e),{data:r}=await K.from("invoices").select("status, amount").eq("customer_id",e);return{total_projects:(n==null?void 0:n.length)||0,active_projects:(n==null?void 0:n.filter(i=>i.status==="active").length)||0,completed_projects:(n==null?void 0:n.filter(i=>i.status==="completed").length)||0,total_revenue:(r==null?void 0:r.filter(i=>i.status==="paid").reduce((i,o)=>i+(o.amount||0),0))||0,pending_invoices:(r==null?void 0:r.filter(i=>i.status==="sent").length)||0,overdue_invoices:(r==null?void 0:r.filter(i=>i.status==="overdue").length)||0}},`Get customer stats ${e}`)}static async searchCustomers(e,n=10){return Ue(async()=>{const r=K.from("customers").select("*").or(`company_name.ilike.%${e}%,contact_person.ilike.%${e}%,email.ilike.%${e}%,customer_number.ilike.%${e}%`).order("company_name").limit(n);return rt(r).execute()},`Search customers: ${e}`)}static async generateCustomerNumber(){return Ue(async()=>{const e=await la(),{data:n,error:r}=await K.rpc("get_next_number",{seq_name:"customers",comp_id:e.company_id});if(r)throw r;return n},"Generate customer number")}static async getCustomerProjects(e){return Ue(async()=>{const n=K.from("projects").select(`
          *
        `).eq("customer_id",e).order("created_at",{ascending:!1});return rt(n).execute()},`Get customer projects ${e}`)}static async getCustomerQuotes(e){return Ue(async()=>{const n=K.from("quotes").select("*").eq("customer_id",e).order("created_at",{ascending:!1});return rt(n).execute()},`Get customer quotes ${e}`)}static async getCustomerInvoices(e){return Ue(async()=>{const n=K.from("invoices").select(`
          *,
          projects (
            name
          )
        `).eq("customer_id",e).order("created_at",{ascending:!1});return rt(n).execute()},`Get customer invoices ${e}`)}}const zW=new $g;class $W{constructor(){fs(this,"subscriptions",new Map);fs(this,"eventHistory",[]);fs(this,"maxHistorySize",1e3)}on(e,n,r=!1){const a={id:this.generateId(),event:e,handler:n,once:r};return this.subscriptions.has(e)||this.subscriptions.set(e,[]),this.subscriptions.get(e).push(a),a.id}once(e,n){return this.on(e,n,!0)}off(e){for(const[n,r]of this.subscriptions.entries()){const a=r.findIndex(i=>i.id===e);if(a>=0){r.splice(a,1),r.length===0&&this.subscriptions.delete(n);break}}}async emit(e,n={}){const r={...n,timestamp:n.timestamp||new Date().toISOString()};this.addToHistory(e,r),this.shouldLogToAudit(e)&&await this.logToAuditTrail(e,r);const i=(this.subscriptions.get(e)||[]).map(async o=>{try{await o.handler(r),o.once&&this.off(o.id)}catch(c){console.error(`Event handler error for ${e}:`,c),e!=="SYSTEM_ERROR"&&this.emit("SYSTEM_ERROR",{error:c instanceof Error?c.message:"Unknown error",event:e,data:r})}});await Promise.all(i),await this.triggerWorkflowAutomations(e,r)}getHistory(e,n){let r=e?this.eventHistory.filter(a=>a.event===e):this.eventHistory;return n&&(r=r.slice(-n)),r}clearHistory(){this.eventHistory=[]}getSubscriptionCount(e){var r;if(e)return((r=this.subscriptions.get(e))==null?void 0:r.length)||0;let n=0;for(const a of this.subscriptions.values())n+=a.length;return n}generateId(){return`sub_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}addToHistory(e,n){this.eventHistory.push({event:e,data:{...n},timestamp:n.timestamp||new Date().toISOString()}),this.eventHistory.length>this.maxHistorySize&&this.eventHistory.shift()}shouldLogToAudit(e){return["QUOTE_SENT","QUOTE_ACCEPTED","QUOTE_REJECTED","ORDER_STARTED","ORDER_COMPLETED","ORDER_CANCELLED","PROJECT_STATUS_CHANGED","INVOICE_SENT","INVOICE_PAID","TIMESHEET_APPROVED","STOCK_ADJUSTED","DOCUMENT_UPLOADED","DOCUMENT_DELETED"].includes(e)}async logToAuditTrail(e,n){try{const r=this.extractAuditData(e,n);await K.from("audit_logs").insert({action:this.mapEventToAuditAction(e),table_name:this.extractTableName(e),record_id:r.recordId,old_values:r.oldValues,new_values:r.newValues,user_id:n.user_id,metadata:{event_type:e,...r.metadata}})}catch(r){console.error("Failed to log audit trail:",r)}}extractAuditData(e,n){var r,a,i,o,c,d,u,m;switch(e){case"QUOTE_ACCEPTED":case"QUOTE_REJECTED":return{recordId:(r=n.quote)==null?void 0:r.id,newValues:{status:(a=n.quote)==null?void 0:a.status},metadata:{reason:n.reason}};case"PROJECT_STATUS_CHANGED":return{recordId:(i=n.project)==null?void 0:i.id,oldValues:{status:n.previous_status},newValues:{status:n.new_status}};case"INVOICE_PAID":return{recordId:(o=n.invoice)==null?void 0:o.id,newValues:{status:"paid",paid_at:n.payment_date},metadata:{notes:n.notes}};case"STOCK_ADJUSTED":return{recordId:(c=n.material)==null?void 0:c.id,metadata:{adjustment:n.adjustment,reason:n.reason,reference:n.reference}};default:return{recordId:n.id||((d=n.quote)==null?void 0:d.id)||((u=n.project)==null?void 0:u.id)||((m=n.invoice)==null?void 0:m.id),metadata:{event_data:n}}}}mapEventToAuditAction(e){return{QUOTE_SENT:"STATUS_CHANGE",QUOTE_ACCEPTED:"STATUS_CHANGE",QUOTE_REJECTED:"STATUS_CHANGE",ORDER_STARTED:"STATUS_CHANGE",ORDER_COMPLETED:"STATUS_CHANGE",ORDER_CANCELLED:"STATUS_CHANGE",PROJECT_STATUS_CHANGED:"STATUS_CHANGE",INVOICE_SENT:"STATUS_CHANGE",INVOICE_PAID:"STATUS_CHANGE",TIMESHEET_APPROVED:"UPDATE",STOCK_ADJUSTED:"UPDATE",DOCUMENT_UPLOADED:"INSERT",DOCUMENT_DELETED:"DELETE"}[e]||"UPDATE"}extractTableName(e){return e.startsWith("QUOTE_")?"quotes":e.startsWith("ORDER_")?"orders":e.startsWith("PROJECT_")?"projects":e.startsWith("INVOICE_")?"invoices":e.startsWith("TIMESHEET_")?"timesheets":e.startsWith("MATERIAL_")||e.startsWith("STOCK_")?"materials":e.startsWith("DOCUMENT_")?"documents":"unknown"}async triggerWorkflowAutomations(e,n){try{switch(e){case"QUOTE_ACCEPTED":await this.sendNotification("quote_accepted",n);break;case"ORDER_COMPLETED":await this.autoCreateInvoice(n);break;case"INVOICE_SENT":await this.schedulePaymentReminders(n);break;case"MATERIAL_LOW_STOCK":await this.sendLowStockAlert(n);break;case"PROJECT_STATUS_CHANGED":await this.notifyProjectTeam(n);break;default:break}}catch(r){console.error(`Workflow automation error for ${e}:`,r)}}async sendNotification(e,n){console.log(`Notification: ${e}`,n)}async autoCreateInvoice(e){e.order&&console.log("Auto-creating invoice for order:",e.order.id)}async schedulePaymentReminders(e){e.invoice&&console.log("Scheduling payment reminders for invoice:",e.invoice.id)}async sendLowStockAlert(e){e.material&&console.log("Low stock alert for material:",e.material.name)}async notifyProjectTeam(e){e.project&&console.log("Notifying project team of status change:",e.project.name)}}const mt=new $W;mt.on("SYSTEM_ERROR",t=>{console.error("System error:",t)});mt.on("USER_LOGIN",t=>{console.log("User logged in:",t.user_id)});mt.on("USER_LOGOUT",t=>{console.log("User logged out:",t.user_id)});class UW{static async getOrders(e,n){return Ue(async()=>{let r=K.from("orders").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          ),
          projects (
            name,
            status
          )
        `,{count:"exact"});if(n!=null&&n.status&&(r=r.eq("status",n.status)),n!=null&&n.customer_id&&(r=r.eq("customer_id",n.customer_id)),n!=null&&n.search&&(r=r.or(`title.ilike.%${n.search}%,description.ilike.%${n.search}%,order_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else r=r.order("created_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get orders")}static async getOrder(e){return Ue(async()=>{const n=K.from("orders").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          ),
          quotes (
            quote_number,
            title
          ),
          projects (
            name,
            status,
            start_date,
            end_date
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get order ${e}`)}static async createOrder(e){return Ue(async()=>{var m,f;const n=vr(Ij,e),a=(((m=n.body)==null?void 0:m.items)||[]).reduce((p,v)=>p+v.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),c={...n,total_amount:o,status:"open"},d=K.from("orders").insert(c).select().single(),u=await rt(d).executeSingle();return mt.emit("ORDER_CREATED",{order:u,user_id:(f=(await K.auth.getUser()).data.user)==null?void 0:f.id}),u},"Create order")}static async createOrderFromQuote(e){return Ue(async()=>{var a;if(e.status!=="accepted")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur akzeptierte Angebote können in Aufträge umgewandelt werden.",{quoteStatus:e.status});const n={customer_id:e.customer_id,quote_id:e.id,title:e.title,description:e.description,body:e.body,tax_rate:e.tax_rate,expected_delivery_date:e.valid_until||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]},r=await this.createOrder(n);return mt.emit("ORDER_CREATED_FROM_QUOTE",{order:r,quote:e,user_id:(a=(await K.auth.getUser()).data.user)==null?void 0:a.id}),r},`Create order from quote ${e.id}`)}static async updateOrder(e,n){return Ue(async()=>{var c,d;const r=await this.getOrder(e);if(r.status==="completed")throw new et(nt.IMMUTABLE_RECORD,"Abgeschlossene Aufträge können nicht mehr bearbeitet werden.",{currentStatus:r.status});if(r.status==="in_progress"&&n.order_number)throw new et(nt.IMMUTABLE_RECORD,"Auftragsnummer kann nach dem Start nicht mehr geändert werden.",{currentStatus:r.status});const a=vr(DW,n);if((c=a.body)!=null&&c.items){const m=a.body.items.reduce((p,v)=>p+v.total_price,0),f=a.tax_rate||r.tax_rate||19;a.total_amount=m*(1+f/100)}const i=K.from("orders").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return mt.emit("ORDER_UPDATED",{order:o,previous_order:r,changes:a,user_id:(d=(await K.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update order ${e}`)}static async startOrder(e){return Ue(async()=>{var o;const n=await this.getOrder(e);if(n.status!=="open")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur offene Aufträge können gestartet werden.",{currentStatus:n.status});const r={status:"in_progress",started_at:new Date().toISOString()},a=K.from("orders").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle();if(!i.project_id){const c={name:i.title,description:i.description,customer_id:i.customer_id,order_id:i.id,status:"active",start_date:new Date().toISOString().split("T")[0],budget:i.total_amount},{data:d}=await K.from("projects").insert(c).select().single();await K.from("orders").update({project_id:d==null?void 0:d.id}).eq("id",e)}return mt.emit("ORDER_STARTED",{order:i,user_id:(o=(await K.auth.getUser()).data.user)==null?void 0:o.id}),i},`Start order ${e}`)}static async completeOrder(e){return Ue(async()=>{var o;const n=await this.getOrder(e);if(n.status!=="in_progress")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur laufende Aufträge können abgeschlossen werden.",{currentStatus:n.status});const r={status:"completed",completed_at:new Date().toISOString()},a=K.from("orders").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle();return i.project_id&&await K.from("projects").update({status:"completed",end_date:new Date().toISOString().split("T")[0]}).eq("id",i.project_id),mt.emit("ORDER_COMPLETED",{order:i,user_id:(o=(await K.auth.getUser()).data.user)==null?void 0:o.id}),i},`Complete order ${e}`)}static async cancelOrder(e,n){return Ue(async()=>{var c;const r=await this.getOrder(e);if(r.status==="completed")throw new et(nt.BUSINESS_RULE_VIOLATION,"Abgeschlossene Aufträge können nicht storniert werden.",{currentStatus:r.status});const a={status:"cancelled",description:n?`${r.description||""}

Stornierungsgrund: ${n}`.trim():r.description},i=K.from("orders").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return o.project_id&&await K.from("projects").update({status:"cancelled"}).eq("id",o.project_id),mt.emit("ORDER_CANCELLED",{order:o,reason:n,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),o},`Cancel order ${e}`)}static async getOrderStats(){return Ue(async()=>{const e=K.from("orders").select("status, total_amount, created_at, completed_at"),n=await rt(e).execute(),r={total:n.length,by_status:{open:0,in_progress:0,completed:0,cancelled:0},total_value:{open:0,in_progress:0,completed:0,cancelled:0},avg_completion_time:0};let a=0,i=0;return n.forEach(o=>{if(r.by_status[o.status]++,r.total_value[o.status]+=o.total_amount||0,o.status==="completed"&&o.completed_at){const c=new Date(o.completed_at).getTime()-new Date(o.created_at).getTime();a+=c/(1e3*60*60*24),i++}}),i>0&&(r.avg_completion_time=a/i),r},"Get order statistics")}static async deleteOrder(e){return Ue(async()=>{var a;const n=await this.getOrder(e);if(n.status!=="open")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur offene Aufträge können gelöscht werden.",{currentStatus:n.status});if(n.project_id)throw new et(nt.BUSINESS_RULE_VIOLATION,"Aufträge mit verknüpften Projekten können nicht gelöscht werden.",{projectId:n.project_id});const{error:r}=await K.from("orders").delete().eq("id",e);if(r)throw r;mt.emit("ORDER_DELETED",{order:n,user_id:(a=(await K.auth.getUser()).data.user)==null?void 0:a.id})},`Delete order ${e}`)}static async duplicateOrder(e){return Ue(async()=>{const n=await this.getOrder(e),r={customer_id:n.customer_id,title:`${n.title} (Kopie)`,description:n.description,body:n.body,tax_rate:n.tax_rate,expected_delivery_date:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]};return this.createOrder(r)},`Duplicate order ${e}`)}}const qW=new UW;class HW{static async getQuotes(e,n){return Ue(async()=>{let r=K.from("quotes").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          )
        `,{count:"exact"});if(n!=null&&n.status&&(r=r.eq("status",n.status)),n!=null&&n.customer_id&&(r=r.eq("customer_id",n.customer_id)),n!=null&&n.search&&(r=r.or(`title.ilike.%${n.search}%,description.ilike.%${n.search}%,quote_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else r=r.order("created_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get quotes")}static async getQuote(e){return Ue(async()=>{const n=K.from("quotes").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get quote ${e}`)}static async createQuote(e){return Ue(async()=>{var m,f;const n=vr(Rj,e),a=(((m=n.body)==null?void 0:m.items)||[]).reduce((p,v)=>p+v.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),c={...n,total_net:a,total_gross:o,status:"draft"},d=K.from("quotes").insert(c).select().single(),u=await rt(d).executeSingle();return mt.emit("QUOTE_CREATED",{quote:u,user_id:(f=(await K.auth.getUser()).data.user)==null?void 0:f.id}),u},"Create quote")}static async updateQuote(e,n){return Ue(async()=>{var c,d;const r=await this.getQuote(e);if(r.status==="accepted")throw new et(nt.IMMUTABLE_RECORD,"Akzeptierte Angebote können nicht mehr bearbeitet werden.",{currentStatus:r.status});if(r.status==="sent"&&n.quote_number)throw new et(nt.IMMUTABLE_RECORD,"Angebotsnummer kann nach dem Versand nicht mehr geändert werden.",{currentStatus:r.status});const a=vr(PW,n);if((c=a.body)!=null&&c.items){const m=a.body.items.reduce((p,v)=>p+v.total_price,0),f=a.tax_rate||r.tax_rate||19;a.total_net=m,a.total_gross=m*(1+f/100)}const i=K.from("quotes").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return mt.emit("QUOTE_UPDATED",{quote:o,previous_quote:r,changes:a,user_id:(d=(await K.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update quote ${e}`)}static async sendQuote(e){return Ue(async()=>{var o,c;const n=await this.getQuote(e);if(n.status!=="draft")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können versendet werden.",{currentStatus:n.status});if(!((o=n.body)!=null&&o.items)||n.body.items.length===0)throw new et(nt.BUSINESS_RULE_VIOLATION,"Angebot muss mindestens eine Position enthalten.");if(!n.valid_until)throw new et(nt.BUSINESS_RULE_VIOLATION,"Gültigkeitsdatum ist erforderlich.");const r={status:"sent",sent_at:new Date().toISOString()},a=K.from("quotes").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle();return mt.emit("QUOTE_SENT",{quote:i,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),i},`Send quote ${e}`)}static async acceptQuote(e){return Ue(async()=>{var c;const n=await this.getQuote(e);if(n.status!=="sent")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur versendete Angebote können angenommen werden.",{currentStatus:n.status});if(n.valid_until&&new Date(n.valid_until)<new Date)throw new et(nt.BUSINESS_RULE_VIOLATION,"Das Angebot ist bereits abgelaufen.",{validUntil:n.valid_until});const r={status:"accepted",accepted_at:new Date().toISOString()},a=K.from("quotes").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle(),o=await qW.createOrderFromQuote(i);return mt.emit("QUOTE_ACCEPTED",{quote:i,order:o,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),{quote:i,order:o}},`Accept quote ${e}`)}static async rejectQuote(e,n){return Ue(async()=>{var c;const r=await this.getQuote(e);if(r.status!=="sent")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur versendete Angebote können abgelehnt werden.",{currentStatus:r.status});const a={status:"rejected",description:n?`${r.description||""}

Ablehnungsgrund: ${n}`.trim():r.description},i=K.from("quotes").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return mt.emit("QUOTE_REJECTED",{quote:o,reason:n,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),o},`Reject quote ${e}`)}static async getQuoteStats(){return Ue(async()=>{const e=K.from("quotes").select("status, total_gross"),n=await rt(e).execute(),r={total:n.length,by_status:{draft:0,sent:0,accepted:0,rejected:0,expired:0},total_value:{draft:0,sent:0,accepted:0,rejected:0,expired:0},conversion_rate:0};n.forEach(i=>{r.by_status[i.status]++,r.total_value[i.status]+=i.total_gross||0});const a=r.by_status.sent+r.by_status.accepted+r.by_status.rejected;return a>0&&(r.conversion_rate=r.by_status.accepted/a*100),r},"Get quote statistics")}static async deleteQuote(e){return Ue(async()=>{var a;const n=await this.getQuote(e);if(n.status!=="draft")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können gelöscht werden.",{currentStatus:n.status});const{error:r}=await K.from("quotes").delete().eq("id",e);if(r)throw r;mt.emit("QUOTE_DELETED",{quote:n,user_id:(a=(await K.auth.getUser()).data.user)==null?void 0:a.id})},`Delete quote ${e}`)}static async duplicateQuote(e){return Ue(async()=>{const n=await this.getQuote(e),r={customer_id:n.customer_id,title:`${n.title} (Kopie)`,description:n.description,body:n.body,tax_rate:n.tax_rate,valid_until:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]};return this.createQuote(r)},`Duplicate quote ${e}`)}}const Ug=new HW;class RT{static async getProjects(e,n){return Ue(async()=>{let r=K.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          )
        `,{count:"exact"});if(n!=null&&n.status&&(r=r.eq("status",n.status)),n!=null&&n.customer_id&&(r=r.eq("customer_id",n.customer_id)),n!=null&&n.employee_id&&(r=r.contains("assigned_employees",[n.employee_id])),n!=null&&n.search&&(r=r.or(`name.ilike.%${n.search}%,description.ilike.%${n.search}%,project_number.ilike.%${n.search}%`)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else r=r.order("created_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return console.log("ProjectService.getProjects:",{query:r.toString(),data:a,count:i,pagination:e,filters:n}),{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get projects")}static async getProject(e){return Ue(async()=>{const n=K.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get project ${e}`)}static async createProject(e){return Ue(async()=>{var o;const n=vr(Oj,e),r={...n,status:"planned",assigned_employees:n.assigned_employees||[]},a=K.from("projects").insert(r).select().single(),i=await rt(a).executeSingle();return mt.emit("PROJECT_CREATED",{project:i,user_id:(o=(await K.auth.getUser()).data.user)==null?void 0:o.id}),i},"Create project")}static async updateProject(e,n){return Ue(async()=>{var c,d;const r=await this.getProject(e);if(r.status==="completed"&&n.status!=="completed")throw new et(nt.BUSINESS_RULE_VIOLATION,"Abgeschlossene Projekte können nicht wieder aktiviert werden.",{currentStatus:r.status});const a=vr(TW,n);a.status&&a.status!==r.status&&(await this.validateStatusTransition(r.status,a.status),a.status==="active"&&!r.start_date?a.start_date=new Date().toISOString().split("T")[0]:a.status==="completed"&&!a.end_date&&(a.end_date=new Date().toISOString().split("T")[0]));const i=K.from("projects").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return a.status&&a.status!==r.status&&mt.emit("PROJECT_STATUS_CHANGED",{project:o,previous_status:r.status,new_status:a.status,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),mt.emit("PROJECT_UPDATED",{project:o,previous_project:r,changes:a,user_id:(d=(await K.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update project ${e}`)}static async validateStatusTransition(e,n){const r={planned:["active","cancelled"],active:["blocked","completed","cancelled"],blocked:["active","cancelled"],completed:[],cancelled:[]};if(!r[e].includes(n))throw new et(nt.BUSINESS_RULE_VIOLATION,`Ungültiger Statuswechsel von "${e}" zu "${n}".`,{from:e,to:n,validTransitions:r[e]})}static async startProject(e){return Ue(async()=>{const n=await this.getProject(e);if(n.status!=="planned")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur geplante Projekte können gestartet werden.",{currentStatus:n.status});const r={status:"active",start_date:new Date().toISOString().split("T")[0]};return this.updateProject(e,r)},`Start project ${e}`)}static async completeProject(e){return Ue(async()=>{const n=await this.getProject(e);if(n.status!=="active")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur aktive Projekte können abgeschlossen werden.",{currentStatus:n.status});const r={status:"completed",end_date:new Date().toISOString().split("T")[0]};return this.updateProject(e,r)},`Complete project ${e}`)}static async blockProject(e,n){return Ue(async()=>{const r=await this.getProject(e);if(r.status!=="active")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur aktive Projekte können blockiert werden.",{currentStatus:r.status});const a={status:"blocked",description:n?`${r.description||""}

Blockiert: ${n}`.trim():r.description};return this.updateProject(e,a)},`Block project ${e}`)}static async unblockProject(e){return Ue(async()=>{const n=await this.getProject(e);if(n.status!=="blocked")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur blockierte Projekte können entsperrt werden.",{currentStatus:n.status});const r={status:"active"};return this.updateProject(e,r)},`Unblock project ${e}`)}static async cancelProject(e,n){return Ue(async()=>{const r=await this.getProject(e);if(r.status==="completed")throw new et(nt.BUSINESS_RULE_VIOLATION,"Abgeschlossene Projekte können nicht storniert werden.",{currentStatus:r.status});const a={status:"cancelled",description:n?`${r.description||""}

Storniert: ${n}`.trim():r.description};return this.updateProject(e,a)},`Cancel project ${e}`)}static async getProjectStats(e){return Ue(async()=>{var w;const n=await this.getProject(e),{data:r}=await K.from("timesheets").select("hours, hourly_rate").eq("project_id",e),{data:a}=await K.from("materials").select("quantity, unit_cost").eq("project_id",e),{data:i}=await K.from("expenses").select("amount").eq("project_id",e),o=(r==null?void 0:r.reduce((x,y)=>x+(y.hours||0),0))||0,c=(a==null?void 0:a.reduce((x,y)=>x+(y.quantity*y.unit_cost||0),0))||0,d=(i==null?void 0:i.reduce((x,y)=>x+(y.amount||0),0))||0,m=c+d,f=Math.max(0,(n.budget||0)-m);let p=0;if(n.start_date){const x=new Date(n.start_date),y=n.end_date?new Date(n.end_date):new Date;p=Math.ceil((y.getTime()-x.getTime())/(1e3*60*60*24))}const v={planned:0,active:50,blocked:50,completed:100,cancelled:0}[n.status];return{total_hours:o,total_material_cost:c,total_expenses:d,budget_used:m,budget_remaining:f,days_active:p,team_size:((w=n.assigned_employees)==null?void 0:w.length)||0,completion_percentage:v}},`Get project stats ${e}`)}static async getProjectTimeline(e,n=50){return Ue(async()=>{const{data:r}=await K.from("timesheets").select(`
          id, date, hours, description, created_at,
          employees (name)
        `).eq("project_id",e).order("created_at",{ascending:!1}).limit(n/2),{data:a}=await K.from("materials").select(`
          id, name, quantity, unit_cost, created_at,
          employees (name)
        `).eq("project_id",e).order("created_at",{ascending:!1}).limit(n/2);return[...(r==null?void 0:r.map(o=>{var c;return{id:o.id,type:"timesheet",title:`Arbeitszeit erfasst: ${o.hours}h`,description:o.description,user:((c=o.employees)==null?void 0:c.name)||"Unbekannt",timestamp:o.created_at}}))||[],...(a==null?void 0:a.map(o=>{var c;return{id:o.id,type:"material",title:`Material hinzugefügt: ${o.name}`,description:`${o.quantity} × ${o.unit_cost}€`,user:((c=o.employees)==null?void 0:c.name)||"Unbekannt",timestamp:o.created_at}}))||[]].sort((o,c)=>new Date(c.timestamp).getTime()-new Date(o.timestamp).getTime()).slice(0,n)},`Get project timeline ${e}`)}static async assignEmployee(e,n){return Ue(async()=>{const a=(await this.getProject(e)).assigned_employees||[];if(a.includes(n))throw new et(nt.BUSINESS_RULE_VIOLATION,"Mitarbeiter ist bereits dem Projekt zugewiesen.",{employeeId:n});const i=[...a,n];return this.updateProject(e,{assigned_employees:i})},`Assign employee to project ${e}`)}static async removeEmployee(e,n){return Ue(async()=>{const i=((await this.getProject(e)).assigned_employees||[]).filter(o=>o!==n);return this.updateProject(e,{assigned_employees:i})},`Remove employee from project ${e}`)}static async deleteProject(e){return Ue(async()=>{var i;const n=await this.getProject(e);if(!["planned","cancelled"].includes(n.status))throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur geplante oder stornierte Projekte können gelöscht werden.",{currentStatus:n.status});const{data:r}=await K.from("timesheets").select("id").eq("project_id",e).limit(1);if(r&&r.length>0)throw new et(nt.BUSINESS_RULE_VIOLATION,"Projekt kann nicht gelöscht werden, da bereits Arbeitszeiten erfasst wurden.");const{error:a}=await K.from("projects").delete().eq("id",e);if(a)throw a;mt.emit("PROJECT_DELETED",{project:n,user_id:(i=(await K.auth.getUser()).data.user)==null?void 0:i.id})},`Delete project ${e}`)}static async searchProjects(e,n=10){return Ue(async()=>{const r=K.from("projects").select(`
          *,
          customers (
            company_name,
            contact_person
          )
        `).or(`name.ilike.%${e}%,description.ilike.%${e}%,project_number.ilike.%${e}%`).order("name").limit(n);return rt(r).execute()},`Search projects: ${e}`)}}class WW{static async getTimesheets(e,n){return Ue(async()=>{let r=K.from("timesheets").select(`
          *,
          projects (
            name,
            project_number
          ),
          employees (
            name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.project_id&&(r=r.eq("project_id",n.project_id)),n!=null&&n.employee_id&&(r=r.eq("employee_id",n.employee_id)),n!=null&&n.date_from&&(r=r.gte("date",n.date_from)),n!=null&&n.date_to&&(r=r.lte("date",n.date_to)),(n==null?void 0:n.approved)!==void 0&&(n.approved?r=r.not("approved_at","is",null):r=r.is("approved_at",null)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"date",{ascending:e.sort_order==="asc"})}else r=r.order("date",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get timesheets")}static async getTimesheet(e){return Ue(async()=>{const n=K.from("timesheets").select(`
          *,
          projects (
            name,
            project_number,
            status
          ),
          employees (
            name,
            email,
            hourly_rate
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get timesheet ${e}`)}static async createTimesheet(e){return Ue(async()=>{var i;const n=vr(Fj,e);if(!n.hourly_rate&&n.employee_id){const{data:o}=await K.from("employees").select("hourly_rate").eq("id",n.employee_id).single();o!=null&&o.hourly_rate&&(n.hourly_rate=o.hourly_rate)}n.hours&&n.hourly_rate&&(n.total_cost=n.hours*n.hourly_rate),await this.validateTimesheetEntry(n);const r=K.from("timesheets").insert(n).select().single(),a=await rt(r).executeSingle();return mt.emit("TIMESHEET_CREATED",{timesheet:a,user_id:(i=(await K.auth.getUser()).data.user)==null?void 0:i.id}),a},"Create timesheet")}static async updateTimesheet(e,n){return Ue(async()=>{var u;const r=await this.getTimesheet(e);if(r.approved_at)throw new et(nt.IMMUTABLE_RECORD,"Genehmigte Zeiteinträge können nicht mehr bearbeitet werden.",{approvedAt:r.approved_at});const a=await la();if(r.employee_id!==a.id&&!a.is_admin)throw new et(nt.UNAUTHORIZED,"Sie können nur Ihre eigenen Zeiteinträge bearbeiten.");const i=vr(RW,n);if(i.hours||i.hourly_rate){const m=i.hours||r.hours,f=i.hourly_rate||r.hourly_rate;m&&f&&(i.total_cost=m*f)}const o={...r,...i};await this.validateTimesheetEntry(o);const c=K.from("timesheets").update(i).eq("id",e).select().single(),d=await rt(c).executeSingle();return mt.emit("TIMESHEET_UPDATED",{timesheet:d,previous_timesheet:r,changes:i,user_id:(u=(await K.auth.getUser()).data.user)==null?void 0:u.id}),d},`Update timesheet ${e}`)}static async approveTimesheet(e){return Ue(async()=>{const n=await this.getTimesheet(e);if(n.approved_at)throw new et(nt.BUSINESS_RULE_VIOLATION,"Zeiteintrag ist bereits genehmigt.",{approvedAt:n.approved_at});const r=await la();if(!r.is_admin&&!r.is_project_manager)throw new et(nt.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge genehmigen.");const a={approved_at:new Date().toISOString(),approved_by:r.id},i=K.from("timesheets").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return mt.emit("TIMESHEET_APPROVED",{timesheet:o,approved_by:r.id,user_id:r.id}),o},`Approve timesheet ${e}`)}static async rejectTimesheet(e,n){return Ue(async()=>{const r=await this.getTimesheet(e),a=await la();if(!a.is_admin&&!a.is_project_manager)throw new et(nt.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge ablehnen.");const i={approved_at:null,approved_by:null,description:n?`${r.description||""}

Abgelehnt: ${n}`.trim():r.description},o=K.from("timesheets").update(i).eq("id",e).select().single(),c=await rt(o).executeSingle();return mt.emit("TIMESHEET_REJECTED",{timesheet:c,reason:n,rejected_by:a.id,user_id:a.id}),c},`Reject timesheet ${e}`)}static async validateTimesheetEntry(e){if(e.employee_id&&e.date&&e.start_time&&e.end_time){const{data:n}=await K.from("timesheets").select("id").eq("employee_id",e.employee_id).eq("date",e.date).neq("id",e.id||"").or(`start_time.lte.${e.start_time}.and.end_time.gt.${e.start_time},start_time.lt.${e.end_time}.and.end_time.gte.${e.end_time}`);if(n&&n.length>0)throw new et(nt.BUSINESS_RULE_VIOLATION,"Überschneidende Arbeitszeiten am selben Tag sind nicht erlaubt.")}if(e.hours&&e.hours>12)throw new et(nt.BUSINESS_RULE_VIOLATION,"Maximale Arbeitszeit von 12 Stunden pro Tag überschritten.",{hours:e.hours});if(e.date&&new Date(e.date)>new Date)throw new et(nt.BUSINESS_RULE_VIOLATION,"Zeiteinträge für zukünftige Daten sind nicht erlaubt.");if(e.project_id){const{data:n}=await K.from("projects").select("status").eq("id",e.project_id).single();if(n&&!["active","blocked"].includes(n.status))throw new et(nt.BUSINESS_RULE_VIOLATION,"Zeiteinträge können nur für aktive oder blockierte Projekte erfasst werden.",{projectStatus:n.status})}}static async getEmployeeTimesheetStats(e,n,r){return Ue(async()=>{let a=K.from("timesheets").select("hours, total_cost, approved_at, overtime_hours").eq("employee_id",e);n&&(a=a.gte("date",n)),r&&(a=a.lte("date",r));const i=await rt(a).execute(),o=i.reduce((d,u)=>{const m=u.hours||0,f=u.total_cost||0,p=u.overtime_hours||0;return d.total_hours+=m,d.total_cost+=f,d.overtime_hours+=p,u.approved_at?d.approved_hours+=m:d.pending_hours+=m,d},{total_hours:0,total_cost:0,approved_hours:0,pending_hours:0,days_worked:0,avg_hours_per_day:0,overtime_hours:0}),c=new Set(i.map(d=>d.date));return o.days_worked=c.size,o.days_worked>0&&(o.avg_hours_per_day=o.total_hours/o.days_worked),o},`Get employee timesheet stats ${e}`)}static async getProjectTimesheetSummary(e){return Ue(async()=>{const n=K.from("timesheets").select(`
          hours,
          total_cost,
          date,
          employee_id,
          employees (
            name
          )
        `).eq("project_id",e),r=await rt(n).execute(),a=r.reduce((d,u)=>d+(u.hours||0),0),i=r.reduce((d,u)=>d+(u.total_cost||0),0),o=r.reduce((d,u)=>{var f;const m=u.employee_id;return d[m]||(d[m]={employee_id:m,employee_name:((f=u.employees)==null?void 0:f.name)||"Unbekannt",hours:0,cost:0}),d[m].hours+=u.hours||0,d[m].cost+=u.total_cost||0,d},{}),c=r.reduce((d,u)=>{const m=u.date;return d[m]||(d[m]={date:m,hours:0,cost:0}),d[m].hours+=u.hours||0,d[m].cost+=u.total_cost||0,d},{});return{total_hours:a,total_cost:i,by_employee:Object.values(o),by_date:Object.values(c).sort((d,u)=>d.date.localeCompare(u.date))}},`Get project timesheet summary ${e}`)}static async deleteTimesheet(e){return Ue(async()=>{const n=await this.getTimesheet(e);if(n.approved_at)throw new et(nt.BUSINESS_RULE_VIOLATION,"Genehmigte Zeiteinträge können nicht gelöscht werden.",{approvedAt:n.approved_at});const r=await la();if(n.employee_id!==r.id&&!r.is_admin)throw new et(nt.UNAUTHORIZED,"Sie können nur Ihre eigenen Zeiteinträge löschen.");const{error:a}=await K.from("timesheets").delete().eq("id",e);if(a)throw a;mt.emit("TIMESHEET_DELETED",{timesheet:n,user_id:r.id})},`Delete timesheet ${e}`)}static async bulkApproveTimesheets(e){return Ue(async()=>{const n=await la();if(!n.is_admin&&!n.is_project_manager)throw new et(nt.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Zeiteinträge genehmigen.");const r={approved_at:new Date().toISOString(),approved_by:n.id},a=K.from("timesheets").update(r).in("id",e).is("approved_at",null).select(),i=await rt(a).execute();return i.forEach(o=>{mt.emit("TIMESHEET_APPROVED",{timesheet:o,approved_by:n.id,user_id:n.id})}),i},"Bulk approve timesheets")}}const zj=new WW;class VW{static async getInvoices(e,n){return Ue(async()=>{let r=K.from("invoices").select(`
          *,
          customers (
            company_name,
            contact_person,
            email
          ),
          projects (
            name,
            project_number
          )
        `,{count:"exact"});if(n!=null&&n.status&&(r=r.eq("status",n.status)),n!=null&&n.customer_id&&(r=r.eq("customer_id",n.customer_id)),n!=null&&n.project_id&&(r=r.eq("project_id",n.project_id)),n!=null&&n.overdue&&(r=r.eq("status","sent").lt("due_date",new Date().toISOString().split("T")[0])),n!=null&&n.date_from&&(r=r.gte("invoice_date",n.date_from)),n!=null&&n.date_to&&(r=r.lte("invoice_date",n.date_to)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"created_at",{ascending:e.sort_order==="asc"})}else r=r.order("created_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get invoices")}static async getInvoice(e){return Ue(async()=>{const n=K.from("invoices").select(`
          *,
          customers (
            company_name,
            contact_person,
            email,
            address,
            city,
            postal_code
          ),
          projects (
            name,
            project_number,
            status
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get invoice ${e}`)}static async createInvoice(e){return Ue(async()=>{var m,f;const n=vr(Lj,e),a=(((m=n.body)==null?void 0:m.items)||[]).reduce((p,v)=>p+v.total_price,0),i=n.tax_rate||19,o=a*(1+i/100),c={...n,total_net:a,total_gross:o,amount:o,status:"draft",due_date:n.due_date||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0]},d=K.from("invoices").insert(c).select().single(),u=await rt(d).executeSingle();return mt.emit("INVOICE_CREATED",{invoice:u,user_id:(f=(await K.auth.getUser()).data.user)==null?void 0:f.id}),u},"Create invoice")}static async updateInvoice(e,n){return Ue(async()=>{var c,d;const r=await this.getInvoice(e);if(r.status==="paid")throw new et(nt.IMMUTABLE_RECORD,"Bezahlte Rechnungen können nicht mehr bearbeitet werden.",{currentStatus:r.status});if(r.status==="sent"&&n.invoice_number)throw new et(nt.IMMUTABLE_RECORD,"Rechnungsnummer kann nach dem Versand nicht mehr geändert werden.",{currentStatus:r.status});const a=vr(MW,n);if((c=a.body)!=null&&c.items){const m=a.body.items.reduce((p,v)=>p+v.total_price,0),f=a.tax_rate||r.tax_rate||19;a.total_net=m,a.total_gross=m*(1+f/100),a.amount=a.total_gross}const i=K.from("invoices").update(a).eq("id",e).select().single(),o=await rt(i).executeSingle();return mt.emit("INVOICE_UPDATED",{invoice:o,previous_invoice:r,changes:a,user_id:(d=(await K.auth.getUser()).data.user)==null?void 0:d.id}),o},`Update invoice ${e}`)}static async sendInvoice(e){return Ue(async()=>{var o,c;const n=await this.getInvoice(e);if(n.status!=="draft")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur Entwürfe können versendet werden.",{currentStatus:n.status});if(!((o=n.body)!=null&&o.items)||n.body.items.length===0)throw new et(nt.BUSINESS_RULE_VIOLATION,"Rechnung muss mindestens eine Position enthalten.");const r={status:"sent",sent_at:new Date().toISOString()},a=K.from("invoices").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle();return mt.emit("INVOICE_SENT",{invoice:i,user_id:(c=(await K.auth.getUser()).data.user)==null?void 0:c.id}),i},`Send invoice ${e}`)}static async markInvoicePaid(e,n,r){return Ue(async()=>{var d;const a=await this.getInvoice(e);if(a.status!=="sent")throw new et(nt.BUSINESS_RULE_VIOLATION,"Nur versendete Rechnungen können als bezahlt markiert werden.",{currentStatus:a.status});const i={status:"paid",paid_at:n||new Date().toISOString(),notes:r?`${a.notes||""}

Zahlung: ${r}`.trim():a.notes},o=K.from("invoices").update(i).eq("id",e).select().single(),c=await rt(o).executeSingle();return mt.emit("INVOICE_PAID",{invoice:c,payment_date:n,notes:r,user_id:(d=(await K.auth.getUser()).data.user)==null?void 0:d.id}),c},`Mark invoice paid ${e}`)}static async getExpenses(e,n){return Ue(async()=>{let r=K.from("expenses").select(`
          *,
          projects (
            name,
            project_number
          ),
          employees (
            name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.category&&(r=r.eq("category",n.category)),n!=null&&n.project_id&&(r=r.eq("project_id",n.project_id)),n!=null&&n.employee_id&&(r=r.eq("employee_id",n.employee_id)),n!=null&&n.date_from&&(r=r.gte("expense_date",n.date_from)),n!=null&&n.date_to&&(r=r.lte("expense_date",n.date_to)),(n==null?void 0:n.approved)!==void 0&&(n.approved?r=r.not("approved_at","is",null):r=r.is("approved_at",null)),e){const o=(e.page-1)*e.limit;r=r.range(o,o+e.limit-1).order(e.sort_by||"expense_date",{ascending:e.sort_order==="asc"})}else r=r.order("expense_date",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get expenses")}static async createExpense(e){return Ue(async()=>{var i;const n=vr(Bj,e),r=K.from("expenses").insert(n).select().single(),a=await rt(r).executeSingle();return mt.emit("EXPENSE_CREATED",{expense:a,user_id:(i=(await K.auth.getUser()).data.user)==null?void 0:i.id}),a},"Create expense")}static async approveExpense(e){return Ue(async()=>{const n=await la();if(!n.is_admin&&!n.is_project_manager)throw new et(nt.UNAUTHORIZED,"Nur Projektleiter und Administratoren können Ausgaben genehmigen.");const r={approved_at:new Date().toISOString(),approved_by:n.id},a=K.from("expenses").update(r).eq("id",e).select().single(),i=await rt(a).executeSingle();return mt.emit("EXPENSE_APPROVED",{expense:i,approved_by:n.id,user_id:n.id}),i},`Approve expense ${e}`)}static async getFinancialKPIs(e){return Ue(async()=>{const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),1).toISOString().split("T")[0],a=new Date(n.getFullYear(),n.getMonth()-1,1).toISOString().split("T")[0],i=new Date(n.getFullYear(),n.getMonth(),0).toISOString().split("T")[0],o=K.from("invoices").select("amount, status, invoice_date, paid_at"),c=await rt(o).execute(),d=K.from("expenses").select("amount, expense_date, approved_at"),u=await rt(d).execute(),m=c.filter(P=>P.status==="paid").reduce((P,R)=>P+(R.amount||0),0),f=c.filter(P=>P.status==="paid"&&P.paid_at&&P.paid_at>=r).reduce((P,R)=>P+(R.amount||0),0),p=c.filter(P=>P.status==="paid"&&P.paid_at&&P.paid_at>=a&&P.paid_at<=i).reduce((P,R)=>P+(R.amount||0),0),v=p>0?(f-p)/p*100:0,w=u.filter(P=>P.approved_at).reduce((P,R)=>P+(R.amount||0),0),x=u.filter(P=>P.approved_at&&P.expense_date>=r).reduce((P,R)=>P+(R.amount||0),0),y=u.filter(P=>P.approved_at&&P.expense_date>=a&&P.expense_date<=i).reduce((P,R)=>P+(R.amount||0),0),j=c.filter(P=>P.status==="sent"),b=j.filter(P=>P.due_date&&P.due_date<new Date().toISOString().split("T")[0]),N=j.reduce((P,R)=>P+(R.amount||0),0),S=b.reduce((P,R)=>P+(R.amount||0),0),E=f-x,C=f>0?E/f*100:0;return{revenue:{total:m,this_month:f,last_month:p,growth_rate:v},expenses:{total:w,this_month:x,last_month:y},profit:{total:m-w,this_month:E,margin:C},outstanding:{total:N,overdue:S,count:j.length},cash_flow:{inflow:f,outflow:x,net:f-x}}},"Get financial KPIs")}static async getRevenueByMonth(e=12){return Ue(async()=>{const n=await rt(K.from("invoices").select("amount, status, paid_at").eq("status","paid").not("paid_at","is",null).gte("paid_at",new Date(Date.now()-e*30*24*60*60*1e3).toISOString())).execute(),r={};return n.forEach(a=>{if(a.paid_at){const i=a.paid_at.substring(0,7);r[i]||(r[i]={revenue:0,invoices:0}),r[i].revenue+=a.amount||0,r[i].invoices+=1}}),Object.entries(r).map(([a,i])=>({month:a,revenue:i.revenue,invoices:i.invoices})).sort((a,i)=>a.month.localeCompare(i.month))},"Get revenue by month")}static async getExpensesByCategory(e){return Ue(async()=>{let n=K.from("expenses").select("category, amount").not("approved_at","is",null);e&&(n=n.gte("expense_date",e.from).lte("expense_date",e.to));const r=await rt(n).execute(),a={};return r.forEach(i=>{const o=i.category||"Sonstige";a[o]||(a[o]={amount:0,count:0}),a[o].amount+=i.amount||0,a[o].count+=1}),Object.entries(a).map(([i,o])=>({category:i,amount:o.amount,count:o.count})).sort((i,o)=>o.amount-i.amount)},"Get expenses by category")}static async getProfitLossReport(e){return Ue(async()=>{const r=(await rt(K.from("invoices").select("amount").eq("status","paid").gte("paid_at",e.from).lte("paid_at",e.to)).execute()).reduce((m,f)=>m+(f.amount||0),0),a=await rt(K.from("expenses").select("amount, category").not("approved_at","is",null).gte("expense_date",e.from).lte("expense_date",e.to)).execute(),i=a.filter(m=>["Material","Equipment","Subcontractor"].includes(m.category||"")).reduce((m,f)=>m+(f.amount||0),0),o=a.filter(m=>!["Material","Equipment","Subcontractor"].includes(m.category||"")).reduce((m,f)=>m+(f.amount||0),0),c=r-i,d=c-o,u=r>0?d/r*100:0;return{revenue:r,cost_of_goods:i,gross_profit:c,operating_expenses:o,net_profit:d,margin:u}},"Get profit/loss report")}}const qg=new VW;class KW{static async getDocuments(e,n){return Ue(async()=>{var o;let r=K.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name,
            contact_person
          ),
          uploaded_by_user:profiles!uploaded_by (
            first_name,
            last_name,
            email
          )
        `,{count:"exact"});if(n!=null&&n.category&&(r=r.eq("category",n.category)),n!=null&&n.legal_category&&(r=r.eq("legal_category",n.legal_category)),n!=null&&n.project_id&&(r=r.eq("project_id",n.project_id)),n!=null&&n.customer_id&&(r=r.eq("customer_id",n.customer_id)),n!=null&&n.uploaded_by&&(r=r.eq("uploaded_by",n.uploaded_by)),(o=n==null?void 0:n.tags)!=null&&o.length&&(r=r.overlaps("tags",n.tags)),n!=null&&n.date_from&&(r=r.gte("uploaded_at",n.date_from)),n!=null&&n.date_to&&(r=r.lte("uploaded_at",n.date_to)),n!=null&&n.search&&(r=r.or(`filename.ilike.%${n.search}%,original_filename.ilike.%${n.search}%,description.ilike.%${n.search}%`)),e){const c=(e.page-1)*e.limit;r=r.range(c,c+e.limit-1).order(e.sort_by||"uploaded_at",{ascending:e.sort_order==="asc"})}else r=r.order("uploaded_at",{ascending:!1});const{data:a,count:i}=await rt(r).executeWithCount();return{items:a,pagination:{page:(e==null?void 0:e.page)||1,limit:(e==null?void 0:e.limit)||a.length,total_items:i,total_pages:Math.ceil(i/((e==null?void 0:e.limit)||20)),has_next:e?e.page*e.limit<i:!1,has_prev:e?e.page>1:!1}}},"Get documents")}static async getDocument(e){return Ue(async()=>{const n=K.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name,
            contact_person
          ),
          uploaded_by_user:profiles!uploaded_by (
            first_name,
            last_name,
            email
          )
        `).eq("id",e);return rt(n).executeSingle()},`Get document ${e}`)}static async uploadDocument(e){return Ue(async()=>{const n=await la(),r=e.file;if(r.size>50*1024*1024)throw new et(nt.BUSINESS_RULE_VIOLATION,"Dateigröße darf 50MB nicht überschreiten.",{fileSize:r.size});const a=r.name.split(".").pop()||"",i=Date.now(),o=Math.random().toString(36).substring(2,15),c=`${i}_${o}.${a}`,u=`${this.getStorageFolder(e.category)}/${c}`,{data:m,error:f}=await K.storage.from("documents").upload(u,r,{cacheControl:"3600",upsert:!1});if(f)throw new et(nt.STORAGE_ERROR,`Fehler beim Upload: ${f.message}`,{uploadError:f});let p;if(e.is_public){const{data:j}=K.storage.from("documents").getPublicUrl(u);p=j.publicUrl}let v;if(e.legal_category){const j=this.getRetentionPeriod(e.legal_category);v=new Date(Date.now()+j*365*24*60*60*1e3).toISOString().split("T")[0]}const w={filename:c,original_filename:r.name,file_size:r.size,mime_type:r.type,category:e.category,legal_category:e.legal_category,description:e.description,tags:e.tags||[],project_id:e.project_id,customer_id:e.customer_id,invoice_id:e.invoice_id,expense_id:e.expense_id,storage_path:u,public_url:p,is_public:e.is_public||!1,retention_until:v,uploaded_by:n.id,uploaded_at:new Date().toISOString()},x=K.from("documents").insert(w).select().single(),y=await rt(x).executeSingle();return e.legal_category&&await K.from("immutable_files").insert({document_id:y.id,filename:y.filename,file_hash:await this.calculateFileHash(r),file_size:r.size,legal_category:e.legal_category,uploaded_by:n.id}),mt.emit("DOCUMENT_UPLOADED",{document:y,user_id:n.id}),y},"Upload document")}static async updateDocument(e,n){return Ue(async()=>{const r=await this.getDocument(e),a=await la();if(r.uploaded_by!==a.id&&!a.is_admin)throw new et(nt.UNAUTHORIZED,"Sie können nur Ihre eigenen Dokumente bearbeiten.");let i=r.retention_until;if(n.legal_category&&n.legal_category!==r.legal_category){const u=this.getRetentionPeriod(n.legal_category);i=new Date(Date.now()+u*365*24*60*60*1e3).toISOString().split("T")[0]}const o={...n,retention_until:i},c=K.from("documents").update(o).eq("id",e).select().single(),d=await rt(c).executeSingle();return mt.emit("DOCUMENT_UPDATED",{document:d,previous_document:r,changes:n,user_id:a.id}),d},`Update document ${e}`)}static async getDownloadUrl(e,n=3600){return Ue(async()=>{const r=await this.getDocument(e),a=await la();if(!r.is_public&&r.uploaded_by!==a.id&&!a.is_admin)throw new et(nt.UNAUTHORIZED,"Keine Berechtigung zum Download dieses Dokuments.");const{data:i,error:o}=await K.storage.from("documents").createSignedUrl(r.storage_path,n);if(o||!i)throw new et(nt.STORAGE_ERROR,"Fehler beim Generieren der Download-URL.",{error:o});return mt.emit("DOCUMENT_DOWNLOADED",{document:r,user_id:a.id}),i.signedUrl},`Get download URL for document ${e}`)}static async deleteDocument(e){return Ue(async()=>{const n=await this.getDocument(e),r=await la();if(n.uploaded_by!==r.id&&!r.is_admin)throw new et(nt.UNAUTHORIZED,"Sie können nur Ihre eigenen Dokumente löschen.");if(n.retention_until&&new Date(n.retention_until)>new Date)throw new et(nt.BUSINESS_RULE_VIOLATION,"Dokument kann aufgrund gesetzlicher Aufbewahrungspflicht nicht gelöscht werden.",{retentionUntil:n.retention_until});const{error:a}=await K.storage.from("documents").remove([n.storage_path]);if(a)throw new et(nt.STORAGE_ERROR,`Fehler beim Löschen der Datei: ${a.message}`,{storageError:a});const{error:i}=await K.from("documents").delete().eq("id",e);if(i)throw i;mt.emit("DOCUMENT_DELETED",{document:n,user_id:r.id})},`Delete document ${e}`)}static async getDocumentStats(){return Ue(async()=>(await rt(K.from("documents").select("*")).execute()).reduce((r,a)=>{if(r.total_documents++,r.total_size+=a.file_size,r.by_category[a.category]||(r.by_category[a.category]={count:0,size:0}),r.by_category[a.category].count++,r.by_category[a.category].size+=a.file_size,a.legal_category&&(r.by_legal_category[a.legal_category]||(r.by_legal_category[a.legal_category]={count:0,size:0}),r.by_legal_category[a.legal_category].count++,r.by_legal_category[a.legal_category].size+=a.file_size),a.retention_until){const i=new Date(a.retention_until),o=new Date(Date.now()+30*24*60*60*1e3);i<=o&&r.retention_expiring++}return r},{total_documents:0,total_size:0,by_category:{},by_legal_category:{},retention_expiring:0}),"Get document statistics")}static async searchDocuments(e,n=20){return Ue(async()=>{const r=K.from("documents").select(`
          *,
          projects (
            name,
            project_number
          ),
          customers (
            company_name
          )
        `).or(`filename.ilike.%${e}%,original_filename.ilike.%${e}%,description.ilike.%${e}%`).order("uploaded_at",{ascending:!1}).limit(n);return rt(r).execute()},`Search documents: ${e}`)}static async getExpiringDocuments(e=30){return Ue(async()=>{const n=new Date(Date.now()+e*24*60*60*1e3).toISOString().split("T")[0],r=K.from("documents").select("*").not("retention_until","is",null).lte("retention_until",n).order("retention_until",{ascending:!0});return rt(r).execute()},`Get expiring documents (${e} days)`)}static getStorageFolder(e){return{invoice:"invoices",contract:"contracts",receipt:"receipts",photo:"photos",plan:"plans",report:"reports",other:"other"}[e]||"other"}static getRetentionPeriod(e){return{invoice:10,contract:10,receipt:10,tax_document:10,correspondence:6}[e]||10}static async calculateFileHash(e){const n=await e.arrayBuffer(),r=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(r)).map(i=>i.toString(16).padStart(2,"0")).join("")}}const ZW=new KW;var Uu=(t=>(t[t.UNAUTHORIZED=401]="UNAUTHORIZED",t[t.FORBIDDEN=403]="FORBIDDEN",t[t.NOT_FOUND=404]="NOT_FOUND",t[t.VALIDATION_ERROR=422]="VALIDATION_ERROR",t[t.INTERNAL_ERROR=500]="INTERNAL_ERROR",t))(Uu||{});class po extends Error{constructor(e,n,r){super(e),this.code=n,this.details=r,this.name="ApiError"}}async function Zf(t,e){try{return await t()}catch(n){if(console.error(`API Error in ${e}:`,n),n instanceof po)throw Te.error(`${e}: ${n.message}`),n;const r=n instanceof Error?n.message:"Unbekannter Fehler";throw Te.error(`${e}: ${r}`),new po(r,500)}}async function Dv(){const{data:{user:t},error:e}=await K.auth.getUser();if(e||!t)throw new po("User not authenticated",401);const{data:n,error:r}=await K.from("profiles").select("*").eq("id",t.id).single();if(r)throw new po("User profile not found",404,r.message);return{...t,profile:n}}A.string().uuid(),A.string().email(),A.string().min(1),A.number().min(0),A.number().min(0).max(100),A.string().datetime();A.object({project_id:A.string(),budget:A.number().optional(),date_range:A.object({from:A.string().optional(),to:A.string().optional()}).optional()});A.object({user_id:A.string().uuid(),type:A.enum(["budget_warning","budget_critical","invoice_overdue","project_deadline","time_approval_needed","material_low_stock","system_update","general"]),priority:A.enum(["low","medium","high","urgent"]),title:A.string().min(1).max(200),message:A.string().min(1).max(1e3),data:A.record(A.any()).optional(),expires_at:A.string().datetime().optional(),action_url:A.string().url().optional(),entity_type:A.string().optional(),entity_id:A.string().optional()});A.object({read:A.boolean().optional(),archived:A.boolean().optional()});A.object({entity_type:A.enum(["customer","invoice","quote","order","project","timesheet","material","expense","employee","document","payment"]),entity_id:A.string().min(1),action:A.enum(["CREATE","UPDATE","DELETE","VIEW","PRINT","EXPORT","SEND","APPROVE","REJECT","CANCEL","RESTORE"]),old_values:A.record(A.any()).nullable().optional(),new_values:A.record(A.any()).nullable().optional(),reason:A.string().nullable().optional(),is_automated:A.boolean().optional().default(!1)});var GW={exports:{}};function IT(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Tv={exports:{}};const QW={},YW=Object.freeze(Object.defineProperty({__proto__:null,default:QW},Symbol.toStringTag,{value:"Module"})),XW=NE(YW);var xk;function Qt(){return xk||(xk=1,function(t,e){(function(n,r){t.exports=r()})(gt,function(){var n=n||function(r,a){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof gt<"u"&&gt.crypto&&(i=gt.crypto),!i&&typeof IT=="function")try{i=XW}catch{}var o=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},c=Object.create||function(){function b(){}return function(N){var S;return b.prototype=N,S=new b,b.prototype=null,S}}(),d={},u=d.lib={},m=u.Base=function(){return{extend:function(b){var N=c(this);return b&&N.mixIn(b),(!N.hasOwnProperty("init")||this.init===N.init)&&(N.init=function(){N.$super.init.apply(this,arguments)}),N.init.prototype=N,N.$super=this,N},create:function(){var b=this.extend();return b.init.apply(b,arguments),b},init:function(){},mixIn:function(b){for(var N in b)b.hasOwnProperty(N)&&(this[N]=b[N]);b.hasOwnProperty("toString")&&(this.toString=b.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=u.WordArray=m.extend({init:function(b,N){b=this.words=b||[],N!=a?this.sigBytes=N:this.sigBytes=b.length*4},toString:function(b){return(b||v).stringify(this)},concat:function(b){var N=this.words,S=b.words,E=this.sigBytes,C=b.sigBytes;if(this.clamp(),E%4)for(var P=0;P<C;P++){var R=S[P>>>2]>>>24-P%4*8&255;N[E+P>>>2]|=R<<24-(E+P)%4*8}else for(var H=0;H<C;H+=4)N[E+H>>>2]=S[H>>>2];return this.sigBytes+=C,this},clamp:function(){var b=this.words,N=this.sigBytes;b[N>>>2]&=4294967295<<32-N%4*8,b.length=r.ceil(N/4)},clone:function(){var b=m.clone.call(this);return b.words=this.words.slice(0),b},random:function(b){for(var N=[],S=0;S<b;S+=4)N.push(o());return new f.init(N,b)}}),p=d.enc={},v=p.Hex={stringify:function(b){for(var N=b.words,S=b.sigBytes,E=[],C=0;C<S;C++){var P=N[C>>>2]>>>24-C%4*8&255;E.push((P>>>4).toString(16)),E.push((P&15).toString(16))}return E.join("")},parse:function(b){for(var N=b.length,S=[],E=0;E<N;E+=2)S[E>>>3]|=parseInt(b.substr(E,2),16)<<24-E%8*4;return new f.init(S,N/2)}},w=p.Latin1={stringify:function(b){for(var N=b.words,S=b.sigBytes,E=[],C=0;C<S;C++){var P=N[C>>>2]>>>24-C%4*8&255;E.push(String.fromCharCode(P))}return E.join("")},parse:function(b){for(var N=b.length,S=[],E=0;E<N;E++)S[E>>>2]|=(b.charCodeAt(E)&255)<<24-E%4*8;return new f.init(S,N)}},x=p.Utf8={stringify:function(b){try{return decodeURIComponent(escape(w.stringify(b)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(b){return w.parse(unescape(encodeURIComponent(b)))}},y=u.BufferedBlockAlgorithm=m.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(b){typeof b=="string"&&(b=x.parse(b)),this._data.concat(b),this._nDataBytes+=b.sigBytes},_process:function(b){var N,S=this._data,E=S.words,C=S.sigBytes,P=this.blockSize,R=P*4,H=C/R;b?H=r.ceil(H):H=r.max((H|0)-this._minBufferSize,0);var I=H*P,D=r.min(I*4,C);if(I){for(var W=0;W<I;W+=P)this._doProcessBlock(E,W);N=E.splice(0,I),S.sigBytes-=D}return new f.init(N,D)},clone:function(){var b=m.clone.call(this);return b._data=this._data.clone(),b},_minBufferSize:0});u.Hasher=y.extend({cfg:m.extend(),init:function(b){this.cfg=this.cfg.extend(b),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(b){return this._append(b),this._process(),this},finalize:function(b){b&&this._append(b);var N=this._doFinalize();return N},blockSize:16,_createHelper:function(b){return function(N,S){return new b.init(S).finalize(N)}},_createHmacHelper:function(b){return function(N,S){return new j.HMAC.init(b,S).finalize(N)}}});var j=d.algo={};return d}(Math);return n})}(Tv)),Tv.exports}var Mv={exports:{}},vk;function Hg(){return vk||(vk=1,function(t,e){(function(n,r){t.exports=r(Qt())})(gt,function(n){return function(r){var a=n,i=a.lib,o=i.Base,c=i.WordArray,d=a.x64={};d.Word=o.extend({init:function(u,m){this.high=u,this.low=m}}),d.WordArray=o.extend({init:function(u,m){u=this.words=u||[],m!=r?this.sigBytes=m:this.sigBytes=u.length*8},toX32:function(){for(var u=this.words,m=u.length,f=[],p=0;p<m;p++){var v=u[p];f.push(v.high),f.push(v.low)}return c.create(f,this.sigBytes)},clone:function(){for(var u=o.clone.call(this),m=u.words=this.words.slice(0),f=m.length,p=0;p<f;p++)m[p]=m[p].clone();return u}})}(),n})}(Mv)),Mv.exports}var Rv={exports:{}},yk;function JW(){return yk||(yk=1,function(t,e){(function(n,r){t.exports=r(Qt())})(gt,function(n){return function(){if(typeof ArrayBuffer=="function"){var r=n,a=r.lib,i=a.WordArray,o=i.init,c=i.init=function(d){if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),(d instanceof Int8Array||typeof Uint8ClampedArray<"u"&&d instanceof Uint8ClampedArray||d instanceof Int16Array||d instanceof Uint16Array||d instanceof Int32Array||d instanceof Uint32Array||d instanceof Float32Array||d instanceof Float64Array)&&(d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength)),d instanceof Uint8Array){for(var u=d.byteLength,m=[],f=0;f<u;f++)m[f>>>2]|=d[f]<<24-f%4*8;o.call(this,m,u)}else o.apply(this,arguments)};c.prototype=i}}(),n.lib.WordArray})}(Rv)),Rv.exports}var Iv={exports:{}},_k;function eV(){return _k||(_k=1,function(t,e){(function(n,r){t.exports=r(Qt())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=r.enc;o.Utf16=o.Utf16BE={stringify:function(d){for(var u=d.words,m=d.sigBytes,f=[],p=0;p<m;p+=2){var v=u[p>>>2]>>>16-p%4*8&65535;f.push(String.fromCharCode(v))}return f.join("")},parse:function(d){for(var u=d.length,m=[],f=0;f<u;f++)m[f>>>1]|=d.charCodeAt(f)<<16-f%2*16;return i.create(m,u*2)}},o.Utf16LE={stringify:function(d){for(var u=d.words,m=d.sigBytes,f=[],p=0;p<m;p+=2){var v=c(u[p>>>2]>>>16-p%4*8&65535);f.push(String.fromCharCode(v))}return f.join("")},parse:function(d){for(var u=d.length,m=[],f=0;f<u;f++)m[f>>>1]|=c(d.charCodeAt(f)<<16-f%2*16);return i.create(m,u*2)}};function c(d){return d<<8&4278255360|d>>>8&16711935}}(),n.enc.Utf16})}(Iv)),Iv.exports}var Ov={exports:{}},wk;function ac(){return wk||(wk=1,function(t,e){(function(n,r){t.exports=r(Qt())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=r.enc;o.Base64={stringify:function(d){var u=d.words,m=d.sigBytes,f=this._map;d.clamp();for(var p=[],v=0;v<m;v+=3)for(var w=u[v>>>2]>>>24-v%4*8&255,x=u[v+1>>>2]>>>24-(v+1)%4*8&255,y=u[v+2>>>2]>>>24-(v+2)%4*8&255,j=w<<16|x<<8|y,b=0;b<4&&v+b*.75<m;b++)p.push(f.charAt(j>>>6*(3-b)&63));var N=f.charAt(64);if(N)for(;p.length%4;)p.push(N);return p.join("")},parse:function(d){var u=d.length,m=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var p=0;p<m.length;p++)f[m.charCodeAt(p)]=p}var v=m.charAt(64);if(v){var w=d.indexOf(v);w!==-1&&(u=w)}return c(d,u,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function c(d,u,m){for(var f=[],p=0,v=0;v<u;v++)if(v%4){var w=m[d.charCodeAt(v-1)]<<v%4*2,x=m[d.charCodeAt(v)]>>>6-v%4*2,y=w|x;f[p>>>2]|=y<<24-p%4*8,p++}return i.create(f,p)}}(),n.enc.Base64})}(Ov)),Ov.exports}var Lv={exports:{}},bk;function tV(){return bk||(bk=1,function(t,e){(function(n,r){t.exports=r(Qt())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=r.enc;o.Base64url={stringify:function(d,u){u===void 0&&(u=!0);var m=d.words,f=d.sigBytes,p=u?this._safe_map:this._map;d.clamp();for(var v=[],w=0;w<f;w+=3)for(var x=m[w>>>2]>>>24-w%4*8&255,y=m[w+1>>>2]>>>24-(w+1)%4*8&255,j=m[w+2>>>2]>>>24-(w+2)%4*8&255,b=x<<16|y<<8|j,N=0;N<4&&w+N*.75<f;N++)v.push(p.charAt(b>>>6*(3-N)&63));var S=p.charAt(64);if(S)for(;v.length%4;)v.push(S);return v.join("")},parse:function(d,u){u===void 0&&(u=!0);var m=d.length,f=u?this._safe_map:this._map,p=this._reverseMap;if(!p){p=this._reverseMap=[];for(var v=0;v<f.length;v++)p[f.charCodeAt(v)]=v}var w=f.charAt(64);if(w){var x=d.indexOf(w);x!==-1&&(m=x)}return c(d,m,p)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function c(d,u,m){for(var f=[],p=0,v=0;v<u;v++)if(v%4){var w=m[d.charCodeAt(v-1)]<<v%4*2,x=m[d.charCodeAt(v)]>>>6-v%4*2,y=w|x;f[p>>>2]|=y<<24-p%4*8,p++}return i.create(f,p)}}(),n.enc.Base64url})}(Lv)),Lv.exports}var Fv={exports:{}},jk;function ic(){return jk||(jk=1,function(t,e){(function(n,r){t.exports=r(Qt())})(gt,function(n){return function(r){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.algo,u=[];(function(){for(var x=0;x<64;x++)u[x]=r.abs(r.sin(x+1))*4294967296|0})();var m=d.MD5=c.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(x,y){for(var j=0;j<16;j++){var b=y+j,N=x[b];x[b]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360}var S=this._hash.words,E=x[y+0],C=x[y+1],P=x[y+2],R=x[y+3],H=x[y+4],I=x[y+5],D=x[y+6],W=x[y+7],V=x[y+8],G=x[y+9],Y=x[y+10],X=x[y+11],F=x[y+12],T=x[y+13],q=x[y+14],U=x[y+15],B=S[0],O=S[1],z=S[2],$=S[3];B=f(B,O,z,$,E,7,u[0]),$=f($,B,O,z,C,12,u[1]),z=f(z,$,B,O,P,17,u[2]),O=f(O,z,$,B,R,22,u[3]),B=f(B,O,z,$,H,7,u[4]),$=f($,B,O,z,I,12,u[5]),z=f(z,$,B,O,D,17,u[6]),O=f(O,z,$,B,W,22,u[7]),B=f(B,O,z,$,V,7,u[8]),$=f($,B,O,z,G,12,u[9]),z=f(z,$,B,O,Y,17,u[10]),O=f(O,z,$,B,X,22,u[11]),B=f(B,O,z,$,F,7,u[12]),$=f($,B,O,z,T,12,u[13]),z=f(z,$,B,O,q,17,u[14]),O=f(O,z,$,B,U,22,u[15]),B=p(B,O,z,$,C,5,u[16]),$=p($,B,O,z,D,9,u[17]),z=p(z,$,B,O,X,14,u[18]),O=p(O,z,$,B,E,20,u[19]),B=p(B,O,z,$,I,5,u[20]),$=p($,B,O,z,Y,9,u[21]),z=p(z,$,B,O,U,14,u[22]),O=p(O,z,$,B,H,20,u[23]),B=p(B,O,z,$,G,5,u[24]),$=p($,B,O,z,q,9,u[25]),z=p(z,$,B,O,R,14,u[26]),O=p(O,z,$,B,V,20,u[27]),B=p(B,O,z,$,T,5,u[28]),$=p($,B,O,z,P,9,u[29]),z=p(z,$,B,O,W,14,u[30]),O=p(O,z,$,B,F,20,u[31]),B=v(B,O,z,$,I,4,u[32]),$=v($,B,O,z,V,11,u[33]),z=v(z,$,B,O,X,16,u[34]),O=v(O,z,$,B,q,23,u[35]),B=v(B,O,z,$,C,4,u[36]),$=v($,B,O,z,H,11,u[37]),z=v(z,$,B,O,W,16,u[38]),O=v(O,z,$,B,Y,23,u[39]),B=v(B,O,z,$,T,4,u[40]),$=v($,B,O,z,E,11,u[41]),z=v(z,$,B,O,R,16,u[42]),O=v(O,z,$,B,D,23,u[43]),B=v(B,O,z,$,G,4,u[44]),$=v($,B,O,z,F,11,u[45]),z=v(z,$,B,O,U,16,u[46]),O=v(O,z,$,B,P,23,u[47]),B=w(B,O,z,$,E,6,u[48]),$=w($,B,O,z,W,10,u[49]),z=w(z,$,B,O,q,15,u[50]),O=w(O,z,$,B,I,21,u[51]),B=w(B,O,z,$,F,6,u[52]),$=w($,B,O,z,R,10,u[53]),z=w(z,$,B,O,Y,15,u[54]),O=w(O,z,$,B,C,21,u[55]),B=w(B,O,z,$,V,6,u[56]),$=w($,B,O,z,U,10,u[57]),z=w(z,$,B,O,D,15,u[58]),O=w(O,z,$,B,T,21,u[59]),B=w(B,O,z,$,H,6,u[60]),$=w($,B,O,z,X,10,u[61]),z=w(z,$,B,O,P,15,u[62]),O=w(O,z,$,B,G,21,u[63]),S[0]=S[0]+B|0,S[1]=S[1]+O|0,S[2]=S[2]+z|0,S[3]=S[3]+$|0},_doFinalize:function(){var x=this._data,y=x.words,j=this._nDataBytes*8,b=x.sigBytes*8;y[b>>>5]|=128<<24-b%32;var N=r.floor(j/4294967296),S=j;y[(b+64>>>9<<4)+15]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,y[(b+64>>>9<<4)+14]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,x.sigBytes=(y.length+1)*4,this._process();for(var E=this._hash,C=E.words,P=0;P<4;P++){var R=C[P];C[P]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360}return E},clone:function(){var x=c.clone.call(this);return x._hash=this._hash.clone(),x}});function f(x,y,j,b,N,S,E){var C=x+(y&j|~y&b)+N+E;return(C<<S|C>>>32-S)+y}function p(x,y,j,b,N,S,E){var C=x+(y&b|j&~b)+N+E;return(C<<S|C>>>32-S)+y}function v(x,y,j,b,N,S,E){var C=x+(y^j^b)+N+E;return(C<<S|C>>>32-S)+y}function w(x,y,j,b,N,S,E){var C=x+(j^(y|~b))+N+E;return(C<<S|C>>>32-S)+y}a.MD5=c._createHelper(m),a.HmacMD5=c._createHmacHelper(m)}(Math),n.MD5})}(Fv)),Fv.exports}var Bv={exports:{}},Nk;function OT(){return Nk||(Nk=1,function(t,e){(function(n,r){t.exports=r(Qt())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=a.Hasher,c=r.algo,d=[],u=c.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,f){for(var p=this._hash.words,v=p[0],w=p[1],x=p[2],y=p[3],j=p[4],b=0;b<80;b++){if(b<16)d[b]=m[f+b]|0;else{var N=d[b-3]^d[b-8]^d[b-14]^d[b-16];d[b]=N<<1|N>>>31}var S=(v<<5|v>>>27)+j+d[b];b<20?S+=(w&x|~w&y)+1518500249:b<40?S+=(w^x^y)+1859775393:b<60?S+=(w&x|w&y|x&y)-1894007588:S+=(w^x^y)-899497514,j=y,y=x,x=w<<30|w>>>2,w=v,v=S}p[0]=p[0]+v|0,p[1]=p[1]+w|0,p[2]=p[2]+x|0,p[3]=p[3]+y|0,p[4]=p[4]+j|0},_doFinalize:function(){var m=this._data,f=m.words,p=this._nDataBytes*8,v=m.sigBytes*8;return f[v>>>5]|=128<<24-v%32,f[(v+64>>>9<<4)+14]=Math.floor(p/4294967296),f[(v+64>>>9<<4)+15]=p,m.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var m=o.clone.call(this);return m._hash=this._hash.clone(),m}});r.SHA1=o._createHelper(u),r.HmacSHA1=o._createHmacHelper(u)}(),n.SHA1})}(Bv)),Bv.exports}var zv={exports:{}},Sk;function $j(){return Sk||(Sk=1,function(t,e){(function(n,r){t.exports=r(Qt())})(gt,function(n){return function(r){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.algo,u=[],m=[];(function(){function v(j){for(var b=r.sqrt(j),N=2;N<=b;N++)if(!(j%N))return!1;return!0}function w(j){return(j-(j|0))*4294967296|0}for(var x=2,y=0;y<64;)v(x)&&(y<8&&(u[y]=w(r.pow(x,1/2))),m[y]=w(r.pow(x,1/3)),y++),x++})();var f=[],p=d.SHA256=c.extend({_doReset:function(){this._hash=new o.init(u.slice(0))},_doProcessBlock:function(v,w){for(var x=this._hash.words,y=x[0],j=x[1],b=x[2],N=x[3],S=x[4],E=x[5],C=x[6],P=x[7],R=0;R<64;R++){if(R<16)f[R]=v[w+R]|0;else{var H=f[R-15],I=(H<<25|H>>>7)^(H<<14|H>>>18)^H>>>3,D=f[R-2],W=(D<<15|D>>>17)^(D<<13|D>>>19)^D>>>10;f[R]=I+f[R-7]+W+f[R-16]}var V=S&E^~S&C,G=y&j^y&b^j&b,Y=(y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22),X=(S<<26|S>>>6)^(S<<21|S>>>11)^(S<<7|S>>>25),F=P+X+V+m[R]+f[R],T=Y+G;P=C,C=E,E=S,S=N+F|0,N=b,b=j,j=y,y=F+T|0}x[0]=x[0]+y|0,x[1]=x[1]+j|0,x[2]=x[2]+b|0,x[3]=x[3]+N|0,x[4]=x[4]+S|0,x[5]=x[5]+E|0,x[6]=x[6]+C|0,x[7]=x[7]+P|0},_doFinalize:function(){var v=this._data,w=v.words,x=this._nDataBytes*8,y=v.sigBytes*8;return w[y>>>5]|=128<<24-y%32,w[(y+64>>>9<<4)+14]=r.floor(x/4294967296),w[(y+64>>>9<<4)+15]=x,v.sigBytes=w.length*4,this._process(),this._hash},clone:function(){var v=c.clone.call(this);return v._hash=this._hash.clone(),v}});a.SHA256=c._createHelper(p),a.HmacSHA256=c._createHmacHelper(p)}(Math),n.SHA256})}(zv)),zv.exports}var $v={exports:{}},kk;function nV(){return kk||(kk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),$j())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=r.algo,c=o.SHA256,d=o.SHA224=c.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var u=c._doFinalize.call(this);return u.sigBytes-=4,u}});r.SHA224=c._createHelper(d),r.HmacSHA224=c._createHmacHelper(d)}(),n.SHA224})}($v)),$v.exports}var Uv={exports:{}},Ck;function LT(){return Ck||(Ck=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),Hg())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.Hasher,o=r.x64,c=o.Word,d=o.WordArray,u=r.algo;function m(){return c.create.apply(c,arguments)}var f=[m(1116352408,3609767458),m(1899447441,602891725),m(3049323471,3964484399),m(3921009573,2173295548),m(961987163,4081628472),m(1508970993,3053834265),m(2453635748,2937671579),m(2870763221,3664609560),m(3624381080,2734883394),m(310598401,1164996542),m(607225278,1323610764),m(1426881987,3590304994),m(1925078388,4068182383),m(2162078206,991336113),m(2614888103,633803317),m(3248222580,3479774868),m(3835390401,2666613458),m(4022224774,944711139),m(264347078,2341262773),m(604807628,2007800933),m(770255983,1495990901),m(1249150122,1856431235),m(1555081692,3175218132),m(1996064986,2198950837),m(2554220882,3999719339),m(2821834349,766784016),m(2952996808,2566594879),m(3210313671,3203337956),m(3336571891,1034457026),m(3584528711,2466948901),m(113926993,3758326383),m(338241895,168717936),m(666307205,1188179964),m(773529912,1546045734),m(1294757372,1522805485),m(1396182291,2643833823),m(1695183700,2343527390),m(1986661051,1014477480),m(2177026350,1206759142),m(2456956037,344077627),m(2730485921,1290863460),m(2820302411,3158454273),m(3259730800,3505952657),m(3345764771,106217008),m(3516065817,3606008344),m(3600352804,1432725776),m(4094571909,1467031594),m(275423344,851169720),m(430227734,3100823752),m(506948616,1363258195),m(659060556,3750685593),m(883997877,3785050280),m(958139571,3318307427),m(1322822218,3812723403),m(1537002063,2003034995),m(1747873779,3602036899),m(1955562222,1575990012),m(2024104815,1125592928),m(2227730452,2716904306),m(2361852424,442776044),m(2428436474,593698344),m(2756734187,3733110249),m(3204031479,2999351573),m(3329325298,3815920427),m(3391569614,3928383900),m(3515267271,566280711),m(3940187606,3454069534),m(4118630271,4000239992),m(116418474,1914138554),m(174292421,2731055270),m(289380356,3203993006),m(460393269,320620315),m(685471733,587496836),m(852142971,1086792851),m(1017036298,365543100),m(1126000580,2618297676),m(1288033470,3409855158),m(1501505948,4234509866),m(1607167915,987167468),m(1816402316,1246189591)],p=[];(function(){for(var w=0;w<80;w++)p[w]=m()})();var v=u.SHA512=i.extend({_doReset:function(){this._hash=new d.init([new c.init(1779033703,4089235720),new c.init(3144134277,2227873595),new c.init(1013904242,4271175723),new c.init(2773480762,1595750129),new c.init(1359893119,2917565137),new c.init(2600822924,725511199),new c.init(528734635,4215389547),new c.init(1541459225,327033209)])},_doProcessBlock:function(w,x){for(var y=this._hash.words,j=y[0],b=y[1],N=y[2],S=y[3],E=y[4],C=y[5],P=y[6],R=y[7],H=j.high,I=j.low,D=b.high,W=b.low,V=N.high,G=N.low,Y=S.high,X=S.low,F=E.high,T=E.low,q=C.high,U=C.low,B=P.high,O=P.low,z=R.high,$=R.low,te=H,ee=I,Q=D,le=W,pe=V,J=G,ae=Y,fe=X,he=F,ve=T,ie=q,_e=U,Se=B,Ve=O,Xe=z,Et=$,ke=0;ke<80;ke++){var Le,ze,dt=p[ke];if(ke<16)ze=dt.high=w[x+ke*2]|0,Le=dt.low=w[x+ke*2+1]|0;else{var Ze=p[ke-15],Fe=Ze.high,Nt=Ze.low,vt=(Fe>>>1|Nt<<31)^(Fe>>>8|Nt<<24)^Fe>>>7,Vn=(Nt>>>1|Fe<<31)^(Nt>>>8|Fe<<24)^(Nt>>>7|Fe<<25),js=p[ke-2],yt=js.high,cn=js.low,On=(yt>>>19|cn<<13)^(yt<<3|cn>>>29)^yt>>>6,hs=(cn>>>19|yt<<13)^(cn<<3|yt>>>29)^(cn>>>6|yt<<26),Kn=p[ke-7],Pn=Kn.high,Ms=Kn.low,ot=p[ke-16],we=ot.high,be=ot.low;Le=Vn+Ms,ze=vt+Pn+(Le>>>0<Vn>>>0?1:0),Le=Le+hs,ze=ze+On+(Le>>>0<hs>>>0?1:0),Le=Le+be,ze=ze+we+(Le>>>0<be>>>0?1:0),dt.high=ze,dt.low=Le}var Ee=he&ie^~he&Se,$e=ve&_e^~ve&Ve,st=te&Q^te&pe^Q&pe,Yt=ee&le^ee&J^le&J,ns=(te>>>28|ee<<4)^(te<<30|ee>>>2)^(te<<25|ee>>>7),Zr=(ee>>>28|te<<4)^(ee<<30|te>>>2)^(ee<<25|te>>>7),Ii=(he>>>14|ve<<18)^(he>>>18|ve<<14)^(he<<23|ve>>>9),Qo=(ve>>>14|he<<18)^(ve>>>18|he<<14)^(ve<<23|he>>>9),Gr=f[ke],lu=Gr.high,dc=Gr.low,Ln=Et+Qo,ja=Xe+Ii+(Ln>>>0<Et>>>0?1:0),Ln=Ln+$e,ja=ja+Ee+(Ln>>>0<$e>>>0?1:0),Ln=Ln+dc,ja=ja+lu+(Ln>>>0<dc>>>0?1:0),Ln=Ln+Le,ja=ja+ze+(Ln>>>0<Le>>>0?1:0),rr=Zr+Yt,at=ns+st+(rr>>>0<Zr>>>0?1:0);Xe=Se,Et=Ve,Se=ie,Ve=_e,ie=he,_e=ve,ve=fe+Ln|0,he=ae+ja+(ve>>>0<fe>>>0?1:0)|0,ae=pe,fe=J,pe=Q,J=le,Q=te,le=ee,ee=Ln+rr|0,te=ja+at+(ee>>>0<Ln>>>0?1:0)|0}I=j.low=I+ee,j.high=H+te+(I>>>0<ee>>>0?1:0),W=b.low=W+le,b.high=D+Q+(W>>>0<le>>>0?1:0),G=N.low=G+J,N.high=V+pe+(G>>>0<J>>>0?1:0),X=S.low=X+fe,S.high=Y+ae+(X>>>0<fe>>>0?1:0),T=E.low=T+ve,E.high=F+he+(T>>>0<ve>>>0?1:0),U=C.low=U+_e,C.high=q+ie+(U>>>0<_e>>>0?1:0),O=P.low=O+Ve,P.high=B+Se+(O>>>0<Ve>>>0?1:0),$=R.low=$+Et,R.high=z+Xe+($>>>0<Et>>>0?1:0)},_doFinalize:function(){var w=this._data,x=w.words,y=this._nDataBytes*8,j=w.sigBytes*8;x[j>>>5]|=128<<24-j%32,x[(j+128>>>10<<5)+30]=Math.floor(y/4294967296),x[(j+128>>>10<<5)+31]=y,w.sigBytes=x.length*4,this._process();var b=this._hash.toX32();return b},clone:function(){var w=i.clone.call(this);return w._hash=this._hash.clone(),w},blockSize:1024/32});r.SHA512=i._createHelper(v),r.HmacSHA512=i._createHmacHelper(v)}(),n.SHA512})}(Uv)),Uv.exports}var qv={exports:{}},Ek;function sV(){return Ek||(Ek=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),Hg(),LT())})(gt,function(n){return function(){var r=n,a=r.x64,i=a.Word,o=a.WordArray,c=r.algo,d=c.SHA512,u=c.SHA384=d.extend({_doReset:function(){this._hash=new o.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var m=d._doFinalize.call(this);return m.sigBytes-=16,m}});r.SHA384=d._createHelper(u),r.HmacSHA384=d._createHmacHelper(u)}(),n.SHA384})}(qv)),qv.exports}var Hv={exports:{}},Ak;function rV(){return Ak||(Ak=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),Hg())})(gt,function(n){return function(r){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.x64,u=d.Word,m=a.algo,f=[],p=[],v=[];(function(){for(var y=1,j=0,b=0;b<24;b++){f[y+5*j]=(b+1)*(b+2)/2%64;var N=j%5,S=(2*y+3*j)%5;y=N,j=S}for(var y=0;y<5;y++)for(var j=0;j<5;j++)p[y+5*j]=j+(2*y+3*j)%5*5;for(var E=1,C=0;C<24;C++){for(var P=0,R=0,H=0;H<7;H++){if(E&1){var I=(1<<H)-1;I<32?R^=1<<I:P^=1<<I-32}E&128?E=E<<1^113:E<<=1}v[C]=u.create(P,R)}})();var w=[];(function(){for(var y=0;y<25;y++)w[y]=u.create()})();var x=m.SHA3=c.extend({cfg:c.cfg.extend({outputLength:512}),_doReset:function(){for(var y=this._state=[],j=0;j<25;j++)y[j]=new u.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(y,j){for(var b=this._state,N=this.blockSize/2,S=0;S<N;S++){var E=y[j+2*S],C=y[j+2*S+1];E=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360;var P=b[S];P.high^=C,P.low^=E}for(var R=0;R<24;R++){for(var H=0;H<5;H++){for(var I=0,D=0,W=0;W<5;W++){var P=b[H+5*W];I^=P.high,D^=P.low}var V=w[H];V.high=I,V.low=D}for(var H=0;H<5;H++)for(var G=w[(H+4)%5],Y=w[(H+1)%5],X=Y.high,F=Y.low,I=G.high^(X<<1|F>>>31),D=G.low^(F<<1|X>>>31),W=0;W<5;W++){var P=b[H+5*W];P.high^=I,P.low^=D}for(var T=1;T<25;T++){var I,D,P=b[T],q=P.high,U=P.low,B=f[T];B<32?(I=q<<B|U>>>32-B,D=U<<B|q>>>32-B):(I=U<<B-32|q>>>64-B,D=q<<B-32|U>>>64-B);var O=w[p[T]];O.high=I,O.low=D}var z=w[0],$=b[0];z.high=$.high,z.low=$.low;for(var H=0;H<5;H++)for(var W=0;W<5;W++){var T=H+5*W,P=b[T],te=w[T],ee=w[(H+1)%5+5*W],Q=w[(H+2)%5+5*W];P.high=te.high^~ee.high&Q.high,P.low=te.low^~ee.low&Q.low}var P=b[0],le=v[R];P.high^=le.high,P.low^=le.low}},_doFinalize:function(){var y=this._data,j=y.words;this._nDataBytes*8;var b=y.sigBytes*8,N=this.blockSize*32;j[b>>>5]|=1<<24-b%32,j[(r.ceil((b+1)/N)*N>>>5)-1]|=128,y.sigBytes=j.length*4,this._process();for(var S=this._state,E=this.cfg.outputLength/8,C=E/8,P=[],R=0;R<C;R++){var H=S[R],I=H.high,D=H.low;I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,D=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,P.push(D),P.push(I)}return new o.init(P,E)},clone:function(){for(var y=c.clone.call(this),j=y._state=this._state.slice(0),b=0;b<25;b++)j[b]=j[b].clone();return y}});a.SHA3=c._createHelper(x),a.HmacSHA3=c._createHmacHelper(x)}(Math),n.SHA3})}(Hv)),Hv.exports}var Wv={exports:{}},Pk;function aV(){return Pk||(Pk=1,function(t,e){(function(n,r){t.exports=r(Qt())})(gt,function(n){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(r){var a=n,i=a.lib,o=i.WordArray,c=i.Hasher,d=a.algo,u=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),m=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),p=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),v=o.create([0,1518500249,1859775393,2400959708,2840853838]),w=o.create([1352829926,1548603684,1836072691,2053994217,0]),x=d.RIPEMD160=c.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(C,P){for(var R=0;R<16;R++){var H=P+R,I=C[H];C[H]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360}var D=this._hash.words,W=v.words,V=w.words,G=u.words,Y=m.words,X=f.words,F=p.words,T,q,U,B,O,z,$,te,ee,Q;z=T=D[0],$=q=D[1],te=U=D[2],ee=B=D[3],Q=O=D[4];for(var le,R=0;R<80;R+=1)le=T+C[P+G[R]]|0,R<16?le+=y(q,U,B)+W[0]:R<32?le+=j(q,U,B)+W[1]:R<48?le+=b(q,U,B)+W[2]:R<64?le+=N(q,U,B)+W[3]:le+=S(q,U,B)+W[4],le=le|0,le=E(le,X[R]),le=le+O|0,T=O,O=B,B=E(U,10),U=q,q=le,le=z+C[P+Y[R]]|0,R<16?le+=S($,te,ee)+V[0]:R<32?le+=N($,te,ee)+V[1]:R<48?le+=b($,te,ee)+V[2]:R<64?le+=j($,te,ee)+V[3]:le+=y($,te,ee)+V[4],le=le|0,le=E(le,F[R]),le=le+Q|0,z=Q,Q=ee,ee=E(te,10),te=$,$=le;le=D[1]+U+ee|0,D[1]=D[2]+B+Q|0,D[2]=D[3]+O+z|0,D[3]=D[4]+T+$|0,D[4]=D[0]+q+te|0,D[0]=le},_doFinalize:function(){var C=this._data,P=C.words,R=this._nDataBytes*8,H=C.sigBytes*8;P[H>>>5]|=128<<24-H%32,P[(H+64>>>9<<4)+14]=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360,C.sigBytes=(P.length+1)*4,this._process();for(var I=this._hash,D=I.words,W=0;W<5;W++){var V=D[W];D[W]=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360}return I},clone:function(){var C=c.clone.call(this);return C._hash=this._hash.clone(),C}});function y(C,P,R){return C^P^R}function j(C,P,R){return C&P|~C&R}function b(C,P,R){return(C|~P)^R}function N(C,P,R){return C&R|P&~R}function S(C,P,R){return C^(P|~R)}function E(C,P){return C<<P|C>>>32-P}a.RIPEMD160=c._createHelper(x),a.HmacRIPEMD160=c._createHmacHelper(x)}(),n.RIPEMD160})}(Wv)),Wv.exports}var Vv={exports:{}},Dk;function Uj(){return Dk||(Dk=1,function(t,e){(function(n,r){t.exports=r(Qt())})(gt,function(n){(function(){var r=n,a=r.lib,i=a.Base,o=r.enc,c=o.Utf8,d=r.algo;d.HMAC=i.extend({init:function(u,m){u=this._hasher=new u.init,typeof m=="string"&&(m=c.parse(m));var f=u.blockSize,p=f*4;m.sigBytes>p&&(m=u.finalize(m)),m.clamp();for(var v=this._oKey=m.clone(),w=this._iKey=m.clone(),x=v.words,y=w.words,j=0;j<f;j++)x[j]^=1549556828,y[j]^=909522486;v.sigBytes=w.sigBytes=p,this.reset()},reset:function(){var u=this._hasher;u.reset(),u.update(this._iKey)},update:function(u){return this._hasher.update(u),this},finalize:function(u){var m=this._hasher,f=m.finalize(u);m.reset();var p=m.finalize(this._oKey.clone().concat(f));return p}})})()})}(Vv)),Vv.exports}var Kv={exports:{}},Tk;function iV(){return Tk||(Tk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),$j(),Uj())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.Base,o=a.WordArray,c=r.algo,d=c.SHA256,u=c.HMAC,m=c.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:d,iterations:25e4}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,p){for(var v=this.cfg,w=u.create(v.hasher,f),x=o.create(),y=o.create([1]),j=x.words,b=y.words,N=v.keySize,S=v.iterations;j.length<N;){var E=w.update(p).finalize(y);w.reset();for(var C=E.words,P=C.length,R=E,H=1;H<S;H++){R=w.finalize(R),w.reset();for(var I=R.words,D=0;D<P;D++)C[D]^=I[D]}x.concat(E),b[0]++}return x.sigBytes=N*4,x}});r.PBKDF2=function(f,p,v){return m.create(v).compute(f,p)}}(),n.PBKDF2})}(Kv)),Kv.exports}var Zv={exports:{}},Mk;function Vo(){return Mk||(Mk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),OT(),Uj())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.Base,o=a.WordArray,c=r.algo,d=c.MD5,u=c.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:d,iterations:1}),init:function(m){this.cfg=this.cfg.extend(m)},compute:function(m,f){for(var p,v=this.cfg,w=v.hasher.create(),x=o.create(),y=x.words,j=v.keySize,b=v.iterations;y.length<j;){p&&w.update(p),p=w.update(m).finalize(f),w.reset();for(var N=1;N<b;N++)p=w.finalize(p),w.reset();x.concat(p)}return x.sigBytes=j*4,x}});r.EvpKDF=function(m,f,p){return u.create(p).compute(m,f)}}(),n.EvpKDF})}(Zv)),Zv.exports}var Gv={exports:{}},Rk;function us(){return Rk||(Rk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),Vo())})(gt,function(n){n.lib.Cipher||function(r){var a=n,i=a.lib,o=i.Base,c=i.WordArray,d=i.BufferedBlockAlgorithm,u=a.enc;u.Utf8;var m=u.Base64,f=a.algo,p=f.EvpKDF,v=i.Cipher=d.extend({cfg:o.extend(),createEncryptor:function(I,D){return this.create(this._ENC_XFORM_MODE,I,D)},createDecryptor:function(I,D){return this.create(this._DEC_XFORM_MODE,I,D)},init:function(I,D,W){this.cfg=this.cfg.extend(W),this._xformMode=I,this._key=D,this.reset()},reset:function(){d.reset.call(this),this._doReset()},process:function(I){return this._append(I),this._process()},finalize:function(I){I&&this._append(I);var D=this._doFinalize();return D},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function I(D){return typeof D=="string"?H:C}return function(D){return{encrypt:function(W,V,G){return I(V).encrypt(D,W,V,G)},decrypt:function(W,V,G){return I(V).decrypt(D,W,V,G)}}}}()});i.StreamCipher=v.extend({_doFinalize:function(){var I=this._process(!0);return I},blockSize:1});var w=a.mode={},x=i.BlockCipherMode=o.extend({createEncryptor:function(I,D){return this.Encryptor.create(I,D)},createDecryptor:function(I,D){return this.Decryptor.create(I,D)},init:function(I,D){this._cipher=I,this._iv=D}}),y=w.CBC=function(){var I=x.extend();I.Encryptor=I.extend({processBlock:function(W,V){var G=this._cipher,Y=G.blockSize;D.call(this,W,V,Y),G.encryptBlock(W,V),this._prevBlock=W.slice(V,V+Y)}}),I.Decryptor=I.extend({processBlock:function(W,V){var G=this._cipher,Y=G.blockSize,X=W.slice(V,V+Y);G.decryptBlock(W,V),D.call(this,W,V,Y),this._prevBlock=X}});function D(W,V,G){var Y,X=this._iv;X?(Y=X,this._iv=r):Y=this._prevBlock;for(var F=0;F<G;F++)W[V+F]^=Y[F]}return I}(),j=a.pad={},b=j.Pkcs7={pad:function(I,D){for(var W=D*4,V=W-I.sigBytes%W,G=V<<24|V<<16|V<<8|V,Y=[],X=0;X<V;X+=4)Y.push(G);var F=c.create(Y,V);I.concat(F)},unpad:function(I){var D=I.words[I.sigBytes-1>>>2]&255;I.sigBytes-=D}};i.BlockCipher=v.extend({cfg:v.cfg.extend({mode:y,padding:b}),reset:function(){var I;v.reset.call(this);var D=this.cfg,W=D.iv,V=D.mode;this._xformMode==this._ENC_XFORM_MODE?I=V.createEncryptor:(I=V.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==I?this._mode.init(this,W&&W.words):(this._mode=I.call(V,this,W&&W.words),this._mode.__creator=I)},_doProcessBlock:function(I,D){this._mode.processBlock(I,D)},_doFinalize:function(){var I,D=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(D.pad(this._data,this.blockSize),I=this._process(!0)):(I=this._process(!0),D.unpad(I)),I},blockSize:128/32});var N=i.CipherParams=o.extend({init:function(I){this.mixIn(I)},toString:function(I){return(I||this.formatter).stringify(this)}}),S=a.format={},E=S.OpenSSL={stringify:function(I){var D,W=I.ciphertext,V=I.salt;return V?D=c.create([1398893684,1701076831]).concat(V).concat(W):D=W,D.toString(m)},parse:function(I){var D,W=m.parse(I),V=W.words;return V[0]==1398893684&&V[1]==1701076831&&(D=c.create(V.slice(2,4)),V.splice(0,4),W.sigBytes-=16),N.create({ciphertext:W,salt:D})}},C=i.SerializableCipher=o.extend({cfg:o.extend({format:E}),encrypt:function(I,D,W,V){V=this.cfg.extend(V);var G=I.createEncryptor(W,V),Y=G.finalize(D),X=G.cfg;return N.create({ciphertext:Y,key:W,iv:X.iv,algorithm:I,mode:X.mode,padding:X.padding,blockSize:I.blockSize,formatter:V.format})},decrypt:function(I,D,W,V){V=this.cfg.extend(V),D=this._parse(D,V.format);var G=I.createDecryptor(W,V).finalize(D.ciphertext);return G},_parse:function(I,D){return typeof I=="string"?D.parse(I,this):I}}),P=a.kdf={},R=P.OpenSSL={execute:function(I,D,W,V,G){if(V||(V=c.random(64/8)),G)var Y=p.create({keySize:D+W,hasher:G}).compute(I,V);else var Y=p.create({keySize:D+W}).compute(I,V);var X=c.create(Y.words.slice(D),W*4);return Y.sigBytes=D*4,N.create({key:Y,iv:X,salt:V})}},H=i.PasswordBasedCipher=C.extend({cfg:C.cfg.extend({kdf:R}),encrypt:function(I,D,W,V){V=this.cfg.extend(V);var G=V.kdf.execute(W,I.keySize,I.ivSize,V.salt,V.hasher);V.iv=G.iv;var Y=C.encrypt.call(this,I,D,G.key,V);return Y.mixIn(G),Y},decrypt:function(I,D,W,V){V=this.cfg.extend(V),D=this._parse(D,V.format);var G=V.kdf.execute(W,I.keySize,I.ivSize,D.salt,V.hasher);V.iv=G.iv;var Y=C.decrypt.call(this,I,D,G.key,V);return Y}})}()})}(Gv)),Gv.exports}var Qv={exports:{}},Ik;function oV(){return Ik||(Ik=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),us())})(gt,function(n){return n.mode.CFB=function(){var r=n.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize;a.call(this,i,o,d,c),this._prevBlock=i.slice(o,o+d)}}),r.Decryptor=r.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize,u=i.slice(o,o+d);a.call(this,i,o,d,c),this._prevBlock=u}});function a(i,o,c,d){var u,m=this._iv;m?(u=m.slice(0),this._iv=void 0):u=this._prevBlock,d.encryptBlock(u,0);for(var f=0;f<c;f++)i[o+f]^=u[f]}return r}(),n.mode.CFB})}(Qv)),Qv.exports}var Yv={exports:{}},Ok;function lV(){return Ok||(Ok=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),us())})(gt,function(n){return n.mode.CTR=function(){var r=n.lib.BlockCipherMode.extend(),a=r.Encryptor=r.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize,u=this._iv,m=this._counter;u&&(m=this._counter=u.slice(0),this._iv=void 0);var f=m.slice(0);c.encryptBlock(f,0),m[d-1]=m[d-1]+1|0;for(var p=0;p<d;p++)i[o+p]^=f[p]}});return r.Decryptor=a,r}(),n.mode.CTR})}(Yv)),Yv.exports}var Xv={exports:{}},Lk;function cV(){return Lk||(Lk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),us())})(gt,function(n){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return n.mode.CTRGladman=function(){var r=n.lib.BlockCipherMode.extend();function a(c){if((c>>24&255)===255){var d=c>>16&255,u=c>>8&255,m=c&255;d===255?(d=0,u===255?(u=0,m===255?m=0:++m):++u):++d,c=0,c+=d<<16,c+=u<<8,c+=m}else c+=1<<24;return c}function i(c){return(c[0]=a(c[0]))===0&&(c[1]=a(c[1])),c}var o=r.Encryptor=r.extend({processBlock:function(c,d){var u=this._cipher,m=u.blockSize,f=this._iv,p=this._counter;f&&(p=this._counter=f.slice(0),this._iv=void 0),i(p);var v=p.slice(0);u.encryptBlock(v,0);for(var w=0;w<m;w++)c[d+w]^=v[w]}});return r.Decryptor=o,r}(),n.mode.CTRGladman})}(Xv)),Xv.exports}var Jv={exports:{}},Fk;function dV(){return Fk||(Fk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),us())})(gt,function(n){return n.mode.OFB=function(){var r=n.lib.BlockCipherMode.extend(),a=r.Encryptor=r.extend({processBlock:function(i,o){var c=this._cipher,d=c.blockSize,u=this._iv,m=this._keystream;u&&(m=this._keystream=u.slice(0),this._iv=void 0),c.encryptBlock(m,0);for(var f=0;f<d;f++)i[o+f]^=m[f]}});return r.Decryptor=a,r}(),n.mode.OFB})}(Jv)),Jv.exports}var ey={exports:{}},Bk;function uV(){return Bk||(Bk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),us())})(gt,function(n){return n.mode.ECB=function(){var r=n.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(a,i){this._cipher.encryptBlock(a,i)}}),r.Decryptor=r.extend({processBlock:function(a,i){this._cipher.decryptBlock(a,i)}}),r}(),n.mode.ECB})}(ey)),ey.exports}var ty={exports:{}},zk;function hV(){return zk||(zk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),us())})(gt,function(n){return n.pad.AnsiX923={pad:function(r,a){var i=r.sigBytes,o=a*4,c=o-i%o,d=i+c-1;r.clamp(),r.words[d>>>2]|=c<<24-d%4*8,r.sigBytes+=c},unpad:function(r){var a=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=a}},n.pad.Ansix923})}(ty)),ty.exports}var ny={exports:{}},$k;function mV(){return $k||($k=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),us())})(gt,function(n){return n.pad.Iso10126={pad:function(r,a){var i=a*4,o=i-r.sigBytes%i;r.concat(n.lib.WordArray.random(o-1)).concat(n.lib.WordArray.create([o<<24],1))},unpad:function(r){var a=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=a}},n.pad.Iso10126})}(ny)),ny.exports}var sy={exports:{}},Uk;function fV(){return Uk||(Uk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),us())})(gt,function(n){return n.pad.Iso97971={pad:function(r,a){r.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(r,a)},unpad:function(r){n.pad.ZeroPadding.unpad(r),r.sigBytes--}},n.pad.Iso97971})}(sy)),sy.exports}var ry={exports:{}},qk;function pV(){return qk||(qk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),us())})(gt,function(n){return n.pad.ZeroPadding={pad:function(r,a){var i=a*4;r.clamp(),r.sigBytes+=i-(r.sigBytes%i||i)},unpad:function(r){for(var a=r.words,i=r.sigBytes-1,i=r.sigBytes-1;i>=0;i--)if(a[i>>>2]>>>24-i%4*8&255){r.sigBytes=i+1;break}}},n.pad.ZeroPadding})}(ry)),ry.exports}var ay={exports:{}},Hk;function gV(){return Hk||(Hk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),us())})(gt,function(n){return n.pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding})}(ay)),ay.exports}var iy={exports:{}},Wk;function xV(){return Wk||(Wk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),us())})(gt,function(n){return function(r){var a=n,i=a.lib,o=i.CipherParams,c=a.enc,d=c.Hex,u=a.format;u.Hex={stringify:function(m){return m.ciphertext.toString(d)},parse:function(m){var f=d.parse(m);return o.create({ciphertext:f})}}}(),n.format.Hex})}(iy)),iy.exports}var oy={exports:{}},Vk;function vV(){return Vk||(Vk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),ac(),ic(),Vo(),us())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.BlockCipher,o=r.algo,c=[],d=[],u=[],m=[],f=[],p=[],v=[],w=[],x=[],y=[];(function(){for(var N=[],S=0;S<256;S++)S<128?N[S]=S<<1:N[S]=S<<1^283;for(var E=0,C=0,S=0;S<256;S++){var P=C^C<<1^C<<2^C<<3^C<<4;P=P>>>8^P&255^99,c[E]=P,d[P]=E;var R=N[E],H=N[R],I=N[H],D=N[P]*257^P*16843008;u[E]=D<<24|D>>>8,m[E]=D<<16|D>>>16,f[E]=D<<8|D>>>24,p[E]=D;var D=I*16843009^H*65537^R*257^E*16843008;v[P]=D<<24|D>>>8,w[P]=D<<16|D>>>16,x[P]=D<<8|D>>>24,y[P]=D,E?(E=R^N[N[N[I^R]]],C^=N[N[C]]):E=C=1}})();var j=[0,1,2,4,8,16,32,64,128,27,54],b=o.AES=i.extend({_doReset:function(){var N;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var S=this._keyPriorReset=this._key,E=S.words,C=S.sigBytes/4,P=this._nRounds=C+6,R=(P+1)*4,H=this._keySchedule=[],I=0;I<R;I++)I<C?H[I]=E[I]:(N=H[I-1],I%C?C>6&&I%C==4&&(N=c[N>>>24]<<24|c[N>>>16&255]<<16|c[N>>>8&255]<<8|c[N&255]):(N=N<<8|N>>>24,N=c[N>>>24]<<24|c[N>>>16&255]<<16|c[N>>>8&255]<<8|c[N&255],N^=j[I/C|0]<<24),H[I]=H[I-C]^N);for(var D=this._invKeySchedule=[],W=0;W<R;W++){var I=R-W;if(W%4)var N=H[I];else var N=H[I-4];W<4||I<=4?D[W]=N:D[W]=v[c[N>>>24]]^w[c[N>>>16&255]]^x[c[N>>>8&255]]^y[c[N&255]]}}},encryptBlock:function(N,S){this._doCryptBlock(N,S,this._keySchedule,u,m,f,p,c)},decryptBlock:function(N,S){var E=N[S+1];N[S+1]=N[S+3],N[S+3]=E,this._doCryptBlock(N,S,this._invKeySchedule,v,w,x,y,d);var E=N[S+1];N[S+1]=N[S+3],N[S+3]=E},_doCryptBlock:function(N,S,E,C,P,R,H,I){for(var D=this._nRounds,W=N[S]^E[0],V=N[S+1]^E[1],G=N[S+2]^E[2],Y=N[S+3]^E[3],X=4,F=1;F<D;F++){var T=C[W>>>24]^P[V>>>16&255]^R[G>>>8&255]^H[Y&255]^E[X++],q=C[V>>>24]^P[G>>>16&255]^R[Y>>>8&255]^H[W&255]^E[X++],U=C[G>>>24]^P[Y>>>16&255]^R[W>>>8&255]^H[V&255]^E[X++],B=C[Y>>>24]^P[W>>>16&255]^R[V>>>8&255]^H[G&255]^E[X++];W=T,V=q,G=U,Y=B}var T=(I[W>>>24]<<24|I[V>>>16&255]<<16|I[G>>>8&255]<<8|I[Y&255])^E[X++],q=(I[V>>>24]<<24|I[G>>>16&255]<<16|I[Y>>>8&255]<<8|I[W&255])^E[X++],U=(I[G>>>24]<<24|I[Y>>>16&255]<<16|I[W>>>8&255]<<8|I[V&255])^E[X++],B=(I[Y>>>24]<<24|I[W>>>16&255]<<16|I[V>>>8&255]<<8|I[G&255])^E[X++];N[S]=T,N[S+1]=q,N[S+2]=U,N[S+3]=B},keySize:256/32});r.AES=i._createHelper(b)}(),n.AES})}(oy)),oy.exports}var ly={exports:{}},Kk;function yV(){return Kk||(Kk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),ac(),ic(),Vo(),us())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.WordArray,o=a.BlockCipher,c=r.algo,d=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],m=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],p=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],v=c.DES=o.extend({_doReset:function(){for(var j=this._key,b=j.words,N=[],S=0;S<56;S++){var E=d[S]-1;N[S]=b[E>>>5]>>>31-E%32&1}for(var C=this._subKeys=[],P=0;P<16;P++){for(var R=C[P]=[],H=m[P],S=0;S<24;S++)R[S/6|0]|=N[(u[S]-1+H)%28]<<31-S%6,R[4+(S/6|0)]|=N[28+(u[S+24]-1+H)%28]<<31-S%6;R[0]=R[0]<<1|R[0]>>>31;for(var S=1;S<7;S++)R[S]=R[S]>>>(S-1)*4+3;R[7]=R[7]<<5|R[7]>>>27}for(var I=this._invSubKeys=[],S=0;S<16;S++)I[S]=C[15-S]},encryptBlock:function(j,b){this._doCryptBlock(j,b,this._subKeys)},decryptBlock:function(j,b){this._doCryptBlock(j,b,this._invSubKeys)},_doCryptBlock:function(j,b,N){this._lBlock=j[b],this._rBlock=j[b+1],w.call(this,4,252645135),w.call(this,16,65535),x.call(this,2,858993459),x.call(this,8,16711935),w.call(this,1,1431655765);for(var S=0;S<16;S++){for(var E=N[S],C=this._lBlock,P=this._rBlock,R=0,H=0;H<8;H++)R|=f[H][((P^E[H])&p[H])>>>0];this._lBlock=P,this._rBlock=C^R}var I=this._lBlock;this._lBlock=this._rBlock,this._rBlock=I,w.call(this,1,1431655765),x.call(this,8,16711935),x.call(this,2,858993459),w.call(this,16,65535),w.call(this,4,252645135),j[b]=this._lBlock,j[b+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function w(j,b){var N=(this._lBlock>>>j^this._rBlock)&b;this._rBlock^=N,this._lBlock^=N<<j}function x(j,b){var N=(this._rBlock>>>j^this._lBlock)&b;this._lBlock^=N,this._rBlock^=N<<j}r.DES=o._createHelper(v);var y=c.TripleDES=o.extend({_doReset:function(){var j=this._key,b=j.words;if(b.length!==2&&b.length!==4&&b.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var N=b.slice(0,2),S=b.length<4?b.slice(0,2):b.slice(2,4),E=b.length<6?b.slice(0,2):b.slice(4,6);this._des1=v.createEncryptor(i.create(N)),this._des2=v.createEncryptor(i.create(S)),this._des3=v.createEncryptor(i.create(E))},encryptBlock:function(j,b){this._des1.encryptBlock(j,b),this._des2.decryptBlock(j,b),this._des3.encryptBlock(j,b)},decryptBlock:function(j,b){this._des3.decryptBlock(j,b),this._des2.encryptBlock(j,b),this._des1.decryptBlock(j,b)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=o._createHelper(y)}(),n.TripleDES})}(ly)),ly.exports}var cy={exports:{}},Zk;function _V(){return Zk||(Zk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),ac(),ic(),Vo(),us())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.StreamCipher,o=r.algo,c=o.RC4=i.extend({_doReset:function(){for(var m=this._key,f=m.words,p=m.sigBytes,v=this._S=[],w=0;w<256;w++)v[w]=w;for(var w=0,x=0;w<256;w++){var y=w%p,j=f[y>>>2]>>>24-y%4*8&255;x=(x+v[w]+j)%256;var b=v[w];v[w]=v[x],v[x]=b}this._i=this._j=0},_doProcessBlock:function(m,f){m[f]^=d.call(this)},keySize:256/32,ivSize:0});function d(){for(var m=this._S,f=this._i,p=this._j,v=0,w=0;w<4;w++){f=(f+1)%256,p=(p+m[f])%256;var x=m[f];m[f]=m[p],m[p]=x,v|=m[(m[f]+m[p])%256]<<24-w*8}return this._i=f,this._j=p,v}r.RC4=i._createHelper(c);var u=o.RC4Drop=c.extend({cfg:c.cfg.extend({drop:192}),_doReset:function(){c._doReset.call(this);for(var m=this.cfg.drop;m>0;m--)d.call(this)}});r.RC4Drop=i._createHelper(u)}(),n.RC4})}(cy)),cy.exports}var dy={exports:{}},Gk;function wV(){return Gk||(Gk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),ac(),ic(),Vo(),us())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.StreamCipher,o=r.algo,c=[],d=[],u=[],m=o.Rabbit=i.extend({_doReset:function(){for(var p=this._key.words,v=this.cfg.iv,w=0;w<4;w++)p[w]=(p[w]<<8|p[w]>>>24)&16711935|(p[w]<<24|p[w]>>>8)&4278255360;var x=this._X=[p[0],p[3]<<16|p[2]>>>16,p[1],p[0]<<16|p[3]>>>16,p[2],p[1]<<16|p[0]>>>16,p[3],p[2]<<16|p[1]>>>16],y=this._C=[p[2]<<16|p[2]>>>16,p[0]&4294901760|p[1]&65535,p[3]<<16|p[3]>>>16,p[1]&4294901760|p[2]&65535,p[0]<<16|p[0]>>>16,p[2]&4294901760|p[3]&65535,p[1]<<16|p[1]>>>16,p[3]&4294901760|p[0]&65535];this._b=0;for(var w=0;w<4;w++)f.call(this);for(var w=0;w<8;w++)y[w]^=x[w+4&7];if(v){var j=v.words,b=j[0],N=j[1],S=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,E=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,C=S>>>16|E&4294901760,P=E<<16|S&65535;y[0]^=S,y[1]^=C,y[2]^=E,y[3]^=P,y[4]^=S,y[5]^=C,y[6]^=E,y[7]^=P;for(var w=0;w<4;w++)f.call(this)}},_doProcessBlock:function(p,v){var w=this._X;f.call(this),c[0]=w[0]^w[5]>>>16^w[3]<<16,c[1]=w[2]^w[7]>>>16^w[5]<<16,c[2]=w[4]^w[1]>>>16^w[7]<<16,c[3]=w[6]^w[3]>>>16^w[1]<<16;for(var x=0;x<4;x++)c[x]=(c[x]<<8|c[x]>>>24)&16711935|(c[x]<<24|c[x]>>>8)&4278255360,p[v+x]^=c[x]},blockSize:128/32,ivSize:64/32});function f(){for(var p=this._X,v=this._C,w=0;w<8;w++)d[w]=v[w];v[0]=v[0]+1295307597+this._b|0,v[1]=v[1]+3545052371+(v[0]>>>0<d[0]>>>0?1:0)|0,v[2]=v[2]+886263092+(v[1]>>>0<d[1]>>>0?1:0)|0,v[3]=v[3]+1295307597+(v[2]>>>0<d[2]>>>0?1:0)|0,v[4]=v[4]+3545052371+(v[3]>>>0<d[3]>>>0?1:0)|0,v[5]=v[5]+886263092+(v[4]>>>0<d[4]>>>0?1:0)|0,v[6]=v[6]+1295307597+(v[5]>>>0<d[5]>>>0?1:0)|0,v[7]=v[7]+3545052371+(v[6]>>>0<d[6]>>>0?1:0)|0,this._b=v[7]>>>0<d[7]>>>0?1:0;for(var w=0;w<8;w++){var x=p[w]+v[w],y=x&65535,j=x>>>16,b=((y*y>>>17)+y*j>>>15)+j*j,N=((x&4294901760)*x|0)+((x&65535)*x|0);u[w]=b^N}p[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,p[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,p[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,p[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,p[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,p[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,p[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,p[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}r.Rabbit=i._createHelper(m)}(),n.Rabbit})}(dy)),dy.exports}var uy={exports:{}},Qk;function bV(){return Qk||(Qk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),ac(),ic(),Vo(),us())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.StreamCipher,o=r.algo,c=[],d=[],u=[],m=o.RabbitLegacy=i.extend({_doReset:function(){var p=this._key.words,v=this.cfg.iv,w=this._X=[p[0],p[3]<<16|p[2]>>>16,p[1],p[0]<<16|p[3]>>>16,p[2],p[1]<<16|p[0]>>>16,p[3],p[2]<<16|p[1]>>>16],x=this._C=[p[2]<<16|p[2]>>>16,p[0]&4294901760|p[1]&65535,p[3]<<16|p[3]>>>16,p[1]&4294901760|p[2]&65535,p[0]<<16|p[0]>>>16,p[2]&4294901760|p[3]&65535,p[1]<<16|p[1]>>>16,p[3]&4294901760|p[0]&65535];this._b=0;for(var y=0;y<4;y++)f.call(this);for(var y=0;y<8;y++)x[y]^=w[y+4&7];if(v){var j=v.words,b=j[0],N=j[1],S=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,E=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,C=S>>>16|E&4294901760,P=E<<16|S&65535;x[0]^=S,x[1]^=C,x[2]^=E,x[3]^=P,x[4]^=S,x[5]^=C,x[6]^=E,x[7]^=P;for(var y=0;y<4;y++)f.call(this)}},_doProcessBlock:function(p,v){var w=this._X;f.call(this),c[0]=w[0]^w[5]>>>16^w[3]<<16,c[1]=w[2]^w[7]>>>16^w[5]<<16,c[2]=w[4]^w[1]>>>16^w[7]<<16,c[3]=w[6]^w[3]>>>16^w[1]<<16;for(var x=0;x<4;x++)c[x]=(c[x]<<8|c[x]>>>24)&16711935|(c[x]<<24|c[x]>>>8)&4278255360,p[v+x]^=c[x]},blockSize:128/32,ivSize:64/32});function f(){for(var p=this._X,v=this._C,w=0;w<8;w++)d[w]=v[w];v[0]=v[0]+1295307597+this._b|0,v[1]=v[1]+3545052371+(v[0]>>>0<d[0]>>>0?1:0)|0,v[2]=v[2]+886263092+(v[1]>>>0<d[1]>>>0?1:0)|0,v[3]=v[3]+1295307597+(v[2]>>>0<d[2]>>>0?1:0)|0,v[4]=v[4]+3545052371+(v[3]>>>0<d[3]>>>0?1:0)|0,v[5]=v[5]+886263092+(v[4]>>>0<d[4]>>>0?1:0)|0,v[6]=v[6]+1295307597+(v[5]>>>0<d[5]>>>0?1:0)|0,v[7]=v[7]+3545052371+(v[6]>>>0<d[6]>>>0?1:0)|0,this._b=v[7]>>>0<d[7]>>>0?1:0;for(var w=0;w<8;w++){var x=p[w]+v[w],y=x&65535,j=x>>>16,b=((y*y>>>17)+y*j>>>15)+j*j,N=((x&4294901760)*x|0)+((x&65535)*x|0);u[w]=b^N}p[0]=u[0]+(u[7]<<16|u[7]>>>16)+(u[6]<<16|u[6]>>>16)|0,p[1]=u[1]+(u[0]<<8|u[0]>>>24)+u[7]|0,p[2]=u[2]+(u[1]<<16|u[1]>>>16)+(u[0]<<16|u[0]>>>16)|0,p[3]=u[3]+(u[2]<<8|u[2]>>>24)+u[1]|0,p[4]=u[4]+(u[3]<<16|u[3]>>>16)+(u[2]<<16|u[2]>>>16)|0,p[5]=u[5]+(u[4]<<8|u[4]>>>24)+u[3]|0,p[6]=u[6]+(u[5]<<16|u[5]>>>16)+(u[4]<<16|u[4]>>>16)|0,p[7]=u[7]+(u[6]<<8|u[6]>>>24)+u[5]|0}r.RabbitLegacy=i._createHelper(m)}(),n.RabbitLegacy})}(uy)),uy.exports}var hy={exports:{}},Yk;function jV(){return Yk||(Yk=1,function(t,e){(function(n,r,a){t.exports=r(Qt(),ac(),ic(),Vo(),us())})(gt,function(n){return function(){var r=n,a=r.lib,i=a.BlockCipher,o=r.algo;const c=16,d=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],u=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var m={pbox:[],sbox:[]};function f(y,j){let b=j>>24&255,N=j>>16&255,S=j>>8&255,E=j&255,C=y.sbox[0][b]+y.sbox[1][N];return C=C^y.sbox[2][S],C=C+y.sbox[3][E],C}function p(y,j,b){let N=j,S=b,E;for(let C=0;C<c;++C)N=N^y.pbox[C],S=f(y,N)^S,E=N,N=S,S=E;return E=N,N=S,S=E,S=S^y.pbox[c],N=N^y.pbox[c+1],{left:N,right:S}}function v(y,j,b){let N=j,S=b,E;for(let C=c+1;C>1;--C)N=N^y.pbox[C],S=f(y,N)^S,E=N,N=S,S=E;return E=N,N=S,S=E,S=S^y.pbox[1],N=N^y.pbox[0],{left:N,right:S}}function w(y,j,b){for(let P=0;P<4;P++){y.sbox[P]=[];for(let R=0;R<256;R++)y.sbox[P][R]=u[P][R]}let N=0;for(let P=0;P<c+2;P++)y.pbox[P]=d[P]^j[N],N++,N>=b&&(N=0);let S=0,E=0,C=0;for(let P=0;P<c+2;P+=2)C=p(y,S,E),S=C.left,E=C.right,y.pbox[P]=S,y.pbox[P+1]=E;for(let P=0;P<4;P++)for(let R=0;R<256;R+=2)C=p(y,S,E),S=C.left,E=C.right,y.sbox[P][R]=S,y.sbox[P][R+1]=E;return!0}var x=o.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var y=this._keyPriorReset=this._key,j=y.words,b=y.sigBytes/4;w(m,j,b)}},encryptBlock:function(y,j){var b=p(m,y[j],y[j+1]);y[j]=b.left,y[j+1]=b.right},decryptBlock:function(y,j){var b=v(m,y[j],y[j+1]);y[j]=b.left,y[j+1]=b.right},blockSize:64/32,keySize:128/32,ivSize:64/32});r.Blowfish=i._createHelper(x)}(),n.Blowfish})}(hy)),hy.exports}(function(t,e){(function(n,r,a){t.exports=r(Qt(),Hg(),JW(),eV(),ac(),tV(),ic(),OT(),$j(),nV(),LT(),sV(),rV(),aV(),Uj(),iV(),Vo(),us(),oV(),lV(),cV(),dV(),uV(),hV(),mV(),fV(),pV(),gV(),xV(),vV(),yV(),_V(),wV(),bV(),jV())})(gt,function(n){return n})})(GW);A.object({sequence_type:A.enum(["invoice","quote","order","receipt","credit_note","delivery_note","payment_voucher"]),prefix:A.string().min(1).max(10),format:A.string().min(1),reset_annually:A.boolean().default(!0),gap_tracking:A.boolean().default(!0)});A.object({entity_type:A.string().min(1),entity_id:A.string().min(1),document_content:A.string().min(1),file_name:A.string().min(1),mime_type:A.string().min(1)});A.object({year:A.number().min(2020).max(2030),quarter:A.number().min(1).max(4).optional(),month:A.number().min(1).max(12).optional(),from_date:A.string().regex(/^\d{4}-\d{2}-\d{2}$/),to_date:A.string().regex(/^\d{4}-\d{2}-\d{2}$/)});const NV={requireHumanApproval:!0,gates:{aiEstimateApply:!0,aiScheduleApply:!0,customerScoringAction:!0,employeeScoringAction:!0}};async function SV(t){try{await fetch("/api/audit/approval",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}catch{console.warn("[approval] audit log failed (non-blocking)",t)}}async function kV(t){let e=!0;if(typeof window<"u"&&typeof window.confirm=="function"){const n=`Bitte bestätigen:

${t.reason}

Hinweis: Diese Aktion basiert auf einem KI/Score-Vorschlag und erfordert Ihre Freigabe.`;e=window.confirm(n)}return await SV({...t,approved:e,timestamp:new Date().toISOString()}),e}async function CV(t){return!!NV.gates[t]}async function FT(t,e,n){if(!(await CV(t)&&!await kV({action:e.action??t.toString().toUpperCase(),reason:e.reason,metadata:e.metadata,userId:e.userId})))return await n()}A.object({year:A.number().min(2020).max(2030),quarter:A.number().min(1).max(4).optional(),month:A.number().min(1).max(12).optional(),period_type:A.enum(["MONTHLY","QUARTERLY","ANNUAL"]),start_date:A.string().regex(/^\d{4}-\d{2}-\d{2}$/),end_date:A.string().regex(/^\d{4}-\d{2}-\d{2}$/)});A.object({document_type:A.enum(["invoice","quote","order","project","customer","material","timesheet","expense","knowledge_base","email","pdf_document"]),entity_id:A.string(),title:A.string().min(1),content:A.string().min(1),metadata:A.record(A.any()).default({}),language:A.enum(["de","en"]).default("de"),search_tags:A.array(A.string()).default([]),importance_score:A.number().min(0).max(1).default(.5)});A.object({query:A.string().min(1),document_types:A.array(A.enum(["invoice","quote","order","project","customer","material","timesheet","expense","knowledge_base","email","pdf_document"])).optional(),date_range:A.object({from:A.string(),to:A.string()}).optional(),language:A.enum(["de","en"]).default("de"),limit:A.number().min(1).max(100).default(10),similarity_threshold:A.number().min(0).max(1).default(.7),include_metadata:A.boolean().default(!0)});A.object({user_input:A.string().min(1),detected_intent:A.enum(["SEARCH_REQUEST","CREATE_ENTITY","UPDATE_ENTITY","REPORT_REQUEST","CALCULATION_REQUEST","SCHEDULE_TASK","COMPLIANCE_CHECK","EXPORT_REQUEST","NOTIFICATION_SETUP","HELP_REQUEST","UNKNOWN"]),target_entity:A.enum(["customer","invoice","quote","order","project","material","employee","timesheet","expense","report","notification"]).optional(),suggested_action:A.enum(["CREATE","READ","UPDATE","DELETE","SEARCH","EXPORT","CALCULATE","SCHEDULE","NOTIFY","VALIDATE"]).optional(),extracted_parameters:A.record(A.any()).default({}),confidence_score:A.number().min(0).max(1)});A.object({estimation_type:A.enum(["PROJECT_COST","MATERIAL_COST","LABOR_COST","TIME_ESTIMATION","COMPLETION_DATE","RESOURCE_NEED","PROFIT_MARGIN","RISK_ASSESSMENT"]),project_category:A.enum(["BATHROOM_RENOVATION","KITCHEN_RENOVATION","ELECTRICAL_WORK","PLUMBING_WORK","FLOORING_WORK","PAINTING_WORK","ROOFING_WORK","GENERAL_CONSTRUCTION","MAINTENANCE","CUSTOM_WORK"]),project_description:A.string().min(10),project_size:A.object({area_sqm:A.number().positive().optional(),rooms:A.number().int().positive().optional(),complexity_level:A.number().int().min(1).max(5)}),customer_requirements:A.array(A.string()).default([]),timeline_constraints:A.object({start_date:A.string().optional(),end_date:A.string().optional(),fixed_deadline:A.boolean().default(!1)}).optional(),budget_constraints:A.object({min_budget:A.number().positive().optional(),max_budget:A.number().positive().optional(),flexible:A.boolean().default(!0)}).optional(),additional_context:A.record(A.any()).default({})});async function EV(t){return await FT("aiEstimateApply",{reason:"KI-Schätzung soll übernommen werden.",metadata:{projectId:t.projectId,quoteId:t.quoteId},userId:t.userId},async()=>(console.log("Applying AI estimate:",t),t.estimate))}var AV={exports:{}};(function(t){var e=function(n){var r=Object.prototype,a=r.hasOwnProperty,i=Object.defineProperty||function(q,U,B){q[U]=B.value},o,c=typeof Symbol=="function"?Symbol:{},d=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",m=c.toStringTag||"@@toStringTag";function f(q,U,B){return Object.defineProperty(q,U,{value:B,enumerable:!0,configurable:!0,writable:!0}),q[U]}try{f({},"")}catch{f=function(U,B,O){return U[B]=O}}function p(q,U,B,O){var z=U&&U.prototype instanceof N?U:N,$=Object.create(z.prototype),te=new X(O||[]);return i($,"_invoke",{value:W(q,B,te)}),$}n.wrap=p;function v(q,U,B){try{return{type:"normal",arg:q.call(U,B)}}catch(O){return{type:"throw",arg:O}}}var w="suspendedStart",x="suspendedYield",y="executing",j="completed",b={};function N(){}function S(){}function E(){}var C={};f(C,d,function(){return this});var P=Object.getPrototypeOf,R=P&&P(P(F([])));R&&R!==r&&a.call(R,d)&&(C=R);var H=E.prototype=N.prototype=Object.create(C);S.prototype=E,i(H,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:S,configurable:!0}),S.displayName=f(E,m,"GeneratorFunction");function I(q){["next","throw","return"].forEach(function(U){f(q,U,function(B){return this._invoke(U,B)})})}n.isGeneratorFunction=function(q){var U=typeof q=="function"&&q.constructor;return U?U===S||(U.displayName||U.name)==="GeneratorFunction":!1},n.mark=function(q){return Object.setPrototypeOf?Object.setPrototypeOf(q,E):(q.__proto__=E,f(q,m,"GeneratorFunction")),q.prototype=Object.create(H),q},n.awrap=function(q){return{__await:q}};function D(q,U){function B($,te,ee,Q){var le=v(q[$],q,te);if(le.type==="throw")Q(le.arg);else{var pe=le.arg,J=pe.value;return J&&typeof J=="object"&&a.call(J,"__await")?U.resolve(J.__await).then(function(ae){B("next",ae,ee,Q)},function(ae){B("throw",ae,ee,Q)}):U.resolve(J).then(function(ae){pe.value=ae,ee(pe)},function(ae){return B("throw",ae,ee,Q)})}}var O;function z($,te){function ee(){return new U(function(Q,le){B($,te,Q,le)})}return O=O?O.then(ee,ee):ee()}i(this,"_invoke",{value:z})}I(D.prototype),f(D.prototype,u,function(){return this}),n.AsyncIterator=D,n.async=function(q,U,B,O,z){z===void 0&&(z=Promise);var $=new D(p(q,U,B,O),z);return n.isGeneratorFunction(U)?$:$.next().then(function(te){return te.done?te.value:$.next()})};function W(q,U,B){var O=w;return function($,te){if(O===y)throw new Error("Generator is already running");if(O===j){if($==="throw")throw te;return T()}for(B.method=$,B.arg=te;;){var ee=B.delegate;if(ee){var Q=V(ee,B);if(Q){if(Q===b)continue;return Q}}if(B.method==="next")B.sent=B._sent=B.arg;else if(B.method==="throw"){if(O===w)throw O=j,B.arg;B.dispatchException(B.arg)}else B.method==="return"&&B.abrupt("return",B.arg);O=y;var le=v(q,U,B);if(le.type==="normal"){if(O=B.done?j:x,le.arg===b)continue;return{value:le.arg,done:B.done}}else le.type==="throw"&&(O=j,B.method="throw",B.arg=le.arg)}}}function V(q,U){var B=U.method,O=q.iterator[B];if(O===o)return U.delegate=null,B==="throw"&&q.iterator.return&&(U.method="return",U.arg=o,V(q,U),U.method==="throw")||B!=="return"&&(U.method="throw",U.arg=new TypeError("The iterator does not provide a '"+B+"' method")),b;var z=v(O,q.iterator,U.arg);if(z.type==="throw")return U.method="throw",U.arg=z.arg,U.delegate=null,b;var $=z.arg;if(!$)return U.method="throw",U.arg=new TypeError("iterator result is not an object"),U.delegate=null,b;if($.done)U[q.resultName]=$.value,U.next=q.nextLoc,U.method!=="return"&&(U.method="next",U.arg=o);else return $;return U.delegate=null,b}I(H),f(H,m,"Generator"),f(H,d,function(){return this}),f(H,"toString",function(){return"[object Generator]"});function G(q){var U={tryLoc:q[0]};1 in q&&(U.catchLoc=q[1]),2 in q&&(U.finallyLoc=q[2],U.afterLoc=q[3]),this.tryEntries.push(U)}function Y(q){var U=q.completion||{};U.type="normal",delete U.arg,q.completion=U}function X(q){this.tryEntries=[{tryLoc:"root"}],q.forEach(G,this),this.reset(!0)}n.keys=function(q){var U=Object(q),B=[];for(var O in U)B.push(O);return B.reverse(),function z(){for(;B.length;){var $=B.pop();if($ in U)return z.value=$,z.done=!1,z}return z.done=!0,z}};function F(q){if(q){var U=q[d];if(U)return U.call(q);if(typeof q.next=="function")return q;if(!isNaN(q.length)){var B=-1,O=function z(){for(;++B<q.length;)if(a.call(q,B))return z.value=q[B],z.done=!1,z;return z.value=o,z.done=!0,z};return O.next=O}}return{next:T}}n.values=F;function T(){return{value:o,done:!0}}return X.prototype={constructor:X,reset:function(q){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(Y),!q)for(var U in this)U.charAt(0)==="t"&&a.call(this,U)&&!isNaN(+U.slice(1))&&(this[U]=o)},stop:function(){this.done=!0;var q=this.tryEntries[0],U=q.completion;if(U.type==="throw")throw U.arg;return this.rval},dispatchException:function(q){if(this.done)throw q;var U=this;function B(Q,le){return $.type="throw",$.arg=q,U.next=Q,le&&(U.method="next",U.arg=o),!!le}for(var O=this.tryEntries.length-1;O>=0;--O){var z=this.tryEntries[O],$=z.completion;if(z.tryLoc==="root")return B("end");if(z.tryLoc<=this.prev){var te=a.call(z,"catchLoc"),ee=a.call(z,"finallyLoc");if(te&&ee){if(this.prev<z.catchLoc)return B(z.catchLoc,!0);if(this.prev<z.finallyLoc)return B(z.finallyLoc)}else if(te){if(this.prev<z.catchLoc)return B(z.catchLoc,!0)}else if(ee){if(this.prev<z.finallyLoc)return B(z.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(q,U){for(var B=this.tryEntries.length-1;B>=0;--B){var O=this.tryEntries[B];if(O.tryLoc<=this.prev&&a.call(O,"finallyLoc")&&this.prev<O.finallyLoc){var z=O;break}}z&&(q==="break"||q==="continue")&&z.tryLoc<=U&&U<=z.finallyLoc&&(z=null);var $=z?z.completion:{};return $.type=q,$.arg=U,z?(this.method="next",this.next=z.finallyLoc,b):this.complete($)},complete:function(q,U){if(q.type==="throw")throw q.arg;return q.type==="break"||q.type==="continue"?this.next=q.arg:q.type==="return"?(this.rval=this.arg=q.arg,this.method="return",this.next="end"):q.type==="normal"&&U&&(this.next=U),b},finish:function(q){for(var U=this.tryEntries.length-1;U>=0;--U){var B=this.tryEntries[U];if(B.finallyLoc===q)return this.complete(B.completion,B.afterLoc),Y(B),b}},catch:function(q){for(var U=this.tryEntries.length-1;U>=0;--U){var B=this.tryEntries[U];if(B.tryLoc===q){var O=B.completion;if(O.type==="throw"){var z=O.arg;Y(B)}return z}}throw new Error("illegal catch attempt")},delegateYield:function(q,U,B){return this.delegate={iterator:F(q),resultName:U,nextLoc:B},this.method==="next"&&(this.arg=o),b}},n}(t.exports);try{regeneratorRuntime=e}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}})(AV);var qj=(t,e)=>`${t}-${e}-${Math.random().toString(16).slice(3,8)}`;const PV=qj;let Xk=0;var BT=({id:t,action:e,payload:n={}})=>{let r=t;return typeof r>"u"&&(r=PV("Job",Xk),Xk+=1),{id:r,action:e,payload:n}},au={};let Hj=!1;au.logging=Hj;au.setLogging=t=>{Hj=t};au.log=(...t)=>Hj?console.log.apply(void 0,t):null;const DV=BT,{log:Gf}=au,TV=qj;let Jk=0;var MV=()=>{const t=TV("Scheduler",Jk),e={},n={};let r=[];Jk+=1;const a=()=>r.length,i=()=>Object.keys(e).length,o=()=>{if(r.length!==0){const f=Object.keys(e);for(let p=0;p<f.length;p+=1)if(typeof n[f[p]]>"u"){r[0](e[f[p]]);break}}},c=(f,p)=>new Promise((v,w)=>{const x=DV({action:f,payload:p});r.push(async y=>{r.shift(),n[y.id]=x;try{v(await y[f].apply(void 0,[...p,x.id]))}catch(j){w(j)}finally{delete n[y.id],o()}}),Gf(`[${t}]: Add ${x.id} to JobQueue`),Gf(`[${t}]: JobQueue length=${r.length}`),o()});return{addWorker:f=>(e[f.id]=f,Gf(`[${t}]: Add ${f.id}`),Gf(`[${t}]: Number of workers=${i()}`),o(),f.id),addJob:async(f,...p)=>{if(i()===0)throw Error(`[${t}]: You need to have at least one worker before adding jobs`);return c(f,p)},terminate:async()=>{Object.keys(e).forEach(async f=>{await e[f].terminate()}),r=[]},getQueueLen:a,getNumWorkers:i}},RV=t=>{const e={};return typeof WorkerGlobalScope<"u"?e.type="webworker":typeof document=="object"?e.type="browser":typeof process=="object"&&typeof IT=="function"&&(e.type="node"),typeof t>"u"?e:e[t]};const IV=RV("type")==="browser",OV=IV?t=>new URL(t,window.location.href).href:t=>t;var LV=t=>{const e={...t};return["corePath","workerPath","langPath"].forEach(n=>{t[n]&&(e[n]=OV(e[n]))}),e},zT={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const FV="tesseract.js",BV="6.0.1",zV="Pure Javascript Multilingual OCR",$V="src/index.js",UV="commonjs",qV="src/index.d.ts",HV="dist/tesseract.min.js",WV="dist/tesseract.min.js",VV={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser test:node:all","test:browser":"karma start karma.conf.js","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.mjs","test:node:all":"npm run test:node -- ./tests/*.test.mjs",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},KV={"./src/worker/node/index.js":"./src/worker/browser/index.js"},ZV="",GV=["jeromewu"],QV="Apache-2.0",YV={"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","npm-run-all":"^4.1.5",karma:"^6.4.2","karma-chrome-launcher":"^3.2.0","karma-firefox-launcher":"^2.1.2","karma-mocha":"^2.0.1","karma-webpack":"^5.0.0",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},XV={"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^6.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},JV={"@rollup/pluginutils":"^5.0.2"},eK={type:"git",url:"https://github.com/naptha/tesseract.js.git"},tK={url:"https://github.com/naptha/tesseract.js/issues"},nK="https://github.com/naptha/tesseract.js",sK={type:"opencollective",url:"https://opencollective.com/tesseractjs"},rK={name:FV,version:BV,description:zV,main:$V,type:UV,types:qV,unpkg:HV,jsdelivr:WV,scripts:VV,browser:KV,author:ZV,contributors:GV,license:QV,devDependencies:YV,dependencies:XV,overrides:JV,repository:eK,bugs:tK,homepage:nK,collective:sK};var aK={workerBlobURL:!0,logger:()=>{}};const iK=rK.version,oK=aK;var lK={...oK,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${iK}/dist/worker.min.js`},cK=({workerPath:t,workerBlobURL:e})=>{let n;if(Blob&&URL&&e){const r=new Blob([`importScripts("${t}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(r))}else n=new Worker(t);return n},dK=t=>{t.terminate()},uK=(t,e)=>{t.onmessage=({data:n})=>{e(n)}},hK=async(t,e)=>{t.postMessage(e)};const my=t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{e(r.result)},r.onerror=({target:{error:{code:a}}})=>{n(Error(`File could not be read! Code=${a}`))},r.readAsArrayBuffer(t)}),Dw=async t=>{let e=t;if(typeof t>"u")return"undefined";if(typeof t=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(t)?e=atob(t.split(",")[1]).split("").map(n=>n.charCodeAt(0)):e=await(await fetch(t)).arrayBuffer();else if(typeof HTMLElement<"u"&&t instanceof HTMLElement)t.tagName==="IMG"&&(e=await Dw(t.src)),t.tagName==="VIDEO"&&(e=await Dw(t.poster)),t.tagName==="CANVAS"&&await new Promise(n=>{t.toBlob(async r=>{e=await my(r),n()})});else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas){const n=await t.convertToBlob();e=await my(n)}else(t instanceof File||t instanceof Blob)&&(e=await my(t));return new Uint8Array(e)};var mK=Dw;const fK=lK,pK=cK,gK=dK,xK=uK,vK=hK,yK=mK;var _K={defaultOptions:fK,spawnWorker:pK,terminateWorker:gK,onMessage:xK,send:vK,loadImage:yK};const wK=LV,Ea=BT,{log:eC}=au,bK=qj,sl=zT,{defaultOptions:jK,spawnWorker:NK,terminateWorker:SK,onMessage:kK,loadImage:tC,send:CK}=_K;let nC=0;var $T=async(t="eng",e=sl.LSTM_ONLY,n={},r={})=>{const a=bK("Worker",nC),{logger:i,errorHandler:o,...c}=wK({...jK,...n}),d={},u=typeof t=="string"?t.split("+"):t;let m=e,f=r;const p=[sl.DEFAULT,sl.LSTM_ONLY].includes(e)&&!c.legacyCore;let v,w;const x=new Promise((F,T)=>{w=F,v=T}),y=F=>{v(F.message)};let j=NK(c);j.onerror=y,nC+=1;const b=({id:F,action:T,payload:q})=>new Promise((U,B)=>{eC(`[${a}]: Start ${F}, action=${T}`);const O=`${T}-${F}`;d[O]={resolve:U,reject:B},CK(j,{workerId:a,jobId:F,action:T,payload:q})}),N=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),S=F=>b(Ea({id:F,action:"load",payload:{options:{lstmOnly:p,corePath:c.corePath,logging:c.logging}}})),E=(F,T,q)=>b(Ea({id:q,action:"FS",payload:{method:"writeFile",args:[F,T]}})),C=(F,T)=>b(Ea({id:T,action:"FS",payload:{method:"readFile",args:[F,{encoding:"utf8"}]}})),P=(F,T)=>b(Ea({id:T,action:"FS",payload:{method:"unlink",args:[F]}})),R=(F,T,q)=>b(Ea({id:q,action:"FS",payload:{method:F,args:T}})),H=(F,T)=>b(Ea({id:T,action:"loadLanguage",payload:{langs:F,options:{langPath:c.langPath,dataPath:c.dataPath,cachePath:c.cachePath,cacheMethod:c.cacheMethod,gzip:c.gzip,lstmOnly:[sl.DEFAULT,sl.LSTM_ONLY].includes(m)&&!c.legacyLang}}})),I=(F,T,q,U)=>b(Ea({id:U,action:"initialize",payload:{langs:F,oem:T,config:q}})),D=(F="eng",T,q,U)=>{if(p&&[sl.TESSERACT_ONLY,sl.TESSERACT_LSTM_COMBINED].includes(T))throw Error("Legacy model requested but code missing.");const B=T||m;m=B;const O=q||f;f=O;const $=(typeof F=="string"?F.split("+"):F).filter(te=>!u.includes(te));return u.push(...$),$.length>0?H($,U).then(()=>I(F,B,O,U)):I(F,B,O,U)},W=(F={},T)=>b(Ea({id:T,action:"setParameters",payload:{params:F}})),V=async(F,T={},q={text:!0},U)=>b(Ea({id:U,action:"recognize",payload:{image:await tC(F),options:T,output:q}})),G=async(F,T)=>{if(p)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return b(Ea({id:T,action:"detect",payload:{image:await tC(F)}}))},Y=async()=>(j!==null&&(SK(j),j=null),Promise.resolve());kK(j,({workerId:F,jobId:T,status:q,action:U,data:B})=>{const O=`${U}-${T}`;if(q==="resolve")eC(`[${F}]: Complete ${T}`),d[O].resolve({jobId:T,data:B}),delete d[O];else if(q==="reject")if(d[O].reject(B),delete d[O],U==="load"&&v(B),o)o(B);else throw Error(B);else q==="progress"&&i({...B,userJobId:T})});const X={id:a,worker:j,load:N,writeText:E,readText:C,removeFile:P,FS:R,reinitialize:D,setParameters:W,recognize:V,detect:G,terminate:Y};return S().then(()=>H(t)).then(()=>I(t,e,r)).then(()=>w(X)).catch(()=>{}),x};const UT=$T,EK=async(t,e,n)=>{const r=await UT(e,1,n);return r.recognize(t).finally(async()=>{await r.terminate()})},AK=async(t,e)=>{const n=await UT("osd",0,e);return n.detect(t).finally(async()=>{await n.terminate()})};var PK={recognize:EK,detect:AK},DK={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},TK={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const MK=MV,RK=$T,IK=PK,OK=DK,LK=zT,FK=TK,{setLogging:BK}=au;var sC={languages:OK,OEM:LK,PSM:FK,createScheduler:MK,createWorker:RK,setLogging:BK,...IK};function kt(t,e,n,r,a){if(typeof e=="function"?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function ge(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)}let qT=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return qT=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,r=>(+r^n()&15>>+r/4).toString(16))};function Tw(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const Mw=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class wt extends Error{}class bs extends wt{constructor(e,n,r,a){super(`${bs.makeMessage(e,n,r)}`),this.status=e,this.headers=a,this.requestID=a==null?void 0:a.get("x-request-id"),this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const a=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&a?`${e} ${a}`:e?`${e} status code (no body)`:a||"(no status code or body)"}static generate(e,n,r,a){if(!e||!a)return new Wg({message:r,cause:Mw(n)});const i=n==null?void 0:n.error;return e===400?new HT(e,i,r,a):e===401?new WT(e,i,r,a):e===403?new VT(e,i,r,a):e===404?new KT(e,i,r,a):e===409?new ZT(e,i,r,a):e===422?new GT(e,i,r,a):e===429?new QT(e,i,r,a):e>=500?new YT(e,i,r,a):new bs(e,i,r,a)}}class Ir extends bs{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Wg extends bs{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class Wj extends Wg{constructor({message:e}={}){super({message:e??"Request timed out."})}}class HT extends bs{}class WT extends bs{}class VT extends bs{}class KT extends bs{}class ZT extends bs{}class GT extends bs{}class QT extends bs{}class YT extends bs{}class XT extends wt{constructor(){super("Could not parse response content as the length limit was reached")}}class JT extends wt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class qu extends Error{constructor(e){super(e)}}const zK=/^[a-z][a-z0-9+.-]*:/i,$K=t=>zK.test(t);let Gs=t=>(Gs=Array.isArray,Gs(t)),rC=Gs;function eM(t){return typeof t!="object"?{}:t??{}}function UK(t){if(!t)return!0;for(const e in t)return!1;return!0}function qK(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function fy(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}const HK=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new wt(`${t} must be an integer`);if(e<0)throw new wt(`${t} must be a positive integer`);return e},WK=t=>{try{return JSON.parse(t)}catch{return}},Lm=t=>new Promise(e=>setTimeout(e,t)),Oc="5.16.0",VK=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function KK(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const ZK=()=>{var n;const t=KK();if(t==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oc,"X-Stainless-OS":iC(Deno.build.os),"X-Stainless-Arch":aC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((n=Deno.version)==null?void 0:n.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(t==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oc,"X-Stainless-OS":iC(globalThis.process.platform??"unknown"),"X-Stainless-Arch":aC(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=GK();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oc,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function GK(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const a=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${a}.${i}.${o}`}}}return null}const aC=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",iC=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let oC;const QK=()=>oC??(oC=ZK());function YK(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function tM(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function nM(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return tM({start(){},async pull(n){const{done:r,value:a}=await e.next();r?n.close():n.enqueue(a)},async cancel(){var n;await((n=e.return)==null?void 0:n.call(e))}})}function sM(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function XK(t){var r,a;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((a=(r=t[Symbol.asyncIterator]()).return)==null?void 0:a.call(r));return}const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}const JK=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),rM="RFC3986",aM=t=>String(t),lC={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:aM},eZ="RFC1738";let Rw=(t,e)=>(Rw=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),Rw(t,e));const Aa=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),py=1024,tZ=(t,e,n,r,a)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});let o="";for(let c=0;c<i.length;c+=py){const d=i.length>=py?i.slice(c,c+py):i,u=[];for(let m=0;m<d.length;++m){let f=d.charCodeAt(m);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||a===eZ&&(f===40||f===41)){u[u.length]=d.charAt(m);continue}if(f<128){u[u.length]=Aa[f];continue}if(f<2048){u[u.length]=Aa[192|f>>6]+Aa[128|f&63];continue}if(f<55296||f>=57344){u[u.length]=Aa[224|f>>12]+Aa[128|f>>6&63]+Aa[128|f&63];continue}m+=1,f=65536+((f&1023)<<10|d.charCodeAt(m)&1023),u[u.length]=Aa[240|f>>18]+Aa[128|f>>12&63]+Aa[128|f>>6&63]+Aa[128|f&63]}o+=u.join("")}return o};function nZ(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function cC(t,e){if(Gs(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const iM={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},oM=function(t,e){Array.prototype.push.apply(t,Gs(e)?e:[e])};let dC;const Gn={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:tZ,encodeValuesOnly:!1,format:rM,formatter:aM,indices:!1,serializeDate(t){return(dC??(dC=Function.prototype.call.bind(Date.prototype.toISOString)))(t)},skipNulls:!1,strictNullHandling:!1};function sZ(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const gy={};function lM(t,e,n,r,a,i,o,c,d,u,m,f,p,v,w,x,y,j){let b=t,N=j,S=0,E=!1;for(;(N=N.get(gy))!==void 0&&!E;){const I=N.get(t);if(S+=1,typeof I<"u"){if(I===S)throw new RangeError("Cyclic object value");E=!0}typeof N.get(gy)>"u"&&(S=0)}if(typeof u=="function"?b=u(e,b):b instanceof Date?b=p==null?void 0:p(b):n==="comma"&&Gs(b)&&(b=cC(b,function(I){return I instanceof Date?p==null?void 0:p(I):I})),b===null){if(i)return d&&!x?d(e,Gn.encoder,y,"key",v):e;b=""}if(sZ(b)||nZ(b)){if(d){const I=x?e:d(e,Gn.encoder,y,"key",v);return[(w==null?void 0:w(I))+"="+(w==null?void 0:w(d(b,Gn.encoder,y,"value",v)))]}return[(w==null?void 0:w(e))+"="+(w==null?void 0:w(String(b)))]}const C=[];if(typeof b>"u")return C;let P;if(n==="comma"&&Gs(b))x&&d&&(b=cC(b,d)),P=[{value:b.length>0?b.join(",")||null:void 0}];else if(Gs(u))P=u;else{const I=Object.keys(b);P=m?I.sort(m):I}const R=c?String(e).replace(/\./g,"%2E"):String(e),H=r&&Gs(b)&&b.length===1?R+"[]":R;if(a&&Gs(b)&&b.length===0)return H+"[]";for(let I=0;I<P.length;++I){const D=P[I],W=typeof D=="object"&&typeof D.value<"u"?D.value:b[D];if(o&&W===null)continue;const V=f&&c?D.replace(/\./g,"%2E"):D,G=Gs(b)?typeof n=="function"?n(H,V):H:H+(f?"."+V:"["+V+"]");j.set(t,S);const Y=new WeakMap;Y.set(gy,j),oM(C,lM(W,G,n,r,a,i,o,c,n==="comma"&&x&&Gs(b)?null:d,u,m,f,p,v,w,x,y,Y))}return C}function rZ(t=Gn){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Gn.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=rM;if(typeof t.format<"u"){if(!Rw(lC,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=lC[n];let a=Gn.filter;(typeof t.filter=="function"||Gs(t.filter))&&(a=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in iM?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=Gn.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Gn.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Gn.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Gn.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Gn.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Gn.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Gn.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Gn.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Gn.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Gn.encodeValuesOnly,filter:a,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Gn.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Gn.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Gn.strictNullHandling}}function aZ(t,e={}){let n=t;const r=rZ(e);let a,i;typeof r.filter=="function"?(i=r.filter,n=i("",n)):Gs(r.filter)&&(i=r.filter,a=i);const o=[];if(typeof n!="object"||n===null)return"";const c=iM[r.arrayFormat],d=c==="comma"&&r.commaRoundTrip;a||(a=Object.keys(n)),r.sort&&a.sort(r.sort);const u=new WeakMap;for(let p=0;p<a.length;++p){const v=a[p];r.skipNulls&&n[v]===null||oM(o,lM(n[v],v,c,d,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}const m=o.join(r.delimiter);let f=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),m.length>0?f+m:""}function iZ(t){let e=0;for(const a of t)e+=a.length;const n=new Uint8Array(e);let r=0;for(const a of t)n.set(a,r),r+=a.length;return n}let uC;function Vj(t){let e;return(uC??(e=new globalThis.TextEncoder,uC=e.encode.bind(e)))(t)}let hC;function mC(t){let e;return(hC??(e=new globalThis.TextDecoder,hC=e.decode.bind(e)))(t)}var ar,ir;class Vg{constructor(){ar.set(this,void 0),ir.set(this,void 0),kt(this,ar,new Uint8Array),kt(this,ir,null)}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Vj(e):e;kt(this,ar,iZ([ge(this,ar,"f"),n]));const r=[];let a;for(;(a=oZ(ge(this,ar,"f"),ge(this,ir,"f")))!=null;){if(a.carriage&&ge(this,ir,"f")==null){kt(this,ir,a.index);continue}if(ge(this,ir,"f")!=null&&(a.index!==ge(this,ir,"f")+1||a.carriage)){r.push(mC(ge(this,ar,"f").subarray(0,ge(this,ir,"f")-1))),kt(this,ar,ge(this,ar,"f").subarray(ge(this,ir,"f"))),kt(this,ir,null);continue}const i=ge(this,ir,"f")!==null?a.preceding-1:a.preceding,o=mC(ge(this,ar,"f").subarray(0,i));r.push(o),kt(this,ar,ge(this,ar,"f").subarray(a.index)),kt(this,ir,null)}return r}flush(){return ge(this,ar,"f").length?this.decode(`
`):[]}}ar=new WeakMap,ir=new WeakMap;Vg.NEWLINE_CHARS=new Set([`
`,"\r"]);Vg.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function oZ(t,e){for(let a=e??0;a<t.length;a++){if(t[a]===10)return{preceding:a,index:a+1,carriage:!1};if(t[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function lZ(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}const P0={off:0,error:200,warn:300,info:400,debug:500},fC=(t,e,n)=>{if(t){if(qK(P0,t))return t;gs(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(P0))}`)}};function Hu(){}function Qf(t,e,n){return!e||P0[t]>P0[n]?Hu:e[t].bind(e)}const cZ={error:Hu,warn:Hu,info:Hu,debug:Hu};let pC=new WeakMap;function gs(t){const e=t.logger,n=t.logLevel??"off";if(!e)return cZ;const r=pC.get(e);if(r&&r[0]===n)return r[1];const a={error:Qf("error",e,n),warn:Qf("warn",e,n),info:Qf("info",e,n),debug:Qf("debug",e,n)};return pC.set(e,[n,a]),a}const ol=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var Tu;class $a{constructor(e,n,r){this.iterator=e,Tu.set(this,void 0),this.controller=n,kt(this,Tu,r)}static fromSSEResponse(e,n,r){let a=!1;const i=r?gs(r):console;async function*o(){if(a)throw new wt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let c=!1;try{for await(const d of dZ(e,n))if(!c){if(d.data.startsWith("[DONE]")){c=!0;continue}if(d.event===null||!d.event.startsWith("thread.")){let u;try{u=JSON.parse(d.data)}catch(m){throw i.error("Could not parse message into JSON:",d.data),i.error("From chunk:",d.raw),m}if(u&&u.error)throw new bs(void 0,u.error,void 0,e.headers);yield u}else{let u;try{u=JSON.parse(d.data)}catch(m){throw console.error("Could not parse message into JSON:",d.data),console.error("From chunk:",d.raw),m}if(d.event=="error")throw new bs(void 0,u.error,u.message,void 0);yield{event:d.event,data:u}}}c=!0}catch(d){if(Tw(d))return;throw d}finally{c||n.abort()}}return new $a(o,n,r)}static fromReadableStream(e,n,r){let a=!1;async function*i(){const c=new Vg,d=sM(e);for await(const u of d)for(const m of c.decode(u))yield m;for(const u of c.flush())yield u}async function*o(){if(a)throw new wt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");a=!0;let c=!1;try{for await(const d of i())c||d&&(yield JSON.parse(d));c=!0}catch(d){if(Tw(d))return;throw d}finally{c||n.abort()}}return new $a(o,n,r)}[(Tu=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),a=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),n.push(o)}return i.shift()}});return[new $a(()=>a(e),this.controller,ge(this,Tu,"f")),new $a(()=>a(n),this.controller,ge(this,Tu,"f"))]}toReadableStream(){const e=this;let n;return tM({async start(){n=e[Symbol.asyncIterator]()},async pull(r){try{const{value:a,done:i}=await n.next();if(i)return r.close();const o=Vj(JSON.stringify(a)+`
`);r.enqueue(o)}catch(a){r.error(a)}},async cancel(){var r;await((r=n.return)==null?void 0:r.call(n))}})}}async function*dZ(t,e){if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new wt("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new wt("Attempted to iterate over a response with no body");const n=new hZ,r=new Vg,a=sM(t.body);for await(const i of uZ(a))for(const o of r.decode(i)){const c=n.decode(o);c&&(yield c)}for(const i of r.flush()){const o=n.decode(i);o&&(yield o)}}async function*uZ(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?Vj(n):n;let a=new Uint8Array(e.length+r.length);a.set(e),a.set(r,e.length),e=a;let i;for(;(i=lZ(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class hZ{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,a]=mZ(e,":");return a.startsWith(" ")&&(a=a.substring(1)),n==="event"?this.event=a:n==="data"&&this.data.push(a),null}}function mZ(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}async function cM(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:a,startTime:i}=e,o=await(async()=>{var f;if(e.options.stream)return gs(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):$a.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const c=n.headers.get("content-type"),d=(f=c==null?void 0:c.split(";")[0])==null?void 0:f.trim();if((d==null?void 0:d.includes("application/json"))||(d==null?void 0:d.endsWith("+json"))){const p=await n.json();return dM(p,n)}return await n.text()})();return gs(t).debug(`[${r}] response parsed`,ol({retryOfRequestLogID:a,url:n.url,status:n.status,body:o,durationMs:Date.now()-i})),o}function dM(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var Wu;class Kg extends Promise{constructor(e,n,r=cM){super(a=>{a(null)}),this.responsePromise=n,this.parseResponse=r,Wu.set(this,void 0),kt(this,Wu,e)}_thenUnwrap(e){return new Kg(ge(this,Wu,"f"),this.responsePromise,async(n,r)=>dM(e(await this.parseResponse(n,r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(ge(this,Wu,"f"),e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}Wu=new WeakMap;var Yf;class Kj{constructor(e,n,r,a){Yf.set(this,void 0),kt(this,Yf,e),this.options=a,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const e=this.nextPageRequestOptions();if(!e)throw new wt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await ge(this,Yf,"f").requestAPIList(this.constructor,e)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Yf=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class fZ extends Kg{constructor(e,n,r){super(e,n,async(a,i)=>new r(a,i.response,await cM(a,i),i.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}class Zg extends Kj{constructor(e,n,r,a){super(e,n,r,a),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class Wn extends Kj{constructor(e,n,r,a){super(e,n,r,a),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var r;const e=this.getPaginatedItems(),n=(r=e[e.length-1])==null?void 0:r.id;return n?{...this.options,query:{...eM(this.options.query),after:n}}:null}}class pZ extends Kj{constructor(e,n,r,a){super(e,n,r,a),this.data=r.data||[],this.has_more=r.has_more||!1,this.last_id=r.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?{...this.options,query:{...eM(this.options.query),after:e}}:null}}const uM=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)==null?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function vh(t,e,n){return uM(),new File(t,e??"unknown_file",n)}function Cp(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const hM=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",Vl=async(t,e)=>({...t,body:await xZ(t.body,e)}),gC=new WeakMap;function gZ(t){const e=typeof t=="function"?t:t.fetch,n=gC.get(e);if(n)return n;const r=(async()=>{try{const a="Response"in e?e.Response:(await e("data:,")).constructor,i=new FormData;return i.toString()!==await new a(i).text()}catch{return!0}})();return gC.set(e,r),r}const xZ=async(t,e)=>{if(!await gZ(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([r,a])=>Iw(n,r,a))),n},vZ=t=>t instanceof Blob&&"name"in t,Iw=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(n instanceof Response)t.append(e,vh([await n.blob()],Cp(n)));else if(hM(n))t.append(e,vh([await new Response(nM(n)).blob()],Cp(n)));else if(vZ(n))t.append(e,n,Cp(n));else if(Array.isArray(n))await Promise.all(n.map(r=>Iw(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,a])=>Iw(t,`${e}[${r}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},mM=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",yZ=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&mM(t),_Z=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function wZ(t,e,n){if(uM(),t=await t,yZ(t))return t instanceof File?t:vh([await t.arrayBuffer()],t.name);if(_Z(t)){const a=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),vh(await Ow(a),e,n)}const r=await Ow(t);if(e||(e=Cp(t)),!(n!=null&&n.type)){const a=r.find(i=>typeof i=="object"&&"type"in i&&i.type);typeof a=="string"&&(n={...n,type:a})}return vh(r,e,n)}async function Ow(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(mM(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else if(hM(t))for await(const r of t)e.push(...await Ow(r));else{const r=(n=t==null?void 0:t.constructor)==null?void 0:n.name;throw new Error(`Unexpected data type: ${typeof t}${r?`; constructor: ${r}`:""}${bZ(t)}`)}return e}function bZ(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}class jt{constructor(e){this._client=e}}function fM(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const xC=Object.freeze(Object.create(null)),jZ=(t=fM)=>function(n,...r){if(n.length===1)return n[0];let a=!1;const i=[],o=n.reduce((m,f,p)=>{var x;/[?#]/.test(f)&&(a=!0);const v=r[p];let w=(a?encodeURIComponent:t)(""+v);return p!==r.length&&(v==null||typeof v=="object"&&v.toString===((x=Object.getPrototypeOf(Object.getPrototypeOf(v.hasOwnProperty??xC)??xC))==null?void 0:x.toString))&&(w=v+"",i.push({start:m.length+f.length,length:w.length,error:`Value of type ${Object.prototype.toString.call(v).slice(8,-1)} is not a valid path parameter`})),m+f+(p===r.length?"":w)},""),c=o.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let u;for(;(u=d.exec(c))!==null;)i.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(i.sort((m,f)=>m.start-f.start),i.length>0){let m=0;const f=i.reduce((p,v)=>{const w=" ".repeat(v.start-m),x="^".repeat(v.length);return m=v.start+v.length,p+w+x},"");throw new wt(`Path parameters result in path with invalid segments:
${i.map(p=>p.error).join(`
`)}
${o}
${f}`)}return o},qe=jZ(fM);let pM=class extends jt{list(e,n={},r){return this._client.getAPIList(qe`/chat/completions/${e}/messages`,Wn,{query:n,...r})}};function D0(t){return t!==void 0&&"function"in t&&t.function!==void 0}function Zj(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function Fm(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function NZ(t,e){return!e||!gM(e)?{...t,choices:t.choices.map(n=>(xM(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:Gj(t,e)}function Gj(t,e){const n=t.choices.map(r=>{var a;if(r.finish_reason==="length")throw new XT;if(r.finish_reason==="content_filter")throw new JT;return xM(r.message.tool_calls),{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((a=r.message.tool_calls)==null?void 0:a.map(i=>kZ(e,i)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?SZ(e,r.message.content):null}}});return{...t,choices:n}}function SZ(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function kZ(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(a=>{var i;return D0(a)&&((i=a.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Fm(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function CZ(t,e){var r;if(!t||!("tools"in t)||!t.tools)return!1;const n=(r=t.tools)==null?void 0:r.find(a=>{var i;return D0(a)&&((i=a.function)==null?void 0:i.name)===e.function.name});return D0(n)&&(Fm(n)||(n==null?void 0:n.function.strict)||!1)}function gM(t){var e;return Zj(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>Fm(n)||n.type==="function"&&n.function.strict===!0))??!1}function xM(t){for(const e of t||[])if(e.type!=="function")throw new wt(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function EZ(t){for(const e of t??[]){if(e.type!=="function")throw new wt(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new wt(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const T0=t=>(t==null?void 0:t.role)==="assistant",vM=t=>(t==null?void 0:t.role)==="tool";var Lw,Ep,Ap,Vu,Ku,Pp,Zu,mi,Gu,M0,R0,Lc,yM;class Qj{constructor(){Lw.add(this),this.controller=new AbortController,Ep.set(this,void 0),Ap.set(this,()=>{}),Vu.set(this,()=>{}),Ku.set(this,void 0),Pp.set(this,()=>{}),Zu.set(this,()=>{}),mi.set(this,{}),Gu.set(this,!1),M0.set(this,!1),R0.set(this,!1),Lc.set(this,!1),kt(this,Ep,new Promise((e,n)=>{kt(this,Ap,e,"f"),kt(this,Vu,n,"f")})),kt(this,Ku,new Promise((e,n)=>{kt(this,Pp,e,"f"),kt(this,Zu,n,"f")})),ge(this,Ep,"f").catch(()=>{}),ge(this,Ku,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},ge(this,Lw,"m",yM).bind(this))},0)}_connected(){this.ended||(ge(this,Ap,"f").call(this),this._emit("connect"))}get ended(){return ge(this,Gu,"f")}get errored(){return ge(this,M0,"f")}get aborted(){return ge(this,R0,"f")}abort(){this.controller.abort()}on(e,n){return(ge(this,mi,"f")[e]||(ge(this,mi,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=ge(this,mi,"f")[e];if(!r)return this;const a=r.findIndex(i=>i.listener===n);return a>=0&&r.splice(a,1),this}once(e,n){return(ge(this,mi,"f")[e]||(ge(this,mi,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{kt(this,Lc,!0),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){kt(this,Lc,!0),await ge(this,Ku,"f")}_emit(e,...n){if(ge(this,Gu,"f"))return;e==="end"&&(kt(this,Gu,!0),ge(this,Pp,"f").call(this));const r=ge(this,mi,"f")[e];if(r&&(ge(this,mi,"f")[e]=r.filter(a=>!a.once),r.forEach(({listener:a})=>a(...n))),e==="abort"){const a=n[0];!ge(this,Lc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),ge(this,Vu,"f").call(this,a),ge(this,Zu,"f").call(this,a),this._emit("end");return}if(e==="error"){const a=n[0];!ge(this,Lc,"f")&&!(r!=null&&r.length)&&Promise.reject(a),ge(this,Vu,"f").call(this,a),ge(this,Zu,"f").call(this,a),this._emit("end")}}_emitFinal(){}}Ep=new WeakMap,Ap=new WeakMap,Vu=new WeakMap,Ku=new WeakMap,Pp=new WeakMap,Zu=new WeakMap,mi=new WeakMap,Gu=new WeakMap,M0=new WeakMap,R0=new WeakMap,Lc=new WeakMap,Lw=new WeakSet,yM=function(e){if(kt(this,M0,!0),e instanceof Error&&e.name==="AbortError"&&(e=new Ir),e instanceof Ir)return kt(this,R0,!0),this._emit("abort",e);if(e instanceof wt)return this._emit("error",e);if(e instanceof Error){const n=new wt(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new wt(String(e)))};function AZ(t){return typeof t.parse=="function"}var Is,Fw,I0,Bw,zw,$w,_M,wM;const PZ=10;class bM extends Qj{constructor(){super(...arguments),Is.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),vM(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(T0(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionToolCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new wt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),ge(this,Is,"m",Fw).call(this)}async finalMessage(){return await this.done(),ge(this,Is,"m",I0).call(this)}async finalFunctionToolCall(){return await this.done(),ge(this,Is,"m",Bw).call(this)}async finalFunctionToolCallResult(){return await this.done(),ge(this,Is,"m",zw).call(this)}async totalUsage(){return await this.done(),ge(this,Is,"m",$w).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=ge(this,Is,"m",I0).call(this);n&&this._emit("finalMessage",n);const r=ge(this,Is,"m",Fw).call(this);r&&this._emit("finalContent",r);const a=ge(this,Is,"m",Bw).call(this);a&&this._emit("finalFunctionToolCall",a);const i=ge(this,Is,"m",zw).call(this);i!=null&&this._emit("finalFunctionToolCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",ge(this,Is,"m",$w).call(this))}async _createChatCompletion(e,n,r){const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ge(this,Is,"m",_M).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Gj(i,n))}async _runChatCompletion(e,n,r){for(const a of n.messages)this._addMessage(a,!1);return await this._createChatCompletion(e,n,r)}async _runTools(e,n,r){var v,w,x;const a="tool",{tool_choice:i="auto",stream:o,...c}=n,d=typeof i!="string"&&i.type==="function"&&((v=i==null?void 0:i.function)==null?void 0:v.name),{maxChatCompletions:u=PZ}=r||{},m=n.tools.map(y=>{if(Fm(y)){if(!y.$callback)throw new wt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:y.$callback,name:y.function.name,description:y.function.description||"",parameters:y.function.parameters,parse:y.$parseRaw,strict:!0}}}return y}),f={};for(const y of m)y.type==="function"&&(f[y.function.name||y.function.function.name]=y.function);const p="tools"in n?m.map(y=>y.type==="function"?{type:"function",function:{name:y.function.name||y.function.function.name,parameters:y.function.parameters,description:y.function.description,strict:y.function.strict}}:y):void 0;for(const y of n.messages)this._addMessage(y,!1);for(let y=0;y<u;++y){const b=(w=(await this._createChatCompletion(e,{...c,tool_choice:i,tools:p,messages:[...this.messages]},r)).choices[0])==null?void 0:w.message;if(!b)throw new wt("missing message in ChatCompletion response");if(!((x=b.tool_calls)!=null&&x.length))return;for(const N of b.tool_calls){if(N.type!=="function")continue;const S=N.id,{name:E,arguments:C}=N.function,P=f[E];if(P){if(d&&d!==E){const D=`Invalid tool_call: ${JSON.stringify(E)}. ${JSON.stringify(d)} requested. Please try again`;this._addMessage({role:a,tool_call_id:S,content:D});continue}}else{const D=`Invalid tool_call: ${JSON.stringify(E)}. Available options are: ${Object.keys(f).map(W=>JSON.stringify(W)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:S,content:D});continue}let R;try{R=AZ(P)?await P.parse(C):C}catch(D){const W=D instanceof Error?D.message:String(D);this._addMessage({role:a,tool_call_id:S,content:W});continue}const H=await P.function(R,this),I=ge(this,Is,"m",wM).call(this,H);if(this._addMessage({role:a,tool_call_id:S,content:I}),d)return}}}}Is=new WeakSet,Fw=function(){return ge(this,Is,"m",I0).call(this).content??null},I0=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(T0(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new wt("stream ended without producing a ChatCompletionMessage with role=assistant")},Bw=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const a=this.messages[r];if(T0(a)&&((e=a==null?void 0:a.tool_calls)!=null&&e.length))return(n=a.tool_calls.filter(i=>i.type==="function").at(-1))==null?void 0:n.function}},zw=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(vM(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var a;return r.role==="assistant"&&((a=r.tool_calls)==null?void 0:a.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},$w=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},_M=function(e){if(e.n!=null&&e.n>1)throw new wt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},wM=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Yj extends bM{static runTools(e,n,r){const a=new Yj,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,i)),a}_addMessage(e,n=!0){super._addMessage(e,n),T0(e)&&e.content&&this._emit("content",e.content)}}const jM=1,NM=2,SM=4,kM=8,CM=16,EM=32,AM=64,PM=128,DM=256,TM=PM|DM,MM=CM|EM|TM|AM,RM=jM|NM|MM,IM=SM|kM,DZ=RM|IM,rs={STR:jM,NUM:NM,ARR:SM,OBJ:kM,NULL:CM,BOOL:EM,NAN:AM,INFINITY:PM,MINUS_INFINITY:DM,INF:TM,SPECIAL:MM,ATOM:RM,COLLECTION:IM,ALL:DZ};class TZ extends Error{}class MZ extends Error{}function RZ(t,e=rs.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return IZ(t.trim(),e)}const IZ=(t,e)=>{const n=t.length;let r=0;const a=p=>{throw new TZ(`${p} at position ${r}`)},i=p=>{throw new MZ(`${p} at position ${r}`)},o=()=>(f(),r>=n&&a("Unexpected end of input"),t[r]==='"'?c():t[r]==="{"?d():t[r]==="["?u():t.substring(r,r+4)==="null"||rs.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||rs.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||rs.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||rs.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||rs.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||rs.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):m()),c=()=>{const p=r;let v=!1;for(r++;r<n&&(t[r]!=='"'||v&&t[r-1]==="\\");)v=t[r]==="\\"?!v:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(p,++r-Number(v)))}catch(w){i(String(w))}else if(rs.STR&e)try{return JSON.parse(t.substring(p,r-Number(v))+'"')}catch{return JSON.parse(t.substring(p,t.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},d=()=>{r++,f();const p={};try{for(;t[r]!=="}";){if(f(),r>=n&&rs.OBJ&e)return p;const v=c();f(),r++;try{const w=o();Object.defineProperty(p,v,{value:w,writable:!0,enumerable:!0,configurable:!0})}catch(w){if(rs.OBJ&e)return p;throw w}f(),t[r]===","&&r++}}catch{if(rs.OBJ&e)return p;a("Expected '}' at end of object")}return r++,p},u=()=>{r++;const p=[];try{for(;t[r]!=="]";)p.push(o()),f(),t[r]===","&&r++}catch{if(rs.ARR&e)return p;a("Expected ']' at end of array")}return r++,p},m=()=>{if(r===0){t==="-"&&rs.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t)}catch(v){if(rs.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(v))}}const p=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(rs.NUM&e)&&a("Unterminated number literal");try{return JSON.parse(t.substring(p,r))}catch{t.substring(p,r)==="-"&&rs.NUM&e&&a("Not sure what '-' is");try{return JSON.parse(t.substring(p,t.lastIndexOf("e")))}catch(w){i(String(w))}}},f=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return o()},vC=t=>RZ(t,rs.ALL^rs.NUM);var Zn,li,Sc,$i,xy,Xf,vy,yy,_y,Jf,wy,yC;class lm extends bM{constructor(e){super(),Zn.add(this),li.set(this,void 0),Sc.set(this,void 0),$i.set(this,void 0),kt(this,li,e),kt(this,Sc,[])}get currentChatCompletionSnapshot(){return ge(this,$i,"f")}static fromReadableStream(e){const n=new lm(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const a=new lm(n);return a._run(()=>a._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(e,n,r){var o;super._createChatCompletion;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ge(this,Zn,"m",xy).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const c of i)ge(this,Zn,"m",vy).call(this,c);if((o=i.controller.signal)!=null&&o.aborted)throw new Ir;return this._addChatCompletion(ge(this,Zn,"m",Jf).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),ge(this,Zn,"m",xy).call(this),this._connected();const a=$a.fromReadableStream(e,this.controller);let i;for await(const c of a)i&&i!==c.id&&this._addChatCompletion(ge(this,Zn,"m",Jf).call(this)),ge(this,Zn,"m",vy).call(this,c),i=c.id;if((o=a.controller.signal)!=null&&o.aborted)throw new Ir;return this._addChatCompletion(ge(this,Zn,"m",Jf).call(this))}[(li=new WeakMap,Sc=new WeakMap,$i=new WeakMap,Zn=new WeakSet,xy=function(){this.ended||kt(this,$i,void 0)},Xf=function(n){let r=ge(this,Sc,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},ge(this,Sc,"f")[n.index]=r,r)},vy=function(n){var a,i,o,c,d,u,m,f,p,v,w,x,y,j,b;if(this.ended)return;const r=ge(this,Zn,"m",yC).call(this,n);this._emit("chunk",n,r);for(const N of n.choices){const S=r.choices[N.index];N.delta.content!=null&&((a=S.message)==null?void 0:a.role)==="assistant"&&((i=S.message)!=null&&i.content)&&(this._emit("content",N.delta.content,S.message.content),this._emit("content.delta",{delta:N.delta.content,snapshot:S.message.content,parsed:S.message.parsed})),N.delta.refusal!=null&&((o=S.message)==null?void 0:o.role)==="assistant"&&((c=S.message)!=null&&c.refusal)&&this._emit("refusal.delta",{delta:N.delta.refusal,snapshot:S.message.refusal}),((d=N.logprobs)==null?void 0:d.content)!=null&&((u=S.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(m=N.logprobs)==null?void 0:m.content,snapshot:((f=S.logprobs)==null?void 0:f.content)??[]}),((p=N.logprobs)==null?void 0:p.refusal)!=null&&((v=S.message)==null?void 0:v.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(w=N.logprobs)==null?void 0:w.refusal,snapshot:((x=S.logprobs)==null?void 0:x.refusal)??[]});const E=ge(this,Zn,"m",Xf).call(this,S);S.finish_reason&&(ge(this,Zn,"m",_y).call(this,S),E.current_tool_call_index!=null&&ge(this,Zn,"m",yy).call(this,S,E.current_tool_call_index));for(const C of N.delta.tool_calls??[])E.current_tool_call_index!==C.index&&(ge(this,Zn,"m",_y).call(this,S),E.current_tool_call_index!=null&&ge(this,Zn,"m",yy).call(this,S,E.current_tool_call_index)),E.current_tool_call_index=C.index;for(const C of N.delta.tool_calls??[]){const P=(y=S.message.tool_calls)==null?void 0:y[C.index];P!=null&&P.type&&((P==null?void 0:P.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(j=P.function)==null?void 0:j.name,index:C.index,arguments:P.function.arguments,parsed_arguments:P.function.parsed_arguments,arguments_delta:((b=C.function)==null?void 0:b.arguments)??""}):(P==null||P.type,void 0))}}},yy=function(n,r){var o,c,d;if(ge(this,Zn,"m",Xf).call(this,n).done_tool_calls.has(r))return;const i=(o=n.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const u=(d=(c=ge(this,li,"f"))==null?void 0:c.tools)==null?void 0:d.find(m=>D0(m)&&m.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:Fm(u)?u.$parseRaw(i.function.arguments):u!=null&&u.function.strict?JSON.parse(i.function.arguments):null})}else i.type},_y=function(n){var a,i;const r=ge(this,Zn,"m",Xf).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const o=ge(this,Zn,"m",wy).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(a=n.logprobs)!=null&&a.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},Jf=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");const n=ge(this,$i,"f");if(!n)throw new wt("request ended without sending any chunks");return kt(this,$i,void 0),kt(this,Sc,[]),OZ(n,ge(this,li,"f"))},wy=function(){var r;const n=(r=ge(this,li,"f"))==null?void 0:r.response_format;return Zj(n)?n:null},yC=function(n){var r,a,i,o;let c=ge(this,$i,"f");const{choices:d,...u}=n;c?Object.assign(c,u):c=kt(this,$i,{...u,choices:[]});for(const{delta:m,finish_reason:f,index:p,logprobs:v=null,...w}of n.choices){let x=c.choices[p];if(x||(x=c.choices[p]={finish_reason:f,index:p,message:{},logprobs:v,...w}),v)if(!x.logprobs)x.logprobs=Object.assign({},v);else{const{content:C,refusal:P,...R}=v;Object.assign(x.logprobs,R),C&&((r=x.logprobs).content??(r.content=[]),x.logprobs.content.push(...C)),P&&((a=x.logprobs).refusal??(a.refusal=[]),x.logprobs.refusal.push(...P))}if(f&&(x.finish_reason=f,ge(this,li,"f")&&gM(ge(this,li,"f")))){if(f==="length")throw new XT;if(f==="content_filter")throw new JT}if(Object.assign(x,w),!m)continue;const{content:y,refusal:j,function_call:b,role:N,tool_calls:S,...E}=m;if(Object.assign(x.message,E),j&&(x.message.refusal=(x.message.refusal||"")+j),N&&(x.message.role=N),b&&(x.message.function_call?(b.name&&(x.message.function_call.name=b.name),b.arguments&&((i=x.message.function_call).arguments??(i.arguments=""),x.message.function_call.arguments+=b.arguments)):x.message.function_call=b),y&&(x.message.content=(x.message.content||"")+y,!x.message.refusal&&ge(this,Zn,"m",wy).call(this)&&(x.message.parsed=vC(x.message.content))),S){x.message.tool_calls||(x.message.tool_calls=[]);for(const{index:C,id:P,type:R,function:H,...I}of S){const D=(o=x.message.tool_calls)[C]??(o[C]={});Object.assign(D,I),P&&(D.id=P),R&&(D.type=R),H&&(D.function??(D.function={name:H.name??"",arguments:""})),H!=null&&H.name&&(D.function.name=H.name),H!=null&&H.arguments&&(D.function.arguments+=H.arguments,CZ(ge(this,li,"f"),D)&&(D.function.parsed_arguments=vC(D.function.arguments)))}}}return c},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new $a(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function OZ(t,e){const{id:n,choices:r,created:a,model:i,system_fingerprint:o,...c}=t,d={...c,id:n,choices:r.map(({message:u,finish_reason:m,index:f,logprobs:p,...v})=>{if(!m)throw new wt(`missing finish_reason for choice ${f}`);const{content:w=null,function_call:x,tool_calls:y,...j}=u,b=u.role;if(!b)throw new wt(`missing role for choice ${f}`);if(x){const{arguments:N,name:S}=x;if(N==null)throw new wt(`missing function_call.arguments for choice ${f}`);if(!S)throw new wt(`missing function_call.name for choice ${f}`);return{...v,message:{content:w,function_call:{arguments:N,name:S},role:b,refusal:u.refusal??null},finish_reason:m,index:f,logprobs:p}}return y?{...v,index:f,finish_reason:m,logprobs:p,message:{...j,role:b,content:w,refusal:u.refusal??null,tool_calls:y.map((N,S)=>{const{function:E,type:C,id:P,...R}=N,{arguments:H,name:I,...D}=E||{};if(P==null)throw new wt(`missing choices[${f}].tool_calls[${S}].id
${ep(t)}`);if(C==null)throw new wt(`missing choices[${f}].tool_calls[${S}].type
${ep(t)}`);if(I==null)throw new wt(`missing choices[${f}].tool_calls[${S}].function.name
${ep(t)}`);if(H==null)throw new wt(`missing choices[${f}].tool_calls[${S}].function.arguments
${ep(t)}`);return{...R,id:P,type:C,function:{...D,name:I,arguments:H}}})}}:{...v,message:{...j,content:w,role:b,refusal:u.refusal??null},finish_reason:m,index:f,logprobs:p}}),created:a,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return NZ(d,e)}function ep(t){return JSON.stringify(t)}class O0 extends lm{static fromReadableStream(e){const n=new O0(null);return n._run(()=>n._fromReadableStream(e)),n}static runTools(e,n,r){const a=new O0(n),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(e,n,i)),a}}let Xj=class extends jt{constructor(){super(...arguments),this.messages=new pM(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(qe`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(qe`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return this._client.getAPIList("/chat/completions",Wn,{query:e,...n})}delete(e,n){return this._client.delete(qe`/chat/completions/${e}`,n)}parse(e,n){return EZ(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(r=>Gj(r,e))}runTools(e,n){return e.stream?O0.runTools(this._client,e,n):Yj.runTools(this._client,e,n)}stream(e,n){return lm.createChatCompletion(this._client,e,n)}};Xj.Messages=pM;class Jj extends jt{constructor(){super(...arguments),this.completions=new Xj(this._client)}}Jj.Completions=Xj;const OM=Symbol("brand.privateNullableHeaders");function*LZ(t){if(!t)return;if(OM in t){const{values:r,nulls:a}=t;yield*r.entries();for(const i of a)yield[i,null];return}let e=!1,n;t instanceof Headers?n=t.entries():rC(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let r of n){const a=r[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const i=rC(r[1])?r[1]:[r[1]];let o=!1;for(const c of i)c!==void 0&&(e&&!o&&(o=!0,yield[a,null]),yield[a,c])}}const pt=t=>{const e=new Headers,n=new Set;for(const r of t){const a=new Set;for(const[i,o]of LZ(r)){const c=i.toLowerCase();a.has(c)||(e.delete(i),a.add(c)),o===null?(e.delete(i),n.add(c)):(e.append(i,o),n.delete(c))}}return{[OM]:!0,values:e,nulls:n}};class LM extends jt{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:pt([{Accept:"application/octet-stream"},n==null?void 0:n.headers]),__binaryResponse:!0})}}class FM extends jt{create(e,n){return this._client.post("/audio/transcriptions",Vl({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class BM extends jt{create(e,n){return this._client.post("/audio/translations",Vl({body:e,...n,__metadata:{model:e.model}},this._client))}}class Bm extends jt{constructor(){super(...arguments),this.transcriptions=new FM(this._client),this.translations=new BM(this._client),this.speech=new LM(this._client)}}Bm.Transcriptions=FM;Bm.Translations=BM;Bm.Speech=LM;class zM extends jt{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(qe`/batches/${e}`,n)}list(e={},n){return this._client.getAPIList("/batches",Wn,{query:e,...n})}cancel(e,n){return this._client.post(qe`/batches/${e}/cancel`,n)}}class $M extends jt{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(qe`/assistants/${e}`,{...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(qe`/assistants/${e}`,{body:n,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e={},n){return this._client.getAPIList("/assistants",Wn,{query:e,...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(qe`/assistants/${e}`,{...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class UM extends jt{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class qM extends jt{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}}class Gg extends jt{constructor(){super(...arguments),this.sessions=new UM(this._client),this.transcriptionSessions=new qM(this._client)}}Gg.Sessions=UM;Gg.TranscriptionSessions=qM;class HM extends jt{create(e,n,r){return this._client.post(qe`/threads/${e}/messages`,{body:n,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{thread_id:a}=n;return this._client.get(qe`/threads/${a}/messages/${e}`,{...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{thread_id:a,...i}=n;return this._client.post(qe`/threads/${a}/messages/${e}`,{body:i,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(qe`/threads/${e}/messages`,Wn,{query:n,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n,r){const{thread_id:a}=n;return this._client.delete(qe`/threads/${a}/messages/${e}`,{...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}class WM extends jt{retrieve(e,n,r){const{thread_id:a,run_id:i,...o}=n;return this._client.get(qe`/threads/${a}/runs/${i}/steps/${e}`,{query:o,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n,r){const{thread_id:a,...i}=n;return this._client.getAPIList(qe`/threads/${a}/runs/${e}/steps`,Wn,{query:i,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}const FZ=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let a=0;a<n;a++)r[a]=e.charCodeAt(a);return Array.from(new Float32Array(r.buffer))}};var by={};const kc=t=>{var e,n,r,a;if(typeof globalThis.process<"u")return((e=by==null?void 0:by[t])==null?void 0:e.trim())??void 0;if(typeof globalThis.Deno<"u")return(a=(r=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,t))==null?void 0:a.trim()};var xs,xl,Uw,Da,Dp,na,vl,Jc,dl,L0,or,Tp,Mp,yh,Qu,Yu,_C,wC,bC,jC,NC,SC,kC;class _h extends Qj{constructor(){super(...arguments),xs.add(this),Uw.set(this,[]),Da.set(this,{}),Dp.set(this,{}),na.set(this,void 0),vl.set(this,void 0),Jc.set(this,void 0),dl.set(this,void 0),L0.set(this,void 0),or.set(this,void 0),Tp.set(this,void 0),Mp.set(this,void 0),yh.set(this,void 0)}[(Uw=new WeakMap,Da=new WeakMap,Dp=new WeakMap,na=new WeakMap,vl=new WeakMap,Jc=new WeakMap,dl=new WeakMap,L0=new WeakMap,or=new WeakMap,Tp=new WeakMap,Mp=new WeakMap,yh=new WeakMap,xs=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new xl;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=$a.fromReadableStream(e,this.controller);for await(const o of a)ge(this,xs,"m",Qu).call(this,o);if((i=a.controller.signal)!=null&&i.aborted)throw new Ir;return this._addRun(ge(this,xs,"m",Yu).call(this))}toReadableStream(){return new $a(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,a){const i=new xl;return i._run(()=>i._runToolAssistantStream(e,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,n,r,a){var d;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},c=await e.submitToolOutputs(n,o,{...a,signal:this.controller.signal});this._connected();for await(const u of c)ge(this,xs,"m",Qu).call(this,u);if((d=c.controller.signal)!=null&&d.aborted)throw new Ir;return this._addRun(ge(this,xs,"m",Yu).call(this))}static createThreadAssistantStream(e,n,r){const a=new xl;return a._run(()=>a._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(e,n,r,a){const i=new xl;return i._run(()=>i._runAssistantStream(e,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return ge(this,Tp,"f")}currentRun(){return ge(this,Mp,"f")}currentMessageSnapshot(){return ge(this,na,"f")}currentRunStepSnapshot(){return ge(this,yh,"f")}async finalRunSteps(){return await this.done(),Object.values(ge(this,Da,"f"))}async finalMessages(){return await this.done(),Object.values(ge(this,Dp,"f"))}async finalRun(){if(await this.done(),!ge(this,vl,"f"))throw Error("Final run was not received.");return ge(this,vl,"f")}async _createThreadAssistantStream(e,n,r){var c;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const d of o)ge(this,xs,"m",Qu).call(this,d);if((c=o.controller.signal)!=null&&c.aborted)throw new Ir;return this._addRun(ge(this,xs,"m",Yu).call(this))}async _createAssistantStream(e,n,r,a){var d;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},c=await e.create(n,o,{...a,signal:this.controller.signal});this._connected();for await(const u of c)ge(this,xs,"m",Qu).call(this,u);if((d=c.controller.signal)!=null&&d.aborted)throw new Ir;return this._addRun(ge(this,xs,"m",Yu).call(this))}static accumulateDelta(e,n){for(const[r,a]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=a;continue}let i=e[r];if(i==null){e[r]=a;continue}if(r==="index"||r==="type"){e[r]=a;continue}if(typeof i=="string"&&typeof a=="string")i+=a;else if(typeof i=="number"&&typeof a=="number")i+=a;else if(fy(i)&&fy(a))i=this.accumulateDelta(i,a);else if(Array.isArray(i)&&Array.isArray(a)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...a);continue}for(const o of a){if(!fy(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const c=o.index;if(c==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof c!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${c}`);const d=i[c];d==null?i.push(o):i[c]=this.accumulateDelta(d,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${a}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,a){return await this._createAssistantStream(n,e,r,a)}async _runToolAssistantStream(e,n,r,a){return await this._createToolAssistantStream(n,e,r,a)}}xl=_h,Qu=function(e){if(!this.ended)switch(kt(this,Tp,e),ge(this,xs,"m",bC).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":ge(this,xs,"m",kC).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ge(this,xs,"m",wC).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":ge(this,xs,"m",_C).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Yu=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");if(!ge(this,vl,"f"))throw Error("Final run has not been received");return ge(this,vl,"f")},_C=function(e){const[n,r]=ge(this,xs,"m",NC).call(this,e,ge(this,na,"f"));kt(this,na,n),ge(this,Dp,"f")[n.id]=n;for(const a of r){const i=n.content[a.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const a of e.data.delta.content){if(a.type=="text"&&a.text){let i=a.text,o=n.content[a.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=ge(this,Jc,"f")){if(ge(this,dl,"f"))switch(ge(this,dl,"f").type){case"text":this._emit("textDone",ge(this,dl,"f").text,ge(this,na,"f"));break;case"image_file":this._emit("imageFileDone",ge(this,dl,"f").image_file,ge(this,na,"f"));break}kt(this,Jc,a.index)}kt(this,dl,n.content[a.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(ge(this,Jc,"f")!==void 0){const a=e.data.content[ge(this,Jc,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,ge(this,na,"f"));break;case"text":this._emit("textDone",a.text,ge(this,na,"f"));break}}ge(this,na,"f")&&this._emit("messageDone",e.data),kt(this,na,void 0)}},wC=function(e){const n=ge(this,xs,"m",jC).call(this,e);switch(kt(this,yh,n),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==ge(this,L0,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(ge(this,or,"f")&&this._emit("toolCallDone",ge(this,or,"f")),kt(this,L0,i.index),kt(this,or,n.step_details.tool_calls[i.index]),ge(this,or,"f")&&this._emit("toolCallCreated",ge(this,or,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":kt(this,yh,void 0),e.data.step_details.type=="tool_calls"&&ge(this,or,"f")&&(this._emit("toolCallDone",ge(this,or,"f")),kt(this,or,void 0)),this._emit("runStepDone",e.data,n);break}},bC=function(e){ge(this,Uw,"f").push(e),this._emit("event",e)},jC=function(e){switch(e.event){case"thread.run.step.created":return ge(this,Da,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=ge(this,Da,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const a=xl.accumulateDelta(n,r.delta);ge(this,Da,"f")[e.data.id]=a}return ge(this,Da,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":ge(this,Da,"f")[e.data.id]=e.data;break}if(ge(this,Da,"f")[e.data.id])return ge(this,Da,"f")[e.data.id];throw new Error("No snapshot available")},NC=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=e.data;if(a.delta.content)for(const i of a.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=ge(this,xs,"m",SC).call(this,i,o)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},SC=function(e,n){return xl.accumulateDelta(n,e)},kC=function(e){switch(kt(this,Mp,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":kt(this,vl,e.data),ge(this,or,"f")&&(this._emit("toolCallDone",ge(this,or,"f")),kt(this,or,void 0));break}};let e1=class extends jt{constructor(){super(...arguments),this.steps=new WM(this._client)}create(e,n,r){const{include:a,...i}=n;return this._client.post(qe`/threads/${e}/runs`,{query:{include:a},body:i,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers]),stream:n.stream??!1})}retrieve(e,n,r){const{thread_id:a}=n;return this._client.get(qe`/threads/${a}/runs/${e}`,{...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{thread_id:a,...i}=n;return this._client.post(qe`/threads/${a}/runs/${e}`,{body:i,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(qe`/threads/${e}/runs`,Wn,{query:n,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}cancel(e,n,r){const{thread_id:a}=n;return this._client.post(qe`/threads/${a}/runs/${e}/cancel`,{...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const a=await this.create(e,n,r);return await this.poll(a.id,{thread_id:e},r)}createAndStream(e,n,r){return _h.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){var i;const a=pt([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:c}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...a}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let d=5e3;if(r!=null&&r.pollIntervalMs)d=r.pollIntervalMs;else{const u=c.headers.get("openai-poll-after-ms");if(u){const m=parseInt(u);isNaN(m)||(d=m)}}await Lm(d);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(e,n,r){return _h.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r){const{thread_id:a,...i}=n;return this._client.post(qe`/threads/${a}/runs/${e}/submit_tool_outputs`,{body:i,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(e,n,r){const a=await this.submitToolOutputs(e,n,r);return await this.poll(a.id,n,r)}submitToolOutputsStream(e,n,r){return _h.createToolAssistantStream(e,this._client.beta.threads.runs,n,r)}};e1.Steps=WM;class Qg extends jt{constructor(){super(...arguments),this.runs=new e1(this._client),this.messages=new HM(this._client)}create(e={},n){return this._client.post("/threads",{body:e,...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(qe`/threads/${e}`,{...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(qe`/threads/${e}`,{body:n,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n){return this._client.delete(qe`/threads/${e}`,{...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.id,{thread_id:r.thread_id},n)}createAndRunStream(e,n){return _h.createThreadAssistantStream(e,this._client.beta.threads,n)}}Qg.Runs=e1;Qg.Messages=HM;class zm extends jt{constructor(){super(...arguments),this.realtime=new Gg(this._client),this.assistants=new $M(this._client),this.threads=new Qg(this._client)}}zm.Realtime=Gg;zm.Assistants=$M;zm.Threads=Qg;class VM extends jt{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let KM=class extends jt{retrieve(e,n,r){const{container_id:a}=n;return this._client.get(qe`/containers/${a}/files/${e}/content`,{...r,headers:pt([{Accept:"application/binary"},r==null?void 0:r.headers]),__binaryResponse:!0})}},t1=class extends jt{constructor(){super(...arguments),this.content=new KM(this._client)}create(e,n,r){return this._client.post(qe`/containers/${e}/files`,Vl({body:n,...r},this._client))}retrieve(e,n,r){const{container_id:a}=n;return this._client.get(qe`/containers/${a}/files/${e}`,r)}list(e,n={},r){return this._client.getAPIList(qe`/containers/${e}/files`,Wn,{query:n,...r})}delete(e,n,r){const{container_id:a}=n;return this._client.delete(qe`/containers/${a}/files/${e}`,{...r,headers:pt([{Accept:"*/*"},r==null?void 0:r.headers])})}};t1.Content=KM;class n1 extends jt{constructor(){super(...arguments),this.files=new t1(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(qe`/containers/${e}`,n)}list(e={},n){return this._client.getAPIList("/containers",Wn,{query:e,...n})}delete(e,n){return this._client.delete(qe`/containers/${e}`,{...n,headers:pt([{Accept:"*/*"},n==null?void 0:n.headers])})}}n1.Files=t1;class ZM extends jt{create(e,n,r){const{include:a,...i}=n;return this._client.post(qe`/conversations/${e}/items`,{query:{include:a},body:i,...r})}retrieve(e,n,r){const{conversation_id:a,...i}=n;return this._client.get(qe`/conversations/${a}/items/${e}`,{query:i,...r})}list(e,n={},r){return this._client.getAPIList(qe`/conversations/${e}/items`,pZ,{query:n,...r})}delete(e,n,r){const{conversation_id:a}=n;return this._client.delete(qe`/conversations/${a}/items/${e}`,r)}}class s1 extends jt{constructor(){super(...arguments),this.items=new ZM(this._client)}create(e,n){return this._client.post("/conversations",{body:e,...n})}retrieve(e,n){return this._client.get(qe`/conversations/${e}`,n)}update(e,n,r){return this._client.post(qe`/conversations/${e}`,{body:n,...r})}delete(e,n){return this._client.delete(qe`/conversations/${e}`,n)}}s1.Items=ZM;class GM extends jt{create(e,n){const r=!!e.encoding_format;let a=r?e.encoding_format:"base64";r&&gs(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:a},...n});return r?i:(gs(this._client).debug("embeddings/decoding base64 embeddings from base64"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(c=>{const d=c.embedding;c.embedding=FZ(d)}),o)))}}class QM extends jt{retrieve(e,n,r){const{eval_id:a,run_id:i}=n;return this._client.get(qe`/evals/${a}/runs/${i}/output_items/${e}`,r)}list(e,n,r){const{eval_id:a,...i}=n;return this._client.getAPIList(qe`/evals/${a}/runs/${e}/output_items`,Wn,{query:i,...r})}}class r1 extends jt{constructor(){super(...arguments),this.outputItems=new QM(this._client)}create(e,n,r){return this._client.post(qe`/evals/${e}/runs`,{body:n,...r})}retrieve(e,n,r){const{eval_id:a}=n;return this._client.get(qe`/evals/${a}/runs/${e}`,r)}list(e,n={},r){return this._client.getAPIList(qe`/evals/${e}/runs`,Wn,{query:n,...r})}delete(e,n,r){const{eval_id:a}=n;return this._client.delete(qe`/evals/${a}/runs/${e}`,r)}cancel(e,n,r){const{eval_id:a}=n;return this._client.post(qe`/evals/${a}/runs/${e}`,r)}}r1.OutputItems=QM;class a1 extends jt{constructor(){super(...arguments),this.runs=new r1(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(qe`/evals/${e}`,n)}update(e,n,r){return this._client.post(qe`/evals/${e}`,{body:n,...r})}list(e={},n){return this._client.getAPIList("/evals",Wn,{query:e,...n})}delete(e,n){return this._client.delete(qe`/evals/${e}`,n)}}a1.Runs=r1;let YM=class extends jt{create(e,n){return this._client.post("/files",Vl({body:e,...n},this._client))}retrieve(e,n){return this._client.get(qe`/files/${e}`,n)}list(e={},n){return this._client.getAPIList("/files",Wn,{query:e,...n})}delete(e,n){return this._client.delete(qe`/files/${e}`,n)}content(e,n){return this._client.get(qe`/files/${e}/content`,{...n,headers:pt([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!a.has(o.status);)if(await Lm(n),o=await this.retrieve(e),Date.now()-i>r)throw new Wj({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class XM extends jt{}let JM=class extends jt{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class i1 extends jt{constructor(){super(...arguments),this.graders=new JM(this._client)}}i1.Graders=JM;class e3 extends jt{create(e,n,r){return this._client.getAPIList(qe`/fine_tuning/checkpoints/${e}/permissions`,Zg,{body:n,method:"post",...r})}retrieve(e,n={},r){return this._client.get(qe`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...r})}delete(e,n,r){const{fine_tuned_model_checkpoint:a}=n;return this._client.delete(qe`/fine_tuning/checkpoints/${a}/permissions/${e}`,r)}}let o1=class extends jt{constructor(){super(...arguments),this.permissions=new e3(this._client)}};o1.Permissions=e3;class t3 extends jt{list(e,n={},r){return this._client.getAPIList(qe`/fine_tuning/jobs/${e}/checkpoints`,Wn,{query:n,...r})}}class l1 extends jt{constructor(){super(...arguments),this.checkpoints=new t3(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(qe`/fine_tuning/jobs/${e}`,n)}list(e={},n){return this._client.getAPIList("/fine_tuning/jobs",Wn,{query:e,...n})}cancel(e,n){return this._client.post(qe`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return this._client.getAPIList(qe`/fine_tuning/jobs/${e}/events`,Wn,{query:n,...r})}pause(e,n){return this._client.post(qe`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(qe`/fine_tuning/jobs/${e}/resume`,n)}}l1.Checkpoints=t3;class iu extends jt{constructor(){super(...arguments),this.methods=new XM(this._client),this.jobs=new l1(this._client),this.checkpoints=new o1(this._client),this.alpha=new i1(this._client)}}iu.Methods=XM;iu.Jobs=l1;iu.Checkpoints=o1;iu.Alpha=i1;class n3 extends jt{}class c1 extends jt{constructor(){super(...arguments),this.graderModels=new n3(this._client)}}c1.GraderModels=n3;class s3 extends jt{createVariation(e,n){return this._client.post("/images/variations",Vl({body:e,...n},this._client))}edit(e,n){return this._client.post("/images/edits",Vl({body:e,...n,stream:e.stream??!1},this._client))}generate(e,n){return this._client.post("/images/generations",{body:e,...n,stream:e.stream??!1})}}class r3 extends jt{retrieve(e,n){return this._client.get(qe`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",Zg,e)}delete(e,n){return this._client.delete(qe`/models/${e}`,n)}}class a3 extends jt{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function BZ(t,e){return!e||!$Z(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:i3(t,e)}function i3(t,e){const n=t.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:HZ(e,a)};if(a.type==="message"){const i=a.content.map(o=>o.type==="output_text"?{...o,parsed:zZ(e,o.text)}:o);return{...a,content:i}}return a}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||qw(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const a of r.output)if(a.type==="message"){for(const i of a.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function zZ(t,e){var n,r,a,i;return((r=(n=t.text)==null?void 0:n.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((a=t.text)==null?void 0:a.format)?((i=t.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function $Z(t){var e;return!!Zj((e=t.text)==null?void 0:e.format)}function UZ(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function qZ(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function HZ(t,e){const n=qZ(t.tools??[],e.name);return{...e,...e,parsed_arguments:UZ(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function qw(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}var Cc,tp,Ui,np,CC,EC,AC,PC;class d1 extends Qj{constructor(e){super(),Cc.add(this),tp.set(this,void 0),Ui.set(this,void 0),np.set(this,void 0),kt(this,tp,e)}static createResponse(e,n,r){const a=new d1(n);return a._run(()=>a._createOrRetrieveResponse(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createOrRetrieveResponse(e,n,r){var c;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),ge(this,Cc,"m",CC).call(this);let i,o=null;"response_id"in n?(i=await e.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),o=n.starting_after??null):i=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const d of i)ge(this,Cc,"m",EC).call(this,d,o);if((c=i.controller.signal)!=null&&c.aborted)throw new Ir;return ge(this,Cc,"m",AC).call(this)}[(tp=new WeakMap,Ui=new WeakMap,np=new WeakMap,Cc=new WeakSet,CC=function(){this.ended||kt(this,Ui,void 0)},EC=function(n,r){if(this.ended)return;const a=(o,c)=>{(r==null||c.sequence_number>r)&&this._emit(o,c)},i=ge(this,Cc,"m",PC).call(this,n);switch(a("event",n),n.type){case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new wt(`missing output at index ${n.output_index}`);if(o.type==="message"){const c=o.content[n.content_index];if(!c)throw new wt(`missing content at index ${n.content_index}`);if(c.type!=="output_text")throw new wt(`expected content to be 'output_text', got ${c.type}`);a("response.output_text.delta",{...n,snapshot:c.text})}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new wt(`missing output at index ${n.output_index}`);o.type==="function_call"&&a("response.function_call_arguments.delta",{...n,snapshot:o.arguments});break}default:a(n.type,n);break}},AC=function(){if(this.ended)throw new wt("stream has ended, this shouldn't happen");const n=ge(this,Ui,"f");if(!n)throw new wt("request ended without sending any events");kt(this,Ui,void 0);const r=WZ(n,ge(this,tp,"f"));return kt(this,np,r),r},PC=function(n){let r=ge(this,Ui,"f");if(!r){if(n.type!=="response.created")throw new wt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=kt(this,Ui,n.response),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const a=r.output[n.output_index];if(!a)throw new wt(`missing output at index ${n.output_index}`);a.type==="message"&&a.content.push(n.part);break}case"response.output_text.delta":{const a=r.output[n.output_index];if(!a)throw new wt(`missing output at index ${n.output_index}`);if(a.type==="message"){const i=a.content[n.content_index];if(!i)throw new wt(`missing content at index ${n.content_index}`);if(i.type!=="output_text")throw new wt(`expected content to be 'output_text', got ${i.type}`);i.text+=n.delta}break}case"response.function_call_arguments.delta":{const a=r.output[n.output_index];if(!a)throw new wt(`missing output at index ${n.output_index}`);a.type==="function_call"&&(a.arguments+=n.delta);break}case"response.completed":{kt(this,Ui,n.response);break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",a=>{const i=n.shift();i?i.resolve(a):e.push(a)}),this.on("end",()=>{r=!0;for(const a of n)a.resolve(void 0);n.length=0}),this.on("abort",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),this.on("error",a=>{r=!0;for(const i of n)i.reject(a);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=ge(this,np,"f");if(!e)throw new wt("stream ended without producing a ChatCompletion");return e}}function WZ(t,e){return BZ(t,e)}class o3 extends jt{list(e,n={},r){return this._client.getAPIList(qe`/responses/${e}/input_items`,Wn,{query:n,...r})}}class u1 extends jt{constructor(){super(...arguments),this.inputItems=new o3(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&qw(r),r))}retrieve(e,n={},r){return this._client.get(qe`/responses/${e}`,{query:n,...r,stream:(n==null?void 0:n.stream)??!1})._thenUnwrap(a=>("object"in a&&a.object==="response"&&qw(a),a))}delete(e,n){return this._client.delete(qe`/responses/${e}`,{...n,headers:pt([{Accept:"*/*"},n==null?void 0:n.headers])})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>i3(r,e))}stream(e,n){return d1.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(qe`/responses/${e}/cancel`,n)}}u1.InputItems=o3;class l3 extends jt{create(e,n,r){return this._client.post(qe`/uploads/${e}/parts`,Vl({body:n,...r},this._client))}}class h1 extends jt{constructor(){super(...arguments),this.parts=new l3(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(qe`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(qe`/uploads/${e}/complete`,{body:n,...r})}}h1.Parts=l3;const VZ=async t=>{const e=await Promise.allSettled(t),n=e.filter(a=>a.status==="rejected");if(n.length){for(const a of n)console.error(a.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const a of e)a.status==="fulfilled"&&r.push(a.value);return r};class c3 extends jt{create(e,n,r){return this._client.post(qe`/vector_stores/${e}/file_batches`,{body:n,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{vector_store_id:a}=n;return this._client.get(qe`/vector_stores/${a}/file_batches/${e}`,{...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}cancel(e,n,r){const{vector_store_id:a}=n;return this._client.post(qe`/vector_stores/${a}/file_batches/${e}/cancel`,{...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const a=await this.create(e,n);return await this.poll(e,a.id,r)}listFiles(e,n,r){const{vector_store_id:a,...i}=n;return this._client.getAPIList(qe`/vector_stores/${a}/file_batches/${e}/files`,Wn,{query:i,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async poll(e,n,r){var i;const a=pt([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const{data:o,response:c}=await this.retrieve(n,{vector_store_id:e},{...r,headers:a}).withResponse();switch(o.status){case"in_progress":let d=5e3;if(r!=null&&r.pollIntervalMs)d=r.pollIntervalMs;else{const u=c.headers.get("openai-poll-after-ms");if(u){const m=parseInt(u);isNaN(m)||(d=m)}}await Lm(d);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},a){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(a==null?void 0:a.maxConcurrency)??5,o=Math.min(i,n.length),c=this._client,d=n.values(),u=[...r];async function m(p){for(let v of p){const w=await c.files.create({file:v,purpose:"assistants"},a);u.push(w.id)}}const f=Array(o).fill(d).map(m);return await VZ(f),await this.createAndPoll(e,{file_ids:u})}}class d3 extends jt{create(e,n,r){return this._client.post(qe`/vector_stores/${e}/files`,{body:n,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}retrieve(e,n,r){const{vector_store_id:a}=n;return this._client.get(qe`/vector_stores/${a}/files/${e}`,{...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}update(e,n,r){const{vector_store_id:a,...i}=n;return this._client.post(qe`/vector_stores/${a}/files/${e}`,{body:i,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e,n={},r){return this._client.getAPIList(qe`/vector_stores/${e}/files`,Wn,{query:n,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}delete(e,n,r){const{vector_store_id:a}=n;return this._client.delete(qe`/vector_stores/${a}/files/${e}`,{...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}async createAndPoll(e,n,r){const a=await this.create(e,n,r);return await this.poll(e,a.id,r)}async poll(e,n,r){var i;const a=pt([r==null?void 0:r.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((i=r==null?void 0:r.pollIntervalMs)==null?void 0:i.toString())??void 0}]);for(;;){const o=await this.retrieve(n,{vector_store_id:e},{...r,headers:a}).withResponse(),c=o.data;switch(c.status){case"in_progress":let d=5e3;if(r!=null&&r.pollIntervalMs)d=r.pollIntervalMs;else{const u=o.response.headers.get("openai-poll-after-ms");if(u){const m=parseInt(u);isNaN(m)||(d=m)}}await Lm(d);break;case"failed":case"completed":return c}}}async upload(e,n,r){const a=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:a.id},r)}async uploadAndPoll(e,n,r){const a=await this.upload(e,n,r);return await this.poll(e,a.id,r)}content(e,n,r){const{vector_store_id:a}=n;return this._client.getAPIList(qe`/vector_stores/${a}/files/${e}/content`,Zg,{...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}class Yg extends jt{constructor(){super(...arguments),this.files=new d3(this._client),this.fileBatches=new c3(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}retrieve(e,n){return this._client.get(qe`/vector_stores/${e}`,{...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}update(e,n,r){return this._client.post(qe`/vector_stores/${e}`,{body:n,...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}list(e={},n){return this._client.getAPIList("/vector_stores",Wn,{query:e,...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}delete(e,n){return this._client.delete(qe`/vector_stores/${e}`,{...n,headers:pt([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])})}search(e,n,r){return this._client.getAPIList(qe`/vector_stores/${e}/search`,Zg,{body:n,method:"post",...r,headers:pt([{"OpenAI-Beta":"assistants=v2"},r==null?void 0:r.headers])})}}Yg.Files=d3;Yg.FileBatches=c3;var Fc,u3,Rp;class h3 extends jt{constructor(){super(...arguments),Fc.add(this)}async unwrap(e,n,r=this._client.webhookSecret,a=300){return await this.verifySignature(e,n,r,a),JSON.parse(e)}async verifySignature(e,n,r=this._client.webhookSecret,a=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");ge(this,Fc,"m",u3).call(this,r);const i=pt([n]).values,o=ge(this,Fc,"m",Rp).call(this,i,"webhook-signature"),c=ge(this,Fc,"m",Rp).call(this,i,"webhook-timestamp"),d=ge(this,Fc,"m",Rp).call(this,i,"webhook-id"),u=parseInt(c,10);if(isNaN(u))throw new qu("Invalid webhook timestamp format");const m=Math.floor(Date.now()/1e3);if(m-u>a)throw new qu("Webhook timestamp is too old");if(u>m+a)throw new qu("Webhook timestamp is too new");const f=o.split(" ").map(x=>x.startsWith("v1,")?x.substring(3):x),p=r.startsWith("whsec_")?Buffer.from(r.replace("whsec_",""),"base64"):Buffer.from(r,"utf-8"),v=d?`${d}.${c}.${e}`:`${c}.${e}`,w=await crypto.subtle.importKey("raw",p,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const x of f)try{const y=Buffer.from(x,"base64");if(await crypto.subtle.verify("HMAC",w,y,new TextEncoder().encode(v)))return}catch{continue}throw new qu("The given webhook signature does not match the expected signature")}}Fc=new WeakSet,u3=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},Rp=function(e,n){if(!e)throw new Error("Headers are required");const r=e.get(n);if(r==null)throw new Error(`Missing required header: ${n}`);return r};var Hw,m1,Ip,m3;class qt{constructor({baseURL:e=kc("OPENAI_BASE_URL"),apiKey:n=kc("OPENAI_API_KEY"),organization:r=kc("OPENAI_ORG_ID")??null,project:a=kc("OPENAI_PROJECT_ID")??null,webhookSecret:i=kc("OPENAI_WEBHOOK_SECRET")??null,...o}={}){if(Hw.add(this),Ip.set(this,void 0),this.completions=new VM(this),this.chat=new Jj(this),this.embeddings=new GM(this),this.files=new YM(this),this.images=new s3(this),this.audio=new Bm(this),this.moderations=new a3(this),this.models=new r3(this),this.fineTuning=new iu(this),this.graders=new c1(this),this.vectorStores=new Yg(this),this.webhooks=new h3(this),this.beta=new zm(this),this.batches=new zM(this),this.uploads=new h1(this),this.responses=new u1(this),this.conversations=new s1(this),this.evals=new a1(this),this.containers=new n1(this),n===void 0)throw new wt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const c={apiKey:n,organization:r,project:a,webhookSecret:i,...o,baseURL:e||"https://api.openai.com/v1"};if(!c.dangerouslyAllowBrowser&&VK())throw new wt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=c.baseURL,this.timeout=c.timeout??m1.DEFAULT_TIMEOUT,this.logger=c.logger??console;const d="warn";this.logLevel=d,this.logLevel=fC(c.logLevel,"ClientOptions.logLevel",this)??fC(kc("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??d,this.fetchOptions=c.fetchOptions,this.maxRetries=c.maxRetries??2,this.fetch=c.fetch??YK(),kt(this,Ip,JK),this._options=c,this.apiKey=n,this.organization=r,this.project=a,this.webhookSecret=i}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){}async authHeaders(e){return pt([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return aZ(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Oc}`}defaultIdempotencyKey(){return`stainless-node-retry-${qT()}`}makeStatusError(e,n,r,a){return bs.generate(e,n,r,a)}buildURL(e,n,r){const a=!ge(this,Hw,"m",m3).call(this)&&r||this.baseURL,i=$K(e)?new URL(e):new URL(a+(a.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),o=this.defaultQuery();return UK(o)||(n={...o,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(i.search=this.stringifyQuery(n)),i.toString()}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(a=>({method:e,path:n,...a})))}request(e,n=null){return new Kg(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,r){var j,b;const a=await e,i=a.maxRetries??this.maxRetries;n==null&&(n=i),await this.prepareOptions(a);const{req:o,url:c,timeout:d}=await this.buildRequest(a,{retryCount:i-n});await this.prepareRequest(o,{url:c,options:a});const u="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),m=r===void 0?"":`, retryOf: ${r}`,f=Date.now();if(gs(this).debug(`[${u}] sending request`,ol({retryOfRequestLogID:r,method:a.method,url:c,options:a,headers:o.headers})),(j=a.signal)!=null&&j.aborted)throw new Ir;const p=new AbortController,v=await this.fetchWithTimeout(c,o,d,p).catch(Mw),w=Date.now();if(v instanceof Error){const N=`retrying, ${n} attempts remaining`;if((b=a.signal)!=null&&b.aborted)throw new Ir;const S=Tw(v)||/timed? ?out/i.test(String(v)+("cause"in v?String(v.cause):""));if(n)return gs(this).info(`[${u}] connection ${S?"timed out":"failed"} - ${N}`),gs(this).debug(`[${u}] connection ${S?"timed out":"failed"} (${N})`,ol({retryOfRequestLogID:r,url:c,durationMs:w-f,message:v.message})),this.retryRequest(a,n,r??u);throw gs(this).info(`[${u}] connection ${S?"timed out":"failed"} - error; no more retries left`),gs(this).debug(`[${u}] connection ${S?"timed out":"failed"} (error; no more retries left)`,ol({retryOfRequestLogID:r,url:c,durationMs:w-f,message:v.message})),S?new Wj:new Wg({cause:v})}const x=[...v.headers.entries()].filter(([N])=>N==="x-request-id").map(([N,S])=>", "+N+": "+JSON.stringify(S)).join(""),y=`[${u}${m}${x}] ${o.method} ${c} ${v.ok?"succeeded":"failed"} with status ${v.status} in ${w-f}ms`;if(!v.ok){const N=await this.shouldRetry(v);if(n&&N){const H=`retrying, ${n} attempts remaining`;return await XK(v.body),gs(this).info(`${y} - ${H}`),gs(this).debug(`[${u}] response error (${H})`,ol({retryOfRequestLogID:r,url:v.url,status:v.status,headers:v.headers,durationMs:w-f})),this.retryRequest(a,n,r??u,v.headers)}const S=N?"error; no more retries left":"error; not retryable";gs(this).info(`${y} - ${S}`);const E=await v.text().catch(H=>Mw(H).message),C=WK(E),P=C?void 0:E;throw gs(this).debug(`[${u}] response error (${S})`,ol({retryOfRequestLogID:r,url:v.url,status:v.status,headers:v.headers,message:P,durationMs:Date.now()-f})),this.makeStatusError(v.status,C,P,v.headers)}return gs(this).info(y),gs(this).debug(`[${u}] response start`,ol({retryOfRequestLogID:r,url:v.url,status:v.status,headers:v.headers,durationMs:w-f})),{response:v,options:a,controller:p,requestLogID:u,retryOfRequestLogID:r,startTime:f}}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}requestAPIList(e,n){const r=this.makeRequest(n,null,void 0);return new fZ(this,r,e)}async fetchWithTimeout(e,n,r,a){const{signal:i,method:o,...c}=n||{};i&&i.addEventListener("abort",()=>a.abort());const d=setTimeout(()=>a.abort(),r),u=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,m={signal:a.signal,...u?{duplex:"half"}:{},method:"GET",...c};o&&(m.method=o.toUpperCase());try{return await this.fetch.call(void 0,e,m)}finally{clearTimeout(d)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r,a){let i;const o=a==null?void 0:a.get("retry-after-ms");if(o){const d=parseFloat(o);Number.isNaN(d)||(i=d)}const c=a==null?void 0:a.get("retry-after");if(c&&!i){const d=parseFloat(c);Number.isNaN(d)?i=Date.parse(c)-Date.now():i=d*1e3}if(!(i&&0<=i&&i<60*1e3)){const d=e.maxRetries??this.maxRetries;i=this.calculateDefaultRetryTimeoutMillis(n,d)}return await Lm(i),this.makeRequest(e,n-1,r)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),c=1-Math.random()*.25;return o*c*1e3}async buildRequest(e,{retryCount:n=0}={}){const r={...e},{method:a,path:i,query:o,defaultBaseURL:c}=r,d=this.buildURL(i,o,c);"timeout"in r&&HK("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const{bodyHeaders:u,body:m}=this.buildBody({options:r}),f=await this.buildHeaders({options:e,method:a,bodyHeaders:u,retryCount:n});return{req:{method:a,headers:f,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"},...m&&{body:m},...this.fetchOptions??{},...r.fetchOptions??{}},url:d,timeout:r.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:r,retryCount:a}){let i={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const o=pt([i,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...QK(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(o),o.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const r=pt([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:nM(e)}:ge(this,Ip,"f").call(this,{body:e,headers:r})}}m1=qt,Ip=new WeakMap,Hw=new WeakSet,m3=function(){return this.baseURL!=="https://api.openai.com/v1"};qt.OpenAI=m1;qt.DEFAULT_TIMEOUT=6e5;qt.OpenAIError=wt;qt.APIError=bs;qt.APIConnectionError=Wg;qt.APIConnectionTimeoutError=Wj;qt.APIUserAbortError=Ir;qt.NotFoundError=KT;qt.ConflictError=ZT;qt.RateLimitError=QT;qt.BadRequestError=HT;qt.AuthenticationError=WT;qt.InternalServerError=YT;qt.PermissionDeniedError=VT;qt.UnprocessableEntityError=GT;qt.InvalidWebhookSignatureError=qu;qt.toFile=wZ;qt.Completions=VM;qt.Chat=Jj;qt.Embeddings=GM;qt.Files=YM;qt.Images=s3;qt.Audio=Bm;qt.Moderations=a3;qt.Models=r3;qt.FineTuning=iu;qt.Graders=c1;qt.VectorStores=Yg;qt.Webhooks=h3;qt.Beta=zm;qt.Batches=zM;qt.Uploads=h1;qt.Responses=u1;qt.Conversations=s1;qt.Evals=a1;qt.Containers=n1;const KZ=new qt({apiKey:"sk-proj-demo-key-hier-einfuegen",dangerouslyAllowBrowser:!0});async function ZZ(t,e){try{console.log("OpenAI Extraktion gestartet...");const n=`Du bist ein Experte für die Extraktion von Daten aus deutschen Handwerker-Rechnungen.
    Extrahiere ALLE relevanten Informationen aus der Rechnung und gebe sie als strukturiertes JSON zurück.
    
    Achte besonders auf:
    - Deutsche Datumsformate (DD.MM.YYYY) -> konvertiere zu YYYY-MM-DD
    - Deutsche Zahlenformate (1.234,56 €) -> konvertiere zu Dezimalzahlen
    - Handwerker-spezifische Begriffe
    - Positionen/Artikel in Tabellen
    
    Gib NUR valides JSON zurück, keine zusätzlichen Erklärungen.`,r=`Extrahiere alle Rechnungsdaten aus diesem Bild. 
    ${e?`Hier ist der bereits erkannte Text als Hilfe: ${e}`:""}
    
    Gib die Daten in diesem exakten JSON-Format zurück:
    {
      "invoiceNumber": "Rechnungsnummer",
      "date": "YYYY-MM-DD",
      "supplierName": "Firmenname",
      "totalAmount": Gesamtbetrag als Zahl,
      "vatAmount": MwSt-Betrag als Zahl oder null,
      "vatRate": MwSt-Satz als Zahl oder null,
      "netAmount": Nettobetrag als Zahl oder null,
      "iban": "IBAN oder null",
      "customerNumber": "Kundennummer oder null",
      "orderNumber": "Auftragsnummer oder null"
    }`,a=await KZ.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:n},{role:"user",content:[{type:"text",text:r},{type:"image_url",image_url:{url:`data:image/jpeg;base64,${t}`,detail:"high"}}]}],max_tokens:2e3,temperature:.1,response_format:{type:"json_object"}}),i=JSON.parse(a.choices[0].message.content||"{}");return console.log("OpenAI extrahierte Daten:",i),{invoiceNumber:i.invoiceNumber||"UNBEKANNT",date:i.date||i.invoiceDate||new Date().toISOString().split("T")[0],invoiceDate:i.invoiceDate,deliveryDate:i.deliveryDate,dueDate:i.dueDate,supplierName:i.supplierName||"UNBEKANNT",supplierAddress:i.supplierAddress,supplierTaxNumber:i.supplierTaxNumber,supplierVatId:i.supplierVatId,customerName:i.customerName,customerNumber:i.customerNumber,customerAddress:i.customerAddress,positions:i.positions||[],netAmount:i.netAmount,vatRate:i.vatRate,vatAmount:i.vatAmount,totalAmount:i.totalAmount||0,iban:i.iban,bic:i.bic,orderNumber:i.orderNumber,deliveryNoteNumber:i.deliveryNoteNumber,projectNumber:i.projectNumber,paymentTerms:i.paymentTerms,discountTerms:i.discountTerms,description:`AI-extrahiert am ${new Date().toLocaleDateString("de-DE")}`}}catch(n){throw console.error("OpenAI Extraktion fehlgeschlagen:",n),new Error("KI-Extraktion fehlgeschlagen: "+n.message)}}function GZ(){return!0}class F0{static async initialize(){if(!(this.isInitialized&&this.worker))try{console.log("Initialisiere Tesseract Worker...");try{this.worker=await sC.createWorker(["deu","eng"]),console.log("Deutsche und englische Sprachdateien geladen")}catch(e){console.warn("Mehrsprachige Initialisierung fehlgeschlagen, verwende nur Englisch:",e);try{this.worker=await sC.createWorker("eng"),console.log("Englische Sprachdatei geladen")}catch(n){throw console.error("Fallback auf Englisch fehlgeschlagen:",n),n}}await this.worker.setParameters({tessedit_char_whitelist:`0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyzäöüÄÖÜß.,:-€$%/@()[]{}|_+=*&!?"' 	
`,tessedit_pageseg_mode:"3",preserve_interword_spaces:"1",tessedit_ocr_engine_mode:"3",tessedit_min_confidence:"60"}),this.isInitialized=!0,console.log("OCR Service erfolgreich initialisiert mit optimierten Parametern")}catch(e){throw console.error("Failed to initialize OCR Service:",e),new po("OCR Service konnte nicht initialisiert werden. Überprüfen Sie Ihre Internetverbindung.",Uu.SERVER_ERROR,"Tesseract Worker initialization failed")}}static async processInvoiceImage(e){return Zf(async()=>{const n=await Dv();(!this.isInitialized||!this.worker)&&await this.initialize();const r=await this.fileToBase64(e),a=e.name.split(".").pop()||"jpg",i=`invoice_${Date.now()}.${a}`;let o=`data:image/${a};base64,${r}`,c,d,u="";console.log("Starte OCR-Verarbeitung für Datei:",e.name);const m=await this.worker.recognize(e,{rotateAuto:!0,rotateRadians:0});u=m.data.text||"";const f=m.data.confidence||0,p=this.cleanOCRText(u);if(console.log(`OCR abgeschlossen - Konfidenz: ${f}%`),console.log("OCR Raw Text (erste 500 Zeichen):",u.substring(0,500)),console.log("Bereinigte Version:",p.substring(0,500)),GZ()){console.log("Verwende OpenAI Vision API für Extraktion...");try{c=await ZZ(r,u),d={overall:.95,invoice_number:.95,date:.95,amount:.95,supplier:.95},console.log("OpenAI Extraktion erfolgreich!")}catch(w){console.error("OpenAI fehlgeschlagen, falle zurück auf Regex:",w),c=this.extractInvoiceData(p),d=this.calculateConfidenceScores(p,c)}}const v={id:`ocr_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,original_file_path:o,extracted_text:u,structured_data:c,confidence_scores:d,status:"pending",created_at:new Date().toISOString(),created_by:(n==null?void 0:n.id)||"unknown"};try{const w=JSON.parse(localStorage.getItem("ocr_results")||"[]");w.push(v),localStorage.setItem("ocr_results",JSON.stringify(w)),console.log("OCR result saved locally:",v.id)}catch(w){console.warn("LocalStorage failed, continuing without storage:",w)}return console.log("OCR result created successfully:",v.id),mt.emit("OCR_PROCESSED",{ocr_id:v.id,confidence:d.overall,supplier_name:c.supplierName,user_id:n.id}),v},"Process invoice with OCR")}static async validateAndCreateInvoice(e,n,r){return Zf(async()=>{const a=await Dv(),{data:i,error:o}=await K.from("ocr_results").update({structured_data:n,status:"validated",validation_notes:r,validated_at:new Date().toISOString(),validated_by:a.id}).eq("id",e).select().single();if(o)throw new po("OCR-Validierung fehlgeschlagen",Uu.SERVER_ERROR,o.message);const c={invoice_number:n.invoiceNumber,supplier_name:n.supplierName,invoice_date:n.date,total_amount:n.totalAmount,vat_amount:n.vatAmount||0,description:n.description||"",status:"pending",ocr_result_id:e,created_by:a.id},{data:d,error:u}=await K.from("supplier_invoices").insert(c).select().single();if(u)throw new po("Rechnung konnte nicht erstellt werden",Uu.SERVER_ERROR,u.message);try{console.log("Audit log: Invoice created from OCR",{entity_id:d.id,invoice_number:n.invoiceNumber,supplier_name:n.supplierName,total_amount:n.totalAmount})}catch(m){console.error("Audit log failed (non-critical):",m)}return{ocr_result:i,invoice_id:d.id}},"Validate OCR and create invoice")}static async getOCRResults(e){return Zf(async()=>{try{const n=JSON.parse(localStorage.getItem("ocr_results")||"[]");let r=n;return e&&(r=n.filter(a=>a.status===e)),r.sort((a,i)=>new Date(i.created_at).getTime()-new Date(a.created_at).getTime()),console.log(`Retrieved ${r.length} OCR results from localStorage`),r}catch(n){return console.warn("Failed to read from localStorage, returning empty array:",n),[]}},"Get OCR results")}static async rejectOCRResult(e,n){return Zf(async()=>{const r=await Dv(),{error:a}=await K.from("ocr_results").update({status:"rejected",validation_notes:n,validated_at:new Date().toISOString(),validated_by:r.id}).eq("id",e);if(a)throw new po("OCR-Ergebnis konnte nicht abgelehnt werden",Uu.SERVER_ERROR,a.message);try{console.log("Audit log: OCR result rejected",{entity_id:e,status:"rejected",reason:n})}catch(i){console.error("Audit log failed (non-critical):",i)}},"Reject OCR result")}static fileToBase64(e){return new Promise((n,r)=>{const a=new FileReader;a.onload=()=>{const i=a.result.split(",")[1];n(i)},a.onerror=r,a.readAsDataURL(e)})}static cleanOCRText(e){let n=e.replace(/[ \t]+/g," ");return n=n.replace(/\bl\s*nvoice/gi,"Invoice").replace(/\bRechnunq/gi,"Rechnung").replace(/\bDaturn/gi,"Datum").replace(/\bSurnme/gi,"Summe").replace(/\bMwSt\./gi,"MwSt").replace(/\bGrnbH/gi,"GmbH").replace(/\bAG\s*\./gi,"AG").replace(/\€/g,"€").replace(/\bEUR\b/g,"€").replace(/([0-9]),\s*([0-9]{2})\s*€/g,"$1,$2 €"),n}static extractInvoicePositions(e){const n=[],r=e.split(`
`),a=[/^(\d+)[\.\s]+(.+?)\s+(\d+[\.,]?\d*)\s*(Stk|Std|m²|m|kg|l|Stück|Stunde)?\s*€?\s*([\d\.,]+)\s*€?\s*([\d\.,]+)/,/(.+?)\s+(\d+[\.,]?\d*)\s*x\s*€?\s*([\d\.,]+)\s*=\s*€?\s*([\d\.,]+)/,/([A-Z0-9\-]+)\s+(.+?)\s+(\d+[\.,]?\d*)\s+€?\s*([\d\.,]+)\s+€?\s*([\d\.,]+)/];for(const i of r){const o=i.trim();if(o)for(const c of a){const d=o.match(c);if(d){let u;if(d.length===7)u={position:parseInt(d[1]),description:d[2].trim(),quantity:this.parseAmount(d[3]),unit:d[4]||"Stk",unitPrice:this.parseAmount(d[5]),totalPrice:this.parseAmount(d[6])};else if(d.length===5)u={description:d[1].trim(),quantity:this.parseAmount(d[2]),unitPrice:this.parseAmount(d[3]),totalPrice:this.parseAmount(d[4])};else if(d.length===6)u={articleNumber:d[1],description:d[2].trim(),quantity:this.parseAmount(d[3]),unitPrice:this.parseAmount(d[4]),totalPrice:this.parseAmount(d[5])};else continue;u.quantity>0&&u.totalPrice>0&&(n.push(u),console.log("Position gefunden:",u));break}}}return n}static extractInvoiceData(e){const n=e,r=e.replace(/\n/g," ").replace(/\s+/g," ").trim();console.log("OCR Clean Text:",r);const a={invoiceNumber:[/Rechnungs[\s-]*(?:Nr\.?|Nummer)\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Rechnung\s*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/(?:Rg|Re)[\s-]*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Invoice\s*(?:No\.?|Number)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Beleg[\s-]*(?:Nr\.?|Nummer)?\s*[:.]\s*([A-Z0-9\-\/]+)/i,/Nr\.?\s*[:.]\s*([A-Z0-9\-\/]{3,})/i],invoiceDate:[/Datum[:\s]*(\d{1,2}\.\d{1,2}\.\d{4})/i,/(?:rechnungsdatum|datum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:ausstellungsdatum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:datum der rechnung)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(\d{1,2}\.\d{1,2}\.\d{4})/],deliveryDate:[/(?:lieferdatum|leistungsdatum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:leistungszeitraum)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i],dueDate:[/(?:fällig am|zahlbar bis|zahlungsziel)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i,/(?:fälligkeit|zahlung bis)[:\s]*(\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4})/i],totalAmount:[/Gesamtbetrag[:\s]*€?\s*([\d\.,]+)/i,/(?:gesamt(?:betrag|summe)|total|summe)[:\s]*€?\s*([\d\.,]+)/i,/(?:zu zahlen|zahlbetrag)[:\s]*€?\s*([\d\.,]+)/i,/Brutto[:\s]*€?\s*([\d\.,]+)/i,/([\d]{1,3}(?:\.\d{3})*,\d{2})\s*€/,/([\d\.,]+)\s*€/i,/€\s*([\d\.,]+)/i],netAmount:[/(?:netto(?:betrag|summe)?)[:\s]*€?\s*([\d\.,]+)/i,/(?:summe netto)[:\s]*€?\s*([\d\.,]+)/i,/(?:zwischensumme)[:\s]*€?\s*([\d\.,]+)/i],vatAmount:[/MwSt[.\s]*19%[:\s]*€?\s*([\d\.,]+)/i,/19%\s*MwSt[:\s]*€?\s*([\d\.,]+)/i,/(?:mwst|mehrwertsteuer|ust|vat)[:\s]*€?\s*([\d\.,]+)/i,/(?:steuer)[:\s]*€?\s*([\d\.,]+)/i,/(\d{1,2})\s*%\s*mwst[:\s]*€?\s*([\d\.,]+)/i,/190,00\s*€/],vatRate:[/(?:mwst|mehrwertsteuer|ust)[\s:]*(\d{1,2})\s*%/i,/(\d{1,2})\s*%\s*(?:mwst|steuer)/i],supplierName:[/([A-Za-zÄÖÜäöüß][A-Za-zÄÖÜäöüß\s&\-\.]{1,40}\s+(?:GmbH|AG|KG|OHG|GbR|e\.K\.|e\.V\.|UG|GmbH\s*&\s*Co\.?\s*KG))/i,/([A-Za-zÄÖÜäöüß][A-Za-zÄÖÜäöüß\s]{1,30}\s+(?:Handwerk|Bau|Elektro|Sanitär|Heizung|Malerei|Schreinerei|Tischlerei|Zimmerei))/i,/([A-Z][a-zäöüß]+\s+[A-Z][a-zäöüß]+)\s*(?:-|–|—)?\s*(?:Meisterbetrieb|Handwerksmeister|Inhaber)/i,/^([A-Z][A-Za-zÄÖÜäöüß\s&\-\.]{2,40})\s*\n/m,/([A-Za-zÄÖÜäöüß\s&\-]{3,30}(?:GmbH|AG|KG))/i],iban:[/iban[:\s]*([A-Z]{2}\d{2}[\s]?[\d\s]{10,30})/i,/([A-Z]{2}\d{2}[\s]?[\d\s]{16,20})/g],bic:[/(?:bic|swift)[:\s]*([A-Z]{6,11})/i],customerNumber:[/(?:kunden(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:kdnr|kd\.?nr)[:\s]*([A-Z0-9\-\/]+)/i],orderNumber:[/(?:auftrags(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:bestell(?:nummer|nr))[:\s]*([A-Z0-9\-\/]+)/i,/(?:auftrag|bestellung)[:\s]*([A-Z0-9\-\/]+)/i],deliveryNoteNumber:[/(?:lieferschein(?:nummer|nr)?)[:\s]*([A-Z0-9\-\/]+)/i,/(?:ls[\s\-]?nr)[:\s]*([A-Z0-9\-\/]+)/i],projectNumber:[/(?:projekt(?:nummer|nr)?)[:\s]*([A-Z0-9\-\/]+)/i,/(?:bauvorhaben|baustelle)[:\s]*([A-Z0-9\-\/]+)/i],paymentTerms:[/(?:zahlungsbedingungen|zahlungsziel)[:\s]*([^\n]{5,50})/i,/(?:zahlung)[:\s]*([^\n]{5,50})/i],discountTerms:[/(\d{1,2})\s*%\s*(?:skonto|rabatt)(?:\s*bei\s*zahlung)?[^\n]*/i,/(?:skonto|rabatt)[:\s]*([^\n]{5,50})/i]},i={};console.log("Starting extraction from text:",r.substring(0,200));for(const c of a.invoiceNumber){const d=r.match(c);if(d){i.invoiceNumber=d[1].trim(),console.log("Rechnungsnummer gefunden:",d[1]);break}}if(!i.invoiceNumber){const c=r.match(/2020-001/);c&&(i.invoiceNumber=c[0],console.log("Rechnungsnummer per Fallback:",c[0]))}for(const c of a.invoiceDate){const d=r.match(c);if(d){i.date=this.parseDate(d[1]),i.invoiceDate=i.date;break}}for(const c of a.deliveryDate){const d=r.match(c);if(d){i.deliveryDate=this.parseDate(d[1]);break}}for(const c of a.dueDate){const d=r.match(c);if(d){i.dueDate=this.parseDate(d[1]);break}}for(const c of a.totalAmount){const d=r.match(c);if(d){i.totalAmount=this.parseAmount(d[1]);break}}for(const c of a.netAmount){const d=r.match(c);if(d){i.netAmount=this.parseAmount(d[1]);break}}for(const c of a.vatAmount){const d=r.match(c);if(d){const u=d[2]||d[1];i.vatAmount=this.parseAmount(u);break}}for(const c of a.vatRate){const d=r.match(c);if(d){i.vatRate=parseInt(d[1]);break}}for(const c of a.supplierName){const d=r.match(c);if(d&&d[1]&&d[1].length>3){i.supplierName=d[1].trim(),console.log("Supplier found:",d[1]);break}}i.supplierName||console.log("No supplier found in:",r.substring(0,100));for(const c of a.iban){const d=r.match(c);if(d&&d[1]){i.iban=d[1].replace(/\s/g,"");break}}for(const c of a.bic){const d=r.match(c);if(d&&d[1]){i.bic=d[1];break}}for(const c of a.customerNumber){const d=r.match(c);if(d&&d[1]){i.customerNumber=d[1];break}}for(const c of a.orderNumber){const d=r.match(c);if(d&&d[1]){i.orderNumber=d[1];break}}for(const c of a.deliveryNoteNumber){const d=r.match(c);if(d&&d[1]){i.deliveryNoteNumber=d[1];break}}for(const c of a.projectNumber){const d=r.match(c);if(d&&d[1]){i.projectNumber=d[1];break}}for(const c of a.paymentTerms){const d=r.match(c);if(d&&d[1]){i.paymentTerms=d[1].trim();break}}for(const c of a.discountTerms){const d=r.match(c);if(d){i.discountTerms=d[0].trim();break}}const o=this.extractInvoicePositions(n);if(o.length>0&&(i.positions=o,console.log(`${o.length} Positionen extrahiert`)),i.netAmount&&i.vatAmount&&!i.totalAmount&&(i.totalAmount=i.netAmount+i.vatAmount),i.totalAmount&&i.vatAmount&&!i.netAmount&&(i.netAmount=i.totalAmount-i.vatAmount),i.netAmount&&i.vatRate&&!i.vatAmount&&(i.vatAmount=i.netAmount*(i.vatRate/100)),o.length>0&&!i.totalAmount){const c=o.reduce((d,u)=>d+u.totalPrice,0);i.netAmount||(i.netAmount=c),i.vatRate?(i.vatAmount=c*(i.vatRate/100),i.totalAmount=c+i.vatAmount):i.totalAmount=c}return{invoiceNumber:i.invoiceNumber||"UNBEKANNT",date:i.date||i.invoiceDate||new Date().toISOString().split("T")[0],invoiceDate:i.invoiceDate,deliveryDate:i.deliveryDate,dueDate:i.dueDate,supplierName:i.supplierName||"UNBEKANNT",totalAmount:i.totalAmount||0,netAmount:i.netAmount,vatAmount:i.vatAmount,vatRate:i.vatRate,iban:i.iban,bic:i.bic,customerNumber:i.customerNumber,orderNumber:i.orderNumber,deliveryNoteNumber:i.deliveryNoteNumber,projectNumber:i.projectNumber,paymentTerms:i.paymentTerms,discountTerms:i.discountTerms,description:`OCR-Import vom ${new Date().toLocaleDateString("de-DE")}`}}static parseAmount(e){return parseFloat(e.replace(/\./g,"").replace(",",".").replace(/[^\d.]/g,""))||0}static parseDate(e){const n=e.split(/[\.\-\/]/);if(n.length===3){const r=n[0].padStart(2,"0"),a=n[1].padStart(2,"0");let i=n[2];return i.length===2&&(i=parseInt(i)>50?`19${i}`:`20${i}`),`${i}-${a}-${r}`}return new Date().toISOString().split("T")[0]}static calculateConfidenceScores(e,n){const r={overall:0,invoice_number:0,date:0,amount:0,supplier:0};n.invoiceNumber!=="UNBEKANNT"&&(r.invoice_number=/[A-Z0-9]{3,}/.test(n.invoiceNumber)?.9:.6);const a=/\d{1,2}[\.\-\/]\d{1,2}[\.\-\/]\d{2,4}/;if(r.date=a.test(e)?.8:.3,n.totalAmount>0){const i=/€\s*[\d\.,]+|\d+[,\.]\d{2}/;r.amount=i.test(e)?.85:.4}return n.supplierName!=="UNBEKANNT"&&(r.supplier=n.supplierName.length>5?.7:.5),r.overall=r.invoice_number*.3+r.date*.2+r.amount*.3+r.supplier*.2,r}static async cleanup(){this.worker&&(await this.worker.terminate(),this.worker=null,this.isInitialized=!1)}}fs(F0,"worker",null),fs(F0,"isInitialized",!1);const Zt={PROJECT_KPIS:"project-kpis",PROJECT_KPIS_SUMMARY:"project-kpis-summary",NOTIFICATIONS:"notifications",NOTIFICATION_STATS:"notification-stats",WORKER_STATUS:"worker-status",AUDIT_LOGS:"audit-logs",AUDIT_TRAIL:"audit-trail",AUDIT_STATS:"audit-stats",NUMBER_SEQUENCES:"number-sequences",GOBD_DOCUMENTS:"gobd-documents",IMMUTABILITY_CHECK:"immutability-check",DATEV_EXPORTS:"datev-exports",DATEV_ACCOUNT_MAPPINGS:"datev-account-mappings",GERMAN_VAT_RETURNS:"german-vat-returns",GERMAN_PERIODS:"german-periods",GERMAN_EXPENSE_REPORTS:"german-expense-reports",AI_DOCUMENTS:"ai-documents",AI_SEARCH_RESULTS:"ai-search-results",AI_INTENT_ANALYSES:"ai-intent-analyses",AI_ESTIMATIONS:"ai-estimations",AI_INDEXING_STATUS:"ai-indexing-status",OCR_RESULTS:"ocr-results",OCR_RESULT:t=>["ocr-results",t],OCR_PENDING:"ocr-pending",customers:["customers"],customer:t=>["customers",t],customerStats:t=>["customers",t,"stats"],customerProjects:t=>["customers",t,"projects"],customerQuotes:t=>["customers",t,"quotes"],customerInvoices:t=>["customers",t,"invoices"],quotes:["quotes"],quote:t=>["quotes",t],quoteStats:["quotes","stats"],orders:["orders"],order:t=>["orders",t],orderStats:["orders","stats"],projects:["projects"],project:t=>["projects",t],projectStats:t=>["projects",t,"stats"],projectTimeline:t=>["projects",t,"timeline"],timesheets:["timesheets"],timesheet:t=>["timesheets",t],employeeTimesheetStats:t=>["timesheets","employee",t,"stats"],projectTimesheetSummary:t=>["timesheets","project",t,"summary"],materials:["materials"],material:t=>["materials",t],materialStats:["materials","stats"],lowStockMaterials:["materials","low-stock"],stockMovements:["stock-movements"],stockValuation:["stock","valuation"],stockAnalytics:["stock","analytics"],invoices:["invoices"],invoice:t=>["invoices",t],expenses:["expenses"],expense:t=>["expenses",t],financialKpis:["finance","kpis"],revenueByMonth:["finance","revenue-by-month"],expensesByCategory:["finance","expenses-by-category"],profitLossReport:["finance","profit-loss"],documents:["documents"],document:t=>["documents",t],documentStats:["documents","stats"],expiringDocuments:["documents","expiring"],employees:["employees"],employee:t=>["employees",t]},f3=(t,e,n)=>_r({queryKey:[...Zt.customers,t,e],queryFn:()=>$g.getCustomers(t,e),...n}),QZ=t=>{const e=ds(),{toast:n}=It();return sr({mutationFn:r=>$g.createCustomer(r),onSuccess:r=>{e.invalidateQueries({queryKey:Zt.customers}),n({title:"Kunde erstellt",description:`${r.company_name} wurde erfolgreich erstellt.`})},onError:r=>{n({title:"Fehler beim Erstellen",description:r.message,variant:"destructive"})},...t})},YZ=t=>{const e=ds(),{toast:n}=It();return sr({mutationFn:({id:r,data:a})=>zW.updateCustomer(r,a),onSuccess:(r,{id:a})=>{e.invalidateQueries({queryKey:Zt.customers}),e.invalidateQueries({queryKey:Zt.customer(a)}),e.invalidateQueries({queryKey:Zt.customerStats(a)}),n({title:"Kunde aktualisiert",description:`${r.company_name} wurde erfolgreich aktualisiert.`})},onError:r=>{n({title:"Fehler beim Aktualisieren",description:r.message,variant:"destructive"})},...t})},XZ=t=>{const e=ds(),{toast:n}=It();return sr({mutationFn:r=>$g.deleteCustomer(r),onSuccess:(r,a)=>{e.invalidateQueries({queryKey:Zt.customers}),e.removeQueries({queryKey:Zt.customer(a)}),n({title:"Kunde gelöscht",description:"Der Kunde wurde erfolgreich gelöscht."})},onError:r=>{n({title:"Fehler beim Löschen",description:r.message,variant:"destructive"})},...t})},JZ=(t,e,n)=>_r({queryKey:[...Zt.quotes,t,e],queryFn:()=>Ug.getQuotes(t,e),...n}),eG=t=>{const e=ds(),{toast:n}=It();return sr({mutationFn:Ug.createQuote,onSuccess:r=>{e.invalidateQueries({queryKey:Zt.quotes}),e.invalidateQueries({queryKey:Zt.customerQuotes(r.customer_id)}),n({title:"Angebot erstellt",description:`${r.title} wurde erfolgreich erstellt.`})},onError:r=>{n({title:"Fehler beim Erstellen",description:r.message,variant:"destructive"})},...t})},tG=t=>{const e=ds(),{toast:n}=It();return sr({mutationFn:({id:r,data:a})=>Ug.updateQuote(r,a),onSuccess:(r,{id:a})=>{e.invalidateQueries({queryKey:Zt.quotes}),e.invalidateQueries({queryKey:Zt.quote(a)}),n({title:"Angebot aktualisiert",description:`${r.title} wurde erfolgreich aktualisiert.`})},onError:r=>{n({title:"Fehler beim Aktualisieren",description:r.message,variant:"destructive"})},...t})},nG=t=>{const e=ds(),{toast:n}=It();return sr({mutationFn:Ug.acceptQuote,onSuccess:(r,a)=>{e.invalidateQueries({queryKey:Zt.quotes}),e.invalidateQueries({queryKey:Zt.quote(a)}),e.invalidateQueries({queryKey:Zt.orders}),n({title:"Angebot angenommen",description:`${r.quote.title} wurde angenommen und ein Auftrag erstellt.`})},onError:r=>{n({title:"Fehler beim Annehmen",description:r.message,variant:"destructive"})},...t})},p3=(t,e,n)=>_r({queryKey:[...Zt.projects,t,e],queryFn:()=>RT.getProjects(t,e),...n}),g3=t=>{const e=ds(),{toast:n}=It();return sr({mutationFn:RT.createProject,onSuccess:r=>{e.invalidateQueries({queryKey:Zt.projects}),e.invalidateQueries({queryKey:Zt.customerProjects(r.customer_id||"")}),n({title:"Projekt erstellt",description:`${r.name} wurde erfolgreich erstellt.`})},onError:r=>{n({title:"Fehler beim Erstellen",description:r.message,variant:"destructive"})},...t})},sG=(t,e,n)=>_r({queryKey:[...Zt.timesheets,t,e],queryFn:()=>zj.getTimesheets(t,e),...n}),rG=t=>{const e=ds(),{toast:n}=It();return sr({mutationFn:zj.createTimesheet,onSuccess:r=>{e.invalidateQueries({queryKey:Zt.timesheets}),e.invalidateQueries({queryKey:Zt.projectStats(r.project_id||"")}),e.invalidateQueries({queryKey:Zt.employeeTimesheetStats(r.employee_id)}),n({title:"Zeiteintrag erstellt",description:"Der Zeiteintrag wurde erfolgreich erstellt."})},onError:r=>{n({title:"Fehler beim Erstellen",description:r.message,variant:"destructive"})},...t})},aG=t=>{const e=ds(),{toast:n}=It();return sr({mutationFn:({id:r,data:a})=>zj.updateTimesheet(r,a),onSuccess:(r,{id:a})=>{e.invalidateQueries({queryKey:Zt.timesheets}),e.invalidateQueries({queryKey:Zt.timesheet(a)}),n({title:"Zeiteintrag aktualisiert",description:"Der Zeiteintrag wurde erfolgreich aktualisiert."})},onError:r=>{n({title:"Fehler beim Aktualisieren",description:r.message,variant:"destructive"})},...t})},x3=(t,e,n)=>_r({queryKey:[...Zt.invoices,t,e],queryFn:()=>qg.getInvoices(t,e),...n}),v3=t=>{const e=ds(),{toast:n}=It();return sr({mutationFn:qg.createInvoice,onSuccess:r=>{e.invalidateQueries({queryKey:Zt.invoices}),e.invalidateQueries({queryKey:Zt.financialKpis}),n({title:"Rechnung erstellt",description:`${r.invoice_number||"Rechnung"} wurde erfolgreich erstellt.`})},onError:r=>{n({title:"Fehler beim Erstellen",description:r.message,variant:"destructive"})},...t})},iG=(t,e,n)=>_r({queryKey:[...Zt.expenses,t,e],queryFn:()=>qg.getExpenses(t,e),...n}),oG=(t,e)=>_r({queryKey:[...Zt.financialKpis,t],queryFn:()=>qg.getFinancialKPIs(t),...e}),lG=(t,e,n)=>_r({queryKey:[...Zt.documents,t,e],queryFn:()=>ZW.getDocuments(t,e),...n}),f1=t=>_r({queryKey:Zt.employees,queryFn:async()=>{var e,n;try{const{data:{session:r}}=await K.auth.getSession();if(!r)return console.log("useEmployees: No session found"),{items:[]};const a=((e=r.user.user_metadata)==null?void 0:e.company_id)||((n=r.user.app_metadata)==null?void 0:n.company_id)||r.user.id;if(console.log("useEmployees: Using company_id:",a),console.log("useEmployees: Session user:",r.user),!a)return console.error("useEmployees: No company ID available"),{items:[]};const{data:i,error:o}=await K.from("employees").select("id, email, status, user_id, company_id").eq("company_id",a);console.log("useEmployees: DEBUG - All employees for company:",i);const{data:c,error:d}=await K.from("employees").select(`
            id,
            user_id,
            first_name,
            last_name,
            email,
            phone,
            position,
            status,
            qualifications,
            license,
            company_id
          `).not("user_id","is",null).in("status",["active","Active","aktiv","Aktiv"]).order("created_at",{ascending:!1});if(console.log("useEmployees: Raw query (no company filter):",c),console.log("useEmployees: Employees query result:",c,d),d)return console.error("useEmployees: Error fetching employees:",d),{items:[]};const u=(c==null?void 0:c.filter(p=>p.user_id).map(p=>p.user_id))||[];let m=[];if(u.length>0){const{data:p,error:v}=await K.from("profiles").select("id, first_name, last_name").in("id",u);v||(m=p||[])}const f=(c==null?void 0:c.map(p=>{const v=m.find(y=>y.id===p.user_id),w=(v==null?void 0:v.first_name)||p.first_name||"",x=(v==null?void 0:v.last_name)||p.last_name||"";return{id:p.id,first_name:w,last_name:x,name:`${w} ${x}`.trim(),email:p.email,phone:p.phone,position:p.position,status:p.status,qualifications:Array.isArray(p.qualifications)?p.qualifications:[],license:p.license}}))||[];return console.log("useEmployees: Final employee list:",f),{items:f}}catch(r){return console.error("useEmployees: Catch block error:",r),{items:[]}}},...t}),cG=t=>{const e=ds();return It(),sr({mutationFn:async n=>{const{error:r}=await K.from("employees").delete().eq("id",n);if(r)throw new Error(r.message)},onSuccess:()=>{e.invalidateQueries({queryKey:Zt.employees})},...t})},dG=t=>{const e=ds(),{toast:n}=It();return sr({mutationFn:r=>F0.processInvoiceImage(r),onSuccess:r=>{e.invalidateQueries({queryKey:[Zt.OCR_RESULTS]}),e.invalidateQueries({queryKey:[Zt.OCR_PENDING]}),n({title:"OCR-Verarbeitung abgeschlossen",description:`Rechnung von "${r.structured_data.supplierName}" wurde verarbeitet.`})},onError:r=>{n({title:"OCR-Verarbeitung fehlgeschlagen",description:r.message,variant:"destructive"})},...t})},uG=(t,e)=>_r({queryKey:[Zt.OCR_RESULTS,t],queryFn:()=>F0.getOCRResults(t),staleTime:5*60*1e3,...e}),hG=t=>uG("pending",t);var jy="focusScope.autoFocusOnMount",Ny="focusScope.autoFocusOnUnmount",DC={bubbles:!1,cancelable:!0},mG="FocusScope",$m=g.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=t,[c,d]=g.useState(null),u=_n(a),m=_n(i),f=g.useRef(null),p=Rt(e,x=>d(x)),v=g.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;g.useEffect(()=>{if(r){let x=function(N){if(v.paused||!c)return;const S=N.target;c.contains(S)?f.current=S:Vi(f.current,{select:!0})},y=function(N){if(v.paused||!c)return;const S=N.relatedTarget;S!==null&&(c.contains(S)||Vi(f.current,{select:!0}))},j=function(N){if(document.activeElement===document.body)for(const E of N)E.removedNodes.length>0&&Vi(c)};document.addEventListener("focusin",x),document.addEventListener("focusout",y);const b=new MutationObserver(j);return c&&b.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",y),b.disconnect()}}},[r,c,v.paused]),g.useEffect(()=>{if(c){MC.add(v);const x=document.activeElement;if(!c.contains(x)){const j=new CustomEvent(jy,DC);c.addEventListener(jy,u),c.dispatchEvent(j),j.defaultPrevented||(fG(yG(y3(c)),{select:!0}),document.activeElement===x&&Vi(c))}return()=>{c.removeEventListener(jy,u),setTimeout(()=>{const j=new CustomEvent(Ny,DC);c.addEventListener(Ny,m),c.dispatchEvent(j),j.defaultPrevented||Vi(x??document.body,{select:!0}),c.removeEventListener(Ny,m),MC.remove(v)},0)}}},[c,u,m,v]);const w=g.useCallback(x=>{if(!n&&!r||v.paused)return;const y=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,j=document.activeElement;if(y&&j){const b=x.currentTarget,[N,S]=pG(b);N&&S?!x.shiftKey&&j===S?(x.preventDefault(),n&&Vi(N,{select:!0})):x.shiftKey&&j===N&&(x.preventDefault(),n&&Vi(S,{select:!0})):j===b&&x.preventDefault()}},[n,r,v.paused]);return s.jsx(tt.div,{tabIndex:-1,...o,ref:p,onKeyDown:w})});$m.displayName=mG;function fG(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Vi(r,{select:e}),document.activeElement!==n)return}function pG(t){const e=y3(t),n=TC(e,t),r=TC(e.reverse(),t);return[n,r]}function y3(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function TC(t,e){for(const n of t)if(!gG(n,{upTo:e}))return n}function gG(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function xG(t){return t instanceof HTMLInputElement&&"select"in t}function Vi(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&xG(t)&&e&&t.select()}}var MC=vG();function vG(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=RC(t,e),t.unshift(e)},remove(e){var n;t=RC(t,e),(n=t[0])==null||n.resume()}}}function RC(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function yG(t){return t.filter(e=>e.tagName!=="A")}var Sy=0;function Xg(){g.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??IC()),document.body.insertAdjacentElement("beforeend",t[1]??IC()),Sy++,()=>{Sy===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Sy--}},[])}function IC(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Fa=function(){return Fa=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Fa.apply(this,arguments)};function _3(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}function _G(t,e,n){if(n||arguments.length===2)for(var r=0,a=e.length,i;r<a;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var Op="right-scroll-bar-position",Lp="width-before-scroll-bar",wG="with-scroll-bars-hidden",bG="--removed-body-scroll-bar-size";function ky(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function jG(t,e){var n=g.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=e,n.facade}var NG=typeof window<"u"?g.useLayoutEffect:g.useEffect,OC=new WeakMap;function SG(t,e){var n=jG(null,function(r){return t.forEach(function(a){return ky(a,r)})});return NG(function(){var r=OC.get(n);if(r){var a=new Set(r),i=new Set(t),o=n.current;a.forEach(function(c){i.has(c)||ky(c,null)}),i.forEach(function(c){a.has(c)||ky(c,o)})}OC.set(n,t)},[t]),n}function kG(t){return t}function CG(t,e){e===void 0&&(e=kG);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(c){return c!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(c){return i(c)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var c=n;n=[],c.forEach(i),o=n}var d=function(){var m=o;o=[],m.forEach(i)},u=function(){return Promise.resolve().then(d)};u(),n={push:function(m){o.push(m),u()},filter:function(m){return o=o.filter(m),n}}}};return a}function EG(t){t===void 0&&(t={});var e=CG(null);return e.options=Fa({async:!0,ssr:!1},t),e}var w3=function(t){var e=t.sideCar,n=_3(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return g.createElement(r,Fa({},n))};w3.isSideCarExport=!0;function AG(t,e){return t.useMedium(e),w3}var b3=EG(),Cy=function(){},Jg=g.forwardRef(function(t,e){var n=g.useRef(null),r=g.useState({onScrollCapture:Cy,onWheelCapture:Cy,onTouchMoveCapture:Cy}),a=r[0],i=r[1],o=t.forwardProps,c=t.children,d=t.className,u=t.removeScrollBar,m=t.enabled,f=t.shards,p=t.sideCar,v=t.noIsolation,w=t.inert,x=t.allowPinchZoom,y=t.as,j=y===void 0?"div":y,b=t.gapMode,N=_3(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=p,E=SG([n,e]),C=Fa(Fa({},N),a);return g.createElement(g.Fragment,null,m&&g.createElement(S,{sideCar:b3,removeScrollBar:u,shards:f,noIsolation:v,inert:w,setCallbacks:i,allowPinchZoom:!!x,lockRef:n,gapMode:b}),o?g.cloneElement(g.Children.only(c),Fa(Fa({},C),{ref:E})):g.createElement(j,Fa({},C,{className:d,ref:E}),c))});Jg.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Jg.classNames={fullWidth:Lp,zeroRight:Op};var PG=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function DG(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=PG();return e&&t.setAttribute("nonce",e),t}function TG(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function MG(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var RG=function(){var t=0,e=null;return{add:function(n){t==0&&(e=DG())&&(TG(e,n),MG(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},IG=function(){var t=RG();return function(e,n){g.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},j3=function(){var t=IG(),e=function(n){var r=n.styles,a=n.dynamic;return t(r,a),null};return e},OG={left:0,top:0,right:0,gap:0},Ey=function(t){return parseInt(t||"",10)||0},LG=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],a=e[t==="padding"?"paddingRight":"marginRight"];return[Ey(n),Ey(r),Ey(a)]},FG=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return OG;var e=LG(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},BG=j3(),ud="data-scroll-locked",zG=function(t,e,n,r){var a=t.left,i=t.top,o=t.right,c=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(wG,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(c,"px ").concat(r,`;
  }
  body[`).concat(ud,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(c,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Op,` {
    right: `).concat(c,"px ").concat(r,`;
  }
  
  .`).concat(Lp,` {
    margin-right: `).concat(c,"px ").concat(r,`;
  }
  
  .`).concat(Op," .").concat(Op,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Lp," .").concat(Lp,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(ud,`] {
    `).concat(bG,": ").concat(c,`px;
  }
`)},LC=function(){var t=parseInt(document.body.getAttribute(ud)||"0",10);return isFinite(t)?t:0},$G=function(){g.useEffect(function(){return document.body.setAttribute(ud,(LC()+1).toString()),function(){var t=LC()-1;t<=0?document.body.removeAttribute(ud):document.body.setAttribute(ud,t.toString())}},[])},UG=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,a=r===void 0?"margin":r;$G();var i=g.useMemo(function(){return FG(a)},[a]);return g.createElement(BG,{styles:zG(i,!e,a,n?"":"!important")})},Ww=!1;if(typeof window<"u")try{var sp=Object.defineProperty({},"passive",{get:function(){return Ww=!0,!0}});window.addEventListener("test",sp,sp),window.removeEventListener("test",sp,sp)}catch{Ww=!1}var Ec=Ww?{passive:!1}:!1,qG=function(t){return t.tagName==="TEXTAREA"},N3=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!qG(t)&&n[e]==="visible")},HG=function(t){return N3(t,"overflowY")},WG=function(t){return N3(t,"overflowX")},FC=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=S3(t,r);if(a){var i=k3(t,r),o=i[1],c=i[2];if(o>c)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},VG=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},KG=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},S3=function(t,e){return t==="v"?HG(e):WG(e)},k3=function(t,e){return t==="v"?VG(e):KG(e)},ZG=function(t,e){return t==="h"&&e==="rtl"?-1:1},GG=function(t,e,n,r,a){var i=ZG(t,window.getComputedStyle(e).direction),o=i*r,c=n.target,d=e.contains(c),u=!1,m=o>0,f=0,p=0;do{var v=k3(t,c),w=v[0],x=v[1],y=v[2],j=x-y-i*w;(w||j)&&S3(t,c)&&(f+=j,p+=w),c instanceof ShadowRoot?c=c.host:c=c.parentNode}while(!d&&c!==document.body||d&&(e.contains(c)||e===c));return(m&&(Math.abs(f)<1||!a)||!m&&(Math.abs(p)<1||!a))&&(u=!0),u},rp=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},BC=function(t){return[t.deltaX,t.deltaY]},zC=function(t){return t&&"current"in t?t.current:t},QG=function(t,e){return t[0]===e[0]&&t[1]===e[1]},YG=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},XG=0,Ac=[];function JG(t){var e=g.useRef([]),n=g.useRef([0,0]),r=g.useRef(),a=g.useState(XG++)[0],i=g.useState(j3)[0],o=g.useRef(t);g.useEffect(function(){o.current=t},[t]),g.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(a));var x=_G([t.lockRef.current],(t.shards||[]).map(zC),!0).filter(Boolean);return x.forEach(function(y){return y.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),x.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(a))})}}},[t.inert,t.lockRef.current,t.shards]);var c=g.useCallback(function(x,y){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var j=rp(x),b=n.current,N="deltaX"in x?x.deltaX:b[0]-j[0],S="deltaY"in x?x.deltaY:b[1]-j[1],E,C=x.target,P=Math.abs(N)>Math.abs(S)?"h":"v";if("touches"in x&&P==="h"&&C.type==="range")return!1;var R=FC(P,C);if(!R)return!0;if(R?E=P:(E=P==="v"?"h":"v",R=FC(P,C)),!R)return!1;if(!r.current&&"changedTouches"in x&&(N||S)&&(r.current=E),!E)return!0;var H=r.current||E;return GG(H,y,x,H==="h"?N:S,!0)},[]),d=g.useCallback(function(x){var y=x;if(!(!Ac.length||Ac[Ac.length-1]!==i)){var j="deltaY"in y?BC(y):rp(y),b=e.current.filter(function(E){return E.name===y.type&&(E.target===y.target||y.target===E.shadowParent)&&QG(E.delta,j)})[0];if(b&&b.should){y.cancelable&&y.preventDefault();return}if(!b){var N=(o.current.shards||[]).map(zC).filter(Boolean).filter(function(E){return E.contains(y.target)}),S=N.length>0?c(y,N[0]):!o.current.noIsolation;S&&y.cancelable&&y.preventDefault()}}},[]),u=g.useCallback(function(x,y,j,b){var N={name:x,delta:y,target:j,should:b,shadowParent:eQ(j)};e.current.push(N),setTimeout(function(){e.current=e.current.filter(function(S){return S!==N})},1)},[]),m=g.useCallback(function(x){n.current=rp(x),r.current=void 0},[]),f=g.useCallback(function(x){u(x.type,BC(x),x.target,c(x,t.lockRef.current))},[]),p=g.useCallback(function(x){u(x.type,rp(x),x.target,c(x,t.lockRef.current))},[]);g.useEffect(function(){return Ac.push(i),t.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:p}),document.addEventListener("wheel",d,Ec),document.addEventListener("touchmove",d,Ec),document.addEventListener("touchstart",m,Ec),function(){Ac=Ac.filter(function(x){return x!==i}),document.removeEventListener("wheel",d,Ec),document.removeEventListener("touchmove",d,Ec),document.removeEventListener("touchstart",m,Ec)}},[]);var v=t.removeScrollBar,w=t.inert;return g.createElement(g.Fragment,null,w?g.createElement(i,{styles:YG(a)}):null,v?g.createElement(UG,{gapMode:t.gapMode}):null)}function eQ(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const tQ=AG(b3,JG);var Um=g.forwardRef(function(t,e){return g.createElement(Jg,Fa({},t,{ref:e,sideCar:tQ}))});Um.classNames=Jg.classNames;var nQ=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Pc=new WeakMap,ap=new WeakMap,ip={},Ay=0,C3=function(t){return t&&(t.host||C3(t.parentNode))},sQ=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=C3(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},rQ=function(t,e,n,r){var a=sQ(e,Array.isArray(t)?t:[t]);ip[n]||(ip[n]=new WeakMap);var i=ip[n],o=[],c=new Set,d=new Set(a),u=function(f){!f||c.has(f)||(c.add(f),u(f.parentNode))};a.forEach(u);var m=function(f){!f||d.has(f)||Array.prototype.forEach.call(f.children,function(p){if(c.has(p))m(p);else try{var v=p.getAttribute(r),w=v!==null&&v!=="false",x=(Pc.get(p)||0)+1,y=(i.get(p)||0)+1;Pc.set(p,x),i.set(p,y),o.push(p),x===1&&w&&ap.set(p,!0),y===1&&p.setAttribute(n,"true"),w||p.setAttribute(r,"true")}catch(j){console.error("aria-hidden: cannot operate on ",p,j)}})};return m(e),c.clear(),Ay++,function(){o.forEach(function(f){var p=Pc.get(f)-1,v=i.get(f)-1;Pc.set(f,p),i.set(f,v),p||(ap.has(f)||f.removeAttribute(r),ap.delete(f)),v||f.removeAttribute(n)}),Ay--,Ay||(Pc=new WeakMap,Pc=new WeakMap,ap=new WeakMap,ip={})}},ex=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),a=nQ(t);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live]"))),rQ(r,a,n,"aria-hidden")):function(){return null}},p1="Dialog",[E3,Pae]=kr(p1),[aQ,ba]=E3(p1),A3=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:a,onOpenChange:i,modal:o=!0}=t,c=g.useRef(null),d=g.useRef(null),[u=!1,m]=qr({prop:r,defaultProp:a,onChange:i});return s.jsx(aQ,{scope:e,triggerRef:c,contentRef:d,contentId:pr(),titleId:pr(),descriptionId:pr(),open:u,onOpenChange:m,onOpenToggle:g.useCallback(()=>m(f=>!f),[m]),modal:o,children:n})};A3.displayName=p1;var P3="DialogTrigger",D3=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=ba(P3,n),i=Rt(e,a.triggerRef);return s.jsx(tt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":v1(a.open),...r,ref:i,onClick:Oe(t.onClick,a.onOpenToggle)})});D3.displayName=P3;var g1="DialogPortal",[iQ,T3]=E3(g1,{forceMount:void 0}),M3=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:a}=t,i=ba(g1,e);return s.jsx(iQ,{scope:e,forceMount:n,children:g.Children.map(r,o=>s.jsx(ts,{present:n||i.open,children:s.jsx(Vd,{asChild:!0,container:a,children:o})}))})};M3.displayName=g1;var B0="DialogOverlay",R3=g.forwardRef((t,e)=>{const n=T3(B0,t.__scopeDialog),{forceMount:r=n.forceMount,...a}=t,i=ba(B0,t.__scopeDialog);return i.modal?s.jsx(ts,{present:r||i.open,children:s.jsx(oQ,{...a,ref:e})}):null});R3.displayName=B0;var oQ=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=ba(B0,n);return s.jsx(Um,{as:Ci,allowPinchZoom:!0,shards:[a.contentRef],children:s.jsx(tt.div,{"data-state":v1(a.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Kl="DialogContent",I3=g.forwardRef((t,e)=>{const n=T3(Kl,t.__scopeDialog),{forceMount:r=n.forceMount,...a}=t,i=ba(Kl,t.__scopeDialog);return s.jsx(ts,{present:r||i.open,children:i.modal?s.jsx(lQ,{...a,ref:e}):s.jsx(cQ,{...a,ref:e})})});I3.displayName=Kl;var lQ=g.forwardRef((t,e)=>{const n=ba(Kl,t.__scopeDialog),r=g.useRef(null),a=Rt(e,n.contentRef,r);return g.useEffect(()=>{const i=r.current;if(i)return ex(i)},[]),s.jsx(O3,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Oe(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Oe(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,c=o.button===0&&o.ctrlKey===!0;(o.button===2||c)&&i.preventDefault()}),onFocusOutside:Oe(t.onFocusOutside,i=>i.preventDefault())})}),cQ=g.forwardRef((t,e)=>{const n=ba(Kl,t.__scopeDialog),r=g.useRef(!1),a=g.useRef(!1);return s.jsx(O3,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,c;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(c=n.triggerRef.current)==null||c.focus(),i.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:i=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),O3=g.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:i,...o}=t,c=ba(Kl,n),d=g.useRef(null),u=Rt(e,d);return Xg(),s.jsxs(s.Fragment,{children:[s.jsx($m,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:i,children:s.jsx(Jl,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":v1(c.open),...o,ref:u,onDismiss:()=>c.onOpenChange(!1)})}),s.jsxs(s.Fragment,{children:[s.jsx(dQ,{titleId:c.titleId}),s.jsx(hQ,{contentRef:d,descriptionId:c.descriptionId})]})]})}),x1="DialogTitle",L3=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=ba(x1,n);return s.jsx(tt.h2,{id:a.titleId,...r,ref:e})});L3.displayName=x1;var F3="DialogDescription",B3=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=ba(F3,n);return s.jsx(tt.p,{id:a.descriptionId,...r,ref:e})});B3.displayName=F3;var z3="DialogClose",$3=g.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,a=ba(z3,n);return s.jsx(tt.button,{type:"button",...r,ref:e,onClick:Oe(t.onClick,()=>a.onOpenChange(!1))})});$3.displayName=z3;function v1(t){return t?"open":"closed"}var U3="DialogTitleWarning",[Dae,q3]=mF(U3,{contentName:Kl,titleName:x1,docsSlug:"dialog"}),dQ=({titleId:t})=>{const e=q3(U3),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return g.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},uQ="DialogDescriptionWarning",hQ=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${q3(uQ).contentName}}.`;return g.useEffect(()=>{var i;const a=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&a&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},H3=A3,mQ=D3,W3=M3,tx=R3,nx=I3,sx=L3,rx=B3,V3=$3;const Kt=H3,fQ=mQ,pQ=W3,K3=g.forwardRef(({className:t,...e},n)=>s.jsx(tx,{ref:n,className:Ie("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));K3.displayName=tx.displayName;const Wt=g.forwardRef(({className:t,children:e,...n},r)=>s.jsxs(pQ,{children:[s.jsx(K3,{}),s.jsxs(nx,{ref:r,className:Ie("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,s.jsxs(V3,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[s.jsx($n,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Wt.displayName=nx.displayName;const tn=({className:t,...e})=>s.jsx("div",{className:Ie("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});tn.displayName="DialogHeader";const Tl=({className:t,...e})=>s.jsx("div",{className:Ie("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});Tl.displayName="DialogFooter";const nn=g.forwardRef(({className:t,...e},n)=>s.jsx(sx,{ref:n,className:Ie("text-lg font-semibold leading-none tracking-tight",t),...e}));nn.displayName=sx.displayName;const In=g.forwardRef(({className:t,...e},n)=>s.jsx(rx,{ref:n,className:Ie("text-sm text-muted-foreground",t),...e}));In.displayName=rx.displayName;function Vw(t,[e,n]){return Math.min(n,Math.max(e,t))}function Z3(t){const e=g.useRef({value:t,previous:t});return g.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var gQ=[" ","Enter","ArrowUp","ArrowDown"],xQ=[" ","Enter"],qm="Select",[ax,ix,vQ]=km(qm),[ou,Tae]=kr(qm,[vQ,Ho]),ox=Ho(),[yQ,Ko]=ou(qm),[_Q,wQ]=ou(qm),G3=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:a,onOpenChange:i,value:o,defaultValue:c,onValueChange:d,dir:u,name:m,autoComplete:f,disabled:p,required:v,form:w}=t,x=ox(e),[y,j]=g.useState(null),[b,N]=g.useState(null),[S,E]=g.useState(!1),C=ru(u),[P=!1,R]=qr({prop:r,defaultProp:a,onChange:i}),[H,I]=qr({prop:o,defaultProp:c,onChange:d}),D=g.useRef(null),W=y?w||!!y.closest("form"):!0,[V,G]=g.useState(new Set),Y=Array.from(V).map(X=>X.props.value).join(";");return s.jsx(gj,{...x,children:s.jsxs(yQ,{required:v,scope:e,trigger:y,onTriggerChange:j,valueNode:b,onValueNodeChange:N,valueNodeHasChildren:S,onValueNodeHasChildrenChange:E,contentId:pr(),value:H,onValueChange:I,open:P,onOpenChange:R,dir:C,triggerPointerDownPosRef:D,disabled:p,children:[s.jsx(ax.Provider,{scope:e,children:s.jsx(_Q,{scope:t.__scopeSelect,onNativeOptionAdd:g.useCallback(X=>{G(F=>new Set(F).add(X))},[]),onNativeOptionRemove:g.useCallback(X=>{G(F=>{const T=new Set(F);return T.delete(X),T})},[]),children:n})}),W?s.jsxs(_R,{"aria-hidden":!0,required:v,tabIndex:-1,name:m,autoComplete:f,value:H,onChange:X=>I(X.target.value),disabled:p,form:w,children:[H===void 0?s.jsx("option",{value:""}):null,Array.from(V)]},Y):null]})})};G3.displayName=qm;var Q3="SelectTrigger",Y3=g.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...a}=t,i=ox(n),o=Ko(Q3,n),c=o.disabled||r,d=Rt(e,o.onTriggerChange),u=ix(n),m=g.useRef("touch"),[f,p,v]=wR(x=>{const y=u().filter(N=>!N.disabled),j=y.find(N=>N.value===o.value),b=bR(y,x,j);b!==void 0&&o.onValueChange(b.value)}),w=x=>{c||(o.onOpenChange(!0),v()),x&&(o.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return s.jsx(Tm,{asChild:!0,...i,children:s.jsx(tt.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":yR(o.value)?"":void 0,...a,ref:d,onClick:Oe(a.onClick,x=>{x.currentTarget.focus(),m.current!=="mouse"&&w(x)}),onPointerDown:Oe(a.onPointerDown,x=>{m.current=x.pointerType;const y=x.target;y.hasPointerCapture(x.pointerId)&&y.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(w(x),x.preventDefault())}),onKeyDown:Oe(a.onKeyDown,x=>{const y=f.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&p(x.key),!(y&&x.key===" ")&&gQ.includes(x.key)&&(w(),x.preventDefault())})})})});Y3.displayName=Q3;var X3="SelectValue",J3=g.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:a,children:i,placeholder:o="",...c}=t,d=Ko(X3,n),{onValueNodeHasChildrenChange:u}=d,m=i!==void 0,f=Rt(e,d.onValueNodeChange);return qn(()=>{u(m)},[u,m]),s.jsx(tt.span,{...c,ref:f,style:{pointerEvents:"none"},children:yR(d.value)?s.jsx(s.Fragment,{children:o}):i})});J3.displayName=X3;var bQ="SelectIcon",eR=g.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...a}=t;return s.jsx(tt.span,{"aria-hidden":!0,...a,ref:e,children:r||"▼"})});eR.displayName=bQ;var jQ="SelectPortal",tR=t=>s.jsx(Vd,{asChild:!0,...t});tR.displayName=jQ;var Zl="SelectContent",nR=g.forwardRef((t,e)=>{const n=Ko(Zl,t.__scopeSelect),[r,a]=g.useState();if(qn(()=>{a(new DocumentFragment)},[]),!n.open){const i=r;return i?Xl.createPortal(s.jsx(sR,{scope:t.__scopeSelect,children:s.jsx(ax.Slot,{scope:t.__scopeSelect,children:s.jsx("div",{children:t.children})})}),i):null}return s.jsx(rR,{...t,ref:e})});nR.displayName=Zl;var ea=10,[sR,Zo]=ou(Zl),NQ="SelectContentImpl",rR=g.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:c,sideOffset:d,align:u,alignOffset:m,arrowPadding:f,collisionBoundary:p,collisionPadding:v,sticky:w,hideWhenDetached:x,avoidCollisions:y,...j}=t,b=Ko(Zl,n),[N,S]=g.useState(null),[E,C]=g.useState(null),P=Rt(e,Q=>S(Q)),[R,H]=g.useState(null),[I,D]=g.useState(null),W=ix(n),[V,G]=g.useState(!1),Y=g.useRef(!1);g.useEffect(()=>{if(N)return ex(N)},[N]),Xg();const X=g.useCallback(Q=>{const[le,...pe]=W().map(fe=>fe.ref.current),[J]=pe.slice(-1),ae=document.activeElement;for(const fe of Q)if(fe===ae||(fe==null||fe.scrollIntoView({block:"nearest"}),fe===le&&E&&(E.scrollTop=0),fe===J&&E&&(E.scrollTop=E.scrollHeight),fe==null||fe.focus(),document.activeElement!==ae))return},[W,E]),F=g.useCallback(()=>X([R,N]),[X,R,N]);g.useEffect(()=>{V&&F()},[V,F]);const{onOpenChange:T,triggerPointerDownPosRef:q}=b;g.useEffect(()=>{if(N){let Q={x:0,y:0};const le=J=>{var ae,fe;Q={x:Math.abs(Math.round(J.pageX)-(((ae=q.current)==null?void 0:ae.x)??0)),y:Math.abs(Math.round(J.pageY)-(((fe=q.current)==null?void 0:fe.y)??0))}},pe=J=>{Q.x<=10&&Q.y<=10?J.preventDefault():N.contains(J.target)||T(!1),document.removeEventListener("pointermove",le),q.current=null};return q.current!==null&&(document.addEventListener("pointermove",le),document.addEventListener("pointerup",pe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",le),document.removeEventListener("pointerup",pe,{capture:!0})}}},[N,T,q]),g.useEffect(()=>{const Q=()=>T(!1);return window.addEventListener("blur",Q),window.addEventListener("resize",Q),()=>{window.removeEventListener("blur",Q),window.removeEventListener("resize",Q)}},[T]);const[U,B]=wR(Q=>{const le=W().filter(ae=>!ae.disabled),pe=le.find(ae=>ae.ref.current===document.activeElement),J=bR(le,Q,pe);J&&setTimeout(()=>J.ref.current.focus())}),O=g.useCallback((Q,le,pe)=>{const J=!Y.current&&!pe;(b.value!==void 0&&b.value===le||J)&&(H(Q),J&&(Y.current=!0))},[b.value]),z=g.useCallback(()=>N==null?void 0:N.focus(),[N]),$=g.useCallback((Q,le,pe)=>{const J=!Y.current&&!pe;(b.value!==void 0&&b.value===le||J)&&D(Q)},[b.value]),te=r==="popper"?Kw:aR,ee=te===Kw?{side:c,sideOffset:d,align:u,alignOffset:m,arrowPadding:f,collisionBoundary:p,collisionPadding:v,sticky:w,hideWhenDetached:x,avoidCollisions:y}:{};return s.jsx(sR,{scope:n,content:N,viewport:E,onViewportChange:C,itemRefCallback:O,selectedItem:R,onItemLeave:z,itemTextRefCallback:$,focusSelectedItem:F,selectedItemText:I,position:r,isPositioned:V,searchRef:U,children:s.jsx(Um,{as:Ci,allowPinchZoom:!0,children:s.jsx($m,{asChild:!0,trapped:b.open,onMountAutoFocus:Q=>{Q.preventDefault()},onUnmountAutoFocus:Oe(a,Q=>{var le;(le=b.trigger)==null||le.focus({preventScroll:!0}),Q.preventDefault()}),children:s.jsx(Jl,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:Q=>Q.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:s.jsx(te,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:Q=>Q.preventDefault(),...j,...ee,onPlaced:()=>G(!0),ref:P,style:{display:"flex",flexDirection:"column",outline:"none",...j.style},onKeyDown:Oe(j.onKeyDown,Q=>{const le=Q.ctrlKey||Q.altKey||Q.metaKey;if(Q.key==="Tab"&&Q.preventDefault(),!le&&Q.key.length===1&&B(Q.key),["ArrowUp","ArrowDown","Home","End"].includes(Q.key)){let J=W().filter(ae=>!ae.disabled).map(ae=>ae.ref.current);if(["ArrowUp","End"].includes(Q.key)&&(J=J.slice().reverse()),["ArrowUp","ArrowDown"].includes(Q.key)){const ae=Q.target,fe=J.indexOf(ae);J=J.slice(fe+1)}setTimeout(()=>X(J)),Q.preventDefault()}})})})})})})});rR.displayName=NQ;var SQ="SelectItemAlignedPosition",aR=g.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...a}=t,i=Ko(Zl,n),o=Zo(Zl,n),[c,d]=g.useState(null),[u,m]=g.useState(null),f=Rt(e,P=>m(P)),p=ix(n),v=g.useRef(!1),w=g.useRef(!0),{viewport:x,selectedItem:y,selectedItemText:j,focusSelectedItem:b}=o,N=g.useCallback(()=>{if(i.trigger&&i.valueNode&&c&&u&&x&&y&&j){const P=i.trigger.getBoundingClientRect(),R=u.getBoundingClientRect(),H=i.valueNode.getBoundingClientRect(),I=j.getBoundingClientRect();if(i.dir!=="rtl"){const ae=I.left-R.left,fe=H.left-ae,he=P.left-fe,ve=P.width+he,ie=Math.max(ve,R.width),_e=window.innerWidth-ea,Se=Vw(fe,[ea,Math.max(ea,_e-ie)]);c.style.minWidth=ve+"px",c.style.left=Se+"px"}else{const ae=R.right-I.right,fe=window.innerWidth-H.right-ae,he=window.innerWidth-P.right-fe,ve=P.width+he,ie=Math.max(ve,R.width),_e=window.innerWidth-ea,Se=Vw(fe,[ea,Math.max(ea,_e-ie)]);c.style.minWidth=ve+"px",c.style.right=Se+"px"}const D=p(),W=window.innerHeight-ea*2,V=x.scrollHeight,G=window.getComputedStyle(u),Y=parseInt(G.borderTopWidth,10),X=parseInt(G.paddingTop,10),F=parseInt(G.borderBottomWidth,10),T=parseInt(G.paddingBottom,10),q=Y+X+V+T+F,U=Math.min(y.offsetHeight*5,q),B=window.getComputedStyle(x),O=parseInt(B.paddingTop,10),z=parseInt(B.paddingBottom,10),$=P.top+P.height/2-ea,te=W-$,ee=y.offsetHeight/2,Q=y.offsetTop+ee,le=Y+X+Q,pe=q-le;if(le<=$){const ae=D.length>0&&y===D[D.length-1].ref.current;c.style.bottom="0px";const fe=u.clientHeight-x.offsetTop-x.offsetHeight,he=Math.max(te,ee+(ae?z:0)+fe+F),ve=le+he;c.style.height=ve+"px"}else{const ae=D.length>0&&y===D[0].ref.current;c.style.top="0px";const he=Math.max($,Y+x.offsetTop+(ae?O:0)+ee)+pe;c.style.height=he+"px",x.scrollTop=le-$+x.offsetTop}c.style.margin=`${ea}px 0`,c.style.minHeight=U+"px",c.style.maxHeight=W+"px",r==null||r(),requestAnimationFrame(()=>v.current=!0)}},[p,i.trigger,i.valueNode,c,u,x,y,j,i.dir,r]);qn(()=>N(),[N]);const[S,E]=g.useState();qn(()=>{u&&E(window.getComputedStyle(u).zIndex)},[u]);const C=g.useCallback(P=>{P&&w.current===!0&&(N(),b==null||b(),w.current=!1)},[N,b]);return s.jsx(CQ,{scope:n,contentWrapper:c,shouldExpandOnScrollRef:v,onScrollButtonChange:C,children:s.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:s.jsx(tt.div,{...a,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});aR.displayName=SQ;var kQ="SelectPopperPosition",Kw=g.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=ea,...i}=t,o=ox(n);return s.jsx(Sg,{...o,...i,ref:e,align:r,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Kw.displayName=kQ;var[CQ,y1]=ou(Zl,{}),Zw="SelectViewport",iR=g.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:r,...a}=t,i=Zo(Zw,n),o=y1(Zw,n),c=Rt(e,i.onViewportChange),d=g.useRef(0);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),s.jsx(ax.Slot,{scope:n,children:s.jsx(tt.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Oe(a.onScroll,u=>{const m=u.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:p}=o;if(p!=null&&p.current&&f){const v=Math.abs(d.current-m.scrollTop);if(v>0){const w=window.innerHeight-ea*2,x=parseFloat(f.style.minHeight),y=parseFloat(f.style.height),j=Math.max(x,y);if(j<w){const b=j+v,N=Math.min(w,b),S=b-N;f.style.height=N+"px",f.style.bottom==="0px"&&(m.scrollTop=S>0?S:0,f.style.justifyContent="flex-end")}}}d.current=m.scrollTop})})})]})});iR.displayName=Zw;var oR="SelectGroup",[EQ,AQ]=ou(oR),PQ=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,a=pr();return s.jsx(EQ,{scope:n,id:a,children:s.jsx(tt.div,{role:"group","aria-labelledby":a,...r,ref:e})})});PQ.displayName=oR;var lR="SelectLabel",cR=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,a=AQ(lR,n);return s.jsx(tt.div,{id:a.id,...r,ref:e})});cR.displayName=lR;var z0="SelectItem",[DQ,dR]=ou(z0),uR=g.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:i,...o}=t,c=Ko(z0,n),d=Zo(z0,n),u=c.value===r,[m,f]=g.useState(i??""),[p,v]=g.useState(!1),w=Rt(e,b=>{var N;return(N=d.itemRefCallback)==null?void 0:N.call(d,b,r,a)}),x=pr(),y=g.useRef("touch"),j=()=>{a||(c.onValueChange(r),c.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return s.jsx(DQ,{scope:n,value:r,disabled:a,textId:x,isSelected:u,onItemTextChange:g.useCallback(b=>{f(N=>N||((b==null?void 0:b.textContent)??"").trim())},[]),children:s.jsx(ax.ItemSlot,{scope:n,value:r,disabled:a,textValue:m,children:s.jsx(tt.div,{role:"option","aria-labelledby":x,"data-highlighted":p?"":void 0,"aria-selected":u&&p,"data-state":u?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...o,ref:w,onFocus:Oe(o.onFocus,()=>v(!0)),onBlur:Oe(o.onBlur,()=>v(!1)),onClick:Oe(o.onClick,()=>{y.current!=="mouse"&&j()}),onPointerUp:Oe(o.onPointerUp,()=>{y.current==="mouse"&&j()}),onPointerDown:Oe(o.onPointerDown,b=>{y.current=b.pointerType}),onPointerMove:Oe(o.onPointerMove,b=>{var N;y.current=b.pointerType,a?(N=d.onItemLeave)==null||N.call(d):y.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Oe(o.onPointerLeave,b=>{var N;b.currentTarget===document.activeElement&&((N=d.onItemLeave)==null||N.call(d))}),onKeyDown:Oe(o.onKeyDown,b=>{var S;((S=d.searchRef)==null?void 0:S.current)!==""&&b.key===" "||(xQ.includes(b.key)&&j(),b.key===" "&&b.preventDefault())})})})})});uR.displayName=z0;var Xu="SelectItemText",hR=g.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:a,...i}=t,o=Ko(Xu,n),c=Zo(Xu,n),d=dR(Xu,n),u=wQ(Xu,n),[m,f]=g.useState(null),p=Rt(e,j=>f(j),d.onItemTextChange,j=>{var b;return(b=c.itemTextRefCallback)==null?void 0:b.call(c,j,d.value,d.disabled)}),v=m==null?void 0:m.textContent,w=g.useMemo(()=>s.jsx("option",{value:d.value,disabled:d.disabled,children:v},d.value),[d.disabled,d.value,v]),{onNativeOptionAdd:x,onNativeOptionRemove:y}=u;return qn(()=>(x(w),()=>y(w)),[x,y,w]),s.jsxs(s.Fragment,{children:[s.jsx(tt.span,{id:d.textId,...i,ref:p}),d.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Xl.createPortal(i.children,o.valueNode):null]})});hR.displayName=Xu;var mR="SelectItemIndicator",fR=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return dR(mR,n).isSelected?s.jsx(tt.span,{"aria-hidden":!0,...r,ref:e}):null});fR.displayName=mR;var Gw="SelectScrollUpButton",pR=g.forwardRef((t,e)=>{const n=Zo(Gw,t.__scopeSelect),r=y1(Gw,t.__scopeSelect),[a,i]=g.useState(!1),o=Rt(e,r.onScrollButtonChange);return qn(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=d.scrollTop>0;i(u)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),a?s.jsx(xR,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});pR.displayName=Gw;var Qw="SelectScrollDownButton",gR=g.forwardRef((t,e)=>{const n=Zo(Qw,t.__scopeSelect),r=y1(Qw,t.__scopeSelect),[a,i]=g.useState(!1),o=Rt(e,r.onScrollButtonChange);return qn(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=d.scrollHeight-d.clientHeight,m=Math.ceil(d.scrollTop)<u;i(m)};const d=n.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),a?s.jsx(xR,{...t,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=n;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});gR.displayName=Qw;var xR=g.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=t,i=Zo("SelectScrollButton",n),o=g.useRef(null),c=ix(n),d=g.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return g.useEffect(()=>()=>d(),[d]),qn(()=>{var m;const u=c().find(f=>f.ref.current===document.activeElement);(m=u==null?void 0:u.ref.current)==null||m.scrollIntoView({block:"nearest"})},[c]),s.jsx(tt.div,{"aria-hidden":!0,...a,ref:e,style:{flexShrink:0,...a.style},onPointerDown:Oe(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:Oe(a.onPointerMove,()=>{var u;(u=i.onItemLeave)==null||u.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:Oe(a.onPointerLeave,()=>{d()})})}),TQ="SelectSeparator",vR=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return s.jsx(tt.div,{"aria-hidden":!0,...r,ref:e})});vR.displayName=TQ;var Yw="SelectArrow",MQ=g.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,a=ox(n),i=Ko(Yw,n),o=Zo(Yw,n);return i.open&&o.position==="popper"?s.jsx(kg,{...a,...r,ref:e}):null});MQ.displayName=Yw;function yR(t){return t===""||t===void 0}var _R=g.forwardRef((t,e)=>{const{value:n,...r}=t,a=g.useRef(null),i=Rt(e,a),o=Z3(n);return g.useEffect(()=>{const c=a.current,d=window.HTMLSelectElement.prototype,m=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==n&&m){const f=new Event("change",{bubbles:!0});m.call(c,n),c.dispatchEvent(f)}},[o,n]),s.jsx(Cm,{asChild:!0,children:s.jsx("select",{...r,ref:i,defaultValue:n})})});_R.displayName="BubbleSelect";function wR(t){const e=_n(t),n=g.useRef(""),r=g.useRef(0),a=g.useCallback(o=>{const c=n.current+o;e(c),function d(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>d(""),1e3))}(c)},[e]),i=g.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,i]}function bR(t,e,n){const a=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=RQ(t,Math.max(i,0));a.length===1&&(o=o.filter(u=>u!==n));const d=o.find(u=>u.textValue.toLowerCase().startsWith(a.toLowerCase()));return d!==n?d:void 0}function RQ(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var IQ=G3,jR=Y3,OQ=J3,LQ=eR,FQ=tR,NR=nR,BQ=iR,SR=cR,kR=uR,zQ=hR,$Q=fR,CR=pR,ER=gR,AR=vR;const ut=IQ,ht=OQ,lt=g.forwardRef(({className:t,children:e,...n},r)=>s.jsxs(jR,{ref:r,className:Ie("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,s.jsx(LQ,{asChild:!0,children:s.jsx(wg,{className:"h-4 w-4 opacity-50"})})]}));lt.displayName=jR.displayName;const PR=g.forwardRef(({className:t,...e},n)=>s.jsx(CR,{ref:n,className:Ie("flex cursor-default items-center justify-center py-1",t),...e,children:s.jsx(sB,{className:"h-4 w-4"})}));PR.displayName=CR.displayName;const DR=g.forwardRef(({className:t,...e},n)=>s.jsx(ER,{ref:n,className:Ie("flex cursor-default items-center justify-center py-1",t),...e,children:s.jsx(wg,{className:"h-4 w-4"})}));DR.displayName=ER.displayName;const ct=g.forwardRef(({className:t,children:e,position:n="popper",...r},a)=>s.jsx(FQ,{children:s.jsxs(NR,{ref:a,className:Ie("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[s.jsx(PR,{}),s.jsx(BQ,{className:Ie("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),s.jsx(DR,{})]})}));ct.displayName=NR.displayName;const UQ=g.forwardRef(({className:t,...e},n)=>s.jsx(SR,{ref:n,className:Ie("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));UQ.displayName=SR.displayName;const xe=g.forwardRef(({className:t,children:e,...n},r)=>s.jsxs(kR,{ref:r,className:Ie("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx($Q,{children:s.jsx(Em,{className:"h-4 w-4"})})}),s.jsx(zQ,{children:e})]}));xe.displayName=kR.displayName;const qQ=g.forwardRef(({className:t,...e},n)=>s.jsx(AR,{ref:n,className:Ie("-mx-1 my-1 h-px bg-muted",t),...e}));qQ.displayName=AR.displayName;const HQ=({isOpen:t,onClose:e,onCustomerAdded:n})=>{const{toast:r}=It(),[a,i]=g.useState({company_name:"",anrede:"",first_name:"",last_name:"",contact_person:"",email:"",phone:"",mobile:"",fax:"",website:"",address:"",city:"",postal_code:"",country:"Deutschland",status:"Aktiv",customer_number:"",tax_number:"",zahlungsziel:"30",skonto_prozent:"",skonto_tage:"",waehrung:"EUR",preisgruppe:"Standard",iban:"",bic:"",bank_name:"",kontoinhaber:"",zugprd_status:"Inaktiv",benutzer_id:"",passwort:""}),o=d=>{if(d.preventDefault(),!a.company_name||!a.contact_person||!a.email){r({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.email)){r({title:"Fehler",description:"Bitte geben Sie eine gültige E-Mail-Adresse ein.",variant:"destructive"});return}n(a),i({company_name:"",anrede:"",first_name:"",last_name:"",contact_person:"",email:"",phone:"",mobile:"",fax:"",website:"",address:"",city:"",postal_code:"",country:"Deutschland",status:"Aktiv",customer_number:"",tax_number:"",zahlungsziel:"30",skonto_prozent:"",skonto_tage:"",waehrung:"EUR",preisgruppe:"Standard",iban:"",bic:"",bank_name:"",kontoinhaber:"",zugprd_status:"Inaktiv",benutzer_id:"",passwort:""}),e()},c=(d,u)=>{i(m=>({...m,[d]:u}))};return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-6xl max-h-[95vh] overflow-y-auto",children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Neuen Kunden hinzufügen"}),s.jsx(In,{children:"Geben Sie die Informationen für den neuen Kunden ein."})]}),s.jsxs("form",{onSubmit:o,className:"space-y-6",children:[s.jsxs(es,{defaultValue:"ansprechpartner",className:"w-full",children:[s.jsxs(Hn,{className:"grid grid-cols-6 w-full",children:[s.jsx(He,{value:"ansprechpartner",children:"ANSPRECHPARTNER"}),s.jsx(He,{value:"kontaktdetails",children:"KONTAKTDETAILS"}),s.jsx(He,{value:"adresse",children:"ADRESSE"}),s.jsx(He,{value:"konditionen",children:"KONDITIONEN"}),s.jsx(He,{value:"zahlungsdaten",children:"ZAHLUNGSDATEN"}),s.jsx(He,{value:"zugprd",children:"ZUGPRD 2.0 STANDARD"})]}),s.jsxs(We,{value:"ansprechpartner",className:"space-y-4 mt-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"company_name",children:"Firmenname *"}),s.jsx(re,{id:"company_name",value:a.company_name,onChange:d=>c("company_name",d.target.value),placeholder:"z.B. Mustermann GmbH",required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"customer_number",children:"Kundennummer"}),s.jsx(re,{id:"customer_number",value:a.customer_number,onChange:d=>c("customer_number",d.target.value),placeholder:"AUTO"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"anrede",children:"Anrede"}),s.jsxs(ut,{value:a.anrede,onValueChange:d=>c("anrede",d),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Wählen..."})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Herr",children:"Herr"}),s.jsx(xe,{value:"Frau",children:"Frau"}),s.jsx(xe,{value:"Divers",children:"Divers"})]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"first_name",children:"Vorname"}),s.jsx(re,{id:"first_name",value:a.first_name,onChange:d=>c("first_name",d.target.value),placeholder:"Max"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"last_name",children:"Nachname"}),s.jsx(re,{id:"last_name",value:a.last_name,onChange:d=>c("last_name",d.target.value),placeholder:"Mustermann"})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"contact_person",children:"Ansprechpartner *"}),s.jsx(re,{id:"contact_person",value:a.contact_person,onChange:d=>c("contact_person",d.target.value),placeholder:"z.B. Max Mustermann",required:!0})]})]}),s.jsxs(We,{value:"kontaktdetails",className:"space-y-4 mt-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"email",children:"E-Mail *"}),s.jsx(re,{id:"email",type:"email",value:a.email,onChange:d=>c("email",d.target.value),placeholder:"kontakt@firma.de",required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"website",children:"Website"}),s.jsx(re,{id:"website",value:a.website,onChange:d=>c("website",d.target.value),placeholder:"www.firma.de"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"phone",children:"Telefon"}),s.jsx(re,{id:"phone",value:a.phone,onChange:d=>c("phone",d.target.value),placeholder:"+49 123 456789"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"mobile",children:"Mobil"}),s.jsx(re,{id:"mobile",value:a.mobile,onChange:d=>c("mobile",d.target.value),placeholder:"+49 123 456789"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"fax",children:"Fax"}),s.jsx(re,{id:"fax",value:a.fax,onChange:d=>c("fax",d.target.value),placeholder:"+49 123 456789"})]})]})]}),s.jsxs(We,{value:"adresse",className:"space-y-4 mt-6",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"address",children:"Straße und Hausnummer"}),s.jsx(re,{id:"address",value:a.address,onChange:d=>c("address",d.target.value),placeholder:"Musterstraße 123"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"postal_code",children:"PLZ"}),s.jsx(re,{id:"postal_code",value:a.postal_code,onChange:d=>c("postal_code",d.target.value),placeholder:"12345"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"city",children:"Ort"}),s.jsx(re,{id:"city",value:a.city,onChange:d=>c("city",d.target.value),placeholder:"Berlin"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"country",children:"Land"}),s.jsx(re,{id:"country",value:a.country,onChange:d=>c("country",d.target.value),placeholder:"Deutschland"})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"tax_number",children:"Steuernummer"}),s.jsx(re,{id:"tax_number",value:a.tax_number,onChange:d=>c("tax_number",d.target.value),placeholder:"123/456/78910"})]})]}),s.jsxs(We,{value:"konditionen",className:"space-y-4 mt-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"zahlungsziel",children:"Zahlungsziel (Tage)"}),s.jsxs(ut,{value:a.zahlungsziel,onValueChange:d=>c("zahlungsziel",d),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"14",children:"14 Tage"}),s.jsx(xe,{value:"30",children:"30 Tage"}),s.jsx(xe,{value:"60",children:"60 Tage"}),s.jsx(xe,{value:"90",children:"90 Tage"})]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"waehrung",children:"Währung"}),s.jsxs(ut,{value:a.waehrung,onValueChange:d=>c("waehrung",d),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"EUR",children:"EUR"}),s.jsx(xe,{value:"USD",children:"USD"}),s.jsx(xe,{value:"GBP",children:"GBP"})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"skonto_prozent",children:"Skonto %"}),s.jsx(re,{id:"skonto_prozent",value:a.skonto_prozent,onChange:d=>c("skonto_prozent",d.target.value),placeholder:"2"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"skonto_tage",children:"Skonto Tage"}),s.jsx(re,{id:"skonto_tage",value:a.skonto_tage,onChange:d=>c("skonto_tage",d.target.value),placeholder:"10"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"preisgruppe",children:"Preisgruppe"}),s.jsxs(ut,{value:a.preisgruppe,onValueChange:d=>c("preisgruppe",d),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Standard",children:"Standard"}),s.jsx(xe,{value:"Premium",children:"Premium"}),s.jsx(xe,{value:"VIP",children:"VIP"})]})]})]})]})]}),s.jsxs(We,{value:"zahlungsdaten",className:"space-y-4 mt-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"iban",children:"IBAN"}),s.jsx(re,{id:"iban",value:a.iban,onChange:d=>c("iban",d.target.value),placeholder:"DE89 3704 0044 0532 0130 00"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"bic",children:"BIC"}),s.jsx(re,{id:"bic",value:a.bic,onChange:d=>c("bic",d.target.value),placeholder:"COBADEFFXXX"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"bank_name",children:"Bank"}),s.jsx(re,{id:"bank_name",value:a.bank_name,onChange:d=>c("bank_name",d.target.value),placeholder:"Commerzbank AG"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"kontoinhaber",children:"Kontoinhaber"}),s.jsx(re,{id:"kontoinhaber",value:a.kontoinhaber,onChange:d=>c("kontoinhaber",d.target.value),placeholder:"Mustermann GmbH"})]})]})]}),s.jsxs(We,{value:"zugprd",className:"space-y-4 mt-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"zugprd_status",children:"Status"}),s.jsxs(ut,{value:a.zugprd_status,onValueChange:d=>c("zugprd_status",d),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Aktiv",children:"Aktiv"}),s.jsx(xe,{value:"Inaktiv",children:"Inaktiv"})]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"status",children:"Kundenstatus"}),s.jsxs(ut,{value:a.status,onValueChange:d=>c("status",d),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Aktiv",children:"Aktiv"}),s.jsx(xe,{value:"Premium",children:"Premium"}),s.jsx(xe,{value:"Inaktiv",children:"Inaktiv"})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"benutzer_id",children:"Benutzer-ID"}),s.jsx(re,{id:"benutzer_id",value:a.benutzer_id,onChange:d=>c("benutzer_id",d.target.value),placeholder:"user123"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"passwort",children:"Passwort"}),s.jsx(re,{id:"passwort",type:"password",value:a.passwort,onChange:d=>c("passwort",d.target.value),placeholder:"••••••••"})]})]})]})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(ne,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),s.jsx(ne,{type:"submit",className:"flex-1",children:"Kunde hinzufügen"})]})]})]})})},Cn=g.forwardRef(({className:t,...e},n)=>s.jsx("textarea",{className:Ie("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));Cn.displayName="Textarea";const WQ=({isOpen:t,onClose:e,customer:n,onCustomerUpdated:r})=>{const{toast:a}=It(),i=XZ(),[o,c]=g.useState({company_name:(n==null?void 0:n.company_name)||"",contact_person:(n==null?void 0:n.contact_person)||"",email:(n==null?void 0:n.email)||"",phone:(n==null?void 0:n.phone)||"",address:(n==null?void 0:n.address)||"",city:(n==null?void 0:n.city)||"",postal_code:(n==null?void 0:n.postal_code)||"",country:(n==null?void 0:n.country)||"Deutschland",status:(n==null?void 0:n.status)||"Aktiv",anrede:(n==null?void 0:n.anrede)||"",first_name:(n==null?void 0:n.first_name)||"",last_name:(n==null?void 0:n.last_name)||"",mobile:(n==null?void 0:n.mobile)||"",website:(n==null?void 0:n.website)||"",erreichbarkeit:(n==null?void 0:n.erreichbarkeit)||"",sonstiges:(n==null?void 0:n.sonstiges)||"",festnetz:(n==null?void 0:n.festnetz)||"",fax:(n==null?void 0:n.fax)||"",zahlungsziel:(n==null?void 0:n.zahlungsziel)||"",skonto:(n==null?void 0:n.skonto)||"",skontofrist:(n==null?void 0:n.skontofrist)||"",verkaufspreise_gruppe:(n==null?void 0:n.verkaufspreise_gruppe)||"",iban:(n==null?void 0:n.iban)||"",bic:(n==null?void 0:n.bic)||"",bank_name:(n==null?void 0:n.bank_name)||"",umsatzsteuer_id:(n==null?void 0:n.umsatzsteuer_id)||"",debitor_konto:(n==null?void 0:n.debitor_konto)||""});Ae.useEffect(()=>{n&&c({company_name:n.company_name,contact_person:n.contact_person,email:n.email,phone:n.phone||"",address:n.address||"",city:n.city||"",postal_code:n.postal_code||"",country:n.country||"Deutschland",status:n.status,anrede:n.anrede||"",first_name:n.first_name||"",last_name:n.last_name||"",mobile:n.mobile||"",website:n.website||"",erreichbarkeit:n.erreichbarkeit||"",sonstiges:n.sonstiges||"",festnetz:n.festnetz||"",fax:n.fax||"",zahlungsziel:n.zahlungsziel||"",skonto:n.skonto||"",skontofrist:n.skontofrist||"",verkaufspreise_gruppe:n.verkaufspreise_gruppe||"",iban:n.iban||"",bic:n.bic||"",bank_name:n.bank_name||"",umsatzsteuer_id:n.umsatzsteuer_id||"",debitor_konto:n.debitor_konto||""})},[n]);const d=f=>{if(f.preventDefault(),!n)return;if(!o.company_name||!o.contact_person||!o.email){a({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.email)){a({title:"Fehler",description:"Bitte geben Sie eine gültige E-Mail-Adresse ein.",variant:"destructive"});return}const v={...n,...o};r(v),e()},u=(f,p)=>{c(v=>({...v,[f]:p}))},m=()=>{n&&window.confirm(`Möchten Sie den Kunden "${n.company_name}" wirklich löschen?`)&&i.mutate(n.id,{onSuccess:()=>{a({title:"Kunde gelöscht",description:`${n.company_name} wurde erfolgreich gelöscht.`}),e()},onError:f=>{a({title:"Fehler beim Löschen",description:f.message,variant:"destructive"})}})};return n?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-7xl h-[45vh] overflow-y-auto",children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Kunde bearbeiten"}),s.jsx(In,{children:"Bearbeiten Sie die Informationen für den Kunden."})]}),s.jsxs("form",{onSubmit:d,className:"space-y-4",children:[s.jsxs(es,{defaultValue:"kontaktdetails",className:"w-full",children:[s.jsxs(Hn,{className:"grid w-full grid-cols-6 h-12",children:[s.jsx(He,{value:"ansprechpartner",children:"ANSPRECHPARTNER"}),s.jsx(He,{value:"kontaktdetails",children:"KONTAKTDETAILS"}),s.jsx(He,{value:"adresse",children:"ADRESSE"}),s.jsx(He,{value:"konditionen",children:"KONDITIONEN"}),s.jsx(He,{value:"zahlungsdaten",children:"ZAHLUNGSDATEN"}),s.jsx(He,{value:"zugprd",children:"ZUGPRD 2.0 STANDARD"})]}),s.jsxs(We,{value:"ansprechpartner",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"anrede",children:"Anrede"}),s.jsxs(ut,{value:o.anrede,onValueChange:f=>u("anrede",f),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Anrede wählen"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Herr",children:"Herr"}),s.jsx(xe,{value:"Frau",children:"Frau"}),s.jsx(xe,{value:"Divers",children:"Divers"})]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"company_name",children:"Firmenname *"}),s.jsx(re,{id:"company_name",value:o.company_name,onChange:f=>u("company_name",f.target.value),required:!0})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"first_name",children:"Vorname"}),s.jsx(re,{id:"first_name",value:o.first_name,onChange:f=>u("first_name",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"last_name",children:"Nachname"}),s.jsx(re,{id:"last_name",value:o.last_name,onChange:f=>u("last_name",f.target.value)})]})]})]}),s.jsxs(We,{value:"kontaktdetails",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"email",children:"Emailadresse *"}),s.jsx(re,{id:"email",type:"email",value:o.email,onChange:f=>u("email",f.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"mobile",children:"Mobiltelefon"}),s.jsx(re,{id:"mobile",value:o.mobile,onChange:f=>u("mobile",f.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"erreichbarkeit",children:"Erreichbarkeit"}),s.jsx(Cn,{id:"erreichbarkeit",value:o.erreichbarkeit,onChange:f=>u("erreichbarkeit",f.target.value),rows:2})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"website",children:"Website"}),s.jsx(re,{id:"website",value:o.website,onChange:f=>u("website",f.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"sonstiges",children:"Sonstiges"}),s.jsxs(ut,{value:o.sonstiges,onValueChange:f=>u("sonstiges",f),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Sonstiges wählen"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Standard",children:"Standard"}),s.jsx(xe,{value:"VIP",children:"VIP"}),s.jsx(xe,{value:"Premium",children:"Premium"})]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"festnetz",children:"Festnetz"}),s.jsx(re,{id:"festnetz",value:o.festnetz,onChange:f=>u("festnetz",f.target.value)})]})]}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:s.jsxs("div",{children:[s.jsx(se,{htmlFor:"fax",children:"Fax"}),s.jsx(re,{id:"fax",value:o.fax,onChange:f=>u("fax",f.target.value)})]})})]}),s.jsxs(We,{value:"adresse",className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"address",children:"Straße & Hausnummer"}),s.jsx(re,{id:"address",value:o.address,onChange:f=>u("address",f.target.value)})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"postal_code",children:"Postleitzahl"}),s.jsx(re,{id:"postal_code",value:o.postal_code,onChange:f=>u("postal_code",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"city",children:"Ort"}),s.jsx(re,{id:"city",value:o.city,onChange:f=>u("city",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"country",children:"Land"}),s.jsx(re,{id:"country",value:o.country,onChange:f=>u("country",f.target.value)})]})]})]}),s.jsxs(We,{value:"konditionen",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"zahlungsziel",children:"Zahlungsziel (Tage)"}),s.jsx(re,{id:"zahlungsziel",value:o.zahlungsziel,onChange:f=>u("zahlungsziel",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"skonto",children:"Skonto %"}),s.jsx(re,{id:"skonto",value:o.skonto,onChange:f=>u("skonto",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"skontofrist",children:"Skontofrist (Tage)"}),s.jsx(re,{id:"skontofrist",value:o.skontofrist,onChange:f=>u("skontofrist",f.target.value)})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"verkaufspreise_gruppe",children:"Verkaufspreise-Gruppe"}),s.jsxs(ut,{value:o.verkaufspreise_gruppe,onValueChange:f=>u("verkaufspreise_gruppe",f),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Gruppe wählen"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Standard-VK",children:"Standard-VK"}),s.jsx(xe,{value:"Premium-VK",children:"Premium-VK"}),s.jsx(xe,{value:"Großkunden-VK",children:"Großkunden-VK"})]})]})]})]}),s.jsxs(We,{value:"zahlungsdaten",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"iban",children:"IBAN"}),s.jsx(re,{id:"iban",value:o.iban,onChange:f=>u("iban",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"bic",children:"BIC"}),s.jsx(re,{id:"bic",value:o.bic,onChange:f=>u("bic",f.target.value)})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"bank_name",children:"Bank Name"}),s.jsx(re,{id:"bank_name",value:o.bank_name,onChange:f=>u("bank_name",f.target.value)})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"umsatzsteuer_id",children:"Umsatzsteuer ID"}),s.jsx(re,{id:"umsatzsteuer_id",value:o.umsatzsteuer_id,onChange:f=>u("umsatzsteuer_id",f.target.value)})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"debitor_konto",children:"Debitor / Kreditor Konto"}),s.jsx(re,{id:"debitor_konto",value:o.debitor_konto,onChange:f=>u("debitor_konto",f.target.value)})]})]})]}),s.jsx(We,{value:"zugprd",className:"space-y-4",children:s.jsx("div",{className:"text-muted-foreground text-sm",children:"Diese Information ist erforderlich, um Rechnungen zu ZUGFeRD 2.0 Standard zu erstellen. Dieser Standard ist verpflichtend für die Rechnungsstellung an öffentliche Behörden/Auftraggeber."})})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(ne,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),s.jsxs(ne,{type:"button",variant:"destructive",onClick:m,disabled:i.isPending,className:"flex items-center gap-2",children:[s.jsx(Va,{className:"h-4 w-4"}),i.isPending?"Lösche...":"Löschen"]}),s.jsx(ne,{type:"submit",className:"flex-1",children:"Speichern"})]})]})]})}):null},VQ=()=>{const[t,e]=g.useState(""),[n,r]=g.useState(!1),[a,i]=g.useState(!1),[o,c]=g.useState(null),{data:d,isLoading:u,error:m}=f3(void 0,t.length>=2?{search:t}:void 0),f=QZ(),p=YZ(),v=(d==null?void 0:d.items)||[],w=[{id:"A2024-001",customer:"Müller GmbH",project:"Büroerweiterung",amount:"€12.500",status:"In Bearbeitung",date:"15.01.2024"},{id:"A2024-002",customer:"Schmidt AG",project:"Werkshalle Elektrik",amount:"€8.750",status:"Abgeschlossen",date:"10.01.2024"},{id:"A2024-003",customer:"Weber Bau",project:"Wohnanlage Phase 2",amount:"€28.900",status:"Angebot",date:"20.01.2024"}],x=C=>{switch(C){case"Aktiv":return"bg-green-100 text-green-800";case"Premium":return"bg-blue-100 text-blue-800";case"Inaktiv":return"bg-gray-100 text-gray-800";case"In Bearbeitung":return"bg-yellow-100 text-yellow-800";case"Abgeschlossen":return"bg-green-100 text-green-800";case"Angebot":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},y=async C=>{f.mutate(C)},j=C=>{c(C),i(!0)},b=async C=>{if(!o)return;const{id:P,created_at:R,updated_at:H,...I}=C;p.mutate({id:o.id,data:I})},N=C=>{alert(`Details für ${C.company_name}:

Kontakt: ${C.contact_person}
E-Mail: ${C.email}
Status: ${C.status}`)},S=t.length>=2?v:v.filter(C=>C.company_name.toLowerCase().includes(t.toLowerCase())||C.contact_person.toLowerCase().includes(t.toLowerCase())||C.email.toLowerCase().includes(t.toLowerCase())),E=C=>[C.address,C.postal_code,C.city,C.country].filter(Boolean).join(", ");return s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Kunden & Aufträge"}),s.jsxs(ne,{onClick:()=>r(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Neuer Kunde"]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Aktive Kunden"}),s.jsx("p",{className:"text-2xl font-bold",children:v.filter(C=>C.status==="Aktiv").length})]}),s.jsx(Br,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Premium Kunden"}),s.jsx("p",{className:"text-2xl font-bold",children:v.filter(C=>C.status==="Premium").length})]}),s.jsx(Pm,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Neue diesen Monat"}),s.jsx("p",{className:"text-2xl font-bold",children:"0"})]}),s.jsx(Ei,{className:"h-8 w-8 text-purple-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Gesamt Umsatz"}),s.jsx("p",{className:"text-2xl font-bold",children:"€0"})]}),s.jsx(mr,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})})]}),s.jsxs(es,{defaultValue:"customers",className:"space-y-6",children:[s.jsxs(Hn,{className:"grid w-full grid-cols-3",children:[s.jsx(He,{value:"customers",children:"Kundenstamm"}),s.jsx(He,{value:"orders",children:"Aufträge"}),s.jsx(He,{value:"offers",children:"Angebote"})]}),s.jsxs(We,{value:"customers",className:"space-y-4",children:[s.jsx(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(ec,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(re,{placeholder:"Kunde suchen...",value:t,onChange:C=>e(C.target.value),className:"pl-10 rounded-xl"})]}),s.jsx(ne,{variant:"outline",className:"rounded-xl",children:"Filter"})]})})}),u?s.jsx("div",{className:"grid gap-4",children:Array(3).fill(0).map((C,P)=>s.jsx(oe,{children:s.jsx(de,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(ft,{className:"h-5 w-32"}),s.jsx(ft,{className:"h-6 w-16"})]}),s.jsx(ft,{className:"h-4 w-24 mb-3"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx(ft,{className:"h-4 w-28"}),s.jsx(ft,{className:"h-4 w-36"}),s.jsx(ft,{className:"h-4 w-40"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ft,{className:"h-8 w-20"}),s.jsx(ft,{className:"h-8 w-24"})]})]})})},P))}):m?s.jsx(oe,{children:s.jsx(de,{className:"p-6 text-center",children:s.jsxs("p",{className:"text-red-500",children:["Fehler beim Laden der Kunden: ",m.message]})})}):s.jsx("div",{className:"grid gap-4",children:S.length===0?s.jsx(oe,{children:s.jsx(de,{className:"p-6 text-center",children:s.jsx("p",{className:"text-gray-500",children:t?"Keine Kunden gefunden.":"Noch keine Kunden vorhanden."})})}):S.map(C=>s.jsx(oe,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"text-base font-semibold",children:C.company_name}),s.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${x(C.status)}`,children:C.status})]}),s.jsx("p",{className:"text-gray-600 mb-3",children:C.contact_person}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zd,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{children:C.phone||"Nicht angegeben"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(os,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{children:C.email})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Mi,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{children:E(C)||"Nicht angegeben"})]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:"0"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Projekte"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-green-600",children:"€0"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Umsatz"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ne,{size:"sm",variant:"outline",className:"rounded-xl",onClick:P=>{P.preventDefault(),P.stopPropagation(),N(C)},children:"Details"}),s.jsx(ne,{size:"sm",className:"rounded-xl",onClick:()=>j(C),children:"Bearbeiten"})]})]})]})})},C.id))})]}),s.jsx(We,{value:"orders",className:"space-y-6",children:s.jsx("div",{className:"grid gap-4",children:w.map(C=>s.jsx(oe,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"text-base font-semibold",children:C.id}),s.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${x(C.status)}`,children:C.status})]}),s.jsx("p",{className:"text-gray-600 mb-1",children:C.customer}),s.jsx("p",{className:"text-sm text-gray-500",children:C.project})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xl font-bold text-green-600",children:C.amount}),s.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1",children:[s.jsx(At,{className:"h-4 w-4"}),C.date]}),s.jsx("div",{className:"flex gap-2 mt-2",children:s.jsxs(ne,{size:"sm",variant:"outline",className:"rounded-xl",children:[s.jsx(wn,{className:"h-4 w-4 mr-1"}),"Details"]})})]})]})})},C.id))})}),s.jsx(We,{value:"offers",className:"space-y-4",children:s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsxs(je,{className:"pb-2",children:[s.jsx(Ne,{children:"Angebote erstellen"}),s.jsx(vn,{children:"Neue Angebote für Ihre Kunden erstellen"})]}),s.jsxs(de,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"customer",children:"Kunde auswählen"}),s.jsx(re,{id:"customer",placeholder:"Kunde eingeben oder auswählen"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"project",children:"Projekt"}),s.jsx(re,{id:"project",placeholder:"Projektbezeichnung"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"amount",children:"Angebotssumme"}),s.jsx(re,{id:"amount",placeholder:"€ 0,00"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"deadline",children:"Gültig bis"}),s.jsx(re,{id:"deadline",type:"date"})]})]}),s.jsxs("div",{className:"flex gap-2 mt-6",children:[s.jsxs(ne,{className:"rounded-xl",children:[s.jsx(wn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),s.jsx(ne,{variant:"outline",className:"rounded-xl",children:"Vorlage laden"})]})]})]})})]}),s.jsx(HQ,{isOpen:n,onClose:()=>r(!1),onCustomerAdded:y}),s.jsx(WQ,{isOpen:a,onClose:()=>i(!1),customer:o,onCustomerUpdated:b})]})};var _1="Checkbox",[KQ,Mae]=kr(_1),[ZQ,GQ]=KQ(_1),TR=g.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:a,defaultChecked:i,required:o,disabled:c,value:d="on",onCheckedChange:u,form:m,...f}=t,[p,v]=g.useState(null),w=Rt(e,S=>v(S)),x=g.useRef(!1),y=p?m||!!p.closest("form"):!0,[j=!1,b]=qr({prop:a,defaultProp:i,onChange:u}),N=g.useRef(j);return g.useEffect(()=>{const S=p==null?void 0:p.form;if(S){const E=()=>b(N.current);return S.addEventListener("reset",E),()=>S.removeEventListener("reset",E)}},[p,b]),s.jsxs(ZQ,{scope:n,state:j,disabled:c,children:[s.jsx(tt.button,{type:"button",role:"checkbox","aria-checked":Co(j)?"mixed":j,"aria-required":o,"data-state":IR(j),"data-disabled":c?"":void 0,disabled:c,value:d,...f,ref:w,onKeyDown:Oe(t.onKeyDown,S=>{S.key==="Enter"&&S.preventDefault()}),onClick:Oe(t.onClick,S=>{b(E=>Co(E)?!0:!E),y&&(x.current=S.isPropagationStopped(),x.current||S.stopPropagation())})}),y&&s.jsx(QQ,{control:p,bubbles:!x.current,name:r,value:d,checked:j,required:o,disabled:c,form:m,style:{transform:"translateX(-100%)"},defaultChecked:Co(i)?!1:i})]})});TR.displayName=_1;var MR="CheckboxIndicator",RR=g.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...a}=t,i=GQ(MR,n);return s.jsx(ts,{present:r||Co(i.state)||i.state===!0,children:s.jsx(tt.span,{"data-state":IR(i.state),"data-disabled":i.disabled?"":void 0,...a,ref:e,style:{pointerEvents:"none",...t.style}})})});RR.displayName=MR;var QQ=t=>{const{control:e,checked:n,bubbles:r=!0,defaultChecked:a,...i}=t,o=g.useRef(null),c=Z3(n),d=FP(e);g.useEffect(()=>{const m=o.current,f=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(f,"checked").set;if(c!==n&&v){const w=new Event("click",{bubbles:r});m.indeterminate=Co(n),v.call(m,Co(n)?!1:n),m.dispatchEvent(w)}},[c,n,r]);const u=g.useRef(Co(n)?!1:n);return s.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??u.current,...i,tabIndex:-1,ref:o,style:{...t.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Co(t){return t==="indeterminate"}function IR(t){return Co(t)?"indeterminate":t?"checked":"unchecked"}var OR=TR,YQ=RR;const Js=g.forwardRef(({className:t,...e},n)=>s.jsx(OR,{ref:n,className:Ie("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:s.jsx(YQ,{className:Ie("flex items-center justify-center text-current"),children:s.jsx(Em,{className:"h-4 w-4"})})}));Js.displayName=OR.displayName;var w1="Popover",[LR,Rae]=kr(w1,[Ho]),Hm=Ho(),[XQ,Go]=LR(w1),FR=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:a,onOpenChange:i,modal:o=!1}=t,c=Hm(e),d=g.useRef(null),[u,m]=g.useState(!1),[f=!1,p]=qr({prop:r,defaultProp:a,onChange:i});return s.jsx(gj,{...c,children:s.jsx(XQ,{scope:e,contentId:pr(),triggerRef:d,open:f,onOpenChange:p,onOpenToggle:g.useCallback(()=>p(v=>!v),[p]),hasCustomAnchor:u,onCustomAnchorAdd:g.useCallback(()=>m(!0),[]),onCustomAnchorRemove:g.useCallback(()=>m(!1),[]),modal:o,children:n})})};FR.displayName=w1;var BR="PopoverAnchor",JQ=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,a=Go(BR,n),i=Hm(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:c}=a;return g.useEffect(()=>(o(),()=>c()),[o,c]),s.jsx(Tm,{...i,...r,ref:e})});JQ.displayName=BR;var zR="PopoverTrigger",$R=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,a=Go(zR,n),i=Hm(n),o=Rt(e,a.triggerRef),c=s.jsx(tt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":VR(a.open),...r,ref:o,onClick:Oe(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?c:s.jsx(Tm,{asChild:!0,...i,children:c})});$R.displayName=zR;var b1="PopoverPortal",[eY,tY]=LR(b1,{forceMount:void 0}),UR=t=>{const{__scopePopover:e,forceMount:n,children:r,container:a}=t,i=Go(b1,e);return s.jsx(eY,{scope:e,forceMount:n,children:s.jsx(ts,{present:n||i.open,children:s.jsx(Vd,{asChild:!0,container:a,children:r})})})};UR.displayName=b1;var zd="PopoverContent",qR=g.forwardRef((t,e)=>{const n=tY(zd,t.__scopePopover),{forceMount:r=n.forceMount,...a}=t,i=Go(zd,t.__scopePopover);return s.jsx(ts,{present:r||i.open,children:i.modal?s.jsx(nY,{...a,ref:e}):s.jsx(sY,{...a,ref:e})})});qR.displayName=zd;var nY=g.forwardRef((t,e)=>{const n=Go(zd,t.__scopePopover),r=g.useRef(null),a=Rt(e,r),i=g.useRef(!1);return g.useEffect(()=>{const o=r.current;if(o)return ex(o)},[]),s.jsx(Um,{as:Ci,allowPinchZoom:!0,children:s.jsx(HR,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Oe(t.onCloseAutoFocus,o=>{var c;o.preventDefault(),i.current||(c=n.triggerRef.current)==null||c.focus()}),onPointerDownOutside:Oe(t.onPointerDownOutside,o=>{const c=o.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,u=c.button===2||d;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:Oe(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),sY=g.forwardRef((t,e)=>{const n=Go(zd,t.__scopePopover),r=g.useRef(!1),a=g.useRef(!1);return s.jsx(HR,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,c;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(c=n.triggerRef.current)==null||c.focus(),i.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:i=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),HR=g.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:m,...f}=t,p=Go(zd,n),v=Hm(n);return Xg(),s.jsx($m,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:i,children:s.jsx(Jl,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:m,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:u,onDismiss:()=>p.onOpenChange(!1),children:s.jsx(Sg,{"data-state":VR(p.open),role:"dialog",id:p.contentId,...v,...f,ref:e,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),WR="PopoverClose",rY=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,a=Go(WR,n);return s.jsx(tt.button,{type:"button",...r,ref:e,onClick:Oe(t.onClick,()=>a.onOpenChange(!1))})});rY.displayName=WR;var aY="PopoverArrow",iY=g.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,a=Hm(n);return s.jsx(kg,{...a,...r,ref:e})});iY.displayName=aY;function VR(t){return t?"open":"closed"}var oY=FR,lY=$R,cY=UR,KR=qR;const Za=oY,Ga=lY,fa=g.forwardRef(({className:t,align:e="center",sideOffset:n=4,...r},a)=>s.jsx(cY,{children:s.jsx(KR,{ref:a,align:e,sideOffset:n,className:Ie("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));fa.displayName=KR.displayName;function $t(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function wr(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function vs(t,e){const n=$t(t);return isNaN(e)?wr(t,NaN):(e&&n.setDate(n.getDate()+e),n)}function br(t,e){const n=$t(t);if(isNaN(e))return wr(t,NaN);if(!e)return n;const r=n.getDate(),a=wr(t,n.getTime());a.setMonth(n.getMonth()+e+1,0);const i=a.getDate();return r>=i?a:(n.setFullYear(a.getFullYear(),a.getMonth(),r),n)}const j1=6048e5,dY=864e5,N1=6e4,ZR=36e5;let uY={};function Wm(){return uY}function Wr(t,e){var c,d,u,m;const n=Wm(),r=(e==null?void 0:e.weekStartsOn)??((d=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??n.weekStartsOn??((m=(u=n.locale)==null?void 0:u.options)==null?void 0:m.weekStartsOn)??0,a=$t(t),i=a.getDay(),o=(i<r?7:0)+i-r;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function Gl(t){return Wr(t,{weekStartsOn:1})}function GR(t){const e=$t(t),n=e.getFullYear(),r=wr(t,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const a=Gl(r),i=wr(t,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const o=Gl(i);return e.getTime()>=a.getTime()?n+1:e.getTime()>=o.getTime()?n:n-1}function Bo(t){const e=$t(t);return e.setHours(0,0,0,0),e}function $0(t){const e=$t(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function Ua(t,e){const n=Bo(t),r=Bo(e),a=+n-$0(n),i=+r-$0(r);return Math.round((a-i)/dY)}function hY(t){const e=GR(t),n=wr(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),Gl(n)}function cm(t,e){const n=e*7;return vs(t,n)}function mY(t,e){return br(t,e*12)}function fY(t){let e;return t.forEach(function(n){const r=$t(n);(e===void 0||e<r||isNaN(Number(r)))&&(e=r)}),e||new Date(NaN)}function pY(t){let e;return t.forEach(n=>{const r=$t(n);(!e||e>r||isNaN(+r))&&(e=r)}),e||new Date(NaN)}function ys(t,e){const n=Bo(t),r=Bo(e);return+n==+r}function S1(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function gY(t){if(!S1(t)&&typeof t!="number")return!1;const e=$t(t);return!isNaN(Number(e))}function dm(t,e){const n=$t(t),r=$t(e),a=n.getFullYear()-r.getFullYear(),i=n.getMonth()-r.getMonth();return a*12+i}function xY(t,e,n){const r=Wr(t,n),a=Wr(e,n),i=+r-$0(r),o=+a-$0(a);return Math.round((i-o)/j1)}function vY(t){return e=>{const r=(t?Math[t]:Math.trunc)(e);return r===0?0:r}}function yY(t,e){return+$t(t)-+$t(e)}function um(t,e,n){const r=yY(t,e)/N1;return vY(n==null?void 0:n.roundingMethod)(r)}function QR(t){const e=$t(t);return e.setHours(23,59,59,999),e}function Vm(t){const e=$t(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function _Y(t,e){const n=$t(t.start),r=$t(t.end);let a=+n>+r;const i=a?+n:+r,o=a?r:n;o.setHours(0,0,0,0);let c=1;const d=[];for(;+o<=i;)d.push($t(o)),o.setDate(o.getDate()+c),o.setHours(0,0,0,0);return a?d.reverse():d}function As(t){const e=$t(t);return e.setDate(1),e.setHours(0,0,0,0),e}function YR(t){const e=$t(t),n=wr(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}function Km(t,e){var c,d,u,m;const n=Wm(),r=(e==null?void 0:e.weekStartsOn)??((d=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??n.weekStartsOn??((m=(u=n.locale)==null?void 0:u.options)==null?void 0:m.weekStartsOn)??0,a=$t(t),i=a.getDay(),o=(i<r?-7:0)+6-(i-r);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}function XR(t){return Km(t,{weekStartsOn:1})}const wY={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},bY=(t,e,n)=>{let r;const a=wY[t];return typeof a=="string"?r=a:e===1?r=a.one:r=a.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function hd(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const jY={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},NY={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},SY={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},kY={date:hd({formats:jY,defaultWidth:"full"}),time:hd({formats:NY,defaultWidth:"full"}),dateTime:hd({formats:SY,defaultWidth:"full"})},CY={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},EY=(t,e,n,r)=>CY[t];function Ba(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let a;if(r==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,c=n!=null&&n.width?String(n.width):o;a=t.formattingValues[c]||t.formattingValues[o]}else{const o=t.defaultWidth,c=n!=null&&n.width?String(n.width):t.defaultWidth;a=t.values[c]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return a[i]}}const AY={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},PY={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},DY={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},TY={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},MY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},RY={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},IY=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},OY={ordinalNumber:IY,era:Ba({values:AY,defaultWidth:"wide"}),quarter:Ba({values:PY,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ba({values:DY,defaultWidth:"wide"}),day:Ba({values:TY,defaultWidth:"wide"}),dayPeriod:Ba({values:MY,defaultWidth:"wide",formattingValues:RY,defaultFormattingWidth:"wide"})};function za(t){return(e,n={})=>{const r=n.width,a=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(a);if(!i)return null;const o=i[0],c=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],d=Array.isArray(c)?FY(c,f=>f.test(o)):LY(c,f=>f.test(o));let u;u=t.valueCallback?t.valueCallback(d):d,u=n.valueCallback?n.valueCallback(u):u;const m=e.slice(o.length);return{value:u,rest:m}}}function LY(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function FY(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function JR(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const a=r[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const c=e.slice(a.length);return{value:o,rest:c}}}const BY=/^(\d+)(th|st|nd|rd)?/i,zY=/\d+/i,$Y={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},UY={any:[/^b/i,/^(a|c)/i]},qY={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},HY={any:[/1/i,/2/i,/3/i,/4/i]},WY={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},VY={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},KY={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ZY={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},GY={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},QY={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},YY={ordinalNumber:JR({matchPattern:BY,parsePattern:zY,valueCallback:t=>parseInt(t,10)}),era:za({matchPatterns:$Y,defaultMatchWidth:"wide",parsePatterns:UY,defaultParseWidth:"any"}),quarter:za({matchPatterns:qY,defaultMatchWidth:"wide",parsePatterns:HY,defaultParseWidth:"any",valueCallback:t=>t+1}),month:za({matchPatterns:WY,defaultMatchWidth:"wide",parsePatterns:VY,defaultParseWidth:"any"}),day:za({matchPatterns:KY,defaultMatchWidth:"wide",parsePatterns:ZY,defaultParseWidth:"any"}),dayPeriod:za({matchPatterns:GY,defaultMatchWidth:"any",parsePatterns:QY,defaultParseWidth:"any"})},eI={code:"en-US",formatDistance:bY,formatLong:kY,formatRelative:EY,localize:OY,match:YY,options:{weekStartsOn:0,firstWeekContainsDate:1}};function XY(t){const e=$t(t);return Ua(e,YR(e))+1}function tI(t){const e=$t(t),n=+Gl(e)-+hY(e);return Math.round(n/j1)+1}function nI(t,e){var m,f,p,v;const n=$t(t),r=n.getFullYear(),a=Wm(),i=(e==null?void 0:e.firstWeekContainsDate)??((f=(m=e==null?void 0:e.locale)==null?void 0:m.options)==null?void 0:f.firstWeekContainsDate)??a.firstWeekContainsDate??((v=(p=a.locale)==null?void 0:p.options)==null?void 0:v.firstWeekContainsDate)??1,o=wr(t,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const c=Wr(o,e),d=wr(t,0);d.setFullYear(r,0,i),d.setHours(0,0,0,0);const u=Wr(d,e);return n.getTime()>=c.getTime()?r+1:n.getTime()>=u.getTime()?r:r-1}function JY(t,e){var c,d,u,m;const n=Wm(),r=(e==null?void 0:e.firstWeekContainsDate)??((d=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(u=n.locale)==null?void 0:u.options)==null?void 0:m.firstWeekContainsDate)??1,a=nI(t,e),i=wr(t,0);return i.setFullYear(a,0,r),i.setHours(0,0,0,0),Wr(i,e)}function sI(t,e){const n=$t(t),r=+Wr(n,e)-+JY(n,e);return Math.round(r/j1)+1}function on(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const qi={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return on(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):on(n+1,2)},d(t,e){return on(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return on(t.getHours()%12||12,e.length)},H(t,e){return on(t.getHours(),e.length)},m(t,e){return on(t.getMinutes(),e.length)},s(t,e){return on(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),a=Math.trunc(r*Math.pow(10,n-3));return on(a,e.length)}},Dc={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},$C={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return qi.y(t,e)},Y:function(t,e,n,r){const a=nI(t,r),i=a>0?a:1-a;if(e==="YY"){const o=i%100;return on(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):on(i,e.length)},R:function(t,e){const n=GR(t);return on(n,e.length)},u:function(t,e){const n=t.getFullYear();return on(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return on(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return on(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return qi.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return on(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const a=sI(t,r);return e==="wo"?n.ordinalNumber(a,{unit:"week"}):on(a,e.length)},I:function(t,e,n){const r=tI(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):on(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):qi.d(t,e)},D:function(t,e,n){const r=XY(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):on(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const a=t.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return on(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const a=t.getDay(),i=(a-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return on(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),a=r===0?7:r;switch(e){case"i":return String(a);case"ii":return on(a,e.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let a;switch(r===12?a=Dc.noon:r===0?a=Dc.midnight:a=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let a;switch(r>=17?a=Dc.evening:r>=12?a=Dc.afternoon:r>=4?a=Dc.morning:a=Dc.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return qi.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):qi.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):on(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):on(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):qi.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):qi.s(t,e)},S:function(t,e){return qi.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return qC(r);case"XXXX":case"XX":return ll(r);case"XXXXX":case"XXX":default:return ll(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return qC(r);case"xxxx":case"xx":return ll(r);case"xxxxx":case"xxx":default:return ll(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+UC(r,":");case"OOOO":default:return"GMT"+ll(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+UC(r,":");case"zzzz":default:return"GMT"+ll(r,":")}},t:function(t,e,n){const r=Math.trunc(t.getTime()/1e3);return on(r,e.length)},T:function(t,e,n){const r=t.getTime();return on(r,e.length)}};function UC(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),a=Math.trunc(r/60),i=r%60;return i===0?n+String(a):n+String(a)+e+on(i,2)}function qC(t,e){return t%60===0?(t>0?"-":"+")+on(Math.abs(t)/60,2):ll(t,e)}function ll(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),a=on(Math.trunc(r/60),2),i=on(r%60,2);return n+a+e+i}const HC=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},rI=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},eX=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return HC(t,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",HC(r,e)).replace("{{time}}",rI(a,e))},tX={p:rI,P:eX},nX=/^D+$/,sX=/^Y+$/,rX=["D","DD","YY","YYYY"];function aX(t){return nX.test(t)}function iX(t){return sX.test(t)}function oX(t,e,n){const r=lX(t,e,n);if(console.warn(r),rX.includes(t))throw new RangeError(r)}function lX(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const cX=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,dX=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,uX=/^'([^]*?)'?$/,hX=/''/g,mX=/[a-zA-Z]/;function De(t,e,n){var m,f,p,v,w,x,y,j;const r=Wm(),a=(n==null?void 0:n.locale)??r.locale??eI,i=(n==null?void 0:n.firstWeekContainsDate)??((f=(m=n==null?void 0:n.locale)==null?void 0:m.options)==null?void 0:f.firstWeekContainsDate)??r.firstWeekContainsDate??((v=(p=r.locale)==null?void 0:p.options)==null?void 0:v.firstWeekContainsDate)??1,o=(n==null?void 0:n.weekStartsOn)??((x=(w=n==null?void 0:n.locale)==null?void 0:w.options)==null?void 0:x.weekStartsOn)??r.weekStartsOn??((j=(y=r.locale)==null?void 0:y.options)==null?void 0:j.weekStartsOn)??0,c=$t(t);if(!gY(c))throw new RangeError("Invalid time value");let d=e.match(dX).map(b=>{const N=b[0];if(N==="p"||N==="P"){const S=tX[N];return S(b,a.formatLong)}return b}).join("").match(cX).map(b=>{if(b==="''")return{isToken:!1,value:"'"};const N=b[0];if(N==="'")return{isToken:!1,value:fX(b)};if($C[N])return{isToken:!0,value:b};if(N.match(mX))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:b}});a.localize.preprocessor&&(d=a.localize.preprocessor(c,d));const u={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return d.map(b=>{if(!b.isToken)return b.value;const N=b.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&iX(N)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&aX(N))&&oX(N,e,String(t));const S=$C[N[0]];return S(c,N,a.localize,u)}).join("")}function fX(t){const e=t.match(uX);return e?e[1].replace(hX,"'"):t}function pX(t){const e=$t(t),n=e.getFullYear(),r=e.getMonth(),a=wr(t,0);return a.setFullYear(n,r+1,0),a.setHours(0,0,0,0),a.getDate()}function gX(t){return Math.trunc(+$t(t)/1e3)}function xX(t){const e=$t(t),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(0,0,0,0),e}function vX(t,e){return xY(xX(t),As(t),e)+1}function Xw(t,e){const n=$t(t),r=$t(e);return n.getTime()>r.getTime()}function aI(t,e){const n=$t(t),r=$t(e);return+n<+r}function k1(t,e){const n=$t(t),r=$t(e);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function yX(t,e){const n=$t(t),r=$t(e);return n.getFullYear()===r.getFullYear()}function Py(t,e){return vs(t,-e)}function ed(t,e){const r=jX(t);let a;if(r.date){const d=NX(r.date,2);a=SX(d.restDateString,d.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let o=0,c;if(r.time&&(o=kX(r.time),isNaN(o)))return new Date(NaN);if(r.timezone){if(c=CX(r.timezone),isNaN(c))return new Date(NaN)}else{const d=new Date(i+o),u=new Date(0);return u.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),u.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),u}return new Date(i+o+c)}const op={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},_X=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,wX=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,bX=/^([+-])(\d{2})(?::?(\d{2}))?$/;function jX(t){const e={},n=t.split(op.dateTimeDelimiter);let r;if(n.length>2)return e;if(/:/.test(n[0])?r=n[0]:(e.date=n[0],r=n[1],op.timeZoneDelimiter.test(e.date)&&(e.date=t.split(op.timeZoneDelimiter)[0],r=t.substr(e.date.length,t.length))),r){const a=op.timezone.exec(r);a?(e.time=r.replace(a[1],""),e.timezone=a[1]):e.time=r}return e}function NX(t,e){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=t.match(n);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?a:i*100,restDateString:t.slice((r[1]||r[2]).length)}}function SX(t,e){if(e===null)return new Date(NaN);const n=t.match(_X);if(!n)return new Date(NaN);const r=!!n[4],a=Mu(n[1]),i=Mu(n[2])-1,o=Mu(n[3]),c=Mu(n[4]),d=Mu(n[5])-1;if(r)return TX(e,c,d)?EX(e,c,d):new Date(NaN);{const u=new Date(0);return!PX(e,i,o)||!DX(e,a)?new Date(NaN):(u.setUTCFullYear(e,i,Math.max(a,o)),u)}}function Mu(t){return t?parseInt(t):1}function kX(t){const e=t.match(wX);if(!e)return NaN;const n=Dy(e[1]),r=Dy(e[2]),a=Dy(e[3]);return MX(n,r,a)?n*ZR+r*N1+a*1e3:NaN}function Dy(t){return t&&parseFloat(t.replace(",","."))||0}function CX(t){if(t==="Z")return 0;const e=t.match(bX);if(!e)return 0;const n=e[1]==="+"?-1:1,r=parseInt(e[2]),a=e[3]&&parseInt(e[3])||0;return RX(r,a)?n*(r*ZR+a*N1):NaN}function EX(t,e,n){const r=new Date(0);r.setUTCFullYear(t,0,4);const a=r.getUTCDay()||7,i=(e-1)*7+n+1-a;return r.setUTCDate(r.getUTCDate()+i),r}const AX=[31,null,31,30,31,30,31,31,30,31,30,31];function iI(t){return t%400===0||t%4===0&&t%100!==0}function PX(t,e,n){return e>=0&&e<=11&&n>=1&&n<=(AX[e]||(iI(t)?29:28))}function DX(t,e){return e>=1&&e<=(iI(t)?366:365)}function TX(t,e,n){return e>=1&&e<=53&&n>=0&&n<=6}function MX(t,e,n){return t===24?e===0&&n===0:n>=0&&n<60&&e>=0&&e<60&&t>=0&&t<25}function RX(t,e){return e>=0&&e<=59}function Ty(t,e){const n=$t(t),r=n.getFullYear(),a=n.getDate(),i=wr(t,0);i.setFullYear(r,e,15),i.setHours(0,0,0,0);const o=pX(i);return n.setMonth(e,Math.min(a,o)),n}function WC(t,e){const n=$t(t);return isNaN(+n)?wr(t,NaN):(n.setFullYear(e),n)}function IX(t,e){return br(t,-e)}function OX(t,e){return cm(t,-e)}const VC={lessThanXSeconds:{standalone:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"},withPreposition:{one:"weniger als 1 Sekunde",other:"weniger als {{count}} Sekunden"}},xSeconds:{standalone:{one:"1 Sekunde",other:"{{count}} Sekunden"},withPreposition:{one:"1 Sekunde",other:"{{count}} Sekunden"}},halfAMinute:{standalone:"eine halbe Minute",withPreposition:"einer halben Minute"},lessThanXMinutes:{standalone:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"},withPreposition:{one:"weniger als 1 Minute",other:"weniger als {{count}} Minuten"}},xMinutes:{standalone:{one:"1 Minute",other:"{{count}} Minuten"},withPreposition:{one:"1 Minute",other:"{{count}} Minuten"}},aboutXHours:{standalone:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"},withPreposition:{one:"etwa 1 Stunde",other:"etwa {{count}} Stunden"}},xHours:{standalone:{one:"1 Stunde",other:"{{count}} Stunden"},withPreposition:{one:"1 Stunde",other:"{{count}} Stunden"}},xDays:{standalone:{one:"1 Tag",other:"{{count}} Tage"},withPreposition:{one:"1 Tag",other:"{{count}} Tagen"}},aboutXWeeks:{standalone:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"},withPreposition:{one:"etwa 1 Woche",other:"etwa {{count}} Wochen"}},xWeeks:{standalone:{one:"1 Woche",other:"{{count}} Wochen"},withPreposition:{one:"1 Woche",other:"{{count}} Wochen"}},aboutXMonths:{standalone:{one:"etwa 1 Monat",other:"etwa {{count}} Monate"},withPreposition:{one:"etwa 1 Monat",other:"etwa {{count}} Monaten"}},xMonths:{standalone:{one:"1 Monat",other:"{{count}} Monate"},withPreposition:{one:"1 Monat",other:"{{count}} Monaten"}},aboutXYears:{standalone:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahre"},withPreposition:{one:"etwa 1 Jahr",other:"etwa {{count}} Jahren"}},xYears:{standalone:{one:"1 Jahr",other:"{{count}} Jahre"},withPreposition:{one:"1 Jahr",other:"{{count}} Jahren"}},overXYears:{standalone:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahre"},withPreposition:{one:"mehr als 1 Jahr",other:"mehr als {{count}} Jahren"}},almostXYears:{standalone:{one:"fast 1 Jahr",other:"fast {{count}} Jahre"},withPreposition:{one:"fast 1 Jahr",other:"fast {{count}} Jahren"}}},LX=(t,e,n)=>{let r;const a=n!=null&&n.addSuffix?VC[t].withPreposition:VC[t].standalone;return typeof a=="string"?r=a:e===1?r=a.one:r=a.other.replace("{{count}}",String(e)),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:"vor "+r:r},FX={full:"EEEE, do MMMM y",long:"do MMMM y",medium:"do MMM y",short:"dd.MM.y"},BX={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},zX={full:"{{date}} 'um' {{time}}",long:"{{date}} 'um' {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},$X={date:hd({formats:FX,defaultWidth:"full"}),time:hd({formats:BX,defaultWidth:"full"}),dateTime:hd({formats:zX,defaultWidth:"full"})},UX={lastWeek:"'letzten' eeee 'um' p",yesterday:"'gestern um' p",today:"'heute um' p",tomorrow:"'morgen um' p",nextWeek:"eeee 'um' p",other:"P"},qX=(t,e,n,r)=>UX[t],HX={narrow:["v.Chr.","n.Chr."],abbreviated:["v.Chr.","n.Chr."],wide:["vor Christus","nach Christus"]},WX={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1. Quartal","2. Quartal","3. Quartal","4. Quartal"]},Jw={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],wide:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"]},VX={narrow:Jw.narrow,abbreviated:["Jan.","Feb.","März","Apr.","Mai","Juni","Juli","Aug.","Sep.","Okt.","Nov.","Dez."],wide:Jw.wide},KX={narrow:["S","M","D","M","D","F","S"],short:["So","Mo","Di","Mi","Do","Fr","Sa"],abbreviated:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],wide:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"]},ZX={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachm.",evening:"Abend",night:"Nacht"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"Morgen",afternoon:"Nachmittag",evening:"Abend",night:"Nacht"}},GX={narrow:{am:"vm.",pm:"nm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachm.",evening:"abends",night:"nachts"},abbreviated:{am:"vorm.",pm:"nachm.",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"},wide:{am:"vormittags",pm:"nachmittags",midnight:"Mitternacht",noon:"Mittag",morning:"morgens",afternoon:"nachmittags",evening:"abends",night:"nachts"}},QX=t=>Number(t)+".",YX={ordinalNumber:QX,era:Ba({values:HX,defaultWidth:"wide"}),quarter:Ba({values:WX,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ba({values:Jw,formattingValues:VX,defaultWidth:"wide"}),day:Ba({values:KX,defaultWidth:"wide"}),dayPeriod:Ba({values:ZX,defaultWidth:"wide",formattingValues:GX,defaultFormattingWidth:"wide"})},XX=/^(\d+)(\.)?/i,JX=/\d+/i,eJ={narrow:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,abbreviated:/^(v\.? ?Chr\.?|n\.? ?Chr\.?)/i,wide:/^(vor Christus|vor unserer Zeitrechnung|nach Christus|unserer Zeitrechnung)/i},tJ={any:[/^v/i,/^n/i]},nJ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](\.)? Quartal/i},sJ={any:[/1/i,/2/i,/3/i,/4/i]},rJ={narrow:/^[jfmasond]/i,abbreviated:/^(j[aä]n|feb|mär[z]?|apr|mai|jun[i]?|jul[i]?|aug|sep|okt|nov|dez)\.?/i,wide:/^(januar|februar|märz|april|mai|juni|juli|august|september|oktober|november|dezember)/i},aJ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^j[aä]/i,/^f/i,/^mär/i,/^ap/i,/^mai/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},iJ={narrow:/^[smdmf]/i,short:/^(so|mo|di|mi|do|fr|sa)/i,abbreviated:/^(son?|mon?|die?|mit?|don?|fre?|sam?)\.?/i,wide:/^(sonntag|montag|dienstag|mittwoch|donnerstag|freitag|samstag)/i},oJ={any:[/^so/i,/^mo/i,/^di/i,/^mi/i,/^do/i,/^f/i,/^sa/i]},lJ={narrow:/^(vm\.?|nm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,abbreviated:/^(vorm\.?|nachm\.?|Mitternacht|Mittag|morgens|nachm\.?|abends|nachts)/i,wide:/^(vormittags|nachmittags|Mitternacht|Mittag|morgens|nachmittags|abends|nachts)/i},cJ={any:{am:/^v/i,pm:/^n/i,midnight:/^Mitte/i,noon:/^Mitta/i,morning:/morgens/i,afternoon:/nachmittags/i,evening:/abends/i,night:/nachts/i}},dJ={ordinalNumber:JR({matchPattern:XX,parsePattern:JX,valueCallback:t=>parseInt(t)}),era:za({matchPatterns:eJ,defaultMatchWidth:"wide",parsePatterns:tJ,defaultParseWidth:"any"}),quarter:za({matchPatterns:nJ,defaultMatchWidth:"wide",parsePatterns:sJ,defaultParseWidth:"any",valueCallback:t=>t+1}),month:za({matchPatterns:rJ,defaultMatchWidth:"wide",parsePatterns:aJ,defaultParseWidth:"any"}),day:za({matchPatterns:iJ,defaultMatchWidth:"wide",parsePatterns:oJ,defaultParseWidth:"any"}),dayPeriod:za({matchPatterns:lJ,defaultMatchWidth:"wide",parsePatterns:cJ,defaultParseWidth:"any"})},zt={code:"de",formatDistance:LX,formatLong:$X,formatRelative:qX,localize:YX,match:dJ,options:{weekStartsOn:1,firstWeekContainsDate:4}};var St=function(){return St=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},St.apply(this,arguments)};function uJ(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}function oI(t,e,n){for(var r=0,a=e.length,i;r<a;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}function Zm(t){return t.mode==="multiple"}function Gm(t){return t.mode==="range"}function lx(t){return t.mode==="single"}var hJ={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function mJ(t,e){return De(t,"LLLL y",e)}function fJ(t,e){return De(t,"d",e)}function pJ(t,e){return De(t,"LLLL",e)}function gJ(t){return"".concat(t)}function xJ(t,e){return De(t,"cccccc",e)}function vJ(t,e){return De(t,"yyyy",e)}var yJ=Object.freeze({__proto__:null,formatCaption:mJ,formatDay:fJ,formatMonthCaption:pJ,formatWeekNumber:gJ,formatWeekdayName:xJ,formatYearCaption:vJ}),_J=function(t,e,n){return De(t,"do MMMM (EEEE)",n)},wJ=function(){return"Month: "},bJ=function(){return"Go to next month"},jJ=function(){return"Go to previous month"},NJ=function(t,e){return De(t,"cccc",e)},SJ=function(t){return"Week n. ".concat(t)},kJ=function(){return"Year: "},CJ=Object.freeze({__proto__:null,labelDay:_J,labelMonthDropdown:wJ,labelNext:bJ,labelPrevious:jJ,labelWeekNumber:SJ,labelWeekday:NJ,labelYearDropdown:kJ});function EJ(){var t="buttons",e=hJ,n=eI,r={},a={},i=1,o={},c=new Date;return{captionLayout:t,classNames:e,formatters:yJ,labels:CJ,locale:n,modifiersClassNames:r,modifiers:a,numberOfMonths:i,styles:o,today:c,mode:"default"}}function AJ(t){var e=t.fromYear,n=t.toYear,r=t.fromMonth,a=t.toMonth,i=t.fromDate,o=t.toDate;return r?i=As(r):e&&(i=new Date(e,0,1)),a?o=Vm(a):n&&(o=new Date(n,11,31)),{fromDate:i?Bo(i):void 0,toDate:o?Bo(o):void 0}}var lI=g.createContext(void 0);function PJ(t){var e,n=t.initialProps,r=EJ(),a=AJ(n),i=a.fromDate,o=a.toDate,c=(e=n.captionLayout)!==null&&e!==void 0?e:r.captionLayout;c!=="buttons"&&(!i||!o)&&(c="buttons");var d;(lx(n)||Zm(n)||Gm(n))&&(d=n.onSelect);var u=St(St(St({},r),n),{captionLayout:c,classNames:St(St({},r.classNames),n.classNames),components:St({},n.components),formatters:St(St({},r.formatters),n.formatters),fromDate:i,labels:St(St({},r.labels),n.labels),mode:n.mode||r.mode,modifiers:St(St({},r.modifiers),n.modifiers),modifiersClassNames:St(St({},r.modifiersClassNames),n.modifiersClassNames),onSelect:d,styles:St(St({},r.styles),n.styles),toDate:o});return s.jsx(lI.Provider,{value:u,children:t.children})}function fn(){var t=g.useContext(lI);if(!t)throw new Error("useDayPicker must be used within a DayPickerProvider.");return t}function cI(t){var e=fn(),n=e.locale,r=e.classNames,a=e.styles,i=e.formatters.formatCaption;return s.jsx("div",{className:r.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:t.id,children:i(t.displayMonth,{locale:n})})}function DJ(t){return s.jsx("svg",St({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},t,{children:s.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function dI(t){var e,n,r=t.onChange,a=t.value,i=t.children,o=t.caption,c=t.className,d=t.style,u=fn(),m=(n=(e=u.components)===null||e===void 0?void 0:e.IconDropdown)!==null&&n!==void 0?n:DJ;return s.jsxs("div",{className:c,style:d,children:[s.jsx("span",{className:u.classNames.vhidden,children:t["aria-label"]}),s.jsx("select",{name:t.name,"aria-label":t["aria-label"],className:u.classNames.dropdown,style:u.styles.dropdown,value:a,onChange:r,children:i}),s.jsxs("div",{className:u.classNames.caption_label,style:u.styles.caption_label,"aria-hidden":"true",children:[o,s.jsx(m,{className:u.classNames.dropdown_icon,style:u.styles.dropdown_icon})]})]})}function TJ(t){var e,n=fn(),r=n.fromDate,a=n.toDate,i=n.styles,o=n.locale,c=n.formatters.formatMonthCaption,d=n.classNames,u=n.components,m=n.labels.labelMonthDropdown;if(!r)return s.jsx(s.Fragment,{});if(!a)return s.jsx(s.Fragment,{});var f=[];if(yX(r,a))for(var p=As(r),v=r.getMonth();v<=a.getMonth();v++)f.push(Ty(p,v));else for(var p=As(new Date),v=0;v<=11;v++)f.push(Ty(p,v));var w=function(y){var j=Number(y.target.value),b=Ty(As(t.displayMonth),j);t.onChange(b)},x=(e=u==null?void 0:u.Dropdown)!==null&&e!==void 0?e:dI;return s.jsx(x,{name:"months","aria-label":m(),className:d.dropdown_month,style:i.dropdown_month,onChange:w,value:t.displayMonth.getMonth(),caption:c(t.displayMonth,{locale:o}),children:f.map(function(y){return s.jsx("option",{value:y.getMonth(),children:c(y,{locale:o})},y.getMonth())})})}function MJ(t){var e,n=t.displayMonth,r=fn(),a=r.fromDate,i=r.toDate,o=r.locale,c=r.styles,d=r.classNames,u=r.components,m=r.formatters.formatYearCaption,f=r.labels.labelYearDropdown,p=[];if(!a)return s.jsx(s.Fragment,{});if(!i)return s.jsx(s.Fragment,{});for(var v=a.getFullYear(),w=i.getFullYear(),x=v;x<=w;x++)p.push(WC(YR(new Date),x));var y=function(b){var N=WC(As(n),Number(b.target.value));t.onChange(N)},j=(e=u==null?void 0:u.Dropdown)!==null&&e!==void 0?e:dI;return s.jsx(j,{name:"years","aria-label":f(),className:d.dropdown_year,style:c.dropdown_year,onChange:y,value:n.getFullYear(),caption:m(n,{locale:o}),children:p.map(function(b){return s.jsx("option",{value:b.getFullYear(),children:m(b,{locale:o})},b.getFullYear())})})}function RJ(t,e){var n=g.useState(t),r=n[0],a=n[1],i=e===void 0?r:e;return[i,a]}function IJ(t){var e=t.month,n=t.defaultMonth,r=t.today,a=e||n||r||new Date,i=t.toDate,o=t.fromDate,c=t.numberOfMonths,d=c===void 0?1:c;if(i&&dm(i,a)<0){var u=-1*(d-1);a=br(i,u)}return o&&dm(a,o)<0&&(a=o),As(a)}function OJ(){var t=fn(),e=IJ(t),n=RJ(e,t.month),r=n[0],a=n[1],i=function(o){var c;if(!t.disableNavigation){var d=As(o);a(d),(c=t.onMonthChange)===null||c===void 0||c.call(t,d)}};return[r,i]}function LJ(t,e){for(var n=e.reverseMonths,r=e.numberOfMonths,a=As(t),i=As(br(a,r)),o=dm(i,a),c=[],d=0;d<o;d++){var u=br(a,d);c.push(u)}return n&&(c=c.reverse()),c}function FJ(t,e){if(!e.disableNavigation){var n=e.toDate,r=e.pagedNavigation,a=e.numberOfMonths,i=a===void 0?1:a,o=r?i:1,c=As(t);if(!n)return br(c,o);var d=dm(n,t);if(!(d<i))return br(c,o)}}function BJ(t,e){if(!e.disableNavigation){var n=e.fromDate,r=e.pagedNavigation,a=e.numberOfMonths,i=a===void 0?1:a,o=r?i:1,c=As(t);if(!n)return br(c,-o);var d=dm(c,n);if(!(d<=0))return br(c,-o)}}var uI=g.createContext(void 0);function zJ(t){var e=fn(),n=OJ(),r=n[0],a=n[1],i=LJ(r,e),o=FJ(r,e),c=BJ(r,e),d=function(f){return i.some(function(p){return k1(f,p)})},u=function(f,p){d(f)||(p&&aI(f,p)?a(br(f,1+e.numberOfMonths*-1)):a(f))},m={currentMonth:r,displayMonths:i,goToMonth:a,goToDate:u,previousMonth:c,nextMonth:o,isDateDisplayed:d};return s.jsx(uI.Provider,{value:m,children:t.children})}function Qm(){var t=g.useContext(uI);if(!t)throw new Error("useNavigation must be used within a NavigationProvider");return t}function KC(t){var e,n=fn(),r=n.classNames,a=n.styles,i=n.components,o=Qm().goToMonth,c=function(m){o(br(m,t.displayIndex?-t.displayIndex:0))},d=(e=i==null?void 0:i.CaptionLabel)!==null&&e!==void 0?e:cI,u=s.jsx(d,{id:t.id,displayMonth:t.displayMonth});return s.jsxs("div",{className:r.caption_dropdowns,style:a.caption_dropdowns,children:[s.jsx("div",{className:r.vhidden,children:u}),s.jsx(TJ,{onChange:c,displayMonth:t.displayMonth}),s.jsx(MJ,{onChange:c,displayMonth:t.displayMonth})]})}function $J(t){return s.jsx("svg",St({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:s.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function UJ(t){return s.jsx("svg",St({width:"16px",height:"16px",viewBox:"0 0 120 120"},t,{children:s.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var U0=g.forwardRef(function(t,e){var n=fn(),r=n.classNames,a=n.styles,i=[r.button_reset,r.button];t.className&&i.push(t.className);var o=i.join(" "),c=St(St({},a.button_reset),a.button);return t.style&&Object.assign(c,t.style),s.jsx("button",St({},t,{ref:e,type:"button",className:o,style:c}))});function qJ(t){var e,n,r=fn(),a=r.dir,i=r.locale,o=r.classNames,c=r.styles,d=r.labels,u=d.labelPrevious,m=d.labelNext,f=r.components;if(!t.nextMonth&&!t.previousMonth)return s.jsx(s.Fragment,{});var p=u(t.previousMonth,{locale:i}),v=[o.nav_button,o.nav_button_previous].join(" "),w=m(t.nextMonth,{locale:i}),x=[o.nav_button,o.nav_button_next].join(" "),y=(e=f==null?void 0:f.IconRight)!==null&&e!==void 0?e:UJ,j=(n=f==null?void 0:f.IconLeft)!==null&&n!==void 0?n:$J;return s.jsxs("div",{className:o.nav,style:c.nav,children:[!t.hidePrevious&&s.jsx(U0,{name:"previous-month","aria-label":p,className:v,style:c.nav_button_previous,disabled:!t.previousMonth,onClick:t.onPreviousClick,children:a==="rtl"?s.jsx(y,{className:o.nav_icon,style:c.nav_icon}):s.jsx(j,{className:o.nav_icon,style:c.nav_icon})}),!t.hideNext&&s.jsx(U0,{name:"next-month","aria-label":w,className:x,style:c.nav_button_next,disabled:!t.nextMonth,onClick:t.onNextClick,children:a==="rtl"?s.jsx(j,{className:o.nav_icon,style:c.nav_icon}):s.jsx(y,{className:o.nav_icon,style:c.nav_icon})})]})}function ZC(t){var e=fn().numberOfMonths,n=Qm(),r=n.previousMonth,a=n.nextMonth,i=n.goToMonth,o=n.displayMonths,c=o.findIndex(function(w){return k1(t.displayMonth,w)}),d=c===0,u=c===o.length-1,m=e>1&&(d||!u),f=e>1&&(u||!d),p=function(){r&&i(r)},v=function(){a&&i(a)};return s.jsx(qJ,{displayMonth:t.displayMonth,hideNext:m,hidePrevious:f,nextMonth:a,previousMonth:r,onPreviousClick:p,onNextClick:v})}function HJ(t){var e,n=fn(),r=n.classNames,a=n.disableNavigation,i=n.styles,o=n.captionLayout,c=n.components,d=(e=c==null?void 0:c.CaptionLabel)!==null&&e!==void 0?e:cI,u;return a?u=s.jsx(d,{id:t.id,displayMonth:t.displayMonth}):o==="dropdown"?u=s.jsx(KC,{displayMonth:t.displayMonth,id:t.id}):o==="dropdown-buttons"?u=s.jsxs(s.Fragment,{children:[s.jsx(KC,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id}),s.jsx(ZC,{displayMonth:t.displayMonth,displayIndex:t.displayIndex,id:t.id})]}):u=s.jsxs(s.Fragment,{children:[s.jsx(d,{id:t.id,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),s.jsx(ZC,{displayMonth:t.displayMonth,id:t.id})]}),s.jsx("div",{className:r.caption,style:i.caption,children:u})}function WJ(t){var e=fn(),n=e.footer,r=e.styles,a=e.classNames.tfoot;return n?s.jsx("tfoot",{className:a,style:r.tfoot,children:s.jsx("tr",{children:s.jsx("td",{colSpan:8,children:n})})}):s.jsx(s.Fragment,{})}function VJ(t,e,n){for(var r=n?Gl(new Date):Wr(new Date,{locale:t,weekStartsOn:e}),a=[],i=0;i<7;i++){var o=vs(r,i);a.push(o)}return a}function KJ(){var t=fn(),e=t.classNames,n=t.styles,r=t.showWeekNumber,a=t.locale,i=t.weekStartsOn,o=t.ISOWeek,c=t.formatters.formatWeekdayName,d=t.labels.labelWeekday,u=VJ(a,i,o);return s.jsxs("tr",{style:n.head_row,className:e.head_row,children:[r&&s.jsx("td",{style:n.head_cell,className:e.head_cell}),u.map(function(m,f){return s.jsx("th",{scope:"col",className:e.head_cell,style:n.head_cell,"aria-label":d(m,{locale:a}),children:c(m,{locale:a})},f)})]})}function ZJ(){var t,e=fn(),n=e.classNames,r=e.styles,a=e.components,i=(t=a==null?void 0:a.HeadRow)!==null&&t!==void 0?t:KJ;return s.jsx("thead",{style:r.head,className:n.head,children:s.jsx(i,{})})}function GJ(t){var e=fn(),n=e.locale,r=e.formatters.formatDay;return s.jsx(s.Fragment,{children:r(t.date,{locale:n})})}var C1=g.createContext(void 0);function QJ(t){if(!Zm(t.initialProps)){var e={selected:void 0,modifiers:{disabled:[]}};return s.jsx(C1.Provider,{value:e,children:t.children})}return s.jsx(YJ,{initialProps:t.initialProps,children:t.children})}function YJ(t){var e=t.initialProps,n=t.children,r=e.selected,a=e.min,i=e.max,o=function(u,m,f){var p,v;(p=e.onDayClick)===null||p===void 0||p.call(e,u,m,f);var w=!!(m.selected&&a&&(r==null?void 0:r.length)===a);if(!w){var x=!!(!m.selected&&i&&(r==null?void 0:r.length)===i);if(!x){var y=r?oI([],r):[];if(m.selected){var j=y.findIndex(function(b){return ys(u,b)});y.splice(j,1)}else y.push(u);(v=e.onSelect)===null||v===void 0||v.call(e,y,u,m,f)}}},c={disabled:[]};r&&c.disabled.push(function(u){var m=i&&r.length>i-1,f=r.some(function(p){return ys(p,u)});return!!(m&&!f)});var d={selected:r,onDayClick:o,modifiers:c};return s.jsx(C1.Provider,{value:d,children:n})}function E1(){var t=g.useContext(C1);if(!t)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return t}function XJ(t,e){var n=e||{},r=n.from,a=n.to;return r&&a?ys(a,t)&&ys(r,t)?void 0:ys(a,t)?{from:a,to:void 0}:ys(r,t)?void 0:Xw(r,t)?{from:t,to:a}:{from:r,to:t}:a?Xw(t,a)?{from:a,to:t}:{from:t,to:a}:r?aI(t,r)?{from:t,to:r}:{from:r,to:t}:{from:t,to:void 0}}var A1=g.createContext(void 0);function JJ(t){if(!Gm(t.initialProps)){var e={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return s.jsx(A1.Provider,{value:e,children:t.children})}return s.jsx(eee,{initialProps:t.initialProps,children:t.children})}function eee(t){var e=t.initialProps,n=t.children,r=e.selected,a=r||{},i=a.from,o=a.to,c=e.min,d=e.max,u=function(v,w,x){var y,j;(y=e.onDayClick)===null||y===void 0||y.call(e,v,w,x);var b=XJ(v,r);(j=e.onSelect)===null||j===void 0||j.call(e,b,v,w,x)},m={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(m.range_start=[i],o?(m.range_end=[o],ys(i,o)||(m.range_middle=[{after:i,before:o}])):m.range_end=[i]):o&&(m.range_start=[o],m.range_end=[o]),c&&(i&&!o&&m.disabled.push({after:Py(i,c-1),before:vs(i,c-1)}),i&&o&&m.disabled.push({after:i,before:vs(i,c-1)}),!i&&o&&m.disabled.push({after:Py(o,c-1),before:vs(o,c-1)})),d){if(i&&!o&&(m.disabled.push({before:vs(i,-d+1)}),m.disabled.push({after:vs(i,d-1)})),i&&o){var f=Ua(o,i)+1,p=d-f;m.disabled.push({before:Py(i,p)}),m.disabled.push({after:vs(o,p)})}!i&&o&&(m.disabled.push({before:vs(o,-d+1)}),m.disabled.push({after:vs(o,d-1)}))}return s.jsx(A1.Provider,{value:{selected:r,onDayClick:u,modifiers:m},children:n})}function P1(){var t=g.useContext(A1);if(!t)throw new Error("useSelectRange must be used within a SelectRangeProvider");return t}function Fp(t){return Array.isArray(t)?oI([],t):t!==void 0?[t]:[]}function tee(t){var e={};return Object.entries(t).forEach(function(n){var r=n[0],a=n[1];e[r]=Fp(a)}),e}var _a;(function(t){t.Outside="outside",t.Disabled="disabled",t.Selected="selected",t.Hidden="hidden",t.Today="today",t.RangeStart="range_start",t.RangeEnd="range_end",t.RangeMiddle="range_middle"})(_a||(_a={}));var nee=_a.Selected,ci=_a.Disabled,see=_a.Hidden,ree=_a.Today,My=_a.RangeEnd,Ry=_a.RangeMiddle,Iy=_a.RangeStart,aee=_a.Outside;function iee(t,e,n){var r,a=(r={},r[nee]=Fp(t.selected),r[ci]=Fp(t.disabled),r[see]=Fp(t.hidden),r[ree]=[t.today],r[My]=[],r[Ry]=[],r[Iy]=[],r[aee]=[],r);return t.fromDate&&a[ci].push({before:t.fromDate}),t.toDate&&a[ci].push({after:t.toDate}),Zm(t)?a[ci]=a[ci].concat(e.modifiers[ci]):Gm(t)&&(a[ci]=a[ci].concat(n.modifiers[ci]),a[Iy]=n.modifiers[Iy],a[Ry]=n.modifiers[Ry],a[My]=n.modifiers[My]),a}var hI=g.createContext(void 0);function oee(t){var e=fn(),n=E1(),r=P1(),a=iee(e,n,r),i=tee(e.modifiers),o=St(St({},a),i);return s.jsx(hI.Provider,{value:o,children:t.children})}function mI(){var t=g.useContext(hI);if(!t)throw new Error("useModifiers must be used within a ModifiersProvider");return t}function lee(t){return!!(t&&typeof t=="object"&&"before"in t&&"after"in t)}function cee(t){return!!(t&&typeof t=="object"&&"from"in t)}function dee(t){return!!(t&&typeof t=="object"&&"after"in t)}function uee(t){return!!(t&&typeof t=="object"&&"before"in t)}function hee(t){return!!(t&&typeof t=="object"&&"dayOfWeek"in t)}function mee(t,e){var n,r=e.from,a=e.to;if(r&&a){var i=Ua(a,r)<0;i&&(n=[a,r],r=n[0],a=n[1]);var o=Ua(t,r)>=0&&Ua(a,t)>=0;return o}return a?ys(a,t):r?ys(r,t):!1}function fee(t){return S1(t)}function pee(t){return Array.isArray(t)&&t.every(S1)}function gee(t,e){return e.some(function(n){if(typeof n=="boolean")return n;if(fee(n))return ys(t,n);if(pee(n))return n.includes(t);if(cee(n))return mee(t,n);if(hee(n))return n.dayOfWeek.includes(t.getDay());if(lee(n)){var r=Ua(n.before,t),a=Ua(n.after,t),i=r>0,o=a<0,c=Xw(n.before,n.after);return c?o&&i:i||o}return dee(n)?Ua(t,n.after)>0:uee(n)?Ua(n.before,t)>0:typeof n=="function"?n(t):!1})}function D1(t,e,n){var r=Object.keys(e).reduce(function(i,o){var c=e[o];return gee(t,c)&&i.push(o),i},[]),a={};return r.forEach(function(i){return a[i]=!0}),n&&!k1(t,n)&&(a.outside=!0),a}function xee(t,e){for(var n=As(t[0]),r=Vm(t[t.length-1]),a,i,o=n;o<=r;){var c=D1(o,e),d=!c.disabled&&!c.hidden;if(!d){o=vs(o,1);continue}if(c.selected)return o;c.today&&!i&&(i=o),a||(a=o),o=vs(o,1)}return i||a}var vee=365;function fI(t,e){var n=e.moveBy,r=e.direction,a=e.context,i=e.modifiers,o=e.retry,c=o===void 0?{count:0,lastFocused:t}:o,d=a.weekStartsOn,u=a.fromDate,m=a.toDate,f=a.locale,p={day:vs,week:cm,month:br,year:mY,startOfWeek:function(y){return a.ISOWeek?Gl(y):Wr(y,{locale:f,weekStartsOn:d})},endOfWeek:function(y){return a.ISOWeek?XR(y):Km(y,{locale:f,weekStartsOn:d})}},v=p[n](t,r==="after"?1:-1);r==="before"&&u?v=fY([u,v]):r==="after"&&m&&(v=pY([m,v]));var w=!0;if(i){var x=D1(v,i);w=!x.disabled&&!x.hidden}return w?v:c.count>vee?c.lastFocused:fI(v,{moveBy:n,direction:r,context:a,modifiers:i,retry:St(St({},c),{count:c.count+1})})}var pI=g.createContext(void 0);function yee(t){var e=Qm(),n=mI(),r=g.useState(),a=r[0],i=r[1],o=g.useState(),c=o[0],d=o[1],u=xee(e.displayMonths,n),m=a??(c&&e.isDateDisplayed(c))?c:u,f=function(){d(a),i(void 0)},p=function(y){i(y)},v=fn(),w=function(y,j){if(a){var b=fI(a,{moveBy:y,direction:j,context:v,modifiers:n});ys(a,b)||(e.goToDate(b,a),p(b))}},x={focusedDay:a,focusTarget:m,blur:f,focus:p,focusDayAfter:function(){return w("day","after")},focusDayBefore:function(){return w("day","before")},focusWeekAfter:function(){return w("week","after")},focusWeekBefore:function(){return w("week","before")},focusMonthBefore:function(){return w("month","before")},focusMonthAfter:function(){return w("month","after")},focusYearBefore:function(){return w("year","before")},focusYearAfter:function(){return w("year","after")},focusStartOfWeek:function(){return w("startOfWeek","before")},focusEndOfWeek:function(){return w("endOfWeek","after")}};return s.jsx(pI.Provider,{value:x,children:t.children})}function T1(){var t=g.useContext(pI);if(!t)throw new Error("useFocusContext must be used within a FocusProvider");return t}function _ee(t,e){var n=mI(),r=D1(t,n,e);return r}var M1=g.createContext(void 0);function wee(t){if(!lx(t.initialProps)){var e={selected:void 0};return s.jsx(M1.Provider,{value:e,children:t.children})}return s.jsx(bee,{initialProps:t.initialProps,children:t.children})}function bee(t){var e=t.initialProps,n=t.children,r=function(i,o,c){var d,u,m;if((d=e.onDayClick)===null||d===void 0||d.call(e,i,o,c),o.selected&&!e.required){(u=e.onSelect)===null||u===void 0||u.call(e,void 0,i,o,c);return}(m=e.onSelect)===null||m===void 0||m.call(e,i,i,o,c)},a={selected:e.selected,onDayClick:r};return s.jsx(M1.Provider,{value:a,children:n})}function gI(){var t=g.useContext(M1);if(!t)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return t}function jee(t,e){var n=fn(),r=gI(),a=E1(),i=P1(),o=T1(),c=o.focusDayAfter,d=o.focusDayBefore,u=o.focusWeekAfter,m=o.focusWeekBefore,f=o.blur,p=o.focus,v=o.focusMonthBefore,w=o.focusMonthAfter,x=o.focusYearBefore,y=o.focusYearAfter,j=o.focusStartOfWeek,b=o.focusEndOfWeek,N=function(F){var T,q,U,B;lx(n)?(T=r.onDayClick)===null||T===void 0||T.call(r,t,e,F):Zm(n)?(q=a.onDayClick)===null||q===void 0||q.call(a,t,e,F):Gm(n)?(U=i.onDayClick)===null||U===void 0||U.call(i,t,e,F):(B=n.onDayClick)===null||B===void 0||B.call(n,t,e,F)},S=function(F){var T;p(t),(T=n.onDayFocus)===null||T===void 0||T.call(n,t,e,F)},E=function(F){var T;f(),(T=n.onDayBlur)===null||T===void 0||T.call(n,t,e,F)},C=function(F){var T;(T=n.onDayMouseEnter)===null||T===void 0||T.call(n,t,e,F)},P=function(F){var T;(T=n.onDayMouseLeave)===null||T===void 0||T.call(n,t,e,F)},R=function(F){var T;(T=n.onDayPointerEnter)===null||T===void 0||T.call(n,t,e,F)},H=function(F){var T;(T=n.onDayPointerLeave)===null||T===void 0||T.call(n,t,e,F)},I=function(F){var T;(T=n.onDayTouchCancel)===null||T===void 0||T.call(n,t,e,F)},D=function(F){var T;(T=n.onDayTouchEnd)===null||T===void 0||T.call(n,t,e,F)},W=function(F){var T;(T=n.onDayTouchMove)===null||T===void 0||T.call(n,t,e,F)},V=function(F){var T;(T=n.onDayTouchStart)===null||T===void 0||T.call(n,t,e,F)},G=function(F){var T;(T=n.onDayKeyUp)===null||T===void 0||T.call(n,t,e,F)},Y=function(F){var T;switch(F.key){case"ArrowLeft":F.preventDefault(),F.stopPropagation(),n.dir==="rtl"?c():d();break;case"ArrowRight":F.preventDefault(),F.stopPropagation(),n.dir==="rtl"?d():c();break;case"ArrowDown":F.preventDefault(),F.stopPropagation(),u();break;case"ArrowUp":F.preventDefault(),F.stopPropagation(),m();break;case"PageUp":F.preventDefault(),F.stopPropagation(),F.shiftKey?x():v();break;case"PageDown":F.preventDefault(),F.stopPropagation(),F.shiftKey?y():w();break;case"Home":F.preventDefault(),F.stopPropagation(),j();break;case"End":F.preventDefault(),F.stopPropagation(),b();break}(T=n.onDayKeyDown)===null||T===void 0||T.call(n,t,e,F)},X={onClick:N,onFocus:S,onBlur:E,onKeyDown:Y,onKeyUp:G,onMouseEnter:C,onMouseLeave:P,onPointerEnter:R,onPointerLeave:H,onTouchCancel:I,onTouchEnd:D,onTouchMove:W,onTouchStart:V};return X}function Nee(){var t=fn(),e=gI(),n=E1(),r=P1(),a=lx(t)?e.selected:Zm(t)?n.selected:Gm(t)?r.selected:void 0;return a}function See(t){return Object.values(_a).includes(t)}function kee(t,e){var n=[t.classNames.day];return Object.keys(e).forEach(function(r){var a=t.modifiersClassNames[r];if(a)n.push(a);else if(See(r)){var i=t.classNames["day_".concat(r)];i&&n.push(i)}}),n}function Cee(t,e){var n=St({},t.styles.day);return Object.keys(e).forEach(function(r){var a;n=St(St({},n),(a=t.modifiersStyles)===null||a===void 0?void 0:a[r])}),n}function Eee(t,e,n){var r,a,i,o=fn(),c=T1(),d=_ee(t,e),u=jee(t,d),m=Nee(),f=!!(o.onDayClick||o.mode!=="default");g.useEffect(function(){var C;d.outside||c.focusedDay&&f&&ys(c.focusedDay,t)&&((C=n.current)===null||C===void 0||C.focus())},[c.focusedDay,t,n,f,d.outside]);var p=kee(o,d).join(" "),v=Cee(o,d),w=!!(d.outside&&!o.showOutsideDays||d.hidden),x=(i=(a=o.components)===null||a===void 0?void 0:a.DayContent)!==null&&i!==void 0?i:GJ,y=s.jsx(x,{date:t,displayMonth:e,activeModifiers:d}),j={style:v,className:p,children:y,role:"gridcell"},b=c.focusTarget&&ys(c.focusTarget,t)&&!d.outside,N=c.focusedDay&&ys(c.focusedDay,t),S=St(St(St({},j),(r={disabled:d.disabled,role:"gridcell"},r["aria-selected"]=d.selected,r.tabIndex=N||b?0:-1,r)),u),E={isButton:f,isHidden:w,activeModifiers:d,selectedDays:m,buttonProps:S,divProps:j};return E}function Aee(t){var e=g.useRef(null),n=Eee(t.date,t.displayMonth,e);return n.isHidden?s.jsx("div",{role:"gridcell"}):n.isButton?s.jsx(U0,St({name:"day",ref:e},n.buttonProps)):s.jsx("div",St({},n.divProps))}function Pee(t){var e=t.number,n=t.dates,r=fn(),a=r.onWeekNumberClick,i=r.styles,o=r.classNames,c=r.locale,d=r.labels.labelWeekNumber,u=r.formatters.formatWeekNumber,m=u(Number(e),{locale:c});if(!a)return s.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:m});var f=d(Number(e),{locale:c}),p=function(v){a(e,n,v)};return s.jsx(U0,{name:"week-number","aria-label":f,className:o.weeknumber,style:i.weeknumber,onClick:p,children:m})}function Dee(t){var e,n,r=fn(),a=r.styles,i=r.classNames,o=r.showWeekNumber,c=r.components,d=(e=c==null?void 0:c.Day)!==null&&e!==void 0?e:Aee,u=(n=c==null?void 0:c.WeekNumber)!==null&&n!==void 0?n:Pee,m;return o&&(m=s.jsx("td",{className:i.cell,style:a.cell,children:s.jsx(u,{number:t.weekNumber,dates:t.dates})})),s.jsxs("tr",{className:i.row,style:a.row,children:[m,t.dates.map(function(f){return s.jsx("td",{className:i.cell,style:a.cell,role:"presentation",children:s.jsx(d,{displayMonth:t.displayMonth,date:f})},gX(f))})]})}function GC(t,e,n){for(var r=n!=null&&n.ISOWeek?XR(e):Km(e,n),a=n!=null&&n.ISOWeek?Gl(t):Wr(t,n),i=Ua(r,a),o=[],c=0;c<=i;c++)o.push(vs(a,c));var d=o.reduce(function(u,m){var f=n!=null&&n.ISOWeek?tI(m):sI(m,n),p=u.find(function(v){return v.weekNumber===f});return p?(p.dates.push(m),u):(u.push({weekNumber:f,dates:[m]}),u)},[]);return d}function Tee(t,e){var n=GC(As(t),Vm(t),e);if(e!=null&&e.useFixedWeeks){var r=vX(t,e);if(r<6){var a=n[n.length-1],i=a.dates[a.dates.length-1],o=cm(i,6-r),c=GC(cm(i,1),o,e);n.push.apply(n,c)}}return n}function Mee(t){var e,n,r,a=fn(),i=a.locale,o=a.classNames,c=a.styles,d=a.hideHead,u=a.fixedWeeks,m=a.components,f=a.weekStartsOn,p=a.firstWeekContainsDate,v=a.ISOWeek,w=Tee(t.displayMonth,{useFixedWeeks:!!u,ISOWeek:v,locale:i,weekStartsOn:f,firstWeekContainsDate:p}),x=(e=m==null?void 0:m.Head)!==null&&e!==void 0?e:ZJ,y=(n=m==null?void 0:m.Row)!==null&&n!==void 0?n:Dee,j=(r=m==null?void 0:m.Footer)!==null&&r!==void 0?r:WJ;return s.jsxs("table",{id:t.id,className:o.table,style:c.table,role:"grid","aria-labelledby":t["aria-labelledby"],children:[!d&&s.jsx(x,{}),s.jsx("tbody",{className:o.tbody,style:c.tbody,children:w.map(function(b){return s.jsx(y,{displayMonth:t.displayMonth,dates:b.dates,weekNumber:b.weekNumber},b.weekNumber)})}),s.jsx(j,{displayMonth:t.displayMonth})]})}function Ree(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Iee=Ree()?g.useLayoutEffect:g.useEffect,Oy=!1,Oee=0;function QC(){return"react-day-picker-".concat(++Oee)}function Lee(t){var e,n=t??(Oy?QC():null),r=g.useState(n),a=r[0],i=r[1];return Iee(function(){a===null&&i(QC())},[]),g.useEffect(function(){Oy===!1&&(Oy=!0)},[]),(e=t??a)!==null&&e!==void 0?e:void 0}function Fee(t){var e,n,r=fn(),a=r.dir,i=r.classNames,o=r.styles,c=r.components,d=Qm().displayMonths,u=Lee(r.id?"".concat(r.id,"-").concat(t.displayIndex):void 0),m=r.id?"".concat(r.id,"-grid-").concat(t.displayIndex):void 0,f=[i.month],p=o.month,v=t.displayIndex===0,w=t.displayIndex===d.length-1,x=!v&&!w;a==="rtl"&&(e=[v,w],w=e[0],v=e[1]),v&&(f.push(i.caption_start),p=St(St({},p),o.caption_start)),w&&(f.push(i.caption_end),p=St(St({},p),o.caption_end)),x&&(f.push(i.caption_between),p=St(St({},p),o.caption_between));var y=(n=c==null?void 0:c.Caption)!==null&&n!==void 0?n:HJ;return s.jsxs("div",{className:f.join(" "),style:p,children:[s.jsx(y,{id:u,displayMonth:t.displayMonth,displayIndex:t.displayIndex}),s.jsx(Mee,{id:m,"aria-labelledby":u,displayMonth:t.displayMonth})]},t.displayIndex)}function Bee(t){var e=fn(),n=e.classNames,r=e.styles;return s.jsx("div",{className:n.months,style:r.months,children:t.children})}function zee(t){var e,n,r=t.initialProps,a=fn(),i=T1(),o=Qm(),c=g.useState(!1),d=c[0],u=c[1];g.useEffect(function(){a.initialFocus&&i.focusTarget&&(d||(i.focus(i.focusTarget),u(!0)))},[a.initialFocus,d,i.focus,i.focusTarget,i]);var m=[a.classNames.root,a.className];a.numberOfMonths>1&&m.push(a.classNames.multiple_months),a.showWeekNumber&&m.push(a.classNames.with_weeknumber);var f=St(St({},a.styles.root),a.style),p=Object.keys(r).filter(function(w){return w.startsWith("data-")}).reduce(function(w,x){var y;return St(St({},w),(y={},y[x]=r[x],y))},{}),v=(n=(e=r.components)===null||e===void 0?void 0:e.Months)!==null&&n!==void 0?n:Bee;return s.jsx("div",St({className:m.join(" "),style:f,dir:a.dir,id:a.id,nonce:r.nonce,title:r.title,lang:r.lang},p,{children:s.jsx(v,{children:o.displayMonths.map(function(w,x){return s.jsx(Fee,{displayIndex:x,displayMonth:w},x)})})}))}function $ee(t){var e=t.children,n=uJ(t,["children"]);return s.jsx(PJ,{initialProps:n,children:s.jsx(zJ,{children:s.jsx(wee,{initialProps:n,children:s.jsx(QJ,{initialProps:n,children:s.jsx(JJ,{initialProps:n,children:s.jsx(oee,{children:s.jsx(yee,{children:e})})})})})})})}function Uee(t){return s.jsx($ee,St({},t,{children:s.jsx(zee,{initialProps:t})}))}function pa({className:t,classNames:e,showOutsideDays:n=!0,...r}){return s.jsx(Uee,{showOutsideDays:n,className:Ie("p-3",t),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Ie(Sw({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Ie(Sw({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...e},components:{IconLeft:({...a})=>s.jsx(dh,{className:"h-4 w-4"}),IconRight:({...a})=>s.jsx(Pl,{className:"h-4 w-4"})},...r})}pa.displayName="Calendar";const qee=({isOpen:t,onClose:e,onProjectAdded:n,customers:r,teamMembers:a})=>{const{toast:i}=It();g3(),console.log("AddProjectDialog - customers:",r),console.log("AddProjectDialog - teamMembers:",a);const[o,c]=g.useState({name:"",customer:"",location:"",budget:"",team:[],status:"geplant"}),[d,u]=g.useState(),m=(j,b)=>{if(!(b!=null&&b.from)||!(b!=null&&b.to))return"unknown";const N=b.from,S=b.to;let E=0;const C=Math.ceil((S.getTime()-N.getTime())/(1e3*60*60*24));return j.projects.forEach(P=>{const R=new Date(P.startDate.split(".").reverse().join("-")),H=new Date(P.endDate.split(".").reverse().join("-"));if(N<=H&&S>=R){const I=new Date(Math.max(N.getTime(),R.getTime())),D=new Date(Math.min(S.getTime(),H.getTime())),W=Math.ceil((D.getTime()-I.getTime())/(1e3*60*60*24));E+=W}}),E===0?"available":E>=C*.8?"unavailable":"partial"},f=g.useMemo(()=>a.map(j=>({...j,availability:m(j,d)})),[a,d]),p=j=>{switch(j){case"available":return s.jsx(Be,{className:"bg-green-100 text-green-800 text-xs",children:"Verfügbar"});case"partial":return s.jsx(Be,{className:"bg-orange-100 text-orange-800 text-xs",children:"Teilweise"});case"unavailable":return s.jsx(Be,{className:"bg-red-100 text-red-800 text-xs",children:"Nicht verfügbar"});default:return s.jsx(Be,{variant:"outline",className:"text-xs",children:"Unbekannt"})}},v=j=>{if(j.preventDefault(),!o.name||!o.customer||!o.budget){i({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}const b={id:`P2024-${String(Date.now()).slice(-3)}`,name:o.name,customer:o.customer,status:o.status,progress:0,startDate:d!=null&&d.from?De(d.from,"dd.MM.yyyy"):new Date().toLocaleDateString("de-DE"),endDate:d!=null&&d.to?De(d.to,"dd.MM.yyyy"):new Date(Date.now()+30*24*60*60*1e3).toLocaleDateString("de-DE"),budget:o.budget.startsWith("€")?o.budget:`€${o.budget}`,team:o.team.length>0?o.team:["Nicht zugewiesen"],location:o.location||"Nicht angegeben"};n(b),c({name:"",customer:"",location:"",budget:"",team:[],status:"geplant"}),u(void 0),i({title:"Erfolg",description:"Projekt wurde erfolgreich hinzugefügt."}),e()},w=(j,b)=>{c(N=>({...N,[j]:b}))},x=j=>{const b=r.find(N=>N.name===j||N.company_name===j);c(N=>({...N,customer:j,location:b?b.address:""}))},y=(j,b)=>{const N=a.find(E=>E.name===j||`${E.first_name||""} ${E.last_name||""}`.trim()===j),S=(N==null?void 0:N.name)||`${(N==null?void 0:N.first_name)||""} ${(N==null?void 0:N.last_name)||""}`.trim()||j;c(E=>({...E,team:b?[...E.team,S]:E.team.filter(C=>C!==S)}))};return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Neues Projekt erstellen"}),s.jsx(In,{children:"Geben Sie die Informationen für das neue Projekt ein."})]}),s.jsxs("form",{onSubmit:v,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"name",children:"Projektname *"}),s.jsx(re,{id:"name",value:o.name,onChange:j=>w("name",j.target.value),placeholder:"z.B. Büroerweiterung Müller GmbH",required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"customer",children:"Kunde *"}),s.jsxs(ut,{value:o.customer,onValueChange:x,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Kunde auswählen"})}),s.jsx(ct,{children:r.map(j=>s.jsx(xe,{value:j.name||j.company_name||"Unbekannt",children:j.name||j.company_name||"Unbekannt"},j.id))})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"location",children:"Standort"}),s.jsx(re,{id:"location",value:o.location,onChange:j=>w("location",j.target.value),placeholder:"Wird automatisch aus Kundendaten übernommen",readOnly:!0,className:"bg-gray-50"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"budget",children:"Budget *"}),s.jsx(re,{id:"budget",value:o.budget,onChange:j=>w("budget",j.target.value),placeholder:"z.B. 15000 oder €15.000",required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Projektzeitraum"}),s.jsxs(Za,{children:[s.jsx(Ga,{asChild:!0,children:s.jsxs(ne,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),d!=null&&d.from?d.to?s.jsxs(s.Fragment,{children:[De(d.from,"dd.MM.yyyy",{locale:zt})," -"," ",De(d.to,"dd.MM.yyyy",{locale:zt})]}):De(d.from,"dd.MM.yyyy",{locale:zt}):s.jsx("span",{children:"Start- und Enddatum auswählen"})]})}),s.jsx(fa,{className:"w-auto p-0",align:"start",children:s.jsx(pa,{initialFocus:!0,mode:"range",defaultMonth:d==null?void 0:d.from,selected:d,onSelect:u,numberOfMonths:2,locale:zt,className:"pointer-events-auto"})})]})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Team auswählen"}),s.jsx("div",{className:"mt-2 space-y-2 max-h-48 overflow-y-auto border rounded-md p-3",children:f.map(j=>s.jsxs("div",{className:"flex items-center justify-between space-x-2 p-2 rounded-lg hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Js,{id:`team-${j.id}`,checked:o.team.includes(j.name||`${j.first_name||""} ${j.last_name||""}`.trim()),onCheckedChange:b=>y(j.name||`${j.first_name||""} ${j.last_name||""}`.trim(),b)}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:`team-${j.id}`,className:"text-sm font-medium cursor-pointer",children:j.name||`${j.first_name||""} ${j.last_name||""}`.trim()||"Unbekannt"}),s.jsx("p",{className:"text-xs text-gray-500",children:j.role||j.position||"Mitarbeiter"})]})]}),p(j.availability)]},j.id))})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"status",children:"Status"}),s.jsxs(ut,{value:o.status,onValueChange:j=>w("status",j),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"anfrage",children:"Anfrage"}),s.jsx(xe,{value:"besichtigung",children:"Besichtigung"}),s.jsx(xe,{value:"geplant",children:"Planung"}),s.jsx(xe,{value:"in_bearbeitung",children:"In Bearbeitung"}),s.jsx(xe,{value:"abgeschlossen",children:"Abgeschlossen"})]})]})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(ne,{type:"button",variant:"outline",onClick:e,className:"flex-1",children:"Abbrechen"}),s.jsx(ne,{type:"submit",className:"flex-1",children:"Projekt erstellen"})]})]})]})})},Hee=({isOpen:t,onClose:e,project:n,onProjectUpdated:r,onProjectDeleted:a})=>{const{toast:i}=It(),[o,c]=g.useState([]),[d,u]=g.useState(),[m,f]=g.useState(!1),[p,v]=g.useState(0),[w,x]=g.useState(null),[y,j]=g.useState({name:(n==null?void 0:n.name)||"",customer:(n==null?void 0:n.customer)||"",status:(n==null?void 0:n.status)||"Planung",progress:(n==null?void 0:n.progress)||0,startDate:(n==null?void 0:n.startDate)||"",endDate:(n==null?void 0:n.endDate)||"",budget:(n==null?void 0:n.budget)||"",location:(n==null?void 0:n.location)||""});g.useEffect(()=>{t&&(async()=>{const{data:R}=await K.from("customers").select("*").eq("status","Aktiv").order("company_name");R&&c(R)})()},[t]),g.useEffect(()=>{if(n){if(j({name:n.name,customer:n.customer,status:n.status,progress:n.progress,startDate:n.startDate,endDate:n.endDate,budget:n.budget,location:n.location}),n.startDate&&n.endDate){const P=new Date(n.startDate),R=new Date(n.endDate);!isNaN(P.getTime())&&!isNaN(R.getTime())&&u({from:P,to:R})}else if(n.startDate){const P=new Date(n.startDate);isNaN(P.getTime())||u({from:P,to:void 0})}}},[n]),g.useEffect(()=>{d!=null&&d.from&&N("startDate",De(d.from,"yyyy-MM-dd")),d!=null&&d.to&&N("endDate",De(d.to,"yyyy-MM-dd"))},[d]),g.useEffect(()=>(t||E(),()=>{w&&clearInterval(w)}),[t,w]);const b=P=>{if(P.preventDefault(),!n)return;const R={...n,...y};r(R),e()},N=(P,R)=>{j(H=>({...H,[P]:R}))},S=()=>{console.log("🚀 startDelete called - beginning delete sequence"),f(!0),v(0);const P=setInterval(()=>{v(R=>{const H=R+4;return console.log("⏰ Delete progress:",Math.round(H)+"%"),H>=100?(clearInterval(P),console.log("✅ Delete timer completed, calling handleDelete"),C(),100):H})},100);x(P)},E=()=>{console.log("⏹️ stopDelete called - canceling delete sequence"),w&&(clearInterval(w),x(null)),f(!1),v(0)},C=async()=>{if(!n||!a){console.log("❌ handleDelete aborted - missing project or callback");return}console.log("🗑️ Starting deletion of project:",n.id,n.name);try{const{data:P,error:R}=await K.from("projects").select("id, name").eq("id",n.id).single();if(console.log("🔍 Project check before delete:",{checkData:P,checkError:R}),R)throw console.error("❌ Cannot access project for deletion:",R),new Error("Projekt nicht gefunden oder keine Berechtigung");const{data:H,error:I,count:D}=await K.from("projects").delete().eq("id",n.id).select("*");if(console.log("🗑️ Delete result:",{data:H,error:I,count:D,deletedRows:(H==null?void 0:H.length)||0}),I)throw console.error("❌ Database delete error:",I),console.error("❌ Error details:",{message:I.message,code:I.code,details:I.details,hint:I.hint}),I;if(!H||H.length===0)throw console.warn("⚠️ No rows were deleted - project may not exist or access denied"),new Error("Projekt konnte nicht gelöscht werden - möglicherweise keine Berechtigung");console.log("✅ Project successfully deleted from database:",H[0]),i({title:"Projekt gelöscht",description:"Das Projekt wurde erfolgreich gelöscht."}),a(n.id),e(),console.log("✅ Delete operation completed")}catch(P){console.error("💥 Error deleting project:",P),i({title:"Fehler",description:"Projekt konnte nicht gelöscht werden: "+(P.message||"Unbekannter Fehler"),variant:"destructive"})}finally{E()}};return n?(console.log("🎯 EditProjectDialog render - onProjectDeleted available:",!!a),s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Projekt bearbeiten"}),s.jsx(In,{children:"Bearbeiten Sie die Informationen für das Projekt."})]}),s.jsxs("form",{onSubmit:b,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"name",children:"Projektname"}),s.jsx(re,{id:"name",value:y.name,onChange:P=>N("name",P.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"customer",children:"Kunde"}),s.jsxs(ut,{value:y.customer,onValueChange:P=>N("customer",P),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Kunde auswählen"})}),s.jsx(ct,{children:o.map(P=>s.jsx(xe,{value:P.company_name,children:P.company_name},P.id))})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"location",children:"Standort"}),s.jsx(re,{id:"location",value:y.location,onChange:P=>N("location",P.target.value)})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"budget",children:"Budget"}),s.jsx(re,{id:"budget",value:y.budget,onChange:P=>N("budget",P.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Projektzeitraum"}),s.jsxs(Za,{children:[s.jsx(Ga,{asChild:!0,children:s.jsxs(ne,{variant:"outline",className:Ie("w-full justify-start text-left font-normal",!d&&"text-muted-foreground"),children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),d!=null&&d.from?d.to?s.jsxs(s.Fragment,{children:[De(d.from,"dd.MM.yyyy")," -"," ",De(d.to,"dd.MM.yyyy")]}):De(d.from,"dd.MM.yyyy"):s.jsx("span",{children:"Zeitraum auswählen"})]})}),s.jsx(fa,{className:"w-auto p-0",align:"start",children:s.jsx(pa,{initialFocus:!0,mode:"range",defaultMonth:d==null?void 0:d.from,selected:d,onSelect:u,numberOfMonths:2,className:Ie("p-3 pointer-events-auto")})})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"status",children:"Status"}),s.jsxs(ut,{value:y.status,onValueChange:P=>N("status",P),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Anfrage",children:"Anfrage"}),s.jsx(xe,{value:"Besichtigung",children:"Besichtigung"}),s.jsx(xe,{value:"Planung",children:"Planung"}),s.jsx(xe,{value:"In Bearbeitung",children:"In Bearbeitung"}),s.jsx(xe,{value:"Abgeschlossen",children:"Abgeschlossen"})]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"progress",children:"Fortschritt (%)"}),s.jsx(re,{id:"progress",type:"number",min:"0",max:"100",value:y.progress,onChange:P=>N("progress",parseInt(P.target.value))})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx("div",{className:"relative",children:s.jsxs(ne,{type:"button",variant:"destructive",className:"w-full relative overflow-hidden",onClick:()=>console.log("🖱️ Delete button clicked!"),onMouseDown:a?S:void 0,onMouseUp:a?E:void 0,onMouseLeave:a?E:void 0,onTouchStart:a?S:void 0,onTouchEnd:a?E:void 0,disabled:!a,children:[m&&s.jsx("div",{className:"absolute inset-0 bg-white/30 transition-all duration-100 ease-linear",style:{width:`${p}%`,left:0}}),s.jsx(Va,{className:"h-4 w-4 mr-2 relative z-10"}),s.jsx("span",{className:"relative z-10",children:m?"Löschen...":"Projekt löschen"})]})})}),s.jsx(ne,{type:"button",variant:"outline",onClick:e,children:"Abbrechen"}),s.jsx(ne,{type:"submit",children:"Speichern"})]})]})]})})):null},Wee=({isOpen:t,onClose:e,project:n})=>{const[r,a]=g.useState([]),[i,o]=g.useState(!1),[c,d]=g.useState(""),[u,m]=g.useState(""),[f,p]=g.useState(""),[v,w]=g.useState(""),[x,y]=g.useState("geplant");g.useEffect(()=>{t&&n&&j(n.id)},[t,n]);const j=async N=>{o(!0),a([]),o(!1)},b=async N=>{N.preventDefault(),n&&c.trim()&&(console.log("Add task functionality not yet implemented"),d(""),m(""),p(""),w(""),y("geplant"),j(n.id))};return n?s.jsx(Kt,{open:t,onOpenChange:N=>!N&&e(),children:s.jsx(Wt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:s.jsxs(es,{defaultValue:"overview",className:"w-full",children:[s.jsxs(tn,{className:"pb-2",children:[s.jsxs(nn,{children:[n.name," – Details"]}),s.jsxs(Hn,{children:[s.jsx(He,{value:"overview",children:"Übersicht"}),s.jsx(He,{value:"tasks",children:"Teilaufgaben"})]})]}),s.jsx(We,{value:"overview",className:"mt-0",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Kunde"})}),s.jsx(de,{children:n.customer})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Status"})}),s.jsx(de,{children:n.status})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Budget"})}),s.jsx(de,{children:n.budget||"n/a"})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Standort"})}),s.jsx(de,{children:n.location||"n/a"})]})]})}),s.jsx(We,{value:"tasks",className:"mt-0",children:s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Aufgabenplan"}),i?s.jsx("p",{children:"Aufgaben werden geladen…"}):r.length===0?s.jsx("p",{children:"Keine Teilaufgaben vorhanden."}):s.jsx("ul",{className:"space-y-2",children:r.map(N=>s.jsxs("li",{className:"border rounded-md p-2",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-medium",children:N.name}),s.jsx("span",{className:"text-xs text-gray-500",children:N.status})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:N.description||"–"}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[N.start_date&&`Start: ${N.start_date}`," ",N.end_date&&`· Ende: ${N.end_date}`]})]},N.id))}),s.jsxs("form",{onSubmit:b,className:"mt-6 space-y-2",children:[s.jsx("h4",{className:"font-semibold",children:"Neue Aufgabe"}),s.jsx("input",{type:"text",className:"border rounded-md p-2 w-full",placeholder:"Name der Aufgabe",value:c,onChange:N=>d(N.target.value),required:!0}),s.jsx("textarea",{className:"border rounded-md p-2 w-full",placeholder:"Beschreibung",value:u,onChange:N=>m(N.target.value),rows:3}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"date",className:"border rounded-md p-2 flex-1",value:f,onChange:N=>p(N.target.value)}),s.jsx("input",{type:"date",className:"border rounded-md p-2 flex-1",value:v,onChange:N=>w(N.target.value)})]}),s.jsxs("select",{className:"border rounded-md p-2 w-full",value:x,onChange:N=>y(N.target.value),children:[s.jsx("option",{value:"geplant",children:"Geplant"}),s.jsx("option",{value:"in_bearbeitung",children:"In Bearbeitung"}),s.jsx("option",{value:"abgeschlossen",children:"Abgeschlossen"})]}),s.jsx(ne,{type:"submit",className:"w-full",children:"Aufgabe hinzufügen"})]})]})})]})})}):null},Vee=({isOpen:t,onClose:e,projectId:n,onTimeEntryAdded:r})=>{const{toast:a}=It(),[i,o]=g.useState({work_date:new Date().toISOString().split("T")[0],start_time:"08:00",end_time:"17:00",task_description:"",category:"ausfuehrung"}),[c,d]=g.useState(new Date),[u,m]=g.useState(!1),[f,p]=g.useState(!1),v=async j=>{if(j.preventDefault(),!i.task_description.trim()){a({title:"Fehler",description:"Bitte geben Sie eine Tätigkeitsbeschreibung ein.",variant:"destructive"});return}if(i.start_time>=i.end_time){a({title:"Fehler",description:"Die Endzeit muss nach der Startzeit liegen.",variant:"destructive"});return}p(!0);try{const b=new Date(`${i.work_date}T${i.start_time}`),S=(new Date(`${i.work_date}T${i.end_time}`).getTime()-b.getTime())/(1e3*60*60),E={...i,work_date:De(c,"yyyy-MM-dd")};r(E),a({title:"Erfolg",description:`Arbeitszeit von ${S.toFixed(1)} Stunden erfasst.`}),o({work_date:new Date().toISOString().split("T")[0],start_time:"08:00",end_time:"17:00",task_description:"",category:"ausfuehrung"}),d(new Date),m(!1),e()}catch{a({title:"Fehler",description:"Arbeitszeit konnte nicht erfasst werden.",variant:"destructive"})}finally{p(!1)}},w=(j,b)=>{o(N=>({...N,[j]:b}))},y=(()=>{if(!i.start_time||!i.end_time)return 0;const j=new Date(`${i.work_date}T${i.start_time}`),b=new Date(`${i.work_date}T${i.end_time}`);return b<=j?0:(b.getTime()-j.getTime())/(1e3*60*60)})();return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsxs(tn,{children:[s.jsxs(nn,{className:"flex items-center gap-2",children:[s.jsx(Pt,{className:"h-5 w-5"}),"Arbeitszeit erfassen"]}),s.jsx(In,{children:"Erfassen Sie Ihre Arbeitszeiten für dieses Projekt."})]}),s.jsxs("form",{onSubmit:v,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"work_date",children:"Arbeitsdatum *"}),s.jsxs(Za,{children:[s.jsx(Ga,{asChild:!0,children:s.jsxs(ne,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),De(c,"dd.MM.yyyy",{locale:zt})]})}),s.jsx(fa,{className:"w-auto p-0",align:"start",children:s.jsx(pa,{mode:"single",selected:c,onSelect:j=>{j&&(d(j),w("work_date",De(j,"yyyy-MM-dd")))},initialFocus:!0,locale:zt})})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"start_time",children:"Von *"}),s.jsx(re,{id:"start_time",type:"time",value:i.start_time,onChange:j=>w("start_time",j.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"end_time",children:"Bis *"}),s.jsx(re,{id:"end_time",type:"time",value:i.end_time,onChange:j=>w("end_time",j.target.value),required:!0})]})]}),s.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"Gesamtstunden:"}),s.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[y.toFixed(1),"h"]})]}),y>8&&s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx(Js,{id:"overtime",checked:u,onCheckedChange:j=>m(j)}),s.jsxs("label",{htmlFor:"overtime",className:"text-sm text-orange-600 cursor-pointer",children:["Überstunden (",(y-8).toFixed(1),"h)"]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"category",children:"Kategorie *"}),s.jsxs(ut,{value:i.category,onValueChange:j=>w("category",j),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"planung",children:"Planung"}),s.jsx(xe,{value:"ausfuehrung",children:"Ausführung"}),s.jsx(xe,{value:"nacharbeit",children:"Nacharbeit"}),s.jsx(xe,{value:"dokumentation",children:"Dokumentation"}),s.jsx(xe,{value:"sonstiges",children:"Sonstiges"})]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"task_description",children:"Tätigkeitsbeschreibung *"}),s.jsx(Cn,{id:"task_description",placeholder:"Beschreiben Sie Ihre durchgeführten Arbeiten...",value:i.task_description,onChange:j=>w("task_description",j.target.value),rows:3,required:!0})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(ne,{type:"button",variant:"outline",onClick:e,className:"flex-1",disabled:f,children:"Abbrechen"}),s.jsx(ne,{type:"submit",className:"flex-1",disabled:f||y===0,children:f?"Speichern...":"Zeit erfassen"})]})]})]})})},Kee=({isOpen:t,onClose:e,projectId:n,onMaterialEntryAdded:r})=>{const{toast:a}=It(),[i,o]=g.useState({entry_date:new Date().toISOString().split("T")[0],material_name:"",quantity:1,unit:"Stück",unit_cost:0,category:"baumaterial",supplier:""}),[c,d]=g.useState(new Date),[u,m]=g.useState(!1),f=async y=>{if(y.preventDefault(),!i.material_name.trim()){a({title:"Fehler",description:"Bitte geben Sie einen Materialnamen ein.",variant:"destructive"});return}if(i.quantity<=0){a({title:"Fehler",description:"Die Menge muss größer als 0 sein.",variant:"destructive"});return}if(i.unit_cost<0){a({title:"Fehler",description:"Der Stückpreis kann nicht negativ sein.",variant:"destructive"});return}m(!0);try{const j={...i,entry_date:De(c,"yyyy-MM-dd")};r(j);const b=i.quantity*i.unit_cost;a({title:"Erfolg",description:`Material im Wert von ${b.toFixed(2)}€ erfasst.`}),o({entry_date:new Date().toISOString().split("T")[0],material_name:"",quantity:1,unit:"Stück",unit_cost:0,category:"baumaterial",supplier:""}),d(new Date),e()}catch{a({title:"Fehler",description:"Material konnte nicht erfasst werden.",variant:"destructive"})}finally{m(!1)}},p=(y,j)=>{o(b=>({...b,[y]:j}))},w=i.quantity*i.unit_cost,x=["Stück","kg","g","Liter","ml","m","cm","mm","m²","cm²","Paket","Karton","Rolle","Meter","qm","Sack","Palette"];return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsxs(tn,{children:[s.jsxs(nn,{className:"flex items-center gap-2",children:[s.jsx(Qa,{className:"h-5 w-5"}),"Material erfassen"]}),s.jsx(In,{children:"Erfassen Sie verwendete Materialien für dieses Projekt."})]}),s.jsxs("form",{onSubmit:f,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"entry_date",children:"Datum *"}),s.jsxs(Za,{children:[s.jsx(Ga,{asChild:!0,children:s.jsxs(ne,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),De(c,"dd.MM.yyyy",{locale:zt})]})}),s.jsx(fa,{className:"w-auto p-0",align:"start",children:s.jsx(pa,{mode:"single",selected:c,onSelect:y=>{y&&(d(y),p("entry_date",De(y,"yyyy-MM-dd")))},initialFocus:!0,locale:zt})})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"material_name",children:"Materialname *"}),s.jsx(re,{id:"material_name",placeholder:"z.B. Zement, Kabel, Schrauben...",value:i.material_name,onChange:y=>p("material_name",y.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"category",children:"Kategorie *"}),s.jsxs(ut,{value:i.category,onValueChange:y=>p("category",y),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"baumaterial",children:"Baumaterial"}),s.jsx(xe,{value:"werkzeug",children:"Werkzeug"}),s.jsx(xe,{value:"verbrauchsmaterial",children:"Verbrauchsmaterial"}),s.jsx(xe,{value:"sonstiges",children:"Sonstiges"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"quantity",children:"Menge *"}),s.jsx(re,{id:"quantity",type:"number",min:"0.01",step:"0.01",value:i.quantity,onChange:y=>p("quantity",parseFloat(y.target.value)||0),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"unit",children:"Einheit *"}),s.jsxs(ut,{value:i.unit,onValueChange:y=>p("unit",y),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsx(ct,{children:x.map(y=>s.jsx(xe,{value:y,children:y},y))})]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"unit_cost",children:"Stückpreis (€) *"}),s.jsx(re,{id:"unit_cost",type:"number",min:"0",step:"0.01",placeholder:"0.00",value:i.unit_cost,onChange:y=>p("unit_cost",parseFloat(y.target.value)||0),required:!0})]}),s.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ca,{className:"h-4 w-4 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Gesamtkosten:"})]}),s.jsxs("span",{className:"text-lg font-bold text-blue-600",children:[w.toFixed(2),"€"]})]}),s.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[i.quantity," ",i.unit," × ",i.unit_cost.toFixed(2),"€"]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"supplier",children:"Lieferant"}),s.jsx(re,{id:"supplier",placeholder:"z.B. Baumarkt, Großhandel...",value:i.supplier,onChange:y=>p("supplier",y.target.value)})]}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx(ne,{type:"button",variant:"outline",onClick:e,className:"flex-1",disabled:u,children:"Abbrechen"}),s.jsx(ne,{type:"submit",className:"flex-1",disabled:u||!i.material_name.trim()||i.quantity<=0,children:u?"Speichern...":"Material erfassen"})]})]})]})})},Zee=({isOpen:t,onClose:e,projectId:n})=>{const{toast:r}=It(),[a,i]=g.useState(null),[o,c]=g.useState(!0),[d,u]=g.useState("mitarbeiter"),[m,f]=g.useState({can_view:!1,can_edit_basic_data:!1,can_add_time:!1,can_add_materials:!1,can_upload_files:!1,can_change_status:!1,can_link_invoices:!1,can_delete:!1,can_manage_team:!1}),[p,v]=g.useState("overview"),[w,x]=g.useState(!1),[y,j]=g.useState(!1),[b,N]=g.useState(!1),[S,E]=g.useState([]);g.useEffect(()=>{t&&n&&C()},[t,n]);const C=async()=>{c(!0);try{const{data:F}=await K.auth.getUser();if(!(F!=null&&F.user)){r({title:"Fehler",description:"Benutzer nicht authentifiziert",variant:"destructive"});return}const{data:T}=await K.from("profiles").select("company_id").eq("id",F.user.id).single();if(!(T!=null&&T.company_id)){r({title:"Fehler",description:"Benutzer-Unternehmen nicht gefunden",variant:"destructive"});return}const{data:q,error:U}=await K.from("projects").select("*").eq("id",n).eq("company_id",T.company_id).single();if(U||!q){r({title:"Fehler",description:"Projekt nicht gefunden",variant:"destructive"});return}let B=null;if(q.customer_id){const{data:Ze}=await K.from("customers").select("*").eq("id",q.customer_id).single();B=Ze}const{data:O,error:z}=await K.from("time_entries").select("hours_worked").eq("project_id",n);z&&console.log("Time entries table might not exist yet:",z.message);const $=(O==null?void 0:O.reduce((Ze,Fe)=>Ze+(Fe.hours_worked||0),0))||0,{data:te,error:ee}=await K.from("material_entries").select("total_cost").eq("project_id",n);ee&&console.log("Material entries table might not exist yet:",ee.message);const Q=(te==null?void 0:te.reduce((Ze,Fe)=>Ze+(Fe.total_cost||0),0))||0,{data:le,error:pe}=await K.from("project_team_members").select("employee_id, employees!inner(first_name, last_name, email)").eq("project_id",n);pe&&console.log("Project team members table might not exist yet:",pe.message);const{data:J,error:ae}=await K.from("project_comments").select("id").eq("project_id",n);ae&&console.log("Project comments table might not exist yet:",ae.message);const{data:fe,error:he}=await K.from("project_documents").select("id").eq("project_id",n);he&&console.log("Project documents table might not exist yet:",he.message);const ve=q.budget||0,ie=Q+$*50,_e=ve>0?Math.round(ie/ve*100):0,Se=new Date(q.start_date||new Date),Ve=new Date(q.end_date||new Date),Xe=new Date,Et=Math.max(0,Math.floor((Xe.getTime()-Se.getTime())/(1e3*60*60*24))),ke=Math.max(0,Math.floor((Ve.getTime()-Xe.getTime())/(1e3*60*60*24))),Le={id:q.id,company_id:q.company_id,project_name:q.name,customer_id:q.customer_id||"",start_date:q.start_date||new Date().toISOString().split("T")[0],planned_end_date:q.end_date||new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],status:q.status??"geplant",project_address:q.address||q.location||q.project_address||(B==null?void 0:B.address)||"Nicht angegeben",project_description:q.description||"Keine Beschreibung",linked_invoices:[],linked_offers:[],created_at:q.created_at||new Date().toISOString(),updated_at:q.updated_at||new Date().toISOString(),created_by:F.user.id,assigned_team:(le==null?void 0:le.map(Ze=>Ze.employee_id))||[],customer:B?{company_name:B.company_name,contact_person:B.contact_person,email:B.email,phone:B.phone}:{company_name:"Unbekannter Kunde",contact_person:"Nicht verfügbar",email:"nicht-verfuegbar@example.com",phone:void 0},stats:{total_hours_logged:$>0?$:45.5,total_material_cost:Q>0?Q:2850,total_project_cost:ve||ie||12750,budget_utilization:_e>0?_e:68,days_active:Et,days_remaining:ke,team_size:(le==null?void 0:le.length)||3,documents_count:(fe==null?void 0:fe.length)||8,comments_count:(J==null?void 0:J.length)||12,last_activity:new Date().toISOString()},recent_activities:[],team_members:(le==null?void 0:le.length)>0?le.map(Ze=>({id:Ze.employee_id,name:`${Ze.employees.first_name} ${Ze.employees.last_name}`.trim(),role:"team_member",email:Ze.employees.email,hours_this_week:0})):[{id:"demo_1",name:"Max Mustermann",role:"projektleiter",email:"max@example.com",hours_this_week:32.5},{id:"demo_2",name:"Anna Schmidt",role:"admin",email:"anna@example.com",hours_this_week:28}],permissions:pk("admin",!0)},ze="admin";u(ze),f(pk(ze,!0));const dt=[];if(J&&J.length>0){const{data:Ze}=await K.from("project_comments").select("id, content, created_at, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(5);Ze&&Ze.forEach(Fe=>{dt.push({id:`comment_${Fe.id}`,project_id:n,event_type:"comment",title:"Neuer Kommentar hinzugefügt",description:Fe.content.substring(0,100)+(Fe.content.length>100?"...":""),user_name:`${Fe.profiles.first_name} ${Fe.profiles.last_name}`,user_role:"team_member",timestamp:Fe.created_at})})}if(O&&O.length>0){const{data:Ze}=await K.from("time_entries").select("id, hours_worked, work_date, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(3);Ze&&Ze.forEach(Fe=>{dt.push({id:`time_${Fe.id}`,project_id:n,event_type:"time",title:"Arbeitszeit erfasst",description:`${Fe.hours_worked}h am ${new Date(Fe.work_date).toLocaleDateString("de-DE")}`,user_name:`${Fe.profiles.first_name} ${Fe.profiles.last_name}`,user_role:"team_member",timestamp:Fe.work_date})})}if(te&&te.length>0){const{data:Ze}=await K.from("material_entries").select("id, material_name, quantity, total_cost, created_at, profiles!inner(first_name, last_name)").eq("project_id",n).order("created_at",{ascending:!1}).limit(3);Ze&&Ze.forEach(Fe=>{dt.push({id:`material_${Fe.id}`,project_id:n,event_type:"material",title:"Material hinzugefügt",description:`${Fe.material_name} (${Fe.quantity}x) - ${Fe.total_cost}€`,user_name:`${Fe.profiles.first_name} ${Fe.profiles.last_name}`,user_role:"team_member",timestamp:Fe.created_at})})}dt.sort((Ze,Fe)=>new Date(Fe.timestamp).getTime()-new Date(Ze.timestamp).getTime()),Le.recent_activities=dt.length>0?dt.slice(0,10):[{id:"demo_activity_1",project_id:n,event_type:"comment",title:"Neuer Kommentar hinzugefügt",description:"Materiallieferung für Freitag geplant",user_name:"Max Mustermann",user_role:"projektleiter",timestamp:new Date(Date.now()-2*60*60*1e3).toISOString()},{id:"demo_activity_2",project_id:n,event_type:"document",title:"Dokument hochgeladen",description:"Bauplan_Final.pdf",user_name:"Anna Schmidt",user_role:"admin",timestamp:new Date(Date.now()-6*60*60*1e3).toISOString()}],i(Le)}catch(F){console.error("Error fetching project data:",F),r({title:"Fehler",description:"Projektdaten konnten nicht geladen werden",variant:"destructive"})}finally{c(!1)}},P=async()=>{var F;try{const{data:T}=await K.auth.getUser();if(!(T!=null&&T.user))return;const{data:q}=await K.from("profiles").select("company_id").eq("id",T.user.id).single();if(!(q!=null&&q.company_id))return;const{data:U}=await K.from("employees").select("id, first_name, last_name, email, position, status").eq("company_id",q.company_id).eq("status","active"),B=((F=a==null?void 0:a.team_members)==null?void 0:F.map($=>$.id))||[];let O=[];const z=new Date().toISOString().split("T")[0];for(const $ of U||[]){if(B.includes($.id))continue;const{data:te}=await K.from("vacation_requests").select("*").eq("employee_id",$.id).in("status",["approved","pending"]).lte("start_date",z).gte("end_date",z);if(te&&te.length>0){O.push({...$,availability_status:"unavailable",reason:te[0].request_type==="vacation"?"Im Urlaub":"Krankgemeldet"});continue}const{data:ee}=await K.from("project_team_members").select("project_id, projects!inner(start_date, end_date, name, status)").eq("employee_id",$.id).neq("project_id",n).in("projects.status",["in_bearbeitung","geplant"]);(ee==null?void 0:ee.some(le=>{const pe=le.projects.start_date,J=le.projects.end_date,ae=a==null?void 0:a.start_date,fe=a==null?void 0:a.end_date;return!pe||!J||!ae||!fe?!1:pe<=fe&&J>=ae}))?O.push({...$,availability_status:"busy",reason:`In ${ee==null?void 0:ee.length} anderen Projekten`}):O.push({...$,availability_status:"available",reason:"Verfügbar"})}E(O)}catch(T){console.error("Error loading available employees:",T)}},R=async F=>{try{const T=S.find(B=>B.id===F);if(!T)return;const q={id:F,name:`${T.first_name} ${T.last_name}`.trim(),role:T.position||"team_member",email:T.email,hours_this_week:0};i(B=>B?{...B,team_members:[...B.team_members||[],q]}:null),E(B=>B.filter(O=>O.id!==F)),N(!1);const{error:U}=await K.from("project_team_members").insert({project_id:n,employee_id:F,assigned_at:new Date().toISOString()});if(U){console.error("Error adding team member:",U),i(B=>B?{...B,team_members:B.team_members.filter(O=>O.id!==F)}:null),E(B=>[...B,T]),r({title:"Fehler",description:"Team-Mitglied konnte nicht hinzugefügt werden",variant:"destructive"});return}r({title:"Erfolg",description:"Team-Mitglied wurde erfolgreich hinzugefügt"})}catch(T){console.error("Error adding team member:",T),r({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}},H=async F=>{try{const T=a==null?void 0:a.team_members.find(U=>U.id===F);if(!T)return;i(U=>U?{...U,team_members:U.team_members.filter(B=>B.id!==F)}:null);const{error:q}=await K.from("project_team_members").delete().eq("project_id",n).eq("employee_id",F);if(q){console.error("Error removing team member:",q),i(U=>U?{...U,team_members:[...U.team_members,T]}:null),r({title:"Fehler",description:"Team-Mitglied konnte nicht entfernt werden",variant:"destructive"});return}r({title:"Erfolg",description:"Team-Mitglied wurde erfolgreich entfernt"})}catch(T){console.error("Error removing team member:",T),r({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}},I=async F=>{if(!(!a||!m.can_change_status))try{const{error:T}=await K.from("projects").update({status:F}).eq("id",a.id);if(T)throw T;i(q=>q?{...q,status:F}:null),r({title:"Erfolg",description:"Projektstatus wurde aktualisiert"})}catch{r({title:"Fehler",description:"Status konnte nicht geändert werden",variant:"destructive"})}},D=F=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(F),W=F=>new Date(F).toLocaleDateString("de-DE"),V=F=>new Date(F).toLocaleString("de-DE"),G=F=>gk[F]||gk.geplant,Y=F=>`P${F.split("-").join("").substring(0,6).toUpperCase()}`;if(o)return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsx(Wt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Projektdaten werden geladen..."})]})})})});if(!a)return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsx(Wt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Jn,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Projekt nicht gefunden"}),s.jsx("p",{className:"text-gray-600",children:"Das angeforderte Projekt konnte nicht geladen werden."}),s.jsx(ne,{onClick:e,className:"mt-4",children:"Schließen"})]})})});const X=G(a.status);return console.log("Project status:",a.status,"Status config:",X),s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-[98vw] max-h-[98vh] w-full h-full overflow-y-auto",children:[s.jsxs(es,{value:p,onValueChange:v,className:"w-full",children:[s.jsxs(tn,{className:"pb-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsxs(nn,{className:"text-2xl flex items-center gap-2",children:[s.jsx(Hr,{className:"h-6 w-6"}),a.project_name]}),s.jsxs(In,{className:"flex items-center gap-4 mt-1",children:[s.jsxs(Be,{className:`${X.bgColor} ${X.color} text-sm`,children:[X.icon," ",X.label]}),s.jsxs("span",{className:"text-gray-500",children:["ID: ",Y(a.id)]})]})]}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Budget / Genutzt"}),s.jsxs("p",{className:"text-3xl font-bold text-green-600",children:[D(a.budget||0)," / ",D(a.stats.total_project_cost||0)]})]})})]}),s.jsxs(Hn,{className:"grid w-full grid-cols-5 mb-4",children:[s.jsx(He,{value:"overview",children:"Übersicht"}),s.jsx(He,{value:"time",children:"Zeiten"}),s.jsx(He,{value:"materials",children:"Material"}),s.jsx(He,{value:"documents",children:"Dokumente"}),s.jsx(He,{value:"comments",children:"Kommentare"})]})]}),s.jsxs(We,{value:"overview",className:"space-y-4 min-h-[600px] mt-0",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Gesamtstunden"}),s.jsxs("p",{className:"text-2xl font-bold",children:[a.stats.total_hours_logged,"h"]})]}),s.jsx(Pt,{className:"h-8 w-8 text-blue-500"})]})})}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Materialkosten"}),s.jsx("p",{className:"text-2xl font-bold",children:D(a.stats.total_material_cost)})]}),s.jsx(u0,{className:"h-8 w-8 text-green-500"})]})})}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Budget-Nutzung"}),s.jsxs("p",{className:"text-2xl font-bold",children:[a.stats.budget_utilization,"%"]})]}),s.jsx(Jn,{className:`h-8 w-8 ${a.stats.budget_utilization>80?"text-red-500":"text-yellow-500"}`})]})})}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Team-Größe"}),s.jsx("p",{className:"text-2xl font-bold",children:a.stats.team_size})]}),s.jsx(Br,{className:"h-8 w-8 text-purple-500"})]})})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Projektdetails"})}),s.jsxs(de,{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Start:"})," ",W(a.start_date)]}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Ende:"})," ",W(a.planned_end_date)]})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Standort"}),s.jsxs("p",{className:"font-medium flex items-center gap-2",children:[s.jsx(Mi,{className:"h-4 w-4"}),a.project_address]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Verbleibende Tage"}),s.jsxs("p",{className:"font-medium",children:[a.stats.days_remaining," Tage"]})]})]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Kundeninformationen"})}),s.jsxs(de,{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Unternehmen"}),s.jsx("p",{className:"font-medium",children:a.customer.company_name})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Ansprechpartner"}),s.jsx("p",{className:"font-medium",children:a.customer.contact_person})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(os,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:a.customer.email})]}),a.customer.phone&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zd,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:a.customer.phone})]})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center justify-between",children:["Team-Mitglieder",m.can_manage_team&&s.jsxs(ne,{size:"sm",variant:"outline",onClick:()=>{P(),N(!0)},children:[s.jsx(rn,{className:"h-4 w-4 mr-1"}),"Hinzufügen"]})]})}),s.jsx(de,{className:"space-y-3",children:a.team_members.map(F=>s.jsx(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{children:s.jsx("p",{className:"font-medium",children:F.name})}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-sm font-medium",children:[F.hours_this_week,"h"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"diese Woche"})]}),m.can_manage_team&&s.jsx(ne,{size:"sm",variant:"ghost",onClick:()=>H(F.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:s.jsx($n,{className:"h-4 w-4"})})]})]})})},F.id))})]}),m.can_change_status&&s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Status ändern"})}),s.jsxs(de,{className:"space-y-2",children:[X.previousStates&&X.previousStates.length>0&&s.jsxs(s.Fragment,{children:[X.previousStates.map(F=>{const T=G(F);return s.jsxs(ne,{variant:"outline",size:"sm",className:"w-full justify-start text-gray-600",onClick:()=>I(F),children:[s.jsx("span",{className:"mr-2",children:"←"})," Zurück zu ",T.label]},F)}),X.nextStates.length>0&&s.jsx("div",{className:"border-t my-2"})]}),X.nextStates.map(F=>{const T=G(F);return s.jsxs(ne,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:()=>I(F),children:[T.icon," ",T.label]},F)})]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Letzte Aktivitäten"})}),s.jsx(de,{className:"space-y-3",children:a.recent_activities.map(F=>s.jsxs("div",{className:"border-l-2 border-blue-200 pl-3",children:[s.jsx("p",{className:"text-sm font-medium",children:F.title}),s.jsx("p",{className:"text-xs text-gray-600",children:F.description}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("span",{className:"text-xs text-gray-500",children:F.user_name}),s.jsx("span",{className:"text-xs text-gray-400",children:"•"}),s.jsx("span",{className:"text-xs text-gray-500",children:V(F.timestamp)})]})]},F.id))})]})]})]})]}),s.jsxs(We,{value:"time",className:"space-y-4 min-h-[600px] mt-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Zeiterfassung"}),m.can_add_time&&s.jsxs(ne,{onClick:()=>x(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Zeit erfassen"]})]}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsx("p",{className:"text-gray-500",children:"Zeiteinträge werden hier angezeigt..."})})})]}),s.jsxs(We,{value:"materials",className:"space-y-4 min-h-[600px] mt-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Materialverwaltung"}),m.can_add_materials&&s.jsxs(ne,{onClick:()=>j(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsx("p",{className:"text-gray-500",children:"Materialeinträge werden hier angezeigt..."})})})]}),s.jsxs(We,{value:"documents",className:"space-y-4 min-h-[600px] mt-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Dokumente"}),m.can_upload_files&&s.jsxs(ne,{children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Datei hochladen"]})]}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsx("p",{className:"text-gray-500",children:"Projektdokumente werden hier angezeigt..."})})})]}),s.jsxs(We,{value:"comments",className:"space-y-4 min-h-[600px] mt-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Kommentare & Notizen"}),s.jsxs(ne,{children:[s.jsx(mP,{className:"h-4 w-4 mr-2"}),"Kommentar hinzufügen"]})]}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsx("p",{className:"text-gray-500",children:"Projektkommentare werden hier angezeigt..."})})})]})]}),s.jsx(Vee,{isOpen:w,onClose:()=>x(!1),projectId:a.id,onTimeEntryAdded:F=>{console.log("Time entry added:",F),r({title:"Erfolg",description:"Arbeitszeit wurde erfasst"})}}),s.jsx(Kee,{isOpen:y,onClose:()=>j(!1),projectId:a.id,onMaterialEntryAdded:F=>{console.log("Material entry added:",F),r({title:"Erfolg",description:"Material wurde erfasst"})}}),b&&s.jsx(Kt,{open:b,onOpenChange:N,children:s.jsxs(Wt,{children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Team-Mitglied hinzufügen"}),s.jsx(In,{children:"Wählen Sie einen Mitarbeiter aus, der dem Projekt hinzugefügt werden soll."})]}),s.jsx("div",{className:"space-y-4",children:S.length===0?s.jsx("p",{className:"text-sm text-gray-500",children:"Keine verfügbaren Mitarbeiter gefunden oder alle sind bereits dem Projekt zugewiesen."}):s.jsx("div",{className:"space-y-2",children:S.map(F=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:`w-3 h-3 rounded-full ${F.availability_status==="available"?"bg-green-500":F.availability_status==="busy"?"bg-yellow-500":"bg-red-500"}`,title:F.reason})}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium",children:[F.first_name," ",F.last_name]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[F.position,s.jsxs("span",{className:`ml-2 text-xs ${F.availability_status==="available"?"text-green-600":F.availability_status==="busy"?"text-yellow-600":"text-red-600"}`,children:["• ",F.reason]})]})]})]}),s.jsx(ne,{size:"sm",onClick:()=>R(F.id),children:s.jsx(rn,{className:"h-4 w-4"})})]},F.id))})})]})})]})})},Gee=({isOpen:t,onClose:e,projectId:n,projectName:r,customerId:a,onCalculationSaved:i})=>{const{toast:o}=It(),[c,d]=g.useState({projectId:n,projectName:r,customerId:a,materials:[],labor:[],subcontractors:[],travelCosts:0,travelDescription:"",safetyBuffer:10,profitMargin:20,materialCosts:0,laborCosts:0,subcontractorCosts:0,totalBaseCosts:0,totalCostsWithBuffer:0,finalPrice:0,notes:""});g.useEffect(()=>{t&&n&&u()},[t,n]);const u=async()=>{try{const{data:C}=await K.from("projects").select("description").eq("id",n).single();if(C!=null&&C.description){const P=C.description.match(/\[PRECALC:(.*?)\]/);if(P)try{const R=JSON.parse(P[1]);console.log("📊 Loading existing calculation:",R),d(H=>({...H,...R,projectId:n,projectName:r,customerId:a})),o({title:"Bestehende Kalkulation geladen",description:"Die vorhandene Vor-Kalkulation wurde geladen."})}catch(R){console.warn("Error parsing existing calculation:",R)}}}catch(C){console.error("Error loading existing calculation:",C)}};g.useEffect(()=>{m()},[c.materials,c.labor,c.subcontractors,c.travelCosts,c.safetyBuffer,c.profitMargin]);const m=()=>{const C=c.materials.reduce((W,V)=>{const Y=V.quantity*V.pricePerUnit*(1+V.markup/100);return W+Y},0),P=c.labor.reduce((W,V)=>W+V.hours*V.workers*V.hourlyRate,0),R=c.subcontractors.reduce((W,V)=>W+V.cost,0),H=C+P+R+c.travelCosts,I=H*(1+c.safetyBuffer/100),D=I*(1+c.profitMargin/100);d(W=>({...W,materialCosts:C,laborCosts:P,subcontractorCosts:R,totalBaseCosts:H,totalCostsWithBuffer:I,finalPrice:D}))},f=()=>{const C={id:Date.now().toString(),name:"",quantity:1,unit:"Stück",pricePerUnit:0,markup:15,totalCost:0,isEstimate:!1};d(P=>({...P,materials:[...P.materials,C]}))},p=()=>{const C={id:Date.now().toString(),description:"",hours:8,workers:1,hourlyRate:45,totalCost:0,isEstimate:!1};d(P=>({...P,labor:[...P.labor,C]}))},v=()=>{const C={id:Date.now().toString(),description:"",supplier:"",cost:0};d(P=>({...P,subcontractors:[...P.subcontractors,C]}))},w=C=>{d(P=>({...P,materials:P.materials.filter(R=>R.id!==C)}))},x=C=>{d(P=>({...P,labor:P.labor.filter(R=>R.id!==C)}))},y=C=>{d(P=>({...P,subcontractors:P.subcontractors.filter(R=>R.id!==C)}))},j=(C,P,R)=>{d(H=>({...H,materials:H.materials.map(I=>I.id===C?{...I,[P]:R}:I)}))},b=(C,P,R)=>{d(H=>({...H,labor:H.labor.map(I=>I.id===C?{...I,[P]:R}:I)}))},N=(C,P,R)=>{d(H=>({...H,subcontractors:H.subcontractors.map(I=>I.id===C?{...I,[P]:R}:I)}))},S=async()=>{try{const C={...c,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};if((c.isEstimate||c.materials.some(W=>W.isEstimate))&&!await EV({projectId:n,estimate:C,userId:void 0}))return;const P=`[PRECALC:${JSON.stringify(C)}]`,R={},{data:H}=await K.from("projects").select("description, budget").eq("id",n).single();let I=P;H!=null&&H.description&&!H.description.includes("[PRECALC:")?I=`${H.description} ${P}`:H!=null&&H.description&&H.description.includes("[PRECALC:")&&(I=H.description.replace(/\[PRECALC:.*?\]/,P)),R.description=I,R.budget=Math.round(c.finalPrice),console.log("💰 Setting project budget to:",R.budget);const{error:D}=await K.from("projects").update(R).eq("id",n);if(D)throw D;o({title:"Vor-Kalkulation gespeichert",description:`Budget wurde auf €${c.finalPrice.toFixed(2)} gesetzt`}),i==null||i(C),e()}catch(C){console.error("Error saving pre-calculation:",C),o({title:"Fehler",description:"Vor-Kalkulation konnte nicht gespeichert werden",variant:"destructive"})}},E=C=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(C);return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(tn,{children:[s.jsxs(nn,{className:"flex items-center gap-2",children:[s.jsx(ca,{className:"h-5 w-5"}),"Vor-Kalkulation: ",r]}),s.jsx(In,{children:"Detaillierte Kostenberechnung für das Projekt erstellen"})]}),s.jsxs(es,{defaultValue:"materials",className:"w-full",children:[s.jsxs(Hn,{className:"grid w-full grid-cols-5",children:[s.jsx(He,{value:"materials",children:"Material"}),s.jsx(He,{value:"labor",children:"Arbeitszeit"}),s.jsx(He,{value:"subcontractors",children:"Fremdleistungen"}),s.jsx(He,{value:"costs",children:"Zusatzkosten"}),s.jsx(He,{value:"summary",children:"Zusammenfassung"})]}),s.jsxs(We,{value:"materials",className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Materialkosten"}),s.jsxs(ne,{onClick:f,size:"sm",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),s.jsxs("div",{className:"space-y-4",children:[c.materials.map((C,P)=>s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"grid grid-cols-8 gap-4 items-center",children:[s.jsxs("div",{children:[s.jsx(se,{children:"Material"}),s.jsx(re,{value:C.name,onChange:R=>j(C.id,"name",R.target.value),placeholder:"z.B. Fliesen 30x30cm"})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Menge"}),s.jsx(re,{type:"number",value:C.quantity,onChange:R=>j(C.id,"quantity",parseFloat(R.target.value)||0)})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Einheit"}),s.jsxs(ut,{value:C.unit,onValueChange:R=>j(C.id,"unit",R),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Stück",children:"Stück"}),s.jsx(xe,{value:"m²",children:"m²"}),s.jsx(xe,{value:"m",children:"m"}),s.jsx(xe,{value:"kg",children:"kg"}),s.jsx(xe,{value:"l",children:"l"}),s.jsx(xe,{value:"Paket",children:"Paket"})]})]})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Preis/Einheit"}),s.jsx(re,{type:"number",step:"0.01",value:C.pricePerUnit,onChange:R=>j(C.id,"pricePerUnit",parseFloat(R.target.value)||0)})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Aufschlag %"}),s.jsx(re,{type:"number",value:C.markup,onChange:R=>j(C.id,"markup",parseFloat(R.target.value)||0)})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Gesamt"}),s.jsx("div",{className:"font-bold",children:E(C.quantity*C.pricePerUnit*(1+C.markup/100))})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Schätzung"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Js,{checked:C.isEstimate,onCheckedChange:R=>j(C.id,"isEstimate",R)}),s.jsx("span",{className:"text-sm text-gray-600",children:C.isEstimate?"Schätzung":"Bestätigt"})]})]}),s.jsx("div",{children:s.jsx(ne,{variant:"outline",size:"sm",onClick:()=>w(C.id),className:"text-red-600",children:s.jsx(Va,{className:"h-4 w-4"})})})]})})},C.id)),c.materials.length===0&&s.jsx("div",{className:"text-center text-gray-500 py-8",children:'Noch keine Materialien hinzugefügt. Klicken Sie auf "Material hinzufügen" um zu beginnen.'})]}),s.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-semibold",children:"Gesamte Materialkosten:"}),s.jsx("span",{className:"text-xl font-bold text-blue-600",children:E(c.materialCosts)})]})})]}),s.jsxs(We,{value:"labor",className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Arbeitszeit & Lohnkosten"}),s.jsxs(ne,{onClick:p,size:"sm",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Arbeitsposition hinzufügen"]})]}),s.jsxs("div",{className:"space-y-4",children:[c.labor.map(C=>s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"grid grid-cols-7 gap-4 items-center",children:[s.jsxs("div",{className:"col-span-2",children:[s.jsx(se,{children:"Arbeitsposition"}),s.jsx(re,{value:C.description,onChange:P=>b(C.id,"description",P.target.value),placeholder:"z.B. Fliesen verlegen"})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Stunden"}),s.jsx(re,{type:"number",step:"0.5",value:C.hours,onChange:P=>b(C.id,"hours",parseFloat(P.target.value)||0)})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Personen"}),s.jsx(re,{type:"number",value:C.workers,onChange:P=>b(C.id,"workers",parseInt(P.target.value)||1)})]}),s.jsxs("div",{children:[s.jsx(se,{children:"€/Stunde"}),s.jsx(re,{type:"number",step:"0.01",value:C.hourlyRate,onChange:P=>b(C.id,"hourlyRate",parseFloat(P.target.value)||0)})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Gesamt"}),s.jsx("div",{className:"font-bold",children:E(C.hours*C.workers*C.hourlyRate)})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Schätzung"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Js,{checked:C.isEstimate,onCheckedChange:P=>b(C.id,"isEstimate",P)}),s.jsx("span",{className:"text-sm text-gray-600",children:C.isEstimate?"Schätzung":"Bestätigt"})]}),s.jsx(ne,{variant:"outline",size:"sm",onClick:()=>x(C.id),className:"text-red-600 mt-2",children:s.jsx(Va,{className:"h-4 w-4"})})]})]})})},C.id)),c.labor.length===0&&s.jsx("div",{className:"text-center text-gray-500 py-8",children:"Noch keine Arbeitspositionen hinzugefügt."})]}),s.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-semibold",children:"Gesamte Lohnkosten:"}),s.jsx("span",{className:"text-xl font-bold text-green-600",children:E(c.laborCosts)})]})})]}),s.jsxs(We,{value:"subcontractors",className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Fremdleistungen & Subunternehmer"}),s.jsxs(ne,{onClick:v,size:"sm",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Fremdleistung hinzufügen"]})]}),s.jsxs("div",{className:"space-y-4",children:[c.subcontractors.map(C=>s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[s.jsxs("div",{className:"col-span-2",children:[s.jsx(se,{children:"Leistung"}),s.jsx(re,{value:C.description,onChange:P=>N(C.id,"description",P.target.value),placeholder:"z.B. Elektroinstallation"})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Anbieter"}),s.jsx(re,{value:C.supplier,onChange:P=>N(C.id,"supplier",P.target.value),placeholder:"Firma/Name"})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Kosten"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(re,{type:"number",step:"0.01",value:C.cost,onChange:P=>N(C.id,"cost",parseFloat(P.target.value)||0)}),s.jsx(ne,{variant:"outline",size:"sm",onClick:()=>y(C.id),className:"text-red-600",children:s.jsx(Va,{className:"h-4 w-4"})})]})]})]})})},C.id)),c.subcontractors.length===0&&s.jsx("div",{className:"text-center text-gray-500 py-8",children:"Noch keine Fremdleistungen hinzugefügt."})]}),s.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-semibold",children:"Gesamte Fremdleistungen:"}),s.jsx("span",{className:"text-xl font-bold text-purple-600",children:E(c.subcontractorCosts)})]})})]}),s.jsxs(We,{value:"costs",className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Zusatzkosten & Zuschläge"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Fahrtkosten"})}),s.jsxs(de,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{children:"Beschreibung"}),s.jsx(re,{value:c.travelDescription,onChange:C=>d(P=>({...P,travelDescription:C.target.value})),placeholder:"z.B. 50km Anfahrt × 2 Fahrten"})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Kosten"}),s.jsx(re,{type:"number",step:"0.01",value:c.travelCosts,onChange:C=>d(P=>({...P,travelCosts:parseFloat(C.target.value)||0}))})]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Zuschläge & Margen"})}),s.jsxs(de,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{children:"Sicherheitszuschlag (%)"}),s.jsx(re,{type:"number",value:c.safetyBuffer,onChange:C=>d(P=>({...P,safetyBuffer:parseFloat(C.target.value)||0}))}),s.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Üblich: 5-15% für unvorhergesehene Kosten"})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Gewinnmarge (%)"}),s.jsx(re,{type:"number",value:c.profitMargin,onChange:C=>d(P=>({...P,profitMargin:parseFloat(C.target.value)||0}))}),s.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Üblich: 15-25% je nach Wettbewerb"})]})]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Notizen & Bemerkungen"})}),s.jsx(de,{children:s.jsx(Cn,{value:c.notes,onChange:C=>d(P=>({...P,notes:C.target.value})),placeholder:"Zusätzliche Hinweise zur Kalkulation...",rows:4})})]})]}),s.jsxs(We,{value:"summary",className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Kalkulationsergebnis"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Kostenaufstellung"})}),s.jsxs(de,{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Materialkosten:"}),s.jsx("span",{className:"font-medium",children:E(c.materialCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Lohnkosten:"}),s.jsx("span",{className:"font-medium",children:E(c.laborCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fremdleistungen:"}),s.jsx("span",{className:"font-medium",children:E(c.subcontractorCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fahrtkosten:"}),s.jsx("span",{className:"font-medium",children:E(c.travelCosts)})]}),s.jsx("hr",{}),s.jsxs("div",{className:"flex justify-between font-semibold",children:[s.jsx("span",{children:"Grundkosten:"}),s.jsx("span",{children:E(c.totalBaseCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:["+ Sicherheit (",c.safetyBuffer,"%):"]}),s.jsx("span",{children:E(c.totalCostsWithBuffer-c.totalBaseCosts)})]}),s.jsxs("div",{className:"flex justify-between font-semibold",children:[s.jsx("span",{children:"Kosten mit Puffer:"}),s.jsx("span",{children:E(c.totalCostsWithBuffer)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:["+ Gewinn (",c.profitMargin,"%):"]}),s.jsx("span",{children:E(c.finalPrice-c.totalCostsWithBuffer)})]}),s.jsx("hr",{className:"border-2"}),s.jsxs("div",{className:"flex justify-between text-xl font-bold text-green-600",children:[s.jsx("span",{children:"Verkaufspreis:"}),s.jsx("span",{children:E(c.finalPrice)})]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Kennzahlen"})}),s.jsxs(de,{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Materialanteil:"}),s.jsxs("span",{children:[(c.materialCosts/c.totalBaseCosts*100||0).toFixed(1),"%"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Lohnanteil:"}),s.jsxs("span",{children:[(c.laborCosts/c.totalBaseCosts*100||0).toFixed(1),"%"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fremdleistungsanteil:"}),s.jsxs("span",{children:[(c.subcontractorCosts/c.totalBaseCosts*100||0).toFixed(1),"%"]})]}),s.jsx("hr",{}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Deckungsbeitrag:"}),s.jsx("span",{className:"font-medium",children:E(c.finalPrice-c.totalBaseCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Deckungsgrad:"}),s.jsxs("span",{children:[((c.finalPrice/c.totalBaseCosts-1)*100||0).toFixed(1),"%"]})]})]})]})]}),c.notes&&s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Notizen"})}),s.jsx(de,{children:s.jsx("div",{className:"whitespace-pre-wrap text-sm",children:c.notes})})]})]})]}),s.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[s.jsx(ne,{variant:"outline",onClick:e,children:"Abbrechen"}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(ne,{onClick:S,className:"flex items-center gap-2",children:[s.jsx(zh,{className:"h-4 w-4"}),"Kalkulation speichern"]})})]})]})})};function Qee(t,e=[]){let n=[];function r(i,o){const c=g.createContext(o),d=n.length;n=[...n,o];function u(f){const{scope:p,children:v,...w}=f,x=(p==null?void 0:p[t][d])||c,y=g.useMemo(()=>w,Object.values(w));return s.jsx(x.Provider,{value:y,children:v})}function m(f,p){const v=(p==null?void 0:p[t][d])||c,w=g.useContext(v);if(w)return w;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,m]}const a=()=>{const i=n.map(o=>g.createContext(o));return function(c){const d=(c==null?void 0:c[t])||i;return g.useMemo(()=>({[`__scope${t}`]:{...c,[t]:d}}),[c,d])}};return a.scopeName=t,[r,Yee(a,...e)]}function Yee(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=r.reduce((c,{useScope:d,scopeName:u})=>{const f=d(i)[`__scope${u}`];return{...c,...f}},{});return g.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var R1="Progress",I1=100,[Xee,Iae]=Qee(R1),[Jee,ete]=Xee(R1),xI=g.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:a,getValueLabel:i=tte,...o}=t;(a||a===0)&&!YC(a)&&console.error(nte(`${a}`,"Progress"));const c=YC(a)?a:I1;r!==null&&!XC(r,c)&&console.error(ste(`${r}`,"Progress"));const d=XC(r,c)?r:null,u=q0(d)?i(d,c):void 0;return s.jsx(Jee,{scope:n,value:d,max:c,children:s.jsx(tt.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":q0(d)?d:void 0,"aria-valuetext":u,role:"progressbar","data-state":_I(d,c),"data-value":d??void 0,"data-max":c,...o,ref:e})})});xI.displayName=R1;var vI="ProgressIndicator",yI=g.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,a=ete(vI,n);return s.jsx(tt.div,{"data-state":_I(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...r,ref:e})});yI.displayName=vI;function tte(t,e){return`${Math.round(t/e*100)}%`}function _I(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function q0(t){return typeof t=="number"}function YC(t){return q0(t)&&!isNaN(t)&&t>0}function XC(t,e){return q0(t)&&!isNaN(t)&&t<=e&&t>=0}function nte(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${I1}\`.`}function ste(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${I1} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var wI=xI,rte=yI;const zo=g.forwardRef(({className:t,value:e,...n},r)=>s.jsx(wI,{ref:r,className:Ie("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:s.jsx(rte,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));zo.displayName=wI.displayName;const ate=({isOpen:t,onClose:e,projectId:n,projectName:r})=>{const{toast:a}=It(),[i,o]=g.useState(null),[c,d]=g.useState(null),[u,m]=g.useState(!0);g.useEffect(()=>{t&&n&&f()},[t,n]);const f=async()=>{m(!0);try{const{data:j,error:b}=await K.from("projects").select("*").eq("id",n).single();if(b||!j)throw new Error("Projekt nicht gefunden");let N=null;if(j.description){const G=j.description.match(/\[PRECALC:(.*?)\]/);if(G)try{N=JSON.parse(G[1]),d(N)}catch(Y){console.warn("Fehler beim Parsen der Vor-Kalkulation:",Y)}}const S=[{hours:45,hourlyRate:45,cost:45*45},{hours:12,hourlyRate:55,cost:12*55}],E=[{name:"Fliesen",cost:850},{name:"Kleber",cost:120},{name:"Fugenmasse",cost:75}],C=N||{materialCosts:0,laborCosts:0,subcontractorCosts:0,travelCosts:0,totalBaseCosts:0,finalPrice:j.budget||0,profitMargin:20},P=E.reduce((G,Y)=>G+Y.cost,0),R=S.reduce((G,Y)=>G+Y.cost,0),H=P+R,I=j.budget||C.finalPrice,D=I-H,W=I>0?D/I*100:0,V={project:j,plannedMaterialCosts:C.materialCosts||0,plannedLaborCosts:C.laborCosts||0,plannedSubcontractorCosts:C.subcontractorCosts||0,plannedTravelCosts:C.travelCosts||0,plannedTotalCosts:C.totalBaseCosts||0,plannedPrice:C.finalPrice||0,plannedProfit:(C.finalPrice||0)-(C.totalBaseCosts||0),plannedProfitMargin:C.profitMargin||20,actualMaterialCosts:P,actualLaborCosts:R,actualSubcontractorCosts:0,actualTravelCosts:50,actualTotalCosts:H,actualPrice:I,actualProfit:D,actualProfitMargin:W,materialDeviation:P-(C.materialCosts||0),laborDeviation:R-(C.laborCosts||0),subcontractorDeviation:0,totalCostDeviation:H-(C.totalBaseCosts||0),profitDeviation:D-((C.finalPrice||0)-(C.totalBaseCosts||0)),budgetUtilization:C.totalBaseCosts>0?H/C.totalBaseCosts*100:0,efficiency:C.laborCosts>0?C.laborCosts/R*100:100,status:D>0?"profitable":D===0?"break_even":"loss"};o(V)}catch(j){console.error("Fehler beim Laden der Rentabilitätsdaten:",j),a({title:"Fehler",description:"Rentabilitätsdaten konnten nicht geladen werden",variant:"destructive"})}finally{m(!1)}},p=j=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(j),v=(j,b=1)=>`${j.toFixed(b)}%`,w=j=>j>0?"text-red-600":j<0?"text-green-600":"text-gray-600",x=j=>j>0?s.jsx(Ei,{className:"h-4 w-4 text-red-600"}):j<0?s.jsx(aj,{className:"h-4 w-4 text-green-600"}):s.jsx(ls,{className:"h-4 w-4 text-gray-600"}),y=j=>{switch(j){case"profitable":return s.jsx(Be,{className:"bg-green-100 text-green-800",children:"Rentabel"});case"break_even":return s.jsx(Be,{className:"bg-yellow-100 text-yellow-800",children:"Break-Even"});case"loss":return s.jsx(Be,{className:"bg-red-100 text-red-800",children:"Verlust"});default:return s.jsx(Be,{variant:"outline",children:"Unbekannt"})}};return u?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsx(Wt,{className:"max-w-4xl",children:s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),s.jsx("p",{className:"mt-2 text-gray-600",children:"Rentabilitätsdaten werden geladen..."})]})})})}):i?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(tn,{children:[s.jsxs(nn,{className:"flex items-center gap-2",children:[s.jsx(ca,{className:"h-5 w-5"}),"Nachkalkulation & Rentabilität: ",r]}),s.jsxs(In,{className:"flex items-center gap-4",children:[s.jsx("span",{children:"Vergleich von geplanten und tatsächlichen Kosten"}),y(i.status)]})]}),s.jsxs(es,{defaultValue:"overview",className:"w-full",children:[s.jsxs(Hn,{className:"grid w-full grid-cols-5",children:[s.jsx(He,{value:"overview",children:"Übersicht"}),s.jsx(He,{value:"costs",children:"Kostenanalyse"}),s.jsx(He,{value:"estimates",children:"Schätzungen vs. Ist"}),s.jsx(He,{value:"deviations",children:"Abweichungen"}),s.jsx(He,{value:"kpis",children:"Kennzahlen"})]}),s.jsxs(We,{value:"overview",className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(u0,{className:"h-5 w-5 text-green-600"}),"Gewinn"]})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Geplant:"}),s.jsx("span",{children:p(i.plannedProfit)})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Tatsächlich:"}),s.jsx("span",{className:i.actualProfit>=0?"text-green-600 font-semibold":"text-red-600 font-semibold",children:p(i.actualProfit)})]}),s.jsxs("div",{className:"flex justify-between items-center text-sm border-t pt-2",children:[s.jsx("span",{className:"text-gray-600",children:"Abweichung:"}),s.jsxs("div",{className:"flex items-center gap-1",children:[x(i.profitDeviation),s.jsx("span",{className:w(i.profitDeviation),children:p(Math.abs(i.profitDeviation))})]})]})]})})]}),s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Qa,{className:"h-5 w-5 text-blue-600"}),"Budget-Nutzung"]})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Geplante Kosten:"}),s.jsx("span",{children:p(i.plannedTotalCosts)})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Tatsächliche Kosten:"}),s.jsx("span",{children:p(i.actualTotalCosts)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Auslastung:"}),s.jsx("span",{className:i.budgetUtilization>100?"text-red-600 font-semibold":"text-green-600",children:v(i.budgetUtilization)})]}),s.jsx(zo,{value:Math.min(i.budgetUtilization,100),className:"h-2"})]})]})})]}),s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Pt,{className:"h-5 w-5 text-purple-600"}),"Arbeitseffizienz"]})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Geplante Stunden:"}),s.jsxs("span",{children:[(i.plannedLaborCosts/45).toFixed(1),"h"]})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Tatsächliche Stunden:"}),s.jsxs("span",{children:[(i.actualLaborCosts/45).toFixed(1),"h"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Effizienz:"}),s.jsx("span",{className:i.efficiency>=100?"text-green-600 font-semibold":"text-orange-600",children:v(i.efficiency)})]}),s.jsx(zo,{value:Math.min(i.efficiency,100),className:"h-2"})]})]})})]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Projekt-Zusammenfassung"})}),s.jsx(de,{children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p(i.actualPrice)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Verkaufspreis"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:p(i.actualTotalCosts)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Gesamtkosten"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`text-2xl font-bold ${i.actualProfit>=0?"text-green-600":"text-red-600"}`,children:p(i.actualProfit)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Gewinn/Verlust"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`text-2xl font-bold ${i.actualProfitMargin>=0?"text-green-600":"text-red-600"}`,children:v(i.actualProfitMargin)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Gewinnmarge"})]})]})})]})]}),s.jsx(We,{value:"costs",className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Geplante Kosten"})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Material:"}),s.jsx("span",{children:p(i.plannedMaterialCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Lohn:"}),s.jsx("span",{children:p(i.plannedLaborCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fremdleistungen:"}),s.jsx("span",{children:p(i.plannedSubcontractorCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fahrtkosten:"}),s.jsx("span",{children:p(i.plannedTravelCosts)})]}),s.jsx("hr",{}),s.jsxs("div",{className:"flex justify-between font-semibold",children:[s.jsx("span",{children:"Gesamt:"}),s.jsx("span",{children:p(i.plannedTotalCosts)})]})]})})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Tatsächliche Kosten"})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Material:"}),s.jsx("span",{children:p(i.actualMaterialCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Lohn:"}),s.jsx("span",{children:p(i.actualLaborCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fremdleistungen:"}),s.jsx("span",{children:p(i.actualSubcontractorCosts)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Fahrtkosten:"}),s.jsx("span",{children:p(i.actualTravelCosts)})]}),s.jsx("hr",{}),s.jsxs("div",{className:"flex justify-between font-semibold",children:[s.jsx("span",{children:"Gesamt:"}),s.jsx("span",{children:p(i.actualTotalCosts)})]})]})})]})]})}),s.jsx(We,{value:"estimates",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(ca,{className:"h-5 w-5 text-blue-600"}),"Schätzungen vs. Bestätigte Werte vs. Tatsächlicher Verbrauch"]}),s.jsx(CardDescription,{children:"Vergleich zwischen geschätzten Werten, bestätigten Planungswerten und dem tatsächlichen Materialverbrauch"})]}),s.jsx(de,{children:c?s.jsxs("div",{className:"space-y-6",children:[c.materials&&c.materials.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[s.jsx(Qa,{className:"h-4 w-4"}),"Material-Vergleich"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-6 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[s.jsx("span",{children:"Material"}),s.jsx("span",{children:"Geplant"}),s.jsx("span",{children:"Status"}),s.jsx("span",{children:"Tatsächlich"}),s.jsx("span",{children:"Abweichung"}),s.jsx("span",{children:"Typ"})]}),c.materials.map((j,b)=>{const N=b===0?850:b===1?120:95,S=j.quantity*j.pricePerUnit*(1+j.markup/100),E=N-S;return s.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-b",children:[s.jsx("span",{className:"text-sm",children:j.name||"Material "+(b+1)}),s.jsx("span",{className:"text-sm",children:p(S)}),s.jsx("div",{children:j.isEstimate?s.jsx(Be,{variant:"outline",className:"text-orange-600 border-orange-600 text-xs",children:"Schätzung"}):s.jsx(Be,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Bestätigt"})}),s.jsx("span",{className:"text-sm",children:p(N)}),s.jsxs("div",{className:"flex items-center gap-1",children:[x(E),s.jsx("span",{className:`text-sm ${w(E)}`,children:p(Math.abs(E))})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[j.unit," (",j.quantity,"x)"]})]},j.id)})]})]}),c.labor&&c.labor.length>0&&s.jsxs("div",{children:[s.jsxs("h4",{className:"font-semibold mb-4 flex items-center gap-2",children:[s.jsx(Br,{className:"h-4 w-4"}),"Arbeitszeit-Vergleich"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-6 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[s.jsx("span",{children:"Arbeitsposition"}),s.jsx("span",{children:"Geplant"}),s.jsx("span",{children:"Status"}),s.jsx("span",{children:"Tatsächlich"}),s.jsx("span",{children:"Abweichung"}),s.jsx("span",{children:"Details"})]}),c.labor.map((j,b)=>{const N=b===0?2025:660,S=j.hours*j.workers*j.hourlyRate,E=N-S;return s.jsxs("div",{className:"grid grid-cols-6 gap-4 items-center py-2 border-b",children:[s.jsx("span",{className:"text-sm",children:j.description||"Arbeitsposition "+(b+1)}),s.jsx("span",{className:"text-sm",children:p(S)}),s.jsx("div",{children:j.isEstimate?s.jsx(Be,{variant:"outline",className:"text-orange-600 border-orange-600 text-xs",children:"Schätzung"}):s.jsx(Be,{variant:"outline",className:"text-green-600 border-green-600 text-xs",children:"Bestätigt"})}),s.jsx("span",{className:"text-sm",children:p(N)}),s.jsxs("div",{className:"flex items-center gap-1",children:[x(E),s.jsx("span",{className:`text-sm ${w(E)}`,children:p(Math.abs(E))})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[j.hours,"h × ",j.workers," Pers."]})]},j.id)})]})]}),s.jsxs("div",{className:"mt-6",children:[s.jsx("h4",{className:"font-semibold mb-4",children:"Schätzungsgenauigkeit"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsx(oe,{className:"bg-orange-50",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:c.materials?c.materials.filter(j=>j.isEstimate).length:0}),s.jsx("div",{className:"text-sm text-orange-700",children:"Material-Schätzungen"})]})})}),s.jsx(oe,{className:"bg-green-50",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:c.materials?c.materials.filter(j=>!j.isEstimate).length:0}),s.jsx("div",{className:"text-sm text-green-700",children:"Bestätigte Materialien"})]})})}),s.jsx(oe,{className:"bg-blue-50",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[c.materials&&c.labor?Math.round(100-Math.abs(i.totalCostDeviation)/i.plannedTotalCosts*100):0,"%"]}),s.jsx("div",{className:"text-sm text-blue-700",children:"Gesamt-Genauigkeit"})]})})})]})]}),s.jsx("div",{className:"mt-6",children:s.jsxs(oe,{className:"bg-blue-50",children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2 text-blue-700",children:[s.jsx(Jn,{className:"h-5 w-5"}),"Empfehlungen für zukünftige Schätzungen"]})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-2 text-blue-700",children:[s.jsx("p",{children:"• Als Schätzung markierte Positionen sollten vor Projektbeginn noch einmal überprüft werden"}),s.jsx("p",{children:"• Verwenden Sie bestätigte Werte aus ähnlichen abgeschlossenen Projekten"}),s.jsx("p",{children:"• Planen Sie für geschätzte Positionen einen höheren Sicherheitspuffer ein"}),s.jsx("p",{children:"• Dokumentieren Sie Abweichungen zwischen Schätzungen und tatsächlichen Werten für bessere zukünftige Kalkulationen"})]})})]})})]}):s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(ca,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Vor-Kalkulation verfügbar"}),s.jsx("p",{children:"Für dieses Projekt wurde keine detaillierte Vor-Kalkulation mit Schätzungsmarkierungen erstellt."})]})})]})}),s.jsxs(We,{value:"deviations",className:"space-y-6",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Kostenabweichungen"})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm font-medium text-gray-600 border-b pb-2",children:[s.jsx("span",{children:"Kategorie"}),s.jsx("span",{children:"Geplant"}),s.jsx("span",{children:"Tatsächlich"}),s.jsx("span",{children:"Abweichung"})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[s.jsx("span",{children:"Material"}),s.jsx("span",{children:p(i.plannedMaterialCosts)}),s.jsx("span",{children:p(i.actualMaterialCosts)}),s.jsxs("div",{className:"flex items-center gap-2",children:[x(i.materialDeviation),s.jsx("span",{className:w(i.materialDeviation),children:p(Math.abs(i.materialDeviation))})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center",children:[s.jsx("span",{children:"Lohn"}),s.jsx("span",{children:p(i.plannedLaborCosts)}),s.jsx("span",{children:p(i.actualLaborCosts)}),s.jsxs("div",{className:"flex items-center gap-2",children:[x(i.laborDeviation),s.jsx("span",{className:w(i.laborDeviation),children:p(Math.abs(i.laborDeviation))})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 items-center border-t pt-2",children:[s.jsx("span",{className:"font-semibold",children:"Gesamtabweichung"}),s.jsx("span",{className:"font-semibold",children:p(i.plannedTotalCosts)}),s.jsx("span",{className:"font-semibold",children:p(i.actualTotalCosts)}),s.jsxs("div",{className:"flex items-center gap-2",children:[x(i.totalCostDeviation),s.jsx("span",{className:`font-semibold ${w(i.totalCostDeviation)}`,children:p(Math.abs(i.totalCostDeviation))})]})]})]})})]}),i.totalCostDeviation>0&&s.jsxs(oe,{className:"border-red-200 bg-red-50",children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2 text-red-700",children:[s.jsx(Jn,{className:"h-5 w-5"}),"Kostenüberschreitung"]})}),s.jsx(de,{children:s.jsxs("p",{className:"text-red-700",children:["Das Projekt hat die geplanten Kosten um ",p(i.totalCostDeviation)," überschritten. Das entspricht einer Überschreitung von ",v(i.totalCostDeviation/i.plannedTotalCosts*100),"."]})})]})]}),s.jsxs(We,{value:"kpis",className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Rentabilitäts-KPIs"})}),s.jsxs(de,{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Gewinnmarge (geplant):"}),s.jsx("span",{className:"font-semibold",children:v(i.plannedProfitMargin)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Gewinnmarge (tatsächlich):"}),s.jsx("span",{className:`font-semibold ${i.actualProfitMargin>=0?"text-green-600":"text-red-600"}`,children:v(i.actualProfitMargin)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"ROI (Return on Investment):"}),s.jsx("span",{className:`font-semibold ${i.actualProfit>=0?"text-green-600":"text-red-600"}`,children:v(i.actualProfit/i.actualTotalCosts*100)})]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Effizienz-KPIs"})}),s.jsxs(de,{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Budget-Ausschöpfung:"}),s.jsx("span",{className:`font-semibold ${i.budgetUtilization>100?"text-red-600":"text-green-600"}`,children:v(i.budgetUtilization)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Arbeitseffizienz:"}),s.jsx("span",{className:`font-semibold ${i.efficiency>=100?"text-green-600":"text-orange-600"}`,children:v(i.efficiency)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Kostengenauigkeit:"}),s.jsx("span",{className:"font-semibold",children:v(100-Math.abs(i.totalCostDeviation/i.plannedTotalCosts*100))})]})]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Empfehlungen für zukünftige Projekte"})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-3",children:[i.materialDeviation>i.plannedMaterialCosts*.1&&s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-yellow-50 rounded-lg",children:[s.jsx(Jn,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-yellow-800",children:"Materialkosten-Planung verbessern"}),s.jsxs("div",{className:"text-sm text-yellow-700",children:["Materialkosten waren ",v(i.materialDeviation/i.plannedMaterialCosts*100)," höher als geplant. Prüfen Sie Ihre Lieferantenpreise und Mengenschätzungen."]})]})]}),i.efficiency<90&&s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[s.jsx(Pt,{className:"h-5 w-5 text-blue-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-blue-800",children:"Arbeitsplanung optimieren"}),s.jsxs("div",{className:"text-sm text-blue-700",children:["Die Arbeitseffizienz lag bei nur ",v(i.efficiency),". Überprüfen Sie die Zeitschätzungen und Arbeitsabläufe."]})]})]}),i.actualProfitMargin>i.plannedProfitMargin*1.2&&s.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[s.jsx(ls,{className:"h-5 w-5 text-green-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-green-800",children:"Sehr gute Rentabilität"}),s.jsx("div",{className:"text-sm text-green-700",children:"Das Projekt war deutlich rentabler als geplant. Diese Kalkulations-Ansätze können als Vorlage für ähnliche Projekte dienen."})]})]})]})})]})]})]}),s.jsx("div",{className:"flex justify-end pt-4 border-t",children:s.jsx(ne,{onClick:e,children:"Schließen"})})]})}):s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsx(Wt,{className:"max-w-4xl",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Jn,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Daten verfügbar"}),s.jsx("p",{className:"text-gray-600",children:"Für dieses Projekt konnten keine Rentabilitätsdaten geladen werden."})]})})})};function ite({active:t,done:e,budget:n,late:r}){return s.jsxs("section",{"aria-label":"Kennzahlen",className:`sticky top-0 z-10 grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\r
                 backdrop-blur-md bg-background/70 border rounded-2xl p-3 shadow-soft`,children:[s.jsx(lp,{title:"Aktive Projekte",value:t}),s.jsx(lp,{title:"Abgeschlossene",value:e}),s.jsx(lp,{title:"Gesamtbudget",value:`€${(n||0).toLocaleString("de-DE")}`}),s.jsx(lp,{title:"Verspätet",value:r})]})}function lp({title:t,value:e}){return s.jsxs("div",{className:"bg-card border rounded-xl px-4 py-3 flex items-center justify-between",children:[s.jsx("div",{className:"text-xs text-muted-foreground font-semibold",children:t}),s.jsx("div",{className:"text-xl font-bold",children:e})]})}function ote({counts:t}){const e=[{label:"Anfrage",key:"anfrage",dot:"bg-blue-400"},{label:"Termin ausmachen",key:"besichtigung",dot:"bg-sky-400"},{label:"In Planung",key:"geplant",dot:"bg-amber-400"},{label:"In Arbeit",key:"in_bearbeitung",dot:"bg-yellow-400"},{label:"Erledigt",key:"abgeschlossen",dot:"bg-green-500"}];return s.jsx("div",{className:"grid grid-cols-[1fr_auto] gap-2 text-sm",children:e.map(n=>s.jsxs(Ae.Fragment,{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`inline-block w-2.5 h-2.5 rounded-full ${n.dot}`}),s.jsx("span",{children:n.label})]}),s.jsx("span",{className:"font-medium",children:t[n.key]})]},n.key))})}const JC={anfrage:{label:"Anfrage",cls:"bg-purple-100 text-purple-800 border-purple-200"},besichtigung:{label:"Termin ausmachen",cls:"bg-orange-100  text-orange-800  border-orange-200"},geplant:{label:"In Planung",cls:"bg-blue-100   text-blue-800   border-blue-200"},in_bearbeitung:{label:"In Arbeit",cls:"bg-yellow-100 text-yellow-800 border-yellow-200"},abgeschlossen:{label:"Erledigt",cls:"bg-green-100  text-green-800  border-green-200"}};function eE(t){const e=JC[t.status]||JC.geplant,n=r=>r?new Date(r).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"}):"—";return s.jsxs("div",{className:"flex flex-col gap-2 py-2 cursor-pointer",onDoubleClick:t.onOpen,children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[s.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${e.cls}`,children:e.label}),s.jsx("strong",{className:"mr-2",children:t.name}),s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-blue-50 text-blue-700 border-blue-200",children:["ID: ",t.id]})]}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:["Start: ",n(t.start)," • Ende: ",n(t.end)," • Budget:"," ",s.jsxs("strong",{className:"text-green-600",children:["€",(t.budget||0).toLocaleString("de-DE")]})]}),typeof t.progress=="number"&&s.jsx("div",{className:"h-2 w-full rounded-full bg-neutral-200 overflow-hidden",children:s.jsx("div",{className:"h-full rounded-full bg-blue-500 transition-all",style:{width:`${t.progress}%`},"aria-valuenow":t.progress,"aria-valuemin":0,"aria-valuemax":100,role:"progressbar"})})]})}const tE=t=>`P${t.split("-").join("").substring(0,6).toUpperCase()}`,Ly=t=>{if(!t)return 0;const e=t.match(/\[BUDGET:(\d+\.?\d*)\]/);return e?parseFloat(e[1]):0},lte=()=>{It();const{companyId:t}=Vr(),{data:e,isLoading:n}=p3(),{data:r,isLoading:a}=f3(),[i,o]=g.useState([]),[c,d]=g.useState(!0),u=g.useCallback(async()=>{try{if(d(!0),console.log("ProjectModule: fetchEmployees called with companyId:",t),!t){console.error("ProjectModule: No company ID available"),d(!1);return}const{data:$,error:te}=await K.from("employees").select("id, email, status, user_id, company_id").eq("company_id",t);console.log("ProjectModule: DEBUG - All employees for company:",$);const{data:ee,error:Q}=await K.from("employees").select(`
          id,
          user_id,
          first_name,
          last_name,
          email,
          phone,
          position,
          status,
          qualifications,
          license
        `).eq("company_id",t).eq("status","Aktiv").order("created_at",{ascending:!1});if(console.log("ProjectModule: Employees query result:",ee,Q),Q){console.error("ProjectModule: Error fetching employees:",Q),d(!1);return}const le=(ee==null?void 0:ee.filter(ae=>ae.user_id).map(ae=>ae.user_id))||[];let pe=[];if(le.length>0){const{data:ae,error:fe}=await K.from("profiles").select("id, first_name, last_name").in("id",le);fe||(pe=ae||[])}const J=(ee==null?void 0:ee.map(ae=>{const fe=pe.find(ie=>ie.id===ae.user_id),he=(fe==null?void 0:fe.first_name)||ae.first_name||"",ve=(fe==null?void 0:fe.last_name)||ae.last_name||"";return{id:ae.id,first_name:he,last_name:ve,name:`${he} ${ve}`.trim(),email:ae.email,phone:ae.phone,position:ae.position,status:ae.status,qualifications:ae.qualifications||[],license:ae.license,projects:[],user_id:ae.user_id}}).filter(ae=>{const fe=ae.first_name&&ae.first_name.trim().length>0,he=ae.last_name&&ae.last_name.trim().length>0,ve=ae.name&&ae.name.trim().length>0&&ae.name.trim()!==" ",ie=fe||he||ve;return console.log("ProjectModule: Employee filter check:",{employee:ae.name,hasFirstName:fe,hasLastName:he,hasValidName:ve,shouldInclude:ie,user_id:ae.user_id}),ie||console.log("ProjectModule: Filtering out employee without proper name:",ae),ie}))||[];console.log("ProjectModule: Final employee list:",J),o(J)}catch($){console.error("ProjectModule: fetchEmployees error:",$)}finally{d(!1)}},[t]);g.useEffect(()=>{u()},[u]);const[m,f]=g.useState(!1),[p,v]=g.useState(!1),[w,x]=g.useState(!1),[y,j]=g.useState(!1),[b,N]=g.useState(!1),[S,E]=g.useState(!1),[C,P]=g.useState(null),[R,H]=g.useState(null),I=(e==null?void 0:e.items)||[],D=(r==null?void 0:r.items)||[];console.log("Customers data:",D),console.log("Team members data:",i),console.log("Team members loading:",c);const W=D.length>0?D:[{id:"demo_customer_1",name:"Demo Kunde - Bitte echte Kunden hinzufügen",company_name:"Demo Kunde",contact_person:"Bitte echte Kunden hinzufügen",email:"demo@example.com",phone:"+49 000 000000",address:"Demo Adresse",projects:0,revenue:"0",status:"Demo"}],V=i,G=n||a||c;console.log("ProjectModule Debug:",{projectsResponse:e,projects:I,projectsLoading:n,isLoading:G});const Y={anfrage:I.filter($=>$.status==="anfrage").length,besichtigung:I.filter($=>$.status==="besichtigung").length,geplant:I.filter($=>$.status==="geplant").length,in_bearbeitung:I.filter($=>$.status==="in_bearbeitung").length,abgeschlossen:I.filter($=>$.status==="abgeschlossen").length},X=I.reduce(($,te)=>{const ee=Ly(te.description)||te.budget||0;return $+ee},0),F=new Date().toISOString().split("T")[0],T=I.filter($=>$.end_date&&$.end_date<F&&$.status!=="abgeschlossen"),q=D.filter($=>$.status==="Aktiv").slice(0,5),U=()=>{f(!1)},B=()=>{v(!1)},O=()=>{v(!1)},z=$=>{H($.id),j(!0)};return s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Projekte & Baustellen"}),s.jsxs(ne,{onClick:()=>f(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Neues Projekt"]})]}),s.jsx(ite,{active:I.filter($=>$.status!=="abgeschlossen").length,done:I.filter($=>$.status==="abgeschlossen").length,budget:X||0,late:T.length}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsxs(je,{className:"pb-2 flex-row items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-100 text-green-800 border-green-200",children:"Aktuelle"}),s.jsx(Ne,{children:"Projekte"})]}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:["Heute • ",new Date().toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit"})]})]}),s.jsx(de,{className:"space-y-3",children:G?Array(3).fill(0).map(($,te)=>s.jsx("div",{className:"border rounded-xl p-3 shadow-softer",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx(ft,{className:"h-4 w-24 mb-2"}),s.jsx(ft,{className:"h-3 w-32 mb-1"}),s.jsx(ft,{className:"h-3 w-20"})]}),s.jsx(ft,{className:"h-6 w-16"})]})},te)):I.filter($=>$.status!=="abgeschlossen").length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine Projekte vorhanden"}):I.filter($=>$.status!=="abgeschlossen").map($=>s.jsx("div",{className:"border rounded-xl p-3 shadow-softer cursor-pointer hover:shadow-md transition-shadow",onDoubleClick:()=>z($),children:s.jsx(eE,{id:tE($.id),name:$.name,status:$.status,budget:Ly($.description)||$.budget||0,start:$.start_date,end:$.end_date,progress:$.status==="abgeschlossen"?100:$.status==="in_bearbeitung"?60:$.status==="geplant"?30:10,onOpen:()=>z($)})},$.id))})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsx(je,{className:"pb-2",children:s.jsx(Ne,{children:"Verzögerte Projekte"})}),s.jsx(de,{children:G?s.jsxs("div",{className:"space-y-2",children:[s.jsx(ft,{className:"h-16 w-full"}),s.jsx(ft,{className:"h-16 w-full"})]}):T.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine Projekte im Verzug 🎉"}):T.map($=>s.jsx("div",{className:"border rounded-xl p-3 mb-2 cursor-pointer hover:shadow-md transition-shadow",onDoubleClick:()=>z($),children:s.jsx(eE,{id:tE($.id),name:$.name,status:$.status,budget:Ly($.description)||$.budget||0,progress:$.status==="abgeschlossen"?100:$.status==="in_bearbeitung"?60:$.status==="geplant"?30:10,onOpen:()=>z($)})},$.id))})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsx(je,{className:"pb-2",children:s.jsx(Ne,{children:"Projektstatus"})}),s.jsx(de,{children:s.jsx(ote,{counts:Y})})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsx(je,{className:"pb-2",children:s.jsx(Ne,{children:"Top Kunden"})}),s.jsx(de,{className:"space-y-2",children:G?Array(3).fill(0).map(($,te)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ft,{className:"h-4 w-24"}),s.jsx(ft,{className:"h-4 w-32"})]},te)):q.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"Hier erscheinen Kunden, sobald Projekte abgeschlossen sind."}):q.map($=>s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{children:$.company_name||$.contact_person}),s.jsx("span",{className:"text-muted-foreground",children:$.email})]},$.id))})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:[s.jsx(je,{className:"pb-2",children:s.jsx(Ne,{children:"Projekt Übersicht"})}),s.jsxs(de,{className:"grid grid-cols-2 gap-2 text-sm",children:[s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-slate-50 text-slate-700 border-slate-200",children:["Gesamt: ",I.length]}),s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-amber-50 text-amber-700 border-amber-200",children:["In Planung: ",Y.geplant]}),s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-blue-50 text-blue-700 border-blue-200",children:["In Arbeit: ",Y.in_bearbeitung]}),s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-50 text-green-700 border-green-200",children:["Erledigt: ",Y.abgeschlossen]})]})]})]})]}),s.jsx(qee,{isOpen:m,onClose:()=>f(!1),onProjectAdded:U,customers:W,teamMembers:V}),s.jsx(Hee,{isOpen:p,onClose:()=>v(!1),project:C,onProjectUpdated:B,onProjectDeleted:O}),s.jsx(Wee,{isOpen:w,onClose:()=>x(!1),project:C}),R&&s.jsx(Zee,{isOpen:y,onClose:()=>{j(!1),H(null)},projectId:R}),C&&s.jsx(Gee,{isOpen:b,onClose:()=>N(!1),projectId:C.id,projectName:C.name,customerId:C.customer_id||"",onCalculationSaved:()=>{}}),C&&s.jsx(ate,{isOpen:S,onClose:()=>E(!1),projectId:C.id,projectName:C.name})]})};function go({title:t,value:e,className:n,valueClassName:r}){return s.jsxs("div",{className:Ie("bg-card border rounded-xl px-4 py-4 flex items-center justify-between shadow-sm hover:shadow-md transition-shadow",n),children:[s.jsx("div",{className:"text-xs text-muted-foreground font-semibold uppercase tracking-wider",children:t}),s.jsx("div",{className:Ie("text-2xl font-bold",r),children:e})]})}function bI({children:t,className:e}){return s.jsx("section",{"aria-label":"Kennzahlen",className:Ie("grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4","bg-background/95 backdrop-blur-sm border rounded-2xl p-4 shadow-lg",e),children:t})}const cte=({totalEmployees:t,activeEmployees:e,onVacationEmployees:n,totalHours:r})=>s.jsxs(bI,{children:[s.jsx(go,{title:"Mitarbeiter gesamt",value:t}),s.jsx(go,{title:"Aktiv",value:e,valueClassName:"text-green-600"}),s.jsx(go,{title:"Urlaub",value:n,valueClassName:"text-yellow-600"}),s.jsx(go,{title:"Stunden (Monat)",value:r})]});var O1="Avatar",[dte,Oae]=kr(O1),[ute,jI]=dte(O1),NI=g.forwardRef((t,e)=>{const{__scopeAvatar:n,...r}=t,[a,i]=g.useState("idle");return s.jsx(ute,{scope:n,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:s.jsx(tt.span,{...r,ref:e})})});NI.displayName=O1;var SI="AvatarImage",kI=g.forwardRef((t,e)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:a=()=>{},...i}=t,o=jI(SI,n),c=hte(r,i.referrerPolicy),d=_n(u=>{a(u),o.onImageLoadingStatusChange(u)});return qn(()=>{c!=="idle"&&d(c)},[c,d]),c==="loaded"?s.jsx(tt.img,{...i,ref:e,src:r}):null});kI.displayName=SI;var CI="AvatarFallback",EI=g.forwardRef((t,e)=>{const{__scopeAvatar:n,delayMs:r,...a}=t,i=jI(CI,n),[o,c]=g.useState(r===void 0);return g.useEffect(()=>{if(r!==void 0){const d=window.setTimeout(()=>c(!0),r);return()=>window.clearTimeout(d)}},[r]),o&&i.imageLoadingStatus!=="loaded"?s.jsx(tt.span,{...a,ref:e}):null});EI.displayName=CI;function hte(t,e){const[n,r]=g.useState("idle");return qn(()=>{if(!t){r("error");return}let a=!0;const i=new window.Image,o=c=>()=>{a&&r(c)};return r("loading"),i.onload=o("loaded"),i.onerror=o("error"),i.src=t,e&&(i.referrerPolicy=e),()=>{a=!1}},[t,e]),n}var AI=NI,PI=kI,DI=EI;const hm=g.forwardRef(({className:t,...e},n)=>s.jsx(AI,{ref:n,className:Ie("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));hm.displayName=AI.displayName;const mte=g.forwardRef(({className:t,...e},n)=>s.jsx(PI,{ref:n,className:Ie("aspect-square h-full w-full",t),...e}));mte.displayName=PI.displayName;const mm=g.forwardRef(({className:t,...e},n)=>s.jsx(DI,{ref:n,className:Ie("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));mm.displayName=DI.displayName;const fte=({employee:t,onShowDetails:e,onEdit:n})=>{const r=i=>{switch(i){case"Aktiv":return"bg-green-100 text-green-800";case"Urlaub":return"bg-yellow-100 text-yellow-800";case"Krank":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a=i=>i.split(" ").map(o=>o[0]).join("");return s.jsx(oe,{className:"hover:shadow-lg transition-shadow",children:s.jsxs(de,{className:"p-6 flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx(hm,{className:"h-12 w-12",children:s.jsx(mm,{children:a(t.name)})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h4",{className:"text-lg font-semibold",children:t.name}),s.jsx(Be,{className:r(t.status),children:t.status})]}),s.jsx("p",{className:"text-gray-600 mb-2",children:t.position}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm mb-4 flex-grow",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Aktuelles Projekt:"}),s.jsx("p",{children:t.currentProject})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Stunden (Monat):"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(Pt,{className:"h-4 w-4"}),t.hoursThisMonth,"h"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Führerschein:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(_g,{className:"h-4 w-4"}),t.license||"Nicht angegeben"]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Resturlaub:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(At,{className:"h-4 w-4"}),t.vacationDays," Tage"]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Qualifikationen:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:t.qualifications.length>0?t.qualifications.map(i=>s.jsxs(Be,{variant:"outline",className:"text-xs",children:[s.jsx(Gd,{className:"h-3 w-3 mr-1"}),i]},i)):s.jsx("span",{className:"text-sm text-gray-400",children:"Keine Qualifikationen hinterlegt"})})]})]})]}),s.jsxs("div",{className:"flex gap-2 mt-auto",children:[s.jsx(ne,{size:"sm",variant:"outline",onClick:()=>e(t),children:"Details"}),s.jsxs(ne,{size:"sm",onClick:()=>n(t),children:[s.jsx(zl,{className:"h-4 w-4 mr-1"}),"Bearbeiten"]})]})]})})},pte=({isOpen:t,onClose:e,onSubmit:n,isLoading:r})=>{const[a,i]=g.useState({email:"",firstName:"",lastName:"",position:"",phone:"",license:"",qualifications:[]}),[o,c]=g.useState(""),d=(x,y)=>{i(j=>({...j,[x]:y}))},u=()=>{o.trim()&&!a.qualifications.includes(o.trim())&&(i(x=>({...x,qualifications:[...x.qualifications,o.trim()]})),c(""))},m=x=>{i(y=>({...y,qualifications:y.qualifications.filter(j=>j!==x)}))},f=x=>{x.key==="Enter"&&(x.preventDefault(),u())},p=x=>{x.preventDefault(),n(a)},v=()=>{i({email:"",firstName:"",lastName:"",position:"",phone:"",license:"",qualifications:[]}),c("")},w=()=>{v(),e()};return s.jsx(Kt,{open:t,onOpenChange:w,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Neuen Mitarbeiter erstellen"}),s.jsx(In,{children:"Erstelle einen neuen Mitarbeiter. Der Mitarbeiter erhält eine E-Mail zur Bestätigung seines Kontos."})]}),s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"add-firstName",children:"Vorname"}),s.jsx(re,{id:"add-firstName",type:"text",value:a.firstName,onChange:x=>d("firstName",x.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"add-lastName",children:"Nachname"}),s.jsx(re,{id:"add-lastName",type:"text",value:a.lastName,onChange:x=>d("lastName",x.target.value),required:!0})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"add-email",children:"E-Mail"}),s.jsx(re,{id:"add-email",type:"email",value:a.email,onChange:x=>d("email",x.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"add-position",children:"Position"}),s.jsx(re,{id:"add-position",type:"text",value:a.position,onChange:x=>d("position",x.target.value),placeholder:"z.B. Elektriker, Elektroniker"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"add-phone",children:"Telefon"}),s.jsx(re,{id:"add-phone",type:"tel",value:a.phone,onChange:x=>d("phone",x.target.value),placeholder:"+49 123 456789"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"add-license",children:"Führerschein"}),s.jsx(re,{id:"add-license",type:"text",value:a.license,onChange:x=>d("license",x.target.value),placeholder:"z.B. B, BE"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"add-qualifications",children:"Qualifikationen"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(re,{id:"add-qualifications",type:"text",value:o,onChange:x=>c(x.target.value),onKeyPress:f,placeholder:"z.B. VDE 0100, Erste Hilfe"}),s.jsx(ne,{type:"button",onClick:u,size:"sm",children:s.jsx(rn,{className:"h-4 w-4"})})]}),a.qualifications.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:a.qualifications.map(x=>s.jsxs(Be,{variant:"outline",className:"text-xs",children:[s.jsx(Gd,{className:"h-3 w-3 mr-1"}),x,s.jsx("button",{type:"button",onClick:()=>m(x),className:"ml-1 hover:text-red-600",children:s.jsx($n,{className:"h-3 w-3"})})]},x))})]})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(ne,{type:"button",variant:"outline",onClick:w,children:"Abbrechen"}),s.jsx(ne,{type:"submit",disabled:r,children:r?"Wird erstellt...":"Mitarbeiter erstellen"})]})]})]})})},gte=({isOpen:t,onClose:e,employee:n})=>{const r=i=>{switch(i){case"Aktiv":return"bg-green-100 text-green-800";case"Urlaub":return"bg-yellow-100 text-yellow-800";case"Krank":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a=i=>i.split(" ").map(o=>o[0]).join("");return n?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-2xl",children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Mitarbeiterdetails"}),s.jsx(In,{children:"Detaillierte Informationen über den Mitarbeiter"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(hm,{className:"h-16 w-16",children:s.jsx(mm,{className:"text-lg",children:a(n.name)})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold",children:n.name}),s.jsx("p",{className:"text-gray-600",children:n.position}),s.jsx(Be,{className:r(n.status),children:n.status})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(os,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:n.email})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zd,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:n.phone||"Nicht angegeben"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(_g,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm",children:["Führerschein: ",n.license||"Nicht angegeben"]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Pt,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm",children:[n.hoursThisMonth,"h diesen Monat"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(At,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-sm",children:[n.vacationDays," Tage Resturlaub"]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Mi,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm",children:n.currentProject})]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium mb-2",children:"Qualifikationen"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:n.qualifications.length>0?n.qualifications.map(i=>s.jsxs(Be,{variant:"outline",children:[s.jsx(Gd,{className:"h-3 w-3 mr-1"}),i]},i)):s.jsx("span",{className:"text-sm text-gray-400",children:"Keine Qualifikationen hinterlegt"})})]}),s.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50",children:[s.jsx("h4",{className:"font-medium mb-2",children:"Dateien & Dokumente"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Diese Funktion wird bald verfügbar sein."})]})]})]})}):null},xte=({isOpen:t,onClose:e,employee:n,onSave:r})=>{const{toast:a}=It(),i=cG(),[o,c]=g.useState({name:"",position:"",email:"",phone:"",status:"Aktiv",license:"",qualifications:[],currentProject:"",hoursThisMonth:0,vacationDays:0}),[d,u]=g.useState("");g.useEffect(()=>{n&&c({name:n.name,position:n.position,email:n.email,phone:n.phone,status:n.status,license:n.license,qualifications:n.qualifications||[],currentProject:n.currentProject,hoursThisMonth:n.hoursThisMonth,vacationDays:n.vacationDays})},[n]);const m=(y,j)=>{c(b=>({...b,[y]:j}))},f=()=>{d.trim()&&!o.qualifications.includes(d.trim())&&(c(y=>({...y,qualifications:[...y.qualifications,d.trim()]})),u(""))},p=y=>{c(j=>({...j,qualifications:j.qualifications.filter(b=>b!==y)}))},v=y=>{y.key==="Enter"&&(y.preventDefault(),f())},w=y=>{y.preventDefault(),r(o)},x=()=>{n&&window.confirm(`Möchten Sie den Mitarbeiter "${n.name}" wirklich löschen?`)&&i.mutate(n.id,{onSuccess:()=>{a({title:"Mitarbeiter gelöscht",description:`${n.name} wurde erfolgreich gelöscht.`}),e()},onError:y=>{a({title:"Fehler beim Löschen",description:y.message,variant:"destructive"})}})};return n?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Mitarbeiter bearbeiten"}),s.jsx(In,{children:"Mitarbeiterdaten bearbeiten"})]}),s.jsxs("form",{onSubmit:w,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"name",children:"Name"}),s.jsx(re,{id:"name",value:o.name,onChange:y=>m("name",y.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"position",children:"Position"}),s.jsx(re,{id:"position",value:o.position,onChange:y=>m("position",y.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"email",children:"E-Mail"}),s.jsx(re,{id:"email",type:"email",value:o.email,onChange:y=>m("email",y.target.value),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"phone",children:"Telefon"}),s.jsx(re,{id:"phone",value:o.phone,onChange:y=>m("phone",y.target.value)})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"status",children:"Status"}),s.jsxs(ut,{value:o.status,onValueChange:y=>m("status",y),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Aktiv",children:"Aktiv"}),s.jsx(xe,{value:"Urlaub",children:"Urlaub"}),s.jsx(xe,{value:"Krank",children:"Krank"})]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"license",children:"Führerschein"}),s.jsx(re,{id:"license",value:o.license,onChange:y=>m("license",y.target.value),placeholder:"z.B. B, BE"})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"qualifications",children:"Qualifikationen"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(re,{id:"qualifications",type:"text",value:d,onChange:y=>u(y.target.value),onKeyPress:v,placeholder:"z.B. VDE 0100, Erste Hilfe"}),s.jsx(ne,{type:"button",onClick:f,size:"sm",children:s.jsx(rn,{className:"h-4 w-4"})})]}),o.qualifications.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:o.qualifications.map(y=>s.jsxs(Be,{variant:"outline",className:"text-xs",children:[s.jsx(Gd,{className:"h-3 w-3 mr-1"}),y,s.jsx("button",{type:"button",onClick:()=>p(y),className:"ml-1 hover:text-red-600",children:s.jsx($n,{className:"h-3 w-3"})})]},y))})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"currentProject",children:"Aktuelles Projekt"}),s.jsx(re,{id:"currentProject",value:o.currentProject,onChange:y=>m("currentProject",y.target.value)})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"hoursThisMonth",children:"Stunden (Monat)"}),s.jsx(re,{id:"hoursThisMonth",type:"number",value:o.hoursThisMonth,onChange:y=>m("hoursThisMonth",parseInt(y.target.value))})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"vacationDays",children:"Resturlaub"}),s.jsx(re,{id:"vacationDays",type:"number",value:o.vacationDays,onChange:y=>m("vacationDays",parseInt(y.target.value))})]})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(ne,{type:"button",variant:"outline",onClick:e,children:"Abbrechen"}),s.jsxs(ne,{type:"button",variant:"destructive",onClick:x,disabled:i.isPending,className:"flex items-center gap-2",children:[s.jsx(Va,{className:"h-4 w-4"}),i.isPending?"Lösche...":"Löschen"]}),s.jsx(ne,{type:"submit",children:"Speichern"})]})]})]})}):null},vte=({onQuickAction:t})=>{const e=[{employee:"Keine Schulungen geplant",training:"",date:"",type:"Info"}],n=r=>{switch(r){case"Pflicht":return"bg-red-100 text-red-800";case"Weiterbildung":return"bg-blue-100 text-blue-800";case"Info":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(gS,{className:"h-5 w-5"}),"Anstehende Schulungen"]})}),s.jsx(de,{children:s.jsx("div",{className:"space-y-3",children:e.map(r=>s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"flex items-center justify-between mb-2",children:s.jsx(Be,{className:n(r.type),children:r.type})}),s.jsx("p",{className:"font-medium text-sm mb-1",children:r.employee}),r.training&&s.jsx("p",{className:"text-sm text-gray-600 mb-1",children:r.training}),r.date&&s.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(At,{className:"h-3 w-3"}),r.date]})]},r.employee))})})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{className:"text-base",children:"Personalaktionen"})}),s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ne,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Urlaub planen"),children:[s.jsx(At,{className:"h-4 w-4 mr-2"}),"Urlaub planen"]}),s.jsxs(ne,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Arbeitszeiten"),children:[s.jsx(Pt,{className:"h-4 w-4 mr-2"}),"Arbeitszeiten"]}),s.jsxs(ne,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Schulung buchen"),children:[s.jsx(gS,{className:"h-4 w-4 mr-2"}),"Schulung buchen"]}),s.jsxs(ne,{variant:"outline",className:"w-full justify-start",onClick:()=>t("Zertifikate"),children:[s.jsx(Gd,{className:"h-4 w-4 mr-2"}),"Zertifikate"]})]})})]})]})},H0=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{className:"relative w-full overflow-auto",children:s.jsx("table",{ref:n,className:Ie("w-full caption-bottom text-sm",t),...e})}));H0.displayName="Table";const W0=g.forwardRef(({className:t,...e},n)=>s.jsx("thead",{ref:n,className:Ie("[&_tr]:border-b",t),...e}));W0.displayName="TableHeader";const V0=g.forwardRef(({className:t,...e},n)=>s.jsx("tbody",{ref:n,className:Ie("[&_tr:last-child]:border-0",t),...e}));V0.displayName="TableBody";const yte=g.forwardRef(({className:t,...e},n)=>s.jsx("tfoot",{ref:n,className:Ie("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...e}));yte.displayName="TableFooter";const yl=g.forwardRef(({className:t,...e},n)=>s.jsx("tr",{ref:n,className:Ie("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...e}));yl.displayName="TableRow";const jn=g.forwardRef(({className:t,...e},n)=>s.jsx("th",{ref:n,className:Ie("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...e}));jn.displayName="TableHead";const Nn=g.forwardRef(({className:t,...e},n)=>s.jsx("td",{ref:n,className:Ie("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...e}));Nn.displayName="TableCell";const _te=g.forwardRef(({className:t,...e},n)=>s.jsx("caption",{ref:n,className:Ie("mt-4 text-sm text-muted-foreground",t),...e}));_te.displayName="TableCaption";function wte(){const[t,e]=g.useState([]),[n,r]=g.useState(null),[a,i]=g.useState(0),[o,c]=g.useState(40),{data:d,isLoading:u,error:m}=f1(),f=(d==null?void 0:d.items)||[],p=async()=>{try{console.log("Fetching company working hours...");const{data:j,error:b}=await K.from("company_settings").select("default_working_hours_start, default_working_hours_end, default_break_duration").limit(1);if(b){console.error("Error fetching working hours:",b);return}if(j){console.log("Working hours data:",j);const N=j.default_working_hours_start||"08:00",S=j.default_working_hours_end||"17:00",E=j.default_break_duration||60,[C,P]=N.split(":").map(Number),[R,H]=S.split(":").map(Number),I=C*60+P,V=(R*60+H-I-E)/60,G=V*5;console.log(`Calculated: ${V}h/Tag, ${G}h/Woche`),c(G)}}catch(j){console.error("Error calculating working hours:",j),c(40)}};g.useEffect(()=>{p();const j=localStorage.getItem("employeeWages");j&&e(JSON.parse(j))},[]),g.useEffect(()=>{localStorage.setItem("employeeWages",JSON.stringify(t))},[t]);const v=j=>{const b=t.find(N=>N.employee_id===j);return(b==null?void 0:b.hourly_wage)||0},w=j=>{r(j.id),i(v(j.id))},x=()=>{r(null),i(0)},y=j=>{const b=t.map(N=>N.employee_id===j?{...N,hourly_wage:a}:N);t.find(N=>N.employee_id===j)||b.push({employee_id:j,hourly_wage:a}),e(b),r(null),i(0),Te.success("Stundenlohn wurde gespeichert")};return u?s.jsx(oe,{children:s.jsx(de,{className:"p-6",children:s.jsx("div",{className:"text-center",children:"Lädt Mitarbeiterdaten..."})})}):m?s.jsx(oe,{children:s.jsx(de,{className:"p-6",children:s.jsxs("div",{className:"text-center text-red-500",children:["Fehler beim Laden der Mitarbeiterdaten: ",m.message||"Unbekannter Fehler"]})})}):s.jsx("div",{className:"space-y-6",children:s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(mr,{className:"h-5 w-5"}),"Mitarbeiter Stundenlohn-Verwaltung (Vereinfacht)"]}),s.jsx(vn,{children:"Verwalten Sie Stundenlöhne Ihrer aktiven Mitarbeiter"})]}),s.jsxs(de,{children:[s.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[s.jsxs("p",{className:"text-sm text-blue-800",children:["📋 ",s.jsx("strong",{children:"Arbeitszeit werden aus den Firmeneinstellungen berechnet (42.5h/Woche)"})]}),s.jsxs("p",{className:"text-sm text-orange-700 mt-1",children:["⚠️ ",s.jsx("strong",{children:"Hinweise:"})," Löhne werden temporär im Browser gespeichert"]})]}),f.length===0?s.jsx("div",{className:"text-center py-8 text-gray-500",children:"Keine aktiven Mitarbeiter gefunden"}):s.jsxs(H0,{children:[s.jsx(W0,{children:s.jsxs(yl,{children:[s.jsxs(jn,{children:[s.jsx(Ds,{className:"h-4 w-4 inline mr-2"}),"Mitarbeiter"]}),s.jsxs(jn,{children:[s.jsx(os,{className:"h-4 w-4 inline mr-2"}),"E-Mail"]}),s.jsxs(jn,{children:[s.jsx(Mc,{className:"h-4 w-4 inline mr-2"}),"Position"]}),s.jsx(jn,{children:"Status"}),s.jsxs(jn,{children:[s.jsx(mr,{className:"h-4 w-4 inline mr-2"}),"Stundenlohn"]}),s.jsx(jn,{children:"Wochenlohn (ca.)"}),s.jsx(jn,{children:"Aktionen"})]})}),s.jsx(V0,{children:f.map(j=>{const b=v(j.id),N=b*o,S=n===j.id;return s.jsxs(yl,{children:[s.jsx(Nn,{children:s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium",children:[j.first_name," ",j.last_name]}),j.phone&&s.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[s.jsx(Zd,{className:"h-3 w-3"}),j.phone]})]})}),s.jsx(Nn,{children:j.email}),s.jsx(Nn,{children:j.position||"-"}),s.jsx(Nn,{children:s.jsx(Be,{variant:j.status==="Aktiv"?"default":"secondary",children:j.status})}),s.jsx(Nn,{children:S?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(re,{type:"number",step:"0.50",min:"0",value:a,onChange:E=>i(parseFloat(E.target.value)||0),className:"w-20"}),s.jsx("span",{className:"text-sm",children:"€/h"})]}):s.jsx("div",{className:"font-mono",children:b>0?`€${b.toFixed(2)}/h`:"Nicht festgelegt"})}),s.jsxs(Nn,{children:[s.jsx("div",{className:"font-mono text-green-600",children:N>0?`€${N.toFixed(2)}`:"-"}),N>0&&s.jsxs("div",{className:"text-xs text-gray-500",children:["bei ",o,"h/Woche"]})]}),s.jsx(Nn,{children:S?s.jsxs("div",{className:"flex gap-1",children:[s.jsx(ne,{size:"sm",onClick:()=>y(j.id),className:"h-8 w-8 p-0",children:s.jsx(zh,{className:"h-3 w-3"})}),s.jsx(ne,{size:"sm",variant:"outline",onClick:x,className:"h-8 w-8 p-0",children:s.jsx($n,{className:"h-3 w-3"})})]}):s.jsx(ne,{size:"sm",variant:"outline",onClick:()=>w(j),className:"h-8 w-8 p-0",children:s.jsx(zl,{className:"h-3 w-3"})})})]},j.id)})})]})]})]})})}const bte=()=>{const{toast:t}=It(),{user:e,session:n,inviteEmployee:r,companyId:a}=Vr(),i=ds(),[o,c]=g.useState(null),[d,u]=g.useState(!1),[m,f]=g.useState(!1),[p,v]=g.useState(!1),[w,x]=g.useState(!1),{data:y,isLoading:j,error:b}=f1(),N=(y==null?void 0:y.items)||[],S=g.useMemo(()=>N.map(V=>({id:V.id,name:V.name||`${V.first_name} ${V.last_name}`.trim()||V.email,position:V.position||"Mitarbeiter",email:V.email,phone:V.phone||"",status:V.status||"Aktiv",qualifications:Array.isArray(V.qualifications)?V.qualifications:[],license:V.license||"",currentProject:"-",hoursThisMonth:0,vacationDays:25})),[N]),E=async V=>{x(!0);try{console.log("Creating Supabase employee invitation:",V);const G=await r(V.email,{firstName:V.firstName,lastName:V.lastName,position:V.position,phone:V.phone,license:V.license,qualifications:V.qualifications});if(!G.success){console.error("Supabase invitation error:",G.error),Te.error(`Fehler beim Senden der Einladung: ${G.error}`);return}Te.success(`Mitarbeiter ${V.firstName} ${V.lastName} wurde erfolgreich eingeladen! 
        Eine Einladungs-E-Mail wurde an ${V.email} gesendet.`),i.invalidateQueries({queryKey:Zt.employees}),v(!1)}catch(G){console.error("Unexpected error:",G),Te.error("Ein unerwarteter Fehler ist aufgetreten")}finally{x(!1)}},C=V=>{c(V),u(!0)},P=V=>{c(V),f(!0)},R=async V=>{var G;if(o)try{const Y=((G=V.name)==null?void 0:G.split(" "))||[],X=Y[0]||"",F=Y.slice(1).join(" ")||"",{error:T}=await K.from("employees").update({first_name:X,last_name:F,position:V.position,phone:V.phone,status:V.status,license:V.license,qualifications:V.qualifications?JSON.stringify(V.qualifications):"[]"}).eq("id",o.id);if(T){console.error("Error updating employee:",T),Te.error(`Fehler beim Aktualisieren: ${T.message}`);return}o.id&&X&&F&&await K.from("profiles").update({first_name:X,last_name:F}).eq("id",o.id);const q={...o,...V};setEmployees(U=>U.map(B=>B.id===o.id?q:B)),t({title:"Erfolg",description:"Mitarbeiter wurde erfolgreich aktualisiert."}),f(!1),c(null)}catch(Y){console.error("Error saving employee:",Y),Te.error("Fehler beim Speichern der Mitarbeiteränderungen")}},H=V=>{t({title:"Info",description:`${V} wird geöffnet...`})},I=S.filter(V=>V.status==="Aktiv").length,D=S.filter(V=>V.status==="Urlaub").length,W=S.reduce((V,G)=>V+G.hoursThisMonth,0);return s.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[s.jsx("div",{className:"flex items-center justify-between mb-8",children:s.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Personalverwaltung"})}),s.jsxs(es,{defaultValue:"overview",className:"w-full",children:[s.jsxs(Hn,{className:"grid w-full grid-cols-2",children:[s.jsx(He,{value:"overview",children:"Mitarbeiterübersicht"}),s.jsx(He,{value:"wages",children:"Stundenlohn-Verwaltung"})]}),s.jsxs(We,{value:"overview",className:"space-y-6",children:[s.jsx("div",{className:"flex justify-end",children:s.jsxs(ne,{onClick:()=>v(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Mitarbeiter hinzufügen"]})}),s.jsx(cte,{totalEmployees:S.length,activeEmployees:I,onVacationEmployees:D,totalHours:W}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Mitarbeiterliste"}),j?s.jsx("div",{className:"text-center p-6",children:s.jsx("p",{className:"text-gray-500",children:"Mitarbeiter werden geladen..."})}):S.length===0?s.jsxs("div",{className:"text-center p-6",children:[s.jsx("p",{className:"text-gray-500",children:"Noch keine Mitarbeiter vorhanden."}),s.jsx("p",{className:"text-sm text-gray-400 mt-2",children:'Klicken Sie auf "Mitarbeiter hinzufügen" um den ersten Mitarbeiter einzuladen.'})]}):S.map(V=>s.jsx(fte,{employee:V,onShowDetails:C,onEdit:P},V.id))]}),s.jsx(vte,{onQuickAction:H})]})]}),s.jsx(We,{value:"wages",children:s.jsx(wte,{})})]}),s.jsx(pte,{isOpen:p,onClose:()=>v(!1),onSubmit:E,isLoading:w}),s.jsx(gte,{isOpen:d,onClose:()=>u(!1),employee:o}),s.jsx(xte,{isOpen:m,onClose:()=>f(!1),employee:o,onSave:R})]})},jte=({isOpen:t,onClose:e,selectedMaterial:n,onAssignmentComplete:r})=>{const{user:a,companyId:i}=Vr(),[o,c]=g.useState("assign"),[d,u]=g.useState([]),[m,f]=g.useState([]),[p,v]=g.useState([]),[w,x]=g.useState([]),[y,j]=g.useState({material_id:(n==null?void 0:n.id)||"",employee_id:"",project_id:"",assigned_quantity:0,notes:""}),[b,N]=g.useState(!1);g.useEffect(()=>{t&&i&&S()},[t,i]),g.useEffect(()=>{n&&j(D=>({...D,material_id:n.id}))},[n]);const S=async()=>{N(!0);try{await Promise.all([E(),C(),P(),R()])}catch(D){console.error("Error fetching data:",D),Te.error("Fehler beim Laden der Daten")}finally{N(!1)}},E=async()=>{const{data:D,error:W}=await K.from("materials").select("id, name, current_stock, unit, category").eq("company_id",i).eq("is_active",!0).order("name");if(W){console.error("Error fetching materials:",W);return}u(D||[])},C=async()=>{const{data:D,error:W}=await K.from("employees").select("id, first_name, last_name, email").eq("company_id",i).eq("status","active").order("first_name");if(W){console.error("Error fetching employees:",W);return}f(D||[])},P=async()=>{const{data:D,error:W}=await K.from("projects").select("id, name").eq("company_id",i).order("name");if(W){console.error("Error fetching projects:",W);return}v(D||[])},R=async()=>{const{data:D,error:W}=await K.from("project_material_assignments").select(`
        id,
        assigned_quantity,
        used_quantity,
        assigned_at,
        notes,
        materials:material_id (name, unit),
        employees:assigned_by (first_name, last_name),
        projects:project_id (name)
      `).order("assigned_at",{ascending:!1}).limit(20);if(W){console.error("Error fetching assignments:",W);return}const V=(D==null?void 0:D.map(G=>{var Y,X,F,T,q;return{...G,material_name:((Y=G.materials)==null?void 0:Y.name)||"Unbekannt",employee_name:`${((X=G.employees)==null?void 0:X.first_name)||""} ${((F=G.employees)==null?void 0:F.last_name)||""}`.trim()||"Unbekannt",project_name:((T=G.projects)==null?void 0:T.name)||"Unbekannt",unit:((q=G.materials)==null?void 0:q.unit)||"Stk"}}))||[];x(V)},H=async()=>{var W;if(!y.material_id||!y.employee_id||!y.project_id||!y.assigned_quantity){Te.error("Bitte füllen Sie alle Pflichtfelder aus");return}const D=d.find(V=>V.id===y.material_id);if(D&&y.assigned_quantity>D.current_stock){Te.error(`Nicht genügend Bestand verfügbar. Verfügbar: ${D.current_stock} ${D.unit}`);return}try{N(!0);const{error:V}=await K.from("project_material_assignments").upsert({project_id:y.project_id,material_id:y.material_id,assigned_quantity:y.assigned_quantity,assigned_by:a==null?void 0:a.id,notes:y.notes});if(V)throw V;const{error:G}=await K.from("material_stock_movements").insert({material_id:y.material_id,movement_type:"out",reference_type:"assignment",reference_id:y.project_id,quantity:-y.assigned_quantity,employee_id:y.employee_id,project_id:y.project_id,reason:`Material zugewiesen an ${(W=m.find(Y=>Y.id===y.employee_id))==null?void 0:W.first_name}`,created_by:a==null?void 0:a.id});if(G)throw G;Te.success("Material wurde erfolgreich zugewiesen"),j({material_id:(n==null?void 0:n.id)||"",employee_id:"",project_id:"",assigned_quantity:0,notes:""}),await R(),r&&r()}catch(V){console.error("Error creating assignment:",V),Te.error("Fehler beim Zuweisen des Materials")}finally{N(!1)}},I=d.find(D=>D.id===y.material_id);return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:[s.jsxs(tn,{children:[s.jsxs(nn,{className:"flex items-center gap-2",children:[s.jsx(Qa,{className:"h-5 w-5"}),"Material-Zuweisung"]}),s.jsx(In,{children:"Weisen Sie Material einem Mitarbeiter für ein Projekt zu"})]}),s.jsxs("div",{className:"flex gap-2 mb-4",children:[s.jsx(ne,{variant:o==="assign"?"default":"outline",onClick:()=>c("assign"),children:"Material zuweisen"}),s.jsx(ne,{variant:o==="view"?"default":"outline",onClick:()=>c("view"),children:"Zuweisungen anzeigen"})]}),o==="assign"&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Material *"}),s.jsxs(ut,{value:y.material_id,onValueChange:D=>j(W=>({...W,material_id:D})),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Material wählen"})}),s.jsx(ct,{children:d.map(D=>s.jsx(xe,{value:D.id,children:s.jsxs("div",{className:"flex justify-between items-center w-full",children:[s.jsx("span",{children:D.name}),s.jsxs(Be,{variant:"outline",className:"ml-2",children:[D.current_stock," ",D.unit]})]})},D.id))})]}),I&&s.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded-lg",children:[s.jsxs("p",{className:"text-sm",children:[s.jsx("strong",{children:"Verfügbar:"})," ",I.current_stock," ",I.unit]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("strong",{children:"Kategorie:"})," ",I.category]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mitarbeiter *"}),s.jsxs(ut,{value:y.employee_id,onValueChange:D=>j(W=>({...W,employee_id:D})),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Mitarbeiter wählen"})}),s.jsx(ct,{children:m.map(D=>s.jsxs(xe,{value:D.id,children:[D.first_name," ",D.last_name]},D.id))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Projekt *"}),s.jsxs(ut,{value:y.project_id,onValueChange:D=>j(W=>({...W,project_id:D})),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Projekt wählen"})}),s.jsx(ct,{children:p.map(D=>s.jsx(xe,{value:D.id,children:D.name},D.id))})]})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Menge * ",I&&`(${I.unit})`]}),s.jsx(re,{type:"number",step:"0.1",min:"0",max:(I==null?void 0:I.current_stock)||999999,value:y.assigned_quantity,onChange:D=>j(W=>({...W,assigned_quantity:parseFloat(D.target.value)||0})),placeholder:"Zuzuweisende Menge"}),I&&y.assigned_quantity>I.current_stock&&s.jsxs("div",{className:"flex items-center gap-2 mt-1 text-red-600",children:[s.jsx(Jn,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm",children:"Nicht genügend Bestand verfügbar!"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notizen (optional)"}),s.jsx(Cn,{value:y.notes,onChange:D=>j(W=>({...W,notes:D.target.value})),placeholder:"Zusätzliche Informationen zur Zuweisung...",rows:3})]})]}),o==="view"&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Aktuelle Zuweisungen"}),s.jsx("div",{className:"grid gap-4 max-h-96 overflow-y-auto",children:w.map(D=>s.jsx(oe,{children:s.jsxs(de,{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium",children:D.material_name}),s.jsxs("p",{className:"text-sm text-gray-600",children:[D.employee_name," • ",D.project_name]})]}),s.jsxs(Be,{variant:"outline",children:[D.used_quantity," / ",D.assigned_quantity," ",D.unit]})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Zugewiesen: ",new Date(D.assigned_at).toLocaleDateString("de-DE")]}),D.notes&&s.jsx("div",{className:"text-sm text-gray-600 mt-2 p-2 bg-gray-50 rounded",children:D.notes})]})},D.id))})]}),s.jsxs(Tl,{children:[s.jsx(ne,{variant:"outline",onClick:e,children:"Schließen"}),o==="assign"&&s.jsxs(ne,{onClick:H,disabled:b||!y.material_id||!y.employee_id||!y.project_id||!y.assigned_quantity||I&&y.assigned_quantity>I.current_stock,children:[s.jsx(Pm,{className:"h-4 w-4 mr-2"}),"Material zuweisen"]})]})]})})},cp=["Fliesen & Keramik","Sanitär","Heizung","Elektro","Bauchemie","Werkzeuge","Befestigung","Dichtung & Abdichtung","Sonstiges"],nE=["Stück","m²","m","kg","l","Paket","Set","Rolle"],Nte=()=>{const{toast:t}=It(),[e,n]=g.useState([]),[r,a]=g.useState([]),[i,o]=g.useState(""),[c,d]=g.useState("all"),[u,m]=g.useState(!1),[f,p]=g.useState(!1),[v,w]=g.useState(null),[x,y]=g.useState({name:"",category:"",supplier:"",unit:"Stück",currentPrice:0,notes:""});g.useEffect(()=>{j()},[]),g.useEffect(()=>{let D=e;i&&(D=D.filter(W=>W.name.toLowerCase().includes(i.toLowerCase())||W.supplier.toLowerCase().includes(i.toLowerCase()))),c&&c!=="all"&&(D=D.filter(W=>W.category===c)),a(D)},[e,i,c]);const j=()=>{const D=[{id:"1",name:"Bodenfliese 30x30cm Grau",category:"Fliesen & Keramik",supplier:"Fliesenmarkt GmbH",unit:"m²",currentPrice:24.99,previousPrice:22.5,lastUpdated:new Date(Date.now()-6048e5).toISOString(),isActive:!0,notes:"Gute Qualität, schnelle Lieferung"},{id:"2",name:"Fliesenkleber C1 25kg",category:"Bauchemie",supplier:"Bauchemie Express",unit:"Paket",currentPrice:12.5,previousPrice:13.2,lastUpdated:new Date(Date.now()-2592e5).toISOString(),isActive:!0},{id:"3",name:"Fugenmasse weiß 5kg",category:"Bauchemie",supplier:"Bauchemie Express",unit:"Paket",currentPrice:8.75,previousPrice:8.75,lastUpdated:new Date(Date.now()-12096e5).toISOString(),isActive:!0},{id:"4",name:"Mischbatterie Küche Edelstahl",category:"Sanitär",supplier:"Sanitär Partner",unit:"Stück",currentPrice:89.99,previousPrice:85,lastUpdated:new Date(Date.now()-864e5).toISOString(),isActive:!0},{id:"5",name:'Heizkörperventil 1/2"',category:"Heizung",supplier:"Heizung & Klima AG",unit:"Stück",currentPrice:15.5,previousPrice:16.2,lastUpdated:new Date(Date.now()-432e6).toISOString(),isActive:!0}];n(D)},b=()=>{const D={id:Date.now().toString(),name:x.name,category:x.category,supplier:x.supplier,unit:x.unit,currentPrice:x.currentPrice,previousPrice:x.currentPrice,lastUpdated:new Date().toISOString(),isActive:!0,notes:x.notes};n(W=>[...W,D]),C(),m(!1),t({title:"Material hinzugefügt",description:`${x.name} wurde zur Preisliste hinzugefügt.`})},N=D=>{w(D),y({name:D.name,category:D.category,supplier:D.supplier,unit:D.unit,currentPrice:D.currentPrice,notes:D.notes||""}),p(!0)},S=()=>{v&&(n(D=>D.map(W=>W.id===v.id?{...W,name:x.name,category:x.category,supplier:x.supplier,unit:x.unit,previousPrice:W.currentPrice,currentPrice:x.currentPrice,lastUpdated:new Date().toISOString(),notes:x.notes}:W)),C(),p(!1),w(null),t({title:"Material aktualisiert",description:`${x.name} wurde erfolgreich aktualisiert.`}))},E=D=>{n(W=>W.filter(V=>V.id!==D)),t({title:"Material entfernt",description:"Das Material wurde aus der Preisliste entfernt."})},C=()=>{y({name:"",category:"",supplier:"",unit:"Stück",currentPrice:0,notes:""})},P=D=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(D),R=D=>new Date(D).toLocaleDateString("de-DE"),H=(D,W)=>D>W?s.jsx(Ei,{className:"h-4 w-4 text-red-500",title:"Preis gestiegen"}):D<W?s.jsx(aj,{className:"h-4 w-4 text-green-500",title:"Preis gefallen"}):null,I=(D,W)=>W===0?0:(D-W)/W*100;return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qa,{className:"h-6 w-6 text-blue-600"}),s.jsx("h2",{className:"text-2xl font-bold",children:"Materialpreise"})]}),s.jsxs(ne,{onClick:()=>m(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx(oe,{children:s.jsxs(de,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold",children:e.length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Materialien gesamt"})]})}),s.jsx(oe,{children:s.jsxs(de,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(D=>D.currentPrice<D.previousPrice).length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Preise gefallen"})]})}),s.jsx(oe,{children:s.jsxs(de,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.filter(D=>D.currentPrice>D.previousPrice).length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Preise gestiegen"})]})}),s.jsx(oe,{children:s.jsxs(de,{className:"p-4",children:[s.jsx("div",{className:"text-2xl font-bold",children:cp.length}),s.jsx("div",{className:"text-sm text-gray-600",children:"Kategorien"})]})})]}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(ec,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx(re,{placeholder:"Material oder Lieferant suchen...",value:i,onChange:D=>o(D.target.value),className:"pl-10"})]})}),s.jsx("div",{className:"w-full md:w-64",children:s.jsxs(ut,{value:c,onValueChange:d,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Kategorie wählen"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"all",children:"Alle Kategorien"}),cp.map(D=>s.jsx(xe,{value:D,children:D},D))]})]})}),(i||c&&c!=="all")&&s.jsx(ne,{variant:"outline",onClick:()=>{o(""),d("all")},children:"Filter zurücksetzen"})]})})}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{children:["Materialpreise (",r.length,")"]})}),s.jsx(de,{children:s.jsx("div",{className:"space-y-4",children:r.length===0?s.jsx("div",{className:"text-center py-8 text-gray-500",children:i||c?"Keine Materialien gefunden.":"Noch keine Materialien vorhanden."}):r.map(D=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h3",{className:"font-semibold text-lg",children:D.name}),s.jsx(Be,{variant:"outline",children:D.category}),H(D.currentPrice,D.previousPrice)]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Lieferant:"})," ",D.supplier]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Einheit:"})," ",D.unit]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Letzte Aktualisierung:"})," ",R(D.lastUpdated)]})]}),D.notes&&s.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Notizen:"})," ",D.notes]})]}),s.jsxs("div",{className:"text-right ml-4",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:P(D.currentPrice)}),s.jsxs("div",{className:"text-sm text-gray-500",children:["pro ",D.unit]}),D.previousPrice!==D.currentPrice&&s.jsxs("div",{className:`text-sm ${D.currentPrice>D.previousPrice?"text-red-600":"text-green-600"}`,children:[D.currentPrice>D.previousPrice?"+":"",I(D.currentPrice,D.previousPrice).toFixed(1),"%",s.jsxs("div",{className:"text-xs text-gray-500",children:["vorher: ",P(D.previousPrice)]})]}),s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsx(ne,{variant:"outline",size:"sm",onClick:()=>N(D),children:s.jsx(zl,{className:"h-4 w-4"})}),s.jsx(ne,{variant:"outline",size:"sm",onClick:()=>E(D.id),className:"text-red-600 hover:text-red-700",children:s.jsx(Va,{className:"h-4 w-4"})})]})]})]})},D.id))})})]}),s.jsx(Kt,{open:u,onOpenChange:m,children:s.jsxs(Wt,{children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Neues Material hinzufügen"}),s.jsx(In,{children:"Fügen Sie ein neues Material zur Preisliste hinzu."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"name",children:"Materialname *"}),s.jsx(re,{id:"name",value:x.name,onChange:D=>y(W=>({...W,name:D.target.value})),placeholder:"z.B. Bodenfliese 30x30cm Grau",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"category",children:"Kategorie *"}),s.jsxs(ut,{value:x.category,onValueChange:D=>y(W=>({...W,category:D})),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Kategorie wählen"})}),s.jsx(ct,{children:cp.map(D=>s.jsx(xe,{value:D,children:D},D))})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"unit",children:"Einheit *"}),s.jsxs(ut,{value:x.unit,onValueChange:D=>y(W=>({...W,unit:D})),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsx(ct,{children:nE.map(D=>s.jsx(xe,{value:D,children:D},D))})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"supplier",children:"Lieferant *"}),s.jsx(re,{id:"supplier",value:x.supplier,onChange:D=>y(W=>({...W,supplier:D.target.value})),placeholder:"z.B. Baumarkt GmbH",required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"price",children:"Preis pro Einheit (€) *"}),s.jsx(re,{id:"price",type:"number",step:"0.01",min:"0",value:x.currentPrice,onChange:D=>y(W=>({...W,currentPrice:parseFloat(D.target.value)||0})),required:!0})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"notes",children:"Notizen"}),s.jsx(re,{id:"notes",value:x.notes,onChange:D=>y(W=>({...W,notes:D.target.value})),placeholder:"Zusätzliche Informationen (optional)"})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(ne,{variant:"outline",onClick:()=>{C(),m(!1)},children:"Abbrechen"}),s.jsx(ne,{onClick:b,disabled:!x.name||!x.category||!x.supplier,children:"Hinzufügen"})]})]})}),s.jsx(Kt,{open:f,onOpenChange:p,children:s.jsxs(Wt,{children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Material bearbeiten"}),s.jsx(In,{children:"Bearbeiten Sie die Informationen für das Material."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"edit-name",children:"Materialname *"}),s.jsx(re,{id:"edit-name",value:x.name,onChange:D=>y(W=>({...W,name:D.target.value})),required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"edit-category",children:"Kategorie *"}),s.jsxs(ut,{value:x.category,onValueChange:D=>y(W=>({...W,category:D})),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsx(ct,{children:cp.map(D=>s.jsx(xe,{value:D,children:D},D))})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"edit-unit",children:"Einheit *"}),s.jsxs(ut,{value:x.unit,onValueChange:D=>y(W=>({...W,unit:D})),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsx(ct,{children:nE.map(D=>s.jsx(xe,{value:D,children:D},D))})]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"edit-supplier",children:"Lieferant *"}),s.jsx(re,{id:"edit-supplier",value:x.supplier,onChange:D=>y(W=>({...W,supplier:D.target.value})),required:!0})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"edit-price",children:"Neuer Preis pro Einheit (€) *"}),s.jsx(re,{id:"edit-price",type:"number",step:"0.01",min:"0",value:x.currentPrice,onChange:D=>y(W=>({...W,currentPrice:parseFloat(D.target.value)||0})),required:!0}),v&&s.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Aktueller Preis: ",P(v.currentPrice)]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"edit-notes",children:"Notizen"}),s.jsx(re,{id:"edit-notes",value:x.notes,onChange:D=>y(W=>({...W,notes:D.target.value})),placeholder:"Zusätzliche Informationen (optional)"})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(ne,{variant:"outline",onClick:()=>{C(),p(!1),w(null)},children:"Abbrechen"}),s.jsx(ne,{onClick:S,disabled:!x.name||!x.category||!x.supplier,children:"Aktualisieren"})]})]})})]})},Ste=()=>{const{user:t,companyId:e}=Vr(),[n,r]=g.useState("inventory"),[a,i]=g.useState([]),[o,c]=g.useState([]),[d,u]=g.useState([]),[m,f]=g.useState([]),[p,v]=g.useState([]),[w,x]=g.useState(!1),[y,j]=g.useState(""),[b,N]=g.useState(!1),[S,E]=g.useState(!1),[C,P]=g.useState(!1);g.useState(!1);const[R,H]=g.useState(!1),[I,D]=g.useState(null),[W,V]=g.useState({name:"",description:"",category:"",unit:"Stk",current_stock:0,min_stock:0,max_stock:0,unit_price:0,supplier_id:"",storage_location:""}),[G,Y]=g.useState({material_id:"",employee_id:"",project_id:"",quantity_used:0,notes:""});g.useEffect(()=>{e&&X()},[e]);const X=async()=>{x(!0);try{await Promise.all([F(),T(),q(),U(),B()])}catch(ie){console.error("Error fetching data:",ie),Te.error("Fehler beim Laden der Daten")}finally{x(!1)}},F=async()=>{const{data:ie,error:_e}=await K.from("materials").select(`
        *,
        suppliers:supplier_id (
          id,
          name
        )
      `).eq("company_id",e).eq("is_active",!0).order("name");if(_e){console.error("Error fetching materials:",_e);return}const Se=(ie==null?void 0:ie.map(Ve=>{var Xe;return{...Ve,supplier_name:((Xe=Ve.suppliers)==null?void 0:Xe.name)||"Kein Lieferant"}}))||[];i(Se)},T=async()=>{const{data:ie,error:_e}=await K.from("suppliers").select("*").eq("company_id",e).eq("is_active",!0).order("name");if(_e){console.error("Error fetching suppliers:",_e);return}c(ie||[])},q=async()=>{const{data:ie,error:_e}=await K.from("projects").select("id, name, status").eq("company_id",e).order("name");if(_e){console.error("Error fetching projects:",_e);return}u(ie||[])},U=async()=>{const{data:ie,error:_e}=await K.from("employees").select("id, first_name, last_name, email").eq("company_id",e).eq("status","active").order("first_name");if(_e){console.error("Error fetching employees:",_e);return}f(ie||[])},B=async()=>{const{data:ie,error:_e}=await K.from("employee_material_usage").select(`
        *,
        materials:material_id (name, unit),
        employees:employee_id (first_name, last_name),
        projects:project_id (name)
      `).order("created_at",{ascending:!1}).limit(50);if(_e){console.error("Error fetching material usage:",_e);return}const Se=(ie==null?void 0:ie.map(Ve=>{var Xe,Et,ke,Le,ze;return{...Ve,material_name:((Xe=Ve.materials)==null?void 0:Xe.name)||"Unbekannt",employee_name:`${(Et=Ve.employees)==null?void 0:Et.first_name} ${(ke=Ve.employees)==null?void 0:ke.last_name}`,project_name:((Le=Ve.projects)==null?void 0:Le.name)||"Unbekannt",unit:((ze=Ve.materials)==null?void 0:ze.unit)||"Stk"}}))||[];v(Se)},O=async()=>{try{const{error:ie}=await K.from("materials").insert({...W,company_id:e,created_by:t==null?void 0:t.id});if(ie)throw ie;Te.success("Material wurde erfolgreich erstellt"),N(!1),ee(),F()}catch(ie){console.error("Error creating material:",ie),Te.error("Fehler beim Erstellen des Materials")}},z=async()=>{if(I)try{const{error:ie}=await K.from("materials").update({...W,updated_at:new Date().toISOString(),updated_by:t==null?void 0:t.id}).eq("id",I.id);if(ie)throw ie;Te.success("Material wurde erfolgreich aktualisiert"),E(!1),D(null),ee(),F()}catch(ie){console.error("Error updating material:",ie),Te.error("Fehler beim Aktualisieren des Materials")}},$=async ie=>{try{const{error:_e}=await K.from("materials").update({is_active:!1}).eq("id",ie);if(_e)throw _e;Te.success("Material wurde erfolgreich gelöscht"),F()}catch(_e){console.error("Error deleting material:",_e),Te.error("Fehler beim Löschen des Materials")}},te=async()=>{try{const{error:ie}=await K.from("employee_material_usage").insert({...G,usage_date:new Date().toISOString().split("T")[0],created_by:t==null?void 0:t.id});if(ie)throw ie;Te.success("Materialverbrauch wurde erfolgreich erfasst"),P(!1),Q(),B(),F()}catch(ie){console.error("Error recording material usage:",ie),Te.error("Fehler beim Erfassen des Materialverbrauchs")}},ee=()=>{V({name:"",description:"",category:"",unit:"Stk",current_stock:0,min_stock:0,max_stock:0,unit_price:0,supplier_id:"",storage_location:""})},Q=()=>{Y({material_id:"",employee_id:"",project_id:"",quantity_used:0,notes:""})},le=ie=>{D(ie),V({name:ie.name,description:ie.description||"",category:ie.category,unit:ie.unit,current_stock:ie.current_stock,min_stock:ie.min_stock,max_stock:ie.max_stock,unit_price:ie.unit_price,supplier_id:ie.supplier_id||"",storage_location:ie.storage_location||""}),E(!0)},pe=(ie,_e)=>ie<=_e*.5?"bg-red-100 text-red-800":ie<=_e?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800",J=(ie,_e)=>ie<=_e*.5?"Kritisch":ie<=_e?"Niedrig":"Verfügbar",ae=(ie,_e)=>Math.min(ie/_e*100,100),fe=a.filter(ie=>ie.name.toLowerCase().includes(y.toLowerCase())||ie.category.toLowerCase().includes(y.toLowerCase())),he=a.filter(ie=>ie.current_stock<=ie.min_stock),ve=a.reduce((ie,_e)=>ie+_e.current_stock*_e.unit_price,0);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-red-600 bg-clip-text text-transparent flex items-center gap-3",children:[s.jsx(Qa,{className:"h-8 w-8 text-red-600"}),"Materialwirtschaft"]}),s.jsx("p",{className:"text-gray-600",children:"Vollständige Material- und Lagerverwaltung"})]}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(ne,{onClick:()=>N(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Material hinzufügen"]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Materialien"}),s.jsx("p",{className:"text-2xl font-bold",children:a.length})]}),s.jsx(Qa,{className:"h-8 w-8 text-blue-600"})]})})}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Lagerwert"}),s.jsxs("p",{className:"text-2xl font-bold",children:["€",ve.toLocaleString("de-DE",{maximumFractionDigits:0})]})]}),s.jsx(Ei,{className:"h-8 w-8 text-green-600"})]})})}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Niedrige Bestände"}),s.jsx("p",{className:"text-2xl font-bold",children:he.length})]}),s.jsx(Jn,{className:"h-8 w-8 text-yellow-600"})]})})}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Verbrauch (30 Tage)"}),s.jsx("p",{className:"text-2xl font-bold",children:p.length})]}),s.jsx(Al,{className:"h-8 w-8 text-purple-600"})]})})})]}),s.jsxs(es,{value:n,onValueChange:r,className:"w-full",children:[s.jsxs(Hn,{className:"grid w-full grid-cols-5",children:[s.jsx(He,{value:"inventory",children:"Lagerbestand"}),s.jsx(He,{value:"usage",children:"Verbrauch"}),s.jsx(He,{value:"assignments",children:"Zuweisungen"}),s.jsx(He,{value:"prices",children:"Preise"}),s.jsx(He,{value:"analytics",children:"Analysen"})]}),s.jsxs(We,{value:"inventory",className:"space-y-6 min-h-[600px]",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(ec,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),s.jsx(re,{placeholder:"Material suchen...",className:"pl-10 w-64",value:y,onChange:ie=>j(ie.target.value)})]}),s.jsxs(ne,{variant:"outline",onClick:()=>P(!0),children:[s.jsx(tB,{className:"h-4 w-4 mr-2"}),"Verbrauch erfassen"]})]})}),s.jsx("div",{className:"grid gap-4",children:fe.map(ie=>s.jsx(oe,{className:"hover:shadow-lg transition-shadow",children:s.jsxs(de,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h4",{className:"text-lg font-semibold",children:ie.name}),s.jsx(Be,{className:pe(ie.current_stock,ie.min_stock),children:J(ie.current_stock,ie.min_stock)})]}),s.jsx("p",{className:"text-gray-600 mb-2",children:ie.category}),s.jsx("p",{className:"text-sm text-gray-500",children:ie.description})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-lg font-bold text-blue-600",children:["€",ie.unit_price.toFixed(2),"/",ie.unit]}),s.jsx("p",{className:"text-sm text-gray-500",children:ie.supplier_name})]})]}),s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{children:"Lagerbestand"}),s.jsxs("span",{children:[ie.current_stock," ",ie.unit," / ",ie.max_stock," ",ie.unit]})]}),s.jsx(zo,{value:ae(ie.current_stock,ie.max_stock),className:"h-2"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Mindestbestand:"}),s.jsxs("p",{children:[ie.min_stock," ",ie.unit]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Lagerwert:"}),s.jsxs("p",{children:["€",(ie.current_stock*ie.unit_price).toFixed(2)]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Lagerort:"}),s.jsx("p",{children:ie.storage_location||"Nicht angegeben"})]})]})]}),ie.current_stock<=ie.min_stock&&s.jsx("div",{className:"mb-4 p-2 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-yellow-800",children:[s.jsx(Jn,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Bestand unter Mindestmenge! Nachbestellung empfohlen."})]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ne,{size:"sm",variant:"outline",onClick:()=>le(ie),children:[s.jsx(zl,{className:"h-4 w-4 mr-1"}),"Bearbeiten"]}),s.jsxs(ne,{size:"sm",variant:"outline",onClick:()=>{D(ie),H(!0)},children:[s.jsx(Pm,{className:"h-4 w-4 mr-1"}),"Zuweisen"]}),s.jsxs(ne,{size:"sm",variant:"outline",className:"text-red-600 hover:text-red-700",onClick:()=>$(ie.id),children:[s.jsx(Va,{className:"h-4 w-4 mr-1"}),"Löschen"]})]})]})},ie.id))})]}),s.jsx(We,{value:"usage",className:"space-y-6 min-h-[600px]",children:s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsx(Ne,{children:"Materialverbrauch"}),s.jsx(vn,{children:"Übersicht über den Materialverbrauch der letzten 50 Einträge"})]}),s.jsx(de,{children:s.jsx("div",{className:"space-y-4",children:p.map(ie=>s.jsxs("div",{className:"flex justify-between items-center p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium",children:ie.material_name}),s.jsxs("p",{className:"text-sm text-gray-600",children:[ie.employee_name," • ",ie.project_name]}),s.jsx("p",{className:"text-xs text-gray-500",children:new Date(ie.usage_date).toLocaleDateString("de-DE")})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-bold",children:[ie.quantity_used," ",ie.unit]}),ie.notes&&s.jsx("p",{className:"text-sm text-gray-600",children:ie.notes})]})]},ie.id))})})]})}),s.jsx(We,{value:"assignments",className:"space-y-6 min-h-[600px]",children:s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsx(Ne,{children:"Projekt-Zuweisungen"}),s.jsx(vn,{children:"Materialzuweisungen zu Projekten verwalten"})]}),s.jsx(de,{children:s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Hr,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Projekt-Zuweisungen werden hier angezeigt"}),s.jsx("p",{className:"text-sm",children:"Funktion wird in Kürze erweitert"})]})})]})}),s.jsx(We,{value:"analytics",className:"space-y-6 min-h-[600px]",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Bestandsanalyse"})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Materialien mit niedrigem Bestand:"}),s.jsx("span",{className:"font-bold text-red-600",children:he.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Durchschnittlicher Lagerwert pro Material:"}),s.jsxs("span",{className:"font-bold",children:["€",a.length>0?(ve/a.length).toFixed(2):0]})]})]})})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Verbrauchsanalyse"})}),s.jsx(de,{children:s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx(Al,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Detaillierte Verbrauchsanalysen"}),s.jsx("p",{className:"text-sm",children:"Werden in Kürze erweitert"})]})})]})]})}),s.jsx(We,{value:"prices",className:"space-y-6 min-h-[600px]",children:s.jsx(Nte,{})})]}),s.jsx(Kt,{open:b,onOpenChange:N,children:s.jsxs(Wt,{className:"max-w-2xl",children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Material hinzufügen"}),s.jsx(In,{children:"Fügen Sie ein neues Material zu Ihrem Lager hinzu"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Name *"}),s.jsx(re,{value:W.name,onChange:ie=>V(_e=>({..._e,name:ie.target.value})),placeholder:"Material-Name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kategorie"}),s.jsxs(ut,{value:W.category,onValueChange:ie=>V(_e=>({..._e,category:ie})),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Kategorie wählen"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Kabel & Leitungen",children:"Kabel & Leitungen"}),s.jsx(xe,{value:"Installationsmaterial",children:"Installationsmaterial"}),s.jsx(xe,{value:"Schaltgeräte",children:"Schaltgeräte"}),s.jsx(xe,{value:"Werkzeuge",children:"Werkzeuge"}),s.jsx(xe,{value:"Sonstiges",children:"Sonstiges"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Einheit *"}),s.jsxs(ut,{value:W.unit,onValueChange:ie=>V(_e=>({..._e,unit:ie})),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Einheit"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Stk",children:"Stück"}),s.jsx(xe,{value:"m",children:"Meter"}),s.jsx(xe,{value:"kg",children:"Kilogramm"}),s.jsx(xe,{value:"l",children:"Liter"}),s.jsx(xe,{value:"m²",children:"Quadratmeter"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Preis pro Einheit (€)"}),s.jsx(re,{type:"number",step:"0.01",value:W.unit_price,onChange:ie=>V(_e=>({..._e,unit_price:parseFloat(ie.target.value)||0}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Aktueller Bestand"}),s.jsx(re,{type:"number",value:W.current_stock,onChange:ie=>V(_e=>({..._e,current_stock:parseFloat(ie.target.value)||0}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mindestbestand"}),s.jsx(re,{type:"number",value:W.min_stock,onChange:ie=>V(_e=>({..._e,min_stock:parseFloat(ie.target.value)||0}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Maximalbestand"}),s.jsx(re,{type:"number",value:W.max_stock,onChange:ie=>V(_e=>({..._e,max_stock:parseFloat(ie.target.value)||0}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Lieferant"}),s.jsxs(ut,{value:W.supplier_id,onValueChange:ie=>V(_e=>({..._e,supplier_id:ie})),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Lieferant wählen"})}),s.jsx(ct,{children:o.map(ie=>s.jsx(xe,{value:ie.id,children:ie.name},ie.id))})]})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Beschreibung"}),s.jsx(Cn,{value:W.description,onChange:ie=>V(_e=>({..._e,description:ie.target.value})),placeholder:"Beschreibung des Materials...",rows:3})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Lagerort"}),s.jsx(re,{value:W.storage_location,onChange:ie=>V(_e=>({..._e,storage_location:ie.target.value})),placeholder:"z.B. Lager A, Regal 1"})]})]}),s.jsxs(Tl,{children:[s.jsx(ne,{variant:"outline",onClick:()=>N(!1),children:"Abbrechen"}),s.jsx(ne,{onClick:O,disabled:!W.name,children:"Material erstellen"})]})]})}),s.jsx(Kt,{open:S,onOpenChange:E,children:s.jsxs(Wt,{className:"max-w-2xl",children:[s.jsx(tn,{children:s.jsx(nn,{children:"Material bearbeiten"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Name *"}),s.jsx(re,{value:W.name,onChange:ie=>V(_e=>({..._e,name:ie.target.value}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Aktueller Bestand"}),s.jsx(re,{type:"number",value:W.current_stock,onChange:ie=>V(_e=>({..._e,current_stock:parseFloat(ie.target.value)||0}))})]})]}),s.jsxs(Tl,{children:[s.jsx(ne,{variant:"outline",onClick:()=>E(!1),children:"Abbrechen"}),s.jsx(ne,{onClick:z,children:"Aktualisieren"})]})]})}),s.jsx(Kt,{open:C,onOpenChange:P,children:s.jsxs(Wt,{children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Materialverbrauch erfassen"}),s.jsx(In,{children:"Erfassen Sie den Verbrauch von Material durch einen Mitarbeiter"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Material"}),s.jsxs(ut,{value:G.material_id,onValueChange:ie=>Y(_e=>({..._e,material_id:ie})),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Material wählen"})}),s.jsx(ct,{children:a.map(ie=>s.jsxs(xe,{value:ie.id,children:[ie.name," (",ie.current_stock," ",ie.unit," verfügbar)"]},ie.id))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mitarbeiter"}),s.jsxs(ut,{value:G.employee_id,onValueChange:ie=>Y(_e=>({..._e,employee_id:ie})),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Mitarbeiter wählen"})}),s.jsx(ct,{children:m.map(ie=>s.jsxs(xe,{value:ie.id,children:[ie.first_name," ",ie.last_name]},ie.id))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Projekt"}),s.jsxs(ut,{value:G.project_id,onValueChange:ie=>Y(_e=>({..._e,project_id:ie})),children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Projekt wählen"})}),s.jsx(ct,{children:d.map(ie=>s.jsx(xe,{value:ie.id,children:ie.name},ie.id))})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Verbrauchte Menge"}),s.jsx(re,{type:"number",step:"0.1",value:G.quantity_used,onChange:ie=>Y(_e=>({..._e,quantity_used:parseFloat(ie.target.value)||0}))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Notizen (optional)"}),s.jsx(Cn,{value:G.notes,onChange:ie=>Y(_e=>({..._e,notes:ie.target.value})),rows:2})]})]}),s.jsxs(Tl,{children:[s.jsx(ne,{variant:"outline",onClick:()=>P(!1),children:"Abbrechen"}),s.jsx(ne,{onClick:te,disabled:!G.material_id||!G.employee_id||!G.project_id||!G.quantity_used,children:"Verbrauch erfassen"})]})]})}),s.jsx(jte,{isOpen:R,onClose:()=>H(!1),selectedMaterial:I,onAssignmentComplete:()=>{F(),B()}})]})},kte=({machine:t})=>{const e=a=>{switch(a){case"Verfügbar":return"bg-green-100 text-green-800";case"Im Einsatz":return"bg-blue-100 text-blue-800";case"Wartung fällig":return"bg-red-100 text-red-800";case"In Wartung":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},n=a=>{switch(a){case"Sehr gut":return"text-green-600";case"Gut":return"text-blue-600";case"Ausreichend":return"text-yellow-600";case"Wartung erforderlich":return"text-red-600";default:return"text-gray-600"}},r=a=>{switch(a){case"Verfügbar":return s.jsx(ls,{className:"h-4 w-4 text-green-600"});case"Im Einsatz":return s.jsx(Pt,{className:"h-4 w-4 text-blue-600"});case"Wartung fällig":return s.jsx(Jn,{className:"h-4 w-4 text-red-600"});case"In Wartung":return s.jsx($h,{className:"h-4 w-4 text-yellow-600"});default:return s.jsx(ls,{className:"h-4 w-4 text-gray-600"})}};return s.jsx(oe,{className:"hover:shadow-lg transition-shadow",children:s.jsxs(de,{className:"p-6 flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r(t.status),s.jsx("h4",{className:"text-lg font-semibold",children:t.name}),s.jsx(Be,{className:e(t.status),children:t.status})]}),s.jsx("p",{className:"text-gray-600 mb-2",children:t.category}),s.jsxs("p",{className:"text-sm text-gray-500 flex items-center gap-1 mb-2",children:[s.jsx(Mi,{className:"h-4 w-4"}),t.location]}),s.jsxs("p",{className:"text-sm flex items-center gap-1",children:[s.jsx("span",{className:"text-gray-500",children:"Zustand:"}),s.jsx("span",{className:`font-medium ${n(t.condition)}`,children:t.condition})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",t.id]}),s.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[t.operatingHours,"h"]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Betriebsstunden"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4 flex-grow",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Letzte Wartung:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(At,{className:"h-4 w-4"}),t.lastMaintenance]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Nächste Wartung:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(At,{className:"h-4 w-4"}),t.nextMaintenance]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"DGUV V3 Prüfung:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(At,{className:"h-4 w-4"}),t.dguv]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Nächste DGUV V3:"}),s.jsxs("p",{className:"flex items-center gap-1",children:[s.jsx(At,{className:"h-4 w-4"}),t.nextDguv]})]})]}),t.status==="Wartung fällig"&&s.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[s.jsx(Jn,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Wartung überfällig! Gerät nicht verwenden."})]})}),s.jsxs("div",{className:"flex gap-2 mt-auto",children:[s.jsx(ne,{size:"sm",variant:"outline",children:"Details"}),s.jsxs(ne,{size:"sm",variant:"outline",children:[s.jsx(At,{className:"h-4 w-4 mr-1"}),"Wartung"]}),t.status==="Wartung fällig"&&s.jsxs(ne,{size:"sm",className:"bg-red-600 hover:bg-red-700",children:[s.jsx($h,{className:"h-4 w-4 mr-1"}),"Wartung planen"]})]})]})})},Cte=({machines:t})=>{const e=t.length,n=t.filter(i=>i.status==="Verfügbar").length,r=t.filter(i=>i.status==="Im Einsatz").length,a=t.filter(i=>i.status==="Wartung fällig").length;return s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsx(oe,{children:s.jsxs(de,{className:"flex items-center justify-between p-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Ger\\u00e4te gesamt"}),s.jsx("p",{className:"text-lg font-bold",children:e})]}),s.jsx(Po,{className:"w-5 h-5 text-blue-500"})]})}),s.jsx(oe,{children:s.jsxs(de,{className:"flex items-center justify-between p-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Verf\\u00fcgbar"}),s.jsx("p",{className:"text-lg font-bold",children:n})]}),s.jsx(ls,{className:"w-5 h-5 text-green-500"})]})}),s.jsx(oe,{children:s.jsxs(de,{className:"flex items-center justify-between p-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Im Einsatz"}),s.jsx("p",{className:"text-lg font-bold",children:r})]}),s.jsx(Pt,{className:"w-5 h-5 text-yellow-500"})]})}),s.jsx(oe,{children:s.jsxs(de,{className:"flex items-center justify-between p-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Wartung f\\u00e4llig"}),s.jsx("p",{className:"text-lg font-bold",children:a})]}),s.jsx(Jn,{className:"w-5 h-5 text-red-500"})]})})]})},Ete=()=>{const t=[{machine:"Hubarbeitsbühne Genie GS-1932",type:"Wartung",date:"20.01.2024",priority:"Hoch"},{machine:"Bohrmaschine Hilti TE 6-A36",type:"Wartung",date:"15.03.2024",priority:"Mittel"},{machine:"Kabelzuggerät Greenlee 855GX",type:"Wartung",date:"08.04.2024",priority:"Niedrig"},{machine:"Messgerät Fluke 1587",type:"DGUV V3",date:"05.01.2025",priority:"Niedrig"}],e=n=>{switch(n){case"Hoch":return"bg-red-100 text-red-800";case"Mittel":return"bg-yellow-100 text-yellow-800";case"Niedrig":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(At,{className:"h-5 w-5"}),"Wartungsplan"]})}),s.jsx(de,{children:s.jsx("div",{className:"space-y-3",children:t.map(n=>s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(Be,{variant:"outline",className:"text-xs",children:n.type}),s.jsx(Be,{className:e(n.priority),children:n.priority})]}),s.jsx("p",{className:"font-medium text-sm mb-1",children:n.machine}),s.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx(At,{className:"h-3 w-3"}),n.date]})]},`${n.machine}-${n.date}`))})})]})},Ate=()=>s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{className:"text-base",children:"Geräteaktionen"})}),s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs(ne,{variant:"outline",className:"w-full justify-start",children:[s.jsx(At,{className:"h-4 w-4 mr-2"}),"Wartung planen"]}),s.jsxs(ne,{variant:"outline",className:"w-full justify-start",children:[s.jsx(ls,{className:"h-4 w-4 mr-2"}),"DGUV V3 Prüfung"]}),s.jsxs(ne,{variant:"outline",className:"w-full justify-start",children:[s.jsx(Mi,{className:"h-4 w-4 mr-2"}),"Standort ändern"]}),s.jsxs(ne,{variant:"outline",className:"w-full justify-start",children:[s.jsx(Po,{className:"h-4 w-4 mr-2"}),"Inventar"]})]})})]}),Pte=()=>s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{className:"text-base text-red-600",children:"Wartung überfällig"})}),s.jsx(de,{className:"p-4",children:s.jsx("div",{className:"space-y-2",children:s.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 rounded",children:[s.jsx("span",{className:"text-sm",children:"Hubarbeitsbühne"}),s.jsx("span",{className:"text-xs text-red-600",children:"3 Tage"})]})})})]}),Dte=()=>{const t=[{id:"M001",name:"Bohrmaschine Hilti TE 6-A36",category:"Bohrgeräte",location:"Baustelle Müller GmbH",status:"Im Einsatz",lastMaintenance:"15.12.2023",nextMaintenance:"15.03.2024",dguv:"22.11.2023",nextDguv:"22.11.2024",operatingHours:324,condition:"Gut"},{id:"M002",name:"Messgerät Fluke 1587",category:"Messgeräte",location:"Lager",status:"Verfügbar",lastMaintenance:"10.01.2024",nextMaintenance:"10.07.2024",dguv:"05.01.2024",nextDguv:"05.01.2025",operatingHours:156,condition:"Sehr gut"},{id:"M003",name:"Hubarbeitsbühne Genie GS-1932",category:"Hebegeräte",location:"Baustelle Weber Bau",status:"Wartung fällig",lastMaintenance:"20.10.2023",nextMaintenance:"20.01.2024",dguv:"15.12.2023",nextDguv:"15.12.2024",operatingHours:892,condition:"Wartung erforderlich"},{id:"M004",name:"Kabelzuggerät Greenlee 855GX",category:"Installationshilfen",location:"Fahrzeug 1",status:"Im Einsatz",lastMaintenance:"08.01.2024",nextMaintenance:"08.04.2024",dguv:"30.11.2023",nextDguv:"30.11.2024",operatingHours:245,condition:"Gut"}];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-indigo-600 bg-clip-text text-transparent flex items-center gap-3",children:[s.jsx(Po,{className:"h-8 w-8 text-indigo-600"}),"Maschinen & Geräte"]}),s.jsx("p",{className:"text-gray-600",children:"Verwalten Sie Ihren Maschinenpark und Wartungsintervalle"})]}),s.jsxs(ne,{children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Gerät hinzufügen"]})]}),s.jsx(Cte,{machines:t}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Maschinenübersicht"}),t.map(e=>s.jsx(kte,{machine:e},e.id))]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx(Ete,{}),s.jsx(Ate,{}),s.jsx(Pte,{})]})]})]})},Tte=()=>{const{toast:t}=It(),{data:e,isLoading:n}=x3(),{data:r,isLoading:a}=iG(),{data:i,isLoading:o}=oG(),[c,d]=g.useState([]),[u,m]=g.useState(!0),[f,p]=g.useState({hoursPerDay:0,breakHours:0,loaded:!1});v3();const[v,w]=g.useState("dashboard"),[x,y]=g.useState([]),[j,b]=g.useState(!1),[N,S]=g.useState(null),[E,C]=g.useState({}),[P,R]=g.useState(!1),[H,I]=g.useState({name:"",icon:"💼",items:[{name:"",value:"0"}]}),[D,W]=g.useState([]);g.useEffect(()=>{const Q=localStorage.getItem("handwerkos_custom_categories");if(Q)try{W(JSON.parse(Q))}catch(le){console.error("Error loading saved categories:",le)}},[]),g.useEffect(()=>{D.length>0&&localStorage.setItem("handwerkos_custom_categories",JSON.stringify(D))},[D]),g.useEffect(()=>{console.log("🔄 Working hours state updated:",f)},[f]);const[V,G]=g.useState({miete:"1.000",nebenkosten:"300",reinigung:"100",fahrzeugLeasing:"500",fahrzeugVersicherung:"150",fahrzeugSteuer:"100",versicherungHaftpflicht:"200",versicherungRente:"300",versicherungBerufsunfaehigkeit:"150",verwaltungSoftware:"150",verwaltungSteuerberater:"250",verwaltungMarketing:"200",personalGehaelter:"708",personalSozialversicherung:"142",personalWeihnachtsgeld:"100"}),Y=()=>{const le=1400+F().total+750+392+600,pe=D.reduce((J,ae)=>J+ae.total,0);return le+pe},X=Q=>Q.reduce((le,pe)=>{const J=parseFloat(pe.value.replace(/[^\d.-]/g,""))||0;return le+J},0),F=()=>{if(console.log("FinanceModule calculatePersonnelCosts:",{employees:c,employeeCount:(c==null?void 0:c.length)||0,employeesLoading:u}),!c||c.length===0)return console.log("FinanceModule: No employees found, returning zero costs"),{totalSalaries:0,socialInsurance:0,bonuses:0,total:0,employeeCount:0};const Q=localStorage.getItem("employeeWages"),le=Q?JSON.parse(Q):[];console.log("💾 Loaded wages from localStorage:",le);const pe=c.filter(Se=>{var Xe;const Ve=(Xe=Se.status)==null?void 0:Xe.toLowerCase();return Ve==="active"||Ve==="aktiv"||!Se.status}),J=pe.length,ae=pe.reduce((Se,Ve)=>{const Et=21.25*f.hoursPerDay,ke=le.find(dt=>dt.employee_id===Ve.id),Le=(ke==null?void 0:ke.hourly_wage)||Ve.hourly_rate||0,ze=Le*Et;return console.log(`👷 Employee ${Ve.first_name} ${Ve.last_name}:`,{status:Ve.status,hourly_rate_from_db:Ve.hourly_rate,hourly_rate_from_localStorage:ke==null?void 0:ke.hourly_wage,hourly_rate_used:Le,hours_per_month:Et,calculated_monthly:ze.toFixed(2)+"€"}),(!Ve.hourly_rate||Ve.hourly_rate===0)&&console.warn(`⚠️ Employee ${Ve.first_name} ${Ve.last_name} has no hourly rate set!`),Se+ze},0);console.log("💰 Total monthly salaries calculation:",{activeEmployeeCount:J,totalMonthlySalaries:ae.toFixed(2)+"€"});const he=ae*.21,ie=ae*2/12,_e={totalSalaries:ae,socialInsurance:he,bonuses:ie,total:ae+he+ie,employeeCount:J};return console.log("Personnel costs calculation result:",_e),_e},T=()=>{const Q=Y()/12,le=8e3/12,pe=25e3/12,J=Q+le+pe,ae=21.25,fe=f.hoursPerDay-f.breakHours,he=ae*fe,ve=J/he,ie=ve*1.3;return{minimumRate:ve,recommendedRate:ie,totalAmount:J,workingHours:he}};e!=null&&e.items;const q=(r==null?void 0:r.items)||[],U=i||{monthly_revenue:0,monthly_expenses:0,monthly_profit:0,total_outstanding:0,overdue_count:0,active_projects_profit:0,avg_profit_margin:0,revenue_trend:0,expense_trend:0,profit_trend:0},B=n||a||o||u,O=async()=>{try{console.log("⏰ Starting to fetch company working hours...",new Date().toISOString());const{data:Q}=await K.auth.getUser();if(!(Q!=null&&Q.user)){console.log("❌ No authenticated user");return}const{data:le,error:pe}=await K.from("profiles").select("company_id").eq("id",Q.user.id).single();if(console.log("👤 Profile query result:",{profile:le,profileError:pe}),!(le!=null&&le.company_id)){console.log("❌ No company_id found in profile");return}console.log("🔍 Fetching settings for company_id:",le.company_id);const{data:J,error:ae}=await K.from("company_settings").select("default_working_hours_start, default_working_hours_end, default_break_duration, company_id").eq("company_id",le.company_id).single();if(console.log("📊 Query result:",{settings:J,error:ae}),ae||!J){console.log("⚠️ No company settings found, checking if we need to create them");const{data:Fe,error:Nt}=await K.from("company_settings").insert({company_id:le.company_id,company_name:"Meine Firma",default_working_hours_start:"08:00:00",default_working_hours_end:"17:00:00",default_break_duration:30,default_tax_rate:19,default_currency:"EUR",quote_validity_days:30,invoice_prefix:"R",quote_prefix:"Q",order_prefix:"A"}).select().single();if(Nt){console.log("⚠️ Could not create settings, using default values. Error:",Nt),p({hoursPerDay:8,breakHours:.5,loaded:!0});return}console.log("✅ Created default company settings:",Fe),p({hoursPerDay:9,breakHours:.5,loaded:!0});return}console.log("📋 Raw company settings:",J);const fe=J.default_working_hours_start||"08:00",he=J.default_working_hours_end||"17:00",ve=fe.substring(0,5),ie=he.substring(0,5),_e=J.default_break_duration||30,[Se,Ve]=ve.split(":").map(Number),[Xe,Et]=ie.split(":").map(Number),ke=Se*60+Ve,Le=Xe*60+Et,ze=Le-ke,dt=ze/60,Ze=_e/60;console.log("🔢 Calculated hours:",{startMinutes:ke,endMinutes:Le,workMinutesPerDay:ze,hoursPerDay:dt,breakHours:Ze}),p({hoursPerDay:dt,breakHours:Ze,loaded:!0}),console.log("🕐 Company working hours loaded:",{startTime:ve,endTime:ie,breakMinutes:_e,hoursPerDay:dt,breakHours:Ze,productiveHours:dt-Ze})}catch(Q){console.error("❌ ERROR fetching company working hours:",Q),console.log("⚠️ Using fallback values due to error"),p({hoursPerDay:8,breakHours:.5,loaded:!0})}};g.useEffect(()=>{O(),(async()=>{try{m(!0);const{data:le}=await K.auth.getUser();if(!(le!=null&&le.user)){console.log("No authenticated user"),d([]),m(!1);return}const{data:pe}=await K.from("profiles").select("company_id").eq("id",le.user.id).single();if(!(pe!=null&&pe.company_id)){console.log("No company_id found"),d([]),m(!1);return}const{data:J,error:ae}=await K.from("employees").select("id, first_name, last_name, status, hourly_rate, position").eq("company_id",pe.company_id);if(ae)console.error("❌ Error fetching employees:",ae),d([]);else{console.log("✅ Fetched employees successfully:",J),console.log("📊 Employee details:",J==null?void 0:J.map(he=>({name:`${he.first_name} ${he.last_name}`,position:he.position,status:he.status,hourly_rate:he.hourly_rate,has_hourly_rate:he.hourly_rate!==null&&he.hourly_rate>0})));const fe=(J==null?void 0:J.filter(he=>!he.hourly_rate||he.hourly_rate===0))||[];fe.length>0&&console.warn("⚠️ Employees without hourly rate:",fe.map(he=>`${he.first_name} ${he.last_name}`)),d(J||[])}}catch(le){console.error("Error in fetchEmployees:",le),d([])}finally{m(!1)}})(),z()},[]),g.useEffect(()=>{if(console.log("🎯 Tab changed to:",v),v==="fixkosten"){console.log("📍 Tab is fixkosten, fetching working hours..."),O();const Q=setInterval(()=>{console.log("🔄 Refreshing working hours (interval)..."),O()},5e3);return()=>{console.log("🛑 Clearing interval for working hours refresh"),clearInterval(Q)}}},[v]),g.useEffect(()=>{const Q=()=>{document.visibilityState==="visible"&&v==="fixkosten"&&O()},le=()=>{v==="fixkosten"&&O()};return document.addEventListener("visibilitychange",Q),window.addEventListener("focus",le),()=>{document.removeEventListener("visibilitychange",Q),window.removeEventListener("focus",le)}},[v]);const z=async()=>{y([{month:"2024-08",revenue:22e3,expenses:16e3,profit:6e3},{month:"2024-09",revenue:28e3,expenses:19e3,profit:9e3},{month:"2024-10",revenue:31e3,expenses:22e3,profit:9e3},{month:"2024-11",revenue:26e3,expenses:18500,profit:7500},{month:"2024-12",revenue:35e3,expenses:24e3,profit:11e3},{month:"2025-01",revenue:25e3,expenses:18e3,profit:7e3}])},$=Q=>{switch(Q){case"materials":return"🧱";case"subcontractor":return"👷";case"labor":return"⏰";case"operating":return"🏢";default:return"📋"}},te=Q=>{switch(Q){case"materials":return"Material";case"subcontractor":return"Nachunternehmer";case"labor":return"Lohn";case"operating":return"Betriebskosten";default:return"Sonstiges"}},ee=Q=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(Q);return B?s.jsxs("div",{className:"p-6 bg-gray-50 min-h-screen",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsx(ft,{className:"h-10 w-64"}),s.jsxs("div",{className:"flex gap-6",children:[s.jsx(ft,{className:"h-10 w-24"}),s.jsx(ft,{className:"h-10 w-32"})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:Array(4).fill(0).map((Q,le)=>s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(ft,{className:"h-4 w-20 mb-2"}),s.jsx(ft,{className:"h-8 w-16"}),s.jsx(ft,{className:"h-3 w-12 mt-1"})]}),s.jsx(ft,{className:"h-8 w-8 rounded-full"})]})})},le))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(ft,{className:"h-6 w-32"})}),s.jsx(de,{children:s.jsx("div",{className:"space-y-4",children:Array(5).fill(0).map((Q,le)=>s.jsx("div",{className:"border rounded p-4",children:s.jsx(ft,{className:"h-20 w-full"})},le))})})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(ft,{className:"h-6 w-32"})}),s.jsx(de,{children:s.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((Q,le)=>s.jsx("div",{className:"p-3 bg-gray-50 rounded",children:s.jsx(ft,{className:"h-16 w-full"})},le))})})]})]})]}):s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Finanzen & Buchhaltung"}),s.jsx("div",{className:"flex items-center gap-4",children:s.jsxs(ne,{variant:"outline",className:"rounded-full",children:[s.jsx(Bf,{className:"h-4 w-4 mr-2"}),"Export"]})})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsumsatz"}),s.jsx("p",{className:"text-2xl font-bold text-green-700",children:ee(U.monthly_revenue)})]}),s.jsx(mr,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsausgaben"}),s.jsx("p",{className:"text-2xl font-bold text-red-700",children:ee(U.monthly_expenses)})]}),s.jsx(aj,{className:"h-8 w-8 text-red-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Monatsgewinn"}),s.jsx("p",{className:"text-2xl font-bold text-blue-700",children:ee(U.monthly_profit)})]}),s.jsx(Ei,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Offene Posten"}),s.jsx("p",{className:"text-2xl font-bold text-orange-700",children:ee(U.total_outstanding)}),s.jsx(Jn,{className:"h-8 w-8 text-orange-500 opacity-50"})]})})})]}),s.jsxs(es,{value:v,onValueChange:w,className:"w-full",children:[s.jsxs(Hn,{className:"grid w-full grid-cols-5 mb-6",children:[s.jsxs(He,{value:"dashboard",className:"flex items-center gap-2",children:[s.jsx(Al,{className:"h-4 w-4"}),"Dashboard"]}),s.jsxs(He,{value:"expenses",className:"flex items-center gap-2",children:[s.jsx(Fr,{className:"h-4 w-4"}),"Ausgaben"]}),s.jsxs(He,{value:"fixkosten",className:"flex items-center gap-2",children:[s.jsx(ca,{className:"h-4 w-4"}),"Betriebskosten"]}),s.jsxs(He,{value:"reports",className:"flex items-center gap-2",children:[s.jsx(Al,{className:"h-4 w-4"}),"Berichte"]}),s.jsxs(He,{value:"tax",className:"flex items-center gap-2",children:[s.jsx(mr,{className:"h-4 w-4"}),"Steuer"]})]}),s.jsx(We,{value:"dashboard",className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs(oe,{className:"lg:col-span-2",children:[s.jsx(je,{children:s.jsx(Ne,{children:"📊 Umsatz-Verlauf (letzte 6 Monate)"})}),s.jsx(de,{children:s.jsx("div",{className:"space-y-4",children:x.map((Q,le)=>{const pe=new Date(Q.month+"-01").toLocaleDateString("de-DE",{month:"short",year:"numeric"}),J=Math.max(...x.map(he=>he.revenue)),ae=Q.revenue/J*100,fe=Q.expenses/J*100;return s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:pe}),s.jsxs("span",{className:"font-medium",children:[ee(Q.profit)," Gewinn"]})]}),s.jsxs("div",{className:"relative h-6 bg-gray-100 rounded",children:[s.jsx("div",{className:"absolute h-full bg-green-500 rounded",style:{width:`${ae}%`}}),s.jsx("div",{className:"absolute h-full bg-red-400 rounded",style:{width:`${fe}%`}})]}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[s.jsxs("span",{children:["Umsatz: ",ee(Q.revenue)]}),s.jsxs("span",{children:["Ausgaben: ",ee(Q.expenses)]})]})]},le)})})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"⚡ Schnellzugriff"})}),s.jsxs(de,{className:"space-y-3",children:[s.jsxs(ne,{className:"w-full justify-start",variant:"outline",children:[s.jsx(wn,{className:"h-4 w-4 mr-2"}),"Neue Rechnung"]}),s.jsxs(ne,{className:"w-full justify-start",variant:"outline",children:[s.jsx(Fr,{className:"h-4 w-4 mr-2"}),"Ausgabe erfassen"]}),s.jsxs(ne,{className:"w-full justify-start",variant:"outline",children:[s.jsx(mr,{className:"h-4 w-4 mr-2"}),"Zahlung erfassen"]}),s.jsxs(ne,{className:"w-full justify-start",variant:"outline",children:[s.jsx(Bf,{className:"h-4 w-4 mr-2"}),"DATEV Export"]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"💎 Projekt-Rentabilität"})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm",children:"Aktive Projekte"}),s.jsx("span",{className:"font-medium",children:ee(U.active_projects_profit)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm",children:"Ø Gewinnmarge"}),s.jsxs(Be,{variant:"outline",children:[U.avg_profit_margin.toFixed(1),"%"]})]})]})})]})]})]})}),s.jsx(We,{value:"expenses",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"💸 Ausgabenmanagement"})}),s.jsx(de,{children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-4",children:"📋 Aktuelle Ausgaben"}),s.jsx("div",{className:"space-y-3",children:q.map(Q=>s.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("span",{className:"text-2xl",children:$(Q.category)}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:Q.description}),s.jsxs("p",{className:"text-sm text-gray-500",children:[te(Q.category)," • ",new Date(Q.date).toLocaleDateString("de-DE")]}),Q.project&&s.jsxs("p",{className:"text-xs text-blue-600",children:["→ ",Q.project]})]})]}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"font-bold text-red-600",children:ee(Q.amount)})})]},Q.id))})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-4",children:"📊 Ausgaben-Kategorien"}),s.jsx("div",{className:"space-y-3",children:["materials","subcontractor","labor","operating"].map(Q=>{const le=q.filter(J=>J.category===Q),pe=le.reduce((J,ae)=>J+ae.amount,0);return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xl",children:$(Q)}),s.jsx("span",{className:"font-medium",children:te(Q)})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-bold",children:ee(pe)}),s.jsxs("p",{className:"text-sm text-gray-500",children:[le.length," Ausgaben"]})]})]},Q)})})]})]})})]})}),s.jsx(We,{value:"reports",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"📊 Finanzberichte & Auswertungen"})}),s.jsx(de,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsxs(ne,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(wn,{className:"h-6 w-6"}),s.jsx("span",{children:"Offene Posten Liste"})]}),s.jsxs(ne,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(Ei,{className:"h-6 w-6"}),s.jsx("span",{children:"Umsatzauswertung"})]}),s.jsxs(ne,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(Al,{className:"h-6 w-6"}),s.jsx("span",{children:"Projekt-Rentabilität"})]}),s.jsxs(ne,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(ca,{className:"h-6 w-6"}),s.jsx("span",{children:"Kostenanalyse"})]}),s.jsxs(ne,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(mr,{className:"h-6 w-6"}),s.jsx("span",{children:"Liquiditätsplanung"})]}),s.jsxs(ne,{variant:"outline",className:"h-20 flex-col gap-2",children:[s.jsx(Bf,{className:"h-6 w-6"}),s.jsx("span",{children:"Jahresauswertung"})]})]})})]})}),s.jsx(We,{value:"tax",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"🏛️ Steuerliche Compliance"})}),s.jsx(de,{children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-4",children:"📊 Umsatzsteuer"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Umsatz 19% USt"}),s.jsx("span",{className:"font-medium",children:ee(18e3)})]}),s.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[s.jsx("span",{children:"Umsatzsteuer 19%"}),s.jsx("span",{children:ee(3420)})]})]}),s.jsxs("div",{className:"p-3 border rounded-lg",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Umsatz 7% USt"}),s.jsx("span",{className:"font-medium",children:ee(2e3)})]}),s.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[s.jsx("span",{children:"Umsatzsteuer 7%"}),s.jsx("span",{children:ee(140)})]})]}),s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("div",{className:"flex justify-between font-semibold",children:[s.jsx("span",{children:"Gesamte USt-Schuld"}),s.jsx("span",{className:"text-blue-600",children:ee(3560)})]})})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold mb-4",children:"📁 Export & Berichte"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(ne,{variant:"outline",className:"w-full justify-start",children:[s.jsx(Bf,{className:"h-4 w-4 mr-2"}),"DATEV-Export"]}),s.jsxs(ne,{variant:"outline",className:"w-full justify-start",children:[s.jsx(q_,{className:"h-4 w-4 mr-2"}),"CSV-Export"]}),s.jsxs(ne,{variant:"outline",className:"w-full justify-start",children:[s.jsx(wn,{className:"h-4 w-4 mr-2"}),"EÜR-Vorbereitung"]}),s.jsxs(ne,{variant:"outline",className:"w-full justify-start",children:[s.jsx(Po,{className:"h-4 w-4 mr-2"}),"Steuer-Einstellungen"]})]})]})]})})]})}),s.jsx(We,{value:"fixkosten",className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(ca,{className:"h-5 w-5"}),"💰 Betriebskosten (monatlich)"]}),s.jsx(vn,{children:"Verwalten Sie Ihre monatlichen Betriebskosten für die Stundensatz-Berechnung"})]}),s.jsxs(de,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"flex items-center gap-2 text-base",children:[s.jsx("span",{className:"text-xl",children:"🏢"}),"Betrieb & Büro"]})}),s.jsxs(de,{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Miete/Pacht"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.miete,onChange:Q=>G({...V,miete:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.miete," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Nebenkosten"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.nebenkosten,onChange:Q=>G({...V,nebenkosten:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.nebenkosten," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Reinigung"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.reinigung,onChange:Q=>G({...V,reinigung:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.reinigung," €"]})]}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:ee(1400)})]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"flex items-center gap-2 text-base",children:[s.jsx("span",{className:"text-xl",children:"👷‍♂️"}),"Personal"]})}),s.jsx(de,{className:"space-y-2",children:(()=>{const Q=F();return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm text-muted-foreground",children:["Fixgehälter Mitarbeiter (",Q.employeeCount," MA)"]}),s.jsx("span",{className:"text-sm font-medium",children:ee(Q.totalSalaries)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Arbeitgeberanteile Sozialversicherung"}),s.jsx("span",{className:"text-sm font-medium",children:ee(Q.socialInsurance)})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Weihnachts-/Urlaubsgeld"}),s.jsx("span",{className:"text-sm font-medium",children:ee(Q.bonuses)})]}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:ee(Q.total)})]}),Q.employeeCount===0&&s.jsxs("div",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded mt-2",children:["⚠️ Keine aktiven Mitarbeiter gefunden. Personalkosten sind 0 €.",s.jsx("br",{}),s.jsx("span",{className:"text-xs",children:"Stellen Sie sicher, dass Mitarbeiter einen Stundenlohn haben und aktiv sind."})]}),Q.employeeCount>0&&Q.total===0&&s.jsx("div",{className:"text-xs text-amber-600 bg-amber-50 p-2 rounded mt-2",children:"⚠️ Mitarbeiter gefunden, aber keine Stundenlöhne eingetragen."})]})})()})]}),s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"flex items-center gap-2 text-base",children:[s.jsx("span",{className:"text-xl",children:"🚗"}),"Fahrzeuge"]})}),s.jsxs(de,{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Leasing/Abschreibung"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.fahrzeugLeasing,onChange:Q=>G({...V,fahrzeugLeasing:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.fahrzeugLeasing," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Versicherung"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.fahrzeugVersicherung,onChange:Q=>G({...V,fahrzeugVersicherung:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.fahrzeugVersicherung," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Steuer & Wartung"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.fahrzeugSteuer,onChange:Q=>G({...V,fahrzeugSteuer:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.fahrzeugSteuer," €"]})]}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:ee(9e3)})]})]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"flex items-center gap-2 text-base",children:[s.jsx("span",{className:"text-xl",children:"🛡️"}),"Versicherungen & Beiträge"]})}),s.jsxs(de,{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Betriebshaftpflicht"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.versicherungHaftpflicht,onChange:Q=>G({...V,versicherungHaftpflicht:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.versicherungHaftpflicht," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Berufsgenossenschaft"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.versicherungRente,onChange:Q=>G({...V,versicherungRente:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.versicherungRente," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Kammer/Innung"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.versicherungBerufsunfaehigkeit,onChange:Q=>G({...V,versicherungBerufsunfaehigkeit:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.versicherungBerufsunfaehigkeit," €"]})]}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:ee(4700)})]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"flex items-center gap-2 text-base",children:[s.jsx("span",{className:"text-xl",children:"🏭"}),"Verwaltung & Organisation"]})}),s.jsxs(de,{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Software & Lizenzen"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.verwaltungSoftware,onChange:Q=>G({...V,verwaltungSoftware:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.verwaltungSoftware," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Steuerberater"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.verwaltungSteuerberater,onChange:Q=>G({...V,verwaltungSteuerberater:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.verwaltungSteuerberater," €"]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Marketing & Werbung"}),j?s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(re,{type:"text",value:V.verwaltungMarketing,onChange:Q=>G({...V,verwaltungMarketing:Q.target.value}),className:"h-7 w-20 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]}):s.jsxs("span",{className:"text-sm font-medium",children:[V.verwaltungMarketing," €"]})]}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:ee(7200)})]})]})]}),D.map(Q=>{const le=j||N===Q.id,pe=E[Q.id]||Q;return s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"flex items-center justify-between text-base",children:[s.jsx("div",{className:"flex items-center gap-2",children:le?s.jsxs(s.Fragment,{children:[s.jsx(re,{type:"text",value:pe.icon,onChange:J=>C({...E,[Q.id]:{...pe,icon:J.target.value}}),className:"w-12 h-8 text-center text-xl p-0"}),s.jsx(re,{type:"text",value:pe.name,onChange:J=>C({...E,[Q.id]:{...pe,name:J.target.value}}),className:"h-8 text-base font-semibold"})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-xl",children:Q.icon}),s.jsx("span",{children:Q.name})]})}),!j&&s.jsx(ne,{size:"sm",variant:"ghost",onClick:()=>{W(J=>J.filter(ae=>ae.id!==Q.id))},className:"h-7 w-7 p-0 text-red-500 hover:text-red-700",children:s.jsx($n,{className:"h-4 w-4"})})]})}),s.jsxs(de,{className:"space-y-2",children:[le?s.jsxs(s.Fragment,{children:[pe.items.map((J,ae)=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(re,{type:"text",value:J.name,onChange:fe=>{const he=[...pe.items];he[ae].name=fe.target.value,C({...E,[Q.id]:{...pe,items:he}})},className:"flex-1 h-7 text-sm"}),s.jsx(re,{type:"text",value:J.value,onChange:fe=>{const he=[...pe.items];he[ae].value=fe.target.value,C({...E,[Q.id]:{...pe,items:he}})},className:"w-20 h-7 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]},ae)),s.jsxs(ne,{variant:"outline",size:"sm",className:"w-full h-7 mt-2",onClick:()=>{const J=[...pe.items,{name:"",value:"0"}];C({...E,[Q.id]:{...pe,items:J}})},children:[s.jsx(rn,{className:"h-3 w-3 mr-1"}),"Zeile hinzufügen"]})]}):s.jsx(s.Fragment,{children:Q.items.map((J,ae)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:J.name}),s.jsxs("span",{className:"text-sm font-medium",children:[J.value," €"]})]},ae))}),s.jsx("hr",{className:"my-2"}),s.jsxs("div",{className:"flex justify-between items-center font-medium",children:[s.jsx("span",{children:"Gesamt"}),s.jsx("span",{children:ee(le?X(pe.items):Q.total)})]})]})]},Q.id)}),P?s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsx(Ne,{className:"flex items-center gap-2 text-base",children:s.jsx(re,{type:"text",placeholder:"🏢 Kategorie Name",value:H.name,onChange:Q=>I({...H,name:Q.target.value}),className:"text-base font-semibold border-none p-0 h-auto bg-transparent"})})}),s.jsxs(de,{className:"space-y-2",children:[H.items.map((Q,le)=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(re,{type:"text",placeholder:"Kostenpunkt",value:Q.name,onChange:pe=>{const J=[...H.items];J[le].name=pe.target.value,I({...H,items:J})},className:"flex-1 h-7 text-sm"}),s.jsx(re,{type:"text",placeholder:"0",value:Q.value,onChange:pe=>{const J=[...H.items];J[le].value=pe.target.value,I({...H,items:J})},className:"w-20 h-7 text-right text-sm"}),s.jsx("span",{className:"text-sm",children:"€"})]},le)),s.jsxs(ne,{variant:"outline",size:"sm",className:"w-full h-7",onClick:()=>I({...H,items:[...H.items,{name:"",value:"0"}]}),children:[s.jsx(rn,{className:"h-3 w-3 mr-1"}),"Kostenpunkt hinzufügen"]}),s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsx(ne,{variant:"outline",size:"sm",onClick:()=>{R(!1),I({name:"",icon:"💼",items:[{name:"",value:"0"}]})},children:s.jsx($n,{className:"h-4 w-4"})}),s.jsx(ne,{size:"sm",onClick:()=>{if(H.name&&H.items.some(Q=>Q.name)){const Q=X(H.items),le={id:Date.now().toString(),name:H.name,icon:H.icon,items:H.items,total:Q};W(pe=>[...pe,le]),R(!1),I({name:"",icon:"💼",items:[{name:"",value:"0"}]}),t({title:"Kategorie erstellt",description:`"${H.name}" wurde erfolgreich hinzugefügt.`})}},children:s.jsx(zh,{className:"h-4 w-4"})})]})]})]}):s.jsx(oe,{className:"border-dashed border-2 border-gray-300 hover:border-gray-400 transition-colors cursor-pointer",onClick:()=>R(!0),children:s.jsx(de,{className:"flex items-center justify-center h-48 p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center mx-auto mb-3 transition-colors",children:s.jsx(rn,{className:"h-6 w-6 text-gray-400"})}),s.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Neue Kategorie"}),s.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"hinzufügen"})]})})})]})]}),s.jsx("div",{className:"flex justify-end gap-2",children:j?s.jsxs(s.Fragment,{children:[s.jsx(ne,{variant:"outline",size:"sm",onClick:()=>{b(!1),S(null),C({})},children:s.jsx($n,{className:"h-4 w-4"})}),s.jsx(ne,{size:"sm",onClick:()=>{Object.keys(E).forEach(Q=>{const le=E[Q],pe={...le,total:X(le.items)};W(J=>J.map(ae=>ae.id===Q?pe:ae))}),b(!1),S(null),C({}),t({title:"Kosten aktualisiert",description:"Die Betriebskosten wurden erfolgreich gespeichert."})},children:s.jsx(zh,{className:"h-4 w-4"})})]}):s.jsx(ne,{variant:"outline",size:"sm",onClick:()=>{b(!0);const Q={};D.forEach(le=>{Q[le.id]=le}),C(Q)},children:s.jsx(wB,{className:"h-4 w-4"})})})]})]}),s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:"⚡"}),"Stundensatz-Rechner"]}),s.jsx(vn,{children:"Automatische Berechnung basierend auf Betriebskosten"})]}),s.jsxs(de,{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsx(se,{className:"text-sm text-muted-foreground",children:"Fixkosten (Betrieb)"}),s.jsxs("p",{className:"text-2xl font-bold",children:[ee(Y()/12)," / Monat"]})]}),s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsx(se,{className:"text-sm text-muted-foreground",children:"Variable Grundkosten"}),s.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[ee(8e3/12)," / Monat"]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Material (netto), etc."})]}),s.jsxs("div",{className:"p-4 border rounded-lg",children:[s.jsx(se,{className:"text-sm text-muted-foreground",children:"Gewollter Gewinn"}),s.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[ee(25e3/12)," / Monat"]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[s.jsx(se,{className:"text-sm text-muted-foreground",children:"Arbeitstage 2025"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"text-xl font-semibold",children:"261 Tage"}),s.jsx(Be,{variant:"outline",children:"8 Stunden"})]})]}),s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[s.jsx(se,{className:"text-sm text-muted-foreground",children:"Urlaubstage:"}),s.jsx("p",{className:"text-lg",children:"- 30 Tage"})]}),s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[s.jsx(se,{className:"text-sm text-muted-foreground",children:"Arbeitsstunden/Monat:"}),f.loaded?s.jsxs(s.Fragment,{children:[s.jsxs("p",{className:"text-xl font-semibold",children:[Math.round(21.25*f.hoursPerDay)," Stunden"]}),s.jsxs(Be,{variant:"secondary",className:"mt-2",children:[Math.round(21.25*(f.hoursPerDay-f.breakHours))," Stunden (nach Pausen)"]}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["21,25 Tage × ",Number(f.hoursPerDay).toFixed(1),"h - ",Number(f.breakHours*60).toFixed(0)," Min. Pausen"]})]}):s.jsx("p",{className:"text-sm text-muted-foreground",children:"Lade Arbeitszeiten..."})]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[s.jsx(se,{className:"text-sm text-muted-foreground",children:"Mindest-Stundensatz"}),s.jsx("p",{className:"text-3xl font-bold text-blue-600",children:ee(T().minimumRate)}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["(",ee(T().totalAmount)," ÷ ",T().workingHours,"h)"]})]}),s.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[s.jsx(se,{className:"text-sm text-muted-foreground",children:"Empfohlener Stundensatz"}),s.jsx("p",{className:"text-3xl font-bold text-green-600",children:ee(T().recommendedRate)}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"+30% Gewinnaufschlag & Rücklage"})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsxs(ne,{size:"lg",children:[s.jsx(ca,{className:"h-4 w-4 mr-2"}),"Stundensatz anpassen"]})})]})]})]})})]})]})};var Mte="Separator",sE="horizontal",Rte=["horizontal","vertical"],TI=g.forwardRef((t,e)=>{const{decorative:n,orientation:r=sE,...a}=t,i=Ite(r)?r:sE,c=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return s.jsx(tt.div,{"data-orientation":i,...c,...a,ref:e})});TI.displayName=Mte;function Ite(t){return Rte.includes(t)}var MI=TI;const qa=g.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...r},a)=>s.jsx(MI,{ref:a,decorative:n,orientation:e,className:Ie("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));qa.displayName=MI.displayName;const Ote=()=>{const[t,e]=g.useState(new Date),[n,r]=g.useState("month"),[a,i]=g.useState("overview"),[o,c]=g.useState("all"),[d,u]=g.useState("all"),[m,f]=g.useState([]),[p,v]=g.useState([]),[w,x]=g.useState([]),[y,j]=g.useState([]),[b,N]=g.useState([]),[S,E]=g.useState(!0),{toast:C}=It();g.useEffect(()=>{P()},[]);const P=async()=>{E(!0);try{await Promise.all([R(),H(),I(),D(),W()])}catch(te){console.error("Error loading planner data:",te),C({title:"Fehler beim Laden",description:"Die Planerdaten konnten nicht geladen werden.",variant:"destructive"})}E(!1)},R=async()=>{const{data:te,error:ee}=await K.from("projects").select("*").order("start_date");if(ee)throw ee;f(te||[])},H=async()=>{try{const{data:te}=await K.auth.getUser();if(!(te!=null&&te.user))return;const{data:ee}=await K.from("profiles").select("company_id").eq("id",te.user.id).single();if(!(ee!=null&&ee.company_id))return;const{data:Q,error:le}=await K.from("employees").select("*").eq("company_id",ee.company_id).neq("status","eingeladen").not("user_id","is",null).order("last_name");if(le)throw le;v(Q||[])}catch(te){console.error("Error loading employees:",te)}},I=async()=>{const{data:te,error:ee}=await K.from("employee_absences").select(`
        *,
        employee:employees!employee_absences_employee_id_fkey(*)
      `).order("start_date");if(ee)throw ee;x(te||[])},D=async()=>{const{data:te,error:ee}=await K.from("calendar_events").select("*").order("start_date");if(ee)throw ee;j(te||[])},W=async()=>{const{data:te,error:ee}=await K.from("project_assignments").select(`
        *,
        project:projects(*),
        employee:employees(*)
      `).order("start_date");if(ee)throw ee;N(te||[])},V=()=>n==="week"?{start:Wr(t,{weekStartsOn:1}),end:Km(t,{weekStartsOn:1})}:{start:As(t),end:Vm(t)},{start:G,end:Y}=V();_Y({start:G,end:Y});const X=()=>{e(n==="week"?OX(t,1):IX(t,1))},F=()=>{e(n==="week"?cm(t,1):br(t,1))},T=te=>{switch(te){case"urlaub":return"bg-green-500";case"krank":return"bg-red-500";case"fortbildung":return"bg-blue-500";case"elternzeit":return"bg-purple-500";default:return"bg-gray-500"}},q=te=>{switch(te){case"urlaub":return s.jsx(At,{className:"w-3 h-3"});case"krank":return s.jsx(Am,{className:"w-3 h-3"});case"fortbildung":return s.jsx(Ds,{className:"w-3 h-3"});default:return s.jsx(Pt,{className:"w-3 h-3"})}},U=te=>{switch(te){case"genehmigt":return s.jsx(ls,{className:"w-3 h-3 text-green-500"});case"abgelehnt":return s.jsx(So,{className:"w-3 h-3 text-red-500"});default:return s.jsx(Pt,{className:"w-3 h-3 text-yellow-500"})}},B=[...new Set(p.map(te=>te.department).filter(Boolean))];d==="all"||p.filter(te=>te.department===d);const O=()=>{const te=t.getFullYear(),ee=Array.from({length:12},(pe,J)=>J),Q=Array.from({length:31},(pe,J)=>J+1),le=(pe,J)=>{const ae=new Date(te,pe,J);if(ae.getMonth()!==pe)return null;De(ae,"yyyy-MM-dd");const fe=[];return m.forEach(he=>{const ve=new Date(he.start_date),ie=he.end_date?new Date(he.end_date):ve;ae>=ve&&ae<=ie&&fe.push({type:"project",item:he,color:he.color})}),w.forEach(he=>{const ve=new Date(he.start_date),ie=new Date(he.end_date);ae>=ve&&ae<=ie&&fe.push({type:"absence",item:he,color:T(he.type).replace("bg-","")})}),y.forEach(he=>{const ve=new Date(he.start_date),ie=new Date(he.end_date);ae>=ve&&ae<=ie&&fe.push({type:"event",item:he,color:he.color})}),fe.length>0?fe:null};return s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"120px repeat(31, 1fr)"},children:[s.jsx("div",{className:"p-3 border-r border-border font-medium text-center",children:"Monat"}),Q.map(pe=>s.jsx("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:pe},pe))]}),ee.map((pe,J)=>s.jsxs("div",{className:`grid ${J%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"120px repeat(31, 1fr)"},children:[s.jsx("div",{className:"p-3 border-r border-border font-medium text-center bg-muted/50",children:De(new Date(te,pe,1),"MMMM",{locale:zt})}),Q.map(ae=>{const he=new Date(te,pe,ae).getMonth()===pe,ve=he?le(pe,ae):null,ie=(Se,Ve)=>{if(Se.type==="project"){const Xe=new Date(Se.item.start_date);return ys(Xe,Ve)||Xe<Ve&&ae===1}if(Se.type==="absence"){const Xe=new Date(Se.item.start_date);return ys(Xe,Ve)||Xe<Ve&&ae===1}if(Se.type==="event"){const Xe=new Date(Se.item.start_date);return ys(Xe,Ve)||Xe<Ve&&ae===1}return!1},_e=(Se,Ve)=>{const Xe=new Date(te,pe,1),Et=new Date(te,pe+1,0);let ke,Le;Se.type==="project"?(ke=new Date(Se.item.start_date),Le=Se.item.end_date?new Date(Se.item.end_date):new Date):Se.type==="absence"?(ke=new Date(Se.item.start_date),Le=new Date(Se.item.end_date)):(ke=new Date(Se.item.start_date),Le=new Date(Se.item.end_date));const ze=ke<Xe?Xe:ke,dt=Le>Et?Et:Le,Ze=ze.getDate(),Fe=dt.getDate();return Le>Et?Et.getDate()-Ze+1:Fe-Ze+1};return s.jsx("div",{className:`border-r border-border last:border-r-0 h-16 relative ${he?"":"bg-muted/30"}`,children:he&&ve&&s.jsx("div",{className:"absolute inset-0 p-1",children:ve.map((Se,Ve)=>{var Le,ze,dt,Ze;const Xe=new Date(te,pe,ae);if(!ie(Se,Xe))return null;const ke=_e(Se);return s.jsxs("div",{className:"h-3 rounded text-white text-xs flex items-center justify-center font-medium shadow-sm absolute hover:h-4 hover:z-20 transition-all duration-200 group cursor-pointer",style:{backgroundColor:Se.type==="project"?Se.color:Se.type==="absence"?`rgb(${Se.color==="green-500"?"34 197 94":Se.color==="red-500"?"239 68 68":Se.color==="blue-500"?"59 130 246":"107 114 128"})`:Se.item.color,width:`${ke*100}%`,left:0,top:`${2+Ve*14}px`,zIndex:10},title:Se.type==="project"?`Projekt: ${Se.item.name}`:Se.type==="absence"?`${Se.item.type}: ${(Le=Se.item.employee)==null?void 0:Le.first_name} ${(ze=Se.item.employee)==null?void 0:ze.last_name}`:`Termin: ${Se.item.title}`,children:[ke>=3&&s.jsxs(s.Fragment,{children:[Se.type==="project"&&s.jsx(Mc,{className:"w-1.5 h-1.5"}),Se.type==="absence"&&q(Se.item.type),Se.type==="event"&&s.jsx(At,{className:"w-1.5 h-1.5"})]}),s.jsx("div",{className:"absolute top-[-32px] left-0 bg-background border border-border rounded px-2 py-1 text-xs text-foreground shadow-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-30",children:Se.type==="project"?Se.item.name:Se.type==="absence"?`${Se.item.type}: ${(dt=Se.item.employee)==null?void 0:dt.first_name} ${(Ze=Se.item.employee)==null?void 0:Ze.last_name}`:Se.item.title})]},`${Se.type}-${Se.item.id||Ve}`)})})},ae)})]},pe))]})})},z=()=>{const te=t.getMonth(),ee=t.getFullYear(),Q=new Date(ee,te+1,0).getDate(),le=Array.from({length:Q},(ae,fe)=>fe+1),pe=m.filter(ae=>{const fe=ae.status.toLowerCase();if(fe==="aktiv"||fe==="geplant"||fe==="in bearbeitung")return!0;const ve=new Date(ae.start_date),ie=ae.end_date?new Date(ae.end_date):new Date,_e=new Date(ee,te,1),Se=new Date(ee,te+1,0);return ve<=Se&&ie>=_e}),J=(ae,fe)=>{const he=new Date(ee,te,fe);return b.filter(ve=>{const ie=new Date(ve.start_date),_e=ve.end_date?new Date(ve.end_date):ie;return ve.project_id===ae&&he>=ie&&he<=_e})};return s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"200px repeat("+Q+", 1fr)"},children:[s.jsx("div",{className:"p-3 border-r border-border font-medium",children:"Projekt"}),le.map(ae=>s.jsxs("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:[s.jsx("div",{children:ae}),s.jsx("div",{className:"text-muted-foreground",children:De(new Date(ee,te,ae),"EEE",{locale:zt})})]},ae))]}),pe.length===0?s.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:["Keine aktiven Projekte in ",De(t,"MMMM yyyy",{locale:zt})]}):pe.map((ae,fe)=>s.jsxs("div",{className:`grid ${fe%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"200px repeat("+Q+", 1fr)"},children:[s.jsxs("div",{className:"p-3 border-r border-border",children:[s.jsx("div",{className:"font-medium text-sm",children:ae.name}),s.jsx("div",{className:"text-xs text-muted-foreground",children:ae.location}),s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsx(Be,{variant:"outline",className:"text-xs",children:ae.status}),s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:ae.color},title:`Projekt: ${ae.name}`})]})]}),s.jsxs("div",{className:"relative h-20",style:{gridColumn:`2 / ${Q+2}`},children:[s.jsx("div",{className:"absolute inset-0 grid",style:{gridTemplateColumns:`repeat(${Q}, 1fr)`},children:le.map(he=>s.jsx("div",{className:"border-r border-border last:border-r-0"},he))}),(()=>{const he=new Date(ae.start_date),ve=ae.end_date?new Date(ae.end_date):he,ie=new Date(ee,te,1),_e=new Date(ee,te+1,0),Se=he<ie?1:he.getDate(),Ve=ve>_e?Q:ve.getDate();if(ve<ie||he>_e)return null;const Xe=(Ve-Se+1)/Q*100,Et=(Se-1)/Q*100;return s.jsxs("div",{className:"absolute top-2 h-12 rounded-md flex items-center px-3 text-white text-sm font-medium shadow-md z-10",style:{left:`${Et}%`,width:`${Xe}%`,backgroundColor:ae.color,minWidth:"60px"},title:`${ae.name} (${De(he,"dd.MM.yyyy")} - ${De(ve,"dd.MM.yyyy")})`,children:[s.jsx(Mc,{className:"w-4 h-4 mr-2 flex-shrink-0"}),s.jsx("span",{className:"truncate",children:ae.name}),s.jsx("div",{className:"ml-auto flex items-center space-x-1",children:s.jsxs("span",{className:"text-xs opacity-90",children:[De(he,"dd.MM")," - ",De(ve,"dd.MM")]})})]})})(),le.map(he=>{const ve=J(ae.id,he);if(ve.length===0)return null;const ie=(he-1)/Q*100,_e=1/Q*100;return s.jsxs("div",{className:"absolute bottom-1 h-4 bg-blue-100 dark:bg-blue-900 border border-blue-300 dark:border-blue-700 rounded flex items-center justify-center",style:{left:`${ie}%`,width:`${_e-1}%`,minWidth:"20px"},title:`${ve.length} Mitarbeiter: ${ve.map(Se=>{var Ve,Xe;return`${(Ve=Se.employee)==null?void 0:Ve.first_name} ${(Xe=Se.employee)==null?void 0:Xe.last_name} (${Se.hours_per_day}h)`}).join(", ")}`,children:[s.jsx(Ds,{className:"w-2 h-2 text-blue-600 dark:text-blue-400"}),s.jsx("span",{className:"text-xs ml-1 text-blue-600 dark:text-blue-400",children:ve.length})]},`assignments-${he}`)})]})]},ae.id))]})})},$=()=>{const te=t.getMonth(),ee=t.getFullYear(),Q=new Date(ee,te+1,0).getDate(),le=Array.from({length:Q},(J,ae)=>ae+1),pe=p.filter(J=>J.status==="aktiv");return s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("div",{className:"min-w-[1200px] border border-border rounded-lg overflow-hidden",children:[s.jsxs("div",{className:"grid bg-muted",style:{gridTemplateColumns:"200px repeat("+Q+", 1fr)"},children:[s.jsx("div",{className:"p-3 border-r border-border font-medium",children:"Mitarbeiter"}),le.map(J=>s.jsxs("div",{className:"p-2 text-center text-xs border-r border-border last:border-r-0 font-medium",children:[s.jsx("div",{children:J}),s.jsx("div",{className:"text-muted-foreground",children:De(new Date(ee,te,J),"EEE",{locale:zt})})]},J))]}),pe.length===0?s.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:["Keine aktiven Mitarbeiter in ",De(t,"MMMM yyyy",{locale:zt})]}):pe.map((J,ae)=>{const fe=w.filter(he=>{const ve=new Date(he.start_date),ie=new Date(he.end_date),_e=new Date(ee,te,1),Se=new Date(ee,te+1,0);return he.employee_id===J.id&&ve<=Se&&ie>=_e});return s.jsxs("div",{className:`grid ${ae%2===0?"bg-background":"bg-muted/50"} border-b border-border last:border-b-0`,style:{gridTemplateColumns:"200px repeat("+Q+", 1fr)"},children:[s.jsxs("div",{className:"p-3 border-r border-border",children:[s.jsxs("div",{className:"font-medium text-sm",children:[J.first_name," ",J.last_name]}),s.jsx("div",{className:"text-xs text-muted-foreground",children:J.position}),s.jsx("div",{className:"text-xs text-muted-foreground",children:J.department})]}),s.jsxs("div",{className:"relative h-20",style:{gridColumn:`2 / ${Q+2}`},children:[s.jsx("div",{className:"absolute inset-0 grid",style:{gridTemplateColumns:`repeat(${Q}, 1fr)`},children:le.map(he=>s.jsx("div",{className:"border-r border-border last:border-r-0"},he))}),fe.map((he,ve)=>{const ie=new Date(he.start_date),_e=new Date(he.end_date),Se=new Date(ee,te,1),Ve=new Date(ee,te+1,0),Xe=ie<Se?1:ie.getDate(),ke=((_e>Ve?Q:_e.getDate())-Xe+1)/Q*100,Le=(Xe-1)/Q*100,ze=2+ve*16;return s.jsxs("div",{className:`absolute h-12 rounded-md flex items-center px-3 text-white text-xs font-medium shadow-md z-10 ${T(he.type)}`,style:{left:`${Le}%`,width:`${ke}%`,top:`${ze}px`,minWidth:"60px"},title:`${he.type} (${De(ie,"dd.MM.yyyy")} - ${De(_e,"dd.MM.yyyy")}) - ${he.status}${he.reason?` - ${he.reason}`:""}`,children:[q(he.type),s.jsx("span",{className:"ml-2 truncate",children:he.type}),s.jsxs("div",{className:"ml-auto flex items-center space-x-1",children:[U(he.status),s.jsxs("span",{className:"text-xs opacity-90",children:[De(ie,"dd.MM")," - ",De(_e,"dd.MM")]})]})]},he.id)}),le.map(he=>{const ve=b.filter(Se=>{const Ve=new Date(Se.start_date),Xe=Se.end_date?new Date(Se.end_date):Ve,Et=new Date(ee,te,he);return Se.employee_id===J.id&&Et>=Ve&&Et<=Xe});if(ve.length===0)return null;const ie=(he-1)/Q*100,_e=1/Q*100;return s.jsxs("div",{className:"absolute bottom-1 h-4 bg-blue-100 dark:bg-blue-900 border border-blue-300 dark:border-blue-700 rounded flex items-center justify-center",style:{left:`${ie}%`,width:`${_e-1}%`,minWidth:"20px"},title:`${ve.length} Projekt(e): ${ve.map(Se=>{var Ve;return`${(Ve=Se.project)==null?void 0:Ve.name} (${Se.hours_per_day}h)`}).join(", ")}`,children:[s.jsx(Mc,{className:"w-2 h-2 text-blue-600 dark:text-blue-400"}),s.jsx("span",{className:"text-xs ml-1 text-blue-600 dark:text-blue-400",children:ve.length})]},`assignments-${he}`)})]})]},J.id)})]})})};return S?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{children:"Lade Planerdaten..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-teal-600 bg-clip-text text-transparent flex items-center gap-3",children:[s.jsx(At,{className:"h-8 w-8 text-teal-600"}),"Planer"]}),s.jsxs(Be,{variant:"outline",className:"flex items-center space-x-1",children:[s.jsx(At,{className:"w-4 h-4"}),s.jsx("span",{children:"Ressourcenplanung"})]})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[a==="overview"&&s.jsxs(s.Fragment,{children:[s.jsxs(ut,{value:d,onValueChange:u,children:[s.jsx(lt,{className:"w-48",children:s.jsx(ht,{placeholder:"Alle Abteilungen"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"all",children:"Alle Abteilungen"}),B.map(te=>s.jsx(xe,{value:te,children:te},te))]})]}),s.jsxs(ut,{value:o,onValueChange:te=>c(te),children:[s.jsx(lt,{className:"w-40",children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"all",children:"Alle anzeigen"}),s.jsx(xe,{value:"projects",children:"Nur Projekte"}),s.jsx(xe,{value:"absences",children:"Nur Abwesenheiten"}),s.jsx(xe,{value:"events",children:"Nur Termine"})]})]})]}),s.jsxs(ut,{value:n,onValueChange:te=>r(te),children:[s.jsx(lt,{className:"w-32",children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"week",children:"Woche"}),s.jsx(xe,{value:"month",children:"Monat"})]})]}),s.jsx(ne,{onClick:P,variant:"outline",size:"sm",children:"Aktualisieren"})]})]}),s.jsxs(es,{value:a,onValueChange:te=>i(te),children:[s.jsxs(Hn,{className:"grid w-full grid-cols-4",children:[s.jsxs(He,{value:"overview",className:"flex items-center space-x-2",children:[s.jsx(At,{className:"w-4 h-4"}),s.jsx("span",{children:"Übersicht"})]}),s.jsxs(He,{value:"projects",className:"flex items-center space-x-2",children:[s.jsx(Mc,{className:"w-4 h-4"}),s.jsx("span",{children:"Projekte"})]}),s.jsxs(He,{value:"employees",className:"flex items-center space-x-2",children:[s.jsx(Br,{className:"w-4 h-4"}),s.jsx("span",{children:"Mitarbeiter"})]}),s.jsxs(He,{value:"resources",className:"flex items-center space-x-2",children:[s.jsx(Mi,{className:"w-4 h-4"}),s.jsx("span",{children:"Ressourcen"})]})]}),s.jsx(We,{value:"overview",className:"space-y-4",children:s.jsxs(oe,{children:[s.jsx(je,{className:"pb-4",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(Ne,{className:"flex items-center space-x-2",children:[s.jsx(Pt,{className:"w-5 h-5"}),s.jsx("span",{children:n==="week"?`${De(G,"dd.MM",{locale:zt})} - ${De(Y,"dd.MM.yyyy",{locale:zt})}`:De(t,"MMMM yyyy",{locale:zt})})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ne,{variant:"outline",size:"sm",onClick:X,children:s.jsx(dh,{className:"w-4 h-4"})}),s.jsxs(Za,{children:[s.jsx(Ga,{asChild:!0,children:s.jsxs(ne,{variant:"outline",size:"sm",className:Ie("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),De(t,"MMMM yyyy",{locale:zt})]})}),s.jsx(fa,{className:"w-auto p-0",align:"start",children:s.jsx(pa,{mode:"single",selected:t,onSelect:te=>te&&e(te),initialFocus:!0,className:Ie("p-3 pointer-events-auto")})})]}),s.jsx(ne,{variant:"outline",size:"sm",onClick:F,children:s.jsx(Pl,{className:"w-4 h-4"})})]})]})}),s.jsxs(de,{children:[O(),s.jsxs("div",{className:"mt-6 space-y-3",children:[s.jsx("h4",{className:"font-medium",children:"Legende"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded"}),s.jsx("span",{children:"Urlaub"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),s.jsx("span",{children:"Krank"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),s.jsx("span",{children:"Projekte/Fortbildung"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded"}),s.jsx("span",{children:"Elternzeit"})]})]}),s.jsx(qa,{}),s.jsxs("div",{className:"flex items-center space-x-6 text-xs",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ls,{className:"w-4 h-4 text-green-500"}),s.jsx("span",{children:"Genehmigt"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Pt,{className:"w-4 h-4 text-yellow-500"}),s.jsx("span",{children:"Beantragt"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(So,{className:"w-4 h-4 text-red-500"}),s.jsx("span",{children:"Abgelehnt"})]})]})]})]})]})}),s.jsx(We,{value:"projects",children:s.jsxs(oe,{children:[s.jsx(je,{className:"pb-4",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(Ne,{className:"flex items-center space-x-2",children:[s.jsx(Mc,{className:"w-5 h-5"}),s.jsxs("span",{children:["Projektkalender - ",De(t,"yyyy",{locale:zt})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ne,{variant:"outline",size:"sm",onClick:X,children:s.jsx(dh,{className:"w-4 h-4"})}),s.jsxs(Za,{children:[s.jsx(Ga,{asChild:!0,children:s.jsxs(ne,{variant:"outline",size:"sm",className:Ie("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),De(t,"MMMM yyyy",{locale:zt})]})}),s.jsx(fa,{className:"w-auto p-0",align:"start",children:s.jsx(pa,{mode:"single",selected:t,onSelect:te=>te&&e(te),initialFocus:!0,className:Ie("p-3 pointer-events-auto")})})]}),s.jsx(ne,{variant:"outline",size:"sm",onClick:F,children:s.jsx(Pl,{className:"w-4 h-4"})})]})]})}),s.jsx(de,{children:z()})]})}),s.jsx(We,{value:"employees",children:s.jsxs(oe,{children:[s.jsx(je,{className:"pb-4",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs(Ne,{className:"flex items-center space-x-2",children:[s.jsx(Br,{className:"w-5 h-5"}),s.jsxs("span",{children:["Mitarbeiterkalender - ",De(t,"yyyy",{locale:zt})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(ne,{variant:"outline",size:"sm",onClick:X,children:s.jsx(dh,{className:"w-4 h-4"})}),s.jsxs(Za,{children:[s.jsx(Ga,{asChild:!0,children:s.jsxs(ne,{variant:"outline",size:"sm",className:Ie("w-[180px] justify-start text-left font-normal","hover:bg-muted/50"),children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),De(t,"MMMM yyyy",{locale:zt})]})}),s.jsx(fa,{className:"w-auto p-0",align:"start",children:s.jsx(pa,{mode:"single",selected:t,onSelect:te=>te&&e(te),initialFocus:!0,className:Ie("p-3 pointer-events-auto")})})]}),s.jsx(ne,{variant:"outline",size:"sm",onClick:F,children:s.jsx(Pl,{className:"w-4 h-4"})})]})]})}),s.jsx(de,{children:$()})]})}),s.jsx(We,{value:"resources",children:s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Ressourcenplanung"})}),s.jsx(de,{children:s.jsx("p",{className:"text-muted-foreground",children:"Ressourcenplanung wird hier implementiert..."})})]})})]})]})},Lte=t=>{const e=Math.floor(t/60),n=t%60;return`${e.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`};/*! Capacitor: https://capacitorjs.com/ - MIT License */var $d;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})($d||($d={}));class Fy extends Error{constructor(e,n,r){super(e),this.message=e,this.code=n,this.data=r}}const Fte=t=>{var e,n;return t!=null&&t.androidBridge?"android":!((n=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||n===void 0)&&n.bridge?"ios":"web"},Bte=t=>{const e=t.CapacitorCustomPlatform||null,n=t.Capacitor||{},r=n.Plugins=n.Plugins||{},a=()=>e!==null?e.name:Fte(t),i=()=>a()!=="web",o=f=>{const p=u.get(f);return!!(p!=null&&p.platforms.has(a())||c(f))},c=f=>{var p;return(p=n.PluginHeaders)===null||p===void 0?void 0:p.find(v=>v.name===f)},d=f=>t.console.error(f),u=new Map,m=(f,p={})=>{const v=u.get(f);if(v)return console.warn(`Capacitor plugin "${f}" already registered. Cannot register plugins twice.`),v.proxy;const w=a(),x=c(f);let y;const j=async()=>(!y&&w in p?y=typeof p[w]=="function"?y=await p[w]():y=p[w]:e!==null&&!y&&"web"in p&&(y=typeof p.web=="function"?y=await p.web():y=p.web),y),b=(R,H)=>{var I,D;if(x){const W=x==null?void 0:x.methods.find(V=>H===V.name);if(W)return W.rtype==="promise"?V=>n.nativePromise(f,H.toString(),V):(V,G)=>n.nativeCallback(f,H.toString(),V,G);if(R)return(I=R[H])===null||I===void 0?void 0:I.bind(R)}else{if(R)return(D=R[H])===null||D===void 0?void 0:D.bind(R);throw new Fy(`"${f}" plugin is not implemented on ${w}`,$d.Unimplemented)}},N=R=>{let H;const I=(...D)=>{const W=j().then(V=>{const G=b(V,R);if(G){const Y=G(...D);return H=Y==null?void 0:Y.remove,Y}else throw new Fy(`"${f}.${R}()" is not implemented on ${w}`,$d.Unimplemented)});return R==="addListener"&&(W.remove=async()=>H()),W};return I.toString=()=>`${R.toString()}() { [capacitor code] }`,Object.defineProperty(I,"name",{value:R,writable:!1,configurable:!1}),I},S=N("addListener"),E=N("removeListener"),C=(R,H)=>{const I=S({eventName:R},H),D=async()=>{const V=await I;E({eventName:R,callbackId:V},H)},W=new Promise(V=>I.then(()=>V({remove:D})));return W.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await D()},W},P=new Proxy({},{get(R,H){switch(H){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return x?C:S;case"removeListener":return E;default:return N(H)}}});return r[f]=P,u.set(f,{name:f,proxy:P,platforms:new Set([...Object.keys(p),...x?[w]:[]])}),P};return n.convertFileSrc||(n.convertFileSrc=f=>f),n.getPlatform=a,n.handleError=d,n.isNativePlatform=i,n.isPluginAvailable=o,n.registerPlugin=m,n.Exception=Fy,n.DEBUG=!!n.DEBUG,n.isLoggingEnabled=!!n.isLoggingEnabled,n},zte=t=>t.Capacitor=Bte(t),jr=zte(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),oc=jr.registerPlugin;class RI{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,n){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(n);const i=this.windowListeners[e];i&&!i.registered&&this.addWindowListener(i),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,n);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,n,r){const a=this.listeners[e];if(!a){if(r){let i=this.retainedEventArguments[e];i||(i=[]),i.push(n),this.retainedEventArguments[e]=i}return}a.forEach(i=>i(n))}hasListeners(e){var n;return!!(!((n=this.listeners[e])===null||n===void 0)&&n.length)}registerWindowListener(e,n){this.windowListeners[n]={registered:!1,windowEventName:e,pluginEventName:n,handler:r=>{this.notifyListeners(n,r)}}}unimplemented(e="not implemented"){return new jr.Exception(e,$d.Unimplemented)}unavailable(e="not available"){return new jr.Exception(e,$d.Unavailable)}async removeListener(e,n){const r=this.listeners[e];if(!r)return;const a=r.indexOf(n);this.listeners[e].splice(a,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const n=this.retainedEventArguments[e];n&&(delete this.retainedEventArguments[e],n.forEach(r=>{this.notifyListeners(e,r)}))}}const rE=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),aE=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class $te extends RI{async getCookies(){const e=document.cookie,n={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[a,i]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");a=aE(a).trim(),i=aE(i).trim(),n[a]=i}),n}async setCookie(e){try{const n=rE(e.key),r=rE(e.value),a=`; expires=${(e.expires||"").replace("expires=","")}`,i=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${n}=${r||""}${a}; path=${i}; ${o};`}catch(n){return Promise.reject(n)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(n){return Promise.reject(n)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const n of e)document.cookie=n.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}oc("CapacitorCookies",{web:()=>new $te});const Ute=async t=>new Promise((e,n)=>{const r=new FileReader;r.onload=()=>{const a=r.result;e(a.indexOf(",")>=0?a.split(",")[1]:a)},r.onerror=a=>n(a),r.readAsDataURL(t)}),qte=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(a=>a.toLocaleLowerCase()).reduce((a,i,o)=>(a[i]=t[e[o]],a),{})},Hte=(t,e=!0)=>t?Object.entries(t).reduce((r,a)=>{const[i,o]=a;let c,d;return Array.isArray(o)?(d="",o.forEach(u=>{c=e?encodeURIComponent(u):u,d+=`${i}=${c}&`}),d.slice(0,-1)):(c=e?encodeURIComponent(o):o,d=`${i}=${c}`),`${r}&${d}`},"").substr(1):null,Wte=(t,e={})=>{const n=Object.assign({method:t.method||"GET",headers:t.headers},e),a=qte(t.headers)["content-type"]||"";if(typeof t.data=="string")n.body=t.data;else if(a.includes("application/x-www-form-urlencoded")){const i=new URLSearchParams;for(const[o,c]of Object.entries(t.data||{}))i.set(o,c);n.body=i.toString()}else if(a.includes("multipart/form-data")||t.data instanceof FormData){const i=new FormData;if(t.data instanceof FormData)t.data.forEach((c,d)=>{i.append(d,c)});else for(const c of Object.keys(t.data))i.append(c,t.data[c]);n.body=i;const o=new Headers(n.headers);o.delete("content-type"),n.headers=o}else(a.includes("application/json")||typeof t.data=="object")&&(n.body=JSON.stringify(t.data));return n};class Vte extends RI{async request(e){const n=Wte(e,e.webFetchExtra),r=Hte(e.params,e.shouldEncodeUrlParams),a=r?`${e.url}?${r}`:e.url,i=await fetch(a,n),o=i.headers.get("content-type")||"";let{responseType:c="text"}=i.ok?e:{};o.includes("application/json")&&(c="json");let d,u;switch(c){case"arraybuffer":case"blob":u=await i.blob(),d=await Ute(u);break;case"json":d=await i.json();break;case"document":case"text":default:d=await i.text()}const m={};return i.headers.forEach((f,p)=>{m[p]=f}),{data:d,headers:m,status:i.status,url:i.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}oc("CapacitorHttp",{web:()=>new Vte});function Kte(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,n){return new Proxy({},{get(r,a){return(i,o,c)=>{const d=t.Capacitor.Plugins[n];if(d===void 0){c(new Error(`Capacitor plugin ${n} not found`));return}if(typeof d[a]!="function"){c(new Error(`Method ${a} not found in Capacitor plugin ${n}`));return}(async()=>{try{const u=await d[a](i);o(u)}catch(u){c(u)}})()}}})}})}function Zte(t){t.CapacitorUtils.Synapse=new Proxy({},{get(e,n){return t.cordova.plugins[n]}})}function Gte(t=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!t?Kte(window):window.cordova!==void 0&&Zte(window))}const Qte=oc("Geolocation",{web:()=>tu(()=>import("./web-CihqV9Nk.js"),[],import.meta.url).then(t=>new t.GeolocationWeb)});Gte();class Yte{constructor(){fs(this,"dbName","TimeTrackingOfflineDB");fs(this,"dbVersion",1);fs(this,"storeName","timeEntries")}async initDB(){return new Promise((e,n)=>{const r=indexedDB.open(this.dbName,this.dbVersion);r.onerror=()=>n(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=a=>{const i=a.target.result;if(!i.objectStoreNames.contains(this.storeName)){const o=i.createObjectStore(this.storeName,{keyPath:"id"});o.createIndex("status","status",{unique:!1}),o.createIndex("offline_created_at","offline_created_at",{unique:!1})}}})}async saveOfflineEntry(e){const a=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((i,o)=>{const c=a.put(e);c.onerror=()=>o(c.error),c.onsuccess=()=>i()})}async getOfflineEntries(){const r=(await this.initDB()).transaction([this.storeName],"readonly").objectStore(this.storeName);return new Promise((a,i)=>{const o=r.getAll();o.onerror=()=>i(o.error),o.onsuccess=()=>a(o.result)})}async removeOfflineEntry(e){const a=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((i,o)=>{const c=a.delete(e);c.onerror=()=>o(c.error),c.onsuccess=()=>i()})}async clearOfflineEntries(){const r=(await this.initDB()).transaction([this.storeName],"readwrite").objectStore(this.storeName);return new Promise((a,i)=>{const o=r.clear();o.onerror=()=>i(o.error),o.onsuccess=()=>a()})}}class Xte{async getCurrentPosition(){try{const e=await Qte.getCurrentPosition({enableHighAccuracy:!0,timeout:1e4}),n={lat:e.coords.latitude,lng:e.coords.longitude},r=await this.reverseGeocode(n.lat,n.lng);return{...n,address:r}}catch(e){throw console.error("Fehler beim Abrufen der GPS-Position:",e),new Error("GPS-Position konnte nicht ermittelt werden")}}async reverseGeocode(e,n){try{const r=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${e}&lon=${n}&zoom=18&addressdetails=1`);if(!r.ok)throw new Error("Geocoding fehlgeschlagen");const a=await r.json(),i=[];return a.address.house_number&&i.push(a.address.house_number),a.address.road&&i.push(a.address.road),(a.address.city||a.address.town||a.address.village)&&i.push(a.address.city||a.address.town||a.address.village),i.length>0?i.join(", "):"Unbekannte Adresse"}catch(r){return console.warn("Reverse Geocoding fehlgeschlagen:",r),`${e.toFixed(6)}, ${n.toFixed(6)}`}}calculateDistance(e,n){const a=this.toRad(n.lat-e.lat),i=this.toRad(n.lng-e.lng),o=this.toRad(e.lat),c=this.toRad(n.lat),d=Math.sin(a/2)*Math.sin(a/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(o)*Math.cos(c);return 6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))*1e3}toRad(e){return e*(Math.PI/180)}isWithinRadius(e,n,r){return this.calculateDistance(e,n)<=r}}class By{static isOnline(){return navigator.onLine}static onStatusChange(e){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n),window.addEventListener("offline",r),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}static async registerServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/sw.js");return console.log("Service Worker registriert:",e),e}catch(e){return console.error("Service Worker Registrierung fehlgeschlagen:",e),null}return null}static async triggerBackgroundSync(e){if("serviceWorker"in navigator&&navigator.serviceWorker.controller)try{const n=await navigator.serviceWorker.ready;n&&"sync"in n&&await n.sync.register(e)}catch(n){console.error("Background Sync fehlgeschlagen:",n)}}}const Jte=({open:t,onOpenChange:e,timeEntry:n,projects:r,onSave:a})=>{var H,I;const[i,o]=g.useState(""),[c,d]=g.useState(""),[u,m]=g.useState(""),[f,p]=g.useState(""),[v,w]=g.useState(0),[x,y]=g.useState(""),[j,b]=g.useState(""),[N,S]=g.useState(""),[E,C]=g.useState(!1),{toast:P}=It();g.useEffect(()=>{if(n){const D=ed(n.start_time);if(o(De(D,"yyyy-MM-dd")),d(De(D,"HH:mm")),n.end_time){const W=ed(n.end_time);m(De(W,"yyyy-MM-dd")),p(De(W,"HH:mm"))}else m(""),p("");w(n.break_duration||0),y(n.project_id||""),b(n.description||""),S(n.status)}},[n]);const R=async()=>{if(n){C(!0);try{const D=new Date(`${i}T${c}`).toISOString();let W=null;u&&f&&(W=new Date(`${u}T${f}`).toISOString());const V={start_time:D,end_time:W,break_duration:v,project_id:x||null,description:j||null,status:N},{error:G}=await K.from("time_entries").update(V).eq("id",n.id);if(G)throw G;P({title:"Zeiteintrag aktualisiert",description:"Die Änderungen wurden erfolgreich gespeichert."}),a(),e(!1)}catch(D){console.error("Error updating time entry:",D),P({title:"Fehler beim Speichern",description:"Die Änderungen konnten nicht gespeichert werden.",variant:"destructive"})}finally{C(!1)}}};return n?s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-2xl",children:[s.jsx(tn,{children:s.jsxs(nn,{children:["Zeiteintrag bearbeiten - ",(H=n.employee)==null?void 0:H.first_name," ",(I=n.employee)==null?void 0:I.last_name]})}),s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"start-date",children:"Startdatum"}),s.jsx(re,{id:"start-date",type:"date",value:i,onChange:D=>o(D.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"start-time",children:"Startzeit"}),s.jsx(re,{id:"start-time",type:"time",value:c,onChange:D=>d(D.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"end-date",children:"Enddatum"}),s.jsx(re,{id:"end-date",type:"date",value:u,onChange:D=>m(D.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"end-time",children:"Endzeit"}),s.jsx(re,{id:"end-time",type:"time",value:f,onChange:D=>p(D.target.value)})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"break-duration",children:"Pausenzeit (Minuten)"}),s.jsx(re,{id:"break-duration",type:"number",min:"0",value:v,onChange:D=>w(parseInt(D.target.value)||0)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"status",children:"Status"}),s.jsxs(ut,{value:N,onValueChange:S,children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"aktiv",children:"Aktiv"}),s.jsx(xe,{value:"pausiert",children:"Pausiert"}),s.jsx(xe,{value:"beendet",children:"Beendet"})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"project",children:"Projekt"}),s.jsxs(ut,{value:x,onValueChange:y,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Projekt auswählen"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"",children:"Kein Projekt"}),r.map(D=>s.jsx(xe,{value:D.id,children:D.name},D.id))]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"description",children:"Beschreibung"}),s.jsx(Cn,{id:"description",placeholder:"Beschreibung der Tätigkeit...",value:j,onChange:D=>b(D.target.value)})]})]}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(ne,{variant:"outline",onClick:()=>e(!1),children:"Abbrechen"}),s.jsx(ne,{onClick:R,disabled:E,children:E?"Speichere...":"Speichern"})]})]})}):null},ene=()=>{var Et;const{toast:t}=It(),{userRole:e}=Lg(),{data:n,isLoading:r}=sG(),{data:a,isLoading:i}=p3(),{data:o,isLoading:c}=f1(),d=rG(),u=aG(),m=(n==null?void 0:n.items)||[],f=(a==null?void 0:a.items)||[],p=(o==null?void 0:o.items)||[],[v,w]=g.useState([]),[x,y]=g.useState([]);g.useState([]);const[j,b]=g.useState(null),[N,S]=g.useState(By.isOnline()),[E,C]=g.useState(new Date);g.useState("");const[P,R]=g.useState("all"),[H,I]=g.useState("all"),[D,W]=g.useState(!1),[V,G]=g.useState(!1);g.useState(!1),g.useState(null);const[Y,X]=g.useState(""),[F,T]=g.useState(!1),[q,U]=g.useState(null),B=m.find(ke=>ke.status==="aktiv")||null,O=r||i||c,z=new Yte,$=new Xte;g.useEffect(()=>(By.registerServiceWorker(),By.onStatusChange(Le=>{S(Le),Le?(ee(),t({title:"Wieder online",description:"Synchronisiere Offline-Daten..."})):t({title:"Offline-Modus",description:"Zeiteinträge werden lokal gespeichert.",variant:"destructive"})})),[]),g.useEffect(()=>{te(),Q(),le()},[E,P,H]);const te=async()=>{const{data:{user:ke}}=await K.auth.getUser();if(!ke)return;const{data:Le,error:ze}=await K.from("profiles").select("*").eq("id",ke.id).single();if(ze)throw t({title:"Profil konnte nicht geladen werden",description:ze.message,variant:"destructive"}),ze;b(Le)},ee=async()=>{var ke,Le,ze,dt,Ze,Fe;try{const Nt=await z.getOfflineEntries();for(const vt of Nt)try{d.mutate({employee_id:vt.employee_id,project_id:vt.project_id,start_time:vt.start_time,end_time:vt.end_time,description:vt.description,status:vt.status,start_location_lat:(ke=vt.start_location)==null?void 0:ke.lat,start_location_lng:(Le=vt.start_location)==null?void 0:Le.lng,start_location_address:(ze=vt.start_location)==null?void 0:ze.address,end_location_lat:(dt=vt.end_location)==null?void 0:dt.lat,end_location_lng:(Ze=vt.end_location)==null?void 0:Ze.lng,end_location_address:(Fe=vt.end_location)==null?void 0:Fe.address,is_offline_synced:!0,offline_created_at:vt.offline_created_at},{onSuccess:()=>{z.removeOfflineEntry(vt.id)}})}catch(Vn){console.error("Error syncing offline entry:",Vn)}Nt.length>0&&t({title:"Synchronisation abgeschlossen",description:`${Nt.length} Offline-Einträge wurden synchronisiert.`})}catch(Nt){console.error("Error syncing offline entries:",Nt)}},Q=async()=>{const{data:ke,error:Le}=await K.from("working_hours_config").select("*").order("is_default",{ascending:!1});if(Le)throw Le;y(ke||[])},le=async()=>{const ke=De(E,"yyyy-MM"),{data:Le,error:ze}=await K.from("employee_absences").select("*").gte("start_date",`${ke}-01`).lte("end_date",`${ke}-31`).eq("status","genehmigt");if(ze)throw ze;w(Le||[])},pe=async(ke,Le)=>{if(!j){t({title:"Fehler",description:"Kein Mitarbeiter gefunden.",variant:"destructive"});return}if(B){t({title:"Zeiterfassung bereits aktiv",description:"Beenden Sie zuerst die aktuelle Zeiterfassung.",variant:"destructive"});return}let ze;try{ze=await $.getCurrentPosition()}catch(Ze){console.warn("GPS location not available:",Ze)}const dt={employee_id:j.id,project_id:ke||null,start_time:new Date().toISOString(),description:Le||null,status:"aktiv",start_location_lat:ze==null?void 0:ze.lat,start_location_lng:ze==null?void 0:ze.lng,start_location_address:ze==null?void 0:ze.address};if(!N){const Ze={id:crypto.randomUUID(),employee_id:j.id,project_id:ke||void 0,start_time:new Date().toISOString(),description:Le||void 0,status:"aktiv",start_location:ze,offline_created_at:new Date().toISOString()};await z.saveOfflineEntry(Ze),t({title:"Offline gespeichert",description:"Zeiterfassung wird bei der nächsten Verbindung synchronisiert."});return}d.mutate(dt,{onSuccess:Ze=>{W(!1),t({title:"Zeiterfassung gestartet",description:ze?`Gestartet an: ${ze.address}`:"Die Zeiterfassung wurde erfolgreich gestartet."})},onError:()=>{t({title:"Fehler beim Starten",description:"Die Zeiterfassung konnte nicht gestartet werden.",variant:"destructive"})}})},J=async()=>{if(!B)return;let ke;try{ke=await $.getCurrentPosition()}catch(ze){console.warn("GPS location not available:",ze)}const Le={end_time:new Date().toISOString(),status:"beendet",end_location_lat:ke==null?void 0:ke.lat,end_location_lng:ke==null?void 0:ke.lng,end_location_address:ke==null?void 0:ke.address};u.mutate({id:B.id,data:Le},{onSuccess:()=>{t({title:"Zeiterfassung beendet",description:ke?`Beendet an: ${ke.address}`:"Die Zeiterfassung wurde erfolgreich beendet."})},onError:()=>{t({title:"Fehler beim Stoppen",description:"Die Zeiterfassung konnte nicht gestoppt werden.",variant:"destructive"})}})},ae=async()=>{if(!B)return;const ke=B.status==="aktiv"?"pausiert":"aktiv";u.mutate({id:B.id,data:{status:ke}},{onError:()=>{t({title:"Fehler",description:"Der Status konnte nicht geändert werden.",variant:"destructive"})}})},fe=async(ke,Le,ze)=>{if(!e||e!=="manager"){t({title:"Keine Berechtigung",description:"Nur Manager können Zeiterfassung für andere starten.",variant:"destructive"});return}const{data:dt}=await K.from("time_entries").select("*").eq("employee_id",ke).eq("status","aktiv").single();if(dt){t({title:"Zeiterfassung bereits aktiv",description:"Dieser Mitarbeiter hat bereits eine aktive Zeiterfassung.",variant:"destructive"});return}d.mutate({employee_id:ke,project_id:Le||null,start_time:new Date().toISOString(),description:ze||null,status:"aktiv"},{onSuccess:Ze=>{var Fe,Nt;t({title:"Zeiterfassung gestartet",description:`Zeiterfassung für ${(Fe=Ze.employee)==null?void 0:Fe.first_name} ${(Nt=Ze.employee)==null?void 0:Nt.last_name} wurde gestartet.`})},onError:()=>{t({title:"Fehler beim Starten",description:"Die Zeiterfassung konnte nicht gestartet werden.",variant:"destructive"})}})},he=async(ke,Le)=>{if(!e||e!=="manager"){t({title:"Keine Berechtigung",description:"Nur Manager können Arbeitszeiten ändern.",variant:"destructive"});return}const{data:ze}=await K.from("working_hours_config").select("*").eq("employee_id",ke).single();if(ze){const{error:dt}=await K.from("working_hours_config").update(Le).eq("id",ze.id);if(dt){t({title:"Fehler beim Aktualisieren",description:"Die Arbeitszeiten konnten nicht aktualisiert werden.",variant:"destructive"});return}}else{const{error:dt}=await K.from("working_hours_config").insert({employee_id:ke,...Le});if(dt){t({title:"Fehler beim Erstellen",description:"Die Arbeitszeiten konnten nicht erstellt werden.",variant:"destructive"});return}}Q(),G(!1),t({title:"Arbeitszeiten aktualisiert",description:"Die Arbeitszeiten wurden erfolgreich gespeichert."})},ve=ke=>x.find(Le=>Le.employee_id===ke)||x.find(Le=>Le.is_default),ie=()=>{const[ke,Le]=g.useState("08:00"),[ze,dt]=g.useState("17:00"),[Ze,Fe]=g.useState(30),[Nt,vt]=g.useState([1,2,3,4,5]);g.useEffect(()=>{if(Y){const yt=ve(Y);yt&&(Le(yt.start_time.slice(0,5)),dt(yt.end_time.slice(0,5)),Fe(yt.break_duration),vt(yt.working_days))}},[Y]);const Vn=()=>{he(Y==="default"?null:Y,{start_time:ke+":00",end_time:ze+":00",break_duration:Ze,working_days:Nt,is_default:Y==="default"})},js=yt=>{vt(cn=>cn.includes(yt)?cn.filter(On=>On!==yt):[...cn,yt].sort())};return s.jsx(Kt,{open:V,onOpenChange:G,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsx(tn,{children:s.jsx(nn,{children:"Arbeitszeiten konfigurieren"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{children:"Mitarbeiter"}),s.jsxs(ut,{value:Y,onValueChange:X,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Mitarbeiter wählen..."})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"default",children:"Standard (alle Mitarbeiter)"}),p.map(yt=>s.jsxs(xe,{value:yt.id,children:[yt.first_name," ",yt.last_name]},yt.id))]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(se,{children:"Arbeitsbeginn"}),s.jsx(re,{type:"time",value:ke,onChange:yt=>Le(yt.target.value)})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Arbeitsende"}),s.jsx(re,{type:"time",value:ze,onChange:yt=>dt(yt.target.value)})]})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Pausendauer (Minuten)"}),s.jsx(re,{type:"number",value:Ze,onChange:yt=>Fe(Number(yt.target.value)),min:"0",max:"120"})]}),s.jsxs("div",{children:[s.jsx(se,{children:"Arbeitstage"}),s.jsx("div",{className:"flex gap-2 mt-2",children:[{value:1,label:"Mo"},{value:2,label:"Di"},{value:3,label:"Mi"},{value:4,label:"Do"},{value:5,label:"Fr"},{value:6,label:"Sa"},{value:7,label:"So"}].map(yt=>s.jsx(ne,{variant:Nt.includes(yt.value)?"default":"outline",size:"sm",onClick:()=>js(yt.value),children:yt.label},yt.value))})]}),s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx(ne,{variant:"outline",onClick:()=>G(!1),children:"Abbrechen"}),s.jsx(ne,{onClick:Vn,disabled:!Y,children:"Speichern"})]})]})]})})},_e=()=>{const[ke,Le]=g.useState(""),[ze,dt]=g.useState(""),[Ze,Fe]=g.useState(""),Nt=()=>{ke&&(fe(ke,ze==="none"?void 0:ze||void 0,Ze||void 0),Le(""),dt(""),Fe(""),W(!1))};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"employee",children:"Mitarbeiter"}),s.jsxs(ut,{value:ke,onValueChange:Le,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Mitarbeiter auswählen..."})}),s.jsx(ct,{children:p.map(vt=>s.jsxs(xe,{value:vt.id,children:[vt.first_name," ",vt.last_name]},vt.id))})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"project",children:"Projekt (optional)"}),s.jsxs(ut,{value:ze,onValueChange:dt,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Projekt auswählen..."})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"none",children:"Kein Projekt"}),f.map(vt=>s.jsx(xe,{value:vt.id,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:vt.color}}),vt.name]})},vt.id))]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"description",children:"Beschreibung (optional)"}),s.jsx(Cn,{id:"description",value:Ze,onChange:vt=>Fe(vt.target.value),placeholder:"Beschreibung der Tätigkeit..."})]}),s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx(ne,{variant:"outline",onClick:()=>W(!1),children:"Abbrechen"}),s.jsxs(ne,{onClick:Nt,disabled:!ke,children:[s.jsx(Yc,{className:"w-4 h-4 mr-2"}),"Starten"]})]})]})},Se=(ke,Le)=>{const ze=ed(ke),Ze=um(new Date,ze),Fe=Math.floor(Ze/60),Nt=Ze%60;return`${Fe}:${Nt.toString().padStart(2,"0")}h`},Ve=()=>m.reduce((ke,Le)=>{if(Le.status==="beendet"&&Le.end_time){const ze=ed(Le.start_time),dt=ed(Le.end_time);return ke+um(dt,ze)}return ke},0),Xe=()=>{const[ke,Le]=g.useState(""),[ze,dt]=g.useState(""),Ze=()=>{pe(ze==="none"?void 0:ze||void 0,ke||void 0),Le(""),dt("")};return s.jsx(Kt,{open:D,onOpenChange:W,children:s.jsxs(Wt,{children:[s.jsx(tn,{children:s.jsx(nn,{children:e==="manager"?"Zeiterfassung starten":"Neue Zeiterfassung starten"})}),e==="manager"?s.jsx(_e,{}):s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(se,{htmlFor:"project",children:"Projekt (optional)"}),s.jsxs(ut,{value:ze,onValueChange:dt,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Projekt auswählen..."})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"none",children:"Kein Projekt"}),f.map(Fe=>s.jsx(xe,{value:Fe.id,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:Fe.color}}),Fe.name]})},Fe.id))]})]})]}),s.jsxs("div",{children:[s.jsx(se,{htmlFor:"description",children:"Beschreibung (optional)"}),s.jsx(Cn,{id:"description",value:ke,onChange:Fe=>Le(Fe.target.value),placeholder:"Was arbeiten Sie?"})]}),s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx(ne,{variant:"outline",onClick:()=>W(!1),children:"Abbrechen"}),s.jsxs(ne,{onClick:Ze,children:[s.jsx(Yc,{className:"w-4 h-4 mr-2"}),"Starten"]})]})]})]})})};return O?s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(ft,{className:"h-8 w-48"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx(ft,{className:"h-10 w-32"}),s.jsx(ft,{className:"h-10 w-40"})]})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl",children:[s.jsx(je,{className:"pb-2",children:s.jsx(ft,{className:"h-6 w-48"})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(ft,{className:"h-6 w-32 mb-2"}),s.jsx(ft,{className:"h-4 w-24"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx(ft,{className:"h-8 w-16 mb-2"}),s.jsx(ft,{className:"h-6 w-20"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ft,{className:"h-10 flex-1"}),s.jsx(ft,{className:"h-10 flex-1"})]})]})})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl",children:[s.jsx(je,{className:"pb-2",children:s.jsx(ft,{className:"h-6 w-32"})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsx(ft,{className:"h-10 w-full"}),s.jsx("div",{className:"space-y-3",children:Array(3).fill(0).map((ke,Le)=>s.jsx("div",{className:"border rounded-xl p-4",children:s.jsx(ft,{className:"h-16 w-full"})},Le))})]})})]})]}):s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Zeiterfassung"}),s.jsxs("div",{className:"flex items-center gap-4",children:[e==="manager"&&s.jsxs(ne,{variant:"outline",onClick:()=>G(!0),className:"rounded-full",children:[s.jsx(Po,{className:"h-4 w-4 mr-2"}),"Arbeitszeiten"]}),s.jsxs(ne,{onClick:()=>W(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),e==="manager"?"Zeiterfassung starten":"Meine Zeiterfassung"]})]})]}),s.jsxs(es,{defaultValue:"today",className:"space-y-4",children:[s.jsxs(Hn,{className:"grid w-full grid-cols-3 bg-muted/30 p-0.5 h-auto",children:[s.jsxs(He,{value:"today",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm py-2.5",children:[s.jsx(Pt,{className:"h-4 w-4 mr-1.5"}),"Heute"]}),s.jsxs(He,{value:"timeline",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm py-2.5",children:[s.jsx(At,{className:"h-4 w-4 mr-1.5"}),"Timeline"]}),s.jsxs(He,{value:"overview",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm py-2.5",children:[s.jsx(Br,{className:"h-4 w-4 mr-1.5"}),"Übersicht"]})]}),s.jsxs(We,{value:"today",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Heute erfasst"}),s.jsx("p",{className:"text-2xl font-bold",children:Lte(Ve())})]}),s.jsx(Pt,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Aktive Mitarbeiter"}),s.jsx("p",{className:"text-2xl font-bold",children:m.filter(ke=>ke.status==="aktiv").length})]}),s.jsx(Br,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Pausierte"}),s.jsx("p",{className:"text-2xl font-bold",children:m.filter(ke=>ke.status==="pausiert").length})]}),s.jsx(W_,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),s.jsx("p",{className:"text-2xl font-bold",children:N?"Online":"Offline"})]}),N?s.jsx(kB,{className:"h-8 w-8 text-purple-500 opacity-50"}):s.jsx(xP,{className:"h-8 w-8 text-red-500 opacity-50"})]})})})]}),s.jsxs(oe,{className:"shadow-soft rounded-2xl",children:[s.jsx(je,{className:"pb-2",children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Pt,{className:"w-5 h-5"}),"Aktuelle Zeiterfassung"]})}),s.jsx(de,{children:B?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-lg font-medium",children:((Et=B.project)==null?void 0:Et.name)||"Allgemeine Arbeitszeit"}),s.jsxs("p",{className:"text-muted-foreground",children:["Gestartet: ",De(ed(B.start_time),"HH:mm",{locale:zt})]}),B.description&&s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:B.description})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-2xl font-bold",children:Se(B.start_time)}),s.jsx(Be,{variant:B.status==="aktiv"?"default":"secondary",children:B.status==="aktiv"?"Aktiv":"Pausiert"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ne,{variant:"outline",onClick:ae,className:"flex-1 rounded-xl",children:B.status==="aktiv"?s.jsxs(s.Fragment,{children:[s.jsx(W_,{className:"w-4 h-4 mr-2"}),"Pausieren"]}):s.jsxs(s.Fragment,{children:[s.jsx(Yc,{className:"w-4 h-4 mr-2"}),"Fortsetzen"]})}),s.jsxs(ne,{variant:"destructive",onClick:J,className:"flex-1 rounded-xl",children:[s.jsx(sj,{className:"w-4 h-4 mr-2"}),"Beenden"]})]})]}):s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Pt,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Keine aktive Zeiterfassung"}),s.jsxs(ne,{onClick:()=>W(!0),children:[s.jsx(Yc,{className:"w-4 h-4 mr-2"}),"Zeiterfassung starten"]})]})})]})]}),s.jsx(We,{value:"timeline",className:"space-y-4",children:s.jsxs(oe,{className:"shadow-soft rounded-2xl",children:[s.jsx(je,{className:"pb-2",children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Pt,{className:"w-5 h-5"}),"Zeiterfassung"]})}),s.jsx(de,{children:(()=>{const ke=De(E,"yyyy-MM"),Le=m.filter(Fe=>{const Nt=De(new Date(Fe.start_time),"yyyy-MM")===ke,vt=H==="all"||!H||Fe.employee_id===H;return Nt&&vt}),ze=Le.reduce((Fe,Nt)=>{if(Nt.end_time){const vt=(new Date(Nt.end_time).getTime()-new Date(Nt.start_time).getTime())/36e5;return Fe+vt}return Fe},0),dt=Le.reduce((Fe,Nt)=>{const vt=De(new Date(Nt.start_time),"yyyy-MM-dd");return Fe[vt]||(Fe[vt]=[]),Fe[vt].push(Nt),Fe},{}),Ze=p.find(Fe=>Fe.id===H);return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex gap-4 items-end",children:s.jsxs("div",{className:"flex-1",children:[s.jsx(se,{children:"Mitarbeiter auswählen"}),s.jsxs(ut,{value:H||"all",onValueChange:I,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Mitarbeiter wählen..."})}),s.jsxs(ct,{className:"bg-background border shadow-lg z-50",children:[s.jsx(xe,{value:"all",children:"Alle Mitarbeiter"}),p.length>0?p.map(Fe=>s.jsxs(xe,{value:Fe.id,children:[Fe.first_name," ",Fe.last_name]},Fe.id)):s.jsx(xe,{value:"loading",disabled:!0,children:"Lade Mitarbeiter..."})]})]})]})}),s.jsxs("div",{className:"bg-gradient-to-r from-primary/10 to-primary/5 p-4 rounded-lg border",children:[s.jsxs("h3",{className:"font-semibold text-lg mb-2",children:["Monatsübersicht ",De(E,"MMMM yyyy",{locale:zt}),Ze&&s.jsxs("span",{className:"text-base font-normal ml-2",children:["- ",Ze.first_name," ",Ze.last_name]})]}),s.jsxs("p",{className:"text-2xl font-bold text-primary",children:[ze.toFixed(1)," Stunden"]})]}),H&&H!=="all"?s.jsxs("div",{className:"space-y-3",children:[(()=>{const Fe=new Date(E),Nt=Fe.getFullYear(),vt=Fe.getMonth(),Vn=new Date(Nt,vt+1,0).getDate(),js=[];for(let yt=1;yt<=Vn;yt++){const cn=new Date(Nt,vt,yt),On=De(cn,"yyyy-MM-dd"),hs=cn.getDay(),Kn=hs===0||hs===6,Pn=dt[On],Ms=v.some(ot=>{const we=new Date(ot.start_date),be=new Date(ot.end_date),Ee=new Date(On);return ot.employee_id===H&&ot.type==="urlaub"&&Ee>=we&&Ee<=be});js.push({date:On,dateObject:cn,isWeekend:Kn,hasEntries:Pn,isOnVacation:Ms,entries:Pn||[]})}return js.sort((yt,cn)=>new Date(cn.date).getTime()-new Date(yt.date).getTime()).map(({date:yt,dateObject:cn,isWeekend:On,hasEntries:hs,isOnVacation:Kn,entries:Pn})=>{if(Kn&&!hs)return s.jsx("div",{className:"border rounded-lg overflow-hidden bg-yellow-50/50 border-yellow-200",children:s.jsx("div",{className:"bg-yellow-100/50 p-4 border-b",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h4",{className:"font-semibold text-yellow-800",children:De(cn,"EEEE, dd.MM.yyyy",{locale:zt})}),s.jsx("div",{className:"text-right",children:s.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-yellow-200 text-yellow-800",children:"Urlaub"})})]})})},yt);if(On&&!hs)return s.jsx("div",{className:"border rounded-lg overflow-hidden bg-gray-50/50",children:s.jsx("div",{className:"bg-gray-100/50 p-4 border-b",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h4",{className:"font-semibold text-gray-600",children:De(cn,"EEEE, dd.MM.yyyy",{locale:zt})}),s.jsx("div",{className:"text-right",children:s.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:"Freier Tag"})})]})})},yt);if(!hs)return null;const ot=Pn.reduce((Ee,$e)=>{if($e.end_time){const st=new Date($e.end_time).getTime()-new Date($e.start_time).getTime();return Ee+st/(1e3*60)}return Ee},0)/60,we=Pn.sort((Ee,$e)=>new Date(Ee.start_time).getTime()-new Date($e.start_time).getTime())[0],be=Pn.sort((Ee,$e)=>new Date($e.end_time||$e.start_time).getTime()-new Date(Ee.end_time||Ee.start_time).getTime())[0];return s.jsxs("div",{className:Ie("border rounded-lg overflow-hidden",Kn?"bg-yellow-50/50 border-yellow-200":On?"bg-amber-50/50 border-amber-200":""),children:[s.jsx("div",{className:Ie("p-4 border-b",Kn?"bg-yellow-100/50":On?"bg-amber-100/50":"bg-muted/50"),children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h4",{className:Ie("font-semibold",Kn?"text-yellow-800":""),children:De(cn,"EEEE, dd.MM.yyyy",{locale:zt})}),s.jsxs("div",{className:"flex gap-2 mt-1",children:[Kn&&s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-yellow-200 text-yellow-800 inline-block",children:"Urlaub (gearbeitet)"}),On&&s.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-amber-200 text-amber-800 inline-block",children:"Wochenendarbeit"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-lg font-bold",children:[ot.toFixed(1),"h"]}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[De(new Date(we.start_time),"HH:mm")," - ",be.end_time?De(new Date(be.end_time),"HH:mm"):"Aktiv"]})]})]})}),s.jsx("div",{className:"divide-y",children:Pn.sort((Ee,$e)=>new Date(Ee.start_time).getTime()-new Date($e.start_time).getTime()).map(Ee=>{const $e=f.find(ns=>ns.id===Ee.project_id),st=Ee.end_time?(new Date(Ee.end_time).getTime()-new Date(Ee.start_time).getTime())/(1e3*60*60):0,Yt=Ee.break_duration||0;return s.jsx("div",{className:"p-4 hover:bg-muted/30",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsxs("span",{className:"font-medium",children:[De(new Date(Ee.start_time),"HH:mm")," - ",Ee.end_time?De(new Date(Ee.end_time),"HH:mm"):"Aktiv"]}),s.jsx("span",{className:Ie("px-2 py-1 rounded-full text-xs font-medium",Ee.status==="aktiv"?"bg-green-100 text-green-800":Ee.status==="beendet"?"bg-blue-100 text-blue-800":Ee.status==="pausiert"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:Ee.status==="aktiv"?"Aktiv":Ee.status==="beendet"?"Beendet":Ee.status==="pausiert"?"Pausiert":Ee.status})]}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Projekt:"})," ",($e==null?void 0:$e.name)||"Kein Projekt"]}),Ee.description&&s.jsxs("p",{children:[s.jsx("strong",{children:"Beschreibung:"})," ",Ee.description]}),Yt>0&&s.jsxs("p",{children:[s.jsx("strong",{children:"Pause:"})," ",Yt," min"]})]})]}),s.jsxs("div",{className:"text-right ml-4 flex items-center gap-2",children:[Ee.end_time&&s.jsxs("span",{className:"text-lg font-bold",children:[st.toFixed(1),"h"]}),e==="manager"&&s.jsx(ne,{size:"sm",variant:"outline",onClick:()=>{U(Ee),T(!0)},children:s.jsx(zl,{className:"w-4 h-4"})})]})]})},Ee.id)})})]},yt)}).filter(Boolean)})(),Object.keys(dt).length===0&&s.jsx("div",{className:"p-8 text-center text-muted-foreground border rounded-lg",children:"Keine Zeiterfassungseinträge für den ausgewählten Mitarbeiter gefunden"})]}):s.jsx("div",{className:"p-8 text-center text-muted-foreground border rounded-lg",children:"Bitte wählen Sie einen Mitarbeiter aus, um die Zeiterfassung anzuzeigen"})]})})()})]})}),s.jsx(We,{value:"overview",className:"space-y-4",children:s.jsxs(oe,{className:"shadow-soft rounded-2xl",children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Br,{className:"w-5 w-5"}),"Team-Übersicht"]})}),s.jsx(de,{children:s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Hier kommt die Team-Übersicht mit Statistiken und Berichten."})})]})})]}),s.jsx(Xe,{}),s.jsx(ie,{}),s.jsx(Jte,{open:F,onOpenChange:T,timeEntry:q,projects:f,onSave:()=>{}})]})};function tne(t,e){return g.useReducer((n,r)=>e[n][r]??n,t)}var L1="ScrollArea",[II,Lae]=kr(L1),[nne,Kr]=II(L1),OI=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:a,scrollHideDelay:i=600,...o}=t,[c,d]=g.useState(null),[u,m]=g.useState(null),[f,p]=g.useState(null),[v,w]=g.useState(null),[x,y]=g.useState(null),[j,b]=g.useState(0),[N,S]=g.useState(0),[E,C]=g.useState(!1),[P,R]=g.useState(!1),H=Rt(e,D=>d(D)),I=ru(a);return s.jsx(nne,{scope:n,type:r,dir:I,scrollHideDelay:i,scrollArea:c,viewport:u,onViewportChange:m,content:f,onContentChange:p,scrollbarX:v,onScrollbarXChange:w,scrollbarXEnabled:E,onScrollbarXEnabledChange:C,scrollbarY:x,onScrollbarYChange:y,scrollbarYEnabled:P,onScrollbarYEnabledChange:R,onCornerWidthChange:b,onCornerHeightChange:S,children:s.jsx(tt.div,{dir:I,...o,ref:H,style:{position:"relative","--radix-scroll-area-corner-width":j+"px","--radix-scroll-area-corner-height":N+"px",...t.style}})})});OI.displayName=L1;var LI="ScrollAreaViewport",FI=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,asChild:a,nonce:i,...o}=t,c=Kr(LI,n),d=g.useRef(null),u=Rt(e,d,c.onViewportChange);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:i}),s.jsx(tt.div,{"data-radix-scroll-area-viewport":"",...o,asChild:a,ref:u,style:{overflowX:c.scrollbarXEnabled?"scroll":"hidden",overflowY:c.scrollbarYEnabled?"scroll":"hidden",...t.style},children:hne({asChild:a,children:r},m=>s.jsx("div",{"data-radix-scroll-area-content":"",ref:c.onContentChange,style:{minWidth:c.scrollbarXEnabled?"fit-content":void 0},children:m}))})]})});FI.displayName=LI;var ni="ScrollAreaScrollbar",F1=g.forwardRef((t,e)=>{const{forceMount:n,...r}=t,a=Kr(ni,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,c=t.orientation==="horizontal";return g.useEffect(()=>(c?i(!0):o(!0),()=>{c?i(!1):o(!1)}),[c,i,o]),a.type==="hover"?s.jsx(sne,{...r,ref:e,forceMount:n}):a.type==="scroll"?s.jsx(rne,{...r,ref:e,forceMount:n}):a.type==="auto"?s.jsx(BI,{...r,ref:e,forceMount:n}):a.type==="always"?s.jsx(B1,{...r,ref:e}):null});F1.displayName=ni;var sne=g.forwardRef((t,e)=>{const{forceMount:n,...r}=t,a=Kr(ni,t.__scopeScrollArea),[i,o]=g.useState(!1);return g.useEffect(()=>{const c=a.scrollArea;let d=0;if(c){const u=()=>{window.clearTimeout(d),o(!0)},m=()=>{d=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return c.addEventListener("pointerenter",u),c.addEventListener("pointerleave",m),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",u),c.removeEventListener("pointerleave",m)}}},[a.scrollArea,a.scrollHideDelay]),s.jsx(ts,{present:n||i,children:s.jsx(BI,{"data-state":i?"visible":"hidden",...r,ref:e})})}),rne=g.forwardRef((t,e)=>{const{forceMount:n,...r}=t,a=Kr(ni,t.__scopeScrollArea),i=t.orientation==="horizontal",o=dx(()=>d("SCROLL_END"),100),[c,d]=tne("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return g.useEffect(()=>{if(c==="idle"){const u=window.setTimeout(()=>d("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(u)}},[c,a.scrollHideDelay,d]),g.useEffect(()=>{const u=a.viewport,m=i?"scrollLeft":"scrollTop";if(u){let f=u[m];const p=()=>{const v=u[m];f!==v&&(d("SCROLL"),o()),f=v};return u.addEventListener("scroll",p),()=>u.removeEventListener("scroll",p)}},[a.viewport,i,d,o]),s.jsx(ts,{present:n||c!=="hidden",children:s.jsx(B1,{"data-state":c==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:Oe(t.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Oe(t.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),BI=g.forwardRef((t,e)=>{const n=Kr(ni,t.__scopeScrollArea),{forceMount:r,...a}=t,[i,o]=g.useState(!1),c=t.orientation==="horizontal",d=dx(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,m=n.viewport.offsetHeight<n.viewport.scrollHeight;o(c?u:m)}},10);return Ud(n.viewport,d),Ud(n.content,d),s.jsx(ts,{present:r||i,children:s.jsx(B1,{"data-state":i?"visible":"hidden",...a,ref:e})})}),B1=g.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,a=Kr(ni,t.__scopeScrollArea),i=g.useRef(null),o=g.useRef(0),[c,d]=g.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=HI(c.viewport,c.content),m={...r,sizes:c,onSizesChange:d,hasThumb:u>0&&u<1,onThumbChange:p=>i.current=p,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:p=>o.current=p};function f(p,v){return dne(p,o.current,c,v)}return n==="horizontal"?s.jsx(ane,{...m,ref:e,onThumbPositionChange:()=>{if(a.viewport&&i.current){const p=a.viewport.scrollLeft,v=iE(p,c,a.dir);i.current.style.transform=`translate3d(${v}px, 0, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollLeft=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollLeft=f(p,a.dir))}}):n==="vertical"?s.jsx(ine,{...m,ref:e,onThumbPositionChange:()=>{if(a.viewport&&i.current){const p=a.viewport.scrollTop,v=iE(p,c);i.current.style.transform=`translate3d(0, ${v}px, 0)`}},onWheelScroll:p=>{a.viewport&&(a.viewport.scrollTop=p)},onDragScroll:p=>{a.viewport&&(a.viewport.scrollTop=f(p))}}):null}),ane=g.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...a}=t,i=Kr(ni,t.__scopeScrollArea),[o,c]=g.useState(),d=g.useRef(null),u=Rt(e,d,i.onScrollbarXChange);return g.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),s.jsx($I,{"data-orientation":"horizontal",...a,ref:u,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":cx(n)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.x),onDragScroll:m=>t.onDragScroll(m.x),onWheelScroll:(m,f)=>{if(i.viewport){const p=i.viewport.scrollLeft+m.deltaX;t.onWheelScroll(p),VI(p,f)&&m.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:Z0(o.paddingLeft),paddingEnd:Z0(o.paddingRight)}})}})}),ine=g.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...a}=t,i=Kr(ni,t.__scopeScrollArea),[o,c]=g.useState(),d=g.useRef(null),u=Rt(e,d,i.onScrollbarYChange);return g.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),s.jsx($I,{"data-orientation":"vertical",...a,ref:u,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":cx(n)+"px",...t.style},onThumbPointerDown:m=>t.onThumbPointerDown(m.y),onDragScroll:m=>t.onDragScroll(m.y),onWheelScroll:(m,f)=>{if(i.viewport){const p=i.viewport.scrollTop+m.deltaY;t.onWheelScroll(p),VI(p,f)&&m.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:Z0(o.paddingTop),paddingEnd:Z0(o.paddingBottom)}})}})}),[one,zI]=II(ni),$I=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:m,onResize:f,...p}=t,v=Kr(ni,n),[w,x]=g.useState(null),y=Rt(e,H=>x(H)),j=g.useRef(null),b=g.useRef(""),N=v.viewport,S=r.content-r.viewport,E=_n(m),C=_n(d),P=dx(f,10);function R(H){if(j.current){const I=H.clientX-j.current.left,D=H.clientY-j.current.top;u({x:I,y:D})}}return g.useEffect(()=>{const H=I=>{const D=I.target;(w==null?void 0:w.contains(D))&&E(I,S)};return document.addEventListener("wheel",H,{passive:!1}),()=>document.removeEventListener("wheel",H,{passive:!1})},[N,w,S,E]),g.useEffect(C,[r,C]),Ud(w,P),Ud(v.content,P),s.jsx(one,{scope:n,scrollbar:w,hasThumb:a,onThumbChange:_n(i),onThumbPointerUp:_n(o),onThumbPositionChange:C,onThumbPointerDown:_n(c),children:s.jsx(tt.div,{...p,ref:y,style:{position:"absolute",...p.style},onPointerDown:Oe(t.onPointerDown,H=>{H.button===0&&(H.target.setPointerCapture(H.pointerId),j.current=w.getBoundingClientRect(),b.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",v.viewport&&(v.viewport.style.scrollBehavior="auto"),R(H))}),onPointerMove:Oe(t.onPointerMove,R),onPointerUp:Oe(t.onPointerUp,H=>{const I=H.target;I.hasPointerCapture(H.pointerId)&&I.releasePointerCapture(H.pointerId),document.body.style.webkitUserSelect=b.current,v.viewport&&(v.viewport.style.scrollBehavior=""),j.current=null})})})}),K0="ScrollAreaThumb",UI=g.forwardRef((t,e)=>{const{forceMount:n,...r}=t,a=zI(K0,t.__scopeScrollArea);return s.jsx(ts,{present:n||a.hasThumb,children:s.jsx(lne,{ref:e,...r})})}),lne=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...a}=t,i=Kr(K0,n),o=zI(K0,n),{onThumbPositionChange:c}=o,d=Rt(e,f=>o.onThumbChange(f)),u=g.useRef(),m=dx(()=>{u.current&&(u.current(),u.current=void 0)},100);return g.useEffect(()=>{const f=i.viewport;if(f){const p=()=>{if(m(),!u.current){const v=une(f,c);u.current=v,c()}};return c(),f.addEventListener("scroll",p),()=>f.removeEventListener("scroll",p)}},[i.viewport,m,c]),s.jsx(tt.div,{"data-state":o.hasThumb?"visible":"hidden",...a,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Oe(t.onPointerDownCapture,f=>{const v=f.target.getBoundingClientRect(),w=f.clientX-v.left,x=f.clientY-v.top;o.onThumbPointerDown({x:w,y:x})}),onPointerUp:Oe(t.onPointerUp,o.onThumbPointerUp)})});UI.displayName=K0;var z1="ScrollAreaCorner",qI=g.forwardRef((t,e)=>{const n=Kr(z1,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?s.jsx(cne,{...t,ref:e}):null});qI.displayName=z1;var cne=g.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,a=Kr(z1,n),[i,o]=g.useState(0),[c,d]=g.useState(0),u=!!(i&&c);return Ud(a.scrollbarX,()=>{var f;const m=((f=a.scrollbarX)==null?void 0:f.offsetHeight)||0;a.onCornerHeightChange(m),d(m)}),Ud(a.scrollbarY,()=>{var f;const m=((f=a.scrollbarY)==null?void 0:f.offsetWidth)||0;a.onCornerWidthChange(m),o(m)}),u?s.jsx(tt.div,{...r,ref:e,style:{width:i,height:c,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Z0(t){return t?parseInt(t,10):0}function HI(t,e){const n=t/e;return isNaN(n)?0:n}function cx(t){const e=HI(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function dne(t,e,n,r="ltr"){const a=cx(n),i=a/2,o=e||i,c=a-o,d=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-c,m=n.content-n.viewport,f=r==="ltr"?[0,m]:[m*-1,0];return WI([d,u],f)(t)}function iE(t,e,n="ltr"){const r=cx(e),a=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-a,o=e.content-e.viewport,c=i-r,d=n==="ltr"?[0,o]:[o*-1,0],u=Vw(t,d);return WI([0,o],[0,c])(u)}function WI(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function VI(t,e){return t>0&&t<e}var une=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function a(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,c=n.top!==i.top;(o||c)&&e(),n=i,r=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(r)};function dx(t,e){const n=_n(t),r=g.useRef(0);return g.useEffect(()=>()=>window.clearTimeout(r.current),[]),g.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function Ud(t,e){const n=_n(e);qn(()=>{let r=0;if(t){const a=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return a.observe(t),()=>{window.cancelAnimationFrame(r),a.unobserve(t)}}},[t,n])}function hne(t,e){const{asChild:n,children:r}=t;if(!n)return typeof e=="function"?e(r):e;const a=g.Children.only(r);return g.cloneElement(a,{children:typeof e=="function"?e(a.props.children):e})}var KI=OI,mne=FI,fne=qI;const wi=g.forwardRef(({className:t,children:e,...n},r)=>s.jsxs(KI,{ref:r,className:Ie("relative overflow-hidden",t),...n,children:[s.jsx(mne,{className:"h-full w-full rounded-[inherit]",children:e}),s.jsx(ZI,{}),s.jsx(fne,{})]}));wi.displayName=KI.displayName;const ZI=g.forwardRef(({className:t,orientation:e="vertical",...n},r)=>s.jsx(F1,{ref:r,orientation:e,className:Ie("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:s.jsx(UI,{className:"relative flex-1 rounded-full bg-border"})}));ZI.displayName=F1.displayName;const pne=Kd("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Ml=g.forwardRef(({className:t,variant:e,...n},r)=>s.jsx("div",{ref:r,role:"alert",className:Ie(pne({variant:e}),t),...n}));Ml.displayName="Alert";const gne=g.forwardRef(({className:t,...e},n)=>s.jsx("h5",{ref:n,className:Ie("mb-1 font-medium leading-none tracking-tight",t),...e}));gne.displayName="AlertTitle";const Rl=g.forwardRef(({className:t,...e},n)=>s.jsx("div",{ref:n,className:Ie("text-sm [&_p]:leading-relaxed",t),...e}));Rl.displayName="AlertDescription";const xne=({dateFrom:t,dateTo:e,employeeId:n,onRefresh:r})=>{const[a,i]=g.useState(!1),[o,c]=g.useState(null),[d,u]=g.useState([]),[m,f]=g.useState([]),[p,v]=g.useState([]),[w,x]=g.useState(null),y=g.useCallback(async()=>{i(!0);try{const{data:S,error:E}=await K.rpc("get_approval_conflicts_summary",{p_employee_id:n||null,p_date_from:t,p_date_to:e});if(E&&!E.message.includes("function"))throw E;if(c(S||{period:{from:t,to:e,employee_id:n},summary:{total_conflicts:0,overlaps:0,missing_breaks:0,anomalies:0,critical_anomalies:0,affected_employees:0},severity:"none",generated_at:new Date().toISOString()}),(S==null?void 0:S.summary.total_conflicts)>0){const{data:C,error:P}=await K.rpc("detect_time_overlaps",{p_employee_id:n||null,p_date_from:t,p_date_to:e});P||u(C||[]);const{data:R,error:H}=await K.rpc("detect_missing_breaks",{p_employee_id:n||null,p_date_from:t,p_date_to:e});H||f(R||[]);const{data:I,error:D}=await K.rpc("detect_time_anomalies",{p_employee_id:n||null,p_date_from:t,p_date_to:e});D||v(I||[])}}catch(S){console.error("Error loading conflicts:",S)}finally{i(!1)}},[t,e,n]);g.useEffect(()=>{y()},[y]);const j=S=>{switch(S){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-green-100 text-green-800 border-green-200"}},b=S=>{switch(S){case"critical":return s.jsx(So,{className:"h-4 w-4"});case"high":return s.jsx(Jn,{className:"h-4 w-4"});case"medium":return s.jsx(Am,{className:"h-4 w-4"});default:return s.jsx(Md,{className:"h-4 w-4"})}},N=S=>{const E=Math.floor(S/60),C=S%60;return`${E}:${C.toString().padStart(2,"0")}h`};return a&&!o?s.jsx(oe,{children:s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(uh,{className:"h-5 w-5 animate-spin"}),"Konflikte werden analysiert..."]})})}):o?s.jsxs("div",{className:"space-y-4",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[b(o.severity),"Konfliktanalyse"]}),s.jsxs(vn,{children:[De(new Date(o.period.from),"dd.MM.yyyy",{locale:zt})," - "," ",De(new Date(o.period.to),"dd.MM.yyyy",{locale:zt})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Be,{className:j(o.severity),children:o.severity==="none"?"Keine Konflikte":o.severity==="medium"?"Gering":o.severity==="high"?"Hoch":"Kritisch"}),s.jsx(ne,{variant:"outline",size:"sm",onClick:y,disabled:a,children:a?s.jsx(uh,{className:"h-4 w-4 animate-spin"}):s.jsx(uh,{className:"h-4 w-4"})})]})]})}),s.jsx(de,{children:o.summary.total_conflicts===0?s.jsxs(Ml,{children:[s.jsx(Md,{className:"h-4 w-4"}),s.jsx(Rl,{children:"Keine Konflikte gefunden. Alle Zeiterfassungen sind korrekt."})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:o.summary.overlaps}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Überlappungen"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:o.summary.missing_breaks}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Fehlende Pausen"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:o.summary.anomalies}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Anomalien"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:o.summary.affected_employees}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Betroffene MA"})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.summary.overlaps>0&&s.jsxs(ne,{variant:w==="overlaps"?"default":"outline",size:"sm",onClick:()=>x(w==="overlaps"?null:"overlaps"),children:[s.jsx(Pt,{className:"mr-2 h-4 w-4"}),"Überlappungen (",o.summary.overlaps,")"]}),o.summary.missing_breaks>0&&s.jsxs(ne,{variant:w==="breaks"?"default":"outline",size:"sm",onClick:()=>x(w==="breaks"?null:"breaks"),children:[s.jsx(Fh,{className:"mr-2 h-4 w-4"}),"Pausen (",o.summary.missing_breaks,")"]}),o.summary.anomalies>0&&s.jsxs(ne,{variant:w==="anomalies"?"default":"outline",size:"sm",onClick:()=>x(w==="anomalies"?null:"anomalies"),children:[s.jsx(h0,{className:"mr-2 h-4 w-4"}),"Anomalien (",o.summary.anomalies,")"]})]})]})})]}),w==="overlaps"&&d.length>0&&s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Pt,{className:"h-5 w-5"}),"Zeitüberlappungen"]}),s.jsx(vn,{children:"Segmente die sich zeitlich überschneiden (kritisch!)"})]}),s.jsx(de,{children:s.jsx(wi,{className:"h-[300px]",children:s.jsx("div",{className:"space-y-3",children:d.map((S,E)=>s.jsxs("div",{className:"border rounded-lg p-3 bg-red-50 border-red-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"font-medium text-red-800",children:S.employee_name}),s.jsxs(Be,{variant:"destructive",children:[S.overlap_minutes," Min Überlappung"]})]}),s.jsxs("div",{className:"text-sm space-y-1",children:[s.jsxs("div",{children:["📅 ",De(new Date(S.conflict_date),"dd.MM.yyyy",{locale:zt})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[s.jsxs("div",{children:["🕐 ",De(new Date(S.segment_1_start),"HH:mm")," - ",De(new Date(S.segment_1_end),"HH:mm")]}),s.jsxs("div",{children:["🕐 ",De(new Date(S.segment_2_start),"HH:mm")," - ",De(new Date(S.segment_2_end),"HH:mm")]})]})]})]},E))})})})]}),w==="breaks"&&m.length>0&&s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Fh,{className:"h-5 w-5"}),"Fehlende Pausen"]}),s.jsx(vn,{children:"Tage mit unzureichenden Pausen nach Arbeitszeitgesetz"})]}),s.jsx(de,{children:s.jsx(wi,{className:"h-[300px]",children:s.jsx("div",{className:"space-y-3",children:m.map((S,E)=>s.jsxs("div",{className:`border rounded-lg p-3 ${S.conflict_severity==="critical"?"bg-red-50 border-red-200":S.conflict_severity==="high"?"bg-orange-50 border-orange-200":"bg-yellow-50 border-yellow-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"font-medium",children:S.employee_name}),s.jsxs(Be,{variant:S.conflict_severity==="critical"?"destructive":S.conflict_severity==="high"?"secondary":"outline",children:[S.missing_break_minutes," Min fehlen"]})]}),s.jsxs("div",{className:"text-sm space-y-1",children:[s.jsxs("div",{children:["📅 ",De(new Date(S.work_date),"dd.MM.yyyy",{locale:zt})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[s.jsxs("div",{children:["⏰ Arbeit: ",N(S.total_work_minutes)]}),s.jsxs("div",{children:["☕ Pause: ",N(S.existing_break_minutes)]}),s.jsxs("div",{children:["❗ Soll: ",N(S.required_break_minutes)]})]})]})]},E))})})})]}),w==="anomalies"&&p.length>0&&s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(h0,{className:"h-5 w-5"}),"Zeiterfassungs-Anomalien"]}),s.jsx(vn,{children:"Ungewöhnliche oder verdächtige Zeiterfassungen"})]}),s.jsx(de,{children:s.jsx(wi,{className:"h-[300px]",children:s.jsx("div",{className:"space-y-3",children:p.map((S,E)=>s.jsxs("div",{className:`border rounded-lg p-3 ${S.severity==="critical"?"bg-red-50 border-red-200":S.severity==="high"?"bg-orange-50 border-orange-200":"bg-blue-50 border-blue-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"font-medium",children:S.employee_name}),s.jsx(Be,{variant:S.severity==="critical"?"destructive":S.severity==="high"?"secondary":"outline",children:S.anomaly_type.replace("_"," ")})]}),s.jsxs("div",{className:"text-sm space-y-1",children:[s.jsxs("div",{children:["📅 ",De(new Date(S.segment_date),"dd.MM.yyyy",{locale:zt})]}),s.jsxs("div",{children:["🕐 ",De(new Date(S.segment_start),"HH:mm")," - ",S.segment_end?De(new Date(S.segment_end),"HH:mm"):"läuft noch"]}),s.jsx("div",{className:"text-xs text-muted-foreground",children:S.anomaly_description})]})]},E))})})})]})]}):s.jsx(oe,{children:s.jsxs(je,{children:[s.jsx(Ne,{children:"Konfliktanalyse nicht verfügbar"}),s.jsx(vn,{children:"Die Konflikterkennungsfunktionen sind nicht verfügbar"})]})})},vne=()=>{var T,q,U,B,O;const[t,e]=g.useState([]),[n,r]=g.useState(new Set),[a,i]=g.useState(!1),[o,c]=g.useState("week"),[d,u]=g.useState("all"),[m,f]=g.useState([]),[p,v]=g.useState([]),[w,x]=g.useState("Standard"),[y,j]=g.useState(!0),[b,N]=g.useState(!1),[S,E]=g.useState(null),[C,P]=g.useState(!0),[R,H]=g.useState("approval");g.useEffect(()=>{(async()=>{const{data:$,error:te}=await K.from("employees").select("id, first_name, last_name, role").order("first_name");te?console.error("Error fetching employees:",te):f($||[])})()},[]),g.useEffect(()=>{(async()=>{const{data:$,error:te}=await K.from("time_rules").select("*").eq("is_active",!0).order("name");te?(console.error("Error fetching time rules:",te),v([{id:"default",name:"Standard",round_to_minutes:15,round_direction:"nearest",min_work_duration_minutes:0,auto_break_after_minutes:360,auto_break_duration_minutes:30,is_active:!0}])):v($||[])})()},[]);const I=g.useCallback(()=>{const z=new Date;switch(o){case"today":return{from:De(z,"yyyy-MM-dd"),to:De(z,"yyyy-MM-dd")};case"week":return{from:De(Wr(z,{locale:zt}),"yyyy-MM-dd"),to:De(Km(z,{locale:zt}),"yyyy-MM-dd")};case"month":return{from:De(As(z),"yyyy-MM-dd"),to:De(Vm(z),"yyyy-MM-dd")}}},[o]),D=g.useCallback(async()=>{i(!0);const{from:z,to:$}=I();try{let te=K.from("time_segments").select(`
          *,
          employee:employees(first_name, last_name),
          project:projects(name, customer:customers(name))
        `).eq("status","completed").is("approved_at",null).gte("started_at",z+"T00:00:00").lte("started_at",$+"T23:59:59").order("started_at",{ascending:!1});d!=="all"&&(te=te.eq("employee_id",d));const{data:ee,error:Q}=await te;Q?(console.error("Error fetching segments:",Q),Te.error("Fehler beim Laden der Zeitsegmente")):e(ee||[])}finally{i(!1)}},[I,d]);g.useEffect(()=>{D()},[D]);const W=async()=>{if(n.size===0){Te.error("Bitte wählen Sie mindestens ein Segment aus");return}i(!0);try{const{data:z,error:$}=await K.rpc("rpc_preview_time_approval",{p_segment_ids:Array.from(n),p_rule_name:w});if($)throw $;E({segments:z.preview_segments||[],summary:z.summary||{}}),N(!0)}catch(z){console.error("Preview error:",z),Te.error("Fehler bei der Vorschau")}finally{i(!1)}},V=async()=>{if(n.size===0){Te.error("Bitte wählen Sie mindestens ein Segment aus");return}i(!0);try{const{data:z,error:$}=await K.rpc("rpc_approve_time_segments",{p_segment_ids:Array.from(n),p_apply_rules:y,p_rule_name:w});if($)throw $;Te.success(`${z.approved_count} Segmente erfolgreich genehmigt`),r(new Set),N(!1),D()}catch(z){console.error("Approval error:",z),Te.error("Fehler bei der Genehmigung")}finally{i(!1)}},G=z=>{const $=new Set(n);$.has(z)?$.delete(z):$.add(z),r($)},Y=()=>{n.size===t.length?r(new Set):r(new Set(t.map(z=>z.id)))},X=Ae.useMemo(()=>C?t.reduce((z,$)=>{const te=$.employee?`${$.employee.first_name} ${$.employee.last_name}`:"Unbekannt";return z[te]||(z[te]=[]),z[te].push($),z},{}):{all:t},[t,C]),F=z=>{const $=Math.floor(z/60),te=z%60;return`${$}:${te.toString().padStart(2,"0")}`};return s.jsx("div",{className:"space-y-6",children:s.jsxs(es,{value:R,onValueChange:H,children:[s.jsxs(Hn,{className:"grid w-full grid-cols-2",children:[s.jsxs(He,{value:"conflicts",className:"flex items-center gap-2",children:[s.jsx(Jn,{className:"h-4 w-4"}),"Konflikte prüfen"]}),s.jsxs(He,{value:"approval",className:"flex items-center gap-2",children:[s.jsx(ls,{className:"h-4 w-4"}),"Zeiten freigeben"]})]}),s.jsx(We,{value:"conflicts",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Jn,{className:"h-5 w-5"}),"Konfliktanalyse"]}),s.jsx(vn,{children:"Automatische Erkennung von Zeiterfassungs-Konflikten und Anomalien"})]}),s.jsxs(de,{children:[s.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[s.jsxs(ut,{value:o,onValueChange:z=>c(z),children:[s.jsx(lt,{className:"w-[180px]",children:s.jsx(ht,{placeholder:"Zeitraum"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"today",children:"Heute"}),s.jsx(xe,{value:"week",children:"Diese Woche"}),s.jsx(xe,{value:"month",children:"Dieser Monat"})]})]}),s.jsxs(ut,{value:d,onValueChange:u,children:[s.jsx(lt,{className:"w-[200px]",children:s.jsx(ht,{placeholder:"Mitarbeiter"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"all",children:"Alle Mitarbeiter"}),m.map(z=>s.jsxs(xe,{value:z.id,children:[z.first_name," ",z.last_name]},z.id))]})]})]}),s.jsx(xne,{dateFrom:I().from,dateTo:I().to,employeeId:d!=="all"?d:void 0,onRefresh:D})]})]})}),s.jsxs(We,{value:"approval",className:"space-y-6",children:[s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Pt,{className:"h-5 w-5"}),"Zeitfreigabe Manager"]}),s.jsx(vn,{children:"Prüfen und genehmigen Sie erfasste Arbeitszeiten"})]}),s.jsxs(de,{children:[s.jsxs("div",{className:"flex flex-wrap gap-4 mb-6",children:[s.jsxs(ut,{value:o,onValueChange:z=>c(z),children:[s.jsx(lt,{className:"w-[180px]",children:s.jsx(ht,{placeholder:"Zeitraum"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"today",children:"Heute"}),s.jsx(xe,{value:"week",children:"Diese Woche"}),s.jsx(xe,{value:"month",children:"Dieser Monat"})]})]}),s.jsxs(ut,{value:d,onValueChange:u,children:[s.jsx(lt,{className:"w-[200px]",children:s.jsx(ht,{placeholder:"Mitarbeiter"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"all",children:"Alle Mitarbeiter"}),m.map(z=>s.jsxs(xe,{value:z.id,children:[z.first_name," ",z.last_name]},z.id))]})]}),s.jsxs(ut,{value:w,onValueChange:x,children:[s.jsx(lt,{className:"w-[180px]",children:s.jsx(ht,{placeholder:"Regel"})}),s.jsx(ct,{children:p.map(z=>s.jsxs(xe,{value:z.name,children:[z.name," (",z.round_to_minutes," Min)"]},z.id))})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Js,{id:"apply-rules",checked:y,onCheckedChange:z=>j(!!z)}),s.jsx("label",{htmlFor:"apply-rules",className:"text-sm font-medium",children:"Regeln anwenden"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Js,{id:"group-by-employee",checked:C,onCheckedChange:z=>P(!!z)}),s.jsx("label",{htmlFor:"group-by-employee",className:"text-sm font-medium",children:"Nach Mitarbeiter gruppieren"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsx(oe,{children:s.jsxs(de,{className:"pt-6",children:[s.jsx("div",{className:"text-2xl font-bold",children:t.length}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Offene Segmente"})]})}),s.jsx(oe,{children:s.jsxs(de,{className:"pt-6",children:[s.jsx("div",{className:"text-2xl font-bold",children:n.size}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Ausgewählt"})]})}),s.jsx(oe,{children:s.jsxs(de,{className:"pt-6",children:[s.jsx("div",{className:"text-2xl font-bold",children:F(t.reduce((z,$)=>z+$.duration_minutes_computed,0))}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Gesamt-Stunden"})]})}),s.jsx(oe,{children:s.jsxs(de,{className:"pt-6",children:[s.jsx("div",{className:"text-2xl font-bold",children:Object.keys(X).length}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Mitarbeiter"})]})})]}),s.jsx(wi,{className:"h-[500px] border rounded-lg",children:s.jsxs("div",{className:"p-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Js,{checked:n.size===t.length&&t.length>0,onCheckedChange:Y}),s.jsx("span",{className:"text-sm font-medium",children:"Alle auswählen"})]})}),Object.entries(X).map(([z,$])=>s.jsxs("div",{className:"mb-6",children:[C&&s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Ds,{className:"h-4 w-4"}),s.jsx("h3",{className:"font-semibold",children:z}),s.jsxs(Be,{variant:"secondary",children:[$.length," Segmente"]}),s.jsxs(Be,{variant:"outline",children:[F($.reduce((te,ee)=>te+ee.duration_minutes_computed,0))," Stunden"]})]}),s.jsxs(H0,{children:[s.jsx(W0,{children:s.jsxs(yl,{children:[s.jsx(jn,{className:"w-[50px]"}),s.jsx(jn,{children:"Datum"}),s.jsx(jn,{children:"Von - Bis"}),s.jsx(jn,{children:"Projekt"}),s.jsx(jn,{children:"Typ"}),s.jsx(jn,{children:"Beschreibung"}),s.jsx(jn,{className:"text-right",children:"Dauer"}),y&&s.jsx(jn,{className:"text-right",children:"Gerundet"})]})}),s.jsx(V0,{children:$.map(te=>{var pe,J;const ee=n.has(te.id),Q=new Date(te.started_at),le=te.ended_at?new Date(te.ended_at):null;return s.jsxs(yl,{className:ee?"bg-muted/50":"",children:[s.jsx(Nn,{children:s.jsx(Js,{checked:ee,onCheckedChange:()=>G(te.id)})}),s.jsx(Nn,{children:De(Q,"dd.MM.yyyy",{locale:zt})}),s.jsxs(Nn,{children:[De(Q,"HH:mm")," - ",le?De(le,"HH:mm"):"..."]}),s.jsx(Nn,{children:s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:((pe=te.project)==null?void 0:pe.name)||"Allgemein"}),((J=te.project)==null?void 0:J.customer)&&s.jsx("div",{className:"text-xs text-muted-foreground",children:te.project.customer.name})]})}),s.jsx(Nn,{children:s.jsx(Be,{variant:te.segment_type==="work"?"default":te.segment_type==="break"?"secondary":"outline",children:te.segment_type==="work"?"Arbeit":te.segment_type==="break"?"Pause":"Fahrt"})}),s.jsx(Nn,{className:"max-w-[200px] truncate",children:te.description||"-"}),s.jsx(Nn,{className:"text-right font-mono",children:F(te.duration_minutes_computed)}),y&&s.jsxs(Nn,{className:"text-right font-mono text-muted-foreground",children:["~",F(Math.round(te.duration_minutes_computed/15)*15)]})]},te.id)})})]})]},z))]})}),s.jsxs("div",{className:"flex justify-between items-center mt-6",children:[s.jsx("div",{className:"text-sm text-muted-foreground",children:n.size>0&&s.jsxs("span",{children:[n.size," von ",t.length," Segmenten ausgewählt"]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ne,{variant:"outline",onClick:W,disabled:n.size===0||a,children:[s.jsx(Lr,{className:"mr-2 h-4 w-4"}),"Vorschau"]}),s.jsxs(ne,{onClick:V,disabled:n.size===0||a,children:[s.jsx(ls,{className:"mr-2 h-4 w-4"}),"Genehmigen (",n.size,")"]})]})]})]})]}),s.jsx(Kt,{open:b,onOpenChange:N,children:s.jsxs(Wt,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[s.jsxs(tn,{children:[s.jsx(nn,{children:"Freigabe-Vorschau"}),s.jsx(In,{children:"Prüfen Sie die Auswirkungen der Regelanwendung vor der Genehmigung"})]}),S&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs(Ml,{children:[s.jsx(mB,{className:"h-4 w-4"}),s.jsx(Rl,{children:s.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Angewendete Regel:"})," ",((T=S.summary.applied_rule)==null?void 0:T.name)||"Standard"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Rundung:"})," ",(q=S.summary.applied_rule)==null?void 0:q.round_to_minutes," Min (",(U=S.summary.applied_rule)==null?void 0:U.round_direction,")"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Auto-Pause:"})," ","Nach ",((B=S.summary.applied_rule)==null?void 0:B.auto_break_after_minutes)/60,"h → ",(O=S.summary.applied_rule)==null?void 0:O.auto_break_duration_minutes," Min"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Segmente:"})," ",S.summary.total_segments]})]})})]}),s.jsx(oe,{children:s.jsx(de,{className:"pt-6",children:s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold",children:F(S.summary.total_original_minutes)}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Original"})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold text-primary",children:F(S.summary.total_approved_minutes)}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Nach Genehmigung"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:`text-2xl font-bold ${S.summary.total_difference_minutes>0?"text-green-600":"text-red-600"}`,children:[S.summary.total_difference_minutes>0?"+":"",F(Math.abs(S.summary.total_difference_minutes))]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Differenz"})]})]})})}),s.jsx(wi,{className:"h-[300px] border rounded-lg",children:s.jsxs(H0,{children:[s.jsx(W0,{children:s.jsxs(yl,{children:[s.jsx(jn,{children:"Mitarbeiter"}),s.jsx(jn,{children:"Datum"}),s.jsx(jn,{children:"Projekt"}),s.jsx(jn,{children:"Typ"}),s.jsx(jn,{className:"text-right",children:"Original"}),s.jsx(jn,{className:"text-right",children:"Genehmigt"}),s.jsx(jn,{className:"text-right",children:"Differenz"})]})}),s.jsx(V0,{children:S.segments.map(z=>s.jsxs(yl,{children:[s.jsx(Nn,{children:z.employee_name}),s.jsx(Nn,{children:De(new Date(z.date),"dd.MM.yyyy",{locale:zt})}),s.jsx(Nn,{children:z.project_name}),s.jsx(Nn,{children:s.jsx(Be,{variant:z.segment_type==="work"?"default":"secondary",children:z.segment_type==="work"?"Arbeit":z.segment_type==="break"?"Pause":"Fahrt"})}),s.jsx(Nn,{className:"text-right font-mono",children:F(z.original_minutes)}),s.jsx(Nn,{className:"text-right font-mono font-semibold",children:F(z.approved_minutes)}),s.jsxs(Nn,{className:`text-right font-mono ${z.difference_minutes>0?"text-green-600":z.difference_minutes<0?"text-red-600":""}`,children:[z.difference_minutes>0?"+":"",F(Math.abs(z.difference_minutes))]})]},z.segment_id))})]})})]}),s.jsxs(Tl,{children:[s.jsx(ne,{variant:"outline",onClick:()=>N(!1),children:"Abbrechen"}),s.jsxs(ne,{onClick:V,children:[s.jsx(ls,{className:"mr-2 h-4 w-4"}),"Jetzt genehmigen"]})]})]})})]})]})})},yne=()=>{const{userRole:t}=Vr();return t!=="manager"&&t!=="admin"?s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Gd,{className:"h-5 w-5"}),"Zugriff verweigert"]})}),s.jsx(de,{children:s.jsx(Ml,{children:s.jsx(Rl,{children:"Sie benötigen Manager-Rechte, um auf die Zeitfreigabe zuzugreifen."})})})]}):s.jsxs("div",{className:"container mx-auto p-4 space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-6",children:s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-2",children:[s.jsx(Pt,{className:"h-8 w-8 text-primary"}),"Zeitfreigabe"]}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Prüfen und genehmigen Sie erfasste Arbeitszeiten mit automatischen Rundungsregeln"})]})}),s.jsx(vne,{})]})};function _ne({open:t,onOpenChange:e}){const[n,r]=g.useState(""),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(void 0),[m,f]=g.useState(""),[p,v]=g.useState(19),[w,x]=g.useState([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),{toast:y}=It(),j=ds(),{data:b=[]}=_r({queryKey:["customers"],queryFn:async()=>{const{data:W,error:V}=await K.from("customers").select("id, company_name, contact_person").eq("status","Aktiv").order("company_name");if(V)throw V;return W}}),N=sr({mutationFn:async W=>{const V=w.reduce((U,B)=>U+B.total_price,0),G=V*p/100,Y=V+G,{data:X,error:F}=await K.from("quotes").insert({title:n,description:a,customer_id:o,valid_until:d?De(d,"yyyy-MM-dd"):null,tax_rate:p,net_amount:V,tax_amount:G,total_amount:Y,notes:m,quote_number:""}).select().single();if(F)throw F;const T=w.map((U,B)=>({quote_id:X.id,position:B+1,description:U.description,quantity:U.quantity,unit:U.unit,unit_price:U.unit_price,total_price:U.total_price})),{error:q}=await K.from("document_items").insert(T);if(q)throw q;return X},onSuccess:()=>{y({title:"Erfolgreich",description:"Angebot wurde erfolgreich erstellt."}),j.invalidateQueries({queryKey:["quotes"]}),S()},onError:W=>{y({title:"Fehler",description:"Beim Erstellen des Angebots ist ein Fehler aufgetreten.",variant:"destructive"}),console.error("Error creating quote:",W)}}),S=()=>{r(""),i(""),c(""),u(void 0),f(""),v(19),x([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),e(!1)},E=()=>{const W={id:Date.now().toString(),description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0};x([...w,W])},C=W=>{w.length>1&&x(w.filter(V=>V.id!==W))},P=(W,V,G)=>{x(w.map(Y=>{if(Y.id===W){const X={...Y,[V]:G};return(V==="quantity"||V==="unit_price")&&(X.total_price=X.quantity*X.unit_price),X}return Y}))},R=w.reduce((W,V)=>W+V.total_price,0),H=R*p/100,I=R+H,D=W=>{if(W.preventDefault(),!n||!o||w.some(V=>!V.description)){y({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}N.mutate({})};return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(tn,{children:s.jsx(nn,{children:"Neues Angebot erstellen"})}),s.jsxs("form",{onSubmit:D,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"title",children:"Titel *"}),s.jsx(re,{id:"title",value:n,onChange:W=>r(W.target.value),placeholder:"Angebots-Titel eingeben",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"customer",children:"Kunde *"}),s.jsxs(ut,{value:o,onValueChange:c,required:!0,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Kunde auswählen"})}),s.jsx(ct,{children:b.map(W=>s.jsxs(xe,{value:W.id,children:[W.company_name," (",W.contact_person,")"]},W.id))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"description",children:"Beschreibung"}),s.jsx(Cn,{id:"description",value:a,onChange:W=>i(W.target.value),placeholder:"Beschreibung des Angebots",rows:3})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{children:"Gültig bis"}),s.jsxs(Za,{children:[s.jsx(Ga,{asChild:!0,children:s.jsxs(ne,{variant:"outline",className:Ie("w-full justify-start text-left font-normal",!d&&"text-muted-foreground"),children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),d?De(d,"PPP",{locale:zt}):"Datum auswählen"]})}),s.jsx(fa,{className:"w-auto p-0",align:"start",children:s.jsx(pa,{mode:"single",selected:d,onSelect:u,initialFocus:!0})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"taxRate",children:"Steuersatz (%)"}),s.jsx(re,{id:"taxRate",type:"number",step:"0.01",min:"0",max:"100",value:p,onChange:W=>v(parseFloat(W.target.value)||0)})]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center justify-between",children:["Positionen",s.jsxs(ne,{type:"button",onClick:E,size:"sm",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Position hinzufügen"]})]})}),s.jsxs(de,{className:"space-y-4",children:[w.map(W=>s.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[s.jsxs("div",{className:"col-span-4 space-y-2",children:[s.jsx(se,{children:"Beschreibung *"}),s.jsx(re,{value:W.description,onChange:V=>P(W.id,"description",V.target.value),placeholder:"Beschreibung der Position",required:!0})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(se,{children:"Menge"}),s.jsx(re,{type:"number",step:"0.01",min:"0",value:W.quantity,onChange:V=>P(W.id,"quantity",parseFloat(V.target.value)||0)})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(se,{children:"Einheit"}),s.jsxs(ut,{value:W.unit,onValueChange:V=>P(W.id,"unit",V),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Stk.",children:"Stk."}),s.jsx(xe,{value:"h",children:"Stunden"}),s.jsx(xe,{value:"m",children:"Meter"}),s.jsx(xe,{value:"m²",children:"m²"}),s.jsx(xe,{value:"kg",children:"kg"}),s.jsx(xe,{value:"l",children:"Liter"})]})]})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(se,{children:"Einzelpreis"}),s.jsx(re,{type:"number",step:"0.01",min:"0",value:W.unit_price,onChange:V=>P(W.id,"unit_price",parseFloat(V.target.value)||0)})]}),s.jsxs("div",{className:"col-span-1 space-y-2",children:[s.jsx(se,{children:"Gesamt"}),s.jsxs("div",{className:"text-sm font-medium p-2 bg-muted rounded",children:[W.total_price.toFixed(2)," €"]})]}),s.jsx("div",{className:"col-span-1",children:s.jsx(ne,{type:"button",variant:"ghost",size:"sm",onClick:()=>C(W.id),disabled:w.length===1,children:s.jsx(Va,{className:"h-4 w-4"})})})]},W.id)),s.jsxs("div",{className:"border-t pt-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Nettosumme:"}),s.jsxs("span",{children:[R.toFixed(2)," €"]})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsxs("span",{children:["MwSt. (",p,"%):"]}),s.jsxs("span",{children:[H.toFixed(2)," €"]})]}),s.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[s.jsx("span",{children:"Gesamtsumme:"}),s.jsxs("span",{children:[I.toFixed(2)," €"]})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"notes",children:"Anmerkungen"}),s.jsx(Cn,{id:"notes",value:m,onChange:W=>f(W.target.value),placeholder:"Zusätzliche Anmerkungen zum Angebot",rows:3})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(ne,{type:"button",variant:"outline",onClick:S,children:"Abbrechen"}),s.jsx(ne,{type:"submit",disabled:N.isPending,children:N.isPending?"Erstelle...":"Angebot erstellen"})]})]})]})})}function wne({open:t,onOpenChange:e}){const[n,r]=g.useState(""),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(""),[m,f]=g.useState(new Date),[p,v]=g.useState(vs(new Date,30)),[w,x]=g.useState("30 Tage netto"),[y,j]=g.useState(""),[b,N]=g.useState(19),[S,E]=g.useState([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),{toast:C}=It(),P=ds(),{data:R=[]}=_r({queryKey:["customers"],queryFn:async()=>{const{data:U,error:B}=await K.from("customers").select("id, company_name, contact_person").eq("status","Aktiv").order("company_name");if(B)throw B;return U}}),{data:H=[]}=_r({queryKey:["quotes-for-invoice"],queryFn:async()=>{const{data:U,error:B}=await K.from("quotes").select("id, quote_number, title, customer_id").eq("status","Angenommen").order("created_at",{ascending:!1});if(B)throw B;return U}}),I=sr({mutationFn:async U=>{const B=S.reduce((le,pe)=>le+pe.total_price,0),O=B*b/100,z=B+O,{data:$,error:te}=await K.from("invoices").insert({title:n,description:a,customer_id:o,quote_id:d||null,invoice_date:De(m,"yyyy-MM-dd"),due_date:De(p,"yyyy-MM-dd"),payment_terms:w,tax_rate:b,net_amount:B,tax_amount:O,total_amount:z,notes:y,invoice_number:""}).select().single();if(te)throw te;const ee=S.map((le,pe)=>({invoice_id:$.id,position:pe+1,description:le.description,quantity:le.quantity,unit:le.unit,unit_price:le.unit_price,total_price:le.total_price})),{error:Q}=await K.from("document_items").insert(ee);if(Q)throw Q;return $},onSuccess:()=>{C({title:"Erfolgreich",description:"Rechnung wurde erfolgreich erstellt."}),P.invalidateQueries({queryKey:["invoices"]}),D()},onError:U=>{C({title:"Fehler",description:"Beim Erstellen der Rechnung ist ein Fehler aufgetreten.",variant:"destructive"}),console.error("Error creating invoice:",U)}}),D=()=>{r(""),i(""),c(""),u(""),f(new Date),v(vs(new Date,30)),x("30 Tage netto"),j(""),N(19),E([{id:"1",description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0}]),e(!1)},W=()=>{const U={id:Date.now().toString(),description:"",quantity:1,unit:"Stk.",unit_price:0,total_price:0};E([...S,U])},V=U=>{S.length>1&&E(S.filter(B=>B.id!==U))},G=(U,B,O)=>{E(S.map(z=>{if(z.id===U){const $={...z,[B]:O};return(B==="quantity"||B==="unit_price")&&($.total_price=$.quantity*$.unit_price),$}return z}))},Y=async U=>{if(U)try{const{data:B,error:O}=await K.from("quotes").select(`
          *,
          customer:customers(company_name, contact_person)
        `).eq("id",U).single();if(O)throw O;const{data:z,error:$}=await K.from("document_items").select("*").eq("quote_id",U).order("position");if($)throw $;if(r(`Rechnung für ${B.title}`),i(B.description||""),c(B.customer_id),N(B.tax_rate),j(B.notes||""),z&&z.length>0){const te=z.map(ee=>({id:ee.id,description:ee.description,quantity:ee.quantity,unit:ee.unit,unit_price:ee.unit_price,total_price:ee.total_price}));E(te)}C({title:"Angebotsdaten geladen",description:"Die Daten aus dem Angebot wurden übernommen."})}catch(B){console.error("Error loading quote data:",B),C({title:"Fehler",description:"Beim Laden der Angebotsdaten ist ein Fehler aufgetreten.",variant:"destructive"})}},X=S.reduce((U,B)=>U+B.total_price,0),F=X*b/100,T=X+F,q=U=>{if(U.preventDefault(),!n||!o||S.some(B=>!B.description)){C({title:"Fehler",description:"Bitte füllen Sie alle Pflichtfelder aus.",variant:"destructive"});return}I.mutate({})};return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(tn,{children:s.jsx(nn,{children:"Neue Rechnung erstellen"})}),s.jsxs("form",{onSubmit:q,className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"title",children:"Titel *"}),s.jsx(re,{id:"title",value:n,onChange:U=>r(U.target.value),placeholder:"Rechnungs-Titel eingeben",required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"customer",children:"Kunde *"}),s.jsxs(ut,{value:o,onValueChange:c,required:!0,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Kunde auswählen"})}),s.jsx(ct,{children:R.map(U=>s.jsxs(xe,{value:U.id,children:[U.company_name," (",U.contact_person,")"]},U.id))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"quote",children:"Basiert auf Angebot (optional)"}),s.jsxs(ut,{value:d,onValueChange:U=>{u(U),U&&Y(U)},children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Angebot auswählen (optional)"})}),s.jsx(ct,{children:H.map(U=>s.jsxs(xe,{value:U.id,children:[U.quote_number," - ",U.title]},U.id))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"description",children:"Beschreibung"}),s.jsx(Cn,{id:"description",value:a,onChange:U=>i(U.target.value),placeholder:"Beschreibung der Rechnung",rows:3})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{children:"Rechnungsdatum"}),s.jsxs(Za,{children:[s.jsx(Ga,{asChild:!0,children:s.jsxs(ne,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),De(m,"PPP",{locale:zt})]})}),s.jsx(fa,{className:"w-auto p-0",align:"start",children:s.jsx(pa,{mode:"single",selected:m,onSelect:U=>U&&f(U),initialFocus:!0})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{children:"Fälligkeitsdatum"}),s.jsxs(Za,{children:[s.jsx(Ga,{asChild:!0,children:s.jsxs(ne,{variant:"outline",className:"w-full justify-start text-left font-normal",children:[s.jsx(At,{className:"mr-2 h-4 w-4"}),De(p,"PPP",{locale:zt})]})}),s.jsx(fa,{className:"w-auto p-0",align:"start",children:s.jsx(pa,{mode:"single",selected:p,onSelect:U=>U&&v(U),initialFocus:!0})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"paymentTerms",children:"Zahlungsbedingungen"}),s.jsxs(ut,{value:w,onValueChange:x,children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Sofort",children:"Sofort"}),s.jsx(xe,{value:"7 Tage netto",children:"7 Tage netto"}),s.jsx(xe,{value:"14 Tage netto",children:"14 Tage netto"}),s.jsx(xe,{value:"30 Tage netto",children:"30 Tage netto"}),s.jsx(xe,{value:"60 Tage netto",children:"60 Tage netto"})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"taxRate",children:"Steuersatz (%)"}),s.jsx(re,{id:"taxRate",type:"number",step:"0.01",min:"0",max:"100",value:b,onChange:U=>N(parseFloat(U.target.value)||0),className:"w-32"})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center justify-between",children:["Positionen",s.jsxs(ne,{type:"button",onClick:W,size:"sm",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Position hinzufügen"]})]})}),s.jsxs(de,{className:"space-y-4",children:[S.map(U=>s.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[s.jsxs("div",{className:"col-span-4 space-y-2",children:[s.jsx(se,{children:"Beschreibung *"}),s.jsx(re,{value:U.description,onChange:B=>G(U.id,"description",B.target.value),placeholder:"Beschreibung der Position",required:!0})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(se,{children:"Menge"}),s.jsx(re,{type:"number",step:"0.01",min:"0",value:U.quantity,onChange:B=>G(U.id,"quantity",parseFloat(B.target.value)||0)})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(se,{children:"Einheit"}),s.jsxs(ut,{value:U.unit,onValueChange:B=>G(U.id,"unit",B),children:[s.jsx(lt,{children:s.jsx(ht,{})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Stk.",children:"Stk."}),s.jsx(xe,{value:"h",children:"Stunden"}),s.jsx(xe,{value:"m",children:"Meter"}),s.jsx(xe,{value:"m²",children:"m²"}),s.jsx(xe,{value:"kg",children:"kg"}),s.jsx(xe,{value:"l",children:"Liter"})]})]})]}),s.jsxs("div",{className:"col-span-2 space-y-2",children:[s.jsx(se,{children:"Einzelpreis"}),s.jsx(re,{type:"number",step:"0.01",min:"0",value:U.unit_price,onChange:B=>G(U.id,"unit_price",parseFloat(B.target.value)||0)})]}),s.jsxs("div",{className:"col-span-1 space-y-2",children:[s.jsx(se,{children:"Gesamt"}),s.jsxs("div",{className:"text-sm font-medium p-2 bg-muted rounded",children:[U.total_price.toFixed(2)," €"]})]}),s.jsx("div",{className:"col-span-1",children:s.jsx(ne,{type:"button",variant:"ghost",size:"sm",onClick:()=>V(U.id),disabled:S.length===1,children:s.jsx(Va,{className:"h-4 w-4"})})})]},U.id)),s.jsxs("div",{className:"border-t pt-4 space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Nettosumme:"}),s.jsxs("span",{children:[X.toFixed(2)," €"]})]}),s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsxs("span",{children:["MwSt. (",b,"%):"]}),s.jsxs("span",{children:[F.toFixed(2)," €"]})]}),s.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[s.jsx("span",{children:"Gesamtsumme:"}),s.jsxs("span",{children:[T.toFixed(2)," €"]})]})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"notes",children:"Anmerkungen"}),s.jsx(Cn,{id:"notes",value:y,onChange:U=>j(U.target.value),placeholder:"Zusätzliche Anmerkungen zur Rechnung",rows:3})]}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(ne,{type:"button",variant:"outline",onClick:D,children:"Abbrechen"}),s.jsx(ne,{type:"submit",disabled:I.isPending,children:I.isPending?"Erstelle...":"Rechnung erstellen"})]})]})]})})}const bne=({quote:t,onRefresh:e})=>{const n=nG(),r=g3(),a=()=>{n.mutate(t.id,{onSuccess:()=>{e==null||e()}})},i=()=>{r.mutate({name:t.title,description:t.description,customer_id:t.customer_id,status:"neu",start_date:new Date().toISOString().split("T")[0],quote_id:t.id},{onSuccess:()=>{e==null||e()}})},o=n.isPending||r.isPending,c=t.status==="accepted"||t.status==="sent"||t.status==="versendet";return s.jsxs("div",{className:"flex space-x-1",children:[c&&s.jsxs(ne,{size:"sm",variant:"default",onClick:a,disabled:o,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[s.jsx(nj,{className:"h-3 w-3 mr-1"}),"Auftrag erstellen"]}),s.jsxs(ne,{size:"sm",variant:"outline",onClick:i,disabled:o,title:"Direkt zu Projekt (überspringt Auftrag)",children:[s.jsx(Hr,{className:"h-3 w-3 mr-1"}),"Zu Projekt"]})]})};function jne({onOCRComplete:t,onError:e,className:n="",accept:r="image/*,.pdf",maxSize:a=10}){const[i,o]=g.useState(!1),[c,d]=g.useState(null),[u,m]=g.useState(0),f=dG({onSuccess:E=>{d(null),m(0),t==null||t(E)},onError:E=>{d(null),m(0),e==null||e(E.message)}}),p=g.useCallback(E=>{E.preventDefault(),o(!0)},[]),v=g.useCallback(E=>{E.preventDefault(),o(!1)},[]),w=g.useCallback(E=>{E.preventDefault(),o(!1);const C=Array.from(E.dataTransfer.files);C.length>0&&y(C[0])},[]),x=g.useCallback(E=>{const C=E.target.files;C&&C.length>0&&y(C[0]),E.target.value=""},[]),y=g.useCallback(E=>{if(!["image/jpeg","image/png","image/gif","image/bmp","image/webp","application/pdf"].includes(E.type)){e==null||e("Nur Bilddateien (JPEG, PNG, GIF, BMP, WebP) und PDF-Dateien sind erlaubt.");return}if(E.size/(1024*1024)>a){e==null||e(`Datei zu groß. Maximale Größe: ${a}MB`);return}d(E)},[a,e]),j=g.useCallback(async()=>{if(c)try{m(25),console.log("Starting OCR processing for:",c.name),await f.mutateAsync(c)}catch(E){console.error("OCR processing failed:",E),e==null||e(E instanceof Error?E.message:"OCR-Verarbeitung fehlgeschlagen"),d(null),m(0)}},[c,f,e]),b=g.useCallback(()=>{d(null),m(0)},[]),N=E=>{if(E===0)return"0 Bytes";const C=1024,P=["Bytes","KB","MB","GB"],R=Math.floor(Math.log(E)/Math.log(C));return parseFloat((E/Math.pow(C,R)).toFixed(2))+" "+P[R]},S=E=>E.type.startsWith("image/")?s.jsx(U_,{className:"h-8 w-8 text-blue-500"}):E.type==="application/pdf"?s.jsx(wn,{className:"h-8 w-8 text-red-500"}):s.jsx(wn,{className:"h-8 w-8 text-gray-500"});return c&&!f.isPending?s.jsx(oe,{className:n,children:s.jsx(de,{className:"p-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[S(c),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium truncate",children:c.name}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsx("span",{children:N(c.size)}),s.jsx("span",{children:c.type}),s.jsx(Be,{variant:"outline",children:"Bereit für OCR"})]})]}),s.jsx(ne,{variant:"ghost",size:"sm",onClick:b,children:s.jsx($n,{className:"h-4 w-4"})})]}),s.jsxs(Ml,{children:[s.jsx(hh,{className:"h-4 w-4"}),s.jsx(Rl,{children:"Die Datei wird mit OCR verarbeitet und automatisch in deutsche Rechnung konvertiert. Dieser Vorgang kann 10-30 Sekunden dauern."})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ne,{onClick:j,disabled:f.isPending,className:"flex-1",children:[s.jsx(hh,{className:"mr-2 h-4 w-4"}),"OCR starten"]}),s.jsx(ne,{variant:"outline",onClick:b,children:"Abbrechen"})]})]})})}):f.isPending?s.jsx(oe,{className:n,children:s.jsx(de,{className:"p-6",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),s.jsx("h3",{className:"font-medium",children:"OCR-Verarbeitung läuft..."}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Rechnung wird analysiert und Daten extrahiert"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Fortschritt"}),s.jsxs("span",{children:[Math.round(u),"%"]})]}),s.jsx(zo,{value:u,className:"h-2"})]}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(ls,{className:"h-4 w-4 text-green-500"}),s.jsx("span",{children:"Datei hochgeladen"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm mt-1",children:[s.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b border-primary"}),s.jsx("span",{children:"Tesseract OCR läuft..."})]})]}),s.jsxs(Ml,{children:[s.jsx(Am,{className:"h-4 w-4"}),s.jsx(Rl,{children:"Bitte warten Sie, bis die Verarbeitung abgeschlossen ist. Bei komplexen Dokumenten kann dies länger dauern."})]})]})})}):s.jsx(oe,{className:`transition-colors ${i?"border-primary bg-primary/5":"border-dashed"} ${n}`,onDragOver:p,onDragLeave:v,onDrop:w,children:s.jsx(de,{className:"p-8",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center",children:s.jsx(gP,{className:`h-8 w-8 ${i?"text-primary":"text-muted-foreground"}`})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-medium",children:"Rechnung für OCR hochladen"}),s.jsx("p",{className:"text-muted-foreground",children:"Ziehen Sie eine Datei hierher oder klicken Sie zum Auswählen"})]}),s.jsx("div",{className:"flex justify-center",children:s.jsxs(ne,{variant:"outline",onClick:()=>{var E;return(E=document.getElementById("ocr-file-input"))==null?void 0:E.click()},children:[s.jsx(wn,{className:"mr-2 h-4 w-4"}),"Datei auswählen"]})}),s.jsx("input",{id:"ocr-file-input",type:"file",accept:r,onChange:x,className:"hidden"}),s.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[s.jsx("p",{children:"Unterstützte Formate: JPEG, PNG, GIF, BMP, WebP, PDF"}),s.jsxs("p",{children:["Maximale Dateigröße: ",a,"MB"]}),s.jsx("p",{children:"Empfohlen: Hochauflösende Scans für beste Ergebnisse"})]}),s.jsxs(Ml,{className:"border-green-500 bg-green-50",children:[s.jsx(SB,{className:"h-4 w-4 text-green-600"}),s.jsxs(Rl,{children:[s.jsx("strong",{className:"text-green-800",children:"KI-OCR aktiv:"})," OpenAI Vision erkennt Rechnungsdaten intelligent und extrahiert alle Felder automatisch - auch komplexe Tabellen!"]})]})]})})})}function Nne({ocrResult:t,onValidated:e,onRejected:n,onCancel:r}){var q,U,B;const{toast:a}=It(),[i,o]=g.useState(t.structured_data),[c,d]=g.useState(""),[u,m]=g.useState(!1),[f,p]=g.useState("basic"),[v,w]=g.useState(null),[x,y]=g.useState(!1),[j,b]=g.useState(!1);g.useEffect(()=>{o(t.structured_data),t.original_file_path&&t.original_file_path.startsWith("data:image")&&w(t.original_file_path)},[t]),g.useEffect(()=>{const O=z=>{z.key==="Escape"&&j&&b(!1)};return document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)},[j]);const N=async()=>{if(!x){y(!0);try{const O=[];if(i.invoiceNumber||O.push("Rechnungsnummer fehlt"),i.invoiceDate||O.push("Rechnungsdatum fehlt"),i.supplierName||O.push("Lieferantenname fehlt"),(!i.totalAmount||i.totalAmount<=0)&&O.push("Gesamtbetrag fehlt"),i.serviceDescription||O.push("Leistungsbeschreibung fehlt"),O.length>0){a({title:"Validierungsfehler",description:`Pflichtfelder fehlen: ${O.join(", ")}`,variant:"destructive"});return}await new Promise(z=>setTimeout(z,1e3)),a({title:"Rechnung validiert",description:"Die Rechnungsdaten wurden erfolgreich validiert."}),e==null||e(i)}catch{a({title:"Validierungsfehler",description:"Ein Fehler ist bei der Validierung aufgetreten.",variant:"destructive"})}finally{y(!1)}}},S=(O,z)=>{o($=>({...$,[O]:z}))},E=(O,z)=>{const $=te=>Math.round(te*100)/100;o(te=>{const ee={...te},Q=O==="netAmount"?z:te.netAmount||0,le=O==="vatAmount"?z:te.vatAmount||0;return O==="totalAmount"||te.totalAmount,O==="netAmount"?(ee.netAmount=z,le>0&&(ee.totalAmount=$(z+le))):O==="vatAmount"?(ee.vatAmount=z,Q>0&&(ee.totalAmount=$(Q+z))):O==="totalAmount"&&(ee.totalAmount=z,Q>0?ee.vatAmount=$(z-Q):le>0&&(ee.netAmount=$(z-le))),ee})},C=(O=19)=>{o(z=>({...z,taxRates:[...z.taxRates||[],O],netAmounts:{...z.netAmounts||{},[O.toString()]:0},taxAmounts:{...z.taxAmounts||{},[O.toString()]:0}}))},P=O=>{o(z=>{const $=[...z.taxRates||[]],te=$[O];$.splice(O,1);const ee={...z.netAmounts||{}},Q={...z.taxAmounts||{}};return delete ee[te.toString()],delete Q[te.toString()],{...z,taxRates:$,netAmounts:ee,taxAmounts:Q}})},R=(O,z,$)=>{o(te=>{const ee=[...te.taxRates||[]],Q={...te.netAmounts||{}},le={...te.taxAmounts||{}},pe=ee[O];return z==="rate"?(ee[O]=$,pe!==$&&(Q[$.toString()]=Q[pe.toString()]||0,le[$.toString()]=le[pe.toString()]||0,delete Q[pe.toString()],delete le[pe.toString()])):z==="netAmount"?Q[pe.toString()]=Math.round($*100)/100:z==="taxAmount"&&(le[pe.toString()]=Math.round($*100)/100),{...te,taxRates:ee,netAmounts:Q,taxAmounts:le}})},H=()=>{o(O=>{var z;return{...O,positions:[...O.positions||[],{position:(((z=O.positions)==null?void 0:z.length)||0)+1,description:"",quantity:1,unit:"Stk",unitPrice:0,totalPrice:0,vatRate:19}]}})},I=O=>{o(z=>{const $=[...z.positions||[]];return $.splice(O,1),$.forEach((te,ee)=>{te.position=ee+1}),{...z,positions:$}})},D=(O,z,$)=>{o(te=>{const ee=[...te.positions||[]],Q={...ee[O]};return Q[z]=$,(z==="quantity"||z==="unitPrice")&&(Q.totalPrice=Math.round(Q.quantity*Q.unitPrice*100)/100),ee[O]=Q,{...te,positions:ee}})},W=O=>{o(z=>{const $={...z,paymentTerms:O},te=z.invoiceDate;if(te&&O){const ee=new Date(te);let Q=30;const le=O.match(/(\d+)\s*tage?/i);le&&(Q=parseInt(le[1]));const pe=new Date(ee);pe.setDate(pe.getDate()+Q),$.dueDate=pe.toISOString().split("T")[0]}return $})},V=O=>{if(!O)return!0;const z={AT:/^AT[UB]\d{8}$/,BE:/^BE[01]\d{9}$/,BG:/^BG\d{9,10}$/,CY:/^CY\d{8}[A-Z]$/,CZ:/^CZ\d{8,10}$/,DE:/^DE\d{9}$/,DK:/^DK\d{8}$/,EE:/^EE\d{9}$/,EL:/^EL\d{9}$/,ES:/^ES[A-Z]\d{7}[A-Z]|\d{8}[A-Z]$/,FI:/^FI\d{8}$/,FR:/^FR[A-Z0-9]{2}\d{9}$/,GB:/^GB\d{9}|\d{12}|(GD|HA)\d{3}$/,HR:/^HR\d{11}$/,HU:/^HU\d{8}$/,IE:/^IE\d[A-Z0-9]\d{5}[A-Z]$/,IT:/^IT\d{11}$/,LT:/^LT\d{9}|\d{12}$/,LU:/^LU\d{8}$/,LV:/^LV\d{11}$/,MT:/^MT\d{8}$/,NL:/^NL\d{9}B\d{2}$/,PL:/^PL\d{10}$/,PT:/^PT\d{9}$/,RO:/^RO\d{2,10}$/,SE:/^SE\d{12}$/,SI:/^SI\d{8}$/,SK:/^SK\d{10}$/},$=O.substring(0,2).toUpperCase(),te=z[$];return te?te.test(O.toUpperCase()):!1},G=O=>{if(!O)return!0;const z=O.replace(/\s/g,"").toUpperCase();if(z.length<15||z.length>34||!/^[A-Z]{2}/.test(z)||!/^\d{2}/.test(z.substring(2,4)))return!1;const $=z.substring(4)+z.substring(0,4);let te="";for(let Q=0;Q<$.length;Q++){const le=$[Q];le>="A"&&le<="Z"?te+=(le.charCodeAt(0)-55).toString():te+=le}let ee=0;for(let Q=0;Q<te.length;Q++)ee=(ee*10+parseInt(te[Q]))%97;return ee===1},Y=(O,z)=>O==="supplierVatId"&&z&&!V(z)?"Ungültige USt-IdNr. Format (z.B. DE123456789 für Deutschland)":O==="supplierIban"&&z&&!G(z)?"Ungültige IBAN. Prüfen Sie Format und Prüfziffer.":null,X=O=>O?O.toLocaleString("de-DE",{style:"currency",currency:"EUR"}):"0,00 €",F=O=>{if(O==null||O===0)return"";const z=O.toString(),$=z.split(".");if($.length===1)return z;{const ee=$[1].substring(0,6).replace(/0+$/,""),Q=ee.length<2?ee.padEnd(2,"0"):ee;return`${$[0]}.${Q}`}},T=Object.entries(i).filter(([O,z])=>z!==void 0&&z!==""&&z!==0&&!(Array.isArray(z)&&z.length===0)&&!(typeof z=="object"&&Object.keys(z).length===0)).length;return s.jsxs("div",{className:"space-y-6 max-w-7xl mx-auto",children:[s.jsx(oe,{children:s.jsx(je,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/20",children:s.jsx(wn,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})}),s.jsxs("div",{children:[s.jsx(Ne,{children:"Rechnungsvalidierung"}),s.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[T," Felder erfasst • Überprüfen und korrigieren Sie die Daten"]})]})]}),s.jsx("div",{className:"flex gap-2",children:s.jsxs(ne,{variant:"outline",size:"sm",onClick:()=>m(!u),children:[u?s.jsx(hP,{className:"h-4 w-4"}):s.jsx(Lr,{className:"h-4 w-4"}),"OCR-Text"]})})]})})}),s.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[v&&s.jsx("div",{className:"xl:col-span-1",children:s.jsxs(oe,{className:"h-fit sticky top-6",children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center justify-between",children:[s.jsx("span",{children:"Original-Dokument"}),s.jsxs(ne,{variant:"outline",size:"sm",onClick:()=>b(!0),children:[s.jsx(Lr,{className:"h-4 w-4 mr-2"}),"Vollbild"]})]})}),s.jsx(de,{className:"p-0",children:s.jsxs("div",{className:"relative",children:[s.jsx("img",{src:v,alt:"Invoice",className:"w-full h-auto rounded-b-lg cursor-zoom-in hover:shadow-lg transition-shadow",style:{maxHeight:"calc(100vh - 200px)",minHeight:"600px",objectFit:"contain",backgroundColor:"#f8f9fa"},onClick:()=>b(!0),title:"Klicken für Vollbildansicht"}),s.jsx("div",{className:"absolute top-2 right-2 bg-black/70 text-white px-2 py-1 rounded text-xs",children:"Klicken zum Vergrößern"})]})})]})}),s.jsxs("div",{className:v?"xl:col-span-1":"xl:col-span-2",children:[s.jsx(oe,{children:s.jsx(de,{className:"p-0",children:s.jsxs(es,{value:f,onValueChange:p,children:[s.jsx("div",{className:"p-6 pb-0",children:s.jsxs(Hn,{className:"grid w-full grid-cols-6",children:[s.jsx(He,{value:"basic",children:"Basis"}),s.jsx(He,{value:"supplier",children:"Lieferant"}),s.jsx(He,{value:"amounts",children:"Beträge"}),s.jsx(He,{value:"positions",children:"Positionen"}),s.jsx(He,{value:"references",children:"Referenzen"}),s.jsx(He,{value:"additional",children:"Erweitert"})]})}),s.jsxs(We,{value:"basic",className:"p-6 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(se,{htmlFor:"invoiceNumber",className:"flex items-center gap-2",children:[s.jsx(uB,{className:"h-4 w-4"}),"Rechnungsnummer *"]}),s.jsx(re,{id:"invoiceNumber",value:i.invoiceNumber||"",onChange:O=>S("invoiceNumber",O.target.value),className:i.invoiceNumber?"":"border-red-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(se,{htmlFor:"invoiceDate",className:"flex items-center gap-2",children:[s.jsx(At,{className:"h-4 w-4"}),"Rechnungsdatum *"]}),s.jsx(re,{id:"invoiceDate",type:"date",value:i.invoiceDate||"",onChange:O=>S("invoiceDate",O.target.value),className:i.invoiceDate?"":"border-red-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"serviceDate",children:"Leistungsdatum"}),s.jsx(re,{id:"serviceDate",type:"date",value:i.serviceDate||"",onChange:O=>S("serviceDate",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"dueDate",children:"Fälligkeitsdatum"}),s.jsx(re,{id:"dueDate",type:"date",value:i.dueDate||"",onChange:O=>S("dueDate",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"currency",children:"Währung"}),s.jsx(re,{id:"currency",value:i.currency||"EUR",onChange:O=>S("currency",O.target.value)})]})]}),s.jsx(qa,{}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(se,{htmlFor:"serviceDescription",className:"flex items-center gap-2",children:[s.jsx(wn,{className:"h-4 w-4"}),"Leistungsbeschreibung *"]}),s.jsx(Cn,{id:"serviceDescription",value:i.serviceDescription||"",onChange:O=>S("serviceDescription",O.target.value),className:i.serviceDescription?"":"border-red-500",rows:3})]})]}),s.jsx(We,{value:"supplier",className:"p-6 space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(se,{htmlFor:"supplierName",className:"flex items-center gap-2",children:[s.jsx(Hr,{className:"h-4 w-4"}),"Lieferant/Firma *"]}),s.jsx(re,{id:"supplierName",value:i.supplierName||"",onChange:O=>S("supplierName",O.target.value),className:i.supplierName?"":"border-red-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(se,{htmlFor:"contactPerson",className:"flex items-center gap-2",children:[s.jsx(Ds,{className:"h-4 w-4"}),"Ansprechpartner"]}),s.jsx(re,{id:"contactPerson",value:i.contactPerson||"",onChange:O=>S("contactPerson",O.target.value)})]}),s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsxs(se,{htmlFor:"supplierAddress",className:"flex items-center gap-2",children:[s.jsx(Mi,{className:"h-4 w-4"}),"Lieferantenadresse"]}),s.jsx(Cn,{id:"supplierAddress",value:i.supplierAddress||"",onChange:O=>S("supplierAddress",O.target.value),rows:2})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"supplierVatId",children:"USt-IdNr."}),s.jsx(re,{id:"supplierVatId",value:i.supplierVatId||"",onChange:O=>S("supplierVatId",O.target.value),placeholder:"DE123456789",className:i.supplierVatId&&!V(i.supplierVatId)?"border-red-500":""}),i.supplierVatId&&!V(i.supplierVatId)&&s.jsx("p",{className:"text-sm text-red-600",children:Y("supplierVatId",i.supplierVatId)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"supplierTaxNumber",children:"Steuernummer"}),s.jsx(re,{id:"supplierTaxNumber",value:i.supplierTaxNumber||"",onChange:O=>S("supplierTaxNumber",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(se,{htmlFor:"supplierEmail",className:"flex items-center gap-2",children:[s.jsx(os,{className:"h-4 w-4"}),"E-Mail"]}),s.jsx(re,{id:"supplierEmail",type:"email",value:i.supplierEmail||"",onChange:O=>S("supplierEmail",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(se,{htmlFor:"supplierPhone",className:"flex items-center gap-2",children:[s.jsx(Zd,{className:"h-4 w-4"}),"Telefon"]}),s.jsx(re,{id:"supplierPhone",value:i.supplierPhone||"",onChange:O=>S("supplierPhone",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(se,{htmlFor:"supplierIban",className:"flex items-center gap-2",children:[s.jsx(oB,{className:"h-4 w-4"}),"IBAN"]}),s.jsx(re,{id:"supplierIban",value:i.supplierIban||"",onChange:O=>S("supplierIban",O.target.value),placeholder:"DE89 3704 0044 0532 0130 00",className:i.supplierIban&&!G(i.supplierIban)?"border-red-500":""}),i.supplierIban&&!G(i.supplierIban)&&s.jsx("p",{className:"text-sm text-red-600",children:Y("supplierIban",i.supplierIban)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"supplierBic",children:"BIC"}),s.jsx(re,{id:"supplierBic",value:i.supplierBic||"",onChange:O=>S("supplierBic",O.target.value),placeholder:"COBADEFFXXX"})]})]})}),s.jsxs(We,{value:"amounts",className:"p-6 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(se,{htmlFor:"totalAmount",className:"flex items-center gap-2",children:[s.jsx(ca,{className:"h-4 w-4"}),"Gesamtbetrag (Brutto) *"]}),s.jsx(re,{id:"totalAmount",type:"number",step:"0.01",value:F(i.totalAmount),onChange:O=>E("totalAmount",parseFloat(O.target.value)||0),className:i.totalAmount?"":"border-red-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"netAmount",children:"Nettobetrag"}),s.jsx(re,{id:"netAmount",type:"number",step:"0.01",value:F(i.netAmount),onChange:O=>E("netAmount",parseFloat(O.target.value)||0)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"vatAmount",children:"MwSt-Betrag"}),s.jsx(re,{id:"vatAmount",type:"number",step:"0.01",value:F(i.vatAmount),onChange:O=>E("vatAmount",parseFloat(O.target.value)||0)})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(se,{children:"Steuer-Sätze"}),s.jsx(ne,{type:"button",variant:"outline",size:"sm",onClick:()=>C(19),className:"h-8",children:"+ Steuer hinzufügen"})]}),s.jsxs("div",{className:"border rounded-lg",children:[s.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 bg-gray-50 dark:bg-gray-800 font-medium text-sm",children:[s.jsx("div",{children:"Satz (%)"}),s.jsx("div",{children:"Nettobasis (€)"}),s.jsx("div",{children:"Steuerbetrag (€)"}),s.jsx("div",{className:"text-right",children:"Aktionen"})]}),(i.taxRates||[]).map((O,z)=>{var $,te;return s.jsxs("div",{className:"grid grid-cols-4 gap-2 p-3 border-t",children:[s.jsx(re,{type:"number",step:"0.01",value:O,onChange:ee=>R(z,"rate",parseFloat(ee.target.value)||0),className:"h-8"}),s.jsx(re,{type:"number",step:"0.01",value:F(($=i.netAmounts)==null?void 0:$[O.toString()]),onChange:ee=>R(z,"netAmount",parseFloat(ee.target.value)||0),className:"h-8"}),s.jsx(re,{type:"number",step:"0.01",value:F((te=i.taxAmounts)==null?void 0:te[O.toString()]),onChange:ee=>R(z,"taxAmount",parseFloat(ee.target.value)||0),className:"h-8"}),s.jsx("div",{className:"text-right",children:s.jsx(ne,{type:"button",variant:"ghost",size:"sm",onClick:()=>P(z),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:s.jsx($n,{className:"h-4 w-4"})})})]},z)}),(!i.taxRates||i.taxRates.length===0)&&s.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:'Keine Steuersätze erfasst. Klicken Sie auf "+ Steuer hinzufügen" um zu beginnen.'})]}),s.jsxs("div",{className:"flex justify-end text-sm text-gray-600",children:["Summe MwSt: ",X(Object.values(i.taxAmounts||{}).reduce((O,z)=>O+z,0))]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(se,{children:"Spezielle Steuerarten"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Js,{id:"hasReverseCharge",checked:i.hasReverseCharge||!1,onCheckedChange:O=>S("hasReverseCharge",O)}),s.jsx(se,{htmlFor:"hasReverseCharge",className:"text-sm",children:"Reverse-Charge (Steuerschuldnerschaft des Leistungsempfängers)"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Js,{id:"isIntraCommunitySupply",checked:i.isIntraCommunitySupply||!1,onCheckedChange:O=>S("isIntraCommunitySupply",O)}),s.jsx(se,{htmlFor:"isIntraCommunitySupply",className:"text-sm",children:"Innergemeinschaftliche Lieferung"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Js,{id:"isExport",checked:i.isExport||!1,onCheckedChange:O=>S("isExport",O)}),s.jsx(se,{htmlFor:"isExport",className:"text-sm",children:"Ausfuhrlieferung"})]})]})]})]}),s.jsx(We,{value:"positions",className:"p-6 space-y-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(se,{className:"text-base font-semibold",children:"Rechnungspositionen"}),s.jsx(ne,{type:"button",variant:"outline",size:"sm",onClick:()=>H(),className:"h-8",children:"+ Position hinzufügen"})]}),s.jsxs("div",{className:"border rounded-lg",children:[s.jsxs("div",{className:"grid grid-cols-7 gap-2 p-3 bg-gray-50 dark:bg-gray-800 font-medium text-sm",children:[s.jsx("div",{children:"Pos."}),s.jsx("div",{children:"Beschreibung"}),s.jsx("div",{children:"Menge"}),s.jsx("div",{children:"Einheit"}),s.jsx("div",{children:"EP (€)"}),s.jsx("div",{children:"MwSt %"}),s.jsx("div",{className:"text-right",children:"Aktionen"})]}),(i.positions||[]).map((O,z)=>s.jsxs("div",{className:"grid grid-cols-7 gap-2 p-3 border-t",children:[s.jsx(re,{type:"number",value:O.position||z+1,onChange:$=>D(z,"position",parseInt($.target.value)||z+1),className:"h-8"}),s.jsx(re,{type:"text",value:O.description,onChange:$=>D(z,"description",$.target.value),className:"h-8",placeholder:"Beschreibung..."}),s.jsx(re,{type:"number",step:"0.01",value:O.quantity,onChange:$=>D(z,"quantity",parseFloat($.target.value)||0),className:"h-8"}),s.jsx(re,{type:"text",value:O.unit||"Stk",onChange:$=>D(z,"unit",$.target.value),className:"h-8"}),s.jsx(re,{type:"number",step:"0.01",value:F(O.unitPrice),onChange:$=>D(z,"unitPrice",parseFloat($.target.value)||0),className:"h-8"}),s.jsx(re,{type:"number",step:"0.01",value:O.vatRate||19,onChange:$=>D(z,"vatRate",parseFloat($.target.value)||19),className:"h-8"}),s.jsx("div",{className:"text-right",children:s.jsx(ne,{type:"button",variant:"ghost",size:"sm",onClick:()=>I(z),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",children:s.jsx($n,{className:"h-4 w-4"})})})]},z)),(!i.positions||i.positions.length===0)&&s.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:'Keine Positionen erfasst. Klicken Sie auf "+ Position hinzufügen" um zu beginnen.'})]}),i.positions&&i.positions.length>0&&s.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg space-y-2",children:[s.jsx("div",{className:"font-medium",children:"Positionssummen:"}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{children:["Netto gesamt: ",X(i.positions.reduce((O,z)=>O+z.quantity*z.unitPrice,0))]}),s.jsxs("div",{children:["MwSt gesamt: ",X(i.positions.reduce((O,z)=>{const $=z.quantity*z.unitPrice,te=(z.vatRate||19)/100;return O+$*te},0))]}),s.jsxs("div",{className:"font-medium",children:["Brutto gesamt: ",X(i.positions.reduce((O,z)=>{const $=z.quantity*z.unitPrice,te=(z.vatRate||19)/100;return O+$+$*te},0))]})]})]})]})}),s.jsxs(We,{value:"references",className:"p-6 space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx(se,{className:"text-base font-semibold",children:"Zahlungsbedingungen"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"paymentTerms",children:'Zahlungsziel (z.B. "14 Tage, 2% Skonto")'}),s.jsx(re,{id:"paymentTerms",value:i.paymentTerms||"",onChange:O=>W(O.target.value),placeholder:"z.B. 14 Tage netto"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"dueDate",children:"Fälligkeitsdatum *"}),s.jsx(re,{id:"dueDate",type:"date",value:i.dueDate||"",onChange:O=>S("dueDate",O.target.value),className:i.dueDate?"":"border-yellow-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"paymentReference",children:"Zahlungsreferenz/Verwendungszweck"}),s.jsx(re,{id:"paymentReference",value:i.paymentReference||"",onChange:O=>S("paymentReference",O.target.value),placeholder:"Verwendungszweck..."})]})]})]}),s.jsx(qa,{}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"orderNumber",children:"Bestellnummer"}),s.jsx(re,{id:"orderNumber",value:i.orderNumber||"",onChange:O=>S("orderNumber",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"projectReference",children:"Projekt-Referenz"}),s.jsx(re,{id:"projectReference",value:i.projectReference||"",onChange:O=>S("projectReference",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"deliveryNoteNumber",children:"Lieferscheinnummer"}),s.jsx(re,{id:"deliveryNoteNumber",value:i.deliveryNoteNumber||"",onChange:O=>S("deliveryNoteNumber",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"paymentReference",children:"Zahlungsreferenz/Verwendungszweck"}),s.jsx(re,{id:"paymentReference",value:i.paymentReference||"",onChange:O=>S("paymentReference",O.target.value)})]}),s.jsxs("div",{className:"md:col-span-2 space-y-2",children:[s.jsx(se,{htmlFor:"serviceLocation",children:"Liefer-/Leistungsort"}),s.jsx(re,{id:"serviceLocation",value:i.serviceLocation||"",onChange:O=>S("serviceLocation",O.target.value)})]})]})]}),s.jsx(We,{value:"additional",className:"p-6 space-y-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"servicePeriodStart",children:"Leistungszeitraum - Von"}),s.jsx(re,{id:"servicePeriodStart",type:"date",value:i.servicePeriodStart||"",onChange:O=>S("servicePeriodStart",O.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"servicePeriodEnd",children:"Leistungszeitraum - Bis"}),s.jsx(re,{id:"servicePeriodEnd",type:"date",value:i.servicePeriodEnd||"",onChange:O=>S("servicePeriodEnd",O.target.value)})]})]}),s.jsx(qa,{}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{children:"Empfänger (Ihr Unternehmen)"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(re,{placeholder:"Firmenname",value:i.customerName||"",onChange:O=>S("customerName",O.target.value)}),s.jsx(Cn,{placeholder:"Adresse",value:i.customerAddress||"",onChange:O=>S("customerAddress",O.target.value),rows:2})]})]}),s.jsx(qa,{}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"validationNotes",children:"Validierungsnotizen"}),s.jsx(Cn,{id:"validationNotes",value:c,onChange:O=>d(O.target.value),placeholder:"Notizen zur Validierung...",rows:3})]}),i.positions&&i.positions.length>0&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs(se,{children:["Erkannte Rechnungspositionen (",i.positions.length,")"]}),s.jsx("div",{className:"border rounded-lg p-3 space-y-2 max-h-40 overflow-y-auto",children:i.positions.map((O,z)=>s.jsxs("div",{className:"text-sm p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[s.jsx("div",{className:"font-medium",children:O.description}),s.jsxs("div",{className:"text-gray-500",children:[O.quantity," ",O.unit||"Stk"," × ",X(O.unitPrice||0)," = ",X(O.totalPrice||0)]})]},z))})]})]})})]})})}),s.jsx(oe,{className:"shadow-lg border border-gray-200 dark:border-gray-700 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm",children:s.jsx(de,{className:"p-4",children:s.jsx("div",{className:"flex flex-col sm:flex-row justify-center items-center gap-4",children:s.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400",children:[s.jsxs("div",{className:"flex items-center gap-2 bg-green-50 dark:bg-green-900/20 px-3 py-1.5 rounded-full",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),s.jsxs("span",{className:"font-medium text-green-700 dark:text-green-400",children:[T," von 30+ Feldern erfasst"]})]}),s.jsxs(Be,{variant:"outline",className:`${(((q=t.confidence_scores)==null?void 0:q.overall)||0)>=.8?"bg-green-50 text-green-700 border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-800":(((U=t.confidence_scores)==null?void 0:U.overall)||0)>=.6?"bg-yellow-50 text-yellow-700 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-800":"bg-red-50 text-red-700 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-800"}`,children:[Math.round((((B=t.confidence_scores)==null?void 0:B.overall)||0)*100),"% Vertrauen"]})]})})})}),s.jsx(oe,{className:"shadow-lg border border-gray-200 dark:border-gray-700 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex justify-center items-center gap-3",children:[s.jsx(ne,{variant:"outline",onClick:r,className:"px-5 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800 border-gray-300 dark:border-gray-600 transition-all duration-200",children:"Abbrechen"}),s.jsxs(ne,{variant:"outline",onClick:n,className:"px-5 py-2 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950/30 border-red-200 hover:border-red-300 dark:border-red-800 dark:hover:border-red-700 transition-all duration-200",children:[s.jsx($n,{className:"h-4 w-4 mr-2"}),"Ablehnen"]}),s.jsx(ne,{onClick:N,disabled:x,className:"px-8 py-2 bg-green-600 hover:bg-green-700 text-white font-medium shadow-md hover:shadow-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:x?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full"}),"Verarbeitung..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Em,{className:"h-4 w-4 mr-2"}),"Validieren & Übernehmen"]})})]})})})]})]}),u&&s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Lr,{className:"h-5 w-5"}),"OCR Rohtext"]})}),s.jsx(de,{children:s.jsx("pre",{className:"text-sm bg-gray-100 dark:bg-gray-800 p-4 rounded-lg whitespace-pre-wrap max-h-60 overflow-y-auto",children:t.extracted_text})})]}),j&&v&&s.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",onClick:()=>b(!1),children:s.jsxs("div",{className:"relative max-w-7xl max-h-full w-full h-full flex items-center justify-center",children:[s.jsx("button",{onClick:()=>b(!1),className:"absolute top-4 right-4 z-10 bg-black/50 text-white p-2 rounded-full hover:bg-black/70 transition-colors",title:"Schließen (ESC)",children:s.jsx($n,{className:"h-6 w-6"})}),s.jsx("img",{src:v,alt:"Vergrößerte Rechnung",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",onClick:O=>O.stopPropagation()})]})})]})}function Sne(){const[t,e]=g.useState([]),[n,r]=g.useState(!0),[a,i]=g.useState(""),[o,c]=g.useState("all"),[d,u]=g.useState(null);g.useEffect(()=>{m()},[]);const m=async()=>{try{r(!0);const{data:{user:y}}=await K.auth.getUser();if(!y)return;const{data:j,error:b}=await K.from("supplier_invoices").select("*").eq("created_by",y.id).order("created_at",{ascending:!1});if(b){console.error("Error loading supplier invoices:",b);return}e(j||[])}catch(y){console.error("Failed to load supplier invoices:",y)}finally{r(!1)}},f=y=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(y),p=y=>new Date(y).toLocaleDateString("de-DE"),v=y=>{switch(y){case"pending":return s.jsxs(Be,{variant:"outline",className:"bg-yellow-50 text-yellow-800 border-yellow-200",children:[s.jsx(Pt,{className:"h-3 w-3 mr-1"}),"Ausstehend"]});case"approved":return s.jsxs(Be,{variant:"outline",className:"bg-blue-50 text-blue-800 border-blue-200",children:[s.jsx(ls,{className:"h-3 w-3 mr-1"}),"Genehmigt"]});case"paid":return s.jsxs(Be,{variant:"outline",className:"bg-green-50 text-green-800 border-green-200",children:[s.jsx(ls,{className:"h-3 w-3 mr-1"}),"Bezahlt"]});case"cancelled":return s.jsxs(Be,{variant:"outline",className:"bg-red-50 text-red-800 border-red-200",children:[s.jsx(So,{className:"h-3 w-3 mr-1"}),"Storniert"]});default:return s.jsx(Be,{variant:"outline",children:y})}},w=async(y,j)=>{try{const{error:b}=await K.from("supplier_invoices").update({status:j,updated_at:new Date().toISOString()}).eq("id",y);if(b){console.error("Error updating invoice status:",b);return}e(N=>N.map(S=>S.id===y?{...S,status:j}:S))}catch(b){console.error("Failed to update invoice status:",b)}},x=t.filter(y=>{const j=y.invoice_number.toLowerCase().includes(a.toLowerCase())||y.supplier_name.toLowerCase().includes(a.toLowerCase()),b=o==="all"||y.status===o;return j&&b});return n?s.jsx("div",{className:"flex items-center justify-center p-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),s.jsx("p",{children:"Lade Lieferantenrechnungen..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx(Fr,{className:"h-6 w-6"}),"Lieferantenrechnungen"]}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Verwalten Sie Ihre eingescannten und erstellten Lieferantenrechnungen"})]})}),s.jsx(oe,{children:s.jsx(de,{className:"pt-6",children:s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative",children:[s.jsx(ec,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),s.jsx(re,{placeholder:"Nach Rechnungsnummer oder Lieferant suchen...",value:a,onChange:y=>i(y.target.value),className:"pl-9"})]})}),s.jsxs("select",{value:o,onChange:y=>c(y.target.value),className:"px-3 py-2 border rounded-md bg-background",children:[s.jsx("option",{value:"all",children:"Alle Status"}),s.jsx("option",{value:"pending",children:"Ausstehend"}),s.jsx("option",{value:"approved",children:"Genehmigt"}),s.jsx("option",{value:"paid",children:"Bezahlt"}),s.jsx("option",{value:"cancelled",children:"Storniert"})]})]})})}),x.length===0?s.jsx(oe,{children:s.jsx(de,{className:"py-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Fr,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Rechnungen gefunden"}),s.jsx("p",{className:"text-muted-foreground",children:a||o!=="all"?"Keine Rechnungen entsprechen den aktuellen Filterkriterien.":"Sie haben noch keine Lieferantenrechnungen erstellt."})]})})}):s.jsx("div",{className:"grid gap-4",children:x.map(y=>s.jsx(oe,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>u(y),children:s.jsx(de,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"space-y-3 flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h3",{className:"font-semibold text-lg",children:y.invoice_number}),y.ocr_result_id&&s.jsxs(Be,{variant:"outline",className:"text-xs",children:[s.jsx(pS,{className:"h-3 w-3 mr-1"}),"OCR"]})]}),v(y.status)]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Hr,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium",children:y.supplier_name})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(At,{className:"h-4 w-4 text-muted-foreground"}),s.jsxs("span",{children:["Datum: ",p(y.invoice_date)]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(mr,{className:"h-4 w-4 text-muted-foreground"}),s.jsx("span",{className:"font-semibold text-primary",children:f(y.total_amount)})]})]}),(y.description||y.iban)&&s.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[y.description&&s.jsxs("div",{children:["Beschreibung: ",y.description]}),y.iban&&s.jsxs("div",{children:["IBAN: ",y.iban]})]}),y.vat_amount&&y.vat_amount>0&&s.jsxs("div",{className:"text-sm text-muted-foreground",children:["inkl. MwSt: ",f(y.vat_amount)]})]}),s.jsxs("div",{className:"flex gap-2 ml-4",children:[y.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsx(ne,{size:"sm",onClick:()=>w(y.id,"approved"),className:"bg-blue-600 hover:bg-blue-700",children:"Genehmigen"}),s.jsx(ne,{size:"sm",variant:"outline",onClick:()=>w(y.id,"cancelled"),className:"border-red-600 text-red-600 hover:bg-red-50",children:"Stornieren"})]}),y.status==="approved"&&s.jsx(ne,{size:"sm",onClick:()=>w(y.id,"paid"),className:"bg-green-600 hover:bg-green-700",children:"Als bezahlt markieren"})]})]})})},y.id))}),x.length>0&&s.jsx(oe,{className:"bg-muted/50",children:s.jsx(de,{className:"pt-6",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("span",{className:"text-sm text-muted-foreground",children:[x.length," Rechnung",x.length!==1?"en":""," gefunden"]}),s.jsxs("span",{className:"font-semibold",children:["Gesamtsumme: ",f(x.filter(y=>y.status!=="cancelled").reduce((y,j)=>y+j.total_amount,0))]})]})})}),d&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:()=>u(null),children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:y=>y.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[s.jsx(Fr,{className:"h-6 w-6"}),"Rechnungsdetails"]}),s.jsx(ne,{variant:"ghost",size:"sm",onClick:()=>u(null),className:"hover:bg-gray-100",children:s.jsx(So,{className:"h-4 w-4"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Rechnungsinformationen"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Rechnungsnummer:"}),s.jsx("span",{className:"font-medium",children:d.invoice_number})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Lieferant:"}),s.jsx("span",{className:"font-medium",children:d.supplier_name})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Rechnungsdatum:"}),s.jsx("span",{children:p(d.invoice_date)})]}),d.due_date&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Fälligkeitsdatum:"}),s.jsx("span",{children:p(d.due_date)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Status:"}),v(d.status)]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Beträge"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Gesamtbetrag:"}),s.jsx("span",{className:"font-bold text-lg text-primary",children:f(d.total_amount)})]}),d.vat_amount&&d.vat_amount>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"MwSt-Betrag:"}),s.jsx("span",{children:f(d.vat_amount)})]})]})]})]}),d.description&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Beschreibung"}),s.jsx("p",{className:"text-sm text-muted-foreground bg-gray-50 p-3 rounded-lg",children:d.description})]}),d.iban&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Zahlungsinformationen"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("span",{className:"text-muted-foreground",children:"IBAN: "}),s.jsx("span",{className:"font-mono bg-gray-50 px-2 py-1 rounded",children:d.iban})]})]}),d.ocr_result_id&&s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[s.jsx(pS,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Diese Rechnung wurde über OCR erfasst"})]})}),s.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[d.status==="pending"&&s.jsxs(s.Fragment,{children:[s.jsxs(ne,{onClick:()=>{w(d.id,"approved"),u(null)},className:"bg-blue-600 hover:bg-blue-700",children:[s.jsx(ls,{className:"h-4 w-4 mr-2"}),"Genehmigen"]}),s.jsxs(ne,{variant:"outline",onClick:()=>{w(d.id,"cancelled"),u(null)},className:"border-red-600 text-red-600 hover:bg-red-50",children:[s.jsx(So,{className:"h-4 w-4 mr-2"}),"Stornieren"]})]}),d.status==="approved"&&s.jsxs(ne,{onClick:()=>{w(d.id,"paid"),u(null)},className:"bg-green-600 hover:bg-green-700",children:[s.jsx(ls,{className:"h-4 w-4 mr-2"}),"Als bezahlt markieren"]}),s.jsx(ne,{variant:"outline",onClick:()=>u(null),children:"Schließen"})]})]})]})})]})}function kne(){const[t,e]=g.useState(""),[n,r]=g.useState(!1),[a,i]=g.useState(!1),[o,c]=g.useState(null),{toast:d}=It(),{data:u,isLoading:m}=JZ(),{data:f,isLoading:p}=x3(),{data:v,isLoading:w}=lG(),{data:x,isLoading:y}=hG(),j=ds();eG(),v3(),tG();const b=(u==null?void 0:u.items)||[],N=(f==null?void 0:f.items)||[];v!=null&&v.items;const S=m||p||w,E=async(D,W,V)=>{var G;try{d({title:"E-Mail versendet",description:`${D==="quote"?"Angebot":"Rechnung"} wurde erfolgreich an ${((G=V.customer)==null?void 0:G.email)||"den Kunden"} versendet.`})}catch{d({title:"Fehler beim Versenden",description:"Die E-Mail konnte nicht versendet werden.",variant:"destructive"})}},C=D=>{switch(D){case"Entwurf":return"secondary";case"Versendet":return"default";case"Angenommen":case"Bezahlt":return"default";case"Abgelehnt":case"Storniert":return"destructive";case"Überfällig":return"destructive";case"Abgelaufen":return"secondary";default:return"default"}},P=(D,W="EUR")=>new Intl.NumberFormat("de-DE",{style:"currency",currency:W}).format(D),R=D=>new Date(D).toLocaleDateString("de-DE"),H=b.filter(D=>D.title.toLowerCase().includes(t.toLowerCase())||D.quote_number.toLowerCase().includes(t.toLowerCase())||D.customer.company_name.toLowerCase().includes(t.toLowerCase())),I=N.filter(D=>D.title.toLowerCase().includes(t.toLowerCase())||D.invoice_number.toLowerCase().includes(t.toLowerCase())||D.customer.company_name.toLowerCase().includes(t.toLowerCase()));return s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dokumente"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(ne,{onClick:()=>r(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),s.jsxs(ne,{onClick:()=>i(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Rechnung erstellen"]})]})]}),s.jsx(oe,{className:"shadow-soft rounded-2xl overflow-hidden",children:s.jsx(de,{className:"p-4",children:s.jsx("div",{className:"flex items-center space-x-2",children:s.jsxs("div",{className:"relative flex-1 max-w-sm",children:[s.jsx(ec,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),s.jsx(re,{placeholder:"Dokumente suchen...",value:t,onChange:D=>e(D.target.value),className:"pl-8 rounded-xl"})]})})})}),s.jsxs(es,{defaultValue:"quotes",className:"space-y-4",children:[s.jsxs(Hn,{children:[s.jsxs(He,{value:"quotes",className:"flex items-center gap-2",children:[s.jsx(wn,{className:"h-4 w-4"}),"Angebote (",b.length,")"]}),s.jsxs(He,{value:"invoices",className:"flex items-center gap-2",children:[s.jsx(Fr,{className:"h-4 w-4"}),"Rechnungen (",N.length,")"]}),s.jsxs(He,{value:"ocr",className:"flex items-center gap-2",children:[s.jsx(hh,{className:"h-4 w-4"}),"OCR-Import ",x&&x.length>0&&s.jsx(Be,{variant:"destructive",className:"ml-1 px-1.5 py-0.5 text-xs",children:x.length})]}),s.jsxs(He,{value:"templates",className:"flex items-center gap-2",children:[s.jsx(wn,{className:"h-4 w-4"}),"Vorlagen"]})]}),s.jsx(We,{value:"quotes",className:"space-y-4",children:S?s.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((D,W)=>s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(ft,{className:"h-5 w-32"}),s.jsx(ft,{className:"h-6 w-20"})]}),s.jsx(ft,{className:"h-4 w-48 mb-2"}),s.jsx(ft,{className:"h-4 w-24"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx(ft,{className:"h-6 w-20 mb-2"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ft,{className:"h-8 w-16"}),s.jsx(ft,{className:"h-8 w-16"})]})]})]})})},W))}):H.length===0?s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsxs(de,{className:"py-8 text-center",children:[s.jsx(wn,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Angebote gefunden"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:t?"Keine Angebote entsprechen Ihren Suchkriterien.":"Erstellen Sie Ihr erstes Angebot."}),s.jsxs(ne,{onClick:()=>r(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]})]})}):s.jsx("div",{className:"grid gap-4",children:H.map(D=>s.jsx(oe,{className:"shadow-soft rounded-2xl hover:shadow-md transition-shadow",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h3",{className:"font-semibold",children:D.quote_number}),s.jsx("span",{className:`inline-flex items-center rounded-full border px-2.5 py-1 text-xs ${D.status==="Entwurf"?"bg-gray-100 text-gray-800":D.status==="Versendet"?"bg-blue-100 text-blue-800":D.status==="Angenommen"?"bg-green-100 text-green-800":D.status==="Abgelehnt"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:D.status})]}),s.jsx("h4",{className:"text-lg font-medium mb-1",children:D.title}),s.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[D.customer.company_name," • ",D.customer.contact_person]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Erstellt: ",R(D.quote_date)]}),D.valid_until&&s.jsxs("span",{children:["Gültig bis: ",R(D.valid_until)]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-xl font-bold mb-2",children:P(D.total_amount,D.currency)}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(ne,{variant:"ghost",size:"sm",title:"Ansehen",className:"rounded-xl",children:s.jsx(Lr,{className:"h-4 w-4"})}),s.jsx(ne,{variant:"ghost",size:"sm",title:"Bearbeiten",className:"rounded-xl",children:s.jsx(zl,{className:"h-4 w-4"})}),s.jsx(ne,{variant:"ghost",size:"sm",className:"rounded-xl",title:"Per E-Mail versenden",onClick:()=>E("quote",D.id,D),disabled:!1,children:s.jsx(os,{className:"h-4 w-4"})}),s.jsx(ne,{variant:"ghost",size:"sm",title:"Herunterladen",className:"rounded-xl",children:s.jsx(q_,{className:"h-4 w-4"})}),s.jsx(bne,{quote:D,onRefresh:()=>j.invalidateQueries({queryKey:["quotes"]})})]})]})]})})},D.id))})}),s.jsx(We,{value:"invoices",className:"space-y-4",children:s.jsxs(es,{defaultValue:"customer",className:"space-y-4",children:[s.jsxs(Hn,{children:[s.jsxs(He,{value:"customer",children:["Kundenrechnungen (",N.length,")"]}),s.jsx(He,{value:"supplier",children:"Lieferantenrechnungen"})]}),s.jsx(We,{value:"customer",className:"space-y-4",children:S?s.jsx("div",{className:"space-y-4",children:Array(3).fill(0).map((D,W)=>s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(ft,{className:"h-5 w-32"}),s.jsx(ft,{className:"h-6 w-20"})]}),s.jsx(ft,{className:"h-4 w-48 mb-2"}),s.jsx(ft,{className:"h-4 w-24"})]}),s.jsxs("div",{className:"text-right",children:[s.jsx(ft,{className:"h-6 w-20 mb-2"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ft,{className:"h-8 w-16"}),s.jsx(ft,{className:"h-8 w-16"})]})]})]})})},W))}):I.length===0?s.jsx(oe,{children:s.jsxs(de,{className:"py-8 text-center",children:[s.jsx(Fr,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Keine Kundenrechnungen gefunden"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:t?"Keine Kundenrechnungen entsprechen Ihren Suchkriterien.":"Erstellen Sie Ihre erste Kundenrechnung."}),s.jsxs(ne,{onClick:()=>i(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Kundenrechnung erstellen"]})]})}):s.jsx("div",{className:"grid gap-4",children:I.map(D=>s.jsx(oe,{className:"hover:shadow-lg transition-shadow",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h3",{className:"font-semibold",children:D.invoice_number}),s.jsx(Be,{variant:C(D.status),children:D.status})]}),s.jsx("h4",{className:"text-lg font-medium mb-1",children:D.title}),s.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[D.customer.company_name," • ",D.customer.contact_person]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Erstellt: ",R(D.invoice_date)]}),s.jsxs("span",{children:["Fällig: ",R(D.due_date)]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-xl font-bold mb-2",children:P(D.total_amount,D.currency)}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(ne,{variant:"ghost",size:"sm",title:"Ansehen",children:s.jsx(Lr,{className:"h-4 w-4"})}),s.jsx(ne,{variant:"ghost",size:"sm",title:"Bearbeiten",children:s.jsx(zl,{className:"h-4 w-4"})}),s.jsx(ne,{variant:"ghost",size:"sm",title:"Per E-Mail versenden",onClick:()=>E("invoice",D.id,D),disabled:!1,children:s.jsx(os,{className:"h-4 w-4"})}),s.jsx(ne,{variant:"ghost",size:"sm",title:"Herunterladen",children:s.jsx(q_,{className:"h-4 w-4"})})]})]})]})})},D.id))})}),s.jsx(We,{value:"supplier",className:"space-y-4",children:s.jsx(Sne,{})})]})}),s.jsx(We,{value:"ocr",className:"space-y-4",children:o?s.jsx(Nne,{ocrResult:o,onValidated:D=>{c(null),d({title:"Rechnung validiert",description:"Die Rechnungsdaten wurden erfolgreich validiert und können übernommen werden."}),console.log("Validated invoice data:",D)},onRejected:()=>{c(null),d({title:"OCR-Ergebnis abgelehnt",description:"Das OCR-Ergebnis wurde abgelehnt."})},onCancel:()=>c(null)}):s.jsxs("div",{className:"space-y-6",children:[s.jsx(jne,{onOCRComplete:D=>{c(D)},onError:D=>{d({title:"OCR-Fehler",description:D,variant:"destructive"})}}),x&&x.length>0&&s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(hh,{className:"h-5 w-5"}),"Ausstehende Validierungen (",x.length,")"]})}),s.jsx(de,{children:s.jsx("div",{className:"space-y-4",children:x.map(D=>s.jsx(oe,{className:"border-orange-200 bg-orange-50",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("h4",{className:"font-medium",children:D.structured_data.supplierName}),s.jsx(Be,{variant:"outline",className:"bg-orange-100 text-orange-800",children:"Ausstehend"}),s.jsxs(Be,{variant:"outline",children:[Math.round(D.confidence_scores.overall*100),"% Konfidenz"]})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[s.jsxs("span",{children:["Rechnung: ",D.structured_data.invoiceNumber]}),s.jsxs("span",{children:["Betrag: ",D.structured_data.totalAmount.toLocaleString("de-DE",{style:"currency",currency:"EUR"})]}),s.jsxs("span",{children:["Datum: ",new Date(D.structured_data.date).toLocaleDateString("de-DE")]}),s.jsxs("span",{children:["Verarbeitet: ",new Date(D.created_at).toLocaleString("de-DE")]})]})]}),s.jsx(ne,{onClick:()=>c(D),size:"sm",children:"Validieren"})]})})},D.id))})})]}),s.jsx(oe,{className:"bg-blue-50 border-blue-200",children:s.jsx(de,{className:"p-6",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(hh,{className:"h-6 w-6 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Automatische Rechnungserfassung mit OCR"}),s.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[s.jsx("li",{children:"• Laden Sie Bilder oder PDFs von Lieferantenrechnungen hoch"}),s.jsx("li",{children:"• OCR erkennt automatisch Rechnungsnummer, Betrag, Lieferant und Datum"}),s.jsx("li",{children:"• Validieren Sie die erkannten Daten vor der Übernahme"}),s.jsx("li",{children:"• Rechnungen werden automatisch in Ihrem System angelegt"})]})]})]})})})]})}),s.jsx(We,{value:"templates",className:"space-y-4",children:s.jsx(oe,{children:s.jsxs(de,{className:"py-8 text-center",children:[s.jsx(wn,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Vorlagen-Manager"}),s.jsx("p",{className:"text-muted-foreground",children:"Die Vorlagen-Funktionalität wird bald verfügbar sein."})]})})})]}),s.jsx(_ne,{open:n,onOpenChange:r}),s.jsx(wne,{open:a,onOpenChange:i})]})}function Cne(){const{user:t,userProfile:e}=Vr(),{toast:n}=It(),[r,a]=g.useState([]),[i,o]=g.useState(null),[c,d]=g.useState(!1),[u,m]=g.useState(!0),[f,p]=g.useState(""),[v,w]=g.useState(!1);g.useEffect(()=>{x()},[t,e]);const x=async()=>{if(!(!t||!(e!=null&&e.company_id)))try{m(!0);const{data:S,error:E}=await K.rpc("get_pending_invoice_validations",{manager_company_id:e.company_id});if(E)throw E;a(S||[])}catch(S){console.error("Error loading pending invoices:",S),n({title:"Fehler beim Laden",description:"Ausstehende Validierungen konnten nicht geladen werden.",variant:"destructive"})}finally{m(!1)}},y=async(S,E)=>{if(t)try{const{data:C,error:P}=await K.rpc("validate_receipt",{receipt_id:S,manager_id:t.id,action:E,reason:E==="reject"?f:null,validated_data:E==="validate"?{validated_by_manager:!0}:null});if(P)throw P;await x(),o(null),d(!1),w(!1),p(""),n({title:E==="validate"?"Rechnung genehmigt":"Rechnung abgelehnt",description:E==="validate"?"Die Rechnung wurde erfolgreich validiert und genehmigt.":"Die Rechnung wurde abgelehnt und der Mitarbeiter wurde benachrichtigt.",variant:E==="validate"?"default":"destructive"})}catch(C){console.error(`Error ${E}ing invoice:`,C),n({title:"Fehler",description:`Rechnung konnte nicht ${E==="validate"?"genehmigt":"abgelehnt"} werden.`,variant:"destructive"})}},j=S=>{switch(S){case"submitted":return s.jsx(Be,{variant:"outline",className:"bg-blue-50 text-blue-700",children:"Eingereicht"});case"pending":return s.jsx(Be,{variant:"outline",className:"bg-yellow-50 text-yellow-700",children:"In Bearbeitung"});case"validated":return s.jsx(Be,{variant:"outline",className:"bg-green-50 text-green-700",children:"Genehmigt"});case"rejected":return s.jsx(Be,{variant:"outline",className:"bg-red-50 text-red-700",children:"Abgelehnt"});default:return s.jsx(Be,{variant:"outline",children:S})}},b=S=>S?S.toLocaleString("de-DE",{style:"currency",currency:"EUR"}):"-",N=S=>S.startsWith("data:")?S:`${K.storage.from("project-media").getPublicUrl(S).data.publicUrl}`;return u?s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Fr,{className:"h-5 w-5"}),"Rechnungsvalidierung"]})}),s.jsx(de,{children:s.jsx("div",{className:"flex items-center justify-center h-32",children:s.jsxs("div",{className:"text-center",children:[s.jsx(Pt,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-gray-400"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Lade ausstehende Validierungen..."})]})})})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Fr,{className:"h-5 w-5"}),"Rechnungsvalidierung"]}),s.jsx(vn,{children:"Überprüfen und genehmigen Sie von Mitarbeitern eingereichte Rechnungen"})]}),s.jsxs(de,{children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:[r.length," ausstehende Validierungen"]}),s.jsx(ne,{onClick:x,variant:"outline",size:"sm",children:"Aktualisieren"})]}),r.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Fr,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Keine ausstehenden Validierungen"}),s.jsx("p",{className:"text-gray-500",children:"Alle eingereichten Rechnungen wurden bereits bearbeitet."})]}):s.jsx("div",{className:"space-y-4",children:r.map(S=>s.jsx(oe,{className:"border-l-4 border-l-blue-500",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h4",{className:"font-semibold",children:S.project_name}),j(S.validation_status)]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-3",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ds,{className:"h-4 w-4"}),S.employee_name]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(At,{className:"h-4 w-4"}),new Date(S.created_at).toLocaleDateString("de-DE")]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(mr,{className:"h-4 w-4"}),b(S.amount)]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(wn,{className:"h-4 w-4"}),S.document_name]})]}),S.description&&s.jsx("p",{className:"text-sm bg-gray-50 p-2 rounded mb-3",children:S.description})]}),s.jsx("div",{className:"flex flex-col gap-2 ml-4",children:s.jsxs(Kt,{children:[s.jsx(fQ,{asChild:!0,children:s.jsxs(ne,{variant:"outline",size:"sm",onClick:()=>o(S),children:[s.jsx(Lr,{className:"h-4 w-4 mr-2"}),"Prüfen"]})}),s.jsxs(Wt,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[s.jsx(tn,{children:s.jsxs(nn,{children:["Rechnungsvalidierung - ",S.project_name]})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Original-Dokument"}),s.jsx("img",{src:N(S.file_url),alt:"Receipt",className:"w-full rounded border",style:{maxHeight:"400px",objectFit:"contain"}})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Details"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Mitarbeiter:"}),s.jsx("span",{className:"font-medium",children:S.employee_name})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Projekt:"}),s.jsx("span",{className:"font-medium",children:S.project_name})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Betrag:"}),s.jsx("span",{className:"font-medium",children:b(S.amount)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Eingereicht:"}),s.jsx("span",{className:"font-medium",children:new Date(S.created_at).toLocaleString("de-DE")})]})]})]}),S.description&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"Beschreibung"}),s.jsx("p",{className:"text-sm bg-gray-50 p-3 rounded",children:S.description})]}),S.ocr_result&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold mb-2",children:"OCR-Ergebnis"}),s.jsxs("div",{className:"text-sm bg-blue-50 p-3 rounded",children:[s.jsxs("div",{className:"flex justify-between mb-2",children:[s.jsx("span",{children:"Status:"}),s.jsx("span",{className:"font-medium",children:S.ocr_result.status})]}),S.ocr_result.confidence&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Vertrauen:"}),s.jsxs("span",{className:"font-medium",children:[Math.round(S.ocr_result.confidence*100),"%"]})]})]})]}),s.jsx(qa,{}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ne,{onClick:()=>y(S.id,"validate"),className:"flex-1",children:[s.jsx(Em,{className:"h-4 w-4 mr-2"}),"Genehmigen"]}),s.jsxs(ne,{variant:"outline",onClick:()=>{o(S),w(!0)},className:"flex-1 text-red-600 border-red-200 hover:bg-red-50",children:[s.jsx($n,{className:"h-4 w-4 mr-2"}),"Ablehnen"]})]})]})]})]})]})})]})})},S.id))})]})]}),s.jsx(Kt,{open:v,onOpenChange:w,children:s.jsxs(Wt,{children:[s.jsx(tn,{children:s.jsxs(nn,{className:"flex items-center gap-2 text-red-600",children:[s.jsx($n,{className:"h-5 w-5"}),"Rechnung ablehnen"]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Bitte geben Sie einen Grund für die Ablehnung an. Der Mitarbeiter wird über die Ablehnung und den Grund informiert."}),s.jsx(Cn,{placeholder:"Grund für die Ablehnung...",value:f,onChange:S=>p(S.target.value),rows:3}),s.jsxs("div",{className:"flex gap-2 justify-end",children:[s.jsx(ne,{variant:"outline",onClick:()=>{w(!1),p("")},children:"Abbrechen"}),s.jsxs(ne,{variant:"destructive",onClick:()=>i&&y(i.id,"reject"),disabled:!f.trim(),children:[s.jsx($n,{className:"h-4 w-4 mr-2"}),"Ablehnen"]})]})]})]})})]})}function Ene(){const{toast:t}=It(),[e,n]=g.useState(null),[r,a]=g.useState(!0),[i,o]=g.useState(!1),c=async()=>{try{console.log("Creating default settings...");const{data:{user:f}}=await K.auth.getUser();if(!f)throw new Error("Nicht angemeldet");const p={company_name:"Meine Firma",address:"",postal_code:"",city:"",country:"Deutschland",phone:"",email:"",website:"",tax_id:"",default_working_hours_start:"08:00",default_working_hours_end:"17:00",default_break_duration:60,default_hourly_rate:50,default_overtime_rate:62.5,default_currency:"EUR",default_tax_rate:19,default_vacation_days:25,invoice_prefix:"RE",quote_prefix:"AN",project_prefix:"PR",is_active:!0};console.log("Inserting default settings:",p);const{data:v,error:w}=await K.from("company_settings").insert(p).select().single();if(console.log("Insert result:",{data:v,error:w}),w)throw w;n(v),t({title:"Erfolg",description:"Standard-Einstellungen wurden erstellt."})}catch(f){const p=f instanceof Error?f.message:String(f);console.error("Error creating default settings:",f),t({title:"Fehler",description:`Standard-Einstellungen konnten nicht erstellt werden: ${p}`,variant:"destructive"})}},d=async()=>{try{console.log("Loading company settings...");const{data:{user:f},error:p}=await K.auth.getUser();if(console.log("Current user:",f),console.log("Auth error:",p),p||!f)throw new Error("Nicht angemeldet");const{data:v,error:w}=await K.from("company_settings").select("*").limit(1).maybeSingle();if(console.log("Load result:",{data:v,error:w}),w)throw console.error("Supabase error details:",w),w;v?n(v):(console.log("No settings found, creating default..."),await c())}catch(f){const p=f instanceof Error?f.message:String(f);console.error("Error loading settings:",f),t({title:"Fehler beim Laden",description:`Einstellungen konnten nicht geladen werden: ${p}`,variant:"destructive"})}finally{a(!1)}};g.useEffect(()=>{d()},[]);const u=async()=>{if(!(e!=null&&e.id)){t({title:"Fehler",description:"Keine gültige Einstellungs-ID gefunden.",variant:"destructive"});return}o(!0);try{console.log("Saving settings:",e);const{data:{user:f}}=await K.auth.getUser();if(!f)throw new Error("Nicht angemeldet");const p={company_name:e.company_name,company_address:e.company_address,company_city:e.company_city,company_postal_code:e.company_postal_code,company_country:e.company_country,company_phone:e.company_phone,company_email:e.company_email,tax_number:e.tax_number,vat_id:e.vat_id,website:e.website,default_working_hours_start:e.default_working_hours_start,default_working_hours_end:e.default_working_hours_end,default_break_duration:e.default_break_duration,default_hourly_rate:e.default_hourly_rate,default_overtime_rate:e.default_overtime_rate,default_currency:e.default_currency,default_tax_rate:e.default_tax_rate,default_vacation_days:e.default_vacation_days,invoice_prefix:e.invoice_prefix,quote_prefix:e.quote_prefix,project_prefix:e.project_prefix};console.log("Update data:",p),console.log("Settings ID:",e.id);const{data:v,error:w}=await K.from("company_settings").update(p).eq("id",e.id).select();if(console.log("Save result:",{data:v,error:w}),w)throw w;t({title:"Erfolgreich gespeichert",description:"Die Firmeneinstellungen wurden aktualisiert."})}catch(f){const p=f instanceof Error?f.message:String(f);console.error("Error saving settings:",f),t({title:"Fehler beim Speichern",description:`Einstellungen konnten nicht gespeichert werden: ${p}`,variant:"destructive"})}finally{o(!1)}},m=(f,p)=>{e&&n({...e,[f]:p})};return r?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-muted-foreground",children:"Lade Einstellungen..."})}):e?s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[s.jsx(Po,{className:"h-6 w-6 text-gray-700"}),"Firmeneinstellungen"]}),s.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:"Verwalten Sie alle wichtigen Firmeninformationen"})]}),s.jsx(ne,{onClick:u,disabled:i,children:i?"Speichere...":"Speichern"})]}),s.jsxs(es,{defaultValue:"company",children:[s.jsxs(Hn,{className:"grid w-full grid-cols-4 bg-muted/30 p-0.5 h-auto",children:[s.jsxs(He,{value:"company",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm py-2.5 text-xs sm:text-sm",children:[s.jsx(Hr,{className:"h-4 w-4 mr-1.5"}),"Firma"]}),s.jsxs(He,{value:"financial",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm py-2.5 text-xs sm:text-sm",children:[s.jsx(u0,{className:"h-4 w-4 mr-1.5"}),"Finanzen"]}),s.jsxs(He,{value:"worktime",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm py-2.5 text-xs sm:text-sm",children:[s.jsx(Pt,{className:"h-4 w-4 mr-1.5"}),"Arbeitszeit"]}),s.jsxs(He,{value:"workflows",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm py-2.5 text-xs sm:text-sm",children:[s.jsx(yS,{className:"h-4 w-4 mr-1.5"}),"Workflows"]})]}),s.jsxs(We,{value:"company",className:"space-y-4 mt-6",children:[s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Hr,{className:"h-5 w-5"}),"Firmeninformationen"]}),s.jsx(vn,{children:"Grundlegende Informationen über Ihr Unternehmen"})]}),s.jsxs(de,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"company_name",children:"Firmenname"}),s.jsx(re,{id:"company_name",value:e.company_name||"",onChange:f=>m("company_name",f.target.value),placeholder:"Ihr Firmenname"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"website",children:"Website"}),s.jsx(re,{id:"website",value:e.website||"",onChange:f=>m("website",f.target.value),placeholder:"https://www.ihre-website.de"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"company_address",children:"Adresse"}),s.jsx(Cn,{id:"company_address",value:e.company_address||"",onChange:f=>m("company_address",f.target.value),placeholder:"Straße und Hausnummer",rows:2})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"company_postal_code",children:"Postleitzahl"}),s.jsx(re,{id:"company_postal_code",value:e.company_postal_code||"",onChange:f=>m("company_postal_code",f.target.value),placeholder:"12345"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"company_city",children:"Stadt"}),s.jsx(re,{id:"company_city",value:e.company_city||"",onChange:f=>m("company_city",f.target.value),placeholder:"Ihre Stadt"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"company_country",children:"Land"}),s.jsx(re,{id:"company_country",value:e.company_country||"",onChange:f=>m("company_country",f.target.value),placeholder:"Deutschland"})]})]})]})]}),s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(os,{className:"h-5 w-5"}),"Kontaktinformationen"]}),s.jsx(vn,{children:"Wie Kunden Sie erreichen können"})]}),s.jsxs(de,{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"company_phone",children:"Telefon"}),s.jsx(re,{id:"company_phone",value:e.company_phone||"",onChange:f=>m("company_phone",f.target.value),placeholder:"+49 123 456789"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"company_email",children:"E-Mail"}),s.jsx(re,{id:"company_email",type:"email",value:e.company_email||"",onChange:f=>m("company_email",f.target.value),placeholder:"info@ihre-firma.de"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"tax_number",children:"Steuernummer"}),s.jsx(re,{id:"tax_number",value:e.tax_number||"",onChange:f=>m("tax_number",f.target.value),placeholder:"123/456/78901"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"vat_id",children:"USt-IdNr."}),s.jsx(re,{id:"vat_id",value:e.vat_id||"",onChange:f=>m("vat_id",f.target.value),placeholder:"DE123456789"})]})]})]})]}),s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(wn,{className:"h-5 w-5"}),"Dokumenteinstellungen"]}),s.jsx(vn,{children:"Präfixe für automatische Nummerierung"})]}),s.jsx(de,{className:"space-y-4",children:s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"invoice_prefix",children:"Rechnungs-Präfix"}),s.jsx(re,{id:"invoice_prefix",value:e.invoice_prefix||"",onChange:f=>m("invoice_prefix",f.target.value),placeholder:"RE"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"quote_prefix",children:"Angebots-Präfix"}),s.jsx(re,{id:"quote_prefix",value:e.quote_prefix||"",onChange:f=>m("quote_prefix",f.target.value),placeholder:"AN"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"project_prefix",children:"Projekt-Präfix"}),s.jsx(re,{id:"project_prefix",value:e.project_prefix||"",onChange:f=>m("project_prefix",f.target.value),placeholder:"PR"})]})]})})]})]}),s.jsx(We,{value:"financial",className:"space-y-4 mt-6",children:s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(u0,{className:"h-5 w-5"}),"Finanzeinstellungen"]}),s.jsx(vn,{children:"Standard-Werte für Preise und Steuern"})]}),s.jsxs(de,{className:"pt-4 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"default_hourly_rate",children:"Standard-Stundensatz (€)"}),s.jsx(re,{id:"default_hourly_rate",type:"number",step:"0.50",value:e.default_hourly_rate||"",onChange:f=>m("default_hourly_rate",Number(f.target.value)),placeholder:"50.00"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"default_overtime_rate",children:"Überstunden-Satz (€)"}),s.jsx(re,{id:"default_overtime_rate",type:"number",step:"0.50",value:e.default_overtime_rate||"",onChange:f=>m("default_overtime_rate",Number(f.target.value)),placeholder:"62.50"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"default_currency",children:"Währung"}),s.jsx(re,{id:"default_currency",value:e.default_currency||"EUR",onChange:f=>m("default_currency",f.target.value),placeholder:"EUR"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"default_tax_rate",children:"Steuersatz (%)"}),s.jsx(re,{id:"default_tax_rate",type:"number",step:"0.1",value:e.default_tax_rate||"",onChange:f=>m("default_tax_rate",Number(f.target.value)),placeholder:"19.0"})]})]})]})]})}),s.jsxs(We,{value:"worktime",className:"space-y-4 mt-6",children:[s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Pt,{className:"h-5 w-5"}),"Arbeitszeiten"]}),s.jsx(vn,{children:"Standard-Arbeitszeiten für Berechnungen und Zeiterfassung"})]}),s.jsx(de,{className:"pt-4 space-y-4",children:s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"default_working_hours_start",children:"Arbeitsbeginn"}),s.jsx(re,{id:"default_working_hours_start",type:"time",value:e.default_working_hours_start||"08:00",onChange:f=>m("default_working_hours_start",f.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"default_working_hours_end",children:"Arbeitsende"}),s.jsx(re,{id:"default_working_hours_end",type:"time",value:e.default_working_hours_end||"17:00",onChange:f=>m("default_working_hours_end",f.target.value)})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"default_break_duration",children:"Pausendauer (Min.)"}),s.jsx(re,{id:"default_break_duration",type:"number",value:e.default_break_duration||60,onChange:f=>m("default_break_duration",Number(f.target.value)),placeholder:"60"})]})]})})]}),s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(At,{className:"h-5 w-5"}),"Urlaubseinstellungen"]}),s.jsx(vn,{children:"Standard-Urlaubstage für neue Mitarbeiter"})]}),s.jsx(de,{className:"space-y-4",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"default_vacation_days",children:"Standard Urlaubstage pro Jahr"}),s.jsx(re,{id:"default_vacation_days",type:"number",min:"0",max:"50",value:e.default_vacation_days||25,onChange:f=>m("default_vacation_days",Number(f.target.value)),placeholder:"25"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Diese Anzahl wird automatisch jedem neuen Mitarbeiter bei der Erstellung zugewiesen"})]})})]})]}),s.jsx(We,{value:"workflows",className:"mt-6",children:s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(yS,{className:"h-5 w-5"}),"Workflow-Einstellungen"]}),s.jsx(vn,{children:"Konfigurieren Sie die automatischen Regeln für die Workflow-Erkennung zwischen Direktabrechnung und Lieferschein-Workflow."})]}),s.jsxs(de,{className:"pt-4 space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[s.jsx(Pt,{className:"h-4 w-4"}),"Automatische Schwellwerte"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{children:"Mindest-Arbeitszeit für Lieferschein (Stunden)"}),s.jsx(re,{type:"number",min:"0",step:"0.5",placeholder:"8"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Projekte mit mehr Stunden erhalten automatisch einen Lieferschein"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{children:"Mindest-Materialwert für Lieferschein (€)"}),s.jsx(re,{type:"number",min:"0",step:"50",placeholder:"500"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Projekte mit Material über diesem Wert erhalten einen Lieferschein"})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-sm font-medium mb-3 flex items-center gap-2",children:[s.jsx(Br,{className:"h-4 w-4"}),"Kunden-basierte Regeln"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-md border",children:[s.jsxs("div",{children:[s.jsx(se,{children:"B2B-Kunden immer mit Lieferschein"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Geschäftskunden erhalten grundsätzlich einen Lieferschein"})]}),s.jsx("div",{className:"w-12 h-6 bg-blue-500 rounded-full relative",children:s.jsx("div",{className:"w-5 h-5 bg-white rounded-full absolute top-0.5 right-0.5"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{children:"B2C-Schwellwert für Lieferschein (€)"}),s.jsx(re,{type:"number",min:"0",step:"100",placeholder:"1000"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Privatkunden-Projekte über diesem Wert erhalten einen Lieferschein"})]})]})]})]})]})})]})]}):s.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[s.jsx("div",{className:"text-muted-foreground",children:"Keine Einstellungen gefunden"}),s.jsx(ne,{onClick:c,children:"Standard-Einstellungen erstellen"})]})}const Ane=()=>{var le,pe;const{toast:t}=It(),[e,n]=g.useState([]),[r,a]=g.useState([]),[i,o]=g.useState(null),[c,d]=g.useState([]),[u,m]=g.useState("inbox"),[f,p]=g.useState(""),[v,w]=g.useState(!1),[x,y]=g.useState(""),[j,b]=g.useState(!1),[N,S]=g.useState(!1),[E,C]=g.useState(!1),P=J=>{try{return new Date(J).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}catch{return"00:00"}},R=J=>{try{return new Date(J).toLocaleDateString("de-DE")}catch{return"01.01.2024"}},H=J=>{try{const ae=new Date(J);return ae.toLocaleDateString("de-DE")+" "+ae.toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})}catch{return"01.01.2024 00:00"}},I={mail:os,"shopping-cart":NB,"message-square":mP,receipt:Fr,"help-circle":rB,newspaper:vB};g.useEffect(()=>{W(),V(),D()},[]),g.useEffect(()=>{if(x)return G(),Y()},[x]);const D=async()=>{try{const{data:{user:J}}=await K.auth.getUser();if(!J){C(!1);return}console.log("Checking Gmail connection for user:",J.id);const{data:ae,error:fe}=await K.from("user_email_connections").select("*").eq("user_id",J.id).eq("provider","gmail").eq("is_active",!0);console.log("Gmail connections query result:",{connections:ae,error:fe}),!fe&&ae&&ae.length>0?(C(!0),console.log("Gmail connection found:",ae[0])):(console.log("No active Gmail connection found, but enabling sync for testing"),C(!0))}catch(J){console.error("Error checking Gmail connection:",J),C(!0)}},W=async()=>{try{const{data:{user:J}}=await K.auth.getUser();if(!J)return;const{data:ae}=await K.from("profiles").select("company_email").eq("id",J.id).single();ae!=null&&ae.company_email&&y(ae.company_email)}catch(J){console.error("Error fetching company email:",J)}},V=async()=>{try{const{data:J,error:ae}=await K.from("email_categories").select("*").order("name");a(!ae&&J?J:[{id:"orders",name:"Bestellungen",color:"#10b981",icon:"shopping-cart"},{id:"inquiries",name:"Anfragen",color:"#3b82f6",icon:"message-square"},{id:"invoices",name:"Rechnungen",color:"#f59e0b",icon:"receipt"},{id:"support",name:"Support",color:"#ef4444",icon:"help-circle"},{id:"newsletter",name:"Newsletter",color:"#8b5cf6",icon:"newspaper"}])}catch(J){console.error("Error fetching categories:",J)}},G=g.useCallback(async()=>{try{const{data:{user:J}}=await K.auth.getUser();if(J){const{data:ae}=await K.from("profiles").select("company_id").eq("id",J.id).single();if(ae!=null&&ae.company_id){const{data:fe,error:he}=await K.from("emails").select(`
              *,
              email_categories (name, color, icon),
              customers (company_name, contact_person, phone, website)
            `).eq("company_id",ae.company_id).order("received_at",{ascending:!1}).limit(50);if(!he&&fe){console.log(`Loaded ${fe.length} real emails from database`);const ve=fe.map(ie=>({...ie,reply_count:fe.filter(_e=>_e.thread_id===ie.thread_id).length-1}));n(ve);return}else console.error("Error loading emails from database:",he)}}}catch(J){console.error("Error fetching emails:",J)}console.log("No emails in database - user needs to sync Gmail first"),n([])},[]),Y=g.useCallback(()=>{const J=K.channel("emails-modern").on("postgres_changes",{event:"INSERT",schema:"public",table:"emails",filter:`recipient_email=eq.${x}`},ae=>{const fe=ae.new;n(he=>[fe,...he]),t({title:"📧 Neue E-Mail",description:`Von: ${fe.sender_name||fe.sender_email}`,action:s.jsx(ne,{size:"sm",onClick:()=>o(fe),children:"Anzeigen"})})}).subscribe();return()=>K.removeChannel(J)},[x,t]),X=J=>{o(J),J.is_read||F([J.id],!0)},F=async(J,ae)=>{const{error:fe}=await K.from("emails").update({is_read:ae}).in("id",J);fe||n(he=>he.map(ve=>J.includes(ve.id)?{...ve,is_read:ae}:ve))},T=async J=>{const ae=e.find(he=>he.id===J);if(!ae)return;const{error:fe}=await K.from("emails").update({is_starred:!ae.is_starred}).eq("id",J);fe||n(he=>he.map(ve=>ve.id===J?{...ve,is_starred:!ae.is_starred}:ve))},q=async J=>{const{error:ae}=await K.from("emails").update({is_archived:!0}).in("id",J);ae||(n(fe=>fe.filter(he=>!J.includes(he.id))),d([]),t({title:"E-Mails archiviert",description:`${J.length} E-Mail(s) wurden archiviert.`}))},U=J=>{switch(J){case"mark-read":F(c,!0);break;case"mark-unread":F(c,!1);break;case"archive":q(c);break;case"star":c.forEach(ae=>T(ae));break}},B=async J=>{try{const{data:{user:ae}}=await K.auth.getUser();if(!ae)return;const{data:fe}=await K.from("profiles").select("company_id").eq("id",ae.id).single();if(!(fe!=null&&fe.company_id))return;let he=null;if(J.customers){const{data:ve}=await K.from("customers").select("id").eq("email",J.sender_email).eq("company_id",fe.company_id).single();if(ve)he=ve.id;else{const{data:ie}=await K.from("customers").insert({company_id:fe.company_id,email:J.sender_email,company_name:J.customers.company_name,contact_person:J.customers.contact_person}).select().single();ie&&(he=ie.id)}}if(he){const{data:ve,error:ie}=await K.from("quotes").insert({quote_number:`AG-${Date.now().toString().slice(-6)}`,company_id:fe.company_id,customer_id:he,title:`Angebot bezüglich: ${J.subject}`,description:`Automatisch erstellt aus E-Mail vom ${R(J.received_at)}`,quote_date:new Date().toISOString().split("T")[0],valid_until:new Date(Date.now()+2592e6).toISOString().split("T")[0],status:"entwurf",total_amount:0,currency:"EUR"}).select().single();ve&&t({title:"Angebot erstellt",description:`Angebot ${ve.quote_number} wurde aus E-Mail erstellt.`})}}catch{t({title:"Fehler beim Erstellen",description:"Angebot konnte nicht erstellt werden.",variant:"destructive"})}},O=async J=>{try{const{data:{user:ae}}=await K.auth.getUser();if(!ae)return;const{data:fe}=await K.from("profiles").select("company_id").eq("id",ae.id).single();if(!(fe!=null&&fe.company_id))return;let he=null;if(J.customers){const{data:ve}=await K.from("customers").select("id").eq("email",J.sender_email).eq("company_id",fe.company_id).single();ve&&(he=ve.id)}if(he){const{data:ve,error:ie}=await K.from("projects").insert({name:J.subject||"Projekt aus E-Mail",customer_id:he,company_id:fe.company_id,status:"anfrage",start_date:new Date().toISOString().split("T")[0],description:`Automatisch erstellt aus E-Mail vom ${H(J.received_at)}.

Inhalt der E-Mail:
${J.content.replace(/<[^>]*>/g,"")}`,budget:0}).select().single();ve&&t({title:"Projekt erstellt",description:`Projekt "${ve.name}" wurde aus E-Mail erstellt.`})}}catch{t({title:"Fehler beim Erstellen",description:"Projekt konnte nicht erstellt werden.",variant:"destructive"})}},z=e.filter(J=>{var he,ve;const ae=u==="inbox"?!J.is_archived:u==="starred"?J.is_starred:u==="unread"?!J.is_read:((he=J.email_categories)==null?void 0:he.name)===u,fe=!f||J.subject.toLowerCase().includes(f.toLowerCase())||((ve=J.sender_name)==null?void 0:ve.toLowerCase().includes(f.toLowerCase()))||J.sender_email.toLowerCase().includes(f.toLowerCase())||J.content.toLowerCase().includes(f.toLowerCase());return ae&&fe}),$=J=>{switch(J){case"urgent":return s.jsx(Am,{className:"h-3 w-3 text-red-500"});case"high":return s.jsx(nj,{className:"h-3 w-3 text-orange-500"});default:return null}},te=async()=>{try{const{data:{user:J}}=await K.auth.getUser();if(!J){t({title:"Fehler",description:"Sie müssen angemeldet sein, um Gmail zu verbinden.",variant:"destructive"});return}const{data:ae,error:fe}=await K.functions.invoke("initiate-gmail-oauth",{body:{user_id:J.id}});if(ae!=null&&ae.authUrl){window.open(ae.authUrl,"_blank","width=500,height=600"),t({title:"Gmail-Verbindung",description:"Ein neues Fenster wurde geöffnet. Bitte autorisieren Sie den Zugriff auf Gmail."});let he=0;const ve=setInterval(async()=>{he++,await D(),(E||he>=15)&&(clearInterval(ve),E&&t({title:"Gmail verbunden!",description:"Sie können jetzt E-Mails synchronisieren."}))},2e3)}else t({title:"Fehler",description:(fe==null?void 0:fe.message)||"Gmail-Verbindung konnte nicht gestartet werden.",variant:"destructive"})}catch(J){console.error("Gmail OAuth error:",J),t({title:"Fehler",description:"Ein unerwarteter Fehler ist aufgetreten.",variant:"destructive"})}},ee=async()=>{var J,ae;try{console.log("Starting AI analysis for emails...");const fe=e.filter(he=>!he.ai_category&&!he.ai_summary);if(fe.length===0){console.log("No emails need AI analysis");return}console.log(`Analyzing ${fe.length} emails with AI...`);for(const he of fe.slice(0,5))try{const{data:ve,error:ie}=await K.functions.invoke("classify-email",{body:JSON.stringify({emailId:he.id,subject:he.subject,content:he.content,senderEmail:he.sender_email,senderName:he.sender_name})});if(ve&&!ie){console.log(`AI analysis result for email ${he.id}:`,ve);const _e={...he,ai_category:ve.category,ai_summary:ve.summary,ai_confidence:ve.confidence,priority:((J=ve.extractedData)==null?void 0:J.priority)||"normal"};n(Se=>Se.map(Ve=>Ve.id===he.id?_e:Ve)),await K.from("emails").update({ai_category:ve.category,ai_summary:ve.summary,ai_confidence:ve.confidence,priority:((ae=ve.extractedData)==null?void 0:ae.priority)||"normal",processing_status:"completed"}).eq("id",he.id)}}catch(ve){console.error(`AI analysis failed for email ${he.id}:`,ve)}t({title:"KI-Analyse abgeschlossen",description:`${fe.length} E-Mails wurden analysiert.`}),await G()}catch(fe){console.error("AI analysis error:",fe),t({title:"KI-Analyse Fehler",description:"Die KI-Analyse konnte nicht durchgeführt werden.",variant:"destructive"})}},Q=async()=>{try{w(!0);const{data:{user:J}}=await K.auth.getUser();if(!J){t({title:"Fehler",description:"Sie müssen angemeldet sein, um E-Mails zu synchronisieren.",variant:"destructive"}),w(!1);return}console.log("Starting Gmail sync for user:",J.id);const ae=new Promise((_e,Se)=>setTimeout(()=>Se(new Error("Sync timeout after 30 seconds")),3e4)),fe=K.functions.invoke("sync-gmail-emails",{body:JSON.stringify({manual:!0,forceFullSync:!1}),headers:{"Content-Type":"application/json"}}),he=await Promise.race([fe,ae]),{data:ve,error:ie}=he;console.log("Gmail sync response:",{data:ve,error:ie}),ve!=null&&ve.success?(await G(),t({title:"Synchronisation erfolgreich",description:`${ve.synced_count||ve.totalSynced||0} neue E-Mails synchronisiert.`}),await ee()):(console.error("Gmail sync failed:",ie),t({title:"Synchronisationsfehler",description:(ie==null?void 0:ie.message)||(ve==null?void 0:ve.error)||"E-Mails konnten nicht synchronisiert werden.",variant:"destructive"}))}catch(J){console.error("Gmail sync error:",J),t({title:"Fehler",description:`Synchronisation fehlgeschlagen: ${J.message}`,variant:"destructive"})}finally{w(!1)}};return s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"E-Mail Verwaltung"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(ne,{variant:E?"default":"outline",onClick:te,className:"rounded-full",children:[s.jsx(os,{className:"h-4 w-4 mr-2"}),E?"Gmail verbunden":"Gmail verbinden"]}),s.jsxs(ne,{variant:"outline",onClick:Q,disabled:v||!E,className:"rounded-full",children:[s.jsx(uh,{className:`h-4 w-4 mr-2 ${v?"animate-spin":""}`}),"Synchronisieren"]}),s.jsxs(ne,{onClick:()=>S(!0),className:"bg-blue-600 hover:bg-blue-700 rounded-full",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Neue E-Mail"]})]})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Ungelesen"}),s.jsx("p",{className:"text-2xl font-bold",children:e.filter(J=>!J.is_read).length})]}),s.jsx(os,{className:"h-8 w-8 text-blue-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Markiert"}),s.jsx("p",{className:"text-2xl font-bold",children:e.filter(J=>J.is_starred).length})]}),s.jsx(Ji,{className:"h-8 w-8 text-yellow-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Heute"}),s.jsx("p",{className:"text-2xl font-bold",children:e.filter(J=>{try{return new Date(J.received_at).toDateString()===new Date().toDateString()}catch{return!1}}).length})]}),s.jsx(At,{className:"h-8 w-8 text-green-500 opacity-50"})]})})}),s.jsx(oe,{className:"shadow-soft rounded-2xl",children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"KI-Kategorien"}),s.jsx("p",{className:"text-2xl font-bold",children:e.filter(J=>J.ai_category).length})]}),s.jsx(Ff,{className:"h-8 w-8 text-purple-500 opacity-50"})]})})})]}),s.jsx(oe,{className:"shadow-soft rounded-2xl flex-1",style:{minHeight:"calc(100vh - 280px)"},children:s.jsx(de,{className:"p-0",children:s.jsxs("div",{className:"flex",style:{height:"calc(100vh - 280px)"},children:[s.jsxs("div",{className:`${j?"w-16":"w-64"} border-r bg-muted/30 transition-all duration-200`,children:[s.jsxs("div",{className:"p-4 border-b",children:[s.jsx(ne,{size:"sm",variant:"ghost",onClick:()=>b(!j),className:"mb-4",children:j?s.jsx(Pl,{className:"h-4 w-4"}):s.jsx(dh,{className:"h-4 w-4"})}),!j&&s.jsxs("div",{className:"relative",children:[s.jsx(ec,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),s.jsx(re,{placeholder:"E-Mails suchen...",value:f,onChange:J=>p(J.target.value),className:"pl-9 rounded-xl"})]})]}),s.jsxs("nav",{className:"flex-1 px-4 space-y-1",children:[s.jsxs(ne,{variant:u==="inbox"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m("inbox"),children:[s.jsx(os,{className:"h-4 w-4 mr-2"}),!j&&s.jsxs(s.Fragment,{children:["Posteingang",s.jsx(Be,{variant:"secondary",className:"ml-auto",children:e.filter(J=>!J.is_archived).length})]})]}),s.jsxs(ne,{variant:u==="starred"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m("starred"),children:[s.jsx(Ji,{className:"h-4 w-4 mr-2"}),!j&&s.jsxs(s.Fragment,{children:["Markiert",s.jsx(Be,{variant:"secondary",className:"ml-auto",children:e.filter(J=>J.is_starred).length})]})]}),s.jsxs(ne,{variant:u==="unread"?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m("unread"),children:[s.jsx(Lr,{className:"h-4 w-4 mr-2"}),!j&&s.jsxs(s.Fragment,{children:["Ungelesen",s.jsx(Be,{variant:"secondary",className:"ml-auto",children:e.filter(J=>!J.is_read).length})]})]}),!j&&s.jsx(qa,{className:"my-4"}),r.map(J=>{const ae=I[J.icon]||os,fe=e.filter(he=>{var ve;return((ve=he.email_categories)==null?void 0:ve.name)===J.name}).length;return s.jsxs(ne,{variant:u===J.name?"secondary":"ghost",className:"w-full justify-start",onClick:()=>m(J.name),children:[s.jsx(ae,{className:"h-4 w-4 mr-2",style:{color:J.color}}),!j&&s.jsxs(s.Fragment,{children:[J.name,s.jsx(Be,{variant:"secondary",className:"ml-auto",children:fe})]})]},J.id)})]}),!j&&s.jsx("div",{className:"p-4 border-t",children:s.jsxs(ne,{variant:"outline",className:"w-full rounded-xl",onClick:ee,children:[s.jsx(Ff,{className:"h-4 w-4 mr-2"}),"KI-Analyse"]})})]}),s.jsxs("div",{className:"w-96 bg-background border-r flex flex-col",children:[c.length>0&&s.jsx("div",{className:"p-3 border-b bg-muted/50",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"text-sm text-muted-foreground",children:[c.length," ausgewählt"]}),s.jsx(ne,{size:"sm",variant:"ghost",onClick:()=>U("mark-read"),children:s.jsx(Md,{className:"h-4 w-4"})}),s.jsx(ne,{size:"sm",variant:"ghost",onClick:()=>U("star"),children:s.jsx(Ji,{className:"h-4 w-4"})}),s.jsx(ne,{size:"sm",variant:"ghost",onClick:()=>U("archive"),children:s.jsx(JF,{className:"h-4 w-4"})})]})}),s.jsx(wi,{className:"flex-1",children:s.jsx("div",{className:"divide-y",children:z.map(J=>{var ae;return s.jsx("div",{className:`p-4 cursor-pointer transition-all hover:bg-accent/50 ${(i==null?void 0:i.id)===J.id?"bg-accent border-r-2 border-primary":""} ${J.is_read?"":"bg-blue-50/30 border-l-2 border-blue-500"}`,onClick:()=>X(J),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Js,{checked:c.includes(J.id),onCheckedChange:fe=>{d(fe?he=>[...he,J.id]:he=>he.filter(ve=>ve!==J.id))},onClick:fe=>fe.stopPropagation()}),s.jsx(hm,{className:"h-8 w-8 flex-shrink-0",children:s.jsx(mm,{children:((ae=J.sender_name)==null?void 0:ae[0])||J.sender_email[0].toUpperCase()})}),s.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:`text-sm truncate ${J.is_read?"":"font-semibold"}`,children:J.sender_name||J.sender_email}),s.jsxs("div",{className:"flex items-center gap-1",children:[$(J.priority),s.jsx("span",{className:"text-xs text-muted-foreground",children:P(J.received_at)})]})]}),s.jsx("p",{className:`text-sm truncate ${J.is_read?"":"font-semibold"}`,children:J.subject}),s.jsxs("p",{className:"text-xs text-muted-foreground line-clamp-2",children:[J.ai_summary||J.content.replace(/<[^>]*>/g,"").substring(0,100),"..."]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[J.is_starred&&s.jsx(Ji,{className:"h-3 w-3 text-yellow-500 fill-current"}),J.attachments&&J.attachments.length>0&&s.jsx(yB,{className:"h-3 w-3 text-muted-foreground"}),J.reply_count&&J.reply_count>0&&s.jsx(Be,{variant:"outline",className:"text-xs px-1 py-0",children:J.reply_count})]}),J.email_categories&&s.jsx(Be,{variant:"outline",className:"text-xs",style:{borderColor:J.email_categories.color,color:J.email_categories.color},children:J.email_categories.name})]})]})]})},J.id)})})})]}),i?s.jsxs("div",{className:"flex-1 flex flex-col",children:[s.jsxs("div",{className:"p-6 border-b bg-card",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(hm,{className:"h-10 w-10",children:s.jsx(mm,{children:((le=i.sender_name)==null?void 0:le[0])||i.sender_email[0].toUpperCase()})}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"font-medium",children:i.sender_name||i.sender_email}),s.jsx("p",{className:"text-sm text-muted-foreground",children:i.sender_email}),s.jsx("p",{className:"text-xs text-muted-foreground",children:H(i.received_at)})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ne,{size:"sm",variant:"ghost",onClick:()=>T(i.id),children:s.jsx(Ji,{className:`h-4 w-4 ${i.is_starred?"text-yellow-500 fill-current":""}`})}),s.jsx(ne,{size:"sm",variant:"ghost",children:s.jsx(jB,{className:"h-4 w-4"})}),s.jsx(ne,{size:"sm",variant:"ghost",children:s.jsx(dB,{className:"h-4 w-4"})}),s.jsx(ne,{size:"sm",variant:"ghost",children:s.jsx(cB,{className:"h-4 w-4"})})]})]}),s.jsx("h2",{className:"text-xl font-semibold mb-4",children:i.subject}),s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.ai_category&&s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-purple-100 text-purple-800 border-purple-200",children:[s.jsx(Ff,{className:"h-3 w-3 mr-1"}),i.ai_category]}),i.customers&&s.jsxs("span",{className:"inline-flex items-center rounded-full border px-2.5 py-1 text-xs bg-green-100 text-green-800 border-green-200",children:[s.jsx(Hr,{className:"h-3 w-3 mr-1"}),i.customers.company_name]})]}),i.ai_summary&&s.jsxs("div",{className:"bg-accent/50 p-4 rounded-xl mt-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ff,{className:"h-4 w-4 text-primary"}),s.jsx("span",{className:"text-sm font-medium",children:"KI-Zusammenfassung"}),i.ai_confidence&&s.jsxs(Be,{variant:"outline",className:"text-xs",children:[Math.round(i.ai_confidence*100),"% Konfidenz"]})]}),s.jsx("p",{className:"text-sm",children:i.ai_summary})]}),s.jsxs("div",{className:"flex gap-2 mt-4",children:[s.jsxs(ne,{size:"sm",onClick:()=>B(i),className:"rounded-xl",children:[s.jsx(wn,{className:"h-4 w-4 mr-2"}),"Angebot erstellen"]}),s.jsxs(ne,{size:"sm",variant:"outline",onClick:()=>O(i),className:"rounded-xl",children:[s.jsx(Hr,{className:"h-4 w-4 mr-2"}),"Projekt anlegen"]}),((pe=i.customers)==null?void 0:pe.phone)&&s.jsx(ne,{size:"sm",variant:"outline",asChild:!0,className:"rounded-xl",children:s.jsxs("a",{href:`tel:${i.customers.phone}`,children:[s.jsx(Zd,{className:"h-4 w-4 mr-2"}),"Anrufen"]})})]})]}),s.jsx(wi,{className:"flex-1 p-6",children:s.jsx("div",{className:"prose prose-sm max-w-none text-gray-800 dark:text-gray-200",style:{fontSize:"14px",lineHeight:"1.6"},dangerouslySetInnerHTML:{__html:i.html_content||i.content.replace(/\n/g,"<br>")}})})]}):s.jsx("div",{className:"flex-1 flex items-center justify-center bg-muted/20",children:s.jsxs("div",{className:"text-center",children:[s.jsx(os,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),s.jsx("p",{className:"text-lg font-medium mb-2",children:"Keine E-Mail ausgewählt"}),s.jsx("p",{className:"text-muted-foreground",children:"Wählen Sie eine E-Mail aus, um sie anzuzeigen"})]})})]})})})]})};function GI({open:t,onOpenChange:e,onSuccess:n}){const{toast:r}=It(),[a,i]=g.useState(!1),[o,c]=g.useState(0),[d,u]=g.useState({startDate:"",endDate:"",reason:"",type:"vacation"});g.useEffect(()=>{t&&m()},[t]);const m=async()=>{try{const{data:{user:w}}=await K.auth.getUser();if(!w)return;const{data:x}=await K.from("employees").select("id, vacation_days_total, vacation_days_used").eq("user_id",w.id).single();if(x){const y=(x.vacation_days_total||0)-(x.vacation_days_used||0);c(Math.max(0,y))}else{const{data:y}=await K.from("company_settings").select("default_vacation_days").single();c((y==null?void 0:y.default_vacation_days)||25)}}catch(w){console.error("Error loading vacation balance:",w),c(0)}},f=(w,x)=>{if(!w||!x)return 0;const y=new Date(w),b=new Date(x).getTime()-y.getTime(),N=Math.ceil(b/(1e3*3600*24))+1;return Math.max(0,N)},p=async w=>{if(w.preventDefault(),!d.startDate||!d.endDate){r({title:"Fehler",description:"Bitte wählen Sie Start- und Enddatum aus",variant:"destructive"});return}const x=new Date(d.startDate),y=new Date(d.endDate);if(x>y){r({title:"Fehler",description:"Das Enddatum muss nach dem Startdatum liegen",variant:"destructive"});return}const j=f(d.startDate,d.endDate);if(d.type==="vacation"&&j>o){r({title:"Fehler",description:`Sie haben nur noch ${o} Urlaubstage verfügbar`,variant:"destructive"});return}i(!0);try{const{data:{user:b}}=await K.auth.getUser();if(!b)throw new Error("Nicht angemeldet");const{data:N,error:S}=await K.from("employees").select("id").eq("user_id",b.id).single();if(S||!N)throw new Error("Mitarbeiterdaten nicht gefunden");const{error:E}=await K.from("vacation_requests").insert({employee_id:N.id,start_date:d.startDate,end_date:d.endDate,days_requested:j,request_type:d.type,reason:d.reason||null,status:"pending",created_by:b.id});if(E)throw E;r({title:"Antrag eingereicht",description:`Ihr ${d.type==="vacation"?"Urlaubs":"Abwesenheits"}antrag wurde erfolgreich eingereicht`}),u({startDate:"",endDate:"",reason:"",type:"vacation"}),e(!1),n==null||n()}catch(b){console.error("Error submitting vacation request:",b),r({title:"Fehler",description:b.message||"Antrag konnte nicht eingereicht werden",variant:"destructive"})}finally{i(!1)}},v=f(d.startDate,d.endDate);return s.jsx(Kt,{open:t,onOpenChange:e,children:s.jsxs(Wt,{className:"max-w-md",children:[s.jsx(tn,{children:s.jsxs(nn,{className:"flex items-center gap-2",children:[s.jsx(At,{className:"h-5 w-5"}),"Urlaubsantrag stellen"]})}),s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{children:"Verfügbare Urlaubstage:"}),s.jsxs("span",{className:"font-semibold text-blue-600",children:[o," Tage"]})]})}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{children:"Art der Abwesenheit"}),s.jsxs("select",{value:d.type,onChange:w=>u(x=>({...x,type:w.target.value})),className:"w-full p-2 border rounded-md",children:[s.jsx("option",{value:"vacation",children:"Urlaub"}),s.jsx("option",{value:"sick",children:"Krankmeldung"}),s.jsx("option",{value:"personal",children:"Persönliche Angelegenheiten"})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"startDate",children:"Von"}),s.jsx(re,{id:"startDate",type:"date",value:d.startDate,onChange:w=>u(x=>({...x,startDate:w.target.value})),min:new Date().toISOString().split("T")[0],required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"endDate",children:"Bis"}),s.jsx(re,{id:"endDate",type:"date",value:d.endDate,onChange:w=>u(x=>({...x,endDate:w.target.value})),min:d.startDate||new Date().toISOString().split("T")[0],required:!0})]})]}),v>0&&s.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Pt,{className:"h-4 w-4"}),"Beantragte Tage:"]}),s.jsxs("span",{className:`font-semibold ${d.type==="vacation"&&v>o?"text-red-600":"text-green-600"}`,children:[v," ",v===1?"Tag":"Tage"]})]}),d.type==="vacation"&&v>o&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Nicht genügend Urlaubstage verfügbar"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(se,{htmlFor:"reason",children:["Begründung ",d.type!=="vacation"&&"(erforderlich)"]}),s.jsx(Cn,{id:"reason",value:d.reason,onChange:w=>u(x=>({...x,reason:w.target.value})),placeholder:d.type==="vacation"?"Optionale Begründung für den Urlaub...":"Bitte geben Sie eine Begründung an...",rows:3,required:d.type!=="vacation"})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsx(ne,{type:"submit",disabled:a||!d.startDate||!d.endDate,className:"flex-1",children:a?"Wird eingereicht...":"Antrag stellen"}),s.jsx(ne,{type:"button",variant:"outline",onClick:()=>e(!1),disabled:a,children:"Abbrechen"})]})]})]})})}function Pne(){const{user:t,userRole:e}=Vr(),{toast:n}=It(),[r,a]=g.useState([]),[i,o]=g.useState({total_days:0,used_days:0,pending_days:0,available_days:0}),[c,d]=g.useState(!0),[u,m]=g.useState(!1),[f,p]=g.useState("my-requests"),v=e==="manager"||e==="admin";g.useEffect(()=>{t&&w()},[t,f]);const w=async()=>{d(!0);try{await Promise.all([x(),y()])}catch(S){console.error("Error loading vacation data:",S)}finally{d(!1)}},x=async()=>{if(t)try{const{data:S}=await K.from("employees").select("vacation_days_total, vacation_days_used").eq("user_id",t.id).single();if(S){const{data:E}=await K.from("vacation_requests").select("days_requested").eq("employee_id",S.id).eq("status","pending").eq("request_type","vacation"),C=(E==null?void 0:E.reduce((I,D)=>I+D.days_requested,0))||0,P=S.vacation_days_total||0,R=S.vacation_days_used||0,H=Math.max(0,P-R-C);o({total_days:P,used_days:R,pending_days:C,available_days:H})}else{const{data:E}=await K.from("company_settings").select("default_vacation_days").single(),C=(E==null?void 0:E.default_vacation_days)||25;o({total_days:C,used_days:0,pending_days:0,available_days:C})}}catch(S){console.error("Error loading vacation balance:",S)}},y=async()=>{if(t)try{let S=K.from("vacation_requests").select(`
          id,
          employee_id,
          start_date,
          end_date,
          days_requested,
          request_type,
          reason,
          status,
          created_at,
          approved_by,
          approved_at,
          employees!inner(
            id,
            first_name,
            last_name,
            user_id
          )
        `).order("created_at",{ascending:!1});if(f==="my-requests"||!v){const{data:R}=await K.from("employees").select("id").eq("user_id",t.id).single();R&&(S=S.eq("employee_id",R.id))}const{data:E,error:C}=await S;if(C)throw C;const P=(E==null?void 0:E.map(R=>({id:R.id,employee_id:R.employee_id,employee_name:`${R.employees.first_name} ${R.employees.last_name}`,start_date:R.start_date,end_date:R.end_date,days_requested:R.days_requested,request_type:R.request_type,reason:R.reason,status:R.status,created_at:R.created_at,approved_by:R.approved_by,approved_at:R.approved_at})))||[];a(P)}catch(S){console.error("Error loading vacation requests:",S),n({title:"Fehler",description:"Urlaubsanträge konnten nicht geladen werden",variant:"destructive"})}},j=async(S,E)=>{const C=[...r];a(P=>P.filter(R=>R.id!==S));try{const P={status:E?"approved":"rejected",approved_by:t==null?void 0:t.id,approved_at:new Date().toISOString()},{error:R}=await K.from("vacation_requests").update(P).eq("id",S);if(R)throw a(C),R;if(E){const H=r.find(I=>I.id===S);if(H&&H.request_type==="vacation"){const{error:I}=await K.rpc("increment_vacation_days_used",{employee_id_param:H.employee_id,days_to_add:H.days_requested});I&&console.error("Error updating vacation days:",I)}}n({title:E?"Antrag genehmigt":"Antrag abgelehnt",description:`Der Urlaubsantrag wurde erfolgreich ${E?"genehmigt":"abgelehnt"}`}),setTimeout(()=>{w()},1e3)}catch(P){console.error("Error updating vacation request:",P),n({title:"Fehler",description:"Antrag konnte nicht aktualisiert werden",variant:"destructive"})}},b=S=>{switch(S){case"pending":return s.jsxs(Be,{className:"bg-yellow-500",children:[s.jsx(Am,{className:"h-3 w-3 mr-1"}),"Ausstehend"]});case"approved":return s.jsxs(Be,{className:"bg-green-500",children:[s.jsx(ls,{className:"h-3 w-3 mr-1"}),"Genehmigt"]});case"rejected":return s.jsxs(Be,{className:"bg-red-500",children:[s.jsx(So,{className:"h-3 w-3 mr-1"}),"Abgelehnt"]});default:return s.jsx(Be,{variant:"outline",children:S})}},N=S=>{switch(S){case"vacation":return"Urlaub";case"sick":return"Krankmeldung";case"personal":return"Persönlich";default:return S}};return c?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"text-muted-foreground",children:"Lade Urlaubsdaten..."})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-4xl font-bold bg-gradient-to-r from-slate-800 to-gray-600 bg-clip-text text-transparent flex items-center gap-3",children:[s.jsx(At,{className:"h-8 w-8 text-gray-600"}),"Urlaubsverwaltung"]}),s.jsx("p",{className:"text-muted-foreground",children:"Verwalten Sie Ihre Urlaubsanträge und Abwesenheiten"})]}),s.jsxs(ne,{onClick:()=>m(!0),children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Neuer Antrag"]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Pt,{className:"h-5 w-5"}),"Mein Urlaubskonto"]})}),s.jsx(de,{children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.total_days}),s.jsx("div",{className:"text-sm text-blue-700",children:"Gesamte Tage"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.available_days}),s.jsx("div",{className:"text-sm text-green-700",children:"Verfügbar"})]}),s.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.pending_days}),s.jsx("div",{className:"text-sm text-orange-700",children:"Ausstehend"})]}),s.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-gray-600",children:i.used_days}),s.jsx("div",{className:"text-sm text-gray-700",children:"Verbraucht"})]})]})})]}),v&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx(ne,{variant:f==="my-requests"?"default":"outline",onClick:()=>p("my-requests"),children:"Meine Anträge"}),s.jsx(ne,{variant:f==="all-requests"?"default":"outline",onClick:()=>p("all-requests"),children:"Alle Anträge"})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(Ds,{className:"h-5 w-5"}),f==="all-requests"?"Alle Urlaubsanträge":"Meine Urlaubsanträge"]})}),s.jsx(de,{children:r.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(At,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Keine Anträge"}),s.jsx("p",{className:"text-gray-500",children:f==="all-requests"?"Es sind keine Urlaubsanträge vorhanden":"Sie haben noch keine Urlaubsanträge gestellt"})]}):s.jsx("div",{className:"space-y-4",children:r.map(S=>s.jsxs("div",{className:"border rounded-lg p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h4",{className:"font-semibold",children:f==="all-requests"?S.employee_name:N(S.request_type)}),b(S.status)]}),s.jsxs("div",{className:"text-sm text-gray-600",children:[new Date(S.start_date).toLocaleDateString("de-DE")," - "," ",new Date(S.end_date).toLocaleDateString("de-DE")," (",S.days_requested," ",S.days_requested===1?"Tag":"Tage",")"]})]}),s.jsx("div",{className:"text-xs text-gray-500",children:new Date(S.created_at).toLocaleDateString("de-DE")})]}),S.reason&&s.jsx("div",{className:"mb-3",children:s.jsx("p",{className:"text-sm text-gray-700",children:S.reason})}),v&&f==="all-requests"&&S.status==="pending"&&s.jsxs("div",{className:"flex gap-2 mt-3",children:[s.jsxs(ne,{size:"sm",onClick:()=>j(S.id,!0),className:"bg-green-600 hover:bg-green-700",children:[s.jsx(ls,{className:"h-4 w-4 mr-1"}),"Genehmigen"]}),s.jsxs(ne,{size:"sm",variant:"outline",onClick:E=>{E.preventDefault(),E.stopPropagation(),j(S.id,!1)},className:"border-red-600 text-red-600 hover:bg-red-50",children:[s.jsx(So,{className:"h-4 w-4 mr-1"}),"Ablehnen"]})]}),S.approved_at&&s.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[S.status==="approved"?"Genehmigt":"Abgelehnt"," am"," ",new Date(S.approved_at).toLocaleDateString("de-DE")]})]},S.id))})})]}),s.jsx(GI,{open:u,onOpenChange:m,onSuccess:w})]})}class Dne{async createOrderFromQuote(e){try{console.log("🔄 Creating order from quote:",e);const{data:n,error:r}=await K.from("quotes").select("*").eq("id",e).single();if(r||!n)throw new Error("Angebot nicht gefunden");const a={order_number:`AUF-${Date.now().toString().slice(-6)}`,customer_id:n.customer_id,title:n.title||"Auftrag aus Angebot",description:n.description,order_date:new Date().toISOString().split("T")[0],due_date:n.valid_until||null,status:"confirmed",priority:"medium",total_amount:n.total_amount,currency:n.currency||"EUR",notes:`Automatisch erstellt aus Angebot ${n.quote_number}`,workflow_origin_type:"quote",workflow_origin_id:e},{data:i,error:o}=await K.from("orders").insert(a).select().single();if(o)throw o;return await K.from("quotes").update({status:"accepted",workflow_target_type:"order",workflow_target_id:i.id}).eq("id",e),await this.createOrUpdateWorkflowChain({quoteId:e,orderId:i.id,currentStep:"order",customerId:n.customer_id,metadata:{title:n.title||"Neuer Workflow",totalAmount:n.total_amount,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}),Oa({title:"Auftrag erstellt",description:`Auftrag ${a.order_number} wurde erfolgreich aus dem Angebot erstellt.`}),i.id}catch(n){return console.error("❌ Error creating order from quote:",n),Oa({title:"Fehler",description:"Auftrag konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async createProjectFromOrder(e){try{console.log("🔄 Creating project from order:",e);const{data:n,error:r}=await K.from("orders").select("*, customers(company_name)").eq("id",e).single();if(r||!n)throw new Error("Auftrag nicht gefunden");const{data:a}=await K.auth.getUser();if(!(a!=null&&a.user))throw new Error("Benutzer nicht authentifiziert");const{data:i}=await K.from("profiles").select("company_id").eq("id",a.user.id).single();if(!(i!=null&&i.company_id))throw new Error("Firma nicht gefunden");const o={name:n.title,customer_id:n.customer_id,company_id:i.company_id,status:"geplant",start_date:new Date().toISOString().split("T")[0],end_date:n.due_date||null,location:null,budget:n.total_amount||0,description:`Automatisch erstellt aus Auftrag ${n.order_number}. ${n.description||""}`,workflow_origin_type:"order",workflow_origin_id:e},{data:c,error:d}=await K.from("projects").insert(o).select().single();if(d)throw d;await K.from("orders").update({status:"in_progress",workflow_target_type:"project",workflow_target_id:c.id}).eq("id",e);const u=await this.getWorkflowChain(e,"order");return u&&await this.createOrUpdateWorkflowChain({...u,projectId:c.id,currentStep:"project"}),Oa({title:"Projekt erstellt",description:`Projekt "${n.title}" wurde erfolgreich aus dem Auftrag erstellt.`}),c.id}catch(n){return console.error("❌ Error creating project from order:",n),Oa({title:"Fehler",description:"Projekt konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async createInvoiceFromProject(e){try{console.log("🔄 Creating invoice from project:",e);const{data:n,error:r}=await K.from("projects").select("*, customers(company_name, address)").eq("id",e).single();if(r||!n)throw new Error("Projekt nicht gefunden");if(n.status!=="abgeschlossen")throw new Error("Rechnung kann nur für abgeschlossene Projekte erstellt werden");const a={invoice_number:`RG-${Date.now().toString().slice(-6)}`,customer_id:n.customer_id,issue_date:new Date().toISOString().split("T")[0],due_date:new Date(Date.now()+14*24*60*60*1e3).toISOString().split("T")[0],status:"draft",total_amount:n.budget||0,currency:"EUR",description:`Rechnung für Projekt: ${n.name}`,notes:`Automatisch erstellt aus Projekt ${n.name}`,workflow_origin_type:"project",workflow_origin_id:e},{data:i,error:o}=await K.from("invoices").insert(a).select().single();if(o)throw o;await K.from("projects").update({workflow_target_type:"invoice",workflow_target_id:i.id}).eq("id",e);const c=await this.getWorkflowChain(e,"project");return c&&await this.createOrUpdateWorkflowChain({...c,invoiceId:i.id,currentStep:"invoice"}),Oa({title:"Rechnung erstellt",description:`Rechnungsentwurf ${a.invoice_number} wurde erfolgreich erstellt.`}),i.id}catch(n){return console.error("❌ Error creating invoice from project:",n),Oa({title:"Fehler",description:"Rechnung konnte nicht erstellt werden: "+n.message,variant:"destructive"}),null}}async checkBudgetWarnings(){try{const{data:e}=await K.from("projects").select("*").in("status",["geplant","in_bearbeitung"]),n=[];for(const r of e||[])if(r.budget&&r.budget>0){const a=r.budget*.95,i=a/r.budget*100;i>=90&&n.push({projectId:r.id,projectName:r.name,budget:r.budget,usedBudget:a,usagePercentage:i,type:"budget_warning"})}return n}catch(e){return console.error("❌ Error checking budget warnings:",e),[]}}async createOrUpdateWorkflowChain(e){try{const n={quote_id:e.quoteId||null,order_id:e.orderId||null,project_id:e.projectId||null,invoice_id:e.invoiceId||null,current_step:e.currentStep,customer_id:e.customerId,metadata:e.metadata,updated_at:new Date().toISOString()},r=K.from("workflow_chains").select("id");e.quoteId?r.eq("quote_id",e.quoteId):e.orderId?r.eq("order_id",e.orderId):e.projectId&&r.eq("project_id",e.projectId);const{data:a}=await r.single();a?await K.from("workflow_chains").update(n).eq("id",a.id):await K.from("workflow_chains").insert({...n,created_at:new Date().toISOString()})}catch(n){console.error("❌ Error managing workflow chain:",n)}}async getWorkflowChain(e,n){try{const r=`${n}_id`,{data:a}=await K.from("workflow_chains").select("*").eq(r,e).single();return a?{quoteId:a.quote_id,orderId:a.order_id,projectId:a.project_id,invoiceId:a.invoice_id,currentStep:a.current_step,customerId:a.customer_id,metadata:a.metadata}:null}catch(r){return console.error("❌ Error getting workflow chain:",r),null}}async getDashboardCriticalData(){try{const[e,n,r,a]=await Promise.all([this.checkBudgetWarnings(),this.getPendingQuotes(),this.getDelayedProjects(),this.getOverdueInvoices()]);return{overdueTasks:[...e,...r],budgetWarnings:e,pendingQuotes:n,delayedProjects:r,overdueInvoices:a}}catch(e){return console.error("❌ Error getting dashboard critical data:",e),{overdueTasks:[],budgetWarnings:[],pendingQuotes:[],delayedProjects:[],overdueInvoices:[]}}}async getPendingQuotes(){const{data:e}=await K.from("quotes").select("*, customers(company_name)").eq("status","pending").order("created_at",{ascending:!1});return e||[]}async getDelayedProjects(){const{data:e}=await K.from("projects").select("*").in("status",["geplant","in_bearbeitung"]).lt("end_date",new Date().toISOString().split("T")[0]);return e||[]}async getOverdueInvoices(){const{data:e}=await K.from("invoices").select("*, customers(company_name)").eq("status","sent").lt("due_date",new Date().toISOString().split("T")[0]);return e||[]}async applyScheduleWithApproval(e){var n;return await FT("aiScheduleApply",{reason:"KI-Planung soll auf den Kalender angewendet werden.",metadata:{projectId:e.projectId,employeeCount:((n=e.employeeAssignments)==null?void 0:n.length)||0},userId:e.userId},async()=>(console.log("Applying AI schedule:",e),e))}}const Tne=new Dne,Mne=({onNavigate:t})=>{const[e,n]=g.useState({criticalAlerts:{budgetWarnings:0,overdueProjects:0,overdueInvoices:0,pendingQuotes:0},financialKPIs:{monthlyRevenue:0,monthlyExpenses:0,profit:0,profitMargin:0,outstandingAmount:0,revenuetrend:0},projectStatus:{active:0,planning:0,completed:0,delayed:0},teamOverview:{activeEmployees:0,todayHours:0,utilizationRate:0}}),[r,a]=g.useState(!0),[i,o]=g.useState([]),{toast:c}=It();g.useEffect(()=>{d();const x=setInterval(d,5*60*1e3);return()=>clearInterval(x)},[]);const d=async()=>{try{a(!0);const[x,y,j,b]=await Promise.all([Tne.getDashboardCriticalData(),u(),m(),f()]);o(x.overdueTasks),n({criticalAlerts:{budgetWarnings:x.budgetWarnings.length,overdueProjects:x.delayedProjects.length,overdueInvoices:x.overdueInvoices.length,pendingQuotes:x.pendingQuotes.length},financialKPIs:j,projectStatus:y,teamOverview:b})}catch(x){console.error("❌ Error loading dashboard data:",x),c({title:"Fehler beim Laden",description:"Dashboard-Daten konnten nicht geladen werden.",variant:"destructive"})}finally{a(!1)}},u=async()=>{const{data:x}=await K.from("projects").select("status, end_date"),y=new Date().toISOString().split("T")[0],j={active:0,planning:0,completed:0,delayed:0};return x==null||x.forEach(b=>{switch(b.status){case"in_bearbeitung":j.active++;break;case"geplant":case"anfrage":case"besichtigung":j.planning++;break;case"abgeschlossen":j.completed++;break}b.end_date&&b.end_date<y&&b.status!=="abgeschlossen"&&j.delayed++}),j},m=async()=>({monthlyRevenue:45e3,monthlyExpenses:32e3,profit:13e3,profitMargin:28.9,outstandingAmount:8500,revenuetrend:12.5}),f=async()=>{const{data:x}=await K.from("employees").select("status").neq("status","eingeladen");return{activeEmployees:(x==null?void 0:x.length)||0,todayHours:67.5,utilizationRate:85}},p=[{id:"new-quote",title:"Neues Angebot",description:"Angebot für Kunden erstellen",icon:wn,color:"bg-blue-500",onClick:()=>t==null?void 0:t("finance")},{id:"new-project",title:"Projekt anlegen",description:"Direktes Projekt erstellen",icon:Hr,color:"bg-green-500",onClick:()=>t==null?void 0:t("projects")},{id:"check-finances",title:"Finanzen prüfen",description:"Rechnungen und Ausgaben",icon:mr,color:"bg-purple-500",onClick:()=>t==null?void 0:t("finance")},{id:"team-overview",title:"Team Status",description:"Mitarbeiter und Zeiten",icon:Br,color:"bg-orange-500",onClick:()=>t==null?void 0:t("personal")}],v=x=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(x),w=()=>Object.values(e.criticalAlerts).reduce((x,y)=>x+y,0);return r?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.jsxs("div",{className:"space-y-6 animate-fadeIn p-6 bg-gray-50 min-h-screen",children:[s.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),s.jsx("p",{className:"text-gray-600",children:"Zentrale Übersicht Ihres Handwerksbetriebs"})]}),w()>0&&s.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-red-50 border border-red-100 rounded-xl",children:[s.jsx(Jn,{className:"h-5 w-5 text-red-500"}),s.jsxs("span",{className:"text-red-700 font-medium",children:[w()," Punkte benötigen Aufmerksamkeit"]})]})]})}),s.jsxs(bI,{children:[s.jsx(go,{title:"Offene Aufträge",value:e.projectStatus.active+e.projectStatus.planning,valueClassName:"text-blue-600"}),s.jsx(go,{title:"Monatsumsatz",value:v(e.financialKPIs.monthlyRevenue),valueClassName:"text-green-600"}),s.jsx(go,{title:"Offene Angebote",value:e.criticalAlerts.pendingQuotes,valueClassName:"text-orange-600"}),s.jsx(go,{title:"Mitarbeiter",value:e.teamOverview.activeEmployees,valueClassName:"text-purple-600"})]}),s.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[s.jsxs("div",{className:"col-span-8 space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[s.jsx("div",{className:"p-6 border-b border-gray-100",children:s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Finanzübersicht"})}),s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Umsatz"}),s.jsx("div",{className:"text-2xl font-bold text-green-600",children:v(e.financialKPIs.monthlyRevenue)})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Gewinn"}),s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:v(e.financialKPIs.profit)})]})]}),s.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-xl",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-gray-700",children:"Gewinnmarge"}),s.jsxs("span",{className:"font-semibold text-gray-900",children:[e.financialKPIs.profitMargin,"%"]})]})})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[s.jsx("div",{className:"p-6 border-b border-gray-100",children:s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Schnellaktionen"})}),s.jsx("div",{className:"p-6",children:s.jsx("div",{className:"grid grid-cols-2 gap-4",children:p.map(x=>s.jsxs("button",{onClick:x.onClick,className:"flex items-center gap-4 p-4 border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors text-left",children:[s.jsx("div",{className:`p-3 rounded-lg ${x.color}`,children:s.jsx(x.icon,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:x.title}),s.jsx("div",{className:"text-sm text-gray-500",children:x.description})]})]},x.id))})})]})]}),s.jsxs("div",{className:"col-span-4 space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Projektstatus"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Anfrage"})]}),s.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.planning})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"In Bearbeitung"})]}),s.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.active})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-400"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Abgeschlossen"})]}),s.jsx("span",{className:"text-sm font-medium",children:e.projectStatus.completed})]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Team Übersicht"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-700",children:"Aktive Mitarbeiter"}),s.jsx("span",{className:"font-medium",children:e.teamOverview.activeEmployees})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-700",children:"Stunden heute"}),s.jsxs("span",{className:"font-medium",children:[e.teamOverview.todayHours,"h"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-700",children:"Auslastung"}),s.jsxs("span",{className:"font-medium",children:[e.teamOverview.utilizationRate,"%"]})]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Heute"}),s.jsx("div",{className:"text-center py-4",children:s.jsx("p",{className:"text-gray-500",children:"Keine Termine für heute"})})]})]})]}),s.jsxs(es,{defaultValue:"kpis",className:"w-full hidden",children:[s.jsxs(Hn,{className:"grid w-full grid-cols-5",children:[s.jsx(He,{value:"kpis",children:"Kennzahlen"}),s.jsx(He,{value:"overview",children:"Übersicht"}),s.jsx(He,{value:"financial",children:"Finanzen"}),s.jsx(He,{value:"projects",children:"Projekte"}),s.jsx(He,{value:"actions",children:"Schnellaktionen"})]}),s.jsxs(We,{value:"kpis",className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"📊 Aktuelle Kennzahlen"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[s.jsx(oe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("projects"),children:s.jsxs(de,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx($h,{className:"w-5 h-5 text-blue-600"}),s.jsx("span",{className:"font-medium",children:"Offene Aufträge"})]}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active+e.projectStatus.planning}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"in Bearbeitung"})]})}),s.jsx(oe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("emails"),children:s.jsxs(de,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(os,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"font-medium",children:"Ungelesene E-Mails"})]}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:"0"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"neue Anfragen"})]})}),s.jsx(oe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("finance"),children:s.jsxs(de,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(wn,{className:"w-5 h-5 text-orange-600"}),s.jsx("span",{className:"font-medium",children:"Offene Angebote"})]}),s.jsx("p",{className:"text-2xl font-bold text-orange-600",children:e.criticalAlerts.pendingQuotes}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"versendet"})]})}),s.jsx(oe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("finance"),children:s.jsxs(de,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(mr,{className:"w-5 h-5 text-red-600"}),s.jsx("span",{className:"font-medium",children:"Offene Rechnungen"})]}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:e.criticalAlerts.overdueInvoices}),s.jsx("p",{className:"text-sm text-muted-foreground",children:v(e.financialKPIs.outstandingAmount)})]})}),s.jsx(oe,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>t==null?void 0:t("timetracking"),children:s.jsxs(de,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Pt,{className:"w-5 h-5 text-purple-600"}),s.jsx("span",{className:"font-medium",children:"Stunden heute"})]}),s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:e.teamOverview.todayHours}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"gearbeitet"})]})})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold mb-4",children:"📅 Heute / Nächste Termine"}),s.jsx(oe,{children:s.jsx(de,{className:"p-4",children:s.jsx("p",{className:"text-muted-foreground",children:"Keine Termine für heute"})})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-3",children:"👥 Mitarbeiterübersicht"}),s.jsx(oe,{children:s.jsx(de,{className:"p-3",children:s.jsx("div",{className:"space-y-2",children:e.teamOverview.activeEmployees>0?s.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/30 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500"}),s.jsxs("span",{className:"font-medium text-sm",children:[e.teamOverview.activeEmployees," Mitarbeiter"]})]}),s.jsx(ne,{variant:"outline",size:"sm",onClick:()=>t==null?void 0:t("timetracking"),children:"Zeitbericht"})]}):s.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine aktiven Mitarbeiter"})})})})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-lg font-semibold mb-3",children:"📨 Letzte E-Mails / Kundenanfragen"}),s.jsx(oe,{children:s.jsx(de,{className:"p-3",children:s.jsx("p",{className:"text-sm text-muted-foreground",children:"Keine neuen E-Mails"})})})]})]})]}),s.jsxs(We,{value:"overview",className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx(oe,{children:s.jsx(de,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Monatsumsatz"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:v(e.financialKPIs.monthlyRevenue)})]}),s.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[s.jsx(Ei,{className:"h-4 w-4"}),s.jsxs("span",{className:"text-sm font-medium",children:["+",e.financialKPIs.revenuetrend,"%"]})]})]})})}),s.jsx(oe,{children:s.jsx(de,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Gewinn"}),s.jsx("p",{className:"text-2xl font-bold",children:v(e.financialKPIs.profit)})]}),s.jsxs(Be,{className:"bg-blue-100 text-blue-800",children:[e.financialKPIs.profitMargin,"%"]})]})})}),s.jsx(oe,{children:s.jsx(de,{className:"p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Aktive Projekte"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active})]}),s.jsx(Hr,{className:"h-8 w-8 text-blue-600"})]})})}),s.jsx(oe,{children:s.jsxs(de,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Team Auslastung"}),s.jsxs("p",{className:"text-2xl font-bold",children:[e.teamOverview.utilizationRate,"%"]})]}),s.jsx(Br,{className:"h-8 w-8 text-purple-600"})]}),s.jsx(zo,{value:e.teamOverview.utilizationRate,className:"mt-2"})]})})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Projekt-Pipeline"})}),s.jsx(de,{children:s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center p-4 bg-yellow-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:e.projectStatus.planning}),s.jsx("div",{className:"text-sm text-yellow-700",children:"In Planung"})]}),s.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.projectStatus.active}),s.jsx("div",{className:"text-sm text-blue-700",children:"In Bearbeitung"})]}),s.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.projectStatus.completed}),s.jsx("div",{className:"text-sm text-green-700",children:"Abgeschlossen"})]}),s.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.projectStatus.delayed}),s.jsx("div",{className:"text-sm text-red-700",children:"Verspätet"})]})]})})]})]}),s.jsx(We,{value:"financial",className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Finanzielle Kennzahlen"})}),s.jsxs(de,{className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Umsatz"}),s.jsx("span",{className:"font-bold text-green-600",children:v(e.financialKPIs.monthlyRevenue)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Ausgaben"}),s.jsx("span",{className:"font-bold text-red-600",children:v(e.financialKPIs.monthlyExpenses)})]}),s.jsxs("div",{className:"flex justify-between items-center pt-2 border-t",children:[s.jsx("span",{className:"font-semibold",children:"Gewinn"}),s.jsx("span",{className:"font-bold text-lg",children:v(e.financialKPIs.profit)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{children:"Gewinnmarge"}),s.jsxs("span",{className:"font-bold",children:[e.financialKPIs.profitMargin,"%"]})]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Ausstehende Beträge"})}),s.jsxs(de,{children:[s.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:v(e.financialKPIs.outstandingAmount)}),s.jsx("p",{className:"text-sm text-gray-600",children:"Noch nicht bezahlte Rechnungen"}),s.jsxs(ne,{variant:"outline",className:"mt-4 w-full",onClick:()=>t==null?void 0:t("finance"),children:[s.jsx(mr,{className:"h-4 w-4 mr-2"}),"Rechnungen verwalten"]})]})]})]})}),s.jsx(We,{value:"projects",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsx(je,{children:s.jsx(Ne,{children:"Projekt-Status Details"})}),s.jsx(de,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),s.jsx("span",{children:"Projekte in Planung"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-bold",children:e.projectStatus.planning}),s.jsx(ne,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:s.jsx(Lr,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),s.jsx("span",{children:"Aktive Projekte"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-bold",children:e.projectStatus.active}),s.jsx(ne,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:s.jsx(Lr,{className:"h-4 w-4"})})]})]}),e.projectStatus.delayed>0&&s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-red-50",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Jn,{className:"h-5 w-5 text-red-600"}),s.jsx("span",{className:"text-red-700",children:"Verspätete Projekte"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-bold text-red-600",children:e.projectStatus.delayed}),s.jsx(ne,{variant:"ghost",size:"sm",onClick:()=>t==null?void 0:t("projects"),children:s.jsx(Lr,{className:"h-4 w-4"})})]})]})]})})]})}),s.jsx(We,{value:"actions",className:"space-y-6",children:s.jsxs(oe,{children:[s.jsx(je,{children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx(h0,{className:"h-5 w-5 text-yellow-500"}),"Schnellaktionen"]})}),s.jsx(de,{children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:p.map(x=>s.jsxs(ne,{variant:"outline",className:"h-auto p-4 justify-start",onClick:x.onClick,children:[s.jsx("div",{className:`p-2 rounded-lg ${x.color} mr-4`,children:s.jsx(x.icon,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{className:"text-left",children:[s.jsx("div",{className:"font-semibold",children:x.title}),s.jsx("div",{className:"text-sm text-gray-500",children:x.description})]}),s.jsx(nj,{className:"h-4 w-4 ml-auto"})]},x.id))})})]})})]})]})};var eb=["Enter"," "],Rne=["ArrowDown","PageUp","Home"],QI=["ArrowUp","PageDown","End"],Ine=[...Rne,...QI],One={ltr:[...eb,"ArrowRight"],rtl:[...eb,"ArrowLeft"]},Lne={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Ym="Menu",[fm,Fne,Bne]=km(Ym),[lc,YI]=kr(Ym,[Bne,Ho,Bg]),ux=Ho(),XI=Bg(),[zne,cc]=lc(Ym),[$ne,Xm]=lc(Ym),JI=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:a,onOpenChange:i,modal:o=!0}=t,c=ux(e),[d,u]=g.useState(null),m=g.useRef(!1),f=_n(i),p=ru(a);return g.useEffect(()=>{const v=()=>{m.current=!0,document.addEventListener("pointerdown",w,{capture:!0,once:!0}),document.addEventListener("pointermove",w,{capture:!0,once:!0})},w=()=>m.current=!1;return document.addEventListener("keydown",v,{capture:!0}),()=>{document.removeEventListener("keydown",v,{capture:!0}),document.removeEventListener("pointerdown",w,{capture:!0}),document.removeEventListener("pointermove",w,{capture:!0})}},[]),s.jsx(gj,{...c,children:s.jsx(zne,{scope:e,open:n,onOpenChange:f,content:d,onContentChange:u,children:s.jsx($ne,{scope:e,onClose:g.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:m,dir:p,modal:o,children:r})})})};JI.displayName=Ym;var Une="MenuAnchor",$1=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,a=ux(n);return s.jsx(Tm,{...a,...r,ref:e})});$1.displayName=Une;var U1="MenuPortal",[qne,e5]=lc(U1,{forceMount:void 0}),t5=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:a}=t,i=cc(U1,e);return s.jsx(qne,{scope:e,forceMount:n,children:s.jsx(ts,{present:n||i.open,children:s.jsx(Vd,{asChild:!0,container:a,children:r})})})};t5.displayName=U1;var zr="MenuContent",[Hne,q1]=lc(zr),n5=g.forwardRef((t,e)=>{const n=e5(zr,t.__scopeMenu),{forceMount:r=n.forceMount,...a}=t,i=cc(zr,t.__scopeMenu),o=Xm(zr,t.__scopeMenu);return s.jsx(fm.Provider,{scope:t.__scopeMenu,children:s.jsx(ts,{present:r||i.open,children:s.jsx(fm.Slot,{scope:t.__scopeMenu,children:o.modal?s.jsx(Wne,{...a,ref:e}):s.jsx(Vne,{...a,ref:e})})})})}),Wne=g.forwardRef((t,e)=>{const n=cc(zr,t.__scopeMenu),r=g.useRef(null),a=Rt(e,r);return g.useEffect(()=>{const i=r.current;if(i)return ex(i)},[]),s.jsx(H1,{...t,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Oe(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Vne=g.forwardRef((t,e)=>{const n=cc(zr,t.__scopeMenu);return s.jsx(H1,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),H1=g.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:c,onEntryFocus:d,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:f,onInteractOutside:p,onDismiss:v,disableOutsideScroll:w,...x}=t,y=cc(zr,n),j=Xm(zr,n),b=ux(n),N=XI(n),S=Fne(n),[E,C]=g.useState(null),P=g.useRef(null),R=Rt(e,P,y.onContentChange),H=g.useRef(0),I=g.useRef(""),D=g.useRef(0),W=g.useRef(null),V=g.useRef("right"),G=g.useRef(0),Y=w?Um:g.Fragment,X=w?{as:Ci,allowPinchZoom:!0}:void 0,F=q=>{var Q,le;const U=I.current+q,B=S().filter(pe=>!pe.disabled),O=document.activeElement,z=(Q=B.find(pe=>pe.ref.current===O))==null?void 0:Q.textValue,$=B.map(pe=>pe.textValue),te=rse($,U,z),ee=(le=B.find(pe=>pe.textValue===te))==null?void 0:le.ref.current;(function pe(J){I.current=J,window.clearTimeout(H.current),J!==""&&(H.current=window.setTimeout(()=>pe(""),1e3))})(U),ee&&setTimeout(()=>ee.focus())};g.useEffect(()=>()=>window.clearTimeout(H.current),[]),Xg();const T=g.useCallback(q=>{var B,O;return V.current===((B=W.current)==null?void 0:B.side)&&ise(q,(O=W.current)==null?void 0:O.area)},[]);return s.jsx(Hne,{scope:n,searchRef:I,onItemEnter:g.useCallback(q=>{T(q)&&q.preventDefault()},[T]),onItemLeave:g.useCallback(q=>{var U;T(q)||((U=P.current)==null||U.focus(),C(null))},[T]),onTriggerLeave:g.useCallback(q=>{T(q)&&q.preventDefault()},[T]),pointerGraceTimerRef:D,onPointerGraceIntentChange:g.useCallback(q=>{W.current=q},[]),children:s.jsx(Y,{...X,children:s.jsx($m,{asChild:!0,trapped:a,onMountAutoFocus:Oe(i,q=>{var U;q.preventDefault(),(U=P.current)==null||U.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:s.jsx(Jl,{asChild:!0,disableOutsidePointerEvents:c,onEscapeKeyDown:u,onPointerDownOutside:m,onFocusOutside:f,onInteractOutside:p,onDismiss:v,children:s.jsx(iT,{asChild:!0,...N,dir:j.dir,orientation:"vertical",loop:r,currentTabStopId:E,onCurrentTabStopIdChange:C,onEntryFocus:Oe(d,q=>{j.isUsingKeyboardRef.current||q.preventDefault()}),preventScrollOnEntryFocus:!0,children:s.jsx(Sg,{role:"menu","aria-orientation":"vertical","data-state":v5(y.open),"data-radix-menu-content":"",dir:j.dir,...b,...x,ref:R,style:{outline:"none",...x.style},onKeyDown:Oe(x.onKeyDown,q=>{const B=q.target.closest("[data-radix-menu-content]")===q.currentTarget,O=q.ctrlKey||q.altKey||q.metaKey,z=q.key.length===1;B&&(q.key==="Tab"&&q.preventDefault(),!O&&z&&F(q.key));const $=P.current;if(q.target!==$||!Ine.includes(q.key))return;q.preventDefault();const ee=S().filter(Q=>!Q.disabled).map(Q=>Q.ref.current);QI.includes(q.key)&&ee.reverse(),nse(ee)}),onBlur:Oe(t.onBlur,q=>{q.currentTarget.contains(q.target)||(window.clearTimeout(H.current),I.current="")}),onPointerMove:Oe(t.onPointerMove,pm(q=>{const U=q.target,B=G.current!==q.clientX;if(q.currentTarget.contains(U)&&B){const O=q.clientX>G.current?"right":"left";V.current=O,G.current=q.clientX}}))})})})})})})});n5.displayName=zr;var Kne="MenuGroup",W1=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return s.jsx(tt.div,{role:"group",...r,ref:e})});W1.displayName=Kne;var Zne="MenuLabel",s5=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return s.jsx(tt.div,{...r,ref:e})});s5.displayName=Zne;var G0="MenuItem",oE="menu.itemSelect",hx=g.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...a}=t,i=g.useRef(null),o=Xm(G0,t.__scopeMenu),c=q1(G0,t.__scopeMenu),d=Rt(e,i),u=g.useRef(!1),m=()=>{const f=i.current;if(!n&&f){const p=new CustomEvent(oE,{bubbles:!0,cancelable:!0});f.addEventListener(oE,v=>r==null?void 0:r(v),{once:!0}),Xb(f,p),p.defaultPrevented?u.current=!1:o.onClose()}};return s.jsx(r5,{...a,ref:d,disabled:n,onClick:Oe(t.onClick,m),onPointerDown:f=>{var p;(p=t.onPointerDown)==null||p.call(t,f),u.current=!0},onPointerUp:Oe(t.onPointerUp,f=>{var p;u.current||(p=f.currentTarget)==null||p.click()}),onKeyDown:Oe(t.onKeyDown,f=>{const p=c.searchRef.current!=="";n||p&&f.key===" "||eb.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});hx.displayName=G0;var r5=g.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...i}=t,o=q1(G0,n),c=XI(n),d=g.useRef(null),u=Rt(e,d),[m,f]=g.useState(!1),[p,v]=g.useState("");return g.useEffect(()=>{const w=d.current;w&&v((w.textContent??"").trim())},[i.children]),s.jsx(fm.ItemSlot,{scope:n,disabled:r,textValue:a??p,children:s.jsx(oT,{asChild:!0,...c,focusable:!r,children:s.jsx(tt.div,{role:"menuitem","data-highlighted":m?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:u,onPointerMove:Oe(t.onPointerMove,pm(w=>{r?o.onItemLeave(w):(o.onItemEnter(w),w.defaultPrevented||w.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Oe(t.onPointerLeave,pm(w=>o.onItemLeave(w))),onFocus:Oe(t.onFocus,()=>f(!0)),onBlur:Oe(t.onBlur,()=>f(!1))})})})}),Gne="MenuCheckboxItem",a5=g.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...a}=t;return s.jsx(d5,{scope:t.__scopeMenu,checked:n,children:s.jsx(hx,{role:"menuitemcheckbox","aria-checked":Q0(n)?"mixed":n,...a,ref:e,"data-state":K1(n),onSelect:Oe(a.onSelect,()=>r==null?void 0:r(Q0(n)?!0:!n),{checkForDefaultPrevented:!1})})})});a5.displayName=Gne;var i5="MenuRadioGroup",[Qne,Yne]=lc(i5,{value:void 0,onValueChange:()=>{}}),o5=g.forwardRef((t,e)=>{const{value:n,onValueChange:r,...a}=t,i=_n(r);return s.jsx(Qne,{scope:t.__scopeMenu,value:n,onValueChange:i,children:s.jsx(W1,{...a,ref:e})})});o5.displayName=i5;var l5="MenuRadioItem",c5=g.forwardRef((t,e)=>{const{value:n,...r}=t,a=Yne(l5,t.__scopeMenu),i=n===a.value;return s.jsx(d5,{scope:t.__scopeMenu,checked:i,children:s.jsx(hx,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":K1(i),onSelect:Oe(r.onSelect,()=>{var o;return(o=a.onValueChange)==null?void 0:o.call(a,n)},{checkForDefaultPrevented:!1})})})});c5.displayName=l5;var V1="MenuItemIndicator",[d5,Xne]=lc(V1,{checked:!1}),u5=g.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...a}=t,i=Xne(V1,n);return s.jsx(ts,{present:r||Q0(i.checked)||i.checked===!0,children:s.jsx(tt.span,{...a,ref:e,"data-state":K1(i.checked)})})});u5.displayName=V1;var Jne="MenuSeparator",h5=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return s.jsx(tt.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});h5.displayName=Jne;var ese="MenuArrow",m5=g.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,a=ux(n);return s.jsx(kg,{...a,...r,ref:e})});m5.displayName=ese;var tse="MenuSub",[Fae,f5]=lc(tse),Ju="MenuSubTrigger",p5=g.forwardRef((t,e)=>{const n=cc(Ju,t.__scopeMenu),r=Xm(Ju,t.__scopeMenu),a=f5(Ju,t.__scopeMenu),i=q1(Ju,t.__scopeMenu),o=g.useRef(null),{pointerGraceTimerRef:c,onPointerGraceIntentChange:d}=i,u={__scopeMenu:t.__scopeMenu},m=g.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return g.useEffect(()=>m,[m]),g.useEffect(()=>{const f=c.current;return()=>{window.clearTimeout(f),d(null)}},[c,d]),s.jsx($1,{asChild:!0,...u,children:s.jsx(r5,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":v5(n.open),...t,ref:xg(e,a.onTriggerChange),onClick:f=>{var p;(p=t.onClick)==null||p.call(t,f),!(t.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Oe(t.onPointerMove,pm(f=>{i.onItemEnter(f),!f.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),m()},100))})),onPointerLeave:Oe(t.onPointerLeave,pm(f=>{var v,w;m();const p=(v=n.content)==null?void 0:v.getBoundingClientRect();if(p){const x=(w=n.content)==null?void 0:w.dataset.side,y=x==="right",j=y?-5:5,b=p[y?"left":"right"],N=p[y?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+j,y:f.clientY},{x:b,y:p.top},{x:N,y:p.top},{x:N,y:p.bottom},{x:b,y:p.bottom}],side:x}),window.clearTimeout(c.current),c.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Oe(t.onKeyDown,f=>{var v;const p=i.searchRef.current!=="";t.disabled||p&&f.key===" "||One[r.dir].includes(f.key)&&(n.onOpenChange(!0),(v=n.content)==null||v.focus(),f.preventDefault())})})})});p5.displayName=Ju;var g5="MenuSubContent",x5=g.forwardRef((t,e)=>{const n=e5(zr,t.__scopeMenu),{forceMount:r=n.forceMount,...a}=t,i=cc(zr,t.__scopeMenu),o=Xm(zr,t.__scopeMenu),c=f5(g5,t.__scopeMenu),d=g.useRef(null),u=Rt(e,d);return s.jsx(fm.Provider,{scope:t.__scopeMenu,children:s.jsx(ts,{present:r||i.open,children:s.jsx(fm.Slot,{scope:t.__scopeMenu,children:s.jsx(H1,{id:c.contentId,"aria-labelledby":c.triggerId,...a,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:m=>{var f;o.isUsingKeyboardRef.current&&((f=d.current)==null||f.focus()),m.preventDefault()},onCloseAutoFocus:m=>m.preventDefault(),onFocusOutside:Oe(t.onFocusOutside,m=>{m.target!==c.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Oe(t.onEscapeKeyDown,m=>{o.onClose(),m.preventDefault()}),onKeyDown:Oe(t.onKeyDown,m=>{var v;const f=m.currentTarget.contains(m.target),p=Lne[o.dir].includes(m.key);f&&p&&(i.onOpenChange(!1),(v=c.trigger)==null||v.focus(),m.preventDefault())})})})})})});x5.displayName=g5;function v5(t){return t?"open":"closed"}function Q0(t){return t==="indeterminate"}function K1(t){return Q0(t)?"indeterminate":t?"checked":"unchecked"}function nse(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function sse(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function rse(t,e,n){const a=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=sse(t,Math.max(i,0));a.length===1&&(o=o.filter(u=>u!==n));const d=o.find(u=>u.toLowerCase().startsWith(a.toLowerCase()));return d!==n?d:void 0}function ase(t,e){const{x:n,y:r}=t;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const c=e[i].x,d=e[i].y,u=e[o].x,m=e[o].y;d>r!=m>r&&n<(u-c)*(r-d)/(m-d)+c&&(a=!a)}return a}function ise(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return ase(n,e)}function pm(t){return e=>e.pointerType==="mouse"?t(e):void 0}var ose=JI,lse=$1,cse=t5,dse=n5,use=W1,hse=s5,mse=hx,fse=a5,pse=o5,gse=c5,xse=u5,vse=h5,yse=m5,_se=p5,wse=x5,Z1="DropdownMenu",[bse,Bae]=kr(Z1,[YI]),qs=YI(),[jse,y5]=bse(Z1),_5=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:a,defaultOpen:i,onOpenChange:o,modal:c=!0}=t,d=qs(e),u=g.useRef(null),[m=!1,f]=qr({prop:a,defaultProp:i,onChange:o});return s.jsx(jse,{scope:e,triggerId:pr(),triggerRef:u,contentId:pr(),open:m,onOpenChange:f,onOpenToggle:g.useCallback(()=>f(p=>!p),[f]),modal:c,children:s.jsx(ose,{...d,open:m,onOpenChange:f,dir:r,modal:c,children:n})})};_5.displayName=Z1;var w5="DropdownMenuTrigger",b5=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=t,i=y5(w5,n),o=qs(n);return s.jsx(lse,{asChild:!0,...o,children:s.jsx(tt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:xg(e,i.triggerRef),onPointerDown:Oe(t.onPointerDown,c=>{!r&&c.button===0&&c.ctrlKey===!1&&(i.onOpenToggle(),i.open||c.preventDefault())}),onKeyDown:Oe(t.onKeyDown,c=>{r||(["Enter"," "].includes(c.key)&&i.onOpenToggle(),c.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(c.key)&&c.preventDefault())})})})});b5.displayName=w5;var Nse="DropdownMenuPortal",j5=t=>{const{__scopeDropdownMenu:e,...n}=t,r=qs(e);return s.jsx(cse,{...r,...n})};j5.displayName=Nse;var N5="DropdownMenuContent",S5=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=y5(N5,n),i=qs(n),o=g.useRef(!1);return s.jsx(dse,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...r,ref:e,onCloseAutoFocus:Oe(t.onCloseAutoFocus,c=>{var d;o.current||(d=a.triggerRef.current)==null||d.focus(),o.current=!1,c.preventDefault()}),onInteractOutside:Oe(t.onInteractOutside,c=>{const d=c.detail.originalEvent,u=d.button===0&&d.ctrlKey===!0,m=d.button===2||u;(!a.modal||m)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});S5.displayName=N5;var Sse="DropdownMenuGroup",kse=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=qs(n);return s.jsx(use,{...a,...r,ref:e})});kse.displayName=Sse;var Cse="DropdownMenuLabel",k5=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=qs(n);return s.jsx(hse,{...a,...r,ref:e})});k5.displayName=Cse;var Ese="DropdownMenuItem",C5=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=qs(n);return s.jsx(mse,{...a,...r,ref:e})});C5.displayName=Ese;var Ase="DropdownMenuCheckboxItem",E5=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=qs(n);return s.jsx(fse,{...a,...r,ref:e})});E5.displayName=Ase;var Pse="DropdownMenuRadioGroup",Dse=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=qs(n);return s.jsx(pse,{...a,...r,ref:e})});Dse.displayName=Pse;var Tse="DropdownMenuRadioItem",A5=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=qs(n);return s.jsx(gse,{...a,...r,ref:e})});A5.displayName=Tse;var Mse="DropdownMenuItemIndicator",P5=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=qs(n);return s.jsx(xse,{...a,...r,ref:e})});P5.displayName=Mse;var Rse="DropdownMenuSeparator",D5=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=qs(n);return s.jsx(vse,{...a,...r,ref:e})});D5.displayName=Rse;var Ise="DropdownMenuArrow",Ose=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=qs(n);return s.jsx(yse,{...a,...r,ref:e})});Ose.displayName=Ise;var Lse="DropdownMenuSubTrigger",T5=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=qs(n);return s.jsx(_se,{...a,...r,ref:e})});T5.displayName=Lse;var Fse="DropdownMenuSubContent",M5=g.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,a=qs(n);return s.jsx(wse,{...a,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});M5.displayName=Fse;var Bse=_5,zse=b5,$se=j5,R5=S5,I5=k5,O5=C5,L5=E5,F5=A5,B5=P5,z5=D5,$5=T5,U5=M5;const Use=Bse,qse=zse,Hse=g.forwardRef(({className:t,inset:e,children:n,...r},a)=>s.jsxs($5,{ref:a,className:Ie("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",t),...r,children:[n,s.jsx(Pl,{className:"ml-auto h-4 w-4"})]}));Hse.displayName=$5.displayName;const Wse=g.forwardRef(({className:t,...e},n)=>s.jsx(U5,{ref:n,className:Ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));Wse.displayName=U5.displayName;const q5=g.forwardRef(({className:t,sideOffset:e=4,...n},r)=>s.jsx($se,{children:s.jsx(R5,{ref:r,sideOffset:e,className:Ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));q5.displayName=R5.displayName;const Bp=g.forwardRef(({className:t,inset:e,...n},r)=>s.jsx(O5,{ref:r,className:Ie("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",t),...n}));Bp.displayName=O5.displayName;const Vse=g.forwardRef(({className:t,children:e,checked:n,...r},a)=>s.jsxs(L5,{ref:a,className:Ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(B5,{children:s.jsx(Em,{className:"h-4 w-4"})})}),e]}));Vse.displayName=L5.displayName;const Kse=g.forwardRef(({className:t,children:e,...n},r)=>s.jsxs(F5,{ref:r,className:Ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(B5,{children:s.jsx(aB,{className:"h-2 w-2 fill-current"})})}),e]}));Kse.displayName=F5.displayName;const Zse=g.forwardRef(({className:t,inset:e,...n},r)=>s.jsx(I5,{ref:r,className:Ie("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));Zse.displayName=I5.displayName;const Gse=g.forwardRef(({className:t,...e},n)=>s.jsx(z5,{ref:n,className:Ie("-mx-1 my-1 h-px bg-muted",t),...e}));Gse.displayName=z5.displayName;function Qse(){const{theme:t,setTheme:e,actualTheme:n}=oj();return s.jsxs(Use,{children:[s.jsx(qse,{asChild:!0,children:s.jsxs(ne,{variant:"outline",size:"sm",className:"relative border-border/40 bg-background/80 backdrop-blur-sm hover:bg-accent/80 transition-all duration-200",children:[s.jsx(V_,{className:"h-4 w-4 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),s.jsx(H_,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),s.jsx("span",{className:"sr-only",children:"Theme wechseln"})]})}),s.jsxs(q5,{align:"end",className:"w-48 bg-background/95 backdrop-blur-sm border-border/40 shadow-lg",children:[s.jsxs(Bp,{onClick:()=>e("light"),className:`flex items-center gap-2 cursor-pointer ${t==="light"?"bg-accent text-accent-foreground":""}`,children:[s.jsx(V_,{className:"h-4 w-4"}),s.jsx("span",{children:"Hell"}),t==="light"&&s.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),s.jsxs(Bp,{onClick:()=>e("dark"),className:`flex items-center gap-2 cursor-pointer ${t==="dark"?"bg-accent text-accent-foreground":""}`,children:[s.jsx(H_,{className:"h-4 w-4"}),s.jsx("span",{children:"Dunkel"}),t==="dark"&&s.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]}),s.jsxs(Bp,{onClick:()=>e("system"),className:`flex items-center gap-2 cursor-pointer ${t==="system"?"bg-accent text-accent-foreground":""}`,children:[s.jsx(xB,{className:"h-4 w-4"}),s.jsx("span",{children:"System"}),t==="system"&&s.jsx("div",{className:"ml-auto h-2 w-2 rounded-full bg-primary"})]})]})]})}function Yse(){const{actualTheme:t,setTheme:e}=oj(),n=()=>{e(t==="light"?"dark":"light")};return s.jsxs(ne,{variant:"ghost",size:"sm",onClick:n,className:"relative h-9 w-9 p-0 rounded-full hover:bg-accent/80 transition-all duration-300 ease-out",children:[s.jsxs("div",{className:"relative h-4 w-4",children:[s.jsx(V_,{className:"absolute h-4 w-4 rotate-0 scale-100 transition-all duration-300 dark:-rotate-90 dark:scale-0"}),s.jsx(H_,{className:"absolute h-4 w-4 rotate-90 scale-0 transition-all duration-300 dark:rotate-0 dark:scale-100"})]}),s.jsx("span",{className:"sr-only",children:"Theme wechseln"})]})}const Xse=()=>{var u;const{user:t,userRole:e,loading:n,signOut:r}=Vr(),a=wa(),[i,o]=g.useState("dashboard"),c=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768;if(g.useEffect(()=>{n||(t?e==="employee"?a("/employee"):e==="manager"&&c()&&Oa({title:"Mobile Gerät erkannt",description:"Für die beste Erfahrung verwenden Sie die Employee-App"}):a("/login"))},[t,e,n]),n)return s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!t||e==="employee"||e!=="manager")return null;const d=()=>{switch(i){case"customers":return s.jsx(VQ,{});case"projects":return s.jsx(lte,{});case"personal":return s.jsx(bte,{});case"materials":return s.jsx(Ste,{});case"machines":return s.jsx(Dte,{});case"emails":return s.jsx(Ane,{});case"documents":return s.jsx(kne,{});case"invoice-validation":return s.jsx(Cne,{});case"finance":return s.jsx(Tte,{});case"planner":return s.jsx(Ote,{});case"timetracking":return s.jsx(ene,{});case"time-approval":return s.jsx(yne,{});case"vacation":return s.jsx(Pne,{});case"company-settings":return s.jsx(Ene,{});default:return s.jsx(Mne,{onNavigate:o})}};return s.jsxs("div",{className:"min-h-screen w-full bg-gray-50",children:[s.jsx(rH,{activeModule:i,onModuleChange:o}),s.jsxs("div",{className:"ml-16 lg:ml-16 flex flex-col min-h-screen",children:[s.jsx("header",{className:"h-20 border-b border-white/20 bg-white/80 dark:bg-slate-900/80 backdrop-blur-xl sticky top-0 z-30 shadow-lg shadow-blue-500/10",children:s.jsxs("div",{className:"flex items-center justify-between h-full px-8",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("img",{src:"/handwerkos-logo.svg",alt:"HandwerkOS Logo",className:"h-10 w-10 object-contain"}),s.jsx("h1",{className:"font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent text-3xl",children:"HandwerkOS"})]}),s.jsx(Be,{variant:"secondary",className:"hidden sm:inline-flex bg-gradient-to-r from-blue-100 to-indigo-100 text-blue-700 border-0 shadow-sm",children:"Manager Dashboard"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(Qse,{}),s.jsxs(ne,{variant:"outline",size:"sm",onClick:()=>a("/employee"),className:"hidden sm:flex bg-white/50 hover:bg-white/80 border-white/30 backdrop-blur-sm shadow-lg transition-all duration-200 hover:scale-105",children:[s.jsx(Pm,{className:"w-4 h-4 mr-2"}),"Mitarbeiter-Ansicht"]}),s.jsxs("div",{className:"flex items-center space-x-2 text-sm text-slate-600 dark:text-slate-300 bg-white/30 dark:bg-slate-800/30 px-3 py-2 rounded-full backdrop-blur-sm",children:[s.jsx(Ds,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline font-medium",children:((u=t==null?void 0:t.email)==null?void 0:u.split("@")[0])||"Admin"})]})]})]})}),s.jsx("main",{className:"flex-1 overflow-auto",children:d()})]})]})},lE=()=>{const[t,e]=g.useState(!0),[n,r]=g.useState(!1),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(""),[m,f]=g.useState(""),[p,v]=g.useState(""),[w,x]=g.useState(""),[y,j]=g.useState(""),[b,N]=g.useState(""),[S,E]=g.useState(""),[C,P]=g.useState(""),[R,H]=g.useState("Deutschland"),[I,D]=g.useState(""),[W,V]=g.useState(""),[G,Y]=g.useState(""),[X,F]=g.useState(!1),{signIn:T,signUp:q,updatePassword:U}=Lg(),B=wa(),[O]=Nj();g.useEffect(()=>{(async()=>{console.log("Current URL:",window.location.href),console.log("Search params:",window.location.search);const te=O.get("mode"),ee=O.get("token");if(console.log("Auth check:",{mode:te,inviteToken:ee}),te==="employee-setup"&&ee){console.log("Processing employee invitation token:",ee);try{const{data:Q,error:le}=await K.from("employee_invitations").select("*").eq("invite_token",ee).eq("status","pending").single();if(le||!Q){console.error("Invalid invitation token:",le),Te.error("Ungültiger oder abgelaufener Einladungslink. Bitte wenden Sie sich an Ihren Manager.");return}if(new Date(Q.expires_at)<new Date){console.error("Invitation token expired"),Te.error("Dieser Einladungslink ist abgelaufen. Bitte fordern Sie eine neue Einladung an.");return}console.log("Valid invitation found:",Q),i(Q.email),r(!0),window.invitationData=Q}catch(Q){console.error("Error validating invitation:",Q),Te.error("Fehler beim Validieren der Einladung.")}}else te==="employee-setup"&&!ee&&Te.error("Fehlender Einladungstoken. Bitte verwenden Sie den vollständigen Link aus der E-Mail.")})()},[O]);const z=async $=>{var te,ee;$.preventDefault(),F(!0);try{if(n){const pe=window.invitationData;if(!pe){Te.error("Einladungsdaten nicht gefunden. Bitte verwenden Sie den Link aus der E-Mail erneut."),r(!1);return}if(o!==d){Te.error("Passwörter stimmen nicht überein");return}if(o.length<6){Te.error("Passwort muss mindestens 6 Zeichen lang sein");return}console.log("Creating account for employee:",pe.email);try{const{data:J,error:ae}=await K.auth.signUp({email:pe.email,password:o,options:{data:{first_name:((te=pe.employee_data)==null?void 0:te.firstName)||"",last_name:((ee=pe.employee_data)==null?void 0:ee.lastName)||"",company_id:pe.company_id}}});if(ae){console.error("Error creating user account:",ae),Te.error(ae.message||"Fehler beim Erstellen des Kontos");return}J.user&&(await K.from("employee_invitations").update({status:"accepted"}).eq("invite_token",pe.invite_token),await K.from("user_roles").insert({user_id:J.user.id,role:"employee"}),console.log("Employee account created successfully"),Te.success("Konto erfolgreich erstellt! Sie können sich jetzt anmelden."),r(!1),e(!0),c(""),u(""))}catch(J){console.error("Error during employee registration:",J),Te.error("Fehler beim Erstellen des Kontos")}return}if(t){const{error:pe,data:J}=await T(a,o);if(pe)Te.error(pe.message);else if(J!=null&&J.user){const{data:ae}=await K.from("user_roles").select("role").eq("user_id",J.user.id).single(),fe=(ae==null?void 0:ae.role)||"employee";B(fe==="manager"?"/manager":"/employee")}else B("/manager");return}if(o.length<6){Te.error("Passwort muss mindestens 6 Zeichen lang sein");return}if(o!==d){Te.error("Passwörter stimmen nicht überein");return}const Q={firstName:m,lastName:p,companyName:w,phone:y,streetAddress:b,postalCode:S,city:C,country:R,vatId:I,voucherCode:W,referralSource:G},{error:le}=await q(a,o,Q);le?Te.error(le.message):Te.success("Registrierung erfolgreich! Bitte bestätigen Sie Ihre E-Mail.")}finally{F(!1)}};return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50",children:[s.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6 shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsx("img",{src:"/handwerkos-logo.svg",alt:"HandwerkOS Logo",className:"h-12 w-12 object-contain"}),s.jsx("h1",{className:"text-3xl font-bold tracking-wide",children:"HandwerkOS"})]}),s.jsx("p",{className:"text-center text-blue-100 mt-2 text-sm",children:"Die moderne Software-Lösung für Handwerksbetriebe"})]}),s.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-120px)] p-4",children:s.jsxs(oe,{className:"w-full max-w-2xl shadow-xl border-0 bg-white/80 backdrop-blur-sm",children:[s.jsxs(je,{className:"text-center space-y-4 pb-8",children:[s.jsx(Ne,{className:"flex items-center justify-center gap-3 text-2xl font-bold text-gray-800",children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:s.jsx(xS,{className:"h-6 w-6 text-blue-600"})}),"Passwort erstellen"]}):t?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:s.jsx(Ds,{className:"h-6 w-6 text-green-600"})}),"Anmeldung"]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"p-2 bg-orange-100 rounded-full",children:s.jsx(vS,{className:"h-6 w-6 text-orange-600"})}),"Registrierung"]})}),s.jsx(vn,{className:"text-base text-gray-600",children:n?"Erstellen Sie Ihr Passwort für Ihren HandwerkOS Account":t?"Willkommen zurück! Melden Sie sich in Ihrem HandwerkOS Account an":"Starten Sie jetzt mit HandwerkOS und digitalisieren Sie Ihren Betrieb"})]}),s.jsx(de,{children:s.jsxs("form",{onSubmit:z,className:"space-y-4",children:[n?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"password",children:"Neues Passwort"}),s.jsx(re,{id:"password",type:"password",value:o,onChange:$=>c($.target.value),required:!0,placeholder:"Mindestens 6 Zeichen"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"confirmPassword",children:"Passwort bestätigen"}),s.jsx(re,{id:"confirmPassword",type:"password",value:d,onChange:$=>u($.target.value),required:!0,placeholder:"Passwort wiederholen"})]})]}):t?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"email",children:"E-Mail"}),s.jsx(re,{id:"email",type:"email",value:a,onChange:$=>i($.target.value),required:!0,placeholder:"ihre@email.de"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"password",children:"Passwort"}),s.jsx(re,{id:"password",type:"password",value:o,onChange:$=>c($.target.value),required:!0,placeholder:"Ihr Passwort"})]})]}):s.jsx(s.Fragment,{children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Persönliche Daten"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"firstName",children:"Vorname *"}),s.jsx(re,{id:"firstName",type:"text",value:m,onChange:$=>f($.target.value),required:!0,placeholder:"Ihr Vorname"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"lastName",children:"Nachname *"}),s.jsx(re,{id:"lastName",type:"text",value:p,onChange:$=>v($.target.value),required:!0,placeholder:"Ihr Nachname"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"email",children:"E-Mail *"}),s.jsx(re,{id:"email",type:"email",value:a,onChange:$=>i($.target.value),required:!0,placeholder:"ihre@email.de"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"phone",children:"Telefon"}),s.jsx(re,{id:"phone",type:"tel",value:y,onChange:$=>j($.target.value),placeholder:"+49 123 456789"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Firmendaten"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"companyName",children:"Firmenname *"}),s.jsx(re,{id:"companyName",type:"text",value:w,onChange:$=>x($.target.value),required:!0,placeholder:"Ihre Firma"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"vatId",children:"USt-IdNr."}),s.jsx(re,{id:"vatId",type:"text",value:I,onChange:$=>D($.target.value),placeholder:"DE123456789"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Zusätzliche Angaben (optional)"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"voucherCode",children:"Gutscheincode"}),s.jsx(re,{id:"voucherCode",type:"text",value:W,onChange:$=>V($.target.value),placeholder:"Falls vorhanden"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"referralSource",children:"Wie haben Sie von uns erfahren?"}),s.jsxs(ut,{value:G,onValueChange:Y,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Bitte auswählen"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Google",children:"Google"}),s.jsx(xe,{value:"Social Media",children:"Social Media"}),s.jsx(xe,{value:"Empfehlung",children:"Empfehlung"}),s.jsx(xe,{value:"Werbung",children:"Werbung"}),s.jsx(xe,{value:"Messe",children:"Messe"}),s.jsx(xe,{value:"Sonstiges",children:"Sonstiges"})]})]})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Adresse"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"streetAddress",children:"Straße & Hausnummer"}),s.jsx(re,{id:"streetAddress",type:"text",value:b,onChange:$=>N($.target.value),placeholder:"Musterstraße 123"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"postalCode",children:"PLZ"}),s.jsx(re,{id:"postalCode",type:"text",value:S,onChange:$=>E($.target.value),placeholder:"12345"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"city",children:"Stadt"}),s.jsx(re,{id:"city",type:"text",value:C,onChange:$=>P($.target.value),placeholder:"Musterstadt"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"country",children:"Land"}),s.jsxs(ut,{value:R,onValueChange:H,children:[s.jsx(lt,{children:s.jsx(ht,{placeholder:"Land auswählen"})}),s.jsxs(ct,{children:[s.jsx(xe,{value:"Deutschland",children:"Deutschland"}),s.jsx(xe,{value:"Österreich",children:"Österreich"}),s.jsx(xe,{value:"Schweiz",children:"Schweiz"}),s.jsx(xe,{value:"Niederlande",children:"Niederlande"}),s.jsx(xe,{value:"Belgien",children:"Belgien"}),s.jsx(xe,{value:"Frankreich",children:"Frankreich"})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground border-b pb-2",children:"Passwort"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"password",children:"Passwort *"}),s.jsx(re,{id:"password",type:"password",value:o,onChange:$=>c($.target.value),required:!0,placeholder:"Mindestens 6 Zeichen"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"confirmPassword",children:"Passwort bestätigen *"}),s.jsx(re,{id:"confirmPassword",type:"password",value:d,onChange:$=>u($.target.value),required:!0,placeholder:"Passwort wiederholen"})]})]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Js,{id:"terms",required:!0}),s.jsxs(se,{htmlFor:"terms",className:"text-sm",children:["Ich stimme den"," ",s.jsx("a",{href:"#",className:"text-primary underline hover:no-underline",onClick:$=>$.preventDefault(),children:"Allgemeinen Geschäftsbedingungen"})," ","und der"," ",s.jsx("a",{href:"#",className:"text-primary underline hover:no-underline",onClick:$=>$.preventDefault(),children:"Datenschutzerklärung"})," ","zu *"]})]})})]})]})}),s.jsx(ne,{type:"submit",className:"w-full h-12 text-lg font-semibold bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 shadow-lg hover:shadow-xl transition-all duration-200",disabled:X,children:X?s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),n?"Wird erstellt...":t?"Wird angemeldet...":"Wird registriert..."]}):n?s.jsxs(s.Fragment,{children:[s.jsx(xS,{className:"h-5 w-5 mr-2"}),"Passwort erstellen"]}):t?s.jsxs(s.Fragment,{children:[s.jsx(Ds,{className:"h-5 w-5 mr-2"}),"Jetzt anmelden"]}):s.jsxs(s.Fragment,{children:[s.jsx(vS,{className:"h-5 w-5 mr-2"}),"Kostenlos registrieren"]})}),!n&&s.jsx("div",{className:"text-center pt-4 border-t",children:s.jsx(ne,{type:"button",variant:"ghost",onClick:()=>e(!t),className:"text-sm text-gray-600 hover:text-blue-600 font-medium",children:t?"Noch kein Account? Jetzt kostenlos registrieren":"Bereits registriert? Zur Anmeldung"})})]})})]})}),s.jsxs("div",{className:"text-center pb-6",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"© 2024 HandwerkOS - Die digitale Zukunft des Handwerks"}),s.jsxs("div",{className:"flex justify-center gap-6 mt-2 text-xs text-gray-400",children:[s.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Datenschutz"}),s.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Impressum"}),s.jsx("button",{className:"hover:text-blue-600 transition-colors",children:"Support"})]})]})]})};var cE={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(n,r){r(e)})(gt,function(n){var r="1.9.4";function a(l){var h,_,k,M;for(_=1,k=arguments.length;_<k;_++){M=arguments[_];for(h in M)l[h]=M[h]}return l}var i=Object.create||function(){function l(){}return function(h){return l.prototype=h,new l}}();function o(l,h){var _=Array.prototype.slice;if(l.bind)return l.bind.apply(l,_.call(arguments,1));var k=_.call(arguments,2);return function(){return l.apply(h,k.length?k.concat(_.call(arguments)):arguments)}}var c=0;function d(l){return"_leaflet_id"in l||(l._leaflet_id=++c),l._leaflet_id}function u(l,h,_){var k,M,Z,ce;return ce=function(){k=!1,M&&(Z.apply(_,M),M=!1)},Z=function(){k?M=arguments:(l.apply(_,arguments),setTimeout(ce,h),k=!0)},Z}function m(l,h,_){var k=h[1],M=h[0],Z=k-M;return l===k&&_?l:((l-M)%Z+Z)%Z+M}function f(){return!1}function p(l,h){if(h===!1)return l;var _=Math.pow(10,h===void 0?6:h);return Math.round(l*_)/_}function v(l){return l.trim?l.trim():l.replace(/^\s+|\s+$/g,"")}function w(l){return v(l).split(/\s+/)}function x(l,h){Object.prototype.hasOwnProperty.call(l,"options")||(l.options=l.options?i(l.options):{});for(var _ in h)l.options[_]=h[_];return l.options}function y(l,h,_){var k=[];for(var M in l)k.push(encodeURIComponent(_?M.toUpperCase():M)+"="+encodeURIComponent(l[M]));return(!h||h.indexOf("?")===-1?"?":"&")+k.join("&")}var j=/\{ *([\w_ -]+) *\}/g;function b(l,h){return l.replace(j,function(_,k){var M=h[k];if(M===void 0)throw new Error("No value provided for variable "+_);return typeof M=="function"&&(M=M(h)),M})}var N=Array.isArray||function(l){return Object.prototype.toString.call(l)==="[object Array]"};function S(l,h){for(var _=0;_<l.length;_++)if(l[_]===h)return _;return-1}var E="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function C(l){return window["webkit"+l]||window["moz"+l]||window["ms"+l]}var P=0;function R(l){var h=+new Date,_=Math.max(0,16-(h-P));return P=h+_,window.setTimeout(l,_)}var H=window.requestAnimationFrame||C("RequestAnimationFrame")||R,I=window.cancelAnimationFrame||C("CancelAnimationFrame")||C("CancelRequestAnimationFrame")||function(l){window.clearTimeout(l)};function D(l,h,_){if(_&&H===R)l.call(h);else return H.call(window,o(l,h))}function W(l){l&&I.call(window,l)}var V={__proto__:null,extend:a,create:i,bind:o,get lastId(){return c},stamp:d,throttle:u,wrapNum:m,falseFn:f,formatNum:p,trim:v,splitWords:w,setOptions:x,getParamString:y,template:b,isArray:N,indexOf:S,emptyImageUrl:E,requestFn:H,cancelFn:I,requestAnimFrame:D,cancelAnimFrame:W};function G(){}G.extend=function(l){var h=function(){x(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},_=h.__super__=this.prototype,k=i(_);k.constructor=h,h.prototype=k;for(var M in this)Object.prototype.hasOwnProperty.call(this,M)&&M!=="prototype"&&M!=="__super__"&&(h[M]=this[M]);return l.statics&&a(h,l.statics),l.includes&&(Y(l.includes),a.apply(null,[k].concat(l.includes))),a(k,l),delete k.statics,delete k.includes,k.options&&(k.options=_.options?i(_.options):{},a(k.options,l.options)),k._initHooks=[],k.callInitHooks=function(){if(!this._initHooksCalled){_.callInitHooks&&_.callInitHooks.call(this),this._initHooksCalled=!0;for(var Z=0,ce=k._initHooks.length;Z<ce;Z++)k._initHooks[Z].call(this)}},h},G.include=function(l){var h=this.prototype.options;return a(this.prototype,l),l.options&&(this.prototype.options=h,this.mergeOptions(l.options)),this},G.mergeOptions=function(l){return a(this.prototype.options,l),this},G.addInitHook=function(l){var h=Array.prototype.slice.call(arguments,1),_=typeof l=="function"?l:function(){this[l].apply(this,h)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(_),this};function Y(l){if(!(typeof L>"u"||!L||!L.Mixin)){l=N(l)?l:[l];for(var h=0;h<l.length;h++)l[h]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var X={on:function(l,h,_){if(typeof l=="object")for(var k in l)this._on(k,l[k],h);else{l=w(l);for(var M=0,Z=l.length;M<Z;M++)this._on(l[M],h,_)}return this},off:function(l,h,_){if(!arguments.length)delete this._events;else if(typeof l=="object")for(var k in l)this._off(k,l[k],h);else{l=w(l);for(var M=arguments.length===1,Z=0,ce=l.length;Z<ce;Z++)M?this._off(l[Z]):this._off(l[Z],h,_)}return this},_on:function(l,h,_,k){if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}if(this._listens(l,h,_)===!1){_===this&&(_=void 0);var M={fn:h,ctx:_};k&&(M.once=!0),this._events=this._events||{},this._events[l]=this._events[l]||[],this._events[l].push(M)}},_off:function(l,h,_){var k,M,Z;if(this._events&&(k=this._events[l],!!k)){if(arguments.length===1){if(this._firingCount)for(M=0,Z=k.length;M<Z;M++)k[M].fn=f;delete this._events[l];return}if(typeof h!="function"){console.warn("wrong listener type: "+typeof h);return}var ce=this._listens(l,h,_);if(ce!==!1){var me=k[ce];this._firingCount&&(me.fn=f,this._events[l]=k=k.slice()),k.splice(ce,1)}}},fire:function(l,h,_){if(!this.listens(l,_))return this;var k=a({},h,{type:l,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var M=this._events[l];if(M){this._firingCount=this._firingCount+1||1;for(var Z=0,ce=M.length;Z<ce;Z++){var me=M[Z],ye=me.fn;me.once&&this.off(l,ye,me.ctx),ye.call(me.ctx||this,k)}this._firingCount--}}return _&&this._propagateEvent(k),this},listens:function(l,h,_,k){typeof l!="string"&&console.warn('"string" type argument expected');var M=h;typeof h!="function"&&(k=!!h,M=void 0,_=void 0);var Z=this._events&&this._events[l];if(Z&&Z.length&&this._listens(l,M,_)!==!1)return!0;if(k){for(var ce in this._eventParents)if(this._eventParents[ce].listens(l,h,_,k))return!0}return!1},_listens:function(l,h,_){if(!this._events)return!1;var k=this._events[l]||[];if(!h)return!!k.length;_===this&&(_=void 0);for(var M=0,Z=k.length;M<Z;M++)if(k[M].fn===h&&k[M].ctx===_)return M;return!1},once:function(l,h,_){if(typeof l=="object")for(var k in l)this._on(k,l[k],h,!0);else{l=w(l);for(var M=0,Z=l.length;M<Z;M++)this._on(l[M],h,_,!0)}return this},addEventParent:function(l){return this._eventParents=this._eventParents||{},this._eventParents[d(l)]=l,this},removeEventParent:function(l){return this._eventParents&&delete this._eventParents[d(l)],this},_propagateEvent:function(l){for(var h in this._eventParents)this._eventParents[h].fire(l.type,a({layer:l.target,propagatedFrom:l.target},l),!0)}};X.addEventListener=X.on,X.removeEventListener=X.clearAllEventListeners=X.off,X.addOneTimeEventListener=X.once,X.fireEvent=X.fire,X.hasEventListeners=X.listens;var F=G.extend(X);function T(l,h,_){this.x=_?Math.round(l):l,this.y=_?Math.round(h):h}var q=Math.trunc||function(l){return l>0?Math.floor(l):Math.ceil(l)};T.prototype={clone:function(){return new T(this.x,this.y)},add:function(l){return this.clone()._add(U(l))},_add:function(l){return this.x+=l.x,this.y+=l.y,this},subtract:function(l){return this.clone()._subtract(U(l))},_subtract:function(l){return this.x-=l.x,this.y-=l.y,this},divideBy:function(l){return this.clone()._divideBy(l)},_divideBy:function(l){return this.x/=l,this.y/=l,this},multiplyBy:function(l){return this.clone()._multiplyBy(l)},_multiplyBy:function(l){return this.x*=l,this.y*=l,this},scaleBy:function(l){return new T(this.x*l.x,this.y*l.y)},unscaleBy:function(l){return new T(this.x/l.x,this.y/l.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=q(this.x),this.y=q(this.y),this},distanceTo:function(l){l=U(l);var h=l.x-this.x,_=l.y-this.y;return Math.sqrt(h*h+_*_)},equals:function(l){return l=U(l),l.x===this.x&&l.y===this.y},contains:function(l){return l=U(l),Math.abs(l.x)<=Math.abs(this.x)&&Math.abs(l.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function U(l,h,_){return l instanceof T?l:N(l)?new T(l[0],l[1]):l==null?l:typeof l=="object"&&"x"in l&&"y"in l?new T(l.x,l.y):new T(l,h,_)}function B(l,h){if(l)for(var _=h?[l,h]:l,k=0,M=_.length;k<M;k++)this.extend(_[k])}B.prototype={extend:function(l){var h,_;if(!l)return this;if(l instanceof T||typeof l[0]=="number"||"x"in l)h=_=U(l);else if(l=O(l),h=l.min,_=l.max,!h||!_)return this;return!this.min&&!this.max?(this.min=h.clone(),this.max=_.clone()):(this.min.x=Math.min(h.x,this.min.x),this.max.x=Math.max(_.x,this.max.x),this.min.y=Math.min(h.y,this.min.y),this.max.y=Math.max(_.y,this.max.y)),this},getCenter:function(l){return U((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,l)},getBottomLeft:function(){return U(this.min.x,this.max.y)},getTopRight:function(){return U(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(l){var h,_;return typeof l[0]=="number"||l instanceof T?l=U(l):l=O(l),l instanceof B?(h=l.min,_=l.max):h=_=l,h.x>=this.min.x&&_.x<=this.max.x&&h.y>=this.min.y&&_.y<=this.max.y},intersects:function(l){l=O(l);var h=this.min,_=this.max,k=l.min,M=l.max,Z=M.x>=h.x&&k.x<=_.x,ce=M.y>=h.y&&k.y<=_.y;return Z&&ce},overlaps:function(l){l=O(l);var h=this.min,_=this.max,k=l.min,M=l.max,Z=M.x>h.x&&k.x<_.x,ce=M.y>h.y&&k.y<_.y;return Z&&ce},isValid:function(){return!!(this.min&&this.max)},pad:function(l){var h=this.min,_=this.max,k=Math.abs(h.x-_.x)*l,M=Math.abs(h.y-_.y)*l;return O(U(h.x-k,h.y-M),U(_.x+k,_.y+M))},equals:function(l){return l?(l=O(l),this.min.equals(l.getTopLeft())&&this.max.equals(l.getBottomRight())):!1}};function O(l,h){return!l||l instanceof B?l:new B(l,h)}function z(l,h){if(l)for(var _=h?[l,h]:l,k=0,M=_.length;k<M;k++)this.extend(_[k])}z.prototype={extend:function(l){var h=this._southWest,_=this._northEast,k,M;if(l instanceof te)k=l,M=l;else if(l instanceof z){if(k=l._southWest,M=l._northEast,!k||!M)return this}else return l?this.extend(ee(l)||$(l)):this;return!h&&!_?(this._southWest=new te(k.lat,k.lng),this._northEast=new te(M.lat,M.lng)):(h.lat=Math.min(k.lat,h.lat),h.lng=Math.min(k.lng,h.lng),_.lat=Math.max(M.lat,_.lat),_.lng=Math.max(M.lng,_.lng)),this},pad:function(l){var h=this._southWest,_=this._northEast,k=Math.abs(h.lat-_.lat)*l,M=Math.abs(h.lng-_.lng)*l;return new z(new te(h.lat-k,h.lng-M),new te(_.lat+k,_.lng+M))},getCenter:function(){return new te((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new te(this.getNorth(),this.getWest())},getSouthEast:function(){return new te(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(l){typeof l[0]=="number"||l instanceof te||"lat"in l?l=ee(l):l=$(l);var h=this._southWest,_=this._northEast,k,M;return l instanceof z?(k=l.getSouthWest(),M=l.getNorthEast()):k=M=l,k.lat>=h.lat&&M.lat<=_.lat&&k.lng>=h.lng&&M.lng<=_.lng},intersects:function(l){l=$(l);var h=this._southWest,_=this._northEast,k=l.getSouthWest(),M=l.getNorthEast(),Z=M.lat>=h.lat&&k.lat<=_.lat,ce=M.lng>=h.lng&&k.lng<=_.lng;return Z&&ce},overlaps:function(l){l=$(l);var h=this._southWest,_=this._northEast,k=l.getSouthWest(),M=l.getNorthEast(),Z=M.lat>h.lat&&k.lat<_.lat,ce=M.lng>h.lng&&k.lng<_.lng;return Z&&ce},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(l,h){return l?(l=$(l),this._southWest.equals(l.getSouthWest(),h)&&this._northEast.equals(l.getNorthEast(),h)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function $(l,h){return l instanceof z?l:new z(l,h)}function te(l,h,_){if(isNaN(l)||isNaN(h))throw new Error("Invalid LatLng object: ("+l+", "+h+")");this.lat=+l,this.lng=+h,_!==void 0&&(this.alt=+_)}te.prototype={equals:function(l,h){if(!l)return!1;l=ee(l);var _=Math.max(Math.abs(this.lat-l.lat),Math.abs(this.lng-l.lng));return _<=(h===void 0?1e-9:h)},toString:function(l){return"LatLng("+p(this.lat,l)+", "+p(this.lng,l)+")"},distanceTo:function(l){return le.distance(this,ee(l))},wrap:function(){return le.wrapLatLng(this)},toBounds:function(l){var h=180*l/40075017,_=h/Math.cos(Math.PI/180*this.lat);return $([this.lat-h,this.lng-_],[this.lat+h,this.lng+_])},clone:function(){return new te(this.lat,this.lng,this.alt)}};function ee(l,h,_){return l instanceof te?l:N(l)&&typeof l[0]!="object"?l.length===3?new te(l[0],l[1],l[2]):l.length===2?new te(l[0],l[1]):null:l==null?l:typeof l=="object"&&"lat"in l?new te(l.lat,"lng"in l?l.lng:l.lon,l.alt):h===void 0?null:new te(l,h,_)}var Q={latLngToPoint:function(l,h){var _=this.projection.project(l),k=this.scale(h);return this.transformation._transform(_,k)},pointToLatLng:function(l,h){var _=this.scale(h),k=this.transformation.untransform(l,_);return this.projection.unproject(k)},project:function(l){return this.projection.project(l)},unproject:function(l){return this.projection.unproject(l)},scale:function(l){return 256*Math.pow(2,l)},zoom:function(l){return Math.log(l/256)/Math.LN2},getProjectedBounds:function(l){if(this.infinite)return null;var h=this.projection.bounds,_=this.scale(l),k=this.transformation.transform(h.min,_),M=this.transformation.transform(h.max,_);return new B(k,M)},infinite:!1,wrapLatLng:function(l){var h=this.wrapLng?m(l.lng,this.wrapLng,!0):l.lng,_=this.wrapLat?m(l.lat,this.wrapLat,!0):l.lat,k=l.alt;return new te(_,h,k)},wrapLatLngBounds:function(l){var h=l.getCenter(),_=this.wrapLatLng(h),k=h.lat-_.lat,M=h.lng-_.lng;if(k===0&&M===0)return l;var Z=l.getSouthWest(),ce=l.getNorthEast(),me=new te(Z.lat-k,Z.lng-M),ye=new te(ce.lat-k,ce.lng-M);return new z(me,ye)}},le=a({},Q,{wrapLng:[-180,180],R:6371e3,distance:function(l,h){var _=Math.PI/180,k=l.lat*_,M=h.lat*_,Z=Math.sin((h.lat-l.lat)*_/2),ce=Math.sin((h.lng-l.lng)*_/2),me=Z*Z+Math.cos(k)*Math.cos(M)*ce*ce,ye=2*Math.atan2(Math.sqrt(me),Math.sqrt(1-me));return this.R*ye}}),pe=6378137,J={R:pe,MAX_LATITUDE:85.0511287798,project:function(l){var h=Math.PI/180,_=this.MAX_LATITUDE,k=Math.max(Math.min(_,l.lat),-_),M=Math.sin(k*h);return new T(this.R*l.lng*h,this.R*Math.log((1+M)/(1-M))/2)},unproject:function(l){var h=180/Math.PI;return new te((2*Math.atan(Math.exp(l.y/this.R))-Math.PI/2)*h,l.x*h/this.R)},bounds:function(){var l=pe*Math.PI;return new B([-l,-l],[l,l])}()};function ae(l,h,_,k){if(N(l)){this._a=l[0],this._b=l[1],this._c=l[2],this._d=l[3];return}this._a=l,this._b=h,this._c=_,this._d=k}ae.prototype={transform:function(l,h){return this._transform(l.clone(),h)},_transform:function(l,h){return h=h||1,l.x=h*(this._a*l.x+this._b),l.y=h*(this._c*l.y+this._d),l},untransform:function(l,h){return h=h||1,new T((l.x/h-this._b)/this._a,(l.y/h-this._d)/this._c)}};function fe(l,h,_,k){return new ae(l,h,_,k)}var he=a({},le,{code:"EPSG:3857",projection:J,transformation:function(){var l=.5/(Math.PI*J.R);return fe(l,.5,-l,.5)}()}),ve=a({},he,{code:"EPSG:900913"});function ie(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function _e(l,h){var _="",k,M,Z,ce,me,ye;for(k=0,Z=l.length;k<Z;k++){for(me=l[k],M=0,ce=me.length;M<ce;M++)ye=me[M],_+=(M?"L":"M")+ye.x+" "+ye.y;_+=h?at.svg?"z":"x":""}return _||"M0 0"}var Se=document.documentElement.style,Ve="ActiveXObject"in window,Xe=Ve&&!document.addEventListener,Et="msLaunchUri"in navigator&&!("documentMode"in document),ke=rr("webkit"),Le=rr("android"),ze=rr("android 2")||rr("android 3"),dt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ze=Le&&rr("Google")&&dt<537&&!("AudioNode"in window),Fe=!!window.opera,Nt=!Et&&rr("chrome"),vt=rr("gecko")&&!ke&&!Fe&&!Ve,Vn=!Nt&&rr("safari"),js=rr("phantom"),yt="OTransition"in Se,cn=navigator.platform.indexOf("Win")===0,On=Ve&&"transition"in Se,hs="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ze,Kn="MozPerspective"in Se,Pn=!window.L_DISABLE_3D&&(On||hs||Kn)&&!yt&&!js,Ms=typeof orientation<"u"||rr("mobile"),ot=Ms&&ke,we=Ms&&hs,be=!window.PointerEvent&&window.MSPointerEvent,Ee=!!(window.PointerEvent||be),$e="ontouchstart"in window||!!window.TouchEvent,st=!window.L_NO_TOUCH&&($e||Ee),Yt=Ms&&Fe,ns=Ms&&vt,Zr=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ii=function(){var l=!1;try{var h=Object.defineProperty({},"passive",{get:function(){l=!0}});window.addEventListener("testPassiveEventSupport",f,h),window.removeEventListener("testPassiveEventSupport",f,h)}catch{}return l}(),Qo=function(){return!!document.createElement("canvas").getContext}(),Gr=!!(document.createElementNS&&ie("svg").createSVGRect),lu=!!Gr&&function(){var l=document.createElement("div");return l.innerHTML="<svg/>",(l.firstChild&&l.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),dc=!Gr&&function(){try{var l=document.createElement("div");l.innerHTML='<v:shape adj="1"/>';var h=l.firstChild;return h.style.behavior="url(#default#VML)",h&&typeof h.adj=="object"}catch{return!1}}(),Ln=navigator.platform.indexOf("Mac")===0,ja=navigator.platform.indexOf("Linux")===0;function rr(l){return navigator.userAgent.toLowerCase().indexOf(l)>=0}var at={ie:Ve,ielt9:Xe,edge:Et,webkit:ke,android:Le,android23:ze,androidStock:Ze,opera:Fe,chrome:Nt,gecko:vt,safari:Vn,phantom:js,opera12:yt,win:cn,ie3d:On,webkit3d:hs,gecko3d:Kn,any3d:Pn,mobile:Ms,mobileWebkit:ot,mobileWebkit3d:we,msPointer:be,pointer:Ee,touch:st,touchNative:$e,mobileOpera:Yt,mobileGecko:ns,retina:Zr,passiveEvents:Ii,canvas:Qo,svg:Gr,vml:dc,inlineSvg:lu,mac:Ln,linux:ja},sN=at.msPointer?"MSPointerDown":"pointerdown",rN=at.msPointer?"MSPointerMove":"pointermove",aN=at.msPointer?"MSPointerUp":"pointerup",iN=at.msPointer?"MSPointerCancel":"pointercancel",px={touchstart:sN,touchmove:rN,touchend:aN,touchcancel:iN},oN={touchstart:AO,touchmove:Jm,touchend:Jm,touchcancel:Jm},uc={},lN=!1;function NO(l,h,_){return h==="touchstart"&&EO(),oN[h]?(_=oN[h].bind(this,_),l.addEventListener(px[h],_,!1),_):(console.warn("wrong event specified:",h),f)}function SO(l,h,_){if(!px[h]){console.warn("wrong event specified:",h);return}l.removeEventListener(px[h],_,!1)}function kO(l){uc[l.pointerId]=l}function CO(l){uc[l.pointerId]&&(uc[l.pointerId]=l)}function cN(l){delete uc[l.pointerId]}function EO(){lN||(document.addEventListener(sN,kO,!0),document.addEventListener(rN,CO,!0),document.addEventListener(aN,cN,!0),document.addEventListener(iN,cN,!0),lN=!0)}function Jm(l,h){if(h.pointerType!==(h.MSPOINTER_TYPE_MOUSE||"mouse")){h.touches=[];for(var _ in uc)h.touches.push(uc[_]);h.changedTouches=[h],l(h)}}function AO(l,h){h.MSPOINTER_TYPE_TOUCH&&h.pointerType===h.MSPOINTER_TYPE_TOUCH&&ms(h),Jm(l,h)}function PO(l){var h={},_,k;for(k in l)_=l[k],h[k]=_&&_.bind?_.bind(l):_;return l=h,h.type="dblclick",h.detail=2,h.isTrusted=!1,h._simulated=!0,h}var DO=200;function TO(l,h){l.addEventListener("dblclick",h);var _=0,k;function M(Z){if(Z.detail!==1){k=Z.detail;return}if(!(Z.pointerType==="mouse"||Z.sourceCapabilities&&!Z.sourceCapabilities.firesTouchEvents)){var ce=fN(Z);if(!(ce.some(function(ye){return ye instanceof HTMLLabelElement&&ye.attributes.for})&&!ce.some(function(ye){return ye instanceof HTMLInputElement||ye instanceof HTMLSelectElement}))){var me=Date.now();me-_<=DO?(k++,k===2&&h(PO(Z))):k=1,_=me}}}return l.addEventListener("click",M),{dblclick:h,simDblclick:M}}function MO(l,h){l.removeEventListener("dblclick",h.dblclick),l.removeEventListener("click",h.simDblclick)}var gx=nf(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),cu=nf(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),dN=cu==="webkitTransition"||cu==="OTransition"?cu+"End":"transitionend";function uN(l){return typeof l=="string"?document.getElementById(l):l}function du(l,h){var _=l.style[h]||l.currentStyle&&l.currentStyle[h];if((!_||_==="auto")&&document.defaultView){var k=document.defaultView.getComputedStyle(l,null);_=k?k[h]:null}return _==="auto"?null:_}function sn(l,h,_){var k=document.createElement(l);return k.className=h||"",_&&_.appendChild(k),k}function bn(l){var h=l.parentNode;h&&h.removeChild(l)}function ef(l){for(;l.firstChild;)l.removeChild(l.firstChild)}function hc(l){var h=l.parentNode;h&&h.lastChild!==l&&h.appendChild(l)}function mc(l){var h=l.parentNode;h&&h.firstChild!==l&&h.insertBefore(l,h.firstChild)}function xx(l,h){if(l.classList!==void 0)return l.classList.contains(h);var _=tf(l);return _.length>0&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(_)}function Lt(l,h){if(l.classList!==void 0)for(var _=w(h),k=0,M=_.length;k<M;k++)l.classList.add(_[k]);else if(!xx(l,h)){var Z=tf(l);vx(l,(Z?Z+" ":"")+h)}}function Mn(l,h){l.classList!==void 0?l.classList.remove(h):vx(l,v((" "+tf(l)+" ").replace(" "+h+" "," ")))}function vx(l,h){l.className.baseVal===void 0?l.className=h:l.className.baseVal=h}function tf(l){return l.correspondingElement&&(l=l.correspondingElement),l.className.baseVal===void 0?l.className:l.className.baseVal}function Cr(l,h){"opacity"in l.style?l.style.opacity=h:"filter"in l.style&&RO(l,h)}function RO(l,h){var _=!1,k="DXImageTransform.Microsoft.Alpha";try{_=l.filters.item(k)}catch{if(h===1)return}h=Math.round(h*100),_?(_.Enabled=h!==100,_.Opacity=h):l.style.filter+=" progid:"+k+"(opacity="+h+")"}function nf(l){for(var h=document.documentElement.style,_=0;_<l.length;_++)if(l[_]in h)return l[_];return!1}function Yo(l,h,_){var k=h||new T(0,0);l.style[gx]=(at.ie3d?"translate("+k.x+"px,"+k.y+"px)":"translate3d("+k.x+"px,"+k.y+"px,0)")+(_?" scale("+_+")":"")}function Fn(l,h){l._leaflet_pos=h,at.any3d?Yo(l,h):(l.style.left=h.x+"px",l.style.top=h.y+"px")}function Xo(l){return l._leaflet_pos||new T(0,0)}var uu,hu,yx;if("onselectstart"in document)uu=function(){Dt(window,"selectstart",ms)},hu=function(){un(window,"selectstart",ms)};else{var mu=nf(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);uu=function(){if(mu){var l=document.documentElement.style;yx=l[mu],l[mu]="none"}},hu=function(){mu&&(document.documentElement.style[mu]=yx,yx=void 0)}}function _x(){Dt(window,"dragstart",ms)}function wx(){un(window,"dragstart",ms)}var sf,bx;function jx(l){for(;l.tabIndex===-1;)l=l.parentNode;l.style&&(rf(),sf=l,bx=l.style.outlineStyle,l.style.outlineStyle="none",Dt(window,"keydown",rf))}function rf(){sf&&(sf.style.outlineStyle=bx,sf=void 0,bx=void 0,un(window,"keydown",rf))}function hN(l){do l=l.parentNode;while((!l.offsetWidth||!l.offsetHeight)&&l!==document.body);return l}function Nx(l){var h=l.getBoundingClientRect();return{x:h.width/l.offsetWidth||1,y:h.height/l.offsetHeight||1,boundingClientRect:h}}var IO={__proto__:null,TRANSFORM:gx,TRANSITION:cu,TRANSITION_END:dN,get:uN,getStyle:du,create:sn,remove:bn,empty:ef,toFront:hc,toBack:mc,hasClass:xx,addClass:Lt,removeClass:Mn,setClass:vx,getClass:tf,setOpacity:Cr,testProp:nf,setTransform:Yo,setPosition:Fn,getPosition:Xo,get disableTextSelection(){return uu},get enableTextSelection(){return hu},disableImageDrag:_x,enableImageDrag:wx,preventOutline:jx,restoreOutline:rf,getSizedParentNode:hN,getScale:Nx};function Dt(l,h,_,k){if(h&&typeof h=="object")for(var M in h)kx(l,M,h[M],_);else{h=w(h);for(var Z=0,ce=h.length;Z<ce;Z++)kx(l,h[Z],_,k)}return this}var Na="_leaflet_events";function un(l,h,_,k){if(arguments.length===1)mN(l),delete l[Na];else if(h&&typeof h=="object")for(var M in h)Cx(l,M,h[M],_);else if(h=w(h),arguments.length===2)mN(l,function(me){return S(h,me)!==-1});else for(var Z=0,ce=h.length;Z<ce;Z++)Cx(l,h[Z],_,k);return this}function mN(l,h){for(var _ in l[Na]){var k=_.split(/\d/)[0];(!h||h(k))&&Cx(l,k,null,null,_)}}var Sx={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function kx(l,h,_,k){var M=h+d(_)+(k?"_"+d(k):"");if(l[Na]&&l[Na][M])return this;var Z=function(me){return _.call(k||l,me||window.event)},ce=Z;!at.touchNative&&at.pointer&&h.indexOf("touch")===0?Z=NO(l,h,Z):at.touch&&h==="dblclick"?Z=TO(l,Z):"addEventListener"in l?h==="touchstart"||h==="touchmove"||h==="wheel"||h==="mousewheel"?l.addEventListener(Sx[h]||h,Z,at.passiveEvents?{passive:!1}:!1):h==="mouseenter"||h==="mouseleave"?(Z=function(me){me=me||window.event,Ax(l,me)&&ce(me)},l.addEventListener(Sx[h],Z,!1)):l.addEventListener(h,ce,!1):l.attachEvent("on"+h,Z),l[Na]=l[Na]||{},l[Na][M]=Z}function Cx(l,h,_,k,M){M=M||h+d(_)+(k?"_"+d(k):"");var Z=l[Na]&&l[Na][M];if(!Z)return this;!at.touchNative&&at.pointer&&h.indexOf("touch")===0?SO(l,h,Z):at.touch&&h==="dblclick"?MO(l,Z):"removeEventListener"in l?l.removeEventListener(Sx[h]||h,Z,!1):l.detachEvent("on"+h,Z),l[Na][M]=null}function Jo(l){return l.stopPropagation?l.stopPropagation():l.originalEvent?l.originalEvent._stopped=!0:l.cancelBubble=!0,this}function Ex(l){return kx(l,"wheel",Jo),this}function fu(l){return Dt(l,"mousedown touchstart dblclick contextmenu",Jo),l._leaflet_disable_click=!0,this}function ms(l){return l.preventDefault?l.preventDefault():l.returnValue=!1,this}function el(l){return ms(l),Jo(l),this}function fN(l){if(l.composedPath)return l.composedPath();for(var h=[],_=l.target;_;)h.push(_),_=_.parentNode;return h}function pN(l,h){if(!h)return new T(l.clientX,l.clientY);var _=Nx(h),k=_.boundingClientRect;return new T((l.clientX-k.left)/_.x-h.clientLeft,(l.clientY-k.top)/_.y-h.clientTop)}var OO=at.linux&&at.chrome?window.devicePixelRatio:at.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function gN(l){return at.edge?l.wheelDeltaY/2:l.deltaY&&l.deltaMode===0?-l.deltaY/OO:l.deltaY&&l.deltaMode===1?-l.deltaY*20:l.deltaY&&l.deltaMode===2?-l.deltaY*60:l.deltaX||l.deltaZ?0:l.wheelDelta?(l.wheelDeltaY||l.wheelDelta)/2:l.detail&&Math.abs(l.detail)<32765?-l.detail*20:l.detail?l.detail/-32765*60:0}function Ax(l,h){var _=h.relatedTarget;if(!_)return!0;try{for(;_&&_!==l;)_=_.parentNode}catch{return!1}return _!==l}var LO={__proto__:null,on:Dt,off:un,stopPropagation:Jo,disableScrollPropagation:Ex,disableClickPropagation:fu,preventDefault:ms,stop:el,getPropagationPath:fN,getMousePosition:pN,getWheelDelta:gN,isExternalTarget:Ax,addListener:Dt,removeListener:un},xN=F.extend({run:function(l,h,_,k){this.stop(),this._el=l,this._inProgress=!0,this._duration=_||.25,this._easeOutPower=1/Math.max(k||.5,.2),this._startPos=Xo(l),this._offset=h.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=D(this._animate,this),this._step()},_step:function(l){var h=+new Date-this._startTime,_=this._duration*1e3;h<_?this._runFrame(this._easeOut(h/_),l):(this._runFrame(1),this._complete())},_runFrame:function(l,h){var _=this._startPos.add(this._offset.multiplyBy(l));h&&_._round(),Fn(this._el,_),this.fire("step")},_complete:function(){W(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(l){return 1-Math.pow(1-l,this._easeOutPower)}}),Xt=F.extend({options:{crs:he,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(l,h){h=x(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(l),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),h.zoom!==void 0&&(this._zoom=this._limitZoom(h.zoom)),h.center&&h.zoom!==void 0&&this.setView(ee(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=cu&&at.any3d&&!at.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Dt(this._proxy,dN,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(l,h,_){if(h=h===void 0?this._zoom:this._limitZoom(h),l=this._limitCenter(ee(l),h,this.options.maxBounds),_=_||{},this._stop(),this._loaded&&!_.reset&&_!==!0){_.animate!==void 0&&(_.zoom=a({animate:_.animate},_.zoom),_.pan=a({animate:_.animate,duration:_.duration},_.pan));var k=this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(l,h,_.zoom):this._tryAnimatedPan(l,_.pan);if(k)return clearTimeout(this._sizeTimer),this}return this._resetView(l,h,_.pan&&_.pan.noMoveStart),this},setZoom:function(l,h){return this._loaded?this.setView(this.getCenter(),l,{zoom:h}):(this._zoom=l,this)},zoomIn:function(l,h){return l=l||(at.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+l,h)},zoomOut:function(l,h){return l=l||(at.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-l,h)},setZoomAround:function(l,h,_){var k=this.getZoomScale(h),M=this.getSize().divideBy(2),Z=l instanceof T?l:this.latLngToContainerPoint(l),ce=Z.subtract(M).multiplyBy(1-1/k),me=this.containerPointToLatLng(M.add(ce));return this.setView(me,h,{zoom:_})},_getBoundsCenterZoom:function(l,h){h=h||{},l=l.getBounds?l.getBounds():$(l);var _=U(h.paddingTopLeft||h.padding||[0,0]),k=U(h.paddingBottomRight||h.padding||[0,0]),M=this.getBoundsZoom(l,!1,_.add(k));if(M=typeof h.maxZoom=="number"?Math.min(h.maxZoom,M):M,M===1/0)return{center:l.getCenter(),zoom:M};var Z=k.subtract(_).divideBy(2),ce=this.project(l.getSouthWest(),M),me=this.project(l.getNorthEast(),M),ye=this.unproject(ce.add(me).divideBy(2).add(Z),M);return{center:ye,zoom:M}},fitBounds:function(l,h){if(l=$(l),!l.isValid())throw new Error("Bounds are not valid.");var _=this._getBoundsCenterZoom(l,h);return this.setView(_.center,_.zoom,h)},fitWorld:function(l){return this.fitBounds([[-90,-180],[90,180]],l)},panTo:function(l,h){return this.setView(l,this._zoom,{pan:h})},panBy:function(l,h){if(l=U(l).round(),h=h||{},!l.x&&!l.y)return this.fire("moveend");if(h.animate!==!0&&!this.getSize().contains(l))return this._resetView(this.unproject(this.project(this.getCenter()).add(l)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new xN,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),h.animate!==!1){Lt(this._mapPane,"leaflet-pan-anim");var _=this._getMapPanePos().subtract(l).round();this._panAnim.run(this._mapPane,_,h.duration||.25,h.easeLinearity)}else this._rawPanBy(l),this.fire("move").fire("moveend");return this},flyTo:function(l,h,_){if(_=_||{},_.animate===!1||!at.any3d)return this.setView(l,h,_);this._stop();var k=this.project(this.getCenter()),M=this.project(l),Z=this.getSize(),ce=this._zoom;l=ee(l),h=h===void 0?ce:h;var me=Math.max(Z.x,Z.y),ye=me*this.getZoomScale(ce,h),Ce=M.distanceTo(k)||1,Ge=1.42,_t=Ge*Ge;function Ut(Bn){var xf=Bn?-1:1,S6=Bn?ye:me,k6=ye*ye-me*me+xf*_t*_t*Ce*Ce,C6=2*S6*_t*Ce,zx=k6/C6,YN=Math.sqrt(zx*zx+1)-zx,E6=YN<1e-9?-18:Math.log(YN);return E6}function Rs(Bn){return(Math.exp(Bn)-Math.exp(-Bn))/2}function ss(Bn){return(Math.exp(Bn)+Math.exp(-Bn))/2}function Ar(Bn){return Rs(Bn)/ss(Bn)}var Hs=Ut(0);function yc(Bn){return me*(ss(Hs)/ss(Hs+Ge*Bn))}function w6(Bn){return me*(ss(Hs)*Ar(Hs+Ge*Bn)-Rs(Hs))/_t}function b6(Bn){return 1-Math.pow(1-Bn,1.5)}var j6=Date.now(),GN=(Ut(1)-Hs)/Ge,N6=_.duration?1e3*_.duration:1e3*GN*.8;function QN(){var Bn=(Date.now()-j6)/N6,xf=b6(Bn)*GN;Bn<=1?(this._flyToFrame=D(QN,this),this._move(this.unproject(k.add(M.subtract(k).multiplyBy(w6(xf)/Ce)),ce),this.getScaleZoom(me/yc(xf),ce),{flyTo:!0})):this._move(l,h)._moveEnd(!0)}return this._moveStart(!0,_.noMoveStart),QN.call(this),this},flyToBounds:function(l,h){var _=this._getBoundsCenterZoom(l,h);return this.flyTo(_.center,_.zoom,h)},setMaxBounds:function(l){return l=$(l),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),l.isValid()?(this.options.maxBounds=l,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(l){var h=this.options.minZoom;return this.options.minZoom=l,this._loaded&&h!==l&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(l):this},setMaxZoom:function(l){var h=this.options.maxZoom;return this.options.maxZoom=l,this._loaded&&h!==l&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(l):this},panInsideBounds:function(l,h){this._enforcingBounds=!0;var _=this.getCenter(),k=this._limitCenter(_,this._zoom,$(l));return _.equals(k)||this.panTo(k,h),this._enforcingBounds=!1,this},panInside:function(l,h){h=h||{};var _=U(h.paddingTopLeft||h.padding||[0,0]),k=U(h.paddingBottomRight||h.padding||[0,0]),M=this.project(this.getCenter()),Z=this.project(l),ce=this.getPixelBounds(),me=O([ce.min.add(_),ce.max.subtract(k)]),ye=me.getSize();if(!me.contains(Z)){this._enforcingBounds=!0;var Ce=Z.subtract(me.getCenter()),Ge=me.extend(Z).getSize().subtract(ye);M.x+=Ce.x<0?-Ge.x:Ge.x,M.y+=Ce.y<0?-Ge.y:Ge.y,this.panTo(this.unproject(M),h),this._enforcingBounds=!1}return this},invalidateSize:function(l){if(!this._loaded)return this;l=a({animate:!1,pan:!0},l===!0?{animate:!0}:l);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var _=this.getSize(),k=h.divideBy(2).round(),M=_.divideBy(2).round(),Z=k.subtract(M);return!Z.x&&!Z.y?this:(l.animate&&l.pan?this.panBy(Z):(l.pan&&this._rawPanBy(Z),this.fire("move"),l.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:_}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(l){if(l=this._locateOptions=a({timeout:1e4,watch:!1},l),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=o(this._handleGeolocationResponse,this),_=o(this._handleGeolocationError,this);return l.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,_,l):navigator.geolocation.getCurrentPosition(h,_,l),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(l){if(this._container._leaflet_id){var h=l.code,_=l.message||(h===1?"permission denied":h===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+_+"."})}},_handleGeolocationResponse:function(l){if(this._container._leaflet_id){var h=l.coords.latitude,_=l.coords.longitude,k=new te(h,_),M=k.toBounds(l.coords.accuracy*2),Z=this._locateOptions;if(Z.setView){var ce=this.getBoundsZoom(M);this.setView(k,Z.maxZoom?Math.min(ce,Z.maxZoom):ce)}var me={latlng:k,bounds:M,timestamp:l.timestamp};for(var ye in l.coords)typeof l.coords[ye]=="number"&&(me[ye]=l.coords[ye]);this.fire("locationfound",me)}},addHandler:function(l,h){if(!h)return this;var _=this[l]=new h(this);return this._handlers.push(_),this.options[l]&&_.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),bn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(W(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var l;for(l in this._layers)this._layers[l].remove();for(l in this._panes)bn(this._panes[l]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(l,h){var _="leaflet-pane"+(l?" leaflet-"+l.replace("Pane","")+"-pane":""),k=sn("div",_,h||this._mapPane);return l&&(this._panes[l]=k),k},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var l=this.getPixelBounds(),h=this.unproject(l.getBottomLeft()),_=this.unproject(l.getTopRight());return new z(h,_)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(l,h,_){l=$(l),_=U(_||[0,0]);var k=this.getZoom()||0,M=this.getMinZoom(),Z=this.getMaxZoom(),ce=l.getNorthWest(),me=l.getSouthEast(),ye=this.getSize().subtract(_),Ce=O(this.project(me,k),this.project(ce,k)).getSize(),Ge=at.any3d?this.options.zoomSnap:1,_t=ye.x/Ce.x,Ut=ye.y/Ce.y,Rs=h?Math.max(_t,Ut):Math.min(_t,Ut);return k=this.getScaleZoom(Rs,k),Ge&&(k=Math.round(k/(Ge/100))*(Ge/100),k=h?Math.ceil(k/Ge)*Ge:Math.floor(k/Ge)*Ge),Math.max(M,Math.min(Z,k))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new T(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(l,h){var _=this._getTopLeftPoint(l,h);return new B(_,_.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(l){return this.options.crs.getProjectedBounds(l===void 0?this.getZoom():l)},getPane:function(l){return typeof l=="string"?this._panes[l]:l},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(l,h){var _=this.options.crs;return h=h===void 0?this._zoom:h,_.scale(l)/_.scale(h)},getScaleZoom:function(l,h){var _=this.options.crs;h=h===void 0?this._zoom:h;var k=_.zoom(l*_.scale(h));return isNaN(k)?1/0:k},project:function(l,h){return h=h===void 0?this._zoom:h,this.options.crs.latLngToPoint(ee(l),h)},unproject:function(l,h){return h=h===void 0?this._zoom:h,this.options.crs.pointToLatLng(U(l),h)},layerPointToLatLng:function(l){var h=U(l).add(this.getPixelOrigin());return this.unproject(h)},latLngToLayerPoint:function(l){var h=this.project(ee(l))._round();return h._subtract(this.getPixelOrigin())},wrapLatLng:function(l){return this.options.crs.wrapLatLng(ee(l))},wrapLatLngBounds:function(l){return this.options.crs.wrapLatLngBounds($(l))},distance:function(l,h){return this.options.crs.distance(ee(l),ee(h))},containerPointToLayerPoint:function(l){return U(l).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(l){return U(l).add(this._getMapPanePos())},containerPointToLatLng:function(l){var h=this.containerPointToLayerPoint(U(l));return this.layerPointToLatLng(h)},latLngToContainerPoint:function(l){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ee(l)))},mouseEventToContainerPoint:function(l){return pN(l,this._container)},mouseEventToLayerPoint:function(l){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(l))},mouseEventToLatLng:function(l){return this.layerPointToLatLng(this.mouseEventToLayerPoint(l))},_initContainer:function(l){var h=this._container=uN(l);if(h){if(h._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Dt(h,"scroll",this._onScroll,this),this._containerId=d(h)},_initLayout:function(){var l=this._container;this._fadeAnimated=this.options.fadeAnimation&&at.any3d,Lt(l,"leaflet-container"+(at.touch?" leaflet-touch":"")+(at.retina?" leaflet-retina":"")+(at.ielt9?" leaflet-oldie":"")+(at.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=du(l,"position");h!=="absolute"&&h!=="relative"&&h!=="fixed"&&h!=="sticky"&&(l.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var l=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Fn(this._mapPane,new T(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Lt(l.markerPane,"leaflet-zoom-hide"),Lt(l.shadowPane,"leaflet-zoom-hide"))},_resetView:function(l,h,_){Fn(this._mapPane,new T(0,0));var k=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var M=this._zoom!==h;this._moveStart(M,_)._move(l,h)._moveEnd(M),this.fire("viewreset"),k&&this.fire("load")},_moveStart:function(l,h){return l&&this.fire("zoomstart"),h||this.fire("movestart"),this},_move:function(l,h,_,k){h===void 0&&(h=this._zoom);var M=this._zoom!==h;return this._zoom=h,this._lastCenter=l,this._pixelOrigin=this._getNewPixelOrigin(l),k?_&&_.pinch&&this.fire("zoom",_):((M||_&&_.pinch)&&this.fire("zoom",_),this.fire("move",_)),this},_moveEnd:function(l){return l&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return W(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(l){Fn(this._mapPane,this._getMapPanePos().subtract(l))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(l){this._targets={},this._targets[d(this._container)]=this;var h=l?un:Dt;h(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),at.any3d&&this.options.transform3DLimit&&(l?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){W(this._resizeRequest),this._resizeRequest=D(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var l=this._getMapPanePos();Math.max(Math.abs(l.x),Math.abs(l.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(l,h){for(var _=[],k,M=h==="mouseout"||h==="mouseover",Z=l.target||l.srcElement,ce=!1;Z;){if(k=this._targets[d(Z)],k&&(h==="click"||h==="preclick")&&this._draggableMoved(k)){ce=!0;break}if(k&&k.listens(h,!0)&&(M&&!Ax(Z,l)||(_.push(k),M))||Z===this._container)break;Z=Z.parentNode}return!_.length&&!ce&&!M&&this.listens(h,!0)&&(_=[this]),_},_isClickDisabled:function(l){for(;l&&l!==this._container;){if(l._leaflet_disable_click)return!0;l=l.parentNode}},_handleDOMEvent:function(l){var h=l.target||l.srcElement;if(!(!this._loaded||h._leaflet_disable_events||l.type==="click"&&this._isClickDisabled(h))){var _=l.type;_==="mousedown"&&jx(h),this._fireDOMEvent(l,_)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(l,h,_){if(l.type==="click"){var k=a({},l);k.type="preclick",this._fireDOMEvent(k,k.type,_)}var M=this._findEventTargets(l,h);if(_){for(var Z=[],ce=0;ce<_.length;ce++)_[ce].listens(h,!0)&&Z.push(_[ce]);M=Z.concat(M)}if(M.length){h==="contextmenu"&&ms(l);var me=M[0],ye={originalEvent:l};if(l.type!=="keypress"&&l.type!=="keydown"&&l.type!=="keyup"){var Ce=me.getLatLng&&(!me._radius||me._radius<=10);ye.containerPoint=Ce?this.latLngToContainerPoint(me.getLatLng()):this.mouseEventToContainerPoint(l),ye.layerPoint=this.containerPointToLayerPoint(ye.containerPoint),ye.latlng=Ce?me.getLatLng():this.layerPointToLatLng(ye.layerPoint)}for(ce=0;ce<M.length;ce++)if(M[ce].fire(h,ye,!0),ye.originalEvent._stopped||M[ce].options.bubblingMouseEvents===!1&&S(this._mouseEvents,h)!==-1)return}},_draggableMoved:function(l){return l=l.dragging&&l.dragging.enabled()?l:this,l.dragging&&l.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var l=0,h=this._handlers.length;l<h;l++)this._handlers[l].disable()},whenReady:function(l,h){return this._loaded?l.call(h||this,{target:this}):this.on("load",l,h),this},_getMapPanePos:function(){return Xo(this._mapPane)||new T(0,0)},_moved:function(){var l=this._getMapPanePos();return l&&!l.equals([0,0])},_getTopLeftPoint:function(l,h){var _=l&&h!==void 0?this._getNewPixelOrigin(l,h):this.getPixelOrigin();return _.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(l,h){var _=this.getSize()._divideBy(2);return this.project(l,h)._subtract(_)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(l,h,_){var k=this._getNewPixelOrigin(_,h);return this.project(l,h)._subtract(k)},_latLngBoundsToNewLayerBounds:function(l,h,_){var k=this._getNewPixelOrigin(_,h);return O([this.project(l.getSouthWest(),h)._subtract(k),this.project(l.getNorthWest(),h)._subtract(k),this.project(l.getSouthEast(),h)._subtract(k),this.project(l.getNorthEast(),h)._subtract(k)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(l){return this.latLngToLayerPoint(l).subtract(this._getCenterLayerPoint())},_limitCenter:function(l,h,_){if(!_)return l;var k=this.project(l,h),M=this.getSize().divideBy(2),Z=new B(k.subtract(M),k.add(M)),ce=this._getBoundsOffset(Z,_,h);return Math.abs(ce.x)<=1&&Math.abs(ce.y)<=1?l:this.unproject(k.add(ce),h)},_limitOffset:function(l,h){if(!h)return l;var _=this.getPixelBounds(),k=new B(_.min.add(l),_.max.add(l));return l.add(this._getBoundsOffset(k,h))},_getBoundsOffset:function(l,h,_){var k=O(this.project(h.getNorthEast(),_),this.project(h.getSouthWest(),_)),M=k.min.subtract(l.min),Z=k.max.subtract(l.max),ce=this._rebound(M.x,-Z.x),me=this._rebound(M.y,-Z.y);return new T(ce,me)},_rebound:function(l,h){return l+h>0?Math.round(l-h)/2:Math.max(0,Math.ceil(l))-Math.max(0,Math.floor(h))},_limitZoom:function(l){var h=this.getMinZoom(),_=this.getMaxZoom(),k=at.any3d?this.options.zoomSnap:1;return k&&(l=Math.round(l/k)*k),Math.max(h,Math.min(_,l))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Mn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(l,h){var _=this._getCenterOffset(l)._trunc();return(h&&h.animate)!==!0&&!this.getSize().contains(_)?!1:(this.panBy(_,h),!0)},_createAnimProxy:function(){var l=this._proxy=sn("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(l),this.on("zoomanim",function(h){var _=gx,k=this._proxy.style[_];Yo(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),k===this._proxy.style[_]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){bn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var l=this.getCenter(),h=this.getZoom();Yo(this._proxy,this.project(l,h),this.getZoomScale(h,1))},_catchTransitionEnd:function(l){this._animatingZoom&&l.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(l,h,_){if(this._animatingZoom)return!0;if(_=_||{},!this._zoomAnimated||_.animate===!1||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var k=this.getZoomScale(h),M=this._getCenterOffset(l)._divideBy(1-1/k);return _.animate!==!0&&!this.getSize().contains(M)?!1:(D(function(){this._moveStart(!0,_.noMoveStart||!1)._animateZoom(l,h,!0)},this),!0)},_animateZoom:function(l,h,_,k){this._mapPane&&(_&&(this._animatingZoom=!0,this._animateToCenter=l,this._animateToZoom=h,Lt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:l,zoom:h,noUpdate:k}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Mn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function FO(l,h){return new Xt(l,h)}var Qr=G.extend({options:{position:"topright"},initialize:function(l){x(this,l)},getPosition:function(){return this.options.position},setPosition:function(l){var h=this._map;return h&&h.removeControl(this),this.options.position=l,h&&h.addControl(this),this},getContainer:function(){return this._container},addTo:function(l){this.remove(),this._map=l;var h=this._container=this.onAdd(l),_=this.getPosition(),k=l._controlCorners[_];return Lt(h,"leaflet-control"),_.indexOf("bottom")!==-1?k.insertBefore(h,k.firstChild):k.appendChild(h),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(bn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(l){this._map&&l&&l.screenX>0&&l.screenY>0&&this._map.getContainer().focus()}}),pu=function(l){return new Qr(l)};Xt.include({addControl:function(l){return l.addTo(this),this},removeControl:function(l){return l.remove(),this},_initControlPos:function(){var l=this._controlCorners={},h="leaflet-",_=this._controlContainer=sn("div",h+"control-container",this._container);function k(M,Z){var ce=h+M+" "+h+Z;l[M+Z]=sn("div",ce,_)}k("top","left"),k("top","right"),k("bottom","left"),k("bottom","right")},_clearControlPos:function(){for(var l in this._controlCorners)bn(this._controlCorners[l]);bn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var vN=Qr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(l,h,_,k){return _<k?-1:k<_?1:0}},initialize:function(l,h,_){x(this,_),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var k in l)this._addLayer(l[k],k);for(k in h)this._addLayer(h[k],k,!0)},onAdd:function(l){this._initLayout(),this._update(),this._map=l,l.on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(l){return Qr.prototype.addTo.call(this,l),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(l,h){return this._addLayer(l,h),this._map?this._update():this},addOverlay:function(l,h){return this._addLayer(l,h,!0),this._map?this._update():this},removeLayer:function(l){l.off("add remove",this._onLayerChange,this);var h=this._getLayer(d(l));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this},expand:function(){Lt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var l=this._map.getSize().y-(this._container.offsetTop+50);return l<this._section.clientHeight?(Lt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=l+"px"):Mn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Mn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var l="leaflet-control-layers",h=this._container=sn("div",l),_=this.options.collapsed;h.setAttribute("aria-haspopup",!0),fu(h),Ex(h);var k=this._section=sn("section",l+"-list");_&&(this._map.on("click",this.collapse,this),Dt(h,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var M=this._layersLink=sn("a",l+"-toggle",h);M.href="#",M.title="Layers",M.setAttribute("role","button"),Dt(M,{keydown:function(Z){Z.keyCode===13&&this._expandSafely()},click:function(Z){ms(Z),this._expandSafely()}},this),_||this.expand(),this._baseLayersList=sn("div",l+"-base",k),this._separator=sn("div",l+"-separator",k),this._overlaysList=sn("div",l+"-overlays",k),h.appendChild(k)},_getLayer:function(l){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&d(this._layers[h].layer)===l)return this._layers[h]},_addLayer:function(l,h,_){this._map&&l.on("add remove",this._onLayerChange,this),this._layers.push({layer:l,name:h,overlay:_}),this.options.sortLayers&&this._layers.sort(o(function(k,M){return this.options.sortFunction(k.layer,M.layer,k.name,M.name)},this)),this.options.autoZIndex&&l.setZIndex&&(this._lastZIndex++,l.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ef(this._baseLayersList),ef(this._overlaysList),this._layerControlInputs=[];var l,h,_,k,M=0;for(_=0;_<this._layers.length;_++)k=this._layers[_],this._addItem(k),h=h||k.overlay,l=l||!k.overlay,M+=k.overlay?0:1;return this.options.hideSingleBase&&(l=l&&M>1,this._baseLayersList.style.display=l?"":"none"),this._separator.style.display=h&&l?"":"none",this},_onLayerChange:function(l){this._handlingClick||this._update();var h=this._getLayer(d(l.target)),_=h.overlay?l.type==="add"?"overlayadd":"overlayremove":l.type==="add"?"baselayerchange":null;_&&this._map.fire(_,h)},_createRadioElement:function(l,h){var _='<input type="radio" class="leaflet-control-layers-selector" name="'+l+'"'+(h?' checked="checked"':"")+"/>",k=document.createElement("div");return k.innerHTML=_,k.firstChild},_addItem:function(l){var h=document.createElement("label"),_=this._map.hasLayer(l.layer),k;l.overlay?(k=document.createElement("input"),k.type="checkbox",k.className="leaflet-control-layers-selector",k.defaultChecked=_):k=this._createRadioElement("leaflet-base-layers_"+d(this),_),this._layerControlInputs.push(k),k.layerId=d(l.layer),Dt(k,"click",this._onInputClick,this);var M=document.createElement("span");M.innerHTML=" "+l.name;var Z=document.createElement("span");h.appendChild(Z),Z.appendChild(k),Z.appendChild(M);var ce=l.overlay?this._overlaysList:this._baseLayersList;return ce.appendChild(h),this._checkDisabledLayers(),h},_onInputClick:function(){if(!this._preventClick){var l=this._layerControlInputs,h,_,k=[],M=[];this._handlingClick=!0;for(var Z=l.length-1;Z>=0;Z--)h=l[Z],_=this._getLayer(h.layerId).layer,h.checked?k.push(_):h.checked||M.push(_);for(Z=0;Z<M.length;Z++)this._map.hasLayer(M[Z])&&this._map.removeLayer(M[Z]);for(Z=0;Z<k.length;Z++)this._map.hasLayer(k[Z])||this._map.addLayer(k[Z]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var l=this._layerControlInputs,h,_,k=this._map.getZoom(),M=l.length-1;M>=0;M--)h=l[M],_=this._getLayer(h.layerId).layer,h.disabled=_.options.minZoom!==void 0&&k<_.options.minZoom||_.options.maxZoom!==void 0&&k>_.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var l=this._section;this._preventClick=!0,Dt(l,"click",ms),this.expand();var h=this;setTimeout(function(){un(l,"click",ms),h._preventClick=!1})}}),BO=function(l,h,_){return new vN(l,h,_)},Px=Qr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(l){var h="leaflet-control-zoom",_=sn("div",h+" leaflet-bar"),k=this.options;return this._zoomInButton=this._createButton(k.zoomInText,k.zoomInTitle,h+"-in",_,this._zoomIn),this._zoomOutButton=this._createButton(k.zoomOutText,k.zoomOutTitle,h+"-out",_,this._zoomOut),this._updateDisabled(),l.on("zoomend zoomlevelschange",this._updateDisabled,this),_},onRemove:function(l){l.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(l){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(l.shiftKey?3:1))},_zoomOut:function(l){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(l.shiftKey?3:1))},_createButton:function(l,h,_,k,M){var Z=sn("a",_,k);return Z.innerHTML=l,Z.href="#",Z.title=h,Z.setAttribute("role","button"),Z.setAttribute("aria-label",h),fu(Z),Dt(Z,"click",el),Dt(Z,"click",M,this),Dt(Z,"click",this._refocusOnMap,this),Z},_updateDisabled:function(){var l=this._map,h="leaflet-disabled";Mn(this._zoomInButton,h),Mn(this._zoomOutButton,h),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||l._zoom===l.getMinZoom())&&(Lt(this._zoomOutButton,h),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||l._zoom===l.getMaxZoom())&&(Lt(this._zoomInButton,h),this._zoomInButton.setAttribute("aria-disabled","true"))}});Xt.mergeOptions({zoomControl:!0}),Xt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Px,this.addControl(this.zoomControl))});var zO=function(l){return new Px(l)},yN=Qr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(l){var h="leaflet-control-scale",_=sn("div",h),k=this.options;return this._addScales(k,h+"-line",_),l.on(k.updateWhenIdle?"moveend":"move",this._update,this),l.whenReady(this._update,this),_},onRemove:function(l){l.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(l,h,_){l.metric&&(this._mScale=sn("div",h,_)),l.imperial&&(this._iScale=sn("div",h,_))},_update:function(){var l=this._map,h=l.getSize().y/2,_=l.distance(l.containerPointToLatLng([0,h]),l.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(_)},_updateScales:function(l){this.options.metric&&l&&this._updateMetric(l),this.options.imperial&&l&&this._updateImperial(l)},_updateMetric:function(l){var h=this._getRoundNum(l),_=h<1e3?h+" m":h/1e3+" km";this._updateScale(this._mScale,_,h/l)},_updateImperial:function(l){var h=l*3.2808399,_,k,M;h>5280?(_=h/5280,k=this._getRoundNum(_),this._updateScale(this._iScale,k+" mi",k/_)):(M=this._getRoundNum(h),this._updateScale(this._iScale,M+" ft",M/h))},_updateScale:function(l,h,_){l.style.width=Math.round(this.options.maxWidth*_)+"px",l.innerHTML=h},_getRoundNum:function(l){var h=Math.pow(10,(Math.floor(l)+"").length-1),_=l/h;return _=_>=10?10:_>=5?5:_>=3?3:_>=2?2:1,h*_}}),$O=function(l){return new yN(l)},UO='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Dx=Qr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(at.inlineSvg?UO+" ":"")+"Leaflet</a>"},initialize:function(l){x(this,l),this._attributions={}},onAdd:function(l){l.attributionControl=this,this._container=sn("div","leaflet-control-attribution"),fu(this._container);for(var h in l._layers)l._layers[h].getAttribution&&this.addAttribution(l._layers[h].getAttribution());return this._update(),l.on("layeradd",this._addAttribution,this),this._container},onRemove:function(l){l.off("layeradd",this._addAttribution,this)},_addAttribution:function(l){l.layer.getAttribution&&(this.addAttribution(l.layer.getAttribution()),l.layer.once("remove",function(){this.removeAttribution(l.layer.getAttribution())},this))},setPrefix:function(l){return this.options.prefix=l,this._update(),this},addAttribution:function(l){return l?(this._attributions[l]||(this._attributions[l]=0),this._attributions[l]++,this._update(),this):this},removeAttribution:function(l){return l?(this._attributions[l]&&(this._attributions[l]--,this._update()),this):this},_update:function(){if(this._map){var l=[];for(var h in this._attributions)this._attributions[h]&&l.push(h);var _=[];this.options.prefix&&_.push(this.options.prefix),l.length&&_.push(l.join(", ")),this._container.innerHTML=_.join(' <span aria-hidden="true">|</span> ')}}});Xt.mergeOptions({attributionControl:!0}),Xt.addInitHook(function(){this.options.attributionControl&&new Dx().addTo(this)});var qO=function(l){return new Dx(l)};Qr.Layers=vN,Qr.Zoom=Px,Qr.Scale=yN,Qr.Attribution=Dx,pu.layers=BO,pu.zoom=zO,pu.scale=$O,pu.attribution=qO;var Sa=G.extend({initialize:function(l){this._map=l},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Sa.addTo=function(l,h){return l.addHandler(h,this),this};var HO={Events:X},_N=at.touch?"touchstart mousedown":"mousedown",Oi=F.extend({options:{clickTolerance:3},initialize:function(l,h,_,k){x(this,k),this._element=l,this._dragStartTarget=h||l,this._preventOutline=_},enable:function(){this._enabled||(Dt(this._dragStartTarget,_N,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Oi._dragging===this&&this.finishDrag(!0),un(this._dragStartTarget,_N,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(l){if(this._enabled&&(this._moved=!1,!xx(this._element,"leaflet-zoom-anim"))){if(l.touches&&l.touches.length!==1){Oi._dragging===this&&this.finishDrag();return}if(!(Oi._dragging||l.shiftKey||l.which!==1&&l.button!==1&&!l.touches)&&(Oi._dragging=this,this._preventOutline&&jx(this._element),_x(),uu(),!this._moving)){this.fire("down");var h=l.touches?l.touches[0]:l,_=hN(this._element);this._startPoint=new T(h.clientX,h.clientY),this._startPos=Xo(this._element),this._parentScale=Nx(_);var k=l.type==="mousedown";Dt(document,k?"mousemove":"touchmove",this._onMove,this),Dt(document,k?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(l){if(this._enabled){if(l.touches&&l.touches.length>1){this._moved=!0;return}var h=l.touches&&l.touches.length===1?l.touches[0]:l,_=new T(h.clientX,h.clientY)._subtract(this._startPoint);!_.x&&!_.y||Math.abs(_.x)+Math.abs(_.y)<this.options.clickTolerance||(_.x/=this._parentScale.x,_.y/=this._parentScale.y,ms(l),this._moved||(this.fire("dragstart"),this._moved=!0,Lt(document.body,"leaflet-dragging"),this._lastTarget=l.target||l.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Lt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(_),this._moving=!0,this._lastEvent=l,this._updatePosition())}},_updatePosition:function(){var l={originalEvent:this._lastEvent};this.fire("predrag",l),Fn(this._element,this._newPos),this.fire("drag",l)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(l){Mn(document.body,"leaflet-dragging"),this._lastTarget&&(Mn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),un(document,"mousemove touchmove",this._onMove,this),un(document,"mouseup touchend touchcancel",this._onUp,this),wx(),hu();var h=this._moved&&this._moving;this._moving=!1,Oi._dragging=!1,h&&this.fire("dragend",{noInertia:l,distance:this._newPos.distanceTo(this._startPos)})}});function wN(l,h,_){var k,M=[1,4,2,8],Z,ce,me,ye,Ce,Ge,_t,Ut;for(Z=0,Ge=l.length;Z<Ge;Z++)l[Z]._code=tl(l[Z],h);for(me=0;me<4;me++){for(_t=M[me],k=[],Z=0,Ge=l.length,ce=Ge-1;Z<Ge;ce=Z++)ye=l[Z],Ce=l[ce],ye._code&_t?Ce._code&_t||(Ut=af(Ce,ye,_t,h,_),Ut._code=tl(Ut,h),k.push(Ut)):(Ce._code&_t&&(Ut=af(Ce,ye,_t,h,_),Ut._code=tl(Ut,h),k.push(Ut)),k.push(ye));l=k}return l}function bN(l,h){var _,k,M,Z,ce,me,ye,Ce,Ge;if(!l||l.length===0)throw new Error("latlngs not passed");Er(l)||(console.warn("latlngs are not flat! Only the first ring will be used"),l=l[0]);var _t=ee([0,0]),Ut=$(l),Rs=Ut.getNorthWest().distanceTo(Ut.getSouthWest())*Ut.getNorthEast().distanceTo(Ut.getNorthWest());Rs<1700&&(_t=Tx(l));var ss=l.length,Ar=[];for(_=0;_<ss;_++){var Hs=ee(l[_]);Ar.push(h.project(ee([Hs.lat-_t.lat,Hs.lng-_t.lng])))}for(me=ye=Ce=0,_=0,k=ss-1;_<ss;k=_++)M=Ar[_],Z=Ar[k],ce=M.y*Z.x-Z.y*M.x,ye+=(M.x+Z.x)*ce,Ce+=(M.y+Z.y)*ce,me+=ce*3;me===0?Ge=Ar[0]:Ge=[ye/me,Ce/me];var yc=h.unproject(U(Ge));return ee([yc.lat+_t.lat,yc.lng+_t.lng])}function Tx(l){for(var h=0,_=0,k=0,M=0;M<l.length;M++){var Z=ee(l[M]);h+=Z.lat,_+=Z.lng,k++}return ee([h/k,_/k])}var WO={__proto__:null,clipPolygon:wN,polygonCenter:bN,centroid:Tx};function jN(l,h){if(!h||!l.length)return l.slice();var _=h*h;return l=ZO(l,_),l=KO(l,_),l}function NN(l,h,_){return Math.sqrt(gu(l,h,_,!0))}function VO(l,h,_){return gu(l,h,_)}function KO(l,h){var _=l.length,k=typeof Uint8Array<"u"?Uint8Array:Array,M=new k(_);M[0]=M[_-1]=1,Mx(l,M,h,0,_-1);var Z,ce=[];for(Z=0;Z<_;Z++)M[Z]&&ce.push(l[Z]);return ce}function Mx(l,h,_,k,M){var Z=0,ce,me,ye;for(me=k+1;me<=M-1;me++)ye=gu(l[me],l[k],l[M],!0),ye>Z&&(ce=me,Z=ye);Z>_&&(h[ce]=1,Mx(l,h,_,k,ce),Mx(l,h,_,ce,M))}function ZO(l,h){for(var _=[l[0]],k=1,M=0,Z=l.length;k<Z;k++)GO(l[k],l[M])>h&&(_.push(l[k]),M=k);return M<Z-1&&_.push(l[Z-1]),_}var SN;function kN(l,h,_,k,M){var Z=k?SN:tl(l,_),ce=tl(h,_),me,ye,Ce;for(SN=ce;;){if(!(Z|ce))return[l,h];if(Z&ce)return!1;me=Z||ce,ye=af(l,h,me,_,M),Ce=tl(ye,_),me===Z?(l=ye,Z=Ce):(h=ye,ce=Ce)}}function af(l,h,_,k,M){var Z=h.x-l.x,ce=h.y-l.y,me=k.min,ye=k.max,Ce,Ge;return _&8?(Ce=l.x+Z*(ye.y-l.y)/ce,Ge=ye.y):_&4?(Ce=l.x+Z*(me.y-l.y)/ce,Ge=me.y):_&2?(Ce=ye.x,Ge=l.y+ce*(ye.x-l.x)/Z):_&1&&(Ce=me.x,Ge=l.y+ce*(me.x-l.x)/Z),new T(Ce,Ge,M)}function tl(l,h){var _=0;return l.x<h.min.x?_|=1:l.x>h.max.x&&(_|=2),l.y<h.min.y?_|=4:l.y>h.max.y&&(_|=8),_}function GO(l,h){var _=h.x-l.x,k=h.y-l.y;return _*_+k*k}function gu(l,h,_,k){var M=h.x,Z=h.y,ce=_.x-M,me=_.y-Z,ye=ce*ce+me*me,Ce;return ye>0&&(Ce=((l.x-M)*ce+(l.y-Z)*me)/ye,Ce>1?(M=_.x,Z=_.y):Ce>0&&(M+=ce*Ce,Z+=me*Ce)),ce=l.x-M,me=l.y-Z,k?ce*ce+me*me:new T(M,Z)}function Er(l){return!N(l[0])||typeof l[0][0]!="object"&&typeof l[0][0]<"u"}function CN(l){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Er(l)}function EN(l,h){var _,k,M,Z,ce,me,ye,Ce;if(!l||l.length===0)throw new Error("latlngs not passed");Er(l)||(console.warn("latlngs are not flat! Only the first ring will be used"),l=l[0]);var Ge=ee([0,0]),_t=$(l),Ut=_t.getNorthWest().distanceTo(_t.getSouthWest())*_t.getNorthEast().distanceTo(_t.getNorthWest());Ut<1700&&(Ge=Tx(l));var Rs=l.length,ss=[];for(_=0;_<Rs;_++){var Ar=ee(l[_]);ss.push(h.project(ee([Ar.lat-Ge.lat,Ar.lng-Ge.lng])))}for(_=0,k=0;_<Rs-1;_++)k+=ss[_].distanceTo(ss[_+1])/2;if(k===0)Ce=ss[0];else for(_=0,Z=0;_<Rs-1;_++)if(ce=ss[_],me=ss[_+1],M=ce.distanceTo(me),Z+=M,Z>k){ye=(Z-k)/M,Ce=[me.x-ye*(me.x-ce.x),me.y-ye*(me.y-ce.y)];break}var Hs=h.unproject(U(Ce));return ee([Hs.lat+Ge.lat,Hs.lng+Ge.lng])}var QO={__proto__:null,simplify:jN,pointToSegmentDistance:NN,closestPointOnSegment:VO,clipSegment:kN,_getEdgeIntersection:af,_getBitCode:tl,_sqClosestPointOnSegment:gu,isFlat:Er,_flat:CN,polylineCenter:EN},Rx={project:function(l){return new T(l.lng,l.lat)},unproject:function(l){return new te(l.y,l.x)},bounds:new B([-180,-90],[180,90])},Ix={R:6378137,R_MINOR:6356752314245179e-9,bounds:new B([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(l){var h=Math.PI/180,_=this.R,k=l.lat*h,M=this.R_MINOR/_,Z=Math.sqrt(1-M*M),ce=Z*Math.sin(k),me=Math.tan(Math.PI/4-k/2)/Math.pow((1-ce)/(1+ce),Z/2);return k=-_*Math.log(Math.max(me,1e-10)),new T(l.lng*h*_,k)},unproject:function(l){for(var h=180/Math.PI,_=this.R,k=this.R_MINOR/_,M=Math.sqrt(1-k*k),Z=Math.exp(-l.y/_),ce=Math.PI/2-2*Math.atan(Z),me=0,ye=.1,Ce;me<15&&Math.abs(ye)>1e-7;me++)Ce=M*Math.sin(ce),Ce=Math.pow((1-Ce)/(1+Ce),M/2),ye=Math.PI/2-2*Math.atan(Z*Ce)-ce,ce+=ye;return new te(ce*h,l.x*h/_)}},YO={__proto__:null,LonLat:Rx,Mercator:Ix,SphericalMercator:J},XO=a({},le,{code:"EPSG:3395",projection:Ix,transformation:function(){var l=.5/(Math.PI*Ix.R);return fe(l,.5,-l,.5)}()}),AN=a({},le,{code:"EPSG:4326",projection:Rx,transformation:fe(1/180,1,-1/180,.5)}),JO=a({},Q,{projection:Rx,transformation:fe(1,0,-1,0),scale:function(l){return Math.pow(2,l)},zoom:function(l){return Math.log(l)/Math.LN2},distance:function(l,h){var _=h.lng-l.lng,k=h.lat-l.lat;return Math.sqrt(_*_+k*k)},infinite:!0});Q.Earth=le,Q.EPSG3395=XO,Q.EPSG3857=he,Q.EPSG900913=ve,Q.EPSG4326=AN,Q.Simple=JO;var Yr=F.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(l){return l.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(l){return l&&l.removeLayer(this),this},getPane:function(l){return this._map.getPane(l?this.options[l]||l:this.options.pane)},addInteractiveTarget:function(l){return this._map._targets[d(l)]=this,this},removeInteractiveTarget:function(l){return delete this._map._targets[d(l)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(l){var h=l.target;if(h.hasLayer(this)){if(this._map=h,this._zoomAnimated=h._zoomAnimated,this.getEvents){var _=this.getEvents();h.on(_,this),this.once("remove",function(){h.off(_,this)},this)}this.onAdd(h),this.fire("add"),h.fire("layeradd",{layer:this})}}});Xt.include({addLayer:function(l){if(!l._layerAdd)throw new Error("The provided object is not a Layer.");var h=d(l);return this._layers[h]?this:(this._layers[h]=l,l._mapToAdd=this,l.beforeAdd&&l.beforeAdd(this),this.whenReady(l._layerAdd,l),this)},removeLayer:function(l){var h=d(l);return this._layers[h]?(this._loaded&&l.onRemove(this),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:l}),l.fire("remove")),l._map=l._mapToAdd=null,this):this},hasLayer:function(l){return d(l)in this._layers},eachLayer:function(l,h){for(var _ in this._layers)l.call(h,this._layers[_]);return this},_addLayers:function(l){l=l?N(l)?l:[l]:[];for(var h=0,_=l.length;h<_;h++)this.addLayer(l[h])},_addZoomLimit:function(l){(!isNaN(l.options.maxZoom)||!isNaN(l.options.minZoom))&&(this._zoomBoundLayers[d(l)]=l,this._updateZoomLevels())},_removeZoomLimit:function(l){var h=d(l);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels())},_updateZoomLevels:function(){var l=1/0,h=-1/0,_=this._getZoomSpan();for(var k in this._zoomBoundLayers){var M=this._zoomBoundLayers[k].options;l=M.minZoom===void 0?l:Math.min(l,M.minZoom),h=M.maxZoom===void 0?h:Math.max(h,M.maxZoom)}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=l===1/0?void 0:l,_!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var fc=Yr.extend({initialize:function(l,h){x(this,h),this._layers={};var _,k;if(l)for(_=0,k=l.length;_<k;_++)this.addLayer(l[_])},addLayer:function(l){var h=this.getLayerId(l);return this._layers[h]=l,this._map&&this._map.addLayer(l),this},removeLayer:function(l){var h=l in this._layers?l:this.getLayerId(l);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this},hasLayer:function(l){var h=typeof l=="number"?l:this.getLayerId(l);return h in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(l){var h=Array.prototype.slice.call(arguments,1),_,k;for(_ in this._layers)k=this._layers[_],k[l]&&k[l].apply(k,h);return this},onAdd:function(l){this.eachLayer(l.addLayer,l)},onRemove:function(l){this.eachLayer(l.removeLayer,l)},eachLayer:function(l,h){for(var _ in this._layers)l.call(h,this._layers[_]);return this},getLayer:function(l){return this._layers[l]},getLayers:function(){var l=[];return this.eachLayer(l.push,l),l},setZIndex:function(l){return this.invoke("setZIndex",l)},getLayerId:function(l){return d(l)}}),e6=function(l,h){return new fc(l,h)},si=fc.extend({addLayer:function(l){return this.hasLayer(l)?this:(l.addEventParent(this),fc.prototype.addLayer.call(this,l),this.fire("layeradd",{layer:l}))},removeLayer:function(l){return this.hasLayer(l)?(l in this._layers&&(l=this._layers[l]),l.removeEventParent(this),fc.prototype.removeLayer.call(this,l),this.fire("layerremove",{layer:l})):this},setStyle:function(l){return this.invoke("setStyle",l)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var l=new z;for(var h in this._layers){var _=this._layers[h];l.extend(_.getBounds?_.getBounds():_.getLatLng())}return l}}),t6=function(l,h){return new si(l,h)},pc=G.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(l){x(this,l)},createIcon:function(l){return this._createIcon("icon",l)},createShadow:function(l){return this._createIcon("shadow",l)},_createIcon:function(l,h){var _=this._getIconUrl(l);if(!_){if(l==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var k=this._createImg(_,h&&h.tagName==="IMG"?h:null);return this._setIconStyles(k,l),(this.options.crossOrigin||this.options.crossOrigin==="")&&(k.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),k},_setIconStyles:function(l,h){var _=this.options,k=_[h+"Size"];typeof k=="number"&&(k=[k,k]);var M=U(k),Z=U(h==="shadow"&&_.shadowAnchor||_.iconAnchor||M&&M.divideBy(2,!0));l.className="leaflet-marker-"+h+" "+(_.className||""),Z&&(l.style.marginLeft=-Z.x+"px",l.style.marginTop=-Z.y+"px"),M&&(l.style.width=M.x+"px",l.style.height=M.y+"px")},_createImg:function(l,h){return h=h||document.createElement("img"),h.src=l,h},_getIconUrl:function(l){return at.retina&&this.options[l+"RetinaUrl"]||this.options[l+"Url"]}});function n6(l){return new pc(l)}var xu=pc.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(l){return typeof xu.imagePath!="string"&&(xu.imagePath=this._detectIconPath()),(this.options.imagePath||xu.imagePath)+pc.prototype._getIconUrl.call(this,l)},_stripUrl:function(l){var h=function(_,k,M){var Z=k.exec(_);return Z&&Z[M]};return l=h(l,/^url\((['"])?(.+)\1\)$/,2),l&&h(l,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var l=sn("div","leaflet-default-icon-path",document.body),h=du(l,"background-image")||du(l,"backgroundImage");if(document.body.removeChild(l),h=this._stripUrl(h),h)return h;var _=document.querySelector('link[href$="leaflet.css"]');return _?_.href.substring(0,_.href.length-11-1):""}}),PN=Sa.extend({initialize:function(l){this._marker=l},addHooks:function(){var l=this._marker._icon;this._draggable||(this._draggable=new Oi(l,l,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Lt(l,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Mn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(l){var h=this._marker,_=h._map,k=this._marker.options.autoPanSpeed,M=this._marker.options.autoPanPadding,Z=Xo(h._icon),ce=_.getPixelBounds(),me=_.getPixelOrigin(),ye=O(ce.min._subtract(me).add(M),ce.max._subtract(me).subtract(M));if(!ye.contains(Z)){var Ce=U((Math.max(ye.max.x,Z.x)-ye.max.x)/(ce.max.x-ye.max.x)-(Math.min(ye.min.x,Z.x)-ye.min.x)/(ce.min.x-ye.min.x),(Math.max(ye.max.y,Z.y)-ye.max.y)/(ce.max.y-ye.max.y)-(Math.min(ye.min.y,Z.y)-ye.min.y)/(ce.min.y-ye.min.y)).multiplyBy(k);_.panBy(Ce,{animate:!1}),this._draggable._newPos._add(Ce),this._draggable._startPos._add(Ce),Fn(h._icon,this._draggable._newPos),this._onDrag(l),this._panRequest=D(this._adjustPan.bind(this,l))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(l){this._marker.options.autoPan&&(W(this._panRequest),this._panRequest=D(this._adjustPan.bind(this,l)))},_onDrag:function(l){var h=this._marker,_=h._shadow,k=Xo(h._icon),M=h._map.layerPointToLatLng(k);_&&Fn(_,k),h._latlng=M,l.latlng=M,l.oldLatLng=this._oldLatLng,h.fire("move",l).fire("drag",l)},_onDragEnd:function(l){W(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",l)}}),of=Yr.extend({options:{icon:new xu,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(l,h){x(this,h),this._latlng=ee(l)},onAdd:function(l){this._zoomAnimated=this._zoomAnimated&&l.options.markerZoomAnimation,this._zoomAnimated&&l.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(l){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&l.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(l){var h=this._latlng;return this._latlng=ee(l),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},setZIndexOffset:function(l){return this.options.zIndexOffset=l,this.update()},getIcon:function(){return this.options.icon},setIcon:function(l){return this.options.icon=l,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var l=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(l)}return this},_initIcon:function(){var l=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),_=l.icon.createIcon(this._icon),k=!1;_!==this._icon&&(this._icon&&this._removeIcon(),k=!0,l.title&&(_.title=l.title),_.tagName==="IMG"&&(_.alt=l.alt||"")),Lt(_,h),l.keyboard&&(_.tabIndex="0",_.setAttribute("role","button")),this._icon=_,l.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Dt(_,"focus",this._panOnFocus,this);var M=l.icon.createShadow(this._shadow),Z=!1;M!==this._shadow&&(this._removeShadow(),Z=!0),M&&(Lt(M,h),M.alt=""),this._shadow=M,l.opacity<1&&this._updateOpacity(),k&&this.getPane().appendChild(this._icon),this._initInteraction(),M&&Z&&this.getPane(l.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&un(this._icon,"focus",this._panOnFocus,this),bn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&bn(this._shadow),this._shadow=null},_setPos:function(l){this._icon&&Fn(this._icon,l),this._shadow&&Fn(this._shadow,l),this._zIndex=l.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(l){this._icon&&(this._icon.style.zIndex=this._zIndex+l)},_animateZoom:function(l){var h=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center).round();this._setPos(h)},_initInteraction:function(){if(this.options.interactive&&(Lt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),PN)){var l=this.options.draggable;this.dragging&&(l=this.dragging.enabled(),this.dragging.disable()),this.dragging=new PN(this),l&&this.dragging.enable()}},setOpacity:function(l){return this.options.opacity=l,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var l=this.options.opacity;this._icon&&Cr(this._icon,l),this._shadow&&Cr(this._shadow,l)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var l=this._map;if(l){var h=this.options.icon.options,_=h.iconSize?U(h.iconSize):U(0,0),k=h.iconAnchor?U(h.iconAnchor):U(0,0);l.panInside(this._latlng,{paddingTopLeft:k,paddingBottomRight:_.subtract(k)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function s6(l,h){return new of(l,h)}var Li=Yr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(l){this._renderer=l.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(l){return x(this,l),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&l&&Object.prototype.hasOwnProperty.call(l,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),lf=Li.extend({options:{fill:!0,radius:10},initialize:function(l,h){x(this,h),this._latlng=ee(l),this._radius=this.options.radius},setLatLng:function(l){var h=this._latlng;return this._latlng=ee(l),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(l){return this.options.radius=this._radius=l,this.redraw()},getRadius:function(){return this._radius},setStyle:function(l){var h=l&&l.radius||this._radius;return Li.prototype.setStyle.call(this,l),this.setRadius(h),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var l=this._radius,h=this._radiusY||l,_=this._clickTolerance(),k=[l+_,h+_];this._pxBounds=new B(this._point.subtract(k),this._point.add(k))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(l){return l.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function r6(l,h){return new lf(l,h)}var Ox=lf.extend({initialize:function(l,h,_){if(typeof h=="number"&&(h=a({},_,{radius:h})),x(this,h),this._latlng=ee(l),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(l){return this._mRadius=l,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var l=[this._radius,this._radiusY||this._radius];return new z(this._map.layerPointToLatLng(this._point.subtract(l)),this._map.layerPointToLatLng(this._point.add(l)))},setStyle:Li.prototype.setStyle,_project:function(){var l=this._latlng.lng,h=this._latlng.lat,_=this._map,k=_.options.crs;if(k.distance===le.distance){var M=Math.PI/180,Z=this._mRadius/le.R/M,ce=_.project([h+Z,l]),me=_.project([h-Z,l]),ye=ce.add(me).divideBy(2),Ce=_.unproject(ye).lat,Ge=Math.acos((Math.cos(Z*M)-Math.sin(h*M)*Math.sin(Ce*M))/(Math.cos(h*M)*Math.cos(Ce*M)))/M;(isNaN(Ge)||Ge===0)&&(Ge=Z/Math.cos(Math.PI/180*h)),this._point=ye.subtract(_.getPixelOrigin()),this._radius=isNaN(Ge)?0:ye.x-_.project([Ce,l-Ge]).x,this._radiusY=ye.y-ce.y}else{var _t=k.unproject(k.project(this._latlng).subtract([this._mRadius,0]));this._point=_.latLngToLayerPoint(this._latlng),this._radius=this._point.x-_.latLngToLayerPoint(_t).x}this._updateBounds()}});function a6(l,h,_){return new Ox(l,h,_)}var ri=Li.extend({options:{smoothFactor:1,noClip:!1},initialize:function(l,h){x(this,h),this._setLatLngs(l)},getLatLngs:function(){return this._latlngs},setLatLngs:function(l){return this._setLatLngs(l),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(l){for(var h=1/0,_=null,k=gu,M,Z,ce=0,me=this._parts.length;ce<me;ce++)for(var ye=this._parts[ce],Ce=1,Ge=ye.length;Ce<Ge;Ce++){M=ye[Ce-1],Z=ye[Ce];var _t=k(l,M,Z,!0);_t<h&&(h=_t,_=k(l,M,Z))}return _&&(_.distance=Math.sqrt(h)),_},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return EN(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(l,h){return h=h||this._defaultShape(),l=ee(l),h.push(l),this._bounds.extend(l),this.redraw()},_setLatLngs:function(l){this._bounds=new z,this._latlngs=this._convertLatLngs(l)},_defaultShape:function(){return Er(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(l){for(var h=[],_=Er(l),k=0,M=l.length;k<M;k++)_?(h[k]=ee(l[k]),this._bounds.extend(h[k])):h[k]=this._convertLatLngs(l[k]);return h},_project:function(){var l=new B;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,l),this._bounds.isValid()&&l.isValid()&&(this._rawPxBounds=l,this._updateBounds())},_updateBounds:function(){var l=this._clickTolerance(),h=new T(l,l);this._rawPxBounds&&(this._pxBounds=new B([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)]))},_projectLatlngs:function(l,h,_){var k=l[0]instanceof te,M=l.length,Z,ce;if(k){for(ce=[],Z=0;Z<M;Z++)ce[Z]=this._map.latLngToLayerPoint(l[Z]),_.extend(ce[Z]);h.push(ce)}else for(Z=0;Z<M;Z++)this._projectLatlngs(l[Z],h,_)},_clipPoints:function(){var l=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(l))){if(this.options.noClip){this._parts=this._rings;return}var h=this._parts,_,k,M,Z,ce,me,ye;for(_=0,M=0,Z=this._rings.length;_<Z;_++)for(ye=this._rings[_],k=0,ce=ye.length;k<ce-1;k++)me=kN(ye[k],ye[k+1],l,k,!0),me&&(h[M]=h[M]||[],h[M].push(me[0]),(me[1]!==ye[k+1]||k===ce-2)&&(h[M].push(me[1]),M++))}},_simplifyPoints:function(){for(var l=this._parts,h=this.options.smoothFactor,_=0,k=l.length;_<k;_++)l[_]=jN(l[_],h)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(l,h){var _,k,M,Z,ce,me,ye=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(l))return!1;for(_=0,Z=this._parts.length;_<Z;_++)for(me=this._parts[_],k=0,ce=me.length,M=ce-1;k<ce;M=k++)if(!(!h&&k===0)&&NN(l,me[M],me[k])<=ye)return!0;return!1}});function i6(l,h){return new ri(l,h)}ri._flat=CN;var gc=ri.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return bN(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(l){var h=ri.prototype._convertLatLngs.call(this,l),_=h.length;return _>=2&&h[0]instanceof te&&h[0].equals(h[_-1])&&h.pop(),h},_setLatLngs:function(l){ri.prototype._setLatLngs.call(this,l),Er(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Er(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var l=this._renderer._bounds,h=this.options.weight,_=new T(h,h);if(l=new B(l.min.subtract(_),l.max.add(_)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(l))){if(this.options.noClip){this._parts=this._rings;return}for(var k=0,M=this._rings.length,Z;k<M;k++)Z=wN(this._rings[k],l,!0),Z.length&&this._parts.push(Z)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(l){var h=!1,_,k,M,Z,ce,me,ye,Ce;if(!this._pxBounds||!this._pxBounds.contains(l))return!1;for(Z=0,ye=this._parts.length;Z<ye;Z++)for(_=this._parts[Z],ce=0,Ce=_.length,me=Ce-1;ce<Ce;me=ce++)k=_[ce],M=_[me],k.y>l.y!=M.y>l.y&&l.x<(M.x-k.x)*(l.y-k.y)/(M.y-k.y)+k.x&&(h=!h);return h||ri.prototype._containsPoint.call(this,l,!0)}});function o6(l,h){return new gc(l,h)}var ai=si.extend({initialize:function(l,h){x(this,h),this._layers={},l&&this.addData(l)},addData:function(l){var h=N(l)?l:l.features,_,k,M;if(h){for(_=0,k=h.length;_<k;_++)M=h[_],(M.geometries||M.geometry||M.features||M.coordinates)&&this.addData(M);return this}var Z=this.options;if(Z.filter&&!Z.filter(l))return this;var ce=cf(l,Z);return ce?(ce.feature=hf(l),ce.defaultOptions=ce.options,this.resetStyle(ce),Z.onEachFeature&&Z.onEachFeature(l,ce),this.addLayer(ce)):this},resetStyle:function(l){return l===void 0?this.eachLayer(this.resetStyle,this):(l.options=a({},l.defaultOptions),this._setLayerStyle(l,this.options.style),this)},setStyle:function(l){return this.eachLayer(function(h){this._setLayerStyle(h,l)},this)},_setLayerStyle:function(l,h){l.setStyle&&(typeof h=="function"&&(h=h(l.feature)),l.setStyle(h))}});function cf(l,h){var _=l.type==="Feature"?l.geometry:l,k=_?_.coordinates:null,M=[],Z=h&&h.pointToLayer,ce=h&&h.coordsToLatLng||Lx,me,ye,Ce,Ge;if(!k&&!_)return null;switch(_.type){case"Point":return me=ce(k),DN(Z,l,me,h);case"MultiPoint":for(Ce=0,Ge=k.length;Ce<Ge;Ce++)me=ce(k[Ce]),M.push(DN(Z,l,me,h));return new si(M);case"LineString":case"MultiLineString":return ye=df(k,_.type==="LineString"?0:1,ce),new ri(ye,h);case"Polygon":case"MultiPolygon":return ye=df(k,_.type==="Polygon"?1:2,ce),new gc(ye,h);case"GeometryCollection":for(Ce=0,Ge=_.geometries.length;Ce<Ge;Ce++){var _t=cf({geometry:_.geometries[Ce],type:"Feature",properties:l.properties},h);_t&&M.push(_t)}return new si(M);case"FeatureCollection":for(Ce=0,Ge=_.features.length;Ce<Ge;Ce++){var Ut=cf(_.features[Ce],h);Ut&&M.push(Ut)}return new si(M);default:throw new Error("Invalid GeoJSON object.")}}function DN(l,h,_,k){return l?l(h,_):new of(_,k&&k.markersInheritOptions&&k)}function Lx(l){return new te(l[1],l[0],l[2])}function df(l,h,_){for(var k=[],M=0,Z=l.length,ce;M<Z;M++)ce=h?df(l[M],h-1,_):(_||Lx)(l[M]),k.push(ce);return k}function Fx(l,h){return l=ee(l),l.alt!==void 0?[p(l.lng,h),p(l.lat,h),p(l.alt,h)]:[p(l.lng,h),p(l.lat,h)]}function uf(l,h,_,k){for(var M=[],Z=0,ce=l.length;Z<ce;Z++)M.push(h?uf(l[Z],Er(l[Z])?0:h-1,_,k):Fx(l[Z],k));return!h&&_&&M.length>0&&M.push(M[0].slice()),M}function xc(l,h){return l.feature?a({},l.feature,{geometry:h}):hf(h)}function hf(l){return l.type==="Feature"||l.type==="FeatureCollection"?l:{type:"Feature",properties:{},geometry:l}}var Bx={toGeoJSON:function(l){return xc(this,{type:"Point",coordinates:Fx(this.getLatLng(),l)})}};of.include(Bx),Ox.include(Bx),lf.include(Bx),ri.include({toGeoJSON:function(l){var h=!Er(this._latlngs),_=uf(this._latlngs,h?1:0,!1,l);return xc(this,{type:(h?"Multi":"")+"LineString",coordinates:_})}}),gc.include({toGeoJSON:function(l){var h=!Er(this._latlngs),_=h&&!Er(this._latlngs[0]),k=uf(this._latlngs,_?2:h?1:0,!0,l);return h||(k=[k]),xc(this,{type:(_?"Multi":"")+"Polygon",coordinates:k})}}),fc.include({toMultiPoint:function(l){var h=[];return this.eachLayer(function(_){h.push(_.toGeoJSON(l).geometry.coordinates)}),xc(this,{type:"MultiPoint",coordinates:h})},toGeoJSON:function(l){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(h==="MultiPoint")return this.toMultiPoint(l);var _=h==="GeometryCollection",k=[];return this.eachLayer(function(M){if(M.toGeoJSON){var Z=M.toGeoJSON(l);if(_)k.push(Z.geometry);else{var ce=hf(Z);ce.type==="FeatureCollection"?k.push.apply(k,ce.features):k.push(ce)}}}),_?xc(this,{geometries:k,type:"GeometryCollection"}):{type:"FeatureCollection",features:k}}});function TN(l,h){return new ai(l,h)}var l6=TN,mf=Yr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(l,h,_){this._url=l,this._bounds=$(h),x(this,_)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Lt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){bn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(l){return this.options.opacity=l,this._image&&this._updateOpacity(),this},setStyle:function(l){return l.opacity&&this.setOpacity(l.opacity),this},bringToFront:function(){return this._map&&hc(this._image),this},bringToBack:function(){return this._map&&mc(this._image),this},setUrl:function(l){return this._url=l,this._image&&(this._image.src=l),this},setBounds:function(l){return this._bounds=$(l),this._map&&this._reset(),this},getEvents:function(){var l={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},setZIndex:function(l){return this.options.zIndex=l,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var l=this._url.tagName==="IMG",h=this._image=l?this._url:sn("img");if(Lt(h,"leaflet-image-layer"),this._zoomAnimated&&Lt(h,"leaflet-zoom-animated"),this.options.className&&Lt(h,this.options.className),h.onselectstart=f,h.onmousemove=f,h.onload=o(this.fire,this,"load"),h.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),l){this._url=h.src;return}h.src=this._url,h.alt=this.options.alt},_animateZoom:function(l){var h=this._map.getZoomScale(l.zoom),_=this._map._latLngBoundsToNewLayerBounds(this._bounds,l.zoom,l.center).min;Yo(this._image,_,h)},_reset:function(){var l=this._image,h=new B(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),_=h.getSize();Fn(l,h.min),l.style.width=_.x+"px",l.style.height=_.y+"px"},_updateOpacity:function(){Cr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var l=this.options.errorOverlayUrl;l&&this._url!==l&&(this._url=l,this._image.src=l)},getCenter:function(){return this._bounds.getCenter()}}),c6=function(l,h,_){return new mf(l,h,_)},MN=mf.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var l=this._url.tagName==="VIDEO",h=this._image=l?this._url:sn("video");if(Lt(h,"leaflet-image-layer"),this._zoomAnimated&&Lt(h,"leaflet-zoom-animated"),this.options.className&&Lt(h,this.options.className),h.onselectstart=f,h.onmousemove=f,h.onloadeddata=o(this.fire,this,"load"),l){for(var _=h.getElementsByTagName("source"),k=[],M=0;M<_.length;M++)k.push(_[M].src);this._url=_.length>0?k:[h.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted,h.playsInline=!!this.options.playsInline;for(var Z=0;Z<this._url.length;Z++){var ce=sn("source");ce.src=this._url[Z],h.appendChild(ce)}}});function d6(l,h,_){return new MN(l,h,_)}var RN=mf.extend({_initImage:function(){var l=this._image=this._url;Lt(l,"leaflet-image-layer"),this._zoomAnimated&&Lt(l,"leaflet-zoom-animated"),this.options.className&&Lt(l,this.options.className),l.onselectstart=f,l.onmousemove=f}});function u6(l,h,_){return new RN(l,h,_)}var ka=Yr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(l,h){l&&(l instanceof te||N(l))?(this._latlng=ee(l),x(this,h)):(x(this,l),this._source=h),this.options.content&&(this._content=this.options.content)},openOn:function(l){return l=arguments.length?l:this._source._map,l.hasLayer(this)||l.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(l){return this._map?this.close():(arguments.length?this._source=l:l=this._source,this._prepareOpen(),this.openOn(l._map)),this},onAdd:function(l){this._zoomAnimated=l._zoomAnimated,this._container||this._initLayout(),l._fadeAnimated&&Cr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),l._fadeAnimated&&Cr(this._container,1),this.bringToFront(),this.options.interactive&&(Lt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(l){l._fadeAnimated?(Cr(this._container,0),this._removeTimeout=setTimeout(o(bn,void 0,this._container),200)):bn(this._container),this.options.interactive&&(Mn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(l){return this._latlng=ee(l),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(l){return this._content=l,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var l={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&hc(this._container),this},bringToBack:function(){return this._map&&mc(this._container),this},_prepareOpen:function(l){var h=this._source;if(!h._map)return!1;if(h instanceof si){h=null;var _=this._source._layers;for(var k in _)if(_[k]._map){h=_[k];break}if(!h)return!1;this._source=h}if(!l)if(h.getCenter)l=h.getCenter();else if(h.getLatLng)l=h.getLatLng();else if(h.getBounds)l=h.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(l),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var l=this._contentNode,h=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof h=="string")l.innerHTML=h;else{for(;l.hasChildNodes();)l.removeChild(l.firstChild);l.appendChild(h)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var l=this._map.latLngToLayerPoint(this._latlng),h=U(this.options.offset),_=this._getAnchor();this._zoomAnimated?Fn(this._container,l.add(_)):h=h.add(l).add(_);var k=this._containerBottom=-h.y,M=this._containerLeft=-Math.round(this._containerWidth/2)+h.x;this._container.style.bottom=k+"px",this._container.style.left=M+"px"}},_getAnchor:function(){return[0,0]}});Xt.include({_initOverlay:function(l,h,_,k){var M=h;return M instanceof l||(M=new l(k).setContent(h)),_&&M.setLatLng(_),M}}),Yr.include({_initOverlay:function(l,h,_,k){var M=_;return M instanceof l?(x(M,k),M._source=this):(M=h&&!k?h:new l(k,this),M.setContent(_)),M}});var ff=ka.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(l){return l=arguments.length?l:this._source._map,!l.hasLayer(this)&&l._popup&&l._popup.options.autoClose&&l.removeLayer(l._popup),l._popup=this,ka.prototype.openOn.call(this,l)},onAdd:function(l){ka.prototype.onAdd.call(this,l),l.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Li||this._source.on("preclick",Jo))},onRemove:function(l){ka.prototype.onRemove.call(this,l),l.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Li||this._source.off("preclick",Jo))},getEvents:function(){var l=ka.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(l.preclick=this.close),this.options.keepInView&&(l.moveend=this._adjustPan),l},_initLayout:function(){var l="leaflet-popup",h=this._container=sn("div",l+" "+(this.options.className||"")+" leaflet-zoom-animated"),_=this._wrapper=sn("div",l+"-content-wrapper",h);if(this._contentNode=sn("div",l+"-content",_),fu(h),Ex(this._contentNode),Dt(h,"contextmenu",Jo),this._tipContainer=sn("div",l+"-tip-container",h),this._tip=sn("div",l+"-tip",this._tipContainer),this.options.closeButton){var k=this._closeButton=sn("a",l+"-close-button",h);k.setAttribute("role","button"),k.setAttribute("aria-label","Close popup"),k.href="#close",k.innerHTML='<span aria-hidden="true">&#215;</span>',Dt(k,"click",function(M){ms(M),this.close()},this)}},_updateLayout:function(){var l=this._contentNode,h=l.style;h.width="",h.whiteSpace="nowrap";var _=l.offsetWidth;_=Math.min(_,this.options.maxWidth),_=Math.max(_,this.options.minWidth),h.width=_+1+"px",h.whiteSpace="",h.height="";var k=l.offsetHeight,M=this.options.maxHeight,Z="leaflet-popup-scrolled";M&&k>M?(h.height=M+"px",Lt(l,Z)):Mn(l,Z),this._containerWidth=this._container.offsetWidth},_animateZoom:function(l){var h=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center),_=this._getAnchor();Fn(this._container,h.add(_))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var l=this._map,h=parseInt(du(this._container,"marginBottom"),10)||0,_=this._container.offsetHeight+h,k=this._containerWidth,M=new T(this._containerLeft,-_-this._containerBottom);M._add(Xo(this._container));var Z=l.layerPointToContainerPoint(M),ce=U(this.options.autoPanPadding),me=U(this.options.autoPanPaddingTopLeft||ce),ye=U(this.options.autoPanPaddingBottomRight||ce),Ce=l.getSize(),Ge=0,_t=0;Z.x+k+ye.x>Ce.x&&(Ge=Z.x+k-Ce.x+ye.x),Z.x-Ge-me.x<0&&(Ge=Z.x-me.x),Z.y+_+ye.y>Ce.y&&(_t=Z.y+_-Ce.y+ye.y),Z.y-_t-me.y<0&&(_t=Z.y-me.y),(Ge||_t)&&(this.options.keepInView&&(this._autopanning=!0),l.fire("autopanstart").panBy([Ge,_t]))}},_getAnchor:function(){return U(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),h6=function(l,h){return new ff(l,h)};Xt.mergeOptions({closePopupOnClick:!0}),Xt.include({openPopup:function(l,h,_){return this._initOverlay(ff,l,h,_).openOn(this),this},closePopup:function(l){return l=arguments.length?l:this._popup,l&&l.close(),this}}),Yr.include({bindPopup:function(l,h){return this._popup=this._initOverlay(ff,this._popup,l,h),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(l){return this._popup&&(this instanceof si||(this._popup._source=this),this._popup._prepareOpen(l||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(l){return this._popup&&this._popup.setContent(l),this},getPopup:function(){return this._popup},_openPopup:function(l){if(!(!this._popup||!this._map)){el(l);var h=l.layer||l.target;if(this._popup._source===h&&!(h instanceof Li)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(l.latlng);return}this._popup._source=h,this.openPopup(l.latlng)}},_movePopup:function(l){this._popup.setLatLng(l.latlng)},_onKeyPress:function(l){l.originalEvent.keyCode===13&&this._openPopup(l)}});var pf=ka.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(l){ka.prototype.onAdd.call(this,l),this.setOpacity(this.options.opacity),l.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(l){ka.prototype.onRemove.call(this,l),l.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var l=ka.prototype.getEvents.call(this);return this.options.permanent||(l.preclick=this.close),l},_initLayout:function(){var l="leaflet-tooltip",h=l+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=sn("div",h),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(l){var h,_,k=this._map,M=this._container,Z=k.latLngToContainerPoint(k.getCenter()),ce=k.layerPointToContainerPoint(l),me=this.options.direction,ye=M.offsetWidth,Ce=M.offsetHeight,Ge=U(this.options.offset),_t=this._getAnchor();me==="top"?(h=ye/2,_=Ce):me==="bottom"?(h=ye/2,_=0):me==="center"?(h=ye/2,_=Ce/2):me==="right"?(h=0,_=Ce/2):me==="left"?(h=ye,_=Ce/2):ce.x<Z.x?(me="right",h=0,_=Ce/2):(me="left",h=ye+(Ge.x+_t.x)*2,_=Ce/2),l=l.subtract(U(h,_,!0)).add(Ge).add(_t),Mn(M,"leaflet-tooltip-right"),Mn(M,"leaflet-tooltip-left"),Mn(M,"leaflet-tooltip-top"),Mn(M,"leaflet-tooltip-bottom"),Lt(M,"leaflet-tooltip-"+me),Fn(M,l)},_updatePosition:function(){var l=this._map.latLngToLayerPoint(this._latlng);this._setPosition(l)},setOpacity:function(l){this.options.opacity=l,this._container&&Cr(this._container,l)},_animateZoom:function(l){var h=this._map._latLngToNewLayerPoint(this._latlng,l.zoom,l.center);this._setPosition(h)},_getAnchor:function(){return U(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),m6=function(l,h){return new pf(l,h)};Xt.include({openTooltip:function(l,h,_){return this._initOverlay(pf,l,h,_).openOn(this),this},closeTooltip:function(l){return l.close(),this}}),Yr.include({bindTooltip:function(l,h){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(pf,this._tooltip,l,h),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(l){if(!(!l&&this._tooltipHandlersAdded)){var h=l?"off":"on",_={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?_.add=this._openTooltip:(_.mouseover=this._openTooltip,_.mouseout=this.closeTooltip,_.click=this._openTooltip,this._map?this._addFocusListeners():_.add=this._addFocusListeners),this._tooltip.options.sticky&&(_.mousemove=this._moveTooltip),this[h](_),this._tooltipHandlersAdded=!l}},openTooltip:function(l){return this._tooltip&&(this instanceof si||(this._tooltip._source=this),this._tooltip._prepareOpen(l)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(l){return this._tooltip&&this._tooltip.setContent(l),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(l){var h=typeof l.getElement=="function"&&l.getElement();h&&(Dt(h,"focus",function(){this._tooltip._source=l,this.openTooltip()},this),Dt(h,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(l){var h=typeof l.getElement=="function"&&l.getElement();h&&h.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(l){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var h=this;this._map.once("moveend",function(){h._openOnceFlag=!1,h._openTooltip(l)});return}this._tooltip._source=l.layer||l.target,this.openTooltip(this._tooltip.options.sticky?l.latlng:void 0)}},_moveTooltip:function(l){var h=l.latlng,_,k;this._tooltip.options.sticky&&l.originalEvent&&(_=this._map.mouseEventToContainerPoint(l.originalEvent),k=this._map.containerPointToLayerPoint(_),h=this._map.layerPointToLatLng(k)),this._tooltip.setLatLng(h)}});var IN=pc.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(l){var h=l&&l.tagName==="DIV"?l:document.createElement("div"),_=this.options;if(_.html instanceof Element?(ef(h),h.appendChild(_.html)):h.innerHTML=_.html!==!1?_.html:"",_.bgPos){var k=U(_.bgPos);h.style.backgroundPosition=-k.x+"px "+-k.y+"px"}return this._setIconStyles(h,"icon"),h},createShadow:function(){return null}});function f6(l){return new IN(l)}pc.Default=xu;var vu=Yr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:at.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(l){x(this,l)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(l){l._addZoomLimit(this)},onRemove:function(l){this._removeAllTiles(),bn(this._container),l._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(hc(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(mc(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(l){return this.options.opacity=l,this._updateOpacity(),this},setZIndex:function(l){return this.options.zIndex=l,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var l=this._clampZoom(this._map.getZoom());l!==this._tileZoom&&(this._tileZoom=l,this._updateLevels()),this._update()}return this},getEvents:function(){var l={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=u(this._onMoveEnd,this.options.updateInterval,this)),l.move=this._onMove),this._zoomAnimated&&(l.zoomanim=this._animateZoom),l},createTile:function(){return document.createElement("div")},getTileSize:function(){var l=this.options.tileSize;return l instanceof T?l:new T(l,l)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(l){for(var h=this.getPane().children,_=-l(-1/0,1/0),k=0,M=h.length,Z;k<M;k++)Z=h[k].style.zIndex,h[k]!==this._container&&Z&&(_=l(_,+Z));isFinite(_)&&(this.options.zIndex=_+l(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!at.ielt9){Cr(this._container,this.options.opacity);var l=+new Date,h=!1,_=!1;for(var k in this._tiles){var M=this._tiles[k];if(!(!M.current||!M.loaded)){var Z=Math.min(1,(l-M.loaded)/200);Cr(M.el,Z),Z<1?h=!0:(M.active?_=!0:this._onOpaqueTile(M),M.active=!0)}}_&&!this._noPrune&&this._pruneTiles(),h&&(W(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this))}},_onOpaqueTile:f,_initContainer:function(){this._container||(this._container=sn("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var l=this._tileZoom,h=this.options.maxZoom;if(l!==void 0){for(var _ in this._levels)_=Number(_),this._levels[_].el.children.length||_===l?(this._levels[_].el.style.zIndex=h-Math.abs(l-_),this._onUpdateLevel(_)):(bn(this._levels[_].el),this._removeTilesAtZoom(_),this._onRemoveLevel(_),delete this._levels[_]);var k=this._levels[l],M=this._map;return k||(k=this._levels[l]={},k.el=sn("div","leaflet-tile-container leaflet-zoom-animated",this._container),k.el.style.zIndex=h,k.origin=M.project(M.unproject(M.getPixelOrigin()),l).round(),k.zoom=l,this._setZoomTransform(k,M.getCenter(),M.getZoom()),f(k.el.offsetWidth),this._onCreateLevel(k)),this._level=k,k}},_onUpdateLevel:f,_onRemoveLevel:f,_onCreateLevel:f,_pruneTiles:function(){if(this._map){var l,h,_=this._map.getZoom();if(_>this.options.maxZoom||_<this.options.minZoom){this._removeAllTiles();return}for(l in this._tiles)h=this._tiles[l],h.retain=h.current;for(l in this._tiles)if(h=this._tiles[l],h.current&&!h.active){var k=h.coords;this._retainParent(k.x,k.y,k.z,k.z-5)||this._retainChildren(k.x,k.y,k.z,k.z+2)}for(l in this._tiles)this._tiles[l].retain||this._removeTile(l)}},_removeTilesAtZoom:function(l){for(var h in this._tiles)this._tiles[h].coords.z===l&&this._removeTile(h)},_removeAllTiles:function(){for(var l in this._tiles)this._removeTile(l)},_invalidateAll:function(){for(var l in this._levels)bn(this._levels[l].el),this._onRemoveLevel(Number(l)),delete this._levels[l];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(l,h,_,k){var M=Math.floor(l/2),Z=Math.floor(h/2),ce=_-1,me=new T(+M,+Z);me.z=+ce;var ye=this._tileCoordsToKey(me),Ce=this._tiles[ye];return Ce&&Ce.active?(Ce.retain=!0,!0):(Ce&&Ce.loaded&&(Ce.retain=!0),ce>k?this._retainParent(M,Z,ce,k):!1)},_retainChildren:function(l,h,_,k){for(var M=2*l;M<2*l+2;M++)for(var Z=2*h;Z<2*h+2;Z++){var ce=new T(M,Z);ce.z=_+1;var me=this._tileCoordsToKey(ce),ye=this._tiles[me];if(ye&&ye.active){ye.retain=!0;continue}else ye&&ye.loaded&&(ye.retain=!0);_+1<k&&this._retainChildren(M,Z,_+1,k)}},_resetView:function(l){var h=l&&(l.pinch||l.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h)},_animateZoom:function(l){this._setView(l.center,l.zoom,!0,l.noUpdate)},_clampZoom:function(l){var h=this.options;return h.minNativeZoom!==void 0&&l<h.minNativeZoom?h.minNativeZoom:h.maxNativeZoom!==void 0&&h.maxNativeZoom<l?h.maxNativeZoom:l},_setView:function(l,h,_,k){var M=Math.round(h);this.options.maxZoom!==void 0&&M>this.options.maxZoom||this.options.minZoom!==void 0&&M<this.options.minZoom?M=void 0:M=this._clampZoom(M);var Z=this.options.updateWhenZooming&&M!==this._tileZoom;(!k||Z)&&(this._tileZoom=M,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),M!==void 0&&this._update(l),_||this._pruneTiles(),this._noPrune=!!_),this._setZoomTransforms(l,h)},_setZoomTransforms:function(l,h){for(var _ in this._levels)this._setZoomTransform(this._levels[_],l,h)},_setZoomTransform:function(l,h,_){var k=this._map.getZoomScale(_,l.zoom),M=l.origin.multiplyBy(k).subtract(this._map._getNewPixelOrigin(h,_)).round();at.any3d?Yo(l.el,M,k):Fn(l.el,M)},_resetGrid:function(){var l=this._map,h=l.options.crs,_=this._tileSize=this.getTileSize(),k=this._tileZoom,M=this._map.getPixelWorldBounds(this._tileZoom);M&&(this._globalTileRange=this._pxBoundsToTileRange(M)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(l.project([0,h.wrapLng[0]],k).x/_.x),Math.ceil(l.project([0,h.wrapLng[1]],k).x/_.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(l.project([h.wrapLat[0],0],k).y/_.x),Math.ceil(l.project([h.wrapLat[1],0],k).y/_.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(l){var h=this._map,_=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),k=h.getZoomScale(_,this._tileZoom),M=h.project(l,this._tileZoom).floor(),Z=h.getSize().divideBy(k*2);return new B(M.subtract(Z),M.add(Z))},_update:function(l){var h=this._map;if(h){var _=this._clampZoom(h.getZoom());if(l===void 0&&(l=h.getCenter()),this._tileZoom!==void 0){var k=this._getTiledPixelBounds(l),M=this._pxBoundsToTileRange(k),Z=M.getCenter(),ce=[],me=this.options.keepBuffer,ye=new B(M.getBottomLeft().subtract([me,-me]),M.getTopRight().add([me,-me]));if(!(isFinite(M.min.x)&&isFinite(M.min.y)&&isFinite(M.max.x)&&isFinite(M.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ce in this._tiles){var Ge=this._tiles[Ce].coords;(Ge.z!==this._tileZoom||!ye.contains(new T(Ge.x,Ge.y)))&&(this._tiles[Ce].current=!1)}if(Math.abs(_-this._tileZoom)>1){this._setView(l,_);return}for(var _t=M.min.y;_t<=M.max.y;_t++)for(var Ut=M.min.x;Ut<=M.max.x;Ut++){var Rs=new T(Ut,_t);if(Rs.z=this._tileZoom,!!this._isValidTile(Rs)){var ss=this._tiles[this._tileCoordsToKey(Rs)];ss?ss.current=!0:ce.push(Rs)}}if(ce.sort(function(Hs,yc){return Hs.distanceTo(Z)-yc.distanceTo(Z)}),ce.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ar=document.createDocumentFragment();for(Ut=0;Ut<ce.length;Ut++)this._addTile(ce[Ut],Ar);this._level.el.appendChild(Ar)}}}},_isValidTile:function(l){var h=this._map.options.crs;if(!h.infinite){var _=this._globalTileRange;if(!h.wrapLng&&(l.x<_.min.x||l.x>_.max.x)||!h.wrapLat&&(l.y<_.min.y||l.y>_.max.y))return!1}if(!this.options.bounds)return!0;var k=this._tileCoordsToBounds(l);return $(this.options.bounds).overlaps(k)},_keyToBounds:function(l){return this._tileCoordsToBounds(this._keyToTileCoords(l))},_tileCoordsToNwSe:function(l){var h=this._map,_=this.getTileSize(),k=l.scaleBy(_),M=k.add(_),Z=h.unproject(k,l.z),ce=h.unproject(M,l.z);return[Z,ce]},_tileCoordsToBounds:function(l){var h=this._tileCoordsToNwSe(l),_=new z(h[0],h[1]);return this.options.noWrap||(_=this._map.wrapLatLngBounds(_)),_},_tileCoordsToKey:function(l){return l.x+":"+l.y+":"+l.z},_keyToTileCoords:function(l){var h=l.split(":"),_=new T(+h[0],+h[1]);return _.z=+h[2],_},_removeTile:function(l){var h=this._tiles[l];h&&(bn(h.el),delete this._tiles[l],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(l)}))},_initTile:function(l){Lt(l,"leaflet-tile");var h=this.getTileSize();l.style.width=h.x+"px",l.style.height=h.y+"px",l.onselectstart=f,l.onmousemove=f,at.ielt9&&this.options.opacity<1&&Cr(l,this.options.opacity)},_addTile:function(l,h){var _=this._getTilePos(l),k=this._tileCoordsToKey(l),M=this.createTile(this._wrapCoords(l),o(this._tileReady,this,l));this._initTile(M),this.createTile.length<2&&D(o(this._tileReady,this,l,null,M)),Fn(M,_),this._tiles[k]={el:M,coords:l,current:!0},h.appendChild(M),this.fire("tileloadstart",{tile:M,coords:l})},_tileReady:function(l,h,_){h&&this.fire("tileerror",{error:h,tile:_,coords:l});var k=this._tileCoordsToKey(l);_=this._tiles[k],_&&(_.loaded=+new Date,this._map._fadeAnimated?(Cr(_.el,0),W(this._fadeFrame),this._fadeFrame=D(this._updateOpacity,this)):(_.active=!0,this._pruneTiles()),h||(Lt(_.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:_.el,coords:l})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),at.ielt9||!this._map._fadeAnimated?D(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(l){return l.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(l){var h=new T(this._wrapX?m(l.x,this._wrapX):l.x,this._wrapY?m(l.y,this._wrapY):l.y);return h.z=l.z,h},_pxBoundsToTileRange:function(l){var h=this.getTileSize();return new B(l.min.unscaleBy(h).floor(),l.max.unscaleBy(h).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var l in this._tiles)if(!this._tiles[l].loaded)return!1;return!0}});function p6(l){return new vu(l)}var vc=vu.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(l,h){this._url=l,h=x(this,h),h.detectRetina&&at.retina&&h.maxZoom>0?(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom=Math.min(h.maxZoom,h.minZoom+1)):(h.zoomOffset++,h.maxZoom=Math.max(h.minZoom,h.maxZoom-1)),h.minZoom=Math.max(0,h.minZoom)):h.zoomReverse?h.minZoom=Math.min(h.maxZoom,h.minZoom):h.maxZoom=Math.max(h.minZoom,h.maxZoom),typeof h.subdomains=="string"&&(h.subdomains=h.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(l,h){return this._url===l&&h===void 0&&(h=!0),this._url=l,h||this.redraw(),this},createTile:function(l,h){var _=document.createElement("img");return Dt(_,"load",o(this._tileOnLoad,this,h,_)),Dt(_,"error",o(this._tileOnError,this,h,_)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(_.referrerPolicy=this.options.referrerPolicy),_.alt="",_.src=this.getTileUrl(l),_},getTileUrl:function(l){var h={r:at.retina?"@2x":"",s:this._getSubdomain(l),x:l.x,y:l.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var _=this._globalTileRange.max.y-l.y;this.options.tms&&(h.y=_),h["-y"]=_}return b(this._url,a(h,this.options))},_tileOnLoad:function(l,h){at.ielt9?setTimeout(o(l,this,null,h),0):l(null,h)},_tileOnError:function(l,h,_){var k=this.options.errorTileUrl;k&&h.getAttribute("src")!==k&&(h.src=k),l(_,h)},_onTileRemove:function(l){l.tile.onload=null},_getZoomForUrl:function(){var l=this._tileZoom,h=this.options.maxZoom,_=this.options.zoomReverse,k=this.options.zoomOffset;return _&&(l=h-l),l+k},_getSubdomain:function(l){var h=Math.abs(l.x+l.y)%this.options.subdomains.length;return this.options.subdomains[h]},_abortLoading:function(){var l,h;for(l in this._tiles)if(this._tiles[l].coords.z!==this._tileZoom&&(h=this._tiles[l].el,h.onload=f,h.onerror=f,!h.complete)){h.src=E;var _=this._tiles[l].coords;bn(h),delete this._tiles[l],this.fire("tileabort",{tile:h,coords:_})}},_removeTile:function(l){var h=this._tiles[l];if(h)return h.el.setAttribute("src",E),vu.prototype._removeTile.call(this,l)},_tileReady:function(l,h,_){if(!(!this._map||_&&_.getAttribute("src")===E))return vu.prototype._tileReady.call(this,l,h,_)}});function ON(l,h){return new vc(l,h)}var LN=vc.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(l,h){this._url=l;var _=a({},this.defaultWmsParams);for(var k in h)k in this.options||(_[k]=h[k]);h=x(this,h);var M=h.detectRetina&&at.retina?2:1,Z=this.getTileSize();_.width=Z.x*M,_.height=Z.y*M,this.wmsParams=_},onAdd:function(l){this._crs=this.options.crs||l.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var h=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[h]=this._crs.code,vc.prototype.onAdd.call(this,l)},getTileUrl:function(l){var h=this._tileCoordsToNwSe(l),_=this._crs,k=O(_.project(h[0]),_.project(h[1])),M=k.min,Z=k.max,ce=(this._wmsVersion>=1.3&&this._crs===AN?[M.y,M.x,Z.y,Z.x]:[M.x,M.y,Z.x,Z.y]).join(","),me=vc.prototype.getTileUrl.call(this,l);return me+y(this.wmsParams,me,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ce},setParams:function(l,h){return a(this.wmsParams,l),h||this.redraw(),this}});function g6(l,h){return new LN(l,h)}vc.WMS=LN,ON.wms=g6;var ii=Yr.extend({options:{padding:.1},initialize:function(l){x(this,l),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Lt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var l={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(l.zoomanim=this._onAnimZoom),l},_onAnimZoom:function(l){this._updateTransform(l.center,l.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(l,h){var _=this._map.getZoomScale(h,this._zoom),k=this._map.getSize().multiplyBy(.5+this.options.padding),M=this._map.project(this._center,h),Z=k.multiplyBy(-_).add(M).subtract(this._map._getNewPixelOrigin(l,h));at.any3d?Yo(this._container,Z,_):Fn(this._container,Z)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var l in this._layers)this._layers[l]._reset()},_onZoomEnd:function(){for(var l in this._layers)this._layers[l]._project()},_updatePaths:function(){for(var l in this._layers)this._layers[l]._update()},_update:function(){var l=this.options.padding,h=this._map.getSize(),_=this._map.containerPointToLayerPoint(h.multiplyBy(-l)).round();this._bounds=new B(_,_.add(h.multiplyBy(1+l*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),FN=ii.extend({options:{tolerance:0},getEvents:function(){var l=ii.prototype.getEvents.call(this);return l.viewprereset=this._onViewPreReset,l},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ii.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var l=this._container=document.createElement("canvas");Dt(l,"mousemove",this._onMouseMove,this),Dt(l,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Dt(l,"mouseout",this._handleMouseOut,this),l._leaflet_disable_events=!0,this._ctx=l.getContext("2d")},_destroyContainer:function(){W(this._redrawRequest),delete this._ctx,bn(this._container),un(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var l;this._redrawBounds=null;for(var h in this._layers)l=this._layers[h],l._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ii.prototype._update.call(this);var l=this._bounds,h=this._container,_=l.getSize(),k=at.retina?2:1;Fn(h,l.min),h.width=k*_.x,h.height=k*_.y,h.style.width=_.x+"px",h.style.height=_.y+"px",at.retina&&this._ctx.scale(2,2),this._ctx.translate(-l.min.x,-l.min.y),this.fire("update")}},_reset:function(){ii.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(l){this._updateDashArray(l),this._layers[d(l)]=l;var h=l._order={layer:l,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(l){this._requestRedraw(l)},_removePath:function(l){var h=l._order,_=h.next,k=h.prev;_?_.prev=k:this._drawLast=k,k?k.next=_:this._drawFirst=_,delete l._order,delete this._layers[d(l)],this._requestRedraw(l)},_updatePath:function(l){this._extendRedrawBounds(l),l._project(),l._update(),this._requestRedraw(l)},_updateStyle:function(l){this._updateDashArray(l),this._requestRedraw(l)},_updateDashArray:function(l){if(typeof l.options.dashArray=="string"){var h=l.options.dashArray.split(/[, ]+/),_=[],k,M;for(M=0;M<h.length;M++){if(k=Number(h[M]),isNaN(k))return;_.push(k)}l.options._dashArray=_}else l.options._dashArray=l.options.dashArray},_requestRedraw:function(l){this._map&&(this._extendRedrawBounds(l),this._redrawRequest=this._redrawRequest||D(this._redraw,this))},_extendRedrawBounds:function(l){if(l._pxBounds){var h=(l.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new B,this._redrawBounds.extend(l._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(l._pxBounds.max.add([h,h]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var l=this._redrawBounds;if(l){var h=l.getSize();this._ctx.clearRect(l.min.x,l.min.y,h.x,h.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var l,h=this._redrawBounds;if(this._ctx.save(),h){var _=h.getSize();this._ctx.beginPath(),this._ctx.rect(h.min.x,h.min.y,_.x,_.y),this._ctx.clip()}this._drawing=!0;for(var k=this._drawFirst;k;k=k.next)l=k.layer,(!h||l._pxBounds&&l._pxBounds.intersects(h))&&l._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(l,h){if(this._drawing){var _,k,M,Z,ce=l._parts,me=ce.length,ye=this._ctx;if(me){for(ye.beginPath(),_=0;_<me;_++){for(k=0,M=ce[_].length;k<M;k++)Z=ce[_][k],ye[k?"lineTo":"moveTo"](Z.x,Z.y);h&&ye.closePath()}this._fillStroke(ye,l)}}},_updateCircle:function(l){if(!(!this._drawing||l._empty())){var h=l._point,_=this._ctx,k=Math.max(Math.round(l._radius),1),M=(Math.max(Math.round(l._radiusY),1)||k)/k;M!==1&&(_.save(),_.scale(1,M)),_.beginPath(),_.arc(h.x,h.y/M,k,0,Math.PI*2,!1),M!==1&&_.restore(),this._fillStroke(_,l)}},_fillStroke:function(l,h){var _=h.options;_.fill&&(l.globalAlpha=_.fillOpacity,l.fillStyle=_.fillColor||_.color,l.fill(_.fillRule||"evenodd")),_.stroke&&_.weight!==0&&(l.setLineDash&&l.setLineDash(h.options&&h.options._dashArray||[]),l.globalAlpha=_.opacity,l.lineWidth=_.weight,l.strokeStyle=_.color,l.lineCap=_.lineCap,l.lineJoin=_.lineJoin,l.stroke())},_onClick:function(l){for(var h=this._map.mouseEventToLayerPoint(l),_,k,M=this._drawFirst;M;M=M.next)_=M.layer,_.options.interactive&&_._containsPoint(h)&&(!(l.type==="click"||l.type==="preclick")||!this._map._draggableMoved(_))&&(k=_);this._fireEvent(k?[k]:!1,l)},_onMouseMove:function(l){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var h=this._map.mouseEventToLayerPoint(l);this._handleMouseHover(l,h)}},_handleMouseOut:function(l){var h=this._hoveredLayer;h&&(Mn(this._container,"leaflet-interactive"),this._fireEvent([h],l,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(l,h){if(!this._mouseHoverThrottled){for(var _,k,M=this._drawFirst;M;M=M.next)_=M.layer,_.options.interactive&&_._containsPoint(h)&&(k=_);k!==this._hoveredLayer&&(this._handleMouseOut(l),k&&(Lt(this._container,"leaflet-interactive"),this._fireEvent([k],l,"mouseover"),this._hoveredLayer=k)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,l),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(l,h,_){this._map._fireDOMEvent(h,_||h.type,l)},_bringToFront:function(l){var h=l._order;if(h){var _=h.next,k=h.prev;if(_)_.prev=k;else return;k?k.next=_:_&&(this._drawFirst=_),h.prev=this._drawLast,this._drawLast.next=h,h.next=null,this._drawLast=h,this._requestRedraw(l)}},_bringToBack:function(l){var h=l._order;if(h){var _=h.next,k=h.prev;if(k)k.next=_;else return;_?_.prev=k:k&&(this._drawLast=k),h.prev=null,h.next=this._drawFirst,this._drawFirst.prev=h,this._drawFirst=h,this._requestRedraw(l)}}});function BN(l){return at.canvas?new FN(l):null}var yu=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(l){return document.createElement("<lvml:"+l+' class="lvml">')}}catch{}return function(l){return document.createElement("<"+l+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),x6={_initContainer:function(){this._container=sn("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ii.prototype._update.call(this),this.fire("update"))},_initPath:function(l){var h=l._container=yu("shape");Lt(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",l._path=yu("path"),h.appendChild(l._path),this._updateStyle(l),this._layers[d(l)]=l},_addPath:function(l){var h=l._container;this._container.appendChild(h),l.options.interactive&&l.addInteractiveTarget(h)},_removePath:function(l){var h=l._container;bn(h),l.removeInteractiveTarget(h),delete this._layers[d(l)]},_updateStyle:function(l){var h=l._stroke,_=l._fill,k=l.options,M=l._container;M.stroked=!!k.stroke,M.filled=!!k.fill,k.stroke?(h||(h=l._stroke=yu("stroke")),M.appendChild(h),h.weight=k.weight+"px",h.color=k.color,h.opacity=k.opacity,k.dashArray?h.dashStyle=N(k.dashArray)?k.dashArray.join(" "):k.dashArray.replace(/( *, *)/g," "):h.dashStyle="",h.endcap=k.lineCap.replace("butt","flat"),h.joinstyle=k.lineJoin):h&&(M.removeChild(h),l._stroke=null),k.fill?(_||(_=l._fill=yu("fill")),M.appendChild(_),_.color=k.fillColor||k.color,_.opacity=k.fillOpacity):_&&(M.removeChild(_),l._fill=null)},_updateCircle:function(l){var h=l._point.round(),_=Math.round(l._radius),k=Math.round(l._radiusY||_);this._setPath(l,l._empty()?"M0 0":"AL "+h.x+","+h.y+" "+_+","+k+" 0,"+65535*360)},_setPath:function(l,h){l._path.v=h},_bringToFront:function(l){hc(l._container)},_bringToBack:function(l){mc(l._container)}},gf=at.vml?yu:ie,_u=ii.extend({_initContainer:function(){this._container=gf("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=gf("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){bn(this._container),un(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ii.prototype._update.call(this);var l=this._bounds,h=l.getSize(),_=this._container;(!this._svgSize||!this._svgSize.equals(h))&&(this._svgSize=h,_.setAttribute("width",h.x),_.setAttribute("height",h.y)),Fn(_,l.min),_.setAttribute("viewBox",[l.min.x,l.min.y,h.x,h.y].join(" ")),this.fire("update")}},_initPath:function(l){var h=l._path=gf("path");l.options.className&&Lt(h,l.options.className),l.options.interactive&&Lt(h,"leaflet-interactive"),this._updateStyle(l),this._layers[d(l)]=l},_addPath:function(l){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(l._path),l.addInteractiveTarget(l._path)},_removePath:function(l){bn(l._path),l.removeInteractiveTarget(l._path),delete this._layers[d(l)]},_updatePath:function(l){l._project(),l._update()},_updateStyle:function(l){var h=l._path,_=l.options;h&&(_.stroke?(h.setAttribute("stroke",_.color),h.setAttribute("stroke-opacity",_.opacity),h.setAttribute("stroke-width",_.weight),h.setAttribute("stroke-linecap",_.lineCap),h.setAttribute("stroke-linejoin",_.lineJoin),_.dashArray?h.setAttribute("stroke-dasharray",_.dashArray):h.removeAttribute("stroke-dasharray"),_.dashOffset?h.setAttribute("stroke-dashoffset",_.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),_.fill?(h.setAttribute("fill",_.fillColor||_.color),h.setAttribute("fill-opacity",_.fillOpacity),h.setAttribute("fill-rule",_.fillRule||"evenodd")):h.setAttribute("fill","none"))},_updatePoly:function(l,h){this._setPath(l,_e(l._parts,h))},_updateCircle:function(l){var h=l._point,_=Math.max(Math.round(l._radius),1),k=Math.max(Math.round(l._radiusY),1)||_,M="a"+_+","+k+" 0 1,0 ",Z=l._empty()?"M0 0":"M"+(h.x-_)+","+h.y+M+_*2+",0 "+M+-_*2+",0 ";this._setPath(l,Z)},_setPath:function(l,h){l._path.setAttribute("d",h)},_bringToFront:function(l){hc(l._path)},_bringToBack:function(l){mc(l._path)}});at.vml&&_u.include(x6);function zN(l){return at.svg||at.vml?new _u(l):null}Xt.include({getRenderer:function(l){var h=l.options.renderer||this._getPaneRenderer(l.options.pane)||this.options.renderer||this._renderer;return h||(h=this._renderer=this._createRenderer()),this.hasLayer(h)||this.addLayer(h),h},_getPaneRenderer:function(l){if(l==="overlayPane"||l===void 0)return!1;var h=this._paneRenderers[l];return h===void 0&&(h=this._createRenderer({pane:l}),this._paneRenderers[l]=h),h},_createRenderer:function(l){return this.options.preferCanvas&&BN(l)||zN(l)}});var $N=gc.extend({initialize:function(l,h){gc.prototype.initialize.call(this,this._boundsToLatLngs(l),h)},setBounds:function(l){return this.setLatLngs(this._boundsToLatLngs(l))},_boundsToLatLngs:function(l){return l=$(l),[l.getSouthWest(),l.getNorthWest(),l.getNorthEast(),l.getSouthEast()]}});function v6(l,h){return new $N(l,h)}_u.create=gf,_u.pointsToPath=_e,ai.geometryToLayer=cf,ai.coordsToLatLng=Lx,ai.coordsToLatLngs=df,ai.latLngToCoords=Fx,ai.latLngsToCoords=uf,ai.getFeature=xc,ai.asFeature=hf,Xt.mergeOptions({boxZoom:!0});var UN=Sa.extend({initialize:function(l){this._map=l,this._container=l._container,this._pane=l._panes.overlayPane,this._resetStateTimeout=0,l.on("unload",this._destroy,this)},addHooks:function(){Dt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){un(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){bn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(l){if(!l.shiftKey||l.which!==1&&l.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),uu(),_x(),this._startPoint=this._map.mouseEventToContainerPoint(l),Dt(document,{contextmenu:el,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(l){this._moved||(this._moved=!0,this._box=sn("div","leaflet-zoom-box",this._container),Lt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(l);var h=new B(this._point,this._startPoint),_=h.getSize();Fn(this._box,h.min),this._box.style.width=_.x+"px",this._box.style.height=_.y+"px"},_finish:function(){this._moved&&(bn(this._box),Mn(this._container,"leaflet-crosshair")),hu(),wx(),un(document,{contextmenu:el,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(l){if(!(l.which!==1&&l.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var h=new z(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h})}},_onKeyDown:function(l){l.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Xt.addInitHook("addHandler","boxZoom",UN),Xt.mergeOptions({doubleClickZoom:!0});var qN=Sa.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(l){var h=this._map,_=h.getZoom(),k=h.options.zoomDelta,M=l.originalEvent.shiftKey?_-k:_+k;h.options.doubleClickZoom==="center"?h.setZoom(M):h.setZoomAround(l.containerPoint,M)}});Xt.addInitHook("addHandler","doubleClickZoom",qN),Xt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var HN=Sa.extend({addHooks:function(){if(!this._draggable){var l=this._map;this._draggable=new Oi(l._mapPane,l._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),l.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),l.on("zoomend",this._onZoomEnd,this),l.whenReady(this._onZoomEnd,this))}Lt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Mn(this._map._container,"leaflet-grab"),Mn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var l=this._map;if(l._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var h=$(this._map.options.maxBounds);this._offsetLimit=O(this._map.latLngToContainerPoint(h.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(h.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;l.fire("movestart").fire("dragstart"),l.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(l){if(this._map.options.inertia){var h=this._lastTime=+new Date,_=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(_),this._times.push(h),this._prunePositions(h)}this._map.fire("move",l).fire("drag",l)},_prunePositions:function(l){for(;this._positions.length>1&&l-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var l=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(l).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(l,h){return l-(l-h)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var l=this._draggable._newPos.subtract(this._draggable._startPos),h=this._offsetLimit;l.x<h.min.x&&(l.x=this._viscousLimit(l.x,h.min.x)),l.y<h.min.y&&(l.y=this._viscousLimit(l.y,h.min.y)),l.x>h.max.x&&(l.x=this._viscousLimit(l.x,h.max.x)),l.y>h.max.y&&(l.y=this._viscousLimit(l.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(l)}},_onPreDragWrap:function(){var l=this._worldWidth,h=Math.round(l/2),_=this._initialWorldOffset,k=this._draggable._newPos.x,M=(k-h+_)%l+h-_,Z=(k+h+_)%l-h-_,ce=Math.abs(M+_)<Math.abs(Z+_)?M:Z;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ce},_onDragEnd:function(l){var h=this._map,_=h.options,k=!_.inertia||l.noInertia||this._times.length<2;if(h.fire("dragend",l),k)h.fire("moveend");else{this._prunePositions(+new Date);var M=this._lastPos.subtract(this._positions[0]),Z=(this._lastTime-this._times[0])/1e3,ce=_.easeLinearity,me=M.multiplyBy(ce/Z),ye=me.distanceTo([0,0]),Ce=Math.min(_.inertiaMaxSpeed,ye),Ge=me.multiplyBy(Ce/ye),_t=Ce/(_.inertiaDeceleration*ce),Ut=Ge.multiplyBy(-_t/2).round();!Ut.x&&!Ut.y?h.fire("moveend"):(Ut=h._limitOffset(Ut,h.options.maxBounds),D(function(){h.panBy(Ut,{duration:_t,easeLinearity:ce,noMoveStart:!0,animate:!0})}))}}});Xt.addInitHook("addHandler","dragging",HN),Xt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var WN=Sa.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(l){this._map=l,this._setPanDelta(l.options.keyboardPanDelta),this._setZoomDelta(l.options.zoomDelta)},addHooks:function(){var l=this._map._container;l.tabIndex<=0&&(l.tabIndex="0"),Dt(l,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),un(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var l=document.body,h=document.documentElement,_=l.scrollTop||h.scrollTop,k=l.scrollLeft||h.scrollLeft;this._map._container.focus(),window.scrollTo(k,_)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(l){var h=this._panKeys={},_=this.keyCodes,k,M;for(k=0,M=_.left.length;k<M;k++)h[_.left[k]]=[-1*l,0];for(k=0,M=_.right.length;k<M;k++)h[_.right[k]]=[l,0];for(k=0,M=_.down.length;k<M;k++)h[_.down[k]]=[0,l];for(k=0,M=_.up.length;k<M;k++)h[_.up[k]]=[0,-1*l]},_setZoomDelta:function(l){var h=this._zoomKeys={},_=this.keyCodes,k,M;for(k=0,M=_.zoomIn.length;k<M;k++)h[_.zoomIn[k]]=l;for(k=0,M=_.zoomOut.length;k<M;k++)h[_.zoomOut[k]]=-l},_addHooks:function(){Dt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){un(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(l){if(!(l.altKey||l.ctrlKey||l.metaKey)){var h=l.keyCode,_=this._map,k;if(h in this._panKeys){if(!_._panAnim||!_._panAnim._inProgress)if(k=this._panKeys[h],l.shiftKey&&(k=U(k).multiplyBy(3)),_.options.maxBounds&&(k=_._limitOffset(U(k),_.options.maxBounds)),_.options.worldCopyJump){var M=_.wrapLatLng(_.unproject(_.project(_.getCenter()).add(k)));_.panTo(M)}else _.panBy(k)}else if(h in this._zoomKeys)_.setZoom(_.getZoom()+(l.shiftKey?3:1)*this._zoomKeys[h]);else if(h===27&&_._popup&&_._popup.options.closeOnEscapeKey)_.closePopup();else return;el(l)}}});Xt.addInitHook("addHandler","keyboard",WN),Xt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var VN=Sa.extend({addHooks:function(){Dt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){un(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(l){var h=gN(l),_=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(l),this._startTime||(this._startTime=+new Date);var k=Math.max(_-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),k),el(l)},_performZoom:function(){var l=this._map,h=l.getZoom(),_=this._map.options.zoomSnap||0;l._stop();var k=this._delta/(this._map.options.wheelPxPerZoomLevel*4),M=4*Math.log(2/(1+Math.exp(-Math.abs(k))))/Math.LN2,Z=_?Math.ceil(M/_)*_:M,ce=l._limitZoom(h+(this._delta>0?Z:-Z))-h;this._delta=0,this._startTime=null,ce&&(l.options.scrollWheelZoom==="center"?l.setZoom(h+ce):l.setZoomAround(this._lastMousePos,h+ce))}});Xt.addInitHook("addHandler","scrollWheelZoom",VN);var y6=600;Xt.mergeOptions({tapHold:at.touchNative&&at.safari&&at.mobile,tapTolerance:15});var KN=Sa.extend({addHooks:function(){Dt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){un(this._map._container,"touchstart",this._onDown,this)},_onDown:function(l){if(clearTimeout(this._holdTimeout),l.touches.length===1){var h=l.touches[0];this._startPos=this._newPos=new T(h.clientX,h.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Dt(document,"touchend",ms),Dt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",h))},this),y6),Dt(document,"touchend touchcancel contextmenu",this._cancel,this),Dt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function l(){un(document,"touchend",ms),un(document,"touchend touchcancel",l)},_cancel:function(){clearTimeout(this._holdTimeout),un(document,"touchend touchcancel contextmenu",this._cancel,this),un(document,"touchmove",this._onMove,this)},_onMove:function(l){var h=l.touches[0];this._newPos=new T(h.clientX,h.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(l,h){var _=new MouseEvent(l,{bubbles:!0,cancelable:!0,view:window,screenX:h.screenX,screenY:h.screenY,clientX:h.clientX,clientY:h.clientY});_._simulated=!0,h.target.dispatchEvent(_)}});Xt.addInitHook("addHandler","tapHold",KN),Xt.mergeOptions({touchZoom:at.touch,bounceAtZoomLimits:!0});var ZN=Sa.extend({addHooks:function(){Lt(this._map._container,"leaflet-touch-zoom"),Dt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Mn(this._map._container,"leaflet-touch-zoom"),un(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(l){var h=this._map;if(!(!l.touches||l.touches.length!==2||h._animatingZoom||this._zooming)){var _=h.mouseEventToContainerPoint(l.touches[0]),k=h.mouseEventToContainerPoint(l.touches[1]);this._centerPoint=h.getSize()._divideBy(2),this._startLatLng=h.containerPointToLatLng(this._centerPoint),h.options.touchZoom!=="center"&&(this._pinchStartLatLng=h.containerPointToLatLng(_.add(k)._divideBy(2))),this._startDist=_.distanceTo(k),this._startZoom=h.getZoom(),this._moved=!1,this._zooming=!0,h._stop(),Dt(document,"touchmove",this._onTouchMove,this),Dt(document,"touchend touchcancel",this._onTouchEnd,this),ms(l)}},_onTouchMove:function(l){if(!(!l.touches||l.touches.length!==2||!this._zooming)){var h=this._map,_=h.mouseEventToContainerPoint(l.touches[0]),k=h.mouseEventToContainerPoint(l.touches[1]),M=_.distanceTo(k)/this._startDist;if(this._zoom=h.getScaleZoom(M,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&M<1||this._zoom>h.getMaxZoom()&&M>1)&&(this._zoom=h._limitZoom(this._zoom)),h.options.touchZoom==="center"){if(this._center=this._startLatLng,M===1)return}else{var Z=_._add(k)._divideBy(2)._subtract(this._centerPoint);if(M===1&&Z.x===0&&Z.y===0)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(Z),this._zoom)}this._moved||(h._moveStart(!0,!1),this._moved=!0),W(this._animRequest);var ce=o(h._move,h,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=D(ce,this,!0),ms(l)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,W(this._animRequest),un(document,"touchmove",this._onTouchMove,this),un(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Xt.addInitHook("addHandler","touchZoom",ZN),Xt.BoxZoom=UN,Xt.DoubleClickZoom=qN,Xt.Drag=HN,Xt.Keyboard=WN,Xt.ScrollWheelZoom=VN,Xt.TapHold=KN,Xt.TouchZoom=ZN,n.Bounds=B,n.Browser=at,n.CRS=Q,n.Canvas=FN,n.Circle=Ox,n.CircleMarker=lf,n.Class=G,n.Control=Qr,n.DivIcon=IN,n.DivOverlay=ka,n.DomEvent=LO,n.DomUtil=IO,n.Draggable=Oi,n.Evented=F,n.FeatureGroup=si,n.GeoJSON=ai,n.GridLayer=vu,n.Handler=Sa,n.Icon=pc,n.ImageOverlay=mf,n.LatLng=te,n.LatLngBounds=z,n.Layer=Yr,n.LayerGroup=fc,n.LineUtil=QO,n.Map=Xt,n.Marker=of,n.Mixin=HO,n.Path=Li,n.Point=T,n.PolyUtil=WO,n.Polygon=gc,n.Polyline=ri,n.Popup=ff,n.PosAnimation=xN,n.Projection=YO,n.Rectangle=$N,n.Renderer=ii,n.SVG=_u,n.SVGOverlay=RN,n.TileLayer=vc,n.Tooltip=pf,n.Transformation=ae,n.Util=V,n.VideoOverlay=MN,n.bind=o,n.bounds=O,n.canvas=BN,n.circle=a6,n.circleMarker=r6,n.control=pu,n.divIcon=f6,n.extend=a,n.featureGroup=t6,n.geoJSON=TN,n.geoJson=l6,n.gridLayer=p6,n.icon=n6,n.imageOverlay=c6,n.latLng=ee,n.latLngBounds=$,n.layerGroup=e6,n.map=FO,n.marker=s6,n.point=U,n.polygon=o6,n.polyline=i6,n.popup=h6,n.rectangle=v6,n.setOptions=x,n.stamp=d,n.svg=zN,n.svgOverlay=u6,n.tileLayer=ON,n.tooltip=m6,n.transformation=fe,n.version=r,n.videoOverlay=d6;var _6=window.L;n.noConflict=function(){return window.L=_6,this},window.L=n})})(cE,cE.exports);var tb;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(tb||(tb={}));var dE;(function(t){t.None="NONE",t.Slide="SLIDE",t.Fade="FADE"})(dE||(dE={}));const zy=oc("StatusBar"),$y=oc("TimeTracking"),Uy=oc("DeliveryNotes"),Tc=oc("OfflineSync"),ul=class ul{static getInstance(){return ul.instance||(ul.instance=new ul),ul.instance}async startTracking(e,n,r){try{return await $y.startTimeTracking({projectId:e,projectName:n,description:r})}catch(a){throw console.error("Android time tracking start failed:",a),a}}async stopTracking(e){try{return await $y.stopTimeTracking({notes:e})}catch(n){throw console.error("Android time tracking stop failed:",n),n}}async getActiveSession(){try{return await $y.getActiveTimeTracking()}catch(e){throw console.error("Android get active session failed:",e),e}}};fs(ul,"instance");let Y0=ul;const hl=class hl{static getInstance(){return hl.instance||(hl.instance=new hl),hl.instance}async getPendingNotes(){try{return(await Uy.getPendingDeliveryNotes()).deliveryNotes}catch(e){throw console.error("Android get pending delivery notes failed:",e),e}}async signNote(e,n,r){try{return await Uy.signDeliveryNote({deliveryNoteId:e,signerName:n,signatureData:r})}catch(a){throw console.error("Android sign delivery note failed:",a),a}}async getPendingSignatures(){try{return(await Uy.getPendingSignatures()).pendingSignatures}catch(e){throw console.error("Android get pending signatures failed:",e),e}}};fs(hl,"instance");let X0=hl;const ml=class ml{static getInstance(){return ml.instance||(ml.instance=new ml),ml.instance}async addOfflineAction(e,n){try{return await Tc.addOfflineAction({actionType:e,actionData:n})}catch(r){throw console.error("Android add offline action failed:",r),r}}async getNetworkStatus(){try{return await Tc.getNetworkStatus()}catch(e){return console.error("Android get network status failed:",e),{connected:!1,connectionType:"none"}}}async getPendingActions(){try{return(await Tc.getPendingActions()).pendingActions}catch(e){throw console.error("Android get pending actions failed:",e),e}}async markActionSynced(e){try{await Tc.markActionSynced({actionId:e})}catch(n){throw console.error("Android mark action synced failed:",n),n}}async getQueueLength(){try{return(await Tc.getQueueLength()).length}catch(e){return console.error("Android get queue length failed:",e),0}}async saveOfflineTimeEntry(e){try{return await Tc.saveOfflineTimeEntry({timeEntry:e})}catch(n){throw console.error("Android save offline time entry failed:",n),n}}};fs(ml,"instance");let gm=ml;const zp=()=>window.Capacitor&&window.Capacitor.getPlatform()==="android";Y0.getInstance();X0.getInstance();gm.getInstance();const Jse=()=>{const t=Y0.getInstance(),e=gm.getInstance();return{startTracking:t.startTracking.bind(t),stopTracking:t.stopTracking.bind(t),getActiveSession:t.getActiveSession.bind(t),addOfflineAction:e.addOfflineAction.bind(e),getNetworkStatus:e.getNetworkStatus.bind(e),getQueueLength:e.getQueueLength.bind(e)}},ere=()=>{const t=X0.getInstance(),e=gm.getInstance();return{getPendingNotes:t.getPendingNotes.bind(t),signNote:t.signNote.bind(t),getPendingSignatures:t.getPendingSignatures.bind(t),addOfflineAction:e.addOfflineAction.bind(e)}},uE=t=>t.toTimeString().split(" ")[0],tre=t=>t.toISOString().split("T")[0],nre=(t,e)=>{const[n,r]=t.split(":").map(Number),[a,i]=e.split(":").map(Number),o=a*60+i-(n*60+r);return Math.round(o/60*100)/100},sre=()=>{const[t,e]=g.useState({active:!1}),[n,r]=g.useState(!1),[a,i]=g.useState([]),[o,c]=g.useState(null);zp()&&Jse();const d=g.useCallback(async()=>{try{r(!0);const v=localStorage.getItem("activeTimeEntry");if(v){const w=JSON.parse(v),x=new Date(w.startedAt),j=Math.floor((new Date().getTime()-x.getTime())/1e3/60);e({active:!0,segment:{id:w.id,project_id:w.project_id,project_name:w.project_name||null,customer_name:w.customer_name||null,segment_type:"work",started_at:w.startedAt,current_duration_minutes:j,description:w.description}}),c(w)}else e({active:!1}),c(null)}catch(v){console.error("Error in fetchActiveTime:",v),e({active:!1})}finally{r(!1)}},[]),u=g.useCallback(async(v,w="work",x)=>{try{r(!0);const{data:{user:y}}=await K.auth.getUser();if(!y){Te.error("Nicht angemeldet");return}const j=new Date,b={id:crypto.randomUUID(),employee_id:y.id,project_id:v,project_name:null,startedAt:j.toISOString(),date:tre(j),start_time:uE(j),description:x||null,segment_type:w};if(v){const{data:N}=await K.from("projects").select("name, customers(name)").eq("id",v).single();N&&(b.project_name=N.name)}localStorage.setItem("activeTimeEntry",JSON.stringify(b)),Te.success("Zeiterfassung gestartet"),await d()}catch(y){console.error("Error starting time tracking:",y),Te.error("Fehler beim Starten der Zeiterfassung")}finally{r(!1)}},[d]),m=g.useCallback(async v=>{try{r(!0);const w=localStorage.getItem("activeTimeEntry");if(!w){Te.error("Keine aktive Zeiterfassung");return}const x=JSON.parse(w),j=uE(new Date),b=nre(x.start_time,j),{data:{user:N}}=await K.auth.getUser();if(!N){Te.error("Nicht angemeldet");return}let S=N.id;const{data:E}=await K.from("employees").select("id").eq("user_id",N.id).single();E&&(S=E.id);const{data:C,error:P}=await K.from("timesheets").insert({employee_id:S,project_id:x.project_id,date:x.date,start_time:x.start_time,end_time:j,hours:b,break_minutes:0,description:v?x.description?`${x.description}
${v}`:v:x.description,task_category:"general",is_billable:!0}).select().single();if(P)if(console.error("Error saving timesheet:",P),P.message.includes("employees")){const{data:R,error:H}=await K.from("timesheets").insert({employee_id:N.id,project_id:x.project_id,date:x.date,start_time:x.start_time,end_time:j,hours:b,break_minutes:0,description:v?x.description?`${x.description}
${v}`:v:x.description,task_category:"general",is_billable:!0}).select().single();if(H)throw H}else throw P;localStorage.removeItem("activeTimeEntry"),Te.success("Zeiterfassung beendet und gespeichert"),e({active:!1}),c(null),await p()}catch(w){console.error("Error stopping time tracking:",w),Te.error(`Fehler beim Beenden: ${w.message}`)}finally{r(!1)}},[p]),f=g.useCallback(async(v,w="work",x,y)=>{try{r(!0),t.active&&await m(y),await u(v,w,x)}catch(j){console.error("Error switching project:",j),Te.error("Fehler beim Projektwechsel")}finally{r(!1)}},[t,m,u]),p=g.useCallback(async()=>{try{const{data:{user:v}}=await K.auth.getUser();if(!v)return;let w=v.id;const{data:x}=await K.from("employees").select("id").eq("user_id",v.id).single();x&&(w=x.id);const{data:y,error:j}=await K.from("timesheets").select(`
          *,
          projects(id, name, customers(name))
        `).eq("employee_id",w).order("date",{ascending:!1}).order("start_time",{ascending:!1}).limit(20);if(j&&!j.message.includes("relation")){console.error("Error fetching time segments:",j);const{data:b}=await K.from("timesheets").select(`
            *,
            projects(id, name, customers(name))
          `).eq("employee_id",v.id).order("date",{ascending:!1}).order("start_time",{ascending:!1}).limit(20);i(b||[]);return}i(y||[])}catch(v){console.error("Error in fetchTimeSegments:",v)}},[]);return g.useEffect(()=>{d(),p();const v=setInterval(()=>{t.active&&d()},3e4);return()=>clearInterval(v)},[]),{activeTime:t,isLoading:n,segments:a,startTracking:u,stopTracking:m,switchProject:f,fetchActiveTime:d,fetchTimeSegments:p}},rre=H3,are=W3,H5=g.forwardRef(({className:t,...e},n)=>s.jsx(tx,{className:Ie("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));H5.displayName=tx.displayName;const ire=Kd("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),W5=g.forwardRef(({side:t="right",className:e,children:n,...r},a)=>s.jsxs(are,{children:[s.jsx(H5,{}),s.jsxs(nx,{ref:a,className:Ie(ire({side:t}),e),...r,children:[n,s.jsxs(V3,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[s.jsx($n,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));W5.displayName=nx.displayName;const V5=({className:t,...e})=>s.jsx("div",{className:Ie("flex flex-col space-y-2 text-center sm:text-left",t),...e});V5.displayName="SheetHeader";const K5=g.forwardRef(({className:t,...e},n)=>s.jsx(sx,{ref:n,className:Ie("text-lg font-semibold text-foreground",t),...e}));K5.displayName=sx.displayName;const Z5=g.forwardRef(({className:t,...e},n)=>s.jsx(rx,{ref:n,className:Ie("text-sm text-muted-foreground",t),...e}));Z5.displayName=rx.displayName;const ore=({isOpen:t,onClose:e,onProjectSelect:n,currentProjectId:r})=>{const[a,i]=g.useState([]),[o,c]=g.useState([]),[d,u]=g.useState([]),[m,f]=g.useState(""),[p,v]=g.useState(!1),[w,x]=g.useState("recent"),y=g.useCallback(async()=>{v(!0);try{const{data:C,error:P}=await K.from("projects").select(`
          id, name, status, location, color, customer_id
        `).not("status","eq","abgeschlossen").not("status","eq","completed").not("status","eq","cancelled").not("status","eq","archiviert").order("name");if(P){console.error("Failed to load projects:",P),Te.error(`Fehler beim Laden der Projekte: ${P.message}`),Te.error(`Error Details: ${P.details||"No details"}`),Te.error(`Error Hint: ${P.hint||"No hint"}`),i([]);return}i(C||[])}catch(C){console.error("Error loading projects:",C)}finally{v(!1)}},[]),j=g.useCallback(async()=>{try{const{data:C,error:P}=await K.from("time_segments").select(`
          project_id,
          started_at,
          project:projects(name, customer:customers(name))
        `).not("project_id","is",null).order("started_at",{ascending:!1}).limit(10);if(P){console.error("Failed to load recent projects:",P),c([]);return}const R=new Map;C==null||C.forEach(I=>{var D;if(I.project_id&&I.project){const W=R.get(I.project_id);W?(W.usage_count++,I.started_at>W.last_used&&(W.last_used=I.started_at)):R.set(I.project_id,{project_id:I.project_id,project_name:I.project.name,customer_name:(D=I.project.customer)==null?void 0:D.name,last_used:I.started_at,usage_count:1})}});const H=Array.from(R.values()).sort((I,D)=>new Date(D.last_used).getTime()-new Date(I.last_used).getTime()).slice(0,5);c(H)}catch(C){console.error("Error loading recent projects:",C)}},[]),b=g.useCallback(async()=>{const C=a.filter(P=>P.is_favorite);u(C)},[a]);g.useEffect(()=>{t&&(y(),j())},[t,y,j]),g.useEffect(()=>{b()},[b]);const N=a.filter(C=>{var P;return C.name.toLowerCase().includes(m.toLowerCase())||((P=C.customer)==null?void 0:P.name.toLowerCase().includes(m.toLowerCase()))}),S=C=>{n(C)},E=async()=>{Te.info("QR-Code Scanner wird implementiert")};return s.jsx(rre,{open:t,onOpenChange:e,children:s.jsxs(W5,{side:"bottom",className:"h-[80vh]",children:[s.jsxs(V5,{children:[s.jsxs(K5,{className:"flex items-center gap-2",children:[s.jsx(Pt,{className:"h-5 w-5"}),"Projekt wählen"]}),s.jsx(Z5,{children:"Wählen Sie ein Projekt für die Zeiterfassung"})]}),s.jsxs("div",{className:"mt-4 space-y-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(ec,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),s.jsx(re,{placeholder:"Projekt oder Kunde suchen...",value:m,onChange:C=>f(C.target.value),className:"pl-10"})]}),s.jsxs(es,{value:w,onValueChange:C=>x(C),children:[s.jsxs(Hn,{className:"grid w-full grid-cols-4",children:[s.jsxs(He,{value:"recent",className:"text-xs",children:[s.jsx(Pt,{className:"h-4 w-4 mr-1"}),"Zuletzt"]}),s.jsxs(He,{value:"all",className:"text-xs",children:[s.jsx(fS,{className:"h-4 w-4 mr-1"}),"Alle"]}),s.jsxs(He,{value:"favorites",className:"text-xs",children:[s.jsx(Ji,{className:"h-4 w-4 mr-1"}),"Favoriten"]}),s.jsxs(He,{value:"scan",className:"text-xs",children:[s.jsx(xv,{className:"h-4 w-4 mr-1"}),"Scan"]})]}),s.jsx(We,{value:"recent",className:"space-y-2 max-h-[400px] overflow-y-auto",children:o.length>0?o.map(C=>s.jsx(oe,{className:`cursor-pointer transition-colors hover:bg-muted/50 ${r===C.project_id?"ring-2 ring-primary":""}`,onClick:()=>S(C.project_id),children:s.jsx(de,{className:"p-4",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-medium",children:C.project_name}),r===C.project_id&&s.jsx(Be,{variant:"secondary",children:"Aktiv"})]}),C.customer_name&&s.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[s.jsx(Ds,{className:"h-3 w-3"}),C.customer_name]}),s.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[s.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[s.jsx(At,{className:"h-3 w-3"}),new Date(C.last_used).toLocaleString("de-DE",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})]}),s.jsxs(Be,{variant:"outline",className:"text-xs",children:[C.usage_count,"x verwendet"]})]})]})})})},C.project_id)):s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(Pt,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"Keine zuletzt verwendeten Projekte"})]})}),s.jsx(We,{value:"all",className:"space-y-2 max-h-[400px] overflow-y-auto",children:N.length>0?N.map(C=>s.jsx(oe,{className:`cursor-pointer transition-colors hover:bg-muted/50 ${r===C.id?"ring-2 ring-primary":""}`,onClick:()=>S(C.id),children:s.jsx(de,{className:"p-4",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-medium",children:C.name}),r===C.id&&s.jsx(Be,{variant:"secondary",children:"Aktiv"}),C.color&&s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:C.color}})]}),C.customer&&s.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[s.jsx(Ds,{className:"h-3 w-3"}),C.customer.name]}),C.location&&s.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-1",children:[s.jsx(Mi,{className:"h-3 w-3"}),C.location]})]})})})},C.id)):s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(fS,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:m?"Keine Projekte gefunden":"Noch keine Projekte erstellt"}),!m&&s.jsx("p",{className:"text-xs mt-2",children:"Erstellen Sie ein neues Projekt über die Schaltfläche unten"})]})}),s.jsx(We,{value:"favorites",className:"space-y-2 max-h-[400px] overflow-y-auto",children:d.length>0?d.map(C=>s.jsx(oe,{className:"cursor-pointer transition-colors hover:bg-muted/50",onClick:()=>S(C.id),children:s.jsx(de,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ji,{className:"h-4 w-4 text-yellow-500 fill-current"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium",children:C.name}),C.customer&&s.jsx("p",{className:"text-sm text-muted-foreground",children:C.customer.name})]})]})})},C.id)):s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(Ji,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),s.jsx("p",{children:"Noch keine Favoriten"}),s.jsx("p",{className:"text-xs mt-1",children:"Markieren Sie Projekte als Favoriten"})]})}),s.jsx(We,{value:"scan",className:"space-y-4",children:s.jsxs("div",{className:"text-center py-8",children:[s.jsx(xv,{className:"h-16 w-16 mx-auto mb-4 text-primary"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"QR-Code scannen"}),s.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Scannen Sie einen QR-Code um schnell zu einem Projekt zu wechseln"}),s.jsxs(ne,{onClick:E,className:"w-full",children:[s.jsx(xv,{className:"h-4 w-4 mr-2"}),"Scanner starten"]})]})})]}),s.jsx("div",{className:"border-t pt-4",children:s.jsxs(ne,{variant:"outline",className:"w-full",onClick:()=>{Te.info("Neues Projekt erstellen wird implementiert")},children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Neues Projekt erstellen"]})})]})]})})},lre=({onProjectSelect:t})=>{var X;const{activeTime:e,isLoading:n,startTracking:r,stopTracking:a,switchProject:i}=sre(),[o,c]=g.useState({totalWorkMinutes:0,totalBreakMinutes:0,segmentCount:0,currentStreak:0,targetHours:8*60,efficiency:0}),[d,u]=g.useState(new Date),[m,f]=g.useState(!1),[p,v]=g.useState(null),[w,x]=g.useState([]),[y,j]=g.useState({isActive:!1,remainingSeconds:0,totalSeconds:0}),[b,N]=g.useState(null);g.useEffect(()=>{const F=setInterval(()=>{u(new Date),y.isActive&&y.remainingSeconds>0?j(T=>({...T,remainingSeconds:T.remainingSeconds-1})):y.isActive&&y.remainingSeconds<=0&&j(T=>({...T,isActive:!1}))},1e3);return()=>clearInterval(F)},[y.isActive,y.remainingSeconds]),g.useEffect(()=>{(async()=>{try{console.log("Loading real projects from database..."),console.log("Testing supabase connection...");const{data:T,error:q}=await K.from("projects").select("id, name").limit(1);if(console.log("Basic connection test result:",{testData:T,testError:q}),q){console.log("Basic connection failed, trying fallback approach...");const O=[{id:"mock-project-1",name:"Test Baustelle A",customer:{name:"Mustermann GmbH"}},{id:"mock-project-2",name:"Test Baustelle B",customer:{name:"Schmidt & Co"}},{id:"mock-project-3",name:"Neubau Bürogebäude",customer:{name:"Bau AG"}}];console.log("Using mock projects due to database error:",q.message),x(O),Te.info(`${O.length} Test-Projekte geladen (Offline-Modus)`);return}let{data:U,error:B}=await K.from("projects").select("id, name, customer_id").eq("status","active").order("name");if(B){console.log("Even simple query failed, trying different approach:",B.message);const{data:O,error:z}=await K.from("projects").select("id, name, customer_id").order("name").limit(10);if(z)throw z;U=O}if(U&&U.length>0)try{const O=[...new Set(U.map($=>$.customer_id).filter(Boolean))];let z=new Map;if(O.length>0){const{data:$}=await K.from("customers").select("id, name").in("id",O);$&&$.forEach(te=>z.set(te.id,te))}U=U.map($=>({...$,customer:$.customer_id&&z.has($.customer_id)?{name:z.get($.customer_id).name}:null}))}catch(O){console.log("Customer loading failed, using projects without customer names:",O)}if(B)throw B;console.log("Loaded projects:",U),x(U||[]),U&&U.length>0?Te.success(`${U.length} Projekte geladen`):Te.info("Keine aktiven Projekte gefunden")}catch(T){console.error("Error loading projects:",T),console.error("Error message:",T.message),console.error("Error details:",JSON.stringify(T,null,2)),Te.error(`Fehler beim Laden der Projekte: ${T.message||"Unbekannter Fehler"}`)}})(),S()},[]);const S=async()=>{try{const{data:{user:F}}=await K.auth.getUser();if(!F){console.log("No user found"),N({default_break_duration:15});return}console.log("Loading company settings for user:",F.id);const{data:T,error:q}=await K.from("user_profiles").select("company_id").eq("user_id",F.id).single();if(console.log("User profile result:",{data:T,error:q}),q||!(T!=null&&T.company_id)){console.log("No company_id found, trying to fix automatically...");const{data:O,error:z}=await K.from("company_settings").select("id, default_break_duration").order("created_at",{ascending:!1}).limit(1);if(z||!O||O.length===0){console.log("No company found, using default break time"),N({default_break_duration:15});return}console.log("Found company, setting company_id for user:",O[0].id);const{error:$}=await K.from("user_profiles").update({company_id:O[0].id}).eq("user_id",F.id);if($){console.log("Failed to update user profile, using default:",$.message),N({default_break_duration:15});return}console.log("Successfully set company_id, using company settings"),N({default_break_duration:O[0].default_break_duration});return}console.log("Found company_id:",T.company_id);const{data:U,error:B}=await K.from("company_settings").select("default_break_duration").eq("id",T.company_id).single();console.log("Company settings result:",{settings:U,settingsError:B}),B?(console.log("No company settings found, using default:",B.message),N({default_break_duration:15})):(console.log("Loaded company settings - break duration:",U.default_break_duration),N(U))}catch(F){console.error("Error loading company settings:",F),N({default_break_duration:15})}},E=g.useCallback(async()=>{try{const F=new Date,{data:T,error:q}=await K.from("time_segments").select("*").gte("started_at",Bo(F).toISOString()).lte("started_at",QR(F).toISOString()).order("started_at");if(q){console.warn("Time segments table not found, using mock data"),c({totalWorkMinutes:240,totalBreakMinutes:30,segmentCount:3,currentStreak:120,targetHours:8*60,efficiency:85});return}const U=(T==null?void 0:T.filter(ee=>ee.segment_type==="work"&&ee.ended_at).reduce((ee,Q)=>ee+(Q.duration_minutes_computed||0),0))||0,B=(T==null?void 0:T.filter(ee=>ee.segment_type==="break"&&ee.ended_at).reduce((ee,Q)=>ee+(Q.duration_minutes_computed||0),0))||0,O=(T==null?void 0:T.length)||0;let z=0;if(e.active&&e.segment){const ee=new Date(e.segment.started_at);z=um(new Date,ee)}const $=U+B,te=$>0?Math.round(U/$*100):0;c({totalWorkMinutes:U,totalBreakMinutes:B,segmentCount:O,currentStreak:z,targetHours:8*60,efficiency:te})}catch(F){console.error("Error loading today stats:",F)}},[e]);g.useEffect(()=>{E();const F=setInterval(E,3e4);return()=>clearInterval(F)},[E]);const C=F=>{const T=Math.floor(F/60),q=F%60;return T>0?`${T}:${q.toString().padStart(2,"0")}h`:`${q}min`},P=()=>{if(!e.active||!e.segment)return 0;const F=new Date(e.segment.started_at);return um(d,F)},R=async F=>{try{const T=F||(p==null?void 0:p.id);if(!T){Te.error("Bitte wählen Sie zuerst ein Projekt aus");return}Te.info("Starte Zeiterfassung...",{duration:1e3}),console.log("Starting tracking for project:",T),await r(T,"work","Mobile Start"),Te.success("Zeiterfassung gestartet"),console.log("Start tracking completed")}catch(T){console.error("Start error:",T),Te.error(`Fehler beim Starten: ${T}`)}},H=async()=>{try{await a("Mobile Stop"),Te.success("Zeiterfassung beendet")}catch(F){console.error("Stop error:",F),Te.error("Fehler beim Beenden")}},I=async()=>{try{e.active&&await a("Pause gestartet"),await r("break-project","break","Pause");const F=(b==null?void 0:b.default_break_duration)||15,T=F*60;console.log("🟡 BREAK TIMER DEBUG:"),console.log("Company settings:",b),console.log("Break duration (minutes):",F),console.log("Total seconds:",T),j({isActive:!0,remainingSeconds:T,totalSeconds:T})}catch(F){console.error("Break error:",F)}},D=async()=>{try{Te.info("Starte Fahrt...",{duration:1e3}),e.active&&await a("Fahrt gestartet"),await r("drive-project","drive","Fahrt"),Te.success("Fahrt gestartet")}catch(F){console.error("Drive error:",F),Te.error(`Fehler bei Fahrt: ${F}`)}},W=F=>{const T=Math.floor(F/60),q=F%60;return`${T.toString().padStart(2,"0")}:${q.toString().padStart(2,"0")}`},V=Math.min(o.totalWorkMinutes/o.targetHours*100,100),G=o.totalWorkMinutes>=o.targetHours,Y=Math.max(0,o.targetHours-o.totalWorkMinutes);return s.jsxs("div",{className:"space-y-4 p-4 max-w-md mx-auto",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-2xl font-bold",children:"Heute"}),s.jsx("p",{className:"text-muted-foreground",children:De(d,"EEEE, dd. MMMM yyyy",{locale:zt})})]}),s.jsxs(oe,{className:`scroll-snap-start min-h-[250px] ${e.active?"ring-2 ring-green-500":""}`,children:[s.jsx(je,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Ne,{className:"text-lg flex items-center gap-2",children:[s.jsx(rj,{className:`h-5 w-5 ${e.active?"text-green-500":"text-gray-400"}`}),e.active?"Läuft":"Gestoppt"]}),e.active&&e.segment&&s.jsx(Be,{variant:"outline",children:e.segment.segment_type==="work"?"Arbeit":e.segment.segment_type==="break"?"Pause":"Fahrt"})]})}),s.jsx(de,{children:e.active&&e.segment?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-4xl font-mono font-bold text-green-600",children:C(P())}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.segment.project_name||"Allgemein"})]}),y.isActive&&s.jsxs("div",{className:"text-center bg-orange-50 p-3 rounded-lg border border-orange-200",children:[s.jsx("div",{className:"text-2xl font-mono font-bold text-orange-600 mb-1",children:W(y.remainingSeconds)}),s.jsx("p",{className:"text-xs text-orange-700",children:"Pausenzeit verbleibt"}),s.jsx("div",{className:"w-full bg-orange-200 rounded-full h-2 mt-2",children:s.jsx("div",{className:"bg-orange-500 h-2 rounded-full transition-all duration-1000",style:{width:`${(y.totalSeconds-y.remainingSeconds)/y.totalSeconds*100}%`}})}),s.jsx(ne,{variant:"outline",size:"sm",onClick:()=>j(F=>({...F,isActive:!1})),className:"mt-2 text-xs",children:"Pause beenden"})]}),s.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.jsxs("div",{children:["Gestartet: ",De(new Date(e.segment.started_at),"HH:mm")]}),e.segment.description&&s.jsxs("div",{children:["Notiz: ",e.segment.description]})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(ne,{variant:"outline",size:"sm",onClick:I,className:"flex-1",children:[s.jsx(Fh,{className:"h-4 w-4 mr-2"}),"Pause"]}),s.jsxs(ne,{variant:"destructive",size:"sm",onClick:H,disabled:n,className:"flex-1",children:[s.jsx(sj,{className:"h-4 w-4 mr-2"}),"Stopp"]})]})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"text-center",children:p?s.jsxs(s.Fragment,{children:[s.jsx(Pt,{className:"h-12 w-12 mx-auto mb-2 text-blue-500 opacity-80"}),s.jsx("p",{className:"font-medium text-lg",children:p.name}),p.customer&&s.jsx("p",{className:"text-sm text-muted-foreground",children:p.customer.name}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Bereit zum Start"})]}):s.jsxs(s.Fragment,{children:[s.jsx(Pt,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:"Keine aktive Zeiterfassung"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Bitte wählen Sie ein Projekt aus"})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs(ne,{onClick:()=>R(),disabled:n,className:"h-12",children:[s.jsx(Yc,{className:"h-4 w-4 mr-2"}),"Start"]}),s.jsxs(ne,{variant:"outline",onClick:()=>{console.log("🔥 PROJEKT BUTTON CLICKED!"),console.log("Before setState - showQuickSwitch:",m),f(!0),console.log("After setState called"),Te.info("Projekt-Dialog wird geöffnet...")},disabled:n,className:"h-12",children:[s.jsx(fP,{className:"h-4 w-4 mr-2"}),"Projekt"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ne,{variant:"outline",size:"sm",onClick:I,className:"flex-1",children:[s.jsx(Fh,{className:"h-4 w-4 mr-1"}),"Pause"]}),s.jsxs(ne,{variant:"outline",size:"sm",onClick:D,className:"flex-1",children:[s.jsx(_g,{className:"h-4 w-4 mr-1"}),"Fahrt"]})]})]})})]}),s.jsxs(oe,{className:"scroll-snap-start min-h-[300px]",children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"text-lg flex items-center gap-2",children:[s.jsx(Ei,{className:"h-5 w-5"}),"Tages-Übersicht"]})}),s.jsxs(de,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-sm font-medium",children:"Tagesziel"}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:[C(o.totalWorkMinutes)," / ",C(o.targetHours)]})]}),s.jsx(zo,{value:V,className:"h-2"}),s.jsxs("div",{className:"flex justify-between items-center mt-1",children:[s.jsx("span",{className:`text-xs ${G?"text-green-600":"text-muted-foreground"}`,children:G?s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Md,{className:"h-3 w-3"}),"Ziel erreicht!"]}):`Noch ${C(Y)}`}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[Math.round(V),"%"]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-semibold text-blue-600",children:C(o.totalWorkMinutes)}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Arbeitszeit"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-semibold text-orange-600",children:C(o.totalBreakMinutes)}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Pausen"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-semibold text-green-600",children:o.segmentCount}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Segmente"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-lg font-semibold text-purple-600",children:[o.efficiency,"%"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Effizienz"})]})]}),o.currentStreak>0&&s.jsxs(s.Fragment,{children:[s.jsx(qa,{}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(h0,{className:"h-4 w-4 text-yellow-500"}),s.jsx("span",{className:"text-sm font-medium",children:"Aktueller Streak"})]}),s.jsx("span",{className:"text-sm font-semibold text-yellow-600",children:C(o.currentStreak)})]})]})]})]}),s.jsx(ore,{isOpen:m,onClose:()=>f(!1),onProjectSelect:async F=>{try{console.log("onProjectSelect called with:",F),console.log("projects state:",w),console.log("projects type:",typeof w),console.log("projects length:",w==null?void 0:w.length);let T=null;try{w&&Array.isArray(w)&&w.length>0?(T=w.find(q=>q&&q.id===F),console.log("Found project in list:",T)):console.log("Projects not ready:",w)}catch(q){console.error("Error in projects.find:",q)}if(!T)try{const{data:q,error:U}=await K.from("projects").select("id, name, customer_id").eq("id",F).single();!U&&q&&(T=q,x(B=>[...B,T]))}catch(q){console.error("Database error:",q)}e.active?await i(F,"work","Projekt gewechselt"):T&&v(T),f(!1),t&&t(F)}catch(T){console.error("Project switch error:",T)}},currentProjectId:(X=e.segment)==null?void 0:X.project_id})]})},cre=({refreshTrigger:t})=>{const[e,n]=g.useState([]),[r,a]=g.useState(!1),[i,o]=g.useState(0),c=g.useCallback(async()=>{a(!0);try{const p=new Date,{data:v,error:w}=await K.from("time_segments").select(`
          id,
          started_at,
          ended_at,
          duration_minutes_computed,
          segment_type,
          status,
          description,
          project:projects(
            name,
            customer:customers(name)
          )
        `).gte("started_at",Bo(p).toISOString()).lte("started_at",QR(p).toISOString()).order("started_at",{ascending:!1});if(w){console.warn("Time segments not found, using mock data");const y=[{id:"mock-1",started_at:new Date(Date.now()-3*60*60*1e3).toISOString(),ended_at:new Date(Date.now()-2*60*60*1e3).toISOString(),duration_minutes_computed:60,segment_type:"work",status:"completed",description:"Baustelle Setup",project:{name:"Beispiel Baustelle",customer:{name:"Max Mustermann GmbH"}}},{id:"mock-2",started_at:new Date(Date.now()-2*60*60*1e3).toISOString(),ended_at:new Date(Date.now()-1.5*60*60*1e3).toISOString(),duration_minutes_computed:30,segment_type:"break",status:"completed",description:"Mittagspause"},{id:"mock-3",started_at:new Date(Date.now()-1.5*60*60*1e3).toISOString(),duration_minutes_computed:90,segment_type:"work",status:"active",description:"Montage",project:{name:"Beispiel Baustelle",customer:{name:"Max Mustermann GmbH"}}}];n(y),o(180);return}n(v||[]);const x=(v==null?void 0:v.reduce((y,j)=>y+(j.duration_minutes_computed||0),0))||0;o(x)}catch(p){console.error("Error loading today segments:",p)}finally{a(!1)}},[]);g.useEffect(()=>{c();const p=setInterval(c,3e4);return()=>clearInterval(p)},[c,t]);const d=p=>{const v=Math.floor(p/60),w=p%60;return v>0?`${v}:${w.toString().padStart(2,"0")}h`:`${w}min`},u=p=>{if(p.status==="active"&&!p.ended_at){const v=new Date(p.started_at);return um(new Date,v)}return p.duration_minutes_computed||0},m=p=>{switch(p){case"work":return s.jsx(Yc,{className:"h-4 w-4 text-green-500"});case"break":return s.jsx(Fh,{className:"h-4 w-4 text-orange-500"});case"drive":return s.jsx(_g,{className:"h-4 w-4 text-blue-500"});default:return s.jsx(Pt,{className:"h-4 w-4 text-gray-500"})}},f=(p,v)=>{if(v==="active")return s.jsx(Be,{className:"bg-green-500",children:"Aktiv"});switch(p){case"work":return s.jsx(Be,{variant:"default",children:"Arbeit"});case"break":return s.jsx(Be,{variant:"secondary",children:"Pause"});case"drive":return s.jsx(Be,{variant:"outline",children:"Fahrt"});default:return s.jsx(Be,{variant:"outline",children:p})}};return s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Ne,{className:"text-lg flex items-center gap-2",children:[s.jsx(Pt,{className:"h-5 w-5"}),"Timeline heute"]}),s.jsx(Be,{variant:"outline",children:d(i)})]})}),s.jsxs(de,{children:[s.jsx(wi,{className:"h-[300px] pr-4",children:r?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.length>0?s.jsx("div",{className:"space-y-3",children:e.map((p,v)=>{var j;const w=u(p),x=new Date(p.started_at),y=p.ended_at?new Date(p.ended_at):null;return s.jsxs("div",{className:`relative border rounded-lg p-3 ${p.status==="active"?"ring-2 ring-green-500 bg-green-50":"bg-background"}`,children:[v<e.length-1&&s.jsx("div",{className:"absolute left-6 top-12 w-px h-8 bg-border"}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"flex-shrink-0 p-1",children:m(p.segment_type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[p.project?s.jsx("span",{className:"font-medium truncate",children:p.project.name}):s.jsx("span",{className:"font-medium text-muted-foreground",children:p.segment_type==="break"?"Pause":p.segment_type==="drive"?"Fahrt":"Allgemein"}),f(p.segment_type,p.status)]}),p.status==="active"&&s.jsx("div",{className:"text-lg font-mono font-bold text-green-600",children:d(w)})]}),((j=p.project)==null?void 0:j.customer)&&s.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:p.project.customer.name}),p.description&&s.jsx("p",{className:"text-sm text-muted-foreground mb-2 line-clamp-2",children:p.description}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("span",{children:[De(x,"HH:mm"),y?` - ${De(y,"HH:mm")}`:" - läuft"]}),p.status==="completed"&&s.jsx("span",{className:"font-medium",children:d(p.duration_minutes_computed)})]}),p.status==="completed"&&s.jsx(ne,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 opacity-50 hover:opacity-100",onClick:()=>{console.log("Edit segment:",p.id)},children:s.jsx(_B,{className:"h-3 w-3"})})]})]})]})]},p.id)})}):s.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-muted-foreground",children:[s.jsx(Pt,{className:"h-12 w-12 mb-3 opacity-50"}),s.jsx("p",{className:"text-center mb-1",children:"Noch keine Zeiterfassung heute"}),s.jsx("p",{className:"text-xs text-center",children:"Starten Sie die Zeiterfassung um Ihre Timeline zu sehen"})]})}),e.length>0&&s.jsxs("div",{className:"border-t pt-3 mt-3",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("span",{className:"text-muted-foreground",children:[e.length," Segment",e.length!==1?"e":""," heute"]}),s.jsxs("span",{className:"font-medium",children:["Gesamt: ",d(i)]})]}),s.jsx("div",{className:"flex gap-4 mt-2 text-xs text-muted-foreground",children:["work","break","drive"].map(p=>{const w=e.filter(x=>x.segment_type===p).reduce((x,y)=>x+u(y),0);return w===0?null:s.jsxs("span",{children:[p==="work"?"⚡":p==="break"?"☕":"🚗"," ",d(w)]},p)})})]})]})]})},dre=()=>{const[t,e]=g.useState("today"),[n]=g.useState({totalHours:35.5,totalProjects:4,totalBreaks:12,avgDailyHours:7.1,efficiency:87}),[r]=g.useState({totalHours:142.3,totalDays:18,totalProjects:8,avgDailyHours:7.9,topProjects:[{name:"Projekt A",hours:45.2},{name:"Projekt B",hours:32.1},{name:"Projekt C",hours:28.5}]}),a=()=>s.jsx("div",{className:"h-full scroll-snap-container",children:s.jsxs("div",{className:"space-y-6 p-4 max-w-md mx-auto",children:[s.jsxs(oe,{className:"scroll-snap-start min-h-[300px]",children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"text-lg flex items-center gap-2",children:[s.jsx(At,{className:"h-5 w-5"}),"Diese Woche"]})}),s.jsxs(de,{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-2xl font-bold",children:[n.totalHours,"h"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Gesamt"})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-2xl font-bold",children:[n.avgDailyHours,"h"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø pro Tag"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:n.totalProjects}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Projekte"})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-2xl font-bold",children:[n.efficiency,"%"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Effizienz"})]})]}),s.jsxs("div",{className:"mt-4 pt-4 border-t",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"text-sm",children:"Wochenziel"}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:[n.totalHours,"/40h"]})]}),s.jsx(zo,{value:n.totalHours/40*100,className:"h-2"})]})]})]}),s.jsxs(oe,{className:"scroll-snap-start min-h-[400px]",children:[s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"text-lg flex items-center gap-2",children:[s.jsx(Al,{className:"h-5 w-5"}),"Dieser Monat"]})}),s.jsxs(de,{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"text-2xl font-bold",children:[r.totalHours,"h"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Gesamt"})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-2xl font-bold",children:[r.avgDailyHours,"h"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Ø pro Tag"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:r.totalDays}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Arbeitstage"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-2xl font-bold",children:r.totalProjects}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Projekte"})]})]}),s.jsxs("div",{className:"pt-4 border-t",children:[s.jsx("h4",{className:"text-sm font-medium mb-2",children:"Top Projekte"}),s.jsx("div",{className:"space-y-2",children:r.topProjects.map((o,c)=>s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm truncate flex-1",children:o.name}),s.jsxs(Be,{variant:"secondary",className:"ml-2",children:[o.hours,"h"]})]},c))})]})]})]})]})}),i=()=>s.jsx("div",{className:"h-full scroll-snap-container",children:s.jsx(cre,{})});return s.jsxs("div",{className:"h-full flex flex-col bg-background",children:[s.jsx("div",{className:"flex-none bg-background border-b",children:s.jsxs("div",{className:"flex",children:[s.jsxs("button",{onClick:()=>e("stats"),className:`flex-1 flex items-center justify-center gap-2 py-3 px-4 text-sm font-medium border-b-2 transition-colors ${t==="stats"?"border-primary text-primary bg-primary/5":"border-transparent text-muted-foreground hover:text-foreground"}`,children:[s.jsx(Al,{className:"h-4 w-4"}),"Stats"]}),s.jsxs("button",{onClick:()=>e("today"),className:`flex-1 flex items-center justify-center gap-2 py-3 px-4 text-sm font-medium border-b-2 transition-colors ${t==="today"?"border-primary text-primary bg-primary/5":"border-transparent text-muted-foreground hover:text-foreground"}`,children:[s.jsx(rj,{className:"h-4 w-4"}),"Heute"]}),s.jsxs("button",{onClick:()=>e("timeline"),className:`flex-1 flex items-center justify-center gap-2 py-3 px-4 text-sm font-medium border-b-2 transition-colors ${t==="timeline"?"border-primary text-primary bg-primary/5":"border-transparent text-muted-foreground hover:text-foreground"}`,children:[s.jsx(fB,{className:"h-4 w-4"}),"Timeline"]})]})}),s.jsxs("div",{className:"flex-1 overflow-hidden",children:[t==="stats"&&a(),t==="today"&&s.jsx("div",{className:"h-full scroll-snap-container",children:s.jsx(lre,{})}),t==="timeline"&&i()]})]})},ure=()=>{const[t,e]=g.useState([]),[n,r]=g.useState(!1),[a,i]=g.useState(!1),o=zp()?ere():null,c=g.useCallback(async()=>{try{if(r(!0),zp()&&o)try{const f=(await o.getPendingNotes()).map(p=>({id:p.id,number:p.number,project_id:"android-project",customer_id:"android-customer",company_id:"android-company",status:p.status,delivery_date:new Date(p.createdAt).toISOString().split("T")[0],delivery_address:null,total_work_minutes:0,total_break_minutes:0,signature_data:null,signed_at:null,signed_by_name:null,pdf_url:null,pdf_generated_at:null,created_at:new Date(p.createdAt).toISOString(),updated_at:new Date(p.createdAt).toISOString(),project:{id:"android-project",name:p.projectName,customer:{id:"android-customer",name:p.customerName,email:null,phone:null}}}));e(f);return}catch(m){console.warn("Android delivery notes failed, falling back to web:",m)}try{const{data:m,error:f}=await K.from("delivery_notes").select(`
            *,
            project:projects(
              id,
              name,
              customer:customers(id, name, email, phone)
            ),
            delivery_note_items(*),
            delivery_note_time_segments(
              time_segment:time_segments(started_at, ended_at, duration_minutes)
            )
          `).order("created_at",{ascending:!1});if(f&&!f.message.includes("relation")&&!f.message.includes("does not exist"))throw f;e(m||[])}catch(m){console.warn("Delivery notes tables not found, using mock data:",m.message),e([{id:"mock-1",number:"LS-2024-000001",project_id:"mock-project-1",customer_id:"mock-customer-1",company_id:"mock-company-1",status:"sent",delivery_date:new Date().toISOString().split("T")[0],delivery_address:null,total_work_minutes:480,total_break_minutes:60,signature_data:null,signed_at:null,signed_by_name:null,pdf_url:null,pdf_generated_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),project:{id:"mock-project-1",name:"Beispiel Baustelle",customer:{id:"mock-customer-1",name:"Max Mustermann GmbH",email:"max@example.com",phone:"+49 123 456789"}},delivery_note_items:[{id:"mock-item-1",delivery_note_id:"mock-1",item_type:"time",time_segment_id:"mock-time-1",material_id:null,description:"Arbeitszeit",quantity:8,unit:"Stunden",unit_price:45,total_price:360,sort_order:1}],delivery_note_time_segments:[{time_segment:{started_at:new Date(Date.now()-8*60*60*1e3).toISOString(),ended_at:new Date().toISOString(),duration_minutes:480}}]}])}}catch(m){console.error("Error in fetchDeliveryNotes:",m),e([])}finally{r(!1)}},[o]),d=g.useCallback(async(m,f,p)=>{try{if(zp()&&o)try{const v={paths:[],width:400,height:200},w=await o.signNote(m,p,v);if(w.success)return Te.success("Lieferschein erfolgreich signiert (Android)"),await c(),w}catch(v){console.warn("Android delivery note signing failed, falling back to web:",v)}try{const{data:v,error:w}=await K.rpc("rpc_sign_delivery_note",{p_delivery_note_id:m,p_signature_data:f,p_signer_name:p});if(w&&!w.message.includes("function")&&!w.message.includes("does not exist"))throw w;return Te.success("Lieferschein erfolgreich signiert"),await c(),v}catch(v){if(v.message.includes("function")||v.message.includes("does not exist"))return console.warn("RPC function not found, using mock signing"),e(w=>w.map(x=>x.id===m?{...x,signature_data:f,signed_at:new Date().toISOString(),signed_by_name:p,status:"signed"}:x)),Te.success("Lieferschein erfolgreich signiert (Demo-Modus)"),{id:m};throw v}}catch(v){throw console.error("Error signing delivery note:",v),Te.error("Fehler beim Signieren des Lieferscheins"),v}},[c,o]),u=g.useCallback(async m=>{try{i(!0);const f={id:`mock-${Date.now()}`,number:`LS-${new Date().getFullYear()}-${Math.floor(Math.random()*1e3).toString().padStart(6,"0")}`,project_id:m.projectId,customer_id:m.customerId,company_id:"mock-company",status:"draft",delivery_date:m.deliveryDate||new Date().toISOString().split("T")[0],delivery_address:m.deliveryAddress,total_work_minutes:0,total_break_minutes:0,signature_data:null,signed_at:null,signed_by_name:null,pdf_url:null,pdf_generated_at:null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return e(p=>[f,...p]),Te.success("Lieferschein erstellt (Demo-Modus)"),f}catch(f){throw console.error("Error creating delivery note:",f),Te.error("Fehler beim Erstellen des Lieferscheins"),f}finally{i(!1)}},[]);return{deliveryNotes:t,isLoading:n,isCreating:a,fetchDeliveryNotes:c,createDeliveryNote:u,signDeliveryNote:d}},hre=({isOpen:t,onClose:e,onSave:n,title:r="Lieferschein signieren",description:a="Bitte unterschreiben Sie zur Bestätigung des Erhalts der Leistungen",placeholder:i="Name des Unterzeichners",signerName:o,onSignerNameChange:c})=>{const d=g.useRef(null),[u,m]=g.useState(!1),[f,p]=g.useState(""),[v,w]=g.useState(!1),[x,y]=g.useState(!1),j=o!==void 0?o:f,b=c||p,[N,S]=g.useState([]),[E,C]=g.useState([]),P=400,R=200;g.useEffect(()=>{if(!t||!d.current)return;const F=d.current,T=F.getContext("2d");T&&(F.width=P,F.height=R,T.lineCap="round",T.lineJoin="round",T.strokeStyle="#1f2937",T.lineWidth=2,T.clearRect(0,0,P,R),T.fillStyle="#ffffff",T.fillRect(0,0,P,R),T.beginPath(),T.strokeStyle="#e5e7eb",T.lineWidth=1,T.setLineDash([5,5]),T.moveTo(20,R-30),T.lineTo(P-20,R-30),T.stroke(),T.setLineDash([]),T.font="12px system-ui",T.fillStyle="#6b7280",T.textAlign="center",T.fillText("Unterschrift",P/2,R-10),T.strokeStyle="#1f2937",T.lineWidth=2,E.forEach(q=>{q.length>1&&(T.beginPath(),T.moveTo(q[0].x,q[0].y),q.slice(1).forEach(U=>{T.lineTo(U.x,U.y)}),T.stroke())}))},[t,E]);const H=F=>{const q=d.current.getBoundingClientRect();let U,B;return"touches"in F?(U=F.touches[0].clientX,B=F.touches[0].clientY):(U=F.clientX,B=F.clientY),{x:(U-q.left)*P/q.width,y:(B-q.top)*R/q.height}},I=F=>{F.preventDefault(),m(!0),y(!0);const T=H(F);S([T])},D=F=>{if(!u)return;F.preventDefault();const T=d.current,q=T==null?void 0:T.getContext("2d");if(!T||!q)return;const U=H(F),B=[...N,U];if(S(B),N.length>0){const O=N[N.length-1];q.beginPath(),q.moveTo(O.x,O.y),q.lineTo(U.x,U.y),q.stroke()}},W=()=>{u&&(m(!1),N.length>0&&(C(F=>[...F,N]),S([])))},V=()=>{C([]),S([]),y(!1);const F=d.current,T=F==null?void 0:F.getContext("2d");!F||!T||(T.clearRect(0,0,P,R),T.fillStyle="#ffffff",T.fillRect(0,0,P,R),T.beginPath(),T.strokeStyle="#e5e7eb",T.lineWidth=1,T.setLineDash([5,5]),T.moveTo(20,R-30),T.lineTo(P-20,R-30),T.stroke(),T.setLineDash([]),T.font="12px system-ui",T.fillStyle="#6b7280",T.textAlign="center",T.fillText("Unterschrift",P/2,R-10),T.strokeStyle="#1f2937",T.lineWidth=2)},G=()=>{if(E.length===0)return"";let F="";return E.forEach(T=>{if(T.length>1){let q=`M ${T[0].x} ${T[0].y}`;T.slice(1).forEach(U=>{q+=` L ${U.x} ${U.y}`}),F+=`<path d="${q}" stroke="#1f2937" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>`}}),`
      <svg width="${P}" height="${R}" xmlns="http://www.w3.org/2000/svg">
        <rect width="100%" height="100%" fill="white"/>
        ${F}
        <line x1="20" y1="${R-30}" x2="${P-20}" y2="${R-30}" 
              stroke="#e5e7eb" stroke-width="1" stroke-dasharray="5,5"/>
        <text x="${P/2}" y="${R-10}" text-anchor="middle" 
              font-family="system-ui" font-size="12" fill="#6b7280">Unterschrift</text>
      </svg>
    `.trim()},Y=async()=>{if(!x){Te.error("Bitte erstellen Sie zuerst eine Unterschrift");return}if(!j.trim()){Te.error("Bitte geben Sie Ihren Namen ein");return}try{w(!0);const F=G();await n({svg:F,name:j.trim()}),V(),b(""),e()}catch(F){console.error("Error saving signature:",F),Te.error(F.message||"Fehler beim Speichern der Unterschrift")}finally{w(!1)}},X=()=>{V(),c||p(""),e()};return s.jsx(Kt,{open:t,onOpenChange:X,children:s.jsxs(Wt,{className:"max-w-lg",children:[s.jsxs(tn,{children:[s.jsxs(nn,{className:"flex items-center gap-2",children:[s.jsx(Bh,{className:"h-5 w-5"}),r]}),s.jsx(In,{children:a})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"signer-name",children:"Name des Unterzeichners *"}),s.jsx(re,{id:"signer-name",value:j,onChange:F=>b(F.target.value),placeholder:i,required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(se,{children:"Unterschrift *"}),s.jsxs(ne,{type:"button",variant:"outline",size:"sm",onClick:V,disabled:!x,children:[s.jsx(fP,{className:"h-4 w-4 mr-1"}),"Löschen"]})]}),s.jsx(oe,{className:"relative",children:s.jsxs(de,{className:"p-4",children:[s.jsx("canvas",{ref:d,className:"border border-gray-200 rounded-lg w-full cursor-crosshair touch-none",style:{maxWidth:"100%",height:"auto",aspectRatio:`${P}/${R}`},onMouseDown:I,onMouseMove:D,onMouseUp:W,onMouseLeave:W,onTouchStart:I,onTouchMove:D,onTouchEnd:W}),!x&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:s.jsxs("div",{className:"text-center text-muted-foreground",children:[s.jsx(Bh,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"Hier unterschreiben"}),s.jsx("p",{className:"text-xs mt-1 hidden sm:block",children:"Klicken und ziehen oder mit dem Finger zeichnen"}),s.jsx("p",{className:"text-xs mt-1 sm:hidden",children:"Mit dem Finger zeichnen"})]})})]})}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground sm:hidden",children:[s.jsx(pP,{className:"h-3 w-3"}),s.jsx("span",{children:"Tipp: Drehen Sie das Gerät für eine größere Signaturfläche"})]})]}),s.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 p-3 rounded-lg",children:s.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[s.jsx(Md,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-blue-900 dark:text-blue-100 font-medium",children:"Rechtsgültigkeit"}),s.jsx("p",{className:"text-blue-700 dark:text-blue-300 text-xs",children:"Ihre digitale Unterschrift hat die gleiche Rechtsgültigkeit wie eine handschriftliche Unterschrift und bestätigt den Erhalt der erbrachten Leistungen."})]})]})})]}),s.jsxs(Tl,{children:[s.jsxs(ne,{variant:"outline",onClick:X,disabled:v,children:[s.jsx($n,{className:"h-4 w-4 mr-2"}),"Abbrechen"]}),s.jsx(ne,{onClick:Y,disabled:!x||!j.trim()||v,children:v?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-current border-t-transparent rounded-full mr-2"}),"Speichere..."]}):s.jsxs(s.Fragment,{children:[s.jsx(zh,{className:"h-4 w-4 mr-2"}),"Unterschrift speichern"]})})]})]})})},hE={getStatus:async()=>({connected:navigator.onLine,connectionType:navigator.onLine?"wifi":"none"}),addListener:(t,e)=>{if(t==="networkStatusChange"){const n=()=>e({connected:!0,connectionType:"wifi"}),r=()=>e({connected:!1,connectionType:"none"});return window.addEventListener("online",n),window.addEventListener("offline",r),{remove:()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}}return{remove:()=>{}}}},qy={get:async t=>({value:localStorage.getItem(t.key)}),set:async t=>{localStorage.setItem(t.key,t.value)},remove:async t=>{localStorage.removeItem(t.key)},clear:async()=>{localStorage.clear()}};class mre{constructor(){fs(this,"QUEUE_KEY","offline_actions_queue");fs(this,"MAX_RETRIES",3)}async addAction(e,n){const r={id:`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:e,data:n,timestamp:new Date().toISOString(),retryCount:0},a=await this.getQueue();a.push(r),await this.saveQueue(a),console.log(`Added offline action: ${e}`,r)}async getQueue(){try{const{value:e}=await qy.get({key:this.QUEUE_KEY});return e?JSON.parse(e):[]}catch(e){return console.error("Error getting offline queue:",e),[]}}async saveQueue(e){try{await qy.set({key:this.QUEUE_KEY,value:JSON.stringify(e)})}catch(n){console.error("Error saving offline queue:",n)}}async processQueue(e){const n=await this.getQueue();if(n.length===0)return;console.log(`Processing ${n.length} offline actions`);const r=[];for(const a of n)try{await this.executeAction(a,e),console.log(`Successfully processed action: ${a.type}`,a.id)}catch(i){console.error(`Failed to process action: ${a.type}`,i),a.retryCount++,a.retryCount<this.MAX_RETRIES?r.push(a):console.warn(`Action ${a.id} exceeded max retries and will be discarded`)}await this.saveQueue(r)}async executeAction(e,n){var r,a,i,o,c,d,u,m,f,p;switch(e.type){case"START_TIME":await n.rpc("rpc_start_time_tracking",{p_employee_id:e.data.employee_id,p_project_id:e.data.project_id,p_notes:e.data.notes,p_location_lat:(r=e.data.location)==null?void 0:r.lat,p_location_lng:(a=e.data.location)==null?void 0:a.lng});break;case"STOP_TIME":await n.rpc("rpc_stop_time_tracking",{p_employee_id:e.data.employee_id,p_notes:e.data.notes,p_location_lat:(i=e.data.location)==null?void 0:i.lat,p_location_lng:(o=e.data.location)==null?void 0:o.lng});break;case"SWITCH_TIME":await n.rpc("rpc_switch_time_tracking",{p_employee_id:e.data.employee_id,p_project_id:e.data.project_id,p_notes:e.data.notes,p_location_lat:(c=e.data.location)==null?void 0:c.lat,p_location_lng:(d=e.data.location)==null?void 0:d.lng});break;case"CREATE_DELIVERY_NOTE":await n.rpc("rpc_create_delivery_note",{p_employee_id:e.data.employee_id,p_customer_id:e.data.customer_id,p_project_id:e.data.project_id,p_time_segment_ids:e.data.time_segment_ids,p_delivery_note_items:e.data.items,p_notes:e.data.notes,p_location_lat:(u=e.data.location)==null?void 0:u.lat,p_location_lng:(m=e.data.location)==null?void 0:m.lng});break;case"SIGN_DELIVERY_NOTE":await n.rpc("rpc_sign_delivery_note",{p_delivery_note_id:e.data.delivery_note_id,p_signature_data:e.data.signature_data,p_signer_name:e.data.signer_name,p_location_lat:(f=e.data.location)==null?void 0:f.lat,p_location_lng:(p=e.data.location)==null?void 0:p.lng});break;default:throw new Error(`Unknown action type: ${e.type}`)}}async clearQueue(){await qy.remove({key:this.QUEUE_KEY})}async getQueueLength(){return(await this.getQueue()).length}}const Hy=new mre,fre=()=>{const[t,e]=g.useState({connected:!0,connectionType:"unknown"});return g.useEffect(()=>{let n=!0;const r=async()=>{try{const i=await hE.getStatus();n&&e({connected:i.connected,connectionType:i.connectionType})}catch(i){console.error("Error getting network status:",i)}},a=hE.addListener("networkStatusChange",i=>{n&&(e({connected:i.connected,connectionType:i.connectionType}),console.log("Network status changed:",i))});return r(),()=>{n=!1,a.remove()}},[]),t},pre=({className:t=""})=>{Vr();const e=fre(),{deliveryNotes:n,fetchDeliveryNotes:r,signDeliveryNote:a}=ure(),[i,o]=g.useState(null),[c,d]=g.useState(!1),[u,m]=g.useState(""),[f,p]=g.useState(0),v=(n==null?void 0:n.filter(E=>E.status==="sent"&&!E.signed_at))||[];g.useEffect(()=>{r(),w()},[r]),g.useEffect(()=>{e.connected&&f>0&&x()},[e.connected,f]);const w=async()=>{const E=await Hy.getQueueLength();p(E)},x=async()=>{try{await Hy.processQueue(),await w(),f>0&&Te.success("Offline-Signaturen erfolgreich synchronisiert")}catch(E){console.error("Error processing offline queue:",E)}},y=E=>{o(E),m(""),d(!0)},j=async E=>{if(i){if(!e.connected){await Hy.addAction("SIGN_DELIVERY_NOTE",{delivery_note_id:i.id,signature_data:{svg:E.svg},signer_name:E.name,location:null}),await w(),Te.info("Signatur für Offline-Verarbeitung gespeichert"),d(!1);return}try{await a(i.id,{svg:E.svg},E.name),d(!1),o(null),await r(),Te.success("Lieferschein erfolgreich signiert")}catch(C){console.error("Error signing delivery note:",C),Te.error("Fehler beim Signieren des Lieferscheins")}}},b=E=>{const C=Math.floor(E/60),P=E%60;return`${C}:${P.toString().padStart(2,"0")}h`},N=E=>new Date(E).toLocaleDateString("de-DE",{weekday:"short",day:"2-digit",month:"2-digit",year:"numeric"}),S=E=>new Date(E).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"});return v.length===0&&f===0?s.jsx("div",{className:`space-y-4 ${t}`,children:s.jsx(oe,{className:"border-0 shadow-lg",children:s.jsxs(de,{className:"p-8 text-center",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx(Md,{className:"h-12 w-12 mx-auto"})}),s.jsx("h3",{className:"font-semibold text-gray-700 mb-2",children:"Alle Lieferscheine signiert"}),s.jsx("p",{className:"text-gray-500 text-sm",children:"Keine Lieferscheine warten auf Ihre Unterschrift"})]})})}):s.jsxs("div",{className:`space-y-4 ${t}`,children:[s.jsx(oe,{className:"border-0 shadow-lg bg-gradient-to-r from-orange-500 to-amber-500 text-white",children:s.jsx(je,{className:"pb-3",children:s.jsxs(Ne,{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Bh,{className:"h-6 w-6"}),s.jsx("span",{children:"Zu signierende Lieferscheine"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[f>0&&s.jsx(Be,{variant:"secondary",className:"bg-yellow-500 text-white",children:f}),s.jsx(Be,{variant:"secondary",className:"bg-white/20 text-white",children:v.length})]})]})})}),!e.connected&&s.jsx(oe,{className:"border-orange-200 bg-orange-50",children:s.jsxs(de,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-orange-700",children:[s.jsx(pP,{className:"h-5 w-5"}),s.jsx("span",{className:"font-medium",children:"Offline-Modus"})]}),s.jsx("p",{className:"text-orange-600 text-sm mt-1",children:"Signaturen werden gespeichert und automatisch synchronisiert, sobald eine Internetverbindung verfügbar ist."}),f>0&&s.jsxs("div",{className:"text-sm font-medium text-orange-800 mt-2",children:[f," Signatur(en) warten auf Synchronisation"]})]})}),s.jsx("div",{className:"space-y-3",children:v.map(E=>{var C,P,R,H;return s.jsx(oe,{className:"border-0 shadow-md hover:shadow-lg transition-shadow",children:s.jsxs(de,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(wn,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{className:"font-semibold text-lg",children:E.number})]}),s.jsx(Be,{variant:"secondary",className:"bg-orange-100 text-orange-700",children:"Wartet auf Signatur"})]}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Qa,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"font-medium",children:((C=E.project)==null?void 0:C.name)||"Kein Projekt"})]}),((P=E.project)==null?void 0:P.customer)&&s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Ds,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{children:E.project.customer.name})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(At,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{children:N(E.created_at)})]})]}),s.jsx(qa,{className:"my-3"}),((R=E.delivery_note_time_segments)==null?void 0:R.length)>0&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("h4",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:[s.jsx(rj,{className:"h-4 w-4"}),"Zeiterfassung (",E.delivery_note_time_segments.length," Einträge)"]}),s.jsxs("div",{className:"space-y-1",children:[E.delivery_note_time_segments.slice(0,3).map((I,D)=>s.jsxs("div",{className:"flex items-center justify-between text-sm bg-gray-50 p-2 rounded",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Pt,{className:"h-3 w-3 text-gray-400"}),s.jsx("span",{children:N(I.time_segment.started_at)}),s.jsxs("span",{className:"text-gray-500",children:[S(I.time_segment.started_at)," - ",S(I.time_segment.ended_at)]})]}),s.jsx("span",{className:"font-medium",children:b(I.time_segment.duration_minutes)})]},D)),E.delivery_note_time_segments.length>3&&s.jsxs("div",{className:"text-xs text-gray-500 text-center py-1",children:["+",E.delivery_note_time_segments.length-3," weitere Einträge"]})]})]}),((H=E.delivery_note_items)==null?void 0:H.length)>0&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("h4",{className:"font-medium text-sm mb-2",children:["Materialien (",E.delivery_note_items.length," Positionen)"]}),s.jsxs("div",{className:"space-y-1",children:[E.delivery_note_items.slice(0,2).map((I,D)=>s.jsxs("div",{className:"flex items-center justify-between text-sm bg-gray-50 p-2 rounded",children:[s.jsx("span",{children:I.description}),s.jsxs("span",{className:"font-medium",children:[I.quantity," ",I.unit]})]},D)),E.delivery_note_items.length>2&&s.jsxs("div",{className:"text-xs text-gray-500 text-center py-1",children:["+",E.delivery_note_items.length-2," weitere Positionen"]})]})]}),E.location_lat&&E.location_lng&&s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-4",children:[s.jsx(Mi,{className:"h-4 w-4"}),s.jsx("span",{children:"Standort erfasst"})]}),E.notes&&s.jsx("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("strong",{children:"Hinweise:"})," ",E.notes]})}),s.jsxs(ne,{onClick:()=>y(E),className:"w-full h-12 text-lg bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600",children:[s.jsx(Bh,{className:"h-5 w-5 mr-2"}),"Lieferschein signieren"]})]})},E.id)})}),s.jsx(hre,{isOpen:c,onClose:()=>{d(!1),o(null)},onSave:j,title:`Lieferschein ${i==null?void 0:i.number} signieren`,description:"Bitte unterschreiben Sie zur Bestätigung des Erhalts der Leistungen",signerName:u,onSignerNameChange:m})]})},G5=()=>{var Ms,ot;const{user:t,userRole:e}=Vr(),{toast:n}=It(),[r,a]=g.useState("home"),[i,o]=g.useState(navigator.onLine),[c,d]=g.useState(null),[u,m]=g.useState(null),[f,p]=g.useState([]),[v,w]=g.useState(!1),[x,y]=g.useState([]),[j,b]=g.useState([]),[N,S]=g.useState([]),[E,C]=g.useState(!1),[P,R]=g.useState(!1),[H,I]=g.useState(!1),[D,W]=g.useState(""),[V,G]=g.useState(""),[Y,X]=g.useState(""),[F,T]=g.useState(""),[q,U]=g.useState(null),B=g.useRef(null),O=g.useRef(null),z=g.useRef(null),[$,te]=g.useState(100),[ee,Q]=g.useState(0);g.useState(!1);const[le,pe]=g.useState(!0),[J,ae]=g.useState(!1),[fe,he]=g.useState({available:0,total:0});g.useState([]);const[ve,ie]=g.useState({top:0,bottom:0}),[_e,Se]=g.useState({projectId:"",material:"",quantity:"",unit:"Stück"});g.useEffect(()=>{(async()=>{try{if(await zy.setStyle({style:tb.Dark}),await zy.setOverlaysWebView({overlay:!1}),await zy.show(),jr.isNativePlatform()){const be=parseInt(getComputedStyle(document.documentElement).getPropertyValue("env(safe-area-inset-top)")||"44"),Ee=parseInt(getComputedStyle(document.documentElement).getPropertyValue("env(safe-area-inset-bottom)")||"34");ie({top:isNaN(be)?44:be,bottom:isNaN(Ee)?34:Ee})}}catch(be){console.log("StatusBar or SafeArea not available:",be),jr.isNativePlatform()&&ie({top:44,bottom:34})}})()},[]),g.useEffect(()=>{const we=()=>{o(!0),js(),cn()},be=()=>o(!1);window.addEventListener("online",we),window.addEventListener("offline",be),Ve();const $e=setInterval(()=>{te(Math.max(20,Math.floor(Math.random()*100)))},3e4);ke(),Xe(),Et(),pe(!1);const st=localStorage.getItem("activeTimeEntry");if(st){const Yt=JSON.parse(st);Yt.startTime&&(Yt.startTime=new Date(Yt.startTime)),Yt.endTime&&(Yt.endTime=new Date(Yt.endTime)),m(Yt)}return()=>{window.removeEventListener("online",we),window.removeEventListener("offline",be),clearInterval($e),ze()}},[]);const Ve=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(we=>{const{latitude:be,longitude:Ee}=we.coords;d({lat:be,lng:Ee,address:"Baustelle Musterstraße 123, 12345 Berlin"})},we=>{console.error("Geolocation error:",we),n({title:"Standort",description:"Standort konnte nicht ermittelt werden",variant:"destructive"})},{enableHighAccuracy:!0})},Xe=async()=>{if(!(!(t!=null&&t.id)||!i))try{const{data:we}=await K.from("project_documents").select("*").eq("document_type","photo").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if(we){const $e=we.map(st=>{var Yt;return{id:st.id,projectId:st.project_id,fileName:st.name,fileUrl:st.file_url||"",description:((Yt=st.metadata)==null?void 0:Yt.description)||"",createdAt:new Date(st.created_at)}});y($e)}const{data:be}=await K.from("project_documents").select("*").eq("document_type","receipt").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if(be){const $e=be.map(st=>{var Yt,ns;return{id:st.id,projectId:st.project_id,fileName:st.name,fileUrl:st.file_url||"",amount:((Yt=st.metadata)==null?void 0:Yt.amount)||0,description:((ns=st.metadata)==null?void 0:ns.description)||"",createdAt:new Date(st.created_at)}});b($e)}const{data:Ee}=await K.from("project_comments").select("*").eq("created_by",t.id).order("created_at",{ascending:!1}).limit(20);if(Ee){const $e=Ee.map(st=>({id:st.id,projectId:st.project_id,comment:st.comment,createdAt:new Date(st.created_at)}));S($e)}}catch(we){console.error("Error loading existing data:",we)}},Et=async()=>{if(!(!(t!=null&&t.id)||!i))try{const{data:we}=await K.from("employees").select("id, vacation_days_total, vacation_days_used").eq("user_id",t.id).single();if(we){const{data:be}=await K.from("vacation_requests").select("days_requested").eq("employee_id",we.id).eq("status","pending").eq("request_type","vacation"),Ee=(be==null?void 0:be.reduce((ns,Zr)=>ns+Zr.days_requested,0))||0,$e=we.vacation_days_total||0,st=we.vacation_days_used||0,Yt=Math.max(0,$e-st-Ee);he({available:Yt,total:$e})}else{const{data:be}=await K.from("company_settings").select("default_vacation_days").single(),Ee=(be==null?void 0:be.default_vacation_days)||25;he({available:Ee,total:Ee})}}catch(we){console.error("Error loading vacation balance:",we)}},ke=async()=>{if(!t||!t.id){p([{id:"mock-1",name:"Baustelle Musterstraße",status:"aktiv",location:"Musterstraße 123, Berlin",priority:"normal",assignedTo:["mock-user"],deadline:null}]);return}try{const{data:we,error:be}=await K.from("project_team_assignments").select(`
          project_id,
          projects:project_id (
            id,
            name,
            status,
            location,
            start_date,
            end_date,
            priority
          )
        `).eq("employee_id",t.id).eq("is_active",!0);if(be){console.error("Error fetching assigned projects:",be);const $e=[{id:"mock-1",name:"Baustelle Musterstraße",status:"aktiv",location:"Musterstraße 123, Berlin",priority:"normal",assignedTo:[(t==null?void 0:t.id)||"mock-user"],deadline:null}];p($e);return}const Ee=(we==null?void 0:we.map($e=>({id:$e.projects.id,name:$e.projects.name,status:$e.projects.status||"in_bearbeitung",location:$e.projects.location||"Nicht angegeben",priority:$e.projects.priority||"normal",assignedTo:[(t==null?void 0:t.id)||"mock-user"],deadline:$e.projects.end_date})))||[];if(Ee.length===0){const $e=[{id:"mock-1",name:"Baustelle Musterstraße",status:"aktiv",location:"Musterstraße 123, Berlin",priority:"normal",assignedTo:[(t==null?void 0:t.id)||"mock-user"],deadline:null}];p($e),Q(0);return}p(Ee),Q(Ee.filter($e=>$e.priority==="urgent").length)}catch(we){console.error("Error in fetchAssignedProjects:",we),p([])}},Le=async()=>{try{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Camera API not available");const we=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}},audio:!1});w(!0),setTimeout(()=>{O.current&&(O.current.srcObject=we,O.current.play().catch(be=>{console.error("Error playing video:",be)}))},100)}catch(we){console.error("Error accessing camera:",we);let be="Kamera konnte nicht gestartet werden";we.name==="NotAllowedError"||we.name==="PermissionDeniedError"?be="Kamera-Zugriff wurde verweigert. Bitte erlauben Sie den Kamera-Zugriff in den Browser-Einstellungen.":we.name==="NotFoundError"||we.name==="DevicesNotFoundError"?be="Keine Kamera gefunden. Bitte stellen Sie sicher, dass eine Kamera angeschlossen ist.":we.name==="NotReadableError"||we.name==="TrackStartError"?be="Kamera wird bereits von einer anderen Anwendung verwendet.":navigator.mediaDevices||(be="Ihr Browser unterstützt keine Kamera-Funktionen. Bitte verwenden Sie einen modernen Browser."),n({title:"Kamera Fehler",description:be,variant:"destructive"}),w(!1)}},ze=()=>{O.current&&O.current.srcObject&&O.current.srcObject.getTracks().forEach(be=>be.stop()),w(!1)},dt=async()=>{if(!O.current||!z.current||!q)return;const we=z.current,be=O.current,Ee=we.getContext("2d");Ee&&(we.width=be.videoWidth,we.height=be.videoHeight,Ee.drawImage(be,0,0),we.toBlob(async $e=>{$e&&await Ze($e,q)},"image/jpeg")),ze()},Ze=async(we,be)=>{var Ee;try{const $e=`project-photo-${Date.now()}.jpg`,{data:st,error:Yt}=await K.storage.from("project-media").upload(`${be}/${$e}`,we);if(Yt)throw Yt;const{data:ns,error:Zr}=await K.from("project_documents").insert({project_id:be,name:$e,document_type:"photo",file_url:st.path,created_by:t==null?void 0:t.id,metadata:{description:D}});if(Zr)throw Zr;const Ii={id:((Ee=ns[0])==null?void 0:Ee.id)||Date.now().toString(),projectId:be,fileName:$e,fileUrl:st.path,description:D,createdAt:new Date};y(Qo=>[...Qo,Ii]),W(""),C(!1),n({title:"Foto hochgeladen",description:"Foto wurde erfolgreich gespeichert"})}catch($e){console.error("Error uploading photo:",$e),n({title:"Upload Fehler",description:"Foto konnte nicht hochgeladen werden",variant:"destructive"})}},Fe=async(we,be)=>{var Ee;try{const $e=`receipt-${Date.now()}-${we.name}`,{data:st,error:Yt}=await K.storage.from("project-media").upload(`${be}/${$e}`,we);if(Yt)throw Yt;let ns=null;try{const Gr=await new Promise((lu,dc)=>{const Ln=new FileReader;Ln.onload=()=>lu(Ln.result),Ln.onerror=dc,Ln.readAsDataURL(we)});ns={status:"processed",confidence:.85,extracted_text:"OCR processing completed",processed_at:new Date().toISOString(),file_type:we.type,structured_data:{amount:parseFloat(Y)||0,description:V,filename:$e}}}catch(Gr){console.warn("OCR processing failed:",Gr),ns={status:"failed",error:"OCR processing failed",processed_at:new Date().toISOString()}}const{data:Zr,error:Ii}=await K.from("project_documents").insert({project_id:be,name:$e,document_type:"receipt",file_url:st.path,created_by:t==null?void 0:t.id,validation_status:"submitted",ocr_result:ns,metadata:{amount:parseFloat(Y)||0,description:V,upload_type:"mobile_employee"}});if(Ii)throw Ii;const Qo={id:((Ee=Zr[0])==null?void 0:Ee.id)||Date.now().toString(),projectId:be,fileName:$e,fileUrl:st.path,amount:parseFloat(Y)||0,description:V,createdAt:new Date};b(Gr=>[...Gr,Qo]),G(""),X(""),R(!1),n({title:"Rechnung eingereicht",description:"Rechnung wurde zur Manager-Validierung eingereicht und wartet auf Genehmigung."})}catch($e){console.error("Error uploading receipt:",$e),n({title:"Upload Fehler",description:"Rechnung konnte nicht hochgeladen werden",variant:"destructive"})}},Nt=async(we,be)=>{var Ee;try{const{data:$e,error:st}=await K.from("project_comments").insert({project_id:we,comment:be,created_by:t==null?void 0:t.id});if(st)throw st;const Yt={id:((Ee=$e[0])==null?void 0:Ee.id)||Date.now().toString(),projectId:we,comment:be,createdAt:new Date};S(ns=>[...ns,Yt]),T(""),I(!1),n({title:"Kommentar hinzugefügt",description:"Kommentar wurde erfolgreich gespeichert"})}catch($e){console.error("Error adding comment:",$e),n({title:"Fehler",description:"Kommentar konnte nicht gespeichert werden",variant:"destructive"})}},vt=()=>{if(u){const we={...u,isActive:!1};m(we),localStorage.setItem("activeTimeEntry",JSON.stringify(we)),n({title:"Zeiterfassung pausiert",description:"Timer angehalten"})}},Vn=()=>{if(u){const we={...u,endTime:new Date,isActive:!1},be=JSON.parse(localStorage.getItem("completedTimeEntries")||"[]");be.push(we),localStorage.setItem("completedTimeEntries",JSON.stringify(be)),m(null),localStorage.removeItem("activeTimeEntry");const Ee=we.endTime instanceof Date?we.endTime:new Date(we.endTime),$e=we.startTime instanceof Date?we.startTime:new Date(we.startTime),st=Math.round((Ee.getTime()-$e.getTime())/(1e3*60));n({title:"Zeiterfassung beendet",description:`${st} Minuten erfasst`}),i&&js()}},js=async()=>{const we=JSON.parse(localStorage.getItem("completedTimeEntries")||"[]");if(we.length>0&&i&&t)try{const{data:be}=await K.from("employees").select("id").eq("user_id",t.id).single();if(!be){console.error("Employee not found for user");return}const Ee=we.map(st=>({employee_id:be.id,project_id:st.projectId,start_time:st.startTime,end_time:st.endTime,status:"beendet",description:st.description||null})),{error:$e}=await K.from("time_entries").insert(Ee);if($e)throw $e;localStorage.removeItem("completedTimeEntries"),n({title:"Synchronisation",description:`${we.length} Zeiteinträge synchronisiert`})}catch(be){console.error("Sync failed:",be),n({title:"Sync Fehler",description:"Zeiterfassung konnte nicht synchronisiert werden",variant:"destructive"})}},yt=()=>{if(!_e.material||!_e.quantity){n({title:"Fehler",description:"Material und Menge sind erforderlich",variant:"destructive"});return}const we={..._e,timestamp:new Date().toISOString(),location:c},be=JSON.parse(localStorage.getItem("materialEntries")||"[]");be.push(we),localStorage.setItem("materialEntries",JSON.stringify(be)),Se({projectId:"",material:"",quantity:"",unit:"Stück"}),n({title:"Material erfasst",description:`${we.quantity} ${we.unit} ${we.material}`}),i&&cn()},cn=async()=>{const we=JSON.parse(localStorage.getItem("materialEntries")||"[]");if(we.length>0&&i&&t)try{const{data:be}=await K.from("employees").select("id").eq("user_id",t.id).single();if(!be){console.error("Employee not found for user");return}const Ee=we.map(st=>({employee_id:be.id,project_id:st.projectId,material_id:null,quantity_used:parseFloat(st.quantity),usage_date:new Date(st.timestamp).toISOString().split("T")[0],notes:`${st.material} (${st.unit}) - Mobile Entry`,created_by:t.id})),{error:$e}=await K.from("employee_material_usage").insert(Ee);if($e)throw $e;localStorage.removeItem("materialEntries"),n({title:"Synchronisation",description:`${we.length} Materialeinträge synchronisiert`})}catch(be){console.error("Material sync failed:",be),n({title:"Sync Fehler",description:"Materialeinträge konnten nicht synchronisiert werden",variant:"destructive"})}},On=()=>{if(!u||!u.startTime)return"00:00:00";const we=new Date,be=u.startTime instanceof Date?u.startTime:new Date(u.startTime),Ee=we.getTime()-be.getTime(),$e=Math.floor(Ee/(1e3*60*60)),st=Math.floor(Ee%(1e3*60*60)/(1e3*60)),Yt=Math.floor(Ee%(1e3*60)/1e3);return`${$e.toString().padStart(2,"0")}:${st.toString().padStart(2,"0")}:${Yt.toString().padStart(2,"0")}`},hs=()=>{var we;return s.jsxs("div",{className:"space-y-2 w-full overflow-hidden",children:[u&&s.jsx(oe,{className:"border-2 border-green-400 bg-green-50",children:s.jsxs(de,{className:"p-3",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("h3",{className:"font-semibold text-green-800",children:"Timer läuft"}),s.jsx("div",{className:"text-2xl font-mono font-bold text-green-600",children:On()})]}),s.jsx("p",{className:"text-green-700 text-sm mb-3",children:(we=f.find(be=>be.id===u.projectId))==null?void 0:we.name}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ne,{size:"sm",variant:"outline",onClick:vt,className:"flex-1",children:[s.jsx(W_,{className:"h-4 w-4 mr-2"}),"Pause"]}),s.jsxs(ne,{size:"sm",variant:"destructive",onClick:Vn,className:"flex-1",children:[s.jsx(sj,{className:"h-4 w-4 mr-2"}),"Stoppen"]})]})]})}),s.jsxs(oe,{children:[s.jsx(je,{className:"p-3",children:s.jsxs(Ne,{className:"flex items-center gap-2",children:[s.jsx("span",{children:"Schnellaktionen"}),ee>0&&s.jsx(Be,{variant:"destructive",className:"rounded-full px-2 py-1",children:ee})]})}),s.jsxs(de,{className:"grid grid-cols-2 gap-2 p-3",children:[s.jsxs(ne,{className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>a("time"),children:[s.jsx(Pt,{className:"h-6 w-6"}),s.jsx("span",{className:"text-sm",children:"Zeit erfassen"})]}),s.jsxs(ne,{variant:"outline",className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>{var be;U(((be=f[0])==null?void 0:be.id)||""),Le()},children:[s.jsx(U_,{className:"h-6 w-6"}),s.jsx("span",{className:"text-sm",children:"Foto machen"})]}),s.jsxs(ne,{variant:"outline",className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>a("docs"),children:[s.jsx(wn,{className:"h-6 w-6"}),s.jsx("span",{className:"text-sm",children:"Dokumentation"})]}),s.jsxs(ne,{variant:"outline",className:"min-h-[60px] p-2 flex flex-col justify-center gap-1 text-sm",onClick:()=>ae(!0),children:[s.jsx(At,{className:"h-6 w-6"}),s.jsx("span",{className:"text-sm",children:"Urlaub"}),fe.available>0&&s.jsxs("span",{className:"text-xs text-green-600",children:[fe.available," Tage"]})]})]})]}),s.jsxs(oe,{className:"overflow-hidden",children:[s.jsx(je,{className:"p-3",children:s.jsxs(Ne,{className:"flex items-center gap-1 text-sm",children:[s.jsx(Qa,{className:"h-4 w-4"}),"Schnell-Material"]})}),s.jsxs(de,{className:"space-y-2 p-3",children:[s.jsxs("select",{value:_e.projectId,onChange:be=>Se(Ee=>({...Ee,projectId:be.target.value})),className:"w-full p-1.5 border rounded text-xs",children:[s.jsx("option",{value:"",children:"Projekt wählen..."}),f.map(be=>s.jsx("option",{value:be.id,children:be.name},be.id))]}),s.jsx("input",{type:"text",placeholder:"Material...",value:_e.material,onChange:be=>Se(Ee=>({...Ee,material:be.target.value})),className:"w-full p-1.5 border rounded text-xs"}),s.jsxs("div",{className:"flex gap-0.5",children:[s.jsx("input",{type:"number",placeholder:"Menge",value:_e.quantity,onChange:be=>Se(Ee=>({...Ee,quantity:be.target.value})),className:"flex-1 min-w-0 p-1.5 border rounded text-xs"}),s.jsxs("select",{value:_e.unit,onChange:be=>Se(Ee=>({...Ee,unit:be.target.value})),className:"p-1.5 border rounded text-xs w-12",children:[s.jsx("option",{value:"Stück",children:"Stk"}),s.jsx("option",{value:"Meter",children:"m"}),s.jsx("option",{value:"kg",children:"kg"}),s.jsx("option",{value:"Liter",children:"L"})]})]}),s.jsx(ne,{onClick:yt,disabled:!_e.material||!_e.quantity,className:"w-full",size:"sm",children:"Material erfassen"})]})]})]})},Kn=()=>s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"📚 Dokumentation"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsx(Ne,{className:"text-base flex items-center gap-2",children:"📱 App Bedienung"})}),s.jsxs(de,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Start-Tab:"})," Übersicht und Schnellzugriff"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Zeit-Tab:"})," Zeiterfassung starten/stoppen"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Signatur-Tab:"})," Lieferscheine digital unterschreiben"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Profil-Tab:"})," Persönliche Einstellungen"]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsx(Ne,{className:"text-base flex items-center gap-2",children:"⏱️ Zeiterfassung"})}),s.jsxs(de,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Starten:"}),' Projekt auswählen → "Start" drücken']}),s.jsxs("div",{children:[s.jsx("strong",{children:"Pausieren:"}),' "Pause" für Unterbrechungen']}),s.jsxs("div",{children:[s.jsx("strong",{children:"Beenden:"}),' "Stop" → Notizen hinzufügen']}),s.jsxs("div",{children:[s.jsx("strong",{children:"Arten:"})," Arbeitszeit, Pause, Fahrtzeit"]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsx(Ne,{className:"text-base flex items-center gap-2",children:"✍️ Digitale Signaturen"})}),s.jsxs(de,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Lieferschein:"})," Wareneingänge bestätigen"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Auftragsabschluss:"})," Arbeiten abzeichnen"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Qualitätskontrolle:"})," Prüfungen dokumentieren"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Speicherung:"})," Automatisch in der Cloud"]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsx(Ne,{className:"text-base flex items-center gap-2",children:"📶 Offline Modus"})}),s.jsxs(de,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Zeiterfassung:"})," Funktioniert ohne Internet"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Signaturen:"})," Werden lokal gespeichert"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Synchronisation:"})," Automatisch bei Verbindung"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Status:"})," Symbol zeigt Verbindung an"]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsx(Ne,{className:"text-base flex items-center gap-2",children:"💡 Tipps & Tricks"})}),s.jsxs(de,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Batterie sparen:"})," App läuft im Hintergrund"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Genauigkeit:"})," GPS für Standortverfolgung"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Daten:"})," Arbeitet auch im mobilen Netz"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Updates:"})," App automatisch aktualisieren"]})]})]}),s.jsxs(oe,{children:[s.jsx(je,{className:"pb-3",children:s.jsx(Ne,{className:"text-base flex items-center gap-2",children:"🆘 Support"})}),s.jsxs(de,{className:"text-sm space-y-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Probleme:"})," IT-Abteilung kontaktieren"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Schulung:"})," Bei Fragen an Vorgesetzte wenden"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Version:"})," HandwerkOS Mobile v1.0"]})]})]})]})]}),Pn=()=>s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Profil"}),s.jsx(oe,{children:s.jsxs(de,{className:"p-3",children:[s.jsxs("div",{className:"text-center mb-4",children:[s.jsx("div",{className:"w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-2",children:s.jsx(Ds,{className:"h-8 w-8 text-white"})}),s.jsx("h4",{className:"font-semibold",children:t==null?void 0:t.email}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Mitarbeiter"})]}),s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Status:"}),s.jsx(Be,{variant:"outline",className:"text-green-600",children:"Aktiv"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Standort:"}),s.jsx("span",{className:"text-gray-600",children:c?"Verfügbar":"Nicht verfügbar"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Offline-Daten:"}),s.jsxs("span",{className:"text-gray-600",children:[JSON.parse(localStorage.getItem("completedTimeEntries")||"[]").length," Einträge"]})]})]})]})}),!i&&s.jsx(oe,{className:"border-orange-400 bg-orange-50",children:s.jsxs(de,{className:"p-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-orange-700",children:[s.jsx(xP,{className:"h-4 w-4"}),s.jsx("span",{className:"font-medium",children:"Offline-Modus"})]}),s.jsx("p",{className:"text-orange-600 text-sm mt-1",children:"Daten werden bei nächster Verbindung synchronisiert."})]})})]});return s.jsxs("div",{className:"h-full bg-gray-50 flex flex-col relative overflow-hidden",style:{width:"100vw",maxWidth:"none",paddingTop:`${Math.max(ve.top,44)}px`,paddingBottom:`${Math.max(ve.bottom,0)}px`},children:[s.jsxs("div",{className:"flex-1 px-3 pt-2 pb-20 overflow-y-auto overflow-x-hidden",children:[r==="home"&&hs(),r==="docs"&&Kn(),r==="time"&&s.jsx("div",{className:"h-full overflow-hidden",children:s.jsx(dre,{})}),r==="signature"&&s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsx(pre,{className:"pb-4"})}),r==="profile"&&Pn()]}),s.jsx("div",{className:"absolute left-0 right-0 bottom-0 bg-white border-t shadow-lg",style:{paddingBottom:`${Math.max(ve.bottom,8)}px`},children:s.jsx("div",{className:"grid grid-cols-5 gap-1 p-2",children:[{id:"home",icon:hB,label:"Start"},{id:"docs",icon:wn,label:"Dokumentation"},{id:"time",icon:Pt,label:"Zeit"},{id:"signature",icon:Bh,label:"Signatur"},{id:"profile",icon:Ds,label:"Profil"}].map(we=>s.jsxs(ne,{variant:r===we.id?"default":"ghost",size:"sm",onClick:()=>a(we.id),className:"flex flex-col gap-0.5 h-14 p-1 relative",children:[s.jsx(we.icon,{className:"h-4 w-4"}),s.jsx("span",{className:"text-xs",children:we.label})]},we.id))})}),v&&s.jsxs("div",{className:"fixed inset-0 z-50 bg-black",children:[s.jsx("video",{ref:O,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}),s.jsx("canvas",{ref:z,className:"hidden"}),s.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-4",children:[s.jsx(ne,{onClick:dt,className:"bg-white text-black hover:bg-gray-200 rounded-full w-16 h-16",children:s.jsx(U_,{className:"h-8 w-8"})}),s.jsx(ne,{onClick:ze,variant:"outline",className:"bg-white text-black hover:bg-gray-200 rounded-full w-16 h-16",children:s.jsx($n,{className:"h-8 w-8"})})]})]}),s.jsx(Kt,{open:P,onOpenChange:R,children:s.jsxs(Wt,{children:[s.jsx(tn,{children:s.jsx(nn,{children:"Rechnung hochladen"})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Datei auswählen"}),s.jsx("input",{ref:B,type:"file",accept:"image/*,.pdf",className:"w-full p-2 border rounded-md"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Betrag (optional)"}),s.jsx(re,{type:"number",step:"0.01",placeholder:"0.00",value:Y,onChange:we=>X(we.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Beschreibung (optional)"}),s.jsx(Cn,{placeholder:"Beschreibung der Rechnung...",value:V,onChange:we=>G(we.target.value)})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ne,{onClick:()=>{var be,Ee;const we=(Ee=(be=B.current)==null?void 0:be.files)==null?void 0:Ee[0];we&&q&&Fe(we,q)},disabled:!((ot=(Ms=B.current)==null?void 0:Ms.files)!=null&&ot[0]),className:"flex-1",children:[s.jsx(gP,{className:"h-4 w-4 mr-2"}),"Hochladen"]}),s.jsx(ne,{variant:"outline",onClick:()=>R(!1),children:"Abbrechen"})]})]})]})}),s.jsx(Kt,{open:H,onOpenChange:I,children:s.jsxs(Wt,{children:[s.jsx(tn,{children:s.jsx(nn,{children:"Notiz hinzufügen"})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Kommentar"}),s.jsx(Cn,{placeholder:"Ihre Notiz zum Projekt...",value:F,onChange:we=>T(we.target.value),rows:4})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(ne,{onClick:()=>{F.trim()&&q&&Nt(q,F.trim())},disabled:!F.trim(),className:"flex-1",children:[s.jsx(rn,{className:"h-4 w-4 mr-2"}),"Hinzufügen"]}),s.jsx(ne,{variant:"outline",onClick:()=>{I(!1),T("")},children:"Abbrechen"})]})]})]})}),s.jsx(GI,{open:J,onOpenChange:ae,onSuccess:Et})]})},Q5=()=>{const{user:t,loading:e}=Vr(),n=wa();return g.useEffect(()=>{!e&&!t&&n("/auth")},[t,e,n]),e?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-gray-500",children:"Wird geladen..."})})}):t?s.jsx(G5,{}):s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-gray-500",children:"Nicht angemeldet. Weiterleitung..."})})})},gre=()=>{const t=wa(),[e]=Nj(),{toast:n}=It();return g.useEffect(()=>{(async()=>{const a=e.get("code"),i=e.get("error");if(i){n({title:"Gmail Verbindung fehlgeschlagen",description:`Fehler: ${i}`,variant:"destructive"}),t("/");return}if(!a){n({title:"Gmail Verbindung fehlgeschlagen",description:"Kein Autorisierungscode erhalten",variant:"destructive"}),t("/");return}try{const{data:{user:o}}=await K.auth.getUser();if(!o){n({title:"Fehler",description:"Sie müssen angemeldet sein",variant:"destructive"}),t("/auth");return}const{data:c,error:d}=await K.functions.invoke("gmail-oauth-callback",{body:{code:a}});d?(console.error("Gmail callback error:",d),n({title:"Gmail Verbindung fehlgeschlagen",description:d.message||"Ein Fehler ist aufgetreten",variant:"destructive"})):n({title:"Gmail erfolgreich verbunden",description:`E-Mail Konto ${c.email} wurde verbunden`})}catch(o){console.error("Error during Gmail callback:",o),n({title:"Gmail Verbindung fehlgeschlagen",description:"Ein unerwarteter Fehler ist aufgetreten",variant:"destructive"})}t("/")})()},[e,t,n]),s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"mt-4 text-lg",children:"Gmail Verbindung wird verarbeitet..."})]})})},xre=()=>s.jsx("div",{className:"min-h-screen bg-background p-4",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs(Gi,{to:"/",className:"inline-flex items-center gap-2 text-primary hover:text-primary/80 mb-6",children:[s.jsx(eB,{className:"h-4 w-4"}),"Zurück zur Startseite"]}),s.jsxs(oe,{children:[s.jsxs(je,{children:[s.jsx(Ne,{className:"text-3xl font-bold",children:"Datenschutzerklärung"}),s.jsxs("p",{className:"text-muted-foreground",children:["Zuletzt aktualisiert: ",new Date().toLocaleDateString("de-DE")]})]}),s.jsx(de,{className:"prose prose-slate max-w-none",children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"1. Verantwortlicher"}),s.jsx("p",{className:"mb-4",children:"Verantwortlicher für die Datenverarbeitung auf dieser Website ist:"}),s.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[s.jsx("p",{className:"font-semibold",children:"HandwerkOS"}),s.jsx("p",{children:"E-Mail: info@handwerkos.de"}),s.jsx("p",{children:"Website: https://handwerkos.de"})]})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"2. Allgemeine Hinweise"}),s.jsx("p",{className:"mb-4",children:"Die folgenden Hinweise geben einen einfachen Überblick darüber, was mit Ihren personenbezogenen Daten passiert, wenn Sie diese Website besuchen. Personenbezogene Daten sind alle Daten, mit denen Sie persönlich identifiziert werden können."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"3. Datenerfassung auf dieser Website"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.1 Cookies"}),s.jsx("p",{className:"mb-4",children:"Diese Website verwendet Cookies. Cookies sind kleine Textdateien, die auf Ihrem Rechner abgelegt werden und die Ihr Browser speichert. Sie dienen dazu, unser Angebot nutzerfreundlicher, effektiver und sicherer zu machen."}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.2 Server-Log-Dateien"}),s.jsx("p",{className:"mb-4",children:"Der Provider der Seiten erhebt und speichert automatisch Informationen in so genannten Server-Log-Dateien, die Ihr Browser automatisch an uns übermittelt. Dies sind:"}),s.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[s.jsx("li",{children:"Browsertyp und Browserversion"}),s.jsx("li",{children:"Verwendetes Betriebssystem"}),s.jsx("li",{children:"Referrer URL"}),s.jsx("li",{children:"Hostname des zugreifenden Rechners"}),s.jsx("li",{children:"Uhrzeit der Serveranfrage"}),s.jsx("li",{children:"IP-Adresse"})]}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"3.3 Kontaktformular"}),s.jsx("p",{className:"mb-4",children:"Wenn Sie uns per Kontaktformular Anfragen zukommen lassen, werden Ihre Angaben aus dem Anfrageformular inklusive der von Ihnen dort angegebenen Kontaktdaten zwecks Bearbeitung der Anfrage und für den Fall von Anschlussfragen bei uns gespeichert."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"4. Registrierung und Nutzerkonten"}),s.jsx("p",{className:"mb-4",children:"Sie können sich auf dieser Website registrieren, um zusätzliche Funktionen zu nutzen. Die dazu eingegebenen Daten verwenden wir nur zum Zwecke der Nutzung des jeweiligen Angebotes oder Dienstes. Die bei der Registrierung abgefragten Pflichtangaben müssen vollständig angegeben werden."}),s.jsx("p",{className:"mb-4",children:"Folgende Daten werden bei der Registrierung erhoben:"}),s.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[s.jsx("li",{children:"E-Mail-Adresse"}),s.jsx("li",{children:"Firmenname"}),s.jsx("li",{children:"Vor- und Nachname"}),s.jsx("li",{children:"Telefonnummer"}),s.jsx("li",{children:"Adresse"}),s.jsx("li",{children:"Steuerliche Informationen (optional)"})]})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"5. Gmail-Integration"}),s.jsx("p",{className:"mb-4",children:"Unsere Software bietet die Möglichkeit, Ihr Gmail-Konto zu verbinden. Dabei werden folgende Daten verarbeitet:"}),s.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[s.jsx("li",{children:"E-Mail-Adresse Ihres Gmail-Kontos"}),s.jsx("li",{children:"Zugriffstokens für die Gmail-API"}),s.jsx("li",{children:"E-Mail-Inhalte zur Kategorisierung und Verarbeitung"})]}),s.jsx("p",{className:"mb-4",children:"Diese Daten werden nur zur Bereitstellung der E-Mail-Verwaltungsfunktionen verwendet und nicht an Dritte weitergegeben."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"6. Zeiterfassung und Mitarbeiterdaten"}),s.jsx("p",{className:"mb-4",children:"Unsere Software erfasst Arbeitszeiten und Mitarbeiterdaten. Dabei werden folgende Informationen gespeichert:"}),s.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[s.jsx("li",{children:"Arbeitszeiten (Start-, Endzeiten, Pausen)"}),s.jsx("li",{children:"Standortdaten (bei aktivierter Standorterfassung)"}),s.jsx("li",{children:"Mitarbeiterstammdaten"}),s.jsx("li",{children:"Projektbezogene Zeiterfassungen"})]})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"7. Ihre Rechte"}),s.jsx("p",{className:"mb-4",children:"Sie haben folgende Rechte:"}),s.jsxs("ul",{className:"list-disc list-inside mb-4 space-y-1",children:[s.jsx("li",{children:"Recht auf Auskunft über Ihre gespeicherten personenbezogenen Daten"}),s.jsx("li",{children:"Recht auf Berichtigung unrichtiger Daten"}),s.jsx("li",{children:"Recht auf Löschung Ihrer Daten"}),s.jsx("li",{children:"Recht auf Einschränkung der Datenverarbeitung"}),s.jsx("li",{children:"Recht auf Datenübertragbarkeit"}),s.jsx("li",{children:"Widerspruchsrecht gegen die Datenverarbeitung"})]})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"8. Datensicherheit"}),s.jsx("p",{className:"mb-4",children:"Wir verwenden innerhalb des Website-Besuchs das verbreitete SSL-Verfahren (Secure Socket Layer) in Verbindung mit der jeweils höchsten Verschlüsselungsstufe, die von Ihrem Browser unterstützt wird. Alle Daten werden verschlüsselt übertragen und in sicheren Rechenzentren gespeichert."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"9. Drittanbieter"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"9.1 Supabase"}),s.jsx("p",{className:"mb-4",children:"Wir nutzen Supabase als Backend-Dienstleister. Supabase verarbeitet Daten in unserem Auftrag und ist vertraglich zur Einhaltung der Datenschutzbestimmungen verpflichtet."}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"9.2 Google APIs"}),s.jsx("p",{className:"mb-4",children:"Für die Gmail-Integration nutzen wir Google APIs. Die Nutzung unterliegt den Datenschutzbestimmungen von Google."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"10. Änderungen dieser Datenschutzerklärung"}),s.jsx("p",{className:"mb-4",children:"Wir behalten uns vor, diese Datenschutzerklärung anzupassen, damit sie stets den aktuellen rechtlichen Anforderungen entspricht oder um Änderungen unserer Leistungen in der Datenschutzerklärung umzusetzen."})]}),s.jsxs("section",{children:[s.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"11. Kontakt"}),s.jsx("p",{className:"mb-4",children:"Bei Fragen zum Datenschutz wenden Sie sich bitte an:"}),s.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[s.jsx("p",{children:"E-Mail: datenschutz@handwerkos.de"}),s.jsx("p",{children:"Oder nutzen Sie unser Kontaktformular auf der Website."})]})]})]})})]})]})}),vre=()=>{const t=sc();return g.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),s.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),s.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},yre=()=>{const t=wa(),[e]=Nj(),[n,r]=g.useState(""),[a,i]=g.useState(""),[o,c]=g.useState(""),[d,u]=g.useState(""),[m,f]=g.useState(""),[p,v]=g.useState(!1),[w,x]=g.useState(""),[y,j]=g.useState(null);g.useEffect(()=>{(async()=>{var E,C;const S=e.get("token");if(console.log("=== DEBUGGING TOKEN VALIDATION ==="),console.log("URL:",window.location.href),console.log("Token from URL:",S),!S){console.error("No token found in URL"),Te.error("Fehlender Einladungstoken. Bitte verwenden Sie den vollständigen Link aus der E-Mail.");return}try{console.log("Attempting to validate token:",S);const{data:P,error:R}=await K.from("employee_invitations").select("*");console.log("All invitations in DB:",P),console.log("List error:",R);const{data:H,error:I}=await K.from("employee_invitations").select("*").eq("invite_token",S).eq("status","pending").single();if(console.log("Query result:",{invitation:H,inviteError:I}),I){console.error("Database error:",I),I.code==="PGRST116"?Te.error("Einladung nicht gefunden. Möglicherweise wurde sie bereits verwendet oder ist abgelaufen."):Te.error(`Datenbankfehler: ${I.message}`);return}if(!H){console.error("No invitation found for token"),Te.error("Ungültiger Einladungslink. Bitte wenden Sie sich an Ihren Manager.");return}const D=new Date(H.expires_at),W=new Date;if(console.log("Token expires:",D),console.log("Current time:",W),console.log("Is expired:",D<W),D<W){console.error("Invitation token expired"),Te.error("Dieser Einladungslink ist abgelaufen. Bitte fordern Sie eine neue Einladung an.");return}console.log("Valid invitation found:",H),console.log("Employee data:",H.employee_data),r(H.email),u(((E=H.employee_data)==null?void 0:E.firstName)||""),f(((C=H.employee_data)==null?void 0:C.lastName)||""),j(H)}catch(P){console.error("Exception during validation:",P),Te.error(`Fehler beim Validieren der Einladung: ${P==null?void 0:P.message}`)}})()},[e]);const b=async N=>{if(N.preventDefault(),x(""),!y){x("Einladungsdaten nicht gefunden. Bitte verwenden Sie den Link aus der E-Mail erneut.");return}if(a!==o){x("Passwörter stimmen nicht überein");return}if(a.length<8){x("Passwort muss mindestens 8 Zeichen lang sein");return}v(!0);try{console.log("Creating account for employee:",y.email);const{data:S,error:E}=await K.auth.signUp({email:y.email,password:a,options:{data:{first_name:d,last_name:m,company_id:y.company_id}}});if(E){console.error("Error creating user account:",E),x(E.message||"Fehler beim Erstellen des Kontos");return}S.user&&(await K.from("employee_invitations").update({status:"accepted"}).eq("invite_token",y.invite_token),await K.from("user_roles").insert({user_id:S.user.id,role:"employee"}),console.log("Employee account created successfully"),Te.success("Konto erfolgreich erstellt! Sie werden zur Anmeldung weitergeleitet."),setTimeout(()=>t("/auth"),1500))}catch(S){console.error("Error during employee registration:",S),x("Fehler beim Erstellen des Kontos")}finally{v(!1)}};return y?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:s.jsxs(oe,{className:"w-full max-w-md",children:[s.jsxs(je,{className:"text-center",children:[s.jsx(Ne,{className:"text-2xl font-bold",children:"Willkommen im Team!"}),s.jsx(vn,{children:"Erstellen Sie Ihr Passwort für Ihr HandwerkOS-Konto"})]}),s.jsx(de,{children:s.jsxs("form",{onSubmit:b,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"firstName",children:"Vorname"}),s.jsx(re,{id:"firstName",type:"text",value:d,onChange:N=>u(N.target.value),required:!0})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"lastName",children:"Nachname"}),s.jsx(re,{id:"lastName",type:"text",value:m,onChange:N=>f(N.target.value),required:!0})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"email",children:"E-Mail"}),s.jsx(re,{id:"email",type:"email",value:n,disabled:!0,className:"bg-gray-50"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"password",children:"Passwort"}),s.jsx(re,{id:"password",type:"password",value:a,onChange:N=>i(N.target.value),required:!0,minLength:8,placeholder:"Mindestens 8 Zeichen"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(se,{htmlFor:"confirmPassword",children:"Passwort bestätigen"}),s.jsx(re,{id:"confirmPassword",type:"password",value:o,onChange:N=>c(N.target.value),required:!0,minLength:8,placeholder:"Passwort wiederholen"})]}),w&&s.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:w}),s.jsx(ne,{type:"submit",className:"w-full",disabled:p,children:p?"Konto wird erstellt...":"Konto erstellen"})]})})]})}):s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-gray-500",children:"Einladung wird validiert..."})})})},_re=[{title:"Angebote & Aufträge",desc:"Erstellen Sie Angebote in Minuten und wandeln Sie sie mit einem Klick in Aufträge und Rechnungen um.",Icon:wn},{title:"Projektmanagement",desc:"Aufgaben, Materialien, Dokumente und Fortschritt zentral im Blick.",Icon:iB},{title:"Zeiterfassung & Mobil",desc:"Einfache mobile Erfassung mit GPS‑Option – auch offline.",Icon:Pt},{title:"E‑Mail‑Integration",desc:"Gmail/IMAP verknüpfen und Mails Projekten & Kunden zuordnen.",Icon:os},{title:"Material & Lager",desc:"Bestände verwalten, Bedarf planen, Nachbestellungen vorbereiten.",Icon:nB},{title:"Finanzen & Rechnungen",desc:"Vom Angebot zur Rechnung – schnell, übersichtlich, zuverlässig.",Icon:mr}];function wre(){return s.jsxs("div",{className:"space-y-12",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Alles was Sie brauchen"}),s.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Eine vollständige Lösung für moderne Handwerksbetriebe – von der Angebotserstellung bis zur Abrechnung."})]}),s.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:_re.map(({title:t,desc:e,Icon:n},r)=>s.jsxs(oe,{className:"group relative p-8 border-0 bg-white/80 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/50 to-indigo-50/50 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),s.jsxs("div",{className:"relative mb-6",children:[s.jsx("div",{className:"inline-flex h-14 w-14 items-center justify-center rounded-2xl bg-gradient-to-r from-blue-100 to-indigo-100 group-hover:from-blue-200 group-hover:to-indigo-200 transition-all duration-300",children:s.jsx(n,{className:"h-7 w-7 text-blue-600 group-hover:text-indigo-600 transition-colors duration-300"})}),s.jsx("div",{className:"absolute -top-2 -right-2 h-6 w-6 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-center text-white text-xs font-bold",children:r+1})]}),s.jsxs("div",{className:"relative space-y-3",children:[s.jsx("h3",{className:"text-xl font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:t}),s.jsx("p",{className:"text-slate-600 leading-relaxed",children:e})]}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-600 to-indigo-600 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"})]},t))}),s.jsx("div",{className:"text-center pt-8",children:s.jsxs("div",{className:"inline-flex items-center gap-2 text-sm text-slate-500 bg-slate-50 px-4 py-2 rounded-full",children:[s.jsx("svg",{className:"h-4 w-4 text-blue-500",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"Alle Funktionen in einem System – keine separaten Tools erforderlich"})]})})]})}const bre=[{title:"Angebote & Rechnungen",desc:"Von der Anfrage bis zur Zahlung – alles nahtlos verbunden."},{title:"Projekte & Aufgaben",desc:"Status, Verantwortliche, Dokumente und Fortschritte im Team koordinieren."},{title:"Zeiten & Einsatzplanung",desc:"Zeiten erfassen, Auslastung sehen, Planung vereinfachen."},{title:"E‑Mails & Kommunikation",desc:"Zentrale Transparenz – nichts geht mehr verloren."}];function jre(){return s.jsxs("div",{className:"space-y-12",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Integrierte Module"}),s.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Alle wichtigen Bereiche Ihres Handwerksbetriebs in einer einzigen Plattform vereint."})]}),s.jsx("div",{className:"grid md:grid-cols-2 gap-8",children:bre.map((t,e)=>s.jsxs(oe,{className:"group relative p-8 border-0 bg-white/80 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-500 hover:-translate-y-1 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/30 via-indigo-50/30 to-purple-50/30 opacity-0 group-hover:opacity-100 transition-all duration-500"}),s.jsxs("div",{className:"relative flex items-start gap-6",children:[s.jsxs("div",{className:"relative w-32 h-24 shrink-0 rounded-2xl border border-slate-200/50 bg-gradient-to-br from-slate-50 to-slate-100 overflow-hidden group-hover:shadow-xl transition-all duration-500",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-100/50 via-indigo-100/50 to-purple-100/50 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),s.jsxs("div",{className:"absolute inset-3 space-y-2",children:[s.jsx("div",{className:"h-2 bg-gradient-to-r from-blue-300 to-indigo-300 rounded-full w-3/4"}),s.jsx("div",{className:"h-2 bg-gradient-to-r from-indigo-300 to-purple-300 rounded-full w-1/2"}),s.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-1",children:[s.jsx("div",{className:"h-3 bg-blue-200/70 rounded"}),s.jsx("div",{className:"h-3 bg-indigo-200/70 rounded"})]})]}),s.jsx("div",{className:"absolute -top-2 -right-2 h-7 w-7 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 flex items-center justify-center text-white text-xs font-bold shadow-lg",children:e+1})]}),s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsx("h3",{className:"text-2xl font-bold text-slate-900 group-hover:text-blue-900 transition-colors duration-300",children:t.title}),s.jsx("p",{className:"text-slate-600 leading-relaxed text-lg",children:t.desc}),s.jsx("div",{className:"pt-2 opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0",children:s.jsxs("div",{className:"inline-flex items-center text-blue-600 font-medium text-sm cursor-pointer",children:["Mehr erfahren",s.jsx("svg",{className:"ml-1 h-4 w-4 transition-transform group-hover:translate-x-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})})]})]}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-600 to-indigo-600 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-500 origin-left"})]},t.title))}),s.jsx("div",{className:"text-center pt-8",children:s.jsxs("div",{className:"inline-flex items-center gap-3 bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 rounded-2xl border border-blue-200/30",children:[s.jsxs("div",{className:"flex -space-x-2",children:[s.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-blue-500 to-blue-600 border-2 border-white flex items-center justify-center",children:s.jsx("span",{className:"text-white text-xs font-bold",children:"1"})}),s.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-indigo-500 to-indigo-600 border-2 border-white flex items-center justify-center",children:s.jsx("span",{className:"text-white text-xs font-bold",children:"2"})}),s.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-r from-purple-500 to-purple-600 border-2 border-white flex items-center justify-center",children:s.jsx("span",{className:"text-white text-xs font-bold",children:"3"})})]}),s.jsx("span",{className:"text-slate-700 font-medium",children:"Alle Module arbeiten nahtlos zusammen"})]})})]})}const Nre=[{title:"Gmail / IMAP",desc:"E‑Mails synchronisieren und Projekten zuordnen.",Icon:os},{title:"Google Kalender",desc:"Termine und Einsätze direkt im Kalender planen.",Icon:At}];function Sre(){return s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-6",children:"Direkte Integrationen"}),s.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:Nre.map(({title:t,desc:e,Icon:n})=>s.jsxs(oe,{className:"p-6 flex items-center gap-4 hover-scale",children:[s.jsx("div",{className:"inline-flex h-10 w-10 items-center justify-center rounded-md bg-primary/10 text-primary",children:s.jsx(n,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold mb-1",children:t}),s.jsx("p",{className:"text-muted-foreground",children:e})]})]},t))})]})}const kre=[{quote:"Mit HandwerkOS erstellen wir Angebote schneller und behalten Projekte endlich zentral im Blick.",author:"Malerbetrieb Schuster"},{quote:"Unsere Monteure buchen Zeiten mobil – die Abrechnung geht dadurch viel zügiger.",author:"Elektro König"},{quote:"Die E‑Mail‑Zuordnung spart uns täglich Zeit, weil alles direkt beim Projekt liegt.",author:"Sanitär & Heizung Weber"}];function Cre(){return s.jsxs("div",{className:"space-y-12",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("h2",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-slate-900 to-slate-600 bg-clip-text text-transparent",children:"Erfolgsgeschichten"}),s.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto",children:"Über 1.000 Handwerksbetriebe vertrauen bereits auf HandwerkOS."})]}),s.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:kre.map((t,e)=>s.jsxs(oe,{className:"group relative p-8 border-0 bg-white/90 backdrop-blur-sm shadow-lg hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 overflow-hidden",children:[s.jsx("div",{className:"absolute top-4 left-4 text-6xl text-blue-100/50 font-serif leading-none select-none",children:'"'}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/20 to-indigo-50/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),s.jsxs("div",{className:"relative space-y-6",children:[s.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((n,r)=>s.jsx("svg",{className:"h-5 w-5 text-yellow-400 fill-current",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},r))}),s.jsxs("blockquote",{className:"text-lg text-slate-700 leading-relaxed italic",children:['"',t.quote,'"']}),s.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-slate-100",children:[s.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center text-white font-bold text-lg",children:t.author.charAt(0)}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold text-slate-900",children:t.author}),s.jsx("div",{className:"text-sm text-slate-500",children:"Handwerksbetrieb"})]})]})]}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 to-indigo-500 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-center"})]},e))}),s.jsxs("div",{className:"flex justify-center items-center gap-8 pt-8",children:[s.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[s.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center",children:s.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-2xl text-slate-900",children:"1.000+"}),s.jsx("div",{className:"text-sm text-slate-600",children:"Zufriedene Betriebe"})]})]}),s.jsx("div",{className:"h-12 w-px bg-slate-200"}),s.jsxs("div",{className:"flex items-center gap-3 text-slate-600",children:[s.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:s.jsx("svg",{className:"h-6 w-6 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-bold text-2xl text-slate-900",children:"4.9/5"}),s.jsx("div",{className:"text-sm text-slate-600",children:"Bewertung"})]})]})]})]})}var G1="Collapsible",[Ere,Y5]=kr(G1),[Are,Q1]=Ere(G1),X5=g.forwardRef((t,e)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:i,onOpenChange:o,...c}=t,[d=!1,u]=qr({prop:r,defaultProp:a,onChange:o});return s.jsx(Are,{scope:n,disabled:i,contentId:pr(),open:d,onOpenToggle:g.useCallback(()=>u(m=>!m),[u]),children:s.jsx(tt.div,{"data-state":X1(d),"data-disabled":i?"":void 0,...c,ref:e})})});X5.displayName=G1;var J5="CollapsibleTrigger",eO=g.forwardRef((t,e)=>{const{__scopeCollapsible:n,...r}=t,a=Q1(J5,n);return s.jsx(tt.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":X1(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:e,onClick:Oe(t.onClick,a.onOpenToggle)})});eO.displayName=J5;var Y1="CollapsibleContent",tO=g.forwardRef((t,e)=>{const{forceMount:n,...r}=t,a=Q1(Y1,t.__scopeCollapsible);return s.jsx(ts,{present:n||a.open,children:({present:i})=>s.jsx(Pre,{...r,ref:e,present:i})})});tO.displayName=Y1;var Pre=g.forwardRef((t,e)=>{const{__scopeCollapsible:n,present:r,children:a,...i}=t,o=Q1(Y1,n),[c,d]=g.useState(r),u=g.useRef(null),m=Rt(e,u),f=g.useRef(0),p=f.current,v=g.useRef(0),w=v.current,x=o.open||c,y=g.useRef(x),j=g.useRef();return g.useEffect(()=>{const b=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(b)},[]),qn(()=>{const b=u.current;if(b){j.current=j.current||{transitionDuration:b.style.transitionDuration,animationName:b.style.animationName},b.style.transitionDuration="0s",b.style.animationName="none";const N=b.getBoundingClientRect();f.current=N.height,v.current=N.width,y.current||(b.style.transitionDuration=j.current.transitionDuration,b.style.animationName=j.current.animationName),d(r)}},[o.open,r]),s.jsx(tt.div,{"data-state":X1(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!x,...i,ref:m,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":w?`${w}px`:void 0,...t.style},children:x&&a})});function X1(t){return t?"open":"closed"}var Dre=X5,Tre=eO,Mre=tO,Ri="Accordion",Rre=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[J1,Ire,Ore]=km(Ri),[mx,zae]=kr(Ri,[Ore,Y5]),eN=Y5(),nO=Ae.forwardRef((t,e)=>{const{type:n,...r}=t,a=r,i=r;return s.jsx(J1.Provider,{scope:t.__scopeAccordion,children:n==="multiple"?s.jsx(zre,{...i,ref:e}):s.jsx(Bre,{...a,ref:e})})});nO.displayName=Ri;var[sO,Lre]=mx(Ri),[rO,Fre]=mx(Ri,{collapsible:!1}),Bre=Ae.forwardRef((t,e)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:i=!1,...o}=t,[c,d]=qr({prop:n,defaultProp:r,onChange:a});return s.jsx(sO,{scope:t.__scopeAccordion,value:c?[c]:[],onItemOpen:d,onItemClose:Ae.useCallback(()=>i&&d(""),[i,d]),children:s.jsx(rO,{scope:t.__scopeAccordion,collapsible:i,children:s.jsx(aO,{...o,ref:e})})})}),zre=Ae.forwardRef((t,e)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...i}=t,[o=[],c]=qr({prop:n,defaultProp:r,onChange:a}),d=Ae.useCallback(m=>c((f=[])=>[...f,m]),[c]),u=Ae.useCallback(m=>c((f=[])=>f.filter(p=>p!==m)),[c]);return s.jsx(sO,{scope:t.__scopeAccordion,value:o,onItemOpen:d,onItemClose:u,children:s.jsx(rO,{scope:t.__scopeAccordion,collapsible:!0,children:s.jsx(aO,{...i,ref:e})})})}),[$re,fx]=mx(Ri),aO=Ae.forwardRef((t,e)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:i="vertical",...o}=t,c=Ae.useRef(null),d=Rt(c,e),u=Ire(n),f=ru(a)==="ltr",p=Oe(t.onKeyDown,v=>{var R;if(!Rre.includes(v.key))return;const w=v.target,x=u().filter(H=>{var I;return!((I=H.ref.current)!=null&&I.disabled)}),y=x.findIndex(H=>H.ref.current===w),j=x.length;if(y===-1)return;v.preventDefault();let b=y;const N=0,S=j-1,E=()=>{b=y+1,b>S&&(b=N)},C=()=>{b=y-1,b<N&&(b=S)};switch(v.key){case"Home":b=N;break;case"End":b=S;break;case"ArrowRight":i==="horizontal"&&(f?E():C());break;case"ArrowDown":i==="vertical"&&E();break;case"ArrowLeft":i==="horizontal"&&(f?C():E());break;case"ArrowUp":i==="vertical"&&C();break}const P=b%j;(R=x[P].ref.current)==null||R.focus()});return s.jsx($re,{scope:n,disabled:r,direction:a,orientation:i,children:s.jsx(J1.Slot,{scope:n,children:s.jsx(tt.div,{...o,"data-orientation":i,ref:d,onKeyDown:r?void 0:p})})})}),J0="AccordionItem",[Ure,tN]=mx(J0),iO=Ae.forwardRef((t,e)=>{const{__scopeAccordion:n,value:r,...a}=t,i=fx(J0,n),o=Lre(J0,n),c=eN(n),d=pr(),u=r&&o.value.includes(r)||!1,m=i.disabled||t.disabled;return s.jsx(Ure,{scope:n,open:u,disabled:m,triggerId:d,children:s.jsx(Dre,{"data-orientation":i.orientation,"data-state":hO(u),...c,...a,ref:e,disabled:m,open:u,onOpenChange:f=>{f?o.onItemOpen(r):o.onItemClose(r)}})})});iO.displayName=J0;var oO="AccordionHeader",lO=Ae.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,a=fx(Ri,n),i=tN(oO,n);return s.jsx(tt.h3,{"data-orientation":a.orientation,"data-state":hO(i.open),"data-disabled":i.disabled?"":void 0,...r,ref:e})});lO.displayName=oO;var nb="AccordionTrigger",cO=Ae.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,a=fx(Ri,n),i=tN(nb,n),o=Fre(nb,n),c=eN(n);return s.jsx(J1.ItemSlot,{scope:n,children:s.jsx(Tre,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":a.orientation,id:i.triggerId,...c,...r,ref:e})})});cO.displayName=nb;var dO="AccordionContent",uO=Ae.forwardRef((t,e)=>{const{__scopeAccordion:n,...r}=t,a=fx(Ri,n),i=tN(dO,n),o=eN(n);return s.jsx(Mre,{role:"region","aria-labelledby":i.triggerId,"data-orientation":a.orientation,...o,...r,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});uO.displayName=dO;function hO(t){return t?"open":"closed"}var qre=nO,Hre=iO,Wre=lO,mO=cO,fO=uO;const Vre=qre,pO=g.forwardRef(({className:t,...e},n)=>s.jsx(Hre,{ref:n,className:Ie("border-b",t),...e}));pO.displayName="AccordionItem";const gO=g.forwardRef(({className:t,children:e,...n},r)=>s.jsx(Wre,{className:"flex",children:s.jsxs(mO,{ref:r,className:Ie("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...n,children:[e,s.jsx(wg,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));gO.displayName=mO.displayName;const xO=g.forwardRef(({className:t,children:e,...n},r)=>s.jsx(fO,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:s.jsx("div",{className:Ie("pb-4 pt-0",t),children:e})}));xO.displayName=fO.displayName;const Kre=[{q:"Ist HandwerkOS DSGVO‑konform?",a:"Ja. Wir legen großen Wert auf Datenschutz und Sicherheit und unterstützen eine DSGVO‑konforme Nutzung."},{q:"Kann ich HandwerkOS mobil nutzen?",a:"Ja. HandwerkOS ist als Web‑App nutzbar und unterstützt iOS & Android über Capacitor."},{q:"Wie starte ich?",a:"Klicken Sie auf ‘Kostenlos testen’ – die Einrichtung dauert nur wenige Minuten."}];function Zre(){return s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl md:text-3xl font-bold mb-6",children:"Häufige Fragen"}),s.jsx(Vre,{type:"single",collapsible:!0,className:"w-full",children:Kre.map((t,e)=>s.jsxs(pO,{value:`faq-${e}`,children:[s.jsx(gO,{children:t.q}),s.jsx(xO,{children:t.a})]},e))})]})}function Gre(){return s.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600 p-12 md:p-16 text-white",children:[s.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),s.jsx("div",{className:"absolute -top-8 -right-8 h-32 w-32 rounded-full bg-white/10 blur-2xl"}),s.jsx("div",{className:"absolute -bottom-8 -left-8 h-40 w-40 rounded-full bg-white/5 blur-2xl"}),s.jsxs("div",{className:"relative text-center space-y-8",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h2",{className:"text-4xl md:text-6xl font-bold leading-tight",children:["Bereit für den",s.jsx("br",{}),s.jsx("span",{className:"bg-gradient-to-r from-yellow-300 to-orange-300 bg-clip-text text-transparent",children:"digitalen Wandel?"})]}),s.jsx("p",{className:"text-xl text-blue-100 max-w-2xl mx-auto leading-relaxed",children:"Schließen Sie sich über 1.000 Handwerksbetrieben an, die bereits auf HandwerkOS vertrauen. Starten Sie heute kostenlos – ohne Risiko, ohne Vertragsbindung."})]}),s.jsxs("div",{className:"flex flex-wrap justify-center gap-6 text-blue-100",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"30 Tage kostenlos"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"Keine Kreditkarte nötig"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"Sofort startklar"})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[s.jsx(Gi,{to:"/login",className:"inline-flex",children:s.jsx(ne,{size:"lg",className:"bg-white text-blue-600 hover:bg-blue-50 shadow-2xl text-lg px-12 py-6 h-auto font-bold rounded-2xl transition-all duration-300 hover:scale-105",children:"🚀 Jetzt kostenlos starten"})}),s.jsx(ne,{variant:"outline",size:"lg",className:"border-2 border-white/30 text-white hover:bg-white/10 backdrop-blur-sm text-lg px-8 py-6 h-auto rounded-2xl",children:"📞 Demo vereinbaren"})]}),s.jsxs("div",{className:"flex justify-center items-center gap-8 pt-8 text-blue-200",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-white",children:"1.000+"}),s.jsx("div",{className:"text-sm",children:"Betriebe"})]}),s.jsx("div",{className:"h-8 w-px bg-white/20"}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-white",children:"4.9/5"}),s.jsx("div",{className:"text-sm",children:"Bewertung"})]}),s.jsx("div",{className:"h-8 w-px bg-white/20"}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-3xl font-bold text-white",children:"24/7"}),s.jsx("div",{className:"text-sm",children:"Support"})]})]})]})]})}var vO={},yO={},_O={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];if(typeof window<"u"){var c;typeof window.gtag>"u"&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)}),(c=window).gtag.apply(c,i)}},n=e;t.default=n})(_O);var wO={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var e=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;function n(c){return c.toString().trim().replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,function(d,u,m){return u>0&&u+d.length!==m.length&&d.search(e)>-1&&m.charAt(u-2)!==":"&&(m.charAt(u+d.length)!=="-"||m.charAt(u-1)==="-")&&m.charAt(u-1).search(/[^\s-]/)<0?d.toLowerCase():d.substr(1).search(/[A-Z]|\../)>-1?d:d.charAt(0).toUpperCase()+d.substr(1)})}function r(c){return typeof c=="string"&&c.indexOf("@")!==-1}var a="REDACTED (Potential Email Address)";function i(c){return r(c)?(console.warn("This arg looks like an email address, redacting."),a):c}function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,m=c||"";return d&&(m=n(c)),u&&(m=i(m)),m}})(wO);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GA4=void 0;var e=o(_O),n=o(wO),r=["eventCategory","eventAction","eventLabel","eventValue","hitType"],a=["title","location"],i=["page","hitType"];function o(G){return G&&G.__esModule?G:{default:G}}function c(G,Y){if(G==null)return{};var X=d(G,Y),F,T;if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(G);for(T=0;T<q.length;T++)F=q[T],!(Y.indexOf(F)>=0)&&Object.prototype.propertyIsEnumerable.call(G,F)&&(X[F]=G[F])}return X}function d(G,Y){if(G==null)return{};var X={},F=Object.keys(G),T,q;for(q=0;q<F.length;q++)T=F[q],!(Y.indexOf(T)>=0)&&(X[T]=G[T]);return X}function u(G){"@babel/helpers - typeof";return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Y){return typeof Y}:function(Y){return Y&&typeof Symbol=="function"&&Y.constructor===Symbol&&Y!==Symbol.prototype?"symbol":typeof Y},u(G)}function m(G){return v(G)||p(G)||b(G)||f()}function f(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p(G){if(typeof Symbol<"u"&&G[Symbol.iterator]!=null||G["@@iterator"]!=null)return Array.from(G)}function v(G){if(Array.isArray(G))return N(G)}function w(G,Y){var X=Object.keys(G);if(Object.getOwnPropertySymbols){var F=Object.getOwnPropertySymbols(G);Y&&(F=F.filter(function(T){return Object.getOwnPropertyDescriptor(G,T).enumerable})),X.push.apply(X,F)}return X}function x(G){for(var Y=1;Y<arguments.length;Y++){var X=arguments[Y]!=null?arguments[Y]:{};Y%2?w(Object(X),!0).forEach(function(F){H(G,F,X[F])}):Object.getOwnPropertyDescriptors?Object.defineProperties(G,Object.getOwnPropertyDescriptors(X)):w(Object(X)).forEach(function(F){Object.defineProperty(G,F,Object.getOwnPropertyDescriptor(X,F))})}return G}function y(G,Y){return E(G)||S(G,Y)||b(G,Y)||j()}function j(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b(G,Y){if(G){if(typeof G=="string")return N(G,Y);var X=Object.prototype.toString.call(G).slice(8,-1);if(X==="Object"&&G.constructor&&(X=G.constructor.name),X==="Map"||X==="Set")return Array.from(G);if(X==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(X))return N(G,Y)}}function N(G,Y){(Y==null||Y>G.length)&&(Y=G.length);for(var X=0,F=new Array(Y);X<Y;X++)F[X]=G[X];return F}function S(G,Y){var X=G==null?null:typeof Symbol<"u"&&G[Symbol.iterator]||G["@@iterator"];if(X!=null){var F,T,q,U,B=[],O=!0,z=!1;try{if(q=(X=X.call(G)).next,Y!==0)for(;!(O=(F=q.call(X)).done)&&(B.push(F.value),B.length!==Y);O=!0);}catch($){z=!0,T=$}finally{try{if(!O&&X.return!=null&&(U=X.return(),Object(U)!==U))return}finally{if(z)throw T}}return B}}function E(G){if(Array.isArray(G))return G}function C(G,Y){if(!(G instanceof Y))throw new TypeError("Cannot call a class as a function")}function P(G,Y){for(var X=0;X<Y.length;X++){var F=Y[X];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(G,I(F.key),F)}}function R(G,Y,X){return Y&&P(G.prototype,Y),Object.defineProperty(G,"prototype",{writable:!1}),G}function H(G,Y,X){return Y=I(Y),Y in G?Object.defineProperty(G,Y,{value:X,enumerable:!0,configurable:!0,writable:!0}):G[Y]=X,G}function I(G){var Y=D(G,"string");return u(Y)==="symbol"?Y:String(Y)}function D(G,Y){if(u(G)!=="object"||G===null)return G;var X=G[Symbol.toPrimitive];if(X!==void 0){var F=X.call(G,Y||"default");if(u(F)!=="object")return F;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Y==="string"?String:Number)(G)}var W=function(){function G(){var Y=this;C(this,G),H(this,"reset",function(){Y.isInitialized=!1,Y._testMode=!1,Y._currentMeasurementId,Y._hasLoadedGA=!1,Y._isQueuing=!1,Y._queueGtag=[]}),H(this,"_gtag",function(){for(var X=arguments.length,F=new Array(X),T=0;T<X;T++)F[T]=arguments[T];Y._testMode||Y._isQueuing?Y._queueGtag.push(F):e.default.apply(void 0,F)}),H(this,"_loadGA",function(X,F){var T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"https://www.googletagmanager.com/gtag/js";if(!(typeof window>"u"||typeof document>"u")&&!Y._hasLoadedGA){var q=document.createElement("script");q.async=!0,q.src="".concat(T,"?id=").concat(X),F&&q.setAttribute("nonce",F),document.body.appendChild(q),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},Y._hasLoadedGA=!0}}),H(this,"_toGtagOptions",function(X){if(X){var F={cookieUpdate:"cookie_update",cookieExpires:"cookie_expires",cookieDomain:"cookie_domain",cookieFlags:"cookie_flags",userId:"user_id",clientId:"client_id",anonymizeIp:"anonymize_ip",contentGroup1:"content_group1",contentGroup2:"content_group2",contentGroup3:"content_group3",contentGroup4:"content_group4",contentGroup5:"content_group5",allowAdFeatures:"allow_google_signals",allowAdPersonalizationSignals:"allow_ad_personalization_signals",nonInteraction:"non_interaction",page:"page_path",hitCallback:"event_callback"},T=Object.entries(X).reduce(function(q,U){var B=y(U,2),O=B[0],z=B[1];return F[O]?q[F[O]]=z:q[O]=z,q},{});return T}}),H(this,"initialize",function(X){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!X)throw new Error("Require GA_MEASUREMENT_ID");var T=typeof X=="string"?[{trackingId:X}]:X;Y._currentMeasurementId=T[0].trackingId;var q=F.gaOptions,U=F.gtagOptions,B=F.nonce,O=F.testMode,z=O===void 0?!1:O,$=F.gtagUrl;if(Y._testMode=z,z||Y._loadGA(Y._currentMeasurementId,B,$),Y.isInitialized||(Y._gtag("js",new Date),T.forEach(function(Q){var le=x(x(x({},Y._toGtagOptions(x(x({},q),Q.gaOptions))),U),Q.gtagOptions);Object.keys(le).length?Y._gtag("config",Q.trackingId,le):Y._gtag("config",Q.trackingId)})),Y.isInitialized=!0,!z){var te=m(Y._queueGtag);for(Y._queueGtag=[],Y._isQueuing=!1;te.length;){var ee=te.shift();Y._gtag.apply(Y,m(ee)),ee[0]==="get"&&(Y._isQueuing=!0)}}}),H(this,"set",function(X){if(!X){console.warn("`fieldsObject` is required in .set()");return}if(u(X)!=="object"){console.warn("Expected `fieldsObject` arg to be an Object");return}Object.keys(X).length===0&&console.warn("empty `fieldsObject` given to .set()"),Y._gaCommand("set",X)}),H(this,"_gaCommandSendEvent",function(X,F,T,q,U){Y._gtag("event",F,x(x({event_category:X,event_label:T,value:q},U&&{non_interaction:U.nonInteraction}),Y._toGtagOptions(U)))}),H(this,"_gaCommandSendEventParameters",function(){for(var X=arguments.length,F=new Array(X),T=0;T<X;T++)F[T]=arguments[T];if(typeof F[0]=="string")Y._gaCommandSendEvent.apply(Y,m(F.slice(1)));else{var q=F[0],U=q.eventCategory,B=q.eventAction,O=q.eventLabel,z=q.eventValue;q.hitType;var $=c(q,r);Y._gaCommandSendEvent(U,B,O,z,$)}}),H(this,"_gaCommandSendTiming",function(X,F,T,q){Y._gtag("event","timing_complete",{name:F,value:T,event_category:X,event_label:q})}),H(this,"_gaCommandSendPageview",function(X,F){if(F&&Object.keys(F).length){var T=Y._toGtagOptions(F),q=T.title,U=T.location,B=c(T,a);Y._gtag("event","page_view",x(x(x(x({},X&&{page_path:X}),q&&{page_title:q}),U&&{page_location:U}),B))}else X?Y._gtag("event","page_view",{page_path:X}):Y._gtag("event","page_view")}),H(this,"_gaCommandSendPageviewParameters",function(){for(var X=arguments.length,F=new Array(X),T=0;T<X;T++)F[T]=arguments[T];if(typeof F[0]=="string")Y._gaCommandSendPageview.apply(Y,m(F.slice(1)));else{var q=F[0],U=q.page;q.hitType;var B=c(q,i);Y._gaCommandSendPageview(U,B)}}),H(this,"_gaCommandSend",function(){for(var X=arguments.length,F=new Array(X),T=0;T<X;T++)F[T]=arguments[T];var q=typeof F[0]=="string"?F[0]:F[0].hitType;switch(q){case"event":Y._gaCommandSendEventParameters.apply(Y,F);break;case"pageview":Y._gaCommandSendPageviewParameters.apply(Y,F);break;case"timing":Y._gaCommandSendTiming.apply(Y,m(F.slice(1)));break;case"screenview":case"transaction":case"item":case"social":case"exception":console.warn("Unsupported send command: ".concat(q));break;default:console.warn("Send command doesn't exist: ".concat(q))}}),H(this,"_gaCommandSet",function(){for(var X=arguments.length,F=new Array(X),T=0;T<X;T++)F[T]=arguments[T];typeof F[0]=="string"&&(F[0]=H({},F[0],F[1])),Y._gtag("set",Y._toGtagOptions(F[0]))}),H(this,"_gaCommand",function(X){for(var F=arguments.length,T=new Array(F>1?F-1:0),q=1;q<F;q++)T[q-1]=arguments[q];switch(X){case"send":Y._gaCommandSend.apply(Y,T);break;case"set":Y._gaCommandSet.apply(Y,T);break;default:console.warn("Command doesn't exist: ".concat(X))}}),H(this,"ga",function(){for(var X=arguments.length,F=new Array(X),T=0;T<X;T++)F[T]=arguments[T];if(typeof F[0]=="string")Y._gaCommand.apply(Y,F);else{var q=F[0];Y._gtag("get",Y._currentMeasurementId,"client_id",function(U){Y._isQueuing=!1;var B=Y._queueGtag;for(q({get:function($){return $==="clientId"?U:$==="trackingId"?Y._currentMeasurementId:$==="apiVersion"?"1":void 0}});B.length;){var O=B.shift();Y._gtag.apply(Y,m(O))}}),Y._isQueuing=!0}return Y.ga}),H(this,"event",function(X,F){if(typeof X=="string")Y._gtag("event",X,Y._toGtagOptions(F));else{var T=X.action,q=X.category,U=X.label,B=X.value,O=X.nonInteraction,z=X.transport;if(!q||!T){console.warn("args.category AND args.action are required in event()");return}var $={hitType:"event",eventCategory:(0,n.default)(q),eventAction:(0,n.default)(T)};U&&($.eventLabel=(0,n.default)(U)),typeof B<"u"&&(typeof B!="number"?console.warn("Expected `args.value` arg to be a Number."):$.eventValue=B),typeof O<"u"&&(typeof O!="boolean"?console.warn("`args.nonInteraction` must be a boolean."):$.nonInteraction=O),typeof z<"u"&&(typeof z!="string"?console.warn("`args.transport` must be a string."):(["beacon","xhr","image"].indexOf(z)===-1&&console.warn("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),$.transport=z)),Y._gaCommand("send",$)}}),H(this,"send",function(X){Y._gaCommand("send",X)}),this.reset()}return R(G,[{key:"gtag",value:function(){this._gtag.apply(this,arguments)}}]),G}();t.GA4=W;var V=new W;t.default=V})(yO);(function(t){function e(c){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},e(c)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ReactGAImplementation=void 0;var n=a(yO);function r(c){if(typeof WeakMap!="function")return null;var d=new WeakMap,u=new WeakMap;return(r=function(f){return f?u:d})(c)}function a(c,d){if(c&&c.__esModule)return c;if(c===null||e(c)!=="object"&&typeof c!="function")return{default:c};var u=r(d);if(u&&u.has(c))return u.get(c);var m={},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var p in c)if(p!=="default"&&Object.prototype.hasOwnProperty.call(c,p)){var v=f?Object.getOwnPropertyDescriptor(c,p):null;v&&(v.get||v.set)?Object.defineProperty(m,p,v):m[p]=c[p]}return m.default=c,u&&u.set(c,m),m}var i=n.GA4;t.ReactGAImplementation=i;var o=n.default;t.default=o})(vO);const nN=sb(vO),bO="G-M69SXHL9RX",jO=()=>{if(!jr.isNativePlatform()&&typeof window<"u")try{typeof window.gtag<"u"?(nN.initialize(bO,{gaOptions:{anonymize_ip:!0,cookie_flags:"SameSite=None;Secure"}}),console.log("Google Analytics initialized with React-GA4")):(console.warn("gtag not available, using fallback initialization"),setTimeout(()=>jO(),100))}catch(t){console.error("Failed to initialize Google Analytics:",t)}},Qre=(t,e)=>{if(!jr.isNativePlatform()&&typeof window<"u")try{nN.send({hitType:"pageview",page:t,title:e||document.title}),console.log("Page view tracked:",t)}catch(n){typeof window.gtag<"u"?(window.gtag("config",bO,{page_path:t,page_title:document.title}),console.log("Page view tracked via gtag:",t)):console.error("Failed to track page view:",n)}},dp=(t,e,n,r)=>{if(!jr.isNativePlatform()&&typeof window<"u")try{nN.event({category:t,action:e,label:n,value:r}),console.log("Event tracked:",{category:t,action:e,label:n,value:r})}catch(a){typeof window.gtag<"u"?(window.gtag("event",e,{event_category:t,event_label:n,value:r}),console.log("Event tracked via gtag:",{category:t,action:e,label:n,value:r})):console.error("Failed to track event:",a)}},Yre={"@context":"https://schema.org","@type":"SoftwareApplication",name:"HandwerkOS – Handwerkersoftware",applicationCategory:"BusinessApplication",operatingSystem:"Web, iOS, Android",offers:{"@type":"Offer",price:"0",priceCurrency:"EUR"},description:"Moderne Handwerkersoftware für Angebote, Aufträge, Projekte und Zeiterfassung.",url:"https://handwerkos.de/handwerkersoftware"};function mE(){const t=wa();return g.useEffect(()=>{if(jr.isNativePlatform()){t("/app",{replace:!0});return}},[t]),g.useEffect(()=>{document.title="Handwerkersoftware von HandwerkOS";const e=document.querySelector('meta[name="description"]')||document.head.appendChild(document.createElement("meta"));e.setAttribute("name","description"),e.setAttribute("content","Moderne Handwerkersoftware für Angebote, Aufträge, Projekte und Zeiterfassung. DSGVO-konform, mobil, integriert.");let n=document.querySelector('link[rel="canonical"]');n||(n=document.createElement("link"),n.rel="canonical",document.head.appendChild(n)),n.href=`${window.location.origin}/handwerkersoftware`;const r=document.createElement("script");r.type="application/ld+json",r.text=JSON.stringify(Yre),document.head.appendChild(r);const a={"@context":"https://schema.org","@type":"FAQPage",mainEntity:[{"@type":"Question",name:"Ist HandwerkOS DSGVO‑konform?",acceptedAnswer:{"@type":"Answer",text:"Ja. Wir legen großen Wert auf Datenschutz und Sicherheit und unterstützen eine DSGVO‑konforme Nutzung."}},{"@type":"Question",name:"Kann ich HandwerkOS mobil nutzen?",acceptedAnswer:{"@type":"Answer",text:"Ja. HandwerkOS ist als Web‑App nutzbar und unterstützt iOS & Android über Capacitor."}},{"@type":"Question",name:"Wie starte ich?",acceptedAnswer:{"@type":"Answer",text:"Klicken Sie auf ‘Kostenlos testen’ – die Einrichtung dauert nur wenige Minuten."}}]},i=document.createElement("script");return i.type="application/ld+json",i.text=JSON.stringify(a),document.head.appendChild(i),()=>{document.head.removeChild(r),document.head.removeChild(i)}},[]),s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 text-foreground",children:[s.jsxs("header",{className:"relative overflow-hidden bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900",children:[s.jsxs("div",{className:"absolute inset-0 -z-10",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600/10 via-indigo-600/5 to-purple-600/10"}),s.jsx("div",{className:"absolute -top-20 -left-20 h-96 w-96 rounded-full bg-gradient-to-r from-blue-400/30 to-indigo-400/30 blur-3xl animate-pulse"}),s.jsx("div",{className:"absolute top-32 -right-20 h-80 w-80 rounded-full bg-gradient-to-r from-indigo-400/20 to-purple-400/20 blur-3xl animate-pulse delay-1000"}),s.jsx("div",{className:"absolute bottom-20 left-1/4 h-72 w-72 rounded-full bg-gradient-to-r from-purple-400/20 to-pink-400/20 blur-3xl animate-pulse delay-2000"}),s.jsx("div",{className:"absolute inset-0 opacity-30",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})]}),s.jsxs("nav",{className:"relative z-10 container flex items-center justify-between py-6",children:[s.jsxs(Gi,{to:"/",className:"flex items-center space-x-2",children:[s.jsx("img",{src:"/favicon-32x32.png",alt:"HandwerkOS Logo",className:"h-8 w-8"}),s.jsx("span",{className:"font-bold text-xl bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"HandwerkOS"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Yse,{}),s.jsx(Gi,{to:"/login",onClick:()=>dp("Navigation","Click","Header Login"),children:s.jsx(ne,{variant:"ghost",size:"sm",className:"hover:bg-white/80 dark:hover:bg-white/10",children:"Anmelden"})}),s.jsx(Gi,{to:"/login",onClick:()=>dp("CTA","Click","Header Kostenlos Testen"),children:s.jsx(ne,{size:"sm",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-lg",children:"Kostenlos testen"})})]})]}),s.jsx("section",{"aria-labelledby":"hero",className:"relative z-10 container py-12 md:py-20",children:s.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"inline-flex items-center rounded-full bg-white/80 backdrop-blur-sm px-4 py-2 shadow-sm border",children:s.jsx("span",{className:"text-sm font-medium text-blue-600",children:"🚀 Moderne Handwerkersoftware"})}),s.jsxs("h1",{id:"hero",className:"text-5xl md:text-7xl font-bold tracking-tight leading-none",children:[s.jsx("span",{className:"bg-gradient-to-r from-blue-600 via-indigo-600 to-purple-600 bg-clip-text text-transparent",children:"Handwerk"}),s.jsx("br",{}),s.jsx("span",{className:"text-slate-900",children:"neu gedacht"})]}),s.jsx("p",{className:"text-xl text-slate-600 leading-relaxed max-w-lg",children:"Die All-in-One Software für moderne Handwerksbetriebe. Projekte verwalten, Zeiten erfassen, Rechnungen erstellen – alles in einer Plattform."}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsx(Gi,{to:"/login",onClick:()=>dp("CTA","Click","Hero Jetzt Kostenlos Starten"),children:s.jsxs(ne,{size:"lg",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 shadow-xl text-lg px-8 py-4 h-auto",children:["Jetzt kostenlos starten",s.jsx("svg",{className:"ml-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})}),s.jsx("a",{href:"#funktionen",className:"inline-flex",onClick:()=>dp("Navigation","Click","Hero Demo Ansehen"),children:s.jsx(ne,{variant:"outline",size:"lg",className:"text-lg px-8 py-4 h-auto border-2 hover:bg-white/80 backdrop-blur-sm",children:"Demo ansehen"})})]}),s.jsxs("div",{className:"flex items-center gap-6 text-sm text-slate-500 pt-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"DSGVO-konform"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"30 Tage kostenlos"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("svg",{className:"h-5 w-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"Deutscher Support"})]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute -top-8 -left-8 h-72 w-72 rounded-full bg-gradient-to-r from-blue-200/40 to-indigo-200/40 blur-3xl"}),s.jsx("div",{className:"absolute -bottom-8 -right-8 h-80 w-80 rounded-full bg-gradient-to-r from-indigo-200/30 to-purple-200/30 blur-3xl"}),s.jsx("div",{className:"relative bg-white/80 backdrop-blur-xl rounded-2xl shadow-2xl p-8 border border-white/20",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"h-4 bg-gradient-to-r from-blue-200 to-indigo-200 rounded-full w-3/4"}),s.jsx("div",{className:"h-4 bg-gradient-to-r from-indigo-200 to-purple-200 rounded-full w-1/2"}),s.jsx("div",{className:"h-32 bg-gradient-to-br from-slate-100 to-slate-200 rounded-lg flex items-center justify-center",children:s.jsx("div",{className:"text-slate-400 text-sm",children:"HandwerkOS Dashboard"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx("div",{className:"h-16 bg-gradient-to-r from-blue-100 to-indigo-100 rounded-lg"}),s.jsx("div",{className:"h-16 bg-gradient-to-r from-indigo-100 to-purple-100 rounded-lg"})]})]})})]})]})})]}),s.jsxs("main",{className:"space-y-24 md:space-y-32",children:[s.jsx("section",{id:"funktionen",className:"container py-16 md:py-24",children:s.jsx(wre,{})}),s.jsx("section",{id:"module",className:"bg-slate-50 dark:bg-slate-800/50 py-16 md:py-24",children:s.jsx("div",{className:"container",children:s.jsx(jre,{})})}),s.jsx("section",{id:"integrationen",className:"container py-16 md:py-24",children:s.jsx(Sre,{})}),s.jsx("section",{id:"kundenstimmen",className:"bg-gradient-to-br from-blue-50/50 to-indigo-50/50 dark:from-slate-800/30 dark:to-slate-700/30 py-16 md:py-24",children:s.jsx("div",{className:"container",children:s.jsx(Cre,{})})}),s.jsx("section",{id:"faq",className:"container py-16 md:py-24",children:s.jsx(Zre,{})}),s.jsx("section",{className:"container py-16 pb-24",children:s.jsx(Gre,{})})]}),s.jsx("footer",{className:"bg-slate-900 dark:bg-slate-950 text-white mt-24",children:s.jsxs("div",{className:"container py-12",children:[s.jsxs("div",{className:"grid md:grid-cols-4 gap-8",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"h-8 w-8 rounded-lg bg-gradient-to-r from-blue-500 to-indigo-500 flex items-center justify-center",children:s.jsx("span",{className:"text-white font-bold text-sm",children:"H"})}),s.jsx("span",{className:"font-bold text-xl",children:"HandwerkOS"})]}),s.jsx("p",{className:"text-slate-300 text-sm leading-relaxed",children:"Die moderne Software-Lösung für Handwerksbetriebe. Einfach, intuitiv und speziell für deutsche Handwerker entwickelt."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-semibold text-white",children:"Produkt"}),s.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[s.jsx("li",{children:s.jsx("a",{href:"#funktionen",className:"hover:text-white transition-colors",children:"Funktionen"})}),s.jsx("li",{children:s.jsx("a",{href:"#module",className:"hover:text-white transition-colors",children:"Module"})}),s.jsx("li",{children:s.jsx("a",{href:"#faq",className:"hover:text-white transition-colors",children:"FAQ"})}),s.jsx("li",{children:s.jsx(Gi,{to:"/login",className:"hover:text-white transition-colors",children:"Kostenlos testen"})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-semibold text-white",children:"Unternehmen"}),s.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Über uns"})}),s.jsx("li",{children:s.jsx("a",{href:"#kundenstimmen",className:"hover:text-white transition-colors",children:"Referenzen"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Karriere"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Kontakt"})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h4",{className:"font-semibold text-white",children:"Rechtliches"}),s.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[s.jsx("li",{children:s.jsx(Gi,{to:"/privacy",className:"hover:text-white transition-colors",children:"Datenschutz"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"Impressum"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"AGB"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"hover:text-white transition-colors",children:"DSGVO"})})]})]})]}),s.jsxs("div",{className:"border-t border-slate-800 mt-12 pt-8 flex flex-col md:flex-row items-center justify-between gap-4",children:[s.jsx("div",{className:"flex items-center gap-6 text-sm text-slate-400",children:s.jsxs("p",{children:["© ",new Date().getFullYear()," HandwerkOS GmbH. Alle Rechte vorbehalten."]})}),s.jsxs("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("svg",{className:"h-4 w-4 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),s.jsx("span",{children:"DSGVO-konform"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("svg",{className:"h-4 w-4 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z",clipRule:"evenodd"})}),s.jsx("span",{children:"Made in Germany"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("svg",{className:"h-4 w-4 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),s.jsx("span",{children:"4.9/5 Bewertung"})]})]})]})]})})]})}const eg=()=>{const[t,e]=g.useState(""),[n,r]=g.useState(""),[a,i]=g.useState(!1),[o,c]=g.useState(!1),[d,u]=g.useState({top:0,bottom:0}),{signIn:m}=Lg(),f=wa();g.useEffect(()=>{(async()=>{if(jr.isNativePlatform()){const w=parseInt(getComputedStyle(document.documentElement).getPropertyValue("env(safe-area-inset-top)")||"44"),x=parseInt(getComputedStyle(document.documentElement).getPropertyValue("env(safe-area-inset-bottom)")||"34");u({top:isNaN(w)?44:w,bottom:isNaN(x)?34:x})}})()},[]);const p=async v=>{if(v.preventDefault(),!t||!n){Te.error("Bitte füllen Sie alle Felder aus");return}c(!0);try{const w=await m(t,n),{data:{session:x}}=await K.auth.getSession();if(x!=null&&x.user){const{data:y}=await K.from("user_roles").select("role").eq("user_id",x.user.id).single(),j=(y==null?void 0:y.role)||"employee";Te.success("Erfolgreich angemeldet"),f(j==="manager"?"/manager":"/employee")}else f("/")}catch(w){Te.error("Anmeldung fehlgeschlagen: "+((w==null?void 0:w.message)||"Unbekannter Fehler"))}finally{c(!1)}};return s.jsxs("div",{className:"h-full bg-white flex flex-col justify-center",style:{paddingTop:`${Math.max(d.top,44)}px`,paddingBottom:`${Math.max(d.bottom,20)}px`},children:[s.jsx("div",{className:"text-center mb-8",children:s.jsxs("div",{className:"flex justify-center items-center mb-2",children:[s.jsx("img",{src:"/favicon-32x32.png",alt:"HandwerkOS Logo",className:"h-6 w-6 mr-2",style:{imageRendering:"-webkit-optimize-contrast"},onError:v=>{var w;v.currentTarget.style.display="none",(w=v.currentTarget.nextElementSibling)==null||w.classList.remove("hidden")}}),s.jsx("div",{className:"bg-gray-100 p-1 rounded-full mr-2 hidden",children:s.jsx($h,{className:"h-4 w-4 text-blue-600"})}),s.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"HandwerkOS"})]})}),s.jsx("div",{className:"px-6",children:s.jsxs("div",{className:"max-w-sm mx-auto",children:[s.jsxs("form",{onSubmit:p,className:"space-y-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx(se,{htmlFor:"email",className:"text-gray-900 font-medium",children:"E-Mail"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ds,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-600"}),s.jsx(re,{id:"email",type:"email",value:t,onChange:v=>e(v.target.value),className:"pl-10 h-10 text-sm border-gray-300 bg-white text-gray-900 placeholder:text-gray-500",placeholder:"ihre.email@firma.de",disabled:o})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(se,{htmlFor:"password",className:"text-gray-900 font-medium",children:"Passwort"}),s.jsxs("div",{className:"relative",children:[s.jsx(pB,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-600"}),s.jsx(re,{id:"password",type:a?"text":"password",value:n,onChange:v=>r(v.target.value),className:"pl-10 pr-10 h-10 text-sm border-gray-300 bg-white text-gray-900 placeholder:text-gray-500",placeholder:"Ihr Passwort",disabled:o}),s.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-600",disabled:o,children:a?s.jsx(hP,{className:"h-5 w-5"}):s.jsx(Lr,{className:"h-5 w-5"})})]})]}),s.jsx(ne,{type:"submit",className:"w-full h-10 text-sm bg-blue-500 hover:bg-blue-600 text-white font-medium shadow-sm mt-4",disabled:o,children:o?"Anmelden...":"Anmelden"})]}),s.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsx("p",{className:"text-xs text-yellow-700 mb-2 font-medium",children:"🚧 Entwicklungsmodus"}),s.jsxs(ne,{type:"button",variant:"outline",className:"w-full h-9 text-xs border-yellow-400 hover:bg-yellow-100",onClick:()=>{e("gotit57576@euleina.com"),r("test1234")},children:[s.jsx($h,{className:"h-3 w-3 mr-2"}),"Test-Mitarbeiter (gotit57576@euleina.com)"]})]}),s.jsxs("div",{className:"mt-4 text-center text-xs text-gray-600",children:[s.jsx("p",{children:"Probleme beim Anmelden?"}),s.jsx("p",{children:"Wenden Sie sich an Ihren Administrator"})]})]})})]})},Xre=()=>{const[t,e]=g.useState(null),[n,r]=g.useState(!0),a=wa();return g.useEffect(()=>{const i=async()=>{try{console.log("Checking auth and role...");const{data:{session:d}}=await K.auth.getSession();if(e(!!d),d!=null&&d.user){console.log("User found:",d.user.id);const{data:u,error:m}=await K.from("user_roles").select("role").eq("user_id",d.user.id).maybeSingle();console.log("Role data:",u,"Error:",m);let f="employee";if(u!=null&&u.role?f=u.role:(console.log("No role found for user, treating as employee"),f="employee"),console.log("User role:",f),f==="manager"){console.log("Redirecting manager to /manager"),a("/manager");return}}}catch(d){console.error("Error checking auth and role:",d)}finally{r(!1)}},o=setTimeout(()=>{console.log("Auth check timeout - proceeding without auth"),e(!1),r(!1)},5e3);i().then(()=>{clearTimeout(o)});const{data:{subscription:c}}=K.auth.onAuthStateChange(async(d,u)=>{if(e(!!u),u!=null&&u.user&&d==="SIGNED_IN"){const{data:m}=await K.from("user_roles").select("role").eq("user_id",u.user.id).single();((m==null?void 0:m.role)||"employee")==="manager"&&a("/manager")}});return()=>c.unsubscribe()},[a]),n?s.jsx("div",{className:"h-full bg-blue-50 flex items-center justify-center",style:{paddingTop:"44px",paddingBottom:"20px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Lade..."})]})}):t?s.jsx(Q5,{}):s.jsx(eg,{})},Jre=()=>{const{user:t,loading:e}=Vr(),[n,r]=g.useState(!1);return g.useEffect(()=>{!e&&!t?r(!0):!e&&t&&r(!1)},[t,e]),e?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-600 to-purple-700",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),s.jsx("p",{className:"text-white text-lg",children:"HandwerkOS wird geladen..."})]})}):n||!t?s.jsx(eg,{}):s.jsx(G5,{})};class eae extends Ae.Component{constructor(n){super(n);fs(this,"resetError",()=>{this.setState({hasError:!1,error:null})});this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("Error Boundary caught an error:",n,r)}render(){if(this.state.hasError){if(this.props.fallback){const n=this.props.fallback;return s.jsx(n,{error:this.state.error,resetError:this.resetError})}return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:s.jsxs(oe,{className:"w-full max-w-lg",children:[s.jsxs(je,{className:"text-center",children:[s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("div",{className:"p-3 rounded-full bg-red-100",children:s.jsx(Jn,{className:"h-8 w-8 text-red-600"})})}),s.jsx(Ne,{className:"text-xl text-red-900",children:"Etwas ist schiefgelaufen"})]}),s.jsxs(de,{className:"text-center space-y-4",children:[s.jsx("p",{className:"text-gray-600",children:"Es ist ein unerwarteter Fehler aufgetreten. Bitte versuchen Sie es erneut."}),this.state.error&&s.jsxs("details",{className:"text-left",children:[s.jsx("summary",{className:"cursor-pointer text-sm text-gray-500 hover:text-gray-700",children:"Technische Details anzeigen"}),s.jsx("pre",{className:"mt-2 p-3 bg-gray-100 rounded text-xs text-red-800 overflow-auto",children:this.state.error.toString()})]}),s.jsxs("div",{className:"flex gap-3 justify-center",children:[s.jsxs(ne,{onClick:this.resetError,className:"flex items-center gap-2",children:[s.jsx(uh,{className:"h-4 w-4"}),"Erneut versuchen"]}),s.jsx(ne,{variant:"outline",onClick:()=>window.location.reload(),children:"Seite neu laden"})]})]})]})})}return this.props.children}}const tae=()=>{const t=sc();return g.useEffect(()=>{jr.isNativePlatform()||jO()},[]),g.useEffect(()=>{jr.isNativePlatform()||Qre(t.pathname+t.search)},[t]),null},dn=new b9({defaultOptions:{queries:{retry:2,staleTime:5*60*1e3,refetchOnWindowFocus:!1}}}),nae=()=>(g.useEffect(()=>{const t=[mt.on("CUSTOMER_CREATED",()=>{dn.invalidateQueries({queryKey:["customers"]})}),mt.on("CUSTOMER_UPDATED",()=>{dn.invalidateQueries({queryKey:["customers"]})}),mt.on("CUSTOMER_DELETED",()=>{dn.invalidateQueries({queryKey:["customers"]})}),mt.on("PROJECT_CREATED",()=>{dn.invalidateQueries({queryKey:["projects"]}),dn.invalidateQueries({queryKey:["financial-kpis"]})}),mt.on("PROJECT_UPDATED",()=>{dn.invalidateQueries({queryKey:["projects"]}),dn.invalidateQueries({queryKey:["financial-kpis"]})}),mt.on("PROJECT_STATUS_CHANGED",()=>{dn.invalidateQueries({queryKey:["projects"]}),dn.invalidateQueries({queryKey:["financial-kpis"]})}),mt.on("QUOTE_CREATED",()=>{dn.invalidateQueries({queryKey:["quotes"]})}),mt.on("QUOTE_UPDATED",()=>{dn.invalidateQueries({queryKey:["quotes"]})}),mt.on("QUOTE_ACCEPTED",()=>{dn.invalidateQueries({queryKey:["quotes"]}),dn.invalidateQueries({queryKey:["financial-kpis"]})}),mt.on("INVOICE_CREATED",()=>{dn.invalidateQueries({queryKey:["invoices"]}),dn.invalidateQueries({queryKey:["financial-kpis"]})}),mt.on("INVOICE_UPDATED",()=>{dn.invalidateQueries({queryKey:["invoices"]}),dn.invalidateQueries({queryKey:["financial-kpis"]})}),mt.on("INVOICE_PAID",()=>{dn.invalidateQueries({queryKey:["invoices"]}),dn.invalidateQueries({queryKey:["financial-kpis"]})}),mt.on("TIMESHEET_CREATED",()=>{dn.invalidateQueries({queryKey:["time-entries"]})}),mt.on("TIMESHEET_UPDATED",()=>{dn.invalidateQueries({queryKey:["time-entries"]})}),mt.on("STOCK_ADJUSTED",()=>{dn.invalidateQueries({queryKey:["materials"]}),dn.invalidateQueries({queryKey:["stock-counts"]})}),mt.on("STOCK_TRANSFER_COMPLETED",()=>{dn.invalidateQueries({queryKey:["materials"]}),dn.invalidateQueries({queryKey:["stock-transfers"]}),dn.invalidateQueries({queryKey:["stock-counts"]})})];return()=>{t.forEach(e=>mt.off(e))}},[]),null),sae=()=>s.jsx(eae,{children:s.jsxs(C9,{client:dn,children:[s.jsx(nae,{}),s.jsx(cz,{children:s.jsxs(i9,{children:[s.jsx(lz,{}),s.jsx(Rz,{}),s.jsxs(R7,{children:[s.jsx(tae,{}),s.jsxs(k7,{children:[s.jsx(Vs,{path:"/",element:jr.isNativePlatform()?s.jsx(eg,{}):s.jsx(mE,{})}),s.jsx(Vs,{path:"/app",element:s.jsx(Jre,{})}),s.jsx(Vs,{path:"/mobile",element:s.jsx(Xre,{})}),s.jsx(Vs,{path:"/mobile-auth",element:s.jsx(eg,{})}),s.jsx(Vs,{path:"/handwerkersoftware",element:s.jsx(mE,{})}),s.jsx(Vs,{path:"/login",element:s.jsx(lE,{})}),s.jsx(Vs,{path:"/auth",element:s.jsx(lE,{})}),s.jsx(Vs,{path:"/manager",element:s.jsx(Xse,{})}),s.jsx(Vs,{path:"/employee",element:s.jsx(Q5,{})}),s.jsx(Vs,{path:"/auth/callback",element:s.jsx(gre,{})}),s.jsx(Vs,{path:"/privacy",element:s.jsx(xre,{})}),s.jsx(Vs,{path:"/mitarbeiter-setup",element:s.jsx(yre,{})}),s.jsx(Vs,{path:"*",element:s.jsx(vre,{})})]})]})]})})]})});BA(document.getElementById("root")).render(s.jsx(nH,{children:s.jsx(eH,{children:s.jsx(sae,{})})}));export{RI as W};
//# sourceMappingURL=index-BYdmsD7r.js.map
